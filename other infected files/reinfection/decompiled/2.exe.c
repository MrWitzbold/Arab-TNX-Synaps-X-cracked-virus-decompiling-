typedef unsigned char   undefined;

typedef unsigned long long    GUID;
typedef unsigned int    ImageBaseOffset32;
typedef unsigned char    bool;
typedef unsigned char    byte;
typedef unsigned int    dword;
float10
typedef long long    longlong;
typedef unsigned char    uchar;
typedef unsigned int    uint;
typedef unsigned int    uint3;
typedef unsigned long    ulong;
typedef unsigned long long    ulonglong;
typedef unsigned char    undefined1;
typedef unsigned short    undefined2;
typedef unsigned int    undefined4;
typedef unsigned long long    undefined8;
typedef unsigned short    ushort;
typedef short    wchar_t;
typedef unsigned short    word;
typedef unsigned short    wchar16;
typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion;

typedef struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct;

struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct {
    dword OffsetToDirectory;
    dword DataIsDirectory;
};

union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion {
    dword OffsetToData;
    struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct;
};

typedef struct _cpinfo _cpinfo, *P_cpinfo;

typedef uint UINT;

typedef uchar BYTE;

struct _cpinfo {
    UINT MaxCharSize;
    BYTE DefaultChar[2];
    BYTE LeadByte[12];
};

typedef int BOOL;

typedef char CHAR;

typedef CHAR * LPSTR;

typedef BOOL (* CALINFO_ENUMPROCA)(LPSTR);

typedef long LONG;

typedef LONG GEOID;

typedef struct _nlsversioninfoex _nlsversioninfoex, *P_nlsversioninfoex;

typedef ulong DWORD;


// WARNING! conflicting data type names: /guiddef.h/GUID - /GUID

struct _nlsversioninfoex {
    DWORD dwNLSVersionInfoSize;
    DWORD dwNLSVersion;
    DWORD dwDefinedVersion;
    DWORD dwEffectiveId;
    GUID guidCustomVersion;
};

typedef DWORD CALID;

typedef BOOL (* CALINFO_ENUMPROCEXA)(LPSTR, CALID);

typedef struct _currencyfmtW _currencyfmtW, *P_currencyfmtW;

typedef struct _currencyfmtW CURRENCYFMTW;

typedef wchar_t WCHAR;

typedef WCHAR * LPWSTR;

struct _currencyfmtW {
    UINT NumDigits;
    UINT LeadingZero;
    UINT Grouping;
    LPWSTR lpDecimalSep;
    LPWSTR lpThousandSep;
    UINT NegativeOrder;
    UINT PositiveOrder;
    LPWSTR lpCurrencySymbol;
};

typedef struct _numberfmtW _numberfmtW, *P_numberfmtW;

typedef struct _numberfmtW NUMBERFMTW;

struct _numberfmtW {
    UINT NumDigits;
    UINT LeadingZero;
    UINT Grouping;
    LPWSTR lpDecimalSep;
    LPWSTR lpThousandSep;
    UINT NegativeOrder;
};

typedef struct _nlsversioninfo _nlsversioninfo, *P_nlsversioninfo;

typedef struct _nlsversioninfo * LPNLSVERSIONINFO;

struct _nlsversioninfo {
    DWORD dwNLSVersionInfoSize;
    DWORD dwNLSVersion;
    DWORD dwDefinedVersion;
};

typedef struct _numberfmtA _numberfmtA, *P_numberfmtA;

typedef struct _numberfmtA NUMBERFMTA;

struct _numberfmtA {
    UINT NumDigits;
    UINT LeadingZero;
    UINT Grouping;
    LPSTR lpDecimalSep;
    LPSTR lpThousandSep;
    UINT NegativeOrder;
};

typedef struct _nlsversioninfoex * LPNLSVERSIONINFOEX;

typedef struct _currencyfmtA _currencyfmtA, *P_currencyfmtA;

typedef struct _currencyfmtA CURRENCYFMTA;

struct _currencyfmtA {
    UINT NumDigits;
    UINT LeadingZero;
    UINT Grouping;
    LPSTR lpDecimalSep;
    LPSTR lpThousandSep;
    UINT NegativeOrder;
    UINT PositiveOrder;
    LPSTR lpCurrencySymbol;
};

typedef DWORD LGRPID;

typedef long LONG_PTR;

typedef BOOL (* LANGUAGEGROUP_ENUMPROCW)(LGRPID, LPWSTR, LPWSTR, DWORD, LONG_PTR);

typedef BOOL (* GEO_ENUMPROC)(GEOID);

typedef BOOL (* CALINFO_ENUMPROCW)(LPWSTR);

typedef BOOL (* LANGUAGEGROUP_ENUMPROCA)(LGRPID, LPSTR, LPSTR, DWORD, LONG_PTR);

typedef LONG_PTR LPARAM;

typedef BOOL (* CALINFO_ENUMPROCEXEX)(LPWSTR, CALID, LPWSTR, LPARAM);

typedef BOOL (* UILANGUAGE_ENUMPROCA)(LPSTR, LONG_PTR);

typedef struct _cpinfoexW _cpinfoexW, *P_cpinfoexW;

struct _cpinfoexW {
    UINT MaxCharSize;
    BYTE DefaultChar[2];
    BYTE LeadByte[12];
    WCHAR UnicodeDefaultChar;
    UINT CodePage;
    WCHAR CodePageName[260];
};

typedef DWORD NLS_FUNCTION;

typedef struct _cpinfoexA _cpinfoexA, *P_cpinfoexA;

typedef struct _cpinfoexA * LPCPINFOEXA;

struct _cpinfoexA {
    UINT MaxCharSize;
    BYTE DefaultChar[2];
    BYTE LeadByte[12];
    WCHAR UnicodeDefaultChar;
    UINT CodePage;
    CHAR CodePageName[260];
};

typedef enum _NORM_FORM {
    NormalizationOther=0,
    NormalizationC=1,
    NormalizationD=2,
    NormalizationKC=5,
    NormalizationKD=6
} _NORM_FORM;

typedef enum _NORM_FORM NORM_FORM;

typedef BOOL (* TIMEFMT_ENUMPROCEX)(LPWSTR, LPARAM);

typedef struct _cpinfo * LPCPINFO;

typedef DWORD LCTYPE;

typedef BOOL (* CALINFO_ENUMPROCEXW)(LPWSTR, CALID);

typedef BOOL (* DATEFMT_ENUMPROCEXA)(LPSTR, CALID);

typedef BOOL (* DATEFMT_ENUMPROCEXW)(LPWSTR, CALID);

typedef BOOL (* LOCALE_ENUMPROCA)(LPSTR);

typedef BOOL (* DATEFMT_ENUMPROCW)(LPWSTR);

typedef BOOL (* DATEFMT_ENUMPROCEXEX)(LPWSTR, CALID, LPARAM);

typedef struct _FILEMUIINFO _FILEMUIINFO, *P_FILEMUIINFO;

struct _FILEMUIINFO {
    DWORD dwSize;
    DWORD dwVersion;
    DWORD dwFileType;
    BYTE pChecksum[16];
    BYTE pServiceChecksum[16];
    DWORD dwLanguageNameOffset;
    DWORD dwTypeIDMainSize;
    DWORD dwTypeIDMainOffset;
    DWORD dwTypeNameMainOffset;
    DWORD dwTypeIDMUISize;
    DWORD dwTypeIDMUIOffset;
    DWORD dwTypeNameMUIOffset;
    BYTE abBuffer[8];
};

typedef BOOL (* TIMEFMT_ENUMPROCA)(LPSTR);

typedef BOOL (* LOCALE_ENUMPROCW)(LPWSTR);

typedef DWORD LCID;

typedef BOOL (* LANGGROUPLOCALE_ENUMPROCW)(LGRPID, LCID, LPWSTR, LONG_PTR);

typedef struct _cpinfoexW * LPCPINFOEXW;

typedef BOOL (* UILANGUAGE_ENUMPROCW)(LPWSTR, LONG_PTR);

typedef BOOL (* LANGGROUPLOCALE_ENUMPROCA)(LGRPID, LCID, LPSTR, LONG_PTR);

typedef DWORD GEOCLASS;

typedef BOOL (* DATEFMT_ENUMPROCA)(LPSTR);

typedef BOOL (* LOCALE_ENUMPROCEX)(LPWSTR, DWORD, LPARAM);

typedef BOOL (* CODEPAGE_ENUMPROCA)(LPSTR);

typedef DWORD CALTYPE;

typedef BOOL (* CODEPAGE_ENUMPROCW)(LPWSTR);

typedef struct _FILEMUIINFO * PFILEMUIINFO;

typedef DWORD GEOTYPE;

typedef BOOL (* TIMEFMT_ENUMPROCW)(LPWSTR);

typedef struct _RPC_SYNTAX_IDENTIFIER _RPC_SYNTAX_IDENTIFIER, *P_RPC_SYNTAX_IDENTIFIER;

typedef struct _RPC_VERSION _RPC_VERSION, *P_RPC_VERSION;

typedef struct _RPC_VERSION RPC_VERSION;

struct _RPC_VERSION {
    ushort MajorVersion;
    ushort MinorVersion;
};

struct _RPC_SYNTAX_IDENTIFIER {
    GUID SyntaxGUID;
    RPC_VERSION SyntaxVersion;
};

typedef struct _RPC_MESSAGE _RPC_MESSAGE, *P_RPC_MESSAGE;

typedef void * I_RPC_HANDLE;

typedef I_RPC_HANDLE RPC_BINDING_HANDLE;

typedef struct _RPC_SYNTAX_IDENTIFIER * PRPC_SYNTAX_IDENTIFIER;

struct _RPC_MESSAGE {
    RPC_BINDING_HANDLE Handle;
    ulong DataRepresentation;
    void * Buffer;
    uint BufferLength;
    uint ProcNum;
    PRPC_SYNTAX_IDENTIFIER TransferSyntax;
    void * RpcInterfaceInformation;
    void * ReservedForRuntime;
    void * ManagerEpv;
    void * ImportContext;
    ulong RpcFlags;
};

typedef struct _RPC_MESSAGE * PRPC_MESSAGE;

typedef struct GuardCfgTableEntry GuardCfgTableEntry, *PGuardCfgTableEntry;

struct GuardCfgTableEntry {
    ImageBaseOffset32 Offset;
    byte Pad[1];
};

typedef struct _COMMPROP _COMMPROP, *P_COMMPROP;

typedef struct _COMMPROP * LPCOMMPROP;

typedef ushort WORD;

struct _COMMPROP {
    WORD wPacketLength;
    WORD wPacketVersion;
    DWORD dwServiceMask;
    DWORD dwReserved1;
    DWORD dwMaxTxQueue;
    DWORD dwMaxRxQueue;
    DWORD dwMaxBaud;
    DWORD dwProvSubType;
    DWORD dwProvCapabilities;
    DWORD dwSettableParams;
    DWORD dwSettableBaud;
    WORD wSettableData;
    WORD wSettableStopParity;
    DWORD dwCurrentTxQueue;
    DWORD dwCurrentRxQueue;
    DWORD dwProvSpec1;
    DWORD dwProvSpec2;
    WCHAR wcProvChar[1];
};

typedef struct _TIME_DYNAMIC_ZONE_INFORMATION _TIME_DYNAMIC_ZONE_INFORMATION, *P_TIME_DYNAMIC_ZONE_INFORMATION;

typedef struct _TIME_DYNAMIC_ZONE_INFORMATION * PDYNAMIC_TIME_ZONE_INFORMATION;

typedef struct _SYSTEMTIME _SYSTEMTIME, *P_SYSTEMTIME;

typedef struct _SYSTEMTIME SYSTEMTIME;

typedef BYTE BOOLEAN;

struct _SYSTEMTIME {
    WORD wYear;
    WORD wMonth;
    WORD wDayOfWeek;
    WORD wDay;
    WORD wHour;
    WORD wMinute;
    WORD wSecond;
    WORD wMilliseconds;
};

struct _TIME_DYNAMIC_ZONE_INFORMATION {
    LONG Bias;
    WCHAR StandardName[32];
    SYSTEMTIME StandardDate;
    LONG StandardBias;
    WCHAR DaylightName[32];
    SYSTEMTIME DaylightDate;
    LONG DaylightBias;
    WCHAR TimeZoneKeyName[128];
    BOOLEAN DynamicDaylightTimeDisabled;
};

typedef struct FILE_ID_DESCRIPTOR FILE_ID_DESCRIPTOR, *PFILE_ID_DESCRIPTOR;

typedef struct FILE_ID_DESCRIPTOR * LPFILE_ID_DESCRIPTOR;

typedef enum _FILE_ID_TYPE {
    FileIdType=0,
    ObjectIdType=1,
    MaximumFileIdType=2
} _FILE_ID_TYPE;

typedef enum _FILE_ID_TYPE FILE_ID_TYPE;

typedef union _union_598 _union_598, *P_union_598;

typedef union _LARGE_INTEGER _LARGE_INTEGER, *P_LARGE_INTEGER;

typedef union _LARGE_INTEGER LARGE_INTEGER;

typedef struct _struct_19 _struct_19, *P_struct_19;

typedef struct _struct_20 _struct_20, *P_struct_20;

typedef double LONGLONG;

struct _struct_20 {
    DWORD LowPart;
    LONG HighPart;
};

struct _struct_19 {
    DWORD LowPart;
    LONG HighPart;
};

union _LARGE_INTEGER {
    struct _struct_19 s;
    struct _struct_20 u;
    LONGLONG QuadPart;
};

union _union_598 {
    LARGE_INTEGER FileId;
    GUID ObjectId;
};

struct FILE_ID_DESCRIPTOR {
    DWORD dwSize;
    FILE_ID_TYPE Type;
    union _union_598 u;
};

typedef struct tagACTCTXA tagACTCTXA, *PtagACTCTXA;

typedef struct tagACTCTXA ACTCTXA;

typedef ulong ULONG;

typedef CHAR * LPCSTR;

typedef ushort USHORT;

typedef WORD LANGID;

typedef struct HINSTANCE__ HINSTANCE__, *PHINSTANCE__;

typedef struct HINSTANCE__ * HINSTANCE;

typedef HINSTANCE HMODULE;

struct tagACTCTXA {
    ULONG cbSize;
    DWORD dwFlags;
    LPCSTR lpSource;
    USHORT wProcessorArchitecture;
    LANGID wLangId;
    LPCSTR lpAssemblyDirectory;
    LPCSTR lpResourceName;
    LPCSTR lpApplicationName;
    HMODULE hModule;
};

struct HINSTANCE__ {
    int unused;
};

typedef struct _SECURITY_ATTRIBUTES _SECURITY_ATTRIBUTES, *P_SECURITY_ATTRIBUTES;

typedef struct _SECURITY_ATTRIBUTES SECURITY_ATTRIBUTES;

typedef void * LPVOID;

struct _SECURITY_ATTRIBUTES {
    DWORD nLength;
    LPVOID lpSecurityDescriptor;
    BOOL bInheritHandle;
};

typedef struct _SYSTEM_POWER_STATUS _SYSTEM_POWER_STATUS, *P_SYSTEM_POWER_STATUS;

struct _SYSTEM_POWER_STATUS {
    BYTE ACLineStatus;
    BYTE BatteryFlag;
    BYTE BatteryLifePercent;
    BYTE Reserved1;
    DWORD BatteryLifeTime;
    DWORD BatteryFullLifeTime;
};

typedef struct _OVERLAPPED _OVERLAPPED, *P_OVERLAPPED;

typedef ulong ULONG_PTR;

typedef union _union_518 _union_518, *P_union_518;

typedef void * HANDLE;

typedef struct _struct_519 _struct_519, *P_struct_519;

typedef void * PVOID;

struct _struct_519 {
    DWORD Offset;
    DWORD OffsetHigh;
};

union _union_518 {
    struct _struct_519 s;
    PVOID Pointer;
};

struct _OVERLAPPED {
    ULONG_PTR Internal;
    ULONG_PTR InternalHigh;
    union _union_518 u;
    HANDLE hEvent;
};

typedef enum enum_570 {
    PipeAttribute=0,
    PipeConnectionAttribute=1,
    PipeHandleAttribute=2
} enum_570;

typedef struct _PROCESS_HEAP_ENTRY _PROCESS_HEAP_ENTRY, *P_PROCESS_HEAP_ENTRY;

typedef struct _PROCESS_HEAP_ENTRY * LPPROCESS_HEAP_ENTRY;

typedef union _union_548 _union_548, *P_union_548;

typedef struct _struct_549 _struct_549, *P_struct_549;

typedef struct _struct_550 _struct_550, *P_struct_550;

struct _struct_550 {
    DWORD dwCommittedSize;
    DWORD dwUnCommittedSize;
    LPVOID lpFirstBlock;
    LPVOID lpLastBlock;
};

struct _struct_549 {
    HANDLE hMem;
    DWORD dwReserved[3];
};

union _union_548 {
    struct _struct_549 Block;
    struct _struct_550 Region;
};

struct _PROCESS_HEAP_ENTRY {
    PVOID lpData;
    DWORD cbData;
    BYTE cbOverhead;
    BYTE iRegionIndex;
    WORD wFlags;
    union _union_548 u;
};

typedef struct _EXCEPTION_DEBUG_INFO _EXCEPTION_DEBUG_INFO, *P_EXCEPTION_DEBUG_INFO;

typedef struct _EXCEPTION_RECORD _EXCEPTION_RECORD, *P_EXCEPTION_RECORD;

typedef struct _EXCEPTION_RECORD EXCEPTION_RECORD;

struct _EXCEPTION_RECORD {
    DWORD ExceptionCode;
    DWORD ExceptionFlags;
    struct _EXCEPTION_RECORD * ExceptionRecord;
    PVOID ExceptionAddress;
    DWORD NumberParameters;
    ULONG_PTR ExceptionInformation[15];
};

struct _EXCEPTION_DEBUG_INFO {
    EXCEPTION_RECORD ExceptionRecord;
    DWORD dwFirstChance;
};

typedef struct _CREATE_THREAD_DEBUG_INFO _CREATE_THREAD_DEBUG_INFO, *P_CREATE_THREAD_DEBUG_INFO;

typedef DWORD (* PTHREAD_START_ROUTINE)(LPVOID);

typedef PTHREAD_START_ROUTINE LPTHREAD_START_ROUTINE;

struct _CREATE_THREAD_DEBUG_INFO {
    HANDLE hThread;
    LPVOID lpThreadLocalBase;
    LPTHREAD_START_ROUTINE lpStartAddress;
};

typedef struct _OUTPUT_DEBUG_STRING_INFO _OUTPUT_DEBUG_STRING_INFO, *P_OUTPUT_DEBUG_STRING_INFO;

typedef struct _OUTPUT_DEBUG_STRING_INFO OUTPUT_DEBUG_STRING_INFO;

struct _OUTPUT_DEBUG_STRING_INFO {
    LPSTR lpDebugStringData;
    WORD fUnicode;
    WORD nDebugStringLength;
};

typedef struct _COMSTAT _COMSTAT, *P_COMSTAT;

typedef struct _COMSTAT * LPCOMSTAT;

struct _COMSTAT {
    DWORD fCtsHold:1;
    DWORD fDsrHold:1;
    DWORD fRlsdHold:1;
    DWORD fXoffHold:1;
    DWORD fXoffSent:1;
    DWORD fEof:1;
    DWORD fTxim:1;
    DWORD fReserved:25;
    DWORD cbInQue;
    DWORD cbOutQue;
};

typedef struct _WIN32_FIND_DATAW _WIN32_FIND_DATAW, *P_WIN32_FIND_DATAW;

typedef struct _WIN32_FIND_DATAW * LPWIN32_FIND_DATAW;

typedef struct _FILETIME _FILETIME, *P_FILETIME;

typedef struct _FILETIME FILETIME;

struct _FILETIME {
    DWORD dwLowDateTime;
    DWORD dwHighDateTime;
};

struct _WIN32_FIND_DATAW {
    DWORD dwFileAttributes;
    FILETIME ftCreationTime;
    FILETIME ftLastAccessTime;
    FILETIME ftLastWriteTime;
    DWORD nFileSizeHigh;
    DWORD nFileSizeLow;
    DWORD dwReserved0;
    DWORD dwReserved1;
    WCHAR cFileName[260];
    WCHAR cAlternateFileName[14];
};

typedef struct _DCB _DCB, *P_DCB;

struct _DCB {
    DWORD DCBlength;
    DWORD BaudRate;
    DWORD fBinary:1;
    DWORD fParity:1;
    DWORD fOutxCtsFlow:1;
    DWORD fOutxDsrFlow:1;
    DWORD fDtrControl:2;
    DWORD fDsrSensitivity:1;
    DWORD fTXContinueOnXoff:1;
    DWORD fOutX:1;
    DWORD fInX:1;
    DWORD fErrorChar:1;
    DWORD fNull:1;
    DWORD fRtsControl:2;
    DWORD fAbortOnError:1;
    DWORD fDummy2:17;
    WORD wReserved;
    WORD XonLim;
    WORD XoffLim;
    BYTE ByteSize;
    BYTE Parity;
    BYTE StopBits;
    char XonChar;
    char XoffChar;
    char ErrorChar;
    char EofChar;
    char EvtChar;
    WORD wReserved1;
};

typedef struct _WIN32_FIND_DATAA _WIN32_FIND_DATAA, *P_WIN32_FIND_DATAA;

struct _WIN32_FIND_DATAA {
    DWORD dwFileAttributes;
    FILETIME ftCreationTime;
    FILETIME ftLastAccessTime;
    FILETIME ftLastWriteTime;
    DWORD nFileSizeHigh;
    DWORD nFileSizeLow;
    DWORD dwReserved0;
    DWORD dwReserved1;
    CHAR cFileName[260];
    CHAR cAlternateFileName[14];
};

typedef struct _LOAD_DLL_DEBUG_INFO _LOAD_DLL_DEBUG_INFO, *P_LOAD_DLL_DEBUG_INFO;

struct _LOAD_DLL_DEBUG_INFO {
    HANDLE hFile;
    LPVOID lpBaseOfDll;
    DWORD dwDebugInfoFileOffset;
    DWORD nDebugInfoSize;
    LPVOID lpImageName;
    WORD fUnicode;
};

typedef struct _struct_557 _struct_557, *P_struct_557;

struct _struct_557 {
    HMODULE LocalizedReasonModule;
    ULONG LocalizedReasonId;
    ULONG ReasonStringCount;
    LPWSTR * ReasonStrings;
};

typedef union _RTL_RUN_ONCE _RTL_RUN_ONCE, *P_RTL_RUN_ONCE;

typedef union _RTL_RUN_ONCE * PRTL_RUN_ONCE;

typedef PRTL_RUN_ONCE LPINIT_ONCE;

union _RTL_RUN_ONCE {
    PVOID Ptr;
};

typedef void (* PFIBER_START_ROUTINE)(LPVOID);

typedef struct _SECURITY_ATTRIBUTES * LPSECURITY_ATTRIBUTES;

typedef enum _DEP_SYSTEM_POLICY_TYPE {
    DEPPolicyAlwaysOff=0,
    DEPPolicyAlwaysOn=1,
    DEPPolicyOptIn=2,
    DEPPolicyOptOut=3,
    DEPTotalPolicyCount=4
} _DEP_SYSTEM_POLICY_TYPE;

typedef enum _DEP_SYSTEM_POLICY_TYPE DEP_SYSTEM_POLICY_TYPE;

typedef struct _COMMTIMEOUTS _COMMTIMEOUTS, *P_COMMTIMEOUTS;

struct _COMMTIMEOUTS {
    DWORD ReadIntervalTimeout;
    DWORD ReadTotalTimeoutMultiplier;
    DWORD ReadTotalTimeoutConstant;
    DWORD WriteTotalTimeoutMultiplier;
    DWORD WriteTotalTimeoutConstant;
};

typedef struct _STARTUPINFOA _STARTUPINFOA, *P_STARTUPINFOA;

typedef BYTE * LPBYTE;

struct _STARTUPINFOA {
    DWORD cb;
    LPSTR lpReserved;
    LPSTR lpDesktop;
    LPSTR lpTitle;
    DWORD dwX;
    DWORD dwY;
    DWORD dwXSize;
    DWORD dwYSize;
    DWORD dwXCountChars;
    DWORD dwYCountChars;
    DWORD dwFillAttribute;
    DWORD dwFlags;
    WORD wShowWindow;
    WORD cbReserved2;
    LPBYTE lpReserved2;
    HANDLE hStdInput;
    HANDLE hStdOutput;
    HANDLE hStdError;
};

typedef struct _DEBUG_EVENT _DEBUG_EVENT, *P_DEBUG_EVENT;

typedef struct _DEBUG_EVENT * LPDEBUG_EVENT;

typedef union _union_543 _union_543, *P_union_543;

typedef struct _EXCEPTION_DEBUG_INFO EXCEPTION_DEBUG_INFO;

typedef struct _CREATE_THREAD_DEBUG_INFO CREATE_THREAD_DEBUG_INFO;

typedef struct _CREATE_PROCESS_DEBUG_INFO _CREATE_PROCESS_DEBUG_INFO, *P_CREATE_PROCESS_DEBUG_INFO;

typedef struct _CREATE_PROCESS_DEBUG_INFO CREATE_PROCESS_DEBUG_INFO;

typedef struct _EXIT_THREAD_DEBUG_INFO _EXIT_THREAD_DEBUG_INFO, *P_EXIT_THREAD_DEBUG_INFO;

typedef struct _EXIT_THREAD_DEBUG_INFO EXIT_THREAD_DEBUG_INFO;

typedef struct _EXIT_PROCESS_DEBUG_INFO _EXIT_PROCESS_DEBUG_INFO, *P_EXIT_PROCESS_DEBUG_INFO;

typedef struct _EXIT_PROCESS_DEBUG_INFO EXIT_PROCESS_DEBUG_INFO;

typedef struct _LOAD_DLL_DEBUG_INFO LOAD_DLL_DEBUG_INFO;

typedef struct _UNLOAD_DLL_DEBUG_INFO _UNLOAD_DLL_DEBUG_INFO, *P_UNLOAD_DLL_DEBUG_INFO;

typedef struct _UNLOAD_DLL_DEBUG_INFO UNLOAD_DLL_DEBUG_INFO;

typedef struct _RIP_INFO _RIP_INFO, *P_RIP_INFO;

typedef struct _RIP_INFO RIP_INFO;

struct _EXIT_PROCESS_DEBUG_INFO {
    DWORD dwExitCode;
};

struct _EXIT_THREAD_DEBUG_INFO {
    DWORD dwExitCode;
};

struct _UNLOAD_DLL_DEBUG_INFO {
    LPVOID lpBaseOfDll;
};

struct _RIP_INFO {
    DWORD dwError;
    DWORD dwType;
};

struct _CREATE_PROCESS_DEBUG_INFO {
    HANDLE hFile;
    HANDLE hProcess;
    HANDLE hThread;
    LPVOID lpBaseOfImage;
    DWORD dwDebugInfoFileOffset;
    DWORD nDebugInfoSize;
    LPVOID lpThreadLocalBase;
    LPTHREAD_START_ROUTINE lpStartAddress;
    LPVOID lpImageName;
    WORD fUnicode;
};

union _union_543 {
    EXCEPTION_DEBUG_INFO Exception;
    CREATE_THREAD_DEBUG_INFO CreateThread;
    CREATE_PROCESS_DEBUG_INFO CreateProcessInfo;
    EXIT_THREAD_DEBUG_INFO ExitThread;
    EXIT_PROCESS_DEBUG_INFO ExitProcess;
    LOAD_DLL_DEBUG_INFO LoadDll;
    UNLOAD_DLL_DEBUG_INFO UnloadDll;
    OUTPUT_DEBUG_STRING_INFO DebugString;
    RIP_INFO RipInfo;
};

struct _DEBUG_EVENT {
    DWORD dwDebugEventCode;
    DWORD dwProcessId;
    DWORD dwThreadId;
    union _union_543 u;
};

typedef BOOL (* ENUMRESNAMEPROCA)(HMODULE, LPCSTR, LPSTR, LONG_PTR);

typedef enum _STREAM_INFO_LEVELS {
    FindStreamInfoStandard=0,
    FindStreamInfoMaxInfoLevel=1
} _STREAM_INFO_LEVELS;

typedef struct _TIME_ZONE_INFORMATION _TIME_ZONE_INFORMATION, *P_TIME_ZONE_INFORMATION;

struct _TIME_ZONE_INFORMATION {
    LONG Bias;
    WCHAR StandardName[32];
    SYSTEMTIME StandardDate;
    LONG StandardBias;
    WCHAR DaylightName[32];
    SYSTEMTIME DaylightDate;
    LONG DaylightBias;
};

typedef enum _FINDEX_INFO_LEVELS {
    FindExInfoStandard=0,
    FindExInfoBasic=1,
    FindExInfoMaxInfoLevel=2
} _FINDEX_INFO_LEVELS;

typedef enum _FINDEX_INFO_LEVELS FINDEX_INFO_LEVELS;

typedef struct _REASON_CONTEXT _REASON_CONTEXT, *P_REASON_CONTEXT;

typedef struct _REASON_CONTEXT * PREASON_CONTEXT;

typedef union _union_556 _union_556, *P_union_556;

union _union_556 {
    struct _struct_557 Detailed;
    LPWSTR SimpleReasonString;
};

struct _REASON_CONTEXT {
    ULONG Version;
    DWORD Flags;
    union _union_556 Reason;
};

typedef struct _MEMORYSTATUS _MEMORYSTATUS, *P_MEMORYSTATUS;

typedef struct _MEMORYSTATUS * LPMEMORYSTATUS;

typedef ULONG_PTR SIZE_T;

struct _MEMORYSTATUS {
    DWORD dwLength;
    DWORD dwMemoryLoad;
    SIZE_T dwTotalPhys;
    SIZE_T dwAvailPhys;
    SIZE_T dwTotalPageFile;
    SIZE_T dwAvailPageFile;
    SIZE_T dwTotalVirtual;
    SIZE_T dwAvailVirtual;
};

typedef struct _PROC_THREAD_ATTRIBUTE_LIST _PROC_THREAD_ATTRIBUTE_LIST, *P_PROC_THREAD_ATTRIBUTE_LIST;

struct _PROC_THREAD_ATTRIBUTE_LIST {
};

typedef struct tagACTCTXW tagACTCTXW, *PtagACTCTXW;

typedef struct tagACTCTXW ACTCTXW;

typedef WCHAR * LPCWSTR;

struct tagACTCTXW {
    ULONG cbSize;
    DWORD dwFlags;
    LPCWSTR lpSource;
    USHORT wProcessorArchitecture;
    LANGID wLangId;
    LPCWSTR lpAssemblyDirectory;
    LPCWSTR lpResourceName;
    LPCWSTR lpApplicationName;
    HMODULE hModule;
};

typedef struct _SYSTEM_INFO _SYSTEM_INFO, *P_SYSTEM_INFO;

typedef union _union_530 _union_530, *P_union_530;

typedef ULONG_PTR DWORD_PTR;

typedef struct _struct_531 _struct_531, *P_struct_531;

struct _struct_531 {
    WORD wProcessorArchitecture;
    WORD wReserved;
};

union _union_530 {
    DWORD dwOemId;
    struct _struct_531 s;
};

struct _SYSTEM_INFO {
    union _union_530 u;
    DWORD dwPageSize;
    LPVOID lpMinimumApplicationAddress;
    LPVOID lpMaximumApplicationAddress;
    DWORD_PTR dwActiveProcessorMask;
    DWORD dwNumberOfProcessors;
    DWORD dwProcessorType;
    DWORD dwAllocationGranularity;
    WORD wProcessorLevel;
    WORD wProcessorRevision;
};

typedef struct _PROC_THREAD_ATTRIBUTE_LIST * LPPROC_THREAD_ATTRIBUTE_LIST;

typedef enum _FILE_INFO_BY_HANDLE_CLASS {
    FileBasicInfo=0,
    FileStandardInfo=1,
    FileNameInfo=2,
    FileRenameInfo=3,
    FileDispositionInfo=4,
    FileAllocationInfo=5,
    FileEndOfFileInfo=6,
    FileStreamInfo=7,
    FileCompressionInfo=8,
    FileAttributeTagInfo=9,
    FileIdBothDirectoryInfo=10,
    FileIdBothDirectoryRestartInfo=11,
    FileIoPriorityHintInfo=12,
    FileRemoteProtocolInfo=13,
    MaximumFileInfoByHandleClass=14
} _FILE_INFO_BY_HANDLE_CLASS;

typedef BOOL (* ENUMRESNAMEPROCW)(HMODULE, LPCWSTR, LPWSTR, LONG_PTR);

typedef enum _FINDEX_SEARCH_OPS {
    FindExSearchNameMatch=0,
    FindExSearchLimitToDirectories=1,
    FindExSearchLimitToDevices=2,
    FindExSearchMaxSearchOp=3
} _FINDEX_SEARCH_OPS;

typedef struct tagACTCTX_SECTION_KEYED_DATA tagACTCTX_SECTION_KEYED_DATA, *PtagACTCTX_SECTION_KEYED_DATA;

typedef struct tagACTCTX_SECTION_KEYED_DATA * PACTCTX_SECTION_KEYED_DATA;

typedef struct tagACTCTX_SECTION_KEYED_DATA_ASSEMBLY_METADATA tagACTCTX_SECTION_KEYED_DATA_ASSEMBLY_METADATA, *PtagACTCTX_SECTION_KEYED_DATA_ASSEMBLY_METADATA;

typedef struct tagACTCTX_SECTION_KEYED_DATA_ASSEMBLY_METADATA ACTCTX_SECTION_KEYED_DATA_ASSEMBLY_METADATA;

struct tagACTCTX_SECTION_KEYED_DATA_ASSEMBLY_METADATA {
    PVOID lpInformation;
    PVOID lpSectionBase;
    ULONG ulSectionLength;
    PVOID lpSectionGlobalDataBase;
    ULONG ulSectionGlobalDataLength;
};

struct tagACTCTX_SECTION_KEYED_DATA {
    ULONG cbSize;
    ULONG ulDataFormatVersion;
    PVOID lpData;
    ULONG ulLength;
    PVOID lpSectionGlobalData;
    ULONG ulSectionGlobalDataLength;
    PVOID lpSectionBase;
    ULONG ulSectionTotalLength;
    HANDLE hActCtx;
    ULONG ulAssemblyRosterIndex;
    ULONG ulFlags;
    ACTCTX_SECTION_KEYED_DATA_ASSEMBLY_METADATA AssemblyMetadata;
};

typedef BOOL (* ENUMRESTYPEPROCA)(HMODULE, LPSTR, LONG_PTR);

typedef struct _MEMORYSTATUSEX _MEMORYSTATUSEX, *P_MEMORYSTATUSEX;

typedef double ULONGLONG;

typedef ULONGLONG DWORDLONG;

struct _MEMORYSTATUSEX {
    DWORD dwLength;
    DWORD dwMemoryLoad;
    DWORDLONG ullTotalPhys;
    DWORDLONG ullAvailPhys;
    DWORDLONG ullTotalPageFile;
    DWORDLONG ullAvailPageFile;
    DWORDLONG ullTotalVirtual;
    DWORDLONG ullAvailVirtual;
    DWORDLONG ullAvailExtendedVirtual;
};

typedef struct _SYSTEM_INFO * LPSYSTEM_INFO;

typedef struct _TIME_ZONE_INFORMATION TIME_ZONE_INFORMATION;

typedef enum enum_570 PIPE_ATTRIBUTE_TYPE;

typedef BOOL (* ENUMRESTYPEPROCW)(HMODULE, LPWSTR, LONG_PTR);

typedef struct _STARTUPINFOW _STARTUPINFOW, *P_STARTUPINFOW;

typedef struct _STARTUPINFOW * LPSTARTUPINFOW;

struct _STARTUPINFOW {
    DWORD cb;
    LPWSTR lpReserved;
    LPWSTR lpDesktop;
    LPWSTR lpTitle;
    DWORD dwX;
    DWORD dwY;
    DWORD dwXSize;
    DWORD dwYSize;
    DWORD dwXCountChars;
    DWORD dwYCountChars;
    DWORD dwFillAttribute;
    DWORD dwFlags;
    WORD wShowWindow;
    WORD cbReserved2;
    LPBYTE lpReserved2;
    HANDLE hStdInput;
    HANDLE hStdOutput;
    HANDLE hStdError;
};

typedef struct _SYSTEM_POWER_STATUS * LPSYSTEM_POWER_STATUS;

typedef PRTL_RUN_ONCE PINIT_ONCE;

typedef BOOL (* PINIT_ONCE_FN)(PINIT_ONCE, PVOID, PVOID *);

typedef struct _TIME_DYNAMIC_ZONE_INFORMATION DYNAMIC_TIME_ZONE_INFORMATION;

typedef enum _COMPUTER_NAME_FORMAT {
    ComputerNameNetBIOS=0,
    ComputerNameDnsHostname=1,
    ComputerNameDnsDomain=2,
    ComputerNameDnsFullyQualified=3,
    ComputerNamePhysicalNetBIOS=4,
    ComputerNamePhysicalDnsHostname=5,
    ComputerNamePhysicalDnsDomain=6,
    ComputerNamePhysicalDnsFullyQualified=7,
    ComputerNameMax=8
} _COMPUTER_NAME_FORMAT;

typedef struct _OVERLAPPED * LPOVERLAPPED;

typedef enum _MEMORY_RESOURCE_NOTIFICATION_TYPE {
    LowMemoryResourceNotification=0,
    HighMemoryResourceNotification=1
} _MEMORY_RESOURCE_NOTIFICATION_TYPE;

typedef struct _STARTUPINFOA * LPSTARTUPINFOA;

typedef struct _RTL_CONDITION_VARIABLE _RTL_CONDITION_VARIABLE, *P_RTL_CONDITION_VARIABLE;

typedef struct _RTL_CONDITION_VARIABLE RTL_CONDITION_VARIABLE;

typedef RTL_CONDITION_VARIABLE * PCONDITION_VARIABLE;

struct _RTL_CONDITION_VARIABLE {
    PVOID Ptr;
};

typedef struct _RTL_SRWLOCK _RTL_SRWLOCK, *P_RTL_SRWLOCK;

typedef struct _RTL_SRWLOCK RTL_SRWLOCK;

typedef RTL_SRWLOCK * PSRWLOCK;

struct _RTL_SRWLOCK {
    PVOID Ptr;
};

typedef BOOL (* ENUMRESLANGPROCW)(HMODULE, LPCWSTR, LPCWSTR, WORD, LONG_PTR);

typedef void (* LPOVERLAPPED_COMPLETION_ROUTINE)(DWORD, DWORD, LPOVERLAPPED);

typedef void (* PTIMERAPCROUTINE)(LPVOID, DWORD, DWORD);

typedef struct _SYSTEMTIME * LPSYSTEMTIME;

typedef struct _RTL_CRITICAL_SECTION _RTL_CRITICAL_SECTION, *P_RTL_CRITICAL_SECTION;

typedef struct _RTL_CRITICAL_SECTION * PRTL_CRITICAL_SECTION;

typedef PRTL_CRITICAL_SECTION PCRITICAL_SECTION;

typedef struct _RTL_CRITICAL_SECTION_DEBUG _RTL_CRITICAL_SECTION_DEBUG, *P_RTL_CRITICAL_SECTION_DEBUG;

typedef struct _RTL_CRITICAL_SECTION_DEBUG * PRTL_CRITICAL_SECTION_DEBUG;

typedef struct _LIST_ENTRY _LIST_ENTRY, *P_LIST_ENTRY;

typedef struct _LIST_ENTRY LIST_ENTRY;

struct _RTL_CRITICAL_SECTION {
    PRTL_CRITICAL_SECTION_DEBUG DebugInfo;
    LONG LockCount;
    LONG RecursionCount;
    HANDLE OwningThread;
    HANDLE LockSemaphore;
    ULONG_PTR SpinCount;
};

struct _LIST_ENTRY {
    struct _LIST_ENTRY * Flink;
    struct _LIST_ENTRY * Blink;
};

struct _RTL_CRITICAL_SECTION_DEBUG {
    WORD Type;
    WORD CreatorBackTraceIndex;
    struct _RTL_CRITICAL_SECTION * CriticalSection;
    LIST_ENTRY ProcessLocksList;
    DWORD EntryCount;
    DWORD ContentionCount;
    DWORD Flags;
    WORD CreatorBackTraceIndexHigh;
    WORD SpareWORD;
};

typedef struct _COMMCONFIG _COMMCONFIG, *P_COMMCONFIG;

typedef struct _COMMCONFIG * LPCOMMCONFIG;

typedef struct _DCB DCB;

struct _COMMCONFIG {
    DWORD dwSize;
    WORD wVersion;
    WORD wReserved;
    DCB dcb;
    DWORD dwProviderSubType;
    DWORD dwProviderOffset;
    DWORD dwProviderSize;
    WCHAR wcProviderData[1];
};

typedef enum _STREAM_INFO_LEVELS STREAM_INFO_LEVELS;

typedef DWORD (* LPPROGRESS_ROUTINE)(LARGE_INTEGER, LARGE_INTEGER, LARGE_INTEGER, LARGE_INTEGER, DWORD, DWORD, HANDLE, HANDLE, LPVOID);

typedef BOOL (* ENUMRESLANGPROCA)(HMODULE, LPCSTR, LPCSTR, WORD, LONG_PTR);

typedef struct _OFSTRUCT _OFSTRUCT, *P_OFSTRUCT;

struct _OFSTRUCT {
    BYTE cBytes;
    BYTE fFixedDisk;
    WORD nErrCode;
    WORD Reserved1;
    WORD Reserved2;
    CHAR szPathName[128];
};

typedef ACTCTXW * PCACTCTXW;

typedef struct _OVERLAPPED_ENTRY _OVERLAPPED_ENTRY, *P_OVERLAPPED_ENTRY;

struct _OVERLAPPED_ENTRY {
    ULONG_PTR lpCompletionKey;
    LPOVERLAPPED lpOverlapped;
    ULONG_PTR Internal;
    DWORD dwNumberOfBytesTransferred;
};

typedef struct _BY_HANDLE_FILE_INFORMATION _BY_HANDLE_FILE_INFORMATION, *P_BY_HANDLE_FILE_INFORMATION;

struct _BY_HANDLE_FILE_INFORMATION {
    DWORD dwFileAttributes;
    FILETIME ftCreationTime;
    FILETIME ftLastAccessTime;
    FILETIME ftLastWriteTime;
    DWORD dwVolumeSerialNumber;
    DWORD nFileSizeHigh;
    DWORD nFileSizeLow;
    DWORD nNumberOfLinks;
    DWORD nFileIndexHigh;
    DWORD nFileIndexLow;
};

typedef DWORD (* APPLICATION_RECOVERY_CALLBACK)(PVOID);

typedef enum _GET_FILEEX_INFO_LEVELS {
    GetFileExInfoStandard=0,
    GetFileExMaxInfoLevel=1
} _GET_FILEEX_INFO_LEVELS;

typedef struct _COMMTIMEOUTS * LPCOMMTIMEOUTS;

typedef enum _GET_FILEEX_INFO_LEVELS GET_FILEEX_INFO_LEVELS;

typedef struct _PROCESS_INFORMATION _PROCESS_INFORMATION, *P_PROCESS_INFORMATION;

typedef struct _PROCESS_INFORMATION * LPPROCESS_INFORMATION;

struct _PROCESS_INFORMATION {
    HANDLE hProcess;
    HANDLE hThread;
    DWORD dwProcessId;
    DWORD dwThreadId;
};

typedef struct _TP_CALLBACK_INSTANCE _TP_CALLBACK_INSTANCE, *P_TP_CALLBACK_INSTANCE;

typedef struct _TP_CALLBACK_INSTANCE * PTP_CALLBACK_INSTANCE;

typedef struct _TP_IO _TP_IO, *P_TP_IO;

typedef struct _TP_IO * PTP_IO;

typedef void (* PTP_WIN32_IO_CALLBACK)(PTP_CALLBACK_INSTANCE, PVOID, PVOID, ULONG, ULONG_PTR, PTP_IO);

struct _TP_CALLBACK_INSTANCE {
};

struct _TP_IO {
};

typedef struct _LDT_ENTRY _LDT_ENTRY, *P_LDT_ENTRY;

typedef struct _LDT_ENTRY * PLDT_ENTRY;

typedef PLDT_ENTRY LPLDT_ENTRY;

typedef union _union_54 _union_54, *P_union_54;

typedef struct _struct_55 _struct_55, *P_struct_55;

typedef struct _struct_56 _struct_56, *P_struct_56;

struct _struct_56 {
    DWORD BaseMid:8;
    DWORD Type:5;
    DWORD Dpl:2;
    DWORD Pres:1;
    DWORD LimitHi:4;
    DWORD Sys:1;
    DWORD Reserved_0:1;
    DWORD Default_Big:1;
    DWORD Granularity:1;
    DWORD BaseHi:8;
};

struct _struct_55 {
    BYTE BaseMid;
    BYTE Flags1;
    BYTE Flags2;
    BYTE BaseHi;
};

union _union_54 {
    struct _struct_55 Bytes;
    struct _struct_56 Bits;
};

struct _LDT_ENTRY {
    WORD LimitLow;
    WORD BaseLow;
    union _union_54 HighWord;
};

typedef struct _CONTEXT _CONTEXT, *P_CONTEXT;

typedef struct _CONTEXT CONTEXT;

typedef CONTEXT * PCONTEXT;

typedef PCONTEXT LPCONTEXT;

typedef struct _FLOATING_SAVE_AREA _FLOATING_SAVE_AREA, *P_FLOATING_SAVE_AREA;

typedef struct _FLOATING_SAVE_AREA FLOATING_SAVE_AREA;

struct _FLOATING_SAVE_AREA {
    DWORD ControlWord;
    DWORD StatusWord;
    DWORD TagWord;
    DWORD ErrorOffset;
    DWORD ErrorSelector;
    DWORD DataOffset;
    DWORD DataSelector;
    BYTE RegisterArea[80];
    DWORD Cr0NpxState;
};

struct _CONTEXT {
    DWORD ContextFlags;
    DWORD Dr0;
    DWORD Dr1;
    DWORD Dr2;
    DWORD Dr3;
    DWORD Dr6;
    DWORD Dr7;
    FLOATING_SAVE_AREA FloatSave;
    DWORD SegGs;
    DWORD SegFs;
    DWORD SegEs;
    DWORD SegDs;
    DWORD Edi;
    DWORD Esi;
    DWORD Ebx;
    DWORD Edx;
    DWORD Ecx;
    DWORD Eax;
    DWORD Ebp;
    DWORD Eip;
    DWORD SegCs;
    DWORD EFlags;
    DWORD Esp;
    DWORD SegSs;
    BYTE ExtendedRegisters[512];
};

typedef struct _EXCEPTION_POINTERS _EXCEPTION_POINTERS, *P_EXCEPTION_POINTERS;

typedef LONG (* PTOP_LEVEL_EXCEPTION_FILTER)(struct _EXCEPTION_POINTERS *);

typedef PTOP_LEVEL_EXCEPTION_FILTER LPTOP_LEVEL_EXCEPTION_FILTER;

typedef EXCEPTION_RECORD * PEXCEPTION_RECORD;

struct _EXCEPTION_POINTERS {
    PEXCEPTION_RECORD ExceptionRecord;
    PCONTEXT ContextRecord;
};

typedef struct _TIME_ZONE_INFORMATION * LPTIME_ZONE_INFORMATION;

typedef struct _DCB * LPDCB;

typedef PFIBER_START_ROUTINE LPFIBER_START_ROUTINE;

typedef enum _FILE_INFO_BY_HANDLE_CLASS FILE_INFO_BY_HANDLE_CLASS;

typedef struct _OVERLAPPED_ENTRY * LPOVERLAPPED_ENTRY;

typedef void (* WAITORTIMERCALLBACKFUNC)(PVOID, BOOLEAN);

typedef WAITORTIMERCALLBACKFUNC WAITORTIMERCALLBACK;

typedef struct _MEMORYSTATUSEX * LPMEMORYSTATUSEX;

typedef enum _FINDEX_SEARCH_OPS FINDEX_SEARCH_OPS;

typedef ACTCTXA * PCACTCTXA;

typedef struct _WIN32_FIND_DATAA * LPWIN32_FIND_DATAA;

typedef enum _MEMORY_RESOURCE_NOTIFICATION_TYPE MEMORY_RESOURCE_NOTIFICATION_TYPE;

typedef struct _BY_HANDLE_FILE_INFORMATION * LPBY_HANDLE_FILE_INFORMATION;

typedef PRTL_CRITICAL_SECTION LPCRITICAL_SECTION;

typedef struct _OFSTRUCT * LPOFSTRUCT;

typedef enum _COMPUTER_NAME_FORMAT COMPUTER_NAME_FORMAT;

typedef struct IRpcChannelBufferVtbl IRpcChannelBufferVtbl, *PIRpcChannelBufferVtbl;

typedef long HRESULT;

typedef struct IRpcChannelBuffer IRpcChannelBuffer, *PIRpcChannelBuffer;

typedef GUID IID;


// WARNING! conflicting data type names: /wtypes.h/ULONG - /WinDef.h/ULONG

typedef struct tagRPCOLEMESSAGE tagRPCOLEMESSAGE, *PtagRPCOLEMESSAGE;

typedef struct tagRPCOLEMESSAGE RPCOLEMESSAGE;

typedef ulong RPCOLEDATAREP;

struct tagRPCOLEMESSAGE {
    void * reserved1;
    RPCOLEDATAREP dataRepresentation;
    void * Buffer;
    ULONG cbBuffer;
    ULONG iMethod;
    void * reserved2[5];
    ULONG rpcFlags;
};

struct IRpcChannelBufferVtbl {
    HRESULT (* QueryInterface)(struct IRpcChannelBuffer *, IID *, void * *);
    ULONG (* AddRef)(struct IRpcChannelBuffer *);
    ULONG (* Release)(struct IRpcChannelBuffer *);
    HRESULT (* GetBuffer)(struct IRpcChannelBuffer *, RPCOLEMESSAGE *, IID *);
    HRESULT (* SendReceive)(struct IRpcChannelBuffer *, RPCOLEMESSAGE *, ULONG *);
    HRESULT (* FreeBuffer)(struct IRpcChannelBuffer *, RPCOLEMESSAGE *);
    HRESULT (* GetDestCtx)(struct IRpcChannelBuffer *, DWORD *, void * *);
    HRESULT (* IsConnected)(struct IRpcChannelBuffer *);
};

struct IRpcChannelBuffer {
    struct IRpcChannelBufferVtbl * lpVtbl;
};

typedef struct DotNetPdbInfo DotNetPdbInfo, *PDotNetPdbInfo;

struct DotNetPdbInfo {
    char signature[4];
    GUID guid;
    dword age;
    char pdbname[13];
};

typedef BYTE UCHAR;

typedef struct _COORD _COORD, *P_COORD;

typedef struct _COORD COORD;

typedef short SHORT;

struct _COORD {
    SHORT X;
    SHORT Y;
};

typedef struct _SMALL_RECT _SMALL_RECT, *P_SMALL_RECT;

struct _SMALL_RECT {
    SHORT Left;
    SHORT Top;
    SHORT Right;
    SHORT Bottom;
};

typedef struct _CONSOLE_FONT_INFOEX _CONSOLE_FONT_INFOEX, *P_CONSOLE_FONT_INFOEX;

struct _CONSOLE_FONT_INFOEX {
    ULONG cbSize;
    DWORD nFont;
    COORD dwFontSize;
    UINT FontFamily;
    UINT FontWeight;
    WCHAR FaceName[32];
};

typedef struct _CONSOLE_SCREEN_BUFFER_INFOEX _CONSOLE_SCREEN_BUFFER_INFOEX, *P_CONSOLE_SCREEN_BUFFER_INFOEX;

typedef struct _CONSOLE_SCREEN_BUFFER_INFOEX * PCONSOLE_SCREEN_BUFFER_INFOEX;

typedef struct _SMALL_RECT SMALL_RECT;

typedef DWORD COLORREF;

struct _CONSOLE_SCREEN_BUFFER_INFOEX {
    ULONG cbSize;
    COORD dwSize;
    COORD dwCursorPosition;
    WORD wAttributes;
    SMALL_RECT srWindow;
    COORD dwMaximumWindowSize;
    WORD wPopupAttributes;
    BOOL bFullscreenSupported;
    COLORREF ColorTable[16];
};

typedef struct _CONSOLE_SELECTION_INFO _CONSOLE_SELECTION_INFO, *P_CONSOLE_SELECTION_INFO;

typedef struct _CONSOLE_SELECTION_INFO * PCONSOLE_SELECTION_INFO;

struct _CONSOLE_SELECTION_INFO {
    DWORD dwFlags;
    COORD dwSelectionAnchor;
    SMALL_RECT srSelection;
};

typedef struct _CHAR_INFO _CHAR_INFO, *P_CHAR_INFO;

typedef struct _CHAR_INFO CHAR_INFO;

typedef union _union_963 _union_963, *P_union_963;

union _union_963 {
    WCHAR UnicodeChar;
    CHAR AsciiChar;
};

struct _CHAR_INFO {
    union _union_963 Char;
    WORD Attributes;
};

typedef struct _CONSOLE_SCREEN_BUFFER_INFO _CONSOLE_SCREEN_BUFFER_INFO, *P_CONSOLE_SCREEN_BUFFER_INFO;

struct _CONSOLE_SCREEN_BUFFER_INFO {
    COORD dwSize;
    COORD dwCursorPosition;
    WORD wAttributes;
    SMALL_RECT srWindow;
    COORD dwMaximumWindowSize;
};

typedef struct _INPUT_RECORD _INPUT_RECORD, *P_INPUT_RECORD;

typedef struct _INPUT_RECORD INPUT_RECORD;

typedef union _union_961 _union_961, *P_union_961;

typedef struct _KEY_EVENT_RECORD _KEY_EVENT_RECORD, *P_KEY_EVENT_RECORD;

typedef struct _KEY_EVENT_RECORD KEY_EVENT_RECORD;

typedef struct _MOUSE_EVENT_RECORD _MOUSE_EVENT_RECORD, *P_MOUSE_EVENT_RECORD;

typedef struct _MOUSE_EVENT_RECORD MOUSE_EVENT_RECORD;

typedef struct _WINDOW_BUFFER_SIZE_RECORD _WINDOW_BUFFER_SIZE_RECORD, *P_WINDOW_BUFFER_SIZE_RECORD;

typedef struct _WINDOW_BUFFER_SIZE_RECORD WINDOW_BUFFER_SIZE_RECORD;

typedef struct _MENU_EVENT_RECORD _MENU_EVENT_RECORD, *P_MENU_EVENT_RECORD;

typedef struct _MENU_EVENT_RECORD MENU_EVENT_RECORD;

typedef struct _FOCUS_EVENT_RECORD _FOCUS_EVENT_RECORD, *P_FOCUS_EVENT_RECORD;

typedef struct _FOCUS_EVENT_RECORD FOCUS_EVENT_RECORD;

typedef union _union_955 _union_955, *P_union_955;

union _union_955 {
    WCHAR UnicodeChar;
    CHAR AsciiChar;
};

struct _WINDOW_BUFFER_SIZE_RECORD {
    COORD dwSize;
};

struct _FOCUS_EVENT_RECORD {
    BOOL bSetFocus;
};

struct _MENU_EVENT_RECORD {
    UINT dwCommandId;
};

struct _MOUSE_EVENT_RECORD {
    COORD dwMousePosition;
    DWORD dwButtonState;
    DWORD dwControlKeyState;
    DWORD dwEventFlags;
};

struct _KEY_EVENT_RECORD {
    BOOL bKeyDown;
    WORD wRepeatCount;
    WORD wVirtualKeyCode;
    WORD wVirtualScanCode;
    union _union_955 uChar;
    DWORD dwControlKeyState;
};

union _union_961 {
    KEY_EVENT_RECORD KeyEvent;
    MOUSE_EVENT_RECORD MouseEvent;
    WINDOW_BUFFER_SIZE_RECORD WindowBufferSizeEvent;
    MENU_EVENT_RECORD MenuEvent;
    FOCUS_EVENT_RECORD FocusEvent;
};

struct _INPUT_RECORD {
    WORD EventType;
    union _union_961 Event;
};

typedef struct _CONSOLE_HISTORY_INFO _CONSOLE_HISTORY_INFO, *P_CONSOLE_HISTORY_INFO;

struct _CONSOLE_HISTORY_INFO {
    UINT cbSize;
    UINT HistoryBufferSize;
    UINT NumberOfHistoryBuffers;
    DWORD dwFlags;
};

typedef struct _CONSOLE_CURSOR_INFO _CONSOLE_CURSOR_INFO, *P_CONSOLE_CURSOR_INFO;

typedef struct _CONSOLE_CURSOR_INFO * PCONSOLE_CURSOR_INFO;

struct _CONSOLE_CURSOR_INFO {
    DWORD dwSize;
    BOOL bVisible;
};

typedef struct _CONSOLE_FONT_INFOEX * PCONSOLE_FONT_INFOEX;

typedef struct _CONSOLE_CURSOR_INFO CONSOLE_CURSOR_INFO;

typedef struct _CONSOLE_READCONSOLE_CONTROL _CONSOLE_READCONSOLE_CONTROL, *P_CONSOLE_READCONSOLE_CONTROL;

typedef struct _CONSOLE_READCONSOLE_CONTROL * PCONSOLE_READCONSOLE_CONTROL;

struct _CONSOLE_READCONSOLE_CONTROL {
    ULONG nLength;
    ULONG nInitialChars;
    ULONG dwCtrlWakeupMask;
    ULONG dwControlKeyState;
};

typedef struct _CONSOLE_FONT_INFO _CONSOLE_FONT_INFO, *P_CONSOLE_FONT_INFO;

typedef struct _CONSOLE_FONT_INFO * PCONSOLE_FONT_INFO;

struct _CONSOLE_FONT_INFO {
    DWORD nFont;
    COORD dwFontSize;
};

typedef struct _CONSOLE_SCREEN_BUFFER_INFO * PCONSOLE_SCREEN_BUFFER_INFO;

typedef struct _CONSOLE_HISTORY_INFO * PCONSOLE_HISTORY_INFO;

typedef struct _CHAR_INFO * PCHAR_INFO;

typedef struct _COORD * PCOORD;

typedef struct _INPUT_RECORD * PINPUT_RECORD;

typedef struct _SMALL_RECT * PSMALL_RECT;

typedef BOOL (* PHANDLER_ROUTINE)(DWORD);

typedef char * va_list;

typedef struct _GENERIC_BINDING_ROUTINE_PAIR _GENERIC_BINDING_ROUTINE_PAIR, *P_GENERIC_BINDING_ROUTINE_PAIR;

typedef struct _GENERIC_BINDING_ROUTINE_PAIR GENERIC_BINDING_ROUTINE_PAIR;

typedef void * (* GENERIC_BINDING_ROUTINE)(void *);

typedef void (* GENERIC_UNBIND_ROUTINE)(void *, uchar *);

struct _GENERIC_BINDING_ROUTINE_PAIR {
    GENERIC_BINDING_ROUTINE pfnBind;
    GENERIC_UNBIND_ROUTINE pfnUnbind;
};

typedef struct _NDR_ASYNC_MESSAGE _NDR_ASYNC_MESSAGE, *P_NDR_ASYNC_MESSAGE;

struct _NDR_ASYNC_MESSAGE {
};

typedef struct _MIDL_STUB_MESSAGE _MIDL_STUB_MESSAGE, *P_MIDL_STUB_MESSAGE;

typedef uint size_t;

typedef struct NDR_ALLOC_ALL_NODES_CONTEXT NDR_ALLOC_ALL_NODES_CONTEXT, *PNDR_ALLOC_ALL_NODES_CONTEXT;

typedef struct NDR_POINTER_QUEUE_STATE NDR_POINTER_QUEUE_STATE, *PNDR_POINTER_QUEUE_STATE;

typedef RPC_BINDING_HANDLE handle_t;

typedef struct _MIDL_STUB_DESC _MIDL_STUB_DESC, *P_MIDL_STUB_DESC;

typedef struct _FULL_PTR_XLAT_TABLES _FULL_PTR_XLAT_TABLES, *P_FULL_PTR_XLAT_TABLES;

typedef struct _struct_1600 _struct_1600, *P_struct_1600;

typedef struct _struct_1600 * NDR_SCONTEXT;

typedef struct ARRAY_INFO ARRAY_INFO, *PARRAY_INFO;

typedef struct _NDR_ASYNC_MESSAGE * PNDR_ASYNC_MESSAGE;

typedef struct _NDR_CORRELATION_INFO _NDR_CORRELATION_INFO, *P_NDR_CORRELATION_INFO;

typedef struct _NDR_CORRELATION_INFO * PNDR_CORRELATION_INFO;

typedef union _union_1631 _union_1631, *P_union_1631;

typedef void (* NDR_RUNDOWN)(void *);

typedef void (* EXPR_EVAL)(struct _MIDL_STUB_MESSAGE *);

typedef struct _XMIT_ROUTINE_QUINTUPLE _XMIT_ROUTINE_QUINTUPLE, *P_XMIT_ROUTINE_QUINTUPLE;

typedef struct _XMIT_ROUTINE_QUINTUPLE XMIT_ROUTINE_QUINTUPLE;

typedef struct _MALLOC_FREE_STRUCT _MALLOC_FREE_STRUCT, *P_MALLOC_FREE_STRUCT;

typedef struct _MALLOC_FREE_STRUCT MALLOC_FREE_STRUCT;

typedef struct _COMM_FAULT_OFFSETS _COMM_FAULT_OFFSETS, *P_COMM_FAULT_OFFSETS;

typedef struct _COMM_FAULT_OFFSETS COMM_FAULT_OFFSETS;

typedef struct _USER_MARSHAL_ROUTINE_QUADRUPLE _USER_MARSHAL_ROUTINE_QUADRUPLE, *P_USER_MARSHAL_ROUTINE_QUADRUPLE;

typedef struct _USER_MARSHAL_ROUTINE_QUADRUPLE USER_MARSHAL_ROUTINE_QUADRUPLE;

typedef void (* NDR_NOTIFY_ROUTINE)(void);

typedef struct _NDR_CS_ROUTINES _NDR_CS_ROUTINES, *P_NDR_CS_ROUTINES;

typedef struct _NDR_CS_ROUTINES NDR_CS_ROUTINES;

typedef struct _NDR_EXPR_DESC _NDR_EXPR_DESC, *P_NDR_EXPR_DESC;

typedef struct _NDR_EXPR_DESC NDR_EXPR_DESC;

typedef enum enum_1636 {
    XLAT_SERVER=1,
    XLAT_CLIENT=2
} enum_1636;

typedef enum enum_1636 XLAT_SIDE;

typedef struct __GENERIC_BINDING_INFO __GENERIC_BINDING_INFO, *P__GENERIC_BINDING_INFO;

typedef struct __GENERIC_BINDING_INFO * PGENERIC_BINDING_INFO;

typedef struct _MIDL_STUB_MESSAGE * PMIDL_STUB_MESSAGE;

typedef void (* XMIT_HELPER_ROUTINE)(PMIDL_STUB_MESSAGE);

typedef ulong (* USER_MARSHAL_SIZING_ROUTINE)(ulong *, ulong, void *);

typedef uchar * (* USER_MARSHAL_MARSHALLING_ROUTINE)(ulong *, uchar *, void *);

typedef uchar * (* USER_MARSHAL_UNMARSHALLING_ROUTINE)(ulong *, uchar *, void *);

typedef void (* USER_MARSHAL_FREEING_ROUTINE)(ulong *, void *);

typedef struct _NDR_CS_SIZE_CONVERT_ROUTINES _NDR_CS_SIZE_CONVERT_ROUTINES, *P_NDR_CS_SIZE_CONVERT_ROUTINES;

typedef struct _NDR_CS_SIZE_CONVERT_ROUTINES NDR_CS_SIZE_CONVERT_ROUTINES;

typedef ulong error_status_t;

typedef void (* CS_TAG_GETTING_ROUTINE)(RPC_BINDING_HANDLE, int, ulong *, ulong *, ulong *, error_status_t *);

typedef uchar * PFORMAT_STRING;

typedef enum _IDL_CS_CONVERT {
    IDL_CS_NO_CONVERT=0,
    IDL_CS_IN_PLACE_CONVERT=1,
    IDL_CS_NEW_BUFFER_CONVERT=2
} _IDL_CS_CONVERT;

typedef enum _IDL_CS_CONVERT IDL_CS_CONVERT;

typedef void (* CS_TYPE_NET_SIZE_ROUTINE)(RPC_BINDING_HANDLE, ulong, ulong, IDL_CS_CONVERT *, ulong *, error_status_t *);


// WARNING! conflicting data type names: /rpcndr.h/byte - /byte

typedef void (* CS_TYPE_TO_NETCS_ROUTINE)(RPC_BINDING_HANDLE, ulong, void *, ulong, byte *, ulong *, error_status_t *);

typedef void (* CS_TYPE_LOCAL_SIZE_ROUTINE)(RPC_BINDING_HANDLE, ulong, ulong, IDL_CS_CONVERT *, ulong *, error_status_t *);

typedef void (* CS_TYPE_FROM_NETCS_ROUTINE)(RPC_BINDING_HANDLE, ulong, byte *, ulong, ulong, void *, ulong *, error_status_t *);

struct _FULL_PTR_XLAT_TABLES {
    void * RefIdToPointer;
    void * PointerToRefId;
    ulong NextRefId;
    XLAT_SIDE XlatSide;
};

struct _NDR_EXPR_DESC {
    ushort * pOffset;
    PFORMAT_STRING pFormatExpr;
};

struct __GENERIC_BINDING_INFO {
    void * pObj;
    uint Size;
    GENERIC_BINDING_ROUTINE pfnBind;
    GENERIC_UNBIND_ROUTINE pfnUnbind;
};

struct _NDR_CS_ROUTINES {
    NDR_CS_SIZE_CONVERT_ROUTINES * pSizeConvertRoutines;
    CS_TAG_GETTING_ROUTINE * pTagGettingRoutines;
};

struct NDR_POINTER_QUEUE_STATE {
};

struct _struct_1600 {
    void * pad[2];
    void * userContext;
};

struct _MALLOC_FREE_STRUCT {
    void * (* pfnAllocate)(size_t);
    void (* pfnFree)(void *);
};

struct _MIDL_STUB_MESSAGE {
    PRPC_MESSAGE RpcMsg;
    uchar * Buffer;
    uchar * BufferStart;
    uchar * BufferEnd;
    uchar * BufferMark;
    ulong BufferLength;
    ulong MemorySize;
    uchar * Memory;
    uchar IsClient;
    uchar Pad;
    ushort uFlags2;
    int ReuseBuffer;
    struct NDR_ALLOC_ALL_NODES_CONTEXT * pAllocAllNodesContext;
    struct NDR_POINTER_QUEUE_STATE * pPointerQueueState;
    int IgnoreEmbeddedPointers;
    uchar * PointerBufferMark;
    uchar CorrDespIncrement;
    uchar uFlags;
    ushort UniquePtrCount;
    ULONG_PTR MaxCount;
    ulong Offset;
    ulong ActualCount;
    void * (* pfnAllocate)(size_t);
    void (* pfnFree)(void *);
    uchar * StackTop;
    uchar * pPresentedType;
    uchar * pTransmitType;
    handle_t SavedHandle;
    struct _MIDL_STUB_DESC * StubDesc;
    struct _FULL_PTR_XLAT_TABLES * FullPtrXlatTables;
    ulong FullPtrRefId;
    ulong PointerLength;
    int fInDontFree:1;
    int fDontCallFreeInst:1;
    int fInOnlyParam:1;
    int fHasReturn:1;
    int fHasExtensions:1;
    int fHasNewCorrDesc:1;
    int fIsIn:1;
    int fIsOut:1;
    int fIsOicf:1;
    int fBufferValid:1;
    int fHasMemoryValidateCallback:1;
    int fInFree:1;
    int fNeedMCCP:1;
    int fUnused:3;
    int fUnused2:16;
    ulong dwDestContext;
    void * pvDestContext;
    NDR_SCONTEXT * SavedContextHandles;
    long ParamNumber;
    struct IRpcChannelBuffer * pRpcChannelBuffer;
    PARRAY_INFO pArrayInfo;
    ulong * SizePtrCountArray;
    ulong * SizePtrOffsetArray;
    ulong * SizePtrLengthArray;
    void * pArgQueue;
    ulong dwStubPhase;
    void * LowStackMark;
    PNDR_ASYNC_MESSAGE pAsyncMsg;
    PNDR_CORRELATION_INFO pCorrInfo;
    uchar * pCorrMemory;
    void * pMemoryList;
};

struct _XMIT_ROUTINE_QUINTUPLE {
    XMIT_HELPER_ROUTINE pfnTranslateToXmit;
    XMIT_HELPER_ROUTINE pfnTranslateFromXmit;
    XMIT_HELPER_ROUTINE pfnFreeXmit;
    XMIT_HELPER_ROUTINE pfnFreeInst;
};

struct NDR_ALLOC_ALL_NODES_CONTEXT {
};

union _union_1631 {
    handle_t * pAutoHandle;
    handle_t * pPrimitiveHandle;
    PGENERIC_BINDING_INFO pGenericBindingInfo;
};

struct _MIDL_STUB_DESC {
    void * RpcInterfaceInformation;
    void * (* pfnAllocate)(size_t);
    void (* pfnFree)(void *);
    union _union_1631 IMPLICIT_HANDLE_INFO;
    NDR_RUNDOWN * apfnNdrRundownRoutines;
    GENERIC_BINDING_ROUTINE_PAIR * aGenericBindingRoutinePairs;
    EXPR_EVAL * apfnExprEval;
    XMIT_ROUTINE_QUINTUPLE * aXmitQuintuple;
    uchar * pFormatTypes;
    int fCheckBounds;
    ulong Version;
    MALLOC_FREE_STRUCT * pMallocFreeStruct;
    long MIDLVersion;
    COMM_FAULT_OFFSETS * CommFaultOffsets;
    USER_MARSHAL_ROUTINE_QUADRUPLE * aUserMarshalQuadruple;
    NDR_NOTIFY_ROUTINE * NotifyRoutineTable;
    ULONG_PTR mFlags;
    NDR_CS_ROUTINES * CsRoutineTables;
    void * ProxyServerInfo;
    NDR_EXPR_DESC * pExprInfo;
};

struct _NDR_CS_SIZE_CONVERT_ROUTINES {
    CS_TYPE_NET_SIZE_ROUTINE pfnNetSize;
    CS_TYPE_TO_NETCS_ROUTINE pfnToNetCs;
    CS_TYPE_LOCAL_SIZE_ROUTINE pfnLocalSize;
    CS_TYPE_FROM_NETCS_ROUTINE pfnFromNetCs;
};

struct ARRAY_INFO {
    long Dimension;
    ulong * BufferConformanceMark;
    ulong * BufferVarianceMark;
    ulong * MaxCountArray;
    ulong * OffsetArray;
    ulong * ActualCountArray;
};

struct _USER_MARSHAL_ROUTINE_QUADRUPLE {
    USER_MARSHAL_SIZING_ROUTINE pfnBufferSize;
    USER_MARSHAL_MARSHALLING_ROUTINE pfnMarshall;
    USER_MARSHAL_UNMARSHALLING_ROUTINE pfnUnmarshall;
    USER_MARSHAL_FREEING_ROUTINE pfnFree;
};

struct _NDR_CORRELATION_INFO {
};

struct _COMM_FAULT_OFFSETS {
    short CommOffset;
    short FaultOffset;
};

typedef struct _MIDL_STUB_DESC MIDL_STUB_DESC;

typedef MIDL_STUB_DESC * PMIDL_STUB_DESC;

typedef union _CLIENT_CALL_RETURN _CLIENT_CALL_RETURN, *P_CLIENT_CALL_RETURN;

union _CLIENT_CALL_RETURN {
    void * Pointer;
    LONG_PTR Simple;
};

typedef union _CLIENT_CALL_RETURN CLIENT_CALL_RETURN;

typedef ushort wint_t;

typedef int errno_t;

typedef size_t rsize_t;

typedef struct _GUID _GUID, *P_GUID;

struct _GUID {
    ulong Data1;
    ushort Data2;
    ushort Data3;
    uchar Data4[8];
};

typedef GUID * LPCGUID;

typedef void * RPC_AUTH_IDENTITY_HANDLE;

typedef struct _RPC_SECURITY_QOS _RPC_SECURITY_QOS, *P_RPC_SECURITY_QOS;

struct _RPC_SECURITY_QOS {
    ulong Version;
    ulong Capabilities;
    ulong IdentityTracking;
    ulong ImpersonationType;
};

typedef struct _RPC_SECURITY_QOS RPC_SECURITY_QOS;

typedef ushort * RPC_WSTR;

typedef long RPC_STATUS;

typedef enum _WER_REGISTER_FILE_TYPE {
    WerRegFileTypeUserDocument=1,
    WerRegFileTypeOther=2,
    WerRegFileTypeMax=3
} _WER_REGISTER_FILE_TYPE;

typedef enum _WER_REGISTER_FILE_TYPE WER_REGISTER_FILE_TYPE;

typedef struct _ACTIVATION_CONTEXT _ACTIVATION_CONTEXT, *P_ACTIVATION_CONTEXT;

struct _ACTIVATION_CONTEXT {
};

typedef struct _PROCESSOR_NUMBER _PROCESSOR_NUMBER, *P_PROCESSOR_NUMBER;

struct _PROCESSOR_NUMBER {
    WORD Group;
    BYTE Number;
    BYTE Reserved;
};

typedef struct _SYSTEM_LOGICAL_PROCESSOR_INFORMATION _SYSTEM_LOGICAL_PROCESSOR_INFORMATION, *P_SYSTEM_LOGICAL_PROCESSOR_INFORMATION;

typedef struct _SYSTEM_LOGICAL_PROCESSOR_INFORMATION * PSYSTEM_LOGICAL_PROCESSOR_INFORMATION;

typedef enum _LOGICAL_PROCESSOR_RELATIONSHIP {
    RelationProcessorCore=0,
    RelationNumaNode=1,
    RelationCache=2,
    RelationProcessorPackage=3,
    RelationGroup=4,
    RelationAll=65535
} _LOGICAL_PROCESSOR_RELATIONSHIP;

typedef enum _LOGICAL_PROCESSOR_RELATIONSHIP LOGICAL_PROCESSOR_RELATIONSHIP;

typedef union _union_148 _union_148, *P_union_148;

typedef struct _struct_149 _struct_149, *P_struct_149;

typedef struct _struct_150 _struct_150, *P_struct_150;

typedef struct _CACHE_DESCRIPTOR _CACHE_DESCRIPTOR, *P_CACHE_DESCRIPTOR;

typedef struct _CACHE_DESCRIPTOR CACHE_DESCRIPTOR;

typedef enum _PROCESSOR_CACHE_TYPE {
    CacheUnified=0,
    CacheInstruction=1,
    CacheData=2,
    CacheTrace=3
} _PROCESSOR_CACHE_TYPE;

typedef enum _PROCESSOR_CACHE_TYPE PROCESSOR_CACHE_TYPE;

struct _struct_149 {
    BYTE Flags;
};

struct _struct_150 {
    DWORD NodeNumber;
};

struct _CACHE_DESCRIPTOR {
    BYTE Level;
    BYTE Associativity;
    WORD LineSize;
    DWORD Size;
    PROCESSOR_CACHE_TYPE Type;
};

union _union_148 {
    struct _struct_149 ProcessorCore;
    struct _struct_150 NumaNode;
    CACHE_DESCRIPTOR Cache;
    ULONGLONG Reserved[2];
};

struct _SYSTEM_LOGICAL_PROCESSOR_INFORMATION {
    ULONG_PTR ProcessorMask;
    LOGICAL_PROCESSOR_RELATIONSHIP Relationship;
    union _union_148 u;
};

typedef struct _PROCESSOR_RELATIONSHIP _PROCESSOR_RELATIONSHIP, *P_PROCESSOR_RELATIONSHIP;

typedef struct _PROCESSOR_RELATIONSHIP PROCESSOR_RELATIONSHIP;

typedef struct _GROUP_AFFINITY _GROUP_AFFINITY, *P_GROUP_AFFINITY;

typedef struct _GROUP_AFFINITY GROUP_AFFINITY;

typedef ULONG_PTR KAFFINITY;

struct _GROUP_AFFINITY {
    KAFFINITY Mask;
    WORD Group;
    WORD Reserved[3];
};

struct _PROCESSOR_RELATIONSHIP {
    BYTE Flags;
    BYTE Reserved[21];
    WORD GroupCount;
    GROUP_AFFINITY GroupMask[1];
};

typedef union _ULARGE_INTEGER _ULARGE_INTEGER, *P_ULARGE_INTEGER;

typedef union _ULARGE_INTEGER ULARGE_INTEGER;

typedef struct _struct_22 _struct_22, *P_struct_22;

typedef struct _struct_23 _struct_23, *P_struct_23;

struct _struct_23 {
    DWORD LowPart;
    DWORD HighPart;
};

struct _struct_22 {
    DWORD LowPart;
    DWORD HighPart;
};

union _ULARGE_INTEGER {
    struct _struct_22 s;
    struct _struct_23 u;
    ULONGLONG QuadPart;
};

typedef PVOID PSECURITY_DESCRIPTOR;

typedef struct _TP_WORK _TP_WORK, *P_TP_WORK;

struct _TP_WORK {
};

typedef struct _TP_CLEANUP_GROUP _TP_CLEANUP_GROUP, *P_TP_CLEANUP_GROUP;

struct _TP_CLEANUP_GROUP {
};

typedef struct _LUID_AND_ATTRIBUTES _LUID_AND_ATTRIBUTES, *P_LUID_AND_ATTRIBUTES;

typedef struct _LUID_AND_ATTRIBUTES LUID_AND_ATTRIBUTES;

typedef struct _LUID _LUID, *P_LUID;

typedef struct _LUID LUID;

struct _LUID {
    DWORD LowPart;
    LONG HighPart;
};

struct _LUID_AND_ATTRIBUTES {
    LUID Luid;
    DWORD Attributes;
};

typedef struct _GENERIC_MAPPING _GENERIC_MAPPING, *P_GENERIC_MAPPING;

typedef DWORD ACCESS_MASK;

struct _GENERIC_MAPPING {
    ACCESS_MASK GenericRead;
    ACCESS_MASK GenericWrite;
    ACCESS_MASK GenericExecute;
    ACCESS_MASK GenericAll;
};

typedef struct _WOW64_CONTEXT _WOW64_CONTEXT, *P_WOW64_CONTEXT;

typedef struct _WOW64_FLOATING_SAVE_AREA _WOW64_FLOATING_SAVE_AREA, *P_WOW64_FLOATING_SAVE_AREA;

typedef struct _WOW64_FLOATING_SAVE_AREA WOW64_FLOATING_SAVE_AREA;

struct _WOW64_FLOATING_SAVE_AREA {
    DWORD ControlWord;
    DWORD StatusWord;
    DWORD TagWord;
    DWORD ErrorOffset;
    DWORD ErrorSelector;
    DWORD DataOffset;
    DWORD DataSelector;
    BYTE RegisterArea[80];
    DWORD Cr0NpxState;
};

struct _WOW64_CONTEXT {
    DWORD ContextFlags;
    DWORD Dr0;
    DWORD Dr1;
    DWORD Dr2;
    DWORD Dr3;
    DWORD Dr6;
    DWORD Dr7;
    WOW64_FLOATING_SAVE_AREA FloatSave;
    DWORD SegGs;
    DWORD SegFs;
    DWORD SegEs;
    DWORD SegDs;
    DWORD Edi;
    DWORD Esi;
    DWORD Ebx;
    DWORD Edx;
    DWORD Ecx;
    DWORD Eax;
    DWORD Ebp;
    DWORD Eip;
    DWORD SegCs;
    DWORD EFlags;
    DWORD Esp;
    DWORD SegSs;
    BYTE ExtendedRegisters[512];
};

typedef struct _TP_WAIT _TP_WAIT, *P_TP_WAIT;

struct _TP_WAIT {
};

typedef WCHAR * PCZZWSTR;

typedef struct _NUMA_NODE_RELATIONSHIP _NUMA_NODE_RELATIONSHIP, *P_NUMA_NODE_RELATIONSHIP;

typedef struct _NUMA_NODE_RELATIONSHIP NUMA_NODE_RELATIONSHIP;

struct _NUMA_NODE_RELATIONSHIP {
    DWORD NodeNumber;
    BYTE Reserved[20];
    GROUP_AFFINITY GroupMask;
};

typedef struct _WOW64_LDT_ENTRY _WOW64_LDT_ENTRY, *P_WOW64_LDT_ENTRY;

typedef union _union_60 _union_60, *P_union_60;

typedef struct _struct_61 _struct_61, *P_struct_61;

typedef struct _struct_62 _struct_62, *P_struct_62;

struct _struct_61 {
    BYTE BaseMid;
    BYTE Flags1;
    BYTE Flags2;
    BYTE BaseHi;
};

struct _struct_62 {
    DWORD BaseMid:8;
    DWORD Type:5;
    DWORD Dpl:2;
    DWORD Pres:1;
    DWORD LimitHi:4;
    DWORD Sys:1;
    DWORD Reserved_0:1;
    DWORD Default_Big:1;
    DWORD Granularity:1;
    DWORD BaseHi:8;
};

union _union_60 {
    struct _struct_61 Bytes;
    struct _struct_62 Bits;
};

struct _WOW64_LDT_ENTRY {
    WORD LimitLow;
    WORD BaseLow;
    union _union_60 HighWord;
};

typedef union _union_381 _union_381, *P_union_381;

typedef struct _struct_382 _struct_382, *P_struct_382;

struct _struct_382 {
    DWORD LongFunction:1;
    DWORD Persistent:1;
    DWORD Private:30;
};

union _union_381 {
    DWORD Flags;
    struct _struct_382 s;
};

typedef struct _PROCESSOR_NUMBER * PPROCESSOR_NUMBER;

typedef BOOLEAN (* PSECURE_MEMORY_CACHE_CALLBACK)(PVOID, SIZE_T);

typedef struct _HARDWARE_COUNTER_DATA _HARDWARE_COUNTER_DATA, *P_HARDWARE_COUNTER_DATA;

typedef enum _HARDWARE_COUNTER_TYPE {
    PMCCounter=0,
    MaxHardwareCounterType=1
} _HARDWARE_COUNTER_TYPE;

typedef enum _HARDWARE_COUNTER_TYPE HARDWARE_COUNTER_TYPE;

typedef ulonglong DWORD64;

struct _HARDWARE_COUNTER_DATA {
    HARDWARE_COUNTER_TYPE Type;
    DWORD Reserved;
    DWORD64 Value;
};

typedef struct _SID_IDENTIFIER_AUTHORITY _SID_IDENTIFIER_AUTHORITY, *P_SID_IDENTIFIER_AUTHORITY;

typedef struct _SID_IDENTIFIER_AUTHORITY * PSID_IDENTIFIER_AUTHORITY;

struct _SID_IDENTIFIER_AUTHORITY {
    BYTE Value[6];
};

typedef struct _TP_WORK * PTP_WORK;

typedef void (* PTP_WORK_CALLBACK)(PTP_CALLBACK_INSTANCE, PVOID, PTP_WORK);

typedef DWORD TP_VERSION;

typedef WCHAR * PWSTR;

typedef struct _OSVERSIONINFOEXA _OSVERSIONINFOEXA, *P_OSVERSIONINFOEXA;

struct _OSVERSIONINFOEXA {
    DWORD dwOSVersionInfoSize;
    DWORD dwMajorVersion;
    DWORD dwMinorVersion;
    DWORD dwBuildNumber;
    DWORD dwPlatformId;
    CHAR szCSDVersion[128];
    WORD wServicePackMajor;
    WORD wServicePackMinor;
    WORD wSuiteMask;
    BYTE wProductType;
    BYTE wReserved;
};

typedef enum _HEAP_INFORMATION_CLASS {
    HeapCompatibilityInformation=0,
    HeapEnableTerminationOnCorruption=1
} _HEAP_INFORMATION_CLASS;

typedef struct _OSVERSIONINFOW _OSVERSIONINFOW, *P_OSVERSIONINFOW;

typedef struct _OSVERSIONINFOW * LPOSVERSIONINFOW;

struct _OSVERSIONINFOW {
    DWORD dwOSVersionInfoSize;
    DWORD dwMajorVersion;
    DWORD dwMinorVersion;
    DWORD dwBuildNumber;
    DWORD dwPlatformId;
    WCHAR szCSDVersion[128];
};

typedef enum _SECURITY_IMPERSONATION_LEVEL {
    SecurityAnonymous=0,
    SecurityIdentification=1,
    SecurityImpersonation=2,
    SecurityDelegation=3
} _SECURITY_IMPERSONATION_LEVEL;

typedef enum _SECURITY_IMPERSONATION_LEVEL SECURITY_IMPERSONATION_LEVEL;

typedef LONG * PLONG;

typedef ULARGE_INTEGER * PULARGE_INTEGER;

typedef struct _SINGLE_LIST_ENTRY _SINGLE_LIST_ENTRY, *P_SINGLE_LIST_ENTRY;

struct _SINGLE_LIST_ENTRY {
    struct _SINGLE_LIST_ENTRY * Next;
};

typedef struct _TP_POOL _TP_POOL, *P_TP_POOL;

struct _TP_POOL {
};

typedef struct _OSVERSIONINFOA _OSVERSIONINFOA, *P_OSVERSIONINFOA;

typedef struct _OSVERSIONINFOA * LPOSVERSIONINFOA;

struct _OSVERSIONINFOA {
    DWORD dwOSVersionInfoSize;
    DWORD dwMajorVersion;
    DWORD dwMinorVersion;
    DWORD dwBuildNumber;
    DWORD dwPlatformId;
    CHAR szCSDVersion[128];
};

typedef DWORD EXECUTION_STATE;

typedef struct _TP_POOL * PTP_POOL;

typedef struct _TP_CALLBACK_ENVIRON_V3 _TP_CALLBACK_ENVIRON_V3, *P_TP_CALLBACK_ENVIRON_V3;

typedef struct _TP_CALLBACK_ENVIRON_V3 TP_CALLBACK_ENVIRON_V3;

typedef struct _TP_CLEANUP_GROUP * PTP_CLEANUP_GROUP;

typedef void (* PTP_CLEANUP_GROUP_CANCEL_CALLBACK)(PVOID, PVOID);

typedef void (* PTP_SIMPLE_CALLBACK)(PTP_CALLBACK_INSTANCE, PVOID);

typedef enum _TP_CALLBACK_PRIORITY {
    TP_CALLBACK_PRIORITY_HIGH=0,
    TP_CALLBACK_PRIORITY_NORMAL=1,
    TP_CALLBACK_PRIORITY_LOW=2,
    TP_CALLBACK_PRIORITY_INVALID=3
} _TP_CALLBACK_PRIORITY;

typedef enum _TP_CALLBACK_PRIORITY TP_CALLBACK_PRIORITY;

struct _TP_CALLBACK_ENVIRON_V3 {
    TP_VERSION Version;
    PTP_POOL Pool;
    PTP_CLEANUP_GROUP CleanupGroup;
    PTP_CLEANUP_GROUP_CANCEL_CALLBACK CleanupGroupCancelCallback;
    PVOID RaceDll;
    struct _ACTIVATION_CONTEXT * ActivationContext;
    PTP_SIMPLE_CALLBACK FinalizationCallback;
    union _union_381 u;
    TP_CALLBACK_PRIORITY CallbackPriority;
    DWORD Size;
};

typedef PVOID PSID;

typedef struct _OSVERSIONINFOEXW _OSVERSIONINFOEXW, *P_OSVERSIONINFOEXW;

struct _OSVERSIONINFOEXW {
    DWORD dwOSVersionInfoSize;
    DWORD dwMajorVersion;
    DWORD dwMinorVersion;
    DWORD dwBuildNumber;
    DWORD dwPlatformId;
    WCHAR szCSDVersion[128];
    WORD wServicePackMajor;
    WORD wServicePackMinor;
    WORD wSuiteMask;
    BYTE wProductType;
    BYTE wReserved;
};

typedef void * PVOID64;

typedef WCHAR * PCWSTR;

typedef union _FILE_SEGMENT_ELEMENT _FILE_SEGMENT_ELEMENT, *P_FILE_SEGMENT_ELEMENT;

typedef union _FILE_SEGMENT_ELEMENT FILE_SEGMENT_ELEMENT;

union _FILE_SEGMENT_ELEMENT {
    PVOID64 Buffer;
    ULONGLONG Alignment;
};

typedef DWORD SECURITY_INFORMATION;

typedef union _SLIST_HEADER _SLIST_HEADER, *P_SLIST_HEADER;

typedef struct _struct_299 _struct_299, *P_struct_299;

typedef struct _SINGLE_LIST_ENTRY SINGLE_LIST_ENTRY;

struct _struct_299 {
    SINGLE_LIST_ENTRY Next;
    WORD Depth;
    WORD Sequence;
};

union _SLIST_HEADER {
    ULONGLONG Alignment;
    struct _struct_299 s;
};

typedef struct _SYSTEM_PROCESSOR_CYCLE_TIME_INFORMATION _SYSTEM_PROCESSOR_CYCLE_TIME_INFORMATION, *P_SYSTEM_PROCESSOR_CYCLE_TIME_INFORMATION;

struct _SYSTEM_PROCESSOR_CYCLE_TIME_INFORMATION {
    DWORD64 CycleTime;
};

typedef struct _WOW64_CONTEXT WOW64_CONTEXT;

typedef WOW64_CONTEXT * PWOW64_CONTEXT;

typedef WCHAR * LPWCH;

typedef WCHAR * PWCHAR;

typedef struct _GROUP_AFFINITY * PGROUP_AFFINITY;

typedef BOOLEAN * PBOOLEAN;

typedef struct _CACHE_RELATIONSHIP _CACHE_RELATIONSHIP, *P_CACHE_RELATIONSHIP;

struct _CACHE_RELATIONSHIP {
    BYTE Level;
    BYTE Associativity;
    WORD LineSize;
    DWORD CacheSize;
    PROCESSOR_CACHE_TYPE Type;
    BYTE Reserved[20];
    GROUP_AFFINITY GroupMask;
};

typedef CHAR * LPCH;

typedef struct _HARDWARE_COUNTER_DATA HARDWARE_COUNTER_DATA;

typedef enum _TOKEN_INFORMATION_CLASS {
    TokenUser=1,
    TokenGroups=2,
    TokenPrivileges=3,
    TokenOwner=4,
    TokenPrimaryGroup=5,
    TokenDefaultDacl=6,
    TokenSource=7,
    TokenType=8,
    TokenImpersonationLevel=9,
    TokenStatistics=10,
    TokenRestrictedSids=11,
    TokenSessionId=12,
    TokenGroupsAndPrivileges=13,
    TokenSessionReference=14,
    TokenSandBoxInert=15,
    TokenAuditPolicy=16,
    TokenOrigin=17,
    TokenElevationType=18,
    TokenLinkedToken=19,
    TokenElevation=20,
    TokenHasRestrictions=21,
    TokenAccessInformation=22,
    TokenVirtualizationAllowed=23,
    TokenVirtualizationEnabled=24,
    TokenIntegrityLevel=25,
    TokenUIAccess=26,
    TokenMandatoryPolicy=27,
    TokenLogonSid=28,
    MaxTokenInfoClass=29
} _TOKEN_INFORMATION_CLASS;

typedef enum _JOBOBJECTINFOCLASS {
    JobObjectBasicAccountingInformation=1,
    JobObjectBasicLimitInformation=2,
    JobObjectBasicProcessIdList=3,
    JobObjectBasicUIRestrictions=4,
    JobObjectSecurityLimitInformation=5,
    JobObjectEndOfJobTimeInformation=6,
    JobObjectAssociateCompletionPortInformation=7,
    JobObjectBasicAndIoAccountingInformation=8,
    JobObjectExtendedLimitInformation=9,
    JobObjectJobSetInformation=10,
    JobObjectGroupInformation=11,
    MaxJobObjectInfoClass=12
} _JOBOBJECTINFOCLASS;

typedef struct _TP_WAIT * PTP_WAIT;

typedef struct _PERFORMANCE_DATA _PERFORMANCE_DATA, *P_PERFORMANCE_DATA;

typedef struct _PERFORMANCE_DATA * PPERFORMANCE_DATA;

struct _PERFORMANCE_DATA {
    WORD Size;
    BYTE Version;
    BYTE HwCountersCount;
    DWORD ContextSwitchCount;
    DWORD64 WaitReasonBitMap;
    DWORD64 CycleTime;
    DWORD RetryCount;
    DWORD Reserved;
    HARDWARE_COUNTER_DATA HwCounters[16];
};

typedef enum _POWER_REQUEST_TYPE {
    PowerRequestDisplayRequired=0,
    PowerRequestSystemRequired=1,
    PowerRequestAwayModeRequired=2
} _POWER_REQUEST_TYPE;

typedef struct _SYSTEM_PROCESSOR_CYCLE_TIME_INFORMATION * PSYSTEM_PROCESSOR_CYCLE_TIME_INFORMATION;

typedef struct _GENERIC_MAPPING GENERIC_MAPPING;

typedef HANDLE * PHANDLE;

typedef union _union_157 _union_157, *P_union_157;

typedef struct _CACHE_RELATIONSHIP CACHE_RELATIONSHIP;

typedef struct _GROUP_RELATIONSHIP _GROUP_RELATIONSHIP, *P_GROUP_RELATIONSHIP;

typedef struct _GROUP_RELATIONSHIP GROUP_RELATIONSHIP;

typedef struct _PROCESSOR_GROUP_INFO _PROCESSOR_GROUP_INFO, *P_PROCESSOR_GROUP_INFO;

typedef struct _PROCESSOR_GROUP_INFO PROCESSOR_GROUP_INFO;

struct _PROCESSOR_GROUP_INFO {
    BYTE MaximumProcessorCount;
    BYTE ActiveProcessorCount;
    BYTE Reserved[38];
    KAFFINITY ActiveProcessorMask;
};

struct _GROUP_RELATIONSHIP {
    WORD MaximumGroupCount;
    WORD ActiveGroupCount;
    BYTE Reserved[20];
    PROCESSOR_GROUP_INFO GroupInfo[1];
};

union _union_157 {
    PROCESSOR_RELATIONSHIP Processor;
    NUMA_NODE_RELATIONSHIP NumaNode;
    CACHE_RELATIONSHIP Cache;
    GROUP_RELATIONSHIP Group;
};

typedef struct _PRIVILEGE_SET _PRIVILEGE_SET, *P_PRIVILEGE_SET;

struct _PRIVILEGE_SET {
    DWORD PrivilegeCount;
    DWORD Control;
    LUID_AND_ATTRIBUTES Privilege[1];
};

typedef DWORD TP_WAIT_RESULT;

typedef void (* PTP_WAIT_CALLBACK)(PTP_CALLBACK_INSTANCE, PVOID, PTP_WAIT, TP_WAIT_RESULT);

typedef struct _TP_TIMER _TP_TIMER, *P_TP_TIMER;

struct _TP_TIMER {
};

typedef struct _SYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX _SYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX, *P_SYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX;

struct _SYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX {
    LOGICAL_PROCESSOR_RELATIONSHIP Relationship;
    DWORD Size;
    union _union_157 u;
};

typedef WCHAR * PCNZWCH;

typedef struct _TP_TIMER * PTP_TIMER;

typedef void (* PTP_TIMER_CALLBACK)(PTP_CALLBACK_INSTANCE, PVOID, PTP_TIMER);

typedef struct _SYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX * PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX;

typedef void (* PAPCFUNC)(ULONG_PTR);

typedef struct _TP_POOL_STACK_INFORMATION _TP_POOL_STACK_INFORMATION, *P_TP_POOL_STACK_INFORMATION;

struct _TP_POOL_STACK_INFORMATION {
    SIZE_T StackReserve;
    SIZE_T StackCommit;
};

typedef ULONGLONG * PULONGLONG;

typedef struct _MEMORY_BASIC_INFORMATION _MEMORY_BASIC_INFORMATION, *P_MEMORY_BASIC_INFORMATION;

typedef struct _MEMORY_BASIC_INFORMATION * PMEMORY_BASIC_INFORMATION;

struct _MEMORY_BASIC_INFORMATION {
    PVOID BaseAddress;
    PVOID AllocationBase;
    DWORD AllocationProtect;
    SIZE_T RegionSize;
    DWORD State;
    DWORD Protect;
    DWORD Type;
};

typedef struct _SINGLE_LIST_ENTRY * PSINGLE_LIST_ENTRY;

typedef WCHAR * PZZWSTR;

typedef struct _IO_COUNTERS _IO_COUNTERS, *P_IO_COUNTERS;

typedef struct _IO_COUNTERS IO_COUNTERS;

struct _IO_COUNTERS {
    ULONGLONG ReadOperationCount;
    ULONGLONG WriteOperationCount;
    ULONGLONG OtherOperationCount;
    ULONGLONG ReadTransferCount;
    ULONGLONG WriteTransferCount;
    ULONGLONG OtherTransferCount;
};

typedef enum _JOBOBJECTINFOCLASS JOBOBJECTINFOCLASS;

typedef TP_CALLBACK_ENVIRON_V3 * PTP_CALLBACK_ENVIRON;

typedef enum _TOKEN_INFORMATION_CLASS TOKEN_INFORMATION_CLASS;

typedef struct _JOB_SET_ARRAY _JOB_SET_ARRAY, *P_JOB_SET_ARRAY;

struct _JOB_SET_ARRAY {
    HANDLE JobHandle;
    DWORD MemberLevel;
    DWORD Flags;
};

typedef struct _OSVERSIONINFOEXW * LPOSVERSIONINFOEXW;

typedef struct _WOW64_LDT_ENTRY * PWOW64_LDT_ENTRY;

typedef enum _HEAP_INFORMATION_CLASS HEAP_INFORMATION_CLASS;

typedef CHAR * LPCCH;

typedef GENERIC_MAPPING * PGENERIC_MAPPING;

typedef union _SLIST_HEADER * PSLIST_HEADER;

typedef void (* PFLS_CALLBACK_FUNCTION)(PVOID);

typedef struct _PRIVILEGE_SET * PPRIVILEGE_SET;

typedef enum _POWER_REQUEST_TYPE POWER_REQUEST_TYPE;

typedef LARGE_INTEGER * PLARGE_INTEGER;

typedef struct _TP_POOL_STACK_INFORMATION * PTP_POOL_STACK_INFORMATION;

typedef IO_COUNTERS * PIO_COUNTERS;

typedef CHAR * PSTR;

typedef struct _OSVERSIONINFOEXA * LPOSVERSIONINFOEXA;

typedef struct _JOB_SET_ARRAY * PJOB_SET_ARRAY;

typedef enum enum_75 {
    WinNullSid=0,
    WinWorldSid=1,
    WinLocalSid=2,
    WinCreatorOwnerSid=3,
    WinCreatorGroupSid=4,
    WinCreatorOwnerServerSid=5,
    WinCreatorGroupServerSid=6,
    WinNtAuthoritySid=7,
    WinDialupSid=8,
    WinNetworkSid=9,
    WinBatchSid=10,
    WinInteractiveSid=11,
    WinServiceSid=12,
    WinAnonymousSid=13,
    WinProxySid=14,
    WinEnterpriseControllersSid=15,
    WinSelfSid=16,
    WinAuthenticatedUserSid=17,
    WinRestrictedCodeSid=18,
    WinTerminalServerSid=19,
    WinRemoteLogonIdSid=20,
    WinLogonIdsSid=21,
    WinLocalSystemSid=22,
    WinLocalServiceSid=23,
    WinNetworkServiceSid=24,
    WinBuiltinDomainSid=25,
    WinBuiltinAdministratorsSid=26,
    WinBuiltinUsersSid=27,
    WinBuiltinGuestsSid=28,
    WinBuiltinPowerUsersSid=29,
    WinBuiltinAccountOperatorsSid=30,
    WinBuiltinSystemOperatorsSid=31,
    WinBuiltinPrintOperatorsSid=32,
    WinBuiltinBackupOperatorsSid=33,
    WinBuiltinReplicatorSid=34,
    WinBuiltinPreWindows2000CompatibleAccessSid=35,
    WinBuiltinRemoteDesktopUsersSid=36,
    WinBuiltinNetworkConfigurationOperatorsSid=37,
    WinAccountAdministratorSid=38,
    WinAccountGuestSid=39,
    WinAccountKrbtgtSid=40,
    WinAccountDomainAdminsSid=41,
    WinAccountDomainUsersSid=42,
    WinAccountDomainGuestsSid=43,
    WinAccountComputersSid=44,
    WinAccountControllersSid=45,
    WinAccountCertAdminsSid=46,
    WinAccountSchemaAdminsSid=47,
    WinAccountEnterpriseAdminsSid=48,
    WinAccountPolicyAdminsSid=49,
    WinAccountRasAndIasServersSid=50,
    WinNTLMAuthenticationSid=51,
    WinDigestAuthenticationSid=52,
    WinSChannelAuthenticationSid=53,
    WinThisOrganizationSid=54,
    WinOtherOrganizationSid=55,
    WinBuiltinIncomingForestTrustBuildersSid=56,
    WinBuiltinPerfMonitoringUsersSid=57,
    WinBuiltinPerfLoggingUsersSid=58,
    WinBuiltinAuthorizationAccessSid=59,
    WinBuiltinTerminalServerLicenseServersSid=60,
    WinBuiltinDCOMUsersSid=61,
    WinBuiltinIUsersSid=62,
    WinIUserSid=63,
    WinBuiltinCryptoOperatorsSid=64,
    WinUntrustedLabelSid=65,
    WinLowLabelSid=66,
    WinMediumLabelSid=67,
    WinHighLabelSid=68,
    WinSystemLabelSid=69,
    WinWriteRestrictedCodeSid=70,
    WinCreatorOwnerRightsSid=71,
    WinCacheablePrincipalsGroupSid=72,
    WinNonCacheablePrincipalsGroupSid=73,
    WinEnterpriseReadonlyControllersSid=74,
    WinAccountReadonlyControllersSid=75,
    WinBuiltinEventLogReadersGroup=76,
    WinNewEnterpriseReadonlyControllersSid=77,
    WinBuiltinCertSvcDComAccessGroup=78,
    WinMediumPlusLabelSid=79,
    WinLocalLogonSid=80,
    WinConsoleLogonSid=81,
    WinThisOrganizationCertificateSid=82
} enum_75;

typedef enum enum_75 WELL_KNOWN_SID_TYPE;

typedef CHAR * PCNZCH;

typedef struct _EVENT_DESCRIPTOR _EVENT_DESCRIPTOR, *P_EVENT_DESCRIPTOR;

typedef struct _EVENT_DESCRIPTOR EVENT_DESCRIPTOR;

struct _EVENT_DESCRIPTOR {
    USHORT Id;
    UCHAR Version;
    UCHAR Channel;
    UCHAR Level;
    UCHAR Opcode;
    USHORT Task;
    ULONGLONG Keyword;
};

typedef struct _EVENT_DATA_DESCRIPTOR _EVENT_DATA_DESCRIPTOR, *P_EVENT_DATA_DESCRIPTOR;

struct _EVENT_DATA_DESCRIPTOR {
    ULONGLONG Ptr;
    ULONG Size;
    ULONG Reserved;
};

typedef struct _EVENT_FILTER_DESCRIPTOR _EVENT_FILTER_DESCRIPTOR, *P_EVENT_FILTER_DESCRIPTOR;

struct _EVENT_FILTER_DESCRIPTOR {
    ULONGLONG Ptr;
    ULONG Size;
    ULONG Type;
};

typedef struct _EVENT_FILTER_DESCRIPTOR * PEVENT_FILTER_DESCRIPTOR;

typedef void (* PENABLECALLBACK)(LPCGUID, ULONG, UCHAR, ULONGLONG, ULONGLONG, PEVENT_FILTER_DESCRIPTOR, PVOID);

typedef ULONGLONG REGHANDLE;

typedef struct _EVENT_DATA_DESCRIPTOR * PEVENT_DATA_DESCRIPTOR;

typedef ULONGLONG * PREGHANDLE;

typedef EVENT_DESCRIPTOR * PCEVENT_DESCRIPTOR;

typedef struct IMAGE_DOS_HEADER IMAGE_DOS_HEADER, *PIMAGE_DOS_HEADER;

struct IMAGE_DOS_HEADER {
    char e_magic[2]; // Magic number
    word e_cblp; // Bytes of last page
    word e_cp; // Pages in file
    word e_crlc; // Relocations
    word e_cparhdr; // Size of header in paragraphs
    word e_minalloc; // Minimum extra paragraphs needed
    word e_maxalloc; // Maximum extra paragraphs needed
    word e_ss; // Initial (relative) SS value
    word e_sp; // Initial SP value
    word e_csum; // Checksum
    word e_ip; // Initial IP value
    word e_cs; // Initial (relative) CS value
    word e_lfarlc; // File address of relocation table
    word e_ovno; // Overlay number
    word e_res[4][4]; // Reserved words
    word e_oemid; // OEM identifier (for e_oeminfo)
    word e_oeminfo; // OEM information; e_oemid specific
    word e_res2[10][10]; // Reserved words
    dword e_lfanew; // File address of new exe header
    byte e_program[64]; // Actual DOS program
};

typedef ulonglong * PULONG64;

typedef ULONG_PTR * PSIZE_T;

typedef ULONG_PTR * PDWORD_PTR;

typedef ulong * PULONG_PTR;

typedef uint UINT_PTR;

typedef struct HKEY__ HKEY__, *PHKEY__;

struct HKEY__ {
    int unused;
};


// WARNING! conflicting data type names: /WinDef.h/UCHAR - /winsmcrd.h/UCHAR

typedef UCHAR * PUCHAR;

typedef DWORD * LPDWORD;

typedef DWORD * PDWORD;

typedef int * LPINT;

typedef struct _FILETIME * PFILETIME;

typedef struct HWND__ HWND__, *PHWND__;

typedef struct HWND__ * HWND;

struct HWND__ {
    int unused;
};

typedef struct HRSRC__ HRSRC__, *PHRSRC__;

struct HRSRC__ {
    int unused;
};

typedef HANDLE HGLOBAL;

typedef void * LPCVOID;

typedef HANDLE HLOCAL;

typedef long * LPLONG;

typedef BOOL * PBOOL;

typedef struct _FILETIME * LPFILETIME;

typedef int (* FARPROC)(void);

typedef USHORT * PUSHORT;

typedef HANDLE * LPHANDLE;

typedef int INT;

typedef WORD * LPWORD;

typedef struct HKEY__ * HKEY;

typedef HKEY * PHKEY;

typedef WORD ATOM;

typedef int HFILE;

typedef ULONG * PULONG;

typedef BOOL * LPBOOL;

typedef struct HRSRC__ * HRSRC;

typedef struct Var Var, *PVar;

struct Var {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct;

struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct {
    dword NameOffset;
    dword NameIsString;
};

typedef struct IMAGE_LOAD_CONFIG_CODE_INTEGRITY IMAGE_LOAD_CONFIG_CODE_INTEGRITY, *PIMAGE_LOAD_CONFIG_CODE_INTEGRITY;

struct IMAGE_LOAD_CONFIG_CODE_INTEGRITY {
    word Flags;
    word Catalog;
    dword CatalogOffset;
    dword Reserved;
};

typedef struct IMAGE_DEBUG_DIRECTORY IMAGE_DEBUG_DIRECTORY, *PIMAGE_DEBUG_DIRECTORY;

struct IMAGE_DEBUG_DIRECTORY {
    dword Characteristics;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    dword Type;
    dword SizeOfData;
    dword AddressOfRawData;
    dword PointerToRawData;
};

typedef struct IMAGE_IMPORT_BY_NAME_15 IMAGE_IMPORT_BY_NAME_15, *PIMAGE_IMPORT_BY_NAME_15;

struct IMAGE_IMPORT_BY_NAME_15 {
    word Hint;
    char Name[15];
};

typedef struct IMAGE_IMPORT_BY_NAME_17 IMAGE_IMPORT_BY_NAME_17, *PIMAGE_IMPORT_BY_NAME_17;

struct IMAGE_IMPORT_BY_NAME_17 {
    word Hint;
    char Name[17];
};

typedef struct IMAGE_IMPORT_BY_NAME_19 IMAGE_IMPORT_BY_NAME_19, *PIMAGE_IMPORT_BY_NAME_19;

struct IMAGE_IMPORT_BY_NAME_19 {
    word Hint;
    char Name[19];
};

typedef struct StringTable StringTable, *PStringTable;

struct StringTable {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct IMAGE_SECTION_HEADER IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;

typedef union Misc Misc, *PMisc;

typedef enum SectionFlags {
    IMAGE_SCN_TYPE_NO_PAD=8,
    IMAGE_SCN_RESERVED_0001=16,
    IMAGE_SCN_CNT_CODE=32,
    IMAGE_SCN_CNT_INITIALIZED_DATA=64,
    IMAGE_SCN_CNT_UNINITIALIZED_DATA=128,
    IMAGE_SCN_LNK_OTHER=256,
    IMAGE_SCN_LNK_INFO=512,
    IMAGE_SCN_RESERVED_0040=1024,
    IMAGE_SCN_LNK_REMOVE=2048,
    IMAGE_SCN_LNK_COMDAT=4096,
    IMAGE_SCN_GPREL=32768,
    IMAGE_SCN_MEM_16BIT=131072,
    IMAGE_SCN_MEM_PURGEABLE=131072,
    IMAGE_SCN_MEM_LOCKED=262144,
    IMAGE_SCN_MEM_PRELOAD=524288,
    IMAGE_SCN_ALIGN_1BYTES=1048576,
    IMAGE_SCN_ALIGN_2BYTES=2097152,
    IMAGE_SCN_ALIGN_4BYTES=3145728,
    IMAGE_SCN_ALIGN_8BYTES=4194304,
    IMAGE_SCN_ALIGN_16BYTES=5242880,
    IMAGE_SCN_ALIGN_32BYTES=6291456,
    IMAGE_SCN_ALIGN_64BYTES=7340032,
    IMAGE_SCN_ALIGN_128BYTES=8388608,
    IMAGE_SCN_ALIGN_256BYTES=9437184,
    IMAGE_SCN_ALIGN_512BYTES=10485760,
    IMAGE_SCN_ALIGN_1024BYTES=11534336,
    IMAGE_SCN_ALIGN_2048BYTES=12582912,
    IMAGE_SCN_ALIGN_4096BYTES=13631488,
    IMAGE_SCN_ALIGN_8192BYTES=14680064,
    IMAGE_SCN_LNK_NRELOC_OVFL=16777216,
    IMAGE_SCN_MEM_DISCARDABLE=33554432,
    IMAGE_SCN_MEM_NOT_CACHED=67108864,
    IMAGE_SCN_MEM_NOT_PAGED=134217728,
    IMAGE_SCN_MEM_SHARED=268435456,
    IMAGE_SCN_MEM_EXECUTE=536870912,
    IMAGE_SCN_MEM_READ=1073741824,
    IMAGE_SCN_MEM_WRITE=2147483648
} SectionFlags;

union Misc {
    dword PhysicalAddress;
    dword VirtualSize;
};

struct IMAGE_SECTION_HEADER {
    char Name[8];
    union Misc Misc;
    ImageBaseOffset32 VirtualAddress;
    dword SizeOfRawData;
    dword PointerToRawData;
    dword PointerToRelocations;
    dword PointerToLinenumbers;
    word NumberOfRelocations;
    word NumberOfLinenumbers;
    enum SectionFlags Characteristics;
};

typedef struct IMAGE_DATA_DIRECTORY IMAGE_DATA_DIRECTORY, *PIMAGE_DATA_DIRECTORY;

struct IMAGE_DATA_DIRECTORY {
    ImageBaseOffset32 VirtualAddress;
    dword Size;
};

typedef struct IMAGE_RESOURCE_DIR_STRING_U_6 IMAGE_RESOURCE_DIR_STRING_U_6, *PIMAGE_RESOURCE_DIR_STRING_U_6;

struct IMAGE_RESOURCE_DIR_STRING_U_6 {
    word Length;
    wchar16 NameString[3];
};

typedef struct IMAGE_RESOURCE_DATA_ENTRY IMAGE_RESOURCE_DATA_ENTRY, *PIMAGE_RESOURCE_DATA_ENTRY;

struct IMAGE_RESOURCE_DATA_ENTRY {
    dword OffsetToData;
    dword Size;
    dword CodePage;
    dword Reserved;
};

typedef struct IMAGE_IMPORT_BY_NAME_21 IMAGE_IMPORT_BY_NAME_21, *PIMAGE_IMPORT_BY_NAME_21;

struct IMAGE_IMPORT_BY_NAME_21 {
    word Hint;
    char Name[21];
};

typedef struct IMAGE_RESOURCE_DIRECTORY IMAGE_RESOURCE_DIRECTORY, *PIMAGE_RESOURCE_DIRECTORY;

struct IMAGE_RESOURCE_DIRECTORY {
    dword Characteristics;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    word NumberOfNamedEntries;
    word NumberOfIdEntries;
};

typedef struct IMAGE_DIRECTORY_ENTRY_EXPORT IMAGE_DIRECTORY_ENTRY_EXPORT, *PIMAGE_DIRECTORY_ENTRY_EXPORT;

struct IMAGE_DIRECTORY_ENTRY_EXPORT {
    dword Characteristics;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    dword Name;
    dword Base;
    dword NumberOfFunctions;
    dword NumberOfNames;
    dword AddressOfFunctions;
    dword AddressOfNames;
    dword AddressOfNameOrdinals;
};

typedef struct IMAGE_IMPORT_BY_NAME_25 IMAGE_IMPORT_BY_NAME_25, *PIMAGE_IMPORT_BY_NAME_25;

struct IMAGE_IMPORT_BY_NAME_25 {
    word Hint;
    char Name[25];
};

typedef struct IMAGE_IMPORT_BY_NAME_29 IMAGE_IMPORT_BY_NAME_29, *PIMAGE_IMPORT_BY_NAME_29;

struct IMAGE_IMPORT_BY_NAME_29 {
    word Hint;
    char Name[29];
};

typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion;

union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion {
    struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct;
    dword Name;
    word Id;
};

typedef struct IMAGE_OPTIONAL_HEADER32 IMAGE_OPTIONAL_HEADER32, *PIMAGE_OPTIONAL_HEADER32;

struct IMAGE_OPTIONAL_HEADER32 {
    word Magic;
    byte MajorLinkerVersion;
    byte MinorLinkerVersion;
    dword SizeOfCode;
    dword SizeOfInitializedData;
    dword SizeOfUninitializedData;
    ImageBaseOffset32 AddressOfEntryPoint;
    ImageBaseOffset32 BaseOfCode;
    ImageBaseOffset32 BaseOfData;
    pointer32 ImageBase;
    dword SectionAlignment;
    dword FileAlignment;
    word MajorOperatingSystemVersion;
    word MinorOperatingSystemVersion;
    word MajorImageVersion;
    word MinorImageVersion;
    word MajorSubsystemVersion;
    word MinorSubsystemVersion;
    dword Win32VersionValue;
    dword SizeOfImage;
    dword SizeOfHeaders;
    dword CheckSum;
    word Subsystem;
    word DllCharacteristics;
    dword SizeOfStackReserve;
    dword SizeOfStackCommit;
    dword SizeOfHeapReserve;
    dword SizeOfHeapCommit;
    dword LoaderFlags;
    dword NumberOfRvaAndSizes;
    struct IMAGE_DATA_DIRECTORY DataDirectory[16];
};

typedef struct IMAGE_FILE_HEADER IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER;

struct IMAGE_FILE_HEADER {
    word Machine; // 332
    word NumberOfSections;
    dword TimeDateStamp;
    dword PointerToSymbolTable;
    dword NumberOfSymbols;
    word SizeOfOptionalHeader;
    word Characteristics;
};

typedef struct IMAGE_NT_HEADERS32 IMAGE_NT_HEADERS32, *PIMAGE_NT_HEADERS32;

struct IMAGE_NT_HEADERS32 {
    char Signature[4];
    struct IMAGE_FILE_HEADER FileHeader;
    struct IMAGE_OPTIONAL_HEADER32 OptionalHeader;
};

typedef struct StringFileInfo StringFileInfo, *PStringFileInfo;

struct StringFileInfo {
    word wLength;
    word wValueLength;
    word wType;
};

typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY IMAGE_RESOURCE_DIRECTORY_ENTRY, *PIMAGE_RESOURCE_DIRECTORY_ENTRY;

union IMAGE_RESOURCE_DIRECTORY_ENTRY {
    union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion NameUnion;
    union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion DirectoryUnion;
};

typedef struct ImgDelayDescr ImgDelayDescr, *PImgDelayDescr;

struct ImgDelayDescr {
    dword grAttrs;
    ImageBaseOffset32 szName;
    ImageBaseOffset32 phmod;
    ImageBaseOffset32 pIAT;
    ImageBaseOffset32 pINT;
    ImageBaseOffset32 pBoundIAT;
    ImageBaseOffset32 pUnloadIAT;
    dword dwTimeStamp;
};

typedef struct VS_VERSION_INFO VS_VERSION_INFO, *PVS_VERSION_INFO;

struct VS_VERSION_INFO {
    word StructLength;
    word ValueLength;
    word StructType;
    wchar16 Info[16];
    byte Padding[2];
    dword Signature;
    word StructVersion[2];
    word FileVersion[4];
    word ProductVersion[4];
    dword FileFlagsMask[2];
    dword FileFlags;
    dword FileOS;
    dword FileType;
    dword FileSubtype;
    dword FileTimestamp;
};

typedef struct VarFileInfo VarFileInfo, *PVarFileInfo;

struct VarFileInfo {
    word wLength;
    word wValueLength;
    word wType;
};

typedef enum IMAGE_GUARD_FLAGS {
    IMAGE_GUARD_CF_INSTRUMENTED=256,
    IMAGE_GUARD_CFW_INSTRUMENTED=512,
    IMAGE_GUARD_CF_FUNCTION_TABLE_PRESENT=1024,
    IMAGE_GUARD_SECURITY_COOKIE_UNUSED=2048,
    IMAGE_GUARD_PROTECT_DELAYLOAD_IAT=4096,
    IMAGE_GUARD_DELAYLOAD_IAT_IN_ITS_OWN_SECTION=8192,
    IMAGE_GUARD_CF_EXPORT_SUPPRESSION_INFO_PRESENT=16384,
    IMAGE_GUARD_CF_ENABLE_EXPORT_SUPPRESSION=32768,
    IMAGE_GUARD_CF_LONGJUMP_TABLE_PRESENT=65536,
    IMAGE_GUARD_RF_INSTRUMENTED=131072,
    IMAGE_GUARD_RF_ENABLE=262144,
    IMAGE_GUARD_RF_STRICT=524288,
    IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK_1=268435456,
    IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK_2=536870912,
    IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK_4=1073741824,
    IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK_8=2147483648
} IMAGE_GUARD_FLAGS;

typedef struct StringInfo StringInfo, *PStringInfo;

struct StringInfo {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct IMAGE_LOAD_CONFIG_DIRECTORY32 IMAGE_LOAD_CONFIG_DIRECTORY32, *PIMAGE_LOAD_CONFIG_DIRECTORY32;

struct IMAGE_LOAD_CONFIG_DIRECTORY32 {
    dword Size;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    dword GlobalFlagsClear;
    dword GlobalFlagsSet;
    dword CriticalSectionDefaultTimeout;
    dword DeCommitFreeBlockThreshold;
    dword DeCommitTotalFreeThreshold;
    pointer32 LockPrefixTable;
    dword MaximumAllocationSize;
    dword VirtualMemoryThreshold;
    dword ProcessHeapFlags;
    dword ProcessAffinityMask;
    word CsdVersion;
    word DependentLoadFlags;
    pointer32 EditList;
    pointer32 SecurityCookie;
    pointer32 SEHandlerTable;
    dword SEHandlerCount;
    pointer32 GuardCFCCheckFunctionPointer;
    pointer32 GuardCFDispatchFunctionPointer;
    pointer32 GuardCFFunctionTable;
    dword GuardCFFunctionCount;
    enum IMAGE_GUARD_FLAGS GuardFlags;
    struct IMAGE_LOAD_CONFIG_CODE_INTEGRITY CodeIntegrity;
    pointer32 GuardAddressTakenIatEntryTable;
    dword GuardAddressTakenIatEntryCount;
    pointer32 GuardLongJumpTargetTable;
    dword GuardLongJumpTargetCount;
    pointer32 DynamicValueRelocTable;
    pointer32 CHPEMetadataPointer;
    pointer32 GuardRFFailureRoutine;
    pointer32 GuardRFFailureRoutineFunctionPointer;
    dword DynamicValueRelocTableOffset;
    word DynamicValueRelocTableSection;
    word Reserved1;
    pointer32 GuardRFVerifyStackPointerFunctionPointer;
    dword HotPatchTableOffset;
    dword Reserved2;
    dword Reserved3;
};

typedef LONG LSTATUS;

typedef ACCESS_MASK REGSAM;

typedef union _union_1020 _union_1020, *P_union_1020;

typedef struct _struct_1021 _struct_1021, *P_struct_1021;

typedef struct _struct_1022 _struct_1022, *P_struct_1022;

struct _struct_1021 {
    BYTE hour;
    BYTE min;
    BYTE sec;
    BYTE frame;
    BYTE fps;
    BYTE dummy;
    BYTE pad[2];
};

struct _struct_1022 {
    DWORD songptrpos;
};

union _union_1020 {
    DWORD ms;
    DWORD sample;
    DWORD cb;
    DWORD ticks;
    struct _struct_1021 smpte;
    struct _struct_1022 midi;
};

typedef struct mmtime_tag mmtime_tag, *Pmmtime_tag;

struct mmtime_tag {
    UINT wType;
    union _union_1020 u;
};

typedef struct mmtime_tag * LPMMTIME;

typedef UINT MMRESULT;

typedef struct timecaps_tag timecaps_tag, *Ptimecaps_tag;

typedef struct timecaps_tag * LPTIMECAPS;

struct timecaps_tag {
    UINT wPeriodMin;
    UINT wPeriodMax;
};

typedef enum _RPC_NOTIFICATION_TYPES {
    RpcNotificationTypeNone=0,
    RpcNotificationTypeEvent=1,
    RpcNotificationTypeApc=2,
    RpcNotificationTypeIoc=3,
    RpcNotificationTypeHwnd=4,
    RpcNotificationTypeCallback=5
} _RPC_NOTIFICATION_TYPES;

typedef enum _RPC_NOTIFICATION_TYPES RPC_NOTIFICATION_TYPES;

typedef union _RPC_ASYNC_NOTIFICATION_INFO _RPC_ASYNC_NOTIFICATION_INFO, *P_RPC_ASYNC_NOTIFICATION_INFO;

typedef struct _struct_1192 _struct_1192, *P_struct_1192;

typedef struct _struct_1193 _struct_1193, *P_struct_1193;

typedef struct _struct_1194 _struct_1194, *P_struct_1194;

typedef struct _RPC_ASYNC_STATE _RPC_ASYNC_STATE, *P_RPC_ASYNC_STATE;

typedef enum _RPC_ASYNC_EVENT {
    RpcCallComplete=0,
    RpcSendComplete=1,
    RpcReceiveComplete=2,
    RpcClientDisconnect=3
} _RPC_ASYNC_EVENT;

typedef enum _RPC_ASYNC_EVENT RPC_ASYNC_EVENT;

typedef void (RPCNOTIFICATION_ROUTINE)(struct _RPC_ASYNC_STATE *, void *, RPC_ASYNC_EVENT);

typedef RPCNOTIFICATION_ROUTINE * PFN_RPCNOTIFICATION_ROUTINE;

typedef union _RPC_ASYNC_NOTIFICATION_INFO RPC_ASYNC_NOTIFICATION_INFO;

struct _struct_1192 {
    PFN_RPCNOTIFICATION_ROUTINE NotificationRoutine;
    HANDLE hThread;
};

struct _struct_1194 {
    HWND hWnd;
    UINT Msg;
};

struct _struct_1193 {
    HANDLE hIOPort;
    DWORD dwNumberOfBytesTransferred;
    DWORD_PTR dwCompletionKey;
    LPOVERLAPPED lpOverlapped;
};

union _RPC_ASYNC_NOTIFICATION_INFO {
    struct _struct_1192 APC;
    struct _struct_1193 IOC;
    struct _struct_1194 HWND;
    HANDLE hEvent;
    PFN_RPCNOTIFICATION_ROUTINE NotificationRoutine;
};

struct _RPC_ASYNC_STATE {
    uint Size;
    ulong Signature;
    long Lock;
    ulong Flags;
    void * StubInfo;
    void * UserInfo;
    void * RuntimeInfo;
    RPC_ASYNC_EVENT Event;
    RPC_NOTIFICATION_TYPES NotificationType;
    RPC_ASYNC_NOTIFICATION_INFO u;
    LONG_PTR Reserved[4];
};

typedef struct _RPC_ASYNC_STATE * PRPC_ASYNC_STATE;




BOOL IsBadWritePtr(LPVOID lp,UINT_PTR ucb)

{
  int iVar1;
  int iVar2;
  LPVOID pvVar3;
  uint uVar4;
  undefined *puVar5;
  int *in_FS_OFFSET;
  undefined local_14 [16];
  
                    // 0x10010  894  IsBadWritePtr
  iVar1 = *in_FS_OFFSET;
  *in_FS_OFFSET = (int)local_14;
  iVar2 = DAT_6b8b0708;
  if (ucb != 0) {
    if ((lp == (LPVOID)0x0) || (pvVar3 = (LPVOID)((ucb - 1) + (int)lp), pvVar3 < lp)) {
      *in_FS_OFFSET = iVar1;
      return 1;
    }
                    // WARNING: Load size is inaccurate
    *(undefined *)lp = *lp;
    uVar4 = -iVar2;
    puVar5 = (undefined *)(uVar4 & (uint)lp);
    while (puVar5 != (undefined *)((uint)pvVar3 & uVar4)) {
      puVar5 = puVar5 + iVar2;
      *puVar5 = *puVar5;
    }
  }
  *in_FS_OFFSET = iVar1;
  return 0;
}



BOOL IsBadCodePtr(FARPROC lpfn)

{
  BOOL BVar1;
  
                    // 0x100e0  888  IsBadCodePtr
  BVar1 = IsBadReadPtr(lpfn,1);
  return BVar1;
}



BOOL IsBadReadPtr(void *lp,UINT_PTR ucb)

{
  int iVar1;
  BOOL BVar2;
  void *pvVar3;
  uint uVar4;
  int *in_FS_OFFSET;
  undefined local_14 [16];
  
                    // 0x10100  891  IsBadReadPtr
  iVar1 = *in_FS_OFFSET;
  *in_FS_OFFSET = (int)local_14;
  if (ucb != 0) {
    if ((lp == (void *)0x0) || (pvVar3 = (void *)((ucb - 1) + (int)lp), pvVar3 < lp)) {
      BVar2 = 1;
      goto LAB_6b81017d;
    }
    for (uVar4 = -DAT_6b8b0708 & (uint)lp; uVar4 != ((uint)pvVar3 & -DAT_6b8b0708);
        uVar4 = uVar4 + DAT_6b8b0708) {
    }
  }
  BVar2 = 0;
LAB_6b81017d:
  *in_FS_OFFSET = iVar1;
  return BVar2;
}



int __fastcall FUN_6b8101a7(int *param_1)

{
  short sVar1;
  ushort *puVar2;
  char cVar3;
  int iVar4;
  undefined4 uVar5;
  undefined4 *puVar6;
  char *pcVar7;
  short *psVar8;
  uint uVar9;
  int iVar10;
  short *psVar11;
  short *psVar12;
  ushort *puVar13;
  uint uVar14;
  int in_FS_OFFSET;
  uint local_34;
  char *local_2c;
  ushort *local_24;
  ushort *local_20;
  int local_1c;
  void *local_18;
  uint local_14;
  short *local_10;
  uint local_c;
  char local_5;
  
  local_24 = (ushort *)0x0;
  uVar14 = 0;
  local_20 = (ushort *)0x0;
  local_2c = (char *)0x0;
  local_10 = (short *)0x0;
  iVar4 = FUN_6b810e4e((int)param_1);
  iVar10 = 1;
  if (iVar4 < 0) {
    if (*param_1 == 8) {
      return 0;
    }
    local_18 = (void *)param_1[0x19];
    if (*(char *)(param_1[3] + 0x19) == '\0') {
      uVar5 = FUN_6b81c868((int)param_1,(short **)&local_24,(short **)0x0);
      if ((char)uVar5 == '\0') {
        return -0x3ffffff3;
      }
      uVar14 = *local_24 + 4;
    }
    else {
      uVar5 = FUN_6b81c868((int)param_1,(short **)0x0,(short **)&local_20);
      if ((char)uVar5 == '\0') {
        return -0x3ffffff3;
      }
      uVar14 = *local_20 + 8;
    }
    local_5 = '\x01';
    local_34 = 0;
  }
  else {
    if (*param_1 == 8) {
      local_18 = (void *)param_1[0x18];
    }
    else {
      local_18 = (void *)param_1[0x17];
    }
    do {
      iVar4 = FUN_6b810f40((int)param_1,(*param_1 == 8) + 2);
    } while (iVar4 == 0x105);
    if (iVar4 != -0x7fffffe6) {
      return iVar4;
    }
    local_34 = param_1[0x17] - (int)local_18;
    local_5 = '\0';
  }
  if (*param_1 == 8) {
    psVar11 = (short *)0x0;
    goto LAB_6b82485e;
  }
  if (*(char *)(param_1[3] + 0x19) == '\0') {
    iVar4 = param_1[0x14];
    if (param_1[0x14] == 0) {
      if ((param_1[0x15] != 0) && (iVar4 = param_1[0x16], iVar4 != 0)) {
        param_1[0x14] = iVar4;
        iVar10 = RtlUnicodeToMultiByteN(param_1[0x13],iVar4,&local_1c,param_1[0x15],iVar4);
        if (iVar10 < 0) {
          return -0x3ffffff3;
        }
        param_1[0x14] = local_1c;
        *(undefined *)(local_1c + param_1[0x13]) = 0;
        iVar4 = local_1c;
        goto LAB_6b8246fd;
      }
      local_2c = "";
    }
    else {
LAB_6b8246fd:
      local_1c = iVar4;
      local_2c = (char *)param_1[0x13];
      iVar10 = local_1c + 1;
    }
    local_14 = (uVar14 - 1) + iVar10;
    cVar3 = *local_2c;
    pcVar7 = local_2c;
    while (cVar3 != '\0') {
      do {
        cVar3 = *pcVar7;
        pcVar7 = pcVar7 + 1;
      } while (cVar3 != '\0');
      local_14 = local_14 + 1;
      cVar3 = *pcVar7;
    }
  }
  else {
    uVar9 = param_1[0x16];
    if (uVar9 == 0) {
      if ((param_1[0x13] != 0) && (iVar10 = param_1[0x14], iVar10 != 0)) {
        param_1[0x16] = iVar10 * 2;
        iVar10 = RtlMultiByteToUnicodeN(param_1[0x15],iVar10 * 2,&local_c,param_1[0x13],iVar10);
        if (iVar10 < 0) {
          return -0x3ffffff3;
        }
        *(undefined2 *)(param_1[0x15] + (local_c & 0xfffffffe)) = 0;
        uVar9 = local_c;
        goto LAB_6b824673;
      }
      local_10 = &DAT_6b884240;
      iVar10 = 2;
    }
    else {
LAB_6b824673:
      local_c = uVar9 >> 1;
      local_10 = (short *)param_1[0x15];
      iVar10 = (uVar9 & 0xfffffffe) + 2;
    }
    local_14 = (uVar14 - 2) + iVar10;
    sVar1 = *local_10;
    psVar11 = local_10;
    while (sVar1 != 0) {
      do {
        sVar1 = *psVar11;
        psVar11 = psVar11 + 1;
      } while (sVar1 != 0);
      local_14 = local_14 + 2;
      sVar1 = *psVar11;
    }
  }
  uVar14 = local_14;
  puVar6 = (undefined4 *)KernelBaseGetGlobalData();
  psVar11 = (short *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar6,
                                     uVar14 + 2);
  if (psVar11 == (short *)0x0) {
    return -0x3fffffe9;
  }
  if (*(char *)(param_1[3] + 0x19) == '\0') {
    psVar8 = psVar11;
    if (local_5 != '\0') {
      *(undefined *)psVar11 = 0x5b;
      puVar2 = *(ushort **)(local_24 + 2);
      puVar13 = puVar2;
      for (uVar9 = (uint)*local_24; psVar12 = (short *)((int)psVar8 + 1), uVar9 != 0;
          uVar9 = uVar9 - 1) {
        *(undefined *)psVar12 = *(undefined *)puVar13;
        puVar13 = (ushort *)((int)puVar13 + 1);
        psVar8 = psVar12;
      }
      *psVar12 = 0xd5d;
      *(undefined *)(psVar12 + 1) = 10;
      psVar8 = psVar8 + 2;
      local_24 = puVar2;
    }
    cVar3 = *local_2c;
    while (cVar3 != '\0') {
      while( true ) {
        local_2c = local_2c + 1;
        *(char *)psVar8 = cVar3;
        if (cVar3 == '\0') break;
        cVar3 = *local_2c;
        psVar8 = (short *)((int)psVar8 + 1);
      }
      *psVar8 = 0xa0d;
      psVar8 = psVar8 + 1;
      cVar3 = *local_2c;
    }
  }
  else {
    psVar8 = psVar11;
    if (local_5 != '\0') {
      *psVar11 = 0x5b;
      psVar12 = *(short **)(local_20 + 2);
      for (uVar9 = (uint)(*local_20 >> 1); psVar8 = psVar8 + 1, uVar9 != 0; uVar9 = uVar9 - 1) {
        sVar1 = *psVar12;
        psVar12 = psVar12 + 1;
        *psVar8 = sVar1;
      }
      *psVar8 = 0x5d;
      psVar8[1] = 0xd;
      psVar8[2] = 10;
      psVar8 = psVar8 + 3;
    }
    sVar1 = *local_10;
    psVar12 = local_10;
    while (sVar1 != 0) {
      *psVar8 = sVar1;
      while (psVar12 = psVar12 + 1, sVar1 != 0) {
        sVar1 = *psVar12;
        psVar8 = psVar8 + 1;
        *psVar8 = sVar1;
      }
      *psVar8 = 0xd;
      psVar8[1] = 10;
      psVar8 = psVar8 + 2;
      uVar14 = local_14;
      sVar1 = *psVar12;
    }
  }
LAB_6b82485e:
  iVar10 = FUN_6b8103d6((int)param_1,local_18,local_34,psVar11,uVar14);
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,psVar11);
  return iVar10;
}



int __fastcall FUN_6b8101e7(int *param_1)

{
  undefined2 uVar1;
  undefined2 *puVar2;
  undefined2 *puVar3;
  int iVar4;
  undefined4 uVar5;
  int iVar6;
  undefined4 *puVar7;
  undefined2 *puVar8;
  undefined2 *puVar9;
  uint uVar10;
  ushort *puVar11;
  int iVar12;
  uint uVar13;
  int iVar14;
  uint uVar15;
  undefined *puVar16;
  int in_FS_OFFSET;
  undefined2 *local_2c;
  ushort *local_28;
  ushort *local_24;
  undefined2 *local_20;
  ushort *local_1c;
  ushort *local_18;
  int local_14;
  uint local_10;
  void *local_c;
  char local_6;
  char local_5;
  
  local_24 = (ushort *)0x0;
  iVar14 = 0;
  local_28 = (ushort *)0x0;
  local_18 = (ushort *)0x0;
  local_1c = (ushort *)0x0;
  local_2c = (undefined2 *)0x0;
  local_20 = (undefined2 *)0x0;
  local_c = (void *)0x0;
  local_14 = FUN_6b810e4e((int)param_1);
  iVar12 = 1;
  if (local_14 < 0) {
    if (*param_1 == 3) {
      return 0;
    }
    local_c = (void *)param_1[0x19];
    if (*(char *)(param_1[3] + 0x19) == '\0') {
      uVar5 = FUN_6b81c868((int)param_1,(short **)&local_24,(short **)0x0);
      if ((char)uVar5 == '\0') {
        return -0x3ffffff3;
      }
      iVar14 = *local_24 + 4;
    }
    else {
      uVar5 = FUN_6b81c868((int)param_1,(short **)0x0,(short **)&local_18);
      if ((char)uVar5 == '\0') {
        return -0x3ffffff3;
      }
      iVar14 = *local_18 + 8;
    }
    local_6 = '\x01';
    iVar4 = local_14;
  }
  else {
    local_6 = '\0';
    iVar4 = FUN_6b810cc1((int)param_1);
  }
  if (iVar4 < 0) {
    if (*param_1 == 3) {
      return 0;
    }
    if (local_6 == '\0') {
      local_c = (void *)param_1[0x17];
    }
    if (*(char *)(param_1[3] + 0x19) == '\0') {
      uVar5 = FUN_6b81c967((int)param_1,(short **)&local_28,(short **)0x0);
      if ((char)uVar5 == '\0') {
        return -0x3ffffff3;
      }
      iVar6 = *local_28 + 3;
    }
    else {
      uVar5 = FUN_6b81c967((int)param_1,(short **)0x0,(short **)&local_1c);
      if ((char)uVar5 == '\0') {
        return -0x3ffffff3;
      }
      iVar6 = *local_1c + 6;
    }
    iVar4 = param_1[3];
    iVar14 = iVar14 + iVar6;
    local_5 = '\x01';
  }
  else {
    iVar4 = param_1[3];
    if (*(char *)(iVar4 + 0x19) == '\0') {
      if (*param_1 == 3) {
        uVar15 = FUN_6b856802((int)param_1);
        puVar11 = (ushort *)param_1[0x21];
        goto LAB_6b825971;
      }
      iVar6 = param_1[0x22];
    }
    else {
      if (*param_1 == 3) {
        uVar15 = FUN_6b856802((int)param_1);
        puVar11 = (ushort *)param_1[0x2a];
LAB_6b825971:
        uVar13 = 0;
        puVar8 = (undefined2 *)0x0;
        goto LAB_6b825982;
      }
      iVar6 = param_1[0x2b];
    }
    local_c = *(void **)(iVar6 + 4);
    local_5 = '\0';
  }
  if (*(char *)(iVar4 + 0x19) == '\0') {
    iVar4 = param_1[0x14];
    if (param_1[0x14] == 0) {
      if ((param_1[0x15] != 0) && (iVar4 = param_1[0x16], iVar4 != 0)) {
        param_1[0x14] = iVar4;
        iVar12 = RtlUnicodeToMultiByteN(param_1[0x13],iVar4,&local_14,param_1[0x15],iVar4);
        if (iVar12 < 0) {
          return -0x3ffffff3;
        }
        param_1[0x14] = local_14;
        *(undefined *)(local_14 + param_1[0x13]) = 0;
        iVar4 = local_14;
        goto LAB_6b810297;
      }
      puVar8 = (undefined2 *)&DAT_6b884254;
    }
    else {
LAB_6b810297:
      local_14 = iVar4;
      puVar8 = (undefined2 *)param_1[0x13];
      iVar12 = local_14 + 1;
    }
    uVar13 = iVar12 - 1;
    local_2c = puVar8;
    if (iVar14 != 0) {
LAB_6b8102a9:
      uVar15 = iVar14 + uVar13;
      puVar7 = (undefined4 *)KernelBaseGetGlobalData();
      puVar8 = (undefined2 *)
               RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar7,
                               uVar15 + 2);
      if (puVar8 == (undefined2 *)0x0) {
        return -0x3fffffe9;
      }
      if (*(char *)(param_1[3] + 0x19) == '\0') {
        puVar9 = puVar8;
        if (local_6 != '\0') {
          *(undefined *)puVar8 = 0x5b;
          puVar16 = *(undefined **)(local_24 + 2);
          for (uVar10 = (uint)*local_24; puVar3 = (undefined2 *)((int)puVar9 + 1), uVar10 != 0;
              uVar10 = uVar10 - 1) {
            *(undefined *)puVar3 = *puVar16;
            puVar16 = puVar16 + 1;
            puVar9 = puVar3;
          }
          *puVar3 = 0xd5d;
          *(undefined *)((int)puVar9 + 3) = 10;
          puVar9 = puVar9 + 2;
        }
        if (local_5 != '\0') {
          puVar16 = *(undefined **)(local_28 + 2);
          for (uVar10 = (uint)*local_28; uVar10 != 0; uVar10 = uVar10 - 1) {
            *(undefined *)puVar9 = *puVar16;
            puVar9 = (undefined2 *)((int)puVar9 + 1);
            puVar16 = puVar16 + 1;
          }
          *(undefined *)puVar9 = 0x3d;
          puVar9 = (undefined2 *)((int)puVar9 + 1);
        }
        if (uVar13 != 0) {
          iVar12 = (int)local_2c - (int)puVar9;
          do {
            *(undefined *)puVar9 = *(undefined *)((int)puVar9 + iVar12);
            puVar9 = (undefined2 *)((int)puVar9 + 1);
            uVar13 = uVar13 - 1;
          } while (uVar13 != 0);
        }
        if (local_5 != '\0') {
          *puVar9 = 0xa0d;
        }
      }
      else {
        puVar9 = puVar8;
        if (local_6 != '\0') {
          *puVar8 = 0x5b;
          puVar3 = *(undefined2 **)(local_18 + 2);
          for (uVar10 = (uint)(*local_18 >> 1); puVar2 = puVar9 + 1, uVar10 != 0;
              uVar10 = uVar10 - 1) {
            uVar1 = *puVar3;
            puVar3 = puVar3 + 1;
            *puVar2 = uVar1;
            puVar9 = puVar2;
          }
          *puVar2 = 0x5d;
          puVar9[2] = 0xd;
          puVar9[3] = 10;
          puVar9 = puVar9 + 4;
        }
        if (local_5 != '\0') {
          puVar3 = *(undefined2 **)(local_1c + 2);
          for (uVar10 = (uint)(*local_1c >> 1); uVar10 != 0; uVar10 = uVar10 - 1) {
            uVar1 = *puVar3;
            puVar3 = puVar3 + 1;
            *puVar9 = uVar1;
            puVar9 = puVar9 + 1;
          }
          *puVar9 = 0x3d;
          puVar9 = puVar9 + 1;
        }
        uVar13 = uVar13 >> 1;
        if (uVar13 != 0) {
          iVar12 = (int)local_20 - (int)puVar9;
          do {
            *puVar9 = *(undefined2 *)(iVar12 + (int)puVar9);
            puVar9 = puVar9 + 1;
            uVar13 = uVar13 - 1;
          } while (uVar13 != 0);
        }
        if (local_5 != '\0') {
          *puVar9 = 0xd;
          puVar9[1] = 10;
        }
      }
      iVar12 = FUN_6b8103d6((int)param_1,local_c,0,puVar8,uVar15);
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar8);
      return iVar12;
    }
    puVar11 = (ushort *)param_1[0x22];
  }
  else {
    uVar13 = param_1[0x16];
    if (uVar13 == 0) {
      if ((param_1[0x13] != 0) && (iVar12 = param_1[0x14], iVar12 != 0)) {
        param_1[0x16] = iVar12 * 2;
        iVar12 = RtlMultiByteToUnicodeN(param_1[0x15],iVar12 * 2,&local_10,param_1[0x13],iVar12);
        if (iVar12 < 0) {
          return -0x3ffffff3;
        }
        *(undefined2 *)(param_1[0x15] + (local_10 & 0xfffffffe)) = 0;
        uVar13 = local_10;
        goto LAB_6b825a07;
      }
      puVar8 = &DAT_6b884240;
      uVar13 = 0;
    }
    else {
LAB_6b825a07:
      local_10 = uVar13 >> 1;
      puVar8 = (undefined2 *)param_1[0x15];
      uVar13 = uVar13 & 0xfffffffe;
    }
    local_20 = puVar8;
    if (iVar14 != 0) goto LAB_6b8102a9;
    puVar11 = (ushort *)param_1[0x2b];
  }
  uVar15 = (uint)*puVar11;
LAB_6b825982:
  iVar12 = FUN_6b8103d6((int)param_1,*(void **)(puVar11 + 2),uVar15,puVar8,uVar13);
  return iVar12;
}



int __fastcall FUN_6b8103d6(int param_1,void *param_2,uint param_3,void *param_4,uint param_5)

{
  int iVar1;
  size_t _Size;
  uint uVar2;
  size_t _Size_00;
  uint uVar3;
  uint local_c;
  
  iVar1 = *(int *)(param_1 + 0xc);
  uVar3 = (*(int *)(iVar1 + 0x1c) - param_3) + param_5;
  if (*(uint *)(iVar1 + 0x24) <= uVar3 && uVar3 != *(uint *)(iVar1 + 0x24)) {
    if (*(uint *)(iVar1 + 0x28) <= uVar3 && uVar3 != *(uint *)(iVar1 + 0x28)) {
      return -0x7ffffffb;
    }
    *(uint *)(iVar1 + 0x24) = uVar3;
    iVar1 = NtAllocateVirtualMemory
                      (0xffffffff,*(int *)(param_1 + 0xc) + 0x20,0,*(int *)(param_1 + 0xc) + 0x24,
                       0x1000,4);
    if (iVar1 < 0) {
      return iVar1;
    }
    *(uint *)(*(int *)(param_1 + 0xc) + 0x1c) = uVar3;
    iVar1 = *(int *)(param_1 + 0xc);
  }
  uVar2 = (int)param_2 - *(int *)(iVar1 + 0x20);
  _Size = *(int *)(param_1 + 100) - (int)param_2;
  _Size_00 = _Size - param_3;
  local_c = _Size_00 + param_5;
  if (param_5 < param_3) {
    memmove(param_2,param_4,param_5);
    memmove((void *)((int)param_2 + param_5),(void *)(param_3 + (int)param_2),_Size_00);
  }
  else {
    if (param_5 == 0) {
      return 0;
    }
    if (param_3 < param_5) {
      memmove((void *)((int)param_2 + (param_5 - param_3)),param_2,_Size);
    }
    else {
      local_c = param_5;
    }
    memmove(param_2,param_4,param_5);
  }
  iVar1 = *(int *)(param_1 + 0xc);
  if (*(uint *)(iVar1 + 0x1c) != uVar3) {
    *(uint *)(iVar1 + 0x1c) = uVar3;
    iVar1 = *(int *)(param_1 + 0xc);
  }
  if (uVar2 < *(uint *)(iVar1 + 0x2c)) {
    *(uint *)(iVar1 + 0x2c) = uVar2;
    iVar1 = *(int *)(param_1 + 0xc);
  }
  uVar2 = uVar2 + local_c;
  if (*(uint *)(iVar1 + 0x30) <= uVar2 && uVar2 != *(uint *)(iVar1 + 0x30)) {
    *(uint *)(iVar1 + 0x30) = uVar2;
  }
  return 0;
}



DWORD GetProfileStringW(LPCWSTR lpAppName,LPCWSTR lpKeyName,LPCWSTR lpDefault,
                       LPWSTR lpReturnedString,DWORD nSize)

{
  DWORD DVar1;
  
                    // 0x10490  719  GetProfileStringW
  DVar1 = GetPrivateProfileStringW
                    (lpAppName,lpKeyName,lpDefault,lpReturnedString,nSize,(LPCWSTR)0x0);
  return DVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

uint __fastcall FUN_6b8104af(int *param_1)

{
  short *psVar1;
  code *pcVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  undefined4 *in_FS_OFFSET;
  int *piVar7;
  undefined4 local_14;
  
  iVar6 = 0;
  if (*(char *)(param_1 + 1) == '\0') {
    iVar6 = param_1[0x13];
  }
  uVar3 = FUN_6b81060b((int)param_1);
  if (-1 < (int)uVar3) {
    iVar5 = param_1[3];
    param_1[0x19] = *(int *)(iVar5 + 0x1c) + *(int *)(iVar5 + 0x20);
    psVar1 = *(short **)(iVar5 + 0x20);
    param_1[0x17] = (int)psVar1;
    if ((*(char *)(iVar5 + 0x19) != '\0') && ((*psVar1 == -0x101 || (*psVar1 == -2)))) {
      param_1[0x17] = (int)(psVar1 + 1);
    }
    if (*param_1 == 5) {
      uVar3 = FUN_6b810ef5((int)param_1);
    }
    else if (*param_1 == 1) {
      uVar3 = FUN_6b810c5c((int)param_1);
    }
    else if (*param_1 == 4) {
      uVar3 = FUN_6b856e49((int)param_1);
    }
    else if (*param_1 == 6) {
      uVar3 = FUN_6b810d68((int)param_1);
    }
    else if (*param_1 == 2) {
LAB_6b8105d9:
      uVar3 = FUN_6b8101e7(param_1);
    }
    else {
      if (*param_1 != 8) {
        if (*param_1 == 3) goto LAB_6b8105d9;
        if (*param_1 != 7) {
          uVar3 = 0xc000000d;
          goto LAB_6b810519;
        }
      }
      uVar3 = FUN_6b8101a7(param_1);
    }
LAB_6b810519:
    FUN_6b8105fa();
  }
  uVar4 = RtlGetSuiteMask();
  pcVar2 = DAT_6b8b09f0;
  if ((uVar4 & 0x10) == 0) goto LAB_6b810570;
  if ((int)uVar3 < 0) {
    if ((((*param_1 == 1) || (*param_1 == 4)) || (*param_1 == 5)) || (*param_1 == 6)) {
      iVar5 = TermsrvSyncUserIniFileExt(param_1);
      if (iVar5 != 0) {
        FUN_6b8104af(param_1);
      }
      goto LAB_6b810570;
    }
    if ((int)uVar3 < 0) goto LAB_6b810570;
  }
  if ((((*param_1 == 2) || (*param_1 == 8)) || ((*param_1 == 3 || (*param_1 == 7)))) &&
     ((*(char *)(DAT_6b8b083c + 0x808) != '\0' && (DAT_6b8b09f0 != (code *)0x0)))) {
    piVar7 = param_1 + 8;
    _guard_check_icall();
    (*pcVar2)(piVar7);
  }
LAB_6b810570:
  if ((uVar3 == 0xc0000034) && (*(char *)(param_1 + 1) == '\0')) {
    uVar3 = ~-(uint)(iVar6 != 0) & 0xc0000034;
  }
  *in_FS_OFFSET = local_14;
  return uVar3;
}



void FUN_6b8105fa(void)

{
  int iVar1;
  int unaff_EBP;
  int unaff_ESI;
  int unaff_EDI;
  
  iVar1 = FUN_6b810a0e(unaff_ESI);
  if (-1 < unaff_EDI) {
    *(int *)(unaff_EBP + -0x1c) = iVar1;
  }
  return;
}



uint __fastcall FUN_6b81060b(int param_1)

{
  short *psVar1;
  LPCWSTR *ppWVar2;
  byte bVar3;
  ushort *puVar4;
  code *pcVar5;
  char cVar6;
  DWORD DVar7;
  int iVar8;
  int *piVar9;
  int iVar10;
  size_t sVar11;
  uint uVar12;
  ushort *puVar13;
  int in_FS_OFFSET;
  short *psVar14;
  uint local_58;
  LPWSTR local_50;
  undefined4 local_4c [2];
  int local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined local_30 [4];
  int local_2c;
  undefined local_28 [8];
  undefined4 local_20;
  undefined4 local_1c;
  int local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  
  psVar1 = (short *)(param_1 + 0x20);
  *psVar1 = 0;
  ppWVar2 = (LPCWSTR *)(param_1 + 0x1c);
  local_44 = param_1;
  if (((*(ushort *)(param_1 + 0x18) < 3) || ((*ppWVar2)[1] != L':')) &&
     ((*(ushort *)(param_1 + 0x18) == 0 ||
      (sVar11 = wcscspn(*ppWVar2,(wchar_t *)&_Control_6b884258),
      sVar11 == *(ushort *)(param_1 + 0x18) >> 1)))) {
    pcVar5 = DAT_6b8b0908;
    iVar8 = param_1 + 0x10;
    if (DAT_6b8b0908 != (code *)0x0) {
      psVar14 = psVar1;
      _guard_check_icall();
      iVar8 = (*pcVar5)(psVar14,iVar8);
      if (-1 < iVar8) goto LAB_6b810686;
    }
    iVar8 = KernelBaseGetGlobalData();
    RtlCopyUnicodeString(psVar1,iVar8 + 8);
    uVar12 = RtlAppendUnicodeToString(psVar1,&DAT_6b88423c);
    if ((int)uVar12 < 0) {
      return uVar12;
    }
    uVar12 = RtlAppendUnicodeStringToString(psVar1,param_1 + 0x10);
    if ((int)uVar12 < 0) {
      return uVar12;
    }
  }
  else {
    DVar7 = GetFullPathNameW(*ppWVar2,(uint)(*(ushort *)(param_1 + 0x22) >> 1),
                             *(LPWSTR *)(param_1 + 0x24),&local_50);
    if (*(ushort *)(param_1 + 0x22) >> 1 < DVar7) {
      return 0xc0000023;
    }
    if (DVar7 == 0) {
      return 0xc0000001;
    }
    *psVar1 = (short)DVar7 * 2;
    iVar8 = KernelBaseGetGlobalData();
    TermsrvConvertSysRootToUserDir(psVar1,iVar8 + 8);
  }
LAB_6b810686:
  cVar6 = RtlDosPathNameToNtPathName_U(*(undefined4 *)(param_1 + 0x24),local_28,&local_50,0);
  if (cVar6 == '\0') {
    local_58 = 0xc000003a;
    iVar8 = 0;
  }
  else {
    RtlCopyUnicodeString(psVar1,local_28);
    RtlFreeUnicodeString(local_28);
    piVar9 = (int *)KernelBaseGetGlobalData();
    iVar8 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                            *piVar9 + 0x80000U | 8,*(ushort *)(param_1 + 0x22) + 0x78);
    if (iVar8 == 0) {
      return 0xc0000017;
    }
    *(int *)(iVar8 + 0xc) = iVar8 + 0x78;
    local_18 = iVar8 + 8;
    *(undefined2 *)(iVar8 + 10) = *(undefined2 *)(param_1 + 0x22);
    RtlCopyUnicodeString(local_18,param_1 + 0x20);
    *(undefined4 *)(iVar8 + 0x10) = *(undefined4 *)(param_1 + 8);
    *(undefined *)(iVar8 + 0x18) = *(undefined *)(param_1 + 4);
    pcVar5 = DAT_6b8b0904;
    if (DAT_6b8b0904 != (code *)0x0) {
      iVar10 = local_18;
      _guard_check_icall();
      (*pcVar5)(iVar10);
    }
    local_20 = 0x18;
    local_1c = 0;
    local_14 = 0x40;
    local_10 = 0;
    local_c = 0;
    if (*(char *)(iVar8 + 0x18) == '\0') {
      local_58 = NtOpenFile(iVar8 + 0x14,0x80100000,&local_20,local_30,7,0x60);
    }
    else {
      local_58 = NtCreateFile(iVar8 + 0x14,0xc0100000,&local_20,local_30,0,0x80,7,3,0x60,0,0);
    }
  }
  if ((int)local_58 < 0) {
LAB_6b810912:
    if (iVar8 == 0) {
      return local_58;
    }
    if (*(char *)(iVar8 + 0x1a) != '\0') {
      local_38 = 0;
      local_34 = 0;
      local_40 = 0xffffffff;
      local_3c = 0xffffffff;
      NtUnlockFile(*(undefined4 *)(iVar8 + 0x14),local_30,&local_38,&local_40,DAT_6b8b016c);
    }
    if (*(int *)(iVar8 + 0x14) == 0) goto LAB_6b81092a;
  }
  else {
    *(undefined *)(iVar8 + 0x1a) = 0;
    local_40 = 0xffffffff;
    local_3c = 0xffffffff;
    local_38 = 0;
    local_34 = 0;
    local_58 = NtLockFile(*(undefined4 *)(iVar8 + 0x14),0,0,0,local_30,&local_38,&local_40,
                          DAT_6b8b016c,0,*(undefined *)(iVar8 + 0x18));
    if ((int)local_58 < 0) {
      if (local_58 == 0xc00000bb) {
        local_58 = 0;
      }
    }
    else {
      *(undefined *)(iVar8 + 0x1a) = 1;
    }
    if ((int)local_58 < 0) goto LAB_6b810912;
    local_58 = NtQueryInformationFile(*(undefined4 *)(iVar8 + 0x14),local_30,iVar8 + 0x60,0x18,5);
    local_58 = -(uint)(local_58 != 0x80000005) & local_58;
    if ((int)local_58 < 0) goto LAB_6b810912;
    *(int *)(iVar8 + 0x1c) = *(int *)(iVar8 + 0x68);
    iVar10 = (uint)(*(char *)(iVar8 + 0x19) != '\0') * 4 + 4 + *(int *)(iVar8 + 0x68);
    *(int *)(iVar8 + 0x24) = iVar10;
    *(int *)(iVar8 + 0x28) = iVar10 + 0x100000;
    local_58 = NtAllocateVirtualMemory(0xffffffff,iVar8 + 0x20,0,(int *)(iVar8 + 0x28),0x2000,4);
    if (((-1 < (int)local_58) &&
        (local_58 = NtAllocateVirtualMemory(0xffffffff,iVar8 + 0x20,0,iVar8 + 0x24,0x1000,4),
        -1 < (int)local_58)) &&
       (local_58 = NtReadFile(*(undefined4 *)(iVar8 + 0x14),0,0,0,local_30,
                              *(undefined4 *)(iVar8 + 0x20),*(undefined4 *)(iVar8 + 0x1c),0,
                              &DAT_6b8b016c), -1 < (int)local_58)) {
      if (local_2c != *(int *)(iVar8 + 0x1c)) {
        local_58 = 0xc0000011;
      }
      if (-1 < (int)local_58) {
        local_4c[0] = 0xffffffff;
        *(undefined4 *)(iVar8 + 0x2c) = 0xffffffff;
        *(undefined4 *)(iVar8 + 0x30) = 0;
        cVar6 = RtlIsTextUnicode(*(undefined4 *)(iVar8 + 0x20),*(int *)(iVar8 + 0x1c),local_4c);
        puVar4 = *(ushort **)(iVar8 + 0x20);
        iVar10 = *(int *)(iVar8 + 0x1c);
        *(char *)(iVar8 + 0x19) = cVar6;
        puVar13 = (ushort *)(iVar10 + (int)puVar4);
        if (cVar6 == '\0') {
          while (puVar4 < puVar13) {
            puVar13 = (ushort *)((int)puVar13 + -1);
            bVar3 = *(byte *)puVar13;
            if (((0x20 < bVar3) || (bVar3 == 0xd)) || (bVar3 == 10)) break;
            iVar10 = *(int *)(iVar8 + 0x1c) + -1;
            *(int *)(iVar8 + 0x1c) = iVar10;
          }
          puVar13 = (ushort *)((int)puVar4 + iVar10);
          if ((puVar13 <= puVar4) || (*(char *)((int)puVar13 + -1) == '\n')) goto LAB_6b810902;
          *puVar13 = 0xa0d;
          *(int *)(iVar8 + 0x2c) = *(int *)(iVar8 + 0x1c);
          iVar10 = *(int *)(iVar8 + 0x1c) + 2;
        }
        else {
          while (puVar4 < puVar13) {
            puVar13 = puVar13 + -1;
            param_1 = local_44;
            if (((0x20 < *puVar13) || (*puVar13 == 0xd)) || (*puVar13 == 10)) break;
            iVar10 = *(int *)(iVar8 + 0x1c) + -2;
            *(int *)(iVar8 + 0x1c) = iVar10;
          }
          puVar13 = (ushort *)((int)puVar4 + iVar10);
          if ((puVar13 <= puVar4) || (puVar13[-1] == 10)) goto LAB_6b810902;
          *puVar13 = 0xd;
          puVar13[1] = 10;
          *(int *)(iVar8 + 0x2c) = *(int *)(iVar8 + 0x1c);
          iVar10 = *(int *)(iVar8 + 0x1c) + 4;
        }
        *(int *)(iVar8 + 0x1c) = iVar10;
        *(int *)(iVar8 + 0x30) = iVar10;
LAB_6b810902:
        *(int *)(param_1 + 0xc) = iVar8;
        return local_58;
      }
    }
    if (*(char *)(iVar8 + 0x1a) != '\0') {
      local_38 = 0;
      local_34 = 0;
      local_40 = 0xffffffff;
      local_3c = 0xffffffff;
      NtUnlockFile(*(undefined4 *)(iVar8 + 0x14),local_30,&local_38,&local_40,DAT_6b8b016c);
    }
  }
  NtClose(*(undefined4 *)(iVar8 + 0x14));
LAB_6b81092a:
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iVar8);
  return local_58;
}



undefined4 TermsrvConvertSysRootToUserDir(undefined4 param_1,undefined4 param_2)

{
  code *pcVar1;
  undefined4 uVar2;
  
                    // 0x109f0  1429  TermsrvConvertSysRootToUserDir
  pcVar1 = DAT_6b8b08d4;
  if (DAT_6b8b08d4 == (code *)0x0) {
    uVar2 = 0xc0000135;
  }
  else {
    _guard_check_icall();
    uVar2 = (*pcVar1)(param_1,param_2);
  }
  return uVar2;
}



int __fastcall FUN_6b810a0e(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int in_FS_OFFSET;
  undefined local_24 [4];
  int local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  int local_8;
  
  iVar1 = *(int *)(param_1 + 0xc);
  iVar3 = 0;
  if (iVar1 != 0) {
    if (*(int *)(iVar1 + 0x20) != 0) {
      if ((*(int *)(iVar1 + 0x2c) != -1) && (*(char *)(iVar1 + 0x18) != '\0')) {
        local_18 = 0;
        local_1c = *(undefined4 *)(iVar1 + 0x2c);
        local_8 = *(int *)(iVar1 + 0x30) - *(int *)(iVar1 + 0x2c);
        iVar3 = NtWriteFile(*(undefined4 *)(iVar1 + 0x14),0,0,0,local_24,
                            *(int *)(iVar1 + 0x20) + *(int *)(iVar1 + 0x2c),local_8,&local_1c,
                            &DAT_6b8b016c);
        if (-1 < iVar3) {
          if (local_20 == local_8) {
            local_14 = *(undefined4 *)(iVar1 + 0x1c);
            local_10 = 0;
            iVar3 = NtSetInformationFile(*(undefined4 *)(iVar1 + 0x14),local_24,&local_14,8,0x14);
          }
          else {
            iVar3 = -0x3fffff81;
          }
        }
      }
      NtFreeVirtualMemory(0xffffffff,iVar1 + 0x20,(undefined4 *)(iVar1 + 0x28),0x8000);
      *(undefined4 *)(iVar1 + 0x20) = 0;
      *(undefined4 *)(iVar1 + 0x24) = 0;
      *(undefined4 *)(iVar1 + 0x28) = 0;
    }
    if (*(char *)(iVar1 + 0x1a) != '\0') {
      local_14 = 0xffffffff;
      local_10 = 0xffffffff;
      local_1c = 0;
      local_18 = 0;
      NtUnlockFile(*(undefined4 *)(iVar1 + 0x14),local_24,&local_1c,&local_14,DAT_6b8b016c);
    }
    iVar2 = NtClose(*(undefined4 *)(iVar1 + 0x14));
    if (-1 < iVar3) {
      iVar3 = iVar2;
    }
    iVar2 = *(int *)(in_FS_OFFSET + 0x30);
    *(undefined4 *)(iVar1 + 0x14) = 0;
    RtlFreeHeap(*(undefined4 *)(iVar2 + 0x18),0,iVar1);
  }
  return iVar3;
}



undefined4 TermsrvSyncUserIniFileExt(undefined4 param_1)

{
  code *pcVar1;
  undefined4 uVar2;
  
                    // 0x10b30  1441  TermsrvSyncUserIniFileExt
  pcVar1 = DAT_6b8b0868;
  if (DAT_6b8b0868 == (code *)0x0) {
    uVar2 = 0;
  }
  else {
    _guard_check_icall();
    uVar2 = (*pcVar1)(param_1);
  }
  return uVar2;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_6b810b60(int *param_1)

{
  wchar_t wVar1;
  int iVar2;
  ulonglong uVar3;
  code *pcVar4;
  char cVar5;
  wchar_t *pwVar6;
  int iVar7;
  uint uVar8;
  wchar_t *pwVar9;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  uint extraout_EDX_03;
  uint extraout_EDX_04;
  uint extraout_EDX_05;
  uint extraout_EDX_06;
  undefined4 extraout_EDX_07;
  undefined4 extraout_EDX_08;
  undefined4 extraout_EDX_09;
  uint extraout_EDX_10;
  int in_FS_OFFSET;
  undefined8 uVar10;
  ulonglong uVar11;
  ulonglong uVar12;
  int *piVar13;
  ushort *puVar14;
  byte *pbVar15;
  ushort *puVar16;
  undefined4 uVar17;
  uint *puVar18;
  undefined auStack724 [3];
  undefined local_2d1;
  short *psStack720;
  uint uStack716;
  undefined uStack711;
  undefined uStack710;
  undefined uStack709;
  undefined4 uStack708;
  uint uStack704;
  ushort local_2bc [2];
  int iStack696;
  ushort local_2b4 [2];
  int iStack688;
  uint local_2ac;
  undefined *local_2a8;
  byte abStack676 [4];
  int iStack672;
  int iStack668;
  int iStack664;
  int iStack660;
  int aiStack656 [2];
  undefined4 uStack648;
  undefined4 uStack644;
  ushort *puStack640;
  undefined4 uStack636;
  undefined4 uStack632;
  undefined4 uStack628;
  undefined4 uStack624;
  undefined4 uStack620;
  ushort *puStack616;
  undefined4 uStack612;
  undefined4 uStack608;
  undefined4 uStack604;
  undefined auStack600 [16];
  undefined4 auStack584 [10];
  undefined local_220 [532];
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)auStack724;
  local_2a8 = local_220;
  local_2ac = 0x20a0208;
  local_2d1 = 0;
  uVar10 = FUN_6b810bf2();
  pcVar4 = DAT_6b8b0910;
  uVar17 = (undefined4)((ulonglong)uVar10 >> 0x20);
  if ((((int)uVar10 != 0) || (*(char *)(DAT_6b8b083c + 0x808) != '\0')) ||
     (DAT_6b8b0910 == (code *)0x0)) goto LAB_6b810bc4;
  puVar16 = local_2b4;
  puVar14 = local_2bc;
  piVar13 = param_1 + 8;
  _guard_check_icall();
  uVar10 = (*pcVar4)(piVar13,puVar14,puVar16);
  uVar17 = (undefined4)((ulonglong)uVar10 >> 0x20);
  if ((int)uVar10 == 0) goto LAB_6b810bc4;
  pwVar6 = wcsrchr((wchar_t *)param_1[9],L'\\');
  uVar3 = (ulonglong)extraout_EDX << 0x20;
  if (pwVar6 != (wchar_t *)0x0) {
    pwVar9 = pwVar6 + 1;
    do {
      wVar1 = *pwVar9;
      pwVar9 = pwVar9 + 1;
    } while (wVar1 != L'\0');
    uStack704 = ((int)pwVar9 - (int)(pwVar6 + 2) >> 1) * 2 + 2;
    uVar11 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,uStack704);
    pwVar9 = (wchar_t *)uVar11;
    uVar3 = uVar11;
    if (pwVar9 != (wchar_t *)0x0) {
      FUN_6b81fb91(pwVar9,uStack704,(int)(pwVar6 + 1));
      pwVar6 = wcsrchr(pwVar9,L'.');
      if (pwVar6 != (wchar_t *)0x0) {
        *pwVar6 = L'\0';
      }
      pcVar4 = DAT_6b8b09f4;
      uVar3 = uVar11 & 0xffffffff | (ulonglong)extraout_EDX_00 << 0x20;
      if (DAT_6b8b09f4 != (code *)0x0) {
        uVar17 = 2;
        pbVar15 = abStack676;
        pwVar6 = pwVar9;
        _guard_check_icall();
        uVar12 = (*pcVar4)(pwVar6,pbVar15,uVar17);
        uVar3 = uVar12 & 0xffffffff00000000 | uVar11 & 0xffffffff;
        if (((int)uVar12 != 0) &&
           (uVar3 = uVar12 & 0xffffffff00000000 | uVar11 & 0xffffffff,
           (abStack676[0] & 0x44) == 0x44)) {
          uVar12 = FUN_6b85eaf9();
          uVar3 = uVar12 & 0xffffffff00000000 | uVar11 & 0xffffffff;
          if ((int)uVar12 != 0) {
            cVar5 = FUN_6b85ea7d(local_2bc,(int)local_2b4);
            uVar3 = uVar11 & 0xffffffff | (ulonglong)extraout_EDX_01 << 0x20;
            if (cVar5 != '\0') {
              iVar7 = FUN_6b85e920(local_220,iStack688,&psStack720,(int *)&uStack716);
              uVar3 = uVar11 & 0xffffffff | (ulonglong)extraout_EDX_02 << 0x20;
              if (-1 < iVar7) {
                if (*(short *)(iStack688 + -2 + (uint)(local_2b4[0] >> 1) * 2) != 0x5c) {
                  iVar7 = FUN_6b85e884(psStack720,uStack716,&DAT_6b88423c,&psStack720,
                                       (int *)&uStack716);
                  uVar3 = uVar11 & 0xffffffff | (ulonglong)extraout_EDX_03 << 0x20;
                  if (iVar7 < 0) goto LAB_6b826087;
                }
                iVar7 = FUN_6b85e884(psStack720,uStack716,pwVar9,&psStack720,(int *)&uStack716);
                uVar3 = uVar11 & 0xffffffff | (ulonglong)extraout_EDX_04 << 0x20;
                if (-1 < iVar7) {
                  iVar7 = FUN_6b85e884(psStack720,uStack716,L".ctx",&psStack720,(int *)&uStack716);
                  pcVar4 = DAT_6b8b09fc;
                  uVar3 = uVar11 & 0xffffffff | (ulonglong)extraout_EDX_05 << 0x20;
                  if (-1 < iVar7) {
                    local_2ac = local_2ac & 0xffff0000 |
                                (uint)(ushort)((short)psStack720 - (short)local_220);
                    uVar3 = uVar11 & 0xffffffff | (ulonglong)extraout_EDX_05 << 0x20;
                    if (DAT_6b8b09fc != (code *)0x0) {
                      puVar18 = &local_2ac;
                      uVar17 = 0;
                      piVar13 = param_1 + 8;
                      _guard_check_icall();
                      (*pcVar4)(piVar13,uVar17,puVar18);
                      puStack640 = local_2bc;
                      uStack648 = 0x18;
                      uStack644 = 0;
                      uStack636 = 0x40;
                      uStack632 = 0;
                      uStack628 = 0;
                      aiStack656[0] = 0;
                      uVar12 = NtOpenFile(&uStack708,0x120089,&uStack648,aiStack656,3,0x20);
                      uVar3 = uVar12 & 0xffffffff00000000 | uVar11 & 0xffffffff;
                      if ((-1 < (int)uVar12) &&
                         (uVar3 = uVar12 & 0xffffffff00000000 | uVar11 & 0xffffffff,
                         -1 < aiStack656[0])) {
                        uStack711 = *(undefined *)(param_1 + 0x12);
                        iVar7 = *param_1;
                        uStack704 = param_1[10];
                        uStack716 = param_1[0xb];
                        psStack720 = (short *)param_1[0xc];
                        iStack672 = param_1[0xd];
                        iStack668 = param_1[0x13];
                        iStack664 = param_1[0x14];
                        iStack660 = param_1[0x15];
                        uStack710 = *(undefined *)((int)param_1 + 5);
                        uStack709 = *(undefined *)(param_1 + 1);
                        *(undefined2 *)(param_1 + 1) = 1;
                        *param_1 = 2;
                        *(undefined *)(param_1 + 0x12) = 0;
                        uVar8 = FUN_6b81060b((int)param_1);
                        if ((int)uVar8 < 0) {
                          NtClose(uStack708);
                          uVar3 = uVar11 & 0xffffffff | (ulonglong)extraout_EDX_06 << 0x20;
                        }
                        else {
                          iVar2 = param_1[3];
                          param_1[0x19] = *(int *)(iVar2 + 0x1c) + *(int *)(iVar2 + 0x20);
                          param_1[0x17] = *(int *)(iVar2 + 0x20);
                          FUN_6b85ee49(uStack708,param_1,&local_2d1);
                          NtClose(uStack708);
                          FUN_6b810a0e((int)param_1);
                          *(undefined *)(param_1 + 0x12) = uStack711;
                          param_1[10] = uStack704;
                          param_1[0xb] = uStack716;
                          param_1[0xc] = (int)psStack720;
                          param_1[0xd] = iStack672;
                          param_1[0x13] = iStack668;
                          param_1[0x14] = iStack664;
                          param_1[0x15] = iStack660;
                          *(undefined *)((int)param_1 + 5) = uStack710;
                          *(undefined *)(param_1 + 1) = uStack709;
                          puStack616 = local_2bc;
                          *param_1 = iVar7;
                          uStack624 = 0x18;
                          uStack620 = 0;
                          uStack612 = 0x40;
                          uStack608 = 0;
                          uStack604 = 0;
                          uVar12 = NtQueryFullAttributesFile(&uStack624,auStack600);
                          uVar3 = uVar12 & 0xffffffff00000000 | uVar11 & 0xffffffff;
                          if (-1 < (int)uVar12) {
                            FUN_6b85f10e(local_2bc,(int)local_2b4,auStack584);
                            uVar3 = uVar11 & 0xffffffff | (ulonglong)extraout_EDX_10 << 0x20;
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
LAB_6b826087:
  uVar17 = (undefined4)(uVar3 >> 0x20);
  if (iStack696 != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iStack696);
    uVar17 = extraout_EDX_07;
  }
  if (iStack688 != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iStack688);
    uVar17 = extraout_EDX_08;
  }
  if ((int)uVar3 != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,(int)uVar3);
    uVar17 = extraout_EDX_09;
  }
LAB_6b810bc4:
  FUN_6b8224af(local_c ^ (uint)auStack724,uVar17);
  return;
}



bool TermsrvAppInstallMode(void)

{
                    // 0x10be0  1428  TermsrvAppInstallMode
  return *(char *)(DAT_6b8b083c + 0x808) != '\0';
}



void FUN_6b810bf2(void)

{
  undefined4 extraout_EDX;
  undefined4 uVar1;
  undefined8 uVar2;
  undefined local_48 [4];
  undefined4 local_44;
  undefined local_40 [56];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  uVar2 = NtOpenProcessToken(0xffffffff,8,&local_44);
  uVar1 = (undefined4)((ulonglong)uVar2 >> 0x20);
  if (-1 < (int)uVar2) {
    NtQueryInformationToken(local_44,10,local_40,0x38,local_48);
    NtClose(local_44);
    uVar1 = extraout_EDX;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar1);
  return;
}



void __fastcall FUN_6b810c5c(int param_1)

{
  int *piVar1;
  short *psVar2;
  byte bVar3;
  ushort uVar4;
  int iVar5;
  uint uVar6;
  ushort *puVar7;
  byte *pbVar8;
  
  iVar5 = FUN_6b810e4e(param_1);
  if ((-1 < iVar5) && (iVar5 = FUN_6b810cc1(param_1), -1 < iVar5)) {
    if (*(char *)(*(int *)(param_1 + 0xc) + 0x19) == '\0') {
      pbVar8 = *(byte **)(*(int *)(param_1 + 0x88) + 4);
      bVar3 = *pbVar8;
      while ((bVar3 < 0x21 && (**(short **)(param_1 + 0x88) != 0))) {
        pbVar8 = pbVar8 + 1;
        *(byte **)(*(short **)(param_1 + 0x88) + 2) = pbVar8;
        **(short **)(param_1 + 0x88) = **(short **)(param_1 + 0x88) + -1;
        psVar2 = (short *)(*(int *)(param_1 + 0x88) + 2);
        *psVar2 = *psVar2 + -1;
        bVar3 = *pbVar8;
      }
      uVar6 = (uint)**(ushort **)(param_1 + 0x88);
      if (((1 < uVar6) && (bVar3 = *pbVar8, bVar3 == pbVar8[uVar6 - 1])) &&
         ((bVar3 == 0x22 || (bVar3 == 0x27)))) {
        piVar1 = (int *)(*(ushort **)(param_1 + 0x88) + 2);
        *piVar1 = *piVar1 + 1;
        **(short **)(param_1 + 0x88) = **(short **)(param_1 + 0x88) + -2;
        psVar2 = (short *)(*(int *)(param_1 + 0x88) + 2);
        *psVar2 = *psVar2 + -2;
      }
    }
    else {
      puVar7 = *(ushort **)(*(int *)(param_1 + 0xac) + 4);
      uVar4 = *puVar7;
      while ((uVar4 < 0x21 && (**(short **)(param_1 + 0xac) != 0))) {
        puVar7 = puVar7 + 1;
        *(ushort **)(*(short **)(param_1 + 0xac) + 2) = puVar7;
        **(short **)(param_1 + 0xac) = **(short **)(param_1 + 0xac) + -2;
        psVar2 = (short *)(*(int *)(param_1 + 0xac) + 2);
        *psVar2 = *psVar2 + -2;
        uVar4 = *puVar7;
      }
      uVar6 = (uint)**(ushort **)(param_1 + 0xac);
      if (((3 < uVar6) &&
          (uVar4 = *puVar7, uVar4 == *(ushort *)((int)puVar7 + (uVar6 - 2 & 0xfffffffe)))) &&
         ((uVar4 == 0x22 || (uVar4 == 0x27)))) {
        piVar1 = (int *)(*(ushort **)(param_1 + 0xac) + 2);
        *piVar1 = *piVar1 + 2;
        **(short **)(param_1 + 0xac) = **(short **)(param_1 + 0xac) + -4;
        psVar2 = (short *)(*(int *)(param_1 + 0xac) + 2);
        *psVar2 = *psVar2 + -4;
      }
    }
    FUN_6b811136(param_1,*(ushort **)(param_1 + 0x88),*(ushort **)(param_1 + 0xac),'\x01');
    return;
  }
  return;
}



int __fastcall FUN_6b810cc1(int param_1)

{
  bool bVar1;
  char cVar2;
  int iVar3;
  undefined4 uVar4;
  short *psVar5;
  short *local_c;
  short *local_8;
  
  local_8 = (short *)0x0;
  local_c = (short *)0x0;
  iVar3 = FUN_6b810f40(param_1,2);
  psVar5 = (short *)0x0;
  do {
    if (iVar3 != 0x105) {
      return -0x3fffffcc;
    }
    bVar1 = false;
    if (*(int *)(param_1 + 0x84) == 0) {
      if (*(char *)(param_1 + 5) != '\0') {
        uVar4 = FUN_6b81c967(param_1,(short **)0x0,&local_c);
        cVar2 = (char)uVar4;
        psVar5 = local_c;
        goto joined_r0x6b8262e3;
      }
      uVar4 = FUN_6b81c967(param_1,&local_8,(short **)0x0);
      if ((char)uVar4 == '\0') {
        return -0x3ffffff3;
      }
      *(int *)(param_1 + 0x84) = param_1 + 0x70;
      iVar3 = RtlUnicodeStringToAnsiString(param_1 + 0x70,*(undefined4 *)(param_1 + 0xa8),1);
      if (iVar3 < 0) {
        return iVar3;
      }
      bVar1 = true;
    }
    else {
      uVar4 = FUN_6b81c967(param_1,&local_8,(short **)0x0);
      cVar2 = (char)uVar4;
joined_r0x6b8262e3:
      if (cVar2 == '\0') {
        return -0x3ffffff3;
      }
    }
    if ((*(int *)(param_1 + 0x84) == 0) && (*(char *)(param_1 + 5) != '\0')) {
      cVar2 = RtlEqualUnicodeString(psVar5,*(undefined4 *)(param_1 + 0xa8),1);
    }
    else {
      cVar2 = RtlEqualString(local_8,*(int *)(param_1 + 0x84),1);
    }
    iVar3 = (-(uint)(cVar2 != '\0') & 0xfffffefb) + 0x105;
    if (bVar1) {
      RtlFreeAnsiString(*(undefined4 *)(param_1 + 0x84));
    }
    if (iVar3 != 0x105) {
      return iVar3;
    }
    iVar3 = FUN_6b810f40(param_1,2);
    psVar5 = local_c;
  } while( true );
}



uint __fastcall FUN_6b810d68(int param_1)

{
  short *psVar1;
  ushort uVar2;
  short sVar3;
  uint uVar4;
  byte *pbVar5;
  ushort *puVar6;
  undefined *puVar7;
  
  uVar4 = FUN_6b810e4e(param_1);
  if (-1 < (int)uVar4) {
    uVar4 = FUN_6b810f40(param_1,3);
    while (uVar4 == 0x105) {
      if ((*(ushort **)(param_1 + 0x84) != (ushort *)0x0) || (*(int *)(param_1 + 0xa8) != 0)) {
        uVar4 = FUN_6b811136(param_1,*(ushort **)(param_1 + 0x84),*(ushort **)(param_1 + 0xa8),'\0')
        ;
        if ((int)uVar4 < 0) {
          return uVar4;
        }
        puVar7 = (undefined *)0x0;
        if (*(char *)(param_1 + 5) == '\0') {
          puVar7 = &DAT_6b889128;
        }
        uVar4 = FUN_6b81117e(param_1,puVar7,
                             (void *)(-(uint)(*(char *)(param_1 + 5) != '\0') & 0x6b884260),1,'\0');
        if ((int)uVar4 < 0) {
          return uVar4;
        }
      }
      if (*(char *)(*(int *)(param_1 + 0xc) + 0x19) == '\0') {
        puVar6 = *(ushort **)(param_1 + 0x88);
        pbVar5 = *(byte **)(puVar6 + 2);
        uVar2 = *puVar6;
        while ((uVar2 != 0 && (*pbVar5 < 0x21))) {
          pbVar5 = pbVar5 + 1;
          *(byte **)(puVar6 + 2) = pbVar5;
          **(short **)(param_1 + 0x88) = **(short **)(param_1 + 0x88) + -1;
          psVar1 = (short *)(*(int *)(param_1 + 0x88) + 2);
          *psVar1 = *psVar1 + -1;
          puVar6 = *(ushort **)(param_1 + 0x88);
          uVar2 = *puVar6;
        }
      }
      else {
        puVar6 = *(ushort **)(*(short **)(param_1 + 0xac) + 2);
        sVar3 = **(short **)(param_1 + 0xac);
        while ((sVar3 != 0 && (*puVar6 < 0x21))) {
          puVar6 = puVar6 + 1;
          *(ushort **)(*(int *)(param_1 + 0xac) + 4) = puVar6;
          **(short **)(param_1 + 0xac) = **(short **)(param_1 + 0xac) + -2;
          psVar1 = (short *)(*(int *)(param_1 + 0xac) + 2);
          *psVar1 = *psVar1 + -2;
          sVar3 = **(short **)(param_1 + 0xac);
        }
        puVar6 = *(ushort **)(param_1 + 0x88);
      }
      uVar4 = FUN_6b811136(param_1,puVar6,*(ushort **)(param_1 + 0xac),'\x01');
      if ((int)uVar4 < 0) {
        return uVar4;
      }
      uVar4 = FUN_6b810f40(param_1,3);
    }
    uVar4 = -(uint)(uVar4 != 0x8000001a) & uVar4;
  }
  return uVar4;
}



int __fastcall FUN_6b810e4e(int param_1)

{
  bool bVar1;
  char cVar2;
  int iVar3;
  undefined4 uVar4;
  short *psVar5;
  short *local_c;
  short *local_8;
  
  local_8 = (short *)0x0;
  local_c = (short *)0x0;
  iVar3 = FUN_6b810f40(param_1,1);
  psVar5 = (short *)0x0;
  do {
    if (iVar3 != 0x105) {
      return -0x3fffffcc;
    }
    bVar1 = false;
    if (*(int *)(param_1 + 0x80) == 0) {
      if (*(char *)(param_1 + 5) != '\0') {
        uVar4 = FUN_6b81c868(param_1,(short **)0x0,&local_c);
        cVar2 = (char)uVar4;
        psVar5 = local_c;
        goto joined_r0x6b8263e6;
      }
      uVar4 = FUN_6b81c868(param_1,&local_8,(short **)0x0);
      if ((char)uVar4 == '\0') {
        return -0x3ffffff3;
      }
      *(int *)(param_1 + 0x80) = param_1 + 0x68;
      iVar3 = RtlUnicodeStringToAnsiString(param_1 + 0x68,*(undefined4 *)(param_1 + 0xa4),1);
      if (iVar3 < 0) {
        return iVar3;
      }
      bVar1 = true;
    }
    else {
      uVar4 = FUN_6b81c868(param_1,&local_8,(short **)0x0);
      cVar2 = (char)uVar4;
joined_r0x6b8263e6:
      if (cVar2 == '\0') {
        return -0x3ffffff3;
      }
    }
    if ((*(int *)(param_1 + 0x80) == 0) && (*(char *)(param_1 + 5) != '\0')) {
      cVar2 = RtlEqualUnicodeString(psVar5,*(undefined4 *)(param_1 + 0xa4),1);
    }
    else {
      cVar2 = RtlEqualString(local_8,*(int *)(param_1 + 0x80),1);
    }
    iVar3 = (-(uint)(cVar2 != '\0') & 0xfffffefb) + 0x105;
    if (bVar1) {
      RtlFreeAnsiString(*(undefined4 *)(param_1 + 0x80));
    }
    if (iVar3 != 0x105) {
      return iVar3;
    }
    iVar3 = FUN_6b810f40(param_1,1);
    psVar5 = local_c;
  } while( true );
}



uint __fastcall FUN_6b810ef5(int param_1)

{
  uint uVar1;
  
  do {
    uVar1 = FUN_6b810f40(param_1,1);
    if (uVar1 != 0x105) {
      return -(uint)(uVar1 != 0x8000001a) & uVar1;
    }
    uVar1 = FUN_6b811136(param_1,*(ushort **)(param_1 + 0x80),*(ushort **)(param_1 + 0xa4),'\x01');
  } while (-1 < (int)uVar1);
  return uVar1;
}



// WARNING: Removing unreachable block (ram,0x6b82662a)

undefined4 __fastcall FUN_6b810f40(int param_1,int param_2)

{
  ushort *puVar1;
  ushort *puVar2;
  ushort *puVar3;
  ushort *puVar4;
  byte bVar5;
  BOOL BVar6;
  short *psVar7;
  ushort *puVar8;
  ushort *puVar9;
  short sVar10;
  ushort uVar11;
  ushort *puVar12;
  int local_c;
  
  local_c = param_2;
  if (param_2 == 3) {
    local_c = 2;
  }
  puVar8 = *(ushort **)(param_1 + 0x5c);
  puVar2 = *(ushort **)(param_1 + 100);
  puVar12 = puVar8;
  if (*(char *)(*(int *)(param_1 + 0xc) + 0x19) != '\0') {
joined_r0x6b82645e:
    do {
      do {
        puVar8 = puVar12;
        if (puVar2 <= puVar12) {
          return 0x8000001a;
        }
        while( true ) {
          if (puVar2 <= puVar8) goto LAB_6b810ff0;
          if (0x20 < *puVar8) break;
          puVar8 = puVar8 + 1;
        }
        if (puVar2 <= puVar8) goto LAB_6b810ff0;
        *(ushort **)(param_1 + 0x60) = puVar8;
        puVar9 = (ushort *)0x0;
        puVar12 = puVar8;
        do {
          if ((puVar9 == (ushort *)0x0) && (*puVar12 == 0x3d)) {
            puVar9 = puVar12 + 1;
          }
          else {
            uVar11 = *puVar12;
            if ((uVar11 == 0xd) || (uVar11 == 10)) {
              if (uVar11 == 0xd) {
                uVar11 = puVar12[1];
                puVar12 = puVar12 + 1;
              }
              if (uVar11 == 10) {
                puVar12 = puVar12 + 1;
              }
              break;
            }
          }
          puVar12 = puVar12 + 1;
        } while (puVar12 < puVar2);
      } while (*puVar8 == 0x3b);
      if (*puVar8 != 0x5b) {
        puVar3 = puVar9;
        if (param_2 == 3) {
          if (puVar9 != (ushort *)0x0) goto joined_r0x6b826592;
          psVar7 = (short *)0x0;
        }
        else {
          if (puVar9 == (ushort *)0x0) goto joined_r0x6b82645e;
joined_r0x6b826592:
          do {
            puVar4 = puVar3 + -1;
            if (puVar4 <= puVar8) break;
            puVar1 = puVar3 + -2;
            puVar3 = puVar4;
          } while (*puVar1 < 0x21);
          sVar10 = (short)puVar4 - (short)puVar8;
          *(ushort **)(param_1 + 0x98) = puVar8;
          psVar7 = (short *)(param_1 + 0x94);
          *psVar7 = sVar10;
          *(short *)(param_1 + 0x96) = sVar10;
          puVar8 = puVar9;
        }
        *(undefined4 *)(param_1 + 0x84) = 0;
        *(short **)(param_1 + 0xa8) = psVar7;
        for (puVar9 = puVar12; (puVar8 < puVar9 && (puVar9[-1] < 0x21)); puVar9 = puVar9 + -1) {
        }
        sVar10 = (short)puVar9 - (short)puVar8;
        *(ushort **)(param_1 + 0xa0) = puVar8;
        *(short *)(param_1 + 0x9c) = sVar10;
        *(short *)(param_1 + 0x9e) = sVar10;
        *(undefined4 *)(param_1 + 0x88) = 0;
        *(short **)(param_1 + 0xac) = (short *)(param_1 + 0x9c);
        if (local_c == 2) {
LAB_6b82661a:
          *(ushort **)(param_1 + 0x5c) = puVar12;
          return 0x105;
        }
        goto joined_r0x6b82645e;
      }
      do {
        puVar8 = puVar8 + 1;
        if (puVar12 <= puVar8) break;
      } while (*puVar8 < 0x21);
      puVar9 = puVar8;
      if (puVar8 < puVar12) {
        do {
          if (*puVar9 == 0x5d) break;
          puVar9 = puVar9 + 1;
        } while (puVar9 < puVar12);
        for (; (puVar8 < puVar9 && (puVar9[-1] < 0x21)); puVar9 = puVar9 + -1) {
        }
      }
      sVar10 = (short)puVar9 - (short)puVar8;
      *(short *)(param_1 + 0x8c) = sVar10;
      *(ushort **)(param_1 + 0x90) = puVar8;
      *(short *)(param_1 + 0x8e) = sVar10;
      *(undefined4 *)(param_1 + 0x80) = 0;
      *(int *)(param_1 + 0xa4) = param_1 + 0x8c;
      if (local_c == 1) goto LAB_6b82661a;
      if (local_c == 2) {
        return 0x8000001a;
      }
    } while( true );
  }
  if (puVar8 < puVar2) {
    while (puVar8 < puVar2) {
      if (*(byte *)puVar8 < 0x21) {
        puVar8 = (ushort *)((int)puVar8 + 1);
      }
      else {
        if (puVar2 <= puVar8) break;
        *(ushort **)(param_1 + 0x60) = puVar8;
        puVar9 = (ushort *)0x0;
        puVar12 = puVar8;
        do {
          if ((puVar9 != (ushort *)0x0) || (*(byte *)puVar12 != 0x3d)) {
            bVar5 = *(byte *)puVar12;
            if (bVar5 == 0xd) {
              bVar5 = *(byte *)((int)puVar12 + 1);
              puVar12 = (ushort *)((int)puVar12 + 1);
            }
            else if (bVar5 != 10) goto LAB_6b810fb0;
            if (bVar5 == 10) {
              puVar12 = (ushort *)((int)puVar12 + 1);
            }
            break;
          }
          puVar9 = (ushort *)((int)puVar12 + 1);
LAB_6b810fb0:
          puVar12 = (ushort *)((int)puVar12 + 1);
        } while (puVar12 < puVar2);
        if (*(byte *)puVar8 != 0x3b) {
          if (*(byte *)puVar8 == 0x5b) {
            do {
              puVar8 = (ushort *)((int)puVar8 + 1);
              if (puVar12 <= puVar8) break;
            } while (*(byte *)puVar8 < 0x21);
            puVar9 = puVar8;
            if (puVar8 < puVar12) {
              do {
                if (*(byte *)puVar9 == 0x5d) break;
                BVar6 = IsDBCSLeadByte(*(byte *)puVar9);
                if (BVar6 != 0) {
                  puVar9 = (ushort *)((int)puVar9 + 1);
                }
                puVar9 = (ushort *)((int)puVar9 + 1);
              } while (puVar9 < puVar12);
              for (; (puVar8 < puVar9 && (*(byte *)((int)puVar9 + -1) < 0x21));
                  puVar9 = (ushort *)((int)puVar9 + -1)) {
              }
            }
            sVar10 = (short)puVar9 - (short)puVar8;
            *(ushort **)(param_1 + 0x6c) = puVar8;
            *(short *)(param_1 + 0x6a) = sVar10;
            *(short *)(param_1 + 0x68) = sVar10;
            *(short **)(param_1 + 0x80) = (short *)(param_1 + 0x68);
            *(undefined4 *)(param_1 + 0xa4) = 0;
            if (local_c == 1) goto LAB_6b81106d;
            if (local_c == 2) {
              return 0x8000001a;
            }
          }
          else {
            puVar3 = puVar9;
            if (param_2 == 3) {
              if (puVar9 != (ushort *)0x0) goto joined_r0x6b811089;
              psVar7 = (short *)0x0;
            }
            else {
              if (puVar9 == (ushort *)0x0) goto LAB_6b810fdb;
joined_r0x6b811089:
              do {
                puVar4 = (ushort *)((int)puVar3 + -1);
                if (puVar4 <= puVar8) break;
                puVar1 = puVar3 + -1;
                puVar3 = puVar4;
              } while (*(byte *)puVar1 < 0x21);
              sVar10 = (short)puVar4 - (short)puVar8;
              *(ushort **)(param_1 + 0x74) = puVar8;
              psVar7 = (short *)(param_1 + 0x70);
              *psVar7 = sVar10;
              *(short *)(param_1 + 0x72) = sVar10;
              puVar8 = puVar9;
            }
            *(short **)(param_1 + 0x84) = psVar7;
            *(undefined4 *)(param_1 + 0xa8) = 0;
            for (puVar9 = puVar12; (puVar8 < puVar9 && (*(byte *)((int)puVar9 + -1) < 0x21));
                puVar9 = (ushort *)((int)puVar9 + -1)) {
            }
            sVar10 = (short)puVar9 - (short)puVar8;
            *(short *)(param_1 + 0x78) = sVar10;
            *(short *)(param_1 + 0x7a) = sVar10;
            *(ushort **)(param_1 + 0x7c) = puVar8;
            *(short **)(param_1 + 0x88) = (short *)(param_1 + 0x78);
            *(undefined4 *)(param_1 + 0xac) = 0;
            if (local_c == 2) {
LAB_6b81106d:
              *(ushort **)(param_1 + 0x5c) = puVar12;
              return 0x105;
            }
          }
        }
LAB_6b810fdb:
        puVar8 = puVar12;
        if (puVar2 <= puVar12) {
          return 0x8000001a;
        }
      }
    }
LAB_6b810ff0:
    *(ushort **)(param_1 + 0x5c) = puVar8;
  }
  return 0x8000001a;
}



int __fastcall FUN_6b811136(int param_1,ushort *param_2,ushort *param_3,char param_4)

{
  ushort uVar1;
  int iVar2;
  void *pvVar3;
  void *pvVar4;
  
  if (param_2 == (ushort *)0x0) {
    if (param_3 == (ushort *)0x0) {
      return -0x3ffffff3;
    }
    uVar1 = *param_3 >> 1;
    pvVar3 = (void *)0x0;
    pvVar4 = *(void **)(param_3 + 2);
  }
  else {
    if (param_3 != (ushort *)0x0) {
      return -0x3ffffff3;
    }
    uVar1 = *param_2;
    pvVar3 = *(void **)(param_2 + 2);
    pvVar4 = (void *)0x0;
  }
  iVar2 = FUN_6b81117e(param_1,pvVar3,pvVar4,(uint)uVar1,param_4);
  return iVar2;
}



int __fastcall FUN_6b81117e(int param_1,void *param_2,void *param_3,uint param_4,char param_5)

{
  uint uVar1;
  int iVar2;
  void *_Dst;
  size_t _Size;
  int local_c;
  int local_8;
  
  uVar1 = param_4;
  local_8 = 0;
  local_c = param_1;
  if (param_2 == (void *)0x0) {
    if (param_3 == (void *)0x0) goto LAB_6b811203;
    if ((*(char *)(param_1 + 5) == '\0') &&
       (iVar2 = RtlUnicodeToMultiByteSize(&param_4,param_3,param_4 * 2), iVar2 < 0)) {
      return iVar2;
    }
    iVar2 = *(int *)(param_1 + 0x4c);
    if (*(uint *)(param_1 + 0x50) <= iVar2 + param_4) {
      param_4 = *(int *)(param_1 + 0x50) - iVar2;
      local_8 = -0x7ffffffb;
      if (param_4 != 0) {
        param_4 = param_4 - 1;
      }
    }
    if (param_4 == 0) goto LAB_6b811203;
    if (*(char *)(param_1 + 5) == '\0') {
      iVar2 = RtlUnicodeToMultiByteN
                        (*(int *)(param_1 + 0x54) + iVar2,param_4,&local_c,param_3,uVar1 * 2);
      goto LAB_6b8111f9;
    }
    _Size = param_4 * 2;
    _Dst = (void *)(*(int *)(param_1 + 0x58) + iVar2 * 2);
    param_2 = param_3;
LAB_6b81126d:
    memcpy(_Dst,param_2,_Size);
  }
  else {
    if (param_3 != (void *)0x0) {
      return -0x3ffffff3;
    }
    if (*(char *)(param_1 + 5) != '\0') {
      iVar2 = RtlMultiByteToUnicodeSize(&param_4,param_2,param_4);
      if (iVar2 < 0) {
        return iVar2;
      }
      param_4 = param_4 >> 1;
    }
    iVar2 = *(int *)(param_1 + 0x4c);
    if (*(uint *)(param_1 + 0x50) <= iVar2 + param_4) {
      param_4 = *(int *)(param_1 + 0x50) - iVar2;
      local_8 = -0x7ffffffb;
      if (param_4 != 0) {
        param_4 = param_4 - 1;
      }
    }
    if (param_4 == 0) goto LAB_6b811203;
    if (*(char *)(param_1 + 5) == '\0') {
      _Dst = (void *)(*(int *)(param_1 + 0x54) + iVar2);
      _Size = param_4;
      goto LAB_6b81126d;
    }
    iVar2 = RtlMultiByteToUnicodeN
                      (*(int *)(param_1 + 0x58) + iVar2 * 2,param_4 * 2,&local_c,param_2,uVar1);
LAB_6b8111f9:
    if (iVar2 < 0) {
      return iVar2;
    }
  }
  *(int *)(param_1 + 0x4c) = *(int *)(param_1 + 0x4c) + param_4;
LAB_6b811203:
  if (param_5 != '\0') {
    iVar2 = *(int *)(param_1 + 0x4c);
    if (iVar2 + 1U < *(uint *)(param_1 + 0x50)) {
      if (*(char *)(param_1 + 5) == '\0') {
        *(undefined *)(iVar2 + *(int *)(param_1 + 0x54)) = 0;
      }
      else {
        *(undefined2 *)(*(int *)(param_1 + 0x58) + iVar2 * 2) = 0;
      }
      *(int *)(param_1 + 0x4c) = *(int *)(param_1 + 0x4c) + 1;
    }
    else {
      local_8 = -0x7ffffffb;
    }
  }
  return local_8;
}



UINT GetPrivateProfileIntW(LPCWSTR lpAppName,LPCWSTR lpKeyName,INT nDefault,LPCWSTR lpFileName)

{
  DWORD DVar1;
  UINT UVar2;
  int iVar3;
  undefined4 extraout_EDX;
  undefined4 uVar4;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined auStack552 [4];
  undefined4 local_224;
  short local_220;
  short local_21e;
  WCHAR *local_21c;
  undefined local_218 [4];
  undefined4 local_214;
  WCHAR local_210 [258];
  uint local_c;
  
                    // 0x112c0  683  GetPrivateProfileIntW
  local_c = DAT_6b8b0140 ^ (uint)auStack552;
  local_224 = 0;
  DVar1 = GetPrivateProfileStringW(lpAppName,lpKeyName,(LPCWSTR)0x0,local_210,0x100,lpFileName);
  uVar4 = extraout_EDX;
  if (DVar1 != 0) {
    local_220 = (short)DVar1 * 2;
    local_21c = local_210;
    local_21e = local_220 + 2;
    iVar3 = RtlUnicodeStringToAnsiString(local_218,&local_220,1);
    if (-1 < iVar3) {
      iVar3 = RtlCharToInteger(local_214,0,&local_224);
      RtlFreeAnsiString(local_218);
      if (-1 < iVar3) {
        RtlSetLastWin32Error(0);
        uVar4 = extraout_EDX_00;
        goto LAB_6b811307;
      }
    }
    BaseSetLastNTError(iVar3);
    uVar4 = extraout_EDX_01;
  }
LAB_6b811307:
  UVar2 = FUN_6b8224af(local_c ^ (uint)auStack552,uVar4);
  return UVar2;
}



DWORD GetPrivateProfileSectionNamesW(LPWSTR lpszReturnBuffer,DWORD nSize,LPCWSTR lpFileName)

{
  DWORD DVar1;
  
                    // 0x11390  686  GetPrivateProfileSectionNamesW
  DVar1 = GetPrivateProfileStringW
                    ((LPCWSTR)0x0,(LPCWSTR)0x0,(LPCWSTR)0x0,lpszReturnBuffer,nSize,lpFileName);
  return DVar1;
}



DWORD GetPrivateProfileStringW
                (LPCWSTR lpAppName,LPCWSTR lpKeyName,LPCWSTR lpDefault,LPWSTR lpReturnedString,
                DWORD nSize,LPCWSTR lpFileName)

{
  wchar_t wVar1;
  uint uVar2;
  wchar_t *pwVar3;
  uint _MaxCount;
  DWORD local_8;
  
                    // 0x113c0  689  GetPrivateProfileStringW
  if (lpDefault == (LPCWSTR)0x0) {
    lpDefault = L"";
  }
  _MaxCount = 0;
  local_8 = nSize;
  uVar2 = BaseDllReadWriteIniFile
                    ('\x01','\0','\0',lpFileName,lpAppName,lpKeyName,lpReturnedString,
                     (int *)&local_8);
  if ((int)uVar2 < 0) {
    if (uVar2 == 0x80000005) {
      if ((lpAppName == (LPCWSTR)0x0) || (lpKeyName == (LPCWSTR)0x0)) {
        if (1 < nSize) {
          _MaxCount = nSize - 2;
          lpReturnedString[nSize - 1] = L'\0';
        }
      }
      else if (nSize != 0) {
        _MaxCount = nSize - 1;
      }
    }
    else {
      pwVar3 = lpDefault;
      do {
        wVar1 = *pwVar3;
        pwVar3 = pwVar3 + 1;
      } while (wVar1 != L'\0');
      _MaxCount = (int)pwVar3 - (int)(lpDefault + 1) >> 1;
      if (_MaxCount != 0) {
        pwVar3 = lpDefault + (_MaxCount - 1);
        do {
          if (*pwVar3 != L' ') break;
          pwVar3 = pwVar3 + -1;
          _MaxCount = _MaxCount - 1;
        } while (_MaxCount != 0);
      }
      if (nSize == 0) {
        BaseSetLastNTError(uVar2);
        return 0;
      }
      if (nSize <= _MaxCount) {
        _MaxCount = nSize - 1;
      }
      wcsncpy_s(lpReturnedString,nSize,lpDefault,_MaxCount);
    }
  }
  else {
    RtlSetLastWin32Error(0);
    _MaxCount = local_8 - 1;
  }
  if (_MaxCount < nSize) {
    lpReturnedString[_MaxCount] = L'\0';
  }
  else if (nSize != 0) {
    lpReturnedString[nSize - 1] = L'\0';
  }
  if ((int)uVar2 < 0) {
    BaseSetLastNTError(uVar2);
  }
  else {
    RtlSetLastWin32Error(0);
  }
  return _MaxCount;
}



void __fastcall FUN_6b81148a(int param_1,int param_2,uint **param_3)

{
  char cVar1;
  int iVar2;
  uint *extraout_EDX;
  uint *puVar3;
  uint *extraout_EDX_00;
  uint *puVar4;
  ulonglong uVar5;
  undefined2 *puVar6;
  undefined local_23c [8];
  undefined local_234 [8];
  uint **local_22c;
  uint local_228;
  int local_224;
  undefined2 local_220 [266];
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_22c = param_3;
  *param_3 = (uint *)0x0;
  local_228 = 0;
  local_224 = 0;
  RtlInitUnicodeString(local_23c,L"win.ini");
  iVar2 = TermsrvGetWindowsDirectoryW(local_220,0x104);
  if (iVar2 == 0) {
    puVar6 = &DAT_6b884240;
  }
  else {
    puVar6 = local_220;
  }
  RtlInitUnicodeString(local_234,puVar6);
  if (*(int *)(param_1 + 4) != *(int *)(param_2 + 4)) {
    iVar2 = KernelBaseGetGlobalData();
    cVar1 = RtlPrefixUnicodeString(iVar2 + 8,param_1,1);
    if ((cVar1 == '\0') && (cVar1 = RtlEqualUnicodeString(param_2,local_23c,1), cVar1 != '\0')) {
      uVar5 = RtlGetSuiteMask();
      puVar3 = (uint *)(uVar5 >> 0x20);
      if (((uVar5 & 0x10) == 0) ||
         (cVar1 = RtlPrefixUnicodeString(local_234,param_1,1), puVar3 = extraout_EDX_00,
         cVar1 == '\0')) goto LAB_6b8115cf;
    }
  }
  if ((*DAT_6b8b07cc | DAT_6b8b07cc[1]) != 0) {
    for (puVar4 = (uint *)((*DAT_6b8b07cc - *(int *)(DAT_6b8b083c + 0x9e8)) + DAT_6b8b083c);
        puVar4 != (uint *)0x0;
        puVar4 = (uint *)((*puVar4 - *(int *)(DAT_6b8b083c + 0x9e8)) + DAT_6b8b083c)) {
      local_228 = puVar4[2];
      if ((puVar4[4] | puVar4[5]) == 0) {
        local_224 = 0;
      }
      else {
        local_224 = (puVar4[4] - *(int *)(DAT_6b8b083c + 0x9e8)) + DAT_6b8b083c;
      }
      cVar1 = RtlEqualUnicodeString(param_2,&local_228,1);
      puVar3 = extraout_EDX;
      if (cVar1 != '\0') goto LAB_6b8115c7;
      if ((*puVar4 | puVar4[1]) == 0) break;
    }
  }
  puVar3 = DAT_6b8b07cc;
  if ((DAT_6b8b07cc[2] | DAT_6b8b07cc[3]) == 0) {
    puVar4 = (uint *)0x0;
  }
  else {
    puVar4 = (uint *)((DAT_6b8b07cc[2] - *(int *)(DAT_6b8b083c + 0x9e8)) + DAT_6b8b083c);
  }
LAB_6b8115c7:
  *local_22c = puVar4;
LAB_6b8115cf:
  FUN_6b8224af(local_c ^ (uint)&stack0xfffffffc,puVar3);
  return;
}



BOOL IsBadStringPtrA(LPCSTR lpsz,UINT_PTR ucchMax)

{
  int iVar1;
  BOOL BVar2;
  int *in_FS_OFFSET;
  char *local_20;
  undefined local_14 [16];
  
                    // 0x11600  892  IsBadStringPtrA
  iVar1 = *in_FS_OFFSET;
  *in_FS_OFFSET = (int)local_14;
  if (ucchMax != 0) {
    if (lpsz == (LPCSTR)0x0) {
      BVar2 = 1;
      goto LAB_6b81166c;
    }
    for (local_20 = lpsz; (*local_20 != '\0' && (local_20 != lpsz + (ucchMax - 1)));
        local_20 = local_20 + 1) {
    }
  }
  BVar2 = 0;
LAB_6b81166c:
  *in_FS_OFFSET = iVar1;
  return BVar2;
}



BOOL IsDBCSLeadByte(BYTE TestChar)

{
  BOOL BVar1;
  
                    // 0x11690  898  IsDBCSLeadByte
                    // WARNING: Could not recover jumptable at 0x6b811696. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = IsDBCSLeadByte(TestChar);
  return BVar1;
}



HANDLE CreateFileMappingA(HANDLE hFile,LPSECURITY_ATTRIBUTES lpFileMappingAttributes,DWORD flProtect
                         ,DWORD dwMaximumSizeHigh,DWORD dwMaximumSizeLow,LPCSTR lpName)

{
  int iVar1;
  code *pcVar2;
  HANDLE pvVar3;
  undefined local_14 [8];
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x116b0  202  CreateFileMappingA
  if (lpName == (LPCSTR)0x0) {
    local_8 = (LPCWSTR)0x0;
LAB_6b8116fb:
    pvVar3 = CreateFileMappingNumaW
                       (hFile,lpFileMappingAttributes,flProtect,dwMaximumSizeHigh,dwMaximumSizeLow,
                        local_8,0xffffffff);
    if (lpName != (LPCSTR)0x0) {
      RtlFreeUnicodeString(local_c);
    }
  }
  else {
    iVar1 = RtlInitAnsiStringEx(local_14,lpName);
    if (iVar1 < 0) {
LAB_6b826e5e:
      RtlSetLastWin32Error(0xce);
    }
    else {
      pcVar2 = (code *)GetEightBitStringToUnicodeStringRoutine(local_c,local_14,1);
      _guard_check_icall();
      iVar1 = (*pcVar2)();
      if (-1 < iVar1) goto LAB_6b8116fb;
      if (iVar1 == -0x7ffffffb) goto LAB_6b826e5e;
      BaseSetLastNTError(iVar1);
    }
    pvVar3 = (HANDLE)0x0;
  }
  return pvVar3;
}



// WARNING: Removing unreachable block (ram,0x6b8280b5)
// WARNING: Could not reconcile some variable overlaps

void FUN_6b811740(int param_1,uint param_2,short *param_3,uint param_4,undefined *param_5,
                 int param_6)

{
  byte *pbVar1;
  undefined2 uVar2;
  undefined4 uVar3;
  undefined uVar4;
  byte bVar5;
  byte bVar6;
  char cVar7;
  int iVar8;
  int iVar9;
  ushort *puVar10;
  byte *pbVar11;
  byte bVar12;
  undefined2 *puVar13;
  uint uVar14;
  undefined2 *extraout_EDX;
  undefined2 *puVar15;
  undefined2 *extraout_EDX_00;
  undefined2 *extraout_EDX_01;
  undefined2 *extraout_EDX_02;
  ushort *puVar16;
  undefined2 *puVar17;
  byte *pbVar18;
  uint uVar19;
  ushort uVar20;
  ushort uVar21;
  int iVar22;
  undefined *puVar23;
  undefined *puVar24;
  ushort *puVar25;
  int in_FS_OFFSET;
  DWORD dwErrCode;
  undefined2 *local_e44;
  int local_e3c;
  undefined2 local_e38 [2];
  byte local_e34;
  undefined local_e33;
  undefined local_e32;
  int local_e30;
  int local_e2c;
  int local_e28;
  byte local_e24;
  int local_e20;
  int local_e1c;
  int local_e18;
  int local_e14;
  int local_e10;
  int local_e0c;
  undefined2 *local_e08;
  undefined2 *local_e04;
  undefined2 *local_e00;
  byte *local_dfc;
  undefined2 *local_df8;
  ushort *local_df4;
  ushort *local_df0;
  int local_dec;
  undefined2 *local_de8;
  undefined2 *local_de4;
  undefined2 *local_de0;
  byte *local_ddc;
  undefined2 *local_dd8;
  ushort *local_dd4;
  ushort *local_dc8;
  undefined2 *local_dc4;
  ushort *local_dc0;
  byte *local_dbc;
  uint local_db8;
  ushort *local_db4;
  int local_db0;
  ushort *local_dac;
  uint local_da8;
  undefined2 *local_da4;
  ushort *local_da0;
  ushort *local_d9c;
  ushort *local_d98;
  undefined2 *local_d94;
  undefined2 *local_d90;
  ushort *local_d8c;
  undefined2 local_d88 [1728];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  iVar8 = FUN_6b811ea6(param_1,param_2,(int)param_3,param_4,(int)param_5,param_6);
  puVar15 = extraout_EDX;
  if (iVar8 == 0) goto LAB_6b811b51;
  if ((int)param_4 < 0) {
    iVar8 = FUN_6b8502c0(param_3);
    param_4 = iVar8 + 1;
  }
  if ((int)param_4 < 0x41) {
    local_e08 = local_d88;
    local_dec = 0xc0;
LAB_6b8117a8:
    FUN_6b811d83(&local_e30,param_1,param_2,(int)param_3,param_4);
    local_e44 = local_e04;
    local_e3c = 2;
    local_d8c = local_dd4;
    if (local_dd4 < local_df0) {
      local_dc0 = local_dc8;
      local_dbc = local_ddc;
      local_da4 = local_de0;
      local_dc4 = local_dd8;
      local_d90 = local_de4;
      local_d94 = local_de8;
      do {
        puVar15 = local_d94;
        uVar20 = *local_dd4;
        local_db8 = (uint)uVar20;
        uVar14 = local_db8;
        if (local_e2c != 0) {
          uVar14 = *(int *)(local_e2c + (uint)(uVar20 >> 8) * 4) + (local_db8 & 0xff);
        }
        local_da0 = (ushort *)(DAT_6b8b0800 + uVar14 * 4);
        bVar5 = *(byte *)((int)local_da0 + 1);
        local_d8c = local_dd4;
        if (bVar5 < 0xd) {
          puVar13 = local_da4;
          if (bVar5 < 5) {
            if (bVar5 == 4) {
              iVar8 = FUN_6b85037c(local_e2c,local_dd4,local_df0,local_e38,&local_e34);
              if (iVar8 < 1) {
                uVar4 = *(undefined *)local_da0;
                *(undefined *)((int)puVar15 + 1) = *(undefined *)(local_da0 + 1);
                *(undefined *)puVar15 = uVar4;
                *(undefined *)local_d90 = 2;
                bVar5 = *(byte *)((int)local_da0 + 3) & 0x3f;
LAB_6b82815a:
                local_d94 = puVar15 + 1;
                *(byte *)local_da4 = bVar5;
                puVar13 = (undefined2 *)((int)local_da4 + 1);
                local_d90 = (undefined2 *)((int)local_d90 + 1);
              }
              else {
                *(char *)((int)puVar15 + 1) = (char)local_e38[0];
                *(char *)puVar15 = (char)((ushort)local_e38[0] >> 8);
                *(byte *)((int)puVar15 + 3) = local_e34;
                *(undefined *)(puVar15 + 1) = 0xff;
                *(undefined *)((int)puVar15 + 5) = local_e33;
                *(undefined *)(puVar15 + 2) = 0xff;
                *(undefined *)((int)puVar15 + 7) = local_e32;
                *(undefined *)(puVar15 + 3) = 0xff;
                local_d94 = puVar15 + 4;
                *(undefined *)local_d90 = 2;
                local_d90 = (undefined2 *)((int)local_d90 + 1);
                *(undefined *)local_da4 = 2;
                local_dd4 = local_dd4 + iVar8 + -1;
                puVar13 = (undefined2 *)((int)local_da4 + 1);
              }
            }
            else if (bVar5 == 0) {
              if (uVar20 == 0xdb40) {
                puVar10 = local_dd4 + 1;
                if (puVar10 < local_df0) {
                  uVar20 = *puVar10;
                }
                else {
                  uVar20 = 0;
                }
                if ((ushort)(uVar20 + 0x2300) < 0xf0) {
                  local_dd4 = puVar10;
                }
              }
            }
            else if (bVar5 == 1) {
              if (local_e04 < local_d90) {
                if (local_e14 == 0) {
                  cVar7 = *(char *)(local_da0 + 1);
                }
                else {
                  cVar7 = '\x02';
                }
                *(char *)((int)local_d90 + -1) = *(char *)((int)local_d90 + -1) + cVar7;
              }
              else {
                if (local_e14 == 0) {
                  uVar4 = *(undefined *)(local_da0 + 1);
                }
                else {
                  uVar4 = 2;
                }
                *(undefined *)local_d90 = uVar4;
                local_d90 = (undefined2 *)((int)local_d90 + 1);
              }
            }
            else {
              if (bVar5 == 2) {
                do {
                  puVar13 = local_d94;
                  if (local_e2c == 0) {
                    uVar14 = (uint)*(ushort *)(local_e28 + (uint)local_da0[1] * 4);
                  }
                  else {
                    uVar20 = *(ushort *)(local_e28 + (uint)local_da0[1] * 4);
                    uVar14 = *(int *)(local_e2c + (uint)(uVar20 >> 8) * 4) + (uVar20 & 0xff);
                  }
                  puVar17 = (undefined2 *)(DAT_6b8b0800 + uVar14 * 4);
                  uVar2 = *puVar17;
                  *(char *)((int)puVar13 + 1) = (char)uVar2;
                  *(char *)puVar13 = (char)((ushort)uVar2 >> 8);
                  puVar15 = puVar13 + 1;
                  if ((local_e14 == 0) ||
                     ((0x14 < *(byte *)((int)puVar17 + 1) && (*(byte *)((int)puVar17 + 1) != 0x29)))
                     ) {
                    uVar4 = *(undefined *)(puVar17 + 1);
                  }
                  else {
                    uVar4 = 2;
                  }
                  *(undefined *)local_d90 = uVar4;
                  if ((local_e18 == 0) ||
                     ((0x14 < *(byte *)((int)puVar17 + 1) && (*(byte *)((int)puVar17 + 1) != 0x29)))
                     ) {
                    bVar5 = *(byte *)((int)puVar17 + 3) & 0x3f;
                  }
                  else {
                    bVar5 = 2;
                  }
                  local_d90 = (undefined2 *)((int)local_d90 + 1);
                  *(byte *)local_da4 = bVar5 & local_e24;
                  local_da4 = (undefined2 *)((int)local_da4 + 1);
                  uVar20 = *(ushort *)(local_e28 + 2 + (uint)local_da0[1] * 4);
                  uVar14 = (uint)uVar20;
                  if (local_e2c != 0) {
                    uVar14 = *(int *)(local_e2c + (uint)(uVar20 >> 8) * 4) + (uVar14 & 0xff);
                  }
                  local_da0 = (ushort *)(DAT_6b8b0800 + uVar14 * 4);
                  local_d94 = puVar15;
                } while (*(char *)((int)local_da0 + 1) == '\x02');
                bVar5 = 2;
                uVar20 = *local_da0;
                *(char *)((int)puVar13 + 3) = (char)uVar20;
                *(char *)puVar15 = (char)(uVar20 >> 8);
                if ((local_e14 == 0) ||
                   ((bVar6 = bVar5, 0x14 < *(byte *)((int)local_da0 + 1) &&
                    (*(byte *)((int)local_da0 + 1) != 0x29)))) {
                  bVar6 = *(byte *)(local_da0 + 1);
                }
                *(byte *)local_d90 = bVar6;
                if ((local_e18 == 0) ||
                   ((0x14 < *(byte *)((int)local_da0 + 1) && (*(byte *)((int)local_da0 + 1) != 0x29)
                    ))) {
                  bVar5 = *(byte *)((int)local_da0 + 3) & 0x3f;
                }
                bVar5 = bVar5 & local_e24;
                goto LAB_6b82815a;
              }
              if (bVar5 == 3) {
                bVar6 = *(byte *)((int)local_da0 + 3) & local_e24;
                bVar5 = *(byte *)local_da0;
                puVar10 = local_dd4;
                if (bVar5 < 2) {
                  do {
                    while( true ) {
                      puVar10 = puVar10 + -1;
                      uVar20 = 0xffff;
                      if (puVar10 < local_df4) goto LAB_6b827dc0;
                      uVar14 = (uint)*puVar10;
                      if (local_e2c != 0) {
                        uVar14 = (uVar14 & 0xff) + *(int *)(local_e2c + (uint)(*puVar10 >> 8) * 4);
                      }
                      uVar3 = *(undefined4 *)(DAT_6b8b0800 + uVar14 * 4);
                      bVar12 = (byte)((uint)uVar3 >> 8);
                      if (2 < bVar12) break;
                      if (bVar12 == 2) goto LAB_6b827dc0;
                    }
                    uVar20 = (ushort)uVar3;
                    if (bVar12 != 3) goto LAB_6b827dc0;
                  } while ((byte)uVar3 < 2);
                  uVar21 = uVar20 & 0xff | 0x2200;
                  local_db4 = (ushort *)(uint)uVar21;
                  bVar12 = (byte)((uint)uVar3 >> 0x18) & local_e24;
                  *local_dbc = bVar12 & 0xc6 | 0xc4;
                  local_dbc[local_dec * 2] = bVar12 & 0xe4 | 0xc4;
                  if (bVar5 == 0) {
                    local_dbc[local_dec] = 4;
                    local_dbc[local_dec * 3] = bVar12 & 0xc5 | 0xc4;
                  }
                  else {
                    uVar21 = uVar20 & 0x87 | 0x2200;
                    local_dbc[local_dec] = 5;
                    local_dbc[local_dec * 3] = bVar6 & 0xc5 | 0xc4;
                  }
                  local_dbc = local_dbc + 1;
                  uVar20 = uVar21;
                }
                else {
                  *local_dbc = bVar6 & 0xc6 | 0xc4;
                  local_dbc[local_dec] = 3;
                  local_dbc[local_dec * 2] = bVar6 & 0xe4 | 0xc4;
                  local_dbc[local_dec * 3] = bVar6 & 0xc5 | 0xc4;
                  local_dbc = local_dbc + 1;
                  uVar20 = bVar5 | 0x2200;
                }
LAB_6b827dc0:
                if ((local_e14 == 0) ||
                   ((0x14 < *(byte *)((int)local_da0 + 1) && (*(byte *)((int)local_da0 + 1) != 0x29)
                    ))) {
                  uVar4 = *(undefined *)(local_da0 + 1);
                }
                else {
                  uVar4 = 2;
                }
                *(undefined *)local_d90 = uVar4;
                *(undefined *)local_da4 = 2;
                cVar7 = (char)(uVar20 >> 8);
                *(char *)local_d94 = cVar7;
                puVar15 = local_d94 + 1;
                *(char *)((int)local_d94 + 1) = (char)uVar20;
                if (((byte)(cVar7 + 0x57U) < 7) ||
                   ((local_e0c != 0 && ((byte)(cVar7 + 0x40U) < 0x30)))) {
                  if (local_dd4 + -1 < local_df4) {
                    *(undefined *)puVar15 = 0;
                  }
                  else {
                    uVar21 = local_dd4[-1];
                    uVar14 = (uint)uVar21;
                    if (local_e2c != 0) {
                      uVar14 = *(int *)(local_e2c + (uint)(uVar21 >> 8) * 4) + (uVar14 & 0xff);
                    }
                    *(undefined *)puVar15 = *(undefined *)(DAT_6b8b0800 + uVar14 * 4 + 2);
                  }
                  puVar15 = (undefined2 *)((int)local_d94 + 3);
                }
                local_d94 = puVar15;
                if (uVar20 != 0xffff) {
                  puVar13 = (undefined2 *)((int)local_da4 + 1);
                  local_d90 = (undefined2 *)((int)local_d90 + 1);
                }
              }
            }
          }
          else if (bVar5 == 5) {
            *local_d94 = 0xfffd;
            uVar4 = *(undefined *)local_da0;
            *(undefined *)((int)local_d94 + 3) = *(undefined *)(local_da0 + 1);
            *(undefined *)(local_d94 + 1) = uVar4;
            *(undefined *)local_d90 = 2;
            *(undefined *)local_da4 = 2;
            puVar13 = (undefined2 *)((int)local_da4 + 1);
            local_d94 = local_d94 + 2;
            local_d90 = (undefined2 *)((int)local_d90 + 1);
          }
          else if (bVar5 == 6) {
            if (local_e20 != 0) goto LAB_6b811a0b;
            uVar20 = ~(ushort)((uint)((int)local_d94 - (int)local_e08) >> 1);
            uVar14 = 2;
            uVar21 = 2;
            if (uVar20 < 2) {
              uVar20 = 2;
            }
            *(char *)local_dc4 = (char)(uVar20 >> 8);
            local_da8._0_1_ = (undefined)uVar20;
            *(undefined *)((int)local_dc4 + 1) = (undefined)local_da8;
            local_da8._0_2_ = (ushort)*(byte *)local_da0 * 0x100;
            if ((local_e14 == 0) ||
               ((0x14 < *(byte *)((int)local_da0 + 1) && (*(byte *)((int)local_da0 + 1) != 0x29))))
            {
              uVar14 = (uint)*(byte *)(local_da0 + 1);
            }
            if ((local_e18 == 0) ||
               ((0x14 < *(byte *)((int)local_da0 + 1) && (*(byte *)((int)local_da0 + 1) != 0x29))))
            {
              uVar21 = (ushort)(*(byte *)((int)local_da0 + 3) & 0x3f);
            }
            uVar20 = (short)local_da8 + (local_e24 & uVar21 | (ushort)(uVar14 << 3));
            local_da8 = (uint)uVar20;
            *(char *)(local_dc4 + 1) = (char)(local_da8 >> 8);
            local_da8._0_1_ = (undefined)uVar20;
            *(undefined *)((int)local_dc4 + 3) = (undefined)local_da8;
            local_dc4 = local_dc4 + 2;
          }
          else if ((6 < bVar5) && (bVar5 < 0xd)) {
LAB_6b811a0b:
            if (local_e1c == 0) {
              uVar20 = *local_da0;
              *(char *)((int)local_d94 + 1) = (char)uVar20;
              *(char *)local_d94 = (char)(uVar20 >> 8);
              *(undefined *)local_d90 = *(undefined *)(local_da0 + 1);
              *(byte *)local_da4 = *(byte *)((int)local_da0 + 3) & local_e24 & 0x3f;
              puVar13 = (undefined2 *)((int)local_da4 + 1);
              local_d94 = local_d94 + 1;
              local_d90 = (undefined2 *)((int)local_d90 + 1);
            }
          }
        }
        else {
          uVar14 = *(uint *)(local_e30 + 0x104);
          local_da8 = uVar14;
          if (uVar14 != 0) {
            local_dc0 = (ushort *)0x0;
            local_db0 = 0;
            bVar5 = *(byte *)((int)local_da0 + 3) & 0xc0;
            if (bVar5 == 0x40) {
LAB_6b8276ea:
              uVar20 = *(ushort *)(uVar14 + 10);
              puVar10 = (ushort *)(*(uint *)(local_e30 + 0xfc) & 0x20);
              local_dac = puVar10;
              if ((uVar20 != 0) && (local_d8c + (puVar10 != (ushort *)0x0) + 2 <= local_df0)) {
                if (local_db0 == 0) {
                  local_db0 = FUN_6b85026b(local_d8c,local_df0,3,*(ushort *)(uVar14 + 4),
                                           *(ushort *)(uVar14 + 6),(int)puVar10,0);
                }
                if (2 < local_db0) {
                  iVar9 = 0;
                  iVar8 = uVar20 - 1;
                  local_d9c = (ushort *)0x0;
                  local_d98 = (ushort *)0x0;
                  if (puVar10 != (ushort *)0x0) {
                    if (local_d8c + 3 < local_df0) {
                      uVar14 = local_db8;
                      if (local_e2c != 0) {
                        uVar14 = (local_db8 & 0xff) + *(int *)(local_e2c + (local_db8 >> 8) * 4);
                      }
                      uVar19 = (uint)local_d8c[1];
                      if (local_e2c != 0) {
                        uVar19 = (uVar19 & 0xff) +
                                 *(int *)(local_e2c + (uint)(local_d8c[1] >> 8) * 4);
                        puVar10 = local_dac;
                      }
                      if (((*(uint *)(DAT_6b8b0800 + uVar19 * 4) ^
                           *(uint *)(DAT_6b8b0800 + uVar14 * 4)) & 0xe7ffffff) == 0) {
                        iVar9 = 1;
                        local_d9c = (ushort *)&DAT_00000001;
                      }
                      else {
                        iVar9 = 0;
                      }
                    }
                    else {
                      iVar9 = 0;
                    }
                  }
                  uVar14 = local_da8;
                  if (-1 < iVar8) {
                    local_db4 = local_d8c + iVar9;
                    do {
                      iVar22 = (int)(iVar8 + (int)local_d98) / 2;
                      puVar10 = (ushort *)(*(int *)(local_e30 + 0x10c) + iVar22 * 0xc);
                      iVar9 = FUN_6b85023c((int)local_db4,puVar10,3);
                      if (iVar9 == 0) {
                        local_da0 = puVar10 + 4;
                        local_d8c = local_d8c + (int)(local_d9c + 1);
                        local_dc0 = local_d9c;
                        goto LAB_6b8279db;
                      }
                      if (iVar9 < 0) {
                        iVar8 = iVar22 + -1;
                      }
                      else {
                        local_d98 = (ushort *)(iVar22 + 1);
                      }
                      puVar10 = local_dac;
                      uVar14 = local_da8;
                    } while ((int)local_d98 <= iVar8);
                  }
                }
              }
              uVar20 = *(ushort *)(uVar14 + 8);
              if ((uVar20 != 0) && (local_d8c + (puVar10 != (ushort *)0x0) + 1 <= local_df0)) {
                iVar8 = local_db0;
                if (local_db0 == 0) {
                  iVar8 = FUN_6b85026b(local_d8c,local_df0,2,*(ushort *)(uVar14 + 4),
                                       *(ushort *)(uVar14 + 6),(int)puVar10,0);
                }
                if (1 < iVar8) {
                  local_dac = (ushort *)(uVar20 - 1);
                  puVar25 = (ushort *)0x0;
                  local_da8 = 0;
                  if ((puVar10 != (ushort *)0x0) && (local_d8c + 2 < local_df0)) {
                    uVar14 = local_db8;
                    if (local_e2c != 0) {
                      uVar14 = (local_db8 & 0xff) + *(int *)(local_e2c + (local_db8 >> 8) * 4);
                    }
                    uVar19 = (uint)local_d8c[1];
                    if (local_e2c != 0) {
                      uVar19 = (uVar19 & 0xff) + *(int *)(local_e2c + (uint)(local_d8c[1] >> 8) * 4)
                      ;
                    }
                    if (((*(uint *)(DAT_6b8b0800 + uVar19 * 4) ^
                         *(uint *)(DAT_6b8b0800 + uVar14 * 4)) & 0xe7ffffff) == 0) {
                      puVar25 = (ushort *)&DAT_00000001;
                    }
                  }
                  if (-1 < (int)local_dac) {
                    local_d98 = local_d8c + (int)puVar25;
                    do {
                      iVar9 = (int)(local_da8 + (int)local_dac) / 2;
                      puVar10 = (ushort *)(*(int *)(local_e30 + 0x108) + iVar9 * 8);
                      iVar8 = FUN_6b85023c((int)local_d98,puVar10,2);
                      if (iVar8 == 0) {
                        local_da0 = puVar10 + 2;
                        local_d8c = local_d98 + 1;
                        local_dc0 = puVar25;
                        break;
                      }
                      if (iVar8 < 0) {
                        local_dac = (ushort *)(iVar9 + -1);
                      }
                      else {
                        local_da8 = iVar9 + 1;
                      }
                    } while ((int)local_da8 <= (int)local_dac);
                  }
                }
              }
            }
            else {
              if (bVar5 == 0x80) {
LAB_6b8273c0:
                uVar20 = *(ushort *)(uVar14 + 0xe);
                puVar10 = (ushort *)(*(uint *)(local_e30 + 0xfc) & 0x20);
                local_dac = puVar10;
                if ((uVar20 != 0) && (local_d8c + (puVar10 != (ushort *)0x0) + 4 <= local_df0)) {
                  if (local_db0 == 0) {
                    local_db0 = FUN_6b85026b(local_d8c,local_df0,5,*(ushort *)(uVar14 + 4),
                                             *(ushort *)(uVar14 + 6),(int)puVar10,0);
                  }
                  if (4 < local_db0) {
                    iVar9 = 0;
                    iVar8 = uVar20 - 1;
                    local_d9c = (ushort *)0x0;
                    local_d98 = (ushort *)0x0;
                    if (puVar10 != (ushort *)0x0) {
                      if (local_d8c + 5 < local_df0) {
                        uVar14 = local_db8;
                        if (local_e2c != 0) {
                          uVar14 = (local_db8 & 0xff) + *(int *)(local_e2c + (local_db8 >> 8) * 4);
                        }
                        uVar19 = (uint)local_d8c[1];
                        if (local_e2c != 0) {
                          uVar19 = (uVar19 & 0xff) +
                                   *(int *)(local_e2c + (uint)(local_d8c[1] >> 8) * 4);
                          puVar10 = local_dac;
                        }
                        if (((*(uint *)(DAT_6b8b0800 + uVar19 * 4) ^
                             *(uint *)(DAT_6b8b0800 + uVar14 * 4)) & 0xe7ffffff) == 0) {
                          iVar9 = 1;
                          local_d9c = (ushort *)&DAT_00000001;
                        }
                        else {
                          iVar9 = 0;
                        }
                      }
                      else {
                        iVar9 = 0;
                      }
                    }
                    uVar14 = local_da8;
                    if (-1 < iVar8) {
                      local_db4 = local_d8c + iVar9;
                      do {
                        iVar22 = (int)(iVar8 + (int)local_d98) / 2;
                        puVar10 = (ushort *)(*(int *)(local_e30 + 0x114) + iVar22 * 0x10);
                        iVar9 = FUN_6b85023c((int)local_db4,puVar10,5);
                        if (iVar9 == 0) {
                          local_da0 = puVar10 + 6;
                          local_d8c = local_d8c + (int)(local_d9c + 2);
                          local_dc0 = local_d9c;
                          goto LAB_6b8279db;
                        }
                        if (iVar9 < 0) {
                          iVar8 = iVar22 + -1;
                        }
                        else {
                          local_d98 = (ushort *)(iVar22 + 1);
                        }
                        puVar10 = local_dac;
                        uVar14 = local_da8;
                      } while ((int)local_d98 <= iVar8);
                    }
                  }
                }
                uVar20 = *(ushort *)(uVar14 + 0xc);
                if ((uVar20 != 0) && (local_d8c + (puVar10 != (ushort *)0x0) + 3 <= local_df0)) {
                  if (local_db0 == 0) {
                    local_db0 = FUN_6b85026b(local_d8c,local_df0,4,*(ushort *)(uVar14 + 4),
                                             *(ushort *)(uVar14 + 6),(int)puVar10,0);
                  }
                  if (3 < local_db0) {
                    iVar9 = 0;
                    iVar8 = uVar20 - 1;
                    local_d9c = (ushort *)0x0;
                    local_d98 = (ushort *)0x0;
                    if (puVar10 != (ushort *)0x0) {
                      if (local_d8c + 4 < local_df0) {
                        uVar14 = local_db8;
                        if (local_e2c != 0) {
                          uVar14 = (local_db8 & 0xff) + *(int *)(local_e2c + (local_db8 >> 8) * 4);
                        }
                        uVar19 = (uint)local_d8c[1];
                        if (local_e2c != 0) {
                          uVar19 = (uVar19 & 0xff) +
                                   *(int *)(local_e2c + (uint)(local_d8c[1] >> 8) * 4);
                        }
                        if (((*(uint *)(DAT_6b8b0800 + uVar19 * 4) ^
                             *(uint *)(DAT_6b8b0800 + uVar14 * 4)) & 0xe7ffffff) == 0) {
                          iVar9 = 1;
                          local_d9c = (ushort *)&DAT_00000001;
                        }
                        else {
                          iVar9 = 0;
                        }
                      }
                      else {
                        iVar9 = 0;
                      }
                    }
                    uVar14 = local_da8;
                    if (-1 < iVar8) {
                      local_db4 = local_d8c + iVar9;
                      do {
                        iVar22 = (int)(iVar8 + (int)local_d98) / 2;
                        puVar10 = (ushort *)(*(int *)(local_e30 + 0x110) + iVar22 * 0xc);
                        iVar9 = FUN_6b85023c((int)local_db4,puVar10,4);
                        if (iVar9 == 0) {
                          local_da0 = puVar10 + 4;
                          local_d8c = local_d8c + (int)((int)local_d9c + 3);
                          local_dc0 = local_d9c;
                          goto LAB_6b8279db;
                        }
                        if (iVar9 < 0) {
                          iVar8 = iVar22 + -1;
                        }
                        else {
                          local_d98 = (ushort *)(iVar22 + 1);
                        }
                        uVar14 = local_da8;
                      } while ((int)local_d98 <= iVar8);
                    }
                  }
                }
                goto LAB_6b8276ea;
              }
              if (bVar5 == 0xc0) {
                uVar20 = *(ushort *)(uVar14 + 0x14);
                puVar10 = (ushort *)(*(uint *)(local_e30 + 0xfc) & 0x20);
                local_dac = puVar10;
                if (((uVar20 != 0) && (local_dd4 + (puVar10 != (ushort *)0x0) + 7 <= local_df0)) &&
                   (local_db0 = FUN_6b85026b(local_dd4,local_df0,8,*(ushort *)(uVar14 + 4),
                                             *(ushort *)(uVar14 + 6),(int)puVar10,0), 7 < local_db0)
                   ) {
                  iVar9 = 0;
                  iVar8 = uVar20 - 1;
                  local_d98 = (ushort *)0x0;
                  local_d9c = (ushort *)0x0;
                  if (puVar10 != (ushort *)0x0) {
                    if (local_d8c + 8 < local_df0) {
                      if (local_e2c == 0) {
                        uVar14 = *(uint *)(DAT_6b8b0800 + local_db8 * 4);
                      }
                      else {
                        uVar14 = *(uint *)(DAT_6b8b0800 +
                                          ((local_db8 & 0xff) +
                                          *(int *)(local_e2c + (local_db8 >> 8) * 4)) * 4);
                      }
                      uVar19 = (uint)local_d8c[1];
                      if (local_e2c != 0) {
                        uVar19 = (uVar19 & 0xff) +
                                 *(int *)(local_e2c + (uint)(local_d8c[1] >> 8) * 4);
                        puVar10 = local_dac;
                      }
                      if (((*(uint *)(DAT_6b8b0800 + uVar19 * 4) ^ uVar14) & 0xe7ffffff) == 0) {
                        iVar9 = 1;
                        local_d98 = (ushort *)&DAT_00000001;
                      }
                      else {
                        iVar9 = 0;
                      }
                    }
                    else {
                      iVar9 = 0;
                    }
                  }
                  uVar14 = local_da8;
                  if (-1 < iVar8) {
                    local_db4 = local_d8c + iVar9;
                    do {
                      iVar22 = (int)(iVar8 + (int)local_d9c) / 2;
                      puVar10 = (ushort *)(*(int *)(local_e30 + 0x120) + iVar22 * 0x14);
                      iVar9 = FUN_6b85023c((int)local_db4,puVar10,8);
                      if (iVar9 == 0) {
                        local_da0 = puVar10 + 8;
                        local_d8c = local_d8c + (int)((int)local_d98 + 7);
                        local_dc0 = local_d98;
                        goto LAB_6b8279db;
                      }
                      if (iVar9 < 0) {
                        iVar8 = iVar22 + -1;
                      }
                      else {
                        local_d9c = (ushort *)(iVar22 + 1);
                      }
                      puVar10 = local_dac;
                      uVar14 = local_da8;
                    } while ((int)local_d9c <= iVar8);
                  }
                }
                uVar20 = *(ushort *)(uVar14 + 0x12);
                if ((uVar20 != 0) && (local_d8c + (puVar10 != (ushort *)0x0) + 6 <= local_df0)) {
                  if (local_db0 == 0) {
                    local_db0 = FUN_6b85026b(local_d8c,local_df0,7,*(ushort *)(uVar14 + 4),
                                             *(ushort *)(uVar14 + 6),(int)puVar10,0);
                  }
                  if (6 < local_db0) {
                    iVar9 = 0;
                    iVar8 = uVar20 - 1;
                    local_d9c = (ushort *)0x0;
                    local_d98 = (ushort *)0x0;
                    if (puVar10 != (ushort *)0x0) {
                      if (local_d8c + 7 < local_df0) {
                        uVar14 = local_db8;
                        if (local_e2c != 0) {
                          uVar14 = (local_db8 & 0xff) + *(int *)(local_e2c + (local_db8 >> 8) * 4);
                        }
                        uVar19 = (uint)local_d8c[1];
                        if (local_e2c != 0) {
                          uVar19 = (uVar19 & 0xff) +
                                   *(int *)(local_e2c + (uint)(local_d8c[1] >> 8) * 4);
                        }
                        if (((*(uint *)(DAT_6b8b0800 + uVar19 * 4) ^
                             *(uint *)(DAT_6b8b0800 + uVar14 * 4)) & 0xe7ffffff) == 0) {
                          iVar9 = 1;
                          local_d9c = (ushort *)&DAT_00000001;
                        }
                        else {
                          iVar9 = 0;
                        }
                      }
                      else {
                        iVar9 = 0;
                      }
                    }
                    uVar14 = local_da8;
                    if (-1 < iVar8) {
                      local_db4 = local_d8c + iVar9;
                      do {
                        iVar22 = (int)(iVar8 + (int)local_d98) / 2;
                        puVar10 = (ushort *)(*(int *)(local_e30 + 0x11c) + iVar22 * 0x14);
                        iVar9 = FUN_6b85023c((int)local_db4,puVar10,7);
                        if (iVar9 == 0) {
                          local_da0 = puVar10 + 8;
                          local_d8c = local_d8c + (int)(local_d9c + 3);
                          local_dc0 = local_d9c;
                          goto LAB_6b8279db;
                        }
                        if (iVar9 < 0) {
                          iVar8 = iVar22 + -1;
                        }
                        else {
                          local_d98 = (ushort *)(iVar22 + 1);
                        }
                        uVar14 = local_da8;
                      } while ((int)local_d98 <= iVar8);
                    }
                  }
                }
                puVar10 = local_dac;
                uVar20 = *(ushort *)(uVar14 + 0x10);
                if ((uVar20 != 0) && (local_d8c + (local_dac != (ushort *)0x0) + 5 <= local_df0)) {
                  if (local_db0 == 0) {
                    local_db0 = FUN_6b85026b(local_d8c,local_df0,6,*(ushort *)(uVar14 + 4),
                                             *(ushort *)(uVar14 + 6),(int)local_dac,0);
                  }
                  if (5 < local_db0) {
                    iVar9 = 0;
                    iVar8 = uVar20 - 1;
                    local_d9c = (ushort *)0x0;
                    local_d98 = (ushort *)0x0;
                    if (puVar10 != (ushort *)0x0) {
                      if (local_d8c + 6 < local_df0) {
                        uVar14 = local_db8;
                        if (local_e2c != 0) {
                          uVar14 = (local_db8 & 0xff) + *(int *)(local_e2c + (local_db8 >> 8) * 4);
                        }
                        uVar19 = (uint)local_d8c[1];
                        if (local_e2c != 0) {
                          uVar19 = (uVar19 & 0xff) +
                                   *(int *)(local_e2c + (uint)(local_d8c[1] >> 8) * 4);
                        }
                        if (((*(uint *)(DAT_6b8b0800 + uVar19 * 4) ^
                             *(uint *)(DAT_6b8b0800 + uVar14 * 4)) & 0xe7ffffff) == 0) {
                          iVar9 = 1;
                          local_d9c = (ushort *)&DAT_00000001;
                        }
                        else {
                          iVar9 = 0;
                        }
                      }
                      else {
                        iVar9 = 0;
                      }
                    }
                    uVar14 = local_da8;
                    if (-1 < iVar8) {
                      local_db4 = local_d8c + iVar9;
                      do {
                        iVar22 = (int)(iVar8 + (int)local_d98) / 2;
                        puVar10 = (ushort *)(*(int *)(local_e30 + 0x118) + iVar22 * 0x10);
                        iVar9 = FUN_6b85023c((int)local_db4,puVar10,6);
                        if (iVar9 == 0) {
                          local_da0 = puVar10 + 6;
                          local_d8c = local_d8c + (int)((int)local_d9c + 5);
                          local_dc0 = local_d9c;
                          goto LAB_6b8279db;
                        }
                        if (iVar9 < 0) {
                          iVar8 = iVar22 + -1;
                        }
                        else {
                          local_d98 = (ushort *)(iVar22 + 1);
                        }
                        uVar14 = local_da8;
                      } while ((int)local_d98 <= iVar8);
                    }
                  }
                }
                goto LAB_6b8273c0;
              }
            }
LAB_6b8279db:
            bVar5 = *(byte *)((int)local_da0 + 1);
          }
          if ((bVar5 == 0xd) && (local_e10 != 0)) {
            local_d9c = (ushort *)0x0;
            puVar23 = &DAT_6b884700;
            local_dac = (ushort *)0x0;
            local_db4 = (ushort *)0x0;
            iVar8 = 0x37;
            if (((ushort)(*local_d8c + 0x2400) < 0x400) && (local_df4 < local_d8c)) {
              if (local_d8c[-1] != 0xd835) goto LAB_6b811891;
              puVar23 = &DAT_6b884c10;
              iVar8 = 9;
            }
            iVar9 = 0;
            uVar20 = *local_d8c;
            puVar10 = (ushort *)(uint)uVar20;
            do {
              uVar14 = iVar8 + iVar9 >> 1;
              if (uVar20 == *(ushort *)(puVar23 + uVar14 * 2)) break;
              if (uVar20 < *(ushort *)(puVar23 + uVar14 * 2)) {
                iVar8 = uVar14 - 1;
              }
              else {
                iVar9 = uVar14 + 1;
              }
            } while (iVar9 <= iVar8);
            uVar20 = *(ushort *)(puVar23 + (uVar14 & 0xfffffffe) * 2);
            if ((*local_d8c < uVar20) ||
               (*(ushort *)(puVar23 + (uVar14 & 0xfffffffe) * 2 + 2) < *local_d8c)) {
              uVar20 = 0;
            }
            local_db4 = (ushort *)(uint)uVar20;
            local_d98 = puVar10;
            if (uVar20 != 0) {
              if ((uVar20 < 0xdc00) || (uVar21 = 0xd835, 0xdfff < uVar20)) {
                uVar21 = 0;
              }
              while (*local_d8c == uVar20) {
                local_dac = (ushort *)((int)local_dac + 1);
                puVar25 = local_d8c + 1;
                if (uVar21 != 0) {
                  if ((local_df0 <= puVar25) || (*puVar25 != uVar21)) {
                    local_d8c = local_d8c + 2;
                    break;
                  }
                  puVar25 = local_d8c + 2;
                }
                local_d8c = puVar25;
                if ((local_df0 <= puVar25) || (0x12 < (int)local_dac)) break;
              }
              uVar14 = 0;
              if ((local_d8c < local_df0) &&
                 (puVar25 = local_d8c, local_d98 = local_dac, (int)local_dac < 0x13)) {
                do {
                  puVar10 = local_d98;
                  if ((*puVar25 < uVar20) || ((int)(uint)uVar20 < (int)(*puVar25 - 9))) break;
                  uVar14 = uVar14 + 1;
                  local_d98 = (ushort *)((int)local_d98 + 1);
                  puVar16 = puVar25 + 1;
                  puVar10 = local_d98;
                  if (uVar21 != 0) {
                    if ((local_df0 <= puVar16) || (*puVar16 != uVar21)) break;
                    puVar16 = puVar25 + 2;
                  }
                  if ((local_df0 <= puVar16) || (puVar25 = puVar16, 0x12 < (int)local_d98)) break;
                } while( true );
              }
              local_d98 = puVar10;
              *local_d94 = 0x20d;
              *(char *)(local_d94 + 1) = (char)uVar14 + '\x02';
              pbVar18 = (byte *)((int)local_d94 + 3);
              puVar15 = (undefined2 *)((int)local_d90 + 1);
              *(undefined *)local_d90 = *(undefined *)(local_da0 + 1);
              *(byte *)local_da4 = *(byte *)((int)local_da0 + 3) & local_e24 & 0x3f;
              if ((uVar14 & 1) != 0) {
                *pbVar18 = 0x20;
              }
              for (; 0 < (int)uVar14; uVar14 = uVar14 - 1) {
                if ((uVar14 & 1) == 0) {
                  *pbVar18 = ((*(char *)local_d8c - (char)uVar20) + '\x02') * '\x10';
                }
                else {
                  *pbVar18 = *pbVar18 | (*(char *)local_d8c - (char)uVar20) + 2U;
                  pbVar18 = pbVar18 + 1;
                }
                puVar10 = local_d8c + 1;
                if (uVar21 != 0) {
                  puVar10 = local_d8c + 2;
                }
                local_d8c = puVar10;
              }
              local_dd4 = local_d8c + -1;
              *pbVar18 = -(char)local_dac - 2;
              local_d94 = (undefined2 *)(pbVar18 + 1);
              puVar13 = (undefined2 *)((int)local_da4 + 1);
              local_d90 = puVar15;
              if (uVar21 != 0) {
                local_dd4 = local_d8c + -2;
              }
              goto LAB_6b811931;
            }
          }
LAB_6b811891:
          uVar20 = *local_da0;
          *(char *)((int)local_d94 + 1) = (char)uVar20;
          puVar15 = local_d94 + 1;
          *(char *)local_d94 = (char)(uVar20 >> 8);
          if (((bVar5 < 0xa9) || (0xaf < bVar5)) &&
             ((local_e0c == 0 || (0x2f < (byte)(bVar5 + 0x40))))) {
            if ((local_e14 == 0) ||
               ((0x14 < *(byte *)((int)local_da0 + 1) && (*(byte *)((int)local_da0 + 1) != 0x29))))
            {
              uVar4 = *(undefined *)(local_da0 + 1);
            }
            else {
              uVar4 = 2;
            }
            *(undefined *)local_d90 = uVar4;
            local_d90 = (undefined2 *)((int)local_d90 + 1);
            local_d94 = puVar15;
          }
          else {
            local_d94 = (undefined2 *)((int)local_d94 + 3);
            *(undefined *)puVar15 = *(undefined *)(local_da0 + 1);
          }
          if ((local_e18 == 0) ||
             ((0x14 < *(byte *)((int)local_da0 + 1) && (*(byte *)((int)local_da0 + 1) != 0x29)))) {
            bVar5 = *(byte *)((int)local_da0 + 3) & 0x3f;
          }
          else {
            bVar5 = 2;
          }
          bVar6 = 2;
          *(byte *)local_da4 = bVar5 & local_e24;
          local_dd4 = local_d8c;
          puVar13 = (undefined2 *)((int)local_da4 + 1);
          if (local_dc0 != (ushort *)0x0) {
            uVar20 = *local_da0;
            *(char *)((int)local_d94 + 1) = (char)uVar20;
            *(char *)local_d94 = (char)(uVar20 >> 8);
            if ((local_e14 == 0) ||
               ((bVar5 = bVar6, 0x14 < *(byte *)((int)local_da0 + 1) &&
                (*(byte *)((int)local_da0 + 1) != 0x29)))) {
              bVar5 = *(byte *)(local_da0 + 1);
            }
            *(byte *)local_d90 = bVar5;
            if ((local_e18 == 0) ||
               ((0x14 < *(byte *)((int)local_da0 + 1) && (*(byte *)((int)local_da0 + 1) != 0x29))))
            {
              bVar6 = *(byte *)((int)local_da0 + 3) & 0x3f;
            }
            *(byte *)(undefined2 *)((int)local_da4 + 1) = bVar6 & local_e24;
            puVar13 = local_da4 + 1;
            local_d94 = local_d94 + 1;
            local_d90 = (undefined2 *)((int)local_d90 + 1);
          }
        }
LAB_6b811931:
        local_da4 = puVar13;
        local_dd4 = local_dd4 + 1;
        local_d8c = local_dd4;
      } while (local_dd4 < local_df0);
    }
    else {
      local_dc4 = local_dd8;
      local_d94 = local_de8;
      local_dbc = local_ddc;
      local_da4 = local_de0;
      local_d90 = local_de4;
    }
    if (param_6 == 0) {
      local_d94 = (undefined2 *)((int)local_d94 - (int)local_e08);
      uVar14 = param_2 & 2;
      if (uVar14 == 0) {
        puVar15 = (undefined2 *)((int)local_d90 + -1);
        if ((*(byte *)(local_e30 + 0xfc) & 0x10) == 0) {
          for (; (local_e04 <= puVar15 && (*(byte *)puVar15 < 3));
              puVar15 = (undefined2 *)((int)puVar15 + -1)) {
          }
        }
        else {
          for (; (local_e04 <= puVar15 && (*(byte *)local_e04 < 3));
              local_e04 = (undefined2 *)((int)local_e04 + 1)) {
          }
        }
        local_d94 = (undefined2 *)((int)local_d94 + (int)((int)puVar15 + (1 - (int)local_e04)));
      }
      puVar15 = local_da4;
      if ((param_2 & 0x20001) != 0x20001) {
        do {
          puVar15 = (undefined2 *)((int)puVar15 + -1);
          if (puVar15 < local_e00) break;
        } while (*(byte *)puVar15 < 3);
        local_d94 = (undefined2 *)((int)local_d94 + (int)((int)puVar15 + (1 - (int)local_e00)));
      }
      if (local_dfc < local_dbc) {
        if (uVar14 != 0) {
          local_d94 = local_d94 + 1;
        }
        uVar14 = -(uint)(uVar14 != 0) & 2;
        pbVar18 = local_dbc + -1 + uVar14 * local_dec;
        do {
          pbVar1 = pbVar18 + ((int)local_dfc - (int)(local_dbc + -1));
          pbVar11 = pbVar18;
          if (pbVar1 <= pbVar18) {
            do {
              if (*pbVar11 != (&DAT_6b8888f8)[uVar14]) break;
              pbVar11 = pbVar11 + -1;
            } while (pbVar1 <= pbVar11);
          }
          pbVar18 = pbVar18 + local_dec;
          local_d94 = (undefined2 *)((int)local_d94 + (int)(pbVar11 + (2 - (int)pbVar1)));
          uVar14 = uVar14 + 1;
        } while ((int)uVar14 < 4);
      }
      puVar15 = local_e08;
      if ((local_e08 != local_d88) && (local_e08 != (undefined2 *)0x0)) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_e08);
        puVar15 = extraout_EDX_01;
      }
      goto LAB_6b811b51;
    }
    local_dac = (ushort *)(param_5 + param_6);
    if (param_6 < (int)(((int)local_d94 - (int)local_e08) + 5U)) goto joined_r0x6b828415;
    puVar15 = (undefined2 *)0x0;
    puVar13 = (undefined2 *)(~-(uint)(local_d94 < local_e08) & (int)local_d94 - (int)local_e08);
    if (puVar13 != (undefined2 *)0x0) {
      do {
        *param_5 = *(undefined *)((int)puVar15 + (int)local_e08);
        param_5 = param_5 + 1;
        puVar15 = (undefined2 *)((int)puVar15 + 1);
      } while (puVar15 < puVar13);
    }
    *param_5 = 1;
    puVar23 = param_5 + 1;
    if ((param_2 & 2) != 0) {
LAB_6b811a8c:
      *puVar23 = 1;
      puVar23 = puVar23 + 1;
      if ((param_2 & 0x20001) != 0x20001) {
        do {
          local_da4 = (undefined2 *)((int)local_da4 + -1);
          if (local_da4 < local_e00) break;
        } while (*(byte *)local_da4 < 3);
        if ((int)local_dac - (int)puVar23 <= (int)((int)local_da4 + (3 - (int)local_e00)))
        goto joined_r0x6b828415;
        for (; puVar15 = local_e00, local_e00 <= local_da4;
            local_e00 = (undefined2 *)((int)local_e00 + 1)) {
          *puVar23 = *(undefined *)local_e00;
          puVar23 = puVar23 + 1;
        }
      }
      *puVar23 = 1;
      puVar24 = puVar23 + 1;
      if (local_dfc < local_dbc) {
        if ((param_2 & 2) == 0) {
          iVar8 = 0;
          local_e3c = 0;
        }
        else {
          if ((int)local_dac - (int)puVar24 < 5) goto joined_r0x6b828415;
          iVar8 = 2;
          *puVar24 = 0xff;
          puVar23[2] = 2;
          puVar24 = puVar23 + 3;
        }
        puVar15 = (undefined2 *)(local_dfc + iVar8 * local_dec);
        local_dbc = local_dbc + (-1 - (int)local_dfc);
        do {
          puVar13 = (undefined2 *)((int)puVar15 + (int)local_dbc);
          if (puVar15 <= puVar13) {
            do {
              if (*(char *)puVar13 != (&DAT_6b8888f8)[iVar8]) break;
              puVar13 = (undefined2 *)((int)puVar13 + -1);
            } while (puVar15 <= puVar13);
          }
          if ((int)local_dac - (int)puVar24 <= (int)((int)puVar13 + (3 - (int)puVar15)))
          goto joined_r0x6b828415;
          local_db4 = (ushort *)&DAT_00000001;
          uVar14 = ~-(uint)(puVar13 < puVar15) & (uint)((int)puVar13 + (1 - (int)puVar15));
          if (uVar14 != 0) {
            uVar19 = 1;
            puVar13 = puVar15;
            do {
              *puVar24 = *(undefined *)puVar13;
              puVar24 = puVar24 + 1;
              puVar13 = (undefined2 *)((int)puVar13 + 1);
              uVar19 = uVar19 + 1;
            } while (uVar19 <= uVar14);
          }
          puVar15 = (undefined2 *)((int)puVar15 + local_dec);
          *puVar24 = (&UNK_6b8888f4)[local_e3c];
          puVar24 = puVar24 + 1;
          iVar8 = local_e3c + 1;
          local_e3c = iVar8;
        } while (iVar8 < 4);
      }
      *puVar24 = 1;
      puVar24 = puVar24 + 1;
      if (local_e1c == 0) {
        if ((int)local_dac - (int)puVar24 < (int)((int)local_dc4 + (1 - (int)local_df8)))
        goto joined_r0x6b828415;
        for (; puVar15 = local_df8, local_df8 < local_dc4;
            local_df8 = (undefined2 *)((int)local_df8 + 1)) {
          *puVar24 = *(undefined *)local_df8;
          puVar24 = puVar24 + 1;
        }
      }
      *puVar24 = 0;
      if ((local_e08 != local_d88) && (local_e08 != (undefined2 *)0x0)) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_e08);
        puVar15 = extraout_EDX_00;
      }
      goto LAB_6b811b51;
    }
    puVar15 = (undefined2 *)((int)local_d90 + -1);
    if ((*(byte *)(local_e30 + 0xfc) & 0x10) == 0) {
      for (; (local_e04 <= puVar15 && (*(byte *)puVar15 < 3));
          puVar15 = (undefined2 *)((int)puVar15 + -1)) {
      }
      if ((int)((int)puVar15 + (4 - (int)local_e04)) < (int)local_dac - (int)puVar23) {
        for (; local_e04 <= puVar15; local_e04 = (undefined2 *)((int)local_e04 + 1)) {
          *puVar23 = *(undefined *)local_e04;
          puVar23 = puVar23 + 1;
        }
        goto LAB_6b811a8c;
      }
    }
    else {
      while ((local_e04 <= puVar15 && (local_e44 = local_e04, *(byte *)local_e04 < 3))) {
        local_e44 = (undefined2 *)((int)local_e04 + 1);
        local_e04 = local_e44;
      }
      if ((int)((int)puVar15 + (4 - (int)local_e04)) < (int)local_dac - (int)puVar23) {
        for (; local_e44 <= puVar15; puVar15 = (undefined2 *)((int)puVar15 + -1)) {
          *puVar23 = *(undefined *)puVar15;
          puVar23 = puVar23 + 1;
        }
        goto LAB_6b811a8c;
      }
    }
joined_r0x6b828415:
    if ((local_e08 != local_d88) && (local_e08 != (undefined2 *)0x0)) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_e08);
    }
    dwErrCode = 0x7a;
  }
  else if (param_4 < 0x25ed098) {
    local_dec = param_4 * 3;
    local_e08 = (undefined2 *)
                RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                param_4 * 0x36);
    if (local_e08 != (undefined2 *)0x0) goto LAB_6b8117a8;
    dwErrCode = 0xe;
  }
  else {
    dwErrCode = 0x57;
  }
  SetLastError(dwErrCode);
  puVar15 = extraout_EDX_02;
LAB_6b811b51:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,puVar15);
  return;
}



void __fastcall FUN_6b811d83(int *param_1,int param_2,uint param_3,int param_4,int param_5)

{
  int iVar1;
  uint uVar2;
  
  if ((param_3 & 0x8000000) == 0) {
    iVar1 = *(int *)(param_2 + 0xf8);
  }
  else {
    iVar1 = *(int *)(param_2 + 0xf4);
  }
  param_1[1] = iVar1;
  *param_1 = param_2;
  param_1[0xf] = param_4;
  param_1[0x17] = param_4;
  param_1[0x10] = param_4 + param_5 * 2;
  param_1[9] = *(uint *)(param_2 + 0xfc) & 1;
  param_1[2] = DAT_6b8b0808;
  uVar2 = param_3 & 0x30001;
  *(undefined *)(param_1 + 3) = 0xff;
  if (uVar2 == 1) {
    *(undefined *)(param_1 + 3) = 0xe7;
  }
  else if (uVar2 == 0x10000) {
    *(undefined *)(param_1 + 3) = 0xdf;
  }
  else if (uVar2 == 0x10001) {
    *(undefined *)(param_1 + 3) = 199;
  }
  else if (uVar2 == 0x20000) {
    *(undefined *)(param_1 + 3) = 0xfe;
  }
  else if (uVar2 == 0x20001) {
    *(undefined *)(param_1 + 3) = 0xe6;
  }
  else if (uVar2 == 0x30000) {
    *(undefined *)(param_1 + 3) = 0xde;
  }
  else if (uVar2 == 0x30001) {
    *(undefined *)(param_1 + 3) = 0xc6;
  }
  FUN_6b811e6e((int)param_1);
  param_1[4] = param_3 & 0x1000;
  param_1[5] = param_3 & 4;
  param_1[8] = param_3 & 8;
  param_1[0x1a] = 0;
  param_1[7] = param_3 & 0x20;
  param_1[6] = param_3 & 0x10;
  return;
}



void __fastcall FUN_6b811e6e(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  iVar4 = *(int *)(param_1 + 0x44);
  *(int *)(param_1 + 0x48) = *(int *)(param_1 + 0x28);
  iVar1 = *(int *)(param_1 + 0x28) + iVar4 * 8;
  iVar2 = iVar1 + iVar4;
  *(int *)(param_1 + 0x2c) = iVar1;
  iVar3 = iVar2 + iVar4;
  *(int *)(param_1 + 0x30) = iVar2;
  iVar4 = iVar3 + iVar4 * 4;
  *(int *)(param_1 + 0x50) = iVar2;
  *(int *)(param_1 + 0x34) = iVar3;
  *(int *)(param_1 + 0x38) = iVar4;
  *(int *)(param_1 + 0x4c) = iVar1;
  *(int *)(param_1 + 0x54) = iVar3;
  *(int *)(param_1 + 0x58) = iVar4;
  return;
}



undefined4 __fastcall
FUN_6b811ea6(int param_1,uint param_2,int param_3,int param_4,int param_5,int param_6)

{
  int iVar1;
  DWORD dwErrCode;
  
  if (((((param_1 == 0) || (param_4 == 0)) || (param_6 < 0)) ||
      ((param_3 == 0 || ((param_6 != 0 && (param_5 == 0)))))) || (param_3 == param_5)) {
    dwErrCode = 0x57;
  }
  else {
    iVar1 = FUN_6b811eff(param_2);
    if (iVar1 == 0) {
      return 0;
    }
    if (DAT_6b8b0800 != 0) {
      return 1;
    }
    dwErrCode = 2;
  }
  SetLastError(dwErrCode);
  return 0;
}



undefined4 __fastcall FUN_6b811eff(uint param_1)

{
  if ((byte)(1U - (((param_1 & 0xffffffe2) - 1 & param_1 & 0x22) != 0) &
             1U - ((param_1 & 0xe7fcefc0) != 0) &
            ~-((((byte)param_1 & 0xf1) - 1 & (byte)param_1 & 0x11) != 0)) != 0) {
    return 1;
  }
  SetLastError(0x3ec);
  return 0;
}



BOOL GetStringTypeExW(LCID Locale,DWORD dwInfoType,LPCWSTR lpSrcStr,int cchSrc,LPWORD lpCharType)

{
  BOOL BVar1;
  
                    // 0x11f40  732  GetStringTypeExW
                    // WARNING: Could not recover jumptable at 0x6b811f46. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetStringTypeExW(Locale,dwInfoType,lpSrcStr,cchSrc,lpCharType);
  return BVar1;
}



HRSRC FindResourceW(HMODULE hModule,LPCWSTR lpName,LPCWSTR lpType)

{
  HRSRC pHVar1;
  
                    // 0x11f60  412  FindResourceW
                    // WARNING: Could not recover jumptable at 0x6b811f66. Too many branches
                    // WARNING: Treating indirect jump as call
  pHVar1 = FindResourceW(hModule,lpName,lpType);
  return pHVar1;
}



GEOID GetUserGeoID(GEOCLASS GeoClass)

{
  int iVar1;
  uint uVar2;
  GEOID GVar3;
  undefined4 in_EDX;
  undefined4 extraout_EDX;
  uint uVar4;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  wchar_t *pwVar5;
  undefined8 uVar6;
  undefined *local_2c4;
  int local_2c0;
  undefined local_2bc [532];
  wchar_t local_a8 [80];
  uint local_8;
  
                    // 0x11f80  796  GetUserGeoID
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_2c0 = 0;
  if (GeoClass == 0xe) {
    pwVar5 = L"Region";
  }
  else {
    if (GeoClass != 0x10) goto LAB_6b812055;
    pwVar5 = L"Nation";
  }
  uVar6 = OpenRegKey(&local_2c0,0,L"Control Panel\\International\\Geo",0x20019,1);
  in_EDX = (undefined4)((ulonglong)uVar6 >> 0x20);
  if (-1 < (int)uVar6) {
    local_2c4 = local_2bc;
    iVar1 = FUN_6b812da7(local_2c0,pwVar5,&local_2c4);
    in_EDX = extraout_EDX;
    if ((-1 < iVar1) && (2 < *(uint *)(local_2c4 + 0xc))) {
      uVar2 = *(uint *)(local_2c4 + 0xc) >> 1;
      uVar4 = 0x50;
      if (uVar2 < 0x51) {
        uVar4 = uVar2;
      }
      FUN_6b812c57(local_a8,uVar4,(int)(local_2c4 + *(int *)(local_2c4 + 8)));
      _wtol(local_a8);
      in_EDX = extraout_EDX_00;
    }
  }
  if (local_2c0 != 0) {
    NtClose(local_2c0);
    in_EDX = extraout_EDX_01;
  }
LAB_6b812055:
  GVar3 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,in_EDX);
  return GVar3;
}



void GetDateFormatWWorker
               (ushort *param_1,uint param_2,ushort *param_3,ushort *param_4,short *param_5,
               int param_6,uint param_7)

{
  ushort uVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  undefined3 extraout_var;
  undefined3 extraout_var_00;
  undefined3 extraout_var_01;
  undefined4 extraout_EDX;
  ushort uVar5;
  int iVar6;
  bool bVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  undefined4 uVar10;
  uint local_2ec;
  short *local_2e8;
  ushort *local_2e4;
  uint local_2e0;
  uint local_2dc;
  uint local_2d8;
  int local_2d4;
  uint local_2d0;
  uint local_2cc;
  ushort *local_2c8;
  short *local_2c4;
  undefined local_2c0 [12];
  undefined4 local_2b4;
  ushort local_2b0 [80];
  ushort local_210 [258];
  uint local_c;
  
                    // 0x12070  552  GetDateFormatWWorker
  local_c = DAT_6b8b0140 ^ (uint)&local_2ec;
  local_2c8 = param_3;
  local_2e4 = param_4;
  local_2c4 = param_5;
  local_2e0 = param_2 & 4;
  iVar6 = 0;
  local_2d8 = 0;
  local_2dc = 0;
  local_2ec = 0;
  local_2d4 = 0;
  local_2d0 = 1;
  uVar4 = param_7;
  if (((int)param_2 < 0) || (iVar2 = NlsIsUserDefaultLocale(param_1), iVar2 == 0)) {
LAB_6b8285b8:
    uVar3 = 0;
LAB_6b81212a:
    param_7 = uVar4;
    if (uVar4 == 0) {
      if (local_2e0 != 0) {
        if (*(ushort *)(*(int *)(param_1 + 10) + *(int *)(*(int *)(param_1 + 8) + 0x7c) * 2) < 2) {
          uVar1 = 0;
        }
        else {
          uVar1 = *(ushort *)
                   (*(int *)(param_1 + 10) + 4 + *(int *)(*(int *)(param_1 + 8) + 0x7c) * 2);
        }
        param_7 = (uint)uVar1;
        if (param_7 != 0) goto LAB_6b812136;
      }
      param_7 = (uint)*(ushort *)
                       (*(int *)(param_1 + 10) + 2 + *(int *)(*(int *)(param_1 + 8) + 0x7c) * 2);
      if (local_2ec == 1) {
        uVar3 = param_7;
      }
    }
  }
  else {
    local_2ec = 1;
    iVar2 = GetUserOverrideWord(param_1,0x4d8,0,&local_2e8);
    if (iVar2 == 0) goto LAB_6b8285b8;
    uVar3 = FUN_6b812d49((uint)param_1,(uint)local_2e8 & 0xffff);
    uVar3 = uVar3 & 0xffff;
    if ((local_2e0 != 0) || (uVar4 = uVar3, param_7 == 0)) goto LAB_6b81212a;
  }
LAB_6b812136:
  local_2cc = ~-(uint)(param_7 != uVar3) & local_2ec;
  local_2ec = GetCalendar(param_1,param_7);
  if (local_2ec == 0) {
LAB_6b828708:
    uVar10 = 0x57;
  }
  else if (local_2e4 == (ushort *)0x0) {
    uVar4 = param_2 & 0xb;
    if (uVar4 < 2) {
      iVar2 = KernelBaseGetGlobalData();
      local_2e8 = *(short **)(iVar2 + 0x30);
      if (*(int *)(local_2ec + 4) != 0) {
        local_2e8 = local_2e8 + *(int *)(local_2e8 + *(int *)(local_2ec + 4) + 1);
      }
      local_2dc = 0x1f;
LAB_6b812199:
      if ((((local_2e0 == 0) || (param_7 == 1)) || (*local_2e8 == 0)) ||
         (local_2e4 = (ushort *)(local_2e8 + 1), local_2e4 == (ushort *)0x0)) {
        if (local_2cc != 0) {
          GetLocaleInfoHelper(param_1,param_7 << 0x10 | local_2dc,local_2b0,0x50);
          local_2e4 = local_2b0;
          if (local_2b0[0] != 0) goto LAB_6b8121da;
        }
        if (*local_2e8 == 0) {
          GetLocaleInfoHelper(param_1,local_2dc | 0x80000000,local_2b0,0x50);
          local_2e4 = local_2b0;
        }
        else {
          local_2e4 = (ushort *)(local_2e8 + 1);
        }
      }
      goto LAB_6b8121da;
    }
    if (uVar4 == 2) {
      iVar2 = KernelBaseGetGlobalData();
      local_2e8 = *(short **)(iVar2 + 0x30);
      if (*(int *)(local_2ec + 0xc) != 0) {
        local_2e8 = local_2e8 + *(int *)(local_2e8 + *(int *)(local_2ec + 0xc) + 1);
      }
      local_2dc = 0x20;
      goto LAB_6b812199;
    }
    if (uVar4 == 8) {
      iVar2 = KernelBaseGetGlobalData();
      local_2e8 = *(short **)(iVar2 + 0x30);
      if (*(int *)(local_2ec + 8) != 0) {
        local_2e8 = local_2e8 + *(int *)(local_2e8 + *(int *)(local_2ec + 8) + 1);
      }
      local_2dc = 0x1006;
      goto LAB_6b812199;
    }
    uVar10 = 0x3ec;
  }
  else {
LAB_6b8121da:
    if (local_2c8 == (ushort *)0x0) {
      GetLocalTime((LPSYSTEMTIME)local_2c0);
    }
    else {
      local_2c0._0_2_ = *local_2c8;
      local_2c0._2_2_ = local_2c8[1];
      local_2c0._4_2_ = local_2c8[2];
      local_2c0._6_2_ = local_2c8[3];
      local_2c0._8_4_ = 0;
      local_2b4 = 0;
      iVar2 = FUN_6b812cd9((undefined2 *)local_2c0);
      if (iVar2 == 0) goto LAB_6b828708;
    }
    if (param_7 == 6) {
      bVar7 = FUN_6b8449ea((ushort *)local_2c0,param_2);
      iVar2 = CONCAT31(extraout_var,bVar7);
LAB_6b828700:
      if (iVar2 == 0) goto LAB_6b828708;
    }
    else {
      if (param_7 == 8) {
        bVar7 = FUN_6b8449a5((ushort *)local_2c0,&local_2d8);
        iVar2 = CONCAT31(extraout_var_00,bVar7);
        goto LAB_6b828700;
      }
      if (param_7 == 0x17) {
        iVar2 = FUN_6b844a5b((ushort *)local_2c0);
        goto LAB_6b828700;
      }
      if (param_7 == 0x16) {
        bVar7 = FUN_6b844a23((undefined2 *)local_2c0);
        iVar2 = CONCAT31(extraout_var_01,bVar7);
        goto LAB_6b828700;
      }
    }
    uVar4 = param_2;
    if ((param_2 & 0x40) != 0) {
      uVar4 = param_2 | 0x10;
      iVar2 = GetLocaleInfoHelper(param_1,0x20000070,&local_2d4,2);
      if ((iVar2 != 0) && (local_2d4 == 1)) {
        if ((*param_1 & 0x3ff) == 0xd) {
          if (local_2dc == 0x1f) {
            bVar7 = param_7 == 8;
LAB_6b828739:
            if (!bVar7) goto LAB_6b812253;
          }
        }
        else if (((param_7 != 1) && (param_7 != 6)) &&
                ((param_7 != 0x16 && (((param_7 != 0x17 && (param_7 != 10)) && (param_7 != 0xb))))))
        {
          bVar7 = param_7 == 0xc;
          goto LAB_6b828739;
        }
        uVar4 = param_2 | 0x30;
      }
    }
LAB_6b812253:
    param_2 = uVar4;
    uVar8 = FUN_6b812372(param_1,param_2,(ushort *)local_2c0,local_2e4,local_210,param_7,local_2ec,1
                         ,0,local_2d8);
    local_2d8 = (uint)uVar8;
    if (param_6 == 0) goto LAB_6b8122c1;
    if (param_6 < (int)local_2d8) {
      uVar10 = 0x7a;
      goto LAB_6b82870a;
    }
    if (local_2d8 == 0) goto LAB_6b828708;
    if ((param_2 & 0x40) != 0) {
      if (param_7 != 8) {
        if (param_7 != 1) goto LAB_6b8122a0;
        if ((*param_1 & 0x3ff) != 0xd) {
          if ((*(uint *)(param_1 + 0x12) & 0x800a) == 0) {
            uVar4 = 0;
          }
          else {
            if (*(int *)(*(int *)(param_1 + 8) + 0xac) == 0) {
              param_1 = *(ushort **)(param_1 + 0x1c);
            }
            uVar4 = *(uint *)(*(int *)(param_1 + 10) + 2 +
                             *(int *)(*(int *)(param_1 + 8) + 0xac) * 2) >> 0xb & 1;
          }
          if (uVar4 == 0) goto LAB_6b8122a0;
        }
      }
      uVar5 = 0x200f;
      iVar2 = 0;
      uVar1 = 0x200e;
      if ((int)local_2d8 < 1) {
LAB_6b8287cf:
        local_2d0 = 0;
      }
      else {
        do {
          if (local_210[iVar2] - 0x591 < 100) {
            uVar5 = uVar1;
            uVar1 = 0x200f;
            break;
          }
          iVar2 = iVar2 + 1;
        } while (iVar2 < (int)local_2d8);
        if ((int)local_2d8 <= iVar2) goto LAB_6b8287cf;
      }
      if (((param_2 & 0x20) != local_2d0) && (0 < (int)local_2d8)) {
        do {
          if (local_210[iVar6] == uVar5) {
            local_210[iVar6] = uVar1;
          }
          iVar6 = iVar6 + 1;
        } while (iVar6 < (int)local_2d8);
      }
    }
LAB_6b8122a0:
    uVar9 = FUN_6b812c57(local_2c4,local_2d8,(int)local_210);
    uVar8 = uVar9 & 0xffffffff00000000 | (ulonglong)local_2d8;
    if (-1 < (int)uVar9) goto LAB_6b8122c1;
    uVar10 = 0xe;
  }
LAB_6b82870a:
  RtlSetLastWin32Error(uVar10);
  uVar8 = CONCAT44(extraout_EDX,local_2d8);
LAB_6b8122c1:
  local_2d8 = (uint)uVar8;
  FUN_6b8224af(local_c ^ (uint)&local_2ec,(int)(uVar8 >> 0x20));
  return;
}



void __fastcall
FUN_6b812372(ushort *param_1,uint param_2,ushort *param_3,ushort *param_4,ushort *param_5,
            uint param_6,int param_7,int param_8,uint param_9,int param_10)

{
  bool bVar1;
  bool bVar2;
  int iVar3;
  undefined3 extraout_var;
  int iVar4;
  undefined3 extraout_var_00;
  short *psVar5;
  ushort uVar6;
  uint uVar7;
  uint extraout_EDX;
  uint extraout_EDX_00;
  undefined4 extraout_EDX_01;
  uint extraout_EDX_02;
  undefined4 extraout_EDX_03;
  uint extraout_EDX_04;
  uint extraout_EDX_05;
  uint extraout_EDX_06;
  ushort *puVar8;
  uint uVar9;
  uint this;
  undefined8 uVar10;
  uint local_44;
  uint local_40;
  ushort *local_3c;
  ushort *local_38;
  uint local_34;
  int local_30;
  int local_2c;
  short *local_28;
  uint local_24;
  ushort *local_20;
  short local_1c [10];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_44 = 0;
  local_40 = 0;
  uVar6 = *param_4;
  local_2c = param_7;
  local_30 = 0;
  bVar1 = false;
  local_20 = param_5;
  local_24 = 0x100;
  local_38 = param_1;
  local_34 = param_2;
  if (uVar6 != 0) {
    local_3c = param_5;
    do {
      iVar4 = local_2c;
      uVar7 = (uint)uVar6;
      if (uVar6 == 0x27) {
        iVar4 = FUN_6b812675(&local_20,local_34,&local_24);
        uVar7 = extraout_EDX_06;
        if (iVar4 == 0) goto LAB_6b812446;
        puVar8 = param_4 + 1;
        uVar6 = *puVar8;
        if (uVar6 == 0x5d1) {
          if (((((*local_38 & 0x3ff) == 0xd) || (param_6 == 8)) && (param_4[2] == 0x27)) &&
             (param_4[3] == 0x4d)) {
            bVar1 = true;
            goto LAB_6b828b95;
          }
        }
        else {
LAB_6b828b95:
          if (uVar6 == 0) goto LAB_6b812426;
        }
        do {
          uVar7 = (uint)uVar6;
          if (uVar6 == 0x27) {
            puVar8 = puVar8 + 1;
            if (*puVar8 != 0x27) break;
            if (local_24 < 2) goto LAB_6b812446;
            uVar6 = 0x27;
          }
          else if (local_24 < 2) goto LAB_6b812446;
          puVar8 = puVar8 + 1;
          local_24 = local_24 - 1;
          *local_20 = uVar6;
          local_20 = local_20 + 1;
          uVar6 = *puVar8;
        } while (uVar6 != 0);
      }
      else {
        if (uVar6 == 0x4d) {
          uVar9 = 0;
          puVar8 = param_4;
          while (puVar8 = puVar8 + 1, *puVar8 == 0x4d) {
            uVar9 = uVar9 + 1;
          }
          if (bVar1) {
            if (((int)uVar9 < 3) &&
               (iVar4 = FUN_6b812675(&local_20,local_34,&local_24), uVar7 = extraout_EDX_05,
               iVar4 == 0)) goto LAB_6b812446;
            bVar1 = false;
          }
          else {
            iVar4 = FUN_6b812675(&local_20,local_34,&local_24);
            uVar7 = extraout_EDX_00;
            if (iVar4 == 0) goto LAB_6b812446;
          }
          if (uVar9 < 2) {
            this = (uint)param_3[1];
            if (param_6 == 8) {
LAB_6b828867:
              uVar10 = FUN_6b844b33(this,(int)local_1c);
              uVar7 = (uint)((ulonglong)uVar10 >> 0x20);
              if ((int)uVar10 != 0) {
                psVar5 = local_1c;
                param_4 = puVar8;
                goto LAB_6b812572;
              }
              goto LAB_6b812446;
            }
            uVar9 = uVar9 + 1;
LAB_6b812603:
            uVar10 = FUN_6b812b73(this,uVar9,(short **)&local_20,&local_24);
          }
          else {
            uVar7 = param_3[1] - 1;
            param_4 = puVar8;
            if (*(int *)(local_2c + 0x20) == 0) {
              iVar4 = *(int *)(local_38 + 8);
              psVar5 = *(short **)(local_38 + 10);
              local_28 = psVar5;
              if (uVar9 == 2) {
                if (*(int *)(iVar4 + 200) != 0) {
                  local_28 = psVar5 + *(int *)(psVar5 + *(int *)(iVar4 + 200) + uVar7 * 2 + 1) + 1;
                }
                iVar4 = *(int *)(iVar4 + 0xd0);
              }
              else {
                if (*(int *)(iVar4 + 0xc4) != 0) {
                  local_28 = psVar5 + *(int *)(psVar5 + *(int *)(iVar4 + 0xc4) + uVar7 * 2 + 1) + 1;
                }
                iVar4 = *(int *)(iVar4 + 0xcc);
              }
              if ((iVar4 != 0) && (uVar7 < (ushort)psVar5[iVar4])) {
                psVar5 = psVar5 + *(int *)(psVar5 + iVar4 + uVar7 * 2 + 1) + 1;
              }
              if ((psVar5 != (short *)0x0) && (*psVar5 != 0)) {
                if (local_30 != 0) goto LAB_6b812572;
                bVar2 = false;
                uVar6 = *puVar8;
                while (uVar6 != 0) {
                  if (uVar6 != 0x27) {
                    if (bVar2) goto LAB_6b828ae4;
                    if ((uVar6 != 0x67) && (uVar6 != 0x79)) {
                      if (uVar6 != 100) goto LAB_6b828ae4;
                      iVar4 = 0;
                      do {
                        puVar8 = puVar8 + 1;
                        iVar4 = iVar4 + 1;
                      } while (*puVar8 == 100);
                      if ((iVar4 != 1) && (iVar4 != 2)) break;
                      goto LAB_6b812572;
                    }
                    break;
                  }
                  bVar2 = !bVar2;
LAB_6b828ae4:
                  puVar8 = puVar8 + 1;
                  uVar6 = *puVar8;
                }
              }
              psVar5 = local_28;
            }
            else {
              if (((param_6 == 8) && (param_10 == 0)) && (5 < (int)uVar7)) {
                uVar7 = (uint)param_3[1];
              }
              iVar4 = KernelBaseGetGlobalData();
              psVar5 = *(short **)(iVar4 + 0x30);
              if (uVar9 == 2) {
                iVar4 = *(int *)(local_2c + 0x24);
              }
              else {
                iVar4 = *(int *)(local_2c + 0x20);
              }
              if (iVar4 != 0) {
                psVar5 = psVar5 + *(int *)(psVar5 + iVar4 + uVar7 * 2 + 1) + 1;
              }
            }
LAB_6b812572:
            bVar2 = FUN_6b812c0f((short **)&local_20,&local_24,psVar5);
            uVar10 = CONCAT44(extraout_EDX_01,CONCAT31(extraout_var,bVar2));
            puVar8 = param_4;
          }
          uVar7 = (uint)((ulonglong)uVar10 >> 0x20);
          if ((int)uVar10 == 0) goto LAB_6b812446;
        }
        else {
          if (uVar6 == 100) {
            iVar3 = FUN_6b812675(&local_20,local_34,&local_24);
            uVar7 = extraout_EDX;
            if (iVar3 != 0) {
              puVar8 = param_4 + 1;
              iVar3 = 0;
              if (*puVar8 == 100) {
                do {
                  puVar8 = puVar8 + 1;
                  iVar3 = iVar3 + 1;
                } while (*puVar8 == 100);
                if (iVar3 < 0) {
LAB_6b812616:
                  local_30 = 0;
                  if (*(int *)(iVar4 + 0x18) == 0) {
                    iVar4 = *(int *)(*(int *)(local_38 + 8) + 0xbc);
LAB_6b81262e:
                    local_30 = 0;
                    psVar5 = *(short **)(local_38 + 10);
                  }
                  else {
                    iVar3 = KernelBaseGetGlobalData();
                    iVar4 = *(int *)(iVar4 + 0x18);
                    psVar5 = *(short **)(iVar3 + 0x30);
                  }
                }
                else {
                  if (iVar3 < 2) goto LAB_6b812499;
                  if (iVar3 != 2) goto LAB_6b812616;
                  local_30 = 0;
                  if (*(int *)(iVar4 + 0x1c) == 0) {
                    iVar4 = *(int *)(*(int *)(local_38 + 8) + 0xc0);
                    goto LAB_6b81262e;
                  }
                  iVar3 = KernelBaseGetGlobalData();
                  iVar4 = *(int *)(iVar4 + 0x1c);
                  psVar5 = *(short **)(iVar3 + 0x30);
                }
                if (iVar4 != 0) {
                  psVar5 = psVar5 + *(int *)(psVar5 + iVar4 + (uint)param_3[2] * 2 + 1) + 1;
                }
LAB_6b81264a:
                bVar2 = FUN_6b812c0f((short **)&local_20,&local_24,psVar5);
                uVar10 = CONCAT44(extraout_EDX_03,CONCAT31(extraout_var_00,bVar2));
              }
              else {
LAB_6b812499:
                local_30 = 1;
                if (param_6 == 8) {
                  uVar10 = FUN_6b844b33((uint)param_3[3],(int)local_1c);
                  uVar7 = (uint)((ulonglong)uVar10 >> 0x20);
                  if ((int)uVar10 != 0) {
                    psVar5 = local_1c;
                    goto LAB_6b81264a;
                  }
                  goto LAB_6b812446;
                }
                uVar10 = FUN_6b812b73((uint)param_3[3],iVar3 + 1,(short **)&local_20,&local_24);
              }
              uVar7 = (uint)((ulonglong)uVar10 >> 0x20);
              if ((int)uVar10 != 0) goto LAB_6b812426;
            }
            goto LAB_6b812446;
          }
          if (uVar6 == 0x67) {
            iVar4 = FUN_6b812675(&local_20,local_34,&local_24);
            uVar7 = extraout_EDX_04;
            if (iVar4 != 0) {
              do {
                param_4 = param_4 + 1;
              } while (*param_4 == 0x67);
              if (param_6 == 1) {
                iVar4 = *(int *)(local_38 + 10) + *(int *)(*(int *)(local_38 + 8) + 0x108) * 2;
              }
              else {
                iVar4 = FUN_6b812d96(param_6,local_2c);
                uVar7 = 1;
                if ((iVar4 != 0) && (uVar7 = param_9, param_8 != 0)) {
                  if (local_44 == 0) {
                    iVar4 = KernelBaseGetGlobalData();
                    uVar7 = FUN_6b8448ae(&local_40,(short *)0x0,param_6,local_2c,
                                         *(int *)(iVar4 + 0x30),*param_3,param_3[1],param_3[3]);
                    local_3c = (ushort *)(uVar7 & 0xffff);
                    local_44 = local_40;
                    uVar7 = 1;
                    if (local_40 == 0) goto LAB_6b82887f;
                  }
                  uVar7 = (uint)*(ushort *)(local_44 + 2);
                }
LAB_6b82887f:
                iVar4 = GetEraNameCountedString(param_6,local_2c,uVar7,4);
              }
              psVar5 = (short *)(iVar4 + 2);
              goto LAB_6b812572;
            }
            goto LAB_6b812446;
          }
          if (uVar6 != 0x79) {
            if (1 < local_24) {
              puVar8 = param_4 + 1;
              local_24 = local_24 - 1;
              *local_20 = uVar6;
              local_20 = local_20 + 1;
              goto LAB_6b812426;
            }
            goto LAB_6b812446;
          }
          iVar4 = FUN_6b812675(&local_20,local_34,&local_24);
          uVar7 = extraout_EDX_02;
          if (iVar4 == 0) goto LAB_6b812446;
          uVar9 = 0;
          while (puVar8 = param_4 + 1, *puVar8 == 0x79) {
            uVar9 = uVar9 + 1;
            param_4 = puVar8;
          }
          iVar4 = FUN_6b812d96(param_6,local_2c);
          if ((iVar4 == 0) || (param_8 == 0)) {
            local_3c = (ushort *)(uint)*param_3;
          }
          else if (local_44 == 0) {
            iVar4 = KernelBaseGetGlobalData();
            uVar7 = FUN_6b8448ae(&local_40,(short *)0x0,param_6,local_2c,*(int *)(iVar4 + 0x30),
                                 *param_3,param_3[1],param_3[3]);
            local_3c = (ushort *)(uVar7 & 0xffff);
            local_44 = local_40;
          }
          this = (uint)local_3c & 0xffff;
          if (param_6 == 8) {
            this = (uint)local_3c & 0xffff;
            goto LAB_6b828867;
          }
          if ((param_6 != 3) || ((short)local_3c != 1)) {
LAB_6b8125ec:
            if (uVar9 < 2) {
              uVar9 = uVar9 + 1;
              this = this % 100;
            }
            else {
              uVar9 = 2;
            }
            goto LAB_6b812603;
          }
          uVar10 = FUN_6b844aa3(1,local_3c);
          uVar7 = (uint)((ulonglong)uVar10 >> 0x20);
          if (((int)uVar10 != 0) ||
             ((*puVar8 != 0x5e74 && ((uVar7 = 0x27, *puVar8 != 0x27 || (param_4[2] != 0x5e74))))))
          goto LAB_6b8125ec;
          if (local_24 == 0) goto LAB_6b812446;
          local_24 = local_24 - 1;
          *local_20 = 0x5143;
          local_20 = local_20 + 1;
        }
        local_30 = 0;
      }
LAB_6b812426:
      uVar6 = *puVar8;
      param_4 = puVar8;
    } while (uVar6 != 0);
  }
  uVar7 = 0;
  *local_20 = 0;
LAB_6b812446:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar7);
  return;
}



undefined4 __fastcall FUN_6b812675(ushort **param_1,uint param_2,uint *param_3)

{
  uint uVar1;
  ushort *puVar2;
  
  if ((param_2 & 0x30) != 0) {
    uVar1 = *param_3;
    if (uVar1 < 2) {
      return 0;
    }
    puVar2 = *param_1;
    *puVar2 = (ushort)(param_2 >> 5) & 1 | 0x200e;
    *param_1 = puVar2 + 1;
    *param_3 = uVar1 - 1;
  }
  return 1;
}



void GetTimeFormatWWorker
               (int param_1,uint param_2,int param_3,ushort *param_4,short *param_5,int param_6)

{
  int iVar1;
  uint uVar2;
  undefined4 extraout_EDX;
  int iVar3;
  undefined8 uVar4;
  undefined4 uVar5;
  _SYSTEMTIME local_2b8;
  ushort local_2a8 [256];
  undefined local_a8 [2];
  ushort local_a6 [79];
  uint local_8;
  
                    // 0x126c0  787  GetTimeFormatWWorker
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  if (param_4 == (ushort *)0x0) {
    iVar1 = NlsIsUserDefaultLocale(param_1);
    if ((param_2 & 3) == 0) {
      if (((int)param_2 < 0) ||
         (iVar1 = GetUserOverrideString(param_1,0,-(uint)(iVar1 != 0) & 0x13a,local_a8,0x50,0),
         iVar1 == 0)) {
        iVar1 = *(int *)(*(int *)(param_1 + 0x10) + 0x58);
LAB_6b828bfd:
        iVar3 = *(int *)(param_1 + 0x14);
        if (iVar1 != 0) {
          iVar3 = iVar3 + *(int *)(iVar3 + 2 + iVar1 * 2) * 2;
        }
        param_4 = (ushort *)(iVar3 + 2);
        goto LAB_6b8126fb;
      }
    }
    else if (((int)param_2 < 0) ||
            (iVar1 = GetUserOverrideString(param_1,0,-(uint)(iVar1 != 0) & 0x1dc,local_a8,0x50,0),
            iVar1 == 0)) {
      iVar1 = *(int *)(*(int *)(param_1 + 0x10) + 0x118);
      goto LAB_6b828bfd;
    }
    param_4 = local_a6;
  }
LAB_6b8126fb:
  if (param_3 == 0) {
    GetLocalTime(&local_2b8);
LAB_6b812742:
    uVar4 = FUN_6b812823(param_1,(int)&local_2b8,param_4,local_2a8,param_2);
    uVar5 = (undefined4)((ulonglong)uVar4 >> 0x20);
    uVar2 = (uint)uVar4;
    if ((param_6 == 0) || (param_5 == (short *)0x0)) goto LAB_6b812795;
    if (param_6 < (int)uVar2) {
      uVar5 = 0x7a;
    }
    else {
      if (uVar2 == 0) goto LAB_6b828c38;
      uVar4 = FUN_6b812c57(param_5,uVar2,(int)local_2a8);
      uVar5 = (undefined4)((ulonglong)uVar4 >> 0x20);
      if (-1 < (int)uVar4) goto LAB_6b812795;
      uVar5 = 0xe;
    }
  }
  else {
    local_2b8.wHour = *(WORD *)(param_3 + 8);
    local_2b8.wMinute = *(WORD *)(param_3 + 10);
    local_2b8.wSecond = *(WORD *)(param_3 + 0xc);
    local_2b8.wMilliseconds = *(WORD *)(param_3 + 0xe);
    iVar1 = FUN_6b812c30((int)&local_2b8);
    if (iVar1 != 0) goto LAB_6b812742;
LAB_6b828c38:
    uVar5 = 0x57;
  }
  RtlSetLastWin32Error(uVar5);
  uVar5 = extraout_EDX;
LAB_6b812795:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar5);
  return;
}



void __fastcall
FUN_6b812823(undefined4 param_1,int param_2,ushort *param_3,ushort *param_4,uint param_5)

{
  ushort uVar1;
  bool bVar2;
  ushort uVar3;
  uint uVar4;
  ushort *puVar5;
  undefined3 extraout_var;
  undefined4 extraout_EDX;
  ushort *puVar6;
  uint uVar7;
  int iVar8;
  undefined8 uVar9;
  ushort *puVar10;
  uint local_c0;
  ushort *local_bc;
  ushort *local_b8;
  int local_b4;
  uint local_b0;
  ushort *local_ac;
  ushort local_a8 [80];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_b4 = 0;
  uVar3 = *param_3;
  local_ac = param_4;
  local_b8 = param_3;
  uVar7 = 0x100;
  local_b0 = 0x100;
  if (uVar3 != 0) {
    local_bc = param_4;
    local_c0 = 0x100;
    puVar6 = param_3;
    do {
      uVar4 = (uint)uVar3;
      puVar10 = param_3;
      if (uVar4 == 0x27) {
        puVar6 = puVar6 + 1;
        uVar3 = *puVar6;
        while (uVar3 != 0) {
          if (uVar3 == 0x27) {
            puVar6 = puVar6 + 1;
            if (*puVar6 != 0x27) break;
            if (uVar7 < 2) goto LAB_6b8129c4;
            *param_4 = 0x27;
          }
          else {
            if (uVar7 < 2) goto LAB_6b8129c4;
            *param_4 = uVar3;
          }
          puVar6 = puVar6 + 1;
          uVar7 = uVar7 - 1;
          param_4 = param_4 + 1;
          local_b0 = uVar7;
          local_ac = param_4;
          uVar3 = *puVar6;
        }
        goto LAB_6b8129a4;
      }
      if (uVar4 == 0x48) {
        puVar10 = (ushort *)0x2;
        iVar8 = 0;
        while (puVar6 = puVar6 + 1, *puVar6 == 0x48) {
          iVar8 = iVar8 + 1;
        }
        while (0 < local_b4) {
          if (uVar7 < 2) goto LAB_6b8129c4;
          local_b4 = local_b4 + -1;
          *param_4 = 0x20;
          param_4 = param_4 + 1;
          uVar7 = uVar7 - 1;
          local_b0 = uVar7;
          local_ac = param_4;
        }
        uVar7 = (uint)*(ushort *)(param_2 + 8);
        param_3 = puVar6;
        if (iVar8 == 0) {
LAB_6b812a58:
          puVar10 = (ushort *)&DAT_00000001;
          param_3 = puVar6;
        }
LAB_6b812977:
        uVar9 = FUN_6b812b73(uVar7,(uint)puVar10,(short **)&local_ac,&local_b0);
LAB_6b81297c:
        puVar10 = (ushort *)((ulonglong)uVar9 >> 0x20);
        puVar6 = param_3;
        param_4 = local_ac;
        uVar7 = local_b0;
        local_c0 = local_b0;
        local_bc = local_ac;
        local_b8 = param_3;
        if ((int)uVar9 == 0) goto LAB_6b8129c4;
      }
      else {
        if (uVar4 == 0x68) {
          uVar3 = *(ushort *)(param_2 + 8);
          if ((param_5 & 8) == 0) {
            uVar3 = *(ushort *)(param_2 + 8) % 0xc;
            if (uVar3 == 0) {
              uVar3 = 0xc;
            }
          }
          puVar5 = (ushort *)0x0;
          while (puVar6 = puVar6 + 1, *puVar6 == 0x68) {
            puVar5 = (ushort *)((int)puVar5 + 1);
          }
          while (0 < local_b4) {
            puVar10 = puVar5;
            if (uVar7 < 2) goto LAB_6b8129c4;
            local_b4 = local_b4 + -1;
            *param_4 = 0x20;
            param_4 = param_4 + 1;
            uVar7 = uVar7 - 1;
            local_b0 = uVar7;
            local_ac = param_4;
          }
LAB_6b812961:
          uVar7 = (uint)uVar3;
          if (puVar5 == (ushort *)0x0) goto LAB_6b812a58;
          puVar10 = (ushort *)0x2;
          param_3 = puVar6;
          goto LAB_6b812977;
        }
        if (uVar4 != 0x6d) {
          puVar5 = (ushort *)(uVar4 - 0x73);
          if (puVar5 == (ushort *)0x0) {
            while (puVar6 = puVar6 + 1, *puVar6 == 0x73) {
              puVar5 = (ushort *)((int)puVar5 + 1);
            }
            if ((param_5 & 3) == 0) {
              if (0 < local_b4) {
                do {
                  puVar10 = (ushort *)0x20;
                  if (uVar7 < 2) goto LAB_6b8129c4;
                  local_b4 = local_b4 + -1;
                  *param_4 = 0x20;
                  param_4 = param_4 + 1;
                  uVar7 = uVar7 - 1;
                  local_b0 = uVar7;
                  local_ac = param_4;
                } while (0 < local_b4);
              }
              uVar3 = *(ushort *)(param_2 + 0xc);
              goto LAB_6b812961;
            }
            bVar2 = false;
            while (puVar6 != param_3) {
              if (*param_3 == 0x27) {
                bVar2 = !bVar2;
              }
              else if (bVar2) {
                *local_bc = *param_3;
                local_bc = local_bc + 1;
                local_c0 = local_c0 - 1;
              }
              param_3 = param_3 + 1;
              local_b8 = param_3;
            }
            uVar3 = *puVar6;
            iVar8 = 0;
            bVar2 = false;
            local_b4 = 0;
            param_4 = local_bc;
            uVar7 = local_c0;
            local_b0 = local_c0;
            local_ac = local_bc;
            if (uVar3 != 0) {
              uVar1 = *param_3;
              do {
                param_3 = local_b8;
                if (uVar1 == 0x27) {
                  if (bVar2) {
                    bVar2 = false;
                    goto LAB_6b828d92;
                  }
                  bVar2 = true;
                }
                else {
LAB_6b828d92:
                  if (!bVar2) {
                    if (uVar3 == 0x20) {
                      iVar8 = iVar8 + 1;
                    }
                    else {
                      local_b4 = iVar8;
                      local_b0 = local_c0;
                      if ((((uVar3 == 0x68) || (local_b0 = local_c0, uVar3 == 0x48)) ||
                          (local_b0 = local_c0, uVar3 == 0x74)) ||
                         (local_b0 = local_c0, uVar3 == 0x6d)) break;
                    }
                  }
                }
                puVar6 = puVar6 + 1;
                uVar3 = *puVar6;
                local_b4 = iVar8;
                local_b0 = local_c0;
              } while (uVar3 != 0);
            }
            goto LAB_6b8129a4;
          }
          if (puVar5 == (ushort *)&DAT_00000001) {
            param_3 = puVar6 + 1;
            puVar10 = (ushort *)0x0;
            uVar3 = *param_3;
            while (uVar3 == 0x74) {
              param_3 = param_3 + 1;
              puVar10 = (ushort *)((int)puVar10 + 1);
              uVar3 = *param_3;
            }
            for (; 0 < local_b4; local_b4 = local_b4 + -1) {
              if (uVar7 < 2) goto LAB_6b8129c4;
              *param_4 = 0x20;
              param_4 = param_4 + 1;
              uVar7 = uVar7 - 1;
              local_b0 = uVar7;
              local_ac = param_4;
            }
            puVar6 = param_3;
            local_b8 = param_3;
            if ((param_5 & 4) != 0) {
              local_ac = local_bc;
              local_b0 = local_c0;
              for (; ((uVar3 = *puVar6, param_4 = local_bc, uVar7 = local_c0, uVar3 != 0 &&
                      (uVar3 != 0x68)) && ((uVar3 != 0x48 && ((uVar3 != 0x6d && (uVar3 != 0x73))))))
                  ; puVar6 = puVar6 + 1) {
              }
              goto LAB_6b8129a4;
            }
            if (puVar10 == (ushort *)0x2) {
              uVar4 = 0x7f - (*(ushort *)(param_2 + 8) < 0xc);
            }
            else {
              uVar4 = 0x29 - (*(ushort *)(param_2 + 8) < 0xc);
            }
            uVar9 = GetLocaleInfoHelper(param_1,uVar4 | param_5 & 0x80000000,local_a8,0x50);
            if ((int)uVar9 == 0) {
              local_a8[0] = 0;
            }
            if (local_a8[0] == 0) {
              local_ac = local_bc;
              param_4 = local_bc;
              uVar7 = local_c0;
              local_b0 = local_c0;
              goto LAB_6b8129a4;
            }
            if (puVar10 != (ushort *)0x0) {
              bVar2 = FUN_6b812c0f((short **)&local_ac,&local_b0,(short *)local_a8);
              uVar9 = CONCAT44(extraout_EDX,CONCAT31(extraout_var,bVar2));
              goto LAB_6b81297c;
            }
            puVar10 = (ushort *)((ulonglong)uVar9 >> 0x20);
            if (1 < uVar7) {
              *param_4 = local_a8[0];
              param_4 = param_4 + 1;
              uVar7 = uVar7 - 1;
              local_c0 = uVar7;
              local_bc = param_4;
              local_b0 = uVar7;
              local_ac = param_4;
              goto LAB_6b8129a4;
            }
          }
          else if (1 < uVar7) {
            *param_4 = uVar3;
            local_ac = param_4 + 1;
            uVar7 = uVar7 - 1;
            puVar6 = puVar6 + 1;
            param_4 = local_ac;
            local_b0 = uVar7;
            goto LAB_6b8129a4;
          }
          goto LAB_6b8129c4;
        }
        puVar5 = (ushort *)0x0;
        while (puVar6 = puVar6 + 1, *puVar6 == 0x6d) {
          puVar5 = (ushort *)((int)puVar5 + 1);
        }
        if ((param_5 & 1) == 0) {
          if (0 < local_b4) {
            do {
              puVar10 = (ushort *)0x20;
              if (uVar7 < 2) goto LAB_6b8129c4;
              local_b4 = local_b4 + -1;
              *param_4 = 0x20;
              param_4 = param_4 + 1;
              uVar7 = uVar7 - 1;
              local_b0 = uVar7;
              local_ac = param_4;
            } while (0 < local_b4);
          }
          uVar3 = *(ushort *)(param_2 + 10);
          goto LAB_6b812961;
        }
        bVar2 = false;
        while (puVar6 != param_3) {
          if (*param_3 == 0x27) {
            bVar2 = !bVar2;
          }
          else if (bVar2) {
            *local_bc = *param_3;
            local_bc = local_bc + 1;
            local_c0 = local_c0 - 1;
          }
          param_3 = param_3 + 1;
          local_b8 = param_3;
        }
        uVar3 = *puVar6;
        iVar8 = 0;
        bVar2 = false;
        local_b4 = 0;
        param_4 = local_bc;
        uVar7 = local_c0;
        local_b0 = local_c0;
        local_ac = local_bc;
        if (uVar3 != 0) {
          uVar1 = *param_3;
          do {
            param_3 = local_b8;
            if (uVar1 == 0x27) {
              if (bVar2) {
                bVar2 = false;
                goto LAB_6b828e83;
              }
              bVar2 = true;
            }
            else {
LAB_6b828e83:
              if (!bVar2) {
                if (uVar3 == 0x20) {
                  iVar8 = iVar8 + 1;
                }
                else {
                  local_b4 = iVar8;
                  local_b0 = local_c0;
                  if (((uVar3 == 0x68) || (local_b0 = local_c0, uVar3 == 0x48)) ||
                     (local_b0 = local_c0, uVar3 == 0x74)) break;
                }
              }
            }
            puVar6 = puVar6 + 1;
            uVar3 = *puVar6;
            local_b4 = iVar8;
            local_b0 = local_c0;
          } while (uVar3 != 0);
        }
      }
LAB_6b8129a4:
      uVar3 = *puVar6;
    } while (uVar3 != 0);
  }
  *param_4 = 0;
  puVar10 = param_3;
LAB_6b8129c4:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,puVar10);
  return;
}



void __thiscall FUN_6b812b73(undefined4 this,uint param_2,short **param_3,uint *param_4)

{
  uint uVar1;
  undefined4 extraout_EDX;
  undefined4 uVar2;
  uint uVar3;
  undefined8 uVar4;
  uint local_90;
  short *local_8c;
  short local_88 [64];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_8c = local_88;
  local_90 = 0x800080;
  uVar4 = RtlIntegerToUnicodeString(this,10,&local_90);
  uVar2 = (undefined4)((ulonglong)uVar4 >> 0x20);
  if (-1 < (int)uVar4) {
    uVar3 = local_90 >> 1 & 0x7fff;
    if (uVar3 < param_2) {
      uVar1 = *param_4;
      do {
        if (uVar1 == 0) break;
        uVar3 = uVar3 + 1;
        **param_3 = 0x30;
        *param_3 = *param_3 + 1;
        *param_4 = *param_4 - 1;
        uVar1 = *param_4;
      } while (uVar3 < param_2);
    }
    FUN_6b812c0f(param_3,param_4,local_8c);
    uVar2 = extraout_EDX;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



bool __fastcall FUN_6b812c0f(short **param_1,uint *param_2,short *param_3)

{
  int iVar1;
  
  iVar1 = FUN_6b81ec6c(*param_1,*param_2,param_3,param_1,param_2);
  return -1 < iVar1;
}



undefined4 __fastcall FUN_6b812c30(int param_1)

{
  if ((((*(ushort *)(param_1 + 8) < 0x18) && (*(ushort *)(param_1 + 10) < 0x3c)) &&
      (*(ushort *)(param_1 + 0xc) < 0x3d)) && (*(ushort *)(param_1 + 0xe) < 1000)) {
    return 1;
  }
  return 0;
}



void __fastcall FUN_6b812c57(short *param_1,uint param_2,int param_3)

{
  int iVar1;
  
  iVar1 = 0;
  if ((param_2 == 0) || (0x7fffffff < param_2)) {
    iVar1 = -0x7ff8ffa9;
  }
  if (iVar1 < 0) {
    if (param_2 != 0) {
      *param_1 = 0;
    }
  }
  else {
    FUN_6b812c87(param_1,param_2,param_1,param_3);
  }
  return;
}



int __fastcall FUN_6b812c87(short *param_1,int param_2,undefined4 param_3,int param_4)

{
  short sVar1;
  int iVar2;
  int iVar3;
  
  if (param_2 != 0) {
    iVar3 = 0x7ffffffe;
    iVar2 = param_4 - (int)param_1;
    do {
      if ((iVar3 == 0) || (sVar1 = *(short *)(iVar2 + (int)param_1), sVar1 == 0)) break;
      *param_1 = sVar1;
      param_1 = param_1 + 1;
      iVar3 = iVar3 + -1;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
    if (param_2 != 0) goto LAB_6b812cbb;
  }
  param_1 = param_1 + -1;
LAB_6b812cbb:
  *param_1 = 0;
  return (-(uint)(param_2 != 0) & 0x7ff8ff86) + 0x8007007a;
}



void __fastcall FUN_6b812cd9(undefined2 *param_1)

{
  char cVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar2;
  undefined local_24 [12];
  undefined2 local_18;
  undefined2 local_16;
  undefined2 local_14;
  undefined4 local_12;
  undefined4 local_e;
  undefined2 local_a;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_18 = *param_1;
  local_16 = param_1[1];
  local_14 = param_1[3];
  local_12 = 0;
  local_e = 0;
  cVar1 = RtlTimeFieldsToTime(&local_18,local_24);
  uVar2 = extraout_EDX;
  if (cVar1 != '\0') {
    RtlTimeToTimeFields(local_24,&local_18);
    param_1[2] = local_a;
    uVar2 = extraout_EDX_00;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



uint __fastcall FUN_6b812d49(uint param_1,uint param_2)

{
  ushort *puVar1;
  int iVar2;
  uint uVar3;
  ushort *puVar4;
  uint local_8;
  
  local_8 = param_1;
  iVar2 = NlsIsUserDefaultLocale(param_1);
  if ((((iVar2 == 0) || (param_2 == 0)) ||
      (uVar3 = GetLocaleInfoHelper(param_1,0x20001009,&local_8,2), uVar3 == 0)) ||
     (local_8 != param_2)) {
    puVar4 = (ushort *)(*(int *)(param_1 + 0x14) + *(int *)(*(int *)(param_1 + 0x10) + 0x7c) * 2);
    puVar1 = puVar4 + *puVar4;
    do {
      puVar4 = puVar4 + 1;
      if (puVar1 < puVar4) {
        return 0;
      }
      uVar3 = (uint)*puVar4;
    } while (param_2 != uVar3);
  }
  else {
    uVar3 = uVar3 & 0xffff0000 | param_2 & 0xffff;
  }
  return uVar3;
}



undefined4 __fastcall FUN_6b812d96(int param_1,int param_2)

{
  if ((*(int *)(param_2 + 0x14) == 0) && (param_1 != 3)) {
    return 0;
  }
  return 1;
}



int __fastcall FUN_6b812da7(undefined4 param_1,undefined4 param_2,void **param_3)

{
  void *pvVar1;
  uint uVar2;
  int iVar3;
  undefined local_10 [8];
  undefined local_8 [4];
  
  RtlInitUnicodeString(local_10,param_2);
  memset(*param_3,0,0x214);
  iVar3 = NtQueryValueKey(param_1,local_10,1,*param_3,0x214,local_8);
  pvVar1 = *param_3;
  if (*(int *)((int)pvVar1 + 4) != 1) {
    iVar3 = -0x3ffffeb4;
  }
  if (-1 < iVar3) {
    if ((*(int *)((int)pvVar1 + 4) == 1) &&
       (((uVar2 = *(uint *)((int)pvVar1 + 0xc), (uVar2 & 1) != 0 || (uVar2 < 2)) ||
        (*(short *)(*(int *)((int)pvVar1 + 8) + (uVar2 & 0xfffffffe) + -2 + (int)pvVar1) != 0)))) {
      iVar3 = -0x3ffffeb4;
    }
    if (-1 < iVar3) {
      iVar3 = 0;
    }
  }
  return iVar3;
}



LONG InterlockedExchange(LONG *Target,LONG Value)

{
  LONG LVar1;
  
                    // 0x12e40  880  InterlockedExchange
  LVar1 = *Target;
  *Target = Value;
  return LVar1;
}



HANDLE OpenMutexA(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCSTR lpName)

{
  int iVar1;
  HANDLE pvVar2;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x12e60  1036  OpenMutexA
  if (lpName == (LPCSTR)0x0) {
    BaseSetLastNTError(0xc000000d);
  }
  else {
    iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpName);
    if (iVar1 != 0) {
      pvVar2 = OpenMutexW(dwDesiredAccess,bInheritHandle,local_8);
      RtlFreeUnicodeString(local_c);
      return pvVar2;
    }
  }
  return (HANDLE)0x0;
}



HRSRC FindResourceA(HMODULE hModule,LPCSTR lpName,LPCSTR lpType)

{
  HRSRC pHVar1;
  
                    // 0x12eb0  409  FindResourceA
  pHVar1 = FindResourceExA(hModule,lpType,lpName,0);
  return pHVar1;
}



ATOM DeleteAtom(ATOM nAtom)

{
  int iVar1;
  undefined2 in_stack_00000006;
  int local_8;
  
                    // 0x12ed0  276  DeleteAtom
  if (0xbfff < nAtom) {
    iVar1 = FUN_6b81bb24(&local_8);
    if ((-1 < iVar1) && (iVar1 = RtlDeleteAtomFromAtomTable(local_8,_nAtom), -1 < iVar1)) {
      return 0;
    }
    BaseSetLastNTError(iVar1);
  }
  return 0;
}



void CheckElevation(LPCWSTR param_1,uint *param_2,uint param_3,uint *param_4,undefined4 *param_5)

{
  HANDLE hObject;
  int iVar1;
  undefined4 extraout_EDX;
  undefined4 uVar2;
  undefined4 extraout_EDX_00;
  undefined4 local_34;
  uint local_30;
  undefined4 local_2c;
  undefined4 *local_28;
  uint *local_24;
  uint local_20;
  uint *local_1c;
  undefined4 local_18 [3];
  uint local_c;
  
                    // 0x12f10  127  CheckElevation
  local_c = DAT_6b8b0140 ^ (uint)&local_34;
  local_1c = param_2;
  local_20 = param_3;
  local_24 = param_4;
  local_28 = param_5;
  local_30 = 0;
  local_2c = 0;
  local_34 = 0;
  hObject = CreateFileW(param_1,0x80000000,5,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0x0);
  if (hObject == (HANDLE)0xffffffff) {
    GetLastError();
    uVar2 = extraout_EDX_00;
    goto LAB_6b812fd2;
  }
  iVar1 = BasepCheckAppCompat(hObject,param_1,&local_30,&local_34);
  if (iVar1 < 0) {
LAB_6b812fe8:
    RtlNtStatusToDosErrorNoTeb(iVar1);
  }
  else {
    iVar1 = FUN_6b814c46(param_1,local_18);
    if (iVar1 < 0) goto LAB_6b812fe8;
    iVar1 = BaseCheckElevation(0xffffffff,(uint)hObject,param_1,local_1c,local_30,(byte)local_2c,
                               (int)local_18,0,(byte)local_34,local_20,local_24,local_28);
    if (iVar1 < 0) goto LAB_6b812fe8;
  }
  CloseHandle(hObject);
  uVar2 = extraout_EDX;
LAB_6b812fd2:
  FUN_6b8224af(local_c ^ (uint)&local_34,uVar2);
  return;
}



undefined4
BasepCheckAppCompat(undefined4 param_1,wchar_t *param_2,undefined4 *param_3,undefined4 *param_4)

{
  uint uVar1;
  undefined4 extraout_ECX;
  uint local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  
                    // 0x13000  82  BasepCheckAppCompat
  local_1c = local_1c & 0xffff0000;
  local_14 = 0;
  local_18 = 0;
  local_10 = 0;
  local_c = 0;
  BasepGetExeArchType((short *)&local_1c,param_1,param_2);
  uVar1 = FUN_6b8135a0(extraout_ECX,extraout_ECX,&local_14,&local_10,&local_18,extraout_ECX,param_2,
                       param_1,extraout_ECX,extraout_ECX,(short)local_1c);
  if ((int)uVar1 < 0) {
    local_c = 0;
    local_18 = 0;
    local_10 = 0;
  }
  *param_3 = local_10;
  param_3[1] = local_c;
  *param_4 = local_18;
  return 0;
}



int BaseCheckElevation(undefined4 param_1,uint param_2,wchar_t *param_3,uint *param_4,uint param_5,
                      byte param_6,int param_7,undefined4 param_8,byte param_9,uint param_10,
                      uint *param_11,undefined4 *param_12)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  uint local_1c [2];
  undefined4 local_14;
  int local_10;
  uint local_c;
  uint local_8;
  
                    // 0x13090  49  BaseCheckElevation
  local_c = 0;
  local_8 = 0;
  uVar1 = 1;
  uVar4 = 1;
  local_14 = 6;
  iVar5 = 0;
  local_10 = 0;
  iVar2 = RtlQueryElevationFlags(local_1c);
  if (-1 < iVar2) {
    iVar2 = 0;
    uVar4 = local_1c[0] >> 2 & 1;
    uVar1 = local_1c[0] & 1;
  }
  if ((iVar2 < 0) || (uVar1 == 0)) goto LAB_6b81313a;
  uVar1 = *param_4;
  *param_4 = uVar1 | 2;
  if ((param_6 & 2) != 0) {
    *param_4 = uVar1 | 10;
  }
  iVar2 = FUN_6b813171(param_2,param_3,param_4,param_5,param_7,param_8,param_9,uVar4,&local_c,
                       &local_14);
  if (iVar2 < 0) goto LAB_6b81313a;
  uVar1 = *param_4;
  if ((param_6 & 1) != 0) {
    uVar1 = uVar1 & 0xfffffffd;
    *param_4 = uVar1;
  }
  if (((param_6 & 4) != 0) && (local_c == 0)) {
    local_c = 1;
  }
  if (((uVar1 & 1) == 0) || (local_c == 0)) goto LAB_6b81313a;
  if (param_10 == 0) {
    iVar2 = NtOpenProcessToken(param_1,8,&local_8);
    if (-1 < iVar2) goto LAB_6b82908c;
    if (iVar2 == -0x3fffffde) {
      iVar3 = FUN_6b8566da(&local_10);
      iVar5 = local_10;
      if ((-1 < iVar3) && (local_10 != 0)) {
        iVar2 = NtOpenProcessToken(param_1,8,&local_8);
        FUN_6b8566b0(iVar5);
        goto LAB_6b82907f;
      }
    }
    else {
LAB_6b82907f:
      if (-1 < iVar2) goto LAB_6b82908c;
    }
    local_8 = 0;
  }
  else {
    local_8 = param_10;
LAB_6b82908c:
    iVar2 = FUN_6b8567a1(local_8,param_4,&local_c);
  }
  if (iVar5 != 0) {
    NtClose(iVar5);
  }
LAB_6b81313a:
  if ((local_8 != 0) && (local_8 != param_10)) {
    NtClose(local_8);
  }
  if (param_11 != (uint *)0x0) {
    *param_11 = local_c;
  }
  if (param_12 != (undefined4 *)0x0) {
    *param_12 = local_14;
  }
  return iVar2;
}



int __fastcall
FUN_6b813171(uint param_1,wchar_t *param_2,uint *param_3,uint param_4,int param_5,undefined4 param_6
            ,byte param_7,int param_8,uint *param_9,undefined4 *param_10)

{
  int iVar1;
  uint uVar2;
  uint local_10;
  uint local_c;
  uint local_8;
  
  iVar1 = 0;
  local_c = 0;
  if (param_4 != 0) {
    uVar2 = 0;
    do {
      if (((uVar2 < 3) || (uVar2 - 0x10 < 3)) && ((param_4 & 1 << ((byte)uVar2 & 0x1f)) != 0))
      goto LAB_6b8290e8;
      uVar2 = uVar2 + 1;
    } while (uVar2 < 0x13);
  }
  local_8 = 0;
  FUN_6b813214(param_5,&local_c,&local_8);
  uVar2 = local_8;
  if (local_8 == 0) {
    if (param_8 != 0) {
      if ((param_7 & 6) == 0) {
        if ((param_7 & 1) == 0) {
          local_10 = 0;
          iVar1 = FUN_6b813259(&local_10,param_2,param_1);
          if (-1 < iVar1) {
            iVar1 = 0;
            uVar2 = local_10 & 1;
            local_8 = uVar2;
          }
          if (iVar1 < 0) {
            iVar1 = FUN_6b86147c((int)param_2,param_6,&local_8);
            uVar2 = local_8;
            if (iVar1 < 0) goto LAB_6b8131bc;
            FUN_6b8670db((uint)(local_8 != 0),param_2,param_1,(uint)(local_8 != 0));
          }
          if (uVar2 == 0) goto LAB_6b8131bc;
          *param_10 = 3;
        }
        else {
          *param_10 = 1;
        }
        local_c = 2;
        *param_3 = *param_3 | 4;
      }
      else {
        uVar2 = local_c;
        if ((param_7 & 2) != 0) {
          *param_3 = *param_3 | 4;
          uVar2 = 2;
        }
LAB_6b8290e8:
        local_c = uVar2;
        *param_10 = 0;
      }
    }
  }
  else {
    *param_10 = 2;
    *param_3 = *param_3 & 0xfffffff5;
  }
LAB_6b8131bc:
  *param_9 = local_c;
  return iVar1;
}



void __fastcall FUN_6b813214(int param_1,undefined4 *param_2,undefined4 *param_3)

{
  int iVar1;
  undefined4 uStack16;
  
  iVar1 = *(int *)(param_1 + 4);
  *param_3 = 0;
  if (iVar1 == 1) {
    *param_2 = 0;
    uStack16 = 0x10;
  }
  else if (iVar1 == 2) {
    *param_2 = 1;
    uStack16 = 0x11;
  }
  else {
    if (iVar1 != 3) {
      return;
    }
    *param_2 = 2;
    uStack16 = 0x12;
  }
  if (*(int *)(param_1 + 8) != 0) {
    *param_2 = uStack16;
  }
  *param_3 = 1;
  return;
}



void __thiscall FUN_6b813259(void *this,wchar_t *param_1,uint param_2)

{
  uint uVar1;
  int iVar2;
  undefined4 extraout_EDX;
  undefined4 uVar3;
  undefined4 *puVar4;
  undefined4 local_f4 [4];
  int local_e4;
  undefined4 local_d8;
  undefined4 local_d4;
  undefined4 *local_38;
  undefined4 local_34;
  int local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 uStack16;
  undefined4 local_c;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_28 = 0;
  local_24 = 0;
  local_20 = 0;
  local_1c = 0;
  local_18 = 0;
  local_14 = 0;
  uStack16 = 0;
  local_c = 0;
  uVar1 = FUN_6b813352(&local_28,param_1,param_2);
  if (-1 < (int)uVar1) {
    memset(local_f4,0,0xc4);
    local_e4 = local_28;
    local_d8 = local_1c;
    local_d4 = local_18;
    local_38 = &local_14;
    puVar4 = local_f4;
    uVar3 = 0;
    local_f4[0] = 0x80;
    local_34 = 0xc;
    _guard_check_icall();
    iVar2 = NtApphelpCacheControl(uVar3,puVar4);
    if (-1 < iVar2) {
      *(undefined4 *)this = local_c;
    }
  }
  FUN_6b813327(&local_28);
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,extraout_EDX);
  return;
}



void __fastcall FUN_6b813327(int *param_1)

{
  int in_FS_OFFSET;
  
  if ((param_1[1] != 0) && (*param_1 != 0)) {
    FUN_6b86734d(*param_1);
  }
  if (param_1[2] != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1[2]);
  }
  return;
}



uint __thiscall FUN_6b813352(void *this,wchar_t *param_1,uint param_2)

{
  uint uVar1;
  
  uVar1 = -(uint)(param_2 != 0xffffffff) & param_2;
  if (uVar1 == 0) {
    uVar1 = FUN_6b86739a((undefined4 *)this,(int)param_1);
    if ((int)uVar1 < 0) {
      return uVar1;
    }
                    // WARNING: Load size is inaccurate
    uVar1 = (uint)(*this != 0);
  }
  else {
    *(uint *)this = uVar1;
    uVar1 = 0;
  }
  *(uint *)((int)this + 4) = uVar1;
                    // WARNING: Load size is inaccurate
  if (*this == 0) {
    uVar1 = 0xc0000225;
  }
  else {
    uVar1 = FUN_6b81435f((wchar_t **)((int)this + 8),param_1);
    if ((-1 < (int)uVar1) &&
       (uVar1 = RtlInitUnicodeStringEx((int)this + 0xc,*(undefined4 *)((int)this + 8)),
       -1 < (int)uVar1)) {
      uVar1 = 0;
    }
  }
  return uVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void BasepQueryAppCompat(int param_1,int param_2,short param_3,undefined4 param_4,undefined4 param_5
                        ,wchar_t *param_6,undefined4 param_7,int param_8,int *param_9,
                        undefined4 *param_10,void **param_11,size_t *param_12,undefined4 *param_13,
                        undefined4 *param_14,undefined4 *param_15,ushort *param_16,
                        undefined4 *param_17,undefined4 *param_18)

{
  short *psVar1;
  int iVar2;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 uVar3;
  undefined4 extraout_ECX_02;
  undefined4 extraout_ECX_03;
  uint uVar4;
  uint uVar5;
  int in_FS_OFFSET;
  int local_c [2];
  
                    // 0x133c0  100  BasepQueryAppCompat
  uVar5 = 1;
  local_c[0] = 0;
  FUN_6b814a7f();
  uVar4 = uVar5;
  if (param_1 != 0) {
    if ((*(ushort *)(param_1 + 0x16) == _DAT_7ffe026c) &&
       (uVar4 = 1, *(ushort *)(param_1 + 0x14) == _DAT_7ffe0270)) {
      uVar4 = 3;
    }
    if ((*(ushort *)(param_1 + 0x18) == _DAT_7ffe026c) &&
       (*(ushort *)(param_1 + 0x1a) == _DAT_7ffe0270)) {
      uVar4 = uVar4 | 2;
    }
  }
  if ((param_11 != (void **)0x0) && (*param_11 != (void *)0x0)) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,*param_11);
    *param_11 = (void *)0x0;
  }
  if ((param_9 != (int *)0x0) && (*param_9 != 0)) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,*param_9);
    *param_9 = 0;
  }
  FUN_6b814a45(param_1,param_2,param_3,(short *)param_16);
  if ((((param_8 == 0) || (psVar1 = *(short **)(param_8 + 4), psVar1 == (short *)0x0)) ||
      (*psVar1 == 0)) ||
     ((iVar2 = CheckIsMSIXPackage(psVar1,local_c), -1 < iVar2 && (local_c[0] != 0)))) {
    uVar4 = FUN_6b813aad(param_9,param_10,param_11,param_12,param_13,param_14,param_15,param_6,
                         param_4,param_5,param_7,*param_16,uVar4);
    uVar3 = extraout_ECX_01;
LAB_6b813505:
    if (-1 < (int)uVar4) goto LAB_6b813527;
    if (uVar4 == 0xc0000022) {
      RtlSetLastWin32Error(0x4c7);
      uVar3 = extraout_ECX_02;
    }
    else {
      BaseSetLastNTError(uVar4);
      uVar3 = extraout_ECX_03;
    }
  }
  else {
    iVar2 = FUN_6b8412c3(param_17,param_18,0,*(undefined4 *)(param_8 + 4));
    uVar3 = extraout_ECX;
    if (iVar2 == 0) {
      uVar4 = FUN_6b866bc5(param_9,param_10,*(undefined4 *)(param_8 + 4),*param_17,param_17[1],
                           *param_16,uVar4);
      uVar3 = extraout_ECX_00;
      goto LAB_6b813505;
    }
  }
  uVar5 = 0;
LAB_6b813527:
  FUN_6b813545(uVar3,(-(uint)(uVar5 != 0) & 0x3fffffff) + 0xc0000001);
  return;
}



void __fastcall FUN_6b813545(undefined4 param_1,undefined4 param_2)

{
  uint extraout_EDX;
  uint uVar1;
  undefined4 local_1c;
  undefined4 *local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  uVar1 = DAT_6b8b08b4;
  local_1c = param_2;
  if ((DAT_6b8b08b0 | DAT_6b8b08b4) != 0) {
    local_14 = 0;
    local_18 = &local_1c;
    local_c = 0;
    local_10 = 4;
    EtwEventWrite(DAT_6b8b08b0,DAT_6b8b08b4,&DAT_6b8843b0,1,&local_18);
    uVar1 = extraout_EDX;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar1);
  return;
}



uint FUN_6b8135a0(undefined4 param_1,undefined4 param_2,undefined4 *param_3,undefined4 *param_4,
                 undefined4 *param_5,undefined4 param_6,wchar_t *param_7,undefined4 param_8,
                 undefined4 param_9,undefined4 param_10,undefined2 param_11)

{
  size_t sVar1;
  wchar_t *pwVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  LPVOID pvVar6;
  void *_Dst;
  int iVar7;
  void *_Src;
  undefined4 *puVar8;
  HANDLE *ppvVar9;
  uint uVar10;
  undefined4 *puVar11;
  int in_FS_OFFSET;
  undefined4 uVar12;
  undefined4 local_15c;
  uint local_158;
  undefined4 local_14c;
  undefined4 local_148;
  undefined2 local_144;
  undefined local_140 [8];
  int local_138;
  undefined4 local_134;
  LPVOID local_a0;
  uint local_9c;
  size_t local_90;
  undefined4 local_8c [2];
  undefined4 local_84 [3];
  uint local_78;
  uint local_74;
  uint local_70;
  undefined4 local_6c;
  undefined4 local_68;
  undefined4 *local_64;
  int local_60;
  uint local_5c;
  uint local_58;
  uint local_54;
  uint local_50;
  uint local_4c;
  uint local_48;
  wchar_t *local_44;
  uint local_40;
  uint local_3c;
  uint local_38;
  uint local_34;
  uint local_30;
  uint local_2c;
  uint local_28;
  uint local_24;
  void *local_20;
  HANDLE local_1c;
  uint local_18;
  uint local_14;
  uint local_c;
  LPVOID local_8;
  
  ppvVar9 = &local_1c;
  for (iVar7 = 6; iVar7 != 0; iVar7 = iVar7 + -1) {
    *ppvVar9 = (HANDLE)0x0;
    ppvVar9 = ppvVar9 + 1;
  }
  local_1c = GetProcessHeap();
  if (param_7 == (wchar_t *)0x0) {
    uVar4 = 0xc000000d;
    goto LAB_6b813a08;
  }
  memset(&local_15c,0,0xc4);
  local_44 = (wchar_t *)0x0;
  local_64 = (undefined4 *)0x0;
  local_20 = (void *)0x0;
  local_60 = 0;
  local_24 = 0;
  local_28 = 0;
  local_148 = 0;
  local_14c = param_8;
  local_15c = 0x1f;
  uVar4 = RtlCreateEnvironmentEx(0,&local_138,0);
  if (-1 < (int)uVar4) {
    local_134 = RtlSizeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_138);
    local_144 = param_11;
    local_158 = FUN_6b814a34(0);
    iVar7 = FUN_6b814701(&local_28,param_7);
    if ((-1 < iVar7) && (local_28 != 0)) {
      local_158 = local_158 | 2;
    }
    iVar7 = FUN_6b8148cf(&local_24,param_7);
    if ((-1 < iVar7) && (local_24 != 0)) {
      local_158 = local_158 | 4;
    }
    uVar4 = FUN_6b81435f(&local_44,param_7);
    pwVar2 = local_44;
    if ((-1 < (int)uVar4) && (uVar4 = RtlInitUnicodeStringEx(local_140,local_44), -1 < (int)uVar4))
    {
      iVar7 = FUN_6b814219(&local_60,pwVar2);
      if ((-1 < iVar7) && (local_60 != 0)) {
        local_158 = local_158 | 8;
      }
      local_24 = local_14;
      uVar5 = 0x1000;
      uVar10 = local_18;
      do {
        local_28 = uVar5;
        uVar4 = local_24;
        pvVar6 = local_8;
        if (local_24 < uVar5) {
          uVar4 = FUN_6b8141f4(uVar5,0xfff,&local_40);
          if ((int)uVar4 < 0) {
            uVar4 = 0x8000000b;
          }
          else {
            uVar4 = local_40 & 0xfffff000;
            local_40 = uVar4;
            if (local_8 == (LPVOID)0x0) {
              pvVar6 = HeapAlloc(local_1c,0,uVar4);
              if (pvVar6 != (LPVOID)0x0) {
                memset(pvVar6,0,uVar4);
                goto LAB_6b82922c;
              }
            }
            else {
              pvVar6 = HeapReAlloc(local_1c,0,local_8,uVar4);
LAB_6b82922c:
              if (pvVar6 != (LPVOID)0x0) goto LAB_6b829240;
            }
            uVar4 = 0x8007000e;
          }
        }
        else {
LAB_6b829240:
          local_8 = pvVar6;
          local_24 = uVar4;
          uVar4 = 0;
          uVar10 = local_28;
          local_18 = local_28;
        }
        uVar3 = local_24;
        if ((int)uVar4 < 0) goto LAB_6b8139db;
        local_a0 = local_8;
        puVar8 = &local_15c;
        uVar12 = 0;
        local_9c = local_28;
        _guard_check_icall();
        uVar4 = NtApphelpCacheControl(uVar12,puVar8);
        uVar5 = local_9c;
      } while (uVar4 == 0xc0000023);
      if (-1 < (int)uVar4) {
        local_40 = local_9c;
        pvVar6 = local_8;
        if (uVar3 < local_9c) {
          uVar4 = FUN_6b8141f4(local_9c,0xfff,&local_48);
          if ((int)uVar4 < 0) {
            uVar4 = 0x8000000b;
          }
          else {
            uVar4 = local_48 & 0xfffff000;
            if (local_8 == (LPVOID)0x0) {
              pvVar6 = HeapAlloc(local_1c,0,uVar4);
              if (pvVar6 != (LPVOID)0x0) {
                memset(pvVar6,0,uVar4);
                goto LAB_6b8292b7;
              }
            }
            else {
              pvVar6 = HeapReAlloc(local_1c,0,local_8,uVar4);
LAB_6b8292b7:
              if (pvVar6 != (LPVOID)0x0) goto LAB_6b8137ff;
            }
            uVar4 = 0x8007000e;
          }
        }
        else {
LAB_6b8137ff:
          local_8 = pvVar6;
          uVar4 = 0;
          uVar10 = local_40;
          local_18 = local_40;
        }
        if (-1 < (int)uVar4) {
          if (param_3 == (undefined4 *)0x0) {
LAB_6b813765:
            if (param_4 != (undefined4 *)0x0) {
              local_6c = 0;
              local_68 = 0;
              uVar4 = 0;
              do {
                if (((uVar10 < uVar4) ||
                    (local_c = uVar4, uVar5 = FUN_6b8141f4(uVar4,8,&local_74), (int)uVar5 < 0)) ||
                   (uVar10 < local_74)) goto LAB_6b8138b4;
                local_4c = *(uint *)(uVar4 + (int)local_8);
                uVar5 = *(uint *)(uVar4 + 4 + (int)local_8);
                uVar4 = FUN_6b8141f4(uVar4,8,&local_c);
                uVar10 = local_18;
                if ((((int)uVar4 < 0) ||
                    (uVar4 = FUN_6b8141f4(local_c,uVar5,&local_30), uVar10 = local_18,
                    (int)uVar4 < 0)) ||
                   ((uVar4 = FUN_6b8141f4(local_30,3,&local_30), uVar3 = local_c, uVar10 = local_18,
                    (int)uVar4 < 0 ||
                    (uVar4 = local_30 & 0xfffffffc, local_30 = uVar4, local_18 < uVar4))))
                goto LAB_6b8138b4;
              } while (local_4c != 4);
              if (8 < uVar5) goto LAB_6b8292fb;
              if (7 < uVar5) {
                uVar5 = 8;
              }
              if (uVar5 == 0) {
LAB_6b8138aa:
                uVar4 = 0;
                uVar10 = local_18;
              }
              else if (((local_18 < local_c) ||
                       (uVar4 = FUN_6b8141f4(local_c,uVar5,&local_50), (int)uVar4 < 0)) ||
                      (uVar10 < local_50)) {
                uVar4 = 0x80070057;
              }
              else {
                memcpy(&local_6c,(void *)((int)local_8 + uVar3),uVar5);
                uVar4 = FUN_6b8141f4(uVar3,uVar5,&local_c);
                if (-1 < (int)uVar4) goto LAB_6b8138aa;
                uVar4 = 0x8000000b;
                uVar10 = local_18;
              }
              if ((int)uVar4 < 0) goto LAB_6b8139db;
LAB_6b8138b4:
              *param_4 = local_6c;
              param_4[1] = local_68;
            }
            if (param_5 != (undefined4 *)0x0) {
              local_8c[0] = 0;
              uVar4 = 0;
              do {
                if (((uVar10 < uVar4) ||
                    (local_c = uVar4, uVar5 = FUN_6b8141f4(uVar4,8,&local_54), (int)uVar5 < 0)) ||
                   (uVar10 < local_54)) goto LAB_6b81395b;
                local_50 = *(uint *)(uVar4 + (int)local_8);
                uVar5 = *(uint *)(uVar4 + 4 + (int)local_8);
                uVar4 = FUN_6b8141f4(uVar4,8,&local_c);
                uVar10 = local_18;
                if ((((int)uVar4 < 0) ||
                    (uVar4 = FUN_6b8141f4(local_c,uVar5,&local_34), uVar10 = local_18,
                    (int)uVar4 < 0)) ||
                   ((uVar4 = FUN_6b8141f4(local_34,3,&local_34), uVar3 = local_c, uVar10 = local_18,
                    (int)uVar4 < 0 ||
                    (uVar4 = local_34 & 0xfffffffc, local_34 = uVar4, local_18 < uVar4))))
                goto LAB_6b81395b;
              } while (local_50 != 0x10);
              if (8 < uVar5) goto LAB_6b8292fb;
              if (7 < uVar5) {
                uVar5 = 8;
              }
              if (uVar5 == 0) {
LAB_6b813951:
                uVar4 = 0;
                uVar10 = local_18;
              }
              else if (((local_18 < local_c) ||
                       (uVar4 = FUN_6b8141f4(local_c,uVar5,&local_58), (int)uVar4 < 0)) ||
                      (uVar10 < local_58)) {
                uVar4 = 0x80070057;
              }
              else {
                memcpy(local_8c,(void *)((int)local_8 + uVar3),uVar5);
                uVar4 = FUN_6b8141f4(uVar3,uVar5,&local_c);
                if (-1 < (int)uVar4) goto LAB_6b813951;
                uVar4 = 0x8000000b;
                uVar10 = local_18;
              }
              if ((int)uVar4 < 0) goto LAB_6b8139db;
LAB_6b81395b:
              *param_5 = local_8c[0];
            }
            uVar4 = 0;
            do {
              if (((uVar10 < uVar4) ||
                  (local_c = uVar4, uVar5 = FUN_6b8141f4(uVar4,8,&local_5c), (int)uVar5 < 0)) ||
                 (uVar10 < local_5c)) goto LAB_6b813aa6;
              local_58 = *(uint *)(uVar4 + (int)local_8);
              uVar5 = *(uint *)(uVar4 + 4 + (int)local_8);
              local_54 = uVar5;
              uVar4 = FUN_6b8141f4(uVar4,8,&local_c);
              uVar3 = local_c;
              uVar10 = local_18;
              if ((((int)uVar4 < 0) ||
                  (uVar4 = FUN_6b8141f4(local_c,uVar5,&local_38), uVar10 = local_18, (int)uVar4 < 0)
                  ) || ((uVar4 = FUN_6b8141f4(local_38,3,&local_38), uVar10 = local_18,
                        (int)uVar4 < 0 ||
                        (uVar4 = local_38 & 0xfffffffc, local_38 = uVar4, local_18 < uVar4))))
              goto LAB_6b813aa6;
            } while (local_58 != 1);
            puVar8 = (undefined4 *)((int)local_8 + uVar3);
            if (local_54 == 0x1c8) {
              local_64 = (undefined4 *)
                         RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                         0x1c8);
              if (local_64 == (undefined4 *)0x0) {
                uVar4 = 0xc0000017;
                goto LAB_6b8139db;
              }
              puVar11 = local_64;
              for (iVar7 = 0x72; uVar10 = local_18, iVar7 != 0; iVar7 = iVar7 + -1) {
                *puVar11 = *puVar8;
                puVar8 = puVar8 + 1;
                puVar11 = puVar11 + 1;
              }
            }
LAB_6b813aa6:
            uVar4 = 0;
            do {
              _Dst = local_20;
              local_c = uVar4;
              if (((uVar10 < uVar4) ||
                  (uVar5 = FUN_6b8141f4(uVar4,8,&local_78), _Dst = local_20, (int)uVar5 < 0)) ||
                 (uVar10 < local_78)) goto LAB_6b8139b9;
              local_5c = *(uint *)(uVar4 + (int)local_8);
              sVar1 = *(size_t *)(uVar4 + 4 + (int)local_8);
              local_90 = sVar1;
              uVar4 = FUN_6b8141f4(uVar4,8,&local_c);
              _Dst = local_20;
              if (((((int)uVar4 < 0) ||
                   (uVar4 = FUN_6b8141f4(local_c,sVar1,&local_3c), _Dst = local_20, (int)uVar4 < 0))
                  || (uVar4 = FUN_6b8141f4(local_3c,3,&local_3c), _Dst = local_20, (int)uVar4 < 0))
                 || (uVar4 = local_3c & 0xfffffffc, local_3c = uVar4, local_18 < uVar4))
              goto LAB_6b8139b9;
              uVar10 = local_18;
            } while (local_5c != 2);
            _Src = (void *)(local_c + (int)local_8);
            if (sVar1 == 0) {
LAB_6b8139b9:
              uVar4 = 0;
            }
            else {
              _Dst = (void *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8
                                             ,sVar1);
              if (_Dst != (void *)0x0) {
                memcpy(_Dst,_Src,local_90);
                goto LAB_6b8139b9;
              }
              uVar4 = 0xc0000017;
            }
            if (local_64 != (undefined4 *)0x0) {
              RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_64);
            }
            if (_Dst != (void *)0x0) {
              RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,_Dst);
            }
          }
          else {
            local_84[0] = 0;
            uVar4 = 0;
            do {
              if (((uVar10 < uVar4) ||
                  (local_c = uVar4, uVar5 = FUN_6b8141f4(uVar4,8,&local_70), (int)uVar5 < 0)) ||
                 (uVar10 < local_70)) goto LAB_6b81375d;
              local_48 = *(uint *)(uVar4 + (int)local_8);
              uVar5 = *(uint *)(uVar4 + 4 + (int)local_8);
              uVar4 = FUN_6b8141f4(uVar4,8,&local_c);
              uVar10 = local_18;
              if ((((int)uVar4 < 0) ||
                  (uVar4 = FUN_6b8141f4(local_c,uVar5,&local_2c), uVar10 = local_18, (int)uVar4 < 0)
                  ) || ((uVar4 = FUN_6b8141f4(local_2c,3,&local_2c), uVar3 = local_c,
                        uVar10 = local_18, (int)uVar4 < 0 ||
                        (uVar4 = local_2c & 0xfffffffc, local_2c = uVar4, local_18 < uVar4))))
              goto LAB_6b81375d;
            } while (local_48 != 8);
            if (uVar5 < 9) {
              if (7 < uVar5) {
                uVar5 = 8;
              }
              if (uVar5 == 0) {
LAB_6b813753:
                uVar4 = 0;
                uVar10 = local_18;
              }
              else if (((local_18 < local_c) ||
                       (uVar4 = FUN_6b8141f4(local_c,uVar5,&local_4c), (int)uVar4 < 0)) ||
                      (uVar10 < local_4c)) {
                uVar4 = 0x80070057;
              }
              else {
                memcpy(local_84,(void *)((int)local_8 + uVar3),uVar5);
                uVar4 = FUN_6b8141f4(uVar3,uVar5,&local_c);
                if (-1 < (int)uVar4) goto LAB_6b813753;
                uVar4 = 0x8000000b;
                uVar10 = local_18;
              }
              if ((int)uVar4 < 0) goto LAB_6b8139db;
LAB_6b81375d:
              *param_3 = local_84[0];
              goto LAB_6b813765;
            }
LAB_6b8292fb:
            uVar4 = 0xc0000095;
          }
        }
      }
    }
LAB_6b8139db:
    if (local_44 != (wchar_t *)0x0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_44);
    }
  }
  if (local_138 != 0) {
    RtlDestroyEnvironment(local_138);
  }
LAB_6b813a08:
  if (local_8 != (LPVOID)0x0) {
    HeapFree(local_1c,0,local_8);
  }
  return uVar4;
}



uint __fastcall
FUN_6b813aad(undefined4 *param_1,undefined4 *param_2,void **param_3,size_t *param_4,
            undefined4 *param_5,undefined4 *param_6,undefined4 *param_7,wchar_t *param_8,
            undefined4 param_9,undefined4 param_10,undefined4 param_11,undefined2 param_12,
            uint param_13)

{
  size_t sVar1;
  wchar_t *pwVar2;
  uint uVar3;
  uint uVar4;
  LPVOID pvVar5;
  uint uVar6;
  void *_Dst;
  int iVar7;
  undefined4 *puVar8;
  HANDLE *ppvVar9;
  uint uVar10;
  void *pvVar11;
  undefined4 *puVar12;
  int in_FS_OFFSET;
  undefined4 uVar13;
  undefined4 local_168;
  uint local_164;
  undefined4 local_158;
  undefined4 local_154;
  undefined2 local_150;
  undefined local_14c [8];
  int local_144;
  undefined4 local_140;
  LPVOID local_ac;
  uint local_a8;
  size_t local_9c;
  undefined4 local_98 [2];
  undefined4 local_90 [3];
  uint local_84;
  undefined4 *local_80;
  uint local_7c;
  uint local_78;
  uint local_74;
  undefined4 local_70;
  undefined4 local_6c;
  int local_68;
  undefined4 *local_64;
  uint local_60;
  uint local_5c;
  uint local_58;
  uint local_54;
  uint local_50;
  wchar_t *local_4c;
  undefined4 *local_48;
  void *local_44;
  uint local_40;
  uint local_3c;
  uint local_38;
  uint local_34;
  uint local_30;
  uint local_2c;
  uint local_28;
  uint local_24;
  HANDLE local_20;
  uint local_1c;
  uint local_18;
  uint local_10;
  LPVOID local_c;
  
  ppvVar9 = &local_20;
  for (iVar7 = 6; iVar7 != 0; iVar7 = iVar7 + -1) {
    *ppvVar9 = (HANDLE)0x0;
    ppvVar9 = ppvVar9 + 1;
  }
  local_80 = param_1;
  local_64 = param_2;
  local_20 = GetProcessHeap();
  if (param_8 == (wchar_t *)0x0) {
    uVar4 = 0xc000000d;
    goto LAB_6b8140c6;
  }
  memset(&local_168,0,0xc4);
  local_4c = (wchar_t *)0x0;
  local_68 = 0;
  local_24 = 0;
  local_28 = 0;
  local_48 = (undefined4 *)0x0;
  local_44 = (void *)0x0;
  local_158 = param_9;
  local_154 = param_10;
  local_168 = 0x1f;
  uVar4 = RtlCreateEnvironmentEx(param_11,&local_144,0);
  if (-1 < (int)uVar4) {
    local_140 = RtlSizeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_144);
    local_150 = param_12;
    local_164 = FUN_6b814a34(param_13);
    iVar7 = FUN_6b814701(&local_28,param_8);
    if ((-1 < iVar7) && (local_28 != 0)) {
      local_164 = local_164 | 2;
    }
    iVar7 = FUN_6b8148cf(&local_24,param_8);
    if ((-1 < iVar7) && (local_24 != 0)) {
      local_164 = local_164 | 4;
    }
    uVar4 = FUN_6b81435f(&local_4c,param_8);
    pwVar2 = local_4c;
    if ((-1 < (int)uVar4) && (uVar4 = RtlInitUnicodeStringEx(local_14c,local_4c), -1 < (int)uVar4))
    {
      iVar7 = FUN_6b814219(&local_68,pwVar2);
      if ((-1 < iVar7) && (local_68 != 0)) {
        local_164 = local_164 | 8;
      }
      local_24 = local_18;
      uVar6 = 0x1000;
      uVar10 = local_1c;
      do {
        local_28 = uVar6;
        uVar4 = local_24;
        pvVar5 = local_c;
        if (local_24 < uVar6) {
          uVar4 = FUN_6b8141f4(uVar6,0xfff,&local_40);
          if ((int)uVar4 < 0) {
            uVar4 = 0x8000000b;
          }
          else {
            uVar4 = local_40 & 0xfffff000;
            local_40 = uVar4;
            if (local_c == (LPVOID)0x0) {
              pvVar5 = HeapAlloc(local_20,0,uVar4);
              if (pvVar5 != (LPVOID)0x0) {
                memset(pvVar5,0,uVar4);
                goto LAB_6b813c43;
              }
            }
            else {
              pvVar5 = HeapReAlloc(local_20,0,local_c,uVar4);
LAB_6b813c43:
              if (pvVar5 != (LPVOID)0x0) goto LAB_6b813c56;
            }
            uVar4 = 0x8007000e;
          }
        }
        else {
LAB_6b813c56:
          local_c = pvVar5;
          local_24 = uVar4;
          uVar4 = 0;
          uVar10 = local_28;
          local_1c = local_28;
        }
        uVar3 = local_24;
        if ((int)uVar4 < 0) goto LAB_6b814099;
        local_ac = local_c;
        puVar8 = &local_168;
        uVar13 = 0xb;
        local_a8 = local_28;
        _guard_check_icall();
        uVar4 = NtApphelpCacheControl(uVar13,puVar8);
        uVar6 = local_a8;
      } while (uVar4 == 0xc0000023);
      if (-1 < (int)uVar4) {
        local_40 = local_a8;
        pvVar5 = local_c;
        if (uVar3 < local_a8) {
          uVar4 = FUN_6b8141f4(local_a8,0xfff,&local_50);
          if ((int)uVar4 < 0) {
            uVar4 = 0x8000000b;
          }
          else {
            uVar4 = local_50 & 0xfffff000;
            if (local_c == (LPVOID)0x0) {
              pvVar5 = HeapAlloc(local_20,0,uVar4);
              if (pvVar5 != (LPVOID)0x0) {
                memset(pvVar5,0,uVar4);
                goto LAB_6b829615;
              }
            }
            else {
              pvVar5 = HeapReAlloc(local_20,0,local_c,uVar4);
LAB_6b829615:
              if (pvVar5 != (LPVOID)0x0) goto LAB_6b813cb4;
            }
            uVar4 = 0x8007000e;
          }
        }
        else {
LAB_6b813cb4:
          local_c = pvVar5;
          uVar4 = 0;
          uVar10 = local_40;
          local_1c = local_40;
        }
        if (-1 < (int)uVar4) {
          if (param_5 == (undefined4 *)0x0) {
LAB_6b813d95:
            if (param_6 != (undefined4 *)0x0) {
              local_70 = 0;
              local_6c = 0;
              uVar4 = 0;
              do {
                if (((uVar10 < uVar4) ||
                    (local_10 = uVar4, uVar6 = FUN_6b8141f4(uVar4,8,&local_78), (int)uVar6 < 0)) ||
                   (uVar10 < local_78)) goto LAB_6b813e5d;
                local_54 = *(uint *)(uVar4 + (int)local_c);
                uVar6 = *(uint *)(uVar4 + 4 + (int)local_c);
                uVar4 = FUN_6b8141f4(uVar4,8,&local_10);
                uVar10 = local_1c;
                if ((((int)uVar4 < 0) ||
                    (uVar4 = FUN_6b8141f4(local_10,uVar6,&local_30), uVar10 = local_1c,
                    (int)uVar4 < 0)) ||
                   ((uVar4 = FUN_6b8141f4(local_30,3,&local_30), uVar3 = local_10, uVar10 = local_1c
                    , (int)uVar4 < 0 ||
                    (uVar4 = local_30 & 0xfffffffc, local_30 = uVar4, local_1c < uVar4))))
                goto LAB_6b813e5d;
              } while (local_54 != 4);
              if (8 < uVar6) goto LAB_6b82962e;
              if (7 < uVar6) {
                uVar6 = 8;
              }
              if (uVar6 == 0) {
LAB_6b813e53:
                uVar4 = 0;
                uVar10 = local_1c;
              }
              else if (((local_1c < local_10) ||
                       (uVar4 = FUN_6b8141f4(local_10,uVar6,&local_58), (int)uVar4 < 0)) ||
                      (uVar10 < local_58)) {
                uVar4 = 0x80070057;
              }
              else {
                memcpy(&local_70,(void *)((int)local_c + uVar3),uVar6);
                uVar4 = FUN_6b8141f4(uVar3,uVar6,&local_10);
                if (-1 < (int)uVar4) goto LAB_6b813e53;
                uVar4 = 0x8000000b;
                uVar10 = local_1c;
              }
              if ((int)uVar4 < 0) goto LAB_6b814099;
LAB_6b813e5d:
              *param_6 = local_70;
              param_6[1] = local_6c;
            }
            if (param_7 != (undefined4 *)0x0) {
              local_98[0] = 0;
              uVar4 = 0;
              do {
                if (((uVar10 < uVar4) ||
                    (local_10 = uVar4, uVar6 = FUN_6b8141f4(uVar4,8,&local_5c), (int)uVar6 < 0)) ||
                   (uVar10 < local_5c)) goto LAB_6b813f32;
                local_58 = *(uint *)(uVar4 + (int)local_c);
                uVar6 = *(uint *)(uVar4 + 4 + (int)local_c);
                uVar4 = FUN_6b8141f4(uVar4,8,&local_10);
                uVar10 = local_1c;
                if ((((int)uVar4 < 0) ||
                    (uVar4 = FUN_6b8141f4(local_10,uVar6,&local_34), uVar10 = local_1c,
                    (int)uVar4 < 0)) ||
                   ((uVar4 = FUN_6b8141f4(local_34,3,&local_34), uVar3 = local_10, uVar10 = local_1c
                    , (int)uVar4 < 0 ||
                    (uVar4 = local_34 & 0xfffffffc, local_34 = uVar4, local_1c < uVar4))))
                goto LAB_6b813f32;
              } while (local_58 != 0x10);
              if (8 < uVar6) goto LAB_6b82962e;
              if (7 < uVar6) {
                uVar6 = 8;
              }
              if (uVar6 == 0) {
LAB_6b813f28:
                uVar4 = 0;
                uVar10 = local_1c;
              }
              else if (((local_1c < local_10) ||
                       (uVar4 = FUN_6b8141f4(local_10,uVar6,&local_60), (int)uVar4 < 0)) ||
                      (uVar10 < local_60)) {
                uVar4 = 0x80070057;
              }
              else {
                memcpy(local_98,(void *)((int)local_c + uVar3),uVar6);
                uVar4 = FUN_6b8141f4(uVar3,uVar6,&local_10);
                if (-1 < (int)uVar4) goto LAB_6b813f28;
                uVar4 = 0x8000000b;
                uVar10 = local_1c;
              }
              if ((int)uVar4 < 0) goto LAB_6b814099;
LAB_6b813f32:
              *param_7 = local_98[0];
            }
            uVar4 = 0;
            do {
              if (((uVar10 < uVar4) ||
                  (local_10 = uVar4, uVar6 = FUN_6b8141f4(uVar4,8,&local_7c), (int)uVar6 < 0)) ||
                 (uVar10 < local_7c)) goto LAB_6b813feb;
              local_60 = *(uint *)(uVar4 + (int)local_c);
              uVar6 = *(uint *)(uVar4 + 4 + (int)local_c);
              local_5c = uVar6;
              uVar4 = FUN_6b8141f4(uVar4,8,&local_10);
              uVar3 = local_10;
              uVar10 = local_1c;
              if ((((int)uVar4 < 0) ||
                  (uVar4 = FUN_6b8141f4(local_10,uVar6,&local_38), uVar10 = local_1c, (int)uVar4 < 0
                  )) || ((uVar4 = FUN_6b8141f4(local_38,3,&local_38), uVar10 = local_1c,
                         (int)uVar4 < 0 ||
                         (uVar4 = local_38 & 0xfffffffc, local_38 = uVar4, local_1c < uVar4))))
              goto LAB_6b813feb;
            } while (local_60 != 1);
            puVar8 = (undefined4 *)((int)local_c + uVar3);
            if (local_5c == 0x1c8) {
              local_48 = (undefined4 *)
                         RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                         0x1c8);
              if (local_48 == (undefined4 *)0x0) {
                uVar4 = 0xc0000017;
                goto LAB_6b814099;
              }
              puVar12 = local_48;
              for (iVar7 = 0x72; iVar7 != 0; iVar7 = iVar7 + -1) {
                *puVar12 = *puVar8;
                puVar8 = puVar8 + 1;
                puVar12 = puVar12 + 1;
              }
              if (local_80 != (undefined4 *)0x0) {
                *local_80 = local_48;
                local_48 = (undefined4 *)0x0;
              }
              uVar10 = local_1c;
              if (local_64 != (undefined4 *)0x0) {
                *local_64 = 0x1c8;
              }
            }
LAB_6b813feb:
            uVar4 = 0;
            do {
              local_10 = uVar4;
              if (((uVar10 < uVar4) || (uVar6 = FUN_6b8141f4(uVar4,8,&local_84), (int)uVar6 < 0)) ||
                 (uVar10 < local_84)) goto LAB_6b814081;
              local_64 = *(undefined4 **)(uVar4 + (int)local_c);
              sVar1 = *(size_t *)(uVar4 + 4 + (int)local_c);
              local_9c = sVar1;
              uVar4 = FUN_6b8141f4(uVar4,8,&local_10);
              if (((((int)uVar4 < 0) ||
                   (uVar4 = FUN_6b8141f4(local_10,sVar1,&local_3c), (int)uVar4 < 0)) ||
                  (uVar4 = FUN_6b8141f4(local_3c,3,&local_3c), (int)uVar4 < 0)) ||
                 (uVar4 = local_3c & 0xfffffffc, local_3c = uVar4, local_1c < uVar4))
              goto LAB_6b814081;
              uVar10 = local_1c;
            } while (local_64 != (undefined4 *)0x2);
            pvVar11 = (void *)(local_10 + (int)local_c);
            if (sVar1 == 0) {
LAB_6b814081:
              uVar4 = 0;
            }
            else {
              _Dst = (void *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8
                                             ,sVar1);
              sVar1 = local_9c;
              local_44 = _Dst;
              if (_Dst != (void *)0x0) {
                memcpy(_Dst,pvVar11,local_9c);
                if (param_3 != (void **)0x0) {
                  *param_3 = _Dst;
                  local_44 = (void *)0x0;
                }
                if (param_4 != (size_t *)0x0) {
                  *param_4 = sVar1;
                }
                goto LAB_6b814081;
              }
              uVar4 = 0xc0000017;
            }
            pvVar11 = local_44;
            if (local_48 != (undefined4 *)0x0) {
              RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_48);
            }
            if (pvVar11 != (void *)0x0) {
              RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pvVar11);
            }
          }
          else {
            local_90[0] = 0;
            uVar4 = 0;
            do {
              if (((uVar10 < uVar4) ||
                  (local_10 = uVar4, uVar6 = FUN_6b8141f4(uVar4,8,&local_74), (int)uVar6 < 0)) ||
                 (uVar10 < local_74)) goto LAB_6b813d8a;
              local_50 = *(uint *)(uVar4 + (int)local_c);
              uVar6 = *(uint *)(uVar4 + 4 + (int)local_c);
              uVar4 = FUN_6b8141f4(uVar4,8,&local_10);
              uVar10 = local_1c;
              if ((((int)uVar4 < 0) ||
                  (uVar4 = FUN_6b8141f4(local_10,uVar6,&local_2c), uVar10 = local_1c, (int)uVar4 < 0
                  )) || ((uVar4 = FUN_6b8141f4(local_2c,3,&local_2c), uVar3 = local_10,
                         uVar10 = local_1c, (int)uVar4 < 0 ||
                         (uVar4 = local_2c & 0xfffffffc, local_2c = uVar4, local_1c < uVar4))))
              goto LAB_6b813d8a;
            } while (local_50 != 8);
            if (uVar6 < 9) {
              if (7 < uVar6) {
                uVar6 = 8;
              }
              if (uVar6 == 0) {
LAB_6b813d80:
                uVar4 = 0;
                uVar10 = local_1c;
              }
              else if (((local_1c < local_10) ||
                       (uVar4 = FUN_6b8141f4(local_10,uVar6,&local_54), (int)uVar4 < 0)) ||
                      (uVar10 < local_54)) {
                uVar4 = 0x80070057;
              }
              else {
                memcpy(local_90,(void *)((int)local_c + uVar3),uVar6);
                uVar4 = FUN_6b8141f4(uVar3,uVar6,&local_10);
                if (-1 < (int)uVar4) goto LAB_6b813d80;
                uVar4 = 0x8000000b;
                uVar10 = local_1c;
              }
              if ((int)uVar4 < 0) goto LAB_6b814099;
LAB_6b813d8a:
              *param_5 = local_90[0];
              goto LAB_6b813d95;
            }
LAB_6b82962e:
            uVar4 = 0xc0000095;
          }
        }
      }
    }
LAB_6b814099:
    if (local_4c != (wchar_t *)0x0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_4c);
    }
  }
  if (local_144 != 0) {
    RtlDestroyEnvironment(local_144);
  }
LAB_6b8140c6:
  if (local_c != (LPVOID)0x0) {
    HeapFree(local_20,0,local_c);
  }
  return uVar4;
}



uint __fastcall FUN_6b8141f4(uint param_1,int param_2,uint *param_3)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = param_1 + param_2;
  uVar2 = uVar1;
  if (uVar1 < param_1) {
    uVar2 = 0xffffffff;
  }
  *param_3 = uVar2;
  return -(uint)(uVar1 < param_1) & 0x80070216;
}



void __fastcall FUN_6b814219(uint *param_1,undefined4 param_2)

{
  int iVar1;
  int iVar2;
  undefined4 extraout_EDX;
  uint uVar3;
  int in_FS_OFFSET;
  undefined local_54 [4];
  undefined4 local_50 [2];
  uint *local_48;
  undefined4 local_44;
  undefined4 local_40;
  int local_3c;
  undefined4 *local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  int local_20;
  int local_1c;
  undefined local_18 [16];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_28 = 0;
  uVar3 = 0;
  local_24 = 0;
  iVar2 = *(int *)(*(int *)(in_FS_OFFSET + 0x18) + 0xf9c);
  local_1c = DAT_6b8b08cc;
  local_20 = 0;
  local_48 = param_1;
  local_44 = param_2;
  if ((iVar2 == 0) && (DAT_6b8b08cc != 0)) {
LAB_6b8142c4:
    iVar2 = RtlInitUnicodeStringEx(local_50,L"AppCompatFlags\\Layers");
    if (-1 < iVar2) {
      local_30 = 0;
      local_2c = 0;
      local_3c = local_1c;
      local_38 = local_50;
      local_40 = 0x18;
      local_34 = 0x40;
      iVar2 = NtOpenKey(&local_20,0x101,&local_40);
      if (iVar2 < 0) {
        uVar3 = 0;
        local_20 = 0;
      }
      else {
        iVar2 = RtlInitUnicodeStringEx(local_50,local_44);
        if (-1 < iVar2) {
          iVar2 = NtQueryValueKey(local_20,local_50,2,local_18,0x10,local_54);
          uVar3 = (uint)(iVar2 != -0x3fffffcc);
        }
      }
    }
  }
  else {
    iVar1 = FUN_6b814aef((undefined2 *)&local_28,
                         L"\\Software\\Microsoft\\Windows NT\\CurrentVersion");
    if (-1 < iVar1) {
      local_38 = &local_28;
      local_40 = 0x18;
      local_3c = 0;
      local_34 = 0x40;
      local_30 = 0;
      local_2c = 0;
      iVar1 = NtOpenKey(&local_1c,8,&local_40);
      if (iVar1 < 0) {
        uVar3 = 0;
        local_1c = 0;
        goto LAB_6b81432c;
      }
      if (iVar2 == 0) {
        LOCK();
        iVar2 = DAT_6b8b08cc;
        if (DAT_6b8b08cc == 0) {
          DAT_6b8b08cc = local_1c;
          iVar2 = 0;
        }
        if (iVar2 != 0) {
          NtClose(local_1c);
          local_1c = DAT_6b8b08cc;
        }
      }
      goto LAB_6b8142c4;
    }
  }
  if ((local_1c != 0) && (local_1c != DAT_6b8b08cc)) {
    NtClose(local_1c);
  }
LAB_6b81432c:
  if (local_20 != 0) {
    NtClose(local_20);
  }
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_24);
  *local_48 = uVar3;
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,extraout_EDX);
  return;
}



uint __fastcall FUN_6b81435f(wchar_t **param_1,wchar_t *param_2)

{
  uint uVar1;
  DWORD DVar2;
  int iVar3;
  wchar_t *pwVar4;
  wchar_t *pwVar5;
  int in_FS_OFFSET;
  undefined4 uVar6;
  char *pcVar7;
  wchar_t *local_1c;
  wchar_t *local_18;
  int local_14;
  int local_10;
  wchar_t **local_c;
  
  local_10 = 0;
  *param_1 = (wchar_t *)0x0;
  local_14 = 0;
  local_18 = (wchar_t *)0x0;
  local_1c = (wchar_t *)0x0;
  local_c = param_1;
  uVar1 = FUN_6b8145f1(&local_18,param_2);
  pwVar5 = local_18;
  if ((int)uVar1 < 0) {
    FUN_6b8671a2(1,"AslPathBuildSignatureLongpath",0x465,
                 "AslPathGetLongFileNameLongpath failed for %ws [%x]");
    pwVar5 = local_18;
    goto LAB_6b8143f6;
  }
  uVar1 = FUN_6b814701(&local_14,local_18);
  if ((int)uVar1 < 0) {
    FUN_6b8671a2(1,"AslPathBuildSignatureLongpath",0x46f,
                 "AslPathIsOnRemovableMedia failed for %ws [%x]");
    goto LAB_6b8143f6;
  }
  if (local_14 == 0) {
    DVar2 = FUN_6b814407(&local_10,pwVar5);
    iVar3 = local_10;
    if ((int)DVar2 < 0) {
      FUN_6b8671a2(2,"AslPathBuildSignatureLongpath",0x47d,
                   "AslPathIsTemporaryInternetFile failed for %ws [%x]");
      iVar3 = 0;
    }
    pwVar4 = (wchar_t *)0x0;
    if (iVar3 == 0) {
LAB_6b8143e0:
      *local_c = pwVar5;
      pwVar5 = (wchar_t *)0x0;
      local_18 = (wchar_t *)0x0;
    }
    else {
      uVar1 = FUN_6b867ae4(&local_1c,pwVar5);
      if ((int)uVar1 < 0) {
        pcVar7 = "AslPathBuildSignatureForInternetFileLongpath failed for %ws [%x]";
        uVar6 = 0x489;
        goto LAB_6b829855;
      }
LAB_6b8298a0:
      pwVar4 = local_1c;
      if (local_1c == (wchar_t *)0x0) goto LAB_6b8143e0;
      *local_c = local_1c;
      pwVar4 = (wchar_t *)0x0;
    }
    uVar1 = 0;
  }
  else {
    uVar1 = FUN_6b867897(&local_1c,pwVar5);
    if (-1 < (int)uVar1) goto LAB_6b8298a0;
    pcVar7 = "AslPathBuildSignatureForDirectoryFileLongpath for %ws [%x]";
    uVar6 = 0x476;
LAB_6b829855:
    FUN_6b8671a2(1,"AslPathBuildSignatureLongpath",uVar6,pcVar7);
    pwVar4 = local_1c;
  }
  if (pwVar4 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pwVar4);
    pwVar5 = local_18;
  }
LAB_6b8143f6:
  if (pwVar5 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pwVar5);
  }
  return uVar1;
}



// WARNING: Could not reconcile some variable overlaps

DWORD __fastcall FUN_6b814407(undefined4 *param_1,wchar_t *param_2)

{
  WCHAR WVar1;
  DWORD DVar2;
  int iVar3;
  DWORD DVar4;
  LPCWSTR pWVar5;
  size_t _MaxCount;
  undefined4 uVar6;
  LPCWSTR lpSrc;
  int iVar7;
  int in_FS_OFFSET;
  undefined4 uVar8;
  char *pcVar9;
  undefined4 local_48;
  undefined4 local_44;
  undefined4 *local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  int local_2c;
  undefined4 local_28;
  int local_24;
  undefined4 *local_20;
  wchar_t *local_1c;
  undefined4 local_18;
  LPWSTR local_14;
  undefined4 local_10;
  undefined4 local_c;
  int local_8;
  
  uVar6 = 0;
  local_c = 0;
  local_8 = 0;
  iVar7 = 0;
  local_24 = 0;
  local_30 = 0;
  local_2c = 0;
  local_18 = 0;
  local_14 = (LPWSTR)0x0;
  local_28 = 0x2080000;
  local_10 = 0;
  local_20 = param_1;
  local_1c = param_2;
  local_24 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,0x208);
  if (local_24 == 0) {
    uVar8 = 0x18c;
    goto LAB_6b829901;
  }
  DVar2 = RtlFormatCurrentUserKeyPath(&local_30);
  if ((int)DVar2 < 0) {
    pcVar9 = "RtlFormatCurrentUserKeyPath failed [%x]";
    uVar8 = 0x192;
  }
  else {
    DVar2 = RtlAppendUnicodeStringToString(&local_28,&local_30);
    if ((int)DVar2 < 0) {
      pcVar9 = "RtlAppendUnicodeStringToString failed for root HKCU path [%x]";
      uVar8 = 0x198;
    }
    else {
      DVar2 = RtlAppendUnicodeToString
                        (&local_28,
                         L"\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders")
      ;
      if (-1 < (int)DVar2) {
        local_40 = &local_28;
        local_48 = 0x18;
        local_44 = 0;
        local_3c = 0x40;
        local_38 = 0;
        local_34 = 0;
        DVar2 = ZwOpenKey(&local_8,1,&local_48);
        if ((int)DVar2 < 0) {
          if (DVar2 != 0xc0000034) {
            pcVar9 = "AslRegistryOpenKey failed [%x]";
            uVar8 = 0x1ad;
            goto LAB_6b829943;
          }
        }
        else {
          iVar7 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,0x208);
          if (iVar7 == 0) {
            uVar8 = 0x1b7;
LAB_6b829901:
            pcVar9 = "Out of memory";
            DVar2 = 0xc0000017;
LAB_6b829917:
            FUN_6b8671a2(1,"AslPathIsTemporaryInternetFile",uVar8,pcVar9);
            goto LAB_6b814580;
          }
          DVar2 = NtQueryValueKey(local_8,&DAT_6b880000,1,iVar7,0x208,&local_c);
          if (DVar2 == 0xc0000023) {
            RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iVar7);
            iVar7 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,local_c)
            ;
            if (iVar7 == 0) {
              uVar8 = 0x1c7;
              goto LAB_6b829901;
            }
            DVar2 = NtQueryValueKey(local_8,&DAT_6b880000,1,iVar7,local_c,&local_c);
          }
          if (DVar2 != 0xc0000034) {
            if ((int)DVar2 < 0) {
              pcVar9 = 
              "NtQueryValueKey failed to get registry value of temporary internet file [%x]";
              uVar8 = 0x1db;
              goto LAB_6b829943;
            }
            if ((*(int *)(iVar7 + 4) != 1) && (*(int *)(iVar7 + 4) != 2)) {
              pcVar9 = 
              "Error in registry value retrieved with NtQueryValueKey, not REG_SZ or REG_EXPAND_SZ";
              DVar2 = 0xc000014c;
              uVar8 = 0x1e1;
              goto LAB_6b829917;
            }
            lpSrc = (LPCWSTR)(*(int *)(iVar7 + 8) + iVar7);
            *(undefined2 *)(*(int *)(iVar7 + 0xc) + -2 + (int)lpSrc) = 0;
            pWVar5 = lpSrc;
            do {
              WVar1 = *pWVar5;
              pWVar5 = pWVar5 + 1;
            } while (WVar1 != (WCHAR)local_18);
            _MaxCount = (int)pWVar5 - (int)(lpSrc + 1) >> 1;
            if (*(int *)(iVar7 + 4) == 2) {
              DVar2 = ExpandEnvironmentStringsW(lpSrc,(LPWSTR)0x0,0);
              if (DVar2 == 0) {
                DVar2 = GetLastError();
                if ((int)DVar2 < 1) {
                  DVar2 = GetLastError();
                }
                else {
                  DVar2 = GetLastError();
                  DVar2 = DVar2 & 0xffff | 0xc0070000;
                }
                uVar6 = 0x1ef;
              }
              else {
                local_14 = (LPWSTR)RtlAllocateHeap(*(undefined4 *)
                                                    (*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                                   DVar2 * 2);
                if (local_14 == (LPWSTR)0x0) {
                  DVar2 = 0xc0000017;
                  FUN_6b8671a2(1,"AslPathIsTemporaryInternetFile",0x1f6,"Out of memory");
                  uVar6 = local_10;
                  goto LAB_6b814580;
                }
                DVar4 = ExpandEnvironmentStringsW(lpSrc,local_14,DVar2);
                if ((DVar4 != 0) && (DVar4 <= DVar2)) {
                  _MaxCount = DVar4 - 1;
                  uVar6 = local_10;
                  lpSrc = local_14;
                  goto LAB_6b81456a;
                }
                DVar2 = GetLastError();
                if ((int)DVar2 < 1) {
                  DVar2 = GetLastError();
                }
                else {
                  DVar2 = GetLastError();
                  DVar2 = DVar2 & 0xffff | 0xc0070000;
                }
                uVar6 = 0x1fd;
              }
              FUN_6b8671a2(1,"AslPathIsTemporaryInternetFile",uVar6,
                           "Failed to expand environment variables in temporary internet file path [%x]"
                          );
              uVar6 = local_10;
              goto LAB_6b814580;
            }
LAB_6b81456a:
            iVar3 = _wcsnicmp(lpSrc,local_1c,_MaxCount);
            if (iVar3 == 0) {
              uVar6 = 1;
            }
          }
        }
        DVar2 = 0;
        goto LAB_6b814580;
      }
      pcVar9 = "RtlAppendUnicodeToString failed for shell folders path [%x]";
      uVar8 = 0x19e;
    }
  }
LAB_6b829943:
  FUN_6b8671a2(1,"AslPathIsTemporaryInternetFile",uVar8,pcVar9);
LAB_6b814580:
  if (local_2c != 0) {
    RtlFreeUnicodeString(&local_30);
  }
  if (local_24 != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_24);
  }
  if (iVar7 != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iVar7);
  }
  if (local_8 != 0) {
    NtClose(local_8);
  }
  if (local_14 != (LPWSTR)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_14);
  }
  *local_20 = uVar6;
  return DVar2;
}



uint __fastcall FUN_6b8145f1(LPWSTR *param_1,wchar_t *param_2)

{
  bool bVar1;
  wchar_t *pwVar2;
  uint uVar3;
  LPWSTR lpszLongPath;
  DWORD DVar4;
  int in_FS_OFFSET;
  undefined4 uVar5;
  
  bVar1 = false;
  *param_1 = (LPWSTR)0x0;
  pwVar2 = wcsstr(param_2,L"SIGN.MEDIA=");
  if (pwVar2 == (wchar_t *)0x0) {
    pwVar2 = wcschr(param_2,L'~');
    if (pwVar2 != (wchar_t *)0x0) {
      uVar3 = 0x104;
      do {
        lpszLongPath = (LPWSTR)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18)
                                               ,8,uVar3 * 2);
        if (lpszLongPath == (LPWSTR)0x0) {
          return 0xc0000017;
        }
        DVar4 = GetLongPathNameW(param_2,lpszLongPath,uVar3);
        if (DVar4 == 0) {
          uVar3 = 0xc0000001;
          GetLastError();
          FUN_6b8671a2(1,"AslPathGetLongFileNameLongpath",0x6e,"Long path conversion failed %d [%x]"
                      );
          goto LAB_6b829bde;
        }
        if (uVar3 < DVar4) {
          if (bVar1) {
            uVar3 = 0xc0000023;
            FUN_6b8671a2(1,"AslPathGetLongFileNameLongpath",0x77,
                         "Buffer allocated was not large enough");
            goto LAB_6b829bde;
          }
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpszLongPath);
          lpszLongPath = (LPWSTR)0x0;
          uVar3 = DVar4;
        }
        bVar1 = true;
      } while (uVar3 <= DVar4);
      *param_1 = lpszLongPath;
      lpszLongPath = (LPWSTR)0x0;
      uVar3 = 0;
LAB_6b829bde:
      if (lpszLongPath == (LPWSTR)0x0) {
        return uVar3;
      }
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpszLongPath);
      return uVar3;
    }
    uVar3 = FUN_6b81464d(param_1,param_2);
    if (-1 < (int)uVar3) {
      return uVar3;
    }
    uVar5 = 0x5e;
  }
  else {
    uVar3 = FUN_6b81464d(param_1,param_2);
    if (-1 < (int)uVar3) {
      return uVar3;
    }
    uVar5 = 0x4b;
  }
  FUN_6b8671a2(1,"AslPathGetLongFileNameLongpath",uVar5,"AslStringDuplicate failed [%x]");
  return uVar3;
}



uint __fastcall FUN_6b81464d(short **param_1,void *param_2)

{
  uint uVar1;
  short *psVar2;
  int in_FS_OFFSET;
  undefined4 uVar3;
  char *pcVar4;
  short **local_8;
  
  *param_1 = (short *)0x0;
  if (param_2 == (void *)0x0) {
    uVar1 = 0;
  }
  else {
    local_8 = param_1;
    uVar1 = FUN_6b81485c(param_2,(int *)&local_8);
    if ((int)uVar1 < 0) {
      pcVar4 = "RtlStringCchLengthW failed [%x]";
      uVar3 = 0x235;
    }
    else {
      uVar1 = FUN_6b814837((uint)local_8,1,(uint *)&local_8);
      if ((int)uVar1 < 0) {
        pcVar4 = "SIZE_T arithmetic failed [%x]";
        uVar3 = 0x240;
      }
      else {
        if ((int)(ZEXT48(local_8) * 2 >> 0x20) == 0) {
          psVar2 = (short *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                            (int)(ZEXT48(local_8) * 2));
          if (psVar2 == (short *)0x0) {
            FUN_6b8671a2(1,"AslStringDuplicate",0x24d,"Out of memory");
            return 0xc0000017;
          }
          uVar1 = FUN_6b8147b5(psVar2,(uint)local_8,(int)param_2);
          if ((int)uVar1 < 0) {
            FUN_6b8671a2(1,"AslStringDuplicate",599,"RtlStringCchCopyW failed [%x]");
          }
          else {
            *param_1 = psVar2;
            psVar2 = (short *)0x0;
            uVar1 = 0;
          }
          if (psVar2 == (short *)0x0) {
            return uVar1;
          }
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,psVar2);
          return uVar1;
        }
        uVar1 = 0xc0000095;
        pcVar4 = "SIZE_T arithmetic failed [%x]";
        uVar3 = 0x246;
      }
    }
    FUN_6b8671a2(1,"AslStringDuplicate",uVar3,pcVar4);
  }
  return uVar1;
}



void __fastcall FUN_6b814701(undefined4 *param_1,wchar_t *param_2)

{
  wchar_t wVar1;
  int iVar2;
  wchar_t *pwVar3;
  UINT UVar4;
  wchar_t *extraout_EDX;
  wchar_t *pwVar5;
  wchar_t *extraout_EDX_00;
  wchar_t *extraout_EDX_01;
  wchar_t *extraout_EDX_02;
  undefined4 uVar6;
  undefined4 uVar7;
  wchar_t local_14;
  undefined local_12 [10];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  uVar6 = 0;
  pwVar5 = param_2 + 1;
  pwVar3 = param_2;
  do {
    wVar1 = *pwVar3;
    pwVar3 = pwVar3 + 1;
  } while (wVar1 != L'\0');
  if ((uint)((int)pwVar3 - (int)pwVar5 >> 1) < 8) {
    uVar7 = 0x107;
  }
  else {
    if (param_2[1] == L':') {
      iVar2 = FUN_6b8147b5(&local_14,5,(int)&DAT_6b884384);
      if (iVar2 < 0) {
        FUN_6b8671a2(1,"AslPathIsOnRemovableMedia",0x123,"RtlStringCchCopyW failed for c:\\ [%x]");
        pwVar5 = extraout_EDX_01;
      }
      else {
        pwVar5 = &local_14;
        local_14 = *param_2;
        do {
          wVar1 = *pwVar5;
          pwVar5 = pwVar5 + 1;
        } while (wVar1 != L'\0');
        pwVar3 = (wchar_t *)FUN_6b817e77();
        iVar2 = _wcsnicmp(&local_14,pwVar3,(int)pwVar5 - (int)local_12 >> 1);
        pwVar5 = extraout_EDX;
        if ((iVar2 != 0) &&
           (((UVar4 = GetDriveTypeW(&local_14), pwVar5 = extraout_EDX_02, UVar4 == 5 || (UVar4 == 2)
             ) || (UVar4 == 4)))) {
          uVar6 = 1;
        }
      }
      goto LAB_6b81479f;
    }
    if (param_2[1] == L'\\') goto LAB_6b81479f;
    uVar7 = 0x112;
  }
  FUN_6b8671a2(1,"AslPathIsOnRemovableMedia",uVar7,"%ws not a full path we can operate on [%x]");
  pwVar5 = extraout_EDX_00;
LAB_6b81479f:
  *param_1 = uVar6;
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,pwVar5);
  return;
}



void __fastcall FUN_6b8147b5(short *param_1,uint param_2,int param_3)

{
  int iVar1;
  
  iVar1 = 0;
  if ((param_2 == 0) || (0x7fffffff < param_2)) {
    iVar1 = -0x3ffffff3;
  }
  if (iVar1 < 0) {
    if (param_2 != 0) {
      *param_1 = 0;
    }
  }
  else {
    FUN_6b8147e5(param_1,param_2,param_1,param_3);
  }
  return;
}



int __fastcall FUN_6b8147e5(short *param_1,int param_2,undefined4 param_3,int param_4)

{
  short sVar1;
  int iVar2;
  int iVar3;
  
  if (param_2 != 0) {
    iVar3 = 0x7ffffffe;
    iVar2 = param_4 - (int)param_1;
    do {
      if ((iVar3 == 0) || (sVar1 = *(short *)(iVar2 + (int)param_1), sVar1 == 0)) break;
      *param_1 = sVar1;
      param_1 = param_1 + 1;
      iVar3 = iVar3 + -1;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
    if (param_2 != 0) goto LAB_6b814819;
  }
  param_1 = param_1 + -1;
LAB_6b814819:
  *param_1 = 0;
  return (-(uint)(param_2 != 0) & 0x7ffffffb) + 0x80000005;
}



uint __fastcall FUN_6b814837(uint param_1,int param_2,uint *param_3)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = param_1 + param_2;
  uVar2 = uVar1;
  if (uVar1 < param_1) {
    uVar2 = 0xffffffff;
  }
  *param_3 = uVar2;
  return -(uint)(uVar1 < param_1) & 0xc0000095;
}



void __thiscall FUN_6b81485c(void *this,int *param_1)

{
  int iVar1;
  
  if (this == (void *)0x0) {
    iVar1 = -0x3ffffff3;
  }
  else {
    iVar1 = FUN_6b814888(this,param_1);
  }
  if ((iVar1 < 0) && (param_1 != (int *)0x0)) {
    *param_1 = 0;
  }
  return;
}



int __thiscall FUN_6b814888(void *this,int *param_1)

{
  int iVar1;
  
  iVar1 = 0x7fffffff;
  do {
                    // WARNING: Load size is inaccurate
    if (*this == 0) break;
    this = (void *)((int)this + 2);
    iVar1 = iVar1 + -1;
  } while (iVar1 != 0);
  if (param_1 != (int *)0x0) {
    if (iVar1 == 0) {
      *param_1 = 0;
    }
    else {
      *param_1 = 0x7fffffff - iVar1;
    }
  }
  return (-(uint)(iVar1 != 0) & 0x3ffffff3) + 0xc000000d;
}



void __fastcall FUN_6b8148cf(undefined4 *param_1,wchar_t *param_2)

{
  WCHAR WVar1;
  DWORD DVar2;
  int iVar3;
  wchar_t *pwVar4;
  WCHAR *pWVar5;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 uVar6;
  undefined4 extraout_EDX_02;
  undefined4 uVar7;
  WCHAR local_214;
  undefined local_212 [2];
  wchar_t local_210 [258];
  undefined2 local_c;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  uVar7 = 0;
  DVar2 = GetTempPathW(0x105,&local_214);
  if ((DVar2 == 0) || (0x104 < DVar2)) {
    FUN_6b8671a2(1,"AslPathIsTemporaryDirectory",0x25c,"Failed to retrieve temporary directory [%x]"
                );
    uVar6 = extraout_EDX_02;
  }
  else {
    pWVar5 = &local_214;
    do {
      WVar1 = *pWVar5;
      pWVar5 = pWVar5 + 1;
    } while (WVar1 != L'\0');
    iVar3 = _wcsnicmp(param_2,&local_214,(int)pWVar5 - (int)local_212 >> 1);
    uVar6 = extraout_EDX;
    if (iVar3 != 0) {
      pwVar4 = (wchar_t *)FUN_6b817e77();
      wcscpy_s(&local_214,0x105,pwVar4);
      wcscat_s(&local_214,0x105,L"\\TEMP\\");
      pWVar5 = &local_214;
      local_c = 0;
      do {
        WVar1 = *pWVar5;
        pWVar5 = pWVar5 + 1;
      } while (WVar1 != L'\0');
      iVar3 = _wcsnicmp(param_2,&local_214,(int)pWVar5 - (int)local_212 >> 1);
      uVar6 = extraout_EDX_00;
      if (iVar3 != 0) {
        pwVar4 = (wchar_t *)FUN_6b817e77();
        wcscpy_s(&local_214,0x105,pwVar4);
        wcscpy_s(local_210,0x103,L"\\TEMP\\");
        pWVar5 = &local_214;
        local_c = 0;
        do {
          WVar1 = *pWVar5;
          pWVar5 = pWVar5 + 1;
        } while (WVar1 != L'\0');
        iVar3 = _wcsnicmp(param_2,&local_214,(int)pWVar5 - (int)local_212 >> 1);
        uVar6 = extraout_EDX_01;
        if (iVar3 != 0) goto LAB_6b814a16;
      }
    }
    uVar7 = 1;
  }
LAB_6b814a16:
  *param_1 = uVar7;
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar6);
  return;
}



uint __fastcall FUN_6b814a34(uint param_1)

{
  uint uVar1;
  
  uVar1 = (param_1 & 1) << 4;
  if ((param_1 & 2) != 0) {
    uVar1 = uVar1 | 0x20;
  }
  return uVar1;
}



void __fastcall FUN_6b814a45(int param_1,int param_2,short param_3,short *param_4)

{
  short sVar1;
  
  if (param_1 == 0) {
    if (param_3 == 0) {
      sVar1 = 0x14c;
    }
    else if (param_3 == 5) {
      sVar1 = 0x1c0;
    }
    else if (param_3 == 9) {
      sVar1 = -0x799c;
    }
    else {
      if (param_3 != 0xc) {
        return;
      }
      sVar1 = -0x559c;
    }
    *param_4 = sVar1;
  }
  else {
    sVar1 = *(short *)(param_1 + 0x20);
    *param_4 = sVar1;
    if ((sVar1 == 0x14c) && (param_2 != 0)) {
      if (param_3 == 5) {
        sVar1 = 0x1c0;
      }
      else if (param_3 == 9) {
        sVar1 = -0x799c;
      }
      else {
        if (param_3 != 0xc) {
          return;
        }
        sVar1 = -0x559c;
      }
      *param_4 = sVar1;
    }
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_6b814a7f(void)

{
  longlong lVar1;
  uint uVar2;
  uint local_c;
  uint local_8;
  
  local_c = 0;
  local_8 = 0;
  if ((DAT_6b8b08b0 | DAT_6b8b08b4) == 0) {
    EtwEventRegister(&DAT_6b88441c,0,0,&local_c);
    if ((local_c | local_8) == 0) {
      return;
    }
    DAT_6b8b08b0 = 0;
    uVar2 = 0;
    LOCK();
    lVar1 = CONCAT44(local_8,local_c);
    if (_DAT_6b8b08b0 != 0) {
      uVar2 = (uint)((ulonglong)_DAT_6b8b08b0 >> 0x20);
      lVar1 = _DAT_6b8b08b0;
    }
    _DAT_6b8b08b0 = lVar1;
    if ((DAT_6b8b08b0 | uVar2) != 0) {
      EtwEventUnregister(local_c,local_8);
      local_c = 0;
      local_8 = 0;
    }
  }
  EtwEventWrite(DAT_6b8b08b0,DAT_6b8b08b4,&DAT_6b8843a0,0,0);
  return;
}



int __fastcall FUN_6b814aef(undefined2 *param_1,short *param_2)

{
  uint uVar1;
  short sVar2;
  int iVar3;
  int iVar4;
  short *psVar5;
  int in_FS_OFFSET;
  int local_c;
  undefined4 local_8;
  
  local_c = 0;
  local_8 = 0;
  iVar3 = RtlFormatCurrentUserKeyPath(&local_c);
  if (iVar3 < 0) {
    FUN_6b8671a2(1,"AslRegistryBuildUserPath",0x5c4,"RtlFormatCurrentUserKeyPath failed [%x]");
  }
  else {
    *param_1 = 0;
    iVar3 = 0;
    psVar5 = param_2;
    do {
      sVar2 = *psVar5;
      psVar5 = psVar5 + 1;
    } while (sVar2 != 0);
    uVar1 = local_c + 2 + ((int)psVar5 - (int)(param_2 + 1) >> 1) * 2;
    iVar4 = *(int *)(in_FS_OFFSET + 0x30);
    param_1[1] = (short)uVar1;
    iVar4 = RtlAllocateHeap(*(undefined4 *)(iVar4 + 0x18),8,uVar1 & 0xffff);
    *(int *)(param_1 + 2) = iVar4;
    if (iVar4 == 0) {
      iVar3 = -0x3fffffe9;
      FUN_6b8671a2(1,"AslRegistryBuildUserPath",0x5d0,"Out of memory");
    }
    else {
      RtlAppendUnicodeStringToString(param_1,&local_c);
      RtlAppendUnicodeToString(param_1,param_2);
    }
  }
  RtlFreeUnicodeString(&local_c);
  return iVar3;
}



int BasepGetExeArchType(short *param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  short sVar2;
  undefined4 *puVar3;
  undefined local_74 [32];
  short local_54;
  byte local_51;
  short local_44;
  undefined4 local_20;
  undefined4 local_1c;
  int local_18;
  undefined4 local_14;
  uint local_10;
  int local_c [2];
  
                    // 0x14b90  92  BasepGetExeArchType
  memset(local_74,0,0x30);
  local_20 = 0;
  local_1c = 0;
  local_c[0] = 0;
  local_10 = 0;
  local_14 = 0;
  local_18 = 0;
  puVar3 = (undefined4 *)&local_44;
  for (iVar1 = 9; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  RtlInitUnicodeString(&local_20,param_3);
  iVar1 = NtCreateSection(local_c,1,0,0,2,0x11000000,param_2);
  sVar2 = 0;
  if ((iVar1 < 0) || (iVar1 = NtQuerySection(local_c[0],1,local_74,0x30,0), iVar1 < 0))
  goto LAB_6b814c29;
  if (((local_54 == 0x14c) && ((local_51 & 1) != 0)) &&
     ((GetSystemInfo((LPSYSTEM_INFO)&local_44), local_44 == 9 || (local_44 == 6)))) {
    iVar1 = NtQuerySystemInformation(0x3b,&local_10,4,0);
    sVar2 = local_54;
    if (iVar1 < 0) goto LAB_6b814c29;
    if ((local_10 & 1) != 0) {
      iVar1 = LdrOpenImageFileOptionsKey(&local_20,0,&local_14);
      if (iVar1 < 0) {
        if (iVar1 == -0x3fffffcc) {
LAB_6b829ead:
          if (local_44 == 6) {
            local_54 = 0x200;
          }
          else if (local_44 == 9) {
            local_54 = -0x799c;
          }
        }
      }
      else {
        iVar1 = LdrQueryImageFileKeyOption(local_14,L"Wow64",4,&local_18,4,0);
        if ((iVar1 == -0x3fffffcc) || ((-1 < iVar1 && (local_18 != 0)))) goto LAB_6b829ead;
      }
    }
  }
  iVar1 = 0;
  sVar2 = local_54;
LAB_6b814c29:
  if (local_c[0] != 0) {
    NtClose(local_c[0]);
  }
  *param_1 = sVar2;
  return iVar1;
}



int __fastcall FUN_6b814c46(LPCWSTR param_1,undefined4 *param_2)

{
  HANDLE hActCtx;
  BOOL BVar1;
  int iVar2;
  int in_FS_OFFSET;
  undefined local_28 [16];
  LPCWSTR local_18;
  LPCWSTR local_14;
  LPCWSTR local_10;
  HMODULE local_c;
  SIZE_T local_8;
  
  local_28._0_4_ = 0x20;
  local_28._12_4_ = 0;
  iVar2 = 0;
  local_18 = (LPCWSTR)0x0;
  local_10 = (LPCWSTR)0x0;
  local_c = (HMODULE)0x0;
  *param_2 = 0;
  param_2[1] = 0;
  param_2[2] = 0;
  local_14 = (LPCWSTR)&DAT_00000001;
  local_28._4_4_ = 8;
  local_28._8_4_ = param_1;
  hActCtx = CreateActCtxW((PCACTCTXW)local_28);
  if (hActCtx == (HANDLE)0xffffffff) {
    iVar2 = *(int *)(*(int *)(in_FS_OFFSET + 0x18) + 0xbf4);
    if (iVar2 < -0x3fffff84) {
      if (((iVar2 != -0x3fffff85) && (iVar2 != -0x3ffffff3)) && (iVar2 != -0x3fffffe9)) {
        if (iVar2 < -0x3fffffcd) {
          return iVar2;
        }
        if (-0x3fffffcc < iVar2) {
          return iVar2;
        }
      }
    }
    else {
      if (iVar2 < -0x3fffff77) {
        return iVar2;
      }
      if ((-0x3fffff75 < iVar2) && (1 < iVar2 + 0x3feaffffU)) {
        return iVar2;
      }
    }
    iVar2 = 0;
  }
  else {
    BVar1 = QueryActCtxW(0x80000000,hActCtx,(PVOID)0x0,5,param_2,0xc,&local_8);
    if (BVar1 == 0) {
      iVar2 = *(int *)(*(int *)(in_FS_OFFSET + 0x18) + 0xbf4);
    }
    ReleaseActCtx(hActCtx);
  }
  return iVar2;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL IsBadStringPtrW(LPCWSTR lpsz,UINT_PTR ucchMax)

{
  BOOL BVar1;
  undefined4 *in_FS_OFFSET;
  LPCWSTR local_20;
  undefined4 local_14;
  
                    // 0x14cd0  893  IsBadStringPtrW
  if (ucchMax != 0) {
    if (lpsz == (LPCWSTR)0x0) {
      BVar1 = 1;
      goto LAB_6b814d19;
    }
    for (local_20 = lpsz; (*local_20 != L'\0' && (local_20 != lpsz + (ucchMax - 1)));
        local_20 = local_20 + 1) {
    }
  }
  BVar1 = 0;
LAB_6b814d19:
  *in_FS_OFFSET = local_14;
  return BVar1;
}



LONG InterlockedCompareExchange(LONG *Destination,LONG Exchange,LONG Comperand)

{
                    // 0x14d30  878  InterlockedCompareExchange
  LOCK();
  if (Comperand == *Destination) {
    *Destination = Exchange;
  }
  else {
    Comperand = *Destination;
  }
  return Comperand;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// InitFn parameter of InitOnceExecuteOnce
// 

undefined4 InitFn_6b814d50(void)

{
  int iVar1;
  undefined local_c [4];
  int local_8;
  
  DAT_6b8b074c = 0x37;
  iVar1 = NtQueryTimerResolution(&local_8,&DAT_6b8b07c8,local_c);
  if (iVar1 < 0) {
    DAT_6b8b0738 = 10;
  }
  else {
    if (local_8 + 9999U < 550000) {
      DAT_6b8b074c = (local_8 + 9999U) / 10000;
    }
    DAT_6b8b0738 = (DAT_6b8b07c8 + 0x26acU) / 10000;
    if (DAT_6b8b0738 == 0) {
      DAT_6b8b0738 = 1;
    }
  }
  FUN_6b814dd5();
  _DAT_6b8b0750 = DAT_6b8b074c;
  DAT_6b8b0754 = DAT_6b8b074c;
  return 1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_6b814dd5(void)

{
  DWORD DVar1;
  undefined4 extraout_EDX;
  int iVar2;
  
  iVar2 = 100;
  do {
    iVar2 = iVar2 + -1;
    _DAT_6b8b0748 = GetTickCount();
    _DAT_6b8b0740 = FUN_6b814e64();
    _DAT_6b8b0744 = extraout_EDX;
    DVar1 = GetTickCount();
    if (DVar1 == _DAT_6b8b0748) {
      return;
    }
  } while (iVar2 != 0);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

DWORD timeGetTime(void)

{
  BOOL BVar1;
  uint uVar2;
  int iVar3;
  DWORD DVar4;
  int extraout_EDX;
  
                    // 0x14e20  1607  timeGetTime
  BVar1 = InitOnceExecuteOnce(&InitOnce_6b8b08c0,InitFn_6b814d50,(PVOID)0x0,(LPVOID *)0x0);
  if (BVar1 != 0) {
    uVar2 = FUN_6b814e64();
    iVar3 = _alldiv(uVar2 - _DAT_6b8b0740,
                    (extraout_EDX - _DAT_6b8b0744) - (uint)(uVar2 < _DAT_6b8b0740),10000,0);
    return iVar3 + _DAT_6b8b0748;
  }
                    // WARNING: Could not recover jumptable at 0x6b814e5e. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar4 = GetTickCount();
  return DVar4;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 FUN_6b814e64(void)

{
  do {
  } while (_DAT_7ffe000c != _DAT_7ffe0010);
  return _DAT_7ffe0008;
}



void GlobalMemoryStatus(LPMEMORYSTATUS lpBuffer)

{
  SIZE_T *pSVar1;
  SIZE_T *pSVar2;
  code *pcVar3;
  int in_FS_OFFSET;
  undefined8 uVar4;
  SIZE_T *pSVar5;
  SIZE_T *pSVar6;
  undefined4 uVar7;
  undefined local_48 [12];
  int local_3c;
  SIZE_T local_38;
  int local_34;
  SIZE_T local_30;
  int local_2c;
  SIZE_T local_28;
  int local_24;
  SIZE_T local_20;
  int local_1c;
  SIZE_T local_18;
  int local_14;
  uint local_8;
  
                    // 0x14e90  831  GlobalMemoryStatus
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  memset(local_48,0,0x40);
  local_48._0_4_ = 0x40;
  GlobalMemoryStatusEx((LPMEMORYSTATUSEX)local_48);
  lpBuffer->dwLength = 0x20;
  lpBuffer->dwMemoryLoad = local_48._4_4_;
  if ((local_3c != 0) || (local_48._8_4_ == 0xffffffff)) {
    local_48._8_4_ = 0xffffffff;
  }
  pSVar1 = &lpBuffer->dwTotalPhys;
  *pSVar1 = local_48._8_4_;
  if ((local_34 != 0) || (local_38 == 0xffffffff)) {
    local_38 = 0xffffffff;
  }
  pSVar2 = &lpBuffer->dwAvailPhys;
  *pSVar2 = local_38;
  if ((local_2c != 0) || (local_30 == 0xffffffff)) {
    local_30 = 0xffffffff;
  }
  lpBuffer->dwTotalPageFile = local_30;
  if ((local_24 != 0) || (local_28 == 0xffffffff)) {
    local_28 = 0xffffffff;
  }
  lpBuffer->dwAvailPageFile = local_28;
  if ((local_1c != 0) || (local_20 == 0xffffffff)) {
    local_20 = 0xffffffff;
  }
  lpBuffer->dwTotalVirtual = local_20;
  if ((local_14 != 0) || (local_18 == 0xffffffff)) {
    local_18 = 0xffffffff;
  }
  lpBuffer->dwAvailVirtual = local_18;
  pcVar3 = DAT_6b8b090c;
  if (DAT_6b8b090c != (code *)0x0) {
    pSVar5 = pSVar1;
    pSVar6 = pSVar2;
    uVar7 = DAT_6b8b0708;
    _guard_check_icall();
    (*pcVar3)(pSVar5,pSVar6,uVar7);
  }
  uVar4 = RtlImageNtHeader(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 8));
  if (((int)uVar4 != 0) && ((*(byte *)((int)uVar4 + 0x16) & 0x20) == 0)) {
    if (0x7fffffff < *pSVar1) {
      *pSVar1 = 0x7fffffff;
    }
    if (0x7fffffff < *pSVar2) {
      *pSVar2 = 0x7fffffff;
    }
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,(int)((ulonglong)uVar4 >> 0x20));
  return;
}



BOOL VerifyVersionInfoA(LPOSVERSIONINFOEXA lpVersionInformation,DWORD dwTypeMask,
                       DWORDLONG dwlConditionMask)

{
  BOOL BVar1;
  undefined4 extraout_EDX;
  _OSVERSIONINFOEXW local_124;
  uint local_8;
  
                    // 0x14ff0  1482  VerifyVersionInfoA
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_124.dwOSVersionInfoSize = 0x11c;
  local_124.dwMajorVersion = lpVersionInformation->dwMajorVersion;
  local_124.dwMinorVersion = lpVersionInformation->dwMinorVersion;
  local_124.dwBuildNumber = lpVersionInformation->dwBuildNumber;
  local_124.dwPlatformId = lpVersionInformation->dwPlatformId;
  local_124.wServicePackMajor = lpVersionInformation->wServicePackMajor;
  local_124.wServicePackMinor = lpVersionInformation->wServicePackMinor;
  local_124.wSuiteMask = lpVersionInformation->wSuiteMask;
  local_124.wProductType = lpVersionInformation->wProductType;
  local_124.wReserved = lpVersionInformation->wReserved;
  VerifyVersionInfoW(&local_124,dwTypeMask,dwlConditionMask);
  BVar1 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,extraout_EDX);
  return BVar1;
}



HFILE _lclose(HFILE hFile)

{
  BOOL BVar1;
  
                    // 0x150a0  1579  _lclose
  BVar1 = CloseHandle((HANDLE)hFile);
  return (BVar1 != 0) - 1;
}



void RtlCaptureStackBackTrace(void)

{
                    // 0x150c0  1235  RtlCaptureStackBackTrace
                    // WARNING: Could not recover jumptable at 0x6b8150c6. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlCaptureStackBackTrace();
  return;
}



BOOL SetPriorityClass(HANDLE hProcess,DWORD dwPriorityClass)

{
  BOOL BVar1;
  
                    // 0x150e0  1344  SetPriorityClass
                    // WARNING: Could not recover jumptable at 0x6b8150e6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetPriorityClass(hProcess,dwPriorityClass);
  return BVar1;
}



BOOL HeapValidate(HANDLE hHeap,DWORD dwFlags,LPCVOID lpMem)

{
  BOOL BVar1;
  
                    // 0x15100  855  HeapValidate
                    // WARNING: Could not recover jumptable at 0x6b815106. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = HeapValidate(hHeap,dwFlags,lpMem);
  return BVar1;
}



LANGID GetSystemDefaultLangID(void)

{
  LANGID LVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b815120. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x15120  738  GetSystemDefaultLangID
  LVar1 = GetSystemDefaultLangID();
  return LVar1;
}



undefined4 __thiscall
BasepGetAppCompatData
          (undefined4 this,wchar_t *param_2,short *param_3,uint *param_4,int param_5,short *param_6,
          uint *param_7,int param_8,undefined4 param_9,uint param_10,uint param_11,
          undefined4 param_12,int *param_13,int *param_14,int *param_15,undefined4 *param_16)

{
  uint uVar1;
  int iVar2;
  DWORD DVar3;
  wchar_t *pwVar4;
  int iVar5;
  undefined4 uVar6;
  undefined4 *extraout_EDX;
  undefined4 *extraout_EDX_00;
  undefined4 *extraout_EDX_01;
  undefined4 *extraout_EDX_02;
  undefined4 *extraout_EDX_03;
  undefined4 *extraout_EDX_04;
  undefined4 *puVar7;
  uint uVar8;
  undefined4 *puVar9;
  int in_FS_OFFSET;
  int local_50;
  undefined4 local_4c;
  uint local_48;
  uint local_44;
  int *local_40;
  undefined4 local_3c;
  undefined *local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  uint local_28;
  uint local_24;
  undefined4 local_20;
  int local_1c;
  undefined2 local_18;
  undefined2 local_16;
  undefined2 local_14;
  undefined2 local_12;
  short *local_10;
  undefined4 local_c;
  
                    // 0x15130  90  BasepGetAppCompatData
  local_4c = 0x11c0;
  local_38 = (undefined *)0x0;
  local_c = 0;
  local_40 = (int *)0x0;
  local_34 = 0;
  local_44 = 0;
  local_30 = 0;
  local_2c = 0;
  uVar8 = *param_4 >> 2 & 1;
  local_3c = 1;
  local_48 = uVar8;
  iVar2 = FUN_6b8158a9(this,&local_44);
  if ((-1 < iVar2) && (local_48 = uVar8, local_44 != 0)) {
    uVar8 = uVar8 | 4;
    local_48 = uVar8;
  }
  local_50 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,local_4c);
  iVar2 = local_50;
  if (local_50 != 0) {
    *(undefined4 *)(local_50 + 0x208) = local_4c;
    *(undefined4 *)(local_50 + 0x20c) = 0xac0dedab;
    *(short *)(local_50 + 0x214) = (short)param_9;
    *(undefined4 *)(local_50 + 0x1144) = *(undefined4 *)(param_8 + 0x28);
    *(undefined4 *)(local_50 + 0x1148) = *(undefined4 *)(param_8 + 0x2c);
    if ((param_3 == (short *)0x0) || (*param_3 == 0)) {
      uVar6 = 0;
    }
    else {
      uVar6 = 1;
    }
    *(undefined4 *)(local_50 + 0x1150) = uVar6;
    *(uint *)(local_50 + 0x1154) = (uint)(*param_6 != 0);
    *(uint *)(local_50 + 0x1158) = (uint)(*(int *)(param_5 + 4) != 0);
    *(uint *)(local_50 + 0x115c) = (uint)(uVar8 != 0);
    *(undefined4 *)(local_50 + 0x1160) = *(undefined4 *)(param_5 + 4);
    DVar3 = GetCurrentProcessId();
    *(DWORD *)(local_50 + 0xb38) = DVar3;
    iVar2 = *(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x10);
    if ((iVar2 != 0) && (*(int *)(iVar2 + 0x3c) != 0)) {
      wcsncpy_s((wchar_t *)(local_50 + 0xb3c),0x104,*(wchar_t **)(iVar2 + 0x3c),0xffffffff);
    }
    if (((undefined4 *)*param_13 != (undefined4 *)0x0) && (*param_14 == 0x1c8)) {
      puVar7 = (undefined4 *)*param_13;
      puVar9 = (undefined4 *)(local_50 + 0x218);
      for (iVar2 = 0x72; uVar8 = local_48, iVar2 != 0; iVar2 = iVar2 + -1) {
        *puVar9 = *puVar7;
        puVar7 = puVar7 + 1;
        puVar9 = puVar9 + 1;
      }
    }
    pwVar4 = wcsrchr(param_2,L'\\');
    if (pwVar4 != (wchar_t *)0x0) {
      param_2 = pwVar4 + 1;
    }
    iVar2 = _wcsicmp(param_2,L"wwahost.exe");
    puVar7 = extraout_EDX;
    if ((((iVar2 == 0) ||
         (iVar2 = _wcsicmp(param_2,L"microsoftedge.exe"), puVar7 = extraout_EDX_00, iVar2 == 0)) ||
        (iVar2 = _wcsicmp(param_2,L"microsoftedgecp.exe"), puVar7 = extraout_EDX_01, iVar2 == 0)) ||
       ((iVar2 = _wcsicmp(param_2,L"microsoftedgebchost.exe"), puVar7 = extraout_EDX_02, iVar2 == 0
        || (iVar2 = _wcsicmp(param_2,L"microsoftedgedevtools.exe"), puVar7 = extraout_EDX_03,
           iVar2 == 0)))) {
      uVar8 = uVar8 | 2;
    }
    local_1c = local_50;
    local_18 = *(undefined2 *)(param_8 + 0x16);
    local_16 = *(undefined2 *)(param_8 + 0x14);
    local_14 = *(undefined2 *)(param_8 + 0x18);
    local_12 = *(undefined2 *)(param_8 + 0x1a);
    local_10 = param_6;
    uVar1 = *param_7;
    local_24 = param_7[1];
    local_28 = uVar1;
    if ((local_24 == 0) && (uVar1 == 0)) {
      local_28 = param_10;
      local_24 = param_11;
    }
    local_20 = param_12;
    if (*param_13 != 0) {
      iVar5 = FUN_6b815914(uVar1,puVar7);
      iVar2 = local_50;
      if (iVar5 < 0) goto LAB_6b829fed;
      local_38 = (undefined *)RtlDecodeSystemPointer(DAT_6b8b0890);
      local_34 = RtlDecodeSystemPointer(DAT_6b8b0894);
      local_30 = RtlDecodeSystemPointer(DAT_6b8b0898);
      local_2c = RtlDecodeSystemPointer(DAT_6b8b089c);
    }
    iVar5 = FUN_6b81549f(&local_28,&local_38);
    iVar2 = local_50;
    if (((-1 < iVar5) && (iVar5 = FUN_6b815764((void *)(local_50 + 0x810),&local_40), iVar5 != 0))
       && (((*(uint *)(iVar2 + 0x114c) = (uint)(*local_40 == 4), uVar8 == 0 && (*param_13 == 0)) ||
           (iVar5 = BaseGenerateAppCompatData
                              (&local_50,extraout_EDX_04,param_9,uVar8,param_13,param_14,&local_50,
                               &local_4c), iVar2 = local_50, -1 < iVar5)))) goto LAB_6b8153eb;
  }
LAB_6b829fed:
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iVar2);
  local_4c = 0;
  local_3c = 0;
  local_50 = 0;
LAB_6b8153eb:
  *param_15 = local_50;
  *param_16 = local_4c;
  return local_3c;
}



void __fastcall FUN_6b81549f(uint *param_1,undefined **param_2)

{
  ushort uVar1;
  ushort uVar2;
  int iVar3;
  ushort uVar4;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar5;
  bool bVar6;
  undefined8 uVar7;
  uint local_130;
  undefined local_12c [4];
  uint local_128;
  uint local_124;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  memset(local_12c,0,0x11c);
  local_130 = 0;
  uVar5 = extraout_EDX;
  if ((param_1 == (uint *)0x0) || (param_1[3] == 0)) goto LAB_6b815556;
  RtlGetDeviceFamilyInfoEnum(0,&local_130,0);
  if (param_1[2] != 0) {
    local_130 = param_1[2];
  }
  if ((*param_1 | param_1[1]) == 0) {
    uVar7 = RtlGetVersion(local_12c);
    uVar5 = (undefined4)((ulonglong)uVar7 >> 0x20);
    if ((int)uVar7 < 0) goto LAB_6b815556;
    uVar2 = *(ushort *)(param_1 + 4);
    if ((uVar2 == local_128) && (*(ushort *)((int)param_1 + 0x12) == local_124)) {
      uVar4 = (ushort)local_128;
      uVar2 = (ushort)local_124;
    }
    else {
      uVar4 = *(ushort *)param_1[6];
      if (uVar4 != 0) {
        uVar2 = ((ushort *)param_1[6])[1];
        iVar3 = 3;
        goto LAB_6b815546;
      }
      uVar4 = *(ushort *)(param_1 + 5);
      bVar6 = uVar2 != uVar4;
      uVar1 = uVar2;
      if ((uVar4 < uVar2) || (uVar1 = uVar4, uVar4 <= uVar2)) {
        uVar4 = uVar1;
        if ((bVar6) ||
           (uVar2 = *(ushort *)((int)param_1 + 0x16),
           *(ushort *)((int)param_1 + 0x16) < *(ushort *)((int)param_1 + 0x12))) {
          uVar2 = *(ushort *)((int)param_1 + 0x12);
        }
      }
      else {
        uVar2 = *(ushort *)((int)param_1 + 0x16);
      }
    }
    iVar3 = 1;
  }
  else {
    uVar4 = *(ushort *)((int)param_1 + 6);
    uVar2 = *(ushort *)(param_1 + 1);
    iVar3 = 2;
  }
LAB_6b815546:
  FUN_6b8155a6(param_1,uVar4,uVar2,local_130,iVar3,param_2);
  uVar5 = extraout_EDX_00;
LAB_6b815556:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar5);
  return;
}



void __fastcall
FUN_6b8155a6(uint *param_1,ushort param_2,ushort param_3,undefined4 param_4,int param_5,
            undefined **param_6)

{
  code *pcVar1;
  int iVar2;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar3;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  int iVar4;
  undefined4 *puVar5;
  uint *puVar6;
  undefined **ppuVar7;
  undefined4 *puVar8;
  uint *puVar9;
  undefined8 uVar10;
  undefined4 local_544 [4];
  undefined4 local_534;
  undefined4 local_530;
  uint *local_528;
  undefined4 local_524;
  uint local_520;
  undefined **local_51c;
  undefined *local_518;
  undefined local_514 [456];
  uint local_34c [4];
  undefined4 local_33c;
  undefined4 local_338;
  undefined4 local_334;
  undefined4 uStack816;
  undefined4 uStack812;
  undefined4 uStack808;
  undefined4 local_324;
  undefined4 uStack800;
  undefined4 uStack796;
  undefined4 uStack792;
  int local_314;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_51c = param_6;
  local_524 = 0xc0000001;
  local_528 = param_1;
  memset(local_34c,0,0x340);
  iVar4 = 0;
  memset(local_514,0,0x1c8);
  local_520 = param_1[3];
  uVar3 = extraout_EDX;
  if (local_520 == 0) goto LAB_6b81574d;
  local_518 = &DAT_6b880080;
  FUN_6b815825(param_2,param_3,&local_518);
  ppuVar7 = local_51c;
  local_334 = *(undefined4 *)(local_518 + 4);
  uStack816 = *(undefined4 *)(local_518 + 8);
  uStack812 = *(undefined4 *)(local_518 + 0xc);
  uStack808 = *(undefined4 *)(local_518 + 0x10);
  if (*(int *)(local_520 + 0x1150) != 0) {
    local_338 = 0;
    local_33c = 0x60002;
  }
  local_314 = param_5;
  if ((*(byte *)(local_520 + 0x2d8) & 0x80) == 0) {
LAB_6b81566c:
    local_324 = local_334;
    uStack800 = uStack816;
    uStack796 = uStack812;
    uStack792 = uStack808;
    local_518 = (undefined *)0x0;
    iVar2 = FUN_6b815764(&local_334,&local_518);
    uVar3 = extraout_EDX_00;
    ppuVar7 = local_51c;
    if ((iVar2 != 0) && (local_518 != (undefined *)0x0)) {
      local_34c[0] = 0;
      local_34c[1] = CONCAT22(*(undefined2 *)(local_518 + 0x14),*(undefined2 *)(local_518 + 0x16));
      if (local_314 == 2) {
        local_34c[0] = *local_528;
        local_34c[1] = local_528[1];
        if ((0xa0000 < local_34c[1]) || ((0x9ffff < local_34c[1] && (0x4a63ffff < local_34c[0])))) {
          local_34c[0] = 0x4a640000;
          local_34c[1] = 0xa0000;
        }
      }
      local_34c[2] = param_4;
      local_544[0] = 1;
      local_544[1] = 0;
      uVar10 = FUN_6b8157d3();
      uVar3 = (undefined4)((ulonglong)uVar10 >> 0x20);
      local_524 = 0;
      local_544[3] = (int)uVar10;
      local_534 = 0;
      local_530 = 0;
      local_544[2] = 1;
      puVar5 = local_544;
      puVar8 = (undefined4 *)(local_520 + 0x7e0);
      for (iVar2 = 6; iVar2 != 0; iVar2 = iVar2 + -1) {
        *puVar8 = *puVar5;
        puVar5 = puVar5 + 1;
        puVar8 = puVar8 + 1;
      }
      puVar6 = local_34c;
      puVar9 = (uint *)(local_520 + 0x7f8);
      for (iVar2 = 0xd0; ppuVar7 = local_51c, iVar2 != 0; iVar2 = iVar2 + -1) {
        *puVar9 = *puVar6;
        puVar6 = puVar6 + 1;
        puVar9 = puVar9 + 1;
      }
    }
  }
  else {
    iVar4 = FUN_6b8508d7(local_520,local_514,local_51c);
    uVar3 = extraout_EDX_01;
    if (iVar4 == 0) goto LAB_6b81574d;
    iVar2 = FUN_6b850955(iVar4,local_514,(int)local_34c,(int)ppuVar7);
    uVar3 = extraout_EDX_02;
    if (iVar2 != 0) goto LAB_6b81566c;
  }
  if (iVar4 != 0) {
    pcVar1 = (code *)ppuVar7[1];
    _guard_check_icall();
    (*pcVar1)(iVar4);
    uVar3 = extraout_EDX_03;
  }
LAB_6b81574d:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar3);
  return;
}



undefined4 __fastcall FUN_6b815764(void *param_1,undefined4 *param_2)

{
  int iVar1;
  int iVar2;
  undefined *local_c;
  uint local_8;
  
  if ((param_2 != (undefined4 *)0x0) && (param_1 != (void *)0x0)) {
    *param_2 = 0;
    iVar2 = 0;
    local_c = &DAT_6b880014;
    local_8 = 0;
    do {
      iVar1 = memcmp(param_1,local_c,0x10);
      if (iVar1 == 0) {
        *param_2 = &DAT_6b880010 + iVar2 * 0x1c;
        return 1;
      }
      iVar2 = iVar2 + 1;
      local_8 = local_8 + 0x1c;
      local_c = local_c + 0x1c;
    } while (local_8 < 0x8c);
  }
  return 0;
}



void FUN_6b8157d3(void)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  undefined8 uVar4;
  int local_6c;
  undefined2 local_68 [32];
  undefined4 local_28 [8];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  puVar2 = (undefined4 *)L"SB_ENABLE_TRACE";
  puVar3 = local_28;
  for (iVar1 = 8; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar3 = *puVar2;
    puVar2 = puVar2 + 1;
    puVar3 = puVar3 + 1;
  }
  uVar4 = RtlQueryEnvironmentVariable(0,local_28,0xf,local_68,0x20,&local_6c);
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,(int)((ulonglong)uVar4 >> 0x20));
  return;
}



undefined4 __fastcall FUN_6b815825(ushort param_1,ushort param_2,undefined4 *param_3)

{
  ushort uVar1;
  uint uVar2;
  undefined4 uVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  
  uVar3 = 1;
  if (param_3 == (undefined4 *)0x0) {
    uVar3 = 0;
  }
  else {
    iVar4 = 0;
    uVar2 = 0;
    iVar5 = -1;
    do {
      uVar1 = *(ushort *)((int)&DAT_6b880024 + uVar2);
      iVar6 = iVar4;
      if (((param_1 <= uVar1) &&
          ((param_1 != uVar1 || (param_2 < *(ushort *)((int)&DAT_6b880026 + uVar2))))) &&
         ((param_1 < uVar1 ||
          ((iVar6 = iVar5, param_1 == uVar1 && (param_2 < *(ushort *)((int)&DAT_6b880026 + uVar2))))
          ))) break;
      uVar2 = uVar2 + 0x1c;
      iVar4 = iVar4 + 1;
      iVar5 = iVar6;
    } while (uVar2 < 0x8c);
    if (iVar5 == -1) {
      *param_3 = &DAT_6b880010;
    }
    else {
      *param_3 = &DAT_6b880010 + iVar5 * 0x1c;
    }
  }
  return uVar3;
}



undefined4 __fastcall FUN_6b8158a9(undefined4 param_1,uint *param_2)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = RtlGetCurrentServiceSessionId();
  if (iVar1 == 0) {
    uVar2 = 0xc00000bb;
  }
  else {
    uVar2 = FUN_6b85127b(param_2);
  }
  return uVar2;
}



undefined4 __fastcall
BaseGenerateAppCompatData
          (undefined4 param_1,undefined4 *param_2,undefined4 param_3,undefined4 param_4,
          undefined4 param_5,undefined4 param_6,undefined4 param_7,undefined4 param_8)

{
  int iVar1;
  code *pcVar2;
  
                    // 0x158d0  62  BaseGenerateAppCompatData
  iVar1 = FUN_6b815914(param_1,param_2);
  if ((-1 < iVar1) && (pcVar2 = (code *)RtlDecodeSystemPointer(DAT_6b8b0888), pcVar2 != (code *)0x0)
     ) {
    _guard_check_icall();
    (*pcVar2)(param_3,param_4,param_5,param_6,param_7,param_8);
  }
  return 0;
}



void __fastcall FUN_6b815914(undefined4 param_1,undefined4 *param_2)

{
  short *psVar1;
  int iVar2;
  short *psVar3;
  undefined8 uVar4;
  undefined4 local_23c;
  undefined4 local_238;
  undefined4 local_234;
  undefined4 local_230;
  undefined4 local_22c;
  undefined4 local_228;
  undefined4 local_224;
  undefined4 local_220;
  undefined *local_21c;
  undefined4 local_218;
  undefined local_214 [524];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_218 = 0;
  if (DAT_6b8b087c != 1) {
    if (DAT_6b8b087c != -1) {
      param_2 = (undefined4 *)&DAT_7ffe0032;
      psVar1 = (short *)&DAT_7ffe0030;
      do {
        psVar3 = psVar1;
        psVar1 = psVar3 + 1;
      } while (*psVar3 != 0);
      if (((int)(psVar3 + -0x3fff0018) >> 1) * 2 + 0x2cU < 0x209) {
        local_21c = local_214;
        local_220 = 0x2080000;
        uVar4 = RtlAppendUnicodeToString(&local_220,&DAT_7ffe0030);
        param_2 = (undefined4 *)((ulonglong)uVar4 >> 0x20);
        if (-1 < (int)uVar4) {
          uVar4 = RtlAppendUnicodeStringToString(&local_220,&DAT_6b8800d4);
          param_2 = (undefined4 *)((ulonglong)uVar4 >> 0x20);
          if (-1 < (int)uVar4) {
            uVar4 = LdrLoadDll(0,0,&local_220,&local_218);
            param_2 = (undefined4 *)((ulonglong)uVar4 >> 0x20);
            if (-1 < (int)uVar4) {
              uVar4 = LdrAddRefDll(1,local_218);
              param_2 = (undefined4 *)((ulonglong)uVar4 >> 0x20);
              if (-1 < (int)uVar4) {
                uVar4 = LdrGetProcedureAddress(local_218,&DAT_6b8800cc,0,&local_224);
                param_2 = (undefined4 *)((ulonglong)uVar4 >> 0x20);
                if (-1 < (int)uVar4) {
                  uVar4 = LdrGetProcedureAddress(local_218,&DAT_6b8800c4,0,&local_228);
                  param_2 = (undefined4 *)((ulonglong)uVar4 >> 0x20);
                  if (-1 < (int)uVar4) {
                    uVar4 = LdrGetProcedureAddress(local_218,&DAT_6b8800bc,0,&local_22c);
                    param_2 = (undefined4 *)((ulonglong)uVar4 >> 0x20);
                    if (-1 < (int)uVar4) {
                      uVar4 = LdrGetProcedureAddress(local_218,&DAT_6b8800b4,0,&local_230);
                      param_2 = (undefined4 *)((ulonglong)uVar4 >> 0x20);
                      if (-1 < (int)uVar4) {
                        uVar4 = LdrGetProcedureAddress(local_218,&DAT_6b8800ac,0,&local_234);
                        param_2 = (undefined4 *)((ulonglong)uVar4 >> 0x20);
                        if (-1 < (int)uVar4) {
                          uVar4 = LdrGetProcedureAddress(local_218,&DAT_6b8800a4,0,&local_238);
                          param_2 = (undefined4 *)((ulonglong)uVar4 >> 0x20);
                          if (-1 < (int)uVar4) {
                            uVar4 = LdrGetProcedureAddress(local_218,&DAT_6b88009c,0,&local_23c);
                            param_2 = (undefined4 *)((ulonglong)uVar4 >> 0x20);
                            if (-1 < (int)uVar4) {
                              iVar2 = RtlEncodeSystemPointer(local_224);
                              LOCK();
                              if (DAT_6b8b0884 != 0) {
                                iVar2 = DAT_6b8b0884;
                              }
                              DAT_6b8b0884 = iVar2;
                              iVar2 = RtlEncodeSystemPointer(local_228);
                              LOCK();
                              if (DAT_6b8b0888 != 0) {
                                iVar2 = DAT_6b8b0888;
                              }
                              DAT_6b8b0888 = iVar2;
                              iVar2 = RtlEncodeSystemPointer(local_22c);
                              LOCK();
                              if (DAT_6b8b088c != 0) {
                                iVar2 = DAT_6b8b088c;
                              }
                              DAT_6b8b088c = iVar2;
                              iVar2 = RtlEncodeSystemPointer(local_230);
                              LOCK();
                              if (DAT_6b8b0890 != 0) {
                                iVar2 = DAT_6b8b0890;
                              }
                              DAT_6b8b0890 = iVar2;
                              iVar2 = RtlEncodeSystemPointer(local_234);
                              LOCK();
                              if (DAT_6b8b0894 != 0) {
                                iVar2 = DAT_6b8b0894;
                              }
                              DAT_6b8b0894 = iVar2;
                              iVar2 = RtlEncodeSystemPointer(local_238);
                              LOCK();
                              if (DAT_6b8b0898 != 0) {
                                iVar2 = DAT_6b8b0898;
                              }
                              DAT_6b8b0898 = iVar2;
                              iVar2 = RtlEncodeSystemPointer(local_23c);
                              param_2 = &DAT_6b8b089c;
                              LOCK();
                              if (DAT_6b8b089c != 0) {
                                iVar2 = DAT_6b8b089c;
                              }
                              DAT_6b8b089c = iVar2;
                              LOCK();
                              if (DAT_6b8b087c == 0) {
                                DAT_6b8b087c = 1;
                              }
                              goto LAB_6b815bb7;
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
    LOCK();
    if (DAT_6b8b087c == 0) {
      DAT_6b8b087c = -1;
    }
  }
LAB_6b815bb7:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



LONG InterlockedExchangeAdd(LONG *Addend,LONG Value)

{
  LONG LVar1;
  
                    // 0x15bd0  881  InterlockedExchangeAdd
  LOCK();
  LVar1 = *Addend;
  *Addend = *Addend + Value;
  return LVar1;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_6b815bf0(ushort *param_1,uint param_2,int *param_3,int param_4,ushort *param_5,int param_6,
                 int *param_7)

{
  ushort uVar1;
  ushort uVar2;
  uint uVar3;
  int iVar4;
  int *extraout_EDX;
  int *piVar5;
  int *extraout_EDX_00;
  int iVar6;
  int *extraout_EDX_01;
  ushort *puVar7;
  int iVar8;
  uint uVar9;
  bool bVar10;
  DWORD dwErrCode;
  undefined auStack212 [4];
  ushort *local_d0;
  ushort *local_cc;
  ushort *local_c8;
  ushort *local_c4;
  int *local_c0;
  int local_bc;
  ushort *local_b8;
  ushort *local_b4;
  undefined4 local_b0;
  ushort *local_ac;
  int *local_a8;
  uint local_a4;
  ushort *local_a0;
  ushort *local_9c;
  undefined4 local_98;
  uint local_94;
  uint local_90;
  uint local_8c;
  uint local_88;
  uint local_84;
  undefined4 local_80;
  undefined4 local_7c;
  undefined4 local_78;
  undefined4 local_74;
  uint local_70;
  uint local_6c;
  int *local_68;
  int *local_64;
  uint local_60;
  int *local_58;
  undefined4 local_54;
  undefined4 local_48;
  ushort *local_44;
  ushort *local_40;
  uint local_3c;
  ushort *local_34;
  undefined4 local_30;
  undefined4 local_24;
  uint local_20;
  undefined4 local_1c;
  undefined4 local_18;
  int local_14;
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)auStack212;
  local_d0 = param_1;
  local_c0 = param_3;
  local_c4 = param_5;
  local_a8 = param_7;
  if ((((param_4 < -1) || (param_3 == (int *)0x0)) || (param_6 < -1)) || (param_5 == (ushort *)0x0))
  {
    dwErrCode = 0x57;
  }
  else {
    if ((param_2 & 0xf00000) == 0) {
      param_2 = param_2 | 0x400000;
    }
    if ((byte)(1U - ((((byte)param_2 & 0xf1) - 1 & (byte)param_2 & 0x11) != 0) &
              ~-(((param_2 & 0xffffffe2) - 1 & param_2 & 0x22) != 0) &
              1U - (((param_2 & 0xfff00000) - 1 & param_2 & 0xf00000) != 0) &
              1U - ((param_2 & 0xf70cffc8) != 0)) != 0) {
      if ((param_4 == -1) && (param_6 == -1)) {
        local_74 = 0;
LAB_6b82a122:
        param_4 = FUN_6b8502c0((short *)param_3);
      }
      else {
        local_74 = 1;
        if (param_4 == -1) goto LAB_6b82a122;
      }
      if (param_6 == -1) {
        param_6 = FUN_6b8502c0((short *)local_c4);
      }
      if ((param_2 & 0x8000000) == 0) {
        local_9c = *(ushort **)(local_d0 + 0x7c);
      }
      else {
        local_9c = *(ushort **)(local_d0 + 0x7a);
      }
      local_a0 = local_d0;
      local_70 = *(byte *)(local_d0 + 0x7e) & 1;
      local_68 = local_c0;
      local_58 = local_c0;
      if (param_4 < 0) {
        local_64 = (int *)0xffffffff;
      }
      else {
        local_64 = (int *)((int)local_c0 + param_4 * 2);
      }
      local_60 = (uint)(param_4 < 0);
      local_44 = local_c4;
      local_34 = local_c4;
      if (param_6 < 0) {
        local_40 = (ushort *)0xffffffff;
      }
      else {
        local_40 = local_c4 + param_6;
      }
      local_3c = (uint)(param_6 < 0);
      local_54 = 0;
      local_b4 = (ushort *)(param_2 & 2);
      local_30 = 0;
      local_90 = (uint)(local_b4 != (ushort *)0x0);
      local_1c = 0;
      local_94 = (param_2 & 0xff) >> 2 & 1;
      local_18 = 0;
      local_88 = (param_2 & 0xff) >> 4 & 1;
      local_48 = 0;
      local_84 = (param_2 & 0xff) >> 5 & 1;
      local_24 = 0;
      local_98 = 0;
      local_80 = 0;
      uVar9 = 0xc4;
      local_7c = 1;
      local_78 = 1;
      uVar3 = 0xffffffff;
      local_c8 = (ushort *)(param_2 & 1);
      local_6c = 0xffffffff;
      local_20 = 0xc4;
      if (local_c8 != (ushort *)0x0) {
        uVar3 = 0xe7ffffff;
        local_6c = 0xe7ffffff;
      }
      if (local_b4 == (ushort *)0x0) {
        uVar9 = 0xf5;
        local_20 = 0xf5;
      }
      else {
        uVar3 = uVar3 & 0xff00ffff;
        local_6c = uVar3;
      }
      if ((param_2 & 0x10000) != 0) {
        uVar3 = uVar3 & 0xdfffffff;
        local_6c = uVar3;
      }
      if (((param_2 & 0x20000) != 0) && (local_6c = uVar3 & 0xfeffffff, local_c8 != (ushort *)0x0))
      {
        local_20 = uVar9 & 0xfffffffb;
      }
      if ((local_9c == (ushort *)0x0) && ((param_2 & 0xf70cffee) == 0)) {
        bVar10 = true;
      }
      else {
        bVar10 = false;
      }
      uVar3 = param_2 & 0xf7fcffc8;
      local_d0 = local_9c;
      local_8c = local_94;
      if (uVar3 == 0x400000) {
        piVar5 = local_58;
        if (bVar10) {
          local_b0 = 0x19;
LAB_6b815e73:
          if ((param_2 & 0x11) != 0) {
            local_b4 = (ushort *)((int)local_40 - (int)local_c4 >> 1);
            local_cc = (ushort *)(-(int)local_68 + (int)local_64 >> 1);
            local_bc = 0;
            local_a4 = 0;
            if (0 < (int)local_cc) {
              local_d0 = (ushort *)((int)local_68 - (int)local_c4);
              local_b8 = local_c4;
              do {
                if ((int)local_b4 <= (int)local_a4) break;
                uVar2 = *(ushort *)((int)local_d0 + (int)local_b8);
                if ((0x7f < uVar2) || (uVar2 == 0)) goto LAB_6b815eda;
                uVar1 = *local_b8;
                local_c8 = (ushort *)(uint)uVar1;
                if ((0x7f < uVar1) || (uVar1 == 0)) goto LAB_6b815eda;
                local_ac = (ushort *)(uint)*(ushort *)((int)local_d0 + (int)local_b8);
                if ((ushort)(uVar2 - 0x61) < 0x1a) {
                  local_ac = (ushort *)((uint)(local_ac + -0x10) & 0xffff);
                }
                if ((ushort)(uVar1 - 0x61) < 0x1a) {
                  uVar1 = uVar1 - 0x20;
                }
                if ((ushort)local_ac != uVar1) goto LAB_6b815ee2;
                local_b8 = local_b8 + 1;
                local_a4 = local_a4 + 1;
              } while ((int)local_a4 < (int)local_cc);
              if (((int)local_a4 < (int)local_cc) &&
                 (0x7f < *(ushort *)((int)local_68 + local_a4 * 2))) goto LAB_6b815f24;
            }
            bVar10 = SBORROW4(local_a4,(int)local_b4);
            iVar6 = local_a4 - (int)local_b4;
            uVar3 = local_a4;
LAB_6b815ea9:
            local_bc = 0;
            if (bVar10 == iVar6 < 0) {
              bVar10 = true;
              goto LAB_6b815ee4;
            }
            if ((0x7f < local_c4[uVar3]) || (local_c4[uVar3] == 0)) goto LAB_6b815f24;
            goto LAB_6b815ee2;
          }
          local_ac = (ushort *)((int)local_40 - (int)local_c4 >> 1);
          local_cc = (ushort *)(-(int)local_68 + (int)local_64 >> 1);
          uVar3 = 0;
          local_bc = 0;
          if ((int)local_cc < 1) {
LAB_6b815ed4:
            bVar10 = SBORROW4(uVar3,(int)local_ac);
            iVar6 = uVar3 - (int)local_ac;
            goto LAB_6b815ea9;
          }
          local_d0 = (ushort *)((int)local_68 - (int)local_c4);
          local_b8 = local_c4;
          do {
            if ((int)local_ac <= (int)uVar3) break;
            if ((0x7f < *(ushort *)((int)local_b8 + (int)local_d0)) ||
               (*(short *)((int)local_b8 + (int)local_d0) == 0)) goto LAB_6b815eda;
            uVar2 = *local_b8;
            local_b4 = (ushort *)(uint)uVar2;
            if ((0x7f < uVar2) || (uVar2 == 0)) goto LAB_6b815eda;
            if (*(ushort *)((int)local_b8 + (int)local_d0) != uVar2) goto LAB_6b815ee2;
            local_b8 = local_b8 + 1;
            uVar3 = uVar3 + 1;
          } while ((int)uVar3 < (int)local_cc);
          if (((int)local_cc <= (int)uVar3) || (*(ushort *)((int)local_68 + uVar3 * 2) < 0x80))
          goto LAB_6b815ed4;
LAB_6b815f24:
          bVar10 = false;
          local_bc = 1;
          goto LAB_6b815ee4;
        }
        goto LAB_6b82a491;
      }
      if (uVar3 != 0x100000) {
        if (uVar3 != 0x200000) {
          if (uVar3 == 0x800000) {
            if (bVar10) {
              local_b0 = 0x19;
LAB_6b82a1e4:
              local_bc = 0;
              local_b8 = (ushort *)0x0;
              puVar7 = (ushort *)((int)local_40 - (int)local_c4 >> 1);
              iVar6 = (int)local_64 - (int)local_c0 >> 1;
              if ((param_2 & 0x11) != 0) {
                local_ac = puVar7;
                if (0 < iVar6) {
                  local_d0 = local_c4 + (int)puVar7 + -1;
                  local_c8 = (ushort *)((int)local_c0 + iVar6 * 2 + -2);
                  do {
                    if ((int)puVar7 <= local_bc) {
                      if ((local_bc < iVar6) &&
                         (0x7f < *(ushort *)((int)local_c0 + (iVar6 - local_bc) * 2 + -2)))
                      goto LAB_6b82a415;
                      break;
                    }
                    uVar2 = *local_c8;
                    uVar1 = *local_d0;
                    local_cc = (ushort *)(uint)uVar1;
                    if (((0x7f < uVar2) || (uVar2 == 0)) || ((0x7f < uVar1 || (uVar1 == 0))))
                    goto LAB_6b82a2d1;
                    local_a4 = (uint)*local_c8;
                    if ((ushort)(uVar2 - 0x61) < 0x1a) {
                      local_a4 = local_a4 - 0x20 & 0xffff;
                    }
                    if ((ushort)(uVar1 - 0x61) < 0x1a) {
                      uVar1 = uVar1 - 0x20;
                    }
                    if ((ushort)local_a4 != uVar1) goto LAB_6b82a2d9;
                    local_c8 = local_c8 + -1;
                    local_bc = local_bc + 1;
                    local_d0 = local_d0 + -1;
                  } while (local_bc < iVar6);
                }
LAB_6b82a3f1:
                if ((int)puVar7 <= local_bc) {
                  bVar10 = true;
                  goto LAB_6b82a424;
                }
                if ((0x7f < local_c4[(int)puVar7 + (-1 - local_bc)]) ||
                   (local_c4[(int)puVar7 + (-1 - local_bc)] == 0)) goto LAB_6b82a415;
                goto LAB_6b82a2d9;
              }
              local_b4 = puVar7;
              if (iVar6 < 1) goto LAB_6b82a3f1;
              local_cc = local_c4 + (int)puVar7 + -1;
              local_c8 = (ushort *)((int)local_c0 + iVar6 * 2 + -2);
              do {
                if ((int)puVar7 <= local_bc) break;
                uVar2 = *local_cc;
                local_d0 = (ushort *)(uint)uVar2;
                if ((((0x7f < *local_c8) || (*local_c8 == 0)) || (0x7f < uVar2)) || (uVar2 == 0))
                goto LAB_6b82a2d1;
                if (*local_c8 != uVar2) goto LAB_6b82a2d9;
                local_bc = local_bc + 1;
                local_c8 = local_c8 + -1;
                local_cc = local_cc + -1;
              } while (local_bc < iVar6);
              if ((iVar6 <= local_bc) ||
                 (*(ushort *)((int)local_c0 + (iVar6 - local_bc) * 2 + -2) < 0x80))
              goto LAB_6b82a3f1;
LAB_6b82a415:
              bVar10 = false;
              local_b8 = (ushort *)&DAT_00000001;
              goto LAB_6b82a424;
            }
            goto LAB_6b82a44a;
          }
          goto LAB_6b82a7bc;
        }
        if (bVar10) {
          iVar8 = 0;
          local_cc = (ushort *)0x0;
          iVar4 = (int)local_64 - (int)local_c0 >> 1;
          if ((param_2 & 0x11) == 0) {
            iVar6 = (int)local_40 - (int)local_c4 >> 1;
            if (0 < iVar4) {
              local_c8 = local_c4 + iVar6 + -1;
              local_b4 = (ushort *)((int)local_c0 + iVar4 * 2 + -2);
              do {
                if (iVar6 <= iVar8) break;
                uVar2 = *local_b4;
                local_d0 = (ushort *)(uint)uVar2;
                uVar1 = *local_c8;
                if ((((0x7f < uVar2) || (uVar2 == 0)) || (0x7f < uVar1)) || (uVar1 == 0))
                goto LAB_6b82a579;
                if (uVar2 != uVar1) goto LAB_6b82a581;
                iVar8 = iVar8 + 1;
                local_c8 = local_c8 + -1;
                local_b4 = local_b4 + -1;
              } while (iVar8 < iVar4);
              if ((iVar8 < iVar4) && (0x7f < *(ushort *)((int)local_c0 + (iVar4 - iVar8) * 2 + -2)))
              goto LAB_6b82a621;
            }
LAB_6b82a606:
            if (iVar6 <= iVar8) {
              bVar10 = true;
              goto LAB_6b82a630;
            }
            if ((local_c4[(iVar6 - iVar8) + -1] < 0x80) && (local_c4[(iVar6 - iVar8) + -1] != 0))
            goto LAB_6b82a581;
          }
          else {
            iVar6 = (int)local_40 - (int)local_c4 >> 1;
            if (iVar4 < 1) goto LAB_6b82a606;
            local_b0 = 0x19;
            local_d0 = local_c4 + iVar6 + -1;
            local_ac = (ushort *)((int)local_c0 + iVar4 * 2 + -2);
            do {
              if (iVar6 <= iVar8) break;
              uVar2 = *local_ac;
              puVar7 = (ushort *)(uint)uVar2;
              if (((0x7f < uVar2) || (uVar2 == 0)) || ((0x7f < *local_d0 || (*local_d0 == 0))))
              goto LAB_6b82a579;
              if ((ushort)(uVar2 - 0x61) < 0x1a) {
                puVar7 = (ushort *)((uint)(puVar7 + -0x10) & 0xffff);
              }
              uVar2 = *local_d0;
              if ((ushort)(uVar2 - 0x61) < 0x1a) {
                uVar2 = uVar2 - 0x20;
              }
              local_b4._0_2_ = (ushort)puVar7;
              local_b4 = puVar7;
              if ((ushort)local_b4 != uVar2) goto LAB_6b82a581;
              iVar8 = iVar8 + 1;
              local_ac = local_ac + -1;
              local_d0 = local_d0 + -1;
            } while (iVar8 < iVar4);
            if ((iVar4 <= iVar8) || (*(ushort *)((int)local_c0 + (iVar4 - iVar8) * 2 + -2) < 0x80))
            goto LAB_6b82a606;
          }
LAB_6b82a621:
          bVar10 = false;
          local_cc = (ushort *)&DAT_00000001;
          goto LAB_6b82a630;
        }
        goto LAB_6b82a471;
      }
      if (bVar10) {
        piVar5 = (int *)((int)local_64 - (int)local_c0 >> 1);
        if ((param_2 & 0x11) == 0) {
          iVar4 = 0;
          local_cc = (ushort *)0x0;
          iVar6 = (int)local_40 - (int)local_c4 >> 1;
          if ((int)piVar5 < 1) {
LAB_6b82a757:
            if (iVar6 <= iVar4) goto LAB_6b82a77c;
            uVar2 = local_c4[iVar4];
LAB_6b82a75f:
            local_cc = (ushort *)0x0;
            if ((uVar2 < 0x80) && (uVar2 != 0)) goto LAB_6b816187;
          }
          else {
            local_d0 = (ushort *)((int)local_c0 - (int)local_c4);
            puVar7 = local_c4;
            do {
              if (iVar6 <= iVar4) break;
              uVar2 = *(ushort *)((int)puVar7 + (int)local_d0);
              local_b4 = (ushort *)(uint)uVar2;
              if (((0x7f < uVar2) || (uVar2 == 0)) ||
                 ((uVar1 = *puVar7, 0x7f < uVar1 || (uVar1 == 0)))) goto LAB_6b81617f;
              if (uVar2 != uVar1) goto LAB_6b816187;
              iVar4 = iVar4 + 1;
              puVar7 = puVar7 + 1;
            } while (iVar4 < (int)piVar5);
            if (((int)piVar5 <= iVar4) ||
               (piVar5 = local_c0, *(ushort *)((int)local_c0 + iVar4 * 2) < 0x80))
            goto LAB_6b82a757;
          }
LAB_6b82a76d:
          bVar10 = false;
          local_cc = (ushort *)&DAT_00000001;
        }
        else {
          iVar4 = 0;
          local_cc = (ushort *)0x0;
          iVar6 = (int)local_40 - (int)local_c4 >> 1;
          if (0 < (int)piVar5) {
            local_d0 = (ushort *)((int)local_c0 - (int)local_c4);
            local_b0 = 0x19;
            local_c8 = local_c4;
            do {
              if (iVar6 <= iVar4) break;
              uVar2 = *(ushort *)((int)local_d0 + (int)local_c8);
              puVar7 = (ushort *)(uint)uVar2;
              if ((((0x7f < uVar2) || (uVar2 == 0)) || (0x7f < *local_c8)) || (*local_c8 == 0))
              goto LAB_6b81617f;
              if ((ushort)(uVar2 - 0x61) < 0x1a) {
                puVar7 = (ushort *)((uint)(puVar7 + -0x10) & 0xffff);
              }
              uVar2 = *local_c8;
              if ((ushort)(uVar2 - 0x61) < 0x1a) {
                uVar2 = uVar2 - 0x20;
              }
              local_b4._0_2_ = (ushort)puVar7;
              local_b4 = puVar7;
              if ((ushort)local_b4 != uVar2) goto LAB_6b816187;
              iVar4 = iVar4 + 1;
              local_c8 = local_c8 + 1;
            } while (iVar4 < (int)piVar5);
            if ((iVar4 < (int)piVar5) && (0x7f < *(ushort *)((int)local_c0 + iVar4 * 2)))
            goto LAB_6b82a76d;
          }
          if (iVar4 < iVar6) {
            uVar2 = local_c4[iVar4];
            goto LAB_6b82a75f;
          }
LAB_6b82a77c:
          local_cc = (ushort *)0x0;
          bVar10 = true;
        }
        goto LAB_6b816189;
      }
      goto LAB_6b82a78f;
    }
LAB_6b82a7bc:
    dwErrCode = 0x3ec;
  }
LAB_6b816107:
  SetLastError(dwErrCode);
  piVar5 = extraout_EDX;
LAB_6b816110:
  FUN_6b8224af(local_c ^ (uint)auStack212,piVar5);
  return;
LAB_6b815eda:
  local_bc = 1;
LAB_6b815ee2:
  bVar10 = false;
LAB_6b815ee4:
  if (bVar10) {
    piVar5 = local_64;
    if (local_a8 != (int *)0x0) {
      *local_a8 = (int)local_40 - (int)local_c4 >> 1;
    }
    goto LAB_6b816110;
  }
  piVar5 = local_68;
  if (local_bc == 1) goto LAB_6b82a491;
  if ((int)local_cc < 2) goto LAB_6b8160fd;
  local_68 = (int *)((int)local_68 + 2);
  goto LAB_6b815e73;
LAB_6b8160fd:
  piVar5 = local_68;
  if (local_bc == 0) goto LAB_6b816105;
LAB_6b82a491:
  local_58 = piVar5;
  iVar6 = 0;
  goto LAB_6b82a792;
LAB_6b82a2d1:
  local_b8 = (ushort *)&DAT_00000001;
LAB_6b82a2d9:
  bVar10 = false;
LAB_6b82a424:
  if (bVar10) {
    if (local_a8 != (int *)0x0) {
      *local_a8 = (int)local_40 - (int)local_c4 >> 1;
    }
    iVar4 = (int)local_64 - (int)local_c0 >> 1;
    iVar6 = (int)local_40 - (int)local_c4 >> 1;
    goto LAB_6b82a63e;
  }
  if (local_b8 == (ushort *)&DAT_00000001) goto LAB_6b82a44a;
  if (iVar6 < 2) goto LAB_6b82a442;
  local_64 = (int *)((int)local_64 + -2);
  goto LAB_6b82a1e4;
LAB_6b82a442:
  if (local_b8 == (ushort *)0x0) goto LAB_6b816105;
LAB_6b82a44a:
  iVar6 = 0;
LAB_6b82a474:
  iVar6 = FUN_6b84c994((int *)&local_a0,iVar6);
  piVar5 = extraout_EDX_00;
  goto LAB_6b82a79b;
LAB_6b82a579:
  local_cc = (ushort *)&DAT_00000001;
LAB_6b82a581:
  bVar10 = false;
LAB_6b82a630:
  if (bVar10) {
    if (local_a8 != (int *)0x0) {
      *local_a8 = iVar6;
    }
LAB_6b82a63e:
    piVar5 = (int *)(iVar4 - iVar6);
    goto LAB_6b816110;
  }
  if (local_cc != (ushort *)0x0) {
LAB_6b82a471:
    iVar6 = 1;
    goto LAB_6b82a474;
  }
LAB_6b816105:
  dwErrCode = 0;
  goto LAB_6b816107;
LAB_6b81617f:
  local_cc = (ushort *)&DAT_00000001;
LAB_6b816187:
  bVar10 = false;
LAB_6b816189:
  if (bVar10) {
    if (local_a8 != (int *)0x0) {
      *local_a8 = iVar6;
    }
    goto LAB_6b816110;
  }
  if (local_cc == (ushort *)0x0) goto LAB_6b816105;
LAB_6b82a78f:
  iVar6 = 1;
LAB_6b82a792:
  local_68 = local_c0;
  iVar6 = FUN_6b84bef1((int *)&local_a0,iVar6);
  piVar5 = extraout_EDX_01;
LAB_6b82a79b:
  if ((iVar6 != -1) && (piVar5 = local_a8, local_a8 != (int *)0x0)) {
    *local_a8 = local_14 - iVar6;
  }
  goto LAB_6b816110;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4
// WARNING: Removing unreachable block (ram,0x6b81ba40)

ATOM GlobalFindAtomA(LPCSTR lpString)

{
  int iVar1;
  undefined4 *in_FS_OFFSET;
  undefined auStack72 [8];
  short asStack64 [4];
  int aiStack56 [2];
  int iStack48;
  short *psStack44;
  ushort auStack40 [2];
  char cStack36;
  undefined uStack32;
  undefined4 uStack20;
  undefined4 uStack12;
  undefined *puStack8;
  
                    // 0x161f0  822  GlobalFindAtomA
  puStack8 = &DAT_6b891a28;
  uStack12 = 0x6b81ba1b;
  uStack32 = 0;
  cStack36 = '\0';
  psStack44 = (short *)0x0;
  if (lpString < (LPCSTR)0x10000) {
    auStack40[0] = (ushort)lpString;
    if (auStack40[0] < 0xc000) goto LAB_6b81baa2;
    iVar1 = -0x3ffffff3;
  }
  else {
    puStack8 = (undefined *)0x0;
    RtlInitAnsiString(auStack72,lpString);
    psStack44 = asStack64;
    iVar1 = RtlAnsiStringToUnicodeString(asStack64,auStack72,1);
    puStack8 = (undefined *)0xfffffffe;
    iStack48 = iVar1;
    if (-1 < iVar1) {
      auStack40[0] = 0;
      puStack8 = (undefined *)0x1;
      if (cStack36 == '\0') {
        if (*psStack44 == 0) {
          RtlSetLastWin32Error(0x7b);
        }
        else {
          iVar1 = NtFindAtom(*(undefined4 *)(psStack44 + 2),*psStack44,auStack40);
LAB_6b81ba92:
          if (iVar1 < 0) goto LAB_6b81bad5;
        }
      }
      else {
        iVar1 = FUN_6b81bb24(aiStack56);
        if (-1 < iVar1) {
          iVar1 = RtlLookupAtomInAtomTable(aiStack56[0],*(undefined4 *)(psStack44 + 2),auStack40);
          goto LAB_6b81ba92;
        }
LAB_6b81bad5:
        BaseSetLastNTError(iVar1);
        auStack40[0] = 0;
      }
      puStack8 = (undefined *)0xfffffffe;
      FUN_6b81bb0a();
      goto LAB_6b81baa2;
    }
  }
  BaseSetLastNTError(iVar1);
  auStack40[0] = 0;
LAB_6b81baa2:
  *in_FS_OFFSET = uStack20;
  return auStack40[0];
}



int CompareStringOrdinal
              (LPCWSTR lpString1,int cchCount1,LPCWSTR lpString2,int cchCount2,BOOL bIgnoreCase)

{
  int iVar1;
  
                    // 0x16210  160  CompareStringOrdinal
                    // WARNING: Could not recover jumptable at 0x6b816216. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = CompareStringOrdinal(lpString1,cchCount1,lpString2,cchCount2,bIgnoreCase);
  return iVar1;
}



HANDLE CreateSemaphoreA(LPSECURITY_ATTRIBUTES lpSemaphoreAttributes,LONG lInitialCount,
                       LONG lMaximumCount,LPCSTR lpName)

{
  HANDLE pvVar1;
  
                    // 0x16230  239  CreateSemaphoreA
  pvVar1 = CreateSemaphoreExA(lpSemaphoreAttributes,lInitialCount,lMaximumCount,lpName,0,0x1f0003);
  return pvVar1;
}



HANDLE CreateSemaphoreExA(LPSECURITY_ATTRIBUTES lpSemaphoreAttributes,LONG lInitialCount,
                         LONG lMaximumCount,LPCSTR lpName,DWORD dwFlags,DWORD dwDesiredAccess)

{
  HANDLE pvVar1;
  int iVar2;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x16260  240  CreateSemaphoreExA
  if (lpName == (LPCSTR)0x0) {
    local_8 = (LPCWSTR)0x0;
  }
  else {
    iVar2 = Basep8BitStringToDynamicUnicodeString(local_c,lpName);
    if (iVar2 == 0) {
      return (HANDLE)0x0;
    }
  }
  pvVar1 = CreateSemaphoreExW(lpSemaphoreAttributes,lInitialCount,lMaximumCount,local_8,dwFlags,
                              dwDesiredAccess);
  if (lpName != (LPCSTR)0x0) {
    RtlFreeUnicodeString(local_c);
  }
  return pvVar1;
}



bool FindActCtxSectionStringWWorker
               (uint param_1,undefined4 param_2,undefined4 param_3,int param_4,uint *param_5)

{
  undefined *puVar1;
  int iVar2;
  undefined local_c [8];
  
                    // 0x162d0  376  FindActCtxSectionStringWWorker
  puVar1 = (undefined *)0x0;
  if (param_4 != 0) {
    RtlInitUnicodeString(local_c,param_4);
    puVar1 = local_c;
  }
  iVar2 = FUN_6b816313(param_1,param_2,param_3,puVar1,param_5);
  return iVar2 != 0;
}



undefined4 __fastcall
FUN_6b816313(uint param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,uint *param_5)

{
  int iVar1;
  undefined4 uVar2;
  uint local_4c;
  undefined4 local_48 [17];
  
  uVar2 = 0;
  local_4c = 0;
  iVar1 = FUN_6b816397(param_1,param_5,&local_4c);
  if (iVar1 != 0) {
    memset(local_48,0,0x40);
    local_48[0] = 0x40;
    iVar1 = RtlFindActivationContextSectionString(local_4c,param_2,param_3,param_4,local_48);
    if (iVar1 < 0) {
      BaseSetLastNTError(iVar1);
    }
    else {
      iVar1 = FUN_6b816414((byte)param_1,(int *)param_5,(int)local_48);
      if (iVar1 != 0) {
        uVar2 = 1;
      }
    }
  }
  return uVar2;
}



undefined4 __fastcall FUN_6b816397(uint param_1,uint *param_2,uint *param_3)

{
  uint *puVar1;
  uint uVar2;
  uint local_c;
  
  local_c = 0;
  uVar2 = 0;
  if (param_3 != (uint *)0x0) {
    *param_3 = 0;
  }
  if ((((param_2 != (uint *)0x0) && (param_3 != (uint *)0x0)) &&
      (local_c = *param_2, 0x23 < local_c)) && ((param_1 & 0xfffffff8) == 0)) {
    puVar1 = (uint *)(local_c + (int)param_2);
    if ((param_1 & 1) != 0) {
      if (puVar1 < param_2 + 9) goto LAB_6b82a7ed;
      uVar2 = 1;
    }
    if ((param_1 & 2) != 0) {
      if (puVar1 < param_2 + 0xb) goto LAB_6b82a7ed;
      uVar2 = uVar2 | 2;
    }
    if ((param_1 & 4) != 0) {
      if (puVar1 < param_2 + 0x10) goto LAB_6b82a7ed;
      uVar2 = uVar2 | 4;
    }
    *param_3 = uVar2;
    return 1;
  }
LAB_6b82a7ed:
  DbgPrintEx(0x33,0,
             "SXS: Invalid parameter(s) passed to FindActCtxSection*()\n   dwFlags = 0x%08lx\n   ReturnedData = %p\n      ->cbSize = %u\n"
             ,param_1,param_2,-(uint)(param_2 != (uint *)0x0) & local_c);
  RtlSetLastWin32Error(0x57);
  return 0;
}



undefined4 __fastcall FUN_6b816414(byte param_1,int *param_2,int param_3)

{
  param_2[1] = *(int *)(param_3 + 4);
  param_2[2] = *(int *)(param_3 + 8);
  param_2[3] = *(int *)(param_3 + 0xc);
  param_2[4] = *(int *)(param_3 + 0x10);
  param_2[5] = *(int *)(param_3 + 0x14);
  param_2[6] = *(int *)(param_3 + 0x18);
  param_2[7] = *(int *)(param_3 + 0x1c);
  param_2[8] = *(int *)(param_3 + 0x20);
  if (param_2 + 10 <= (int *)(*param_2 + (int)param_2)) {
    param_2[9] = *(int *)(param_3 + 0x24);
  }
  if ((param_1 & 2) != 0) {
    param_2[10] = *(int *)(param_3 + 0x28);
  }
  if ((param_1 & 4) != 0) {
    param_2[0xb] = *(int *)(param_3 + 0x2c);
    param_2[0xc] = *(int *)(param_3 + 0x30);
    param_2[0xd] = *(int *)(param_3 + 0x34);
    param_2[0xe] = *(int *)(param_3 + 0x38);
    param_2[0xf] = *(int *)(param_3 + 0x3c);
  }
  return 1;
}



// WARNING: Could not reconcile some variable overlaps

void __fastcall FUN_6b81647d(short *param_1,uint param_2)

{
  bool bVar1;
  byte bVar2;
  code *pcVar3;
  BOOL BVar4;
  uint extraout_EDX;
  uint uVar5;
  int iVar6;
  int iVar7;
  undefined8 uVar8;
  short local_120;
  short local_11e;
  short *local_11c;
  uint local_118;
  undefined *local_114;
  uint local_110;
  undefined local_10c [260];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  uVar5 = param_2;
  if ((((int)param_2 < 0xd) && (param_2 != 0)) && (*param_1 != 0x2e)) {
    local_120 = (short)param_2 * 2;
    bVar1 = false;
    local_114 = local_10c;
    local_118 = 0x1040000;
    local_11e = local_120;
    local_11c = param_1;
    pcVar3 = (code *)GetUnicodeStringToEightBitStringRoutine(&local_118,&local_120,0);
    _guard_check_icall();
    uVar8 = (*pcVar3)();
    uVar5 = (uint)((ulonglong)uVar8 >> 0x20);
    if (-1 < (int)uVar8) {
      iVar6 = 0;
      if ((short)local_118 != 0) {
        iVar7 = param_2 - 1;
        do {
          local_110 = local_110 & 0xffffff00 | (uint)(byte)local_114[iVar6];
          BVar4 = IsDBCSLeadByte(local_114[iVar6]);
          if (BVar4 == 0) {
            bVar2 = (byte)(local_110 & 0xff);
            uVar5 = extraout_EDX;
            if ((0x7f < bVar2) ||
               (uVar5 = (local_110 & 0xff) >> 5,
               (*(uint *)(&DAT_6b885c60 + uVar5 * 4) & 1 << (bVar2 & 0x1f)) != 0)) break;
            if ((char)local_110 == '.') {
              if ((bVar1) || (3 < iVar7)) break;
              bVar1 = true;
            }
            if ((7 < iVar6) && (!bVar1)) break;
          }
          else {
            if (((!bVar1) && (uVar5 = extraout_EDX, 6 < iVar6)) ||
               (uVar5 = extraout_EDX, iVar6 == (local_118 & 0xffff) - 1)) break;
            iVar6 = iVar6 + 1;
            iVar7 = iVar7 + -1;
            uVar5 = extraout_EDX;
          }
          iVar6 = iVar6 + 1;
          iVar7 = iVar7 + -1;
        } while (iVar6 < (int)(local_118 & 0xffff));
      }
    }
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar5);
  return;
}



int __fastcall
FUN_6b8165a1(ushort **param_1,int param_2,ushort **param_3,int param_4,int param_5,int *param_6,
            int *param_7)

{
  int iVar1;
  byte bVar4;
  byte bVar5;
  ushort uVar2;
  uint uVar3;
  int iVar6;
  byte *pbVar7;
  int iVar8;
  ushort *puVar9;
  char *pcVar10;
  ushort *puVar11;
  ushort *puVar12;
  int iStack60;
  int local_20;
  int local_14;
  ushort *local_10;
  
  local_10 = *param_1;
  iStack60 = 2;
  puVar11 = *param_3;
  local_20 = 2;
  local_14 = 2;
LAB_6b8165db:
  do {
    iVar6 = param_2;
    iVar8 = param_4;
    puVar9 = local_10;
    puVar12 = puVar11;
    if ((((param_2 != 0) && (*local_10 < 0x80)) && (param_4 != 0)) &&
       ((*puVar11 < 0x80 && (*local_10 == *puVar11)))) {
      puVar9 = local_10 + 1;
      puVar12 = puVar11 + 1;
      iVar8 = param_4 + -1;
      iVar6 = param_2 + -1;
      if ((((iVar6 != 0) && ((*puVar9 < 0x80 && (iVar8 != 0)))) && (*puVar12 < 0x80)) &&
         (*puVar9 == *puVar12)) {
        puVar9 = local_10 + 2;
        puVar12 = puVar11 + 2;
        iVar8 = param_4 + -2;
        iVar6 = param_2 + -2;
        if ((((iVar6 != 0) && (*puVar9 < 0x80)) && (iVar8 != 0)) &&
           ((*puVar12 < 0x80 && (*puVar9 == *puVar12)))) {
          iVar8 = param_4 + -3;
          puVar9 = local_10 + 3;
          puVar12 = puVar11 + 3;
          iVar6 = param_2 + -3;
          if (((iVar6 != 0) && ((*puVar9 < 0x80 && (iVar8 != 0)))) &&
             ((*puVar12 < 0x80 && (*puVar9 == *puVar12)))) {
            puVar9 = local_10 + 4;
            puVar12 = puVar11 + 4;
            iVar8 = param_4 + -4;
            iVar6 = param_2 + -4;
            if ((((iVar6 != 0) && (*puVar9 < 0x80)) && (iVar8 != 0)) &&
               ((*puVar12 < 0x80 && (*puVar9 == *puVar12)))) {
              puVar9 = local_10 + 5;
              puVar12 = puVar11 + 5;
              iVar8 = param_4 + -5;
              iVar6 = param_2 + -5;
              if (((iVar6 != 0) && ((*puVar9 < 0x80 && (iVar8 != 0)))) &&
                 ((*puVar12 < 0x80 && (*puVar9 == *puVar12)))) {
                puVar9 = local_10 + 6;
                puVar12 = puVar11 + 6;
                iVar8 = param_4 + -6;
                iVar6 = param_2 + -6;
                if ((((iVar6 != 0) && (*puVar9 < 0x80)) && (iVar8 != 0)) &&
                   ((*puVar12 < 0x80 && (*puVar9 == *puVar12)))) {
                  puVar9 = local_10 + 7;
                  puVar12 = puVar11 + 7;
                  iVar8 = param_4 + -7;
                  iVar6 = param_2 + -7;
                  if ((((iVar6 != 0) && ((*puVar9 < 0x80 && (iVar8 != 0)))) && (*puVar12 < 0x80)) &&
                     (*puVar9 == *puVar12)) {
                    local_10 = local_10 + 8;
                    param_2 = param_2 + -8;
                    puVar11 = puVar11 + 8;
                    param_4 = param_4 + -8;
                    goto LAB_6b8165db;
                  }
                }
              }
            }
          }
        }
      }
    }
    if ((0x7f < *puVar9) || (0x7f < *puVar12)) goto LAB_6b8168cf;
    param_2 = iVar6;
    param_4 = iVar8;
    local_10 = puVar9;
    puVar11 = puVar12;
    if (iVar6 == 0) goto LAB_6b816b0d;
    if (iVar8 == 0) goto LAB_6b816940;
    iVar1 = (uint)*puVar9 * 2;
    pbVar7 = &DAT_6b888900 + iVar1;
    bVar5 = *pbVar7;
    uVar3 = (uint)bVar5;
    if (bVar5 == 0) {
LAB_6b81663f:
      if (local_14 == 2) {
        if ((char)uVar3 == '\0') {
          while (local_10 = puVar9, pbVar7[1] == 0) {
            puVar9 = puVar9 + 1;
            iVar6 = iVar6 + -1;
            local_10 = puVar9;
            if (((iVar6 == 0) || (0x7f < *puVar9)) ||
               (pbVar7 = &DAT_6b888900 + (uint)*puVar9 * 2, *pbVar7 != 0)) break;
          }
        }
        pcVar10 = &DAT_6b888900 + (uint)*puVar12 * 2;
        if (*pcVar10 == '\0') {
          while (param_4 = iVar8, pcVar10[1] == '\0') {
            puVar12 = puVar12 + 1;
            iVar8 = iVar8 + -1;
            param_4 = iVar8;
            if (((iVar8 == 0) || (0x7f < *puVar12)) ||
               (pcVar10 = &DAT_6b888900 + (uint)*puVar12 * 2, *pcVar10 != '\0')) break;
          }
        }
        param_2 = iVar6;
        puVar11 = puVar12;
        if (((iVar6 != 0) && (*local_10 < 0x80)) && ((param_4 != 0 && (*puVar12 < 0x80)))) {
          if ((&DAT_6b888900)[(uint)*local_10 * 2] == '\0') {
            uVar2 = (ushort)(byte)(&DAT_6b888901)[(uint)*local_10 * 2] << 8;
          }
          else {
            uVar2 = 0;
          }
          if ((&DAT_6b888900)[(uint)*puVar12 * 2] == '\0') {
            uVar2 = uVar2 | (byte)(&DAT_6b888901)[(uint)*puVar12 * 2];
          }
          bVar5 = (byte)(uVar2 >> 8);
          if (bVar5 != (byte)uVar2) {
            if (bVar5 < (byte)uVar2) {
              local_14 = 1;
              goto LAB_6b816648;
            }
            local_14 = 3;
          }
          if ((local_14 != 2) || (*local_10 != *puVar12)) goto LAB_6b816648;
        }
      }
      else {
LAB_6b816648:
        while ((iVar6 != 0 && ((*local_10 < 0x80 && ((&DAT_6b888900)[(uint)*local_10 * 2] == '\0')))
               )) {
          local_10 = local_10 + 1;
          iVar6 = iVar6 + -1;
        }
        while (((param_2 = iVar6, param_4 != 0 && (*puVar11 < 0x80)) &&
               ((&DAT_6b888900)[(uint)*puVar11 * 2] == '\0'))) {
          puVar11 = puVar11 + 1;
          param_4 = param_4 + -1;
        }
      }
    }
    else {
      uVar3 = (uint)CONCAT11((&DAT_6b888900)[(uint)*puVar12 * 2],bVar5);
      bVar4 = (byte)(uVar3 >> 8);
      if (bVar4 == 0) goto LAB_6b81663f;
      if (bVar5 != bVar4) {
        iStack60 = (-(uint)((byte)(&DAT_6b888900)[(uint)*puVar9 * 2] <
                           (byte)(&DAT_6b888900)[(uint)*puVar12 * 2]) & 0xfffffffe) + 3;
        goto LAB_6b8168cf;
      }
      if ((param_5 != 1) && (local_20 == 2)) {
        local_20 = (-(uint)((byte)(&DAT_6b888901)[iVar1] < (byte)(&DAT_6b888901)[(uint)*puVar12 * 2]
                           ) & 0xfffffffe) + 3;
      }
      local_10 = puVar9 + 1;
      puVar11 = puVar12 + 1;
      param_2 = iVar6 + -1;
      param_4 = iVar8 + -1;
    }
    puVar9 = local_10;
    puVar12 = puVar11;
    if ((0x7f < *local_10) || (0x7f < *puVar11)) goto LAB_6b8168cf;
    if (param_2 == 0) goto LAB_6b816b0d;
    if (param_4 == 0) {
LAB_6b816940:
      while (((param_2 != 0 && (uVar2 = *local_10, uVar2 < 0x80)) &&
             (((&DAT_6b888900)[(uint)uVar2 * 2] == '\0' &&
              ((local_14 != 2 || ((&DAT_6b888901)[(uint)uVar2 * 2] == '\0'))))))) {
        local_10 = local_10 + 1;
        param_2 = param_2 + -1;
      }
LAB_6b816b0d:
      while (((param_4 != 0 &&
              ((uVar2 = *puVar11, uVar2 < 0x80 && ((&DAT_6b888900)[(uint)uVar2 * 2] == '\0')))) &&
             ((local_14 != 2 || ((&DAT_6b888901)[(uint)uVar2 * 2] == '\0'))))) {
        puVar11 = puVar11 + 1;
        param_4 = param_4 + -1;
      }
      puVar9 = local_10;
      puVar12 = puVar11;
      if (param_2 == 0) {
        if (param_4 == 0) {
          iStack60 = local_20;
          if (local_20 == 2) {
            iStack60 = local_14;
          }
        }
        else {
          iStack60 = 1;
        }
      }
      else {
        iStack60 = 3;
      }
LAB_6b8168cf:
      if ((0x7f < *puVar9) || (0x7f < *puVar12)) {
        *param_1 = puVar9;
        *param_3 = puVar12;
        *param_6 = local_20;
        *param_7 = local_14;
        iStack60 = 0;
      }
      return iStack60;
    }
  } while( true );
}



// WARNING: Function: __SEH_prolog4_GS replaced with injection: SEH_prolog4

DWORD GetShortPathNameA(LPCSTR lpszLongPath,LPSTR lpszShortPath,DWORD cchBuffer)

{
  int iVar1;
  DWORD DVar2;
  code *pcVar3;
  int *piVar4;
  LPWSTR lpszShortPath_00;
  DWORD _Size;
  undefined4 *in_FS_OFFSET;
  short local_254 [2];
  LPWSTR local_250;
  DWORD local_24c;
  DWORD local_248;
  ushort local_244 [2];
  void *local_240;
  LPSTR local_23c;
  undefined local_238 [2];
  short local_236;
  LPCWSTR local_234;
  LPWSTR local_230;
  DWORD local_22c;
  WCHAR local_228 [266];
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x16b60  722  GetShortPathNameA
  local_8 = &DAT_6b891a90;
  uStack12 = 0x6b816b6f;
  local_23c = lpszShortPath;
  local_230 = (LPWSTR)0x0;
  if (lpszLongPath == (LPCSTR)0x0) {
    RtlSetLastWin32Error(0x57);
    _Size = 0;
  }
  else {
    local_240 = (void *)0x0;
    local_234 = (LPCWSTR)0x0;
    _Size = 0;
    local_22c = 0;
    local_8 = (undefined *)0x0;
    iVar1 = Basep8BitStringToDynamicUnicodeString(local_238,lpszLongPath);
    if (iVar1 != 0) {
      lpszShortPath_00 = local_228;
      local_230 = lpszShortPath_00;
      DVar2 = GetShortPathNameW(local_234,lpszShortPath_00,0x104);
      local_24c = DVar2;
      local_248 = DVar2;
      if (0x103 < DVar2) {
        piVar4 = (int *)KernelBaseGetGlobalData();
        lpszShortPath_00 =
             (LPWSTR)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),*piVar4 + 0x200000,
                                     local_248 * 2);
        local_230 = lpszShortPath_00;
        if (lpszShortPath_00 == (LPWSTR)0x0) {
          RtlSetLastWin32Error(8);
          DVar2 = 0;
          _Size = local_22c;
        }
        else {
          DVar2 = GetShortPathNameW(local_234,lpszShortPath_00,local_24c);
          _Size = local_22c;
        }
      }
      if (DVar2 != 0) {
        local_254[0] = (short)DVar2 * 2;
        local_236 = local_254[0] + 2;
        local_250 = lpszShortPath_00;
        pcVar3 = (code *)GetUnicodeStringToEightBitStringRoutine(local_244,local_254,1);
        _guard_check_icall();
        iVar1 = (*pcVar3)();
        if (iVar1 < 0) {
          BaseSetLastNTError(iVar1);
          _Size = 0;
          local_22c = _Size;
        }
        else {
          _Size = (DWORD)local_244[0];
          if ((local_23c == (LPSTR)0x0) || (cchBuffer <= _Size)) {
            _Size = _Size + 1;
            local_22c = _Size;
          }
          else {
            local_22c = _Size;
            memmove(local_23c,local_240,_Size);
            local_23c[_Size] = '\0';
          }
        }
      }
    }
    local_8 = (undefined *)0xfffffffe;
    FUN_6b816c8c();
  }
  *in_FS_OFFSET = local_14;
  return _Size;
}



void FUN_6b816c8c(void)

{
  undefined4 unaff_EBX;
  int unaff_EBP;
  int unaff_EDI;
  int in_FS_OFFSET;
  
  if (*(int *)(unaff_EBP + -0x230) != 0) {
    RtlFreeUnicodeString(unaff_EBP + -0x234);
  }
  if (*(int *)(unaff_EBP + -0x23c) != 0) {
    RtlFreeAnsiString(unaff_EBP + -0x240);
  }
  if ((unaff_EDI != 0) && (unaff_EDI != unaff_EBP + -0x224)) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EBX,unaff_EDI);
  }
  return;
}



// WARNING: Function: __SEH_prolog4_GS replaced with injection: SEH_prolog4

DWORD GetShortPathNameW(LPCWSTR lpszLongPath,LPWSTR lpszShortPath,DWORD cchBuffer)

{
  WCHAR WVar1;
  short sVar2;
  LPCWSTR pWVar3;
  DWORD DVar4;
  wchar_t *pwVar5;
  int iVar6;
  int *piVar7;
  LPCWSTR pWVar8;
  HANDLE hFindFile;
  uint uVar9;
  short *psVar10;
  undefined4 *in_FS_OFFSET;
  LPCWSTR local_29c;
  LPCWSTR local_28c;
  LPCWSTR local_288;
  LPCWSTR local_284;
  LPCWSTR local_280;
  DWORD local_27c;
  undefined local_278 [612];
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x16ce0  723  GetShortPathNameW
  local_8 = &DAT_6b891ab0;
  uStack12 = 0x6b816cef;
  local_29c = (LPCWSTR)0x0;
  local_27c = 0;
  if (lpszLongPath == (LPCWSTR)0x0) {
    RtlSetLastWin32Error(0x57);
    uVar9 = 0;
    goto LAB_6b816fbf;
  }
  SetErrorMode(0x8001);
  local_8 = (undefined *)0x0;
  DVar4 = GetFileAttributesW(lpszLongPath);
  if ((DVar4 == 0xffffffff) &&
     ((in_FS_OFFSET[0xc] == 0 || ((*(uint *)(in_FS_OFFSET[0xc] + 0x1d8) & 1) == 0)))) {
    uVar9 = 0;
    local_27c = uVar9;
  }
  else {
    pwVar5 = FUN_6b81e728(lpszLongPath);
    if ((pwVar5 == (wchar_t *)0x0) ||
       ((*pwVar5 == L'\0' || (iVar6 = FUN_6b81e617(pwVar5,&local_288,&local_284,1), iVar6 == 0)))) {
      pWVar8 = lpszLongPath;
      do {
        WVar1 = *pWVar8;
        pWVar8 = pWVar8 + 1;
      } while (WVar1 != L'\0');
      uVar9 = (int)pWVar8 - (int)(lpszLongPath + 1) >> 1;
      if ((uVar9 < cchBuffer) && (lpszShortPath != (LPWSTR)0x0)) {
        pWVar8 = (LPCWSTR)((int)lpszShortPath - (int)lpszLongPath);
        local_29c = lpszLongPath;
        local_27c = uVar9;
LAB_6b816faf:
        if (pWVar8 != (LPCWSTR)0x0) {
          memmove(lpszShortPath,local_29c,uVar9 * 2 + 2);
        }
      }
      else {
LAB_6b82aa09:
        uVar9 = uVar9 + 1;
        local_27c = uVar9;
      }
    }
    else {
      pWVar8 = lpszLongPath;
      do {
        WVar1 = *pWVar8;
        pWVar8 = pWVar8 + 1;
      } while (WVar1 != L'\0');
      uVar9 = ((int)pWVar8 - (int)(lpszLongPath + 1) >> 1) + 1;
      piVar7 = (int *)KernelBaseGetGlobalData();
      pWVar8 = (LPCWSTR)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),*piVar7 + 0x200000
                                        ,uVar9 * 2);
      if (pWVar8 == (LPCWSTR)0x0) {
LAB_6b82a9a6:
        RtlSetLastWin32Error(8);
        uVar9 = local_27c;
      }
      else {
        FUN_6b81709d(pWVar8,uVar9,(int)lpszLongPath,uVar9);
        local_288 = pWVar8 + ((int)local_288 - (int)lpszLongPath >> 1);
        local_284 = pWVar8 + ((int)local_284 - (int)lpszLongPath >> 1);
        local_280 = lpszShortPath;
        pWVar3 = local_280;
        if ((cchBuffer != 0) && (lpszShortPath != (LPWSTR)0x0)) {
          if (lpszShortPath < lpszLongPath) {
LAB_6b816e2b:
            if (lpszShortPath + cchBuffer < lpszLongPath) goto LAB_6b816e38;
          }
          else if (lpszLongPath + uVar9 <= lpszShortPath) {
            if (lpszLongPath <= lpszShortPath) goto LAB_6b816e38;
            goto LAB_6b816e2b;
          }
          piVar7 = (int *)KernelBaseGetGlobalData();
          local_29c = (LPCWSTR)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),
                                               *piVar7 + 0x200000,cchBuffer * 2);
          pWVar3 = local_29c;
          if (local_29c == (LPCWSTR)0x0) goto LAB_6b82a9a6;
        }
LAB_6b816e38:
        local_280 = pWVar3;
        uVar9 = 0;
        local_27c = 0;
        local_28c = pWVar8;
        while( true ) {
          iVar6 = (int)local_288 - (int)local_28c >> 1;
          if (((iVar6 != 0) && (uVar9 = uVar9 + iVar6, local_27c = uVar9, uVar9 < cchBuffer)) &&
             (lpszShortPath != (LPWSTR)0x0)) {
            memmove(local_280,local_28c,iVar6 * 2);
            local_280 = local_280 + iVar6;
          }
          WVar1 = *local_284;
          *local_284 = L'\0';
          hFindFile = FindFirstFileW(pWVar8,(LPWIN32_FIND_DATAW)local_278);
          *local_284 = WVar1;
          if (hFindFile == (HANDLE)0xffffffff) break;
          FindClose(hFindFile);
          psVar10 = (short *)(local_278 + 0x234);
          do {
            sVar2 = *psVar10;
            psVar10 = psVar10 + 1;
          } while (sVar2 != 0);
          iVar6 = (int)psVar10 - (int)(local_278 + 0x236) >> 1;
          if (iVar6 == 0) {
            iVar6 = (int)local_284 - (int)local_288 >> 1;
          }
          else {
            local_288 = (LPCWSTR)(local_278 + 0x234);
          }
          uVar9 = uVar9 + iVar6;
          local_27c = uVar9;
          if ((uVar9 < cchBuffer) && (lpszShortPath != (LPWSTR)0x0)) {
            memmove(local_280,local_288,iVar6 * 2);
            local_280 = local_280 + iVar6;
          }
          local_28c = local_284;
          if ((*local_284 == L'\0') ||
             (iVar6 = FUN_6b81e617(local_284,&local_288,&local_284,1), iVar6 == 0))
          goto LAB_6b816f51;
        }
        local_27c = 0;
        uVar9 = 0;
LAB_6b816f51:
        if (uVar9 != 0) {
          pWVar8 = local_28c;
          do {
            WVar1 = *pWVar8;
            pWVar8 = pWVar8 + 1;
          } while (WVar1 != L'\0');
          iVar6 = (int)pWVar8 - (int)(local_28c + 1) >> 1;
          uVar9 = uVar9 + iVar6;
          if ((cchBuffer <= uVar9) || (lpszShortPath == (LPWSTR)0x0)) goto LAB_6b82aa09;
          local_27c = uVar9;
          memmove(local_280,local_28c,iVar6 * 2 + 2);
          pWVar8 = local_29c;
          goto LAB_6b816faf;
        }
      }
    }
  }
  local_8 = (undefined *)0xfffffffe;
  FUN_6b81705a();
LAB_6b816fbf:
  *in_FS_OFFSET = local_14;
  return uVar9;
}



void FUN_6b81705a(void)

{
  undefined4 unaff_EBX;
  int unaff_EBP;
  int in_FS_OFFSET;
  
  if (*(int *)(unaff_EBP + -0x298) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EBX,
                *(int *)(unaff_EBP + -0x298));
  }
  if (*(int *)(unaff_EBP + -0x294) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EBX,
                *(int *)(unaff_EBP + -0x294));
  }
  SetErrorMode(*(UINT *)(unaff_EBP + -0x2a4));
  return;
}



int __fastcall FUN_6b81709d(short *param_1,uint param_2,int param_3,uint param_4)

{
  int iVar1;
  
  iVar1 = 0;
  if ((param_2 == 0) || (0x7fffffff < param_2)) {
    iVar1 = -0x7ff8ffa9;
  }
  if (iVar1 < 0) {
    if (param_2 == 0) {
      return iVar1;
    }
  }
  else {
    if (param_4 < 0x7fffffff) {
      iVar1 = FUN_6b8170e1(param_1,param_2,param_1,param_3,param_4);
      return iVar1;
    }
    iVar1 = -0x7ff8ffa9;
  }
  *param_1 = 0;
  return iVar1;
}



int __fastcall FUN_6b8170e1(short *param_1,int param_2,undefined4 param_3,int param_4,int param_5)

{
  short sVar1;
  int iVar2;
  
  if (param_2 != 0) {
    iVar2 = param_4 - (int)param_1;
    do {
      if ((param_5 == 0) || (sVar1 = *(short *)(iVar2 + (int)param_1), sVar1 == 0)) break;
      *param_1 = sVar1;
      param_1 = param_1 + 1;
      param_5 = param_5 + -1;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
    if (param_2 != 0) goto LAB_6b817113;
  }
  param_1 = param_1 + -1;
LAB_6b817113:
  *param_1 = 0;
  return (-(uint)(param_2 != 0) & 0x7ff8ff86) + 0x8007007a;
}



int GetTimeFormatW(LCID Locale,DWORD dwFlags,SYSTEMTIME *lpTime,LPCWSTR lpFormat,LPWSTR lpTimeStr,
                  int cchTime)

{
  int iVar1;
  
                    // 0x17140  786  GetTimeFormatW
                    // WARNING: Could not recover jumptable at 0x6b817146. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = GetTimeFormatW(Locale,dwFlags,lpTime,lpFormat,lpTimeStr,cchTime);
  return iVar1;
}



void BasepConstructSxsCreateProcessMessage
               (uint **param_1,uint **param_2,uint **param_3,undefined4 param_4,undefined4 param_5,
               uint param_6,int param_7,byte param_8,uint param_9,uint param_10,int param_11,
               short *param_12,uint param_13,int param_14,uint param_15,uint param_16,uint param_17,
               uint *param_18,uint *param_19,int *param_20)

{
  short sVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  undefined *puVar5;
  undefined4 *puVar6;
  undefined4 *extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar7;
  undefined4 *extraout_EDX_01;
  undefined4 extraout_EDX_02;
  short *psVar8;
  int *piVar9;
  int in_FS_OFFSET;
  undefined8 uVar10;
  undefined uStack308;
  char local_133;
  char local_132;
  char local_131;
  uint *local_130;
  undefined4 local_12c;
  int *local_128;
  short *local_124;
  uint local_120;
  uint **local_11c;
  uint **local_118;
  int local_114;
  undefined4 local_110;
  uint *local_10c;
  int local_108;
  uint *local_104;
  int local_100;
  uint **local_fc;
  uint **local_f8;
  uint local_f4;
  uint local_f0;
  undefined4 local_ec;
  short *local_e8;
  int local_e4;
  undefined4 local_e0;
  uint local_dc;
  int local_d8;
  uint *local_d4;
  undefined4 local_d0;
  uint local_cc;
  undefined *local_c8;
  undefined4 local_c4;
  short *local_c0;
  undefined4 local_bc;
  wchar_t *local_b8;
  uint *local_b4;
  undefined4 local_b0;
  int local_ac;
  undefined4 local_a8;
  undefined4 local_a4;
  uint **local_a0;
  int *local_9c;
  uint **local_98;
  uint **local_94;
  uint **local_90;
  int *local_8c;
  uint *local_88;
  uint *local_84;
  uint local_80;
  uint local_7c;
  undefined4 local_78;
  undefined4 local_74;
  undefined4 *local_70;
  undefined4 local_6c;
  undefined4 local_68;
  undefined4 local_64;
  uint **local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  undefined local_48 [8];
  undefined4 local_40 [7];
  byte local_24;
  uint **local_20;
  uint **local_1c;
  uint **local_18;
  int *local_14;
  int *local_10;
  uint local_c;
  
                    // 0x17160  85  BasepConstructSxsCreateProcessMessage
  local_c = DAT_6b8b0140 ^ (uint)&uStack308;
  local_118 = param_1;
  local_11c = param_2;
  local_fc = param_3;
  local_e0 = param_4;
  local_a4 = param_5;
  local_120 = param_6;
  local_124 = param_12;
  local_d4 = param_18;
  local_128 = param_20;
  local_e4 = 0;
  local_dc = 0;
  local_132 = '\0';
  local_131 = '\0';
  local_133 = '\0';
  local_54 = 0;
  local_50 = 0;
  local_4c = 0;
  local_ec = 0;
  local_e8 = (short *)0x0;
  local_d8 = 0;
  local_104 = (uint *)0x0;
  local_100 = 0;
  local_10c = (uint *)0x0;
  local_108 = 0;
  local_cc = 0;
  local_c8 = (undefined *)0x0;
  memset(param_19,0,400);
  memset(local_128,0,0x40);
  param_19[0x1b] = 0;
  local_40[0] = 0x20;
  iVar2 = NtQueryInformationProcess(local_e0,0,local_40,0x20,0);
  if ((-1 < iVar2) && ((local_24 & 1) != 0)) {
    local_131 = '\x01';
  }
  if (param_12 == (short *)0x0) {
    uVar10 = FUN_6b81ae4e(&local_e4);
    puVar6 = (undefined4 *)((ulonglong)uVar10 >> 0x20);
    if ((int)uVar10 < 0) goto LAB_6b81739d;
    local_120 = param_17;
    local_f0 = param_16;
    local_f4 = param_15;
  }
  else {
    local_fc = &local_104;
    local_f8 = &local_10c;
    psVar8 = param_12;
    do {
      sVar1 = *psVar8;
      psVar8 = psVar8 + 1;
    } while (sVar1 != 0);
    iVar2 = (int)psVar8 - (int)(param_12 + 1) >> 1;
    if (param_12[iVar2 + -1] == 0x5c) goto LAB_6b81739d;
    *param_19 = *param_19 | 0x400;
    iVar4 = FUN_6b83a9ee(local_120,&local_133);
    if (iVar4 < 0) goto LAB_6b81739d;
    if (local_133 != '\0') {
      *param_19 = *param_19 | 0x800;
    }
    local_f4 = 0;
    local_f0 = 0;
    local_120 = 0;
    iVar4 = RtlDosPathNameToNtPathName_U_WithStatus(local_124,&local_ec,0,0);
    if (iVar4 < 0) goto LAB_6b81739d;
    sVar1 = (short)iVar2;
    local_130 = (uint *)((uint)(ushort)(sVar1 * 2 + 0x1a) << 0x10);
    local_104 = local_130;
    local_100 = 0;
    local_130 = (uint *)((uint)(ushort)((short)local_ec + 0x1a) << 0x10);
    local_10c = local_130;
    local_108 = 0;
    uVar3 = FUN_6b83a58d(local_128 + 0xc,2,(int)&local_fc);
    if ((int)uVar3 < 0) goto LAB_6b81739d;
    sVar1 = sVar1 * 2;
    local_c4 = CONCAT22(sVar1,sVar1);
    local_c0 = local_124;
    local_bc = 0x1a0018;
    local_b8 = L"\\Application";
    iVar2 = FUN_6b83aaf4(&local_104,(int)&local_c4);
    if (iVar2 < 0) goto LAB_6b81739d;
    *(undefined2 *)(local_100 + ((uint)local_104 >> 1 & 0x7fff) * 2) = 0;
    local_c4 = local_ec;
    local_c0 = local_e8;
    iVar2 = FUN_6b83aaf4(&local_10c,(int)&local_c4);
    if (iVar2 < 0) goto LAB_6b81739d;
    piVar9 = local_128 + 0xe;
    *(undefined2 *)(local_108 + ((uint)local_10c >> 1 & 0x7fff) * 2) = 0;
    local_11c = &local_104;
    local_118 = &local_10c;
    local_78 = 0x18;
    local_70 = &local_ec;
    local_74 = 0;
    local_6c = 0x40;
    local_68 = 0;
    local_64 = 0;
    uVar10 = NtOpenFile(piVar9,0x120089,&local_78,local_48,5,0x21);
    puVar6 = (undefined4 *)((ulonglong)uVar10 >> 0x20);
    if ((int)uVar10 < 0) goto LAB_6b81739d;
    local_132 = param_7 == 0;
    local_fc = (uint **)*piVar9;
    param_18 = local_d4;
  }
  if (param_11 == 0) {
    if ((local_131 == '\0') &&
       ((((local_e4 != 0 || (param_7 != 0)) || (uVar3 = FUN_6b81afa6(local_fc), uVar3 != 0)) ||
        (puVar6 = extraout_EDX, DAT_7ffe02ec != '\0')))) {
      local_d0 = 0;
      local_b0 = 0;
      sVar1 = *(short *)local_11c;
      local_12c = 0;
      local_98 = local_11c;
      local_94 = local_118;
      local_130 = (uint *)((uint)(ushort)(sVar1 + 0x14) << 0x10);
      local_d4 = local_130;
      local_130 = (uint *)((uint)(ushort)(sVar1 + 0x10) << 0x10);
      local_b4 = local_130;
      local_130 = (uint *)((uint)(ushort)(sVar1 + 2) << 0x10);
      local_114 = (uint)(ushort)(*(short *)local_118 + 0x14) << 0x10;
      local_ac = local_114;
      local_a8 = 0;
      local_114 = (uint)(ushort)(*(short *)local_118 + 0x10) << 0x10;
      local_110 = 0;
      piVar9 = local_128 + 0xc;
      local_90 = &local_d4;
      local_8c = &local_ac;
      local_a0 = &local_b4;
      local_9c = &local_114;
      local_20 = &local_130;
      local_1c = &local_d4;
      local_18 = &local_b4;
      local_14 = &local_ac;
      local_10 = &local_114;
      iVar2 = *piVar9;
      if (iVar2 != 0) {
        *piVar9 = 0;
        local_d8 = iVar2;
      }
      uVar3 = FUN_6b83a58d(piVar9,5,(int)&local_20);
      if ((int)uVar3 < 0) goto LAB_6b81739d;
      local_5c = local_e0;
      local_60 = local_fc;
      local_58 = local_a4;
      if (param_9 != 0) {
        local_80 = param_9;
        local_88 = *local_11c;
        local_84 = local_11c[1];
        local_7c = param_10;
      }
      iVar2 = FUN_6b83a7f9(local_f4,local_f0,local_120,(int *)&local_90,local_128,(int *)&local_98,
                           (int *)&local_60,(int *)&local_a0,local_128 + 6,(uint *)&local_130,
                           param_13,param_14,param_19);
      puVar6 = extraout_EDX_01;
      if (iVar2 < 0) goto LAB_6b81739d;
    }
    else {
      if (param_9 != 0) {
        param_19[8] = param_9;
        param_19[9] = 0;
        param_19[10] = param_10;
      }
      param_19[5] = (uint)*local_118;
      param_19[6] = (uint)local_118[1];
      param_19[3] = (uint)*local_11c;
      param_19[4] = (uint)local_11c[1];
      param_19[2] = (uint)local_fc;
      param_19[0x10] = local_f4;
      param_19[0x11] = local_f0;
      param_19[0x12] = local_120;
      uVar3 = *param_19;
      *param_19 = uVar3 | 0x40;
      if (local_132 != '\0') {
        *param_19 = uVar3 | 0x240;
      }
    }
    if ((local_124 == (short *)0x0) || (local_133 != '\0')) {
      iVar2 = FUN_6b817412(&local_cc,puVar6);
      uVar3 = local_cc;
      puVar5 = local_c8;
      if (iVar2 < 0) goto LAB_6b81739d;
    }
    else {
      uVar3 = 0x60004;
      puVar5 = &DAT_6b8855a0;
    }
    param_19[0x18] = uVar3;
    uVar3 = *param_19;
    param_19[0x19] = (uint)puVar5;
    if (param_7 != 0) {
      uVar3 = uVar3 | 0x80;
      *param_19 = uVar3;
    }
    if ((uVar3 & 1) != 0) {
      *param_18 = *param_18 | 0x2000;
      uVar3 = *param_19;
    }
    if ((param_8 & 1) != 0) {
      uVar3 = uVar3 | 0x10;
      *param_19 = uVar3;
    }
    if ((uVar3 & 0x41) != 0) {
      RtlInitUnicodeString
                (param_19 + 0x1e,L"-----------------------------------------------------------");
      uVar3 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,
                              *(undefined2 *)((int)param_19 + 0x7a));
      local_128[0xd] = uVar3;
      if (uVar3 == 0) goto LAB_6b81739d;
      param_19[0x1f] = uVar3;
    }
  }
  else {
    *param_19 = *param_19 | 0x20;
  }
  if (param_7 == 0) {
    if (((*(byte *)param_19 & 0x41) == 0) && (local_124 == (short *)0x0)) goto LAB_6b82aee4;
  }
  else {
    *param_18 = *param_18 | 0x8000;
LAB_6b82aee4:
    if (local_132 == '\0') {
      iVar2 = FUN_6b865d57((ushort *)local_118,(uint)(local_124 != (short *)0x0),&local_dc);
      if (iVar2 < 0) goto LAB_6b81739d;
      if (local_dc != 0) {
        *param_18 = *param_18 | 0x1000;
      }
    }
  }
  param_19[1] = *param_18;
LAB_6b81739d:
  RtlFreeUnicodeString(&local_ec);
  uVar7 = extraout_EDX_00;
  if (local_d8 != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_d8);
    uVar7 = extraout_EDX_02;
  }
  FUN_6b8224af(local_c ^ (uint)&uStack308,uVar7);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void __fastcall FUN_6b817412(undefined4 *param_1,undefined4 *param_2)

{
  short sVar1;
  undefined2 *puVar2;
  int iVar3;
  undefined4 *extraout_EDX;
  undefined4 *extraout_EDX_00;
  undefined4 *extraout_EDX_01;
  undefined4 *puVar4;
  undefined8 uVar5;
  undefined local_30 [4];
  undefined2 *local_2c;
  char local_25;
  short local_24;
  undefined2 local_22;
  undefined2 *local_20;
  undefined2 *local_1c;
  undefined2 *local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined2 local_c [2];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_25 = '\x01';
  puVar4 = (undefined4 *)&local_24;
  for (iVar3 = 7; iVar3 != 0; iVar3 = iVar3 + -1) {
    *puVar4 = 0;
    puVar4 = puVar4 + 1;
  }
  *param_1 = 0x60004;
  param_1[1] = &DAT_6b8855a0;
  if (DAT_6b8b0874 == (undefined2 *)0x0) {
    local_20 = local_c;
    local_c[0] = 0;
    local_24 = 0;
    local_14 = 2;
    local_10 = 2;
    local_22 = 2;
    local_1c = local_20;
    local_18 = local_20;
    uVar5 = RtlpEnsureBufferSize(0,&local_1c,0x82);
    param_2 = (undefined4 *)((ulonglong)uVar5 >> 0x20);
    if (-1 < (int)uVar5) {
      local_20 = local_1c;
      local_22 = (undefined2)local_14;
      iVar3 = FUN_6b81af26(0x10008,&local_24);
      param_2 = extraout_EDX;
      if (-1 < iVar3) {
        param_2 = &DAT_6b8b0874;
        LOCK();
        puVar2 = DAT_6b8b0874;
        if (DAT_6b8b0874 == (undefined2 *)0x0) {
          DAT_6b8b0874 = local_20;
          puVar2 = (undefined2 *)0x0;
        }
        if (puVar2 == (undefined2 *)0x0) {
          DAT_6b8b0858 = local_24;
          local_25 = '\0';
        }
        goto LAB_6b8174d0;
      }
    }
  }
  else {
LAB_6b8174d0:
    sVar1 = DAT_6b8b0858;
    if (DAT_6b8b0858 == 0) {
      iVar3 = FUN_6b83a9be();
      sVar1 = (short)iVar3;
      param_2 = extraout_EDX_00;
    }
    param_1[1] = DAT_6b8b0874;
    *(short *)param_1 = sVar1;
    *(short *)((int)param_1 + 2) = sVar1;
    if (local_25 == '\0') goto LAB_6b8174ed;
  }
  if ((local_1c != (undefined2 *)0x0) && (local_1c != local_18)) {
    local_2c = local_1c;
    RtlFreeUnicodeString(local_30);
    param_2 = extraout_EDX_01;
  }
  if (local_18 != (undefined2 *)0x0) {
    *local_18 = 0;
  }
LAB_6b8174ed:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



LANGID GetThreadUILanguage(void)

{
  LANGID LVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b817530. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x17530  780  GetThreadUILanguage
  LVar1 = GetThreadUILanguage();
  return LVar1;
}



void __fastcall
BasepCheckWinSaferRestrictions
          (undefined4 param_1,undefined4 param_2,int param_3,short *param_4,undefined4 param_5,
          ushort *param_6)

{
  bool bVar1;
  code *pcVar2;
  char cVar3;
  undefined4 *puVar4;
  int iVar5;
  void *pvVar6;
  DWORD DVar7;
  undefined4 extraout_EDX;
  int iVar8;
  int in_FS_OFFSET;
  undefined4 uVar9;
  undefined4 *puVar10;
  wchar_t *pwVar11;
  undefined4 uVar12;
  undefined auStack692 [4];
  int local_2b0;
  void *local_2ac;
  int local_2a8;
  int local_2a4;
  undefined4 local_2a0;
  undefined4 local_29c;
  short *local_298;
  undefined4 uStack660;
  undefined2 local_290;
  short local_28e;
  int local_28c;
  undefined4 local_288;
  undefined local_284 [4];
  int local_280;
  undefined4 local_27c;
  undefined4 local_278;
  undefined4 local_274;
  short local_270 [4];
  undefined4 local_268;
  undefined4 local_264;
  undefined2 *local_260;
  undefined4 local_25c;
  undefined4 local_258;
  undefined4 local_254;
  undefined local_250 [4];
  undefined local_24c [4];
  undefined4 local_248;
  uint local_244;
  short *local_240;
  undefined4 local_23c;
  undefined4 local_1dc;
  void *local_1d8;
  undefined local_1b8 [4];
  int local_1b4;
  int local_1b0;
  int local_1ac;
  undefined local_168 [128];
  undefined local_e8 [4];
  int local_e4;
  int local_e0;
  int local_dc;
  undefined4 local_98 [35];
  uint local_c;
  
                    // 0x17540  84  BasepCheckWinSaferRestrictions
  local_c = DAT_6b8b0140 ^ (uint)auStack692;
  local_274 = param_5;
  local_280 = param_3;
  bVar1 = false;
  local_298 = param_4;
  local_2ac = (void *)0x0;
  local_2a4 = 0;
  local_2b0 = 0;
  if ((param_4 == (short *)0x0) || (*param_4 == 0)) goto LAB_6b8178cd;
  if ((param_6 != (ushort *)0x0) &&
     ((*param_6 != 0 && (*(int *)(*(int *)(in_FS_OFFSET + 0x18) + 0xf9c) != 0)))) {
    bVar1 = true;
  }
  if ((DAT_6b8b0158 == -2) && (!bVar1)) goto LAB_6b8178cd;
  RtlAcquireSRWLockExclusive(&DAT_6b8b0870);
  if ((DAT_6b8b0158 == 0) || ((DAT_6b8b0158 == -2 && (!bVar1)))) goto LAB_6b8178c0;
  if (param_3 == 0) {
    if (*(int *)(*(int *)(in_FS_OFFSET + 0x18) + 0xf9c) == 0) {
      iVar8 = -0x3fffff84;
    }
    else {
      iVar8 = NtOpenThreadToken(0xfffffffe,0x2000000,1,&local_2b0);
    }
    if (iVar8 == -0x3fffff84) {
      local_2b0 = 0;
LAB_6b817600:
      iVar8 = NtOpenProcessToken(0xffffffff,10,&local_2a4);
      if (iVar8 == -0x3fffffde) {
        iVar8 = NtOpenProcessToken(0xffffffff,8,&local_2a4);
      }
      if (iVar8 < 0) {
        local_2a4 = 0;
      }
      if (local_2b0 != 0) {
        iVar5 = NtSetInformationThread(0xfffffffe,5,&local_2b0,4);
        NtClose(local_2b0);
        local_2b0 = 0;
        pvVar6 = local_2ac;
        if (-1 < iVar5) goto LAB_6b81762f;
        goto LAB_6b8178a7;
      }
LAB_6b81762f:
      if (-1 < iVar8) {
        local_280 = local_2a4;
        param_3 = local_2a4;
        goto LAB_6b817644;
      }
      if (DAT_6b8b0158 == -1) {
        DAT_6b8b0158 = -2;
      }
    }
    else if (-1 < iVar8) {
      local_27c = 0;
      iVar8 = NtSetInformationThread(0xfffffffe,5,&local_27c,4);
      if (-1 < iVar8) goto LAB_6b817600;
      NtClose(local_2b0);
      local_2b0 = 0;
    }
  }
  else {
LAB_6b817644:
    if ((DAT_6b8b0158 == -1) || (DAT_6b8b0158 == -2)) {
      iVar8 = NtQueryInformationToken(param_3,1,local_98,0x88,local_250);
      if (iVar8 < 0) {
LAB_6b81771e:
        iVar8 = NtOpenKey(&local_288,3,&DAT_6b880104);
        if (iVar8 < 0) {
LAB_6b817738:
          bVar1 = false;
          iVar8 = NtOpenKey(&local_2a0,1,&DAT_6b8800ec);
          if (-1 < iVar8) {
            iVar8 = NtQueryValueKey(local_2a0,&DAT_6b8800e4,2,local_1b8,0x50,local_284);
            if (((-1 < iVar8) && (local_1b4 == 4)) && ((local_1b0 == 4 && (local_1ac != 0)))) {
              bVar1 = true;
            }
            iVar8 = NtQueryValueKey(local_2a0,&DAT_6b8800dc,2,local_1b8,0x50,local_284);
            if (((-1 < iVar8) && (local_1ac != 0)) && ((local_1b4 == 4 && (local_1b0 == 4)))) {
              DAT_6b8b0928 = 8;
            }
            NtClose(local_2a0);
            if (!bVar1) goto LAB_6b8177bd;
LAB_6b82b180:
            local_278 = 0x1000;
            iVar8 = LdrLoadDll(0,&local_278,&DAT_6b880784,&local_2a8);
            if (iVar8 < 0) {
              DAT_6b8b0158 = 0;
              pvVar6 = local_2ac;
            }
            else {
              iVar8 = LdrGetProcedureAddress(local_2a8,&DAT_6b88077c,0,&DAT_6b8b0a38);
              if ((((-1 < iVar8) && (DAT_6b8b0a38 != (code *)0x0)) &&
                  ((iVar8 = LdrGetProcedureAddress(local_2a8,&DAT_6b880774,0,&DAT_6b8b0a3c),
                   -1 < iVar8 &&
                   ((DAT_6b8b0a3c != (code *)0x0 &&
                    (iVar8 = LdrGetProcedureAddress(local_2a8,&DAT_6b88076c,0,&DAT_6b8b0a40),
                    -1 < iVar8)))))) &&
                 ((DAT_6b8b0a40 != (code *)0x0 &&
                  ((iVar8 = LdrGetProcedureAddress(local_2a8,&DAT_6b880764,0,&DAT_6b8b0a44),
                   -1 < iVar8 && (DAT_6b8b0a44 != (code *)0x0)))))) {
                DAT_6b8b0158 = local_2a8;
                goto LAB_6b82b262;
              }
              LdrUnloadDll(local_2a8);
              DAT_6b8b0158 = 0;
              pvVar6 = local_2ac;
            }
            goto LAB_6b8178a7;
          }
LAB_6b8177bd:
          iVar8 = RtlFormatCurrentUserKeyPath(local_270);
          if (-1 < iVar8) {
            local_290 = 0;
            local_28e = local_270[0] + 0x78;
            puVar4 = (undefined4 *)KernelBaseGetGlobalData();
            local_28c = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                                        *puVar4,local_28e);
            if (local_28c != 0) {
              iVar8 = RtlAppendUnicodeStringToString(&local_290,local_270);
              if ((-1 < iVar8) &&
                 (iVar8 = RtlAppendUnicodeToString
                                    (&local_290,
                                     L"\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers"
                                    ), -1 < iVar8)) {
                local_260 = &local_290;
                local_268 = 0x18;
                local_264 = 0;
                local_25c = 0x40;
                local_258 = 0;
                local_254 = 0;
                iVar8 = NtOpenKey(&local_2a0,1,&local_268);
                if (((-1 < iVar8) &&
                    (((iVar8 = NtQueryValueKey(local_2a0,&DAT_6b8800e4,2,local_1b8,0x50,local_284),
                      -1 < iVar8 && (local_1b4 == 4)) && (local_1b0 == 4)))) && (local_1ac != 0)) {
                  bVar1 = true;
                }
              }
              RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_28c);
            }
            RtlFreeUnicodeString(local_270);
            if (bVar1) goto LAB_6b82b180;
          }
        }
        else {
          iVar8 = NtQueryValueKey(local_288,&DAT_6b88078c,2,local_e8,0x50,local_24c);
          NtClose(local_288);
          if ((((iVar8 < 0) || (local_e4 != 4)) || (local_e0 != 4)) || (local_dc == 0))
          goto LAB_6b817738;
        }
        DAT_6b8b0158 = -2;
      }
      else {
        RtlInitializeSid(local_168,&DAT_6b8845e8,1);
        puVar4 = (undefined4 *)RtlSubAuthoritySid(local_168,0);
        *puVar4 = 0x12;
        cVar3 = RtlEqualSid(local_98[0],local_168);
        if (cVar3 == '\0') {
          puVar4 = (undefined4 *)RtlSubAuthoritySid(local_168,0);
          *puVar4 = 0x13;
          cVar3 = RtlEqualSid(local_98[0],local_168);
          if (cVar3 == '\0') {
            puVar4 = (undefined4 *)RtlSubAuthoritySid(local_168,0);
            *puVar4 = 0x14;
            cVar3 = RtlEqualSid(local_98[0],local_168);
            if (cVar3 == '\0') goto LAB_6b81771e;
          }
        }
      }
      pvVar6 = (void *)0x0;
    }
    else {
LAB_6b82b262:
      memset(&local_248,0,0x90);
      local_248 = 0x90;
      local_240 = local_298;
      local_1dc = 2;
      if ((param_6 == (ushort *)0x0) || (*param_6 == 0)) {
        local_244 = DAT_6b8b0928 | 5;
        local_23c = local_274;
      }
      else {
        pvVar6 = (void *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,
                                         *param_6 + 2);
        local_2ac = pvVar6;
        if (pvVar6 == (void *)0x0) goto LAB_6b8178a7;
        memcpy(pvVar6,*(void **)(param_6 + 2),(uint)*param_6);
        *(undefined2 *)((int)pvVar6 + (uint)(*param_6 >> 1) * 2) = 0;
        local_244 = 0x21;
        local_23c = 0;
        local_1d8 = pvVar6;
      }
      pcVar2 = DAT_6b8b0a38;
      puVar4 = &local_29c;
      pwVar11 = L"IGNORESRPV2";
      puVar10 = &local_248;
      uVar9 = 1;
      _guard_check_icall();
      iVar8 = (*pcVar2)(uVar9,puVar10,puVar4,pwVar11);
      pcVar2 = DAT_6b8b0a40;
      pvVar6 = local_2ac;
      if (iVar8 != 0) {
        puVar4 = &uStack660;
        uStack660 = 0;
        uVar12 = 0;
        uVar9 = 1;
        iVar8 = local_280;
        _guard_check_icall();
        iVar8 = (*pcVar2)(local_29c,iVar8,puVar4,uVar9,uVar12);
        pcVar2 = DAT_6b8b0a44;
        if (iVar8 == 0) {
          DVar7 = GetLastError();
          pcVar2 = DAT_6b8b0a44;
          if ((DVar7 == 0x4ec) || (DVar7 == 0x312)) {
            uVar9 = 0;
            iVar8 = local_2b0;
            pvVar6 = local_2ac;
            _guard_check_icall();
            (*pcVar2)(iVar8,pvVar6,uVar9);
          }
        }
        else if (local_2a8 != 0) {
          uVar9 = 0;
          iVar8 = local_2b0;
          pvVar6 = local_2ac;
          _guard_check_icall();
          (*pcVar2)(iVar8,pvVar6,uVar9);
          NtClose(local_2a8);
        }
        pcVar2 = DAT_6b8b0a3c;
        iVar8 = local_2b0;
        _guard_check_icall();
        (*pcVar2)(iVar8);
        pvVar6 = local_2ac;
      }
    }
LAB_6b8178a7:
    if (local_2a4 != 0) {
      NtClose(local_2a4);
    }
    if (pvVar6 != (void *)0x0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pvVar6);
    }
  }
LAB_6b8178c0:
  RtlReleaseSRWLockExclusive(&DAT_6b8b0870);
  param_2 = extraout_EDX;
LAB_6b8178cd:
  FUN_6b8224af(local_c ^ (uint)auStack692,param_2);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint __thiscall QuirkIsEnabled3Worker(undefined4 this,wchar_t *param_2,uint param_3)

{
  int iVar1;
  wchar_t *pwVar2;
  uint uVar3;
  HANDLE pvVar4;
  undefined4 extraout_ECX;
  uint uVar5;
  uint uVar6;
  int in_FS_OFFSET;
  bool bVar7;
  short *psVar8;
  short *psVar9;
  uint local_8;
  
                    // 0x17900  1119  QuirkIsEnabled3Worker
  uVar5 = 0;
  iVar1 = *(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x1e8);
  if ((((param_2 != (wchar_t *)0x0) &&
       ((param_3 != 0xffffffff || ((iVar1 != 0 && ((*(uint *)(iVar1 + 0x2d8) & 0x400) != 0)))))) &&
      ((DAT_6b8b08ac != 0 || (iVar1 = FUN_6b81fd2a(), this = extraout_ECX, -1 < iVar1)))) &&
     (pwVar2 = FUN_6b8422a7(this,param_2), pwVar2 != (wchar_t *)0x0)) {
    if (param_3 == 0xffffffff) {
      uVar6 = 0xffffffff;
      local_8 = 0xffffffff;
    }
    else {
      local_8 = (param_3 >> 0x18) << 0x10 | ((param_3 & 0xff0000) << 8) >> 0x18;
      uVar6 = (param_3 & 0xff00) << 8 | param_3 & 0xff;
    }
    FUN_6b81fceb(*(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x1e8));
    uVar5 = 1;
    uVar3 = _allshl();
    if ((uVar3 & *(uint *)(pwVar2 + 0x86)) == 0) {
      uVar5 = 0;
    }
    else {
      if (DAT_6b8b0238 == -1) {
        if (((*(uint *)(pwVar2 + 0x114) & 1) == 0) &&
           ((((*(uint *)(pwVar2 + 0x114) & 2) != 0 ||
             (bVar7 = *(uint *)(pwVar2 + 0x84) <= local_8,
             bVar7 && local_8 != *(uint *)(pwVar2 + 0x84))) ||
            ((bVar7 && (*(uint *)(pwVar2 + 0x82) <= uVar6)))))) {
          uVar5 = 0;
        }
      }
      else {
        uVar5 = (uint)(DAT_6b8b0238 != 0);
      }
      if ((uVar5 != 0) && (((byte)*(uint *)(pwVar2 + 0x114) & 0xc) == 4)) {
        *(uint *)(pwVar2 + 0x114) = *(uint *)(pwVar2 + 0x114) | 8;
      }
    }
    if (_DAT_6b8b0860 != 0) {
      psVar9 = (short *)0x0;
      psVar8 = (short *)0x0;
      pvVar4 = GetCurrentProcess();
      FUN_6b8417db(pwVar2,uVar5,pvVar4,psVar8,psVar9);
    }
  }
  return uVar5;
}



void Process32Next(undefined4 param_1,uint *param_2)

{
  undefined4 extraout_EDX;
  undefined4 uVar1;
  undefined4 extraout_EDX_00;
  int local_234;
  uint local_230;
  uint local_22c;
  uint local_228;
  uint local_224;
  uint local_220;
  uint local_21c;
  uint local_218;
  uint local_214;
  WCHAR local_210 [260];
  uint local_8;
  
                    // 0x17950  1073  Process32Next
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  if ((param_2 == (uint *)0x0) || (*param_2 < 0x128)) {
    BaseSetLastNTError(0xc0000004);
    uVar1 = extraout_EDX_00;
  }
  else {
    local_234 = 0x22c;
    Process32NextW(param_1,&local_234);
    WideCharToMultiByte(0,0x400,local_210,-1,(LPSTR)(param_2 + 9),0x104,(LPCSTR)0x0,(LPBOOL)0x0);
    param_2[1] = local_230;
    param_2[2] = local_22c;
    param_2[3] = local_228;
    param_2[4] = local_224;
    param_2[5] = local_220;
    param_2[6] = local_21c;
    param_2[7] = local_218;
    param_2[8] = local_214;
    uVar1 = extraout_EDX;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar1);
  return;
}



// WARNING: Removing unreachable block (ram,0x6b8268c1)
// WARNING: Removing unreachable block (ram,0x6b8268df)
// WARNING: Removing unreachable block (ram,0x6b8268a0)
// WARNING: Removing unreachable block (ram,0x6b8268ad)
// WARNING: Removing unreachable block (ram,0x6b81b674)
// WARNING: Removing unreachable block (ram,0x6b8268e7)
// WARNING: Removing unreachable block (ram,0x6b81b69e)
// WARNING: Removing unreachable block (ram,0x6b81b6b7)
// WARNING: Removing unreachable block (ram,0x6b81b728)

UINT GetAtomNameW(ATOM nAtom,LPWSTR lpBuffer,int nSize)

{
  uint uVar1;
  int iVar2;
  UINT UVar3;
  undefined2 in_stack_00000006;
  short local_2c;
  short local_2a;
  LPWSTR local_28;
  ushort local_24;
  undefined2 local_22;
  LPWSTR local_20;
  int local_1c;
  LPWSTR local_18;
  uint local_14;
  uint local_10;
  undefined4 local_c;
  char local_5;
  
                    // 0x17a20  451  GetAtomNameW
  local_5 = '\x01';
  local_c = 0;
  UVar3 = 0;
  local_10 = 0;
  local_14 = nSize;
  if (nSize == 0) {
    iVar2 = -0x7ffffffb;
  }
  else {
    local_10 = nSize * 2;
    local_18 = lpBuffer;
    iVar2 = FUN_6b81bb24(&local_1c);
    if ((-1 < iVar2) &&
       (iVar2 = RtlQueryAtomInAtomTable(local_1c,_nAtom,0,0,local_18,&local_10), uVar1 = local_10,
       -1 < iVar2)) {
      if (local_5 == '\0') {
        local_28 = local_18;
        local_2c = (short)local_10;
        local_2a = local_2c + 2;
        local_20 = lpBuffer;
        local_24 = 0;
        local_22 = (undefined2)local_14;
        iVar2 = RtlUnicodeStringToAnsiString(&local_24,&local_2c,0);
        if (-1 < iVar2) {
          UVar3 = (UINT)local_24;
        }
      }
      else {
        UVar3 = local_10 >> 1;
        if (local_18 != lpBuffer) {
          memmove(lpBuffer,local_18,local_10);
        }
        if (UVar3 < local_14) {
          *(undefined2 *)((int)lpBuffer + (uVar1 & 0xfffffffe)) = 0;
        }
      }
    }
    if (-1 < iVar2) {
      return UVar3;
    }
  }
  BaseSetLastNTError(iVar2);
  return 0;
}



BOOL RegisterWaitForSingleObject
               (PHANDLE phNewWaitObject,HANDLE hObject,WAITORTIMERCALLBACK Callback,PVOID Context,
               ULONG dwMilliseconds,ULONG dwFlags)

{
  int iVar1;
  int in_FS_OFFSET;
  
                    // 0x17a40  1197  RegisterWaitForSingleObject
  *phNewWaitObject = (HANDLE)0x0;
  if (hObject == (HANDLE)0xfffffff4) {
    hObject = *(HANDLE *)(*(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x10) + 0x20);
  }
  else if (hObject == (HANDLE)0xfffffff5) {
    hObject = *(HANDLE *)(*(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x10) + 0x1c);
  }
  else if (hObject == (HANDLE)0xfffffff6) {
    hObject = *(HANDLE *)(*(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x10) + 0x18);
  }
  iVar1 = RtlRegisterWait(phNewWaitObject,hObject,Callback,Context,dwMilliseconds,dwFlags);
  if (iVar1 < 0) {
    BaseSetLastNTError(iVar1);
  }
  return (uint)(iVar1 >= 0);
}



undefined4
QueryActCtxWWorker(uint param_1,undefined4 param_2,int param_3,uint param_4,int param_5,int param_6,
                  undefined4 *param_7)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  
                    // 0x17aa0  1094  QueryActCtxWWorker
  uVar3 = 0;
  if (param_7 != (undefined4 *)0x0) {
    *param_7 = 0;
  }
  uVar1 = param_1 & 3;
  if (uVar1 == 1) {
    param_1 = param_1 | 4;
  }
  else if (uVar1 == 2) {
    param_1 = param_1 | 8;
  }
  else if (uVar1 == 3) {
    param_1 = param_1 | 0x10;
  }
  if ((param_1 & 0x7fffffe0) != 0) {
    BaseSetLastNTError(0xc00000ef);
    return 0;
  }
  if (param_4 == 0) {
LAB_6b817b8c:
    iVar2 = -0x3fffff10;
    goto LAB_6b817b51;
  }
  if (2 < param_4) {
    if (param_4 < 5) {
      if (param_3 == 0) {
LAB_6b817b7e:
        iVar2 = -0x3fffff0f;
        goto LAB_6b817b51;
      }
    }
    else {
      if (6 < param_4) goto LAB_6b817b8c;
      if (param_3 != 0) goto LAB_6b817b7e;
    }
  }
  if (param_5 == 0) {
    if (param_6 != 0) {
      iVar2 = -0x3fffff0e;
      goto LAB_6b817b51;
    }
    if (param_7 == (undefined4 *)0x0) {
      iVar2 = -0x3fffff0d;
      goto LAB_6b817b51;
    }
  }
  uVar1 = param_1 & 0x1c;
  if (uVar1 != 0) {
    if (uVar1 == 0x10) {
      uVar3 = 4;
    }
    else if (uVar1 == 8) {
      uVar3 = 2;
    }
    else {
      if (uVar1 != 4) {
        iVar2 = -0x3fffff11;
        goto LAB_6b817b51;
      }
      uVar3 = 1;
    }
  }
  if ((int)param_1 < 0) {
    uVar3 = uVar3 | 0x80000000;
  }
  iVar2 = RtlQueryInformationActivationContext
                    (uVar3,param_2,param_3,param_4,param_5,param_6,param_7);
  if (-1 < iVar2) {
    return 1;
  }
LAB_6b817b51:
  BaseSetLastNTError(iVar2);
  return 0;
}



uint FUN_6b817ba0(int param_1,uint param_2,short *param_3,uint param_4,int param_5,int param_6)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  short *psVar4;
  DWORD dwErrCode;
  
  if ((((param_4 != 0) && (-1 < param_6)) && (param_3 != (short *)0x0)) &&
     ((param_6 == 0 || (param_5 != 0)))) {
    if ((int)param_4 < 0) {
      iVar1 = FUN_6b8502c0(param_3);
      param_4 = iVar1 + 1;
    }
    if (param_1 != 0) {
      uVar3 = param_2 & 0xfeffffff;
      if (uVar3 == 0x200) {
        if ((param_2 & 0x1000000) == 0) {
          iVar1 = *(int *)(param_1 + 0xec);
        }
        else {
          iVar1 = *(int *)(param_1 + 0xe4);
        }
        psVar4 = (short *)&DAT_6b8845f0;
LAB_6b817c01:
        uVar3 = FUN_6b817c23((int)param_3,param_4,param_5,param_6,iVar1,psVar4);
        return uVar3;
      }
      if (uVar3 == 0x100) {
        if ((param_2 & 0x1000000) == 0) {
          iVar1 = *(int *)(param_1 + 0xf0);
        }
        else {
          iVar1 = *(int *)(param_1 + 0xe8);
        }
        psVar4 = (short *)&DAT_6b8888e8;
        goto LAB_6b817c01;
      }
      if (uVar3 == 0x300) {
        if ((param_2 & 0x1000000) == 0) {
          iVar1 = *(int *)(param_1 + 0xf0);
          iVar2 = *(int *)(param_1 + 0xec);
        }
        else {
          iVar1 = *(int *)(param_1 + 0xe8);
          iVar2 = *(int *)(param_1 + 0xe4);
        }
        uVar3 = FUN_6b84e25e((int)param_3,param_4,param_5,param_6,iVar2,iVar1);
        return uVar3;
      }
      dwErrCode = 0x3ec;
      goto LAB_6b82b622;
    }
  }
  dwErrCode = 0x57;
LAB_6b82b622:
  SetLastError(dwErrCode);
  return 0;
}



int __fastcall
FUN_6b817c23(int param_1,int param_2,int param_3,int param_4,int param_5,short *param_6)

{
  byte bVar1;
  ushort uVar2;
  int iVar3;
  int local_8;
  
  iVar3 = param_2;
  if (param_4 != 0) {
    if (param_4 < param_2) {
      local_8 = param_1;
      SetLastError(0x7a);
      iVar3 = 0;
    }
    else {
      iVar3 = 0;
      local_8 = 0;
      if (0 < param_2) {
        do {
          uVar2 = *(ushort *)(param_1 + local_8 * 2);
          if (uVar2 == 0xd801) {
            FUN_6b84e496(param_6,param_1,param_2,&local_8,param_3);
          }
          else {
            bVar1 = *(byte *)(param_1 + local_8 * 2);
            *(short *)(param_3 + local_8 * 2) =
                 *(short *)(param_5 +
                           ((uint)*(ushort *)
                                   (param_5 +
                                   ((uint)*(ushort *)(param_5 + (uint)(uVar2 >> 8) * 2) +
                                   (uint)(bVar1 >> 4)) * 2) + (bVar1 & 0xf)) * 2) +
                 *(short *)(param_1 + local_8 * 2);
          }
          iVar3 = local_8 + 1;
          local_8 = iVar3;
        } while (iVar3 < param_2);
      }
    }
  }
  return iVar3;
}



LCID GetSystemDefaultLCID(void)

{
  LCID LVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b817cb0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x17cb0  737  GetSystemDefaultLCID
  LVar1 = GetSystemDefaultLCID();
  return LVar1;
}



BOOL SwitchToThread(void)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b817cc0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x17cc0  1421  SwitchToThread
  BVar1 = SwitchToThread();
  return BVar1;
}



HANDLE CreateWaitableTimerA
                 (LPSECURITY_ATTRIBUTES lpTimerAttributes,BOOL bManualReset,LPCSTR lpTimerName)

{
  HANDLE pvVar1;
  
                    // 0x17cd0  259  CreateWaitableTimerA
  pvVar1 = CreateWaitableTimerExA(lpTimerAttributes,lpTimerName,(uint)(bManualReset != 0),0x1f0003);
  return pvVar1;
}



HANDLE CreateWaitableTimerExA
                 (LPSECURITY_ATTRIBUTES lpTimerAttributes,LPCSTR lpTimerName,DWORD dwFlags,
                 DWORD dwDesiredAccess)

{
  HANDLE pvVar1;
  int iVar2;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x17d00  260  CreateWaitableTimerExA
  if (lpTimerName == (LPCSTR)0x0) {
    local_8 = (LPCWSTR)0x0;
  }
  else {
    iVar2 = Basep8BitStringToDynamicUnicodeString(local_c,lpTimerName);
    if (iVar2 == 0) {
      return (HANDLE)0x0;
    }
  }
  pvVar1 = CreateWaitableTimerExW(lpTimerAttributes,local_8,dwFlags,dwDesiredAccess);
  if (lpTimerName != (LPCSTR)0x0) {
    RtlFreeUnicodeString(local_c);
  }
  return pvVar1;
}



int CompareStringA(LCID Locale,DWORD dwCmpFlags,PCNZCH lpString1,int cchCount1,PCNZCH lpString2,
                  int cchCount2)

{
  int iVar1;
  
                    // 0x17d40  158  CompareStringA
                    // WARNING: Could not recover jumptable at 0x6b817d46. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = CompareStringA(Locale,dwCmpFlags,lpString1,cchCount1,lpString2,cchCount2);
  return iVar1;
}



DWORD GetPrivateProfileSectionW
                (LPCWSTR lpAppName,LPWSTR lpReturnedString,DWORD nSize,LPCWSTR lpFileName)

{
  uint uVar1;
  DWORD DVar2;
  DWORD local_8;
  
                    // 0x17d60  687  GetPrivateProfileSectionW
  DVar2 = 0;
  local_8 = nSize;
  uVar1 = BaseDllReadWriteIniFile
                    ('\x01','\0','\x01',lpFileName,lpAppName,(short *)0x0,lpReturnedString,
                     (int *)&local_8);
  if ((int)uVar1 < 0) {
    if (uVar1 == 0x80000005) {
      if (1 < nSize) {
        DVar2 = nSize - 2;
        lpReturnedString[nSize - 1] = L'\0';
      }
    }
    else if (uVar1 == 0xc000007b) {
      RtlSetLastWin32Error(0xd);
    }
    else {
      BaseSetLastNTError(uVar1);
    }
  }
  else {
    RtlSetLastWin32Error(0);
    DVar2 = local_8 - 1;
  }
  if (DVar2 < nSize) {
    lpReturnedString[DVar2] = L'\0';
  }
  else if (nSize != 0) {
    lpReturnedString[nSize - 1] = L'\0';
  }
  return DVar2;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

HGLOBAL GlobalHandle(LPCVOID pMem)

{
  char cVar1;
  undefined4 *in_FS_OFFSET;
  uint local_24;
  HGLOBAL local_20 [3];
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x17de0  829  GlobalHandle
  local_8 = &DAT_6b891ad0;
  uStack12 = 0x6b817dec;
  local_20[0] = (HGLOBAL)0x0;
  RtlLockHeap(DAT_6b8b0734);
  local_8 = (undefined *)0x1;
  local_20[0] = (HGLOBAL)0x0;
  local_24 = 0x801;
  cVar1 = RtlGetUserInfoHeap(DAT_6b8b0734,0x801,pMem,local_20,&local_24);
  if (cVar1 == '\0') {
    RtlSetLastWin32Error(6);
  }
  else if ((local_20[0] == (HGLOBAL)0x0) || ((local_24 & 0x200) == 0)) {
    local_20[0] = pMem;
  }
  local_8 = (undefined *)0xfffffffe;
  FUN_6b817e6a();
  *in_FS_OFFSET = local_14;
  return local_20[0];
}



void FUN_6b817e6a(void)

{
  RtlUnlockHeap(DAT_6b8b0734);
  return;
}



undefined * FUN_6b817e77(void)

{
  HMODULE hModule;
  FARPROC pFVar1;
  undefined *puVar2;
  
  puVar2 = DAT_6b8b086c;
  if (DAT_6b8b086c == (undefined *)0x0) {
    puVar2 = &DAT_7ffe0030;
    hModule = LoadLibraryExW(L"ntdll.dll",(HANDLE)0x0,0x800);
    if (hModule != (HMODULE)0x0) {
      pFVar1 = GetProcAddress(hModule,"RtlGetNtSystemRoot");
      if (pFVar1 != (FARPROC)0x0) {
        _guard_check_icall();
        puVar2 = (undefined *)(*pFVar1)();
      }
      FreeLibrary(hModule);
    }
  }
  DAT_6b8b086c = puVar2;
  return DAT_6b8b086c;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint BasepIsProcessAllowed(undefined4 param_1)

{
  code *pcVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  undefined4 *puVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 local_10;
  uint local_c;
  undefined4 local_8;
  
                    // 0x17ee0  95  BasepIsProcessAllowed
  uVar4 = 0;
  local_c = 0;
  local_8 = 2;
  do {
    if (_DAT_6b8b0854 != 0) {
      uVar3 = DAT_6b8b015c;
      if ((_DAT_6b8b0160 != 0) &&
         (uVar3 = uVar4, puVar5 = DAT_6b8b0840, (undefined4 **)DAT_6b8b0840 != &DAT_6b8b0840)) {
        do {
          pcVar1 = (code *)puVar5[4];
          uVar7 = 1;
          uVar6 = param_1;
          _guard_check_icall();
          uVar3 = (*pcVar1)(uVar6,uVar7);
          if ((int)uVar3 < 0) {
            local_8 = 3;
            uVar4 = uVar3;
          }
          uVar6 = local_8;
          puVar5 = (undefined4 *)*puVar5;
        } while ((undefined4 **)puVar5 != &DAT_6b8b0840);
        uVar3 = uVar4;
        puVar5 = DAT_6b8b0840;
        local_c = uVar4;
        if ((undefined4 **)DAT_6b8b0840 != &DAT_6b8b0840) {
          do {
            pcVar1 = (code *)puVar5[4];
            uVar7 = param_1;
            uVar8 = uVar6;
            _guard_check_icall();
            (*pcVar1)(uVar7,uVar8);
            puVar5 = (undefined4 *)*puVar5;
            uVar3 = local_c;
          } while ((undefined4 **)puVar5 != &DAT_6b8b0840);
        }
      }
      return uVar3;
    }
    uVar3 = 0;
    RtlAcquireSRWLockExclusive(&DAT_6b8b0870);
    if (_DAT_6b8b0854 == 0) {
      iVar2 = NtOpenKey(&local_10,1,&DAT_6b88011c);
      if (iVar2 < 0) {
LAB_6b817f44:
        if ((undefined4 **)DAT_6b8b0840 == &DAT_6b8b0840) goto LAB_6b817f50;
        _DAT_6b8b0160 = 1;
      }
      else {
        NtClose(local_10);
        uVar3 = RtlQueryRegistryValuesEx(2,L"Session Manager",&PTR_FUN_6b880370,0,0);
        if ((-1 < (int)uVar3) || (uVar3 = uVar3 & -(uint)(uVar3 != 0xc0000034), -1 < (int)uVar3))
        goto LAB_6b817f44;
LAB_6b817f50:
        _DAT_6b8b0160 = 0;
        DAT_6b8b015c = uVar3;
      }
      _DAT_6b8b0854 = 1;
    }
    RtlReleaseSRWLockExclusive(&DAT_6b8b0870);
  } while( true );
}



HRESULT RegisterApplicationRecoveryCallback
                  (APPLICATION_RECOVERY_CALLBACK pRecoveyCallback,PVOID pvParameter,
                  DWORD dwPingInterval,DWORD dwFlags)

{
  HRESULT HVar1;
  
                    // 0x17f80  1190  RegisterApplicationRecoveryCallback
  if ((pRecoveyCallback == (APPLICATION_RECOVERY_CALLBACK)0x0) || (300000 < dwPingInterval)) {
    HVar1 = -0x7ff8ffa9;
  }
  else {
    if (dwPingInterval == 0) {
      dwPingInterval = 5000;
    }
    HVar1 = FUN_6b817fb6(pRecoveyCallback,pvParameter,dwPingInterval,dwFlags);
  }
  return HVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 __fastcall
FUN_6b817fb6(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  bool bVar1;
  undefined3 extraout_var;
  int iVar2;
  int iVar3;
  uint uVar4;
  undefined4 uVar5;
  HANDLE pvVar6;
  undefined4 uVar7;
  undefined4 *in_FS_OFFSET;
  char *pcVar8;
  _SECURITY_ATTRIBUTES local_34;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b891af8;
  uStack12 = 0x6b817fc2;
  uVar7 = 0x80004005;
  local_20 = 0x80004005;
  local_34.nLength = 0;
  local_34.lpSecurityDescriptor = (LPVOID)0x0;
  local_34.bInheritHandle = 0;
  local_28 = param_2;
  local_24 = param_1;
  bVar1 = FUN_6b81813c();
  if (CONCAT31(extraout_var,bVar1) == 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid state\n",0x96c);
    uVar7 = 0x8007139f;
    goto LAB_6b818123;
  }
  iVar2 = FUN_6b818381();
  if (iVar2 == 0) {
    uVar5 = 0x974;
    pcVar8 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
  }
  else {
    iVar3 = FUN_6b818333();
    if (iVar3 < 0) {
      uVar5 = 0x97a;
      pcVar8 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
    }
    else {
      iVar3 = FUN_6b8182bd();
      if (-1 < iVar3) {
        local_8 = (undefined *)0x0;
        iVar2 = *(int *)(iVar2 + 0x230);
        if ((iVar2 == 0) || (uVar4 = FUN_6b81826e(iVar2), (int)uVar4 < 0)) {
          uVar5 = 0x98b;
          pcVar8 = "WER/CrashAPI:%u: ERROR Invalid PEB entry\n";
LAB_6b82b87c:
          DbgPrintEx(0x96,0,pcVar8,uVar5);
        }
        else {
          *(undefined4 *)(iVar2 + 0x8a8) = 0x40;
          uVar5 = RtlEncodeSystemPointer(local_24);
          *(undefined4 *)(iVar2 + 0x8b0) = uVar5;
          *(undefined4 *)(iVar2 + 0x8b4) = 0;
          *(undefined4 *)(iVar2 + 0x8b8) = local_28;
          *(undefined4 *)(iVar2 + 0x8bc) = 0;
          *(undefined4 *)(iVar2 + 0x8e0) = param_3;
          *(undefined4 *)(iVar2 + 0x8e4) = param_4;
          local_34.nLength = 0xc;
          local_34.lpSecurityDescriptor = (LPVOID)0x0;
          local_34.bInheritHandle = 1;
          if ((*(uint *)(iVar2 + 0x8c0) | *(uint *)(iVar2 + 0x8c4)) == 0) {
            pvVar6 = CreateEventW(&local_34,0,0,(LPCWSTR)0x0);
            *(HANDLE *)(iVar2 + 0x8c0) = pvVar6;
            *(undefined4 *)(iVar2 + 0x8c4) = 0;
            if (pvVar6 != (HANDLE)0x0) goto LAB_6b8180b0;
            uVar5 = 0x9af;
LAB_6b82b864:
            pcVar8 = "WER/CrashAPI:%u: ERROR Unable to create the m_hAliveEvent event\n";
            goto LAB_6b82b87c;
          }
LAB_6b8180b0:
          if ((*(uint *)(iVar2 + 0x8c8) | *(uint *)(iVar2 + 0x8cc)) == 0) {
            pvVar6 = CreateEventW(&local_34,1,0,(LPCWSTR)0x0);
            *(HANDLE *)(iVar2 + 0x8c8) = pvVar6;
            *(undefined4 *)(iVar2 + 0x8cc) = 0;
            if (pvVar6 == (HANDLE)0x0) {
              uVar5 = 0x9be;
              goto LAB_6b82b864;
            }
          }
          if ((*(uint *)(iVar2 + 0x8d0) | *(uint *)(iVar2 + 0x8d4)) == 0) {
            pvVar6 = CreateEventW(&local_34,1,0,(LPCWSTR)0x0);
            *(HANDLE *)(iVar2 + 0x8d0) = pvVar6;
            *(undefined4 *)(iVar2 + 0x8d4) = 0;
            if (pvVar6 == (HANDLE)0x0) {
              uVar5 = 0x9cd;
              goto LAB_6b82b864;
            }
          }
          uVar7 = 0;
          local_20 = 0;
        }
        local_8 = (undefined *)0xfffffffe;
        FUN_6b818135();
        goto LAB_6b818123;
      }
      uVar5 = 0x980;
      pcVar8 = "WER/CrashAPI:%u: ERROR WerpInitPEBStore failed\n";
    }
  }
  DbgPrintEx(0x96,0,pcVar8,uVar5);
LAB_6b818123:
  *in_FS_OFFSET = local_14;
  return uVar7;
}



void FUN_6b818135(void)

{
  RtlReleasePebLock();
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

bool FUN_6b81813c(void)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  bool bVar4;
  undefined4 *in_FS_OFFSET;
  undefined4 local_14;
  
  iVar1 = FUN_6b818381();
  if (iVar1 == 0) {
    bVar4 = true;
  }
  else {
    iVar2 = FUN_6b818333();
    if (iVar2 < 0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpAcquirePebLock failed\n",0x22d);
      bVar4 = false;
    }
    else {
      iVar1 = *(int *)(iVar1 + 0x230);
      bVar4 = true;
      if (iVar1 != 0) {
        uVar3 = FUN_6b81826e(iVar1);
        if ((int)uVar3 < 0) {
          DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpValidatePebHeader failed\n",0x23e);
          bVar4 = false;
        }
        else {
          bVar4 = *(int *)(iVar1 + 0x8d8) == 0;
        }
      }
      FUN_6b8181b6();
    }
  }
  *in_FS_OFFSET = local_14;
  return bVar4;
}



void FUN_6b8181b6(void)

{
  RtlReleasePebLock();
  return;
}



HRESULT WerSetFlags(DWORD dwFlags)

{
  int iVar1;
  
                    // 0x181d0  1523  WerSetFlags
                    // 0x181d0  1524  WerSetFlagsWorker
  iVar1 = FUN_6b8181e1(dwFlags);
  return iVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

int __fastcall FUN_6b8181e1(undefined4 param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  undefined4 *in_FS_OFFSET;
  char *pcVar5;
  undefined4 uVar6;
  undefined4 local_14;
  
  iVar1 = FUN_6b818381();
  if (iVar1 == 0) {
    uVar6 = 0xfd0;
    pcVar5 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
  }
  else {
    iVar2 = FUN_6b8182bd();
    if (iVar2 < 0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpInitPEBStore failed\n",0xfd6);
      goto LAB_6b818257;
    }
    iVar3 = FUN_6b818333();
    if (-1 < iVar3) {
      iVar1 = *(int *)(iVar1 + 0x230);
      if ((iVar1 == 0) || (uVar4 = FUN_6b81826e(iVar1), (int)uVar4 < 0)) {
        DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid PEB entry\n",0xfe6);
      }
      else {
        *(undefined4 *)(iVar1 + 0x914) = param_1;
        iVar2 = 0;
      }
      FUN_6b818267();
      goto LAB_6b818257;
    }
    uVar6 = 0xfdc;
    pcVar5 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
  }
  DbgPrintEx(0x96,0,pcVar5,uVar6);
  iVar2 = -0x7fffbffb;
LAB_6b818257:
  *in_FS_OFFSET = local_14;
  return iVar2;
}



void FUN_6b818267(void)

{
  RtlReleasePebLock();
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

uint __fastcall FUN_6b81826e(int param_1)

{
  int iVar1;
  uint uVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 local_14;
  
  if (param_1 == 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid args\n",500);
    uVar2 = 0x80070057;
  }
  else {
    iVar1 = wcsncmp((wchar_t *)(param_1 + 4),L"PEB_SIGNATURE",0xe);
    uVar2 = -(uint)(iVar1 != 0) & 0x80004005;
  }
  *in_FS_OFFSET = local_14;
  return uVar2;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 FUN_6b8182bd(void)

{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  undefined4 *in_FS_OFFSET;
  char *pcVar5;
  undefined4 uVar6;
  undefined4 local_14;
  
  uVar4 = 0x80004005;
  iVar1 = FUN_6b818381();
  if (iVar1 == 0) {
    uVar6 = 0x271;
    pcVar5 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
  }
  else {
    iVar2 = FUN_6b818333();
    if (-1 < iVar2) {
      if (*(int *)(iVar1 + 0x230) == 0) {
        puVar3 = (undefined4 *)VirtualAlloc((LPVOID)0x0,0x968,0x3000,4);
        *(undefined4 **)(iVar1 + 0x230) = puVar3;
        if (puVar3 == (undefined4 *)0x0) {
          DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR VirtualAlloc failed\n",0x289);
          uVar4 = 0x8007000e;
        }
        else {
          if ((*(short *)(puVar3 + 0x246) == 0) &&
             (iVar1 = FUN_6b8646f4((short *)(puVar3 + 0x246)), iVar1 < 0)) {
            uVar6 = 0x29b;
            pcVar5 = "WER/CrashAPI:%u: ERROR WerpHeapInitialize failed\n";
          }
          else {
            iVar1 = FUN_6b861a82((short *)(puVar3 + 1),0xe,(int)L"PEB_SIGNATURE");
            if (-1 < iVar1) {
              *puVar3 = 0x968;
              goto LAB_6b818301;
            }
            uVar6 = 0x2a4;
            pcVar5 = "WER/CrashAPI:%u: ERROR Could not set the peb signature\n";
          }
          DbgPrintEx(0x96,0,pcVar5,uVar6);
        }
      }
      else {
LAB_6b818301:
        uVar4 = 0;
      }
      FUN_6b818324();
      goto LAB_6b818312;
    }
    uVar6 = 0x277;
    pcVar5 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
  }
  DbgPrintEx(0x96,0,pcVar5,uVar6);
LAB_6b818312:
  *in_FS_OFFSET = local_14;
  return uVar4;
}



void FUN_6b818324(void)

{
  int unaff_EBX;
  SIZE_T unaff_ESI;
  int unaff_EDI;
  
  if ((unaff_EDI < 0) && (*(LPVOID *)(unaff_EBX + 0x230) != (LPVOID)0x0)) {
    VirtualFree(*(LPVOID *)(unaff_EBX + 0x230),unaff_ESI,0x8000);
    *(SIZE_T *)(unaff_EBX + 0x230) = unaff_ESI;
  }
  RtlReleasePebLock();
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 FUN_6b818333(void)

{
  int iVar1;
  undefined4 uVar2;
  int iVar3;
  undefined4 *in_FS_OFFSET;
  undefined4 local_14;
  
  uVar2 = 0x80004005;
  iVar3 = 0;
  do {
    if (199 < iVar3) {
LAB_6b818368:
      *in_FS_OFFSET = local_14;
      return uVar2;
    }
    iVar1 = RtlTryAcquirePebLock();
    if (iVar1 != 0) {
      uVar2 = 0;
      goto LAB_6b818368;
    }
    Sleep(10);
    iVar3 = iVar3 + 1;
  } while( true );
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 FUN_6b818381(void)

{
  undefined4 *in_FS_OFFSET;
  undefined4 local_14;
  
  *in_FS_OFFSET = local_14;
  return in_FS_OFFSET[0xc];
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

LPSTR lstrcpy(LPSTR lpString1,LPCSTR lpString2)

{
  char cVar1;
  int iVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 local_14;
  
                    // 0x183c0  1594  lstrcpy
                    // 0x183c0  1595  lstrcpyA
  iVar2 = (int)lpString1 - (int)lpString2;
  do {
    cVar1 = *lpString2;
    lpString2[iVar2] = cVar1;
    lpString2 = lpString2 + 1;
  } while (cVar1 != '\0');
  *in_FS_OFFSET = local_14;
  return lpString1;
}



int GetLocaleInfoA(LCID Locale,LCTYPE LCType,LPSTR lpLCData,int cchData)

{
  int iVar1;
  
                    // 0x18410  617  GetLocaleInfoA
                    // WARNING: Could not recover jumptable at 0x6b818416. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = GetLocaleInfoA(Locale,LCType,lpLCData,cchData);
  return iVar1;
}



void BasepReleaseSxsCreateProcessUtilityStruct(int *param_1)

{
  int in_FS_OFFSET;
  
                    // 0x18430  103  BasepReleaseSxsCreateProcessUtilityStruct
  FUN_6b81ad44(param_1);
  FUN_6b81ad44(param_1 + 6);
  if (param_1[0xc] != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1[0xc]);
  }
  if (param_1[0xd] != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1[0xd]);
  }
  if (param_1[0xe] != 0) {
    NtClose(param_1[0xe]);
  }
  return;
}



UINT GetSystemDirectoryA(LPSTR lpBuffer,UINT uSize)

{
  uint uVar1;
  
                    // 0x18480  741  GetSystemDirectoryA
  uVar1 = FUN_6b818494(lpBuffer,(ushort)uSize);
  return uVar1;
}



uint __fastcall FUN_6b818494(undefined4 param_1,ushort param_2)

{
  int iVar1;
  int iVar2;
  code *pcVar3;
  ushort local_14;
  ushort local_12;
  undefined4 local_10;
  undefined4 local_c;
  uint local_8;
  
  local_c = param_1;
  iVar1 = KernelBaseGetGlobalData();
  iVar2 = RtlUnicodeToMultiByteSize
                    (&local_8,*(undefined4 *)(iVar1 + 0x14),*(undefined2 *)(iVar1 + 0x12));
  if (-1 < iVar2) {
    if (param_2 < (ushort)local_8) {
      return local_8;
    }
    local_10 = local_c;
    local_12 = param_2;
    pcVar3 = (code *)GetUnicodeStringToEightBitStringRoutine(&local_14,iVar1 + 0x10,0);
    _guard_check_icall();
    iVar1 = (*pcVar3)();
    if (-1 < iVar1) {
      return (uint)local_14;
    }
  }
  return 0;
}



void BasepFreeAppCompatData(int param_1,int param_2,int param_3)

{
  int in_FS_OFFSET;
  
                    // 0x18510  89  BasepFreeAppCompatData
  if (param_1 != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1);
  }
  if (param_3 != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_3);
  }
  if (param_2 != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_2);
  }
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

UINT GlobalFlags(HGLOBAL hMem)

{
  ushort uVar1;
  char cVar2;
  HGLOBAL pvVar3;
  undefined4 *in_FS_OFFSET;
  uint local_28;
  HGLOBAL local_24;
  uint local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x18560  825  GlobalFlags
  local_8 = &DAT_6b891c00;
  uStack12 = 0x6b81856c;
  local_20 = 0x8000;
  RtlLockHeap(DAT_6b8b0734);
  local_8 = (undefined *)0x1;
  pvVar3 = hMem;
  if (((uint)hMem & 4) == 0) {
    local_24 = (HGLOBAL)0x0;
    local_28 = 0x800;
    cVar2 = RtlGetUserInfoHeap(DAT_6b8b0734,0x800,hMem,&local_24,&local_28);
    if ((cVar2 != '\0') &&
       ((local_24 == (HGLOBAL)0x0 || (pvVar3 = local_24, (local_28 & 0x200) == 0)))) {
      local_20 = 0;
      pvVar3 = hMem;
    }
    if (((uint)pvVar3 & 4) == 0) goto LAB_6b8185cd;
  }
  cVar2 = RtlIsValidHandle(DAT_6b8b072c,(ushort *)((int)pvVar3 - 4U));
  if (cVar2 != '\0') {
    local_20 = (uint)(byte)*(undefined2 *)((int)pvVar3 - 2);
    uVar1 = *(ushort *)((int)pvVar3 - 4U);
    if ((uVar1 & 8) != 0) {
      local_20 = local_20 | 0x4000;
    }
    if ((uVar1 & 4) != 0) {
      local_20 = local_20 | 0x100;
    }
    if ((short)uVar1 < 0) {
      local_20 = local_20 | 0x2000;
    }
  }
LAB_6b8185cd:
  if (local_20 == 0x8000) {
    RtlSetLastWin32Error(6);
  }
  local_8 = (undefined *)0xfffffffe;
  FUN_6b8185fa();
  *in_FS_OFFSET = local_14;
  return local_20;
}



void FUN_6b8185fa(void)

{
  RtlUnlockHeap(DAT_6b8b0734);
  return;
}



BOOL SetEnvironmentVariableW(LPCWSTR lpName,LPCWSTR lpValue)

{
  BOOL BVar1;
  
                    // 0x18620  1304  SetEnvironmentVariableW
                    // WARNING: Could not recover jumptable at 0x6b818626. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetEnvironmentVariableW(lpName,lpValue);
  return BVar1;
}



undefined4 __fastcall FUN_6b81862c(undefined *param_1)

{
  undefined uVar1;
  void *_Dst;
  int iVar2;
  undefined4 uVar3;
  int in_FS_OFFSET;
  undefined4 local_2c;
  undefined4 local_28;
  undefined *local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined local_14 [4];
  int local_10;
  undefined local_c [4];
  undefined4 local_8;
  
  local_8 = 0;
  uVar3 = 0;
  RtlInitUnicodeString
            (local_14,L"\\Registry\\Machine\\System\\CurrentControlSet\\Control\\Terminal Server");
  _Dst = (void *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,0x224);
  if (local_10 != 0) {
    if (_Dst == (void *)0x0) {
      return 0;
    }
    local_24 = local_14;
    local_2c = 0x18;
    local_28 = 0;
    local_20 = 0x40;
    local_1c = 0;
    local_18 = 0;
    iVar2 = NtOpenKey(&local_8,0x20019,&local_2c);
    if (-1 < iVar2) {
      RtlInitUnicodeString(local_14,L"TSAppCompat");
      iVar2 = NtQueryValueKey(local_8,local_14,2,_Dst,0x224,local_c);
      if (((-1 < iVar2) && (*(int *)((int)_Dst + 4) == 4)) && (*(int *)((int)_Dst + 0xc) != 0)) {
        uVar3 = 1;
      }
      RtlInitUnicodeString(local_14,L"TSUserEnabled");
      iVar2 = NtQueryValueKey(local_8,local_14,2,_Dst,0x224,local_c);
      if ((iVar2 < 0) || (*(int *)((int)_Dst + 4) != 4)) {
        uVar1 = 0;
      }
      else {
        uVar1 = *(undefined *)((int)_Dst + 0xc);
      }
      *param_1 = uVar1;
      NtClose(local_8);
    }
  }
  if (_Dst != (void *)0x0) {
    memset(_Dst,0,0x224);
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,_Dst);
  }
  return uVar3;
}



BOOL QueryActCtxW(DWORD dwFlags,HANDLE hActCtx,PVOID pvSubInstance,ULONG ulInfoClass,PVOID pvBuffer,
                 SIZE_T cbBuffer,SIZE_T *pcbWrittenOrRequired)

{
  BOOL BVar1;
  
                    // 0x18760  1093  QueryActCtxW
                    // WARNING: Could not recover jumptable at 0x6b818766. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = QueryActCtxW(dwFlags,hActCtx,pvSubInstance,ulInfoClass,pvBuffer,cbBuffer,
                       pcbWrittenOrRequired);
  return BVar1;
}



HANDLE OpenFileMappingA(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCSTR lpName)

{
  int iVar1;
  HANDLE pvVar2;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x18780  1032  OpenFileMappingA
  if (lpName == (LPCSTR)0x0) {
    local_8 = (LPCWSTR)0x0;
  }
  else {
    iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpName);
    if (iVar1 == 0) {
      return (HANDLE)0x0;
    }
  }
  pvVar2 = OpenFileMappingW(dwDesiredAccess,bInheritHandle,local_8);
  if (lpName != (LPCSTR)0x0) {
    RtlFreeUnicodeString(local_c);
  }
  return pvVar2;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4
// WARNING: Removing unreachable block (ram,0x6b81ba40)

ATOM FindAtomA(LPCSTR lpString)

{
  int iVar1;
  undefined4 *in_FS_OFFSET;
  undefined auStack72 [8];
  short asStack64 [4];
  int aiStack56 [2];
  int iStack48;
  short *psStack44;
  ushort auStack40 [2];
  char cStack36;
  undefined uStack32;
  undefined4 uStack20;
  undefined4 uStack12;
  undefined *puStack8;
  
                    // 0x187e0  377  FindAtomA
  puStack8 = &DAT_6b891a28;
  uStack12 = 0x6b81ba1b;
  uStack32 = 0;
  cStack36 = '\x01';
  psStack44 = (short *)0x0;
  if (lpString < (LPCSTR)0x10000) {
    auStack40[0] = (ushort)lpString;
    if (auStack40[0] < 0xc000) goto LAB_6b81baa2;
    iVar1 = -0x3ffffff3;
  }
  else {
    puStack8 = (undefined *)0x0;
    RtlInitAnsiString(auStack72,lpString);
    psStack44 = asStack64;
    iVar1 = RtlAnsiStringToUnicodeString(asStack64,auStack72,1);
    puStack8 = (undefined *)0xfffffffe;
    iStack48 = iVar1;
    if (-1 < iVar1) {
      auStack40[0] = 0;
      puStack8 = (undefined *)0x1;
      if (cStack36 == '\0') {
        if (*psStack44 == 0) {
          RtlSetLastWin32Error(0x7b);
        }
        else {
          iVar1 = NtFindAtom(*(undefined4 *)(psStack44 + 2),*psStack44,auStack40);
LAB_6b81ba92:
          if (iVar1 < 0) goto LAB_6b81bad5;
        }
      }
      else {
        iVar1 = FUN_6b81bb24(aiStack56);
        if (-1 < iVar1) {
          iVar1 = RtlLookupAtomInAtomTable(aiStack56[0],*(undefined4 *)(psStack44 + 2),auStack40);
          goto LAB_6b81ba92;
        }
LAB_6b81bad5:
        BaseSetLastNTError(iVar1);
        auStack40[0] = 0;
      }
      puStack8 = (undefined *)0xfffffffe;
      FUN_6b81bb0a();
      goto LAB_6b81baa2;
    }
  }
  BaseSetLastNTError(iVar1);
  auStack40[0] = 0;
LAB_6b81baa2:
  *in_FS_OFFSET = uStack20;
  return auStack40[0];
}



BOOL Wow64RevertWow64FsRedirection(PVOID OlValue)

{
  BOOL BVar1;
  
                    // 0x18800  1546  Wow64RevertWow64FsRedirection
                    // WARNING: Could not recover jumptable at 0x6b818806. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = Wow64RevertWow64FsRedirection(OlValue);
  return BVar1;
}



BOOL Wow64DisableWow64FsRedirection(PVOID *OldValue)

{
  BOOL BVar1;
  
                    // 0x18820  1542  Wow64DisableWow64FsRedirection
                    // WARNING: Could not recover jumptable at 0x6b818826. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = Wow64DisableWow64FsRedirection(OldValue);
  return BVar1;
}



int LCMapStringEx(LPCWSTR lpLocaleName,DWORD dwMapFlags,LPCWSTR lpSrcStr,int cchSrc,LPWSTR lpDestStr
                 ,int cchDest,LPNLSVERSIONINFO lpVersionInformation,LPVOID lpReserved,LPARAM lParam)

{
  int iVar1;
  
                    // 0x18840  950  LCMapStringEx
                    // WARNING: Could not recover jumptable at 0x6b818846. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = LCMapStringEx(lpLocaleName,dwMapFlags,lpSrcStr,cchSrc,lpDestStr,cchDest,
                        lpVersionInformation,lpReserved,lParam);
  return iVar1;
}



BOOL SetThreadLocale(LCID Locale)

{
  BOOL BVar1;
  
                    // 0x18860  1378  SetThreadLocale
                    // WARNING: Could not recover jumptable at 0x6b818866. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetThreadLocale(Locale);
  return BVar1;
}



int GetNumberFormatW(LCID Locale,DWORD dwFlags,LPCWSTR lpValue,NUMBERFMTW *lpFormat,
                    LPWSTR lpNumberStr,int cchNumber)

{
  int iVar1;
  
                    // 0x18880  665  GetNumberFormatW
  iVar1 = FUN_6b8188a0(Locale,dwFlags,lpValue,lpFormat,lpNumberStr,cchNumber);
  return iVar1;
}



int __fastcall
FUN_6b8188a0(undefined4 param_1,DWORD param_2,LPCWSTR param_3,NUMBERFMTW *param_4,LPWSTR param_5,
            int param_6)

{
  LPCWSTR lpLocaleName;
  int iVar1;
  
  lpLocaleName = (LPCWSTR)InternalLcidToName();
  if (lpLocaleName == (LPCWSTR)0x0) {
    SetLastError(0x57);
    iVar1 = 0;
  }
  else {
    iVar1 = GetNumberFormatEx(lpLocaleName,param_2,param_3,param_4,param_5,param_6);
  }
  return iVar1;
}



BOOL CreateProcessW(LPCWSTR lpApplicationName,LPWSTR lpCommandLine,
                   LPSECURITY_ATTRIBUTES lpProcessAttributes,
                   LPSECURITY_ATTRIBUTES lpThreadAttributes,BOOL bInheritHandles,
                   DWORD dwCreationFlags,LPVOID lpEnvironment,LPCWSTR lpCurrentDirectory,
                   LPSTARTUPINFOW lpStartupInfo,LPPROCESS_INFORMATION lpProcessInformation)

{
  BOOL BVar1;
  
                    // 0x188e0  235  CreateProcessW
                    // WARNING: Could not recover jumptable at 0x6b8188e6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = CreateProcessW(lpApplicationName,lpCommandLine,lpProcessAttributes,lpThreadAttributes,
                         bInheritHandles,dwCreationFlags,lpEnvironment,lpCurrentDirectory,
                         lpStartupInfo,lpProcessInformation);
  return BVar1;
}



BOOL FindActCtxSectionStringW
               (DWORD dwFlags,GUID *lpExtensionGuid,ULONG ulSectionId,LPCWSTR lpStringToFind,
               PACTCTX_SECTION_KEYED_DATA ReturnedData)

{
  BOOL BVar1;
  
                    // 0x18900  375  FindActCtxSectionStringW
                    // WARNING: Could not recover jumptable at 0x6b818906. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = FindActCtxSectionStringW(dwFlags,lpExtensionGuid,ulSectionId,lpStringToFind,ReturnedData);
  return BVar1;
}



BOOL SetProcessDEPPolicy(DWORD dwFlags)

{
  BOOL BVar1;
  DWORD local_c;
  uint local_8;
  
                    // 0x18920  1347  SetProcessDEPPolicy
  local_c = dwFlags;
  local_8 = dwFlags & 1;
  BVar1 = SetProcessMitigationPolicy(0,&local_c,8);
  return BVar1;
}



void BasepCheckWebBladeHashes(undefined4 param_1)

{
  uint uVar1;
  undefined4 uVar2;
  undefined4 extraout_EDX;
  ulonglong uVar3;
  undefined8 uVar4;
  undefined *_Base;
  size_t _NumOfElements;
  undefined local_18 [16];
  uint local_8;
  
                    // 0x18950  83  BasepCheckWebBladeHashes
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  uVar3 = RtlGetSuiteMask();
  uVar2 = (undefined4)(uVar3 >> 0x20);
  if ((uVar3 & 0x6c00) != 0) {
    uVar4 = RtlComputeImportTableHash(param_1,local_18,1);
    uVar2 = (undefined4)((ulonglong)uVar4 >> 0x20);
    if (-1 < (int)uVar4) {
      uVar1 = RtlGetSuiteMask();
      if ((uVar1 & 0x4000) == 0) {
        uVar1 = RtlGetSuiteMask();
        if ((uVar1 & 0x2000) == 0) {
          _NumOfElements = 0x17;
          _Base = &DAT_6b8879b0;
        }
        else {
          _NumOfElements = 8;
          _Base = &DAT_6b887930;
        }
      }
      else {
        _NumOfElements = 0x13;
        _Base = &DAT_6b887800;
      }
      bsearch(local_18,_Base,_NumOfElements,0x10,_PtFuncCompare_6b83abe0);
      uVar2 = extraout_EDX;
    }
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



DWORD GetEnvironmentVariableA(LPCSTR lpName,LPSTR lpBuffer,DWORD nSize)

{
  DWORD DVar1;
  
                    // 0x18990  574  GetEnvironmentVariableA
                    // WARNING: Could not recover jumptable at 0x6b818996. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = GetEnvironmentVariableA(lpName,lpBuffer,nSize);
  return DVar1;
}



BOOL GetModuleHandleExA(DWORD dwFlags,LPCSTR lpModuleName,HMODULE *phModule)

{
  BOOL BVar1;
  
                    // 0x189b0  636  GetModuleHandleExA
                    // WARNING: Could not recover jumptable at 0x6b8189b6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetModuleHandleExA(dwFlags,lpModuleName,phModule);
  return BVar1;
}



LCID GetThreadLocale(void)

{
  LCID LVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8189d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x189d0  773  GetThreadLocale
  LVar1 = GetThreadLocale();
  return LVar1;
}



DWORD GetLogicalDrives(void)

{
  int iVar1;
  DWORD local_28 [9];
  
                    // 0x189e0  622  GetLogicalDrives
  iVar1 = NtQueryInformationProcess(0xffffffff,0x17,local_28,0x24,0);
  if (iVar1 < 0) {
    BaseSetLastNTError(iVar1);
    return 0;
  }
  if (local_28[0] != 0) {
    return local_28[0];
  }
  RtlSetLastWin32Error(0);
  return local_28[0];
}



BOOL UnregisterWait(HANDLE WaitHandle)

{
  int iVar1;
  
                    // 0x18a20  1468  UnregisterWait
  if (WaitHandle == (HANDLE)0x0) {
    RtlSetLastWin32Error(6);
  }
  else {
    iVar1 = RtlDeregisterWait(WaitHandle);
    if ((iVar1 != 0x103) && (-1 < iVar1)) {
      return 1;
    }
    BaseSetLastNTError(iVar1);
  }
  return 0;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

LPSTR lstrcat(LPSTR lpString1,LPCSTR lpString2)

{
  char *pcVar1;
  char cVar2;
  uint uVar3;
  LPCSTR pCVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  undefined4 *in_FS_OFFSET;
  undefined4 local_14;
  
                    // 0x18a60  1585  lstrcat
                    // 0x18a60  1586  lstrcatA
  pCVar4 = lpString2;
  do {
    cVar2 = *pCVar4;
    pCVar4 = pCVar4 + 1;
  } while (cVar2 != '\0');
  puVar6 = (undefined4 *)(lpString1 + -1);
  do {
    pcVar1 = (char *)((int)puVar6 + 1);
    puVar6 = (undefined4 *)((int)puVar6 + 1);
  } while (*pcVar1 != '\0');
  puVar5 = (undefined4 *)lpString2;
  for (uVar3 = (uint)((int)pCVar4 - (int)lpString2) >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
    *puVar6 = *puVar5;
    puVar5 = puVar5 + 1;
    puVar6 = puVar6 + 1;
  }
  for (uVar3 = (int)pCVar4 - (int)lpString2 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
    *(undefined *)puVar6 = *(undefined *)puVar5;
    puVar5 = (undefined4 *)((int)puVar5 + 1);
    puVar6 = (undefined4 *)((int)puVar6 + 1);
  }
  *in_FS_OFFSET = local_14;
  return lpString1;
}



void FreeLibraryAndExitThread(HMODULE hLibModule,DWORD dwExitCode)

{
                    // 0x18ac0  434  FreeLibraryAndExitThread
                    // WARNING: Subroutine does not return
  FreeLibraryAndExitThread(hLibModule,dwExitCode);
}



DWORD GetCurrentDirectoryW(DWORD nBufferLength,LPWSTR lpBuffer)

{
  DWORD DVar1;
  
                    // 0x18ae0  535  GetCurrentDirectoryW
                    // WARNING: Could not recover jumptable at 0x6b818ae6. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = GetCurrentDirectoryW(nBufferLength,lpBuffer);
  return DVar1;
}



DWORD GetProcessVersion(DWORD ProcessId)

{
  DWORD DVar1;
  
                    // 0x18b00  709  GetProcessVersion
                    // WARNING: Could not recover jumptable at 0x6b818b06. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = GetProcessVersion(ProcessId);
  return DVar1;
}



BOOL UnregisterWaitEx(HANDLE WaitHandle,HANDLE CompletionEvent)

{
  BOOL BVar1;
  
                    // 0x18b20  1469  UnregisterWaitEx
                    // WARNING: Could not recover jumptable at 0x6b818b26. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = UnregisterWaitEx(WaitHandle,CompletionEvent);
  return BVar1;
}



HLOCAL LocalReAlloc(HLOCAL hMem,SIZE_T uBytes,UINT uFlags)

{
  HLOCAL pvVar1;
  
                    // 0x18b40  984  LocalReAlloc
                    // WARNING: Could not recover jumptable at 0x6b818b46. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = LocalReAlloc(hMem,uBytes,uFlags);
  return pvVar1;
}



BOOL CopyFileA(LPCSTR lpExistingFileName,LPCSTR lpNewFileName,BOOL bFailIfExists)

{
  int iVar1;
  BOOL BVar2;
  undefined local_14 [4];
  LPCWSTR local_10;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x18b60  174  CopyFileA
  iVar1 = Basep8BitStringToDynamicUnicodeString(local_14,lpExistingFileName);
  if (iVar1 == 0) {
    BVar2 = 0;
  }
  else {
    iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpNewFileName);
    if (iVar1 == 0) {
      BVar2 = 0;
    }
    else {
      BVar2 = CopyFileExW(local_10,local_8,(LPPROGRESS_ROUTINE)0x0,(LPVOID)0x0,(LPBOOL)0x0,
                          (uint)(bFailIfExists != 0));
      RtlFreeUnicodeString(local_c);
    }
    RtlFreeUnicodeString(local_14);
  }
  return BVar2;
}



int GetDateFormatW(LCID Locale,DWORD dwFlags,SYSTEMTIME *lpDate,LPCWSTR lpFormat,LPWSTR lpDateStr,
                  int cchDate)

{
  int iVar1;
  
                    // 0x18bd0  551  GetDateFormatW
                    // WARNING: Could not recover jumptable at 0x6b818bd6. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = GetDateFormatW(Locale,dwFlags,lpDate,lpFormat,lpDateStr,cchDate);
  return iVar1;
}



DWORD SearchPathW(LPCWSTR lpPath,LPCWSTR lpFileName,LPCWSTR lpExtension,DWORD nBufferLength,
                 LPWSTR lpBuffer,LPWSTR *lpFilePart)

{
  DWORD DVar1;
  
                    // 0x18bf0  1244  SearchPathW
                    // WARNING: Could not recover jumptable at 0x6b818bf6. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = SearchPathW(lpPath,lpFileName,lpExtension,nBufferLength,lpBuffer,lpFilePart);
  return DVar1;
}



int FoldStringW(DWORD dwMapFlags,LPCWSTR lpSrcStr,int cchSrc,LPWSTR lpDestStr,int cchDest)

{
  int iVar1;
  
                    // 0x18c10  426  FoldStringW
                    // WARNING: Could not recover jumptable at 0x6b818c16. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = FoldStringW(dwMapFlags,lpSrcStr,cchSrc,lpDestStr,cchDest);
  return iVar1;
}



DWORD FormatMessageA(DWORD dwFlags,LPCVOID lpSource,DWORD dwMessageId,DWORD dwLanguageId,
                    LPSTR lpBuffer,DWORD nSize,va_list *Arguments)

{
  DWORD DVar1;
  
                    // 0x18c30  428  FormatMessageA
                    // WARNING: Could not recover jumptable at 0x6b818c36. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = FormatMessageA(dwFlags,lpSource,dwMessageId,dwLanguageId,lpBuffer,nSize,Arguments);
  return DVar1;
}



BOOL QueryInformationJobObject
               (HANDLE hJob,JOBOBJECTINFOCLASS JobObjectInformationClass,
               LPVOID lpJobObjectInformation,DWORD cbJobObjectInformationLength,
               LPDWORD lpReturnLength)

{
  BOOL BVar1;
  undefined4 extraout_EDX;
  undefined4 uVar2;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  bool bVar3;
  undefined8 uVar4;
  undefined auStack136 [4];
  LPVOID local_84;
  undefined local_80 [36];
  int local_5c;
  uint local_c;
  
                    // 0x18c50  1102  QueryInformationJobObject
  local_c = DAT_6b8b0140 ^ (uint)auStack136;
  local_84 = lpJobObjectInformation;
  if (JobObjectInformationClass == JobObjectBasicLimitInformation) {
    bVar3 = cbJobObjectInformationLength == 0x30;
LAB_6b818c90:
    lpJobObjectInformation = local_80;
    if (!bVar3) {
      BaseSetLastNTError(0xc0000004);
      uVar2 = extraout_EDX_00;
      goto LAB_6b818d0a;
    }
  }
  else if (JobObjectInformationClass == JobObjectExtendedLimitInformation) {
    bVar3 = cbJobObjectInformationLength == 0x70;
    goto LAB_6b818c90;
  }
  uVar4 = NtQueryInformationJobObject
                    (hJob,JobObjectInformationClass,lpJobObjectInformation,
                     cbJobObjectInformationLength,lpReturnLength);
  uVar2 = (undefined4)((ulonglong)uVar4 >> 0x20);
  if ((int)uVar4 < 0) {
    BaseSetLastNTError((int)uVar4);
    uVar2 = extraout_EDX_01;
    goto LAB_6b818d0a;
  }
  if ((undefined *)lpJobObjectInformation != local_80) goto LAB_6b818d0a;
  if (local_5c == 1) {
    local_5c = 0x40;
  }
  else if (local_5c == 2) {
LAB_6b818cec:
    local_5c = 0x20;
  }
  else if (local_5c == 3) {
    local_5c = 0x80;
  }
  else if (local_5c == 4) {
    local_5c = 0x100;
  }
  else if (local_5c == 5) {
    local_5c = 0x4000;
  }
  else {
    if (local_5c != 6) goto LAB_6b818cec;
    local_5c = 0x8000;
  }
  memcpy(local_84,local_80,cbJobObjectInformationLength);
  uVar2 = extraout_EDX;
LAB_6b818d0a:
  BVar1 = FUN_6b8224af(local_c ^ (uint)auStack136,uVar2);
  return BVar1;
}



void CheckElevationEnabled(uint *param_1)

{
  int iVar1;
  uint local_8;
  
                    // 0x18d30  128  CheckElevationEnabled
  iVar1 = RtlQueryElevationFlags(&local_8);
  if (-1 < iVar1) {
    *param_1 = local_8 & 1;
    iVar1 = 0;
  }
  RtlNtStatusToDosErrorNoTeb(iVar1);
  return;
}



void BaseElevationPostProcessing(byte param_1,short param_2,undefined4 param_3)

{
  undefined4 local_8;
  
                    // 0x18d70  56  BaseElevationPostProcessing
  if (((param_1 & 2) != 0) && ((param_2 == 0 || (param_2 == 10)))) {
    local_8 = 1;
    NtSetInformationProcess(param_3,0x30,&local_8,4);
  }
  return;
}



BOOL WritePrivateProfileStringA(LPCSTR lpAppName,LPCSTR lpKeyName,LPCSTR lpString,LPCSTR lpFileName)

{
  uint uVar1;
  BOOL BVar2;
  
                    // 0x18da0  1565  WritePrivateProfileStringA
  uVar1 = BaseDllReadWriteIniFile
                    ('\0','\x01','\0',(LPCWSTR)lpFileName,(short *)lpAppName,(short *)lpKeyName,
                     (short *)(-(uint)(lpKeyName != (LPCSTR)0x0) & (uint)lpString),(int *)0x0);
  if ((int)uVar1 < 0) {
    if (uVar1 == 0xc000007b) {
      RtlSetLastWin32Error(0xd);
    }
    else {
      BaseSetLastNTError(uVar1);
    }
    BVar2 = 0;
  }
  else {
    BVar2 = 1;
  }
  return BVar2;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

MMRESULT timeEndPeriod(UINT uPeriod)

{
  short sVar1;
  BOOL BVar2;
  int iVar3;
  short *psVar4;
  MMRESULT MVar5;
  undefined local_c [4];
  int local_8;
  
                    // 0x18de0  1604  timeEndPeriod
  MVar5 = 0;
  BVar2 = InitOnceExecuteOnce(&InitOnce_6b8b08c0,InitFn_6b814d50,(PVOID)0x0,(LPVOID *)0x0);
  if ((BVar2 == 0) || (uPeriod < DAT_6b8b0738)) {
    MVar5 = 0x61;
  }
  else if (uPeriod < DAT_6b8b074c) {
    RtlAcquireSRWLockExclusive(&DAT_6b8b08bc);
    psVar4 = (short *)(&DAT_6b8b0758 + (uPeriod - DAT_6b8b0738) * 2);
    if (*psVar4 == 0) {
      MVar5 = 0x61;
    }
    else {
      sVar1 = *psVar4 + -1;
      *psVar4 = sVar1;
      if ((sVar1 == 0) && (uPeriod == _DAT_6b8b0750)) {
        for (; (uPeriod < DAT_6b8b074c && (*psVar4 == 0)); psVar4 = psVar4 + 1) {
          uPeriod = uPeriod + 1;
        }
        NtSetTimerResolution(DAT_6b8b0754 * 10000,0,local_c);
        DAT_6b8b0754 = DAT_6b8b074c;
        _DAT_6b8b0750 = uPeriod;
        if ((uPeriod < DAT_6b8b074c) &&
           (iVar3 = NtSetTimerResolution(uPeriod * 10000,1,&local_8), -1 < iVar3)) {
          DAT_6b8b0754 = (local_8 + 9999U) / 10000;
        }
      }
    }
    RtlReleaseSRWLockExclusive(&DAT_6b8b08bc);
  }
  else {
    MVar5 = 0;
  }
  return MVar5;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

MMRESULT timeBeginPeriod(UINT uPeriod)

{
  short sVar1;
  BOOL BVar2;
  int iVar3;
  MMRESULT MVar4;
  uint local_8;
  
                    // 0x18ec0  1603  timeBeginPeriod
  MVar4 = 0;
  BVar2 = InitOnceExecuteOnce(&InitOnce_6b8b08c0,InitFn_6b814d50,(PVOID)0x0,(LPVOID *)0x0);
  if ((BVar2 != 0) && (DAT_6b8b0738 <= uPeriod)) {
    if (DAT_6b8b074c <= uPeriod) {
      return 0;
    }
    RtlAcquireSRWLockExclusive(&DAT_6b8b08bc);
    if (*(short *)(&DAT_6b8b0758 + (uPeriod - DAT_6b8b0738) * 2) != -1) {
      sVar1 = *(short *)(&DAT_6b8b0758 + (uPeriod - DAT_6b8b0738) * 2) + 1;
      *(short *)(&DAT_6b8b0758 + (uPeriod - DAT_6b8b0738) * 2) = sVar1;
      if ((sVar1 == 1) && (uPeriod < DAT_6b8b0754)) {
        local_8 = uPeriod * 10000;
        if (local_8 < DAT_6b8b07c8) {
          local_8 = DAT_6b8b07c8;
        }
        iVar3 = NtSetTimerResolution(local_8,1,&local_8);
        if (iVar3 < 0) {
          MVar4 = 0x61;
          *(short *)(&DAT_6b8b0758 + (uPeriod - DAT_6b8b0738) * 2) =
               *(short *)(&DAT_6b8b0758 + (uPeriod - DAT_6b8b0738) * 2) + -1;
        }
        else {
          _DAT_6b8b0750 = uPeriod;
          DAT_6b8b0754 = (local_8 + 0x26ac) / 10000;
        }
      }
      RtlReleaseSRWLockExclusive(&DAT_6b8b08bc);
      return MVar4;
    }
    RtlReleaseSRWLockExclusive(&DAT_6b8b08bc);
  }
  return 0x61;
}



BOOL SetCurrentDirectoryW(LPCWSTR lpPathName)

{
  BOOL BVar1;
  
                    // 0x18fb0  1293  SetCurrentDirectoryW
                    // WARNING: Could not recover jumptable at 0x6b818fb6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetCurrentDirectoryW(lpPathName);
  return BVar1;
}



// WARNING: Could not reconcile some variable overlaps

void __fastcall FUN_6b818fbc(undefined4 *param_1)

{
  BOOL BVar1;
  undefined4 uVar2;
  undefined4 extraout_EDX;
  _OSVERSIONINFOW local_124;
  undefined4 local_c;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_124.dwOSVersionInfoSize = 0x11c;
  BVar1 = GetVersionExW(&local_124);
  if ((((BVar1 == 0) || ((local_c & 0x10) == 0)) || ((local_c & 0x100) != 0)) ||
     ((local_c._2_1_ != '\x02' && (local_c._2_1_ != '\x03')))) {
    uVar2 = 0;
  }
  else {
    uVar2 = 1;
  }
  *param_1 = uVar2;
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,extraout_EDX);
  return;
}



int FindNLSStringEx(LPCWSTR lpLocaleName,DWORD dwFindNLSStringFlags,LPCWSTR lpStringSource,
                   int cchSource,LPCWSTR lpStringValue,int cchValue,LPINT pcchFound,
                   LPNLSVERSIONINFO lpVersionInformation,LPVOID lpReserved,LPARAM lParam)

{
  int iVar1;
  
                    // 0x19020  398  FindNLSStringEx
                    // WARNING: Could not recover jumptable at 0x6b819026. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = FindNLSStringEx(lpLocaleName,dwFindNLSStringFlags,lpStringSource,cchSource,lpStringValue,
                          cchValue,pcchFound,lpVersionInformation,lpReserved,lParam);
  return iVar1;
}



BOOL TzSpecificLocalTimeToSystemTime
               (TIME_ZONE_INFORMATION *lpTimeZoneInformation,SYSTEMTIME *lpLocalTime,
               LPSYSTEMTIME lpUniversalTime)

{
  BOOL BVar1;
  
                    // 0x19040  1455  TzSpecificLocalTimeToSystemTime
                    // WARNING: Could not recover jumptable at 0x6b819046. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = TzSpecificLocalTimeToSystemTime(lpTimeZoneInformation,lpLocalTime,lpUniversalTime);
  return BVar1;
}



BOOL SystemTimeToTzSpecificLocalTime
               (TIME_ZONE_INFORMATION *lpTimeZoneInformation,SYSTEMTIME *lpUniversalTime,
               LPSYSTEMTIME lpLocalTime)

{
  BOOL BVar1;
  
                    // 0x19060  1423  SystemTimeToTzSpecificLocalTime
                    // WARNING: Could not recover jumptable at 0x6b819066. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SystemTimeToTzSpecificLocalTime(lpTimeZoneInformation,lpUniversalTime,lpLocalTime);
  return BVar1;
}



BOOL GetComputerNameA(LPSTR lpBuffer,LPDWORD nSize)

{
  BOOL BVar1;
  DWORD DVar2;
  undefined4 *puVar3;
  LPWSTR lpBuffer_00;
  undefined4 extraout_EDX;
  undefined4 uVar4;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  int in_FS_OFFSET;
  undefined auStack52 [4];
  DWORD local_30;
  WCHAR local_2c [16];
  uint local_c;
  
                    // 0x19080  482  GetComputerNameA
  local_c = DAT_6b8b0140 ^ (uint)auStack52;
  lpBuffer_00 = local_2c;
  local_30 = 0x10;
  BVar1 = GetComputerNameW(lpBuffer_00,&local_30);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
    uVar4 = extraout_EDX_00;
    if (DVar2 != 0x6f) goto LAB_6b8190db;
    puVar3 = (undefined4 *)KernelBaseGetGlobalData();
    lpBuffer_00 = (LPWSTR)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                                          *puVar3,local_30 * 2);
    if (lpBuffer_00 == (LPWSTR)0x0) {
      RtlSetLastWin32Error(8);
      uVar4 = extraout_EDX_01;
      goto LAB_6b8190db;
    }
    BVar1 = GetComputerNameW(lpBuffer_00,&local_30);
    if (BVar1 == 0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpBuffer_00);
      uVar4 = extraout_EDX_02;
      goto LAB_6b8190db;
    }
  }
  FUN_6b8190ef(lpBuffer_00,lpBuffer,nSize);
  uVar4 = extraout_EDX;
  if (lpBuffer_00 != local_2c) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpBuffer_00);
    uVar4 = extraout_EDX_03;
  }
LAB_6b8190db:
  BVar1 = FUN_6b8224af(local_c ^ (uint)auStack52,uVar4);
  return BVar1;
}



undefined4 __fastcall FUN_6b8190ef(undefined4 param_1,undefined4 param_2,uint *param_3)

{
  int iVar1;
  uint uVar2;
  undefined local_14 [8];
  ushort local_c;
  undefined2 local_a;
  undefined4 local_8;
  
  iVar1 = RtlInitUnicodeStringEx(local_14,param_1);
  if (iVar1 < 0) {
    BaseSetLastNTError(iVar1);
    *param_3 = 0;
  }
  else {
    uVar2 = RtlxUnicodeStringToAnsiSize(local_14);
    if (uVar2 < *param_3 || uVar2 == *param_3) {
      local_a = 0xffff;
      if (*param_3 < 0x10000) {
        local_a = *(undefined2 *)param_3;
      }
      local_c = 0;
      local_8 = param_2;
      iVar1 = RtlUnicodeStringToAnsiString(&local_c,local_14,0);
      if (-1 < iVar1) {
        *param_3 = (uint)local_c;
        return 1;
      }
      BaseSetLastNTError(iVar1);
      *param_3 = 0;
    }
    else {
      RtlSetLastWin32Error(0x6f);
      *param_3 = uVar2;
    }
  }
  return 0;
}



DWORD GetProfileStringA(LPCSTR lpAppName,LPCSTR lpKeyName,LPCSTR lpDefault,LPSTR lpReturnedString,
                       DWORD nSize)

{
  DWORD DVar1;
  
                    // 0x19170  718  GetProfileStringA
  DVar1 = GetPrivateProfileStringA(lpAppName,lpKeyName,lpDefault,lpReturnedString,nSize,(LPCSTR)0x0)
  ;
  return DVar1;
}



HRESULT WerRegisterMemoryBlock(PVOID pvAddress,DWORD dwSize)

{
  HRESULT HVar1;
  
                    // 0x191a0  1519  WerRegisterMemoryBlock
                    // WARNING: Could not recover jumptable at 0x6b8191a6. Too many branches
                    // WARNING: Treating indirect jump as call
  HVar1 = WerRegisterMemoryBlock(pvAddress,dwSize);
  return HVar1;
}



BOOL GetLogicalProcessorInformation
               (PSYSTEM_LOGICAL_PROCESSOR_INFORMATION Buffer,PDWORD ReturnedLength)

{
  BOOL BVar1;
  
                    // 0x191c0  623  GetLogicalProcessorInformation
                    // WARNING: Could not recover jumptable at 0x6b8191c6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetLogicalProcessorInformation(Buffer,ReturnedLength);
  return BVar1;
}



void Process32First(undefined4 param_1,uint *param_2)

{
  undefined4 extraout_EDX;
  undefined4 uVar1;
  undefined4 extraout_EDX_00;
  int local_234;
  uint local_230;
  uint local_22c;
  uint local_228;
  uint local_224;
  uint local_220;
  uint local_21c;
  uint local_218;
  uint local_214;
  WCHAR local_210 [260];
  uint local_8;
  
                    // 0x191e0  1071  Process32First
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  if ((param_2 == (uint *)0x0) || (*param_2 < 0x128)) {
    BaseSetLastNTError(0xc0000004);
    uVar1 = extraout_EDX_00;
  }
  else {
    local_234 = 0x22c;
    Process32FirstW(param_1,&local_234);
    WideCharToMultiByte(0,0x400,local_210,-1,(LPSTR)(param_2 + 9),0x104,(LPCSTR)0x0,(LPBOOL)0x0);
    param_2[1] = local_230;
    param_2[2] = local_22c;
    param_2[3] = local_228;
    param_2[4] = local_224;
    param_2[5] = local_220;
    param_2[6] = local_21c;
    param_2[7] = local_218;
    param_2[8] = local_214;
    uVar1 = extraout_EDX;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar1);
  return;
}



BOOL EnumCalendarInfoA(CALINFO_ENUMPROCA lpCalInfoEnumProc,LCID Locale,CALID Calendar,
                      CALTYPE CalType)

{
  undefined4 uVar1;
  BOOL BVar2;
  
                    // 0x192b0  313  EnumCalendarInfoA
  uVar1 = NlsValidateLocale(&Locale,0);
  if (((CalType & 0x10000000) == 0) && ((CalType & 0xfffffff) < 0x38)) {
    BVar2 = Internal_EnumCalendarInfo(lpCalInfoEnumProc,uVar1,Calendar,CalType,0,0,0,0);
  }
  else {
    SetLastError(0x3ec);
    BVar2 = 0;
  }
  return BVar2;
}



LPSTR lstrcpyn(LPSTR lpString1,LPCSTR lpString2,int iMaxLength)

{
  LPSTR pCVar1;
  
                    // 0x19300  1597  lstrcpyn
                    // 0x19300  1598  lstrcpynA
                    // WARNING: Could not recover jumptable at 0x6b819306. Too many branches
                    // WARNING: Treating indirect jump as call
  pCVar1 = lstrcpynA(lpString1,lpString2,iMaxLength);
  return pCVar1;
}



BOOL VirtualLock(LPVOID lpAddress,SIZE_T dwSize)

{
  BOOL BVar1;
  
                    // 0x19320  1489  VirtualLock
                    // WARNING: Could not recover jumptable at 0x6b819326. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = VirtualLock(lpAddress,dwSize);
  return BVar1;
}



undefined4 __fastcall FUN_6b81932c(int param_1)

{
  if ((param_1 < 0) &&
     ((((param_1 == -0x3fffff75 || (param_1 == -0x3fffff77)) || (param_1 == -0x3fffff76)) ||
      (param_1 == -0x3ffffdfc)))) {
    return 1;
  }
  return 0;
}



void OutputDebugStringA(LPCSTR lpOutputString)

{
                    // WARNING: Could not recover jumptable at 0x6b819350. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x19350  1052  OutputDebugStringA
  OutputDebugStringA(lpOutputString);
  return;
}



BOOL SetDllDirectoryA(LPCSTR lpPathName)

{
  int iVar1;
  code *pcVar2;
  undefined local_14 [8];
  undefined4 local_c;
  undefined4 local_8;
  
                    // 0x19360  1297  SetDllDirectoryA
  local_c = 0;
  local_8 = 0;
  if (lpPathName == (LPCSTR)0x0) {
    RtlInitUnicodeString(&local_c,0);
  }
  else {
    iVar1 = RtlInitAnsiStringEx(local_14,lpPathName);
    if (iVar1 < 0) goto LAB_6b82bf20;
    pcVar2 = (code *)GetEightBitStringToUnicodeStringRoutine(&local_c,local_14,1);
    _guard_check_icall();
    iVar1 = (*pcVar2)();
    if (iVar1 < 0) goto LAB_6b82bf20;
  }
  iVar1 = LdrSetDllDirectory(&local_c);
  RtlFreeUnicodeString(&local_c);
  if (-1 < iVar1) {
    return 1;
  }
LAB_6b82bf20:
  BaseSetLastNTError(iVar1);
  return 0;
}



BOOL GetUserPreferredUILanguages
               (DWORD dwFlags,PULONG pulNumLanguages,PZZWSTR pwszLanguagesBuffer,
               PULONG pcchLanguagesBuffer)

{
  BOOL BVar1;
  
                    // 0x193e0  797  GetUserPreferredUILanguages
                    // WARNING: Could not recover jumptable at 0x6b8193e6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetUserPreferredUILanguages
                    (dwFlags,pulNumLanguages,pwszLanguagesBuffer,pcchLanguagesBuffer);
  return BVar1;
}



void __fastcall FUN_6b8193ec(int param_1,int param_2)

{
  undefined4 uVar1;
  int extraout_EDX;
  int extraout_EDX_00;
  int extraout_EDX_01;
  int extraout_EDX_02;
  int extraout_EDX_03;
  int iVar2;
  uint *puVar3;
  int iVar4;
  undefined local_21c [4];
  ushort local_218;
  ushort local_216;
  ushort *local_214;
  int local_210;
  undefined local_20c [8];
  ushort local_204;
  ushort local_200 [252];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  iVar4 = param_2;
  if ((*(uint *)(param_2 + 0x18) | *(uint *)(param_2 + 0x1c)) != 0) {
    for (puVar3 = (uint *)((DAT_6b8b083c - *(int *)(DAT_6b8b083c + 0x9e8)) +
                          *(int *)(param_2 + 0x18)); puVar3 != (uint *)0x0;
        puVar3 = (uint *)((*puVar3 - *(int *)(DAT_6b8b083c + 0x9e8)) + DAT_6b8b083c)) {
      local_218 = *(ushort *)(puVar3 + 2);
      local_216 = *(ushort *)((int)puVar3 + 10);
      if ((puVar3[4] | puVar3[5]) == 0) {
        local_214 = (ushort *)0x0;
      }
      else {
        local_214 = (ushort *)((puVar3[4] - *(int *)(DAT_6b8b083c + 0x9e8)) + DAT_6b8b083c);
      }
      iVar2 = FUN_6b811136(param_1,(ushort *)0x0,&local_218,'\x01');
      iVar4 = extraout_EDX_01;
      if (iVar2 < 0) goto LAB_6b819463;
      if ((*puVar3 | puVar3[1]) == 0) break;
    }
  }
  if (((((*(uint *)(param_2 + 0x20) | *(uint *)(param_2 + 0x24)) != 0) &&
       (iVar2 = (*(int *)(param_2 + 0x20) - *(int *)(DAT_6b8b083c + 0x9e8)) + DAT_6b8b083c,
       iVar2 != 0)) &&
      (uVar1 = FUN_6b81c868(param_1,(short **)0x0,(short **)&local_214), iVar4 = extraout_EDX,
      (char)uVar1 != '\0')) &&
     ((iVar2 = FUN_6b81bef2(param_1,iVar2,local_214,'\0',&local_210), iVar4 = extraout_EDX_00,
      -1 < iVar2 && (local_210 != -1)))) {
    iVar4 = 0;
    while (iVar2 = NtEnumerateValueKey(local_210,iVar4,0,local_20c,0x200,local_21c),
          iVar2 != -0x7fffffe6) {
      if (iVar2 < 0) {
LAB_6b82c059:
        NtClose(local_210);
        iVar4 = extraout_EDX_03;
        goto LAB_6b819463;
      }
      local_214 = local_200;
      local_218 = local_204;
      local_216 = local_204;
      iVar2 = FUN_6b811136(param_1,(ushort *)0x0,&local_218,'\x01');
      if (iVar2 < 0) goto LAB_6b82c059;
      iVar4 = iVar4 + 1;
    }
    NtClose(local_210);
    iVar4 = extraout_EDX_02;
  }
LAB_6b819463:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,iVar4);
  return;
}



LANGID GetUserDefaultLangID(void)

{
  LANGID LVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b819490. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x19490  793  GetUserDefaultLangID
  LVar1 = GetUserDefaultLangID();
  return LVar1;
}



BOOL EnumDateFormatsW(DATEFMT_ENUMPROCW lpDateFmtEnumProc,LCID Locale,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // 0x194a0  322  EnumDateFormatsW
                    // WARNING: Could not recover jumptable at 0x6b8194a6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumDateFormatsW(lpDateFmtEnumProc,Locale,dwFlags);
  return BVar1;
}



BOOL GetExitCodeProcess(HANDLE hProcess,LPDWORD lpExitCode)

{
  BOOL BVar1;
  DWORD DVar2;
  int iVar3;
  
                    // 0x194c0  578  GetExitCodeProcess
  BVar1 = GetExitCodeProcess(hProcess,lpExitCode);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
    iVar3 = FUN_6b836520(hProcess,lpExitCode);
    if (iVar3 == 0) {
      RtlSetLastWin32Error(DVar2);
      return 0;
    }
  }
  return 1;
}



void ReleaseActCtx(HANDLE hActCtx)

{
                    // WARNING: Could not recover jumptable at 0x6b8194f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x194f0  1202  ReleaseActCtx
  ReleaseActCtx(hActCtx);
  return;
}



UINT GetSystemWindowsDirectoryW(LPWSTR lpBuffer,UINT uSize)

{
  uint uVar1;
  
                    // 0x19500  755  GetSystemWindowsDirectoryW
  uVar1 = FUN_6b81f08b(lpBuffer,uSize);
  return uVar1;
}



BOOL EnumSystemLocalesEx(LOCALE_ENUMPROCEX lpLocaleEnumProcEx,DWORD dwFlags,LPARAM lParam,
                        LPVOID lpReserved)

{
  BOOL BVar1;
  
                    // 0x19520  345  EnumSystemLocalesEx
                    // WARNING: Could not recover jumptable at 0x6b819526. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumSystemLocalesEx(lpLocaleEnumProcEx,dwFlags,lParam,lpReserved);
  return BVar1;
}



BOOL SetProcessShutdownParameters(DWORD dwLevel,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // 0x19540  1355  SetProcessShutdownParameters
                    // WARNING: Could not recover jumptable at 0x6b819546. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetProcessShutdownParameters(dwLevel,dwFlags);
  return BVar1;
}



DWORD SetThreadIdealProcessor(HANDLE hThread,DWORD dwIdealProcessor)

{
  DWORD DVar1;
  
                    // 0x19560  1375  SetThreadIdealProcessor
                    // WARNING: Could not recover jumptable at 0x6b819566. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = SetThreadIdealProcessor(hThread,dwIdealProcessor);
  return DVar1;
}



void WerRegisterCustomMetadata(void)

{
                    // 0x19580  1515  WerRegisterCustomMetadata
                    // WARNING: Could not recover jumptable at 0x6b819586. Too many branches
                    // WARNING: Treating indirect jump as call
  WerRegisterCustomMetadata();
  return;
}



ATOM AddAtomA(LPCSTR lpString)

{
  uint uVar1;
  
                    // 0x195a0  8  AddAtomA
  uVar1 = FUN_6b81b8e7('\x01','\0',(uint)lpString,0);
  return (ATOM)uVar1;
}



HANDLE CreatePrivateNamespaceW
                 (LPSECURITY_ATTRIBUTES lpPrivateNamespaceAttributes,LPVOID lpBoundaryDescriptor,
                 LPCWSTR lpAliasPrefix)

{
  HANDLE pvVar1;
  
                    // 0x195c0  229  CreatePrivateNamespaceW
                    // WARNING: Could not recover jumptable at 0x6b8195c6. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = CreatePrivateNamespaceW(lpPrivateNamespaceAttributes,lpBoundaryDescriptor,lpAliasPrefix);
  return pvVar1;
}



int CompareStringEx(LPCWSTR lpLocaleName,DWORD dwCmpFlags,LPCWSTR lpString1,int cchCount1,
                   LPCWSTR lpString2,int cchCount2,LPNLSVERSIONINFO lpVersionInformation,
                   LPVOID lpReserved,LPARAM lParam)

{
  int iVar1;
  
                    // 0x195e0  159  CompareStringEx
                    // WARNING: Could not recover jumptable at 0x6b8195e6. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = CompareStringEx(lpLocaleName,dwCmpFlags,lpString1,cchCount1,lpString2,cchCount2,
                          lpVersionInformation,lpReserved,lParam);
  return iVar1;
}



BOOL EnumUILanguagesW(UILANGUAGE_ENUMPROCW lpUILanguageEnumProc,DWORD dwFlags,LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // 0x19600  351  EnumUILanguagesW
                    // WARNING: Could not recover jumptable at 0x6b819606. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumUILanguagesW(lpUILanguageEnumProc,dwFlags,lParam);
  return BVar1;
}



BOOL WritePrivateProfileStringW
               (LPCWSTR lpAppName,LPCWSTR lpKeyName,LPCWSTR lpString,LPCWSTR lpFileName)

{
  uint uVar1;
  BOOL BVar2;
  
                    // 0x19620  1566  WritePrivateProfileStringW
  uVar1 = BaseDllReadWriteIniFile
                    ('\x01','\x01','\0',lpFileName,lpAppName,lpKeyName,
                     (short *)(-(uint)(lpKeyName != (LPCWSTR)0x0) & (uint)lpString),(int *)0x0);
  if ((int)uVar1 < 0) {
    if (uVar1 == 0xc000007b) {
      RtlSetLastWin32Error(0xd);
    }
    else {
      BaseSetLastNTError(uVar1);
    }
    BVar2 = 0;
  }
  else {
    BVar2 = 1;
  }
  return BVar2;
}



BOOL SetThreadErrorMode(DWORD dwNewMode,LPDWORD lpOldMode)

{
  BOOL BVar1;
  
                    // 0x19660  1372  SetThreadErrorMode
                    // WARNING: Could not recover jumptable at 0x6b819666. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetThreadErrorMode(dwNewMode,lpOldMode);
  return BVar1;
}



BOOL EnumSystemLocalesW(LOCALE_ENUMPROCW lpLocaleEnumProc,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // 0x19680  346  EnumSystemLocalesW
                    // WARNING: Could not recover jumptable at 0x6b819686. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumSystemLocalesW(lpLocaleEnumProc,dwFlags);
  return BVar1;
}



BOOL EnumTimeFormatsW(TIMEFMT_ENUMPROCW lpTimeFmtEnumProc,LCID Locale,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // 0x196a0  349  EnumTimeFormatsW
                    // WARNING: Could not recover jumptable at 0x6b8196a6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumTimeFormatsW(lpTimeFmtEnumProc,Locale,dwFlags);
  return BVar1;
}



EXECUTION_STATE SetThreadExecutionState(EXECUTION_STATE esFlags)

{
  int iVar1;
  EXECUTION_STATE local_8;
  
                    // 0x196c0  1373  SetThreadExecutionState
  local_8 = 0;
  iVar1 = NtSetThreadExecutionState(esFlags,&local_8);
  if (iVar1 < 0) {
    BaseSetLastNTError(iVar1);
    local_8 = 0;
  }
  return local_8;
}



void K32GetModuleInformation(void)

{
                    // 0x196f0  938  K32GetModuleInformation
                    // WARNING: Could not recover jumptable at 0x6b8196f6. Too many branches
                    // WARNING: Treating indirect jump as call
  K32GetModuleInformation();
  return;
}



HANDLE CreateBoundaryDescriptorW(LPCWSTR Name,ULONG Flags)

{
  HANDLE pvVar1;
  
                    // 0x19710  185  CreateBoundaryDescriptorW
                    // WARNING: Could not recover jumptable at 0x6b819716. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = CreateBoundaryDescriptorW(Name,Flags);
  return pvVar1;
}



BOOL CopyFileExW(LPCWSTR lpExistingFileName,LPCWSTR lpNewFileName,
                LPPROGRESS_ROUTINE lpProgressRoutine,LPVOID lpData,LPBOOL pbCancel,DWORD dwCopyFlags
                )

{
  BOOL BVar1;
  
                    // 0x19730  176  CopyFileExW
                    // WARNING: Could not recover jumptable at 0x6b819736. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = CopyFileExW(lpExistingFileName,lpNewFileName,lpProgressRoutine,lpData,pbCancel,dwCopyFlags
                     );
  return BVar1;
}



BOOL VirtualUnlock(LPVOID lpAddress,SIZE_T dwSize)

{
  BOOL BVar1;
  
                    // 0x19750  1494  VirtualUnlock
                    // WARNING: Could not recover jumptable at 0x6b819756. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = VirtualUnlock(lpAddress,dwSize);
  return BVar1;
}



LSTATUS RegOpenKeyExW(HKEY hKey,LPCWSTR lpSubKey,DWORD ulOptions,REGSAM samDesired,PHKEY phkResult)

{
  LSTATUS LVar1;
  
                    // 0x19770  1175  RegOpenKeyExW
                    // WARNING: Could not recover jumptable at 0x6b819776. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegOpenKeyExW(hKey,lpSubKey,ulOptions,samDesired,phkResult);
  return LVar1;
}



DWORD QueueUserAPC(PAPCFUNC pfnAPC,HANDLE hThread,ULONG_PTR dwData)

{
  DWORD DVar1;
  
                    // 0x19790  1114  QueueUserAPC
                    // WARNING: Could not recover jumptable at 0x6b819796. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = QueueUserAPC(pfnAPC,hThread,dwData);
  return DVar1;
}



BOOL IsProcessInJob(HANDLE ProcessHandle,HANDLE JobHandle,PBOOL Result)

{
  BOOL BVar1;
  
                    // 0x197b0  906  IsProcessInJob
                    // WARNING: Could not recover jumptable at 0x6b8197b6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = IsProcessInJob(ProcessHandle,JobHandle,Result);
  return BVar1;
}



void DeleteBoundaryDescriptor(HANDLE BoundaryDescriptor)

{
                    // WARNING: Could not recover jumptable at 0x6b8197d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x197d0  277  DeleteBoundaryDescriptor
  DeleteBoundaryDescriptor(BoundaryDescriptor);
  return;
}



void BaseFreeAppCompatDataForProcessWorker(int param_1)

{
  int in_FS_OFFSET;
  
                    // 0x197e0  61  BaseFreeAppCompatDataForProcessWorker
                    // 0x197e0  1415  SortCloseHandle
  if (param_1 != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1);
  }
  return;
}



HRESULT WerRegisterRuntimeExceptionModule(PCWSTR pwszOutOfProcessCallbackDll,PVOID pContext)

{
  HRESULT HVar1;
  
                    // 0x19810  1521  WerRegisterRuntimeExceptionModule
                    // WARNING: Could not recover jumptable at 0x6b819816. Too many branches
                    // WARNING: Treating indirect jump as call
  HVar1 = WerRegisterRuntimeExceptionModule(pwszOutOfProcessCallbackDll,pContext);
  return HVar1;
}



BOOL AddSIDToBoundaryDescriptor(HANDLE *BoundaryDescriptor,PSID RequiredSid)

{
  BOOL BVar1;
  
                    // 0x19830  19  AddSIDToBoundaryDescriptor
                    // WARNING: Could not recover jumptable at 0x6b819836. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = AddSIDToBoundaryDescriptor(BoundaryDescriptor,RequiredSid);
  return BVar1;
}



LPWSTR lstrcpynW(LPWSTR lpString1,LPCWSTR lpString2,int iMaxLength)

{
  LPWSTR pWVar1;
  
                    // 0x19850  1599  lstrcpynW
                    // WARNING: Could not recover jumptable at 0x6b819856. Too many branches
                    // WARNING: Treating indirect jump as call
  pWVar1 = lstrcpynW(lpString1,lpString2,iMaxLength);
  return pWVar1;
}



BOOL GetNLSVersion(NLS_FUNCTION Function,LCID Locale,LPNLSVERSIONINFO lpVersionInformation)

{
  BOOL BVar1;
  
                    // 0x19870  639  GetNLSVersion
                    // WARNING: Could not recover jumptable at 0x6b819876. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetNLSVersion(Function,Locale,lpVersionInformation);
  return BVar1;
}



DWORD SearchPathA(LPCSTR lpPath,LPCSTR lpFileName,LPCSTR lpExtension,DWORD nBufferLength,
                 LPSTR lpBuffer,LPSTR *lpFilePart)

{
  DWORD DVar1;
  
                    // 0x19890  1243  SearchPathA
                    // WARNING: Could not recover jumptable at 0x6b819896. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = SearchPathA(lpPath,lpFileName,lpExtension,nBufferLength,lpBuffer,lpFilePart);
  return DVar1;
}



int LCMapStringA(LCID Locale,DWORD dwMapFlags,LPCSTR lpSrcStr,int cchSrc,LPSTR lpDestStr,int cchDest
                )

{
  int iVar1;
  
                    // 0x198b0  949  LCMapStringA
                    // WARNING: Could not recover jumptable at 0x6b8198b6. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = LCMapStringA(Locale,dwMapFlags,lpSrcStr,cchSrc,lpDestStr,cchDest);
  return iVar1;
}



BOOL GetStringTypeA(LCID Locale,DWORD dwInfoType,LPCSTR lpSrcStr,int cchSrc,LPWORD lpCharType)

{
  BOOL BVar1;
  
                    // 0x198d0  730  GetStringTypeA
                    // 0x198d0  731  GetStringTypeExA
                    // WARNING: Could not recover jumptable at 0x6b8198d6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetStringTypeA(Locale,dwInfoType,lpSrcStr,cchSrc,lpCharType);
  return BVar1;
}



BOOL GetNumaHighestNodeNumber(PULONG HighestNodeNumber)

{
  BOOL BVar1;
  
                    // 0x198f0  655  GetNumaHighestNodeNumber
                    // WARNING: Could not recover jumptable at 0x6b8198f6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetNumaHighestNodeNumber(HighestNodeNumber);
  return BVar1;
}



BOOL TerminateProcess(HANDLE hProcess,UINT uExitCode)

{
  BOOL BVar1;
  
                    // 0x19910  1426  TerminateProcess
                    // WARNING: Could not recover jumptable at 0x6b819916. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = TerminateProcess(hProcess,uExitCode);
  return BVar1;
}



UINT GetWindowsDirectoryW(LPWSTR lpBuffer,UINT uSize)

{
  UINT UVar1;
  
                    // 0x19930  812  GetWindowsDirectoryW
                    // WARNING: Could not recover jumptable at 0x6b819936. Too many branches
                    // WARNING: Treating indirect jump as call
  UVar1 = GetWindowsDirectoryW(lpBuffer,uSize);
  return UVar1;
}



HANDLE CreateMemoryResourceNotification(MEMORY_RESOURCE_NOTIFICATION_TYPE NotificationType)

{
  HANDLE pvVar1;
  
                    // 0x19950  220  CreateMemoryResourceNotification
                    // WARNING: Could not recover jumptable at 0x6b819956. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = CreateMemoryResourceNotification(NotificationType);
  return pvVar1;
}



BOOL SetProcessWorkingSetSize
               (HANDLE hProcess,SIZE_T dwMinimumWorkingSetSize,SIZE_T dwMaximumWorkingSetSize)

{
  BOOL BVar1;
  
                    // 0x19970  1356  SetProcessWorkingSetSize
  BVar1 = SetProcessWorkingSetSizeEx(hProcess,dwMinimumWorkingSetSize,dwMaximumWorkingSetSize,0);
  return BVar1;
}



BOOL EnumCalendarInfoExW(CALINFO_ENUMPROCEXW lpCalInfoEnumProcEx,LCID Locale,CALID Calendar,
                        CALTYPE CalType)

{
  BOOL BVar1;
  
                    // 0x19990  316  EnumCalendarInfoExW
                    // WARNING: Could not recover jumptable at 0x6b819996. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumCalendarInfoExW(lpCalInfoEnumProcEx,Locale,Calendar,CalType);
  return BVar1;
}



BOOL MoveFileExW(LPCWSTR lpExistingFileName,LPCWSTR lpNewFileName,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // 0x199b0  1006  MoveFileExW
                    // WARNING: Could not recover jumptable at 0x6b8199b6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = MoveFileExW(lpExistingFileName,lpNewFileName,dwFlags);
  return BVar1;
}



HANDLE OpenPrivateNamespaceW(LPVOID lpBoundaryDescriptor,LPCWSTR lpAliasPrefix)

{
  HANDLE pvVar1;
  
                    // 0x199d0  1040  OpenPrivateNamespaceW
                    // WARNING: Could not recover jumptable at 0x6b8199d6. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = OpenPrivateNamespaceW(lpBoundaryDescriptor,lpAliasPrefix);
  return pvVar1;
}



BOOLEAN ClosePrivateNamespace(HANDLE Handle,ULONG Flags)

{
  BOOLEAN BVar1;
  
                    // 0x199f0  142  ClosePrivateNamespace
                    // WARNING: Could not recover jumptable at 0x6b8199f6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = ClosePrivateNamespace(Handle,Flags);
  return BVar1;
}



BOOL FlushViewOfFile(LPCVOID lpBaseAddress,SIZE_T dwNumberOfBytesToFlush)

{
  BOOL BVar1;
  
                    // 0x19a10  424  FlushViewOfFile
                    // WARNING: Could not recover jumptable at 0x6b819a16. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = FlushViewOfFile(lpBaseAddress,dwNumberOfBytesToFlush);
  return BVar1;
}



// WARNING: Could not reconcile some variable overlaps

void CreateActCtxWWorker(HINSTANCE__ param_1)

{
  WCHAR WVar1;
  HMODULE pHVar2;
  bool bVar3;
  char cVar4;
  ushort uVar5;
  undefined3 extraout_var;
  uint uVar6;
  undefined4 uVar7;
  undefined4 *puVar8;
  int iVar9;
  WCHAR *pWVar10;
  int iVar11;
  uint uVar12;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  int *piVar13;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 extraout_EDX_04;
  uint uVar14;
  WCHAR **ppWVar15;
  uint *puVar16;
  wchar_t *_Src;
  HMODULE pHVar17;
  int in_FS_OFFSET;
  char *pcVar18;
  HMODULE local_354;
  WCHAR *local_350;
  int local_34c;
  undefined4 local_348;
  size_t local_344;
  undefined4 local_340;
  WCHAR *local_33c [2];
  ushort local_334;
  undefined2 local_332;
  WCHAR *local_330;
  int local_32c;
  WCHAR *local_328;
  HMODULE local_324;
  WCHAR *local_320;
  undefined4 local_31c;
  int local_318;
  int local_314;
  uint local_310;
  void *local_30c;
  int local_308;
  uint local_304;
  undefined4 local_300;
  undefined local_2fc [4];
  WCHAR *local_2f8;
  undefined local_2f4 [4];
  WCHAR *local_2f0;
  undefined local_2ec [4];
  WCHAR *local_2e8;
  uint local_2e4;
  WCHAR *local_2e0;
  WCHAR *local_2dc;
  WCHAR *local_2d8;
  uint local_2d4;
  uint local_2d0;
  uint local_2c8;
  WCHAR *local_2c4;
  WCHAR *local_2c0;
  WCHAR *local_2bc;
  uint local_2b8;
  uint local_2b4;
  uint local_2ac;
  WCHAR *local_2a8;
  WCHAR *local_2a4;
  WCHAR *local_2a0;
  uint local_29c;
  uint local_298;
  WCHAR local_290 [128];
  WCHAR local_190 [64];
  WCHAR local_110 [130];
  uint local_c;
  
                    // 0x19a30  183  CreateActCtxWWorker
  local_c = DAT_6b8b0140 ^ (uint)&local_354;
  local_348 = 0xffffffff;
  local_340 = 0x20;
  local_31c = 0;
  iVar11 = 7;
  ppWVar15 = local_33c;
  for (iVar9 = iVar11; iVar9 != 0; iVar9 = iVar9 + -1) {
    *ppWVar15 = (WCHAR *)0x0;
    ppWVar15 = ppWVar15 + 1;
  }
  local_314 = 0;
  local_34c = 0;
  puVar16 = &local_2e4;
  for (iVar9 = iVar11; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar16 = 0;
    puVar16 = puVar16 + 1;
  }
  local_320 = (WCHAR *)0x0;
  local_318 = 0;
  puVar16 = &local_2c8;
  for (iVar9 = iVar11; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar16 = 0;
    puVar16 = puVar16 + 1;
  }
  puVar16 = &local_2ac;
  for (; iVar11 != 0; iVar11 = iVar11 + -1) {
    *puVar16 = 0;
    puVar16 = puVar16 + 1;
  }
  local_300 = 0;
  local_350 = (WCHAR *)0x0;
  if ((param_1 == 0) || (uVar14 = *(int *)param_1 + param_1, uVar14 < param_1 + 0xcU)) {
    pHVar17 = *(HMODULE *)param_1;
    pcVar18 = "SXS: %s() Null %p or size 0x%lx too small\n";
    pWVar10 = (WCHAR *)param_1;
LAB_6b82518a:
    DbgPrintEx(0x33,0,pcVar18,"CreateActCtxWWorker",pWVar10,pHVar17);
LAB_6b825196:
    iVar9 = -0x3ffffff3;
  }
  else {
    pWVar10 = *(WCHAR **)(param_1 + 4);
    local_33c[0] = pWVar10;
    if ((((uint)pWVar10 & 0xffffff00) != 0) ||
       ((((uint)pWVar10 & 1) != 0 && (uVar14 < param_1 + 0xeU)))) {
LAB_6b8248a5:
      pHVar17 = *(HMODULE *)param_1;
      pcVar18 = "SXS: %s() Bad flags/size 0x%lx/0x%lx\n";
      goto LAB_6b82518a;
    }
    if (((uint)pWVar10 & 2) == 0) {
      uVar6 = *(int *)param_1 + param_1;
    }
    else {
      uVar6 = uVar14;
      if (uVar14 < param_1 + 0x10U) goto LAB_6b8248a5;
    }
    if (((((((uint)pWVar10 & 4) != 0) && (uVar6 = uVar14, uVar14 < param_1 + 0x14U)) ||
         ((local_33c[0]._0_1_ = (byte)pWVar10, ((uint)pWVar10 & 8) != 0 &&
          (uVar6 = uVar14, uVar14 < param_1 + 0x18U)))) ||
        ((((uint)pWVar10 & 0x20) != 0 && (uVar6 = uVar14, uVar14 < param_1 + 0x1cU)))) ||
       ((((uint)pWVar10 & 0x80) != 0 && (uVar6 < param_1 + 0x20U)))) goto LAB_6b8248a5;
    if ((((uint)pWVar10 & 0x40) != 0) && (((uint)pWVar10 & 0x88) != 0)) {
LAB_6b8248dd:
      iVar9 = -0x3ffffff3;
      goto LAB_6b819dff;
    }
    if ((((uint)pWVar10 & 0x10) != 0) &&
       (local_318 = *(int *)(in_FS_OFFSET + 0x30), *(int *)(local_318 + 0x1f8) != 0)) {
      iVar9 = -0x3feafff2;
      goto LAB_6b819dff;
    }
    local_33c[1] = *(WCHAR **)(param_1 + 8);
    if ((local_33c[1] == (WCHAR *)0x0) && (((uint)pWVar10 & 0x84) == 0)) goto LAB_6b8248dd;
    if (((uint)pWVar10 & 0x10) != 0) {
LAB_6b819b62:
      local_344 = 5;
      if (((byte)local_33c[0] & 1) == 0) {
        local_33c[0] = (WCHAR *)((uint)local_33c[0] | 1);
        uVar5 = 10;
LAB_6b819b7f:
        if (((byte)local_33c[0] & 2) != 0) {
          local_332 = *(undefined2 *)(param_1 + 0xe);
        }
        if (((uint)local_33c[0] & 0x80) != 0) {
          local_324 = *(HMODULE *)(param_1 + 0x1c);
        }
        if (((byte)local_33c[0] & 0x20) != 0) {
          local_328 = *(WCHAR **)(param_1 + 0x18);
        }
        local_334 = uVar5;
        if ((local_33c[1] == (WCHAR *)0x0) && (((uint)local_33c[0] & 0x80) != 0)) {
          local_2c4 = local_290;
          local_2c8 = 0x1000000;
          local_290[0] = L'\0';
          local_2b8 = 0x100;
          local_2b4 = 0x100;
          local_354 = local_324;
          local_2c0 = local_2c4;
          local_2bc = local_2c4;
          uVar14 = GetModuleFileNameW(local_324,local_290,0x80);
          while (uVar14 != 0) {
            if (uVar14 < local_2b8 >> 1) {
              uVar14 = uVar14 * 2;
              local_2c8 = local_2c8 & 0xffff0000 | uVar14 & 0xffff;
              local_350 = (WCHAR *)&DAT_00000001;
              local_33c[1] = local_2c4;
              goto LAB_6b819bbf;
            }
            uVar14 = uVar14 * 4 + 2;
            local_2c8 = local_2c8 & 0xffff0000 | (uint)(ushort)((short)local_2b8 - 2);
            if (0xfffe < uVar14) goto LAB_6b824e84;
            if ((local_2b8 < uVar14) &&
               (iVar9 = RtlpEnsureBufferSize(0,&local_2c0,uVar14), iVar9 < 0)) goto LAB_6b824cd0;
            local_2c4 = local_2c0;
            local_2c8 = local_2c8 & 0xffff | local_2b8 << 0x10;
            uVar14 = GetModuleFileNameW(local_324,local_2c0,local_2b8 >> 1);
          }
          goto LAB_6b824a1d;
        }
        uVar14 = local_2c8 & 0xffff;
LAB_6b819bbf:
        if (((uint)local_33c[0] & 4) != 0) {
          local_330 = *(WCHAR **)(param_1 + 0x10);
        }
        local_354 = (HMODULE)0x2;
        if (((byte)local_33c[0] & 0x40) == 0) {
          if (((uint)local_33c[0] & 4) == 0) {
            if (local_350 == (WCHAR *)0x0) {
              local_2c4 = local_290;
              local_2c8 = 0x1000000;
              local_290[0] = L'\0';
              local_2b8 = 0x100;
              local_2b4 = 0x100;
              local_2c0 = local_2c4;
              local_2bc = local_2c4;
              uVar14 = RtlGetFullPathName_U(local_33c[1],0x100,local_290,0);
              while (uVar14 != 0) {
                if (uVar14 <= local_2b8) {
                  uVar14 = uVar14 & 0xffff;
                  local_2c8 = local_2c8 & 0xffff0000 | uVar14;
                  local_33c[1] = local_2c4;
                  goto LAB_6b819c73;
                }
                uVar14 = uVar14 + 2;
                if (0xfffe < uVar14) goto LAB_6b824cc6;
                if ((local_2b8 < uVar14) &&
                   (iVar9 = RtlpEnsureBufferSize(0,&local_2c0,uVar14), iVar9 < 0)) break;
                local_2c4 = local_2c0;
                local_2c8 = local_2c8 & 0xffff | local_2b8 << 0x10;
                uVar14 = RtlGetFullPathName_U(local_33c[1],local_2b8,local_2c0,0);
              }
LAB_6b824cd0:
              iVar9 = -0x3fffffe9;
            }
            else {
LAB_6b819c73:
              local_2e0 = local_110;
              local_2e4 = 0x1000000;
              uVar12 = 0;
              local_2d4 = 0x100;
              local_110[0] = L'\0';
              uVar6 = (uVar14 & 0xffff) + 2;
              local_2d0 = 0x100;
              local_2dc = local_2e0;
              local_2d8 = local_2e0;
              if (0xfffe < uVar6) goto LAB_6b824e84;
              if (0x100 < uVar6) {
                iVar9 = RtlpEnsureBufferSize(0,&local_2dc,uVar6);
                if (iVar9 < 0) goto LAB_6b824cd0;
                uVar12 = local_2e4 & 0xffff;
                uVar14 = local_2c8 & 0xffff;
              }
              local_2e0 = local_2dc;
              memmove((void *)((int)local_2dc + (uVar12 & 0xfffe)),local_2c4,uVar14 & 0xffff);
              uVar14 = local_2e4 + local_2c8;
              local_2e4 = uVar14 & 0xffff | (uint)(ushort)((short)uVar14 + 2) << 0x10;
              *(undefined2 *)((int)local_2e0 + (uVar14 & 0xfffe)) = 0;
              iVar9 = RtlpApplyLengthFunction
                                (0,0x1c,&local_2e4,
                                 RtlGetLengthWithoutLastFullDosOrNtPathElement_exref);
              if (-1 < iVar9) {
                local_2e0[local_2e4 >> 1 & 0x7fff] = L'\0';
                local_33c[0] = (WCHAR *)((uint)local_33c[0] | 4);
                local_330 = local_2e0;
                pWVar10 = local_33c[1];
LAB_6b819d6b:
                local_33c[1] = pWVar10;
                pHVar17 = local_354;
                goto LAB_6b819d73;
              }
            }
          }
          else {
            if ((local_330 == (WCHAR *)0x0) || (*local_330 == L'\0')) {
              pcVar18 = "SXS: %s() Bad lpAssemblyDirectory %ls\n";
              pWVar10 = local_330;
              goto LAB_6b824979;
            }
            pHVar17 = (HMODULE)RtlDetermineDosPathNameType_U(local_330);
            pHVar2 = local_354;
            if (((pHVar17 != (HMODULE)&DAT_00000001) && (pHVar17 != local_354)) &&
               (pHVar17 != (HMODULE)0x6)) goto LAB_6b825196;
            if (local_33c[1] == (WCHAR *)0x0) {
              if (((uint)local_33c[0] & 0x20) != 0) {
                if ((local_328 == (WCHAR *)0x0) || (*local_328 == L'\0')) {
                  pcVar18 = "SXS: %s() Bad lpApplication name \'%ls\'\n";
                  pWVar10 = local_328;
                  goto LAB_6b824979;
                }
                RtlInitUnicodeString(&local_310,local_328);
                local_2a8 = local_190;
                local_190[0] = L'\0';
                local_29c = 0x80;
                uVar14 = (local_310 & 0xffff) + 2;
                local_298 = 0x80;
                local_2ac._0_2_ = 0;
                local_2ac = 0x800000;
                local_2a4 = local_2a8;
                local_2a0 = local_2a8;
                if (uVar14 < 0xffff) {
                  if (0x80 < uVar14) {
                    iVar9 = RtlpEnsureBufferSize(0,&local_2a4,uVar14);
                    if (iVar9 < 0) goto LAB_6b824cd0;
                  }
                  local_2a8 = local_2a4;
                  memmove(local_2a4 + ((ushort)local_2ac >> 1),local_30c,local_310 & 0xffff);
                  local_310 = local_310 + local_2ac;
                  local_2ac._0_2_ = (ushort)local_310;
                  local_2ac = local_310 & 0xffff | (uint)(ushort)((ushort)local_2ac + 2) << 0x10;
                  *(undefined2 *)((int)local_2a8 + (local_310 & 0xfffe)) = 0;
                  uVar14 = (local_310 & 0xffff) + 0x14;
                  if (uVar14 < 0xffff) {
                    if (local_29c < uVar14) {
                      iVar9 = RtlpEnsureBufferSize(0,&local_2a4,uVar14);
                      if (iVar9 < 0) goto LAB_6b824cd0;
                    }
                    local_2a8 = local_2a4;
                    memmove(local_2a4 + ((ushort)local_2ac >> 1),L".Manifest",0x12);
                    local_2ac._0_2_ = (short)local_2ac + 0x12;
                    local_2ac = CONCAT22((short)local_2ac + 0x14,(ushort)local_2ac);
                    local_2a8[(ushort)local_2ac >> 1] = L'\0';
                    uVar14 = (ushort)local_2ac + 4;
                    if (uVar14 < 0xffff) {
                      if (local_29c < uVar14) {
                        iVar9 = RtlpEnsureBufferSize(0,&local_2a4,uVar14);
                        if (iVar9 < 0) goto LAB_6b824cd0;
                      }
                      local_2ac = local_2ac & 0xffff | local_29c << 0x10;
                      local_2a8 = local_2a4;
                      local_2a4[(ushort)local_2ac >> 1] = L'\0';
                      _Src = local_2a4;
                      goto LAB_6b824cef;
                    }
                  }
                }
LAB_6b824cc6:
                iVar9 = -0x3ffffefa;
                goto LAB_6b819fe7;
              }
              _Src = L"Application.Manifest";
            }
            else {
              pHVar17 = (HMODULE)RtlDetermineDosPathNameType_U(local_33c[1]);
              pWVar10 = local_33c[1];
              if (((pHVar17 == (HMODULE)&DAT_00000001) || (pHVar17 == pHVar2)) ||
                 (pHVar17 == (HMODULE)0x6)) goto LAB_6b819d6b;
              _Src = local_33c[1];
              if (pHVar17 != (HMODULE)0x5) {
                pcVar18 = "SXS: %s() Bad lpSource PathType %ls, 0x%lx\n";
                goto LAB_6b82518a;
              }
            }
LAB_6b824cef:
            pWVar10 = local_330;
            do {
              WVar1 = *pWVar10;
              pWVar10 = (WCHAR *)((int)pWVar10 + (int)local_354);
            } while (WVar1 != (WCHAR)local_31c);
            local_308 = (int)pWVar10 - (int)(local_330 + 1) >> 1;
            local_344 = local_308 * 2;
            local_304 = (uint)(ushort)local_330[local_308 + -1];
            local_350 = _Src + 1;
            pWVar10 = _Src;
            do {
              WVar1 = *pWVar10;
              pWVar10 = pWVar10 + 1;
            } while (WVar1 != (WCHAR)local_31c);
            iVar9 = (int)pWVar10 - (int)local_350 >> 1;
            local_31c = 0x5c;
            local_308 = (uint)(local_330[local_308 + -1] != L'\\') + local_308;
            while( true ) {
              puVar8 = (undefined4 *)KernelBaseGetGlobalData();
              local_320 = (WCHAR *)RtlAllocateHeap(*(undefined4 *)
                                                    (*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar8,
                                                   (local_308 + iVar9) * 2 + 2);
              if (local_320 == (WCHAR *)0x0) break;
              memcpy(local_320,local_330,local_344);
              local_350 = (WCHAR *)(local_344 + (int)local_320);
              if ((WCHAR)local_304 != (WCHAR)local_31c) {
                *local_350 = (WCHAR)local_31c;
                local_350 = (WCHAR *)((int)local_350 + (int)local_354);
              }
              memcpy(local_350,_Src,iVar9 * 2);
              local_350[iVar9] = L'\0';
              pWVar10 = local_320;
              cVar4 = RtlDoesFileExists_U(local_320);
              if ((cVar4 != '\0') || (_Src != local_2a8)) goto LAB_6b819d6b;
              iVar9 = 0x14;
              _Src = L"Application.Manifest";
              RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_320);
            }
LAB_6b824e19:
            iVar9 = -0x3fffffe9;
          }
        }
        else {
          pHVar17 = local_354;
          if (local_330 == (WCHAR *)0x0) {
            local_2e0 = local_110;
            local_2e4 = 0x1000000;
            local_2d4 = 0x100;
            local_2d0 = 0x100;
            local_110[0] = L'\0';
            local_2dc = local_2e0;
            local_2d8 = local_2e0;
            iVar9 = KernelBaseGetGlobalData();
            if ((local_2e4 & 0xffff) + 2 + (uint)*(ushort *)(iVar9 + 8) < 0xffff) {
              iVar9 = KernelBaseGetGlobalData();
              if (local_2d4 < (local_2e4 & 0xffff) + 2 + (uint)*(ushort *)(iVar9 + 8)) {
                iVar9 = KernelBaseGetGlobalData();
                iVar9 = RtlpEnsureBufferSize
                                  (0,&local_2dc,
                                   (uint)*(ushort *)(iVar9 + 8) + (local_2e4 & 0xffff) + 2);
                if (iVar9 < 0) goto LAB_6b824cd0;
              }
              local_2e0 = local_2dc;
              iVar9 = KernelBaseGetGlobalData();
              iVar11 = KernelBaseGetGlobalData();
              memmove(local_2e0 + (local_2e4 >> 1 & 0x7fff),*(void **)(iVar11 + 0xc),
                      (uint)*(ushort *)(iVar9 + 8));
              iVar9 = KernelBaseGetGlobalData();
              pHVar17 = local_354;
              local_2e4 = local_2e4 & 0xffff |
                          (uint)(ushort)(*(short *)(iVar9 + 8) + (ushort)local_2e4 +
                                        (short)local_354) << 0x10;
              iVar9 = KernelBaseGetGlobalData();
              local_2e4._0_2_ = (ushort)local_2e4 + *(short *)(iVar9 + 8);
              local_2e4 = local_2e4 & 0xffff0000 | (uint)(ushort)local_2e4;
              local_2e0[(ushort)local_2e4 >> 1] = L'\0';
              uVar14 = (ushort)local_2e4 + 0x10;
              if (uVar14 < 0xffff) {
                if (local_2d4 < uVar14) {
                  iVar9 = RtlpEnsureBufferSize(0,&local_2dc,uVar14);
                  if (iVar9 < 0) goto LAB_6b824e19;
                }
                local_2e0 = local_2dc;
                memmove(local_2dc + ((ushort)local_2e4 >> 1),L"\\WinSxs",0xe);
                uVar5 = (short)local_2e4 + 0xe;
                local_2e4 = CONCAT22((short)local_2e4 + 0x10,uVar5);
                local_2e0[uVar5 >> 1] = L'\0';
                local_330 = local_2e0;
                local_33c[0] = (WCHAR *)((uint)local_33c[0] | 4);
                goto LAB_6b819d73;
              }
            }
LAB_6b824e84:
            iVar9 = -0x3ffffefa;
          }
          else {
LAB_6b819d73:
            if (((byte)local_33c[0] & 8) == 0) {
              uVar7 = 1;
              iVar9 = local_32c;
            }
            else {
              if (*(int *)(param_1 + 0x14) == 0) {
                DbgPrintEx(0x33,0,
                           "SXS: %s() ACTCTX_FLAG_RESOURCE_NAME_VALID set but lpResourceName == 0\n"
                           ,"CreateActCtxWWorker");
                goto LAB_6b825196;
              }
              local_314 = BaseDllMapResourceIdW(*(undefined4 *)(param_1 + 0x14));
              uVar7 = local_300;
              iVar9 = local_314;
              if (local_314 == -1) {
                DbgPrintEx(0x33,0,"SXS: %s() BaseDllMapResourceIdW failed\n","CreateActCtxWWorker");
                iVar9 = *(int *)(*(int *)(in_FS_OFFSET + 0x18) + 0xbf4);
                goto LAB_6b819fe7;
              }
            }
            local_32c = iVar9;
            iVar9 = FUN_6b81a00e(uVar7,(int)&local_340,(wchar_t *)&local_34c);
            if (-1 < iVar9) {
              if (local_34c == 0) goto LAB_6b8248dd;
              if (((uint)local_33c[0] & 0x10) == 0) {
                iVar9 = RtlCreateActivationContext(0,local_34c,0,FUN_6b821500,0,&local_348);
                if (-1 < iVar9) {
LAB_6b819df9:
                  iVar9 = 0;
                  local_34c = 0;
                  goto LAB_6b819dff;
                }
                if (((((iVar9 != -0x3fffffcc) && (iVar9 != -0x3fffff77)) && (iVar9 != -0x3fffff76))
                    && ((iVar9 != -0x3fffff75 && (iVar9 != -0x3ffffdfc)))) &&
                   ((iVar9 != -0x3feafffe && ((iVar9 != -0x3feafffc && (iVar9 != -0x3ffffff1)))))) {
                  pHVar17 = (HMODULE)0x0;
                }
                DbgPrintEx(0x33,pHVar17,"SXS: RtlCreateActivationContext() failed 0x%08lx\n",iVar9);
                local_348 = 0xffffffff;
              }
              else {
                piVar13 = (int *)(local_318 + 0x1f8);
                if (*piVar13 == 0) {
                  iVar9 = 0;
                  LOCK();
                  if (*piVar13 == 0) {
                    *piVar13 = local_34c;
                  }
                  else {
                    iVar9 = *piVar13;
                  }
                  if (iVar9 == 0) {
                    local_348 = 0;
                    goto LAB_6b819df9;
                  }
                }
                iVar9 = -0x3feafff2;
              }
            }
          }
        }
        goto LAB_6b819fe7;
      }
      uVar5 = *(ushort *)(param_1 + 0xc);
      pWVar10 = (WCHAR *)(uint)uVar5;
      local_354 = (HMODULE)0xa;
      if (uVar5 == 0) {
        uVar5 = 10;
      }
      if (uVar5 == 5) {
        uVar5 = 0xd;
      }
      local_344 = 0xffff;
      if ((uVar5 == 0xffff) || (uVar5 == 10)) goto LAB_6b819b7f;
      pcVar18 = "SXS: %s() bad wProcessorArchitecture 0x%x\n";
LAB_6b824979:
      DbgPrintEx(0x33,0,pcVar18,"CreateActCtxWWorker",pWVar10);
      goto LAB_6b825196;
    }
    bVar3 = FUN_6b81af82();
    if (CONCAT31(extraout_var,bVar3) != 0) {
      goto LAB_6b819b62;
    }
    local_348 = 0xfffffffd;
LAB_6b824a1d:
    iVar9 = 0;
  }
LAB_6b819fe7:
  if (local_34c != 0) {
    NtUnmapViewOfSection(0xffffffff,local_34c);
  }
LAB_6b819dff:
  BaseDllFreeResourceId(local_314);
  uVar7 = extraout_EDX;
  if (iVar9 < 0) {
    BaseSetLastNTError(iVar9);
    local_348 = 0xffffffff;
    uVar7 = extraout_EDX_00;
  }
  if (local_2dc != (WCHAR *)0x0) {
    if (local_2dc != local_2d8) {
      local_2f8 = local_2dc;
      RtlFreeUnicodeString(local_2fc);
      uVar7 = extraout_EDX_01;
    }
    local_2dc = local_2d8;
    local_2d4 = local_2d0;
  }
  if (local_2d8 != (WCHAR *)0x0) {
    *local_2d8 = L'\0';
  }
  local_2e4 = local_2d0 << 0x10;
  local_2e0 = local_2d8;
  if (local_2c0 != (WCHAR *)0x0) {
    if (local_2c0 != local_2bc) {
      local_2f0 = local_2c0;
      RtlFreeUnicodeString(local_2f4);
      uVar7 = extraout_EDX_02;
    }
    local_2c0 = local_2bc;
    local_2b8 = local_2b4;
  }
  if (local_2bc != (WCHAR *)0x0) {
    *local_2bc = L'\0';
  }
  local_2c8 = local_2b4 << 0x10;
  local_2c4 = local_2bc;
  if (local_2a4 != (WCHAR *)0x0) {
    if (local_2a4 != local_2a0) {
      local_2e8 = local_2a4;
      RtlFreeUnicodeString(local_2ec);
      uVar7 = extraout_EDX_03;
    }
    local_29c = local_298;
    local_2a4 = local_2a0;
  }
  if (local_2a0 != (WCHAR *)0x0) {
    *local_2a0 = L'\0';
  }
  local_2ac = local_298 << 0x10;
  local_2a8 = local_2a0;
  if (local_320 != (WCHAR *)0x0) {
    local_33c[1] = *(WCHAR **)(param_1 + 8);
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_320);
    uVar7 = extraout_EDX_04;
  }
  FUN_6b8224af(local_c ^ (uint)&local_354,uVar7);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void __fastcall FUN_6b81a00e(uint param_1,int param_2,wchar_t *param_3)

{
  wchar_t wVar1;
  short *psVar2;
  bool bVar3;
  byte bVar4;
  int iVar5;
  uint uVar6;
  uint *puVar7;
  int iVar8;
  int iVar9;
  wchar_t *pwVar10;
  uint *puVar11;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 extraout_EDX_04;
  undefined4 extraout_EDX_05;
  int *piVar12;
  undefined4 uVar13;
  int *piVar14;
  int in_FS_OFFSET;
  char *pcVar15;
  int local_6a8 [6];
  int local_690 [7];
  undefined local_674 [4];
  undefined2 *local_670;
  undefined local_66c [4];
  undefined2 *local_668;
  undefined local_664 [4];
  undefined2 *local_660;
  undefined local_65c [4];
  undefined2 *local_658;
  undefined local_654 [4];
  undefined2 *local_650;
  undefined local_64c [4];
  undefined local_648 [8];
  undefined local_640 [4];
  undefined2 *local_63c;
  uint *local_638;
  int *local_634;
  undefined4 local_630;
  uint local_62c;
  uint *local_628;
  uint *local_624;
  int *local_620;
  int *local_61c;
  undefined4 local_618;
  undefined4 local_614;
  uint *local_610;
  undefined4 local_60c;
  undefined4 local_608;
  undefined4 local_604;
  undefined4 local_600;
  int local_5fc;
  int local_5f8;
  uint local_5f4;
  wchar_t *local_5f0;
  uint local_5ec;
  int local_5e8;
  int local_5e4;
  int local_5e0 [4];
  uint local_5d0;
  uint local_5cc;
  uint local_5c8;
  wchar_t *local_5c4;
  int *local_5c0;
  uint **local_5bc;
  wchar_t *local_5b8;
  int local_5b4;
  int local_5b0;
  int local_5ac;
  int local_5a8;
  int *local_5a4;
  uint local_5a0;
  undefined2 local_59c;
  int local_598;
  undefined2 *local_594;
  undefined2 local_590 [20];
  undefined local_568 [4];
  int local_564;
  int local_560;
  ushort local_540;
  ushort uStack1342;
  undefined2 uStack1340;
  undefined2 uStack1338;
  undefined local_538 [16];
  uint local_528;
  wchar_t *local_524;
  undefined4 local_3f8;
  undefined2 *local_3f4;
  undefined2 *local_3f0;
  undefined2 *local_3ec;
  undefined4 local_3e8;
  undefined4 local_3e4;
  int local_3dc;
  undefined2 *local_3d8;
  undefined2 *local_3d4;
  undefined2 *local_3d0;
  int local_3cc;
  int local_3c8;
  int local_3c0;
  undefined2 *local_3bc;
  undefined2 *local_3b8;
  undefined2 *local_3b4;
  int local_3b0;
  int local_3ac;
  uint local_3a4;
  undefined2 *local_3a0;
  undefined2 *local_39c;
  undefined2 *local_398;
  int local_394;
  int local_390;
  int local_388;
  undefined2 *local_384;
  undefined2 *local_380;
  undefined2 *local_37c;
  int local_378;
  int local_374;
  int local_36c;
  undefined2 *local_368;
  undefined2 *local_364;
  undefined2 *local_360;
  int local_35c;
  int local_358;
  uint local_350;
  wchar_t *local_34c;
  undefined4 local_348;
  wchar_t *local_344;
  undefined4 local_340;
  wchar_t *local_33c;
  uint local_338;
  wchar_t *local_334;
  undefined4 local_330;
  wchar_t *local_32c;
  undefined4 local_328;
  wchar_t *local_324;
  undefined2 local_320 [64];
  undefined2 local_2a0 [64];
  undefined2 local_220 [64];
  undefined2 local_1a0 [64];
  undefined2 local_120 [64];
  undefined2 local_a0 [66];
  wchar_t local_1c;
  undefined local_1a [14];
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_5b8 = param_3;
  local_628 = &local_5f4;
  local_624 = &local_5c8;
  local_620 = &local_3dc;
  local_61c = &local_3c0;
  piVar12 = (int *)0x0;
  local_5bc = (uint **)0x0;
  piVar14 = local_5e0;
  local_5b0 = param_2;
  for (iVar9 = 6; iVar9 != 0; iVar9 = iVar9 + -1) {
    *piVar14 = 0;
    piVar14 = piVar14 + 1;
  }
  local_630 = 0;
  piVar14 = local_6a8;
  local_62c = param_1;
  for (iVar9 = 6; iVar9 != 0; iVar9 = iVar9 + -1) {
    *piVar14 = 0;
    piVar14 = piVar14 + 1;
  }
  local_600 = 0;
  piVar14 = local_690;
  for (iVar9 = 6; iVar9 != 0; iVar9 = iVar9 + -1) {
    *piVar14 = 0;
    piVar14 = piVar14 + 1;
  }
  local_638 = &local_3a4;
  local_5c0 = (int *)0x0;
  local_634 = &local_388;
  local_5a4 = (int *)0x0;
  local_5a8 = 1;
  local_5e8 = 1;
  local_5ac = 0;
  local_5b4 = 0;
  local_5f8 = 0;
  local_5fc = 0;
  local_5e4 = 0;
  memset(&local_5a0,0,0x1a8);
  iVar9 = local_5b0;
  local_3d8 = local_1a0;
  local_3dc = 0x800000;
  local_1a0[0] = 0;
  local_3bc = local_120;
  local_120[0] = 0;
  local_3a0 = local_a0;
  local_3cc = 0x80;
  local_3c8 = 0x80;
  local_3b0 = 0x80;
  local_3ac = 0x80;
  local_3c0 = 0x800000;
  local_394 = 0x80;
  local_390 = 0x80;
  local_a0[0] = 0;
  local_384 = local_220;
  local_220[0] = 0;
  local_368 = local_2a0;
  local_2a0[0] = 0;
  local_3f4 = local_320;
  local_320[0] = 0;
  local_59c = *(undefined2 *)(local_5b0 + 0xc);
  local_3a4 = 0x800000;
  local_378 = 0x80;
  local_374 = 0x80;
  local_388 = 0x800000;
  local_35c = 0x80;
  local_358 = 0x80;
  local_36c = 0x800000;
  local_3e8 = 0x80;
  local_3e4 = 0x80;
  local_3f8 = 0x800000;
  local_5c4 = (wchar_t *)0x0;
  local_3f0 = local_3f4;
  local_3ec = local_3f4;
  local_3d4 = local_3d8;
  local_3d0 = local_3d8;
  local_3b8 = local_3bc;
  local_3b4 = local_3bc;
  local_39c = local_3a0;
  local_398 = local_3a0;
  local_380 = local_384;
  local_37c = local_384;
  local_364 = local_368;
  local_360 = local_368;
  if ((*(byte *)(local_5b0 + 4) & 2) == 0) {
LAB_6b81a27a:
    iVar5 = FUN_6b81af26(0x38,(short *)&local_36c);
    piVar14 = local_5a4;
    if (-1 < iVar5) {
      local_598 = local_36c;
      local_594 = local_368;
      local_528 = *(uint *)(iVar9 + 0x14);
      if ((local_528 & 0xffff0000) != 0) {
        local_528 = 0xffffffff;
      }
      RtlInitUnicodeString(&local_540,*(undefined4 *)(iVar9 + 0x10));
      if ((local_540 == 0) ||
         (((local_540 & 0xfffe) < (uStack1342 & 0xfffe) &&
          (*(short *)(CONCAT22(uStack1338,uStack1340) + (uint)(local_540 >> 1) * 2) == 0)))) {
        psVar2 = *(short **)(iVar9 + 8);
        if ((psVar2 == (short *)0x0) || (*psVar2 == 0)) {
          DbgPrintEx(0x33,0,"SXS: %s() empty lpSource %ls\n","BasepCreateActCtx",psVar2);
          piVar14 = local_5a4;
        }
        else {
          local_5e0[1] = 0xffffffff;
          uVar13 = 2;
          local_524 = local_5b8;
          if ((*(byte *)(iVar9 + 4) & 0x40) == 0) {
            RtlInitUnicodeString(&local_5f4,psVar2);
            RtlDetermineDosPathNameType_U(*(undefined4 *)(iVar9 + 8));
            iVar5 = RtlDosPathNameToNtPathName_U_WithStatus(local_5f0,&local_5c8,0,0);
            piVar12 = local_5a4;
            piVar14 = local_5a4;
            if (iVar5 < 0) goto LAB_6b81a809;
            local_5b8 = wcsrchr(local_5f0,L'.');
            if ((*(byte *)(iVar9 + 4) & 0x80) != 0) {
              local_5d0 = *(uint *)(iVar9 + 0x1c);
              local_5e0[0] = 0;
              local_5e0[2] = 0;
              local_5cc = 0;
              local_5a8 = 0;
              iVar5 = 1;
              goto LAB_6b81a3c2;
            }
            local_610 = &local_5c8;
            local_618 = 0x18;
            local_614 = 0;
            local_60c = 0x40;
            local_608 = 0;
            local_604 = 0;
            puVar7 = (uint *)NtOpenFile(local_5e0,0x1200a9,&local_618,local_648,5,0x60);
            if ((int)puVar7 < 0) goto LAB_6b8252e3;
            if ((local_5b8 != (wchar_t *)0x0) &&
               ((iVar5 = _wcsicmp(local_5b8,L".dll"), iVar5 == 0 ||
                (iVar5 = _wcsicmp(local_5b8,L".exe"), iVar5 == 0)))) {
              iVar5 = *(int *)(in_FS_OFFSET + 0x18);
              if (*(int *)(iVar5 + 0xfdc) < 0) {
                iVar5 = iVar5 + *(int *)(iVar5 + 0xfdc);
              }
              if (iVar5 == *(int *)(iVar5 + 0x18)) {
                puVar11 = *(uint **)(iVar5 + 0xe38);
              }
              else {
                puVar11 = *(uint **)(iVar5 + 0x14d0);
              }
              if (DAT_6b8b0708 < *puVar11) goto LAB_6b81aaed;
              puVar7 = (uint *)NtCreateSection(local_5e0 + 2,4,0,0,2,0x11000000,local_5e0[0]);
              if (-1 < (int)puVar7) {
                local_5e4 = 1;
                goto LAB_6b81aaed;
              }
              if ((((puVar7 == (uint *)0xc000007b) || (puVar7 == (uint *)0xc000012f)) ||
                  (puVar7 == (uint *)0xc0000130)) ||
                 ((puVar7 == (uint *)0xc0000131 || (puVar7 == (uint *)0xc000035a)))) {
                puVar7 = (uint *)0x0;
                goto LAB_6b81aaed;
              }
              if ((((puVar7 != (uint *)0xc0000034) && (puVar7 != (uint *)0xc0000089)) &&
                  ((puVar7 != (uint *)0xc000008a &&
                   (((puVar7 != (uint *)0xc000008b && (puVar7 != (uint *)0xc0000204)) &&
                    (puVar7 != (uint *)0xc0150002)))))) &&
                 ((puVar7 != (uint *)0xc0150004 && (puVar7 != (uint *)0xc000000f)))) {
                uVar13 = 0;
              }
              pcVar15 = "SXS: %s() NtCreateSection() failed. Status = 0x%x\n";
              goto LAB_6b825368;
            }
LAB_6b81aaed:
            if (local_5e0[2] == 0) {
              puVar7 = (uint *)NtCreateSection(local_5e0 + 2,4,0,0,2,0x8000000,local_5e0[0]);
            }
            if ((int)puVar7 < 0) {
              iVar5 = local_5ac;
              if (puVar7 != (uint *)0xc0000040) {
                if ((((puVar7 != (uint *)0xc0000034) && (puVar7 != (uint *)0xc0000089)) &&
                    ((puVar7 != (uint *)0xc000008a &&
                     (((puVar7 != (uint *)0xc000008b && (puVar7 != (uint *)0xc0000204)) &&
                      (puVar7 != (uint *)0xc0150002)))))) &&
                   ((puVar7 != (uint *)0xc0150004 && (puVar7 != (uint *)0xc000000f)))) {
                  uVar13 = 0;
                }
                pcVar15 = "SXS: %s() NtCreateSection() failed. Status = 0x%x.\n";
                goto LAB_6b825368;
              }
            }
            else {
              local_5ec = 0;
              iVar5 = NtMapViewOfSection(local_5e0[2],0xffffffff,&local_5ec,0,0,0,&local_600,1,0,2);
              if (iVar5 < 0) {
                if (iVar5 != -0x3fffffe9) {
                  if (((iVar5 != -0x3fffffcc) && (iVar5 != -0x3fffff77)) &&
                     ((iVar5 != -0x3fffff76 &&
                      ((((iVar5 != -0x3fffff75 && (iVar5 != -0x3ffffdfc)) && (iVar5 != -0x3feafffe))
                       && ((iVar5 != -0x3feafffc && (iVar5 != -0x3ffffff1)))))))) {
                    uVar13 = 0;
                  }
                  DbgPrintEx(0x33,uVar13,"SXS: %s() NtMapViewOfSection failed\n","BasepCreateActCtx"
                            );
                  piVar12 = local_5a4;
                  piVar14 = local_5a4;
                  goto LAB_6b81a809;
                }
                NtClose(local_5e0[2]);
                local_5e0[2] = 0;
              }
              else {
                local_5d0 = local_5ec;
                if (local_5e4 == 0) {
                  local_5d0 = local_5ec | 1;
                }
                local_5cc = 0;
              }
              iVar5 = 0;
            }
LAB_6b81a3c2:
            if ((local_5d0 | local_5cc) == 0) {
              if (*(int *)(iVar9 + 0x14) != 0) goto LAB_6b81a3fb;
LAB_6b81abd7:
              bVar3 = false;
              local_5c0 = local_5e0;
              local_5ac = 0;
            }
            else {
              iVar9 = RtlImageNtHeaderEx(iVar5,local_5d0 & 0xfffffffc,local_600,0,&local_630);
              if (iVar9 < 0) {
                local_5e8 = local_5a8;
                piVar12 = local_5a4;
                piVar14 = local_5a4;
                if (iVar9 != -0x3fffff85) goto LAB_6b81a809;
                goto LAB_6b81abd7;
              }
LAB_6b81a3fb:
              local_5c0 = local_6a8;
              bVar3 = true;
              local_5ac = 1;
            }
            local_5e8 = 0;
            piVar12 = (int *)(-(uint)bVar3 & (uint)local_5e0);
            piVar14 = piVar12;
            if (bVar3) {
              if ((*(byte *)(local_5b0 + 4) & 8) != 0) {
LAB_6b81a43c:
                local_338 = local_5f4;
                local_334 = local_5f0;
                local_330 = 0;
                local_32c = (wchar_t *)0x0;
                if ((*(byte *)(local_5b0 + 4) & 8) != 0) {
                  uVar6 = *(uint *)(local_5b0 + 0x14);
                  if ((uVar6 & 0xffff0000) == 0) {
                    if (uVar6 != 1) {
                      swprintf_s(&local_1c,8,L".%lu",uVar6);
                      pwVar10 = &local_1c;
                      do {
                        wVar1 = *pwVar10;
                        pwVar10 = pwVar10 + 1;
                      } while (wVar1 != L'\0');
                      local_330 = CONCAT22(0x10,(short)((int)pwVar10 - (int)local_1a >> 1) * 2);
                      local_32c = &local_1c;
                    }
                  }
                  else {
                    RtlInitUnicodeString(&local_330,uVar6);
                  }
                }
                local_328 = 0x10000e;
                local_324 = L".Config";
                if ((local_5b8 != (wchar_t *)0x0) &&
                   (iVar9 = _wcsicmp(local_5b8,L".Manifest"), iVar9 == 0)) {
                  local_5bc = (uint **)0x12;
                  local_338 = local_338 & 0xffff0000 | (uint)(ushort)((short)local_338 - 0x12);
                }
                iVar9 = RtlMultiAppendUnicodeStringBuffer(&local_3dc,3,&local_338);
                if (-1 < iVar9) {
                  local_334 = local_5c4;
                  local_338 = local_5c8 & 0xffff0000 |
                              (uint)(ushort)((short)local_5c8 - (short)local_5bc);
                  local_5a4 = piVar12;
                  iVar9 = RtlMultiAppendUnicodeStringBuffer(&local_3c0,3,&local_338);
                  if (-1 < iVar9) {
                    if (local_5ac == 0) {
LAB_6b81a632:
                      bVar4 = 1;
LAB_6b81a635:
                      local_5bc = &local_638;
                      if (local_5ac == 0) {
                        local_5bc = &local_628;
                      }
                      iVar9 = *(int *)(local_5b0 + 0x14);
                      local_5a4 = piVar12;
                      uVar6 = FUN_6b81ad7d((undefined4 *)0x0,iVar9,0,0,0,0,
                                           (int *)(-(uint)bVar4 & (uint)local_5bc),local_5c0,
                                           (int *)(-(uint)(local_5ac != 0) & (uint)&local_628),
                                           piVar12,iVar9,
                                           (int *)(~-(uint)(iVar9 != 1) & (uint)&local_620),
                                           (int *)(~-(uint)(iVar9 != 1) & (uint)local_690),
                                           &local_5a0,local_590,
                                           (undefined2 *)(~-(uint)(iVar9 != 1) & (uint)local_568));
                      if (local_5a0 == 0) {
                        if ((int)uVar6 < 0) goto LAB_6b81ad14;
                      }
                      else {
                        if ((local_5a0 & 2) == 0) {
                          iVar9 = FUN_6b81b001(uVar6);
                          uVar6 = uVar6 & ~-(uint)(iVar9 != 0);
                        }
                        if (-1 < (int)uVar6) {
                          local_5a4 = piVar12;
                          if (*(int *)(local_5b0 + 0x14) != 1) {
                            local_564 = *local_620;
                            local_560 = local_620[1];
                          }
                          goto LAB_6b81a72f;
                        }
LAB_6b81ad14:
                        if ((((((uVar6 != 0xc000008b) && (uVar6 != 0xc0000034)) &&
                              (uVar6 != 0xc0000089)) &&
                             ((uVar6 != 0xc000008a && (uVar6 != 0xc0000204)))) &&
                            (uVar6 != 0xc0150002)) &&
                           ((uVar6 != 0xc0150004 && (uVar6 != 0xc000000f)))) {
                          uVar13 = 0;
                        }
                      }
                      DbgPrintEx(0x33,uVar13,"SXS: %s() BasepSxsCreateStreams() failed\n",
                                 "BasepCreateActCtx");
                      piVar14 = local_5a4;
                    }
                    else {
                      local_350 = local_5f4;
                      local_34c = local_5f0;
                      local_348 = local_330;
                      local_344 = local_32c;
                      local_340 = 0x140012;
                      local_33c = L".Manifest";
                      local_5a4 = piVar12;
                      iVar9 = RtlMultiAppendUnicodeStringBuffer(&local_3a4,3,&local_350);
                      if (-1 < iVar9) {
                        local_350 = local_5c8;
                        local_34c = local_5c4;
                        local_5a4 = piVar12;
                        iVar9 = RtlMultiAppendUnicodeStringBuffer(&local_388,3,&local_350);
                        if (-1 < iVar9) {
                          if ((local_62c & 1) == 0) goto LAB_6b81a632;
                          bVar4 = 0;
                          goto LAB_6b81a635;
                        }
                      }
                    }
                  }
                }
              }
            }
            else if (*(int *)(local_5b0 + 0x14) == 0) goto LAB_6b81a43c;
          }
          else {
            local_5a0 = 8;
            RtlInitUnicodeString(local_538,psVar2);
LAB_6b81a72f:
            if ((local_5a0 & 8) == 0) {
              iVar9 = local_5e0[0];
              if (local_5e0[0] != 0) {
LAB_6b81a7ba:
                local_5b4 = iVar9;
                uVar6 = FUN_6b81afa6(local_5b4);
                if (uVar6 == 0) {
                  local_5a0 = local_5a0 | 0x40;
                }
                goto LAB_6b81a7ca;
              }
              local_610 = &local_5c8;
              local_618 = 0x18;
              local_614 = 0;
              local_60c = 0x40;
              local_608 = 0;
              local_604 = 0;
              puVar7 = (uint *)NtOpenFile(&local_5b4,0x120089,&local_618,local_648,5,0x60);
              if (-1 < (int)puVar7) {
                local_5f8 = 1;
                iVar9 = local_5b4;
                goto LAB_6b81a7ba;
              }
LAB_6b8252e3:
              piVar12 = local_5a4;
              piVar14 = local_5a4;
              if ((((puVar7 == (uint *)0xc0000034) || (puVar7 == (uint *)0xc0000089)) ||
                  (puVar7 == (uint *)0xc000008a)) ||
                 (((puVar7 == (uint *)0xc000008b || (puVar7 == (uint *)0xc0000204)) ||
                  ((puVar7 == (uint *)0xc0150002 ||
                   ((puVar7 == (uint *)0xc0150004 || (puVar7 == (uint *)0xc000000f))))))))
              goto LAB_6b81a809;
              pcVar15 = "SXS: %s() NtOpenFile(%wZ) failed\n";
              uVar13 = 0;
              puVar7 = local_610;
            }
            else {
LAB_6b81a7ca:
              if ((*(uint *)(*(int *)(*(int *)(*(int *)(in_FS_OFFSET + 0x18) + 0x30) + 0x10) + 8) &
                  0x8000) != 0) {
                local_5a0 = local_5a0 | 0x80;
              }
              puVar7 = (uint *)FUN_6b8224a0();
              piVar12 = local_5a4;
              piVar14 = local_5a4;
              if (-1 < (int)puVar7) goto LAB_6b81a809;
              if (((((puVar7 != (uint *)0xc0000022) && (puVar7 != (uint *)0xc0000034)) &&
                   (puVar7 != (uint *)0xc0000089)) &&
                  (((puVar7 != (uint *)0xc000008a && (puVar7 != (uint *)0xc000008b)) &&
                   ((puVar7 != (uint *)0xc0000204 &&
                    ((puVar7 != (uint *)0xc0150002 && (puVar7 != (uint *)0xc0150004)))))))) &&
                 (puVar7 != (uint *)0xc000000f)) {
                uVar13 = 0;
              }
              pcVar15 = "SXS: %s() Calling csrss server failed. Status = 0x%x\n";
            }
LAB_6b825368:
            DbgPrintEx(0x33,uVar13,pcVar15,"BasepCreateActCtx",puVar7);
            piVar12 = local_5a4;
            piVar14 = local_5a4;
          }
        }
      }
      else {
        DbgPrintEx(0x33,0,"SXS: %s() AssemblyDirectory is not null terminated\n","BasepCreateActCtx"
                  );
        piVar14 = local_5a4;
      }
    }
LAB_6b81a809:
    local_5a4 = piVar14;
    iVar5 = local_5a8;
    if (local_5fc != 0) {
      RtlSetThreadPreferredUILanguages(8,local_3f4,local_64c);
    }
    if (iVar5 == 0) goto LAB_6b81a81e;
  }
  else {
    iVar8 = FUN_6b81af26(0x48,(short *)&local_3f8);
    iVar5 = local_5a8;
    if (-1 < iVar8) {
      SetThreadUILanguage(*(LANGID *)(iVar9 + 0xe));
      local_5fc = 1;
      goto LAB_6b81a27a;
    }
  }
  if (((local_5d0 | local_5cc) != 0) && (local_5e4 == 0)) {
    local_5d0 = local_5d0 & 0xfffffffc;
    local_5cc = 0;
  }
LAB_6b81a81e:
  if (local_5e8 != 0) {
    FUN_6b81ad44(local_5e0);
  }
  if (local_5c0 != (int *)0x0) {
    FUN_6b81ad44(local_5c0);
  }
  if ((piVar12 != (int *)0x0) && (iVar5 != 0)) {
    FUN_6b81ad44(piVar12);
  }
  FUN_6b81ad44(local_690);
  if ((local_5f8 != 0) && (local_5b4 != 0)) {
    NtClose(local_5b4);
  }
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_5c4);
  uVar13 = extraout_EDX;
  if (local_3d4 != (undefined2 *)0x0) {
    if (local_3d4 != local_3d0) {
      local_670 = local_3d4;
      RtlFreeUnicodeString(local_674);
      uVar13 = extraout_EDX_01;
    }
    local_3d4 = local_3d0;
    local_3cc = local_3c8;
  }
  if (local_3d0 != (undefined2 *)0x0) {
    *local_3d0 = 0;
  }
  local_3dc = local_3c8 << 0x10;
  local_3d8 = local_3d0;
  if (local_3b8 != (undefined2 *)0x0) {
    if (local_3b8 != local_3b4) {
      local_63c = local_3b8;
      RtlFreeUnicodeString(local_640);
      uVar13 = extraout_EDX_02;
    }
    local_3b8 = local_3b4;
    local_3b0 = local_3ac;
  }
  if (local_3b4 != (undefined2 *)0x0) {
    *local_3b4 = 0;
  }
  local_3c0 = local_3ac << 0x10;
  local_3bc = local_3b4;
  if (local_39c != (undefined2 *)0x0) {
    if (local_39c != local_398) {
      local_650 = local_39c;
      RtlFreeUnicodeString(local_654);
      uVar13 = extraout_EDX_03;
    }
    local_39c = local_398;
    local_394 = local_390;
  }
  if (local_398 != (undefined2 *)0x0) {
    *local_398 = 0;
  }
  local_3a4 = local_390 << 0x10;
  local_3a0 = local_398;
  if (local_380 != (undefined2 *)0x0) {
    if (local_380 != local_37c) {
      local_658 = local_380;
      RtlFreeUnicodeString(local_65c);
      uVar13 = extraout_EDX_00;
    }
    local_380 = local_37c;
    local_378 = local_374;
  }
  if (local_37c != (undefined2 *)0x0) {
    *local_37c = 0;
  }
  local_388 = local_374 << 0x10;
  local_384 = local_37c;
  if (local_364 != (undefined2 *)0x0) {
    if (local_364 != local_360) {
      local_660 = local_364;
      RtlFreeUnicodeString(local_664);
      uVar13 = extraout_EDX_04;
    }
    local_364 = local_360;
    local_35c = local_358;
  }
  if (local_360 != (undefined2 *)0x0) {
    *local_360 = 0;
  }
  local_36c = local_358 << 0x10;
  local_368 = local_360;
  if ((local_3f0 != (undefined2 *)0x0) && (local_3f0 != local_3ec)) {
    local_668 = local_3f0;
    RtlFreeUnicodeString(local_66c);
    uVar13 = extraout_EDX_05;
  }
  if (local_3ec != (undefined2 *)0x0) {
    *local_3ec = 0;
  }
  FUN_6b8224af(local_c ^ (uint)&stack0xfffffffc,uVar13);
  return;
}



void __fastcall FUN_6b81ad44(int *param_1)

{
  if (*param_1 != 0) {
    NtClose(*param_1);
  }
  if (param_1[2] != 0) {
    NtClose(param_1[2]);
  }
  if ((param_1[4] | param_1[5]) == 0) {
    return;
  }
  NtUnmapViewOfSection(0xffffffff,param_1[4]);
  return;
}



int FUN_6b81ad7d(undefined4 *param_1,undefined4 param_2,int param_3,undefined4 param_4,
                undefined4 param_5,int param_6,int *param_7,int *param_8,int *param_9,int *param_10,
                int param_11,int *param_12,int *param_13,uint *param_14,undefined2 *param_15,
                undefined2 *param_16)

{
  bool bVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined4 extraout_ECX;
  undefined2 *extraout_ECX_00;
  int *extraout_ECX_01;
  undefined2 *extraout_ECX_02;
  undefined2 *extraout_ECX_03;
  undefined2 *extraout_ECX_04;
  undefined2 *extraout_ECX_05;
  undefined2 *puVar5;
  undefined2 *extraout_ECX_06;
  int local_8;
  
  local_8 = 0;
  bVar1 = true;
  if (param_1 == (undefined4 *)0x0) {
    iVar2 = FUN_6b81ae4e(&local_8);
    if (iVar2 < 0) {
      return iVar2;
    }
    if (local_8 == 0) {
      iVar4 = 0;
      if (param_9 != (int *)0x0) {
        if ((param_10[4] | param_10[5]) == 0) {
          iVar2 = FUN_6b865e65(param_9,param_11,param_10,param_15);
          puVar5 = extraout_ECX_06;
        }
        else {
          iVar2 = FUN_6b81b018(param_9,param_10,param_11,param_3,param_4,param_5,param_6,param_15);
          puVar5 = extraout_ECX_00;
        }
        if (-1 < iVar2) goto LAB_6b81ade4;
        iVar3 = FUN_6b81932c(iVar2);
        param_9 = extraout_ECX_01;
        iVar4 = iVar2;
        if (iVar3 == 0) {
          return iVar2;
        }
      }
      if (param_7 == (int *)0x0) {
        return iVar2;
      }
      iVar2 = FUN_6b81b0dd(param_9,param_7,param_8,param_15);
      puVar5 = extraout_ECX_02;
      if (iVar2 < 0) {
        iVar3 = FUN_6b81b001(iVar2);
        if (iVar3 == 0) {
          return iVar2;
        }
        if (iVar4 == 0) {
          return iVar2;
        }
        return iVar4;
      }
    }
    else {
      if (param_7 != (int *)0x0) {
        iVar2 = FUN_6b81b0dd(extraout_ECX,param_7,param_8,param_15);
        puVar5 = extraout_ECX_03;
        if (-1 < iVar2) goto LAB_6b81ade4;
        iVar4 = FUN_6b81b001(iVar2);
        if (iVar4 == 0) {
          return iVar2;
        }
      }
      if (param_9 == (int *)0x0) {
        return iVar2;
      }
      if ((param_10[4] | param_10[5]) == 0) {
        iVar2 = FUN_6b865e65(param_9,param_11,param_10,param_15);
        puVar5 = extraout_ECX_05;
      }
      else {
        iVar2 = FUN_6b81b018(param_9,param_10,param_11,param_3,param_4,param_5,param_6,param_15);
        puVar5 = extraout_ECX_04;
      }
      if (iVar2 < 0) {
        return iVar2;
      }
    }
  }
  else {
    bVar1 = false;
    *param_15 = 0x301;
    *(undefined4 *)(param_15 + 2) = *param_1;
    *(undefined4 *)(param_15 + 4) = param_1[1];
    *(undefined4 *)(param_15 + 6) = 0;
    *(undefined4 *)(param_15 + 8) = 0;
    *(undefined *)(param_15 + 1) = 2;
    iVar2 = param_1[2];
    *(int *)(param_15 + 0xc) = iVar2;
    *(int *)(param_15 + 0xe) = iVar2 >> 0x1f;
    *(undefined4 *)(param_15 + 0x10) = param_1[3];
    puVar5 = param_15;
  }
LAB_6b81ade4:
  *param_14 = *param_14 | 1;
  if ((bVar1) && (param_12 != (int *)0x0)) {
    iVar2 = FUN_6b81b0dd(puVar5,param_12,param_13,param_16);
    if (iVar2 < 0) {
      return iVar2;
    }
    *param_14 = *param_14 | 2;
  }
  return 0;
}



void __fastcall FUN_6b81ae4e(int *param_1)

{
  int iVar1;
  int extraout_EDX;
  int iVar2;
  undefined8 uVar3;
  undefined local_44 [4];
  undefined4 local_40;
  undefined4 local_3c;
  undefined *local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined local_28 [8];
  int local_20;
  undefined local_1c [4];
  int local_18;
  int local_14;
  int local_10;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_20 = 0;
  *param_1 = 0;
  iVar2 = DAT_6b8b0234;
  if (DAT_6b8b0234 == -1) {
    RtlInitUnicodeString
              (local_28,
               L"\\Registry\\MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\SideBySide");
    local_38 = local_28;
    local_40 = 0x18;
    local_3c = 0;
    local_34 = 0x40;
    local_30 = 0;
    local_2c = 0;
    uVar3 = NtOpenKey(&local_20,0x20019,&local_40);
    iVar2 = (int)((ulonglong)uVar3 >> 0x20);
    if ((int)uVar3 < 0) goto LAB_6b81af02;
    RtlInitUnicodeString(local_28,L"PreferExternalManifest");
    uVar3 = NtQueryValueKey(local_20,local_28,2,local_1c,0x14,local_44);
    iVar2 = (int)((ulonglong)uVar3 >> 0x20);
    if ((int)uVar3 < 0) goto LAB_6b81af02;
    if (((local_18 != 4) || (local_14 != 4)) || (local_10 == -1)) {
      local_10 = 1;
    }
    iVar1 = -1;
    LOCK();
    iVar2 = local_10;
    if (DAT_6b8b0234 != -1) {
      iVar1 = DAT_6b8b0234;
      iVar2 = DAT_6b8b0234;
    }
    DAT_6b8b0234 = iVar2;
    iVar2 = local_10;
    if (iVar1 != -1) {
      iVar2 = iVar1;
    }
  }
  *param_1 = iVar2;
LAB_6b81af02:
  if (local_20 != 0) {
    NtClose(local_20);
    iVar2 = extraout_EDX;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,iVar2);
  return;
}



int __fastcall FUN_6b81af26(undefined4 param_1,short *param_2)

{
  undefined4 *puVar1;
  uint uVar2;
  int iVar3;
  undefined4 local_c;
  uint local_8;
  
  local_c = 0;
  local_8 = (uint)((ushort)param_2[1] >> 1);
  iVar3 = RtlGetThreadPreferredUILanguages(param_1,&local_c,*(undefined4 *)(param_2 + 2),&local_8);
  if (iVar3 != -0x3fffffdd) {
    if (iVar3 < 0) {
      return iVar3;
    }
    if (local_8 <= (ushort)param_2[1] >> 1) goto LAB_6b81af76;
  }
  uVar2 = local_8 * 2 + 2;
  if (0xfffe < uVar2) {
    return -0x3ffffefa;
  }
  puVar1 = (undefined4 *)(param_2 + 4);
  if (((puVar1 == (undefined4 *)0x0) ||
      (*(uint *)(param_2 + 8) <= uVar2 && uVar2 != *(uint *)(param_2 + 8))) &&
     (iVar3 = RtlpEnsureBufferSize(0,puVar1,uVar2), iVar3 < 0)) {
    return -0x3fffffe9;
  }
  param_2[1] = param_2[8];
  *(undefined4 *)(param_2 + 2) = *puVar1;
  iVar3 = RtlGetThreadPreferredUILanguages(param_1,&local_c,*puVar1,&local_8);
  if (iVar3 < 0) {
    return iVar3;
  }
LAB_6b81af76:
  *param_2 = (short)local_8 * 2;
  return iVar3;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

bool FUN_6b81af82(void)

{
  InitOnceExecuteOnce(&InitOnce_6b8b0878,InitFn_6b820f80,(PVOID)0x0,(LPVOID *)0x0);
  return _DAT_6b8b0834 == 0x50000;
}



uint __fastcall FUN_6b81afa6(undefined4 param_1)

{
  int iVar1;
  undefined local_14 [8];
  uint local_c;
  uint local_8;
  
  iVar1 = NtQueryVolumeInformationFile(param_1,local_14,&local_c,8,4);
  if (iVar1 < 0) {
    DbgPrint("BasepIsRemovableMedia: NtQueryVolumeInformationFile failed 0x%lx\n",iVar1);
    return 1;
  }
  local_8 = local_8 & 0x11;
  if (local_8 == 0) {
    if (local_c < 2) {
      return 0;
    }
    if (((3 < local_c) && (local_c != 0x12)) && (local_c != 0x14)) {
      return 0;
    }
    local_8 = 1;
  }
  DbgPrint("BasepIsRemovableMedia: Host device is removable, Shim cache deactivated\n");
  return local_8;
}



undefined4 __fastcall FUN_6b81b001(int param_1)

{
  int iVar1;
  
  if ((param_1 < 0) &&
     ((((param_1 == -0x3fffffcc || (param_1 == -0x3fffffc6)) || (param_1 == -0x3ffffff1)) ||
      (((iVar1 = RtlNtStatusToDosErrorNoTeb(param_1), iVar1 == 2 || (iVar1 == 3)) ||
       ((iVar1 == 0x35 || (iVar1 == 0x43)))))))) {
    return 1;
  }
  return 0;
}



void __fastcall
FUN_6b81b018(int *param_1,undefined4 *param_2,int param_3,int param_4,undefined4 param_5,
            undefined4 param_6,int param_7,undefined2 *param_8)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  undefined8 uVar3;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  int local_10;
  undefined4 local_c;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_14 = 0x18;
  uVar2 = 0;
  local_10 = 0;
  local_c = 0;
  local_1c = 0;
  local_18 = 0;
  if ((param_2[4] | param_2[5]) != 0) {
    if ((param_4 == 0) || (param_3 != 1)) {
      local_10 = param_3;
      uVar3 = LdrResSearchResource(param_2[4],&local_14,3,0x130,&local_1c,&local_18,0,0);
      uVar2 = (undefined4)((ulonglong)uVar3 >> 0x20);
      if ((int)uVar3 < 0) goto LAB_6b81b0c5;
      *(undefined4 *)(param_8 + 0x10) = local_18;
      param_6 = 0;
      param_5 = local_1c;
    }
    else {
      if (param_7 == 0) goto LAB_6b81b0c5;
      *(int *)(param_8 + 0x10) = param_7;
    }
    uVar2 = 0;
    *(undefined4 *)(param_8 + 0xc) = param_5;
    *(undefined4 *)(param_8 + 0xe) = param_6;
    if (*(uint *)(param_8 + 0x10) < 0x800001) {
      *(undefined4 *)(param_8 + 8) = param_2[1];
      *(undefined4 *)(param_8 + 6) = *param_2;
      *param_8 = 0x101;
      puVar1 = (undefined4 *)*param_1;
      *(undefined4 *)(param_8 + 2) = *puVar1;
      *(undefined4 *)(param_8 + 4) = puVar1[1];
      *(undefined *)(param_8 + 1) = 1;
    }
  }
LAB_6b81b0c5:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



void __fastcall FUN_6b81b0dd(undefined4 param_1,int *param_2,int *param_3,undefined2 *param_4)

{
  undefined4 *puVar1;
  int iVar2;
  uint uVar3;
  uint extraout_EDX;
  uint extraout_EDX_00;
  undefined8 uVar4;
  char *pcVar5;
  undefined local_48 [8];
  undefined4 local_40;
  undefined4 local_3c;
  int local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  int *local_28;
  undefined local_24 [8];
  uint local_1c;
  int local_18;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_28 = param_2;
  if (*param_3 == 0) {
    local_38 = param_2[1];
    local_40 = 0x18;
    local_3c = 0;
    local_34 = 0x40;
    local_30 = 0;
    local_2c = 0;
    uVar4 = NtOpenFile(param_3,0x1200a9,&local_40,local_48,5,0x60);
    uVar3 = (uint)((ulonglong)uVar4 >> 0x20);
    iVar2 = (int)uVar4;
    if (iVar2 < 0) {
      local_1c = uVar3;
      if (((((iVar2 != -0x3fffffcc) && (iVar2 != -0x3fffff77)) && (iVar2 != -0x3fffff76)) &&
          ((iVar2 != -0x3fffff75 && (iVar2 != -0x3ffffdfc)))) &&
         ((iVar2 != -0x3feafffe && (iVar2 != -0x3ffffff1)))) {
        DbgPrintEx(0x33,0,"SXS: %s() NtOpenFile(%wZ) failed. Status = 0x%x\n",
                   "BasepSxsCreateFileStream",local_38,iVar2);
        local_1c = extraout_EDX;
      }
      goto LAB_6b81b178;
    }
  }
  iVar2 = NtQueryInformationFile(*param_3,local_48,local_24,0x18,5);
  if (iVar2 < 0) {
    pcVar5 = "SXS: %s() NtQueryInformationFile failed. Status = 0x%x\n";
  }
  else {
    if ((-1 < local_18) && ((0 < local_18 || (0x800000 < local_1c)))) goto LAB_6b81b178;
    if ((param_3[2] != 0) ||
       (iVar2 = NtCreateSection(param_3 + 2,4,0,0,2,0x8000000,*param_3), -1 < iVar2)) {
      *(int *)(param_4 + 6) = *param_3;
      *param_4 = 0x101;
      puVar1 = (undefined4 *)*local_28;
      *(undefined4 *)(param_4 + 2) = *puVar1;
      *(undefined4 *)(param_4 + 4) = puVar1[1];
      *(undefined *)(param_4 + 1) = 3;
      *(int *)(param_4 + 8) = param_3[2];
      *(undefined4 *)(param_4 + 0xc) = 0;
      *(undefined4 *)(param_4 + 0xe) = 0;
      *(uint *)(param_4 + 0x10) = local_1c;
      goto LAB_6b81b178;
    }
    pcVar5 = "SXS: %s() NtCreateSection() failed. Status = 0x%x\n";
  }
  DbgPrintEx(0x33,0,pcVar5,"BasepSxsCreateFileStream",iVar2);
  local_1c = extraout_EDX_00;
LAB_6b81b178:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,local_1c);
  return;
}



HRSRC FindResourceExA(HMODULE hModule,LPCSTR lpType,LPCSTR lpName,WORD wLanguage)

{
  int iVar1;
  HRSRC pHVar2;
  undefined4 extraout_EDX;
  undefined4 uVar3;
  undefined4 extraout_EDX_00;
  int **in_FS_OFFSET;
  uint uStack72;
  undefined4 local_34;
  int local_30;
  short *local_2c;
  short *local_28;
  uint local_24;
  uint local_20;
  uint *local_1c;
  int *local_14;
  code *pcStack16;
  uint local_c;
  undefined4 local_8;
  
                    // 0x1b210  410  FindResourceExA
  pcStack16 = __except_handler4;
  local_14 = *in_FS_OFFSET;
  local_c = DAT_6b8b0140 ^ 0x6b8919b0;
  uStack72 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_1c = &uStack72;
  *in_FS_OFFSET = (int *)&local_14;
  local_30 = 0xc000000d;
  local_34 = 0;
  local_2c = (short *)0x0;
  local_28 = (short *)0x0;
  local_8 = 1;
  local_20 = uStack72;
  local_2c = FUN_6b81b329((short *)lpType);
  if (local_2c == (short *)0xffffffff) {
    iVar1 = -0x3ffffff3;
  }
  else {
    local_28 = FUN_6b81b329((short *)lpName);
    if (local_28 == (short *)0xffffffff) {
      iVar1 = -0x3ffffff3;
    }
    else {
      local_24 = (uint)wLanguage;
      local_34 = 0;
      if (hModule == (HMODULE)0x0) {
        hModule = (HMODULE)in_FS_OFFSET[0xc][2];
      }
      iVar1 = LdrFindResource_U(hModule,&local_2c,3,&local_34);
    }
  }
  local_8 = 0;
  local_30 = iVar1;
  FUN_6b81b314();
  local_8 = 0xfffffffe;
  uVar3 = extraout_EDX;
  if (iVar1 < 0) {
    BaseSetLastNTError(iVar1);
    uVar3 = extraout_EDX_00;
  }
  *in_FS_OFFSET = local_14;
  pHVar2 = (HRSRC)FUN_6b8224af(local_20 ^ (uint)&stack0xfffffffc,uVar3);
  return pHVar2;
}



void FUN_6b81b314(void)

{
  int unaff_EBP;
  
  BaseDllFreeResourceId(*(undefined4 *)(unaff_EBP + -0x28));
  BaseDllFreeResourceId(*(undefined4 *)(unaff_EBP + -0x24));
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

short * __fastcall FUN_6b81b329(short *param_1)

{
  short sVar1;
  int iVar2;
  short *psVar3;
  undefined4 *in_FS_OFFSET;
  undefined local_44 [8];
  undefined local_3c [4];
  short *local_38;
  int local_34;
  undefined4 local_2c;
  short *local_28;
  short *local_24;
  short *local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined4 local_8;
  
  uStack12 = 0x6b81b335;
  local_8 = 0;
  if ((short *)0xffff < param_1) {
    if (*(char *)param_1 == '#') {
      iVar2 = RtlCharToInteger((int)param_1 + 1,10,&local_24);
      local_20 = local_24;
      if (-1 < iVar2) {
        param_1 = local_24;
        if (((uint)local_24 & 0xffff0000) == 0) goto LAB_6b81b344;
        if (-1 < iVar2) {
          iVar2 = -0x3ffffff3;
        }
      }
    }
    else {
      RtlInitAnsiString(local_44,param_1);
      iVar2 = RtlAnsiStringToUnicodeString(local_3c,local_44,1);
      local_34 = iVar2;
      if (-1 < iVar2) {
        local_8 = 1;
        local_2c = 1;
        for (psVar3 = local_38; local_28 = psVar3, *psVar3 != 0; psVar3 = psVar3 + 1) {
          sVar1 = RtlUpcaseUnicodeChar(*psVar3);
          *psVar3 = sVar1;
        }
        local_8 = 0;
        local_2c = 0;
        FUN_6b81b3c5();
        param_1 = local_38;
        goto LAB_6b81b344;
      }
    }
    BaseSetLastNTError(iVar2);
    param_1 = (short *)0xffffffff;
  }
LAB_6b81b344:
  *in_FS_OFFSET = local_14;
  return param_1;
}



void FUN_6b81b3c5(void)

{
  int unaff_EBP;
  
  if (*(int *)(unaff_EBP + -0x28) == 0) {
    return;
  }
  RtlFreeUnicodeString(unaff_EBP + -0x38);
  return;
}



BOOL DosDateTimeToFileTime(WORD wFatDate,WORD wFatTime,LPFILETIME lpFileTime)

{
  char cVar1;
  BOOL BVar2;
  undefined4 extraout_EDX;
  undefined4 uVar3;
  undefined4 extraout_EDX_00;
  DWORD local_20;
  DWORD local_1c;
  short local_18;
  ushort local_16;
  ushort local_14;
  ushort local_12;
  ushort local_10;
  short local_e;
  undefined2 local_c;
  uint local_8;
  
                    // 0x1b3e0  300  DosDateTimeToFileTime
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_18 = (wFatDate >> 9) + 0x7bc;
  local_14 = wFatDate & 0x1f;
  local_16 = wFatDate >> 5 & 0xf;
  local_12 = wFatTime >> 0xb;
  local_10 = wFatTime >> 5 & 0x3f;
  local_e = (wFatTime & 0x1f) * 2;
  local_c = 0;
  cVar1 = RtlTimeFieldsToTime(&local_18,&local_20);
  if (cVar1 == '\0') {
    BaseSetLastNTError(0xc000000d);
    uVar3 = extraout_EDX_00;
  }
  else {
    lpFileTime->dwLowDateTime = local_20;
    lpFileTime->dwHighDateTime = local_1c;
    uVar3 = extraout_EDX;
  }
  BVar2 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar3);
  return BVar2;
}



UINT GetProfileIntA(LPCSTR lpAppName,LPCSTR lpKeyName,INT nDefault)

{
  UINT UVar1;
  
                    // 0x1b490  714  GetProfileIntA
  UVar1 = GetPrivateProfileIntA(lpAppName,lpKeyName,nDefault,(LPCSTR)0x0);
  return UVar1;
}



UINT GetPrivateProfileIntA(LPCSTR lpAppName,LPCSTR lpKeyName,INT nDefault,LPCSTR lpFileName)

{
  DWORD DVar1;
  UINT UVar2;
  int iVar3;
  undefined4 extraout_EDX;
  undefined4 uVar4;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 local_10c;
  CHAR local_108 [256];
  uint local_8;
  
                    // 0x1b4b0  682  GetPrivateProfileIntA
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_10c = 0;
  DVar1 = GetPrivateProfileStringA(lpAppName,lpKeyName,(LPCSTR)0x0,local_108,0x100,lpFileName);
  uVar4 = extraout_EDX;
  if (DVar1 != 0) {
    iVar3 = RtlCharToInteger(local_108,0,&local_10c);
    if (iVar3 < 0) {
      BaseSetLastNTError(iVar3);
      uVar4 = extraout_EDX_00;
    }
    else {
      RtlSetLastWin32Error(0);
      uVar4 = extraout_EDX_01;
    }
  }
  UVar2 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar4);
  return UVar2;
}



ATOM GlobalAddAtomA(LPCSTR lpString)

{
  uint uVar1;
  
                    // 0x1b510  815  GlobalAddAtomA
  uVar1 = FUN_6b81b8e7('\0','\0',(uint)lpString,0);
  return (ATOM)uVar1;
}



DWORD GetPrivateProfileStringA
                (LPCSTR lpAppName,LPCSTR lpKeyName,LPCSTR lpDefault,LPSTR lpReturnedString,
                DWORD nSize,LPCSTR lpFileName)

{
  char cVar1;
  uint uVar2;
  BOOL BVar3;
  LPCSTR pCVar4;
  char *_MaxCount;
  BYTE *pBVar5;
  DWORD DVar6;
  LPCSTR local_8;
  
                    // 0x1b530  688  GetPrivateProfileStringA
  if (lpDefault == (LPCSTR)0x0) {
    lpDefault = "";
  }
  local_8 = (LPCSTR)nSize;
  uVar2 = BaseDllReadWriteIniFile
                    ('\0','\0','\0',(LPCWSTR)lpFileName,(short *)lpAppName,(short *)lpKeyName,
                     (short *)lpReturnedString,(int *)&local_8);
  if ((int)uVar2 < 0) {
    if (uVar2 == 0x80000005) {
      if ((lpAppName == (LPCSTR)0x0) || (lpKeyName == (LPCSTR)0x0)) {
        if (1 < nSize) {
          DVar6 = nSize - 2;
          *(undefined2 *)(lpReturnedString + DVar6) = 0;
          if (DVar6 != 0) {
            pBVar5 = (BYTE *)(lpReturnedString + -1 + DVar6);
            for (; lpReturnedString <= pBVar5;
                lpReturnedString = (LPSTR)((BYTE *)lpReturnedString + (BVar3 != 0) + 1)) {
              BVar3 = IsDBCSLeadByte(*lpReturnedString);
            }
            if ((int)lpReturnedString - (int)pBVar5 == 2) {
              *pBVar5 = '\0';
            }
          }
          BaseSetLastNTError(0x80000005);
          return DVar6;
        }
      }
      else if (nSize != 0) {
        _MaxCount = (char *)(nSize - 1);
        goto LAB_6b81b5b1;
      }
      _MaxCount = (char *)0x0;
    }
    else {
      local_8 = lpDefault + 1;
      pCVar4 = lpDefault;
      do {
        cVar1 = *pCVar4;
        pCVar4 = pCVar4 + 1;
      } while (cVar1 != '\0');
      for (_MaxCount = pCVar4 + -(int)local_8;
          (_MaxCount != (char *)0x0 && ((lpDefault + -1)[(int)_MaxCount] == ' '));
          _MaxCount = _MaxCount + -1) {
      }
      if (nSize == 0) {
        BaseSetLastNTError(uVar2);
        return 0;
      }
      if (nSize <= _MaxCount) {
        _MaxCount = (char *)(nSize - 1);
      }
      strncpy_s(lpReturnedString,nSize,lpDefault,(rsize_t)_MaxCount);
    }
  }
  else {
    RtlSetLastWin32Error(0);
    _MaxCount = local_8 + -1;
  }
LAB_6b81b5b1:
  if (_MaxCount < nSize) {
    _MaxCount[(int)lpReturnedString] = '\0';
  }
  else if (nSize != 0) {
    lpReturnedString[nSize - 1] = '\0';
  }
  if ((int)uVar2 < 0) {
    BaseSetLastNTError(uVar2);
  }
  else {
    RtlSetLastWin32Error(0);
  }
  return (DWORD)_MaxCount;
}



void GlobalAddAtomExW(uint param_1,undefined4 param_2)

{
                    // 0x1b610  817  GlobalAddAtomExW
  FUN_6b81b8e7('\0','\x01',param_1,param_2);
  return;
}



// WARNING: Removing unreachable block (ram,0x6b81b6c3)
// WARNING: Removing unreachable block (ram,0x6b81b6cb)
// WARNING: Removing unreachable block (ram,0x6b8268a0)
// WARNING: Removing unreachable block (ram,0x6b8268ad)
// WARNING: Removing unreachable block (ram,0x6b8268c1)
// WARNING: Removing unreachable block (ram,0x6b8268df)
// WARNING: Removing unreachable block (ram,0x6b81b6d1)
// WARNING: Removing unreachable block (ram,0x6b81b6e2)

UINT GlobalGetAtomNameW(ATOM nAtom,LPWSTR lpBuffer,int nSize)

{
  LPWSTR _Src;
  ushort uVar1;
  undefined4 *puVar2;
  int iVar3;
  int iVar4;
  uint _Size;
  UINT UVar5;
  int in_FS_OFFSET;
  undefined2 in_stack_00000006;
  ushort uStack44;
  short sStack42;
  LPWSTR pWStack40;
  ushort uStack36;
  undefined2 uStack34;
  LPWSTR pWStack32;
  uint uStack20;
  uint uStack16;
  int iStack12;
  char cStack5;
  
                    // 0x1b630  828  GlobalGetAtomNameW
  cStack5 = '\x01';
  iStack12 = 0;
  UVar5 = 0;
  uStack16 = 0;
  uStack20 = nSize;
  if (nSize == 0) {
    iVar4 = -0x7ffffffb;
  }
  else {
    iStack12 = nSize * 2 + 8;
    puVar2 = (undefined4 *)KernelBaseGetGlobalData();
    iVar3 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar2,iStack12);
    if (iVar3 == 0) {
      iVar4 = -0x3fffffe9;
    }
    else {
      iVar4 = NtQueryInformationAtom(_nAtom,0,iVar3,iStack12,&iStack12);
      if (-1 < iVar4) {
        uVar1 = *(ushort *)(iVar3 + 4);
        _Size = (uint)uVar1;
        _Src = (LPWSTR)(iVar3 + 6);
        uStack16 = _Size;
        if (-1 < iVar4) {
          if (cStack5 == '\0') {
            sStack42 = uVar1 + 2;
            pWStack32 = lpBuffer;
            uStack36 = 0;
            uStack34 = (undefined2)uStack20;
            uStack44 = uVar1;
            pWStack40 = _Src;
            iVar4 = RtlUnicodeStringToAnsiString(&uStack36,&uStack44,0);
            if (-1 < iVar4) {
              UVar5 = (UINT)uStack36;
            }
          }
          else {
            UVar5 = (UINT)(uVar1 >> 1);
            if (_Src != lpBuffer) {
              memmove(lpBuffer,_Src,_Size);
            }
            if (UVar5 < uStack20) {
              *(undefined2 *)((int)lpBuffer + (_Size & 0xfffffffe)) = 0;
            }
          }
        }
      }
      if (iVar3 != 0) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iVar3);
      }
      if (-1 < iVar4) {
        return UVar5;
      }
    }
  }
  BaseSetLastNTError(iVar4);
  return 0;
}



ATOM GlobalAddAtomW(LPCWSTR lpString)

{
  uint uVar1;
  
                    // 0x1b770  818  GlobalAddAtomW
  uVar1 = FUN_6b81b8e7('\0','\x01',(uint)lpString,0);
  return (ATOM)uVar1;
}



void QueryActCtxSettingsWWorker
               (int param_1,undefined4 param_2,int param_3,int param_4,int param_5,int param_6,
               undefined4 *param_7)

{
  int iVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  uint uVar2;
  undefined8 uVar3;
  undefined4 uVar4;
  undefined local_48 [8];
  undefined local_40 [8];
  undefined4 local_38;
  int local_34;
  int local_30;
  int local_2c;
  wchar_t *local_28 [8];
  uint local_8;
  
                    // 0x1b790  1092  QueryActCtxSettingsWWorker
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_38 = param_2;
  local_2c = param_3;
  local_30 = param_4;
  local_34 = param_5;
  if (param_7 != (undefined4 *)0x0) {
    *param_7 = 0;
  }
  if (param_1 == 0) {
    if (param_4 == 0) {
      uVar4 = 0xc00000f2;
    }
    else {
      if ((param_6 == 0) || (param_5 != 0)) {
        if (param_3 == 0) {
LAB_6b81b868:
          uVar3 = RtlQueryActivationContextApplicationSettings
                            (0,local_38,local_2c,local_30,local_34,param_6,param_7);
          uVar4 = (undefined4)((ulonglong)uVar3 >> 0x20);
          iVar1 = (int)uVar3;
          if (-1 < iVar1) goto LAB_6b81b884;
        }
        else {
          local_28[0] = L"http://schemas.microsoft.com/SMI/2005/WindowsSettings";
          local_28[1] = L"http://schemas.microsoft.com/SMI/2011/WindowsSettings";
          local_28[2] = L"http://schemas.microsoft.com/SMI/2013/WindowsSettings";
          local_28[3] = L"http://schemas.microsoft.com/SMI/2014/WindowsSettings";
          local_28[4] = L"http://schemas.microsoft.com/SMI/2016/WindowsSettings";
          local_28[5] = L"http://schemas.microsoft.com/SMI/2017/WindowsSettings";
          local_28[6] = L"http://schemas.microsoft.com/SMI/2019/WindowsSettings";
          local_28[7] = L"http://schemas.microsoft.com/SMI/2020/WindowsSettings";
          RtlInitUnicodeString(local_48,param_3);
          uVar2 = 0;
          do {
            RtlInitUnicodeString(local_40,local_28[uVar2]);
            iVar1 = RtlCompareUnicodeString(local_48,local_40,0);
            if (iVar1 == 0) goto LAB_6b81b868;
            uVar2 = uVar2 + 1;
          } while (uVar2 < 8);
          iVar1 = -0x3fffff0f;
        }
        BaseSetLastNTError(iVar1);
        uVar4 = extraout_EDX;
        goto LAB_6b81b884;
      }
      uVar4 = 0xc000000d;
    }
  }
  else {
    uVar4 = 0xc00000ef;
  }
  BaseSetLastNTError(uVar4);
  uVar4 = extraout_EDX_00;
LAB_6b81b884:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar4);
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4
// WARNING: Removing unreachable block (ram,0x6b81bae3)
// WARNING: Removing unreachable block (ram,0x6b8269bd)

ATOM GlobalFindAtomW(LPCWSTR lpString)

{
  int iVar1;
  undefined4 *in_FS_OFFSET;
  short asStack64 [4];
  int aiStack56 [2];
  undefined4 uStack48;
  short *psStack44;
  ushort auStack40 [2];
  char cStack36;
  undefined uStack32;
  undefined4 uStack20;
  undefined4 uStack12;
  undefined *puStack8;
  
                    // 0x1b8b0  823  GlobalFindAtomW
  puStack8 = &DAT_6b891a28;
  uStack12 = 0x6b81ba1b;
  uStack32 = 1;
  cStack36 = '\0';
  psStack44 = (short *)0x0;
  if (lpString < (LPCWSTR)0x10000) {
    auStack40[0] = (ushort)lpString;
    if (0xbfff < auStack40[0]) {
      BaseSetLastNTError(0xc000000d);
      auStack40[0] = 0;
    }
    goto LAB_6b81baa2;
  }
  puStack8 = (undefined *)0x0;
  psStack44 = asStack64;
  RtlInitUnicodeString(psStack44,lpString);
  uStack48 = 0;
  auStack40[0] = 0;
  puStack8 = (undefined *)0x1;
  if (cStack36 == '\0') {
    if (*psStack44 == 0) {
      RtlSetLastWin32Error(0x7b);
    }
    else {
      iVar1 = NtFindAtom(*(undefined4 *)(psStack44 + 2),*psStack44,auStack40);
LAB_6b81ba92:
      if (iVar1 < 0) goto LAB_6b81bad5;
    }
  }
  else {
    iVar1 = FUN_6b81bb24(aiStack56);
    if (-1 < iVar1) {
      iVar1 = RtlLookupAtomInAtomTable(aiStack56[0],*(undefined4 *)(psStack44 + 2),auStack40);
      goto LAB_6b81ba92;
    }
LAB_6b81bad5:
    BaseSetLastNTError(iVar1);
    auStack40[0] = 0;
  }
  puStack8 = (undefined *)0xfffffffe;
  FUN_6b81bb0a();
LAB_6b81baa2:
  *in_FS_OFFSET = uStack20;
  return auStack40[0];
}



ATOM AddAtomW(LPCWSTR lpString)

{
  uint uVar1;
  
                    // 0x1b8d0  9  AddAtomW
  uVar1 = FUN_6b81b8e7('\x01','\x01',(uint)lpString,0);
  return (ATOM)uVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

uint __fastcall FUN_6b81b8e7(char param_1,char param_2,uint param_3,undefined4 param_4)

{
  uint uVar1;
  int iVar2;
  undefined4 *in_FS_OFFSET;
  undefined local_48 [8];
  undefined2 local_40 [4];
  int local_38 [2];
  int local_30;
  undefined2 *local_2c;
  ushort local_28 [2];
  char local_24;
  char local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b891a00;
  uStack12 = 0x6b81b8f3;
  iVar2 = 0;
  local_2c = (undefined2 *)0x0;
  local_24 = param_1;
  local_20 = param_2;
  if (param_3 < 0x10000) {
    uVar1 = param_3 & 0xffff;
    local_28[0] = (ushort)uVar1;
    if (0xbfff < local_28[0]) {
      iVar2 = -0x3ffffff3;
      goto LAB_6b82696f;
    }
  }
  else {
    local_8 = (undefined *)0x0;
    if (param_2 == '\0') {
      RtlInitAnsiString(local_48,param_3);
      local_2c = local_40;
      iVar2 = RtlAnsiStringToUnicodeString(local_40,local_48,1);
    }
    else {
      local_2c = local_40;
      RtlInitUnicodeString(local_2c,param_3);
    }
    local_8 = (undefined *)0xfffffffe;
    local_30 = iVar2;
    if (iVar2 < 0) {
LAB_6b82696f:
      BaseSetLastNTError(iVar2);
      uVar1 = 0;
      goto LAB_6b81b979;
    }
    local_28[0] = 0;
    local_8 = (undefined *)0x1;
    if (local_24 == '\0') {
      iVar2 = NtAddAtomEx(*(undefined4 *)(local_2c + 2),*local_2c,local_28,param_4);
LAB_6b81b969:
      if (iVar2 < 0) goto LAB_6b81b9cb;
    }
    else {
      iVar2 = FUN_6b81bb24(local_38);
      if (-1 < iVar2) {
        iVar2 = RtlAddAtomToAtomTable(local_38[0],*(undefined4 *)(local_2c + 2),local_28);
        goto LAB_6b81b969;
      }
LAB_6b81b9cb:
      BaseSetLastNTError(iVar2);
      local_28[0] = 0;
    }
    local_8 = (undefined *)0xfffffffe;
    uVar1 = FUN_6b81b9d9();
  }
  uVar1 = uVar1 & 0xffff0000 | (uint)local_28[0];
LAB_6b81b979:
  *in_FS_OFFSET = local_14;
  return uVar1;
}



void FUN_6b81b9d9(void)

{
  int unaff_EBP;
  
  if ((*(char *)(unaff_EBP + -0x1c) == '\0') && (*(int *)(unaff_EBP + -0x28) == unaff_EBP + -0x3c))
  {
    RtlFreeUnicodeString(*(int *)(unaff_EBP + -0x28));
  }
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4
// WARNING: Removing unreachable block (ram,0x6b81bae3)
// WARNING: Removing unreachable block (ram,0x6b8269bd)

ATOM FindAtomW(LPCWSTR lpString)

{
  int iVar1;
  undefined4 *in_FS_OFFSET;
  short local_40 [4];
  int local_38 [2];
  undefined4 local_30;
  short *local_2c;
  ushort local_28 [2];
  char local_24;
  undefined local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x1ba00  378  FindAtomW
  local_8 = &DAT_6b891a28;
  uStack12 = 0x6b81ba1b;
  local_20 = 1;
  local_24 = '\x01';
  local_2c = (short *)0x0;
  if (lpString < (LPCWSTR)0x10000) {
    local_28[0] = (ushort)lpString;
    if (0xbfff < local_28[0]) {
      BaseSetLastNTError(0xc000000d);
      local_28[0] = 0;
    }
    goto LAB_6b81baa2;
  }
  local_8 = (undefined *)0x0;
  local_2c = local_40;
  RtlInitUnicodeString(local_2c,lpString);
  local_30 = 0;
  local_28[0] = 0;
  local_8 = (undefined *)0x1;
  if (local_24 == '\0') {
    if (*local_2c == 0) {
      RtlSetLastWin32Error(0x7b);
    }
    else {
      iVar1 = NtFindAtom(*(undefined4 *)(local_2c + 2),*local_2c,local_28);
LAB_6b81ba92:
      if (iVar1 < 0) goto LAB_6b81bad5;
    }
  }
  else {
    iVar1 = FUN_6b81bb24(local_38);
    if (-1 < iVar1) {
      iVar1 = RtlLookupAtomInAtomTable(local_38[0],*(undefined4 *)(local_2c + 2),local_28);
      goto LAB_6b81ba92;
    }
LAB_6b81bad5:
    BaseSetLastNTError(iVar1);
    local_28[0] = 0;
  }
  local_8 = (undefined *)0xfffffffe;
  FUN_6b81bb0a();
LAB_6b81baa2:
  *in_FS_OFFSET = local_14;
  return local_28[0];
}



void FUN_6b81bb0a(void)

{
  int unaff_EBP;
  
  if ((*(char *)(unaff_EBP + -0x1c) == '\0') && (*(int *)(unaff_EBP + -0x28) == unaff_EBP + -0x3c))
  {
    RtlFreeUnicodeString(*(undefined4 *)(unaff_EBP + -0x28));
  }
  return;
}



int __fastcall FUN_6b81bb24(int *param_1)

{
  int iVar1;
  int local_8;
  
  local_8 = DAT_6b8b07d0;
  if (DAT_6b8b07d0 == 0) {
    iVar1 = RtlCreateAtomTable(0,&local_8);
    if (iVar1 < 0) {
      return iVar1;
    }
    LOCK();
    iVar1 = DAT_6b8b07d0;
    if (DAT_6b8b07d0 == 0) {
      DAT_6b8b07d0 = local_8;
      iVar1 = 0;
    }
    if (iVar1 != 0) {
      RtlDestroyAtomTable(local_8);
      local_8 = iVar1;
    }
  }
  *param_1 = local_8;
  return 0;
}



BOOL FileTimeToDosDateTime(FILETIME *lpFileTime,LPWORD lpFatDate,LPWORD lpFatTime)

{
  BOOL BVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar2;
  undefined4 extraout_EDX_01;
  int local_28;
  int local_24;
  short local_1c;
  undefined2 uStack26;
  ushort uStack24;
  undefined2 local_16;
  undefined2 uStack20;
  ushort local_12;
  uint local_c;
  
                    // 0x1bb80  366  FileTimeToDosDateTime
  local_c = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_28 = lpFileTime->dwLowDateTime + 19999999;
  local_24 = lpFileTime->dwHighDateTime + (uint)(0xfeced300 < lpFileTime->dwLowDateTime);
  if ((local_24 < 1) && (local_24 < 0)) {
    RtlSetLastWin32Error(0x57);
    uVar2 = extraout_EDX_01;
  }
  else {
    RtlTimeToTimeFields(&local_28,&local_1c);
    if ((0x7bb < local_1c) && (local_1c < 0x83c)) {
      *lpFatDate = (ushort)(((CONCAT22(uStack26,local_1c) + -0x3c) * 0x10 |
                            CONCAT22(uStack24,uStack26)) << 5) | uStack24;
      *lpFatTime = (ushort)((CONCAT22(uStack20,local_16) << 6 | CONCAT22(local_12,uStack20)) << 5) |
                   local_12 >> 1;
      BVar1 = FUN_6b8224af(local_c ^ (uint)&stack0xfffffffc,extraout_EDX);
      return BVar1;
    }
    BaseSetLastNTError(0xc000000d);
    uVar2 = extraout_EDX_00;
  }
  BVar1 = FUN_6b8224af(local_c ^ (uint)&stack0xfffffffc,uVar2);
  return BVar1;
}



undefined4
FindActCtxSectionGuidWorker
          (uint param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,uint *param_5)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  undefined4 local_48 [17];
  
                    // 0x1bc50  373  FindActCtxSectionGuidWorker
  uVar3 = 0;
  uVar4 = 0;
  if (((param_5 == (uint *)0x0) || (uVar3 = *param_5, uVar3 < 0x24)) ||
     ((param_1 & 0xfffffff8) != 0)) {
LAB_6b826a3b:
    DbgPrintEx(0x33,0,
               "SXS: Invalid parameter(s) passed to FindActCtxSection*()\n   dwFlags = 0x%08lx\n   ReturnedData = %p\n      ->cbSize = %u\n"
               ,param_1,param_5,-(uint)(param_5 != (uint *)0x0) & uVar3);
    RtlSetLastWin32Error(0x57);
  }
  else {
    puVar1 = (uint *)(uVar3 + (int)param_5);
    if ((param_1 & 1) != 0) {
      if (puVar1 < param_5 + 9) goto LAB_6b826a3b;
      uVar4 = 1;
    }
    if ((param_1 & 2) != 0) {
      if (puVar1 < param_5 + 0xb) goto LAB_6b826a3b;
      uVar4 = uVar4 | 2;
    }
    if ((param_1 & 4) != 0) {
      if (puVar1 < param_5 + 0x10) goto LAB_6b826a3b;
      uVar4 = uVar4 | 4;
    }
    memset(local_48,0,0x40);
    local_48[0] = 0x40;
    iVar2 = RtlFindActivationContextSectionGuid(uVar4,param_2,param_3,param_4,local_48);
    if (iVar2 < 0) {
      BaseSetLastNTError(iVar2);
    }
    else {
      iVar2 = FUN_6b816414((byte)param_1,(int *)param_5,(int)local_48);
      if (iVar2 != 0) {
        return 1;
      }
    }
  }
  return 0;
}



undefined4 BaseSetLastNTError(undefined4 param_1)

{
  undefined4 uVar1;
  
                    // 0x1bd20  71  BaseSetLastNTError
  uVar1 = RtlNtStatusToDosError(param_1);
  RtlSetLastWin32Error(uVar1);
  return uVar1;
}



void __fastcall FUN_6b81bd3f(int *param_1,ushort *param_2,uint *param_3,ushort *param_4)

{
  short sVar1;
  int *piVar2;
  undefined4 uVar3;
  int iVar4;
  undefined4 *puVar5;
  undefined *puVar6;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 extraout_EDX_04;
  undefined4 extraout_EDX_05;
  undefined4 uVar7;
  undefined4 extraout_EDX_06;
  undefined4 extraout_EDX_07;
  undefined4 extraout_EDX_08;
  int in_FS_OFFSET;
  ushort local_40 [4];
  int *local_38;
  ushort local_34;
  short local_32;
  short *local_30;
  ushort *local_2c;
  ushort *local_28;
  undefined4 local_24;
  int local_20;
  char local_19;
  undefined local_18 [16];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_28 = param_4;
  local_38 = param_1;
  local_2c = param_2;
  if (param_4 == (ushort *)0x0) {
    uVar3 = FUN_6b81c967((int)param_1,(short **)0x0,(short **)&local_28);
    uVar7 = extraout_EDX;
    if ((char)uVar3 == '\0') goto LAB_6b81be02;
    local_19 = '\0';
    param_4 = local_28;
  }
  else {
    RtlInitUnicodeString(local_40,&DAT_6b884260);
    local_19 = '\x01';
  }
  if ((((param_3 == (uint *)0x0) &&
       (param_3 = FUN_6b81c8bc((int)local_2c,param_4), uVar7 = extraout_EDX_00,
       param_3 == (uint *)0x0)) ||
      (uVar3 = FUN_6b81c868((int)param_1,(short **)0x0,(short **)&local_2c), uVar7 = extraout_EDX_01
      , (char)uVar3 == '\0')) ||
     ((iVar4 = FUN_6b81bef2(param_1,(int)param_3,local_2c,'\0',&local_20), uVar7 = extraout_EDX_02,
      iVar4 < 0 || (local_20 == -1)))) goto LAB_6b81be02;
  iVar4 = NtQueryValueKey(local_20,param_4,2,local_18,0x10,&local_24);
  if (iVar4 < 0) {
    if (iVar4 == -0x7ffffffb) {
      puVar5 = (undefined4 *)KernelBaseGetGlobalData();
      puVar6 = (undefined *)
               RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar5,
                               local_24);
      param_4 = local_28;
      if (puVar6 != (undefined *)0x0) {
        iVar4 = NtQueryValueKey(local_20,local_28,2,puVar6,local_24,&local_24);
        goto LAB_6b81be50;
      }
    }
    NtClose(local_20);
    uVar7 = extraout_EDX_03;
    goto LAB_6b81be02;
  }
  puVar6 = local_18;
LAB_6b81be50:
  NtClose(local_20);
  piVar2 = local_38;
  uVar7 = extraout_EDX_04;
  if ((-1 < iVar4) && (*(int *)(puVar6 + 4) == 1)) {
    if (local_19 != '\0') {
      iVar4 = FUN_6b811136((int)local_38,(ushort *)0x0,param_4,'\0');
      uVar7 = extraout_EDX_07;
      if (iVar4 < 0) goto LAB_6b81bec4;
      iVar4 = FUN_6b811136((int)piVar2,(ushort *)0x0,local_40,'\0');
      uVar7 = extraout_EDX_08;
    }
    if (-1 < iVar4) {
      local_30 = (short *)(puVar6 + 0xc);
      local_32 = *(short *)(puVar6 + 8);
      if (*(uint *)(puVar6 + 8) < 2) {
        local_34 = 0;
      }
      else {
        local_34 = local_32 - 2;
      }
      if ((((3 < local_34) && (*piVar2 == 1)) &&
          (sVar1 = *local_30, sVar1 == *(short *)((int)local_30 + (local_34 - 2 & 0xfffffffe)))) &&
         ((sVar1 == 0x22 || (sVar1 == 0x27)))) {
        local_30 = (short *)(puVar6 + 0xe);
        local_34 = local_34 - 4;
        local_32 = *(short *)(puVar6 + 8) + -4;
      }
      FUN_6b811136((int)piVar2,(ushort *)0x0,&local_34,'\x01');
      uVar7 = extraout_EDX_05;
    }
  }
LAB_6b81bec4:
  if (puVar6 != local_18) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar6);
    uVar7 = extraout_EDX_06;
  }
LAB_6b81be02:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar7);
  return;
}



int __fastcall
FUN_6b81bef2(int param_1,int param_2,ushort *param_3,char param_4,undefined4 *param_5)

{
  bool bVar1;
  int iVar2;
  int iVar3;
  ushort uVar4;
  int iVar5;
  uint uVar6;
  ushort *puVar7;
  int in_FS_OFFSET;
  undefined local_8c [4];
  undefined4 local_88;
  undefined4 local_84;
  uint *local_80;
  undefined4 local_7c;
  undefined4 local_78;
  undefined4 local_74;
  undefined4 local_70;
  undefined4 local_6c;
  ushort *local_68;
  undefined4 local_64;
  undefined4 local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined4 local_54;
  uint *local_50;
  undefined4 local_4c;
  undefined4 local_48;
  undefined4 local_44;
  undefined local_40 [4];
  undefined4 local_3c;
  uint local_38;
  undefined4 local_34;
  uint local_30;
  int local_2c;
  ushort local_28;
  undefined2 local_26;
  int local_24;
  int local_20;
  ushort local_1c [4];
  uint local_14;
  int local_10;
  char local_9;
  
  *param_5 = 0xffffffff;
  local_9 = '\0';
  if ((*(uint *)(param_2 + 0x20) | *(uint *)(param_2 + 0x24)) == 0) {
    iVar5 = 0;
  }
  else {
    iVar5 = (*(int *)(param_2 + 0x20) - *(int *)(DAT_6b8b083c + 0x9e8)) + DAT_6b8b083c;
  }
  uVar6 = *(uint *)(param_2 + 0x18);
  if (iVar5 == 0) {
    return 0;
  }
  local_28 = *(ushort *)(iVar5 + 8);
  local_26 = *(undefined2 *)(iVar5 + 10);
  if ((*(uint *)(iVar5 + 0x10) | *(uint *)(iVar5 + 0x14)) == 0) {
    local_24 = 0;
  }
  else {
    local_24 = (*(int *)(iVar5 + 0x10) - *(int *)(DAT_6b8b083c + 0x9e8)) + DAT_6b8b083c;
  }
  if (local_28 == 0) {
    return 0;
  }
  local_20 = param_1;
  RtlInitUnicodeString(local_1c,0);
  if ((int)uVar6 < 0) {
    iVar5 = KernelBaseGetGlobalData();
    if (*(char *)(iVar5 + 4) == '\x01') {
      return -0x3fffffde;
    }
    iVar5 = RtlFormatCurrentUserKeyPath(local_1c);
    if (-1 < iVar5) {
      local_68 = local_1c;
      local_70 = 0x18;
      local_6c = 0;
      local_64 = 0x40;
      local_60 = 0;
      local_5c = 0;
      iVar5 = NtOpenKey(&local_34,0x80000000,&local_70);
      if (-1 < iVar5) {
        NtClose(local_34);
        puVar7 = local_1c;
        goto LAB_6b81bff2;
      }
      RtlFreeUnicodeString(local_1c);
      RtlInitUnicodeString(local_1c,0);
    }
    puVar7 = (ushort *)&DAT_6b8807ac;
LAB_6b81bff2:
    if (puVar7 == (ushort *)0x0) {
      iVar5 = 2;
      goto LAB_6b81c000;
    }
  }
  else {
    if ((uVar6 & 0x40000000) == 0) {
      puVar7 = (ushort *)0x0;
      goto LAB_6b81bff2;
    }
    puVar7 = &DAT_6b8807b4;
  }
  iVar5 = *puVar7 + 4;
LAB_6b81c000:
  iVar5 = (uint)local_28 + iVar5;
  local_38 = uVar6 & 0x10000000;
  if (local_38 != 0) {
    iVar5 = iVar5 + *(ushort *)(local_20 + 0x10) + 2;
  }
  if ((param_3 == (ushort *)0x0) || ((uVar6 & 0x20000000) == 0)) {
    bVar1 = false;
  }
  else {
    bVar1 = true;
    iVar5 = iVar5 + *param_3 + 2;
  }
  local_10 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iVar5 + 2);
  if (local_10 == 0) {
    if (puVar7 == local_1c) {
      RtlFreeUnicodeString(local_1c);
    }
    return -0x3fffffe9;
  }
  local_14 = (iVar5 + 2) * 0x10000;
  if (puVar7 != (ushort *)0x0) {
    RtlAppendUnicodeStringToString(&local_14,puVar7);
    RtlAppendUnicodeToString(&local_14,&DAT_6b88423c);
    if (puVar7 == local_1c) {
      RtlFreeUnicodeString(local_1c);
    }
  }
  RtlAppendUnicodeStringToString(&local_14,&local_28);
  if (local_38 != 0) {
    RtlAppendUnicodeToString(&local_14,&DAT_6b88423c);
    RtlAppendUnicodeStringToString(&local_14,local_20 + 0x10);
  }
  if (bVar1) {
    RtlAppendUnicodeToString(&local_14,&DAT_6b88423c);
    RtlAppendUnicodeStringToString(&local_14,param_3);
  }
  local_58 = 0x18;
  local_50 = &local_14;
  local_54 = 0;
  local_4c = 0xc0;
  local_48 = 0;
  local_44 = 0;
  if (param_4 == '\0') {
    iVar5 = NtOpenKey(param_5,0x80000000,&local_58);
    iVar2 = local_2c;
  }
  else {
    iVar5 = NtCreateKey(param_5,0x2000f,&local_58,0,0,0,local_40);
    iVar2 = local_2c;
    local_2c = local_10;
    while ((local_10 = local_2c, iVar5 == -0x3fffffcc && (local_9 == '\0'))) {
      local_30 = local_14;
      if (*(short *)(local_2c + (local_14 & 0xfffe)) != 0x5c) {
        uVar6 = local_14 & 0xffff;
        do {
          uVar4 = (short)uVar6 - 2;
          uVar6 = (uint)uVar4;
          local_30 = local_30 & 0xffff0000 | (uint)uVar4;
        } while (*(short *)(local_2c + (uVar6 & 0xfffe)) != 0x5c);
      }
      local_88 = 0x18;
      local_80 = &local_30;
      local_84 = 0;
      local_7c = 0xc0;
      local_78 = 0;
      local_74 = 0;
      iVar3 = NtCreateKey(&local_3c,0x2000f,&local_88,0,0,0,local_8c);
      iVar2 = local_2c;
      if (iVar3 < 0) break;
      NtClose(local_3c);
      local_9 = '\x01';
      iVar5 = NtCreateKey(param_5,0x2000f,&local_58,0,0,0,local_40);
      iVar2 = local_2c;
      local_2c = local_10;
    }
  }
  local_2c = iVar2;
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_10);
  return iVar5;
}



// WARNING: Could not reconcile some variable overlaps

uint BaseDllReadWriteIniFile
               (char param_1,char param_2,char param_3,LPCWSTR param_4,short *param_5,short *param_6
               ,short *param_7,int *param_8)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  int *piVar4;
  int in_FS_OFFSET;
  int *local_c;
  undefined4 local_8;
  
                    // 0x1c110  53  BaseDllReadWriteIniFile
  uVar1 = local_8;
  if (param_3 != '\0') {
    param_6 = (short *)0x0;
  }
  local_8 = local_8 & 0xffffff00;
  if (param_2 == '\0') {
    if (param_5 == (short *)0x0) {
      if (param_3 != '\0') {
        return 0xc000000d;
      }
      if (param_7 == (short *)0x0) {
        return 0xc000000d;
      }
      param_6 = (short *)0x0;
      uVar3 = 5;
LAB_6b81c22f:
      local_8 = CONCAT31(SUB43(uVar1,1),1);
    }
    else {
      if (param_7 == (short *)0x0) {
        return 0xc000000d;
      }
      if (param_6 == (short *)0x0) {
        local_8 = CONCAT31(SUB43(uVar1,1),1);
        if (param_3 == '\0') {
          uVar3 = 4;
        }
        else {
          uVar3 = 6;
        }
      }
      else {
        uVar3 = 1;
      }
    }
  }
  else if (param_5 == (short *)0x0) {
    uVar3 = -(uint)(param_4 != (LPCWSTR)0x0) & 9;
  }
  else if (param_6 == (short *)0x0) {
    if (param_7 != (short *)0x0) {
      uVar3 = 7;
      goto LAB_6b81c22f;
    }
    uVar3 = 8;
  }
  else {
    uVar3 = 3 - (param_7 != (short *)0x0);
  }
  uVar1 = FUN_6b81c289(param_1,uVar3,param_2,(char)local_8,param_4,param_5,param_6,param_7,param_8,
                       (int *)&local_c);
  piVar4 = local_c;
  if ((int)uVar1 < 0) {
    return uVar1;
  }
  if (*local_c == 9) {
    uVar1 = FUN_6b8223b0();
  }
  else if (local_c[2] == 0) {
    uVar1 = 0xc0000016;
  }
  else {
    uVar1 = FUN_6b81c74a(local_c);
  }
  if (uVar1 == 0xc0000016) {
    uVar1 = FUN_6b8104af(piVar4);
  }
  if ((int)uVar1 < 0) {
LAB_6b81c1a4:
    if (uVar1 != 0x80000005) goto LAB_6b81c1ac;
  }
  else {
    if (((*piVar4 == 6) || (*piVar4 == 5)) || (*piVar4 == 4)) {
      uVar1 = FUN_6b81117e((int)piVar4,(void *)0x0,(void *)0x0,0,'\x01');
    }
    if ((int)uVar1 < 0) goto LAB_6b81c1a4;
  }
  if (*(char *)(piVar4 + 1) == '\0') {
    if (param_8 != (int *)0x0) {
      *param_8 = piVar4[0x13];
    }
  }
  else {
    iVar2 = KernelBaseGetGlobalData();
    *(int *)(iVar2 + 0x18) = *(int *)(iVar2 + 0x18) + 1;
  }
LAB_6b81c1ac:
  if (*(char *)((int)piVar4 + 6) != '\0') {
    if (*(char *)((int)piVar4 + 5) == '\0') {
      iVar2 = piVar4[0x13];
    }
    else {
      iVar2 = piVar4[0x15];
    }
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iVar2);
    piVar4 = local_c;
  }
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,piVar4);
  return uVar1;
}



int __fastcall
FUN_6b81c289(char param_1,undefined4 param_2,undefined param_3,char param_4,LPCWSTR param_5,
            short *param_6,short *param_7,short *param_8,undefined4 *param_9,int *param_10)

{
  char cVar1;
  WCHAR WVar2;
  DWORD DVar3;
  uint uVar4;
  undefined4 *puVar5;
  short *psVar6;
  code *pcVar8;
  int iVar9;
  short sVar10;
  int iVar11;
  undefined4 uVar12;
  int iVar13;
  short *psVar14;
  short sVar15;
  undefined2 *puVar16;
  LPCWSTR pWVar17;
  int in_FS_OFFSET;
  short local_28;
  short local_26;
  LPCWSTR local_24;
  uint local_20;
  undefined4 *local_1c;
  undefined2 *local_18;
  int local_14;
  int local_10;
  uint local_c;
  char local_5;
  short *psVar7;
  
  iVar11 = 0;
  if (param_5 != (LPCWSTR)0x0) {
    if (param_1 == '\0') {
      pWVar17 = param_5;
      do {
        cVar1 = *(char *)pWVar17;
        pWVar17 = (LPCWSTR)((int)pWVar17 + 1);
      } while (cVar1 != '\0');
      iVar11 = (int)pWVar17 - ((int)param_5 + 1);
    }
    else {
      pWVar17 = param_5;
      do {
        WVar2 = *pWVar17;
        pWVar17 = pWVar17 + 1;
      } while (WVar2 != L'\0');
      iVar11 = (int)pWVar17 - (int)(param_5 + 1) >> 1;
    }
  }
  local_18 = (undefined2 *)param_2;
  local_14 = iVar11;
  local_5 = param_1;
  if (param_6 == (short *)0x0) {
    local_c = 0;
    param_7 = (short *)0x0;
  }
  else {
    local_c = FUN_6b81c6dc(param_1,&param_6);
  }
  if (param_7 == (short *)0x0) {
    local_10 = 0;
  }
  else {
    local_10 = FUN_6b81c6dc(param_1,&param_7);
  }
  if ((param_8 == (short *)0x0) || (param_9 != (undefined4 *)0x0)) {
    iVar13 = 0;
  }
  else {
    psVar14 = param_8;
    if (param_4 == '\0') {
      if (param_1 != '\0') {
        do {
          sVar15 = *psVar14;
          psVar14 = psVar14 + 1;
          psVar6 = param_8 + 1;
        } while (sVar15 != 0);
LAB_6b826d07:
        iVar13 = (int)psVar14 - (int)psVar6 >> 1;
        goto LAB_6b81c30e;
      }
      do {
        cVar1 = *(char *)psVar14;
        psVar14 = (short *)((int)psVar14 + 1);
        psVar6 = (short *)((int)param_8 + 1);
      } while (cVar1 != '\0');
    }
    else {
      if (param_1 != '\0') {
        sVar15 = *param_8;
        while (psVar6 = param_8, sVar15 != 0) {
          do {
            sVar15 = *psVar14;
            psVar14 = psVar14 + 1;
          } while (sVar15 != 0);
          sVar15 = *psVar14;
        }
        goto LAB_6b826d07;
      }
      cVar1 = *(char *)param_8;
      while (psVar6 = param_8, cVar1 != '\0') {
        do {
          cVar1 = *(char *)psVar14;
          psVar14 = (short *)((int)psVar14 + 1);
        } while (cVar1 != '\0');
        cVar1 = *(char *)psVar14;
      }
    }
    iVar13 = (int)psVar14 - (int)psVar6;
  }
LAB_6b81c30e:
  if (param_5 == (LPCWSTR)0x0) {
LAB_6b81c335:
    local_20 = RtlGetLongestNtPathLength();
  }
  else {
    if (local_5 == '\0') {
      DVar3 = GetFullPathNameA((LPCSTR)param_5,0,(LPSTR)0x0,(LPSTR *)0x0);
    }
    else {
      DVar3 = GetFullPathNameW(param_5,0,(LPWSTR)0x0,(LPWSTR *)0x0);
    }
    local_20 = DVar3 + 5;
    uVar4 = RtlGetLongestNtPathLength();
    if (local_20 <= uVar4) goto LAB_6b81c335;
  }
  local_20 = local_20 * 2;
  iVar9 = local_20 + 0xb0;
  if (local_5 == '\0') {
    iVar9 = iVar9 + iVar11 * 2 + 2;
  }
  puVar5 = (undefined4 *)KernelBaseGetGlobalData();
  puVar5 = (undefined4 *)
           RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar5,
                           iVar9 + 6 + (local_10 + iVar13 + local_c) * 2);
  if (puVar5 == (undefined4 *)0x0) {
    return -0x3fffffe9;
  }
  puVar5[3] = 0;
  *puVar5 = local_18;
  *(undefined *)(puVar5 + 1) = param_3;
  *(char *)(puVar5 + 0x12) = param_4;
  *(undefined2 *)(puVar5 + 8) = 0;
  puVar5[9] = puVar5 + 0x2c;
  local_18 = (undefined2 *)((int)(puVar5 + 0x2c) + local_20);
  *(short *)((int)puVar5 + 0x22) = (short)local_20;
  *(char *)((int)puVar5 + 5) = local_5;
  *(undefined *)((int)puVar5 + 6) = 0;
  local_1c = puVar5;
  if (param_5 == (LPCWSTR)0x0) {
    RtlInitUnicodeString(puVar5 + 6,L"win.ini");
    iVar11 = DAT_6b8b07cc;
    puVar5[4] = puVar5[6];
    puVar5[5] = puVar5[7];
    if ((*(uint *)(iVar11 + 0x10) | *(uint *)(iVar11 + 0x14)) == 0) {
      iVar11 = 0;
    }
    else {
      iVar11 = (*(int *)(iVar11 + 0x10) - *(int *)(DAT_6b8b083c + 0x9e8)) + DAT_6b8b083c;
    }
    puVar5[2] = iVar11;
  }
  else {
    sVar15 = (short)iVar11;
    *(short *)((int)puVar5 + 0x1a) = sVar15 * 2 + 2;
    if (local_5 == '\0') {
      local_24 = param_5;
      local_26 = sVar15 + 1;
      puVar5[7] = local_18;
      local_18 = local_18 + iVar11 + 1;
      *(undefined2 *)(puVar5 + 6) = 0;
      local_28 = sVar15;
      pcVar8 = (code *)GetEightBitStringToUnicodeStringRoutine(puVar5 + 6,&local_28,0);
      _guard_check_icall();
      iVar9 = (*pcVar8)();
      iVar11 = local_14;
      if (iVar9 < 0) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar5);
        return iVar9;
      }
    }
    else {
      *(short *)(puVar5 + 6) = sVar15 * 2;
      puVar5[7] = param_5;
    }
    *(undefined2 *)(puVar5 + 4) = 0;
    psVar14 = (short *)(puVar5[7] + iVar11 * 2);
    psVar6 = psVar14;
    if (iVar11 != 0) {
      do {
        psVar7 = psVar6 + -1;
        psVar14 = psVar7;
        if (((psVar7 < (short *)puVar5[7] || psVar7 == (short *)puVar5[7]) ||
            (sVar15 = *psVar7, psVar14 = psVar6, sVar15 == 0x5c)) || (sVar15 == 0x2f)) break;
        psVar6 = psVar7;
      } while (sVar15 != 0x3a);
    }
    puVar5[5] = psVar14;
    sVar15 = ((short)iVar11 - (short)((int)psVar14 - puVar5[7] >> 1)) * 2;
    *(short *)(puVar5 + 4) = sVar15;
    *(short *)((int)puVar5 + 0x12) = sVar15 + 2;
    FUN_6b81148a((int)(puVar5 + 6),(int)(puVar5 + 4),(uint **)(puVar5 + 2));
  }
  if (param_6 == (short *)0x0) {
    RtlInitAnsiString(puVar5 + 10,0);
    RtlInitUnicodeString(puVar5 + 0xe,0);
    puVar16 = local_18;
  }
  else {
    local_20 = local_c & 0xffff;
    sVar10 = (short)local_20;
    sVar15 = sVar10 * 2;
    *(short *)((int)puVar5 + 0x2a) = sVar15 + 1;
    *(short *)((int)puVar5 + 0x3a) = (sVar15 + 1) * 2;
    if (local_5 == '\0') {
      puVar5[0xb] = param_6;
      iVar11 = 2;
      puVar5[0xf] = local_18;
      sVar15 = 0;
    }
    else {
      puVar5[0xb] = local_18;
      puVar5[0xf] = param_6;
      sVar10 = 0;
      iVar11 = 1;
    }
    *(short *)(local_1c + 10) = sVar10;
    *(short *)(local_1c + 0xe) = sVar15;
    puVar16 = (undefined2 *)(iVar11 + (int)(local_18 + local_c));
    puVar5 = local_1c;
    local_18 = local_18 + local_c;
  }
  if (param_7 == (short *)0x0) {
    RtlInitAnsiString(puVar5 + 0xc,0);
    RtlInitUnicodeString(puVar5 + 0x10,0);
  }
  else {
    sVar10 = (short)local_10;
    sVar15 = sVar10 * 2;
    *(short *)((int)puVar5 + 0x32) = sVar15 + 1;
    *(short *)((int)puVar5 + 0x42) = (sVar15 + 1) * 2;
    if (local_5 == '\0') {
      puVar5[0xd] = param_7;
      sVar15 = 0;
      puVar5[0x11] = puVar16;
      iVar11 = 2;
    }
    else {
      puVar5[0xd] = puVar16;
      puVar5[0x11] = param_7;
      sVar10 = 0;
      iVar11 = 1;
    }
    puVar16 = (undefined2 *)((int)puVar16 + iVar11 + local_10 * 2);
    *(short *)(local_1c + 0xc) = sVar10;
    *(short *)(local_1c + 0x10) = sVar15;
    puVar5 = local_1c;
  }
  if (param_8 == (short *)0x0) {
    param_8 = (short *)0x0;
    puVar5[0x14] = 0;
    puVar5[0x15] = 0;
    puVar5[0x13] = 0;
  }
  else {
    if (*(char *)(puVar5 + 1) != '\0') {
      if (local_5 == '\0') {
        puVar5[0x13] = param_8;
        puVar5[0x14] = iVar13;
        *puVar16 = 0;
        puVar5[0x16] = 0;
        puVar5[0x15] = puVar16;
      }
      else {
        puVar5[0x15] = param_8;
        puVar5[0x16] = iVar13 * 2;
        *(undefined *)puVar16 = 0;
        puVar5[0x14] = 0;
        puVar5[0x13] = puVar16;
      }
      goto LAB_6b81c532;
    }
    if (param_9 == (undefined4 *)0x0) {
      uVar12 = 0;
    }
    else {
      uVar12 = *param_9;
    }
    puVar5[0x14] = uVar12;
    puVar5[0x13] = 0;
    if (local_5 == '\0') {
      puVar5[0x15] = param_8;
      puVar5[0x16] = 0;
      goto LAB_6b81c532;
    }
    puVar5[0x15] = 0;
  }
  puVar5[0x16] = param_8;
LAB_6b81c532:
  *param_10 = (int)puVar5;
  return 0;
}



int __fastcall FUN_6b81c6dc(char param_1,short **param_2)

{
  short *psVar1;
  short *psVar2;
  short *psVar3;
  
  psVar2 = *param_2;
  if (param_1 == '\0') {
    for (; *(char *)psVar2 == ' '; psVar2 = (short *)((int)psVar2 + 1)) {
    }
    *param_2 = psVar2;
    psVar3 = psVar2;
    if (*(char *)psVar2 != '\0') {
      do {
        psVar2 = (short *)((int)psVar2 + 1);
      } while (*(char *)psVar2 != '\0');
      psVar3 = *param_2;
    }
    psVar1 = psVar2;
    if (psVar3 < psVar2) {
      do {
        psVar2 = psVar1;
        psVar1 = (short *)((int)psVar2 + -1);
      } while (*(char *)(short *)((int)psVar2 + -1) == ' ');
      psVar3 = *param_2;
    }
    return (int)psVar2 - (int)psVar3;
  }
  for (; *psVar2 == 0x20; psVar2 = psVar2 + 1) {
  }
  *param_2 = psVar2;
  psVar3 = psVar2;
  if (*psVar2 != 0) {
    do {
      psVar2 = psVar2 + 1;
    } while (*psVar2 != 0);
    psVar3 = *param_2;
  }
  psVar1 = psVar2;
  if (psVar3 < psVar2) {
    do {
      psVar2 = psVar1;
      psVar1 = psVar2 + -1;
    } while (psVar2[-1] == 0x20);
    psVar3 = *param_2;
  }
  return (int)psVar2 - (int)psVar3 >> 1;
}



int __fastcall FUN_6b81c74a(int *param_1)

{
  undefined4 uVar1;
  uint *puVar2;
  int iVar3;
  int *local_c [2];
  
  if (*param_1 == 0) {
    iVar3 = 0;
  }
  else {
    local_c[0] = param_1;
    if (*param_1 == 5) {
      iVar3 = FUN_6b856a71((int)param_1);
    }
    else {
      uVar1 = FUN_6b81c868((int)param_1,(short **)0x0,(short **)local_c);
      if ((char)uVar1 != '\0') {
        puVar2 = FUN_6b81c7c4(param_1[2],local_c[0]);
        if (puVar2 == (uint *)0x0) {
          return -0x3fffffea;
        }
        if (*param_1 == 1) {
          iVar3 = FUN_6b81bd3f(param_1,(ushort *)puVar2,(uint *)0x0,(ushort *)0x0);
          return iVar3;
        }
        if (*param_1 == 4) {
          iVar3 = FUN_6b8193ec((int)param_1,(int)puVar2);
          return iVar3;
        }
        if (*param_1 == 6) {
          iVar3 = FUN_6b856c4f(param_1,(ushort *)puVar2);
          return iVar3;
        }
        if ((*param_1 == 2) || (*param_1 == 3)) {
          iVar3 = FUN_6b857301(param_1,(ushort *)puVar2,(uint *)0x0,(short *)0x0);
          return iVar3;
        }
        if ((*param_1 == 7) || (*param_1 == 8)) {
          iVar3 = FUN_6b856e92(param_1,(ushort *)puVar2);
          return iVar3;
        }
      }
      iVar3 = -0x3ffffff3;
    }
  }
  return iVar3;
}



uint * __fastcall FUN_6b81c7c4(int param_1,undefined4 param_2)

{
  char cVar1;
  uint *puVar2;
  uint *puVar3;
  undefined2 local_10;
  undefined2 local_e;
  int local_c;
  undefined4 local_8;
  
  puVar3 = (uint *)0x0;
  if ((*(uint *)(param_1 + 0x18) | *(uint *)(param_1 + 0x1c)) != 0) {
    local_8 = param_2;
    for (puVar2 = (uint *)((DAT_6b8b083c - *(int *)(DAT_6b8b083c + 0x9e8)) +
                          *(int *)(param_1 + 0x18)); puVar2 != (uint *)0x0;
        puVar2 = (uint *)((*puVar2 - *(int *)(DAT_6b8b083c + 0x9e8)) + DAT_6b8b083c)) {
      local_10 = *(undefined2 *)(puVar2 + 2);
      local_e = *(undefined2 *)((int)puVar2 + 10);
      if ((puVar2[4] | puVar2[5]) == 0) {
        local_c = 0;
      }
      else {
        local_c = (puVar2[4] - *(int *)(DAT_6b8b083c + 0x9e8)) + DAT_6b8b083c;
      }
      cVar1 = RtlEqualUnicodeString(&local_10,local_8,1);
      if (cVar1 != '\0') {
        return puVar2;
      }
      if ((*puVar2 | puVar2[1]) == 0) break;
    }
  }
  if ((*(uint *)(param_1 + 0x20) | *(uint *)(param_1 + 0x24)) != 0) {
    puVar3 = (uint *)((*(int *)(param_1 + 0x20) - *(int *)(DAT_6b8b083c + 0x9e8)) + DAT_6b8b083c);
  }
  return puVar3;
}



undefined4 __fastcall FUN_6b81c868(int param_1,short **param_2,short **param_3)

{
  uint in_EAX;
  short *psVar1;
  
  if (param_2 == (short **)0x0) {
    if (param_3 == (short **)0x0) goto LAB_6b81c8b8;
    psVar1 = (short *)(param_1 + 0x38);
    in_EAX = 0;
    param_2 = param_3;
    if (*psVar1 != 0) goto LAB_6b81c87f;
    in_EAX = RtlAnsiStringToUnicodeString(psVar1,param_1 + 0x28,0);
  }
  else {
    psVar1 = (short *)(param_1 + 0x28);
    in_EAX = 0;
    if (*psVar1 != 0) goto LAB_6b81c87f;
    in_EAX = RtlUnicodeStringToAnsiString(psVar1,param_1 + 0x38,0);
  }
  if ((int)in_EAX < 0) {
LAB_6b81c8b8:
    return in_EAX & 0xffffff00;
  }
LAB_6b81c87f:
  *param_2 = psVar1;
  return CONCAT31((int3)(in_EAX >> 8),1);
}



uint * __fastcall FUN_6b81c8bc(int param_1,undefined4 param_2)

{
  char cVar1;
  uint *puVar2;
  uint *puVar3;
  undefined2 local_10;
  undefined2 local_e;
  int local_c;
  undefined4 local_8;
  
  puVar3 = (uint *)0x0;
  if ((*(uint *)(param_1 + 0x18) | *(uint *)(param_1 + 0x1c)) != 0) {
    local_8 = param_2;
    for (puVar2 = (uint *)((DAT_6b8b083c - *(int *)(DAT_6b8b083c + 0x9e8)) +
                          *(int *)(param_1 + 0x18)); puVar2 != (uint *)0x0;
        puVar2 = (uint *)((*puVar2 - *(int *)(DAT_6b8b083c + 0x9e8)) + DAT_6b8b083c)) {
      local_10 = *(undefined2 *)(puVar2 + 2);
      local_e = *(undefined2 *)((int)puVar2 + 10);
      if ((puVar2[4] | puVar2[5]) == 0) {
        local_c = 0;
      }
      else {
        local_c = (puVar2[4] - *(int *)(DAT_6b8b083c + 0x9e8)) + DAT_6b8b083c;
      }
      cVar1 = RtlEqualUnicodeString(&local_10,local_8,1);
      if (cVar1 != '\0') {
        return puVar2;
      }
      if ((*puVar2 | puVar2[1]) == 0) break;
    }
  }
  if ((*(uint *)(param_1 + 0x20) | *(uint *)(param_1 + 0x24)) != 0) {
    puVar3 = (uint *)((*(int *)(param_1 + 0x20) - *(int *)(DAT_6b8b083c + 0x9e8)) + DAT_6b8b083c);
  }
  return puVar3;
}



undefined4 __fastcall FUN_6b81c967(int param_1,short **param_2,short **param_3)

{
  uint in_EAX;
  short *psVar1;
  
  if (param_2 == (short **)0x0) {
    if (param_3 == (short **)0x0) goto LAB_6b81c9b7;
    psVar1 = (short *)(param_1 + 0x40);
    in_EAX = 0;
    if (*psVar1 != 0) goto LAB_6b81c995;
    in_EAX = RtlAnsiStringToUnicodeString(psVar1,param_1 + 0x30,0);
  }
  else {
    psVar1 = (short *)(param_1 + 0x30);
    in_EAX = 0;
    param_3 = param_2;
    if (*psVar1 != 0) goto LAB_6b81c995;
    in_EAX = RtlUnicodeStringToAnsiString(psVar1,param_1 + 0x40,0);
  }
  if ((int)in_EAX < 0) {
LAB_6b81c9b7:
    return in_EAX & 0xffffff00;
  }
LAB_6b81c995:
  *param_3 = psVar1;
  return CONCAT31((int3)(in_EAX >> 8),1);
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 GetTickCount64(void)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  
  do {
  } while (_DAT_7ffe0324 != _DAT_7ffe0328);
  uVar1 = (uint)((ulonglong)_DAT_7ffe0324 * (ulonglong)_DAT_7ffe0004);
  uVar4 = (uint)((ulonglong)_DAT_7ffe0320 * (ulonglong)_DAT_7ffe0004 >> 0x20);
  uVar2 = (uint)((ulonglong)_DAT_7ffe0320 * (ulonglong)_DAT_7ffe0004) >> 0x18 | uVar4 << 8;
  uVar3 = uVar1 * 0x100;
  return CONCAT44((uVar4 >> 0x18) +
                  ((int)((ulonglong)_DAT_7ffe0324 * (ulonglong)_DAT_7ffe0004 >> 0x20) << 8 |
                  uVar1 >> 0x18) + (uint)CARRY4(uVar2,uVar3),uVar2 + uVar3);
}



void FUN_6b81ca20(int param_1,uint param_2,ushort *param_3,int param_4,ushort *param_5,int param_6)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  undefined4 extraout_EDX;
  undefined4 uVar4;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  DWORD dwErrCode;
  int local_b4;
  int local_b0;
  ushort *local_ac;
  int local_a8;
  int local_a4;
  int local_a0;
  int local_9c;
  uint local_98;
  uint local_94;
  uint local_90;
  uint local_8c;
  uint local_88;
  uint local_84;
  uint local_80;
  undefined4 local_7c;
  undefined4 local_78;
  uint local_74;
  uint local_70;
  uint local_6c;
  ushort *local_68;
  ushort *local_64;
  uint local_60;
  ushort *local_58;
  undefined4 local_54;
  undefined4 local_48;
  ushort *local_44;
  ushort *local_40;
  uint local_3c;
  ushort *local_34;
  undefined4 local_30;
  undefined4 local_24;
  uint local_20;
  int local_1c;
  int local_18;
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)&local_b4;
  local_b4 = param_4;
  local_ac = param_3;
  local_a8 = param_6;
  if ((param_3 == (ushort *)0x0) || (param_5 == (ushort *)0x0)) {
    dwErrCode = 0x57;
  }
  else {
    if ((bool)(((param_2 & 0xa7fcefc0) == 0 && ((param_2 & 0xffffffe2) - 1 & param_2 & 0x22) == 0) &
              ~((((byte)param_2 & 0xf1) - 1 & (byte)param_2 & 0x11) != 0))) {
      if ((param_2 & 0x8000000) == 0) {
        local_9c = *(int *)(param_1 + 0xf8);
      }
      else {
        local_9c = *(int *)(param_1 + 0xf4);
      }
      local_1c = 0;
      local_b0 = 0;
      local_18 = 0;
      local_68 = param_3;
      local_58 = param_3;
      local_44 = param_5;
      local_34 = param_5;
      if (((param_2 == 0) || (param_2 == 1)) && (local_9c == 0)) {
        if (param_4 < 0) {
          local_b4 = FUN_6b8502c0((short *)param_3);
        }
        if (local_a8 < 0) {
          local_a8 = FUN_6b8502c0((short *)param_5);
        }
        uVar3 = param_2;
        if (param_2 != 1) {
          uVar3 = 0;
        }
        iVar1 = FUN_6b8165a1(&local_58,local_b4,&local_34,local_a8,uVar3,&local_b0,&local_a4);
        uVar4 = extraout_EDX_01;
        if (iVar1 != 0) goto LAB_6b81cc6a;
        if (local_b0 != 2) {
          local_1c = local_b0;
        }
        if (local_a4 != 2) {
          local_18 = local_a4;
        }
      }
      local_a0 = param_1;
      local_70 = (uint)((*(byte *)(param_1 + 0xfc) & 1) != 0);
      local_3c = param_2 & 0x10000000;
      if (local_b4 < 0) {
        local_64 = (ushort *)0xffffffff;
        local_60 = 1;
      }
      else {
        local_64 = local_ac + local_b4;
        local_60 = local_3c;
      }
      local_74 = (uint)(local_b4 >= 0);
      if (local_a8 < 0) {
        local_40 = (ushort *)0xffffffff;
        local_3c = 1;
      }
      else {
        local_40 = param_5 + local_a8;
        local_74 = 1;
      }
      local_54 = 0;
      local_30 = 0;
      local_48 = 0;
      local_24 = 0;
      uVar3 = param_2 & 2;
      local_90 = uVar3;
      if (uVar3 != 0) {
        local_90 = 1;
      }
      local_8c = (uint)((param_2 & 4) != 0);
      local_94 = local_8c;
      if (local_18 != 0) {
        local_94 = 1;
      }
      local_98 = (uint)((param_2 & 0x1000) != 0);
      local_88 = (uint)((param_2 & 0x10) != 0);
      local_84 = (uint)((param_2 & 0x20) != 0);
      local_80 = (uint)((param_2 & 8) != 0);
      uVar2 = 0xffffffff;
      local_7c = 0;
      local_78 = 0;
      local_6c = 0xffffffff;
      local_20 = 0xc4;
      if ((param_2 & 1) != 0) {
        uVar2 = 0xe7ffffff;
        local_6c = 0xe7ffffff;
      }
      if (uVar3 == 0) {
        if ((*(byte *)(param_1 + 0xfc) & 0x10) == 0) {
          local_20 = 0xf5;
        }
        else {
          local_20 = 0xf6;
        }
      }
      else {
        uVar2 = uVar2 & 0xff00ffff;
        local_6c = uVar2;
      }
      if ((param_2 & 0x10000) != 0) {
        uVar2 = uVar2 & 0xdfffffff;
        local_6c = uVar2;
      }
      if (((param_2 & 0x20000) != 0) && (local_6c = uVar2 & 0xfeffffff, (param_2 & 1) != 0)) {
        local_20 = local_20 & 0xfffffffb;
      }
      local_b0 = local_18;
      FUN_6b81cd80(&local_a0);
      uVar4 = extraout_EDX;
      goto LAB_6b81cc6a;
    }
    dwErrCode = 0x3ec;
  }
  SetLastError(dwErrCode);
  uVar4 = extraout_EDX_00;
LAB_6b81cc6a:
  FUN_6b8224af(local_c ^ (uint)&local_b4,uVar4);
  return;
}


/*
Unable to decompile 'FUN_6b81cd80'
Cause: Exception while decompiling 6b81cd80: process: timeout

*/


DWORD GetCurrentThreadId(void)

{
  int in_FS_OFFSET;
  
                    // 0x1df10  546  GetCurrentThreadId
  return *(DWORD *)(*(int *)(in_FS_OFFSET + 0x18) + 0x24);
}



LPVOID TlsGetValue(DWORD dwTlsIndex)

{
  LPVOID pvVar1;
  
                    // 0x1df20  1446  TlsGetValue
                    // WARNING: Could not recover jumptable at 0x6b81df26. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = TlsGetValue(dwTlsIndex);
  return pvVar1;
}



BOOL QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)

{
  BOOL BVar1;
  
                    // 0x1df40  1105  QueryPerformanceCounter
                    // WARNING: Could not recover jumptable at 0x6b81df46. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = QueryPerformanceCounter(lpPerformanceCount);
  return BVar1;
}



BOOL HeapFree(HANDLE hHeap,DWORD dwFlags,LPVOID lpMem)

{
  BOOL BVar1;
  
                    // 0x1df60  847  HeapFree
                    // WARNING: Could not recover jumptable at 0x6b81df66. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = HeapFree(hHeap,dwFlags,lpMem);
  return BVar1;
}



int MultiByteToWideChar(UINT CodePage,DWORD dwFlags,LPCSTR lpMultiByteStr,int cbMultiByte,
                       LPWSTR lpWideCharStr,int cchWideChar)

{
  int iVar1;
  
                    // 0x1df80  1013  MultiByteToWideChar
                    // WARNING: Could not recover jumptable at 0x6b81df86. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = MultiByteToWideChar(CodePage,dwFlags,lpMultiByteStr,cbMultiByte,lpWideCharStr,cchWideChar)
  ;
  return iVar1;
}



void SetLastError(void)

{
                    // WARNING: Could not recover jumptable at 0x6b81dfa0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1dfa0  1334  SetLastError
  RtlSetLastWin32Error();
  return;
}



BOOL TlsSetValue(DWORD dwTlsIndex,LPVOID lpTlsValue)

{
  BOOL BVar1;
  
                    // 0x1dfb0  1447  TlsSetValue
                    // WARNING: Could not recover jumptable at 0x6b81dfb6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = TlsSetValue(dwTlsIndex,lpTlsValue);
  return BVar1;
}



int CompareStringW(LCID Locale,DWORD dwCmpFlags,PCNZWCH lpString1,int cchCount1,PCNZWCH lpString2,
                  int cchCount2)

{
  int iVar1;
  
                    // 0x1dfd0  161  CompareStringW
                    // WARNING: Could not recover jumptable at 0x6b81dfd6. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = CompareStringW(Locale,dwCmpFlags,lpString1,cchCount1,lpString2,cchCount2);
  return iVar1;
}



int WideCharToMultiByte(UINT CodePage,DWORD dwFlags,LPCWSTR lpWideCharStr,int cchWideChar,
                       LPSTR lpMultiByteStr,int cbMultiByte,LPCSTR lpDefaultChar,
                       LPBOOL lpUsedDefaultChar)

{
  int iVar1;
  
                    // 0x1dff0  1540  WideCharToMultiByte
                    // WARNING: Could not recover jumptable at 0x6b81dff6. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = WideCharToMultiByte(CodePage,dwFlags,lpWideCharStr,cchWideChar,lpMultiByteStr,cbMultiByte,
                              lpDefaultChar,lpUsedDefaultChar);
  return iVar1;
}



DWORD GetLastError(void)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b81e010. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1e010  615  GetLastError
  DVar1 = GetLastError();
  return DVar1;
}



LONG _llseek(HFILE hFile,LONG lOffset,int iOrigin)

{
  DWORD DVar1;
  
                    // 0x1e020  1581  _llseek
  if (iOrigin != 0) {
    if (iOrigin == 1) {
      DVar1 = SetFilePointer((HANDLE)hFile,lOffset,(PLONG)0x0,1);
      return DVar1;
    }
    if (iOrigin != 2) {
      return -1;
    }
    iOrigin = 2;
  }
  DVar1 = SetFilePointer((HANDLE)hFile,lOffset,(PLONG)0x0,iOrigin);
  return DVar1;
}



UINT _hread(HFILE hFile,LPVOID lpBuffer,UINT uBytes)

{
  BOOL BVar1;
  UINT local_8;
  
                    // 0x1e070  1577  _hread
                    // 0x1e070  1583  _lread
  BVar1 = ReadFile((HANDLE)hFile,lpBuffer,uBytes,&local_8,(LPOVERLAPPED)0x0);
  if (BVar1 == 0) {
    local_8 = 0xffffffff;
  }
  return local_8;
}



int lstrlenW(LPCWSTR lpString)

{
  int iVar1;
  
                    // 0x1e0b0  1602  lstrlenW
                    // WARNING: Could not recover jumptable at 0x6b81e0b6. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = lstrlenW(lpString);
  return iVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL GlobalUnlock(HGLOBAL hMem)

{
  short sVar1;
  short sVar2;
  char cVar3;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar4;
  BOOL local_20;
  undefined4 local_14;
  
                    // 0x1e0d0  837  GlobalUnlock
  local_20 = 1;
  if (((uint)hMem & 4) == 0) goto LAB_6b81e14c;
  RtlLockHeap(DAT_6b8b0734);
  cVar3 = RtlIsValidHandle(DAT_6b8b072c,(int)hMem + -4);
  if (cVar3 == '\0') {
    RtlSetLastWin32Error(6);
  }
  else {
    sVar2 = *(short *)((int)hMem + -2);
    sVar1 = sVar2 + -1;
    *(short *)((int)hMem + -2) = sVar1;
    if (sVar2 == 0) {
      *(undefined2 *)((int)hMem + -2) = 0;
      uVar4 = 0x9e;
    }
    else {
      if (sVar1 != 0) goto LAB_6b81e13c;
      uVar4 = 0;
    }
    RtlSetLastWin32Error(uVar4);
    local_20 = 0;
  }
LAB_6b81e13c:
  FUN_6b81e161();
LAB_6b81e14c:
  *in_FS_OFFSET = local_14;
  return local_20;
}



void FUN_6b81e161(void)

{
  RtlUnlockHeap(DAT_6b8b0734);
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

LPVOID GlobalLock(HGLOBAL hMem)

{
  short sVar1;
  LPVOID pvVar2;
  char cVar3;
  BOOL BVar4;
  undefined4 *in_FS_OFFSET;
  HGLOBAL local_28 [2];
  LPVOID local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x1e180  830  GlobalLock
  local_8 = &DAT_6b891c70;
  uStack12 = 0x6b81e18c;
  local_20 = (LPVOID)0x0;
  if (((uint)hMem & 4) == 0) {
    if (DAT_6b8b0730 == (HGLOBAL)0x0) {
      NtQuerySystemInformation(0x32,local_28,4,0);
      DAT_6b8b0730 = local_28[0];
    }
    if ((DAT_6b8b0730 <= hMem) || (BVar4 = IsBadReadPtr(hMem,1), BVar4 != 0)) {
      RtlSetLastWin32Error(6);
      hMem = (LPVOID)0x0;
    }
  }
  else {
    RtlLockHeap(DAT_6b8b0734);
    local_8 = (undefined *)0x1;
    cVar3 = RtlIsValidHandle(DAT_6b8b072c,(int)hMem + -4);
    if (cVar3 == '\0') {
      RtlSetLastWin32Error(6);
      local_20 = (LPVOID)0x0;
      pvVar2 = (LPVOID)0x0;
    }
    else {
                    // WARNING: Load size is inaccurate
      pvVar2 = *hMem;
      local_20 = pvVar2;
      if (pvVar2 == (LPVOID)0x0) {
        RtlSetLastWin32Error(0x9d);
      }
      else {
        sVar1 = *(short *)((int)hMem + -2);
        *(short *)((int)hMem + -2) = sVar1 + 1;
        if (sVar1 == 0xff) {
          *(undefined2 *)((int)hMem + -2) = 0xff;
        }
      }
    }
    hMem = pvVar2;
    local_8 = (undefined *)0xfffffffe;
    FUN_6b81e239();
  }
  *in_FS_OFFSET = local_14;
  return hMem;
}



void FUN_6b81e239(void)

{
  RtlUnlockHeap(DAT_6b8b0734);
  return;
}



// WARNING: Function: __SEH_prolog4_GS replaced with injection: SEH_prolog4

DWORD GetLongPathNameW(LPCWSTR lpszShortPath,LPWSTR lpszLongPath,DWORD cchBuffer)

{
  size_t _Size;
  WCHAR WVar1;
  short sVar2;
  LPCWSTR pWVar3;
  UINT uMode;
  DWORD DVar4;
  wchar_t *pwVar5;
  int iVar6;
  int *piVar7;
  LPCWSTR pWVar8;
  HANDLE hFindFile;
  short *psVar9;
  uint uVar10;
  DWORD DVar11;
  undefined4 *in_FS_OFFSET;
  LPCWSTR local_298;
  LPCWSTR local_28c;
  LPCWSTR local_284;
  LPCWSTR local_280;
  LPCWSTR local_27c;
  DWORD local_278;
  undefined local_274 [608];
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x1e260  628  GetLongPathNameW
  local_8 = &DAT_6b891c98;
  uStack12 = 0x6b81e26f;
  local_278 = 0;
  local_284 = (LPCWSTR)0x0;
  local_27c = (LPCWSTR)0x0;
  local_298 = (LPCWSTR)0x0;
  if (lpszShortPath == (LPCWSTR)0x0) {
    RtlSetLastWin32Error(0x57);
    DVar11 = 0;
    goto LAB_6b81e56b;
  }
  uMode = SetErrorMode(0x8001);
  local_8 = (undefined *)0x0;
  DVar4 = GetFileAttributesW(lpszShortPath);
  DVar11 = 0;
  if (DVar4 != 0xffffffff) {
    pwVar5 = FUN_6b81e728(lpszShortPath);
    if (((pwVar5 == (wchar_t *)0x0) || (*pwVar5 == L'\0')) ||
       (iVar6 = FUN_6b81e617(pwVar5,&local_284,&local_27c,0), iVar6 == 0)) {
      pWVar8 = lpszShortPath;
      do {
        WVar1 = *pWVar8;
        pWVar8 = pWVar8 + 1;
      } while (WVar1 != L'\0');
      DVar11 = (int)pWVar8 - (int)(lpszShortPath + 1) >> 1;
      if ((DVar11 < cchBuffer) && (lpszLongPath != (LPWSTR)0x0)) {
        local_278 = DVar11;
        if (lpszLongPath == lpszShortPath) goto LAB_6b81e551;
LAB_6b81e5ce:
        memmove(lpszLongPath,lpszShortPath,DVar11 * 2 + 2);
      }
      else {
LAB_6b81e5db:
        DVar11 = DVar11 + 1;
        local_278 = DVar11;
      }
    }
    else {
      pWVar8 = lpszShortPath;
      do {
        WVar1 = *pWVar8;
        pWVar8 = pWVar8 + 1;
      } while (WVar1 != L'\0');
      iVar6 = (int)pWVar8 - (int)(lpszShortPath + 1) >> 1;
      piVar7 = (int *)KernelBaseGetGlobalData();
      _Size = iVar6 * 2 + 2;
      pWVar8 = (LPCWSTR)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),*piVar7 + 0x200000
                                        ,_Size);
      if (pWVar8 == (LPCWSTR)0x0) {
LAB_6b82e734:
        RtlSetLastWin32Error(8);
        DVar11 = local_278;
      }
      else {
        memmove(pWVar8,lpszShortPath,_Size);
        local_284 = pWVar8 + ((int)local_284 - (int)lpszShortPath >> 1);
        local_27c = pWVar8 + ((int)local_27c - (int)lpszShortPath >> 1);
        local_280 = lpszLongPath;
        DVar11 = local_278;
        local_28c = pWVar8;
        pWVar3 = local_280;
        if ((cchBuffer != 0) && (lpszLongPath != (LPWSTR)0x0)) {
          if (lpszLongPath < lpszShortPath) {
LAB_6b81e57d:
            if (lpszLongPath + cchBuffer < lpszShortPath) goto LAB_6b81e3dc;
          }
          else if (lpszShortPath + iVar6 + 1 <= lpszLongPath) {
            if (lpszShortPath <= lpszLongPath) goto LAB_6b81e3dc;
            goto LAB_6b81e57d;
          }
          piVar7 = (int *)KernelBaseGetGlobalData();
          local_298 = (LPCWSTR)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),
                                               *piVar7 + 0x200000,cchBuffer * 2);
          DVar11 = local_278;
          pWVar3 = local_298;
          if (local_298 == (LPCWSTR)0x0) goto LAB_6b82e734;
        }
LAB_6b81e3dc:
        while( true ) {
          local_280 = pWVar3;
          iVar6 = (int)local_284 - (int)local_28c >> 1;
          uVar10 = DVar11 + iVar6;
          local_278 = uVar10;
          if ((iVar6 != 0) && (uVar10 < cchBuffer)) {
            memmove(local_280,local_28c,iVar6 * 2);
            local_280 = local_280 + iVar6;
          }
          WVar1 = *local_27c;
          *local_27c = L'\0';
          hFindFile = FindFirstFileW(pWVar8,(LPWIN32_FIND_DATAW)local_274);
          *local_27c = WVar1;
          if (hFindFile == (HANDLE)0xffffffff) break;
          FindClose(hFindFile);
          psVar9 = (short *)(local_274 + 0x2c);
          do {
            sVar2 = *psVar9;
            psVar9 = psVar9 + 1;
          } while (sVar2 != 0);
          iVar6 = (int)psVar9 - (int)(local_274 + 0x2e) >> 1;
          if (iVar6 == 0) {
            iVar6 = (int)local_27c - (int)local_284 >> 1;
          }
          else {
            local_284 = (LPCWSTR)(local_274 + 0x2c);
          }
          DVar11 = uVar10 + iVar6;
          local_278 = DVar11;
          if ((DVar11 < cchBuffer) && (lpszLongPath != (LPWSTR)0x0)) {
            memmove(local_280,local_284,iVar6 * 2);
            local_280 = local_280 + iVar6;
          }
          local_28c = local_27c;
          if ((*local_27c == L'\0') ||
             (iVar6 = FUN_6b81e617(local_27c,&local_284,&local_27c,0), pWVar3 = local_280,
             iVar6 == 0)) goto LAB_6b81e4ed;
        }
        DVar11 = 0;
        local_278 = 0;
LAB_6b81e4ed:
        if (DVar11 != 0) {
          pWVar8 = local_28c;
          do {
            WVar1 = *pWVar8;
            pWVar8 = pWVar8 + 1;
          } while (WVar1 != L'\0');
          iVar6 = (int)pWVar8 - (int)(local_28c + 1) >> 1;
          DVar11 = DVar11 + iVar6;
          if ((cchBuffer <= DVar11) || (lpszLongPath == (LPWSTR)0x0)) goto LAB_6b81e5db;
          local_278 = DVar11;
          memmove(local_280,local_28c,iVar6 * 2 + 2);
          lpszShortPath = local_298;
          if (local_298 != (LPCWSTR)0x0) goto LAB_6b81e5ce;
        }
      }
    }
  }
LAB_6b81e551:
  local_8 = (undefined *)0xfffffffe;
  FUN_6b81e5e7();
  SetErrorMode(uMode);
LAB_6b81e56b:
  *in_FS_OFFSET = local_14;
  return DVar11;
}



void FUN_6b81e5e7(void)

{
  undefined4 unaff_EBX;
  int unaff_EBP;
  int in_FS_OFFSET;
  
  if (*(int *)(unaff_EBP + -0x290) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EBX,
                *(int *)(unaff_EBP + -0x290));
  }
  if (*(int *)(unaff_EBP + -0x294) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EBX,
                *(int *)(unaff_EBP + -0x294));
  }
  return;
}



undefined4 __fastcall FUN_6b81e617(short *param_1,short **param_2,short **param_3,int param_4)

{
  short sVar1;
  int iVar2;
  uint uVar3;
  short *psVar4;
  
  while( true ) {
    sVar1 = *param_1;
    while ((sVar1 != 0 && ((sVar1 == 0x5c || (sVar1 == 0x2f))))) {
      param_1 = param_1 + 1;
      sVar1 = *param_1;
    }
    if (sVar1 == 0) break;
    psVar4 = param_1 + 1;
    sVar1 = *psVar4;
    while (((sVar1 != 0 && (sVar1 != 0x5c)) && (sVar1 != 0x2f))) {
      psVar4 = psVar4 + 1;
      sVar1 = *psVar4;
    }
    uVar3 = (int)psVar4 - (int)param_1 >> 1;
    if (param_4 == 0) {
      iVar2 = FUN_6b81e6d7(param_1,uVar3);
    }
    else {
      iVar2 = FUN_6b81647d(param_1,uVar3);
    }
    if (iVar2 == 0) {
      if ((param_2 != (short **)0x0) && (param_3 != (short **)0x0)) {
        *param_2 = param_1;
        *param_3 = psVar4;
      }
      return 1;
    }
    if (*psVar4 == 0) {
      return 0;
    }
    param_1 = psVar4 + 1;
  }
  return 0;
}



undefined4 __fastcall FUN_6b81e6d7(short *param_1,int param_2)

{
  bool bVar1;
  int iVar2;
  undefined4 uVar3;
  int iVar4;
  
  if (((param_2 == 0) || (0xc < param_2)) || (*param_1 == 0x2e)) {
LAB_6b81e711:
    uVar3 = 1;
  }
  else {
    bVar1 = false;
    iVar2 = 0;
    if (0 < param_2) {
      iVar4 = param_2 + -1;
      do {
        if (param_1[iVar2] == 0x2e) {
          if ((bVar1) || (3 < iVar4)) goto LAB_6b81e711;
          bVar1 = true;
        }
        if ((7 < iVar2) && (!bVar1)) goto LAB_6b81e711;
        iVar2 = iVar2 + 1;
        iVar4 = iVar4 + -1;
      } while (iVar2 < param_2);
    }
    uVar3 = 0;
  }
  return uVar3;
}



wchar_t * __fastcall FUN_6b81e728(wchar_t *param_1)

{
  wchar_t wVar1;
  int iVar2;
  wchar_t *_Str1;
  int iVar3;
  
  iVar2 = RtlDetermineDosPathNameType_U(param_1);
  if (iVar2 != 1) {
    if (iVar2 == 2) {
      return param_1 + 3;
    }
    if (iVar2 == 3) {
      return param_1 + 2;
    }
    if (iVar2 == 4) {
      return param_1 + 1;
    }
    if (iVar2 == 5) {
      return param_1;
    }
    if (iVar2 != 6) {
      return (wchar_t *)0x0;
    }
  }
  iVar3 = 2;
  _Str1 = param_1 + 2;
  iVar2 = _wcsnicmp(_Str1,L"?\\UNC",5);
  if (iVar2 == 0) {
    _Str1 = param_1 + 8;
  }
  do {
    wVar1 = *_Str1;
    if (wVar1 == L'\0') {
      return _Str1;
    }
    if ((wVar1 == L'\\') || (wVar1 == L'/')) {
      iVar3 = iVar3 + -1;
    }
    _Str1 = _Str1 + 1;
  } while (iVar3 != 0);
  return _Str1;
}



LCID GetUserDefaultLCID(void)

{
  LCID LVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b81e760. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1e760  792  GetUserDefaultLCID
  LVar1 = GetUserDefaultLCID();
  return LVar1;
}



PVOID FlsGetValue(DWORD dwFlsIndex)

{
  PVOID pvVar1;
  
                    // 0x1e770  418  FlsGetValue
                    // WARNING: Could not recover jumptable at 0x6b81e776. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = FlsGetValue(dwFlsIndex);
  return pvVar1;
}



BOOL GetOverlappedResult(HANDLE hFile,LPOVERLAPPED lpOverlapped,LPDWORD lpNumberOfBytesTransferred,
                        BOOL bWait)

{
  BOOL BVar1;
  
                    // 0x1e790  670  GetOverlappedResult
                    // WARNING: Could not recover jumptable at 0x6b81e796. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetOverlappedResult(hFile,lpOverlapped,lpNumberOfBytesTransferred,bWait);
  return BVar1;
}



HANDLE GetCurrentThread(void)

{
                    // 0x1e7b0  545  GetCurrentThread
  return (HANDLE)0xfffffffe;
}



undefined4 TermsrvOpenRegEntry(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  code *pcVar1;
  undefined4 uVar2;
  
                    // 0x1e7c0  1436  TermsrvOpenRegEntry
  pcVar1 = DAT_6b8b08dc;
  if (DAT_6b8b08dc == (code *)0x0) {
    uVar2 = 0;
  }
  else {
    _guard_check_icall();
    uVar2 = (*pcVar1)(param_1,param_2,param_3);
  }
  return uVar2;
}



LONG InterlockedIncrement(LONG *lpAddend)

{
  int iVar1;
  
                    // 0x1e7e0  883  InterlockedIncrement
  LOCK();
  iVar1 = *lpAddend;
  *lpAddend = *lpAddend + 1;
  return iVar1 + 1;
}



int lstrcmpiA(LPCSTR lpString1,LPCSTR lpString2)

{
  int iVar1;
  
                    // 0x1e800  1592  lstrcmpiA
  iVar1 = CompareStringA(0x400,0x40000001,lpString1,-1,lpString2,-1);
  if ((iVar1 != 0) ||
     (iVar1 = CompareStringA(0x800,0x40000001,lpString1,-1,lpString2,-1), iVar1 != 0)) {
    return iVar1 + -2;
  }
  if (lpString1 == (LPCSTR)0x0) {
    return -(uint)(lpString2 != (LPCSTR)0x0);
  }
  if (lpString2 != (LPCSTR)0x0) {
    iVar1 = _stricmp(lpString1,lpString2);
    return iVar1;
  }
  return 1;
}



HGLOBAL LoadResource(HMODULE hModule,HRSRC hResInfo)

{
  HGLOBAL pvVar1;
  
                    // 0x1e840  973  LoadResource
                    // WARNING: Could not recover jumptable at 0x6b81e846. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = LoadResource(hModule,hResInfo);
  return pvVar1;
}



LONG InterlockedDecrement(LONG *lpAddend)

{
  int iVar1;
  
                    // 0x1e860  879  InterlockedDecrement
  LOCK();
  iVar1 = *lpAddend;
  *lpAddend = *lpAddend + -1;
  return iVar1 + -1;
}



undefined4 * __thiscall SortGetHandle(undefined4 this,LPCWSTR param_2,uint *param_3,int param_4)

{
  undefined4 *puVar1;
  uint uVar2;
  
                    // 0x1e880  1416  SortGetHandle
  puVar1 = (undefined4 *)FUN_6b81e8fe((int *)&DAT_6b8b07e0,param_2,param_3,this,param_4);
  if (puVar1 == (undefined4 *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    *puVar1 = 2;
    uVar2 = DAT_6b8b0828;
    if (DAT_6b8b0828 < 0x60306) {
      uVar2 = 0x60305;
    }
    puVar1[0x32] = uVar2;
    puVar1[0x34] = FUN_6b817ba0;
    puVar1[0x35] = FUN_6b81ca20;
    puVar1[0x36] = FUN_6b815bf0;
    puVar1[0x33] = FUN_6b811740;
    puVar1[0x37] = FUN_6b8501f0;
    puVar1[0x38] = FUN_6b84e690;
  }
  return puVar1;
}



void __fastcall
FUN_6b81e8fe(int *param_1,LPCWSTR param_2,uint *param_3,undefined4 param_4,int param_5)

{
  int *piVar1;
  BOOL BVar2;
  int iVar3;
  void **ppvVar4;
  undefined4 *puVar5;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar6;
  undefined4 extraout_EDX_01;
  undefined8 uVar7;
  DWORD dwErrCode;
  undefined auStack44 [4];
  int *local_28;
  LPCWSTR local_24;
  void *local_20;
  void *pvStack28;
  void *pvStack24;
  void *pvStack20;
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)auStack44;
  local_28 = param_1;
  local_24 = param_2;
  if ((param_3 == (uint *)0x0) || (param_3[1] == 0)) {
LAB_6b81e9f0:
    dwErrCode = 0x57;
  }
  else {
    ppvVar4 = (void **)(param_3 + 4);
    if (*param_3 < 0x20) {
      ppvVar4 = &_Buf2_6b884770;
    }
    local_20 = *ppvVar4;
    pvStack28 = ppvVar4[1];
    pvStack24 = ppvVar4[2];
    pvStack20 = ppvVar4[3];
    if (((param_2 == (LPCWSTR)0x0) || (BVar2 = IsValidLocaleName(param_2), BVar2 == 0)) &&
       (iVar3 = memcmp(&local_20,&_Buf2_6b884770,0x10), iVar3 == 0)) goto LAB_6b81e9f0;
    piVar1 = local_28;
    if (param_5 == 0) {
      if (local_28[0xe] == 0) {
        uVar7 = FUN_6b81edbb(local_28);
        uVar6 = (undefined4)((ulonglong)uVar7 >> 0x20);
        if ((int)uVar7 == 0) goto LAB_6b81e9d6;
      }
      if (((piVar1[0x12] ^ param_3[1]) & 0xffffff00) == 0) {
        iVar3 = memcmp(&local_20,&_Buf2_6b884770,0x10);
        if (iVar3 == 0) {
          ppvVar4 = (void **)FUN_6b81eb61(local_24,extraout_EDX,&local_20);
        }
        else {
          ppvVar4 = &local_20;
        }
        piVar1 = local_28;
        puVar5 = (undefined4 *)FUN_6b81eb11((int)local_28,*ppvVar4,ppvVar4[1],ppvVar4[2],ppvVar4[3])
        ;
        if (puVar5 != (undefined4 *)0x0) {
          FUN_6b81e9fb(piVar1,puVar5);
          uVar6 = extraout_EDX_00;
          goto LAB_6b81e9d6;
        }
      }
      goto LAB_6b81e9f0;
    }
    dwErrCode = 0x3ec;
  }
  SetLastError(dwErrCode);
  uVar6 = extraout_EDX_01;
LAB_6b81e9d6:
  FUN_6b8224af(local_c ^ (uint)auStack44,uVar6);
  return;
}



undefined4 __fastcall FUN_6b81e9fb(int *param_1,undefined4 *param_2)

{
  int iVar1;
  undefined4 uVar2;
  int extraout_EDX;
  int extraout_EDX_00;
  undefined4 extraout_EDX_01;
  int in_FS_OFFSET;
  
  iVar1 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,0x124);
  if (iVar1 == 0) {
    uVar2 = 0;
  }
  else {
    *(undefined4 *)(iVar1 + 0xb8) = *param_2;
    *(undefined4 *)(iVar1 + 0xbc) = param_2[1];
    *(undefined4 *)(iVar1 + 0xc0) = param_2[2];
    *(undefined4 *)(iVar1 + 0xc4) = param_2[3];
    FUN_6b81ead3((int)param_1,iVar1,(int)param_2);
    FUN_6b81eaa5((int)param_1,extraout_EDX,(int)param_2);
    FUN_6b81ea57(param_1,extraout_EDX_00,(int)param_2);
    uVar2 = extraout_EDX_01;
  }
  return uVar2;
}



void __fastcall FUN_6b81ea57(int *param_1,int param_2,int param_3)

{
  int iVar1;
  
  iVar1 = *param_1;
  *(int *)(param_2 + 0xe4) = iVar1 + 4;
  *(uint *)(param_2 + 0xe8) = iVar1 + 4 + (uint)*(ushort *)(iVar1 + 2) * 2;
  iVar1 = *param_1 + *(int *)(param_3 + 0x20) * 2;
  *(int *)(param_2 + 0xec) = iVar1 + 4;
  *(uint *)(param_2 + 0xf0) = iVar1 + (*(ushort *)(iVar1 + 2) + 2) * 2;
  return;
}



void __fastcall FUN_6b81eaa5(int param_1,int param_2,int param_3)

{
  int iVar1;
  int *piVar2;
  ushort uVar3;
  ushort uVar4;
  int iVar5;
  
  *(undefined4 *)(param_2 + 0xfc) = *(undefined4 *)(param_3 + 0x10);
  if (*(int *)(param_3 + 0x14) == -1) {
    *(undefined4 *)(param_2 + 0x104) = 0;
  }
  else {
    piVar2 = (int *)(*(int *)(param_3 + 0x14) * 0x18 + *(int *)(param_1 + 0x2c));
    *(int **)(param_2 + 0x104) = piVar2;
    iVar1 = *(int *)(param_1 + 0x30);
    uVar4 = *(ushort *)(piVar2 + 2);
    if (uVar4 != 0) {
      *(int *)(param_2 + 0x108) = iVar1 + *piVar2 * 2;
      uVar4 = *(ushort *)(piVar2 + 2);
    }
    uVar3 = *(ushort *)((int)piVar2 + 10);
    if (uVar3 != 0) {
      *(uint *)(param_2 + 0x10c) = iVar1 + (*piVar2 + (uint)uVar4 * 4) * 2;
      uVar3 = *(ushort *)((int)piVar2 + 10);
    }
    iVar5 = (uint)uVar4 * 4 + (uint)uVar3 * 6;
    uVar4 = *(ushort *)(piVar2 + 3);
    if (uVar4 != 0) {
      *(int *)(param_2 + 0x110) = iVar1 + (*piVar2 + iVar5) * 2;
      uVar4 = *(ushort *)(piVar2 + 3);
    }
    iVar5 = iVar5 + (uint)uVar4 * 6;
    uVar4 = *(ushort *)((int)piVar2 + 0xe);
    if (uVar4 != 0) {
      *(int *)(param_2 + 0x114) = iVar1 + (*piVar2 + iVar5) * 2;
      uVar4 = *(ushort *)((int)piVar2 + 0xe);
    }
    iVar5 = iVar5 + (uint)uVar4 * 8;
    uVar4 = *(ushort *)(piVar2 + 4);
    if (uVar4 != 0) {
      *(int *)(param_2 + 0x118) = iVar1 + (*piVar2 + iVar5) * 2;
      uVar4 = *(ushort *)(piVar2 + 4);
    }
    iVar5 = iVar5 + (uint)uVar4 * 8;
    if (*(short *)((int)piVar2 + 0x12) != 0) {
      *(int *)(param_2 + 0x11c) = iVar1 + (*piVar2 + iVar5) * 2;
    }
    if (*(short *)(piVar2 + 5) != 0) {
      *(uint *)(param_2 + 0x120) =
           iVar1 + ((uint)*(ushort *)((int)piVar2 + 0x12) * 10 + *piVar2 + iVar5) * 2;
    }
  }
  return;
}



void __fastcall FUN_6b81ead3(int param_1,int param_2,int param_3)

{
  int iVar1;
  
  if (*(int *)(param_3 + 0x18) == 0) {
    iVar1 = 0;
  }
  else {
    iVar1 = *(int *)(param_1 + 0x20) + *(int *)(param_3 + 0x18) * 4;
  }
  *(int *)(param_2 + 0xf4) = iVar1;
  if (*(int *)(param_3 + 0x1c) != 0) {
    iVar1 = *(int *)(param_1 + 0x20) + *(int *)(param_3 + 0x1c) * 4;
  }
  *(int *)(param_2 + 0xf8) = iVar1;
  return;
}



void __thiscall
FUN_6b81eb11(int this,undefined4 param_2,undefined4 param_3,undefined4 param_4,undefined4 param_5)

{
  int iVar1;
  undefined4 extraout_EDX;
  undefined4 uVar2;
  undefined4 extraout_EDX_00;
  undefined4 local_1c;
  undefined4 uStack24;
  undefined4 uStack20;
  undefined4 uStack16;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_1c = param_2;
  uStack24 = param_3;
  uStack20 = param_4;
  uStack16 = param_5;
  iVar1 = memcmp(&local_1c,&_Buf2_6b884780,0x10);
  uVar2 = extraout_EDX;
  if (iVar1 != 0) {
    bsearch(&local_1c,*(void **)(this + 0x24),*(size_t *)(this + 4),0x24,_PtFuncCompare_6b83abe0);
    uVar2 = extraout_EDX_00;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



void __fastcall FUN_6b81eb61(short *param_1,undefined4 param_2,void **param_3)

{
  int iVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  short *psVar2;
  void **ppvVar3;
  undefined8 uVar4;
  undefined local_104 [8];
  undefined local_fc [8];
  short *local_f4;
  void *local_f0 [4];
  undefined local_e0 [12];
  undefined local_d4 [108];
  short local_68 [34];
  uint local_24;
  
  local_24 = DAT_6b8b0140 ^ (uint)&stack0xffffffe0;
  local_f4 = (short *)0x0;
  if ((param_1 != (short *)0x0) && (iVar1 = FUN_6b81ed46(), param_2 = extraout_EDX, iVar1 != 0)) {
    FUN_6b81ec6c(local_68,0x20,param_1,&local_f4,(uint *)0x0);
    param_2 = extraout_EDX_00;
    psVar2 = local_f4;
LAB_6b81ebc4:
    if (local_68 < psVar2) {
      RtlInitUnicodeString(local_fc,local_68);
      memset(local_e0,0,0x5a);
      uVar4 = NtQueryValueKey(DAT_6b8b08b8,local_fc,2,local_e0,0x5a,&local_f4);
      param_2 = (undefined4)((ulonglong)uVar4 >> 0x20);
      if ((int)uVar4 == 0) {
        RtlInitUnicodeString(local_104,local_d4);
        uVar4 = RtlGUIDFromString(local_104,local_f0);
        param_2 = (undefined4)((ulonglong)uVar4 >> 0x20);
        if (-1 < (int)uVar4) {
          ppvVar3 = local_f0;
          goto LAB_6b81ec44;
        }
      }
      psVar2 = psVar2 + -1;
      if (local_68 < psVar2) {
        do {
          if ((*psVar2 == 0x2d) || (*psVar2 == 0x5f)) {
            *psVar2 = 0;
            break;
          }
          psVar2 = psVar2 + -1;
        } while (local_68 < psVar2);
      }
      goto LAB_6b81ebc4;
    }
  }
  ppvVar3 = &_Buf2_6b884780;
LAB_6b81ec44:
  *param_3 = *ppvVar3;
  param_3[1] = ppvVar3[1];
  param_3[2] = ppvVar3[2];
  param_3[3] = ppvVar3[3];
  FUN_6b8224af(local_24 ^ (uint)&stack0xffffffe0,param_2);
  return;
}



int __fastcall
FUN_6b81ec6c(short *param_1,uint param_2,short *param_3,short **param_4,uint *param_5)

{
  int iVar1;
  int local_8;
  
  if ((param_2 == 0) || (iVar1 = 0, 0x7fffffff < param_2)) {
    iVar1 = -0x7ff8ffa9;
  }
  if (iVar1 < 0) {
    if (param_2 != 0) {
      *param_1 = 0;
    }
  }
  else {
    iVar1 = 0;
    if (param_2 == 0) {
      if (*param_3 != 0) {
        if (param_1 == (short *)0x0) {
          return -0x7ff8ffa9;
        }
        iVar1 = -0x7ff8ff86;
      }
    }
    else {
      local_8 = 0;
      iVar1 = FUN_6b81ece5(param_1,param_2,&local_8,(int)param_3);
      param_2 = param_2 - local_8;
      param_1 = param_1 + local_8;
      if ((iVar1 < 0) && (iVar1 != -0x7ff8ff86)) {
        return iVar1;
      }
    }
    if (param_4 != (short **)0x0) {
      *param_4 = param_1;
    }
    if (param_5 != (uint *)0x0) {
      *param_5 = param_2;
    }
  }
  return iVar1;
}



int __fastcall FUN_6b81ece5(short *param_1,int param_2,int *param_3,int param_4)

{
  short sVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  iVar2 = 0;
  if (param_2 != 0) {
    iVar4 = 0x7ffffffe;
    iVar3 = param_4 - (int)param_1;
    do {
      if ((iVar4 == 0) || (sVar1 = *(short *)(iVar3 + (int)param_1), sVar1 == 0)) break;
      *param_1 = sVar1;
      param_1 = param_1 + 1;
      iVar4 = iVar4 + -1;
      iVar2 = iVar2 + 1;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
    if (param_2 != 0) goto LAB_6b81ed1d;
  }
  param_1 = param_1 + -1;
  iVar2 = iVar2 + -1;
LAB_6b81ed1d:
  *param_1 = 0;
  if (param_3 != (int *)0x0) {
    *param_3 = iVar2;
  }
  return (-(uint)(param_2 != 0) & 0x7ff8ff86) + 0x8007007a;
}



undefined4 FUN_6b81ed46(void)

{
  int iVar1;
  undefined4 local_28;
  undefined4 local_24;
  undefined *local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined local_10 [8];
  int local_8;
  
  if (DAT_6b8b08b8 == 0) {
    RtlInitUnicodeString
              (local_10,
               L"\\Registry\\Machine\\System\\CurrentControlSet\\Control\\Nls\\Sorting\\Ids");
    local_20 = local_10;
    local_28 = 0x18;
    local_24 = 0;
    local_1c = 0x40;
    local_18 = 0;
    local_14 = 0;
    iVar1 = NtOpenKey(&local_8,0x20019,&local_28);
    if (iVar1 < 0) {
      SetLastError(0x3f1);
      return 0;
    }
    LOCK();
    iVar1 = DAT_6b8b08b8;
    if (DAT_6b8b08b8 == 0) {
      DAT_6b8b08b8 = local_8;
      iVar1 = 0;
    }
    if (iVar1 != 0) {
      NtClose(local_8);
    }
  }
  return 1;
}



void __fastcall FUN_6b81edbb(int *param_1)

{
  int *piVar1;
  bool bVar2;
  uint uVar3;
  undefined3 extraout_var;
  int iVar4;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 uVar5;
  undefined4 extraout_EDX_02;
  undefined8 uVar6;
  int *local_214;
  WCHAR local_210 [260];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_214 = (int *)0x0;
  memset(local_210,0,0x208);
  uVar3 = FUN_6b81f08b(local_210,0x104);
  uVar5 = extraout_EDX;
  if ((uVar3 != 0) && (uVar3 < 0x104)) {
    uVar6 = FUN_6b81eeab(local_210,0x104,(int)L"\\Globalization\\Sorting\\");
    uVar5 = (undefined4)((ulonglong)uVar6 >> 0x20);
    if (-1 < (int)uVar6) {
      uVar6 = FUN_6b81eeab(local_210,0x104,(int)L"sortdefault.nls");
      uVar5 = (undefined4)((ulonglong)uVar6 >> 0x20);
      if ((-1 < (int)uVar6) &&
         (bVar2 = FUN_6b81f019(local_210,&local_214), piVar1 = local_214, uVar5 = extraout_EDX_00,
         CONCAT31(extraout_var,bVar2) != 0)) {
        param_1[0x13] = (int)local_214;
        iVar4 = FUN_6b81ef40((int)param_1,(undefined4 *)(local_214[3] + (int)local_214));
        if (iVar4 == 0) {
          SetLastError(0x3eb);
          uVar5 = extraout_EDX_02;
        }
        else {
          param_1[8] = *piVar1 + (int)piVar1;
          *param_1 = piVar1[1] + (int)piVar1;
          iVar4 = piVar1[2];
          param_1[0xd] = (int)piVar1 + iVar4 + 4;
          param_1[0xe] = (int)piVar1 + *(ushort *)((int)piVar1 + iVar4 + 2) + 2 + iVar4;
          uVar5 = extraout_EDX_01;
        }
      }
    }
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar5);
  return;
}



void __fastcall FUN_6b81eeab(short *param_1,uint param_2,int param_3)

{
  int iVar1;
  undefined4 extraout_ECX;
  short *local_8;
  
  iVar1 = 0;
  if ((param_2 == 0) || (0x7fffffff < param_2)) {
    iVar1 = -0x7ff8ffa9;
  }
  if (-1 < iVar1) {
    local_8 = param_1;
    iVar1 = FUN_6b81eefb(param_1,param_2,(int *)&local_8);
    if (-1 < iVar1) {
      FUN_6b812c87(param_1 + (int)local_8,param_2 - (int)local_8,extraout_ECX,param_3);
    }
  }
  return;
}



int __fastcall FUN_6b81eefb(short *param_1,int param_2,int *param_3)

{
  int iVar1;
  
  iVar1 = param_2;
  if (param_2 != 0) {
    do {
      if (*param_1 == 0) break;
      param_1 = param_1 + 1;
      iVar1 = iVar1 + -1;
    } while (iVar1 != 0);
  }
  if (param_3 != (int *)0x0) {
    if (iVar1 == 0) {
      *param_3 = 0;
    }
    else {
      *param_3 = param_2 - iVar1;
    }
  }
  return (-(uint)(iVar1 != 0) & 0x7ff8ffa9) + 0x80070057;
}



undefined4 __fastcall FUN_6b81ef40(int param_1,undefined4 *param_2)

{
  int *piVar1;
  ushort *puVar2;
  int iVar3;
  uint uVar4;
  int *piVar5;
  int iVar6;
  
  *(undefined4 *)(param_1 + 0x48) = *param_2;
  iVar3 = param_2[1];
  if (iVar3 != 0) {
    *(int *)(param_1 + 4) = iVar3;
    *(undefined4 **)(param_1 + 0x24) = param_2 + 2;
  }
  iVar6 = param_2[iVar3 * 9 + 2];
  if (iVar6 != 0) {
    *(int *)(param_1 + 8) = iVar6;
    *(undefined4 **)(param_1 + 0x28) = param_2 + iVar3 * 9 + 3;
  }
  piVar1 = param_2 + iVar3 * 9 + iVar6 + 3;
  iVar3 = *piVar1;
  piVar5 = piVar1 + 1;
  if (iVar3 != 0) {
    iVar6 = iVar3 * 0x18;
    *(int *)(param_1 + 0xc) = iVar3;
    *(int **)(param_1 + 0x2c) = piVar5;
    *(int **)(param_1 + 0x30) = piVar1 + iVar3 * 6 + 1;
    piVar5 = (int *)((int)(piVar1 + iVar3 * 6 + 1) +
                    (((uint)*(ushort *)(iVar6 + -10 + (int)piVar1) +
                     (uint)*(ushort *)(piVar1 + iVar3 * 6 + -2)) * 6 +
                     ((uint)*(ushort *)(piVar5 + iVar3 * 6 + -4) +
                     ((uint)*(ushort *)(iVar6 + -10 + (int)piVar5) +
                     (uint)*(ushort *)(piVar5 + iVar3 * 6 + -2)) * 2) * 4 +
                     ((uint)*(ushort *)(iVar6 + -2 + (int)piVar1) +
                     (uint)*(ushort *)(piVar1 + iVar3 * 6)) * 10 + piVar1[iVar3 * 6 + -5]) * 2);
  }
  uVar4 = (uint)*(ushort *)piVar5;
  if (uVar4 != 0) {
    *(uint *)(param_1 + 0x14) = uVar4;
    *(int **)(param_1 + 0x3c) = piVar5 + 1;
  }
  puVar2 = (ushort *)((int)piVar5 + uVar4 * 2 + 4);
  uVar4 = (uint)*puVar2;
  if (uVar4 != 0) {
    *(uint *)(param_1 + 0x18) = uVar4;
    *(ushort **)(param_1 + 0x40) = puVar2 + 2;
  }
  if (puVar2[uVar4 * 4 + 2] != 0) {
    *(uint *)(param_1 + 0x1c) = (uint)puVar2[uVar4 * 4 + 2];
    *(ushort **)(param_1 + 0x44) = puVar2 + (uVar4 + 1) * 4;
  }
  return 1;
}



bool __fastcall FUN_6b81f019(LPCWSTR param_1,LPVOID *param_2)

{
  HANDLE hFile;
  HANDLE hFileMappingObject;
  LPVOID pvVar1;
  bool bVar2;
  
  hFile = CreateFileW(param_1,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0x0);
  if (hFile == (HANDLE)0xffffffff) {
    bVar2 = false;
  }
  else {
    hFileMappingObject = CreateFileMappingW(hFile,(LPSECURITY_ATTRIBUTES)0x0,2,0,0,(LPCWSTR)0x0);
    if (hFileMappingObject == (HANDLE)0x0) {
      CloseHandle(hFile);
      bVar2 = false;
    }
    else {
      pvVar1 = MapViewOfFile(hFileMappingObject,4,0,0,0);
      bVar2 = pvVar1 != (LPVOID)0x0;
      if (bVar2) {
        *param_2 = pvVar1;
      }
      CloseHandle(hFileMappingObject);
      CloseHandle(hFile);
    }
  }
  return bVar2;
}



uint __fastcall FUN_6b81f08b(void *param_1,int param_2)

{
  ushort uVar1;
  int iVar2;
  uint uVar3;
  
  iVar2 = KernelBaseGetGlobalData();
  uVar1 = *(ushort *)(iVar2 + 8);
  uVar3 = (uint)(uVar1 >> 1);
  if ((uint)(param_2 * 2) < uVar1 + 2) {
    uVar3 = uVar3 + 1;
  }
  else {
    iVar2 = KernelBaseGetGlobalData();
    memcpy(param_1,*(void **)(iVar2 + 0xc),(uint)uVar1);
    *(undefined2 *)((int)param_1 + uVar3 * 2) = 0;
  }
  return uVar3;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int FUN_6b81f0e0(HMODULE param_1,LPCWSTR param_2,HANDLE *param_3)

{
  HANDLE pvVar1;
  int iVar2;
  LPCWSTR *ppWVar3;
  int in_FS_OFFSET;
  ACTCTXW local_28;
  undefined4 local_8;
  
  local_28.cbSize = 0x20;
  local_8 = 0;
  ppWVar3 = (LPCWSTR *)&local_28.dwFlags;
  for (iVar2 = 7; iVar2 != 0; iVar2 = iVar2 + -1) {
    *ppWVar3 = (LPCWSTR)0x0;
    ppWVar3 = ppWVar3 + 1;
  }
  if (param_3 == (HANDLE *)0x0) {
    iVar2 = -0x3ffffff3;
  }
  else {
    *param_3 = (HANDLE)0x0;
    InitOnceExecuteOnce(&InitOnce_6b8b0878,InitFn_6b820f80,(PVOID)0x0,(LPVOID *)0x0);
    if ((_DAT_6b8b0834 == 0x50000) &&
       (((*(byte *)(*(int *)(in_FS_OFFSET + 0x30) + 3) & 2) == 0 ||
        ((*(byte *)(*(int *)(in_FS_OFFSET + 0x30) + 3) & 0x40) != 0)))) {
      iVar2 = LdrResFindResourceDirectory(param_1,0x18,2,&local_8,0,0,0x10);
      if (-1 < iVar2) {
        local_28.lpSource = param_2;
        local_28.dwFlags = 0x88;
        local_28.lpResourceName = (LPCWSTR)0x2;
        local_28.hModule = param_1;
        pvVar1 = CreateActCtxW(&local_28);
        if (pvVar1 == (HANDLE)0xffffffff) {
          iVar2 = *(int *)(*(int *)(in_FS_OFFSET + 0x18) + 0xbf4);
        }
        else {
          *param_3 = pvVar1;
          iVar2 = 0;
        }
      }
    }
    else {
      iVar2 = -0x3fffff45;
    }
  }
  return iVar2;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

HGLOBAL GlobalReAlloc(HGLOBAL hMem,SIZE_T dwBytes,UINT uFlags)

{
  ushort *puVar1;
  char cVar2;
  int *piVar3;
  int iVar4;
  void *_Dst;
  ushort uVar5;
  undefined4 *puVar6;
  uint uVar7;
  undefined4 *in_FS_OFFSET;
  HGLOBAL local_34;
  uint local_30;
  undefined4 *local_2c;
  uint local_28;
  ushort *local_24;
  ushort *local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x1f1a0  833  GlobalReAlloc
  local_8 = &DAT_6b891cb8;
  uStack12 = 0x6b81f1ac;
  local_2c = (undefined4 *)hMem;
  if ((uFlags & 0xffff800d) == 0) {
    local_30 = uFlags & 0x100;
    if ((local_30 == 0) || ((char)uFlags < '\0')) {
      uVar7 = uFlags >> 3 & 8;
      local_24 = (ushort *)(uFlags & 2);
      if (local_24 == (ushort *)0x0) {
        uVar7 = uVar7 | 0x10;
      }
      RtlLockHeap(DAT_6b8b0734);
      local_8 = (undefined *)0x1;
      if (((uint)hMem & 4) == 0) {
        if ((uFlags & 0x80) == 0) {
          piVar3 = (int *)KernelBaseGetGlobalData();
          hMem = (HGLOBAL)RtlReAllocateHeap(DAT_6b8b0734,*piVar3 + 0x100000U | uVar7 | 1,hMem,
                                            dwBytes);
          if ((undefined4 *)hMem == (undefined4 *)0x0) {
LAB_6b82ecca:
            RtlSetLastWin32Error(8);
          }
        }
        else if (local_24 != (ushort *)0x0) {
          local_34 = hMem;
          cVar2 = RtlGetUserInfoHeap(DAT_6b8b0734,1,hMem,&local_34,0);
          if (cVar2 != '\0') {
            local_24 = (ushort *)RtlAllocateHandle(DAT_6b8b072c,0);
            if (local_24 != (ushort *)0x0) {
              local_2c = (undefined4 *)RtlSizeHeap(DAT_6b8b0734,1,hMem);
              local_28 = uVar7 | 0x301;
              piVar3 = (int *)KernelBaseGetGlobalData();
              _Dst = (void *)RtlAllocateHeap(DAT_6b8b0734,*piVar3 + 0x100000U | uVar7 | 0x301,
                                             local_2c);
              puVar1 = local_24;
              *(void **)(local_24 + 2) = _Dst;
              if (_Dst != (void *)0x0) {
                memmove(_Dst,hMem,(size_t)local_2c);
                RtlFreeHeap(DAT_6b8b0734,1,hMem);
                hMem = puVar1 + 2;
                puVar1[1] = 0;
                uVar5 = 3;
                *puVar1 = 3;
                if (local_30 != 0) {
                  uVar5 = 7;
                  *puVar1 = 7;
                }
                if (((uint)local_34 & 0x2000) != 0) {
                  *puVar1 = uVar5 | 0x8000;
                }
                RtlSetUserValueHeap(DAT_6b8b0734,1,*(undefined4 *)(puVar1 + 2),hMem);
                goto LAB_6b81f291;
              }
              *local_24 = 1;
              RtlFreeHandle(DAT_6b8b072c,local_24);
            }
LAB_6b82eb9c:
            hMem = (undefined4 *)0x0;
            goto LAB_6b82ecca;
          }
        }
      }
      else {
        local_20 = (ushort *)((int)hMem + -4);
        cVar2 = RtlIsValidHandle(DAT_6b8b072c,local_20);
        if (cVar2 == '\0') {
          RtlSetLastWin32Error(6);
          hMem = (undefined4 *)0x0;
        }
        else if ((uFlags & 0x80) == 0) {
                    // WARNING: Load size is inaccurate
          local_30 = *hMem;
          if (dwBytes == 0) {
            puVar6 = (undefined4 *)0x0;
            hMem = local_2c;
            if ((((local_30 != 0) && (hMem = puVar6, local_24 != (ushort *)0x0)) &&
                (local_20[1] == 0)) &&
               (iVar4 = RtlFreeHeap(DAT_6b8b0734,uVar7 | 1,local_30), iVar4 != 0)) {
              *local_2c = 0;
              *local_20 = *local_20 | 8;
              hMem = local_2c;
            }
          }
          else {
            if (local_30 == 0) {
              local_28 = uVar7 | 0x301;
              piVar3 = (int *)KernelBaseGetGlobalData();
              iVar4 = RtlAllocateHeap(DAT_6b8b0734,*piVar3 + 0x100000U | uVar7 | 0x301,dwBytes);
              if (iVar4 == 0) goto LAB_6b82eb9c;
              RtlSetUserValueHeap(DAT_6b8b0734,1,iVar4,hMem);
            }
            else {
              if ((local_24 == (ushort *)0x0) && (local_20[1] != 0)) {
                uVar7 = uVar7 | 0x311;
              }
              else {
                uVar7 = uVar7 & 0xffffffef | 0x301;
              }
              local_28 = uVar7;
              piVar3 = (int *)KernelBaseGetGlobalData();
              iVar4 = RtlReAllocateHeap(DAT_6b8b0734,*piVar3 + 0x100000U | uVar7,local_30,dwBytes);
            }
            if (iVar4 == 0) goto LAB_6b82eb9c;
            *(int *)hMem = iVar4;
            *local_20 = *local_20 & 0xfff7;
          }
        }
        else {
          if (local_30 == 0) {
            uVar5 = *local_20 & 0xfffb;
          }
          else {
            uVar5 = *local_20 | 4;
          }
          *local_20 = uVar5;
        }
      }
LAB_6b81f291:
      local_8 = (undefined *)0xfffffffe;
      FUN_6b81f30c();
      goto LAB_6b81f2a2;
    }
  }
  RtlSetLastWin32Error(0x57);
  hMem = (undefined4 *)0x0;
LAB_6b81f2a2:
  *in_FS_OFFSET = local_14;
  return hMem;
}



void FUN_6b81f30c(void)

{
  RtlUnlockHeap(DAT_6b8b0734);
  return;
}



BOOL GetProcessTimes(HANDLE hProcess,LPFILETIME lpCreationTime,LPFILETIME lpExitTime,
                    LPFILETIME lpKernelTime,LPFILETIME lpUserTime)

{
  BOOL BVar1;
  
                    // 0x1f320  708  GetProcessTimes
                    // WARNING: Could not recover jumptable at 0x6b81f326. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetProcessTimes(hProcess,lpCreationTime,lpExitTime,lpKernelTime,lpUserTime);
  return BVar1;
}



LPVOID LockResource(HGLOBAL hResData)

{
  LPVOID pvVar1;
  
                    // 0x1f340  993  LockResource
                    // WARNING: Could not recover jumptable at 0x6b81f346. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = LockResource(hResData);
  return pvVar1;
}



int lstrcmpiW(LPCWSTR lpString1,LPCWSTR lpString2)

{
  int iVar1;
  
                    // 0x1f360  1593  lstrcmpiW
                    // WARNING: Could not recover jumptable at 0x6b81f366. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = lstrcmpiW(lpString1,lpString2);
  return iVar1;
}



HANDLE GetProcessHeap(void)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b81f380. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1f380  698  GetProcessHeap
  pvVar1 = GetProcessHeap();
  return pvVar1;
}



void GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)

{
                    // WARNING: Could not recover jumptable at 0x6b81f390. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1f390  751  GetSystemTimeAsFileTime
  GetSystemTimeAsFileTime(lpSystemTimeAsFileTime);
  return;
}



HMODULE LoadLibraryExW(LPCWSTR lpLibFileName,HANDLE hFile,DWORD dwFlags)

{
  HMODULE pHVar1;
  
                    // 0x1f3a0  969  LoadLibraryExW
                    // WARNING: Could not recover jumptable at 0x6b81f3a6. Too many branches
                    // WARNING: Treating indirect jump as call
  pHVar1 = LoadLibraryExW(lpLibFileName,hFile,dwFlags);
  return pHVar1;
}



LPVOID VirtualAlloc(LPVOID lpAddress,SIZE_T dwSize,DWORD flAllocationType,DWORD flProtect)

{
  LPVOID pvVar1;
  
                    // 0x1f3c0  1484  VirtualAlloc
                    // WARNING: Could not recover jumptable at 0x6b81f3c6. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = VirtualAlloc(lpAddress,dwSize,flAllocationType,flProtect);
  return pvVar1;
}



BOOL MoveFileA(LPCSTR lpExistingFileName,LPCSTR lpNewFileName)

{
  BOOL BVar1;
  
                    // 0x1f3e0  1004  MoveFileA
  BVar1 = FUN_6b81f3fb(lpExistingFileName,(int)lpNewFileName,0,0,2,0);
  return BVar1;
}



undefined4 __fastcall
FUN_6b81f3fb(undefined4 param_1,int param_2,undefined4 param_3,undefined4 param_4,undefined4 param_5
            ,undefined4 param_6)

{
  int iVar1;
  undefined4 uVar2;
  undefined local_14 [4];
  undefined4 local_10;
  undefined local_c [4];
  undefined4 local_8;
  
  iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,param_1);
  if (iVar1 == 0) {
LAB_6b82ed18:
    uVar2 = 0;
  }
  else {
    if (param_2 == 0) {
      local_10 = 0;
    }
    else {
      iVar1 = Basep8BitStringToDynamicUnicodeString(local_14,param_2);
      if (iVar1 == 0) {
        RtlFreeUnicodeString(local_c);
        goto LAB_6b82ed18;
      }
    }
    uVar2 = MoveFileWithProgressTransactedW(local_8,local_10,param_3,param_4,param_5,param_6);
    RtlFreeUnicodeString(local_c);
    RtlFreeUnicodeString(local_14);
  }
  return uVar2;
}



undefined4 Basep8BitStringToDynamicUnicodeString(undefined4 param_1,undefined4 param_2)

{
  int iVar1;
  code *pcVar2;
  undefined local_c [8];
  
                    // 0x1f470  77  Basep8BitStringToDynamicUnicodeString
  iVar1 = RtlInitAnsiStringEx(local_c,param_2);
  if (-1 < iVar1) {
    pcVar2 = (code *)GetEightBitStringToUnicodeStringRoutine(param_1,local_c,1);
    _guard_check_icall();
    iVar1 = (*pcVar2)();
    if (-1 < iVar1) {
      return 1;
    }
    if (iVar1 != -0x7ffffffb) {
      BaseSetLastNTError(iVar1);
      return 0;
    }
  }
  RtlSetLastWin32Error(0xce);
  return 0;
}



BOOL VirtualFree(LPVOID lpAddress,SIZE_T dwSize,DWORD dwFreeType)

{
  BOOL BVar1;
  
                    // 0x1f4c0  1487  VirtualFree
                    // WARNING: Could not recover jumptable at 0x6b81f4c6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = VirtualFree(lpAddress,dwSize,dwFreeType);
  return BVar1;
}



int lstrcmp(LPCSTR lpString1,LPCSTR lpString2)

{
  uint uVar1;
  
                    // 0x1f4e0  1588  lstrcmp
                    // 0x1f4e0  1589  lstrcmpA
  uVar1 = FUN_6b81f4f4((byte *)lpString1,(byte *)lpString2);
  return uVar1;
}



uint __fastcall FUN_6b81f4f4(byte *param_1,byte *param_2)

{
  byte bVar1;
  int iVar2;
  bool bVar3;
  
  iVar2 = CompareStringA(0x400,0x40000000,(PCNZCH)param_1,-1,(PCNZCH)param_2,-1);
  if ((iVar2 != 0) ||
     (iVar2 = CompareStringA(0x800,0x40000000,(PCNZCH)param_1,-1,(PCNZCH)param_2,-1), iVar2 != 0)) {
    return iVar2 - 2;
  }
  if (param_1 == (byte *)0x0) {
    return -(uint)(param_2 != (byte *)0x0);
  }
  if (param_2 == (byte *)0x0) {
    return 1;
  }
  while( true ) {
    bVar1 = *param_1;
    bVar3 = bVar1 < *param_2;
    if (bVar1 != *param_2) break;
    if (bVar1 == 0) {
      return 0;
    }
    bVar1 = param_1[1];
    bVar3 = bVar1 < param_2[1];
    if (bVar1 != param_2[1]) break;
    param_1 = param_1 + 2;
    param_2 = param_2 + 2;
    if (bVar1 == 0) {
      return 0;
    }
  }
  return -(uint)bVar3 | 1;
}



HLOCAL LocalFree(HLOCAL hMem)

{
  HLOCAL pvVar1;
  
                    // 0x1f530  981  LocalFree
                    // WARNING: Could not recover jumptable at 0x6b81f536. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = LocalFree(hMem);
  return pvVar1;
}



FARPROC GetProcAddress(HMODULE hModule,LPCSTR lpProcName)

{
  FARPROC pFVar1;
  undefined4 unaff_retaddr;
  
                    // 0x1f550  692  GetProcAddress
  pFVar1 = (FARPROC)GetProcAddressForCaller(hModule,lpProcName,unaff_retaddr);
  return pFVar1;
}



SIZE_T VirtualQuery(LPCVOID lpAddress,PMEMORY_BASIC_INFORMATION lpBuffer,SIZE_T dwLength)

{
  SIZE_T SVar1;
  
                    // 0x1f570  1492  VirtualQuery
                    // WARNING: Could not recover jumptable at 0x6b81f576. Too many branches
                    // WARNING: Treating indirect jump as call
  SVar1 = VirtualQuery(lpAddress,lpBuffer,dwLength);
  return SVar1;
}



LPVOID MapViewOfFile(HANDLE hFileMappingObject,DWORD dwDesiredAccess,DWORD dwFileOffsetHigh,
                    DWORD dwFileOffsetLow,SIZE_T dwNumberOfBytesToMap)

{
  LPVOID pvVar1;
  
                    // 0x1f590  996  MapViewOfFile
                    // WARNING: Could not recover jumptable at 0x6b81f596. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = MapViewOfFile(hFileMappingObject,dwDesiredAccess,dwFileOffsetHigh,dwFileOffsetLow,
                         dwNumberOfBytesToMap);
  return pvVar1;
}



HANDLE OpenThread(DWORD dwDesiredAccess,BOOL bInheritHandle,DWORD dwThreadId)

{
  HANDLE pvVar1;
  
                    // 0x1f5b0  1048  OpenThread
                    // WARNING: Could not recover jumptable at 0x6b81f5b6. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = OpenThread(dwDesiredAccess,bInheritHandle,dwThreadId);
  return pvVar1;
}



BOOL DeviceIoControl(HANDLE hDevice,DWORD dwIoControlCode,LPVOID lpInBuffer,DWORD nInBufferSize,
                    LPVOID lpOutBuffer,DWORD nOutBufferSize,LPDWORD lpBytesReturned,
                    LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  int iVar2;
  int in_FS_OFFSET;
  int local_8;
  
                    // 0x1f5d0  291  DeviceIoControl
  if ((((dwIoControlCode == 0x2d4808) || (dwIoControlCode == 0x74808)) ||
      (dwIoControlCode == 0x90020)) &&
     (iVar2 = RtlGetActiveConsoleId(), *(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x1d4) != iVar2)) {
    iVar2 = FUN_6b818fbc(&local_8);
    if (-1 < iVar2) {
      if ((local_8 == 0) || (iVar2 = FUN_6b85e698(), iVar2 != 0)) goto LAB_6b81f5fd;
      iVar2 = -0x3fffffde;
    }
    BaseSetLastNTError(iVar2);
    BVar1 = 0;
  }
  else {
LAB_6b81f5fd:
    BVar1 = DeviceIoControl(hDevice,dwIoControlCode,lpInBuffer,nInBufferSize,lpOutBuffer,
                            nOutBufferSize,lpBytesReturned,lpOverlapped);
  }
  return BVar1;
}



BOOL FindActCtxSectionGuid
               (DWORD dwFlags,GUID *lpExtensionGuid,ULONG ulSectionId,GUID *lpGuidToFind,
               PACTCTX_SECTION_KEYED_DATA ReturnedData)

{
  BOOL BVar1;
  
                    // 0x1f630  372  FindActCtxSectionGuid
                    // WARNING: Could not recover jumptable at 0x6b81f636. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = FindActCtxSectionGuid(dwFlags,lpExtensionGuid,ulSectionId,lpGuidToFind,ReturnedData);
  return BVar1;
}



void entry(undefined4 param_1,int param_2)

{
  if (param_2 == 1) {
    __DllMainCRTStartupForGS2_12(param_1,1);
  }
  FUN_6b81f668(param_1,param_2);
  return;
}



// WARNING: Could not reconcile some variable overlaps
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __fastcall FUN_6b81f668(undefined4 param_1,int param_2)

{
  short sVar1;
  wchar_t wVar2;
  code *pcVar3;
  uint uVar4;
  int iVar5;
  undefined4 extraout_ECX;
  wchar_t *pwVar6;
  undefined4 extraout_EDX;
  undefined4 uVar7;
  int iVar8;
  undefined4 extraout_EDX_00;
  int iVar9;
  int in_FS_OFFSET;
  undefined8 uVar10;
  DWORD local_21c;
  uint local_218;
  uint local_214;
  code *local_210;
  char local_209;
  wchar_t local_208 [256];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  iVar5 = *(int *)(in_FS_OFFSET + 0x30);
  local_210 = *(code **)(iVar5 + 0x10);
  local_218 = local_218 & 0xffffff00;
  if (param_2 == 0) {
    local_210 = LoadLibraryExW;
  }
  else if (param_2 == 1) {
    uVar10 = RtlImageNtHeader(*(undefined4 *)(iVar5 + 8));
    uVar7 = (undefined4)((ulonglong)uVar10 >> 0x20);
    iVar8 = (int)uVar10;
    if (iVar8 == 0) goto LAB_6b81f864;
    RtlSetThreadPoolStartFunc(FUN_6b851e80,FUN_6b851f20);
    LdrSetDllManifestProber(FUN_6b81f0e0,FUN_6b83a680,ReleaseActCtx_exref);
    local_218 = 1;
    FUN_6b81fadb();
    sVar1 = *(short *)(iVar8 + 0x5c);
    if ((((sVar1 != 3) && (sVar1 != 2)) && (sVar1 != 1)) || (*(ushort *)(iVar8 + 0x48) < 6)) {
      RtlSetProtectedPolicy(&DAT_6b8848b0,1,0);
      RtlSetUserCallbackExceptionFilter(CheckForReadOnlyResourceFilter);
    }
    if (*(int *)(iVar5 + 0x1d4) == 0) {
      pwVar6 = local_208;
      iVar8 = 0x100;
      iVar9 = (int)L"\\Windows" - (int)pwVar6;
      do {
        if ((iVar8 == -0x7ffffefe) || (wVar2 = *(wchar_t *)(iVar9 + (int)pwVar6), wVar2 == L'\0'))
        break;
        *pwVar6 = wVar2;
        pwVar6 = pwVar6 + 1;
        iVar8 = iVar8 + -1;
      } while (iVar8 != 0);
      if (iVar8 == 0) {
        pwVar6 = pwVar6 + -1;
      }
      *pwVar6 = L'\0';
    }
    else {
      FUN_6b81fb19(local_208,0x200,L"%ws\\%ld%ws");
    }
    DAT_6b8b083c = *(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x4c) +
                   (*(int *)(*(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x54) + 8) -
                   *(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x248));
    _DAT_6b8b0838 = DAT_6b8b083c + 0x3a;
    if ((_DAT_6b8b0838 != 0) && (*(int *)(iVar5 + 500) == 0)) {
      RtlInitUnicodeString(iVar5 + 0x1f0,_DAT_6b8b0838);
    }
    pcVar3 = local_210;
    _DAT_6b8b0848 = *(undefined2 *)(DAT_6b8b083c + 0x7f8);
    _DAT_6b8b084a = *(undefined2 *)(DAT_6b8b083c + 0x7fa);
    if ((*(uint *)(DAT_6b8b083c + 0x800) | *(uint *)(DAT_6b8b083c + 0x804)) == 0) {
      _DAT_6b8b084c = 0;
    }
    else {
      _DAT_6b8b084c =
           (*(int *)(DAT_6b8b083c + 0x800) - *(int *)(DAT_6b8b083c + 0x9e8)) + DAT_6b8b083c;
    }
    if (((*(uint *)(local_210 + 8) & 0x4000) == 0) &&
       (iVar5 = LdrQueryImageFileExecutionOptions
                          (local_210 + 0x38,L"SearchPathMode",4,&local_21c,4,0), -1 < iVar5)) {
      SetSearchPathMode(local_21c);
    }
    if (*(int *)(pcVar3 + 0xc) != 0) {
      pcVar3 = (code *)swi(3);
      (*pcVar3)();
      return;
    }
    _DAT_6b8b0844 = &DAT_6b8b0840;
    DAT_6b8b0840 = &DAT_6b8b0840;
    uVar4 = RtlGetSuiteMask();
    if ((uVar4 & 0x10) != 0) {
      local_214 = 0;
      local_209 = '\0';
      uVar4 = FUN_6b81fa90(&local_209,&local_214);
      if (((char)uVar4 != '\0') && (local_209 != '\0')) {
        GetRegistryExtensionFlags(local_214);
      }
    }
    LdrDisableThreadCalloutsForDll(param_1);
    param_1 = extraout_ECX;
  }
  uVar4 = FUN_6b81f91d(param_1,param_2);
  uVar7 = extraout_EDX;
  if (((char)uVar4 == '\0') && ((char)local_218 != '\0')) {
    LdrSetDllManifestProber(0,0,0);
    uVar7 = extraout_EDX_00;
  }
LAB_6b81f864:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar7);
  return;
}



uint __fastcall FUN_6b81f91d(undefined4 param_1,int param_2)

{
  uint in_EAX;
  int iVar1;
  uint uVar2;
  int in_FS_OFFSET;
  
  uVar2 = 0;
  if (param_2 == 0) {
    in_EAX = KernelBaseGetGlobalData();
    if (*(int *)(in_EAX + 0x18) != 0) {
      in_EAX = WritePrivateProfileStringW((LPCWSTR)0x0,(LPCWSTR)0x0,(LPCWSTR)0x0,(LPCWSTR)0x0);
    }
  }
  else if (param_2 == 1) {
    iVar1 = KernelBaseGetGlobalData();
    *(undefined4 *)(iVar1 + 0x18) = 0;
    DAT_6b8b083c = (*(int *)(*(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x54) + 8) -
                   *(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x248)) +
                   *(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x4c);
    FUN_6b81f9ca();
    in_EAX = FUN_6b81f99b();
    if ((int)in_EAX < 0) goto LAB_6b81f97f;
    in_EAX = NtQuerySystemInformation(0,&DAT_6b8b0700,0x2c,0);
    if ((int)in_EAX < 0) goto LAB_6b81f97f;
  }
  uVar2 = 1;
LAB_6b81f97f:
  return in_EAX & 0xffffff00 | uVar2;
}



undefined4 FUN_6b81f99b(void)

{
  if ((*(uint *)(DAT_6b8b083c + 0x170) | *(uint *)(DAT_6b8b083c + 0x174)) == 0) {
    DAT_6b8b07cc = 0;
  }
  else {
    DAT_6b8b07cc = (DAT_6b8b083c - *(int *)(DAT_6b8b083c + 0x9e8)) + *(uint *)(DAT_6b8b083c + 0x170)
    ;
  }
  return 0;
}



void FUN_6b81f9ca(void)

{
  int iVar1;
  
  iVar1 = KernelBaseGetGlobalData();
  if (DAT_6b8b0730 != 0) {
    DAT_6b8b072c = *(undefined4 *)(iVar1 + 0x28);
    DAT_6b8b0734 = *(undefined4 *)(iVar1 + 0x24);
    return;
  }
  DAT_6b8b072c = *(undefined4 *)(iVar1 + 0x28);
  DAT_6b8b0730 = *(undefined4 *)(iVar1 + 0x2c);
  DAT_6b8b0734 = *(undefined4 *)(iVar1 + 0x24);
  return;
}



int __fastcall BaseThreadInitThunk(int param_1,undefined *param_2,undefined4 param_3)

{
  undefined4 uVar1;
  uint uVar2;
  int iVar3;
  
                    // 0x1fa10  1  BaseThreadInitThunk
  if (param_1 == 0) {
    _guard_check_icall();
    uVar1 = (*(code *)param_2)(param_3);
    RtlExitUserThread(uVar1);
  }
  uVar2 = RtlGetSuiteMask();
  if (((uVar2 & 0x10) != 0) && (iVar3 = FUN_6b81fa4a(), iVar3 < 0)) {
    return iVar3;
  }
  return 0;
}



int FUN_6b81fa4a(void)

{
  undefined4 *puVar1;
  int iVar2;
  HMODULE hModule;
  FARPROC pFVar3;
  int iVar4;
  int in_FS_OFFSET;
  int local_8;
  
  DAT_6b8b0868 = FUN_6b810b60;
  iVar2 = FUN_6b81faba();
  if ((iVar2 == 0) && (iVar2 = FUN_6b810bf2(), iVar2 == 0)) {
    iVar2 = FUN_6b818fbc(&local_8);
    if ((-1 < iVar2) && (iVar2 = 0, local_8 != 0)) {
      hModule = LoadLibraryExW(L"tsappcmp.dll",(HANDLE)0x0,0x800);
      if (hModule == (HMODULE)0x0) {
        iVar2 = *(int *)(*(int *)(in_FS_OFFSET + 0x18) + 0xbf4);
      }
      else {
        iVar4 = 0;
        do {
          pFVar3 = GetProcAddress(hModule,*(LPCSTR *)((int)&lpProcName_6b8807c0 + iVar4));
          puVar1 = (undefined4 *)((int)&PTR_DAT_6b8807c4 + iVar4);
          iVar4 = iVar4 + 8;
          *(FARPROC *)*puVar1 = pFVar3;
        } while (iVar4 != 0x60);
      }
    }
  }
  else {
    iVar2 = 0;
  }
  return iVar2;
}



uint __fastcall FUN_6b81fa90(undefined *param_1,uint *param_2)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  HMODULE hModule;
  bool bVar4;
  
  uVar1 = FUN_6b81faba();
  if ((uVar1 == 0) && (uVar1 = FUN_6b81862c(param_1), uVar1 != 0)) {
    uVar2 = FUN_6b85e474();
    *param_2 = uVar2;
    iVar3 = FUN_6b810bf2();
    if (iVar3 == 0) {
      uVar1 = 0x108;
      if ((uVar2 & 0x108) != 0x108) goto LAB_6b82eefd;
    }
    else {
      uVar1 = 0x2008;
      if ((uVar2 & 0x2008) == 0x2008) {
LAB_6b82eefd:
        hModule = LoadLibraryExW(L"tsappcmp.dll",(HANDLE)0x0,0x800);
        bVar4 = hModule != (HMODULE)0x0;
        if (bVar4) {
          DAT_6b8b08d8 = GetProcAddress(hModule,"TermsrvCreateRegEntry");
          DAT_6b8b08dc = GetProcAddress(hModule,"TermsrvOpenRegEntry");
          DAT_6b8b08e0 = GetProcAddress(hModule,"TermsrvSetValueKey");
          DAT_6b8b08e4 = GetProcAddress(hModule,"TermsrvDeleteKey");
          DAT_6b8b08e8 = GetProcAddress(hModule,"TermsrvDeleteValue");
          DAT_6b8b08ec = GetProcAddress(hModule,"TermsrvRestoreKey");
          DAT_6b8b08f0 = GetProcAddress(hModule,"TermsrvSetKeySecurity");
          DAT_6b8b08f4 = GetProcAddress(hModule,"TermsrvOpenUserClasses");
          hModule = (HMODULE)GetProcAddress(hModule,"TermsrvGetPreSetValue");
          DAT_6b8b08f8 = hModule;
        }
        return (uint)hModule & 0xffffff00 | (uint)bVar4;
      }
    }
  }
  return uVar1 & 0xffffff00;
}



undefined4 FUN_6b81faba(void)

{
  int iVar1;
  int in_FS_OFFSET;
  
  iVar1 = RtlImageNtHeader(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 8));
  if ((iVar1 != 0) && (*(short *)(iVar1 + 0x5e) < 0)) {
    return 1;
  }
  return 0;
}



void FUN_6b81fadb(void)

{
  int iVar1;
  
  iVar1 = KernelBaseGetGlobalData();
  if (DAT_6b8b0730 == 0) {
    DAT_6b8b0730 = *(int *)(iVar1 + 0x2c);
  }
  DAT_6b8b072c = *(undefined4 *)(iVar1 + 0x28);
  DAT_6b8b0734 = *(undefined4 *)(iVar1 + 0x24);
  return;
}



int __cdecl FUN_6b81fb19(wchar_t *param_1,uint param_2,wchar_t *param_3)

{
  uint uVar1;
  int iVar2;
  
  uVar1 = param_2 >> 1;
  iVar2 = (-(uint)(uVar1 != 0) & 0x7ff8ffa9) + 0x80070057;
  if (uVar1 != 0) {
    iVar2 = FUN_6b81fb51(param_1,uVar1,&stack0x00000010,param_3,&stack0x00000010);
  }
  return iVar2;
}



undefined4 __fastcall
FUN_6b81fb51(wchar_t *param_1,int param_2,undefined4 param_3,wchar_t *param_4,va_list param_5)

{
  uint _Count;
  uint uVar1;
  undefined4 uVar2;
  
  _Count = param_2 - 1;
  uVar2 = 0;
  uVar1 = _vsnwprintf(param_1,_Count,param_4,param_5);
  if (((int)uVar1 < 0) || (_Count < uVar1)) {
    uVar2 = 0x8007007a;
  }
  else if (uVar1 != _Count) {
    return 0;
  }
  param_1[_Count] = L'\0';
  return uVar2;
}



int __fastcall FUN_6b81fb91(short *param_1,uint param_2,int param_3)

{
  int iVar1;
  uint uVar2;
  
  uVar2 = param_2 >> 1;
  iVar1 = (-(uint)(uVar2 != 0) & 0x7ff8ffa9) + 0x80070057;
  if (uVar2 != 0) {
    iVar1 = FUN_6b812c87(param_1,uVar2,param_1,param_3);
  }
  return iVar1;
}



HRSRC FindResourceExW(HMODULE hModule,LPCWSTR lpType,LPCWSTR lpName,WORD wLanguage)

{
  HRSRC pHVar1;
  
                    // 0x1fbc0  411  FindResourceExW
                    // WARNING: Could not recover jumptable at 0x6b81fbc6. Too many branches
                    // WARNING: Treating indirect jump as call
  pHVar1 = FindResourceExW(hModule,lpType,lpName,wLanguage);
  return pHVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint QuirkIsEnabledWorker(uint param_1)

{
  short *psVar1;
  uint uVar2;
  int iVar3;
  HANDLE pvVar4;
  uint uVar5;
  int in_FS_OFFSET;
  bool bVar6;
  undefined8 uVar7;
  short *psVar8;
  short *psVar9;
  uint local_c;
  uint local_8;
  
                    // 0x1fbe0  1125  QuirkIsEnabledWorker
  uVar5 = 0;
  if (((DAT_6b8b08ac != 0) || (iVar3 = FUN_6b81fd2a(), -1 < iVar3)) &&
     (psVar1 = (short *)FUN_6b81fd05(DAT_6b8b08ac,param_1), psVar1 != (short *)0x0)) {
    FUN_6b81fceb(*(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x1e8));
    uVar7 = FUN_6b81fcd4(*(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x1e8));
    uVar5 = 1;
    uVar2 = _allshl();
    local_8 = (uint)((ulonglong)uVar7 >> 0x20);
    local_c = (uint)uVar7;
    if ((uVar2 & *(uint *)(psVar1 + 0x86)) == 0) {
      uVar5 = 0;
    }
    else {
      if (DAT_6b8b0238 == -1) {
        if (((*(uint *)(psVar1 + 0x114) & 1) == 0) &&
           ((((*(uint *)(psVar1 + 0x114) & 2) != 0 ||
             (bVar6 = *(uint *)(psVar1 + 0x84) <= local_8,
             bVar6 && local_8 != *(uint *)(psVar1 + 0x84))) ||
            ((bVar6 && (*(uint *)(psVar1 + 0x82) <= local_c)))))) {
          uVar5 = 0;
        }
      }
      else {
        uVar5 = (uint)(DAT_6b8b0238 != 0);
      }
      if ((uVar5 != 0) && (((byte)*(uint *)(psVar1 + 0x114) & 0xc) == 4)) {
        *(uint *)(psVar1 + 0x114) = *(uint *)(psVar1 + 0x114) | 8;
      }
    }
    if (_DAT_6b8b0860 != 0) {
      psVar9 = (short *)0x0;
      psVar8 = (short *)0x0;
      pvVar4 = GetCurrentProcess();
      FUN_6b8417db(psVar1,uVar5,pvVar4,psVar8,psVar9);
    }
  }
  return uVar5;
}



undefined8 __fastcall FUN_6b81fcd4(int param_1)

{
  int iVar1;
  
  iVar1 = FUN_6b81fceb(param_1);
  if (iVar1 != 0) {
    return *(undefined8 *)(iVar1 + 0x18);
  }
  return 0;
}



int __fastcall FUN_6b81fceb(int param_1)

{
  int iVar1;
  
  iVar1 = 0;
  if ((param_1 != 0) && ((iVar1 = param_1 + 0x7e0, iVar1 == 0 || (*(int *)(param_1 + 0x810) == 0))))
  {
    return 0;
  }
  return iVar1;
}



int __fastcall FUN_6b81fd05(int param_1,uint param_2)

{
  if (((ushort)(param_2 >> 0x10) < *(ushort *)(param_1 + 2)) &&
     ((ushort)(param_2 & 0xffff) < *(ushort *)(param_1 + 8 + (param_2 >> 0x10) * 0x10))) {
    return (param_2 & 0xffff) * 0x22c + *(int *)(param_1 + 0x10 + (param_2 >> 0x10) * 0x10) +
           param_1;
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int FUN_6b81fd2a(void)

{
  LPCRITICAL_SECTION p_Var1;
  LPCRITICAL_SECTION lpCriticalSection;
  LPCRITICAL_SECTION p_Var2;
  int iVar3;
  undefined4 extraout_ECX;
  int iVar4;
  uint extraout_EDX;
  uint uVar5;
  int in_FS_OFFSET;
  
  if (DAT_6b8b08ac != 0) {
    return 0;
  }
  uVar5 = 0;
  if (lpCriticalSection_6b8b08a8 == (LPCRITICAL_SECTION)0x0) {
    lpCriticalSection =
         (LPCRITICAL_SECTION)
         RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,0x18);
    if (lpCriticalSection == (LPCRITICAL_SECTION)0x0) {
      return -0x3fffff66;
    }
    InitializeCriticalSection(lpCriticalSection);
    p_Var2 = (LPCRITICAL_SECTION)0x0;
    LOCK();
    p_Var1 = lpCriticalSection;
    if (lpCriticalSection_6b8b08a8 != (LPCRITICAL_SECTION)0x0) {
      p_Var2 = lpCriticalSection_6b8b08a8;
      p_Var1 = lpCriticalSection_6b8b08a8;
    }
    lpCriticalSection_6b8b08a8 = p_Var1;
    if (p_Var2 != (LPCRITICAL_SECTION)0x0) {
      DeleteCriticalSection(lpCriticalSection);
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpCriticalSection);
    }
  }
  EnterCriticalSection(lpCriticalSection_6b8b08a8);
  if (DAT_6b8b08ac == 0) {
    iVar3 = FUN_6b81ff5a();
    if (iVar3 < 0) goto LAB_6b81fe23;
    if (DAT_6b8b08ac == 0) {
      iVar3 = -0x3fffffff;
      goto LAB_6b81fe23;
    }
    iVar3 = *(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x1e8);
    if (iVar3 != 0) {
      *(undefined4 *)(iVar3 + 0x1188) = *(undefined4 *)(DAT_6b8b08ac + 4);
      iVar4 = DAT_6b8b08ac >> 0x1f;
      *(int *)(iVar3 + 0x1180) = DAT_6b8b08ac;
      *(int *)(iVar3 + 0x1184) = iVar4;
    }
    iVar3 = EtwEventRegister(&DAT_6b8848f0,0,0,&DAT_6b8b08a0);
    if (iVar3 < 0) {
      DAT_6b8b08a0 = 0;
      DAT_6b8b08a4 = 0;
    }
    else {
      uVar5 = EtwEventEnabled(DAT_6b8b08a0,DAT_6b8b08a4,&DAT_6b8848e0);
      uVar5 = uVar5 & 0xff;
    }
    _DAT_6b8b0860 = uVar5;
    FUN_6b81fe37();
    FUN_6b81feca(extraout_ECX,extraout_EDX);
  }
  iVar3 = 0;
LAB_6b81fe23:
  LeaveCriticalSection(lpCriticalSection_6b8b08a8);
  return iVar3;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_6b81fe37(void)

{
  uint uVar1;
  int *piVar2;
  char cVar3;
  DWORD DVar4;
  LSTATUS LVar5;
  uint uVar6;
  int *piVar7;
  uint uVar8;
  uint uVar9;
  int iVar10;
  int iVar11;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  uint extraout_EDX_03;
  uint extraout_EDX_04;
  uint extraout_EDX_05;
  uint extraout_EDX_06;
  uint extraout_EDX_07;
  uint extraout_EDX_08;
  uint extraout_EDX_09;
  uint extraout_EDX_10;
  uint extraout_EDX_11;
  uint extraout_EDX_12;
  uint uVar12;
  HANDLE *ppvVar13;
  int in_FS_OFFSET;
  uint local_24c;
  uint local_248;
  HANDLE local_244;
  uint local_240;
  uint local_234;
  int *local_230;
  undefined4 local_22c;
  uint local_228;
  uint local_224;
  uint local_220;
  uint local_21c;
  WCHAR local_218 [262];
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)&local_24c;
  local_248 = DAT_6b8b08ac;
  ppvVar13 = &local_244;
  for (iVar11 = 6; iVar11 != 0; iVar11 = iVar11 + -1) {
    *ppvVar13 = (HANDLE)0x0;
    ppvVar13 = ppvVar13 + 1;
  }
  if ((*(char *)(*(int *)(in_FS_OFFSET + 0x30) + 2) == '\0') &&
     (cVar3 = EtwEventEnabled(DAT_6b8b08a0,DAT_6b8b08a4,&DAT_6b8848e0), cVar3 == '\0')) {
    _DAT_6b8b085c = 0;
    uVar12 = extraout_EDX;
    piVar7 = local_230;
    goto LAB_6b81fea5;
  }
  _DAT_6b8b085c = 1;
  local_22c = 0x104;
  iVar11 = GetCurrentPackageFullName(&local_22c,local_218);
  if ((iVar11 < 0) || (local_218[0] == L'\0')) {
    local_22c = 0x104;
    DVar4 = GetModuleFileNameW((HMODULE)0x0,local_218,0x104);
    uVar12 = extraout_EDX_01;
    piVar7 = local_230;
    if (DVar4 == 0) goto LAB_6b81fea5;
  }
  local_24c = 0;
  LVar5 = RegGetValueW((HKEY)0x80000001,
                       L"Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Quirks",
                       local_218,8,(LPDWORD)0x0,(PVOID)0x0,&local_24c);
  uVar6 = local_24c;
  uVar12 = extraout_EDX_02;
  piVar7 = local_230;
  if ((LVar5 != 0) || (local_24c == 0)) goto LAB_6b81fea5;
  local_244 = *(HANDLE *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18);
  if (local_244 == (HANDLE)0x0) {
    local_244 = GetProcessHeap();
  }
  local_234 = 0;
  local_230 = (int *)0x0;
  if (uVar6 == 0) {
LAB_6b82f12a:
    piVar2 = local_230;
    uVar6 = local_24c;
    local_240 = local_24c;
    LVar5 = RegGetValueW((HKEY)0x80000001,
                         L"Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Quirks",
                         local_218,8,(LPDWORD)0x0,local_230,&local_24c);
    uVar12 = extraout_EDX_05;
    piVar7 = piVar2;
    if ((((LVar5 == 0) && (local_24c == uVar6)) &&
        (uVar8 = FUN_6b8141f4(0,4,&local_224), uVar12 = extraout_EDX_06, -1 < (int)uVar8)) &&
       (((local_224 <= uVar6 &&
         (uVar8 = FUN_6b8141f4(0,4,&local_234), uVar6 = local_248, uVar12 = extraout_EDX_07,
         piVar7 = local_230, -1 < (int)uVar8)) &&
        ((*piVar2 == 0x736b7271 && (local_234 < local_240)))))) {
      while ((uVar1 = local_234, uVar8 = local_240, uVar9 = FUN_6b8141f4(local_234,4,&local_220),
             uVar12 = extraout_EDX_08, piVar7 = local_230, -1 < (int)uVar9 && (local_220 <= uVar8)))
      {
        local_248 = *(uint *)(uVar1 + (int)local_230);
        uVar9 = FUN_6b8141f4(uVar1,4,&local_234);
        uVar1 = local_234;
        uVar8 = local_240;
        uVar12 = extraout_EDX_09;
        piVar7 = local_230;
        if (((int)uVar9 < 0) ||
           (((local_240 < local_234 ||
             (uVar9 = FUN_6b8141f4(local_234,4,&local_21c), uVar12 = extraout_EDX_10,
             piVar7 = local_230, (int)uVar9 < 0)) || (uVar8 < local_21c)))) break;
        iVar11 = *(int *)(uVar1 + (int)local_230);
        uVar8 = FUN_6b8141f4(uVar1,4,&local_234);
        uVar12 = extraout_EDX_11;
        piVar7 = local_230;
        if (((int)uVar8 < 0) ||
           (iVar10 = FUN_6b81fd05(uVar6,local_248), uVar12 = extraout_EDX_12, piVar7 = local_230,
           iVar10 == 0)) break;
        uVar12 = *(uint *)(iVar10 + 0x228) & 0xfffffffc | (iVar11 == 0) + 1;
        *(uint *)(iVar10 + 0x228) = uVar12;
        if (local_240 <= local_234) break;
      }
    }
  }
  else {
    uVar6 = FUN_6b8141f4(uVar6,0x3ff,&local_228);
    uVar12 = extraout_EDX_03;
    if (-1 < (int)uVar6) {
      piVar7 = (int *)HeapAlloc(local_244,0,local_228 & 0xfffffc00);
      uVar12 = extraout_EDX_04;
      if (piVar7 != (int *)0x0) {
        memset(piVar7,0,local_228 & 0xfffffc00);
        local_230 = piVar7;
        goto LAB_6b82f12a;
      }
    }
    ppvVar13 = &local_244;
    for (iVar11 = 6; piVar7 = local_230, iVar11 != 0; iVar11 = iVar11 + -1) {
      *ppvVar13 = (HANDLE)0x0;
      ppvVar13 = ppvVar13 + 1;
    }
  }
LAB_6b81fea5:
  if (piVar7 != (int *)0x0) {
    HeapFree(local_244,0,piVar7);
    uVar12 = extraout_EDX_00;
  }
  FUN_6b8224af(local_c ^ (uint)&local_24c,uVar12);
  return;
}



void __fastcall FUN_6b81feca(undefined4 param_1,uint param_2)

{
  ushort uVar1;
  int iVar2;
  undefined4 *puVar3;
  ushort *puVar4;
  uint uVar5;
  uint extraout_EDX;
  bool bVar6;
  undefined4 local_10;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  if (DAT_6b8b0238 == 0xffffffff) {
    iVar2 = FUN_6b81ff02(param_1,&local_10);
    param_2 = extraout_EDX;
    if (-1 < iVar2) {
      puVar4 = &DAT_6b887cd8;
      puVar3 = &local_10;
      do {
        uVar1 = *(ushort *)puVar3;
        uVar5 = param_2 & 0xffff0000;
        param_2 = uVar5 | uVar1;
        bVar6 = uVar1 < *puVar4;
        if (uVar1 != *puVar4) {
LAB_6b82f2be:
          uVar5 = -(uint)bVar6 | 1;
          goto LAB_6b82f2c3;
        }
        if (uVar1 == 0) break;
        uVar1 = *(ushort *)((int)puVar3 + 2);
        param_2 = uVar5 | uVar1;
        bVar6 = uVar1 < puVar4[1];
        if (uVar1 != puVar4[1]) goto LAB_6b82f2be;
        puVar3 = puVar3 + 1;
        puVar4 = puVar4 + 2;
      } while (uVar1 != 0);
      uVar5 = 0;
LAB_6b82f2c3:
      DAT_6b8b0238 = (uint)(uVar5 != 0);
    }
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



int __fastcall FUN_6b81ff02(undefined4 param_1,undefined4 *param_2)

{
  int iVar1;
  undefined local_14 [8];
  ushort local_c;
  ushort local_a;
  undefined4 *local_8;
  
  *param_2 = 0;
  param_2[1] = 0;
  iVar1 = RtlInitUnicodeStringEx(local_14,L"QUIRKS_FORCE_RESULT");
  if (-1 < iVar1) {
    local_c = 0;
    local_a = 8;
    local_8 = param_2;
    iVar1 = RtlQueryEnvironmentVariable_U(0,local_14,&local_c);
    if ((-1 < iVar1) && (local_a - 2 < (uint)local_c)) {
      iVar1 = -0x3fffffdd;
    }
  }
  return iVar1;
}



void FUN_6b81ff5a(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined *puVar3;
  undefined local_d0 [188];
  undefined4 *local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  memset(local_d0,0,0xbc);
  local_14 = &local_c;
  puVar3 = local_d0;
  local_c = 0;
  local_8 = 0;
  local_10 = 8;
  uVar2 = 8;
  _guard_check_icall();
  iVar1 = NtApphelpCacheControl(uVar2,puVar3);
  DAT_6b8b08ac = 0;
  if (-1 < iVar1) {
    DAT_6b8b08ac = local_c;
  }
  return;
}



HGLOBAL GlobalFree(HGLOBAL hMem)

{
  code *pcVar1;
  HGLOBAL pvVar2;
  int iVar3;
  
                    // 0x1ffc0  826  GlobalFree
  pcVar1 = DAT_6b8b08d0;
  if (DAT_6b8b08d0 != (code *)0x0) {
    pvVar2 = hMem;
    _guard_check_icall();
    iVar3 = (*pcVar1)(pvVar2);
    if (iVar3 == 0) {
      return (HGLOBAL)0x0;
    }
  }
                    // WARNING: Could not recover jumptable at 0x6b81ffd6. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar2 = GlobalFree(hMem);
  return pvVar2;
}



void LoadAppInitDlls(void)

{
  byte bVar1;
  bool bVar2;
  int iVar3;
  undefined3 extraout_var;
  LSTATUS LVar4;
  int in_FS_OFFSET;
  int local_14;
  DWORD local_10;
  HKEY local_c;
  uint local_8;
  
                    // 0x1fff0  965  LoadAppInitDlls
  if ((((DAT_7ffe02ec == '\0') &&
       (bVar1 = *(byte *)(*(int *)(in_FS_OFFSET + 0x30) + 3), (bVar1 & 2) == 0)) &&
      ((((bVar1 & 0x10) == 0 && ((DAT_7ffe02f0 & 0x80) == 0)) ||
       (iVar3 = FUN_6b830450(), iVar3 != 0)))) &&
     ((((iVar3 = FUN_6b8200dc(), iVar3 == 0 || (local_8 == 0)) &&
       ((bVar2 = FUN_6b8200a9(&local_8), CONCAT31(extraout_var,bVar2) == 0 || (local_8 == 0)))) &&
      (LVar4 = RegOpenKeyExW((HKEY)0x80000002,
                             L"Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows",0,0x20019,
                             &local_c), LVar4 == 0)))) {
    local_10 = 4;
    LVar4 = RegGetValueW(local_c,(LPCWSTR)0x0,L"LoadAppInit_DLLs",0x10,(LPDWORD)0x0,&local_14,
                         &local_10);
    if ((LVar4 == 0) && (local_14 != 0)) {
      FUN_6b830481(local_c);
    }
    RegCloseKey(local_c);
  }
  return;
}



bool __fastcall FUN_6b8200a9(uint *param_1)

{
  HANDLE pvVar1;
  int iVar2;
  undefined4 uVar3;
  uint **ppuVar4;
  undefined4 uVar5;
  uint *local_8;
  
  uVar5 = 4;
  ppuVar4 = &local_8;
  uVar3 = 6;
  local_8 = param_1;
  pvVar1 = GetCurrentProcess();
  iVar2 = GetProcessMitigationPolicy(pvVar1,uVar3,ppuVar4,uVar5);
  if (iVar2 != 0) {
    *param_1 = (uint)local_8 & 1;
  }
  return iVar2 != 0;
}



void FUN_6b8200dc(void)

{
  HANDLE ProcessHandle;
  BOOL BVar1;
  int iVar2;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 extraout_EDX_04;
  uint uVar3;
  undefined4 uVar4;
  int in_FS_OFFSET;
  undefined8 uVar5;
  DWORD DesiredAccess;
  HANDLE *TokenHandle;
  undefined local_80 [20];
  undefined4 *local_6c;
  DWORD local_68;
  DWORD local_64;
  int local_60;
  HANDLE local_5c;
  HANDLE local_58;
  PSID local_54;
  GENERIC_MAPPING local_50;
  _PRIVILEGE_SET local_40 [2];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  uVar3 = 0;
  TokenHandle = &local_5c;
  local_64 = 0;
  DesiredAccess = 10;
  local_60 = 0;
  local_58 = (HANDLE)0x0;
  local_5c = (HANDLE)0x0;
  local_54 = (PSID)0x0;
  ProcessHandle = GetCurrentProcess();
  BVar1 = OpenProcessToken(ProcessHandle,DesiredAccess,TokenHandle);
  uVar4 = extraout_EDX;
  if ((BVar1 != 0) &&
     (BVar1 = DuplicateToken(local_5c,SecurityImpersonation,&local_58), uVar4 = extraout_EDX_00,
     BVar1 != 0)) {
    uVar5 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,0x198);
    uVar4 = (undefined4)((ulonglong)uVar5 >> 0x20);
    iVar2 = (int)uVar5;
    if (iVar2 != 0) {
      RtlCreateAcl(iVar2,0x198,2);
      do {
        if (local_54 != (PSID)0x0) {
          FreeSid(local_54);
          local_54 = (PSID)0x0;
        }
        BVar1 = AllocateAndInitializeSid
                          ((PSID_IDENTIFIER_AUTHORITY)&pIdentifierAuthority_6b8b0164,
                           (&DAT_6b8b0180)[uVar3],*(DWORD *)((int)&nSubAuthority0_6b8b0184 + uVar3),
                           *(DWORD *)((int)&nSubAuthority1_6b8b0188 + uVar3),
                           *(DWORD *)((int)&nSubAuthority2_6b8b018c + uVar3),
                           *(DWORD *)((int)&nSubAuthority3_6b8b0190 + uVar3),
                           *(DWORD *)((int)&nSubAuthority4_6b8b0194 + uVar3),
                           *(DWORD *)((int)&nSubAuthority5_6b8b0198 + uVar3),
                           *(DWORD *)((int)&nSubAuthority6_6b8b019c + uVar3),
                           *(DWORD *)((int)&nSubAuthority7_6b8b01a0 + uVar3),&local_54);
        if (BVar1 == 0) goto LAB_6b82026d;
        RtlAddAccessAllowedAce(iVar2,2,1,local_54);
        uVar3 = uVar3 + 0x24;
      } while (uVar3 < 0xb4);
      uVar4 = 1;
      RtlCreateSecurityDescriptor(local_80,1);
      RtlSetOwnerSecurityDescriptor(local_80,local_54,0);
      RtlSetGroupSecurityDescriptor(local_80,local_54,0);
      RtlSetDaclSecurityDescriptor(local_80,1,iVar2,0);
      local_50.GenericRead = 0x20001;
      local_50.GenericWrite = 0x20000;
      local_50.GenericExecute = 0x20000;
      local_50.GenericAll = 0x1f0001;
      local_68 = 0x38;
      BVar1 = AccessCheck(local_80,local_58,1,&local_50,local_40,&local_68,&local_64,&local_60);
      if (BVar1 != 0) {
        if ((local_60 == 0) || (local_64 != 1)) {
          uVar4 = 0;
        }
        *local_6c = uVar4;
      }
LAB_6b82026d:
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iVar2);
      uVar4 = extraout_EDX_01;
    }
  }
  if (local_54 != (PSID)0x0) {
    FreeSid(local_54);
    uVar4 = extraout_EDX_02;
  }
  if (local_58 != (HANDLE)0x0) {
    CloseHandle(local_58);
    uVar4 = extraout_EDX_03;
  }
  if (local_5c != (HANDLE)0x0) {
    CloseHandle(local_5c);
    uVar4 = extraout_EDX_04;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar4);
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

SIZE_T LocalSize(HLOCAL hMem)

{
  char cVar1;
  SIZE_T *pSVar2;
  undefined4 *in_FS_OFFSET;
  SIZE_T *local_28;
  uint local_24;
  SIZE_T local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x202d0  986  LocalSize
  local_8 = &DAT_6b891ce0;
  uStack12 = 0x6b8202dc;
  local_20 = 0xffffffff;
  local_24 = 0;
  RtlLockHeap(DAT_6b8b0734);
  local_8 = (undefined *)0x1;
  pSVar2 = (SIZE_T *)hMem;
  if (((uint)hMem & 4) == 0) {
    local_28 = (SIZE_T *)0x0;
    cVar1 = RtlGetUserInfoHeap(DAT_6b8b0734,local_24,hMem,&local_28,&local_24);
    if ((cVar1 != '\0') &&
       ((local_28 == (SIZE_T *)0x0 || (pSVar2 = local_28, (local_24 & 0x200) == 0)))) {
      local_20 = RtlSizeHeap(DAT_6b8b0734,1,hMem);
      pSVar2 = (SIZE_T *)hMem;
    }
    if (((uint)pSVar2 & 4) == 0) goto LAB_6b820336;
  }
  cVar1 = RtlIsValidHandle(DAT_6b8b072c,pSVar2 + -1);
  if (cVar1 == '\0') {
    RtlSetLastWin32Error(6);
  }
  else if ((*(byte *)(pSVar2 + -1) & 8) == 0) {
    local_20 = RtlSizeHeap(DAT_6b8b0734,1,*pSVar2);
  }
  else {
    local_20 = *pSVar2;
  }
LAB_6b820336:
  local_8 = (undefined *)0xfffffffe;
  FUN_6b8203a8();
  if (local_20 == 0xffffffff) {
    RtlSetLastWin32Error(6);
    local_20 = 0;
  }
  *in_FS_OFFSET = local_14;
  return local_20;
}



void FUN_6b8203a8(void)

{
  RtlUnlockHeap(DAT_6b8b0734);
  return;
}



UINT GetACP(void)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8203c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x203c0  440  GetACP
  UVar1 = GetACP();
  return UVar1;
}



bool DeactivateActCtxWorker(uint param_1,undefined4 param_2)

{
  bool bVar1;
  
                    // 0x203d0  265  DeactivateActCtxWorker
  bVar1 = (param_1 & 0xfffffffe) != 0;
  if (bVar1) {
    BaseSetLastNTError(0xc000000d);
  }
  else {
    RtlDeactivateActivationContext(param_1 & 1,param_2);
  }
  return !bVar1;
}



undefined4 ActivateActCtxWorker(int param_1,undefined4 param_2)

{
  int iVar1;
  
                    // 0x20400  7  ActivateActCtxWorker
  if (param_1 == -1) {
    iVar1 = -0x3ffffff3;
  }
  else {
    iVar1 = RtlActivateActivationContext(0,param_1,param_2);
    if (-1 < iVar1) {
      return 1;
    }
  }
  BaseSetLastNTError(iVar1);
  return 0;
}



int lstrlen(LPCSTR lpString)

{
  int iVar1;
  
                    // 0x20440  1600  lstrlen
                    // 0x20440  1601  lstrlenA
                    // WARNING: Could not recover jumptable at 0x6b820446. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = lstrlenA(lpString);
  return iVar1;
}



HLOCAL LocalAlloc(UINT uFlags,SIZE_T uBytes)

{
  HLOCAL pvVar1;
  
                    // 0x20460  976  LocalAlloc
                    // WARNING: Could not recover jumptable at 0x6b820466. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = LocalAlloc(uFlags,uBytes);
  return pvVar1;
}



DWORD SizeofResource(HMODULE hModule,HRSRC hResInfo)

{
  DWORD DVar1;
  
                    // 0x20480  1410  SizeofResource
                    // WARNING: Could not recover jumptable at 0x6b820486. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = SizeofResource(hModule,hResInfo);
  return DVar1;
}



HANDLE CreateFileMappingW(HANDLE hFile,LPSECURITY_ATTRIBUTES lpFileMappingAttributes,DWORD flProtect
                         ,DWORD dwMaximumSizeHigh,DWORD dwMaximumSizeLow,LPCWSTR lpName)

{
  HANDLE pvVar1;
  
                    // 0x204a0  206  CreateFileMappingW
                    // WARNING: Could not recover jumptable at 0x6b8204a6. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = CreateFileMappingW(hFile,lpFileMappingAttributes,flProtect,dwMaximumSizeHigh,
                              dwMaximumSizeLow,lpName);
  return pvVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

SIZE_T VirtualProtect(HGLOBAL hMem)

{
  char cVar1;
  SIZE_T *pSVar2;
  undefined4 *in_FS_OFFSET;
  uint uStack40;
  SIZE_T *pSStack36;
  SIZE_T SStack32;
  undefined4 uStack20;
  undefined4 uStack12;
  undefined *puStack8;
  
                    // 0x204c0  1490  VirtualProtect
  puStack8 = &DAT_6b891d08;
  uStack12 = 0x6b8204ec;
  SStack32 = 0xffffffff;
  RtlLockHeap(DAT_6b8b0734);
  puStack8 = (undefined *)0x1;
  pSVar2 = (SIZE_T *)hMem;
  if (((uint)hMem & 4) == 0) {
    pSStack36 = (SIZE_T *)0x0;
    uStack40 = 0x800;
    cVar1 = RtlGetUserInfoHeap(DAT_6b8b0734,0x800,hMem,&pSStack36,&uStack40);
    if ((cVar1 != '\0') &&
       ((pSStack36 == (SIZE_T *)0x0 || (pSVar2 = pSStack36, (uStack40 & 0x200) == 0)))) {
      SStack32 = RtlSizeHeap(DAT_6b8b0734,1,hMem);
      pSVar2 = (SIZE_T *)hMem;
    }
    if (((uint)pSVar2 & 4) == 0) goto LAB_6b820541;
  }
  cVar1 = RtlIsValidHandle(DAT_6b8b072c,pSVar2 + -1);
  if (cVar1 == '\0') {
    RtlSetLastWin32Error(6);
  }
  else if ((*(byte *)(pSVar2 + -1) & 8) == 0) {
    SStack32 = RtlSizeHeap(DAT_6b8b0734,1,*pSVar2);
  }
  else {
    SStack32 = *pSVar2;
  }
LAB_6b820541:
  puStack8 = (undefined *)0xfffffffe;
  FUN_6b820574();
  if (SStack32 == 0xffffffff) {
    RtlSetLastWin32Error(6);
    SStack32 = 0;
  }
  *in_FS_OFFSET = uStack20;
  return SStack32;
}



void FUN_6b8204c2(void)

{
  code *pcVar1;
  
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

SIZE_T GlobalSize(HGLOBAL hMem)

{
  char cVar1;
  SIZE_T *pSVar2;
  undefined4 *in_FS_OFFSET;
  uint local_28;
  SIZE_T *local_24;
  SIZE_T local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x204e0  834  GlobalSize
  local_8 = &DAT_6b891d08;
  uStack12 = 0x6b8204ec;
  local_20 = 0xffffffff;
  RtlLockHeap(DAT_6b8b0734);
  local_8 = (undefined *)0x1;
  pSVar2 = (SIZE_T *)hMem;
  if (((uint)hMem & 4) == 0) {
    local_24 = (SIZE_T *)0x0;
    local_28 = 0x800;
    cVar1 = RtlGetUserInfoHeap(DAT_6b8b0734,0x800,hMem,&local_24,&local_28);
    if ((cVar1 != '\0') &&
       ((local_24 == (SIZE_T *)0x0 || (pSVar2 = local_24, (local_28 & 0x200) == 0)))) {
      local_20 = RtlSizeHeap(DAT_6b8b0734,1,hMem);
      pSVar2 = (SIZE_T *)hMem;
    }
    if (((uint)pSVar2 & 4) == 0) goto LAB_6b820541;
  }
  cVar1 = RtlIsValidHandle(DAT_6b8b072c,pSVar2 + -1);
  if (cVar1 == '\0') {
    RtlSetLastWin32Error(6);
  }
  else if ((*(byte *)(pSVar2 + -1) & 8) == 0) {
    local_20 = RtlSizeHeap(DAT_6b8b0734,1,*pSVar2);
  }
  else {
    local_20 = *pSVar2;
  }
LAB_6b820541:
  local_8 = (undefined *)0xfffffffe;
  FUN_6b820574();
  if (local_20 == 0xffffffff) {
    RtlSetLastWin32Error(6);
    local_20 = 0;
  }
  *in_FS_OFFSET = local_14;
  return local_20;
}



void FUN_6b820574(void)

{
  RtlUnlockHeap(DAT_6b8b0734);
  return;
}



UINT GetWriteWatch(DWORD dwFlags,PVOID lpBaseAddress,SIZE_T dwRegionSize,PVOID *lpAddresses,
                  ULONG_PTR *lpdwCount,PULONG lpdwGranularity)

{
  UINT UVar1;
  
                    // 0x20590  813  GetWriteWatch
                    // WARNING: Could not recover jumptable at 0x6b820596. Too many branches
                    // WARNING: Treating indirect jump as call
  UVar1 = GetWriteWatch(dwFlags,lpBaseAddress,dwRegionSize,lpAddresses,lpdwCount,lpdwGranularity);
  return UVar1;
}



void RaiseException(DWORD dwExceptionCode,DWORD dwExceptionFlags,DWORD nNumberOfArguments,
                   ULONG_PTR *lpArguments)

{
                    // WARNING: Could not recover jumptable at 0x6b8205b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x205b0  1126  RaiseException
  RaiseException(dwExceptionCode,dwExceptionFlags,nNumberOfArguments,lpArguments);
  return;
}



void RtlUnwind(PVOID TargetFrame,PVOID TargetIp,PEXCEPTION_RECORD ExceptionRecord,PVOID ReturnValue)

{
                    // WARNING: Could not recover jumptable at 0x6b8205c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x205c0  1239  RtlUnwind
  RtlUnwind(TargetFrame,TargetIp,ExceptionRecord,ReturnValue);
  return;
}



BOOL UnmapViewOfFile(LPCVOID lpBaseAddress)

{
  BOOL BVar1;
  
                    // 0x205d0  1462  UnmapViewOfFile
                    // WARNING: Could not recover jumptable at 0x6b8205d6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = UnmapViewOfFile(lpBaseAddress);
  return BVar1;
}



HGLOBAL GlobalAlloc(UINT uFlags,SIZE_T dwBytes)

{
  HGLOBAL pvVar1;
  
                    // 0x205f0  819  GlobalAlloc
                    // WARNING: Could not recover jumptable at 0x6b8205f6. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = GlobalAlloc(uFlags,dwBytes);
  return pvVar1;
}



UINT SetErrorMode(UINT uMode)

{
  UINT UVar1;
  
                    // 0x20610  1305  SetErrorMode
                    // WARNING: Could not recover jumptable at 0x6b820616. Too many branches
                    // WARNING: Treating indirect jump as call
  UVar1 = SetErrorMode(uMode);
  return UVar1;
}



HANDLE OpenProcess(DWORD dwDesiredAccess,BOOL bInheritHandle,DWORD dwProcessId)

{
  HANDLE pvVar1;
  
                    // 0x20630  1041  OpenProcess
                    // WARNING: Could not recover jumptable at 0x6b820636. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = OpenProcess(dwDesiredAccess,bInheritHandle,dwProcessId);
  return pvVar1;
}



undefined4
TermsrvGetPreSetValue(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  code *pcVar1;
  undefined4 uVar2;
  
                    // 0x20650  1433  TermsrvGetPreSetValue
  pcVar1 = DAT_6b8b08f8;
  if (DAT_6b8b08f8 == (code *)0x0) {
    uVar2 = 0xc0000135;
  }
  else {
    _guard_check_icall();
    uVar2 = (*pcVar1)(param_1,param_2,param_3,param_4);
  }
  return uVar2;
}



undefined4
TermsrvSetValueKey(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
                  undefined4 param_5,undefined4 param_6)

{
  code *pcVar1;
  undefined4 uVar2;
  
                    // 0x20680  1440  TermsrvSetValueKey
  pcVar1 = DAT_6b8b08e0;
  if (DAT_6b8b08e0 == (code *)0x0) {
    uVar2 = 0;
  }
  else {
    _guard_check_icall();
    uVar2 = (*pcVar1)(param_1,param_2,param_3,param_4,param_5,param_6);
  }
  return uVar2;
}



int GetLocaleInfoW(LCID Locale,LCTYPE LCType,LPWSTR lpLCData,int cchData)

{
  int iVar1;
  
                    // 0x206a0  619  GetLocaleInfoW
                    // WARNING: Could not recover jumptable at 0x6b8206a6. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = GetLocaleInfoW(Locale,LCType,lpLCData,cchData);
  return iVar1;
}



BOOL SetThreadPriority(HANDLE hThread,int nPriority)

{
  BOOL BVar1;
  
                    // 0x206c0  1380  SetThreadPriority
                    // WARNING: Could not recover jumptable at 0x6b8206c6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetThreadPriority(hThread,nPriority);
  return BVar1;
}



BOOL IsWow64Process(HANDLE hProcess,PBOOL Wow64Process)

{
  BOOL BVar1;
  
                    // 0x206e0  920  IsWow64Process
                    // WARNING: Could not recover jumptable at 0x6b8206e6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = IsWow64Process(hProcess,Wow64Process);
  return BVar1;
}



LPVOID LocalLock(HLOCAL hMem)

{
  LPVOID pvVar1;
  
                    // 0x20700  983  LocalLock
                    // WARNING: Could not recover jumptable at 0x6b820706. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = LocalLock(hMem);
  return pvVar1;
}



BOOL LocalUnlock(HLOCAL hMem)

{
  BOOL BVar1;
  
                    // 0x20720  988  LocalUnlock
                    // WARNING: Could not recover jumptable at 0x6b820726. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = LocalUnlock(hMem);
  return BVar1;
}



UINT ResetWriteWatch(LPVOID lpBaseAddress,SIZE_T dwRegionSize)

{
  UINT UVar1;
  
                    // 0x20740  1227  ResetWriteWatch
                    // WARNING: Could not recover jumptable at 0x6b820746. Too many branches
                    // WARNING: Treating indirect jump as call
  UVar1 = ResetWriteWatch(lpBaseAddress,dwRegionSize);
  return UVar1;
}



BOOL GetThreadPreferredUILanguages
               (DWORD dwFlags,PULONG pulNumLanguages,PZZWSTR pwszLanguagesBuffer,
               PULONG pcchLanguagesBuffer)

{
  BOOL BVar1;
  
                    // 0x20760  774  GetThreadPreferredUILanguages
                    // WARNING: Could not recover jumptable at 0x6b820766. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetThreadPreferredUILanguages
                    (dwFlags,pulNumLanguages,pwszLanguagesBuffer,pcchLanguagesBuffer);
  return BVar1;
}



undefined4 Process32NextW(undefined4 param_1,int *param_2)

{
  uint uVar1;
  int iVar2;
  undefined4 uVar3;
  int *piVar4;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  int local_8;
  
                    // 0x20780  1074  Process32NextW
  uVar3 = 0;
  if ((param_2 == (int *)0x0) || (*param_2 != 0x22c)) {
    iVar2 = -0x3ffffffc;
  }
  else {
    local_14 = 0;
    local_10 = 0;
    local_c = 0;
    local_8 = 0;
    iVar2 = NtMapViewOfSection(param_1,0xffffffff,&local_8,0,0,&local_14,&local_c,1,0,4);
    if (-1 < iVar2) {
      uVar1 = *(uint *)(local_8 + 0x24);
      if (uVar1 < *(uint *)(local_8 + 4)) {
        *(uint *)(local_8 + 0x24) = uVar1 + 1;
        piVar4 = (int *)(uVar1 * 0x22c + *(int *)(local_8 + 0x14) + local_8);
        for (iVar2 = 0x8b; iVar2 != 0; iVar2 = iVar2 + -1) {
          *param_2 = *piVar4;
          piVar4 = piVar4 + 1;
          param_2 = param_2 + 1;
        }
        uVar3 = 1;
      }
      else {
        RtlSetLastWin32Error(0x12);
      }
      NtUnmapViewOfSection(0xffffffff,local_8);
      return uVar3;
    }
  }
  BaseSetLastNTError(iVar2);
  return 0;
}



undefined4 GetCurrentActCtxWorker(int param_1)

{
  int iVar1;
  
                    // 0x20820  530  GetCurrentActCtxWorker
  if (param_1 == 0) {
    iVar1 = -0x3ffffff3;
  }
  else {
    iVar1 = RtlGetActiveActivationContext(param_1);
    if (-1 < iVar1) {
      return 1;
    }
  }
  BaseSetLastNTError(iVar1);
  return 0;
}



DWORD GetEnvironmentVariableW(LPCWSTR lpName,LPWSTR lpBuffer,DWORD nSize)

{
  DWORD DVar1;
  
                    // 0x20860  575  GetEnvironmentVariableW
                    // WARNING: Could not recover jumptable at 0x6b820866. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = GetEnvironmentVariableW(lpName,lpBuffer,nSize);
  return DVar1;
}



int lstrcmpW(LPCWSTR lpString1,LPCWSTR lpString2)

{
  int iVar1;
  
                    // 0x20880  1590  lstrcmpW
                    // WARNING: Could not recover jumptable at 0x6b820886. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = lstrcmpW(lpString1,lpString2);
  return iVar1;
}



BOOL VerifyVersionInfoW(LPOSVERSIONINFOEXW lpVersionInformation,DWORD dwTypeMask,
                       DWORDLONG dwlConditionMask)

{
  int iVar1;
  undefined4 uVar2;
  
                    // 0x208a0  1483  VerifyVersionInfoW
  iVar1 = RtlSwitchedVVI(lpVersionInformation,dwTypeMask,dwlConditionMask);
  if (iVar1 == -0x3ffffff3) {
    uVar2 = 0xa0;
  }
  else {
    if (iVar1 != -0x3fffffa7) {
      return 1;
    }
    uVar2 = 0x47e;
  }
  RtlSetLastWin32Error(uVar2);
  return 0;
}



undefined4 BasepNotifyLoadStringResource(void)

{
                    // 0x208f0  97  BasepNotifyLoadStringResource
                    // 0x208f0  1538  WerpNotifyLoadStringResourceWorker
  return 0x80004001;
}



DWORD GetModuleFileNameW(HMODULE hModule,LPWSTR lpFilename,DWORD nSize)

{
  DWORD DVar1;
  
                    // 0x20900  634  GetModuleFileNameW
                    // WARNING: Could not recover jumptable at 0x6b820906. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = GetModuleFileNameW(hModule,lpFilename,nSize);
  return DVar1;
}



undefined4 __fastcall
FUN_6b82090c(uint param_1,uint param_2,uint *param_3,int param_4,uint *param_5,int param_6,
            int param_7)

{
  uint *puVar1;
  int *piVar2;
  void *_Src;
  ushort uVar3;
  uint uVar4;
  int iVar5;
  uint *puVar6;
  uint *puVar7;
  uint uVar8;
  uint *local_1c;
  int local_18;
  uint local_10;
  
  local_1c = param_3 + 0xc;
  if ((param_1 & 1) != 0) {
    uVar8 = 0;
    param_3[4] = 0x30;
    if (*param_3 != 0) {
      puVar7 = (uint *)(param_7 + 4);
      puVar6 = param_3 + 0xe;
      do {
        puVar6[-2] = 0x10;
        puVar6[-1] = param_2;
        uVar4 = *puVar7;
        puVar7 = puVar7 + 0x10;
        *puVar6 = uVar4;
        uVar8 = uVar8 + 1;
        puVar6[1] = (uint)(uVar4 == *(uint *)(param_6 + 0x4c));
        puVar6 = puVar6 + 4;
      } while (uVar8 < *param_3);
    }
    local_1c = param_3 + uVar8 * 4 + 0xc;
  }
  if ((param_1 & 8) != 0) {
    param_3[6] = (int)local_1c - (int)param_3;
    puVar7 = param_5 + 1;
    uVar8 = param_3[2];
    if (*param_5 <= uVar8 && uVar8 != *param_5) {
      return 0xc000000d;
    }
    uVar4 = 0;
    local_10 = 0;
    if (uVar8 != 0) {
      puVar6 = local_1c + 7;
      do {
        puVar6[-7] = 0x428;
        puVar6[-5] = param_2;
        *puVar6 = puVar7[2];
        puVar6[-2] = puVar7[2];
        FUN_6b85ab4b(puVar6 + 0x81,puVar7 + 7,0x208);
        FUN_6b85ab4b(puVar6 + 1,*(ushort *)((int)puVar7 + 0x1a) + 0x1c + (int)puVar7,0x200);
        puVar6[-1] = puVar7[3];
        puVar6[-6] = 1;
        puVar6[-4] = (uint)*(ushort *)(puVar7 + 6);
        puVar1 = puVar7 + 6;
        puVar7 = puVar7 + 0x47;
        puVar6[-3] = (uint)*(ushort *)puVar1;
        uVar4 = local_10 + 1;
        puVar6 = puVar6 + 0x10a;
        local_10 = uVar4;
      } while (uVar4 < param_3[2]);
    }
    local_1c = local_1c + uVar4 * 0x10a;
  }
  if ((param_1 & 2) != 0) {
    local_10 = 0;
    param_3[5] = (int)local_1c - (int)param_3;
    puVar7 = local_1c + 7;
    local_18 = 0;
    do {
      puVar7[-7] = 0x22c;
      puVar7[-5] = *(uint *)(local_18 + 0x44 + param_4);
      *puVar7 = *(uint *)(local_18 + 0x40 + param_4);
      puVar7[-2] = *(uint *)(local_18 + 4 + param_4);
      puVar7[-1] = *(uint *)(local_18 + 0x48 + param_4);
      puVar7[-6] = 0;
      puVar7[-4] = 0;
      puVar7[-3] = 0;
      puVar7[1] = 0;
      _Src = *(void **)(local_18 + 0x3c + param_4);
      if (_Src == (void *)0x0) {
        wcscpy_s((wchar_t *)(puVar7 + 2),0x104,L"[System Process]");
      }
      else {
        uVar3 = *(ushort *)(local_18 + 0x38 + param_4);
        if (0x103 < uVar3) {
          uVar3 = 0x103;
          *(undefined2 *)(local_18 + 0x38 + param_4) = 0x103;
        }
        memcpy(puVar7 + 2,_Src,(uint)uVar3);
        *(undefined2 *)((int)puVar7 + (uint)*(ushort *)(local_18 + 0x38 + param_4) * 2 + 8) = 0;
      }
      piVar2 = (int *)(local_18 + param_4);
      puVar7 = puVar7 + 0x8b;
      local_18 = local_18 + *piVar2;
      local_10 = local_10 + 1;
    } while (*piVar2 != 0);
    local_1c = local_1c + local_10 * 0x8b;
  }
  if ((param_1 & 4) != 0) {
    iVar5 = 0;
    param_3[7] = (int)local_1c - (int)param_3;
    do {
      uVar8 = 0;
      if (*(int *)(iVar5 + 4 + param_4) != 0) {
        puVar7 = (uint *)(param_4 + 0xd8 + iVar5);
        do {
          *local_1c = 0x1c;
          local_1c[2] = puVar7[1];
          local_1c[3] = *puVar7;
          local_1c[4] = puVar7[3];
          local_1c[5] = 0;
          local_1c[1] = 0;
          local_1c[6] = 0;
          local_1c = local_1c + 7;
          uVar8 = uVar8 + 1;
          puVar7 = puVar7 + 0x10;
        } while (uVar8 < *(uint *)(iVar5 + 4 + param_4));
      }
      piVar2 = (int *)(iVar5 + param_4);
      iVar5 = iVar5 + *piVar2;
    } while (*piVar2 != 0);
  }
  return 0;
}



HANDLE HeapCreate(DWORD flOptions,SIZE_T dwInitialSize,SIZE_T dwMaximumSize)

{
  HANDLE pvVar1;
  
                    // 0x20a40  845  HeapCreate
                    // WARNING: Could not recover jumptable at 0x6b820a46. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = HeapCreate(flOptions,dwInitialSize,dwMaximumSize);
  return pvVar1;
}



HMODULE GetModuleHandleA(LPCSTR lpModuleName)

{
  HMODULE pHVar1;
  
                    // 0x20a60  635  GetModuleHandleA
                    // WARNING: Could not recover jumptable at 0x6b820a66. Too many branches
                    // WARNING: Treating indirect jump as call
  pHVar1 = GetModuleHandleA(lpModuleName);
  return pHVar1;
}



int GetThreadPriority(HANDLE hThread)

{
  int iVar1;
  
                    // 0x20a80  775  GetThreadPriority
                    // WARNING: Could not recover jumptable at 0x6b820a86. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = GetThreadPriority(hThread);
  return iVar1;
}



BOOL DeactivateActCtx(DWORD dwFlags,ULONG_PTR ulCookie)

{
  BOOL BVar1;
  
                    // 0x20aa0  264  DeactivateActCtx
                    // WARNING: Could not recover jumptable at 0x6b820aa6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = DeactivateActCtx(dwFlags,ulCookie);
  return BVar1;
}



BOOL ActivateActCtx(HANDLE hActCtx,ULONG_PTR *lpCookie)

{
  BOOL BVar1;
  
                    // 0x20ac0  6  ActivateActCtx
                    // WARNING: Could not recover jumptable at 0x6b820ac6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = ActivateActCtx(hActCtx,lpCookie);
  return BVar1;
}



BOOL FreeLibrary(HMODULE hLibModule)

{
  BOOL BVar1;
  
                    // 0x20ae0  433  FreeLibrary
                    // WARNING: Could not recover jumptable at 0x6b820ae6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = FreeLibrary(hLibModule);
  return BVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int __thiscall FUN_6b820aec(undefined4 this,undefined4 param_2,uint *param_3,uint *param_4)

{
  uint uVar1;
  int iVar2;
  
  iVar2 = RtlQueryPackageClaims(this,0,0,0,0,0,param_3,param_4);
  if (iVar2 == -0x3ffffddb) {
    *param_4 = 0;
    iVar2 = 0;
    param_4[1] = 0;
    *param_3 = 0;
  }
  if (iVar2 < 0) {
    _DAT_6b8b0834 = 0;
    return iVar2;
  }
  if ((*param_4 & 1) != 0) {
    if ((*param_4 & 8) != 0) {
      _DAT_6b8b0834 = 0x50001;
      return iVar2;
    }
    uVar1 = *param_3;
    if (((((uVar1 & 0x10000) == 0) && ((uVar1 & 4) == 0)) && ((uVar1 & 0x400) == 0)) &&
       ((((uVar1 & 0x800) == 0 && ((uVar1 & 0x40) == 0)) && ((uVar1 & 0x1000) == 0)))) {
      _DAT_6b8b0834 = (byte)~(byte)uVar1 >> 3 & 1 | 0x50000;
      return iVar2;
    }
  }
  _DAT_6b8b0834 = 0x50000;
  return iVar2;
}



void GetLocalTime(LPSYSTEMTIME lpSystemTime)

{
                    // WARNING: Could not recover jumptable at 0x6b820b60. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20b60  616  GetLocalTime
  GetLocalTime(lpSystemTime);
  return;
}



BOOL IsProcessorFeaturePresent(DWORD ProcessorFeature)

{
  BOOL BVar1;
  
                    // 0x20b70  907  IsProcessorFeaturePresent
                    // WARNING: Could not recover jumptable at 0x6b820b76. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = IsProcessorFeaturePresent(ProcessorFeature);
  return BVar1;
}



BOOL ProcessIdToSessionId(DWORD dwProcessId,DWORD *pSessionId)

{
  BOOL BVar1;
  
                    // 0x20b90  1075  ProcessIdToSessionId
                    // WARNING: Could not recover jumptable at 0x6b820b96. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = ProcessIdToSessionId(dwProcessId,pSessionId);
  return BVar1;
}



BOOL SetThreadPreferredUILanguages
               (DWORD dwFlags,PCZZWSTR pwszLanguagesBuffer,PULONG pulNumLanguages)

{
  BOOL BVar1;
  
                    // 0x20bb0  1379  SetThreadPreferredUILanguages
                    // WARNING: Could not recover jumptable at 0x6b820bb6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetThreadPreferredUILanguages(dwFlags,pwszLanguagesBuffer,pulNumLanguages);
  return BVar1;
}



HMODULE LoadLibraryA(LPCSTR lpLibFileName)

{
  HMODULE pHVar1;
  
                    // 0x20bd0  967  LoadLibraryA
                    // WARNING: Could not recover jumptable at 0x6b820bd6. Too many branches
                    // WARNING: Treating indirect jump as call
  pHVar1 = LoadLibraryA(lpLibFileName);
  return pHVar1;
}



BOOL HeapDestroy(HANDLE hHeap)

{
  BOOL BVar1;
  
                    // 0x20bf0  846  HeapDestroy
                    // WARNING: Could not recover jumptable at 0x6b820bf6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = HeapDestroy(hHeap);
  return BVar1;
}



void ReleaseActCtxWorker(void)

{
                    // WARNING: Could not recover jumptable at 0x6b820c10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20c10  1203  ReleaseActCtxWorker
  RtlReleaseActivationContext();
  return;
}



DWORD GetProcessId(HANDLE Process)

{
  DWORD DVar1;
  
                    // 0x20c20  700  GetProcessId
                    // WARNING: Could not recover jumptable at 0x6b820c26. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = GetProcessId(Process);
  return DVar1;
}



BOOL GetStringTypeW(DWORD dwInfoType,LPCWSTR lpSrcStr,int cchSrc,LPWORD lpCharType)

{
  BOOL BVar1;
  
                    // 0x20c40  733  GetStringTypeW
                    // WARNING: Could not recover jumptable at 0x6b820c46. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetStringTypeW(dwInfoType,lpSrcStr,cchSrc,lpCharType);
  return BVar1;
}



int GetLocaleInfoEx(LPCWSTR lpLocaleName,LCTYPE LCType,LPWSTR lpLCData,int cchData)

{
  int iVar1;
  
                    // 0x20c60  618  GetLocaleInfoEx
                    // WARNING: Could not recover jumptable at 0x6b820c66. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = GetLocaleInfoEx(lpLocaleName,LCType,lpLCData,cchData);
  return iVar1;
}



void GetStartupInfoA(LPSTARTUPINFOA lpStartupInfo)

{
  int iVar1;
  uint uVar2;
  DWORD *pDVar3;
  undefined4 *puVar4;
  DWORD *pDVar5;
  int iVar6;
  DWORD *pDVar7;
  int in_FS_OFFSET;
  undefined local_1c [4];
  DWORD local_18;
  undefined local_14 [4];
  DWORD local_10;
  undefined local_c [4];
  DWORD local_8;
  
                    // 0x20c80  725  GetStartupInfoA
  iVar1 = *(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x10);
  pDVar5 = DAT_6b8b06ec;
  if (DAT_6b8b06ec != (DWORD *)0x0) goto LAB_6b820dab;
  puVar4 = (undefined4 *)KernelBaseGetGlobalData();
  pDVar5 = (DWORD *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar4,
                                    0x44);
  if (pDVar5 == (DWORD *)0x0) {
    iVar6 = -0x3fffffe9;
LAB_6b82f6db:
    RtlRaiseStatus(iVar6);
  }
  else {
    *pDVar5 = 0x44;
    pDVar5[1] = 0;
    pDVar5[2] = 0;
    pDVar5[3] = 0;
    pDVar5[4] = *(DWORD *)(iVar1 + 0x4c);
    pDVar5[5] = *(DWORD *)(iVar1 + 0x50);
    pDVar5[6] = *(DWORD *)(iVar1 + 0x54);
    pDVar5[7] = *(DWORD *)(iVar1 + 0x58);
    pDVar5[8] = *(DWORD *)(iVar1 + 0x5c);
    pDVar5[9] = *(DWORD *)(iVar1 + 0x60);
    pDVar5[10] = *(DWORD *)(iVar1 + 100);
    pDVar5[0xb] = *(DWORD *)(iVar1 + 0x68);
    *(undefined2 *)(pDVar5 + 0xc) = *(undefined2 *)(iVar1 + 0x6c);
    *(undefined2 *)((int)pDVar5 + 0x32) = *(undefined2 *)(iVar1 + 0x88);
    pDVar5[0xd] = *(DWORD *)(iVar1 + 0x8c);
    pDVar5[0xe] = *(DWORD *)(iVar1 + 0x18);
    pDVar5[0xf] = *(DWORD *)(iVar1 + 0x1c);
    pDVar5[0x10] = *(DWORD *)(iVar1 + 0x20);
    iVar6 = RtlUnicodeStringToAnsiString(local_14,iVar1 + 0x80,1);
    if (iVar6 < 0) {
LAB_6b82f6c9:
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pDVar5);
      goto LAB_6b82f6db;
    }
    pDVar5[1] = local_10;
    iVar6 = RtlUnicodeStringToAnsiString(local_c,iVar1 + 0x78,1);
    if (iVar6 < 0) {
LAB_6b82f6bf:
      RtlFreeAnsiString(local_14);
      goto LAB_6b82f6c9;
    }
    pDVar5[2] = local_8;
    iVar6 = RtlUnicodeStringToAnsiString(local_1c,iVar1 + 0x70,1);
    if (iVar6 < 0) {
      RtlFreeAnsiString(local_c);
      goto LAB_6b82f6bf;
    }
    pDVar5[3] = local_18;
    pDVar7 = (DWORD *)0x0;
    LOCK();
    pDVar3 = pDVar5;
    if (DAT_6b8b06ec != (DWORD *)0x0) {
      pDVar7 = DAT_6b8b06ec;
      pDVar3 = DAT_6b8b06ec;
    }
    DAT_6b8b06ec = pDVar3;
    if (pDVar7 == (DWORD *)0x0) goto LAB_6b820dab;
  }
  RtlFreeAnsiString(local_1c);
  RtlFreeAnsiString(local_c);
  RtlFreeAnsiString(local_14);
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pDVar5);
  pDVar5 = DAT_6b8b06ec;
LAB_6b820dab:
  lpStartupInfo->cb = *pDVar5;
  lpStartupInfo->lpReserved = (LPSTR)pDVar5[1];
  lpStartupInfo->lpDesktop = (LPSTR)pDVar5[2];
  lpStartupInfo->lpTitle = (LPSTR)pDVar5[3];
  lpStartupInfo->dwX = pDVar5[4];
  lpStartupInfo->dwY = pDVar5[5];
  lpStartupInfo->dwXSize = pDVar5[6];
  lpStartupInfo->dwYSize = pDVar5[7];
  lpStartupInfo->dwXCountChars = pDVar5[8];
  lpStartupInfo->dwYCountChars = pDVar5[9];
  lpStartupInfo->dwFillAttribute = pDVar5[10];
  uVar2 = pDVar5[0xb];
  lpStartupInfo->dwFlags = uVar2;
  lpStartupInfo->wShowWindow = *(WORD *)(pDVar5 + 0xc);
  lpStartupInfo->cbReserved2 = *(WORD *)((int)pDVar5 + 0x32);
  lpStartupInfo->lpReserved2 = (LPBYTE)pDVar5[0xd];
  if ((uVar2 & 0x700) == 0) {
    lpStartupInfo->hStdInput = (HANDLE)0xffffffff;
    lpStartupInfo->hStdOutput = (HANDLE)0xffffffff;
    lpStartupInfo->hStdError = (HANDLE)0xffffffff;
  }
  else {
    lpStartupInfo->hStdInput = (HANDLE)pDVar5[0xe];
    lpStartupInfo->hStdOutput = (HANDLE)pDVar5[0xf];
    lpStartupInfo->hStdError = (HANDLE)pDVar5[0x10];
  }
  return;
}



DWORD GetModuleFileNameA(HMODULE hModule,LPSTR lpFilename,DWORD nSize)

{
  DWORD DVar1;
  
                    // 0x20e30  633  GetModuleFileNameA
                    // WARNING: Could not recover jumptable at 0x6b820e36. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = GetModuleFileNameA(hModule,lpFilename,nSize);
  return DVar1;
}



HMODULE GetModuleHandleW(LPCWSTR lpModuleName)

{
  HMODULE pHVar1;
  
                    // 0x20e50  638  GetModuleHandleW
                    // WARNING: Could not recover jumptable at 0x6b820e56. Too many branches
                    // WARNING: Treating indirect jump as call
  pHVar1 = GetModuleHandleW(lpModuleName);
  return pHVar1;
}



int LCMapStringW(LCID Locale,DWORD dwMapFlags,LPCWSTR lpSrcStr,int cchSrc,LPWSTR lpDestStr,
                int cchDest)

{
  int iVar1;
  
                    // 0x20e70  951  LCMapStringW
                    // WARNING: Could not recover jumptable at 0x6b820e76. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = LCMapStringW(Locale,dwMapFlags,lpSrcStr,cchSrc,lpDestStr,cchDest);
  return iVar1;
}



ATOM GlobalDeleteAtom(ATOM nAtom)

{
  undefined4 uVar1;
  undefined2 in_stack_00000006;
  
                    // 0x20e90  821  GlobalDeleteAtom
  uVar1 = FUN_6b820ea3(0,_nAtom);
  return (ATOM)uVar1;
}



undefined4 __fastcall FUN_6b820ea3(int param_1,undefined4 param_2)

{
  int iVar1;
  int local_8;
  
  if ((ushort)param_2 < 0xc000) {
    return 0;
  }
  local_8 = param_1;
  if ((char)param_1 == '\0') {
    iVar1 = NtDeleteAtom(param_2);
  }
  else {
    iVar1 = FUN_6b81bb24(&local_8);
    if (iVar1 < 0) goto LAB_6b820ece;
    iVar1 = RtlDeleteAtomFromAtomTable(local_8,param_2);
  }
  if (-1 < iVar1) {
    return 0;
  }
LAB_6b820ece:
  BaseSetLastNTError(iVar1);
  return 0;
}



DWORD ExpandEnvironmentStringsW(LPCWSTR lpSrc,LPWSTR lpDst,DWORD nSize)

{
  DWORD DVar1;
  
                    // 0x20ee0  360  ExpandEnvironmentStringsW
                    // WARNING: Could not recover jumptable at 0x6b820ee6. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = ExpandEnvironmentStringsW(lpSrc,lpDst,nSize);
  return DVar1;
}



void Sleep(DWORD dwMilliseconds)

{
                    // WARNING: Could not recover jumptable at 0x6b820f00. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20f00  1411  Sleep
  Sleep(dwMilliseconds);
  return;
}



HANDLE CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes,SIZE_T dwStackSize,
                   LPTHREAD_START_ROUTINE lpStartAddress,LPVOID lpParameter,DWORD dwCreationFlags,
                   LPDWORD lpThreadId)

{
  HANDLE pvVar1;
  
                    // 0x20f10  249  CreateThread
  pvVar1 = CreateRemoteThreadEx
                     ((HANDLE)0xffffffff,lpThreadAttributes,dwStackSize,lpStartAddress,lpParameter,
                      dwCreationFlags & 0x10004,(LPPROC_THREAD_ATTRIBUTE_LIST)0x0,lpThreadId);
  return pvVar1;
}



void AddRefActCtxWorker(void)

{
                    // WARNING: Could not recover jumptable at 0x6b820f40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20f40  17  AddRefActCtxWorker
  RtlAddRefActivationContext();
  return;
}



BOOL FlushInstructionCache(HANDLE hProcess,LPCVOID lpBaseAddress,SIZE_T dwSize)

{
  BOOL BVar1;
  
                    // 0x20f50  422  FlushInstructionCache
                    // WARNING: Could not recover jumptable at 0x6b820f56. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = FlushInstructionCache(hProcess,lpBaseAddress,dwSize);
  return BVar1;
}



BOOL TlsFree(DWORD dwTlsIndex)

{
  BOOL BVar1;
  
                    // 0x20f70  1445  TlsFree
                    // WARNING: Could not recover jumptable at 0x6b820f76. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = TlsFree(dwTlsIndex);
  return BVar1;
}



// InitFn parameter of InitOnceExecuteOnce
// 

undefined4 __fastcall InitFn_6b820f80(undefined4 param_1)

{
  uint local_14 [2];
  uint local_c [2];
  
  FUN_6b820aec(0xfffffffc,param_1,local_14,local_c);
  return 1;
}



int __fastcall
FUN_6b820fa0(undefined4 *param_1,uint **param_2,uint param_3,undefined4 param_4,int param_5,
            uint param_6,uint param_7)

{
  int *piVar1;
  uint *puVar2;
  uint **ppuVar3;
  uint uVar4;
  undefined4 *puVar5;
  int iVar6;
  uint uVar7;
  undefined local_54 [24];
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  uint local_28;
  undefined4 local_24;
  uint **local_20;
  undefined4 *local_1c;
  uint local_18;
  uint local_14;
  int local_10;
  uint local_c;
  uint local_8;
  
  uVar4 = 0;
  iVar6 = 0;
  local_c = 0;
  local_14 = 0;
  local_18 = 0;
  uVar7 = 0;
  local_8 = 0x34;
  if ((param_3 & 6) != 0) {
    do {
      piVar1 = (int *)(iVar6 + param_5);
      uVar4 = uVar4 + 1;
      iVar6 = iVar6 + *piVar1;
      uVar7 = uVar7 + piVar1[1];
    } while (*piVar1 != 0);
    if ((param_3 & 2) != 0) {
      local_8 = uVar4 * 0x22c + 0x34;
    }
    local_c = uVar4;
    if ((param_3 & 4) != 0) {
      local_8 = local_8 + uVar7 * 0x1c;
    }
  }
  uVar4 = local_8;
  local_20 = param_2;
  local_1c = param_1;
  if ((param_3 & 8) == 0) {
LAB_6b820fdb:
    uVar4 = local_8;
    if ((param_3 & 1) != 0) {
      local_14 = param_7;
      iVar6 = FUN_6b850b02(&local_10,(int)((ulonglong)param_7 * 0x10),
                           (int)((ulonglong)param_7 * 0x10 >> 0x20));
      if ((iVar6 < 0) || (uVar4 = FUN_6b839286(uVar4,local_10,&local_8), (int)uVar4 < 0))
      goto LAB_6b82f7d2;
    }
    local_28 = local_8;
    if ((int)param_3 < 0) {
      local_38 = 0;
      puVar5 = &local_3c;
      local_3c = 0xc;
      local_34 = 1;
    }
    else {
      puVar5 = (undefined4 *)0x0;
    }
    iVar6 = BaseFormatObjectAttributes(local_54,puVar5,0,&local_10);
    puVar5 = local_1c;
    if (-1 < iVar6) {
      local_24 = 0;
      iVar6 = NtCreateSection(local_1c,0xf0007,local_10,&local_28,4,0x8000000,0);
      ppuVar3 = local_20;
      if (-1 < iVar6) {
        local_30 = 0;
        local_2c = 0;
        local_8 = 0;
        iVar6 = NtMapViewOfSection(*puVar5,0xffffffff,local_20,0,0,&local_30,&local_8,1,0,4);
        if (-1 < iVar6) {
          puVar2 = *ppuVar3;
          puVar2[1] = local_c;
          *puVar2 = local_14;
          puVar2[2] = local_18;
          puVar2[3] = uVar7;
          iVar6 = 0;
        }
      }
    }
  }
  else {
    local_18 = param_6;
    iVar6 = FUN_6b850b02(&local_10,(int)((ulonglong)param_6 * 0x428),
                         (int)((ulonglong)param_6 * 0x428 >> 0x20));
    if ((-1 < iVar6) && (uVar4 = FUN_6b839286(uVar4,local_10,&local_8), -1 < (int)uVar4))
    goto LAB_6b820fdb;
LAB_6b82f7d2:
    iVar6 = -0x3ffffe8d;
  }
  return iVar6;
}



UINT GetSystemDirectoryW(LPWSTR lpBuffer,UINT uSize)

{
  ushort uVar1;
  undefined2 extraout_var;
  
                    // 0x210b0  742  GetSystemDirectoryW
  uVar1 = FUN_6b8210c4(lpBuffer,uSize);
  return CONCAT22(extraout_var,uVar1);
}



ushort __fastcall FUN_6b8210c4(void *param_1,int param_2)

{
  ushort uVar1;
  int iVar2;
  
  iVar2 = KernelBaseGetGlobalData();
  uVar1 = *(ushort *)(iVar2 + 0x10);
  if ((uint)(param_2 * 2) < uVar1 + 2) {
    uVar1 = (uVar1 >> 1) + 1;
  }
  else {
    memcpy(param_1,*(void **)(iVar2 + 0x14),(uint)uVar1);
    *(undefined2 *)((int)param_1 + (uint)(*(ushort *)(iVar2 + 0x10) >> 1) * 2) = 0;
    uVar1 = *(ushort *)(iVar2 + 0x10) >> 1;
  }
  return uVar1;
}



BOOL SystemTimeToFileTime(SYSTEMTIME *lpSystemTime,LPFILETIME lpFileTime)

{
  BOOL BVar1;
  
                    // 0x21120  1422  SystemTimeToFileTime
                    // WARNING: Could not recover jumptable at 0x6b821126. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SystemTimeToFileTime(lpSystemTime,lpFileTime);
  return BVar1;
}



DWORD TlsAlloc(void)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b821140. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21140  1444  TlsAlloc
  DVar1 = TlsAlloc();
  return DVar1;
}



undefined4 TermsrvGetWindowsDirectoryW(undefined4 param_1,undefined4 param_2)

{
  code *pcVar1;
  undefined4 uVar2;
  
                    // 0x21150  1435  TermsrvGetWindowsDirectoryW
  pcVar1 = DAT_6b8b08fc;
  if (DAT_6b8b08fc == (code *)0x0) {
    uVar2 = 0;
  }
  else {
    _guard_check_icall();
    uVar2 = (*pcVar1)(param_1,param_2);
  }
  return uVar2;
}



LPVOID MapViewOfFileEx(HANDLE hFileMappingObject,DWORD dwDesiredAccess,DWORD dwFileOffsetHigh,
                      DWORD dwFileOffsetLow,SIZE_T dwNumberOfBytesToMap,LPVOID lpBaseAddress)

{
  LPVOID pvVar1;
  
                    // 0x21170  997  MapViewOfFileEx
                    // WARNING: Could not recover jumptable at 0x6b821176. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = MapViewOfFileEx(hFileMappingObject,dwDesiredAccess,dwFileOffsetHigh,dwFileOffsetLow,
                           dwNumberOfBytesToMap,lpBaseAddress);
  return pvVar1;
}



undefined4 TermsrvDeleteValue(undefined4 param_1,undefined4 param_2)

{
  code *pcVar1;
  undefined4 uVar2;
  
                    // 0x21190  1432  TermsrvDeleteValue
  pcVar1 = DAT_6b8b08e8;
  if (DAT_6b8b08e8 == (code *)0x0) {
    uVar2 = 0;
  }
  else {
    _guard_check_icall();
    uVar2 = (*pcVar1)(param_1,param_2);
  }
  return uVar2;
}



PTP_WAIT CreateThreadpoolWait(PTP_WAIT_CALLBACK pfnwa,PVOID pv,PTP_CALLBACK_ENVIRON pcbe)

{
  int iVar1;
  PTP_WAIT local_8;
  
                    // 0x211b0  254  CreateThreadpoolWait
  iVar1 = TpAllocWait(&local_8,pfnwa,pv,pcbe);
  if (iVar1 < 0) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
    local_8 = (PTP_WAIT)0x0;
  }
  return local_8;
}



BOOL FlsSetValue(DWORD dwFlsIndex,PVOID lpFlsData)

{
  BOOL BVar1;
  
                    // 0x211e0  419  FlsSetValue
                    // WARNING: Could not recover jumptable at 0x6b8211e6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = FlsSetValue(dwFlsIndex,lpFlsData);
  return BVar1;
}



BOOL FreeResource(HGLOBAL hResData)

{
  BOOL BVar1;
  
                    // 0x21200  437  FreeResource
                    // WARNING: Could not recover jumptable at 0x6b821206. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = FreeResource(hResData);
  return BVar1;
}



// WARNING: Could not reconcile some variable overlaps

void BasepGetComputerNameFromNtPath(ushort *param_1,int param_2,LPWSTR param_3,uint *param_4)

{
  short sVar1;
  ushort uVar2;
  uint *puVar3;
  LPWSTR pWVar4;
  char cVar5;
  DWORD DVar6;
  wchar_t *pwVar7;
  BOOL BVar8;
  int iVar9;
  uint uVar10;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  uint extraout_EDX_03;
  uint extraout_EDX_04;
  uint extraout_EDX_05;
  uint extraout_EDX_06;
  short *psVar11;
  uint uVar12;
  int local_69c;
  undefined2 local_698;
  undefined2 local_696;
  wchar_t *local_694;
  uint *local_690;
  LPWSTR local_68c;
  ushort local_688;
  undefined2 local_686;
  wchar_t *local_684;
  undefined2 local_680;
  undefined2 local_67e;
  wchar_t *local_67c;
  undefined local_678 [8];
  undefined4 local_670;
  undefined4 local_66c;
  undefined *local_668;
  undefined4 local_664;
  undefined4 local_660;
  undefined4 local_65c;
  undefined local_658 [8];
  uint local_650;
  undefined2 local_64c;
  WCHAR local_648 [26];
  short local_614;
  short local_612;
  wchar_t local_610 [236];
  short local_438 [2];
  wchar_t local_434 [262];
  uint local_228;
  wchar_t local_222 [267];
  uint local_c;
  
                    // 0x21220  91  BasepGetComputerNameFromNtPath
  local_c = DAT_6b8b0140 ^ (uint)&local_69c;
  local_69c = param_2;
  local_68c = param_3;
  local_690 = param_4;
  local_650 = 0x3a0041;
  local_64c = 0;
  local_688 = 0x10;
  local_686 = 0x12;
  local_680 = 8;
  local_67e = 10;
  local_684 = L"\\??\\UNC\\";
  local_67c = L"\\??\\";
  RtlInitUnicodeString(&local_698,0);
  cVar5 = RtlPrefixString(&local_688,param_1,1);
  if (cVar5 == '\0') {
    cVar5 = RtlPrefixString(&local_680,param_1,1);
    uVar12 = extraout_EDX_00;
    if ((cVar5 == '\0') || (*(short *)(*(int *)(param_1 + 2) + 10) != 0x3a)) goto LAB_6b82136d;
    uVar2 = *(ushort *)(*(int *)(param_1 + 2) + 8);
    uVar12 = local_650 & 0xffff0000;
    local_650 = uVar12 | uVar2;
    if ((0x60 < uVar2) && (uVar2 < 0x7b)) {
      local_650 = uVar12 | (ushort)(uVar2 - 0x20);
    }
    DVar6 = QueryDosDeviceW((LPCWSTR)&local_650,local_648,0x105);
    if (DVar6 != 0) {
      pwVar7 = wcsstr(local_648,L"\\Device\\LanmanRedirector\\;");
      if (((local_648 == pwVar7) && ((short)local_650 == local_614)) && (local_612 == 0x3a)) {
        local_694 = wcschr(local_610,L'\\');
        local_228 = 0;
        if (local_694 == (wchar_t *)0x0) goto LAB_6b82f852;
        local_694 = local_694 + 1;
        local_228 = (0x105 - ((int)local_694 - (int)local_648 >> 1)) * 2;
        goto LAB_6b82fa43;
      }
      pwVar7 = wcsstr(local_648,L"\\Device\\Harddisk");
      if (local_648 != pwVar7) {
        pwVar7 = wcsstr(local_648,L"\\Device\\CdRom");
        if (local_648 != pwVar7) {
          pwVar7 = wcsstr(local_648,L"\\Device\\Floppy");
          if (local_648 != pwVar7) {
            pwVar7 = wcsstr(local_648,L"\\Device\\WinDfs\\");
            uVar12 = extraout_EDX_04;
            if (local_648 != pwVar7) goto LAB_6b82136d;
            iVar9 = NtQueryInformationFile(local_69c,local_678,&local_228,0x218,9);
            if (-1 < iVar9) {
              local_694 = local_222;
              goto LAB_6b82f852;
            }
            goto LAB_6b82f9ee;
          }
        }
      }
      BVar8 = GetComputerNameW(local_68c,local_690);
      uVar12 = extraout_EDX_01;
      if (BVar8 != 0) goto LAB_6b82136d;
    }
    GetLastError();
    uVar12 = extraout_EDX_02;
    goto LAB_6b82136d;
  }
  uVar12 = extraout_EDX;
  if (*param_1 <= local_688) goto LAB_6b82136d;
  local_228 = (uint)*param_1 - (uint)local_688;
  local_694 = (wchar_t *)(*(int *)(param_1 + 2) + (uint)(local_688 >> 1) * 2);
LAB_6b82f852:
  if (local_69c != -1) {
    local_69c = -1;
    pwVar7 = local_694 + -1;
    RtlInitUnicodeString(local_658,L"\\Dfs");
    local_670 = 0x18;
    local_668 = local_658;
    local_66c = 0;
    local_664 = 0x40;
    local_660 = 0;
    local_65c = 0;
    iVar9 = NtCreateFile(&local_69c,0x100000,&local_670,local_678,0,0x80,7,3,0xa0,0,0);
    if (iVar9 < 0) {
LAB_6b82f9ee:
      RtlNtStatusToDosError(iVar9);
      uVar12 = extraout_EDX_05;
      goto LAB_6b82136d;
    }
    if (*pwVar7 != L'\\') {
      NtClose(local_69c);
      uVar12 = extraout_EDX_03;
      goto LAB_6b82136d;
    }
    iVar9 = NtFsControlFile(local_69c,0,0,0,local_678,0x600c0,pwVar7,local_228 + 2,local_438,0x20a);
    NtClose(local_69c);
    if (iVar9 < 0) {
      if (iVar9 != -0x3fffffcc) goto LAB_6b82f9ee;
    }
    else if (local_438[0] != 0) {
      psVar11 = local_438;
      uVar12 = 0;
      do {
        sVar1 = *psVar11;
        psVar11 = psVar11 + 1;
      } while (sVar1 != 0);
      local_228 = ((int)psVar11 - (int)(local_438 + 1) >> 1) * 2;
      if (((local_228 < 6) || (uVar12 = 0x5c, local_438[0] != 0x5c)) || (local_438[1] != 0x5c))
      goto LAB_6b82136d;
      local_694 = local_434;
      local_228 = local_228 - 4;
    }
  }
LAB_6b82fa43:
  pWVar4 = local_68c;
  puVar3 = local_690;
  pwVar7 = local_694;
  if (local_228 != 0) {
    do {
      if (*pwVar7 == L'\\') break;
      uVar12 = 0x2e;
      if (*pwVar7 == L'.') goto LAB_6b82136d;
      pwVar7 = pwVar7 + 1;
    } while ((uint)((int)pwVar7 - (int)local_694) < local_228);
  }
  uVar10 = (int)pwVar7 - (int)local_694;
  uVar12 = uVar10 & 0xffff;
  local_698 = (undefined2)uVar10;
  local_696 = local_698;
  if (((uVar12 < local_228) && (uVar12 < 0x1f)) && (uVar12 + 2 <= *local_690 * 2)) {
    memcpy(local_68c,local_694,uVar12);
    *puVar3 = uVar12 >> 1;
    *(undefined2 *)((int)pWVar4 + (uVar10 & 0xfffe)) = 0;
    uVar12 = extraout_EDX_06;
  }
LAB_6b82136d:
  FUN_6b8224af(local_c ^ (uint)&local_69c,uVar12);
  return;
}



BOOL GetComputerNameW(LPWSTR lpBuffer,LPDWORD nSize)

{
  short *psVar1;
  WCHAR WVar2;
  short sVar3;
  DWORD DVar4;
  short *psVar5;
  int iVar6;
  LPWSTR pWVar7;
  BOOL BVar8;
  short *psVar9;
  int in_FS_OFFSET;
  bool bVar10;
  size_t _Size;
  LPDWORD pDVar11;
  int local_38;
  int local_34;
  code *local_30;
  short *psStack44;
  undefined local_28 [8];
  undefined4 uStack32;
  undefined4 uStack28;
  undefined *puStack24;
  undefined4 uStack20;
  undefined4 uStack16;
  undefined4 uStack12;
  
                    // 0x213a0  485  GetComputerNameW
  BVar8 = 0;
  local_38 = 0;
  local_34 = 0;
  local_30 = (code *)GetEnvironmentVariableW(L"_CLUSTER_NETWORK_NAME_",lpBuffer,*nSize);
  if (local_30 != (code *)0x0) {
    bVar10 = (code *)*nSize < local_30;
    if (bVar10) {
      RtlSetLastWin32Error(0x6f);
    }
    *nSize = (DWORD)local_30;
    return (uint)!bVar10;
  }
  iVar6 = KernelBaseGetGlobalData();
  if (*(int *)(iVar6 + 0x54) != 0) {
    iVar6 = KernelBaseGetGlobalData();
    DVar4 = *(DWORD *)(iVar6 + 0x58);
    if (DVar4 + 1 <= *nSize) {
      *nSize = DVar4;
      _Size = DVar4 * 2 + 2;
      iVar6 = KernelBaseGetGlobalData();
      memcpy(lpBuffer,*(void **)(iVar6 + 0x54),_Size);
      return 1;
    }
    *nSize = DVar4 + 1;
    RtlSetLastWin32Error(0x6f);
    return 0;
  }
  local_30 = DAT_6b8b09ec;
  if (DAT_6b8b09ec == (code *)0x0) {
LAB_6b82fb72:
    RtlInitUnicodeString
              (local_28,L"\\Registry\\Machine\\System\\CurrentControlSet\\Control\\ComputerName");
    puStack24 = local_28;
    uStack32 = 0x18;
    uStack28 = 0;
    uStack20 = 0x40;
    uStack16 = 0;
    uStack12 = 0;
    iVar6 = NtOpenKey(&local_38,0x20019,&uStack32);
    if (iVar6 == -0x3fffffcc) {
      if (lpBuffer != (LPWSTR)0x0) {
LAB_6b82fbc6:
        *lpBuffer = L'\0';
      }
      *nSize = 0;
    }
    else {
      if (iVar6 < 0) {
LAB_6b82fd8b:
        BaseSetLastNTError(iVar6);
        goto LAB_6b82fd73;
      }
      iVar6 = FUN_6b853047(local_38,L"ActiveComputerName",lpBuffer,nSize);
      if (iVar6 == -0x7ffffffb) {
        RtlSetLastWin32Error(0x6f);
        goto LAB_6b82fd73;
      }
      if (iVar6 < 0) {
        iVar6 = FUN_6b853047(local_38,L"ComputerName",lpBuffer,nSize);
        if (iVar6 == -0x3fffffcc) goto LAB_6b82fbc6;
        if ((iVar6 < 0) ||
           ((iVar6 = FUN_6b873522(lpBuffer,nSize), iVar6 < 0 && (iVar6 != -0x3fffffde))))
        goto LAB_6b82fd8b;
      }
    }
  }
  else {
    pWVar7 = lpBuffer;
    pDVar11 = nSize;
    _guard_check_icall();
    iVar6 = (*local_30)(pWVar7,pDVar11);
    if (iVar6 == 0x4d5) goto LAB_6b82fb72;
    if (iVar6 == 0x6f) goto LAB_6b82fd73;
  }
  if ((lpBuffer != (LPWSTR)0x0) && (*nSize != 0)) {
    pWVar7 = lpBuffer;
    do {
      WVar2 = *pWVar7;
      pWVar7 = pWVar7 + 1;
    } while (WVar2 != L'\0');
    *nSize = (int)pWVar7 - (int)(lpBuffer + 1) >> 1;
  }
  if (DAT_6b8b0244 != 0) {
    iVar6 = KernelBaseGetGlobalData();
    RtlEnterCriticalSection(iVar6 + 0x5c);
    local_30 = (code *)&_Src_00000004;
    iVar6 = FUN_6b873a59(0,(undefined *)L"\\Registry\\Machine\\System\\Setup",L"OOBEInProgress",
                         &local_34,(uint *)&local_30);
    if ((iVar6 < 0) || (local_34 == 0)) {
      local_30 = (code *)&_Src_00000004;
      iVar6 = FUN_6b873a59(0,(undefined *)L"\\Registry\\Machine\\System\\Setup",
                           L"SystemSetupInProgress",&local_34,(uint *)&local_30);
    }
    if (-1 < iVar6) {
      DAT_6b8b0244 = ~-(uint)(local_34 != 0) & DAT_6b8b0244;
    }
    if ((DAT_6b8b0244 != 0) && (iVar6 = KernelBaseGetGlobalData(), *(int *)(iVar6 + 0x54) == 0)) {
      psStack44 = (short *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,
                                           *nSize * 2 + 2);
      if (psStack44 == (short *)0x0) {
        DAT_6b8b0244 = 0;
      }
      else {
        memcpy(psStack44,lpBuffer,*nSize * 2);
        psVar5 = psStack44;
        psStack44[*nSize] = 0;
        psVar1 = psStack44 + 1;
        psVar9 = psStack44;
        do {
          sVar3 = *psVar9;
          psVar9 = psVar9 + 1;
        } while (sVar3 != 0);
        iVar6 = KernelBaseGetGlobalData();
        *(int *)(iVar6 + 0x58) = (int)psVar9 - (int)psVar1 >> 1;
        iVar6 = KernelBaseGetGlobalData();
        *(short **)(iVar6 + 0x54) = psVar5;
      }
    }
    iVar6 = KernelBaseGetGlobalData();
    RtlLeaveCriticalSection(iVar6 + 0x5c);
  }
  BVar8 = 1;
LAB_6b82fd73:
  if (local_38 != 0) {
    NtClose(local_38);
  }
  return BVar8;
}



BOOL GetSystemPowerStatus(LPSYSTEM_POWER_STATUS lpSystemPowerStatus)

{
  byte bVar1;
  byte bVar2;
  BOOL BVar3;
  int iVar4;
  uint uVar5;
  uint extraout_EDX;
  uint uVar6;
  undefined8 uVar7;
  byte local_38 [8];
  undefined local_30 [4];
  undefined4 local_2c;
  char local_28;
  char local_27;
  char local_26;
  uint local_20;
  uint local_1c;
  DWORD local_14;
  uint local_8;
  
                    // 0x21440  746  GetSystemPowerStatus
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  uVar7 = NtPowerInformation(5,0,0,&local_28,0x20);
  uVar6 = (uint)((ulonglong)uVar7 >> 0x20);
  iVar4 = (int)uVar7;
  if (-1 < iVar4) {
    *(undefined4 *)lpSystemPowerStatus = 0;
    lpSystemPowerStatus->BatteryLifeTime = 0;
    lpSystemPowerStatus->BatteryFullLifeTime = 0;
    lpSystemPowerStatus->ACLineStatus = '\x01';
    if (local_27 != '\0') {
      lpSystemPowerStatus->ACLineStatus =
           lpSystemPowerStatus->ACLineStatus & (local_28 == '\0') - 1U;
    }
    if (local_26 != '\0') {
      lpSystemPowerStatus->BatteryFlag = lpSystemPowerStatus->BatteryFlag | 8;
    }
    if (local_27 == '\0') {
      lpSystemPowerStatus->BatteryFlag = lpSystemPowerStatus->BatteryFlag | 0x80;
    }
    lpSystemPowerStatus->BatteryLifePercent = 0xff;
    if (local_20 != 0) {
      if (local_20 < local_1c) {
        bVar2 = 100;
      }
      else {
        uVar5 = local_1c * 100 + (local_20 >> 1);
        uVar6 = uVar5 % local_20;
        bVar2 = (byte)(uVar5 / local_20);
      }
      lpSystemPowerStatus->BatteryLifePercent = bVar2;
      if (bVar2 < 0x43) {
        if (bVar2 < 0x21) {
          bVar1 = lpSystemPowerStatus->BatteryFlag;
          lpSystemPowerStatus->BatteryFlag = bVar1 | 2;
          if (bVar2 < 5) {
            lpSystemPowerStatus->BatteryFlag = bVar1 | 6;
          }
        }
      }
      else {
        lpSystemPowerStatus->BatteryFlag = lpSystemPowerStatus->BatteryFlag | 1;
      }
    }
    lpSystemPowerStatus->BatteryLifeTime = 0xffffffff;
    lpSystemPowerStatus->BatteryFullLifeTime = 0xffffffff;
    if (local_14 != 0) {
      lpSystemPowerStatus->BatteryLifeTime = local_14;
    }
    if (local_27 == '\0') goto LAB_6b8214c0;
    local_2c = 8;
    uVar7 = NtQueryWnfStateData(&DAT_6b886e60,0,0,local_30,local_38,&local_2c);
    uVar6 = (uint)((ulonglong)uVar7 >> 0x20);
    iVar4 = (int)uVar7;
    if (-1 < iVar4) {
      if ((local_38[0] & 2) != 0) {
        lpSystemPowerStatus->Reserved1 = '\x01';
      }
      goto LAB_6b8214c0;
    }
  }
  BaseSetLastNTError(iVar4);
  uVar6 = extraout_EDX;
LAB_6b8214c0:
  BVar3 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar6);
  return BVar3;
}



undefined4
TermsrvCreateRegEntry
          (undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
          undefined4 param_5)

{
  code *pcVar1;
  undefined4 uVar2;
  
                    // 0x214e0  1430  TermsrvCreateRegEntry
  pcVar1 = DAT_6b8b08d8;
  if (DAT_6b8b08d8 == (code *)0x0) {
    uVar2 = 0;
  }
  else {
    _guard_check_icall();
    uVar2 = (*pcVar1)(param_1,param_2,param_3,param_4,param_5);
  }
  return uVar2;
}



void FUN_6b821500(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
                 undefined4 param_5,undefined *param_6)

{
  if (param_1 == 1) {
    NtUnmapViewOfSection(0xffffffff,param_3);
  }
  else {
    *param_6 = 1;
  }
  return;
}



BOOL GetCPInfo(UINT CodePage,LPCPINFO lpCPInfo)

{
  BOOL BVar1;
  
                    // 0x21530  455  GetCPInfo
                    // WARNING: Could not recover jumptable at 0x6b821536. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetCPInfo(CodePage,lpCPInfo);
  return BVar1;
}



void GetStartupInfoW(LPSTARTUPINFOW lpStartupInfo)

{
                    // WARNING: Could not recover jumptable at 0x6b821550. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21550  726  GetStartupInfoW
  GetStartupInfoW(lpStartupInfo);
  return;
}



undefined4 TermsrvDeleteKey(undefined4 param_1)

{
  code *pcVar1;
  undefined4 uVar2;
  
                    // 0x21560  1431  TermsrvDeleteKey
  pcVar1 = DAT_6b8b08e4;
  if (DAT_6b8b08e4 == (code *)0x0) {
    uVar2 = 0;
  }
  else {
    _guard_check_icall();
    uVar2 = (*pcVar1)(param_1);
  }
  return uVar2;
}



int __fastcall FUN_6b82157b(undefined4 *param_1,void *param_2)

{
  short sVar1;
  int iVar2;
  undefined4 *local_8;
  
  iVar2 = 0;
  *param_1 = 0;
  param_1[1] = 0;
  if (param_2 != (void *)0x0) {
    local_8 = param_1;
    iVar2 = FUN_6b8215cb(param_2,(int *)&local_8);
    if (-1 < iVar2) {
      if (param_1 == (undefined4 *)0x0) {
        iVar2 = -0x3ffffff3;
      }
      else {
        param_1[1] = param_2;
        sVar1 = (short)local_8 * 2;
        *(short *)param_1 = sVar1;
        *(short *)((int)param_1 + 2) = sVar1 + 2;
      }
    }
  }
  return iVar2;
}



int __thiscall FUN_6b8215cb(void *this,int *param_1)

{
  int iVar1;
  
  iVar1 = 0x7fff;
  do {
                    // WARNING: Load size is inaccurate
    if (*this == 0) break;
    this = (void *)((int)this + 2);
    iVar1 = iVar1 + -1;
  } while (iVar1 != 0);
  if (param_1 != (int *)0x0) {
    if (iVar1 == 0) {
      *param_1 = 0;
    }
    else {
      *param_1 = 0x7fff - iVar1;
    }
  }
  return (-(uint)(iVar1 != 0) & 0x3ffffff3) + 0xc000000d;
}



HMODULE LoadLibraryExA(LPCSTR lpLibFileName,HANDLE hFile,DWORD dwFlags)

{
  HMODULE pHVar1;
  
                    // 0x21620  968  LoadLibraryExA
                    // WARNING: Could not recover jumptable at 0x6b821626. Too many branches
                    // WARNING: Treating indirect jump as call
  pHVar1 = LoadLibraryExA(lpLibFileName,hFile,dwFlags);
  return pHVar1;
}



BOOL GetModuleHandleExW(DWORD dwFlags,LPCWSTR lpModuleName,HMODULE *phModule)

{
  BOOL BVar1;
  
                    // 0x21640  637  GetModuleHandleExW
                    // WARNING: Could not recover jumptable at 0x6b821646. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetModuleHandleExW(dwFlags,lpModuleName,phModule);
  return BVar1;
}



void GetSystemTime(LPSYSTEMTIME lpSystemTime)

{
                    // WARNING: Could not recover jumptable at 0x6b821660. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21660  749  GetSystemTime
  GetSystemTime(lpSystemTime);
  return;
}



BOOL GetProcessIoCounters(HANDLE hProcess,PIO_COUNTERS lpIoCounters)

{
  int iVar1;
  
                    // 0x21670  703  GetProcessIoCounters
  iVar1 = NtQueryInformationProcess(hProcess,2,lpIoCounters,0x30,0);
  if (iVar1 < 0) {
    BaseSetLastNTError(iVar1);
  }
  return (uint)(iVar1 >= 0);
}



BOOL IsValidCodePage(UINT CodePage)

{
  BOOL BVar1;
  
                    // 0x216a0  913  IsValidCodePage
                    // WARNING: Could not recover jumptable at 0x6b8216a6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = IsValidCodePage(CodePage);
  return BVar1;
}



HMODULE LoadLibraryW(LPCWSTR lpLibFileName)

{
  HMODULE pHVar1;
  
                    // 0x216c0  970  LoadLibraryW
                    // WARNING: Could not recover jumptable at 0x6b8216c6. Too many branches
                    // WARNING: Treating indirect jump as call
  pHVar1 = LoadLibraryW(lpLibFileName);
  return pHVar1;
}



BOOL QueryPerformanceFrequency(LARGE_INTEGER *lpFrequency)

{
  BOOL BVar1;
  
                    // 0x216e0  1106  QueryPerformanceFrequency
                    // WARNING: Could not recover jumptable at 0x6b8216e6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = QueryPerformanceFrequency(lpFrequency);
  return BVar1;
}



HANDLE GetStdHandle(DWORD nStdHandle)

{
  HANDLE pvVar1;
  
                    // 0x21700  728  GetStdHandle
                    // WARNING: Could not recover jumptable at 0x6b821706. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = GetStdHandle(nStdHandle);
  return pvVar1;
}



LPTOP_LEVEL_EXCEPTION_FILTER
SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)

{
  LPTOP_LEVEL_EXCEPTION_FILTER pPVar1;
  
                    // 0x21720  1395  SetUnhandledExceptionFilter
                    // WARNING: Could not recover jumptable at 0x6b821726. Too many branches
                    // WARNING: Treating indirect jump as call
  pPVar1 = SetUnhandledExceptionFilter(lpTopLevelExceptionFilter);
  return pPVar1;
}



void RegisterWaitForInputIdle(undefined4 param_1)

{
  DAT_6b8b0864 = param_1;
                    // 0x21740  1196  RegisterWaitForInputIdle
  return;
}



BOOL GetVersionExA(LPOSVERSIONINFOA lpVersionInformation)

{
  BOOL BVar1;
  
                    // 0x21760  800  GetVersionExA
                    // WARNING: Could not recover jumptable at 0x6b821766. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetVersionExA(lpVersionInformation);
  return BVar1;
}



BOOL HeapSetInformation(HANDLE HeapHandle,HEAP_INFORMATION_CLASS HeapInformationClass,
                       PVOID HeapInformation,SIZE_T HeapInformationLength)

{
  BOOL BVar1;
  
                    // 0x21780  851  HeapSetInformation
                    // WARNING: Could not recover jumptable at 0x6b821786. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = HeapSetInformation(HeapHandle,HeapInformationClass,HeapInformation,HeapInformationLength);
  return BVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

int __fastcall
FUN_6b82178c(uint param_1,undefined4 param_2,int *param_3,int *param_4,undefined4 *param_5,
            undefined4 *param_6,int *param_7,undefined4 *param_8,undefined4 *param_9)

{
  int iVar1;
  int iVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 local_2c;
  uint local_28;
  uint local_24;
  uint local_20 [3];
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b891d30;
  uStack12 = 0x6b821798;
  iVar2 = 0;
  local_20[0] = 0x10000;
  local_28 = 0x10000;
  *param_3 = 0;
  *param_4 = 0;
  *param_7 = 0;
  local_2c = param_2;
  local_24 = param_1;
  if ((param_1 & 6) != 0) {
    while( true ) {
      local_8 = (undefined *)0x0;
      local_28 = local_20[0];
      iVar2 = NtAllocateVirtualMemory(0xffffffff,param_3,0,&local_28,0x1000,4);
      local_8 = (undefined *)0xfffffffe;
      if (iVar2 < 0) break;
      local_20[0] = local_28;
      iVar2 = NtQuerySystemInformation(5,*param_3,local_28,local_20);
      if (iVar2 != -0x3ffffffc) break;
      NtFreeVirtualMemory(0xffffffff,param_3,&local_28,0x8000);
      *param_3 = 0;
      local_20[0] = local_20[0] + 0x1fff & 0xffffe000;
    }
  }
  if (((local_24 & 0x18) != 0) && (-1 < iVar2)) {
    iVar1 = RtlCreateQueryDebugBuffer(0,0);
    *param_4 = iVar1;
    if (iVar1 == 0) {
      iVar2 = -0x3fffffff;
    }
    if (-1 < iVar2) {
      *param_5 = *(undefined4 *)(*param_4 + 4);
      *param_6 = *(undefined4 *)(*param_4 + 0x2c);
      iVar2 = RtlQueryProcessDebugInformation
                        (local_2c,(local_24 & 0x10 | 0xe0000000) << 2 | local_24 >> 3 & 1,*param_4);
    }
  }
  if ((local_24 & 1) == 0) {
LAB_6b8217d4:
    if (-1 < iVar2) goto LAB_6b8217dc;
  }
  else {
    if (-1 < iVar2) {
      iVar1 = RtlCreateQueryDebugBuffer(0,0);
      *param_7 = iVar1;
      if (iVar1 == 0) {
        iVar2 = -0x3fffffff;
      }
    }
    if (-1 < iVar2) {
      *param_8 = *(undefined4 *)(*param_7 + 4);
      *param_9 = *(undefined4 *)(*param_7 + 0x2c);
      iVar2 = RtlQueryProcessDebugInformation(local_2c,4,*param_7);
      goto LAB_6b8217d4;
    }
  }
  if (*param_3 != 0) {
    local_2c = 0;
    NtFreeVirtualMemory(0xffffffff,param_3,&local_2c,0x8000);
    *param_3 = 0;
  }
  if (*param_4 != 0) {
    RtlDestroyQueryDebugBuffer(*param_4);
    *param_4 = 0;
  }
  if (*param_7 != 0) {
    RtlDestroyQueryDebugBuffer(*param_7);
    *param_7 = 0;
  }
LAB_6b8217dc:
  *in_FS_OFFSET = local_14;
  return iVar2;
}



BOOL IsValidLocale(LCID Locale,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // 0x21880  915  IsValidLocale
                    // WARNING: Could not recover jumptable at 0x6b821886. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = IsValidLocale(Locale,dwFlags);
  return BVar1;
}



BOOL GetVersionExW(LPOSVERSIONINFOW lpVersionInformation)

{
  BOOL BVar1;
  
                    // 0x218a0  801  GetVersionExW
                    // WARNING: Could not recover jumptable at 0x6b8218a6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetVersionExW(lpVersionInformation);
  return BVar1;
}



PTP_WORK CreateThreadpoolWork(PTP_WORK_CALLBACK pfnwk,PVOID pv,PTP_CALLBACK_ENVIRON pcbe)

{
  int iVar1;
  PTP_WORK local_8;
  
                    // 0x218c0  255  CreateThreadpoolWork
  iVar1 = TpAllocWork(&local_8,pfnwk,pv,pcbe);
  if (iVar1 < 0) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
    local_8 = (PTP_WORK)0x0;
  }
  return local_8;
}



DWORD ResumeThread(HANDLE hThread)

{
  DWORD DVar1;
  
                    // 0x218f0  1233  ResumeThread
                    // WARNING: Could not recover jumptable at 0x6b8218f6. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = ResumeThread(hThread);
  return DVar1;
}



void GetSystemInfo(LPSYSTEM_INFO lpSystemInfo)

{
                    // WARNING: Could not recover jumptable at 0x6b821910. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21910  745  GetSystemInfo
  GetSystemInfo(lpSystemInfo);
  return;
}



LANGID GetSystemDefaultUILanguage(void)

{
  LANGID LVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b821920. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21920  740  GetSystemDefaultUILanguage
  LVar1 = GetSystemDefaultUILanguage();
  return LVar1;
}



BOOL DisableThreadLibraryCalls(HMODULE hLibModule)

{
  BOOL BVar1;
  
                    // 0x21930  292  DisableThreadLibraryCalls
                    // WARNING: Could not recover jumptable at 0x6b821936. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = DisableThreadLibraryCalls(hLibModule);
  return BVar1;
}



undefined4 TermsrvOpenUserClasses(undefined4 param_1,undefined4 param_2)

{
  code *pcVar1;
  undefined4 uVar2;
  
                    // 0x21950  1437  TermsrvOpenUserClasses
  pcVar1 = DAT_6b8b08f4;
  if (DAT_6b8b08f4 == (code *)0x0) {
    uVar2 = 0;
  }
  else {
    _guard_check_icall();
    uVar2 = (*pcVar1)(param_1,param_2);
  }
  return uVar2;
}



DWORD GetVersion(void)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b821970. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21970  799  GetVersion
  DVar1 = GetVersion();
  return DVar1;
}



// WARNING: Function: __SEH_prolog4_GS replaced with injection: SEH_prolog4

undefined4
BasepSetFileEncryptionCompression
          (undefined4 param_1,undefined4 *param_2,undefined4 param_3,FARPROC param_4,
          undefined4 param_5,uint param_6,uint param_7,uint param_8)

{
  DWORD DVar1;
  int iVar2;
  uint *puVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  undefined4 *puVar7;
  undefined4 uVar8;
  undefined4 *in_FS_OFFSET;
  bool bVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  uint local_80;
  undefined4 local_7c;
  HMODULE local_78;
  uint local_74;
  undefined4 local_70;
  uint local_6c;
  undefined local_68 [8];
  uint local_60;
  uint local_5c;
  undefined4 local_58;
  FARPROC local_54;
  int local_50;
  FARPROC local_4c;
  uint local_48;
  undefined4 *local_44;
  undefined local_40 [8];
  uint local_38 [2];
  ushort local_30 [2];
  undefined4 local_2c;
  undefined4 local_14;
  undefined4 uStack12;
  undefined4 local_8;
  
                    // 0x21980  105  BasepSetFileEncryptionCompression
  uStack12 = 0x6b82198c;
  local_44 = param_2;
  local_70 = param_3;
  local_4c = param_4;
  local_58 = param_5;
  local_78 = (HMODULE)0xffffffff;
  uVar8 = 0;
  local_48 = 0;
  local_8 = 0;
  local_54 = (FARPROC)(param_6 & 0x4000);
  uVar4 = param_6 & 0x800;
  uVar5 = param_6 & 0x8000;
  if (param_7 == 0xffffffff) {
    uVar6 = (uint)(local_54 == (FARPROC)0x0);
    local_5c = (uint)(uVar4 == 0);
    local_74 = (uint)(uVar5 == 0);
  }
  else {
    uVar6 = param_7 & 0x4000;
    local_5c = param_7 & 0x800;
    local_74 = param_7 & 0x8000;
  }
  local_6c = local_5c;
  local_60 = uVar6;
  if ((local_54 == (FARPROC)0x0) && (uVar6 == 0)) {
LAB_6b821a25:
    puVar7 = local_44;
    if (uVar4 == 0) {
LAB_6b821a33:
      if ((local_5c != 0) && (uVar6 == 0)) {
        local_48 = local_48 & 0xffff0000;
        puVar3 = &local_48;
LAB_6b83026d:
        puVar7 = local_44;
        local_50 = NtFsControlFile(*local_44,0,0,0,local_68,0x9c040,puVar3,2,0,0);
        if ((param_7 != 0xffffffff) && (local_50 < 0)) goto joined_r0x6b8302a0;
      }
    }
    else if ((local_5c == 0) && (uVar6 == 0)) {
      local_50 = NtQueryInformationFile(param_1,local_68,local_40,0x10,0x1c);
      if (-1 < local_50) {
        puVar3 = local_38;
        goto LAB_6b83026d;
      }
      puVar7 = local_44;
      if (param_7 == 0xffffffff) goto LAB_6b821a3e;
joined_r0x6b8302a0:
      if ((param_8 & 1) == 0) goto LAB_6b83020c;
    }
    else if (uVar4 == 0) goto LAB_6b821a33;
LAB_6b821a3e:
    if (uVar5 == 0) {
LAB_6b821a4c:
      if (local_74 != 0) {
        local_80 = local_80 & 0xffff0000;
        local_7c = 0;
LAB_6b83032b:
        local_50 = NtFsControlFile(*puVar7,0,0,0,local_68,0x9c280,&local_80,8,0,0);
        if ((param_7 != 0xffffffff) && (local_50 < 0)) goto LAB_6b8302fe;
      }
    }
    else if (local_74 == 0) {
      local_50 = NtFsControlFile(param_1,0,0,0,local_68,0x9027c,0,0,local_30,0x10);
      if (-1 < local_50) {
        local_80 = (uint)local_30[0];
        local_7c = local_2c;
        goto LAB_6b83032b;
      }
      if (param_7 == 0xffffffff) goto LAB_6b821a54;
LAB_6b8302fe:
      if ((param_8 & 1) == 0) goto LAB_6b83020c;
    }
    else if (uVar5 == 0) goto LAB_6b821a4c;
LAB_6b821a54:
    uVar8 = 1;
  }
  else {
    NtClose(*param_2);
    *local_44 = 0xffffffff;
    local_78 = LoadLibraryExW(L"advapi32.dll",(HANDLE)0x0,0x800);
    if (local_78 == (HMODULE)0x0) {
      bVar9 = (param_8 & 1) == 0;
LAB_6b830185:
      if (bVar9) goto LAB_6b821a5d;
    }
    else {
      if (local_54 != (FARPROC)0x0) {
        if (uVar6 != 0) {
          if (local_54 == (FARPROC)0x0) goto LAB_6b8300d1;
          goto LAB_6b830144;
        }
        DVar1 = GetEncryptedFileVersionExt(local_4c,&local_48);
        local_54 = (FARPROC)(param_8 & 1);
        if ((DVar1 == 0) || (local_54 != (FARPROC)0x0)) {
          if ((local_48 == 5) || (local_48 == 6)) {
            iVar2 = FUN_6b830fd9(local_4c,local_58,0);
            if (iVar2 == 0) goto LAB_6b8300a1;
LAB_6b8300ba:
            uVar6 = 1;
            local_60 = 1;
            local_5c = 0;
            local_6c = 0;
          }
          else {
            local_4c = GetProcAddress(local_78,"EncryptFileW");
            if (local_4c == (FARPROC)0x0) {
LAB_6b8300a1:
              bVar9 = local_54 == (FARPROC)0x0;
              goto LAB_6b830185;
            }
            uVar10 = local_58;
            _guard_check_icall();
            iVar2 = (*local_4c)(uVar10);
            if (iVar2 != 0) goto LAB_6b8300ba;
            if (local_54 == (FARPROC)0x0) goto LAB_6b821a5d;
          }
          goto LAB_6b83018b;
        }
LAB_6b830054:
        RtlSetLastWin32Error(DVar1);
        goto LAB_6b821a5d;
      }
LAB_6b8300d1:
      if (uVar6 == 0) {
        if (local_54 == (FARPROC)0x0) goto LAB_6b83018b;
LAB_6b830144:
        if (uVar6 != 0) {
          DVar1 = GetEncryptedFileVersionExt(local_4c,&local_48);
          if ((DVar1 != 0) && ((param_8 & 1) == 0)) goto LAB_6b830054;
          if (((local_48 == 5) || (local_48 == 6)) &&
             (iVar2 = FUN_6b830fd9(local_4c,local_58,1), iVar2 == 0)) {
            bVar9 = (param_8 & 1) == 0;
            goto LAB_6b830185;
          }
        }
      }
      else {
        local_54 = GetProcAddress(local_78,"DecryptFileW");
        local_4c = (FARPROC)(param_8 & 1);
        if (local_54 == (FARPROC)0x0) {
          bVar9 = local_4c == (FARPROC)0x0;
          goto LAB_6b830185;
        }
        DVar1 = GetEncryptedFileVersionExt(local_58,&local_48);
        if ((DVar1 != 0) && (local_4c == (FARPROC)0x0)) goto LAB_6b830054;
        if ((local_48 != 5) && (local_48 != 6)) {
          uVar11 = 0;
          uVar10 = local_58;
          _guard_check_icall();
          iVar2 = (*local_54)(uVar10,uVar11);
          if (iVar2 == 0) {
            bVar9 = local_4c == (FARPROC)0x0;
            goto LAB_6b830185;
          }
          uVar6 = 0;
          local_60 = 0;
        }
      }
    }
LAB_6b83018b:
    local_50 = NtOpenFile(local_44,0xc0150000,local_70,local_68,0,0x60);
    if (local_50 == -0x3fffffde) {
      if ((param_8 & 1) != 0) {
        local_50 = NtOpenFile(local_44,0x80150000,local_70,local_68,0,0x60);
      }
      if ((local_50 == -0x3fffffde) && ((param_8 & 1) != 0)) {
        local_50 = NtOpenFile(local_44,0x80110000,local_70,local_68,0,0x60);
      }
    }
    if (-1 < local_50) goto LAB_6b821a25;
LAB_6b83020c:
    BaseSetLastNTError(local_50);
  }
LAB_6b821a5d:
  local_8 = 0xfffffffe;
  FUN_6b821a7d();
  *in_FS_OFFSET = local_14;
  return uVar8;
}



void FUN_6b821a7d(void)

{
  HMODULE hLibModule;
  int unaff_EBP;
  
  hLibModule = *(HMODULE *)(unaff_EBP + -0x74);
  if ((hLibModule != (HMODULE)0xffffffff) && (hLibModule != (HMODULE)0x0)) {
    FreeLibrary(hLibModule);
  }
  return;
}



// WARNING: Could not reconcile some variable overlaps

DWORD GetActiveProcessorCount(WORD GroupNumber)

{
  byte bVar1;
  int iVar2;
  DWORD DVar3;
  uint uVar4;
  byte *pbVar5;
  int in_FS_OFFSET;
  DWORD local_10;
  PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX local_c;
  uint local_8;
  
                    // 0x21a90  441  GetActiveProcessorCount
  iVar2 = FUN_6b821afa(&local_c,&local_10);
  if (iVar2 == 0) {
    DVar3 = 0;
  }
  else {
    if (GroupNumber == 0xffff) {
      uVar4 = (uint)*(ushort *)&(local_c->u).field_0x2;
      local_8 = 0;
      if (uVar4 != 0) {
        pbVar5 = &(local_c->u).field_0x19;
        do {
          bVar1 = *pbVar5;
          pbVar5 = pbVar5 + 0x2c;
          local_8 = (uint)(ushort)((short)local_8 + (ushort)bVar1);
          uVar4 = uVar4 - 1;
        } while (uVar4 != 0);
      }
    }
    else if (GroupNumber < *(ushort *)&(local_c->u).field_0x2) {
      local_8 = (uint)(byte)(&(local_c->u).field_0x19)[(uint)GroupNumber * 0x2c];
    }
    else {
      local_8 = 0;
      RtlSetLastWin32Error(0x57);
    }
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_c);
    DVar3 = local_8 & 0xffff;
  }
  return DVar3;
}



undefined4 __fastcall FUN_6b821afa(PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX *param_1,DWORD *param_2)

{
  BOOL BVar1;
  DWORD DVar2;
  PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX Buffer;
  int in_FS_OFFSET;
  undefined4 uVar3;
  DWORD local_8;
  
  local_8 = 0;
  BVar1 = GetLogicalProcessorInformationEx
                    (RelationGroup,(PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX)0x0,&local_8);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
    if (DVar2 != 0x7a) {
      return 0;
    }
    Buffer = (PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX)
             RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_8);
    if (Buffer != (PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX)0x0) {
      BVar1 = GetLogicalProcessorInformationEx(RelationGroup,Buffer,&local_8);
      if (BVar1 == 0) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,Buffer);
        return 0;
      }
      *param_2 = local_8;
      *param_1 = Buffer;
      return 1;
    }
    uVar3 = 8;
  }
  else {
    uVar3 = 0xd;
  }
  RtlSetLastWin32Error(uVar3);
  return 0;
}



undefined4 TermsrvGetWindowsDirectoryA(undefined4 param_1,undefined4 param_2)

{
  code *pcVar1;
  undefined4 uVar2;
  
                    // 0x21b80  1434  TermsrvGetWindowsDirectoryA
  pcVar1 = DAT_6b8b0900;
  if (DAT_6b8b0900 == (code *)0x0) {
    uVar2 = 0;
  }
  else {
    _guard_check_icall();
    uVar2 = (*pcVar1)(param_1,param_2);
  }
  return uVar2;
}



BOOL FreeEnvironmentStringsW(LPWCH param_1)

{
  BOOL BVar1;
  
                    // 0x21ba0  432  FreeEnvironmentStringsW
                    // WARNING: Could not recover jumptable at 0x6b821ba6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = FreeEnvironmentStringsW(param_1);
  return BVar1;
}



DWORD FormatMessageW(DWORD dwFlags,LPCVOID lpSource,DWORD dwMessageId,DWORD dwLanguageId,
                    LPWSTR lpBuffer,DWORD nSize,va_list *Arguments)

{
  DWORD DVar1;
  
                    // 0x21bc0  429  FormatMessageW
                    // WARNING: Could not recover jumptable at 0x6b821bc6. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = FormatMessageW(dwFlags,lpSource,dwMessageId,dwLanguageId,lpBuffer,nSize,Arguments);
  return DVar1;
}



BOOL QueryThreadCycleTime(HANDLE ThreadHandle,PULONG64 CycleTime)

{
  BOOL BVar1;
  
                    // 0x21be0  1110  QueryThreadCycleTime
                    // WARNING: Could not recover jumptable at 0x6b821be6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = QueryThreadCycleTime(ThreadHandle,CycleTime);
  return BVar1;
}



undefined4 Process32FirstW(undefined4 param_1,int *param_2)

{
  int iVar1;
  undefined4 uVar2;
  int *piVar3;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  int local_8;
  
                    // 0x21c00  1072  Process32FirstW
  uVar2 = 0;
  if ((param_2 == (int *)0x0) || (*param_2 != 0x22c)) {
    iVar1 = -0x3ffffffc;
  }
  else {
    local_14 = 0;
    local_10 = 0;
    local_c = 0;
    local_8 = 0;
    iVar1 = NtMapViewOfSection(param_1,0xffffffff,&local_8,0,0,&local_14,&local_c,1,0,4);
    if (-1 < iVar1) {
      if (*(int *)(local_8 + 4) == 0) {
        memset(param_2 + 1,0,*param_2 - 4);
        RtlSetLastWin32Error(0x12);
      }
      else {
        piVar3 = (int *)(*(int *)(local_8 + 0x14) + local_8);
        for (iVar1 = 0x8b; iVar1 != 0; iVar1 = iVar1 + -1) {
          *param_2 = *piVar3;
          piVar3 = piVar3 + 1;
          param_2 = param_2 + 1;
        }
        *(undefined4 *)(local_8 + 0x24) = 1;
        uVar2 = 1;
      }
      NtUnmapViewOfSection(0xffffffff,local_8);
      return uVar2;
    }
  }
  BaseSetLastNTError(iVar1);
  return 0;
}



BOOL GetSystemTimeAdjustment
               (PDWORD lpTimeAdjustment,PDWORD lpTimeIncrement,PBOOL lpTimeAdjustmentDisabled)

{
  BOOL BVar1;
  
                    // 0x21ca0  750  GetSystemTimeAdjustment
                    // WARNING: Could not recover jumptable at 0x6b821ca6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetSystemTimeAdjustment(lpTimeAdjustment,lpTimeIncrement,lpTimeAdjustmentDisabled);
  return BVar1;
}



DWORD GetTimeZoneInformation(LPTIME_ZONE_INFORMATION lpTimeZoneInformation)

{
  DWORD DVar1;
  
                    // 0x21cc0  788  GetTimeZoneInformation
                    // WARNING: Could not recover jumptable at 0x6b821cc6. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = GetTimeZoneInformation(lpTimeZoneInformation);
  return DVar1;
}



BOOL CancelIoEx(HANDLE hFile,LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  
                    // 0x21ce0  119  CancelIoEx
                    // WARNING: Could not recover jumptable at 0x6b821ce6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = CancelIoEx(hFile,lpOverlapped);
  return BVar1;
}



PTP_TIMER CreateThreadpoolTimer(PTP_TIMER_CALLBACK pfnti,PVOID pv,PTP_CALLBACK_ENVIRON pcbe)

{
  int iVar1;
  PTP_TIMER local_8;
  
                    // 0x21d00  253  CreateThreadpoolTimer
  iVar1 = TpAllocTimer(&local_8,pfnti,pv,pcbe);
  if (iVar1 < 0) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
    local_8 = (PTP_TIMER)0x0;
  }
  return local_8;
}



BOOL QueueUserWorkItem(LPTHREAD_START_ROUTINE Function,PVOID Context,ULONG Flags)

{
  BOOL BVar1;
  
                    // 0x21d30  1115  QueueUserWorkItem
                    // WARNING: Could not recover jumptable at 0x6b821d36. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = QueueUserWorkItem(Function,Context,Flags);
  return BVar1;
}



UINT GetWindowsDirectoryA(LPSTR lpBuffer,UINT uSize)

{
  UINT UVar1;
  
                    // 0x21d50  811  GetWindowsDirectoryA
                    // WARNING: Could not recover jumptable at 0x6b821d56. Too many branches
                    // WARNING: Treating indirect jump as call
  UVar1 = GetWindowsDirectoryA(lpBuffer,uSize);
  return UVar1;
}



LPWSTR GetCommandLineW(void)

{
  LPWSTR pWVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b821d70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21d70  477  GetCommandLineW
  pWVar1 = GetCommandLineW();
  return pWVar1;
}



BOOL AreFileApisANSI(void)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b821d80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21d80  39  AreFileApisANSI
  BVar1 = AreFileApisANSI();
  return BVar1;
}



BOOL SetFileCompletionNotificationModes(HANDLE FileHandle,UCHAR Flags)

{
  int iVar1;
  BOOL BVar2;
  undefined local_10 [8];
  uint local_8;
  
                    // 0x21d90  1315  SetFileCompletionNotificationModes
  local_8 = (uint)Flags;
  if ((Flags & 0xfc) == 0) {
    if ((Flags & 3) != 0) {
      iVar1 = NtSetInformationFile(FileHandle,local_10,&local_8,4,0x29);
      if (iVar1 < 0) {
        BaseSetLastNTError(iVar1);
        goto LAB_6b830436;
      }
    }
    BVar2 = 1;
  }
  else {
    RtlSetLastWin32Error(0x57);
LAB_6b830436:
    BVar2 = 0;
  }
  return BVar2;
}



BOOL GlobalMemoryStatusEx(LPMEMORYSTATUSEX lpBuffer)

{
  BOOL BVar1;
  
                    // 0x21de0  832  GlobalMemoryStatusEx
                    // WARNING: Could not recover jumptable at 0x6b821de6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GlobalMemoryStatusEx(lpBuffer);
  return BVar1;
}



LCID LocaleNameToLCID(LPCWSTR lpName,DWORD dwFlags)

{
  LCID LVar1;
  
                    // 0x21e00  989  LocaleNameToLCID
                    // WARNING: Could not recover jumptable at 0x6b821e06. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = LocaleNameToLCID(lpName,dwFlags);
  return LVar1;
}



DWORD FlsAlloc(PFLS_CALLBACK_FUNCTION lpCallback)

{
  DWORD DVar1;
  
                    // 0x21e20  416  FlsAlloc
                    // WARNING: Could not recover jumptable at 0x6b821e26. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = FlsAlloc(lpCallback);
  return DVar1;
}



BOOL GetProcessAffinityMask
               (HANDLE hProcess,PDWORD_PTR lpProcessAffinityMask,PDWORD_PTR lpSystemAffinityMask)

{
  int iVar1;
  _SYSTEM_INFO local_40;
  undefined local_1c [8];
  ULONG_PTR local_14;
  
                    // 0x21e40  693  GetProcessAffinityMask
  iVar1 = NtQueryInformationProcess(hProcess,0,local_1c,0x18,0);
  if (iVar1 < 0) {
    BaseSetLastNTError(iVar1);
  }
  else {
    GetSystemInfo(&local_40);
    *lpProcessAffinityMask = local_14;
    *lpSystemAffinityMask = -(uint)(local_14 != 0) & local_40.dwActiveProcessorMask;
  }
  return (uint)(iVar1 >= 0);
}



void WTSGetActiveConsoleSessionId(void)

{
                    // WARNING: Could not recover jumptable at 0x6b821ea0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21ea0  1495  WTSGetActiveConsoleSessionId
  RtlGetActiveConsoleId();
  return;
}



void GetNativeSystemInfo(LPSYSTEM_INFO lpSystemInfo)

{
                    // WARNING: Could not recover jumptable at 0x6b821eb0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21eb0  651  GetNativeSystemInfo
  GetNativeSystemInfo(lpSystemInfo);
  return;
}



int LCIDToLocaleName(LCID Locale,LPWSTR lpName,int cchName,DWORD dwFlags)

{
  int iVar1;
  
                    // 0x21ec0  948  LCIDToLocaleName
                    // WARNING: Could not recover jumptable at 0x6b821ec6. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = LCIDToLocaleName(Locale,lpName,cchName,dwFlags);
  return iVar1;
}



LPSTR GetCommandLineA(void)

{
  LPSTR pCVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b821ee0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21ee0  476  GetCommandLineA
  pCVar1 = GetCommandLineA();
  return pCVar1;
}



LPWCH GetEnvironmentStringsW(void)

{
  LPWCH pWVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b821ef0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21ef0  573  GetEnvironmentStringsW
  pWVar1 = GetEnvironmentStringsW();
  return pWVar1;
}



HANDLE OpenFileMappingW(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCWSTR lpName)

{
  HANDLE pvVar1;
  
                    // 0x21f00  1033  OpenFileMappingW
                    // WARNING: Could not recover jumptable at 0x6b821f06. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = OpenFileMappingW(dwDesiredAccess,bInheritHandle,lpName);
  return pvVar1;
}



BOOL SetThreadStackGuarantee(PULONG StackSizeInBytes)

{
  BOOL BVar1;
  
                    // 0x21f20  1383  SetThreadStackGuarantee
                    // WARNING: Could not recover jumptable at 0x6b821f26. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetThreadStackGuarantee(StackSizeInBytes);
  return BVar1;
}



HANDLE CreateActCtxW(PCACTCTXW pActCtx)

{
  HANDLE pvVar1;
  
                    // 0x21f40  182  CreateActCtxW
                    // WARNING: Could not recover jumptable at 0x6b821f46. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = CreateActCtxW(pActCtx);
  return pvVar1;
}



LANGID GetUserDefaultUILanguage(void)

{
  LANGID LVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b821f60. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21f60  795  GetUserDefaultUILanguage
  LVar1 = GetUserDefaultUILanguage();
  return LVar1;
}



BOOL GetThreadTimes(HANDLE hThread,LPFILETIME lpCreationTime,LPFILETIME lpExitTime,
                   LPFILETIME lpKernelTime,LPFILETIME lpUserTime)

{
  BOOL BVar1;
  
                    // 0x21f70  779  GetThreadTimes
                    // WARNING: Could not recover jumptable at 0x6b821f76. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetThreadTimes(hThread,lpCreationTime,lpExitTime,lpKernelTime,lpUserTime);
  return BVar1;
}



UINT SetHandleCount(UINT uNumber)

{
                    // 0x21f90  1329  SetHandleCount
  return uNumber;
}



HRESULT WerRegisterFile(PCWSTR pwzFile,WER_REGISTER_FILE_TYPE regFileType,DWORD dwFlags)

{
  HRESULT HVar1;
  
                    // 0x21fb0  1517  WerRegisterFile
                    // WARNING: Could not recover jumptable at 0x6b821fb6. Too many branches
                    // WARNING: Treating indirect jump as call
  HVar1 = WerRegisterFile(pwzFile,regFileType,dwFlags);
  return HVar1;
}



DWORD GetProcessIdOfThread(HANDLE Thread)

{
  DWORD DVar1;
  
                    // 0x21fd0  701  GetProcessIdOfThread
                    // WARNING: Could not recover jumptable at 0x6b821fd6. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = GetProcessIdOfThread(Thread);
  return DVar1;
}



BOOL SetDllDirectoryW(LPCWSTR lpPathName)

{
  int iVar1;
  undefined4 local_c [2];
  
                    // 0x21ff0  1298  SetDllDirectoryW
  iVar1 = FUN_6b82157b(local_c,lpPathName);
  if ((-1 < iVar1) && (iVar1 = LdrSetDllDirectory(local_c), -1 < iVar1)) {
    return 1;
  }
  BaseSetLastNTError(iVar1);
  return 0;
}



BOOL GetFileInformationByHandleEx
               (HANDLE hFile,FILE_INFO_BY_HANDLE_CLASS FileInformationClass,LPVOID lpFileInformation
               ,DWORD dwBufferSize)

{
  BOOL BVar1;
  
                    // 0x22030  590  GetFileInformationByHandleEx
                    // WARNING: Could not recover jumptable at 0x6b822036. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetFileInformationByHandleEx(hFile,FileInformationClass,lpFileInformation,dwBufferSize);
  return BVar1;
}



BOOL FlsFree(DWORD dwFlsIndex)

{
  BOOL BVar1;
  
                    // 0x22050  417  FlsFree
                    // WARNING: Could not recover jumptable at 0x6b822056. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = FlsFree(dwFlsIndex);
  return BVar1;
}



BOOL GetProductInfo(DWORD dwOSMajorVersion,DWORD dwOSMinorVersion,DWORD dwSpMajorVersion,
                   DWORD dwSpMinorVersion,PDWORD pdwReturnedProductType)

{
  BOOL BVar1;
  
                    // 0x22070  713  GetProductInfo
                    // WARNING: Could not recover jumptable at 0x6b822076. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetProductInfo(dwOSMajorVersion,dwOSMinorVersion,dwSpMajorVersion,dwSpMinorVersion,
                         pdwReturnedProductType);
  return BVar1;
}



BOOL GetComputerNameExW(COMPUTER_NAME_FORMAT NameType,LPWSTR lpBuffer,LPDWORD nSize)

{
  BOOL BVar1;
  
                    // 0x22090  484  GetComputerNameExW
                    // WARNING: Could not recover jumptable at 0x6b822096. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetComputerNameExW(NameType,lpBuffer,nSize);
  return BVar1;
}



BOOL MoveFileW(LPCWSTR lpExistingFileName,LPCWSTR lpNewFileName)

{
  BOOL BVar1;
  
                    // 0x220b0  1009  MoveFileW
  BVar1 = MoveFileWithProgressW
                    (lpExistingFileName,lpNewFileName,(LPPROGRESS_ROUTINE)0x0,(LPVOID)0x0,2);
  return BVar1;
}



BOOL IsDebuggerPresent(void)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8220d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x220d0  900  IsDebuggerPresent
  BVar1 = IsDebuggerPresent();
  return BVar1;
}



BOOL GetExitCodeThread(HANDLE hThread,LPDWORD lpExitCode)

{
  BOOL BVar1;
  
                    // 0x220e0  579  GetExitCodeThread
                    // WARNING: Could not recover jumptable at 0x6b8220e6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetExitCodeThread(hThread,lpExitCode);
  return BVar1;
}



BOOL ReplaceFile(LPCWSTR lpReplacedFileName,LPCWSTR lpReplacementFileName,LPCWSTR lpBackupFileName,
                DWORD dwReplaceFlags,LPVOID lpExclude,LPVOID lpReserved)

{
  BOOL BVar1;
  
                    // 0x22100  1220  ReplaceFile
                    // 0x22100  1222  ReplaceFileW
                    // WARNING: Could not recover jumptable at 0x6b822106. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = ReplaceFileW(lpReplacedFileName,lpReplacementFileName,lpBackupFileName,dwReplaceFlags,
                       lpExclude,lpReserved);
  return BVar1;
}



BOOL QueryUnbiasedInterruptTime(PULONGLONG UnbiasedTime)

{
  BOOL BVar1;
  
                    // 0x22120  1113  QueryUnbiasedInterruptTime
                    // WARNING: Could not recover jumptable at 0x6b822126. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = QueryUnbiasedInterruptTime(UnbiasedTime);
  return BVar1;
}



HRESULT RegisterApplicationRestart(PCWSTR pwzCommandline,DWORD dwFlags)

{
  HRESULT HVar1;
  
                    // 0x22140  1191  RegisterApplicationRestart
                    // WARNING: Could not recover jumptable at 0x6b822146. Too many branches
                    // WARNING: Treating indirect jump as call
  HVar1 = RegisterApplicationRestart(pwzCommandline,dwFlags);
  return HVar1;
}



int GetUserDefaultLocaleName(LPWSTR lpLocaleName,int cchLocaleName)

{
  int iVar1;
  
                    // 0x22160  794  GetUserDefaultLocaleName
                    // WARNING: Could not recover jumptable at 0x6b822166. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = GetUserDefaultLocaleName(lpLocaleName,cchLocaleName);
  return iVar1;
}



undefined4 BaseIsAppcompatInfrastructureDisabled(void)

{
                    // 0x22180  66  BaseIsAppcompatInfrastructureDisabled
                    // 0x22180  67  BaseIsAppcompatInfrastructureDisabledWorker
  return 0;
}



UINT GetOEMCP(void)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b822190. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22190  669  GetOEMCP
  UVar1 = GetOEMCP();
  return UVar1;
}



undefined4 FUN_6b8221a0(void)

{
  return 0x2000;
}



undefined4 FUN_6b8221b0(void)

{
  return 0x24a2;
}



undefined FUN_6b8221c0(void)

{
  return 0;
}



undefined4 __fastcall FUN_6b8221d0(int param_1)

{
  return *(undefined4 *)(param_1 + 0x10);
}



undefined4 __fastcall FUN_6b8221e0(int param_1)

{
  return *(undefined4 *)(param_1 + 4);
}



INT BaseInitAppcompatCacheSupportWorker(void)

{
                    // 0x221f0  65  BaseInitAppcompatCacheSupportWorker
                    // 0x221f0  143  CloseProfileUserMapping
                    // 0x221f0  962  LZStart
                    // 0x221f0  1043  OpenProfileUserMapping
  return 1;
}



undefined4 __fastcall FUN_6b822200(int param_1)

{
  return *(undefined4 *)(param_1 + 0xc);
}



undefined4 __fastcall FUN_6b822210(int param_1)

{
  return *(undefined4 *)(param_1 + 8);
}



undefined4 FUN_6b822220(ushort *param_1,int param_2)

{
  *(int *)(param_2 + 0x18) = *(int *)(param_2 + 0x18) + 1;
  *(int *)(param_2 + 0x14) = *(int *)(param_2 + 0x14) + (uint)*param_1;
  return 0;
}



undefined4 FUN_6b822240(undefined4 param_1,undefined4 param_2,undefined4 *param_3)

{
  *param_3 = 2;
  return 0;
}



BOOL PostQueuedCompletionStatus
               (HANDLE CompletionPort,DWORD dwNumberOfBytesTransferred,ULONG_PTR dwCompletionKey,
               LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  
                    // 0x22260  1063  PostQueuedCompletionStatus
                    // WARNING: Could not recover jumptable at 0x6b822266. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = PostQueuedCompletionStatus
                    (CompletionPort,dwNumberOfBytesTransferred,dwCompletionKey,lpOverlapped);
  return BVar1;
}



BOOL GetQueuedCompletionStatus
               (HANDLE CompletionPort,LPDWORD lpNumberOfBytesTransferred,PULONG_PTR lpCompletionKey,
               LPOVERLAPPED *lpOverlapped,DWORD dwMilliseconds)

{
  BOOL BVar1;
  
                    // 0x22280  720  GetQueuedCompletionStatus
                    // WARNING: Could not recover jumptable at 0x6b822286. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetQueuedCompletionStatus
                    (CompletionPort,lpNumberOfBytesTransferred,lpCompletionKey,lpOverlapped,
                     dwMilliseconds);
  return BVar1;
}



HANDLE CreateIoCompletionPort
                 (HANDLE FileHandle,HANDLE ExistingCompletionPort,ULONG_PTR CompletionKey,
                 DWORD NumberOfConcurrentThreads)

{
  HANDLE pvVar1;
  
                    // 0x222a0  214  CreateIoCompletionPort
                    // WARNING: Could not recover jumptable at 0x6b8222a6. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = CreateIoCompletionPort
                     (FileHandle,ExistingCompletionPort,CompletionKey,NumberOfConcurrentThreads);
  return pvVar1;
}



HANDLE CreateNamedPipeA(LPCSTR lpName,DWORD dwOpenMode,DWORD dwPipeMode,DWORD nMaxInstances,
                       DWORD nOutBufferSize,DWORD nInBufferSize,DWORD nDefaultTimeOut,
                       LPSECURITY_ATTRIBUTES lpSecurityAttributes)

{
  int iVar1;
  HANDLE pvVar2;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x222c0  225  CreateNamedPipeA
  iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpName);
  if (iVar1 == 0) {
    pvVar2 = (HANDLE)0xffffffff;
  }
  else {
    pvVar2 = CreateNamedPipeW(local_8,dwOpenMode,dwPipeMode,nMaxInstances,nOutBufferSize,
                              nInBufferSize,nDefaultTimeOut,lpSecurityAttributes);
    RtlFreeUnicodeString(local_c);
  }
  return pvVar2;
}



HANDLE OpenSemaphoreA(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCSTR lpName)

{
  int iVar1;
  HANDLE pvVar2;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x22320  1044  OpenSemaphoreA
  if (lpName == (LPCSTR)0x0) {
    BaseSetLastNTError(0xc000000d);
  }
  else {
    iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpName);
    if (iVar1 != 0) {
      pvVar2 = OpenSemaphoreW(dwDesiredAccess,bInheritHandle,local_8);
      RtlFreeUnicodeString(local_c);
      return pvVar2;
    }
  }
  return (HANDLE)0x0;
}



DWORD ExpandEnvironmentStringsA(LPCSTR lpSrc,LPSTR lpDst,DWORD nSize)

{
  DWORD DVar1;
  
                    // 0x22370  359  ExpandEnvironmentStringsA
                    // WARNING: Could not recover jumptable at 0x6b822376. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = ExpandEnvironmentStringsA(lpSrc,lpDst,nSize);
  return DVar1;
}



BOOL ConnectNamedPipe(HANDLE hNamedPipe,LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  
                    // 0x22390  162  ConnectNamedPipe
                    // WARNING: Could not recover jumptable at 0x6b822396. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = ConnectNamedPipe(hNamedPipe,lpOverlapped);
  return BVar1;
}



DWORD GetTickCount(void)

{
  DWORD DVar1;
  
                    // 0x223a0  782  GetTickCount
  DVar1 = GetTickCount();
  return DVar1;
}



void FUN_6b8223b0(void)

{
  thunk_FUN_6b823e9e();
  return;
}



void FUN_6b822400(void)

{
  thunk_FUN_6b823e9e();
  return;
}



void FUN_6b822480(void)

{
  thunk_FUN_6b823e9e();
  return;
}



void FUN_6b8224a0(void)

{
  thunk_FUN_6b823e9e();
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __fastcall FUN_6b8224af(uint param_1,undefined4 param_2)

{
  uint uVar1;
  undefined4 in_EAX;
  undefined4 unaff_EBX;
  undefined4 unaff_EBP;
  undefined4 unaff_ESI;
  undefined4 unaff_EDI;
  undefined2 in_ES;
  undefined2 in_CS;
  undefined2 in_SS;
  undefined2 in_DS;
  undefined2 in_FS;
  undefined2 in_GS;
  byte in_AF;
  byte in_TF;
  byte in_IF;
  byte in_NT;
  byte in_AC;
  byte in_VIF;
  byte in_VIP;
  byte in_ID;
  undefined4 unaff_retaddr;
  
  uVar1 = param_1 - DAT_6b8b0140;
  if (uVar1 == 0) {
    return;
  }
  _DAT_6b8b04b0 =
       (uint)(in_NT & 1) * 0x4000 | (uint)SBORROW4(param_1,DAT_6b8b0140) * 0x800 |
       (uint)(in_IF & 1) * 0x200 | (uint)(in_TF & 1) * 0x100 | (uint)((int)uVar1 < 0) * 0x80 |
       (uint)(uVar1 == 0) * 0x40 | (uint)(in_AF & 1) * 0x10 |
       (uint)((POPCOUNT(uVar1 & 0xff) & 1U) == 0) * 4 | (uint)(param_1 < DAT_6b8b0140) |
       (uint)(in_ID & 1) * 0x200000 | (uint)(in_VIP & 1) * 0x100000 | (uint)(in_VIF & 1) * 0x80000 |
       (uint)(in_AC & 1) * 0x40000;
  _DAT_6b8b04b4 = &stack0x00000004;
  _DAT_6b8b03f0 = 0x10001;
  _DAT_6b8b03a0 = 0xc0000409;
  _DAT_6b8b03a4 = 1;
  _DAT_6b8b03b0 = 1;
  DAT_6b8b03b4 = 2;
  _DAT_6b8b03ac = unaff_retaddr;
  _DAT_6b8b047c = in_GS;
  _DAT_6b8b0480 = in_FS;
  _DAT_6b8b0484 = in_ES;
  _DAT_6b8b0488 = in_DS;
  _DAT_6b8b048c = unaff_EDI;
  _DAT_6b8b0490 = unaff_ESI;
  _DAT_6b8b0494 = unaff_EBX;
  _DAT_6b8b0498 = param_2;
  _DAT_6b8b049c = param_1;
  _DAT_6b8b04a0 = in_EAX;
  _DAT_6b8b04a4 = unaff_EBP;
  DAT_6b8b04a8 = unaff_retaddr;
  _DAT_6b8b04ac = in_CS;
  _DAT_6b8b04b8 = in_SS;
  RtlUnhandledExceptionFilter(&PTR_DAT_6b8801e4);
  NtTerminateProcess(0xffffffff,0xc0000409);
  return;
}



// Library Function - Single Match
//  __DllMainCRTStartupForGS2@12
// 
// Libraries: Visual Studio 2012 Release, Visual Studio 2015 Release, Visual Studio 2017 Release,
// Visual Studio 2019 Release

undefined4 __DllMainCRTStartupForGS2_12(undefined4 param_1,int param_2)

{
  if (param_2 == 1) {
    ___security_init_cookie();
  }
  return 1;
}



// Library Function - Single Match
//  ___raise_securityfailure
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void __cdecl ___raise_securityfailure(undefined4 param_1)

{
  RtlUnhandledExceptionFilter(param_1);
  NtTerminateProcess(0xffffffff,0xc0000409);
  return;
}



// Library Function - Single Match
//  ___report_rangecheckfailure
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void ___report_rangecheckfailure(void)

{
  ___report_securityfailure(8);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  ___report_securityfailure
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void __cdecl ___report_securityfailure(undefined4 param_1)

{
  undefined4 uVar1;
  undefined4 unaff_retaddr;
  
  uVar1 = unaff_retaddr;
  RtlCaptureContext(&DAT_6b8b03f0);
  _DAT_6b8b03ac = uVar1;
  _DAT_6b8b04b4 = &param_1;
  _DAT_6b8b03a0 = 0xc0000409;
  _DAT_6b8b03a4 = 1;
  _DAT_6b8b03b0 = 1;
  DAT_6b8b03b4 = param_1;
  DAT_6b8b04a8 = _DAT_6b8b03ac;
  ___raise_securityfailure(&PTR_DAT_6b8801e4);
  return;
}



// Library Function - Single Match
//  ___security_init_cookie
// 
// Library: Visual Studio 2019 Release

void __cdecl ___security_init_cookie(void)

{
  if ((DAT_6b8b0140 == 0) || (DAT_6b8b0140 == 0xbb40e64e)) {
    ___security_init_cookie_ex(&DAT_6b8b0140);
  }
  DAT_6b8b0144 = ~DAT_6b8b0140;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  ___security_init_cookie_ex
// 
// Library: Visual Studio 2019 Release

void __cdecl ___security_init_cookie_ex(uint *param_1)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  uint local_c;
  
  iVar2 = _DAT_7ffe0324;
  uVar1 = _DAT_7ffe0004;
  if (_DAT_7ffe0004 < 0x1000000) {
    do {
    } while (_DAT_7ffe0324 != _DAT_7ffe0328);
    iVar3 = _aullshr(_DAT_7ffe0320);
    local_c = iVar3 + iVar2 * 0x100 * uVar1;
  }
  else {
    local_c = _aullshr(_DAT_7ffe0320);
  }
  *param_1 = local_c ^ (uint)param_1;
  if ((*param_1 == 0) || (*param_1 == 0xbb40e64e)) {
    *param_1 = 0xbb40e64f;
  }
  return;
}



void _guard_check_icall(void)

{
                    // 0x22760  55  BaseDumpAppcompatCacheWorker
                    // 0x22760  956  LZDone
  return;
}



void RtlCaptureContext(void)

{
                    // WARNING: Could not recover jumptable at 0x6b822770. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22770  1234  RtlCaptureContext
  RtlCaptureContext();
  return;
}



void RtlUnwind(PVOID TargetFrame,PVOID TargetIp,PEXCEPTION_RECORD ExceptionRecord,PVOID ReturnValue)

{
                    // WARNING: Could not recover jumptable at 0x6b822776. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlUnwind(TargetFrame,TargetIp,ExceptionRecord,ReturnValue);
  return;
}



void RtlAllocateHeap(void)

{
                    // WARNING: Could not recover jumptable at 0x6b82277c. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlAllocateHeap();
  return;
}



void RtlFreeHeap(void)

{
                    // WARNING: Could not recover jumptable at 0x6b822782. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlFreeHeap();
  return;
}



// Library Function - Single Match
//  _ValidateLocalCookies
// 
// Library: Visual Studio 2019 Release

void __fastcall
_ValidateLocalCookies(undefined4 param_1,undefined4 param_2,int *param_3,int param_4)

{
  undefined4 extraout_EDX;
  
  if (*param_3 != -2) {
    FUN_6b8224af(param_3[1] + param_4 ^ *(uint *)(*param_3 + param_4),param_2);
    param_2 = extraout_EDX;
  }
  FUN_6b8224af(param_3[3] + param_4 ^ *(uint *)(param_3[2] + param_4),param_2);
  return;
}



// Library Function - Single Match
//  __except_handler4
// 
// Library: Visual Studio 2019 Release

undefined4 __fastcall
__except_handler4(undefined4 param_1,undefined4 param_2,int param_3,PVOID param_4,int param_5)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  code *pcVar4;
  undefined4 uVar5;
  undefined4 extraout_ECX;
  uint uVar6;
  uint extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 uVar7;
  uint uVar8;
  undefined8 uVar9;
  int local_1c;
  int local_18;
  int *local_14;
  undefined4 local_10;
  int *local_c;
  byte local_5;
  
  local_5 = 0;
  local_10 = 1;
  iVar1 = (int)param_4 + 0x10;
  local_c = (int *)(*(uint *)((int)param_4 + 8) ^ DAT_6b8b0140);
  _ValidateLocalCookies(param_1,param_2,local_c,iVar1);
  ___except_validate_context_record(param_5);
  uVar8 = *(uint *)((int)param_4 + 0xc);
  if ((*(byte *)(param_3 + 4) & 0x66) == 0) {
    local_1c = param_3;
    local_18 = param_5;
    *(int **)((int)param_4 + -4) = &local_1c;
    uVar5 = extraout_EDX;
    if (uVar8 == 0xfffffffe) {
      return local_10;
    }
    do {
      iVar2 = uVar8 * 3 + 4;
      uVar3 = local_c[iVar2];
      local_14 = local_c + iVar2;
      if ((undefined *)local_14[1] == (undefined *)0x0) {
        uVar6 = (uint)local_5;
      }
      else {
        uVar9 = __EH4_CallFilterFunc_8((undefined *)local_14[1]);
        uVar5 = (undefined4)((ulonglong)uVar9 >> 0x20);
        uVar6 = CONCAT31((int3)((uint)extraout_ECX >> 8),1);
        local_5 = 1;
        if ((int)uVar9 < 0) {
          local_10 = 0;
          goto LAB_6b82288d;
        }
        if (0 < (int)uVar9) {
          __EH4_GlobalUnwind_4(param_4);
          uVar5 = extraout_ECX_01;
          uVar7 = extraout_EDX_01;
          if (*(uint *)((int)param_4 + 0xc) != uVar8) {
            __EH4_LocalUnwind_16((int)param_4,uVar8,iVar1,&DAT_6b8b0140);
            uVar5 = extraout_ECX_02;
            uVar7 = extraout_EDX_02;
          }
          *(uint *)((int)param_4 + 0xc) = uVar3;
          _ValidateLocalCookies(uVar5,uVar7,local_c,iVar1);
          __EH4_TransferToHandler_8((undefined *)local_14[2]);
          pcVar4 = (code *)swi(3);
          uVar5 = (*pcVar4)();
          return uVar5;
        }
      }
      uVar8 = uVar3;
    } while (uVar3 != 0xfffffffe);
    if ((char)uVar6 == '\0') {
      return local_10;
    }
  }
  else {
    if (uVar8 == 0xfffffffe) {
      return local_10;
    }
    __EH4_LocalUnwind_16((int)param_4,0xfffffffe,iVar1,&DAT_6b8b0140);
    uVar6 = extraout_ECX_00;
    uVar5 = extraout_EDX_00;
  }
LAB_6b82288d:
  _ValidateLocalCookies(uVar6,uVar5,local_c,iVar1);
  return local_10;
}



void NtSetInformationFile(void)

{
                    // WARNING: Could not recover jumptable at 0x6b8228e2. Too many branches
                    // WARNING: Treating indirect jump as call
  NtSetInformationFile();
  return;
}



void NtQueryInformationFile(void)

{
                    // WARNING: Could not recover jumptable at 0x6b8228e8. Too many branches
                    // WARNING: Treating indirect jump as call
  NtQueryInformationFile();
  return;
}



void NtClose(void)

{
                    // WARNING: Could not recover jumptable at 0x6b8228ee. Too many branches
                    // WARNING: Treating indirect jump as call
  NtClose();
  return;
}



void NtOpenFile(void)

{
                    // WARNING: Could not recover jumptable at 0x6b8228f4. Too many branches
                    // WARNING: Treating indirect jump as call
  NtOpenFile();
  return;
}



void NtWaitForSingleObject(void)

{
                    // WARNING: Could not recover jumptable at 0x6b8228fa. Too many branches
                    // WARNING: Treating indirect jump as call
  NtWaitForSingleObject();
  return;
}



void NtOpenKey(void)

{
                    // WARNING: Could not recover jumptable at 0x6b822900. Too many branches
                    // WARNING: Treating indirect jump as call
  NtOpenKey();
  return;
}



void NtQueryValueKey(void)

{
                    // WARNING: Could not recover jumptable at 0x6b822906. Too many branches
                    // WARNING: Treating indirect jump as call
  NtQueryValueKey();
  return;
}



void RtlAppendUnicodeToString(void)

{
                    // WARNING: Could not recover jumptable at 0x6b82290c. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlAppendUnicodeToString();
  return;
}



void RtlInitUnicodeStringEx(void)

{
                    // WARNING: Could not recover jumptable at 0x6b822912. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlInitUnicodeStringEx();
  return;
}



void RtlCreateEnvironmentEx(void)

{
                    // WARNING: Could not recover jumptable at 0x6b822918. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlCreateEnvironmentEx();
  return;
}



void RtlDestroyEnvironment(void)

{
                    // WARNING: Could not recover jumptable at 0x6b82291e. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlDestroyEnvironment();
  return;
}



void NtUnmapViewOfSection(void)

{
                    // WARNING: Could not recover jumptable at 0x6b822924. Too many branches
                    // WARNING: Treating indirect jump as call
  NtUnmapViewOfSection();
  return;
}



void DbgPrintEx(void)

{
                    // WARNING: Could not recover jumptable at 0x6b82292a. Too many branches
                    // WARNING: Treating indirect jump as call
  DbgPrintEx();
  return;
}



void RtlpEnsureBufferSize(void)

{
                    // WARNING: Could not recover jumptable at 0x6b822930. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlpEnsureBufferSize();
  return;
}



void RtlDoesFileExists_U(void)

{
                    // WARNING: Could not recover jumptable at 0x6b822936. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlDoesFileExists_U();
  return;
}



void NtCreateSection(void)

{
                    // WARNING: Could not recover jumptable at 0x6b82293c. Too many branches
                    // WARNING: Treating indirect jump as call
  NtCreateSection();
  return;
}



void NtMapViewOfSection(void)

{
                    // WARNING: Could not recover jumptable at 0x6b822942. Too many branches
                    // WARNING: Treating indirect jump as call
  NtMapViewOfSection();
  return;
}



void RtlNtStatusToDosErrorNoTeb(void)

{
                    // WARNING: Could not recover jumptable at 0x6b822948. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlNtStatusToDosErrorNoTeb();
  return;
}



void NtTerminateProcess(void)

{
                    // WARNING: Could not recover jumptable at 0x6b82294e. Too many branches
                    // WARNING: Treating indirect jump as call
  NtTerminateProcess();
  return;
}



void RtlUnhandledExceptionFilter(void)

{
                    // WARNING: Could not recover jumptable at 0x6b822954. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlUnhandledExceptionFilter();
  return;
}



void _aullshr(void)

{
                    // WARNING: Could not recover jumptable at 0x6b82295a. Too many branches
                    // WARNING: Treating indirect jump as call
  _aullshr();
  return;
}



void NtWow64ReadVirtualMemory64(void)

{
                    // WARNING: Could not recover jumptable at 0x6b822960. Too many branches
                    // WARNING: Treating indirect jump as call
  NtWow64ReadVirtualMemory64();
  return;
}



void RtlSizeHeap(void)

{
                    // WARNING: Could not recover jumptable at 0x6b822966. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlSizeHeap();
  return;
}



// Library Function - Single Match
//  __local_unwind4
// 
// Libraries: Visual Studio 2017 Debug, Visual Studio 2017 Release, Visual Studio 2019 Debug, Visual
// Studio 2019 Release

void __cdecl __local_unwind4(uint *param_1,int param_2,uint param_3)

{
  undefined4 *puVar1;
  uint uVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 uStack40;
  code *pcStack36;
  uint local_20;
  uint uStack28;
  int iStack24;
  uint *puStack20;
  
  puStack20 = param_1;
  iStack24 = param_2;
  uStack28 = param_3;
  pcStack36 = FUN_6b822a00;
  uStack40 = *in_FS_OFFSET;
  local_20 = DAT_6b8b0140 ^ (uint)&uStack40;
  *in_FS_OFFSET = &uStack40;
  while( true ) {
    uVar2 = *(uint *)(param_2 + 0xc);
    if ((uVar2 == 0xfffffffe) || ((param_3 != 0xfffffffe && (uVar2 <= param_3)))) break;
    puVar1 = (undefined4 *)((*(uint *)(param_2 + 8) ^ *param_1) + 0x10 + uVar2 * 0xc);
    *(undefined4 *)(param_2 + 0xc) = *puVar1;
    if (puVar1[1] == 0) {
      __NLG_Notify(0x101);
      FUN_6b822c94();
    }
  }
  *in_FS_OFFSET = uStack40;
  return;
}



undefined4 __fastcall
FUN_6b822a00(undefined4 param_1,undefined4 param_2,int param_3,uint param_4,undefined4 param_5,
            uint *param_6)

{
  undefined4 uVar1;
  int iVar2;
  
  uVar1 = 1;
  if ((*(uint *)(param_3 + 4) & 6) != 0) {
    iVar2 = FUN_6b8224af(*(uint *)(param_4 + 8) ^ param_4,param_2);
    __local_unwind4(*(uint **)(iVar2 + 0x14),*(int *)(iVar2 + 0x10),*(uint *)(iVar2 + 0xc));
    *param_6 = param_4;
    uVar1 = 3;
  }
  return uVar1;
}



// Library Function - Single Match
//  @_EH4_CallFilterFunc@8
// 
// Library: Visual Studio 2019 Release

void __fastcall __EH4_CallFilterFunc_8(undefined *param_1)

{
  (*(code *)param_1)();
  return;
}



// Library Function - Single Match
//  @_EH4_TransferToHandler@8
// 
// Library: Visual Studio 2019 Release

void __fastcall __EH4_TransferToHandler_8(undefined *UNRECOVERED_JUMPTABLE)

{
  __NLG_Notify(1);
                    // WARNING: Could not recover jumptable at 0x6b822a9f. Too many branches
                    // WARNING: Treating indirect jump as call
  (*(code *)UNRECOVERED_JUMPTABLE)();
  return;
}



// Library Function - Single Match
//  @_EH4_GlobalUnwind@4
// 
// Library: Visual Studio 2019 Release

void __fastcall __EH4_GlobalUnwind_4(PVOID param_1)

{
  RtlUnwind(param_1,(PVOID)0x6b822ab9,(PEXCEPTION_RECORD)0x0,(PVOID)0x0);
  return;
}



// Library Function - Single Match
//  @_EH4_LocalUnwind@16
// 
// Library: Visual Studio 2019 Release

void __fastcall __EH4_LocalUnwind_16(int param_1,uint param_2,undefined4 param_3,uint *param_4)

{
  __local_unwind4(param_4,param_1,param_2);
  return;
}



// WARNING: Removing unreachable block (ram,0x6b822ae8)
// WARNING: Removing unreachable block (ram,0x6b822afd)
// WARNING: Removing unreachable block (ram,0x6b822b02)
// Library Function - Single Match
//  ___except_validate_context_record
// 
// Library: Visual Studio 2019 Release

void __cdecl ___except_validate_context_record(int param_1)

{
  return;
}



// WARNING: Removing unreachable block (ram,0x6b822b1a)
// WARNING: Removing unreachable block (ram,0x6b822b2b)
// WARNING: Removing unreachable block (ram,0x6b822b30)
// WARNING: Removing unreachable block (ram,0x6b822b35)
// WARNING: Removing unreachable block (ram,0x6b822b3e)
// Library Function - Single Match
//  ___except_validate_jump_buffer
// 
// Library: Visual Studio 2019 Release

void __cdecl ___except_validate_jump_buffer(int param_1)

{
  return;
}



// Library Function - Single Match
//  __global_unwind2
// 
// Library: Visual Studio

void __cdecl __global_unwind2(PVOID param_1)

{
  RtlUnwind(param_1,(PVOID)0x6b822b78,(PEXCEPTION_RECORD)0x0,(PVOID)0x0);
  return;
}



undefined4 __fastcall
FUN_6b822b80(undefined4 param_1,undefined4 param_2,int param_3,undefined4 param_4,undefined4 param_5
            ,undefined4 *param_6,uint param_7)

{
  undefined4 uVar1;
  int iVar2;
  
  uVar1 = 1;
  if ((*(uint *)(param_3 + 4) & 6) != 0) {
    iVar2 = FUN_6b8224af(*(uint *)(param_7 - 4) ^ param_7,param_2);
    __local_unwind2(*(int *)(iVar2 + 0x24),*(uint *)(iVar2 + 0x28));
    *param_6 = param_4;
    uVar1 = 3;
  }
  return uVar1;
}



// Library Function - Single Match
//  __local_unwind2
// 
// Libraries: Visual Studio 2017 Debug, Visual Studio 2017 Release, Visual Studio 2019 Debug, Visual
// Studio 2019 Release

void __cdecl __local_unwind2(int param_1,uint param_2)

{
  uint uVar1;
  undefined4 *in_FS_OFFSET;
  undefined4 local_20;
  code *pcStack28;
  undefined4 local_18;
  int iStack20;
  
  iStack20 = param_1;
  pcStack28 = FUN_6b822b80;
  local_20 = *in_FS_OFFSET;
  *in_FS_OFFSET = &local_20;
  while( true ) {
    uVar1 = *(uint *)(param_1 + 0xc);
    if ((uVar1 == 0xffffffff) || ((param_2 != 0xffffffff && (uVar1 <= param_2)))) break;
    local_18 = *(undefined4 *)(*(int *)(param_1 + 8) + uVar1 * 0xc);
    *(undefined4 *)(param_1 + 0xc) = local_18;
    if (*(int *)(*(int *)(param_1 + 8) + 4 + uVar1 * 0xc) == 0) {
      __NLG_Notify(0x101);
      FUN_6b822c94();
    }
  }
  *in_FS_OFFSET = local_20;
  return;
}



// Library Function - Single Match
//  __NLG_Notify
// 
// Libraries: Visual Studio 2017 Debug, Visual Studio 2017 Release, Visual Studio 2019 Debug, Visual
// Studio 2019 Release

void __NLG_Notify(ulong param_1)

{
  undefined4 in_EAX;
  undefined4 unaff_EBP;
  
  DAT_6b8b014c = in_EAX;
  DAT_6b8b0150 = param_1;
  DAT_6b8b0154 = unaff_EBP;
  return;
}



void FUN_6b822c94(void)

{
  code *in_EAX;
  
  (*in_EAX)();
  return;
}



int MulDiv(int nNumber,int nNumerator,int nDenominator)

{
  longlong lVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  
                    // 0x22d30  1012  MulDiv
  uVar4 = nDenominator >> 1;
  if (nNumber < 0) {
    if (nNumerator < 0) {
      lVar1 = (ulonglong)(uint)-nNumber * (ulonglong)(uint)-nNumerator;
      iVar5 = (int)((ulonglong)lVar1 >> 0x20);
      uVar2 = (uint)lVar1;
      if (nDenominator < 0) {
        uVar4 = -nDenominator;
        uVar6 = iVar5 + (uint)CARRY4(uVar2,(int)uVar4 >> 1);
        if ((uVar6 < uVar4) &&
           (iVar5 = (int)(CONCAT44(uVar6,uVar2 + ((int)uVar4 >> 1)) / (ulonglong)uVar4),
           iVar3 = -iVar5, iVar3 == 0 || 0 < iVar5)) {
          return iVar3;
        }
      }
      else {
        uVar6 = iVar5 + (uint)CARRY4(uVar2,uVar4);
        if ((uVar6 < (uint)nDenominator) &&
           (iVar5 = (int)(CONCAT44(uVar6,uVar2 + uVar4) / (ulonglong)(uint)nDenominator), -1 < iVar5
           )) {
          return iVar5;
        }
      }
    }
    else {
      lVar1 = (ulonglong)(uint)-nNumber * (ulonglong)(uint)nNumerator;
      iVar5 = (int)((ulonglong)lVar1 >> 0x20);
      uVar2 = (uint)lVar1;
      if (nDenominator < 0) {
        uVar4 = -nDenominator;
        uVar6 = iVar5 + (uint)CARRY4(uVar2,(int)uVar4 >> 1);
        if ((uVar6 < uVar4) &&
           (iVar5 = (int)(CONCAT44(uVar6,uVar2 + ((int)uVar4 >> 1)) / (ulonglong)uVar4), -1 < iVar5)
           ) {
          return iVar5;
        }
      }
      else {
        uVar6 = iVar5 + (uint)CARRY4(uVar2,uVar4);
        if ((uVar6 < (uint)nDenominator) &&
           (iVar5 = (int)(CONCAT44(uVar6,uVar2 + uVar4) / (ulonglong)(uint)nDenominator),
           iVar3 = -iVar5, iVar3 == 0 || 0 < iVar5)) {
          return iVar3;
        }
      }
    }
    return -1;
  }
  if (nNumerator < 0) {
    iVar5 = (int)((ulonglong)(uint)nNumber * (ulonglong)(uint)-nNumerator >> 0x20);
    uVar2 = (uint)((ulonglong)(uint)nNumber * (ulonglong)(uint)-nNumerator);
    if (nDenominator < 0) {
      uVar4 = -nDenominator;
      uVar6 = iVar5 + (uint)CARRY4(uVar2,(int)uVar4 >> 1);
      if (uVar6 < uVar4) {
        iVar5 = (int)(CONCAT44(uVar6,uVar2 + ((int)uVar4 >> 1)) / (ulonglong)uVar4);
        if (iVar5 < 0) {
          return -1;
        }
        return iVar5;
      }
    }
    else {
      uVar6 = iVar5 + (uint)CARRY4(uVar2,uVar4);
      if ((uVar6 < (uint)nDenominator) &&
         (iVar5 = (int)(CONCAT44(uVar6,uVar2 + uVar4) / (ulonglong)(uint)nDenominator),
         iVar3 = -iVar5, iVar3 == 0 || 0 < iVar5)) {
        return iVar3;
      }
    }
  }
  else {
    iVar5 = (int)((ulonglong)(uint)nNumber * (ulonglong)(uint)nNumerator >> 0x20);
    uVar2 = (uint)((ulonglong)(uint)nNumber * (ulonglong)(uint)nNumerator);
    if (-1 < nDenominator) {
      uVar6 = iVar5 + (uint)CARRY4(uVar2,uVar4);
      if ((uVar6 < (uint)nDenominator) &&
         (iVar5 = (int)(CONCAT44(uVar6,uVar2 + uVar4) / (ulonglong)(uint)nDenominator), -1 < iVar5))
      {
        return iVar5;
      }
      return -1;
    }
    uVar4 = -nDenominator;
    uVar6 = iVar5 + (uint)CARRY4(uVar2,(int)uVar4 >> 1);
    if ((uVar6 < uVar4) &&
       (iVar5 = (int)(CONCAT44(uVar6,uVar2 + ((int)uVar4 >> 1)) / (ulonglong)uVar4), iVar3 = -iVar5,
       iVar3 == 0 || 0 < iVar5)) {
      return iVar3;
    }
  }
  return -1;
}



void BaseFormatObjectAttributes(void)

{
                    // WARNING: Could not recover jumptable at 0x6b822e60. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22e60  59  BaseFormatObjectAttributes
  BaseFormatObjectAttributes();
  return;
}



BOOL GetVolumeNameForVolumeMountPointW
               (LPCWSTR lpszVolumeMountPoint,LPWSTR lpszVolumeName,DWORD cchBufferLength)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b822e70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22e70  806  GetVolumeNameForVolumeMountPointW
  BVar1 = GetVolumeNameForVolumeMountPointW(lpszVolumeMountPoint,lpszVolumeName,cchBufferLength);
  return BVar1;
}



HANDLE GetCurrentProcess(void)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b822e80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22e80  541  GetCurrentProcess
  pvVar1 = GetCurrentProcess();
  return pvVar1;
}



DWORD GetCurrentProcessId(void)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b822e90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22e90  542  GetCurrentProcessId
  DVar1 = GetCurrentProcessId();
  return DVar1;
}



void GetProcessInformation(void)

{
                    // WARNING: Could not recover jumptable at 0x6b822ea0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22ea0  702  GetProcessInformation
  GetProcessInformation();
  return;
}



void GetThreadInformation(void)

{
                    // WARNING: Could not recover jumptable at 0x6b822eb0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22eb0  772  GetThreadInformation
  GetThreadInformation();
  return;
}



void SetProcessInformation(void)

{
                    // WARNING: Could not recover jumptable at 0x6b822ec0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22ec0  1351  SetProcessInformation
  SetProcessInformation();
  return;
}



void SetThreadInformation(void)

{
                    // WARNING: Could not recover jumptable at 0x6b822ed0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22ed0  1377  SetThreadInformation
  SetThreadInformation();
  return;
}



BOOL CloseHandle(HANDLE hObject)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b822ee0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22ee0  140  CloseHandle
  BVar1 = CloseHandle(hObject);
  return BVar1;
}



BOOL DuplicateHandle(HANDLE hSourceProcessHandle,HANDLE hSourceHandle,HANDLE hTargetProcessHandle,
                    LPHANDLE lpTargetHandle,DWORD dwDesiredAccess,BOOL bInheritHandle,
                    DWORD dwOptions)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b822ef0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22ef0  305  DuplicateHandle
  BVar1 = DuplicateHandle(hSourceProcessHandle,hSourceHandle,hTargetProcessHandle,lpTargetHandle,
                          dwDesiredAccess,bInheritHandle,dwOptions);
  return BVar1;
}



BOOL GetHandleInformation(HANDLE hObject,LPDWORD lpdwFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b822f00. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22f00  612  GetHandleInformation
  BVar1 = GetHandleInformation(hObject,lpdwFlags);
  return BVar1;
}



BOOL SetHandleInformation(HANDLE hObject,DWORD dwMask,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b822f10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22f10  1330  SetHandleInformation
  BVar1 = SetHandleInformation(hObject,dwMask,dwFlags);
  return BVar1;
}



BOOL CancelWaitableTimer(HANDLE hTimer)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b822f20. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22f20  123  CancelWaitableTimer
  BVar1 = CancelWaitableTimer(hTimer);
  return BVar1;
}



HANDLE CreateEventA(LPSECURITY_ATTRIBUTES lpEventAttributes,BOOL bManualReset,BOOL bInitialState,
                   LPCSTR lpName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b822f30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22f30  194  CreateEventA
  pvVar1 = CreateEventA(lpEventAttributes,bManualReset,bInitialState,lpName);
  return pvVar1;
}



HANDLE CreateEventExA(LPSECURITY_ATTRIBUTES lpEventAttributes,LPCSTR lpName,DWORD dwFlags,
                     DWORD dwDesiredAccess)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b822f40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22f40  195  CreateEventExA
  pvVar1 = CreateEventExA(lpEventAttributes,lpName,dwFlags,dwDesiredAccess);
  return pvVar1;
}



HANDLE CreateEventExW(LPSECURITY_ATTRIBUTES lpEventAttributes,LPCWSTR lpName,DWORD dwFlags,
                     DWORD dwDesiredAccess)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b822f50. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22f50  196  CreateEventExW
  pvVar1 = CreateEventExW(lpEventAttributes,lpName,dwFlags,dwDesiredAccess);
  return pvVar1;
}



HANDLE CreateEventW(LPSECURITY_ATTRIBUTES lpEventAttributes,BOOL bManualReset,BOOL bInitialState,
                   LPCWSTR lpName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b822f60. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22f60  197  CreateEventW
  pvVar1 = CreateEventW(lpEventAttributes,bManualReset,bInitialState,lpName);
  return pvVar1;
}



HANDLE CreateMutexA(LPSECURITY_ATTRIBUTES lpMutexAttributes,BOOL bInitialOwner,LPCSTR lpName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b822f70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22f70  221  CreateMutexA
  pvVar1 = CreateMutexA(lpMutexAttributes,bInitialOwner,lpName);
  return pvVar1;
}



HANDLE CreateMutexExA(LPSECURITY_ATTRIBUTES lpMutexAttributes,LPCSTR lpName,DWORD dwFlags,
                     DWORD dwDesiredAccess)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b822f80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22f80  222  CreateMutexExA
  pvVar1 = CreateMutexExA(lpMutexAttributes,lpName,dwFlags,dwDesiredAccess);
  return pvVar1;
}



HANDLE CreateMutexExW(LPSECURITY_ATTRIBUTES lpMutexAttributes,LPCWSTR lpName,DWORD dwFlags,
                     DWORD dwDesiredAccess)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b822f90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22f90  223  CreateMutexExW
  pvVar1 = CreateMutexExW(lpMutexAttributes,lpName,dwFlags,dwDesiredAccess);
  return pvVar1;
}



HANDLE CreateMutexW(LPSECURITY_ATTRIBUTES lpMutexAttributes,BOOL bInitialOwner,LPCWSTR lpName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b822fa0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22fa0  224  CreateMutexW
  pvVar1 = CreateMutexW(lpMutexAttributes,bInitialOwner,lpName);
  return pvVar1;
}



HANDLE CreateSemaphoreExW(LPSECURITY_ATTRIBUTES lpSemaphoreAttributes,LONG lInitialCount,
                         LONG lMaximumCount,LPCWSTR lpName,DWORD dwFlags,DWORD dwDesiredAccess)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b822fb0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22fb0  241  CreateSemaphoreExW
  pvVar1 = CreateSemaphoreExW(lpSemaphoreAttributes,lInitialCount,lMaximumCount,lpName,dwFlags,
                              dwDesiredAccess);
  return pvVar1;
}



HANDLE CreateSemaphoreW(LPSECURITY_ATTRIBUTES lpSemaphoreAttributes,LONG lInitialCount,
                       LONG lMaximumCount,LPCWSTR lpName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b822fc0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22fc0  242  CreateSemaphoreW
  pvVar1 = CreateSemaphoreW(lpSemaphoreAttributes,lInitialCount,lMaximumCount,lpName);
  return pvVar1;
}



HANDLE CreateWaitableTimerExW
                 (LPSECURITY_ATTRIBUTES lpTimerAttributes,LPCWSTR lpTimerName,DWORD dwFlags,
                 DWORD dwDesiredAccess)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b822fd0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22fd0  261  CreateWaitableTimerExW
  pvVar1 = CreateWaitableTimerExW(lpTimerAttributes,lpTimerName,dwFlags,dwDesiredAccess);
  return pvVar1;
}



BOOL InitializeCriticalSectionAndSpinCount(LPCRITICAL_SECTION lpCriticalSection,DWORD dwSpinCount)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b822fe0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22fe0  869  InitializeCriticalSectionAndSpinCount
  BVar1 = InitializeCriticalSectionAndSpinCount(lpCriticalSection,dwSpinCount);
  return BVar1;
}



BOOL InitializeCriticalSectionEx(LPCRITICAL_SECTION lpCriticalSection,DWORD dwSpinCount,DWORD Flags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b822ff0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22ff0  870  InitializeCriticalSectionEx
  BVar1 = InitializeCriticalSectionEx(lpCriticalSection,dwSpinCount,Flags);
  return BVar1;
}



HANDLE OpenEventA(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCSTR lpName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823000. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23000  1028  OpenEventA
  pvVar1 = OpenEventA(dwDesiredAccess,bInheritHandle,lpName);
  return pvVar1;
}



HANDLE OpenEventW(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCWSTR lpName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823010. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23010  1029  OpenEventW
  pvVar1 = OpenEventW(dwDesiredAccess,bInheritHandle,lpName);
  return pvVar1;
}



HANDLE OpenMutexW(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCWSTR lpName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823020. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23020  1037  OpenMutexW
  pvVar1 = OpenMutexW(dwDesiredAccess,bInheritHandle,lpName);
  return pvVar1;
}



HANDLE OpenSemaphoreW(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCWSTR lpName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823030. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23030  1045  OpenSemaphoreW
  pvVar1 = OpenSemaphoreW(dwDesiredAccess,bInheritHandle,lpName);
  return pvVar1;
}



HANDLE OpenWaitableTimerW(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCWSTR lpTimerName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823040. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23040  1051  OpenWaitableTimerW
  pvVar1 = OpenWaitableTimerW(dwDesiredAccess,bInheritHandle,lpTimerName);
  return pvVar1;
}



BOOL ReleaseMutex(HANDLE hMutex)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823050. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23050  1204  ReleaseMutex
  BVar1 = ReleaseMutex(hMutex);
  return BVar1;
}



BOOL ReleaseSemaphore(HANDLE hSemaphore,LONG lReleaseCount,LPLONG lpPreviousCount)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823060. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23060  1208  ReleaseSemaphore
  BVar1 = ReleaseSemaphore(hSemaphore,lReleaseCount,lpPreviousCount);
  return BVar1;
}



BOOL ResetEvent(HANDLE hEvent)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823070. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23070  1226  ResetEvent
  BVar1 = ResetEvent(hEvent);
  return BVar1;
}



BOOL SetEvent(HANDLE hEvent)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823080. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23080  1306  SetEvent
  BVar1 = SetEvent(hEvent);
  return BVar1;
}



BOOL SetWaitableTimer(HANDLE hTimer,LARGE_INTEGER *lpDueTime,LONG lPeriod,
                     PTIMERAPCROUTINE pfnCompletionRoutine,LPVOID lpArgToCompletionRoutine,
                     BOOL fResume)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823090. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23090  1404  SetWaitableTimer
  BVar1 = SetWaitableTimer(hTimer,lpDueTime,lPeriod,pfnCompletionRoutine,lpArgToCompletionRoutine,
                           fResume);
  return BVar1;
}



DWORD SleepEx(DWORD dwMilliseconds,BOOL bAlertable)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8230a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x230a0  1414  SleepEx
  DVar1 = SleepEx(dwMilliseconds,bAlertable);
  return DVar1;
}



DWORD WaitForMultipleObjects(DWORD nCount,HANDLE *lpHandles,BOOL bWaitAll,DWORD dwMilliseconds)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8230b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x230b0  1499  WaitForMultipleObjects
  DVar1 = WaitForMultipleObjects(nCount,lpHandles,bWaitAll,dwMilliseconds);
  return DVar1;
}



DWORD WaitForMultipleObjectsEx
                (DWORD nCount,HANDLE *lpHandles,BOOL bWaitAll,DWORD dwMilliseconds,BOOL bAlertable)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8230c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x230c0  1500  WaitForMultipleObjectsEx
  DVar1 = WaitForMultipleObjectsEx(nCount,lpHandles,bWaitAll,dwMilliseconds,bAlertable);
  return DVar1;
}



DWORD WaitForSingleObject(HANDLE hHandle,DWORD dwMilliseconds)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8230d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x230d0  1501  WaitForSingleObject
  DVar1 = WaitForSingleObject(hHandle,dwMilliseconds);
  return DVar1;
}



DWORD WaitForSingleObjectEx(HANDLE hHandle,DWORD dwMilliseconds,BOOL bAlertable)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8230e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x230e0  1502  WaitForSingleObjectEx
  DVar1 = WaitForSingleObjectEx(hHandle,dwMilliseconds,bAlertable);
  return DVar1;
}



LONG CompareFileTime(FILETIME *lpFileTime1,FILETIME *lpFileTime2)

{
  LONG LVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8230f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x230f0  157  CompareFileTime
  LVar1 = CompareFileTime(lpFileTime1,lpFileTime2);
  return LVar1;
}



BOOL CreateDirectoryA(LPCSTR lpPathName,LPSECURITY_ATTRIBUTES lpSecurityAttributes)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823100. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23100  187  CreateDirectoryA
  BVar1 = CreateDirectoryA(lpPathName,lpSecurityAttributes);
  return BVar1;
}



BOOL CreateDirectoryW(LPCWSTR lpPathName,LPSECURITY_ATTRIBUTES lpSecurityAttributes)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823110. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23110  192  CreateDirectoryW
  BVar1 = CreateDirectoryW(lpPathName,lpSecurityAttributes);
  return BVar1;
}



void CreateFile2(void)

{
                    // WARNING: Could not recover jumptable at 0x6b823120. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23120  200  CreateFile2
  CreateFile2();
  return;
}



HANDLE CreateFileA(LPCSTR lpFileName,DWORD dwDesiredAccess,DWORD dwShareMode,
                  LPSECURITY_ATTRIBUTES lpSecurityAttributes,DWORD dwCreationDisposition,
                  DWORD dwFlagsAndAttributes,HANDLE hTemplateFile)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823130. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23130  201  CreateFileA
  pvVar1 = CreateFileA(lpFileName,dwDesiredAccess,dwShareMode,lpSecurityAttributes,
                       dwCreationDisposition,dwFlagsAndAttributes,hTemplateFile);
  return pvVar1;
}



HANDLE CreateFileW(LPCWSTR lpFileName,DWORD dwDesiredAccess,DWORD dwShareMode,
                  LPSECURITY_ATTRIBUTES lpSecurityAttributes,DWORD dwCreationDisposition,
                  DWORD dwFlagsAndAttributes,HANDLE hTemplateFile)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823140. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23140  209  CreateFileW
  pvVar1 = CreateFileW(lpFileName,dwDesiredAccess,dwShareMode,lpSecurityAttributes,
                       dwCreationDisposition,dwFlagsAndAttributes,hTemplateFile);
  return pvVar1;
}



BOOL DefineDosDeviceW(DWORD dwFlags,LPCWSTR lpDeviceName,LPCWSTR lpTargetPath)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823150. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23150  274  DefineDosDeviceW
  BVar1 = DefineDosDeviceW(dwFlags,lpDeviceName,lpTargetPath);
  return BVar1;
}



BOOL DeleteFileA(LPCSTR lpFileName)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823160. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23160  280  DeleteFileA
  BVar1 = DeleteFileA(lpFileName);
  return BVar1;
}



BOOL DeleteFileW(LPCWSTR lpFileName)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823170. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23170  283  DeleteFileW
  BVar1 = DeleteFileW(lpFileName);
  return BVar1;
}



BOOL DeleteVolumeMountPointW(LPCWSTR lpszVolumeMountPoint)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823180. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23180  290  DeleteVolumeMountPointW
  BVar1 = DeleteVolumeMountPointW(lpszVolumeMountPoint);
  return BVar1;
}



BOOL FileTimeToLocalFileTime(FILETIME *lpFileTime,LPFILETIME lpLocalFileTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823190. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23190  367  FileTimeToLocalFileTime
  BVar1 = FileTimeToLocalFileTime(lpFileTime,lpLocalFileTime);
  return BVar1;
}



BOOL FindClose(HANDLE hFindFile)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8231a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x231a0  379  FindClose
  BVar1 = FindClose(hFindFile);
  return BVar1;
}



BOOL FindCloseChangeNotification(HANDLE hChangeHandle)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8231b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x231b0  380  FindCloseChangeNotification
  BVar1 = FindCloseChangeNotification(hChangeHandle);
  return BVar1;
}



HANDLE FindFirstChangeNotificationA(LPCSTR lpPathName,BOOL bWatchSubtree,DWORD dwNotifyFilter)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8231c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x231c0  381  FindFirstChangeNotificationA
  pvVar1 = FindFirstChangeNotificationA(lpPathName,bWatchSubtree,dwNotifyFilter);
  return pvVar1;
}



HANDLE FindFirstChangeNotificationW(LPCWSTR lpPathName,BOOL bWatchSubtree,DWORD dwNotifyFilter)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8231d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x231d0  382  FindFirstChangeNotificationW
  pvVar1 = FindFirstChangeNotificationW(lpPathName,bWatchSubtree,dwNotifyFilter);
  return pvVar1;
}



HANDLE FindFirstFileA(LPCSTR lpFileName,LPWIN32_FIND_DATAA lpFindFileData)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8231e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x231e0  383  FindFirstFileA
  pvVar1 = FindFirstFileA(lpFileName,lpFindFileData);
  return pvVar1;
}



HANDLE FindFirstFileExA(LPCSTR lpFileName,FINDEX_INFO_LEVELS fInfoLevelId,LPVOID lpFindFileData,
                       FINDEX_SEARCH_OPS fSearchOp,LPVOID lpSearchFilter,DWORD dwAdditionalFlags)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8231f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x231f0  384  FindFirstFileExA
  pvVar1 = FindFirstFileExA(lpFileName,fInfoLevelId,lpFindFileData,fSearchOp,lpSearchFilter,
                            dwAdditionalFlags);
  return pvVar1;
}



HANDLE FindFirstFileExW(LPCWSTR lpFileName,FINDEX_INFO_LEVELS fInfoLevelId,LPVOID lpFindFileData,
                       FINDEX_SEARCH_OPS fSearchOp,LPVOID lpSearchFilter,DWORD dwAdditionalFlags)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823200. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23200  385  FindFirstFileExW
  pvVar1 = FindFirstFileExW(lpFileName,fInfoLevelId,lpFindFileData,fSearchOp,lpSearchFilter,
                            dwAdditionalFlags);
  return pvVar1;
}



HANDLE FindFirstFileNameW(LPCWSTR lpFileName,DWORD dwFlags,LPDWORD StringLength,PWCHAR LinkName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823210. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23210  387  FindFirstFileNameW
  pvVar1 = FindFirstFileNameW(lpFileName,dwFlags,StringLength,LinkName);
  return pvVar1;
}



HANDLE FindFirstFileW(LPCWSTR lpFileName,LPWIN32_FIND_DATAW lpFindFileData)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823220. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23220  390  FindFirstFileW
  pvVar1 = FindFirstFileW(lpFileName,lpFindFileData);
  return pvVar1;
}



HANDLE FindFirstVolumeW(LPWSTR lpszVolumeName,DWORD cchBufferLength)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823230. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23230  396  FindFirstVolumeW
  pvVar1 = FindFirstVolumeW(lpszVolumeName,cchBufferLength);
  return pvVar1;
}



BOOL FindNextChangeNotification(HANDLE hChangeHandle)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823240. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23240  399  FindNextChangeNotification
  BVar1 = FindNextChangeNotification(hChangeHandle);
  return BVar1;
}



BOOL FindNextFileA(HANDLE hFindFile,LPWIN32_FIND_DATAA lpFindFileData)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823250. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23250  400  FindNextFileA
  BVar1 = FindNextFileA(hFindFile,lpFindFileData);
  return BVar1;
}



BOOL FindNextFileNameW(HANDLE hFindStream,LPDWORD StringLength,PWCHAR LinkName)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823260. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23260  401  FindNextFileNameW
  BVar1 = FindNextFileNameW(hFindStream,StringLength,LinkName);
  return BVar1;
}



BOOL FindNextFileW(HANDLE hFindFile,LPWIN32_FIND_DATAW lpFindFileData)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823270. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23270  402  FindNextFileW
  BVar1 = FindNextFileW(hFindFile,lpFindFileData);
  return BVar1;
}



BOOL FindNextVolumeW(HANDLE hFindVolume,LPWSTR lpszVolumeName,DWORD cchBufferLength)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823280. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23280  407  FindNextVolumeW
  BVar1 = FindNextVolumeW(hFindVolume,lpszVolumeName,cchBufferLength);
  return BVar1;
}



BOOL FindVolumeClose(HANDLE hFindVolume)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823290. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23290  414  FindVolumeClose
  BVar1 = FindVolumeClose(hFindVolume);
  return BVar1;
}



BOOL FlushFileBuffers(HANDLE hFile)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8232a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x232a0  421  FlushFileBuffers
  BVar1 = FlushFileBuffers(hFile);
  return BVar1;
}



BOOL GetDiskFreeSpaceA(LPCSTR lpRootPathName,LPDWORD lpSectorsPerCluster,LPDWORD lpBytesPerSector,
                      LPDWORD lpNumberOfFreeClusters,LPDWORD lpTotalNumberOfClusters)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8232b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x232b0  556  GetDiskFreeSpaceA
  BVar1 = GetDiskFreeSpaceA(lpRootPathName,lpSectorsPerCluster,lpBytesPerSector,
                            lpNumberOfFreeClusters,lpTotalNumberOfClusters);
  return BVar1;
}



BOOL GetDiskFreeSpaceExA(LPCSTR lpDirectoryName,PULARGE_INTEGER lpFreeBytesAvailableToCaller,
                        PULARGE_INTEGER lpTotalNumberOfBytes,
                        PULARGE_INTEGER lpTotalNumberOfFreeBytes)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8232c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x232c0  557  GetDiskFreeSpaceExA
  BVar1 = GetDiskFreeSpaceExA(lpDirectoryName,lpFreeBytesAvailableToCaller,lpTotalNumberOfBytes,
                              lpTotalNumberOfFreeBytes);
  return BVar1;
}



BOOL GetDiskFreeSpaceExW(LPCWSTR lpDirectoryName,PULARGE_INTEGER lpFreeBytesAvailableToCaller,
                        PULARGE_INTEGER lpTotalNumberOfBytes,
                        PULARGE_INTEGER lpTotalNumberOfFreeBytes)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8232d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x232d0  558  GetDiskFreeSpaceExW
  BVar1 = GetDiskFreeSpaceExW(lpDirectoryName,lpFreeBytesAvailableToCaller,lpTotalNumberOfBytes,
                              lpTotalNumberOfFreeBytes);
  return BVar1;
}



BOOL GetDiskFreeSpaceW(LPCWSTR lpRootPathName,LPDWORD lpSectorsPerCluster,LPDWORD lpBytesPerSector,
                      LPDWORD lpNumberOfFreeClusters,LPDWORD lpTotalNumberOfClusters)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8232e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x232e0  559  GetDiskFreeSpaceW
  BVar1 = GetDiskFreeSpaceW(lpRootPathName,lpSectorsPerCluster,lpBytesPerSector,
                            lpNumberOfFreeClusters,lpTotalNumberOfClusters);
  return BVar1;
}



UINT GetDriveTypeA(LPCSTR lpRootPathName)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8232f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x232f0  564  GetDriveTypeA
  UVar1 = GetDriveTypeA(lpRootPathName);
  return UVar1;
}



UINT GetDriveTypeW(LPCWSTR lpRootPathName)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823300. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23300  565  GetDriveTypeW
  UVar1 = GetDriveTypeW(lpRootPathName);
  return UVar1;
}



DWORD GetFileAttributesA(LPCSTR lpFileName)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823310. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23310  582  GetFileAttributesA
  DVar1 = GetFileAttributesA(lpFileName);
  return DVar1;
}



BOOL GetFileAttributesExA
               (LPCSTR lpFileName,GET_FILEEX_INFO_LEVELS fInfoLevelId,LPVOID lpFileInformation)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823320. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23320  583  GetFileAttributesExA
  BVar1 = GetFileAttributesExA(lpFileName,fInfoLevelId,lpFileInformation);
  return BVar1;
}



BOOL GetFileAttributesExW
               (LPCWSTR lpFileName,GET_FILEEX_INFO_LEVELS fInfoLevelId,LPVOID lpFileInformation)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823330. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23330  584  GetFileAttributesExW
  BVar1 = GetFileAttributesExW(lpFileName,fInfoLevelId,lpFileInformation);
  return BVar1;
}



DWORD GetFileAttributesW(LPCWSTR lpFileName)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823340. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23340  587  GetFileAttributesW
  DVar1 = GetFileAttributesW(lpFileName);
  return DVar1;
}



BOOL GetFileInformationByHandle(HANDLE hFile,LPBY_HANDLE_FILE_INFORMATION lpFileInformation)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823350. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23350  589  GetFileInformationByHandle
  BVar1 = GetFileInformationByHandle(hFile,lpFileInformation);
  return BVar1;
}



DWORD GetFileSize(HANDLE hFile,LPDWORD lpFileSizeHigh)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823360. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23360  593  GetFileSize
  DVar1 = GetFileSize(hFile,lpFileSizeHigh);
  return DVar1;
}



BOOL GetFileSizeEx(HANDLE hFile,PLARGE_INTEGER lpFileSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823370. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23370  594  GetFileSizeEx
  BVar1 = GetFileSizeEx(hFile,lpFileSize);
  return BVar1;
}



BOOL GetFileTime(HANDLE hFile,LPFILETIME lpCreationTime,LPFILETIME lpLastAccessTime,
                LPFILETIME lpLastWriteTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823380. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23380  595  GetFileTime
  BVar1 = GetFileTime(hFile,lpCreationTime,lpLastAccessTime,lpLastWriteTime);
  return BVar1;
}



DWORD GetFileType(HANDLE hFile)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823390. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23390  596  GetFileType
  DVar1 = GetFileType(hFile);
  return DVar1;
}



DWORD GetFinalPathNameByHandleA(HANDLE hFile,LPSTR lpszFilePath,DWORD cchFilePath,DWORD dwFlags)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8233a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x233a0  597  GetFinalPathNameByHandleA
  DVar1 = GetFinalPathNameByHandleA(hFile,lpszFilePath,cchFilePath,dwFlags);
  return DVar1;
}



DWORD GetFinalPathNameByHandleW(HANDLE hFile,LPWSTR lpszFilePath,DWORD cchFilePath,DWORD dwFlags)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8233b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x233b0  598  GetFinalPathNameByHandleW
  DVar1 = GetFinalPathNameByHandleW(hFile,lpszFilePath,cchFilePath,dwFlags);
  return DVar1;
}



DWORD GetFullPathNameA(LPCSTR lpFileName,DWORD nBufferLength,LPSTR lpBuffer,LPSTR *lpFilePart)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8233c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x233c0  604  GetFullPathNameA
  DVar1 = GetFullPathNameA(lpFileName,nBufferLength,lpBuffer,lpFilePart);
  return DVar1;
}



DWORD GetFullPathNameW(LPCWSTR lpFileName,DWORD nBufferLength,LPWSTR lpBuffer,LPWSTR *lpFilePart)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8233d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x233d0  607  GetFullPathNameW
  DVar1 = GetFullPathNameW(lpFileName,nBufferLength,lpBuffer,lpFilePart);
  return DVar1;
}



DWORD GetLogicalDriveStringsW(DWORD nBufferLength,LPWSTR lpBuffer)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8233e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x233e0  621  GetLogicalDriveStringsW
  DVar1 = GetLogicalDriveStringsW(nBufferLength,lpBuffer);
  return DVar1;
}



UINT GetTempFileNameA(LPCSTR lpPathName,LPCSTR lpPrefixString,UINT uUnique,LPSTR lpTempFileName)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8233f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x233f0  761  GetTempFileNameA
  UVar1 = GetTempFileNameA(lpPathName,lpPrefixString,uUnique,lpTempFileName);
  return UVar1;
}



UINT GetTempFileNameW(LPCWSTR lpPathName,LPCWSTR lpPrefixString,UINT uUnique,LPWSTR lpTempFileName)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823400. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23400  762  GetTempFileNameW
  UVar1 = GetTempFileNameW(lpPathName,lpPrefixString,uUnique,lpTempFileName);
  return UVar1;
}



DWORD GetTempPathA(DWORD nBufferLength,LPSTR lpBuffer)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823410. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23410  763  GetTempPathA
  DVar1 = GetTempPathA(nBufferLength,lpBuffer);
  return DVar1;
}



DWORD GetTempPathW(DWORD nBufferLength,LPWSTR lpBuffer)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823420. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23420  764  GetTempPathW
  DVar1 = GetTempPathW(nBufferLength,lpBuffer);
  return DVar1;
}



BOOL GetVolumeInformationA
               (LPCSTR lpRootPathName,LPSTR lpVolumeNameBuffer,DWORD nVolumeNameSize,
               LPDWORD lpVolumeSerialNumber,LPDWORD lpMaximumComponentLength,
               LPDWORD lpFileSystemFlags,LPSTR lpFileSystemNameBuffer,DWORD nFileSystemNameSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823430. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23430  802  GetVolumeInformationA
  BVar1 = GetVolumeInformationA
                    (lpRootPathName,lpVolumeNameBuffer,nVolumeNameSize,lpVolumeSerialNumber,
                     lpMaximumComponentLength,lpFileSystemFlags,lpFileSystemNameBuffer,
                     nFileSystemNameSize);
  return BVar1;
}



BOOL GetVolumeInformationByHandleW
               (HANDLE hFile,LPWSTR lpVolumeNameBuffer,DWORD nVolumeNameSize,
               LPDWORD lpVolumeSerialNumber,LPDWORD lpMaximumComponentLength,
               LPDWORD lpFileSystemFlags,LPWSTR lpFileSystemNameBuffer,DWORD nFileSystemNameSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823440. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23440  803  GetVolumeInformationByHandleW
  BVar1 = GetVolumeInformationByHandleW
                    (hFile,lpVolumeNameBuffer,nVolumeNameSize,lpVolumeSerialNumber,
                     lpMaximumComponentLength,lpFileSystemFlags,lpFileSystemNameBuffer,
                     nFileSystemNameSize);
  return BVar1;
}



BOOL GetVolumeInformationW
               (LPCWSTR lpRootPathName,LPWSTR lpVolumeNameBuffer,DWORD nVolumeNameSize,
               LPDWORD lpVolumeSerialNumber,LPDWORD lpMaximumComponentLength,
               LPDWORD lpFileSystemFlags,LPWSTR lpFileSystemNameBuffer,DWORD nFileSystemNameSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823450. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23450  804  GetVolumeInformationW
  BVar1 = GetVolumeInformationW
                    (lpRootPathName,lpVolumeNameBuffer,nVolumeNameSize,lpVolumeSerialNumber,
                     lpMaximumComponentLength,lpFileSystemFlags,lpFileSystemNameBuffer,
                     nFileSystemNameSize);
  return BVar1;
}



BOOL GetVolumePathNameW(LPCWSTR lpszFileName,LPWSTR lpszVolumePathName,DWORD cchBufferLength)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823460. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23460  808  GetVolumePathNameW
  BVar1 = GetVolumePathNameW(lpszFileName,lpszVolumePathName,cchBufferLength);
  return BVar1;
}



BOOL GetVolumePathNamesForVolumeNameW
               (LPCWSTR lpszVolumeName,LPWCH lpszVolumePathNames,DWORD cchBufferLength,
               PDWORD lpcchReturnLength)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823470. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23470  810  GetVolumePathNamesForVolumeNameW
  BVar1 = GetVolumePathNamesForVolumeNameW
                    (lpszVolumeName,lpszVolumePathNames,cchBufferLength,lpcchReturnLength);
  return BVar1;
}



BOOL LocalFileTimeToFileTime(FILETIME *lpLocalFileTime,LPFILETIME lpFileTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823480. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23480  978  LocalFileTimeToFileTime
  BVar1 = LocalFileTimeToFileTime(lpLocalFileTime,lpFileTime);
  return BVar1;
}



BOOL LockFile(HANDLE hFile,DWORD dwFileOffsetLow,DWORD dwFileOffsetHigh,
             DWORD nNumberOfBytesToLockLow,DWORD nNumberOfBytesToLockHigh)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823490. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23490  991  LockFile
  BVar1 = LockFile(hFile,dwFileOffsetLow,dwFileOffsetHigh,nNumberOfBytesToLockLow,
                   nNumberOfBytesToLockHigh);
  return BVar1;
}



BOOL LockFileEx(HANDLE hFile,DWORD dwFlags,DWORD dwReserved,DWORD nNumberOfBytesToLockLow,
               DWORD nNumberOfBytesToLockHigh,LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8234a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x234a0  992  LockFileEx
  BVar1 = LockFileEx(hFile,dwFlags,dwReserved,nNumberOfBytesToLockLow,nNumberOfBytesToLockHigh,
                     lpOverlapped);
  return BVar1;
}



DWORD QueryDosDeviceW(LPCWSTR lpDeviceName,LPWSTR lpTargetPath,DWORD ucchMax)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8234b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x234b0  1097  QueryDosDeviceW
  DVar1 = QueryDosDeviceW(lpDeviceName,lpTargetPath,ucchMax);
  return DVar1;
}



BOOL ReadFile(HANDLE hFile,LPVOID lpBuffer,DWORD nNumberOfBytesToRead,LPDWORD lpNumberOfBytesRead,
             LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8234c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x234c0  1143  ReadFile
  BVar1 = ReadFile(hFile,lpBuffer,nNumberOfBytesToRead,lpNumberOfBytesRead,lpOverlapped);
  return BVar1;
}



BOOL ReadFileEx(HANDLE hFile,LPVOID lpBuffer,DWORD nNumberOfBytesToRead,LPOVERLAPPED lpOverlapped,
               LPOVERLAPPED_COMPLETION_ROUTINE lpCompletionRoutine)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8234d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x234d0  1144  ReadFileEx
  BVar1 = ReadFileEx(hFile,lpBuffer,nNumberOfBytesToRead,lpOverlapped,lpCompletionRoutine);
  return BVar1;
}



BOOL ReadFileScatter(HANDLE hFile,FILE_SEGMENT_ELEMENT *aSegmentArray,DWORD nNumberOfBytesToRead,
                    LPDWORD lpReserved,LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8234e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x234e0  1145  ReadFileScatter
  BVar1 = ReadFileScatter(hFile,aSegmentArray,nNumberOfBytesToRead,lpReserved,lpOverlapped);
  return BVar1;
}



BOOL RemoveDirectoryA(LPCSTR lpPathName)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8234f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x234f0  1210  RemoveDirectoryA
  BVar1 = RemoveDirectoryA(lpPathName);
  return BVar1;
}



BOOL RemoveDirectoryW(LPCWSTR lpPathName)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823500. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23500  1213  RemoveDirectoryW
  BVar1 = RemoveDirectoryW(lpPathName);
  return BVar1;
}



BOOL SetEndOfFile(HANDLE hFile)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823510. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23510  1300  SetEndOfFile
  BVar1 = SetEndOfFile(hFile);
  return BVar1;
}



BOOL SetFileAttributesA(LPCSTR lpFileName,DWORD dwFileAttributes)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823520. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23520  1310  SetFileAttributesA
  BVar1 = SetFileAttributesA(lpFileName,dwFileAttributes);
  return BVar1;
}



BOOL SetFileAttributesW(LPCWSTR lpFileName,DWORD dwFileAttributes)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823530. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23530  1313  SetFileAttributesW
  BVar1 = SetFileAttributesW(lpFileName,dwFileAttributes);
  return BVar1;
}



BOOL SetFileInformationByHandle
               (HANDLE hFile,FILE_INFO_BY_HANDLE_CLASS FileInformationClass,LPVOID lpFileInformation
               ,DWORD dwBufferSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823540. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23540  1316  SetFileInformationByHandle
  BVar1 = SetFileInformationByHandle(hFile,FileInformationClass,lpFileInformation,dwBufferSize);
  return BVar1;
}



DWORD SetFilePointer(HANDLE hFile,LONG lDistanceToMove,PLONG lpDistanceToMoveHigh,DWORD dwMoveMethod
                    )

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823550. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23550  1318  SetFilePointer
  DVar1 = SetFilePointer(hFile,lDistanceToMove,lpDistanceToMoveHigh,dwMoveMethod);
  return DVar1;
}



BOOL SetFilePointerEx(HANDLE hFile,LARGE_INTEGER liDistanceToMove,PLARGE_INTEGER lpNewFilePointer,
                     DWORD dwMoveMethod)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823560. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23560  1319  SetFilePointerEx
  BVar1 = SetFilePointerEx(hFile,liDistanceToMove,lpNewFilePointer,dwMoveMethod);
  return BVar1;
}



BOOL SetFileTime(HANDLE hFile,FILETIME *lpCreationTime,FILETIME *lpLastAccessTime,
                FILETIME *lpLastWriteTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823570. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23570  1322  SetFileTime
  BVar1 = SetFileTime(hFile,lpCreationTime,lpLastAccessTime,lpLastWriteTime);
  return BVar1;
}



BOOL SetFileValidData(HANDLE hFile,LONGLONG ValidDataLength)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823580. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23580  1323  SetFileValidData
  BVar1 = SetFileValidData(hFile,ValidDataLength);
  return BVar1;
}



BOOL UnlockFile(HANDLE hFile,DWORD dwFileOffsetLow,DWORD dwFileOffsetHigh,
               DWORD nNumberOfBytesToUnlockLow,DWORD nNumberOfBytesToUnlockHigh)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823590. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23590  1460  UnlockFile
  BVar1 = UnlockFile(hFile,dwFileOffsetLow,dwFileOffsetHigh,nNumberOfBytesToUnlockLow,
                     nNumberOfBytesToUnlockHigh);
  return BVar1;
}



BOOL UnlockFileEx(HANDLE hFile,DWORD dwReserved,DWORD nNumberOfBytesToUnlockLow,
                 DWORD nNumberOfBytesToUnlockHigh,LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8235a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x235a0  1461  UnlockFileEx
  BVar1 = UnlockFileEx(hFile,dwReserved,nNumberOfBytesToUnlockLow,nNumberOfBytesToUnlockHigh,
                       lpOverlapped);
  return BVar1;
}



BOOL WriteFile(HANDLE hFile,LPCVOID lpBuffer,DWORD nNumberOfBytesToWrite,
              LPDWORD lpNumberOfBytesWritten,LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8235b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x235b0  1560  WriteFile
  BVar1 = WriteFile(hFile,lpBuffer,nNumberOfBytesToWrite,lpNumberOfBytesWritten,lpOverlapped);
  return BVar1;
}



BOOL WriteFileEx(HANDLE hFile,LPCVOID lpBuffer,DWORD nNumberOfBytesToWrite,LPOVERLAPPED lpOverlapped
                ,LPOVERLAPPED_COMPLETION_ROUTINE lpCompletionRoutine)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8235c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x235c0  1561  WriteFileEx
  BVar1 = WriteFileEx(hFile,lpBuffer,nNumberOfBytesToWrite,lpOverlapped,lpCompletionRoutine);
  return BVar1;
}



BOOL WriteFileGather(HANDLE hFile,FILE_SEGMENT_ELEMENT *aSegmentArray,DWORD nNumberOfBytesToWrite,
                    LPDWORD lpReserved,LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8235d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x235d0  1562  WriteFileGather
  BVar1 = WriteFileGather(hFile,aSegmentArray,nNumberOfBytesToWrite,lpReserved,lpOverlapped);
  return BVar1;
}



BOOL EnumResourceNamesW(HMODULE hModule,LPCWSTR lpType,ENUMRESNAMEPROCW lpEnumFunc,LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8235e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x235e0  332  EnumResourceNamesW
  BVar1 = EnumResourceNamesW(hModule,lpType,lpEnumFunc,lParam);
  return BVar1;
}



void LoadPackagedLibrary(void)

{
                    // WARNING: Could not recover jumptable at 0x6b8235f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x235f0  972  LoadPackagedLibrary
  LoadPackagedLibrary();
  return;
}



BOOL CallNamedPipeW(LPCWSTR lpNamedPipeName,LPVOID lpInBuffer,DWORD nInBufferSize,LPVOID lpOutBuffer
                   ,DWORD nOutBufferSize,LPDWORD lpBytesRead,DWORD nTimeOut)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823600. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23600  115  CallNamedPipeW
  BVar1 = CallNamedPipeW(lpNamedPipeName,lpInBuffer,nInBufferSize,lpOutBuffer,nOutBufferSize,
                         lpBytesRead,nTimeOut);
  return BVar1;
}



void GetSystemTimePreciseAsFileTime(void)

{
                    // WARNING: Could not recover jumptable at 0x6b823610. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23610  752  GetSystemTimePreciseAsFileTime
  GetSystemTimePreciseAsFileTime();
  return;
}



BOOL FileTimeToSystemTime(FILETIME *lpFileTime,LPSYSTEMTIME lpSystemTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823620. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23620  368  FileTimeToSystemTime
  BVar1 = FileTimeToSystemTime(lpFileTime,lpSystemTime);
  return BVar1;
}



int GetCalendarInfoEx(LPCWSTR lpLocaleName,CALID Calendar,LPCWSTR lpReserved,CALTYPE CalType,
                     LPWSTR lpCalData,int cchData,LPDWORD lpValue)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823630. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23630  464  GetCalendarInfoEx
  iVar1 = GetCalendarInfoEx(lpLocaleName,Calendar,lpReserved,CalType,lpCalData,cchData,lpValue);
  return iVar1;
}



int GetCalendarInfoW(LCID Locale,CALID Calendar,CALTYPE CalType,LPWSTR lpCalData,int cchData,
                    LPDWORD lpValue)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823640. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23640  465  GetCalendarInfoW
  iVar1 = GetCalendarInfoW(Locale,Calendar,CalType,lpCalData,cchData,lpValue);
  return iVar1;
}



void NlsCheckPolicy(void)

{
                    // WARNING: Could not recover jumptable at 0x6b823650. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23650  1016  NlsCheckPolicy
  NlsCheckPolicy();
  return;
}



void NlsGetCacheUpdateCount(void)

{
                    // WARNING: Could not recover jumptable at 0x6b823660. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23660  1017  NlsGetCacheUpdateCount
  NlsGetCacheUpdateCount();
  return;
}



void NlsUpdateLocale(void)

{
                    // WARNING: Could not recover jumptable at 0x6b823670. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23670  1018  NlsUpdateLocale
  NlsUpdateLocale();
  return;
}



void NlsUpdateSystemLocale(void)

{
                    // WARNING: Could not recover jumptable at 0x6b823680. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23680  1019  NlsUpdateSystemLocale
  NlsUpdateSystemLocale();
  return;
}



LPCH GetEnvironmentStringsA(void)

{
  LPCH pCVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823690. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23690  572  GetEnvironmentStringsA
  pCVar1 = GetEnvironmentStrings();
  return pCVar1;
}



BOOL ClearCommBreak(HANDLE hFile)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8236a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x236a0  137  ClearCommBreak
  BVar1 = ClearCommBreak(hFile);
  return BVar1;
}



BOOL ClearCommError(HANDLE hFile,LPDWORD lpErrors,LPCOMSTAT lpStat)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8236b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x236b0  138  ClearCommError
  BVar1 = ClearCommError(hFile,lpErrors,lpStat);
  return BVar1;
}



BOOL EscapeCommFunction(HANDLE hFile,DWORD dwFunc)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8236c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x236c0  355  EscapeCommFunction
  BVar1 = EscapeCommFunction(hFile,dwFunc);
  return BVar1;
}



BOOL GetCommConfig(HANDLE hCommDev,LPCOMMCONFIG lpCC,LPDWORD lpdwSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8236d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x236d0  470  GetCommConfig
  BVar1 = GetCommConfig(hCommDev,lpCC,lpdwSize);
  return BVar1;
}



BOOL GetCommMask(HANDLE hFile,LPDWORD lpEvtMask)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8236e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x236e0  471  GetCommMask
  BVar1 = GetCommMask(hFile,lpEvtMask);
  return BVar1;
}



BOOL GetCommModemStatus(HANDLE hFile,LPDWORD lpModemStat)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8236f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x236f0  472  GetCommModemStatus
  BVar1 = GetCommModemStatus(hFile,lpModemStat);
  return BVar1;
}



BOOL GetCommProperties(HANDLE hFile,LPCOMMPROP lpCommProp)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823700. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23700  473  GetCommProperties
  BVar1 = GetCommProperties(hFile,lpCommProp);
  return BVar1;
}



BOOL GetCommState(HANDLE hFile,LPDCB lpDCB)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823710. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23710  474  GetCommState
  BVar1 = GetCommState(hFile,lpDCB);
  return BVar1;
}



BOOL GetCommTimeouts(HANDLE hFile,LPCOMMTIMEOUTS lpCommTimeouts)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823720. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23720  475  GetCommTimeouts
  BVar1 = GetCommTimeouts(hFile,lpCommTimeouts);
  return BVar1;
}



BOOL PurgeComm(HANDLE hFile,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823730. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23730  1090  PurgeComm
  BVar1 = PurgeComm(hFile,dwFlags);
  return BVar1;
}



BOOL SetCommBreak(HANDLE hFile)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823740. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23740  1249  SetCommBreak
  BVar1 = SetCommBreak(hFile);
  return BVar1;
}



BOOL SetCommConfig(HANDLE hCommDev,LPCOMMCONFIG lpCC,DWORD dwSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823750. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23750  1250  SetCommConfig
  BVar1 = SetCommConfig(hCommDev,lpCC,dwSize);
  return BVar1;
}



BOOL SetCommMask(HANDLE hFile,DWORD dwEvtMask)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823760. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23760  1251  SetCommMask
  BVar1 = SetCommMask(hFile,dwEvtMask);
  return BVar1;
}



BOOL SetCommState(HANDLE hFile,LPDCB lpDCB)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823770. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23770  1252  SetCommState
  BVar1 = SetCommState(hFile,lpDCB);
  return BVar1;
}



BOOL SetCommTimeouts(HANDLE hFile,LPCOMMTIMEOUTS lpCommTimeouts)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823780. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23780  1253  SetCommTimeouts
  BVar1 = SetCommTimeouts(hFile,lpCommTimeouts);
  return BVar1;
}



BOOL SetupComm(HANDLE hFile,DWORD dwInQueue,DWORD dwOutQueue)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823790. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23790  1407  SetupComm
  BVar1 = SetupComm(hFile,dwInQueue,dwOutQueue);
  return BVar1;
}



BOOL TransmitCommChar(HANDLE hFile,char cChar)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8237a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x237a0  1450  TransmitCommChar
  BVar1 = TransmitCommChar(hFile,cChar);
  return BVar1;
}



BOOL WaitCommEvent(HANDLE hFile,LPDWORD lpEvtMask,LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8237b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x237b0  1496  WaitCommEvent
  BVar1 = WaitCommEvent(hFile,lpEvtMask,lpOverlapped);
  return BVar1;
}



UINT GetSystemWow64DirectoryA(LPSTR lpBuffer,UINT uSize)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8237c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x237c0  756  GetSystemWow64DirectoryA
  UVar1 = GetSystemWow64DirectoryA(lpBuffer,uSize);
  return UVar1;
}



UINT GetSystemWow64DirectoryW(LPWSTR lpBuffer,UINT uSize)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8237d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x237d0  757  GetSystemWow64DirectoryW
  UVar1 = GetSystemWow64DirectoryW(lpBuffer,uSize);
  return UVar1;
}



BOOL CopyFileW(LPCWSTR lpExistingFileName,LPCWSTR lpNewFileName,BOOL bFailIfExists)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8237e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x237e0  179  CopyFileW
  BVar1 = CopyFileW(lpExistingFileName,lpNewFileName,bFailIfExists);
  return BVar1;
}



BOOL ConvertFiberToThread(void)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8237f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x237f0  167  ConvertFiberToThread
  BVar1 = ConvertFiberToThread();
  return BVar1;
}



LPVOID ConvertThreadToFiber(LPVOID lpParameter)

{
  LPVOID pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823800. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23800  170  ConvertThreadToFiber
  pvVar1 = ConvertThreadToFiber(lpParameter);
  return pvVar1;
}



LPVOID ConvertThreadToFiberEx(LPVOID lpParameter,DWORD dwFlags)

{
  LPVOID pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823810. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23810  171  ConvertThreadToFiberEx
  pvVar1 = ConvertThreadToFiberEx(lpParameter,dwFlags);
  return pvVar1;
}



LPVOID CreateFiber(SIZE_T dwStackSize,LPFIBER_START_ROUTINE lpStartAddress,LPVOID lpParameter)

{
  LPVOID pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823820. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23820  198  CreateFiber
  pvVar1 = CreateFiber(dwStackSize,lpStartAddress,lpParameter);
  return pvVar1;
}



LPVOID CreateFiberEx(SIZE_T dwStackCommitSize,SIZE_T dwStackReserveSize,DWORD dwFlags,
                    LPFIBER_START_ROUTINE lpStartAddress,LPVOID lpParameter)

{
  LPVOID pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823830. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23830  199  CreateFiberEx
  pvVar1 = CreateFiberEx(dwStackCommitSize,dwStackReserveSize,dwFlags,lpStartAddress,lpParameter);
  return pvVar1;
}



void DeleteFiber(LPVOID lpFiber)

{
                    // WARNING: Could not recover jumptable at 0x6b823840. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23840  279  DeleteFiber
  DeleteFiber(lpFiber);
  return;
}



void SwitchToFiber(LPVOID lpFiber)

{
                    // WARNING: Could not recover jumptable at 0x6b823850. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23850  1420  SwitchToFiber
  SwitchToFiber(lpFiber);
  return;
}



BOOL AllocConsole(void)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823860. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23860  25  AllocConsole
  BVar1 = AllocConsole();
  return BVar1;
}



BOOL AttachConsole(DWORD dwProcessId)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823870. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23870  41  AttachConsole
  BVar1 = AttachConsole(dwProcessId);
  return BVar1;
}



void ClosePseudoConsole(void)

{
                    // WARNING: Could not recover jumptable at 0x6b823880. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23880  144  ClosePseudoConsole
  ClosePseudoConsole();
  return;
}



void CreatePseudoConsole(void)

{
                    // WARNING: Could not recover jumptable at 0x6b823890. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23890  236  CreatePseudoConsole
  CreatePseudoConsole();
  return;
}



BOOL FreeConsole(void)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8238a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x238a0  430  FreeConsole
  BVar1 = FreeConsole();
  return BVar1;
}



UINT GetConsoleCP(void)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8238b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x238b0  496  GetConsoleCP
  UVar1 = GetConsoleCP();
  return UVar1;
}



BOOL GetConsoleMode(HANDLE hConsoleHandle,LPDWORD lpMode)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8238c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x238c0  514  GetConsoleMode
  BVar1 = GetConsoleMode(hConsoleHandle,lpMode);
  return BVar1;
}



UINT GetConsoleOutputCP(void)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8238d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x238d0  518  GetConsoleOutputCP
  UVar1 = GetConsoleOutputCP();
  return UVar1;
}



BOOL GetNumberOfConsoleInputEvents(HANDLE hConsoleInput,LPDWORD lpNumberOfEvents)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8238e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x238e0  667  GetNumberOfConsoleInputEvents
  BVar1 = GetNumberOfConsoleInputEvents(hConsoleInput,lpNumberOfEvents);
  return BVar1;
}



BOOL PeekConsoleInputA(HANDLE hConsoleInput,PINPUT_RECORD lpBuffer,DWORD nLength,
                      LPDWORD lpNumberOfEventsRead)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8238f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x238f0  1060  PeekConsoleInputA
  BVar1 = PeekConsoleInputA(hConsoleInput,lpBuffer,nLength,lpNumberOfEventsRead);
  return BVar1;
}



BOOL PeekConsoleInputW(HANDLE hConsoleInput,PINPUT_RECORD lpBuffer,DWORD nLength,
                      LPDWORD lpNumberOfEventsRead)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823900. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23900  1061  PeekConsoleInputW
  BVar1 = PeekConsoleInputW(hConsoleInput,lpBuffer,nLength,lpNumberOfEventsRead);
  return BVar1;
}



BOOL ReadConsoleA(HANDLE hConsoleInput,LPVOID lpBuffer,DWORD nNumberOfCharsToRead,
                 LPDWORD lpNumberOfCharsRead,PCONSOLE_READCONSOLE_CONTROL pInputControl)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823910. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23910  1130  ReadConsoleA
  BVar1 = ReadConsoleA(hConsoleInput,lpBuffer,nNumberOfCharsToRead,lpNumberOfCharsRead,pInputControl
                      );
  return BVar1;
}



BOOL ReadConsoleInputA(HANDLE hConsoleInput,PINPUT_RECORD lpBuffer,DWORD nLength,
                      LPDWORD lpNumberOfEventsRead)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823920. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23920  1131  ReadConsoleInputA
  BVar1 = ReadConsoleInputA(hConsoleInput,lpBuffer,nLength,lpNumberOfEventsRead);
  return BVar1;
}



BOOL ReadConsoleInputW(HANDLE hConsoleInput,PINPUT_RECORD lpBuffer,DWORD nLength,
                      LPDWORD lpNumberOfEventsRead)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823930. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23930  1134  ReadConsoleInputW
  BVar1 = ReadConsoleInputW(hConsoleInput,lpBuffer,nLength,lpNumberOfEventsRead);
  return BVar1;
}



BOOL ReadConsoleW(HANDLE hConsoleInput,LPVOID lpBuffer,DWORD nNumberOfCharsToRead,
                 LPDWORD lpNumberOfCharsRead,PCONSOLE_READCONSOLE_CONTROL pInputControl)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823940. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23940  1140  ReadConsoleW
  BVar1 = ReadConsoleW(hConsoleInput,lpBuffer,nNumberOfCharsToRead,lpNumberOfCharsRead,pInputControl
                      );
  return BVar1;
}



void ResizePseudoConsole(void)

{
                    // WARNING: Could not recover jumptable at 0x6b823950. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23950  1228  ResizePseudoConsole
  ResizePseudoConsole();
  return;
}



BOOL SetConsoleCtrlHandler(PHANDLER_ROUTINE HandlerRoutine,BOOL Add)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823960. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23960  1261  SetConsoleCtrlHandler
  BVar1 = SetConsoleCtrlHandler(HandlerRoutine,Add);
  return BVar1;
}



BOOL SetConsoleMode(HANDLE hConsoleHandle,DWORD dwMode)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823970. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23970  1277  SetConsoleMode
  BVar1 = SetConsoleMode(hConsoleHandle,dwMode);
  return BVar1;
}



BOOL WriteConsoleA(HANDLE hConsoleOutput,void *lpBuffer,DWORD nNumberOfCharsToWrite,
                  LPDWORD lpNumberOfCharsWritten,LPVOID lpReserved)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823980. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23980  1549  WriteConsoleA
  BVar1 = WriteConsoleA(hConsoleOutput,lpBuffer,nNumberOfCharsToWrite,lpNumberOfCharsWritten,
                        lpReserved);
  return BVar1;
}



BOOL WriteConsoleW(HANDLE hConsoleOutput,void *lpBuffer,DWORD nNumberOfCharsToWrite,
                  LPDWORD lpNumberOfCharsWritten,LPVOID lpReserved)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823990. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23990  1559  WriteConsoleW
  BVar1 = WriteConsoleW(hConsoleOutput,lpBuffer,nNumberOfCharsToWrite,lpNumberOfCharsWritten,
                        lpReserved);
  return BVar1;
}



HANDLE CreateConsoleScreenBuffer
                 (DWORD dwDesiredAccess,DWORD dwShareMode,SECURITY_ATTRIBUTES *lpSecurityAttributes,
                 DWORD dwFlags,LPVOID lpScreenBufferData)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8239a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x239a0  186  CreateConsoleScreenBuffer
  pvVar1 = CreateConsoleScreenBuffer
                     (dwDesiredAccess,dwShareMode,lpSecurityAttributes,dwFlags,lpScreenBufferData);
  return pvVar1;
}



BOOL FillConsoleOutputAttribute
               (HANDLE hConsoleOutput,WORD wAttribute,DWORD nLength,COORD dwWriteCoord,
               LPDWORD lpNumberOfAttrsWritten)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8239b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x239b0  369  FillConsoleOutputAttribute
  BVar1 = FillConsoleOutputAttribute
                    (hConsoleOutput,wAttribute,nLength,dwWriteCoord,lpNumberOfAttrsWritten);
  return BVar1;
}



BOOL FillConsoleOutputCharacterA
               (HANDLE hConsoleOutput,CHAR cCharacter,DWORD nLength,COORD dwWriteCoord,
               LPDWORD lpNumberOfCharsWritten)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8239c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x239c0  370  FillConsoleOutputCharacterA
  BVar1 = FillConsoleOutputCharacterA
                    (hConsoleOutput,cCharacter,nLength,dwWriteCoord,lpNumberOfCharsWritten);
  return BVar1;
}



BOOL FillConsoleOutputCharacterW
               (HANDLE hConsoleOutput,WCHAR cCharacter,DWORD nLength,COORD dwWriteCoord,
               LPDWORD lpNumberOfCharsWritten)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8239d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x239d0  371  FillConsoleOutputCharacterW
  BVar1 = FillConsoleOutputCharacterW
                    (hConsoleOutput,cCharacter,nLength,dwWriteCoord,lpNumberOfCharsWritten);
  return BVar1;
}



BOOL FlushConsoleInputBuffer(HANDLE hConsoleInput)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8239e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x239e0  420  FlushConsoleInputBuffer
  BVar1 = FlushConsoleInputBuffer(hConsoleInput);
  return BVar1;
}



BOOL GenerateConsoleCtrlEvent(DWORD dwCtrlEvent,DWORD dwProcessGroupId)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8239f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x239f0  439  GenerateConsoleCtrlEvent
  BVar1 = GenerateConsoleCtrlEvent(dwCtrlEvent,dwProcessGroupId);
  return BVar1;
}



BOOL GetConsoleCursorInfo(HANDLE hConsoleOutput,PCONSOLE_CURSOR_INFO lpConsoleCursorInfo)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823a00. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23a00  502  GetConsoleCursorInfo
  BVar1 = GetConsoleCursorInfo(hConsoleOutput,lpConsoleCursorInfo);
  return BVar1;
}



DWORD GetConsoleOriginalTitleA(LPSTR lpConsoleTitle,DWORD nSize)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823a10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23a10  516  GetConsoleOriginalTitleA
  DVar1 = GetConsoleOriginalTitleA(lpConsoleTitle,nSize);
  return DVar1;
}



DWORD GetConsoleOriginalTitleW(LPWSTR lpConsoleTitle,DWORD nSize)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823a20. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23a20  517  GetConsoleOriginalTitleW
  DVar1 = GetConsoleOriginalTitleW(lpConsoleTitle,nSize);
  return DVar1;
}



BOOL GetConsoleScreenBufferInfo
               (HANDLE hConsoleOutput,PCONSOLE_SCREEN_BUFFER_INFO lpConsoleScreenBufferInfo)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823a30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23a30  520  GetConsoleScreenBufferInfo
  BVar1 = GetConsoleScreenBufferInfo(hConsoleOutput,lpConsoleScreenBufferInfo);
  return BVar1;
}



BOOL GetConsoleScreenBufferInfoEx
               (HANDLE hConsoleOutput,PCONSOLE_SCREEN_BUFFER_INFOEX lpConsoleScreenBufferInfoEx)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823a40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23a40  521  GetConsoleScreenBufferInfoEx
  BVar1 = GetConsoleScreenBufferInfoEx(hConsoleOutput,lpConsoleScreenBufferInfoEx);
  return BVar1;
}



DWORD GetConsoleTitleA(LPSTR lpConsoleTitle,DWORD nSize)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823a50. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23a50  523  GetConsoleTitleA
  DVar1 = GetConsoleTitleA(lpConsoleTitle,nSize);
  return DVar1;
}



DWORD GetConsoleTitleW(LPWSTR lpConsoleTitle,DWORD nSize)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823a60. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23a60  524  GetConsoleTitleW
  DVar1 = GetConsoleTitleW(lpConsoleTitle,nSize);
  return DVar1;
}



COORD GetLargestConsoleWindowSize(HANDLE hConsoleOutput)

{
  COORD CVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823a70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23a70  614  GetLargestConsoleWindowSize
  CVar1 = GetLargestConsoleWindowSize(hConsoleOutput);
  return CVar1;
}



BOOL ReadConsoleOutputA(HANDLE hConsoleOutput,PCHAR_INFO lpBuffer,COORD dwBufferSize,
                       COORD dwBufferCoord,PSMALL_RECT lpReadRegion)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823a80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23a80  1135  ReadConsoleOutputA
  BVar1 = ReadConsoleOutputA(hConsoleOutput,lpBuffer,dwBufferSize,dwBufferCoord,lpReadRegion);
  return BVar1;
}



BOOL ReadConsoleOutputAttribute
               (HANDLE hConsoleOutput,LPWORD lpAttribute,DWORD nLength,COORD dwReadCoord,
               LPDWORD lpNumberOfAttrsRead)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823a90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23a90  1136  ReadConsoleOutputAttribute
  BVar1 = ReadConsoleOutputAttribute
                    (hConsoleOutput,lpAttribute,nLength,dwReadCoord,lpNumberOfAttrsRead);
  return BVar1;
}



BOOL ReadConsoleOutputCharacterA
               (HANDLE hConsoleOutput,LPSTR lpCharacter,DWORD nLength,COORD dwReadCoord,
               LPDWORD lpNumberOfCharsRead)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823aa0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23aa0  1137  ReadConsoleOutputCharacterA
  BVar1 = ReadConsoleOutputCharacterA
                    (hConsoleOutput,lpCharacter,nLength,dwReadCoord,lpNumberOfCharsRead);
  return BVar1;
}



BOOL ReadConsoleOutputCharacterW
               (HANDLE hConsoleOutput,LPWSTR lpCharacter,DWORD nLength,COORD dwReadCoord,
               LPDWORD lpNumberOfCharsRead)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823ab0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23ab0  1138  ReadConsoleOutputCharacterW
  BVar1 = ReadConsoleOutputCharacterW
                    (hConsoleOutput,lpCharacter,nLength,dwReadCoord,lpNumberOfCharsRead);
  return BVar1;
}



BOOL ReadConsoleOutputW(HANDLE hConsoleOutput,PCHAR_INFO lpBuffer,COORD dwBufferSize,
                       COORD dwBufferCoord,PSMALL_RECT lpReadRegion)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823ac0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23ac0  1139  ReadConsoleOutputW
  BVar1 = ReadConsoleOutputW(hConsoleOutput,lpBuffer,dwBufferSize,dwBufferCoord,lpReadRegion);
  return BVar1;
}



BOOL ScrollConsoleScreenBufferA
               (HANDLE hConsoleOutput,SMALL_RECT *lpScrollRectangle,SMALL_RECT *lpClipRectangle,
               COORD dwDestinationOrigin,CHAR_INFO *lpFill)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823ad0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23ad0  1241  ScrollConsoleScreenBufferA
  BVar1 = ScrollConsoleScreenBufferA
                    (hConsoleOutput,lpScrollRectangle,lpClipRectangle,dwDestinationOrigin,lpFill);
  return BVar1;
}



BOOL ScrollConsoleScreenBufferW
               (HANDLE hConsoleOutput,SMALL_RECT *lpScrollRectangle,SMALL_RECT *lpClipRectangle,
               COORD dwDestinationOrigin,CHAR_INFO *lpFill)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823ae0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23ae0  1242  ScrollConsoleScreenBufferW
  BVar1 = ScrollConsoleScreenBufferW
                    (hConsoleOutput,lpScrollRectangle,lpClipRectangle,dwDestinationOrigin,lpFill);
  return BVar1;
}



BOOL SetConsoleActiveScreenBuffer(HANDLE hConsoleOutput)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823af0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23af0  1259  SetConsoleActiveScreenBuffer
  BVar1 = SetConsoleActiveScreenBuffer(hConsoleOutput);
  return BVar1;
}



BOOL SetConsoleCP(UINT wCodePageID)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823b00. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23b00  1260  SetConsoleCP
  BVar1 = SetConsoleCP(wCodePageID);
  return BVar1;
}



BOOL SetConsoleCursorInfo(HANDLE hConsoleOutput,CONSOLE_CURSOR_INFO *lpConsoleCursorInfo)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823b10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23b10  1263  SetConsoleCursorInfo
  BVar1 = SetConsoleCursorInfo(hConsoleOutput,lpConsoleCursorInfo);
  return BVar1;
}



BOOL SetConsoleCursorPosition(HANDLE hConsoleOutput,COORD dwCursorPosition)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823b20. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23b20  1265  SetConsoleCursorPosition
  BVar1 = SetConsoleCursorPosition(hConsoleOutput,dwCursorPosition);
  return BVar1;
}



BOOL SetConsoleOutputCP(UINT wCodePageID)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823b30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23b30  1282  SetConsoleOutputCP
  BVar1 = SetConsoleOutputCP(wCodePageID);
  return BVar1;
}



BOOL SetConsoleScreenBufferInfoEx
               (HANDLE hConsoleOutput,PCONSOLE_SCREEN_BUFFER_INFOEX lpConsoleScreenBufferInfoEx)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823b40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23b40  1284  SetConsoleScreenBufferInfoEx
  BVar1 = SetConsoleScreenBufferInfoEx(hConsoleOutput,lpConsoleScreenBufferInfoEx);
  return BVar1;
}



BOOL SetConsoleScreenBufferSize(HANDLE hConsoleOutput,COORD dwSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823b50. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23b50  1285  SetConsoleScreenBufferSize
  BVar1 = SetConsoleScreenBufferSize(hConsoleOutput,dwSize);
  return BVar1;
}



BOOL SetConsoleTextAttribute(HANDLE hConsoleOutput,WORD wAttributes)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823b60. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23b60  1286  SetConsoleTextAttribute
  BVar1 = SetConsoleTextAttribute(hConsoleOutput,wAttributes);
  return BVar1;
}



BOOL SetConsoleTitleA(LPCSTR lpConsoleTitle)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823b70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23b70  1287  SetConsoleTitleA
  BVar1 = SetConsoleTitleA(lpConsoleTitle);
  return BVar1;
}



BOOL SetConsoleTitleW(LPCWSTR lpConsoleTitle)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823b80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23b80  1288  SetConsoleTitleW
  BVar1 = SetConsoleTitleW(lpConsoleTitle);
  return BVar1;
}



BOOL SetConsoleWindowInfo(HANDLE hConsoleOutput,BOOL bAbsolute,SMALL_RECT *lpConsoleWindow)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823b90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23b90  1289  SetConsoleWindowInfo
  BVar1 = SetConsoleWindowInfo(hConsoleOutput,bAbsolute,lpConsoleWindow);
  return BVar1;
}



BOOL WriteConsoleInputA(HANDLE hConsoleInput,INPUT_RECORD *lpBuffer,DWORD nLength,
                       LPDWORD lpNumberOfEventsWritten)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823ba0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23ba0  1550  WriteConsoleInputA
  BVar1 = WriteConsoleInputA(hConsoleInput,lpBuffer,nLength,lpNumberOfEventsWritten);
  return BVar1;
}



BOOL WriteConsoleInputW(HANDLE hConsoleInput,INPUT_RECORD *lpBuffer,DWORD nLength,
                       LPDWORD lpNumberOfEventsWritten)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823bb0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23bb0  1553  WriteConsoleInputW
  BVar1 = WriteConsoleInputW(hConsoleInput,lpBuffer,nLength,lpNumberOfEventsWritten);
  return BVar1;
}



BOOL WriteConsoleOutputA(HANDLE hConsoleOutput,CHAR_INFO *lpBuffer,COORD dwBufferSize,
                        COORD dwBufferCoord,PSMALL_RECT lpWriteRegion)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823bc0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23bc0  1554  WriteConsoleOutputA
  BVar1 = WriteConsoleOutputA(hConsoleOutput,lpBuffer,dwBufferSize,dwBufferCoord,lpWriteRegion);
  return BVar1;
}



BOOL WriteConsoleOutputAttribute
               (HANDLE hConsoleOutput,WORD *lpAttribute,DWORD nLength,COORD dwWriteCoord,
               LPDWORD lpNumberOfAttrsWritten)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823bd0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23bd0  1555  WriteConsoleOutputAttribute
  BVar1 = WriteConsoleOutputAttribute
                    (hConsoleOutput,lpAttribute,nLength,dwWriteCoord,lpNumberOfAttrsWritten);
  return BVar1;
}



BOOL WriteConsoleOutputCharacterA
               (HANDLE hConsoleOutput,LPCSTR lpCharacter,DWORD nLength,COORD dwWriteCoord,
               LPDWORD lpNumberOfCharsWritten)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823be0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23be0  1556  WriteConsoleOutputCharacterA
  BVar1 = WriteConsoleOutputCharacterA
                    (hConsoleOutput,lpCharacter,nLength,dwWriteCoord,lpNumberOfCharsWritten);
  return BVar1;
}



BOOL WriteConsoleOutputCharacterW
               (HANDLE hConsoleOutput,LPCWSTR lpCharacter,DWORD nLength,COORD dwWriteCoord,
               LPDWORD lpNumberOfCharsWritten)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823bf0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23bf0  1557  WriteConsoleOutputCharacterW
  BVar1 = WriteConsoleOutputCharacterW
                    (hConsoleOutput,lpCharacter,nLength,dwWriteCoord,lpNumberOfCharsWritten);
  return BVar1;
}



BOOL WriteConsoleOutputW(HANDLE hConsoleOutput,CHAR_INFO *lpBuffer,COORD dwBufferSize,
                        COORD dwBufferCoord,PSMALL_RECT lpWriteRegion)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823c00. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23c00  1558  WriteConsoleOutputW
  BVar1 = WriteConsoleOutputW(hConsoleOutput,lpBuffer,dwBufferSize,dwBufferCoord,lpWriteRegion);
  return BVar1;
}



BOOL AddConsoleAliasA(LPSTR Source,LPSTR Target,LPSTR ExeName)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823c10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23c10  10  AddConsoleAliasA
  BVar1 = AddConsoleAliasA(Source,Target,ExeName);
  return BVar1;
}



BOOL AddConsoleAliasW(LPWSTR Source,LPWSTR Target,LPWSTR ExeName)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823c20. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23c20  11  AddConsoleAliasW
  BVar1 = AddConsoleAliasW(Source,Target,ExeName);
  return BVar1;
}



void ExpungeConsoleCommandHistoryA(void)

{
                    // WARNING: Could not recover jumptable at 0x6b823c30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23c30  361  ExpungeConsoleCommandHistoryA
  ExpungeConsoleCommandHistoryA();
  return;
}



void ExpungeConsoleCommandHistoryW(void)

{
                    // WARNING: Could not recover jumptable at 0x6b823c40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23c40  362  ExpungeConsoleCommandHistoryW
  ExpungeConsoleCommandHistoryW();
  return;
}



DWORD GetConsoleAliasA(LPSTR Source,LPSTR TargetBuffer,DWORD TargetBufferLength,LPSTR ExeName)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823c50. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23c50  486  GetConsoleAliasA
  DVar1 = GetConsoleAliasA(Source,TargetBuffer,TargetBufferLength,ExeName);
  return DVar1;
}



DWORD GetConsoleAliasExesA(LPSTR ExeNameBuffer,DWORD ExeNameBufferLength)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823c60. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23c60  487  GetConsoleAliasExesA
  DVar1 = GetConsoleAliasExesA(ExeNameBuffer,ExeNameBufferLength);
  return DVar1;
}



DWORD GetConsoleAliasExesLengthA(void)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823c70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23c70  488  GetConsoleAliasExesLengthA
  DVar1 = GetConsoleAliasExesLengthA();
  return DVar1;
}



DWORD GetConsoleAliasExesLengthW(void)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823c80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23c80  489  GetConsoleAliasExesLengthW
  DVar1 = GetConsoleAliasExesLengthW();
  return DVar1;
}



DWORD GetConsoleAliasExesW(LPWSTR ExeNameBuffer,DWORD ExeNameBufferLength)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823c90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23c90  490  GetConsoleAliasExesW
  DVar1 = GetConsoleAliasExesW(ExeNameBuffer,ExeNameBufferLength);
  return DVar1;
}



DWORD GetConsoleAliasW(LPWSTR Source,LPWSTR TargetBuffer,DWORD TargetBufferLength,LPWSTR ExeName)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823ca0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23ca0  491  GetConsoleAliasW
  DVar1 = GetConsoleAliasW(Source,TargetBuffer,TargetBufferLength,ExeName);
  return DVar1;
}



DWORD GetConsoleAliasesA(LPSTR AliasBuffer,DWORD AliasBufferLength,LPSTR ExeName)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823cb0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23cb0  492  GetConsoleAliasesA
  DVar1 = GetConsoleAliasesA(AliasBuffer,AliasBufferLength,ExeName);
  return DVar1;
}



DWORD GetConsoleAliasesLengthA(LPSTR ExeName)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823cc0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23cc0  493  GetConsoleAliasesLengthA
  DVar1 = GetConsoleAliasesLengthA(ExeName);
  return DVar1;
}



DWORD GetConsoleAliasesLengthW(LPWSTR ExeName)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823cd0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23cd0  494  GetConsoleAliasesLengthW
  DVar1 = GetConsoleAliasesLengthW(ExeName);
  return DVar1;
}



DWORD GetConsoleAliasesW(LPWSTR AliasBuffer,DWORD AliasBufferLength,LPWSTR ExeName)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823ce0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23ce0  495  GetConsoleAliasesW
  DVar1 = GetConsoleAliasesW(AliasBuffer,AliasBufferLength,ExeName);
  return DVar1;
}



void GetConsoleCommandHistoryA(void)

{
                    // WARNING: Could not recover jumptable at 0x6b823cf0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23cf0  498  GetConsoleCommandHistoryA
  GetConsoleCommandHistoryA();
  return;
}



void GetConsoleCommandHistoryLengthA(void)

{
                    // WARNING: Could not recover jumptable at 0x6b823d00. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23d00  499  GetConsoleCommandHistoryLengthA
  GetConsoleCommandHistoryLengthA();
  return;
}



void GetConsoleCommandHistoryLengthW(void)

{
                    // WARNING: Could not recover jumptable at 0x6b823d10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23d10  500  GetConsoleCommandHistoryLengthW
  GetConsoleCommandHistoryLengthW();
  return;
}



void GetConsoleCommandHistoryW(void)

{
                    // WARNING: Could not recover jumptable at 0x6b823d20. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23d20  501  GetConsoleCommandHistoryW
  GetConsoleCommandHistoryW();
  return;
}



BOOL GetConsoleDisplayMode(LPDWORD lpModeFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823d30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23d30  504  GetConsoleDisplayMode
  BVar1 = GetConsoleDisplayMode(lpModeFlags);
  return BVar1;
}



COORD GetConsoleFontSize(HANDLE hConsoleOutput,DWORD nFont)

{
  COORD CVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823d40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23d40  506  GetConsoleFontSize
  CVar1 = GetConsoleFontSize(hConsoleOutput,nFont);
  return CVar1;
}



BOOL GetConsoleHistoryInfo(PCONSOLE_HISTORY_INFO lpConsoleHistoryInfo)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823d50. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23d50  508  GetConsoleHistoryInfo
  BVar1 = GetConsoleHistoryInfo(lpConsoleHistoryInfo);
  return BVar1;
}



DWORD GetConsoleProcessList(LPDWORD lpdwProcessList,DWORD dwProcessCount)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823d60. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23d60  519  GetConsoleProcessList
  DVar1 = GetConsoleProcessList(lpdwProcessList,dwProcessCount);
  return DVar1;
}



BOOL GetConsoleSelectionInfo(PCONSOLE_SELECTION_INFO lpConsoleSelectionInfo)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823d70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23d70  522  GetConsoleSelectionInfo
  BVar1 = GetConsoleSelectionInfo(lpConsoleSelectionInfo);
  return BVar1;
}



HWND GetConsoleWindow(void)

{
  HWND pHVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823d80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23d80  525  GetConsoleWindow
  pHVar1 = GetConsoleWindow();
  return pHVar1;
}



BOOL GetCurrentConsoleFont
               (HANDLE hConsoleOutput,BOOL bMaximumWindow,PCONSOLE_FONT_INFO lpConsoleCurrentFont)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823d90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23d90  532  GetCurrentConsoleFont
  BVar1 = GetCurrentConsoleFont(hConsoleOutput,bMaximumWindow,lpConsoleCurrentFont);
  return BVar1;
}



BOOL GetCurrentConsoleFontEx
               (HANDLE hConsoleOutput,BOOL bMaximumWindow,
               PCONSOLE_FONT_INFOEX lpConsoleCurrentFontEx)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823da0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23da0  533  GetCurrentConsoleFontEx
  BVar1 = GetCurrentConsoleFontEx(hConsoleOutput,bMaximumWindow,lpConsoleCurrentFontEx);
  return BVar1;
}



BOOL GetNumberOfConsoleMouseButtons(LPDWORD lpNumberOfMouseButtons)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823db0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23db0  668  GetNumberOfConsoleMouseButtons
  BVar1 = GetNumberOfConsoleMouseButtons(lpNumberOfMouseButtons);
  return BVar1;
}



BOOL SetConsoleDisplayMode(HANDLE hConsoleOutput,DWORD dwFlags,PCOORD lpNewScreenBufferDimensions)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823dc0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23dc0  1266  SetConsoleDisplayMode
  BVar1 = SetConsoleDisplayMode(hConsoleOutput,dwFlags,lpNewScreenBufferDimensions);
  return BVar1;
}



BOOL SetConsoleHistoryInfo(PCONSOLE_HISTORY_INFO lpConsoleHistoryInfo)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823dd0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23dd0  1269  SetConsoleHistoryInfo
  BVar1 = SetConsoleHistoryInfo(lpConsoleHistoryInfo);
  return BVar1;
}



void SetConsoleNumberOfCommandsA(void)

{
                    // WARNING: Could not recover jumptable at 0x6b823de0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23de0  1279  SetConsoleNumberOfCommandsA
  SetConsoleNumberOfCommandsA();
  return;
}



void SetConsoleNumberOfCommandsW(void)

{
                    // WARNING: Could not recover jumptable at 0x6b823df0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23df0  1280  SetConsoleNumberOfCommandsW
  SetConsoleNumberOfCommandsW();
  return;
}



BOOL SetCurrentConsoleFontEx
               (HANDLE hConsoleOutput,BOOL bMaximumWindow,
               PCONSOLE_FONT_INFOEX lpConsoleCurrentFontEx)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b823e00. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23e00  1291  SetCurrentConsoleFontEx
  BVar1 = SetCurrentConsoleFontEx(hConsoleOutput,bMaximumWindow,lpConsoleCurrentFontEx);
  return BVar1;
}



void FUN_6b823e06(void)

{
  code *pcVar1;
  int iVar2;
  undefined4 *local_18;
  undefined4 local_14;
  undefined **local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  iVar2 = LdrGetDllHandle(0,0,&DAT_6b8801ec,&local_14);
  if (iVar2 < 0) {
    pcVar1 = (code *)swi(0x29);
    (*pcVar1)();
  }
  local_10 = &Wow64Transition;
  local_c = 4;
  iVar2 = NtProtectVirtualMemory(0xffffffff,&local_10,&local_c,4,&local_8);
  if (iVar2 < 0) {
    pcVar1 = (code *)swi(0x29);
    (*pcVar1)();
  }
  iVar2 = LdrGetProcedureAddress(local_14,&DAT_6b8801f4,0,&local_18);
  if (iVar2 < 0) {
    pcVar1 = (code *)swi(0x29);
    (*pcVar1)();
  }
  Wow64Transition = (undefined *)*local_18;
  iVar2 = NtProtectVirtualMemory(0xffffffff,&local_10,&local_c,local_8,&local_8);
  if (iVar2 < 0) {
    pcVar1 = (code *)swi(0x29);
    (*pcVar1)();
  }
  return;
}



void FUN_6b823e9e(void)

{
  FUN_6b823e06();
                    // WARNING: Could not recover jumptable at 0x6b823ead. Too many branches
                    // WARNING: Treating indirect jump as call
  (*(code *)Wow64Transition)();
  return;
}



void DelayLoad_QueryOOBESupport(void)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = (code *)FUN_6b8734f6(&ImgDelayDescr_6b892a9c,&QueryOOBESupport_exref);
                    // WARNING: Could not recover jumptable at 0x6b823ecc. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)();
  return;
}



// WARNING: Could not reconcile some variable overlaps
// Library Function - Multiple Matches With Different Base Names
//  _IsInitializeInputDeviceInjectionPresent@0
//  _IsInitializePointerDeviceInjectionPresent@0
//  _IsInjectDeviceInputPresent@0
//  _IsInjectKeyboardInputPresent@0
//   35 names - too many to list
// 
// Library: Visual Studio 2019 Release

uint __fastcall FID_conflict__IsRIMFreeInputBufferPresent_0(uint3 param_1)

{
  uint in_EAX;
  undefined4 uStack8;
  
  if (DAT_6b8b06c0 == 1) {
    return in_EAX & 0xffffff00 | 1;
  }
  if (DAT_6b8b06c0 != 2) {
    uStack8 = (uint)param_1;
    in_EAX = ApiSetQueryApiSetPresence(&DAT_6b8801fc,(int)&uStack8 + 3);
    if (-1 < (int)in_EAX) {
      DAT_6b8b06c0 = (uStack8._3_1_ == 0) + 1;
      return in_EAX & 0xffffff00 | (uint)uStack8._3_1_;
    }
  }
  return in_EAX & 0xffffff00;
}



void NtApphelpCacheControl(void)

{
                    // WARNING: Could not recover jumptable at 0x6b823f20. Too many branches
                    // WARNING: Treating indirect jump as call
  NtApphelpCacheControl();
  return;
}



void ApiSetQueryApiSetPresence(void)

{
                    // WARNING: Could not recover jumptable at 0x6b823f26. Too many branches
                    // WARNING: Treating indirect jump as call
  ApiSetQueryApiSetPresence();
  return;
}



void DelayLoad_RpcAsyncInitializeHandle(void)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE =
       (code *)FUN_6b8734f6(&ImgDelayDescr_6b892abc,&RpcAsyncInitializeHandle_exref);
                    // WARNING: Could not recover jumptable at 0x6b823f45. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)();
  return;
}



void DelayLoad_RpcBindingFromStringBindingW(void)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE =
       (code *)FUN_6b8734f6(&ImgDelayDescr_6b892abc,&RpcBindingFromStringBindingW_exref);
                    // WARNING: Could not recover jumptable at 0x6b823f45. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)();
  return;
}



void DelayLoad_RpcStringBindingComposeW(void)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE =
       (code *)FUN_6b8734f6(&ImgDelayDescr_6b892abc,&RpcStringBindingComposeW_exref);
                    // WARNING: Could not recover jumptable at 0x6b823f45. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)();
  return;
}



void DelayLoad_I_RpcExceptionFilter(void)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = (code *)FUN_6b8734f6(&ImgDelayDescr_6b892abc,&I_RpcExceptionFilter_exref);
                    // WARNING: Could not recover jumptable at 0x6b823f45. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)();
  return;
}



void DelayLoad_RpcAsyncCompleteCall(void)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = (code *)FUN_6b8734f6(&ImgDelayDescr_6b892abc,&RpcAsyncCompleteCall_exref);
                    // WARNING: Could not recover jumptable at 0x6b823f45. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)();
  return;
}



void DelayLoad_RpcBindingSetAuthInfoExW(void)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE =
       (code *)FUN_6b8734f6(&ImgDelayDescr_6b892abc,&RpcBindingSetAuthInfoExW_exref);
                    // WARNING: Could not recover jumptable at 0x6b823f45. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)();
  return;
}



void DelayLoad_RpcStringFreeW(void)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = (code *)FUN_6b8734f6(&ImgDelayDescr_6b892abc,&RpcStringFreeW_exref);
                    // WARNING: Could not recover jumptable at 0x6b823f45. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)();
  return;
}



void DelayLoad_RpcAsyncCancelCall(void)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = (code *)FUN_6b8734f6(&ImgDelayDescr_6b892abc,&RpcAsyncCancelCall_exref);
                    // WARNING: Could not recover jumptable at 0x6b823f45. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)();
  return;
}



void DelayLoad_RpcBindingFree(void)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = (code *)FUN_6b8734f6(&ImgDelayDescr_6b892abc,&RpcBindingFree_exref);
                    // WARNING: Could not recover jumptable at 0x6b823f45. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)();
  return;
}



void DelayLoad_NdrAsyncClientCall(void)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = (code *)FUN_6b8734f6(&ImgDelayDescr_6b892abc,&NdrAsyncClientCall_exref);
                    // WARNING: Could not recover jumptable at 0x6b823f45. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)();
  return;
}



undefined4 __fastcall FUN_6b823fa1(ushort param_1)

{
  if ((((param_1 < 0x1100) || (0x11ff < param_1)) && ((param_1 < 0xa960 || (0xa97c < param_1)))) &&
     (((param_1 < 0xd7b0 || (0xd7c6 < param_1)) && (0x30 < (ushort)(param_1 + 0x2835))))) {
    return 0;
  }
  return 1;
}



void _CIcos(void)

{
                    // WARNING: Could not recover jumptable at 0x6b823fec. Too many branches
                    // WARNING: Treating indirect jump as call
  _CIcos();
  return;
}



void _CIsin(void)

{
                    // WARNING: Could not recover jumptable at 0x6b823ff2. Too many branches
                    // WARNING: Treating indirect jump as call
  _CIsin();
  return;
}



// WARNING: This is an inlined function
// WARNING: Unable to track spacebase fully for stack
// WARNING: Variable defined which should be unmapped: param_2
// Library Function - Single Match
//  __SEH_prolog4
// 
// Library: Visual Studio

void __cdecl __SEH_prolog4(undefined4 param_1,int param_2)

{
  int iVar1;
  undefined4 unaff_EBX;
  undefined4 unaff_ESI;
  undefined4 unaff_EDI;
  int *in_FS_OFFSET;
  undefined4 unaff_retaddr;
  uint auStack28 [5];
  undefined local_8 [8];
  
  iVar1 = -param_2;
  *(undefined4 *)((int)auStack28 + iVar1 + 0x10) = unaff_EBX;
  *(undefined4 *)((int)auStack28 + iVar1 + 0xc) = unaff_ESI;
  *(undefined4 *)((int)auStack28 + iVar1 + 8) = unaff_EDI;
  *(uint *)((int)auStack28 + iVar1 + 4) = DAT_6b8b0140 ^ (uint)&param_2;
  *(undefined4 *)((int)auStack28 + iVar1) = unaff_retaddr;
  *in_FS_OFFSET = (int)local_8;
  return;
}



// WARNING: This is an inlined function
// Library Function - Single Match
//  __SEH_epilog4
// 
// Library: Visual Studio

void __SEH_epilog4(void)

{
  undefined4 *unaff_EBP;
  undefined4 *in_FS_OFFSET;
  undefined4 unaff_retaddr;
  
  *in_FS_OFFSET = unaff_EBP[-4];
  *unaff_EBP = unaff_retaddr;
  return;
}



// WARNING: This is an inlined function
// WARNING: Unable to track spacebase fully for stack
// WARNING: Variable defined which should be unmapped: param_2
// Library Function - Single Match
//  __SEH_prolog4_GS
// 
// Library: Visual Studio

void __cdecl __SEH_prolog4_GS(undefined4 param_1,int param_2)

{
  int iVar1;
  undefined4 unaff_EBX;
  undefined4 unaff_ESI;
  undefined4 unaff_EDI;
  int *in_FS_OFFSET;
  undefined4 unaff_retaddr;
  uint auStack28 [5];
  undefined local_8 [8];
  
  iVar1 = -param_2;
  *(undefined4 *)((int)auStack28 + iVar1 + 0x10) = unaff_EBX;
  *(undefined4 *)((int)auStack28 + iVar1 + 0xc) = unaff_ESI;
  *(undefined4 *)((int)auStack28 + iVar1 + 8) = unaff_EDI;
  *(uint *)((int)auStack28 + iVar1 + 4) = DAT_6b8b0140 ^ (uint)&param_2;
  *(undefined4 *)((int)auStack28 + iVar1) = unaff_retaddr;
  *in_FS_OFFSET = (int)local_8;
  return;
}



void _alldiv(void)

{
                    // WARNING: Could not recover jumptable at 0x6b8240ab. Too many branches
                    // WARNING: Treating indirect jump as call
  _alldiv();
  return;
}



void _allmul(void)

{
                    // WARNING: Could not recover jumptable at 0x6b8240b1. Too many branches
                    // WARNING: Treating indirect jump as call
  _allmul();
  return;
}



void _allshl(void)

{
                    // WARNING: Could not recover jumptable at 0x6b8240b7. Too many branches
                    // WARNING: Treating indirect jump as call
  _allshl();
  return;
}



// WARNING: This is an inlined function
// WARNING: Exceeded maximum restarts with more pending

void _chkstk(void)

{
                    // WARNING: Could not recover jumptable at 0x6b8240bd. Too many branches
                    // WARNING: Treating indirect jump as call
  _chkstk();
  return;
}



void _ftol2_sse(void)

{
                    // WARNING: Could not recover jumptable at 0x6b8240c3. Too many branches
                    // WARNING: Treating indirect jump as call
  _ftol2_sse();
  return;
}



// WARNING: Exceeded maximum restarts with more pending

double __cdecl floor(double _X)

{
  float10 fVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8240c9. Too many branches
                    // WARNING: Treating indirect jump as call
  fVar1 = (float10)floor();
  return (double)fVar1;
}



// WARNING: Exceeded maximum restarts with more pending

int __cdecl memcmp(void *_Buf1,void *_Buf2,size_t _Size)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8240cf. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = memcmp();
  return iVar1;
}



// WARNING: Exceeded maximum restarts with more pending

void * __cdecl memcpy(void *_Dst,void *_Src,size_t _Size)

{
  void *pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8240d5. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = (void *)memcpy();
  return pvVar1;
}



// WARNING: Exceeded maximum restarts with more pending

void * __cdecl memmove(void *_Dst,void *_Src,size_t _Size)

{
  void *pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8240db. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = (void *)memmove();
  return pvVar1;
}



// WARNING: Exceeded maximum restarts with more pending

void * __cdecl memset(void *_Dst,int _Val,size_t _Size)

{
  void *pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8240e1. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = (void *)memset();
  return pvVar1;
}



void thunk_FUN_6b823e9e(void)

{
                    // WARNING: Could not recover jumptable at 0x6b8240f0. Too many branches
                    // WARNING: Treating indirect jump as call
  (*(code *)Wow64Transition)();
  return;
}



void ExitProcess(UINT uExitCode)

{
  code *pcVar1;
  undefined4 uVar2;
  
                    // 0x24100  356  ExitProcess
  uVar2 = 0xffffffff;
  RtlExitUserProcess(uExitCode);
  pcVar1 = (code *)swi(3);
  (*pcVar1)(uVar2);
  return;
}



undefined4 CreateToolhelp32Snapshot(uint param_1,DWORD param_2)

{
  bool bVar1;
  int iVar2;
  int **in_FS_OFFSET;
  undefined4 local_68;
  int local_60;
  uint *local_5c;
  undefined4 local_58;
  uint local_54;
  uint local_50;
  int local_4c;
  uint *local_48;
  int local_44;
  uint *local_40;
  int local_3c;
  int local_38;
  int local_34;
  uint *local_30;
  uint *local_2c;
  int local_28;
  uint *local_24;
  uint *local_20 [3];
  int *local_14;
  code *pcStack16;
  uint local_c;
  undefined4 local_8;
  
                    // 0x24120  258  CreateToolhelp32Snapshot
  local_8 = 0xfffffffe;
  pcStack16 = __except_handler4;
  local_14 = *in_FS_OFFSET;
  local_c = DAT_6b8b0140 ^ 0x6b892330;
  *in_FS_OFFSET = (int *)&local_14;
  local_58 = 0xffffffff;
  local_68 = 0xffffffff;
  local_38 = 0;
  local_60 = 0;
  local_3c = 0;
  local_28 = 0;
  local_5c = (uint *)0x0;
  local_24 = (uint *)0x0;
  local_20[0] = (uint *)0x0;
  local_50 = 0;
  local_54 = 0;
  local_30 = (uint *)0x0;
  local_2c = (uint *)0x0;
  if (param_2 == 0) {
    param_2 = GetCurrentProcessId();
  }
  local_8 = 0;
  local_28 = FUN_6b82178c(param_1,param_2,&local_38,&local_60,&local_24,&local_4c,&local_3c,local_20
                          ,&local_44);
  if (local_28 < 0) {
    BaseSetLastNTError(local_28);
    goto LAB_6b824431;
  }
  if (local_20[0] != (uint *)0x0) {
    local_2c = *(uint **)(local_3c + 0x38);
    if ((((local_2c < local_20[0]) || (local_2c + 0x11 < local_2c)) ||
        ((uint *)((int)local_20[0] + local_44) < local_20[0])) ||
       ((uint *)((int)local_20[0] + local_44) < local_2c + 0x11)) {
      bVar1 = false;
    }
    else {
      bVar1 = true;
    }
    if (!bVar1) {
      BaseSetLastNTError(0xc000003e);
      goto LAB_6b824431;
    }
    local_50 = *local_2c;
    if (1 < local_50) {
      iVar2 = FUN_6b850b28(local_50 - 1,0x40,&local_34);
      if (iVar2 < 0) {
        BaseSetLastNTError(0xc000003e);
        goto LAB_6b824431;
      }
      local_40 = local_2c + 0x11;
      if (((local_40 < local_20[0]) || ((uint *)((int)local_40 + local_34) < local_40)) ||
         (((uint *)((int)local_20[0] + local_44) < local_20[0] ||
          ((uint)((int)local_20[0] + local_44) < (uint)((int)local_40 + local_34))))) {
        bVar1 = false;
      }
      else {
        bVar1 = true;
      }
      if (!bVar1) {
        BaseSetLastNTError(0xc000003e);
        goto LAB_6b824431;
      }
    }
  }
  if (local_24 != (uint *)0x0) {
    local_30 = *(uint **)(local_60 + 0x30);
    if (((local_30 < local_24) || (local_30 + 0x48 < local_30)) ||
       (((uint *)((int)local_24 + local_4c) < local_24 ||
        ((uint *)((int)local_24 + local_4c) < local_30 + 0x48)))) {
      bVar1 = false;
    }
    else {
      bVar1 = true;
    }
    if (!bVar1) {
      BaseSetLastNTError(0xc000003e);
      goto LAB_6b824431;
    }
    local_54 = *local_30;
    if (1 < local_54) {
      iVar2 = FUN_6b850b28(local_54 - 1,0x120,&local_34);
      if (iVar2 < 0) {
        BaseSetLastNTError(0xc000003e);
        goto LAB_6b824431;
      }
      local_48 = local_30 + 0x48;
      if ((((local_48 < local_24) || ((uint *)((int)local_48 + local_34) < local_48)) ||
          ((uint *)((int)local_24 + local_4c) < local_24)) ||
         ((uint)((int)local_24 + local_4c) < (uint)((int)local_48 + local_34))) {
        bVar1 = false;
      }
      else {
        bVar1 = true;
      }
      if (!bVar1) {
        BaseSetLastNTError(0xc000003e);
        goto LAB_6b824431;
      }
    }
  }
  local_28 = FUN_6b820fa0(&local_58,&local_5c,param_1,param_2,local_38,local_54,local_50);
  if (local_28 < 0) {
    BaseSetLastNTError(local_28);
  }
  else {
    local_28 = FUN_6b82090c(param_1,param_2,local_5c,local_38,local_30,local_3c,(int)local_2c);
    if (local_28 < 0) {
      BaseSetLastNTError(local_28);
    }
    else {
      local_68 = local_58;
    }
  }
LAB_6b824431:
  local_8 = 0xfffffffe;
  FUN_6b824442();
  *in_FS_OFFSET = local_14;
  return local_68;
}



void FUN_6b824442(void)

{
  int iVar1;
  int unaff_EBP;
  
  if (*(int *)(unaff_EBP + -100) != *(int *)(unaff_EBP + -0x54)) {
    iVar1 = NtClose(*(undefined4 *)(unaff_EBP + -0x54));
    if (iVar1 < 0) {
      *(undefined4 *)(unaff_EBP + -0x78) = 0;
    }
    else {
      *(undefined4 *)(unaff_EBP + -0x78) = 1;
    }
  }
  if (*(int *)(unaff_EBP + -0x58) != 0) {
    iVar1 = NtUnmapViewOfSection(0xffffffff,*(undefined4 *)(unaff_EBP + -0x58));
    if (iVar1 < 0) {
      *(undefined4 *)(unaff_EBP + -0x7c) = 0;
    }
    else {
      *(undefined4 *)(unaff_EBP + -0x7c) = 1;
    }
  }
  if (*(int *)(unaff_EBP + -0x34) != 0) {
    *(undefined4 *)(unaff_EBP + -0x80) = 0;
    iVar1 = NtFreeVirtualMemory(0xffffffff,unaff_EBP + -0x34,unaff_EBP + -0x80,0x8000);
    if (iVar1 < 0) {
      *(undefined4 *)(unaff_EBP + -0x84) = 0;
    }
    else {
      *(undefined4 *)(unaff_EBP + -0x84) = 1;
    }
  }
  if (*(int *)(unaff_EBP + -0x5c) != 0) {
    RtlDestroyQueryDebugBuffer(*(undefined4 *)(unaff_EBP + -0x5c));
  }
  if (*(int *)(unaff_EBP + -0x38) != 0) {
    RtlDestroyQueryDebugBuffer(*(undefined4 *)(unaff_EBP + -0x38));
  }
  return;
}



void FUN_6b8244f0(undefined param_1)

{
  NdrAsyncClientCall((PMIDL_STUB_DESC)&pStubDescriptor_6b8802a0,"",&param_1);
  return;
}



void FUN_6b82451a(undefined param_1)

{
  NdrAsyncClientCall((PMIDL_STUB_DESC)&pStubDescriptor_6b8802a0,"",&param_1);
  return;
}



undefined4 FUN_6b830450(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_c;
  uint local_8;
  
  uVar2 = 0;
  local_c = 8;
  local_8 = 0;
  iVar1 = NtQuerySystemInformation(0x67,&local_c,8,0);
  if ((-1 < iVar1) && ((local_8 & 2) != 0)) {
    uVar2 = 1;
  }
  return uVar2;
}



void __fastcall FUN_6b830481(HKEY param_1)

{
  DWORD dwFlags;
  LSTATUS LVar1;
  WCHAR WVar2;
  undefined4 extraout_EDX;
  undefined4 uVar3;
  undefined4 extraout_EDX_00;
  WCHAR *lpLibFileName;
  WCHAR *pWVar4;
  WCHAR *pWVar5;
  int in_FS_OFFSET;
  undefined8 uVar6;
  int local_118;
  WCHAR *local_114;
  DWORD local_110;
  DWORD local_10c;
  WCHAR local_108 [128];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_10c = 4;
  local_110 = 0;
  LVar1 = RegGetValueW(param_1,(LPCWSTR)0x0,L"RequireSignedAppInit_DLLs",0x10,(LPDWORD)0x0,
                       &local_118,&local_10c);
  if ((LVar1 == 0) && (local_118 != 0)) {
    local_110 = 0x80;
  }
  local_10c = 0x100;
  lpLibFileName = local_108;
  while (local_114 = lpLibFileName,
        LVar1 = RegGetValueW(param_1,(LPCWSTR)0x0,L"AppInit_DLLs",2,(LPDWORD)0x0,lpLibFileName,
                             &local_10c), dwFlags = local_110, LVar1 == 0xea) {
    if (lpLibFileName != local_108) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpLibFileName);
    }
    uVar6 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_10c);
    lpLibFileName = (WCHAR *)uVar6;
    if (lpLibFileName == (WCHAR *)0x0) goto LAB_6b8305fb;
  }
  uVar3 = extraout_EDX;
  pWVar5 = lpLibFileName;
  if (LVar1 == 0) {
    while( true ) {
      while( true ) {
        uVar3 = 0x2c;
        WVar2 = *lpLibFileName;
        if ((WVar2 != L' ') && (WVar2 != L',')) break;
        lpLibFileName = lpLibFileName + 1;
      }
      pWVar4 = lpLibFileName;
      pWVar5 = local_114;
      if (WVar2 == L'\0') break;
      do {
        if (WVar2 == L',') break;
        if (WVar2 == L'\0') goto LAB_6b8305c6;
        pWVar4 = pWVar4 + 1;
        WVar2 = *pWVar4;
      } while (WVar2 != L' ');
      if (WVar2 != L'\0') {
        *pWVar4 = L'\0';
        pWVar4 = pWVar4 + 1;
      }
LAB_6b8305c6:
      LoadLibraryExW(lpLibFileName,(HANDLE)0x0,dwFlags);
      lpLibFileName = pWVar4;
    }
  }
  uVar6 = CONCAT44(uVar3,local_114);
  if (pWVar5 != local_108) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pWVar5);
    uVar6 = CONCAT44(extraout_EDX_00,local_114);
  }
LAB_6b8305fb:
  local_114 = (WCHAR *)uVar6;
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,(int)((ulonglong)uVar6 >> 0x20));
  return;
}



void FUN_6b830610(SIZE_T param_1)

{
  HANDLE hHeap;
  DWORD dwFlags;
  
  dwFlags = 0;
  hHeap = GetProcessHeap();
  HeapAlloc(hHeap,dwFlags,param_1);
  return;
}



void FreeMemoryJobObject(LPVOID param_1)

{
  HANDLE hHeap;
  DWORD dwFlags;
  
                    // 0x30630  436  FreeMemoryJobObject
  dwFlags = 0;
  hHeap = GetProcessHeap();
  HeapFree(hHeap,dwFlags,param_1);
  return;
}



BOOL Beep(DWORD dwFreq,DWORD dwDuration)

{
  BOOL BVar1;
  uint local_8;
  
                    // 0x30650  106  Beep
  BVar1 = GetConsoleDisplayMode(&local_8);
  local_8 = local_8 & -(uint)(BVar1 != 0);
  if (local_8 == 0) {
    FUN_6b822480();
  }
  BVar1 = Beep(dwFreq,dwDuration);
  return BVar1;
}



undefined4 IsNativeVhdBoot(uint *param_1)

{
  int iVar1;
  char *pcVar2;
  int in_FS_OFFSET;
  undefined4 local_8;
  
                    // 0x30690  903  IsNativeVhdBoot
  if (param_1 == (uint *)0x0) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    iVar1 = NtQuerySystemInformation(0x70,0,0,&local_8);
    if (iVar1 == -0x3fffffdd) {
      pcVar2 = (char *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,
                                       local_8);
      if (pcVar2 == (char *)0x0) {
        RtlSetLastWin32Error(8);
      }
      else {
        iVar1 = NtQuerySystemInformation(0x70,pcVar2,local_8,&local_8);
        if (-1 < iVar1) {
          *param_1 = (uint)(*pcVar2 != '\0');
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pcVar2);
          return 1;
        }
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pcVar2);
        BaseSetLastNTError(iVar1);
      }
    }
    else {
      BaseSetLastNTError(iVar1);
    }
  }
  return 0;
}



LONG CopyLZFile(INT hfSource,INT hfDest)

{
  LONG LVar1;
  
                    // 0x30750  180  CopyLZFile
  LVar1 = LZCopy(hfSource,hfDest);
  return LVar1;
}



LONG LZCopy(INT hfSource,INT hfDest)

{
  HANDLE *ppvVar1;
  HANDLE pvVar2;
  HANDLE pvVar3;
  HGLOBAL *ppvVar4;
  HGLOBAL pvVar5;
  uint extraout_EDX;
  undefined *puVar6;
  
                    // 0x30760  954  LZCopy
  if (hfSource < 0x400) {
    pvVar2 = (HANDLE)FUN_6b83534e(hfDest);
    pvVar3 = (HANDLE)FUN_6b83534e(extraout_EDX);
  }
  else {
    pvVar5 = *(HGLOBAL *)(hfSource * 4 + 0x6b8af930);
    if (pvVar5 == (HGLOBAL)0x0) {
      return -1;
    }
    ppvVar1 = (HANDLE *)GlobalLock(pvVar5);
    if (ppvVar1 == (HANDLE *)0x0) {
      return -6;
    }
    pvVar3 = *ppvVar1;
    pvVar2 = (HANDLE)FUN_6b83534e(hfDest);
    GlobalUnlock(pvVar5);
  }
  ppvVar4 = FUN_6b86612e((HGLOBAL)0x8000,(HGLOBAL)0x8000);
  if (ppvVar4 == (HGLOBAL *)0x0) {
    puVar6 = (undefined *)0xfffffffb;
  }
  else {
    ppvVar4[7] = (HGLOBAL)0x0;
    pvVar5 = (HGLOBAL)((int)ppvVar4[1] + (int)ppvVar4[0xb] + 1);
    ppvVar4[10] = (HGLOBAL)0x0;
    ppvVar4[2] = pvVar5;
    ppvVar4[3] = pvVar5;
    ppvVar4[6] = ppvVar4[4];
    ppvVar4[5] = (HGLOBAL)((int)ppvVar4[0xc] + (int)ppvVar4[4]);
    puVar6 = (undefined *)FUN_6b8661c2(pvVar3,pvVar2,(int *)ppvVar4);
    if (puVar6 == &DAT_00000001) {
      puVar6 = (undefined *)ppvVar4[10];
    }
    FUN_6b8660e6(ppvVar4);
  }
  return (LONG)puVar6;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

DWORD GetFullPathNameTransactedA
                (LPCSTR lpFileName,DWORD nBufferLength,LPSTR lpBuffer,LPSTR *lpFilePart,
                HANDLE hTransaction)

{
  int iVar1;
  DWORD DVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar3;
  undefined4 local_14;
  
                    // 0x30830  605  GetFullPathNameTransactedA
  DVar2 = 0;
  if ((hTransaction == (HANDLE)0xffffffff) || (hTransaction == (HANDLE)0x0)) {
    uVar3 = 0x1a2c;
  }
  else {
    iVar1 = RtlGetCurrentTransaction();
    if (iVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      DVar2 = GetFullPathNameA(lpFileName,nBufferLength,lpBuffer,lpFilePart);
      FUN_6b830891();
      goto LAB_6b8308a5;
    }
    uVar3 = 0x1a45;
  }
  RtlSetLastWin32Error(uVar3);
LAB_6b8308a5:
  *in_FS_OFFSET = local_14;
  return DVar2;
}



void FUN_6b830891(void)

{
  RtlSetCurrentTransaction(0);
  return;
}



BOOL SetSystemTimeAdjustment(DWORD dwTimeAdjustment,BOOL bTimeAdjustmentDisabled)

{
  int iVar1;
  DWORD local_c;
  uint local_8;
  
                    // 0x308c0  1365  SetSystemTimeAdjustment
  local_c = dwTimeAdjustment;
  local_8 = bTimeAdjustmentDisabled & 0xff;
  iVar1 = NtSetSystemInformation(0x1c,&local_c,8);
  if (-1 >= iVar1) {
    BaseSetLastNTError(iVar1);
  }
  return (uint)(-1 < iVar1);
}



BOOL DebugBreakProcess(HANDLE Process)

{
  int iVar1;
  
                    // 0x30900  269  DebugBreakProcess
  iVar1 = DbgUiIssueRemoteBreakin(Process);
  if (iVar1 < 0) {
    BaseSetLastNTError(iVar1);
  }
  return (uint)(iVar1 >= 0);
}



BOOL DebugSetProcessKillOnExit(BOOL KillOnExit)

{
  int iVar1;
  uint local_8;
  
                    // 0x30930  270  DebugSetProcessKillOnExit
  iVar1 = DbgUiGetThreadDebugObject();
  if (iVar1 == 0) {
    iVar1 = -0x3ffffff8;
  }
  else {
    local_8 = (uint)(KillOnExit != 0);
    iVar1 = NtSetInformationDebugObject(iVar1,1,&local_8,4,0);
    if (-1 < iVar1) {
      return 1;
    }
  }
  BaseSetLastNTError(iVar1);
  return 0;
}



BOOL Wow64GetThreadSelectorEntry(HANDLE hThread,DWORD dwSelector,PWOW64_LDT_ENTRY lpSelectorEntry)

{
                    // 0x30980  1545  Wow64GetThreadSelectorEntry
  BaseSetLastNTError(0xc00000bb);
  return 0;
}



BOOL CreateDirectoryTransactedA
               (LPCSTR lpTemplateDirectory,LPCSTR lpNewDirectory,
               LPSECURITY_ATTRIBUTES lpSecurityAttributes,HANDLE hTransaction)

{
  int iVar1;
  BOOL BVar2;
  undefined local_14 [4];
  LPCWSTR local_10;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x309a0  190  CreateDirectoryTransactedA
  iVar1 = Basep8BitStringToDynamicUnicodeString(local_14,lpNewDirectory);
  if (iVar1 == 0) {
    return 0;
  }
  if (lpTemplateDirectory == (LPCSTR)0x0) {
    local_8 = (LPCWSTR)0x0;
  }
  else {
    iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpTemplateDirectory);
    if (iVar1 == 0) {
      BVar2 = 0;
      goto LAB_6b8309fc;
    }
  }
  BVar2 = CreateDirectoryTransactedW(local_8,local_10,lpSecurityAttributes,hTransaction);
  if (lpTemplateDirectory != (LPCSTR)0x0) {
    RtlFreeUnicodeString(local_c);
  }
LAB_6b8309fc:
  RtlFreeUnicodeString(local_14);
  return BVar2;
}



BOOL RemoveDirectoryTransactedA(LPCSTR lpPathName,HANDLE hTransaction)

{
  BOOL BVar1;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x30a20  1211  RemoveDirectoryTransactedA
  BVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpPathName);
  if (BVar1 != 0) {
    BVar1 = RemoveDirectoryTransactedW(local_8,hTransaction);
    RtlFreeUnicodeString(local_c);
  }
  return BVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

HANDLE FindFirstFileNameTransactedW
                 (LPCWSTR lpFileName,DWORD dwFlags,LPDWORD StringLength,PWCHAR LinkName,
                 HANDLE hTransaction)

{
  int iVar1;
  HANDLE pvVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar3;
  undefined4 local_14;
  
                    // 0x30a60  386  FindFirstFileNameTransactedW
  pvVar2 = (HANDLE)0xffffffff;
  if ((hTransaction == (HANDLE)0xffffffff) || (hTransaction == (HANDLE)0x0)) {
    uVar3 = 0x1a2c;
  }
  else {
    iVar1 = RtlGetCurrentTransaction();
    if (iVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      pvVar2 = FindFirstFileNameW(lpFileName,dwFlags,StringLength,LinkName);
      FUN_6b830ac4();
      goto LAB_6b830ad8;
    }
    uVar3 = 0x1a45;
  }
  RtlSetLastWin32Error(uVar3);
LAB_6b830ad8:
  *in_FS_OFFSET = local_14;
  return pvVar2;
}



void FUN_6b830ac4(void)

{
  RtlSetCurrentTransaction(0);
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

HANDLE FindFirstFileTransactedA
                 (LPCSTR lpFileName,FINDEX_INFO_LEVELS fInfoLevelId,LPVOID lpFindFileData,
                 FINDEX_SEARCH_OPS fSearchOp,LPVOID lpSearchFilter,DWORD dwAdditionalFlags,
                 HANDLE hTransaction)

{
  int iVar1;
  HANDLE pvVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar3;
  undefined4 local_14;
  
                    // 0x30b00  388  FindFirstFileTransactedA
  pvVar2 = (HANDLE)0xffffffff;
  if ((hTransaction == (HANDLE)0xffffffff) || (hTransaction == (HANDLE)0x0)) {
    uVar3 = 0x1a2c;
  }
  else {
    iVar1 = RtlGetCurrentTransaction();
    if (iVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      pvVar2 = FindFirstFileExA(lpFileName,fInfoLevelId,lpFindFileData,fSearchOp,lpSearchFilter,
                                dwAdditionalFlags);
      FUN_6b830b6a();
      goto LAB_6b830b7e;
    }
    uVar3 = 0x1a45;
  }
  RtlSetLastWin32Error(uVar3);
LAB_6b830b7e:
  *in_FS_OFFSET = local_14;
  return pvVar2;
}



void FUN_6b830b6a(void)

{
  RtlSetCurrentTransaction(0);
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

HANDLE FindFirstStreamTransactedW
                 (LPCWSTR lpFileName,STREAM_INFO_LEVELS InfoLevel,LPVOID lpFindStreamData,
                 DWORD dwFlags,HANDLE hTransaction)

{
  int iVar1;
  HANDLE pvVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar3;
  undefined4 local_14;
  
                    // 0x30ba0  391  FindFirstStreamTransactedW
  pvVar2 = (HANDLE)0xffffffff;
  if ((hTransaction == (HANDLE)0xffffffff) || (hTransaction == (HANDLE)0x0)) {
    uVar3 = 0x1a2c;
  }
  else {
    iVar1 = RtlGetCurrentTransaction();
    if (iVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      pvVar2 = FindFirstStreamW(lpFileName,InfoLevel,lpFindStreamData,dwFlags);
      FUN_6b830c04();
      goto LAB_6b830c18;
    }
    uVar3 = 0x1a45;
  }
  RtlSetLastWin32Error(uVar3);
LAB_6b830c18:
  *in_FS_OFFSET = local_14;
  return pvVar2;
}



void FUN_6b830c04(void)

{
  RtlSetCurrentTransaction(0);
  return;
}



BOOL GetFileBandwidthReservation
               (HANDLE hFile,LPDWORD lpPeriodMilliseconds,LPDWORD lpBytesPerPeriod,
               LPBOOL pDiscardable,LPDWORD lpTransferSize,LPDWORD lpNumOutstandingRequests)

{
  int iVar1;
  BOOL BVar2;
  LPDWORD extraout_EDX;
  LPDWORD pDVar3;
  undefined local_2c [8];
  LPDWORD local_24;
  LPDWORD local_20;
  int local_1c;
  DWORD local_18;
  byte local_13;
  DWORD local_10;
  DWORD local_c;
  uint local_8;
  
                    // 0x30c40  588  GetFileBandwidthReservation
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_20 = lpTransferSize;
  local_24 = lpNumOutstandingRequests;
  iVar1 = NtQueryInformationFile(hFile,local_2c,&local_1c,0x14,0x2c);
  if (iVar1 < 0) {
    BaseSetLastNTError(iVar1);
    pDVar3 = extraout_EDX;
  }
  else {
    *local_20 = local_10;
    *local_24 = local_c;
    *lpPeriodMilliseconds = local_18;
    *lpBytesPerPeriod = local_1c * local_10;
    *pDiscardable = (uint)local_13;
    pDVar3 = local_24;
  }
  BVar2 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,pDVar3);
  return BVar2;
}



BOOL SetFileBandwidthReservation
               (HANDLE hFile,DWORD nPeriodMilliseconds,DWORD nBytesPerPeriod,BOOL bDiscardable,
               LPDWORD lpTransferSize,LPDWORD lpNumOutstandingRequests)

{
  int iVar1;
  BOOL BVar2;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 uVar3;
  undefined8 uVar4;
  undefined local_28 [8];
  HANDLE local_20;
  uint local_1c;
  DWORD local_18;
  undefined local_14;
  undefined local_13;
  uint local_10;
  DWORD local_c;
  uint local_8;
  
                    // 0x30cd0  1314  SetFileBandwidthReservation
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_20 = hFile;
  iVar1 = NtQueryInformationFile(hFile,local_28,&local_1c,0x14,0x2c);
  if (iVar1 < 0) {
    BaseSetLastNTError(iVar1);
    uVar3 = extraout_EDX;
  }
  else if (local_10 == 0) {
    *lpTransferSize = 0;
    *lpNumOutstandingRequests = 0;
    RtlSetLastWin32Error(1);
    uVar3 = extraout_EDX_00;
  }
  else {
    local_1c = nBytesPerPeriod / local_10;
    if ((local_1c == 0) && (nBytesPerPeriod != 0)) {
      RtlSetLastWin32Error(0x57);
      uVar3 = extraout_EDX_01;
    }
    else {
      local_18 = nPeriodMilliseconds;
      local_13 = (undefined)bDiscardable;
      local_14 = 1;
      uVar4 = NtSetInformationFile(local_20,local_28,&local_1c,0x14,0x2c);
      uVar3 = (undefined4)((ulonglong)uVar4 >> 0x20);
      iVar1 = (int)uVar4;
      if (-1 < iVar1) {
        if (nBytesPerPeriod == 0) {
          *lpTransferSize = 0;
          *lpNumOutstandingRequests = 0;
          goto LAB_6b830dae;
        }
        uVar4 = NtQueryInformationFile(local_20,local_28,&local_1c,0x14,0x2c);
        uVar3 = (undefined4)((ulonglong)uVar4 >> 0x20);
        iVar1 = (int)uVar4;
        if (-1 < iVar1) {
          *lpTransferSize = local_10;
          *lpNumOutstandingRequests = local_c;
          goto LAB_6b830dae;
        }
      }
      BaseSetLastNTError(iVar1);
      uVar3 = extraout_EDX_02;
    }
  }
LAB_6b830dae:
  BVar2 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar3);
  return BVar2;
}



BOOL SetFileShortNameA(HANDLE hFile,LPCSTR lpShortName)

{
  BOOL BVar1;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x30dd0  1320  SetFileShortNameA
  BVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpShortName);
  if (BVar1 != 0) {
    BVar1 = SetFileShortNameW(hFile,local_8);
    RtlFreeUnicodeString(local_c);
  }
  return BVar1;
}



// WARNING: Could not reconcile some variable overlaps

BOOL SetFileShortNameW(HANDLE hFile,LPCWSTR lpShortName)

{
  WCHAR WVar1;
  undefined4 *puVar2;
  int *piVar3;
  LPCWSTR pWVar4;
  uint uVar5;
  int iVar6;
  int in_FS_OFFSET;
  undefined local_10 [8];
  undefined4 local_8;
  
                    // 0x30e10  1321  SetFileShortNameW
  if (lpShortName == (LPCWSTR)0x0) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    local_8 = 0;
    pWVar4 = lpShortName;
    do {
      WVar1 = *pWVar4;
      pWVar4 = pWVar4 + 1;
    } while (WVar1 != L'\0');
    if ((int)pWVar4 - (int)(lpShortName + 1) >> 1 == 0) {
      iVar6 = 8;
    }
    else {
      pWVar4 = lpShortName;
      do {
        WVar1 = *pWVar4;
        pWVar4 = pWVar4 + 1;
      } while (WVar1 != L'\0');
      iVar6 = ((int)pWVar4 - (int)(lpShortName + 1) >> 1) * 2 + 6;
    }
    puVar2 = (undefined4 *)KernelBaseGetGlobalData();
    piVar3 = (int *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar2,
                                    iVar6);
    if (piVar3 == (int *)0x0) {
      RtlSetLastWin32Error(8);
    }
    else {
      pWVar4 = lpShortName;
      do {
        WVar1 = *pWVar4;
        pWVar4 = pWVar4 + 1;
      } while (WVar1 != (WCHAR)local_8);
      uVar5 = (int)pWVar4 - (int)(lpShortName + 1) >> 1;
      *piVar3 = uVar5 * 2;
      wcscpy_s((wchar_t *)(piVar3 + 1),(uVar5 & 0x7fffffff) + 1,lpShortName);
      iVar6 = NtSetInformationFile(hFile,local_10,piVar3,iVar6,0x28);
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,piVar3);
      if (-1 < iVar6) {
        return 1;
      }
      BaseSetLastNTError(iVar6);
    }
  }
  return 0;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 BasepCopyEncryption(undefined4 param_1,int param_2,uint *param_3)

{
  HMODULE hModule;
  FARPROC pFVar1;
  int iVar2;
  undefined4 uVar3;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar4;
  undefined4 local_14;
  
                    // 0x30f10  86  BasepCopyEncryption
  uVar3 = 0;
  hModule = LoadLibraryExW(L"advapi32.dll",(HANDLE)0x0,0x800);
  if (hModule == (HMODULE)0x0) goto LAB_6b830fa7;
  if (param_2 == 0) {
    pFVar1 = GetProcAddress(hModule,"DecryptFileW");
    if (pFVar1 == (FARPROC)0x0) goto LAB_6b830fa7;
    uVar4 = 0;
    _guard_check_icall();
    iVar2 = (*pFVar1)(param_1,uVar4);
    if (iVar2 == 0) goto LAB_6b830fa7;
    *param_3 = *param_3 & 0xffffbfff;
  }
  else {
    pFVar1 = GetProcAddress(hModule,"EncryptFileW");
    if (pFVar1 == (FARPROC)0x0) goto LAB_6b830fa7;
    _guard_check_icall();
    iVar2 = (*pFVar1)(param_1);
    if (iVar2 == 0) goto LAB_6b830fa7;
    *param_3 = *param_3 | 0x4000;
  }
  uVar3 = 1;
LAB_6b830fa7:
  FUN_6b830fcd();
  *in_FS_OFFSET = local_14;
  return uVar3;
}



void FUN_6b830fcd(void)

{
  HMODULE unaff_EDI;
  
  if (unaff_EDI != (HMODULE)0x0) {
    FreeLibrary(unaff_EDI);
  }
  return;
}



undefined4 __fastcall FUN_6b830fd9(undefined4 param_1,undefined4 param_2,int param_3)

{
  HMODULE hModule;
  FARPROC pFVar1;
  FARPROC pFVar2;
  int iVar3;
  FARPROC pFVar4;
  undefined4 uVar5;
  HMODULE hModule_00;
  undefined4 uVar6;
  int **ppiVar7;
  undefined4 uVar8;
  int *piVar9;
  int *local_10;
  FARPROC local_c;
  int *local_8;
  
  uVar5 = 0;
  hModule_00 = (HMODULE)0x0;
  local_8 = (int *)0x0;
  local_10 = (int *)0x0;
  hModule = LoadLibraryExW(L"feclient.dll",(HANDLE)0x0,0x800);
  if (hModule == (HMODULE)0x0) {
    return 0;
  }
  pFVar1 = GetProcAddress(hModule,"EfsClientEncryptFileEx");
  if (((pFVar1 == (FARPROC)0x0) ||
      (local_c = GetProcAddress(hModule,"EfsClientQueryProtectors"), local_c == (FARPROC)0x0)) ||
     (pFVar2 = GetProcAddress(hModule,"EfsClientFreeProtectorList"), pFVar2 == (FARPROC)0x0))
  goto LAB_6b83115d;
  ppiVar7 = &local_8;
  _guard_check_icall();
  iVar3 = (*local_c)(param_1,ppiVar7);
  if (iVar3 == 0) {
    if (*local_8 == 0) {
      iVar3 = 0xd;
      goto LAB_6b83106f;
    }
    if (param_3 == 0) {
LAB_6b831109:
      uVar6 = *(undefined4 *)(*(int *)local_8[1] + 8);
      _guard_check_icall();
      iVar3 = (*pFVar1)(param_2,uVar6);
      if (iVar3 != 0) goto LAB_6b83106f;
LAB_6b831128:
      uVar5 = 1;
    }
    else {
      ppiVar7 = &local_10;
      uVar6 = param_2;
      _guard_check_icall();
      iVar3 = (*local_c)(uVar6,ppiVar7);
      if (iVar3 != 0) goto LAB_6b83106f;
      if ((*local_10 == 1) &&
         (iVar3 = _wcsicmp(*(wchar_t **)(*(int *)local_8[1] + 8),
                           *(wchar_t **)(*(int *)local_10[1] + 8)), iVar3 == 0)) goto LAB_6b831128;
      hModule_00 = LoadLibraryExW(L"advapi32.dll",(HANDLE)0x0,0x800);
      if ((hModule_00 != (HMODULE)0x0) &&
         (pFVar4 = GetProcAddress(hModule_00,"DecryptFileW"), pFVar4 != (FARPROC)0x0)) {
        uVar8 = 0;
        uVar6 = param_2;
        _guard_check_icall();
        iVar3 = (*pFVar4)(uVar6,uVar8);
        if (iVar3 != 0) goto LAB_6b831109;
      }
    }
  }
  else {
LAB_6b83106f:
    RtlSetLastWin32Error(iVar3);
  }
  if (local_8 != (int *)0x0) {
    piVar9 = local_8;
    _guard_check_icall();
    (*pFVar2)(piVar9);
  }
  if (local_10 != (int *)0x0) {
    piVar9 = local_10;
    _guard_check_icall();
    (*pFVar2)(piVar9);
  }
  if (hModule_00 != (HMODULE)0x0) {
    FreeLibrary(hModule_00);
  }
LAB_6b83115d:
  FreeLibrary(hModule);
  return uVar5;
}



DWORD DuplicateEncryptionInfoFileExt
                (undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
                undefined4 param_5)

{
  HMODULE hModule;
  DWORD DVar1;
  FARPROC pFVar2;
  
                    // 0x31180  304  DuplicateEncryptionInfoFileExt
  if (DAT_6b8b0924 == (FARPROC)0x0) {
    hModule = LoadLibraryExW(L"advapi32.dll",(HANDLE)0x0,0x800);
    if (hModule == (HMODULE)0x0) {
      DVar1 = GetLastError();
      return DVar1;
    }
    pFVar2 = GetProcAddress(hModule,"DuplicateEncryptionInfoFile");
    if (pFVar2 == (FARPROC)0x0) {
      DVar1 = GetLastError();
      FreeLibrary(hModule);
      return DVar1;
    }
    LdrAddRefDll(1,hModule);
    DAT_6b8b0924 = pFVar2;
  }
  pFVar2 = DAT_6b8b0924;
  _guard_check_icall();
  DVar1 = (*pFVar2)(param_1,param_2,param_3,param_4,param_5);
  return DVar1;
}



DWORD GetEncryptedFileVersionExt(undefined4 param_1,undefined4 *param_2)

{
  HMODULE hModule;
  DWORD DVar1;
  FARPROC pFVar2;
  FARPROC pFVar3;
  undefined4 uVar4;
  int *piVar5;
  int iVar6;
  int local_8;
  
                    // 0x31210  570  GetEncryptedFileVersionExt
  pFVar3 = (FARPROC)0x0;
  local_8 = 0;
  hModule = LoadLibraryExW(L"advapi32.dll",(HANDLE)0x0,0x800);
  if (hModule != (HMODULE)0x0) {
    pFVar2 = GetProcAddress(hModule,"EncryptedFileKeyInfo");
    if (pFVar2 != (FARPROC)0x0) {
      pFVar3 = GetProcAddress(hModule,"FreeEncryptedFileKeyInfo");
      if (pFVar3 != (FARPROC)0x0) {
        piVar5 = &local_8;
        uVar4 = 2;
        _guard_check_icall();
        DVar1 = (*pFVar2)(param_1,uVar4,piVar5);
        if (DVar1 == 0) {
          *param_2 = **(undefined4 **)(local_8 + 4);
        }
        goto LAB_6b831289;
      }
    }
  }
  DVar1 = GetLastError();
LAB_6b831289:
  if (local_8 != 0) {
    iVar6 = local_8;
    _guard_check_icall();
    (*pFVar3)(iVar6);
  }
  if (hModule != (HMODULE)0x0) {
    FreeLibrary(hModule);
  }
  return DVar1;
}



BOOL AddSecureMemoryCacheCallback(PSECURE_MEMORY_CACHE_CALLBACK pfnCallBack)

{
  int iVar1;
  
                    // 0x312c0  21  AddSecureMemoryCacheCallback
  iVar1 = RtlRegisterSecureMemoryCacheCallback(pfnCallBack);
  if (iVar1 < 0) {
    BaseSetLastNTError(iVar1);
  }
  return (uint)(iVar1 >= 0);
}



UINT EnumSystemFirmwareTables
               (DWORD FirmwareTableProviderSignature,PVOID pFirmwareTableEnumBuffer,DWORD BufferSize
               )

{
  UINT UVar1;
  
                    // 0x312f0  339  EnumSystemFirmwareTables
                    // WARNING: Could not recover jumptable at 0x6b8312f6. Too many branches
                    // WARNING: Treating indirect jump as call
  UVar1 = EnumSystemFirmwareTables
                    (FirmwareTableProviderSignature,pFirmwareTableEnumBuffer,BufferSize);
  return UVar1;
}



UINT GetSystemFirmwareTable
               (DWORD FirmwareTableProviderSignature,DWORD FirmwareTableID,
               PVOID pFirmwareTableBuffer,DWORD BufferSize)

{
  UINT UVar1;
  
                    // 0x31310  744  GetSystemFirmwareTable
                    // WARNING: Could not recover jumptable at 0x6b831316. Too many branches
                    // WARNING: Treating indirect jump as call
  UVar1 = GetSystemFirmwareTable
                    (FirmwareTableProviderSignature,FirmwareTableID,pFirmwareTableBuffer,BufferSize)
  ;
  return UVar1;
}



SIZE_T GlobalCompact(DWORD dwMinFree)

{
  SIZE_T SVar1;
  
                    // 0x31330  820  GlobalCompact
                    // 0x31330  977  LocalCompact
  SVar1 = RtlCompactHeap(DAT_6b8b0734,0);
  return SVar1;
}



void GlobalFix(HGLOBAL hMem)

{
                    // 0x31350  824  GlobalFix
  if (hMem != (HGLOBAL)0xffffffff) {
    GlobalLock(hMem);
    return;
  }
  return;
}



BOOL GlobalUnWire(HGLOBAL hMem)

{
  BOOL BVar1;
  
                    // 0x31370  835  GlobalUnWire
  BVar1 = GlobalUnlock(hMem);
  return BVar1;
}



void GlobalUnfix(HGLOBAL hMem)

{
                    // 0x31380  836  GlobalUnfix
  if (hMem != (HGLOBAL)0xffffffff) {
    GlobalUnlock(hMem);
    return;
  }
  return;
}



LPVOID GlobalWire(HGLOBAL hMem)

{
  LPVOID pvVar1;
  
                    // 0x313a0  838  GlobalWire
  pvVar1 = GlobalLock(hMem);
  return pvVar1;
}



void RegisterWowBaseHandlers(undefined4 param_1)

{
  DAT_6b8b08d0 = param_1;
                    // 0x313b0  1200  RegisterWowBaseHandlers
  return;
}



BOOL RemoveSecureMemoryCacheCallback(PSECURE_MEMORY_CACHE_CALLBACK pfnCallBack)

{
  uint uVar1;
  
                    // 0x313d0  1217  RemoveSecureMemoryCacheCallback
  uVar1 = RtlDeregisterSecureMemoryCacheCallback(pfnCallBack);
  return uVar1 & 0xff;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

HLOCAL LocalHandle(LPCVOID pMem)

{
  char cVar1;
  undefined4 *in_FS_OFFSET;
  uint local_24;
  HLOCAL local_20 [3];
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x313f0  982  LocalHandle
  local_8 = &DAT_6b891e10;
  uStack12 = 0x6b8313fc;
  local_20[0] = (HLOCAL)0x0;
  RtlLockHeap(DAT_6b8b0734);
  local_8 = (undefined *)0x1;
  local_20[0] = (HLOCAL)0x0;
  cVar1 = RtlGetUserInfoHeap(DAT_6b8b0734,1,pMem,local_20,&local_24);
  if (cVar1 == '\0') {
    RtlSetLastWin32Error(6);
  }
  else if ((local_20[0] == (HLOCAL)0x0) || ((local_24 & 0x200) == 0)) {
    local_20[0] = pMem;
  }
  local_8 = (undefined *)0xfffffffe;
  FUN_6b83149d();
  *in_FS_OFFSET = local_14;
  return local_20[0];
}



void FUN_6b83149d(void)

{
  RtlUnlockHeap(DAT_6b8b0734);
  return;
}



SIZE_T LocalShrink(HLOCAL hMem,UINT cbNewSize)

{
  SIZE_T SVar1;
  
                    // 0x314b0  985  LocalShrink
  SVar1 = RtlCompactHeap(DAT_6b8b0734,0);
  return SVar1;
}



void LoadStringBaseW(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
                    // 0x314d0  975  LoadStringBaseW
  LoadStringBaseExW(param_1,param_2,param_3,param_4,0);
  return;
}



BOOL EnumResourceLanguagesA
               (HMODULE hModule,LPCSTR lpType,LPCSTR lpName,ENUMRESLANGPROCA lpEnumFunc,
               LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // 0x31500  325  EnumResourceLanguagesA
  BVar1 = EnumResourceLanguagesExA(hModule,lpType,lpName,lpEnumFunc,lParam,3,0);
  return BVar1;
}



BOOL EnumResourceLanguagesW
               (HMODULE hModule,LPCWSTR lpType,LPCWSTR lpName,ENUMRESLANGPROCW lpEnumFunc,
               LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // 0x31530  328  EnumResourceLanguagesW
  BVar1 = EnumResourceLanguagesExW(hModule,lpType,lpName,lpEnumFunc,lParam,3,0);
  return BVar1;
}



BOOL EnumResourceNamesA(HMODULE hModule,LPCSTR lpType,ENUMRESNAMEPROCA lpEnumFunc,LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // 0x31560  329  EnumResourceNamesA
  BVar1 = EnumResourceNamesExA(hModule,lpType,lpEnumFunc,lParam,3,0);
  return BVar1;
}



BOOL EnumResourceTypesA(HMODULE hModule,ENUMRESTYPEPROCA lpEnumFunc,LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // 0x31590  333  EnumResourceTypesA
  BVar1 = EnumResourceTypesExA(hModule,lpEnumFunc,lParam,3,0);
  return BVar1;
}



BOOL EnumResourceTypesW(HMODULE hModule,ENUMRESTYPEPROCW lpEnumFunc,LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // 0x315c0  336  EnumResourceTypesW
  BVar1 = EnumResourceTypesExW(hModule,lpEnumFunc,lParam,3,0);
  return BVar1;
}



// WARNING: Could not reconcile some variable overlaps

DWORD GetDllDirectoryA(DWORD nBufferLength,LPSTR lpBuffer)

{
  uint uVar1;
  DWORD DVar2;
  undefined4 *puVar3;
  int iVar4;
  code *pcVar5;
  short sVar6;
  int in_FS_OFFSET;
  uint local_14;
  LPSTR local_10;
  short local_c;
  short local_a;
  int local_8;
  
                    // 0x315f0  562  GetDllDirectoryA
  local_14 = 0;
  local_10 = (LPSTR)0x0;
  RtlInitUnicodeString(&local_c,0);
  LdrGetDllDirectory(&local_c);
  sVar6 = local_c;
  if (local_c == 2) {
    if (nBufferLength == 0) {
      DVar2 = 1;
    }
    else {
      RtlSetLastWin32Error(0);
      *lpBuffer = '\0';
      DVar2 = 0;
    }
  }
  else {
    puVar3 = (undefined4 *)KernelBaseGetGlobalData();
    local_8 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar3,sVar6);
    while (local_8 != 0) {
      local_c = 0;
      local_a = sVar6;
      iVar4 = LdrGetDllDirectory(&local_c);
      if (iVar4 != -0x3fffffdd) {
        local_10 = lpBuffer;
        uVar1 = local_14 & 0xffff;
        local_14 = uVar1 | nBufferLength << 0x10;
        if (0xfffe < nBufferLength) {
          local_14 = CONCAT22(0xfffe,(short)uVar1);
        }
        pcVar5 = (code *)GetUnicodeStringToEightBitStringRoutine(&local_14,&local_c,0);
        _guard_check_icall();
        iVar4 = (*pcVar5)();
        if (-1 < iVar4) {
          return (local_14 & 0xffff) - 1;
        }
        goto LAB_6b8316be;
      }
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_8);
      sVar6 = local_c;
      puVar3 = (undefined4 *)KernelBaseGetGlobalData();
      local_8 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar3,sVar6)
      ;
    }
    iVar4 = -0x3fffffe9;
LAB_6b8316be:
    if (nBufferLength != 0) {
      *lpBuffer = '\0';
    }
    if (iVar4 == -0x7ffffffb) {
      pcVar5 = (code *)GetUnicodeStringToEightBitSizeRoutine(&local_c);
      _guard_check_icall();
      DVar2 = (*pcVar5)();
    }
    else {
      BaseSetLastNTError(iVar4);
      DVar2 = 0;
    }
  }
  return DVar2;
}



BOOL SetSearchPathMode(DWORD Flags)

{
  int iVar1;
  
                    // 0x31740  1359  SetSearchPathMode
  iVar1 = RtlSetSearchPathMode(Flags);
  if (iVar1 < 0) {
    BaseSetLastNTError(iVar1);
  }
  return (uint)(iVar1 >= 0);
}



undefined4
UTRegister(undefined4 param_1,PCNZCH param_2,undefined4 param_3,PCNZCH param_4,undefined **param_5)

{
  int iVar1;
  
                    // 0x31770  1457  UTRegister
  iVar1 = CompareStringA(0x7f,1,param_2,-1,"mem16.dll",-1);
  if ((iVar1 == 2) && (iVar1 = CompareStringA(0x7f,1,param_4,-1,"GetMemory",-1), iVar1 == 2)) {
    *param_5 = FUN_6b8221a0;
    return 1;
  }
  return 0;
}



void CmdBatNotification(void)

{
                    // 0x317d0  153  CmdBatNotification
                    // 0x317d0  1458  UTUnRegister
  return;
}



BOOL GetNamedPipeClientSessionId(HANDLE Pipe,PULONG ClientSessionId)

{
  BOOL BVar1;
  ULONG local_10;
  undefined4 local_c;
  ULONG_PTR local_8;
  
                    // 0x317e0  645  GetNamedPipeClientSessionId
  local_10 = 0;
  local_c = 0;
  local_8 = 8;
  BVar1 = GetNamedPipeAttribute(Pipe,PipeConnectionAttribute,"ClientSessionId",&local_10,&local_8);
  if (BVar1 != 0) {
    *ClientSessionId = local_10;
  }
  return BVar1;
}



BOOL GetNamedPipeServerSessionId(HANDLE Pipe,PULONG ServerSessionId)

{
  BOOL BVar1;
  ULONG_PTR local_8;
  
                    // 0x31830  650  GetNamedPipeServerSessionId
  local_8 = 4;
  BVar1 = GetNamedPipeAttribute(Pipe,PipeAttribute,"ServerSessionId",ServerSessionId,&local_8);
  return BVar1;
}



BOOL SetNamedPipeAttribute
               (HANDLE Pipe,PIPE_ATTRIBUTE_TYPE AttributeType,PSTR AttributeName,
               PVOID AttributeValue,SIZE_T AttributeValueLength)

{
  char *_Size;
  char cVar1;
  void *_Dst;
  int iVar2;
  uint uVar3;
  PSTR pCVar4;
  undefined4 uVar5;
  int in_FS_OFFSET;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  uint local_14 [2];
  char *local_c;
  undefined4 local_8;
  
                    // 0x31860  1342  SetNamedPipeAttribute
  if (AttributeType == PipeAttribute) {
    uVar5 = 0x11002c;
  }
  else if (AttributeType == PipeConnectionAttribute) {
    uVar5 = 0x110034;
  }
  else {
    if (AttributeType != PipeHandleAttribute) {
      RtlSetLastWin32Error(0x57);
      return 0;
    }
    uVar5 = 0x11003c;
  }
  pCVar4 = AttributeName;
  do {
    cVar1 = *pCVar4;
    pCVar4 = pCVar4 + 1;
  } while (cVar1 != '\0');
  _Size = pCVar4 + (1 - (int)(AttributeName + 1));
  local_c = _Size + AttributeValueLength;
  _Dst = (void *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_c);
  if (_Dst == (void *)0x0) {
    RtlSetLastWin32Error(8);
  }
  else {
    memcpy(_Dst,AttributeName,(size_t)_Size);
    if (AttributeValueLength != 0) {
      memcpy((char *)((int)_Dst + (int)_Size),AttributeValue,AttributeValueLength);
    }
    local_2c = 0x18;
    local_28 = 0;
    local_20 = 0;
    local_24 = 0;
    local_1c = 0;
    local_18 = 0;
    iVar2 = NtCreateEvent(&local_8,0x1f0003,&local_2c,0,0);
    if (-1 < iVar2) {
      uVar3 = NtFsControlFile(Pipe,local_8,0,0,local_14,uVar5,_Dst,local_c,0,0);
      if ((uVar3 == 0x103) && (uVar3 = NtWaitForSingleObject(local_8,0,0), -1 < (int)uVar3)) {
        uVar3 = local_14[0];
      }
      NtClose(local_8);
      if ((int)uVar3 < 0) {
        BaseSetLastNTError(uVar3);
      }
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,_Dst);
      return ~uVar3 >> 0x1f;
    }
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,_Dst);
    BaseSetLastNTError(iVar2);
  }
  return 0;
}



BOOL GetNumaAvailableMemoryNode(UCHAR Node,PULONGLONG AvailableBytes)

{
  BOOL BVar1;
  
                    // 0x319c0  653  GetNumaAvailableMemoryNode
  BVar1 = GetNumaAvailableMemoryNodeEx((ushort)Node,AvailableBytes);
  return BVar1;
}



BOOL GetNumaNodeNumberFromHandle(HANDLE hFile,PUSHORT NodeNumber)

{
  int iVar1;
  undefined local_10 [8];
  USHORT local_8 [2];
  
                    // 0x319e0  656  GetNumaNodeNumberFromHandle
  iVar1 = NtQueryInformationFile(hFile,local_10,local_8,2,0x35);
  if (-1 < iVar1) {
    *NodeNumber = local_8[0];
  }
  else {
    BaseSetLastNTError(iVar1);
  }
  return (uint)(-1 < iVar1);
}



// WARNING: Could not reconcile some variable overlaps

BOOL GetNumaProcessorNode(UCHAR Processor,PUCHAR NodeNumber)

{
  BOOL BVar1;
  _PROCESSOR_NUMBER local_c;
  UCHAR local_8;
  
                    // 0x31a30  659  GetNumaProcessorNode
  if (Processor < 0x20) {
    RtlGetCurrentProcessorNumberEx(&local_c);
    local_c._0_3_ = CONCAT12(Processor,local_c.Group);
    local_c = local_c & 0xff000000 | (uint)local_c._0_3_;
    BVar1 = GetNumaProcessorNodeEx(&local_c,(PUSHORT)&local_8);
    *NodeNumber = local_8;
  }
  else {
    *NodeNumber = 0xff;
    RtlSetLastWin32Error(0x57);
    BVar1 = 0;
  }
  return BVar1;
}



BOOL GetNumaProximityNode(ULONG ProximityId,PUCHAR NodeNumber)

{
  BOOL BVar1;
  UCHAR local_8;
  
                    // 0x31a80  661  GetNumaProximityNode
  BVar1 = GetNumaProximityNodeEx(ProximityId,(PUSHORT)&local_8);
  if (BVar1 != 0) {
    *NodeNumber = local_8;
  }
  return BVar1;
}



BOOL CheckNameLegalDOS8Dot3A
               (LPCSTR lpName,LPSTR lpOemName,DWORD OemNameSize,PBOOL pbNameContainsSpaces,
               PBOOL pbNameLegal)

{
  int iVar1;
  BOOL BVar2;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x31ab0  132  CheckNameLegalDOS8Dot3A
  if ((((lpName == (LPCSTR)0x0) || (pbNameLegal == (PBOOL)0x0)) ||
      ((lpOemName == (LPSTR)0x0 && (OemNameSize != 0)))) || (0xffff < OemNameSize)) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpName);
    if (iVar1 != 0) {
      BVar2 = CheckNameLegalDOS8Dot3W
                        (local_8,lpOemName,OemNameSize,pbNameContainsSpaces,pbNameLegal);
      RtlFreeUnicodeString(local_c);
      return BVar2;
    }
  }
  return 0;
}



BOOL CheckNameLegalDOS8Dot3W
               (LPCWSTR lpName,LPSTR lpOemName,DWORD OemNameSize,PBOOL pbNameContainsSpaces,
               PBOOL pbNameLegal)

{
  BOOL BVar1;
  uint extraout_EDX;
  uint uVar2;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  uint *puVar3;
  uint _Size;
  undefined4 uVar4;
  undefined local_30 [8];
  uint *local_28;
  uint *local_24;
  uint local_20;
  undefined *local_1c;
  byte local_16;
  byte local_15;
  undefined local_14 [12];
  uint local_8;
  
                    // 0x31b20  133  CheckNameLegalDOS8Dot3W
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_20 = 0;
  local_1c = (undefined *)0x0;
  local_24 = (uint *)pbNameContainsSpaces;
  local_28 = (uint *)pbNameLegal;
  if ((((lpName == (LPCWSTR)0x0) || (pbNameLegal == (PBOOL)0x0)) ||
      ((lpOemName == (LPSTR)0x0 && (OemNameSize != 0)))) || (0xffff < OemNameSize)) {
    uVar4 = 0x57;
LAB_6b831bf3:
    RtlSetLastWin32Error(uVar4);
    uVar2 = extraout_EDX_01;
  }
  else {
    if (lpOemName == (LPSTR)0x0) {
      puVar3 = (uint *)0x0;
    }
    else {
      local_20 = 0xc0000;
      puVar3 = &local_20;
      local_1c = local_14;
    }
    RtlInitUnicodeString(local_30,lpName);
    local_15 = RtlIsNameLegalDOS8Dot3(local_30,puVar3,&local_16);
    uVar2 = extraout_EDX & 0xffffff00 | (uint)local_15;
    if (local_15 != 0) {
      if (puVar3 != (uint *)0x0) {
        _Size = local_20 & 0xffff;
        if (OemNameSize < _Size + 1) {
          uVar4 = 0x7a;
          goto LAB_6b831bf3;
        }
        memcpy(lpOemName,local_1c,_Size);
        uVar2 = extraout_EDX_00 & 0xffffff00 | (uint)local_15;
        lpOemName[_Size] = '\0';
      }
      if (local_24 != (uint *)0x0) {
        *local_24 = (uint)local_16;
      }
    }
    *local_28 = uVar2 & 0xff;
  }
  BVar1 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return BVar1;
}



BOOL CancelDeviceWakeupRequest(HANDLE hDevice)

{
                    // 0x31c10  117  CancelDeviceWakeupRequest
                    // 0x31c10  1224  RequestDeviceWakeup
                    // 0x31c10  1225  RequestWakeupLatency
  BaseSetLastNTError(0xc0000002);
  return 0;
}



BOOL IsSystemResumeAutomatic(void)

{
  uint uVar1;
  
                    // 0x31c30  908  IsSystemResumeAutomatic
  uVar1 = NtIsSystemResumeAutomatic();
  return uVar1 & 0xff;
}



BOOL SetMessageWaitingIndicator(HANDLE hMsgIndicator,ULONG ulMsgCount)

{
                    // 0x31c40  1341  SetMessageWaitingIndicator
  BaseSetLastNTError(0xc0000002);
  return 0;
}



BOOL SetSystemPowerState(BOOL fSuspend,BOOL fForce)

{
  int iVar1;
  
                    // 0x31c60  1363  SetSystemPowerState
  iVar1 = NtInitiatePowerAction
                    (3 - (uint)(fSuspend != 0),(-(uint)(fSuspend != 0) & 0xfffffffd) + 5,fForce != 1
                     ,0);
  if (-1 >= iVar1) {
    BaseSetLastNTError(iVar1);
  }
  return (uint)(-1 < iVar1);
}



void BasepAppContainerEnvironmentExtension(PSID param_1,wchar_t *param_2,int *param_3)

{
                    // 0x31cb0  80  BasepAppContainerEnvironmentExtension
  FUN_6b85fc08(param_1,param_2,param_3);
  return;
}



void BasepAppXExtension(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
                       undefined4 param_5,undefined4 param_6)

{
                    // 0x31cd0  81  BasepAppXExtension
  AppXPreCreationExtension(param_1,param_2,param_3,param_4,1,param_5,param_6);
  return;
}



void FUN_6b831d00(undefined4 param_1,undefined4 param_2,LPCWSTR param_3,undefined4 param_4,
                 undefined4 param_5,int **param_6)

{
  FUN_6b832356(param_6,param_1,param_3);
  return;
}



void BasepPostSuccessAppXExtension(void)

{
                    // 0x31d20  98  BasepPostSuccessAppXExtension
                    // WARNING: Could not recover jumptable at 0x6b831d26. Too many branches
                    // WARNING: Treating indirect jump as call
  AppXPostSuccessExtension();
  return;
}



// WARNING: Could not reconcile some variable overlaps

void BasepProcessInvalidImage
               (int param_1,uint param_2,LPCWSTR param_3,LPCWSTR *param_4,wchar_t **param_5,
               LPCWSTR param_6,uint *param_7,undefined4 *param_8,ushort *param_9,undefined *param_10
               ,wchar_t **param_11,int param_12,int param_13,int *param_14,undefined4 *param_15,
               ushort *param_16,short *param_17,undefined4 *param_18,uint *param_19,
               undefined4 *param_20,int *param_21)

{
  WCHAR WVar1;
  wchar_t **ppwVar2;
  uint *puVar3;
  ushort uVar4;
  int iVar5;
  int iVar6;
  undefined4 *puVar7;
  LPWSTR lpBuffer;
  DWORD DVar8;
  wchar_t *pwVar9;
  LPCWSTR pWVar10;
  uint uVar11;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 extraout_EDX_04;
  undefined4 uVar12;
  undefined4 extraout_EDX_05;
  undefined4 extraout_EDX_06;
  uint uVar13;
  ushort *puVar14;
  int in_FS_OFFSET;
  undefined8 uVar15;
  uint local_19c;
  wchar_t **local_198;
  uint *local_194;
  LPCWSTR *local_190;
  int *local_18c;
  ushort *local_188;
  uint *local_184;
  ushort *local_180;
  int local_17c;
  undefined4 *local_178;
  undefined4 *local_174;
  int *local_170;
  int local_16c;
  short *local_168;
  wchar_t **local_164;
  int local_160;
  undefined4 local_15c;
  DWORD local_158;
  undefined4 local_154;
  int local_150;
  undefined *local_14c;
  uint local_148;
  LPCWSTR local_144;
  undefined4 *local_140;
  undefined4 *local_13c;
  undefined4 local_138;
  undefined4 local_134;
  wchar_t *local_130;
  undefined local_12c [4];
  undefined4 local_128;
  uint local_124;
  LPCWSTR local_120;
  undefined4 local_11c;
  int local_118;
  undefined4 local_114;
  undefined local_110 [260];
  uint local_c;
  
                    // 0x31d40  99  BasepProcessInvalidImage
  local_c = DAT_6b8b0140 ^ (uint)&local_19c;
  local_190 = param_4;
  local_198 = param_5;
  local_144 = param_6;
  local_13c = param_8;
  local_14c = param_10;
  local_164 = param_11;
  local_16c = param_12;
  local_17c = param_13;
  local_170 = param_14;
  local_174 = param_15;
  local_180 = param_16;
  local_168 = param_17;
  local_178 = param_18;
  local_194 = param_19;
  local_140 = param_20;
  local_18c = param_21;
  local_19c = param_2;
  local_184 = param_7;
  local_188 = param_9;
  local_160 = 1;
  local_154 = 0x100;
  local_15c = 0;
  if (param_2 == 0) {
LAB_6b832004:
    if (param_1 == -0x3fffffe0) {
      FUN_6b8392ab(param_3,0x14,3,0);
      iVar5 = -0x3fffffe0;
    }
    else {
      iVar5 = local_160;
      puVar14 = local_188;
      if (param_1 != -0x3ffffee5) {
        if (param_1 == -0x3ffffed1) {
LAB_6b832258:
          puVar14 = local_188;
          iVar5 = BaseIsDosApplication(local_188);
          if (iVar5 != 0) goto LAB_6b83227b;
          iVar5 = 0xc1;
        }
        else {
          if (param_1 == -0x3ffffed0) goto LAB_6b83227b;
          if (param_1 == -0x3ffffecf) {
            pWVar10 = param_3;
            do {
              WVar1 = *pWVar10;
              pWVar10 = pWVar10 + 1;
            } while (WVar1 != (WCHAR)local_15c);
            local_120 = param_3;
            local_11c = 0;
            local_114 = 0;
            local_118 = ((int)pWVar10 - (int)(param_3 + 1) >> 1) * 2;
            EtwEventWriteNoRegistration(&DAT_6b8870f8,&DAT_6b8870e8,1,&local_120);
            uVar13 = local_19c;
            if ((*param_7 & 0x2000) != 0) goto LAB_6b832258;
            local_148 = 1;
            *local_14c = 1;
            iVar5 = CheckElevation(param_3,&local_148,local_19c,&local_124,&local_128);
            if (iVar5 == 0) {
              iVar5 = FUN_6b837894(*local_164,(int)local_180,local_168);
              ppwVar2 = local_198;
              uVar12 = extraout_EDX_01;
              if (iVar5 == 0) goto LAB_6b832329;
              uVar11 = (-(uint)((*param_7 & 0x800) != 0) & 0x20) + 0x20;
              *local_194 = uVar11;
              while (iVar5 = FUN_6b83659e(uVar11,*local_190,*ppwVar2,local_144,local_180,local_17c,
                                          local_170,*param_7,local_16c,uVar13), puVar7 = local_174,
                    iVar5 < 0) {
                BaseSetLastNTError(iVar5);
                puVar3 = local_194;
                uVar12 = extraout_EDX_03;
                if (((iVar5 == -0x3ffffbec) || (*local_194 != 0x20)) ||
                   (DVar8 = GetLastError(), uVar12 = extraout_EDX_04, DVar8 != 5))
                goto LAB_6b832329;
                *param_7 = *param_7 | 0x800;
                uVar11 = 0x80;
                *puVar3 = 0x80;
                uVar13 = local_19c;
              }
              uVar4 = *(ushort *)(local_17c + 0x9a) & 7;
              if (uVar4 == 1) {
                *local_178 = 1;
                uVar15 = FUN_6b837db4(local_17c,*local_170,*local_194,local_174);
                uVar12 = (undefined4)((ulonglong)uVar15 >> 0x20);
                if ((int)uVar15 == 0) {
                  iVar5 = -0x3ffffecf;
                  goto LAB_6b832322;
                }
                *local_140 = 1;
                *ppwVar2 = (wchar_t *)puVar7[1];
                *local_190 = (LPCWSTR)0x0;
                *param_7 = *param_7 & 0xffffffe7 | 0x8000000;
                *(uint *)(local_16c + 0x2c) = *(uint *)(local_16c + 0x2c) | 0x40;
              }
              else {
                if (uVar4 == 2) {
                  iVar5 = 0x15;
                  goto LAB_6b832055;
                }
                uVar12 = extraout_EDX_02;
                if (uVar4 == 4) {
                  *local_178 = 4;
                  *local_18c = *(int *)(local_17c + 0x44);
                }
              }
              if (*local_18c == 0) {
                *local_13c = 0;
                *local_164 = *(wchar_t **)(local_168 + 2);
              }
              goto LAB_6b832329;
            }
          }
          else if (param_1 == -0x3ffffd99) {
            iVar5 = 0x10fe;
          }
          else {
            iVar5 = param_1;
            if (param_1 != -0x3ffffbd8) goto LAB_6b832322;
            iVar5 = 0x241;
          }
        }
LAB_6b832055:
        RtlSetLastWin32Error(iVar5);
        uVar12 = extraout_EDX_00;
        goto LAB_6b832329;
      }
LAB_6b83227b:
      iVar6 = FUN_6b838d45(param_3,&local_138,&local_158);
      if (iVar6 == 0) {
        pWVar10 = param_3;
        do {
          WVar1 = *pWVar10;
          pWVar10 = pWVar10 + 1;
        } while (WVar1 != (WCHAR)local_15c);
        local_120 = param_3;
        local_11c = 0;
        local_114 = 0;
        local_118 = ((int)pWVar10 - (int)(param_3 + 1) >> 1) * 2;
        EtwEventWriteNoRegistration(&DAT_6b8870f8,&DAT_6b8870e8,1,&local_120);
        FUN_6b8392ab(param_3,iVar5 + 0x10,0,local_158);
        RaiseInvalid16BitExeError(puVar14);
        uVar12 = extraout_EDX_05;
        goto LAB_6b832329;
      }
      FUN_6b8392ab(param_3,0x14,local_138,local_158);
      iVar5 = -0x3ffffefe;
    }
  }
  else {
    if (((param_1 != -0x3ffffee5) && (param_1 != -0x3ffffed0)) && (param_1 != -0x3ffffecf)) {
      if (param_1 != -0x3ffffed1) goto LAB_6b832004;
      iVar5 = BaseIsDosApplication(param_9);
      if (iVar5 != 0) goto LAB_6b831e41;
      goto LAB_6b832258;
    }
LAB_6b831e41:
    iVar6 = RtlQueryPackageIdentity(local_19c,local_110,&local_154,0,0,0);
    iVar5 = param_1;
    if ((iVar6 < 0) &&
       (iVar5 = NtQueryInformationToken(local_19c,0xc,&local_150,4,local_12c), -1 < iVar5)) {
      if (local_150 == *(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x1d4)) goto LAB_6b832004;
      puVar7 = (undefined4 *)KernelBaseGetGlobalData();
      lpBuffer = (LPWSTR)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                                         *puVar7,0x208);
      DVar8 = GetEnvironmentVariableW(L"SystemRoot",lpBuffer,0xef);
      if ((DVar8 < 0xef) && (DVar8 != 0)) {
        FUN_6b83282b(lpBuffer,0x104,(int)L"\\system32\\csrstub.exe");
        puVar7 = (undefined4 *)KernelBaseGetGlobalData();
        pwVar9 = (wchar_t *)
                 RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar7,
                                 (DVar8 + 0x119) * 2);
        if (pwVar9 == (wchar_t *)0x0) {
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpBuffer);
          iVar5 = -0x3fffffe9;
        }
        else {
          iVar5 = FUN_6b832879(pwVar9,DVar8 + 0x119,L"%ws %d -P %ws");
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpBuffer);
          if (iVar5 < 0) {
            RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pwVar9);
          }
          else {
            iVar5 = RtlInitUnicodeStringEx(&local_134,pwVar9);
            puVar7 = local_174;
            if (-1 < iVar5) {
              RtlFreeUnicodeString(local_174);
              *puVar7 = local_134;
              puVar7[1] = local_130;
              *local_198 = local_130;
              *local_190 = (LPCWSTR)0x0;
              *local_184 = *local_184 & 0x404 | 0xc000000;
              uVar12 = extraout_EDX;
              goto LAB_6b832329;
            }
            RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pwVar9);
          }
        }
      }
      else {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpBuffer);
        iVar5 = -0x3ffffefd;
      }
    }
  }
LAB_6b832322:
  BaseSetLastNTError(iVar5);
  uVar12 = extraout_EDX_06;
LAB_6b832329:
  FUN_6b8224af(local_c ^ (uint)&local_19c,uVar12);
  return;
}



void BasepReleaseAppXContext(void)

{
                    // WARNING: Could not recover jumptable at 0x6b832350. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x32350  102  BasepReleaseAppXContext
  AppXReleaseAppXContext();
  return;
}



// WARNING: Could not reconcile some variable overlaps

int __fastcall FUN_6b832356(int **param_1,undefined4 param_2,LPCWSTR param_3)

{
  int **ppiVar1;
  code *pcVar2;
  int iVar3;
  undefined4 *puVar4;
  int **ppiVar5;
  HMODULE hModule;
  int *piVar6;
  int in_FS_OFFSET;
  undefined4 local_c;
  int **local_8;
  
  local_c = param_1;
  local_8 = param_1;
  iVar3 = RtlInitUnicodeStringEx(&local_c,param_2);
  if (-1 < iVar3) {
    for (ppiVar5 = (int **)*param_1; ppiVar5 != param_1; ppiVar5 = (int **)*ppiVar5) {
      iVar3 = RtlCompareUnicodeString(ppiVar5 + 2,&local_c,1);
      if (iVar3 == 0) goto LAB_6b83247f;
    }
    puVar4 = (undefined4 *)KernelBaseGetGlobalData();
    ppiVar5 = (int **)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar4,
                                      ((uint)local_c >> 0x10) + 0x14);
    if (ppiVar5 == (int **)0x0) {
      iVar3 = -0x3fffffe9;
    }
    else {
      ppiVar5[1] = (int *)ppiVar5;
      *ppiVar5 = (int *)ppiVar5;
      ppiVar5[3] = (int *)(ppiVar5 + 5);
      *(undefined2 *)(ppiVar5 + 2) = (undefined2)local_c;
      *(ushort *)((int)ppiVar5 + 10) = local_c._2_2_;
      memcpy(ppiVar5 + 5,local_8,(uint)local_c._2_2_);
      piVar6 = param_1[1];
      if ((int **)*piVar6 != param_1) {
LAB_6b832486:
        pcVar2 = (code *)swi(0x29);
        (*pcVar2)();
        pcVar2 = (code *)swi(3);
        iVar3 = (*pcVar2)();
        return iVar3;
      }
      *ppiVar5 = (int *)param_1;
      ppiVar5[1] = piVar6;
      *piVar6 = (int)ppiVar5;
      param_1[1] = (int *)ppiVar5;
      if ((param_3 == (LPCWSTR)0x0) || (hModule = LoadLibraryW(param_3), hModule == (HMODULE)0x0)) {
        piVar6 = *ppiVar5;
        if (((int **)piVar6[1] != ppiVar5) ||
           (ppiVar1 = (int **)ppiVar5[1], (int **)*ppiVar1 != ppiVar5)) goto LAB_6b832486;
        *ppiVar1 = piVar6;
        piVar6[1] = (int)ppiVar1;
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,ppiVar5);
      }
      else {
        piVar6 = (int *)GetProcAddress(hModule,"CreateProcessNotify");
        ppiVar5[4] = piVar6;
        if (piVar6 == (int *)0x0) {
          piVar6 = *ppiVar5;
          if (((int **)piVar6[1] != ppiVar5) ||
             (ppiVar1 = (int **)ppiVar5[1], (int **)*ppiVar1 != ppiVar5)) goto LAB_6b832486;
          *ppiVar1 = piVar6;
          piVar6[1] = (int)ppiVar1;
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,ppiVar5);
          FreeLibrary(hModule);
        }
      }
LAB_6b83247f:
      iVar3 = 0;
    }
  }
  return iVar3;
}



void FatalExit(int ExitCode)

{
  code *pcVar1;
  
                    // 0x32490  365  FatalExit
  RtlExitUserProcess(ExitCode);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



BOOL GetProcessDEPPolicy(HANDLE hProcess,LPDWORD lpFlags,PBOOL lpPermanent)

{
  BOOL BVar1;
  DWORD local_c;
  uint local_8;
  
                    // 0x324b0  694  GetProcessDEPPolicy
  BVar1 = GetProcessMitigationPolicy(hProcess,0,&local_c,8);
  if (BVar1 != 0) {
    *lpFlags = local_c;
    *lpPermanent = local_8 & 0xff;
  }
  return BVar1;
}



DEP_SYSTEM_POLICY_TYPE GetSystemDEPPolicy(void)

{
  byte bVar1;
  DEP_SYSTEM_POLICY_TYPE DStack4;
  
                    // 0x324f0  736  GetSystemDEPPolicy
  DStack4 = DEPPolicyAlwaysOff;
  bVar1 = DAT_7ffe02d5 & 3;
  if (bVar1 != 0) {
    if (bVar1 == 1) {
      DStack4 = DEPPolicyAlwaysOn;
    }
    else if (bVar1 == 2) {
      DStack4 = DEPPolicyOptIn;
    }
    else if (bVar1 == 3) {
      DStack4 = DEPPolicyOptOut;
    }
  }
  return DStack4;
}



BOOL GetSystemRegistryQuota(PDWORD pdwQuotaAllowed,PDWORD pdwQuotaUsed)

{
  BOOL BVar1;
  undefined4 extraout_EDX;
  undefined4 uVar2;
  undefined8 uVar3;
  DWORD local_14;
  DWORD local_10;
  uint local_8;
  
                    // 0x32530  748  GetSystemRegistryQuota
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  uVar3 = NtQuerySystemInformation(0x25,&local_14,0xc,0);
  uVar2 = (undefined4)((ulonglong)uVar3 >> 0x20);
  if ((int)uVar3 < 0) {
    BaseSetLastNTError((int)uVar3);
    uVar2 = extraout_EDX;
  }
  else {
    if (pdwQuotaAllowed != (PDWORD)0x0) {
      *pdwQuotaAllowed = local_14;
    }
    if (pdwQuotaUsed != (PDWORD)0x0) {
      *pdwQuotaUsed = local_10;
    }
  }
  BVar1 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return BVar1;
}



BOOL IsBadHugeReadPtr(void *lp,UINT_PTR ucb)

{
  BOOL BVar1;
  
                    // 0x325a0  889  IsBadHugeReadPtr
  BVar1 = IsBadReadPtr(lp,ucb);
  return BVar1;
}



BOOL IsBadHugeWritePtr(LPVOID lp,UINT_PTR ucb)

{
  BOOL BVar1;
  
                    // 0x325b0  890  IsBadHugeWritePtr
  BVar1 = IsBadWritePtr(lp,ucb);
  return BVar1;
}



void NtVdm64CreateProcessInternalW
               (undefined4 param_1,LPCWSTR param_2,short *param_3,undefined4 param_4,
               undefined4 param_5,undefined4 param_6,undefined4 param_7,undefined4 param_8,
               undefined4 param_9,undefined4 param_10,undefined4 param_11,undefined4 param_12)

{
  uint uVar1;
  HMODULE hModule;
  FARPROC pFVar2;
  int iVar3;
  undefined4 extraout_EDX;
  DWORD DVar4;
  int in_FS_OFFSET;
  LPCWSTR pWVar5;
  short local_214 [262];
  uint local_8;
  
                    // 0x325c0  1023  NtVdm64CreateProcessInternalW
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  DVar4 = 0xc1;
  if (((short *)(*(int *)(in_FS_OFFSET + 0x18) + 0xc00U) <= param_3) &&
     (param_3 < (short *)(*(int *)(in_FS_OFFSET + 0x18) + 0xe0aU))) {
    uVar1 = FUN_6b812c57(local_214,0x105,(int)param_3);
    if ((int)uVar1 < 0) {
      DVar4 = uVar1 & 0xffff;
      goto LAB_6b832739;
    }
    param_3 = local_214;
  }
  hModule = LoadLibraryExW(L"NtVdm64.Dll",(HANDLE)0x0,0x800);
  if (hModule == (HMODULE)0x0) goto LAB_6b832739;
  pFVar2 = GetProcAddress(hModule,"NtVdm64CreateProcessInternalW");
  if (pFVar2 != (FARPROC)0x0) {
    pWVar5 = param_2;
    _guard_check_icall();
    iVar3 = (*pFVar2)(param_1,pWVar5,param_3,param_4,param_5,param_6,param_7,param_8,param_9,
                      param_10,param_11,param_12);
    DVar4 = GetLastError();
    if (iVar3 == 0) {
      if (DVar4 != 0xd8) goto LAB_6b832731;
      iVar3 = 0x20;
    }
    else {
      iVar3 = 0x100;
    }
    FUN_6b8392ab(param_2,iVar3,0,0);
  }
LAB_6b832731:
  FreeLibrary(hModule);
LAB_6b832739:
  RtlSetLastWin32Error(DVar4);
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,extraout_EDX);
  return;
}



void RaiseInvalid16BitExeError(ushort *param_1)

{
  HMODULE hModule;
  FARPROC pFVar1;
  undefined4 extraout_EDX;
  int in_FS_OFFSET;
  ushort *puVar2;
  undefined4 uVar3;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  uint local_10;
  undefined4 local_c;
  uint local_8;
  
                    // 0x32760  1128  RaiseInvalid16BitExeError
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  hModule = LoadLibraryExW(L"NtVdm64.Dll",(HANDLE)0x0,0x800);
  if (hModule != (HMODULE)0x0) {
    pFVar1 = GetProcAddress(hModule,"NtVdm64RaiseInvalid16BitError");
    if (pFVar1 != (FARPROC)0x0) {
      puVar2 = param_1;
      _guard_check_icall();
      (*pFVar1)(puVar2);
    }
    FreeLibrary(hModule);
  }
  local_20 = *(undefined4 *)(param_1 + 2);
  local_1c = 0;
  RtlWow64LogMessageInEventLogger(1,&local_20,0x40000455);
  local_18 = *(undefined4 *)(param_1 + 2);
  local_14 = 0;
  local_c = 0;
  local_10 = (uint)*param_1;
  EtwEventWriteNoRegistration(&DAT_6b8870f8,&DAT_6b8870e8,1,&local_18);
  if (*(uint *)(*(int *)(in_FS_OFFSET + 0x30) + 0xb8) < 4) {
    uVar3 = 0xc1;
  }
  else {
    uVar3 = 0xd8;
  }
  RtlSetLastWin32Error(uVar3);
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,extraout_EDX);
  return;
}



void __fastcall FUN_6b83282b(short *param_1,uint param_2,int param_3)

{
  int iVar1;
  undefined4 extraout_ECX;
  short *local_8;
  
  iVar1 = 0;
  if ((param_2 == 0) || (0x7fffffff < param_2)) {
    iVar1 = -0x3ffffff3;
  }
  if (-1 < iVar1) {
    local_8 = param_1;
    iVar1 = FUN_6b83290d(param_1,param_2,(int *)&local_8);
    if (-1 < iVar1) {
      FUN_6b8328bd(param_1 + (int)local_8,param_2 - (int)local_8,extraout_ECX,param_3);
    }
  }
  return;
}



int __cdecl FUN_6b832879(wchar_t *param_1,uint param_2,wchar_t *param_3)

{
  int iVar1;
  
  iVar1 = 0;
  if ((param_2 == 0) || (0x7fffffff < param_2)) {
    iVar1 = -0x3ffffff3;
  }
  if (iVar1 < 0) {
    if (param_2 != 0) {
      *param_1 = L'\0';
    }
  }
  else {
    iVar1 = FUN_6b832952(param_1,param_2,&stack0x00000010,param_3,&stack0x00000010);
  }
  return iVar1;
}



int __fastcall FUN_6b8328bd(short *param_1,int param_2,undefined4 param_3,int param_4)

{
  short sVar1;
  int iVar2;
  int iVar3;
  
  if (param_2 != 0) {
    iVar3 = 0x7ffffffe;
    iVar2 = param_4 - (int)param_1;
    do {
      if ((iVar3 == 0) || (sVar1 = *(short *)(iVar2 + (int)param_1), sVar1 == 0)) break;
      *param_1 = sVar1;
      param_1 = param_1 + 1;
      iVar3 = iVar3 + -1;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
    if (param_2 != 0) goto LAB_6b8328f4;
  }
  param_1 = param_1 + -1;
LAB_6b8328f4:
  *param_1 = 0;
  return (-(uint)(param_2 != 0) & 0x7ffffffb) + 0x80000005;
}



int __fastcall FUN_6b83290d(short *param_1,int param_2,int *param_3)

{
  int iVar1;
  
  iVar1 = param_2;
  if (param_2 != 0) {
    do {
      if (*param_1 == 0) break;
      param_1 = param_1 + 1;
      iVar1 = iVar1 + -1;
    } while (iVar1 != 0);
  }
  if (param_3 != (int *)0x0) {
    if (iVar1 == 0) {
      *param_3 = 0;
    }
    else {
      *param_3 = param_2 - iVar1;
    }
  }
  return (-(uint)(iVar1 != 0) & 0x3ffffff3) + 0xc000000d;
}



undefined4 __fastcall
FUN_6b832952(wchar_t *param_1,int param_2,undefined4 param_3,wchar_t *param_4,va_list param_5)

{
  uint _Count;
  uint uVar1;
  undefined4 uVar2;
  
  _Count = param_2 - 1;
  uVar2 = 0;
  uVar1 = _vsnwprintf(param_1,_Count,param_4,param_5);
  if (((int)uVar1 < 0) || (_Count < uVar1)) {
    uVar2 = 0x80000005;
  }
  else if (uVar1 != _Count) {
    return 0;
  }
  param_1[_Count] = L'\0';
  return uVar2;
}



BOOL ReplacePartitionUnit(PWSTR TargetPartition,PWSTR SparePartition,ULONG Flags)

{
  int iVar1;
  undefined local_14 [8];
  undefined local_c [8];
  
                    // 0x329a0  1223  ReplacePartitionUnit
  RtlInitUnicodeString(local_c,SparePartition);
  RtlInitUnicodeString(local_14,TargetPartition);
  iVar1 = NtReplacePartitionUnit(local_14,local_c,Flags);
  if (-1 >= iVar1) {
    BaseSetLastNTError(iVar1);
  }
  return (uint)(-1 < iVar1);
}



void AddRefActCtx(HANDLE hActCtx)

{
                    // WARNING: Could not recover jumptable at 0x6b8329f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x329f0  16  AddRefActCtx
  AddRefActCtx(hActCtx);
  return;
}



void AddResourceAttributeAce(void)

{
                    // 0x32a00  18  AddResourceAttributeAce
                    // WARNING: Could not recover jumptable at 0x6b832a06. Too many branches
                    // WARNING: Treating indirect jump as call
  AddResourceAttributeAce();
  return;
}



void AddScopedPolicyIDAce(void)

{
                    // 0x32a20  20  AddScopedPolicyIDAce
                    // WARNING: Could not recover jumptable at 0x6b832a26. Too many branches
                    // WARNING: Treating indirect jump as call
  AddScopedPolicyIDAce();
  return;
}



BOOL AllocateUserPhysicalPagesNuma
               (HANDLE hProcess,PULONG_PTR NumberOfPages,PULONG_PTR PageArray,DWORD nndPreferred)

{
  BOOL BVar1;
  
                    // 0x32a40  27  AllocateUserPhysicalPagesNuma
                    // WARNING: Could not recover jumptable at 0x6b832a46. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = AllocateUserPhysicalPagesNuma(hProcess,NumberOfPages,PageArray,nndPreferred);
  return BVar1;
}



BOOL AllocateUserPhysicalPages(HANDLE hProcess,PULONG_PTR NumberOfPages,PULONG_PTR PageArray)

{
  BOOL BVar1;
  
                    // 0x32a60  26  AllocateUserPhysicalPages
                    // WARNING: Could not recover jumptable at 0x6b832a66. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = AllocateUserPhysicalPages(hProcess,NumberOfPages,PageArray);
  return BVar1;
}



void BaseCheckAppcompatCacheEx(void)

{
                    // 0x32a80  46  BaseCheckAppcompatCacheEx
                    // WARNING: Could not recover jumptable at 0x6b832a86. Too many branches
                    // WARNING: Treating indirect jump as call
  BaseCheckAppcompatCacheEx();
  return;
}



void BaseCheckAppcompatCache(void)

{
                    // 0x32aa0  45  BaseCheckAppcompatCache
                    // WARNING: Could not recover jumptable at 0x6b832aa6. Too many branches
                    // WARNING: Treating indirect jump as call
  BaseCheckAppcompatCache();
  return;
}



void BaseCleanupAppcompatCacheSupport(void)

{
                    // 0x32ac0  50  BaseCleanupAppcompatCacheSupport
                    // WARNING: Could not recover jumptable at 0x6b832ac6. Too many branches
                    // WARNING: Treating indirect jump as call
  BaseCleanupAppcompatCacheSupport();
  return;
}



void BaseDumpAppcompatCache(void)

{
                    // WARNING: Could not recover jumptable at 0x6b832ae0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x32ae0  54  BaseDumpAppcompatCache
  BaseDumpAppcompatCache();
  return;
}



void BaseFlushAppcompatCache(void)

{
                    // WARNING: Could not recover jumptable at 0x6b832af0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x32af0  57  BaseFlushAppcompatCache
  BaseFlushAppcompatCache();
  return;
}



void BaseGetNamedObjectDirectory(void)

{
                    // 0x32b00  63  BaseGetNamedObjectDirectory
                    // WARNING: Could not recover jumptable at 0x6b832b06. Too many branches
                    // WARNING: Treating indirect jump as call
  BaseGetNamedObjectDirectory();
  return;
}



void BaseInitAppcompatCacheSupport(void)

{
                    // WARNING: Could not recover jumptable at 0x6b832b20. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x32b20  64  BaseInitAppcompatCacheSupport
  BaseInitAppcompatCacheSupport();
  return;
}



void BaseUpdateAppcompatCache(void)

{
                    // 0x32b30  72  BaseUpdateAppcompatCache
                    // WARNING: Could not recover jumptable at 0x6b832b36. Too many branches
                    // WARNING: Treating indirect jump as call
  BaseUpdateAppcompatCache();
  return;
}



BOOL CallbackMayRunLong(PTP_CALLBACK_INSTANCE pci)

{
  int iVar1;
  
                    // 0x32b50  116  CallbackMayRunLong
  iVar1 = TpCallbackMayRunLong(pci);
  if (-1 >= iVar1) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  }
  return (uint)(-1 < iVar1);
}



BOOL CancelIo(HANDLE hFile)

{
  BOOL BVar1;
  
                    // 0x32b80  118  CancelIo
                    // WARNING: Could not recover jumptable at 0x6b832b86. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = CancelIo(hFile);
  return BVar1;
}



BOOL CancelSynchronousIo(HANDLE hThread)

{
  BOOL BVar1;
  
                    // 0x32ba0  120  CancelSynchronousIo
                    // WARNING: Could not recover jumptable at 0x6b832ba6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = CancelSynchronousIo(hThread);
  return BVar1;
}



BOOL ChangeTimerQueueTimer(HANDLE TimerQueue,HANDLE Timer,ULONG DueTime,ULONG Period)

{
  BOOL BVar1;
  
                    // 0x32bc0  125  ChangeTimerQueueTimer
                    // WARNING: Could not recover jumptable at 0x6b832bc6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = ChangeTimerQueueTimer(TimerQueue,Timer,DueTime,Period);
  return BVar1;
}



void CheckAllowDecryptedRemoteDestinationPolicy(void)

{
                    // WARNING: Could not recover jumptable at 0x6b832be0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x32be0  126  CheckAllowDecryptedRemoteDestinationPolicy
  CheckAllowDecryptedRemoteDestinationPolicy();
  return;
}



BOOL CheckRemoteDebuggerPresent(HANDLE hProcess,PBOOL pbDebuggerPresent)

{
  BOOL BVar1;
  
                    // 0x32bf0  134  CheckRemoteDebuggerPresent
                    // WARNING: Could not recover jumptable at 0x6b832bf6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = CheckRemoteDebuggerPresent(hProcess,pbDebuggerPresent);
  return BVar1;
}



void CheckTokenCapability(void)

{
                    // 0x32c10  135  CheckTokenCapability
                    // WARNING: Could not recover jumptable at 0x6b832c16. Too many branches
                    // WARNING: Treating indirect jump as call
  CheckTokenCapability();
  return;
}



void CheckTokenMembershipEx(void)

{
                    // 0x32c30  136  CheckTokenMembershipEx
                    // WARNING: Could not recover jumptable at 0x6b832c36. Too many branches
                    // WARNING: Treating indirect jump as call
  CheckTokenMembershipEx();
  return;
}



BOOL ContinueDebugEvent(DWORD dwProcessId,DWORD dwThreadId,DWORD dwContinueStatus)

{
  BOOL BVar1;
  
                    // 0x32c50  164  ContinueDebugEvent
                    // WARNING: Could not recover jumptable at 0x6b832c56. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = ContinueDebugEvent(dwProcessId,dwThreadId,dwContinueStatus);
  return BVar1;
}



LCID ConvertDefaultLocale(LCID Locale)

{
  LCID LVar1;
  
                    // 0x32c70  166  ConvertDefaultLocale
                    // WARNING: Could not recover jumptable at 0x6b832c76. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = ConvertDefaultLocale(Locale);
  return LVar1;
}



void CopyContext(void)

{
                    // 0x32c90  172  CopyContext
                    // WARNING: Could not recover jumptable at 0x6b832c96. Too many branches
                    // WARNING: Treating indirect jump as call
  CopyContext();
  return;
}



void CopyFile2(void)

{
                    // 0x32cb0  173  CopyFile2
                    // WARNING: Could not recover jumptable at 0x6b832cb6. Too many branches
                    // WARNING: Treating indirect jump as call
  CopyFile2();
  return;
}



BOOL CreateDirectoryExW(LPCWSTR lpTemplateDirectory,LPCWSTR lpNewDirectory,
                       LPSECURITY_ATTRIBUTES lpSecurityAttributes)

{
  BOOL BVar1;
  
                    // 0x32cd0  189  CreateDirectoryExW
                    // WARNING: Could not recover jumptable at 0x6b832cd6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = CreateDirectoryExW(lpTemplateDirectory,lpNewDirectory,lpSecurityAttributes);
  return BVar1;
}



HANDLE CreateFileMappingNumaW
                 (HANDLE hFile,LPSECURITY_ATTRIBUTES lpFileMappingAttributes,DWORD flProtect,
                 DWORD dwMaximumSizeHigh,DWORD dwMaximumSizeLow,LPCWSTR lpName,DWORD nndPreferred)

{
  HANDLE pvVar1;
  
                    // 0x32cf0  205  CreateFileMappingNumaW
                    // WARNING: Could not recover jumptable at 0x6b832cf6. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = CreateFileMappingNumaW
                     (hFile,lpFileMappingAttributes,flProtect,dwMaximumSizeHigh,dwMaximumSizeLow,
                      lpName,nndPreferred);
  return pvVar1;
}



BOOL CreateHardLinkA(LPCSTR lpFileName,LPCSTR lpExistingFileName,
                    LPSECURITY_ATTRIBUTES lpSecurityAttributes)

{
  BOOL BVar1;
  
                    // 0x32d10  210  CreateHardLinkA
                    // WARNING: Could not recover jumptable at 0x6b832d16. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = CreateHardLinkA(lpFileName,lpExistingFileName,lpSecurityAttributes);
  return BVar1;
}



BOOL CreateHardLinkW(LPCWSTR lpFileName,LPCWSTR lpExistingFileName,
                    LPSECURITY_ATTRIBUTES lpSecurityAttributes)

{
  BOOL BVar1;
  
                    // 0x32d30  213  CreateHardLinkW
                    // WARNING: Could not recover jumptable at 0x6b832d36. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = CreateHardLinkW(lpFileName,lpExistingFileName,lpSecurityAttributes);
  return BVar1;
}



HANDLE CreateNamedPipeW(LPCWSTR lpName,DWORD dwOpenMode,DWORD dwPipeMode,DWORD nMaxInstances,
                       DWORD nOutBufferSize,DWORD nInBufferSize,DWORD nDefaultTimeOut,
                       LPSECURITY_ATTRIBUTES lpSecurityAttributes)

{
  HANDLE pvVar1;
  
                    // 0x32d50  226  CreateNamedPipeW
                    // WARNING: Could not recover jumptable at 0x6b832d56. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = CreateNamedPipeW(lpName,dwOpenMode,dwPipeMode,nMaxInstances,nOutBufferSize,nInBufferSize,
                            nDefaultTimeOut,lpSecurityAttributes);
  return pvVar1;
}



BOOL CreatePipe(PHANDLE hReadPipe,PHANDLE hWritePipe,LPSECURITY_ATTRIBUTES lpPipeAttributes,
               DWORD nSize)

{
  BOOL BVar1;
  
                    // 0x32d70  227  CreatePipe
                    // WARNING: Could not recover jumptable at 0x6b832d76. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = CreatePipe(hReadPipe,hWritePipe,lpPipeAttributes,nSize);
  return BVar1;
}



BOOL CreateProcessA(LPCSTR lpApplicationName,LPSTR lpCommandLine,
                   LPSECURITY_ATTRIBUTES lpProcessAttributes,
                   LPSECURITY_ATTRIBUTES lpThreadAttributes,BOOL bInheritHandles,
                   DWORD dwCreationFlags,LPVOID lpEnvironment,LPCSTR lpCurrentDirectory,
                   LPSTARTUPINFOA lpStartupInfo,LPPROCESS_INFORMATION lpProcessInformation)

{
  BOOL BVar1;
  
                    // 0x32d90  230  CreateProcessA
                    // WARNING: Could not recover jumptable at 0x6b832d96. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = CreateProcessA(lpApplicationName,lpCommandLine,lpProcessAttributes,lpThreadAttributes,
                         bInheritHandles,dwCreationFlags,lpEnvironment,lpCurrentDirectory,
                         lpStartupInfo,lpProcessInformation);
  return BVar1;
}



BOOL CreateProcessAsUserA
               (HANDLE hToken,LPCSTR lpApplicationName,LPSTR lpCommandLine,
               LPSECURITY_ATTRIBUTES lpProcessAttributes,LPSECURITY_ATTRIBUTES lpThreadAttributes,
               BOOL bInheritHandles,DWORD dwCreationFlags,LPVOID lpEnvironment,
               LPCSTR lpCurrentDirectory,LPSTARTUPINFOA lpStartupInfo,
               LPPROCESS_INFORMATION lpProcessInformation)

{
  BOOL BVar1;
  
                    // 0x32db0  231  CreateProcessAsUserA
                    // WARNING: Could not recover jumptable at 0x6b832db6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = CreateProcessAsUserA
                    (hToken,lpApplicationName,lpCommandLine,lpProcessAttributes,lpThreadAttributes,
                     bInheritHandles,dwCreationFlags,lpEnvironment,lpCurrentDirectory,lpStartupInfo,
                     lpProcessInformation);
  return BVar1;
}



BOOL CreateProcessAsUserW
               (HANDLE hToken,LPCWSTR lpApplicationName,LPWSTR lpCommandLine,
               LPSECURITY_ATTRIBUTES lpProcessAttributes,LPSECURITY_ATTRIBUTES lpThreadAttributes,
               BOOL bInheritHandles,DWORD dwCreationFlags,LPVOID lpEnvironment,
               LPCWSTR lpCurrentDirectory,LPSTARTUPINFOW lpStartupInfo,
               LPPROCESS_INFORMATION lpProcessInformation)

{
  BOOL BVar1;
  
                    // 0x32dd0  232  CreateProcessAsUserW
                    // WARNING: Could not recover jumptable at 0x6b832dd6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = CreateProcessAsUserW
                    (hToken,lpApplicationName,lpCommandLine,lpProcessAttributes,lpThreadAttributes,
                     bInheritHandles,dwCreationFlags,lpEnvironment,lpCurrentDirectory,lpStartupInfo,
                     lpProcessInformation);
  return BVar1;
}



void CreateProcessInternalA(void)

{
                    // 0x32df0  233  CreateProcessInternalA
                    // WARNING: Could not recover jumptable at 0x6b832df6. Too many branches
                    // WARNING: Treating indirect jump as call
  CreateProcessInternalA();
  return;
}



void CreateProcessInternalW(void)

{
                    // 0x32e10  234  CreateProcessInternalW
                    // WARNING: Could not recover jumptable at 0x6b832e16. Too many branches
                    // WARNING: Treating indirect jump as call
  CreateProcessInternalW();
  return;
}



HANDLE CreateRemoteThread(HANDLE hProcess,LPSECURITY_ATTRIBUTES lpThreadAttributes,
                         SIZE_T dwStackSize,LPTHREAD_START_ROUTINE lpStartAddress,LPVOID lpParameter
                         ,DWORD dwCreationFlags,LPDWORD lpThreadId)

{
  HANDLE pvVar1;
  
                    // 0x32e30  237  CreateRemoteThread
  pvVar1 = CreateRemoteThreadEx
                     (hProcess,lpThreadAttributes,dwStackSize,lpStartAddress,lpParameter,
                      dwCreationFlags & 0x10004,(LPPROC_THREAD_ATTRIBUTE_LIST)0x0,lpThreadId);
  return pvVar1;
}



BOOLEAN CreateSymbolicLinkW(LPCWSTR lpSymlinkFileName,LPCWSTR lpTargetFileName,DWORD dwFlags)

{
  BOOLEAN BVar1;
  
                    // 0x32e70  247  CreateSymbolicLinkW
                    // WARNING: Could not recover jumptable at 0x6b832e76. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = CreateSymbolicLinkW(lpSymlinkFileName,lpTargetFileName,dwFlags);
  return BVar1;
}



PTP_CLEANUP_GROUP CreateThreadpoolCleanupGroup(void)

{
  int iVar1;
  PTP_CLEANUP_GROUP local_8;
  
                    // 0x32e90  251  CreateThreadpoolCleanupGroup
  iVar1 = TpAllocCleanupGroup(&local_8);
  if (iVar1 < 0) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
    return (PTP_CLEANUP_GROUP)0x0;
  }
  return local_8;
}



PTP_IO CreateThreadpoolIo(HANDLE fl,PTP_WIN32_IO_CALLBACK pfnio,PVOID pv,PTP_CALLBACK_ENVIRON pcbe)

{
  PTP_IO p_Var1;
  
                    // 0x32ec0  252  CreateThreadpoolIo
  p_Var1 = (PTP_IO)FUN_6b85077a(fl,(int)pfnio,(int)pv,(int *)pcbe);
  return p_Var1;
}



PTP_POOL CreateThreadpool(PVOID reserved)

{
  int iVar1;
  PTP_POOL local_8;
  
                    // 0x32ee0  250  CreateThreadpool
  iVar1 = TpAllocPool(&local_8,reserved);
  if (iVar1 < 0) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
    local_8 = (PTP_POOL)0x0;
  }
  return local_8;
}



HANDLE CreateTimerQueue(void)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b832f10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x32f10  256  CreateTimerQueue
  pvVar1 = CreateTimerQueue();
  return pvVar1;
}



BOOL CreateTimerQueueTimer
               (PHANDLE phNewTimer,HANDLE TimerQueue,WAITORTIMERCALLBACK Callback,PVOID Parameter,
               DWORD DueTime,DWORD Period,ULONG Flags)

{
  BOOL BVar1;
  
                    // 0x32f20  257  CreateTimerQueueTimer
                    // WARNING: Could not recover jumptable at 0x6b832f26. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = CreateTimerQueueTimer(phNewTimer,TimerQueue,Callback,Parameter,DueTime,Period,Flags);
  return BVar1;
}



BOOL DebugActiveProcessStop(DWORD dwProcessId)

{
  BOOL BVar1;
  
                    // 0x32f40  267  DebugActiveProcessStop
                    // WARNING: Could not recover jumptable at 0x6b832f46. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = DebugActiveProcessStop(dwProcessId);
  return BVar1;
}



BOOL DebugActiveProcess(DWORD dwProcessId)

{
  BOOL BVar1;
  
                    // 0x32f60  266  DebugActiveProcess
                    // WARNING: Could not recover jumptable at 0x6b832f66. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = DebugActiveProcess(dwProcessId);
  return BVar1;
}



void DebugBreak(void)

{
                    // WARNING: Could not recover jumptable at 0x6b832f80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x32f80  268  DebugBreak
  DebugBreak();
  return;
}



void DelayLoadFailureHook(void)

{
                    // 0x32f90  275  DelayLoadFailureHook
                    // WARNING: Could not recover jumptable at 0x6b832f96. Too many branches
                    // WARNING: Treating indirect jump as call
  DelayLoadFailureHook();
  return;
}



void DeleteSynchronizationBarrier(void)

{
                    // 0x32fb0  285  DeleteSynchronizationBarrier
                    // WARNING: Could not recover jumptable at 0x6b832fb6. Too many branches
                    // WARNING: Treating indirect jump as call
  DeleteSynchronizationBarrier();
  return;
}



BOOL DeleteTimerQueueEx(HANDLE TimerQueue,HANDLE CompletionEvent)

{
  BOOL BVar1;
  
                    // 0x32fd0  287  DeleteTimerQueueEx
                    // WARNING: Could not recover jumptable at 0x6b832fd6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = DeleteTimerQueueEx(TimerQueue,CompletionEvent);
  return BVar1;
}



BOOL DeleteTimerQueueTimer(HANDLE TimerQueue,HANDLE Timer,HANDLE CompletionEvent)

{
  BOOL BVar1;
  
                    // 0x32ff0  288  DeleteTimerQueueTimer
                    // WARNING: Could not recover jumptable at 0x6b832ff6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = DeleteTimerQueueTimer(TimerQueue,Timer,CompletionEvent);
  return BVar1;
}



BOOL DisconnectNamedPipe(HANDLE hNamedPipe)

{
  BOOL BVar1;
  
                    // 0x33010  296  DisconnectNamedPipe
                    // WARNING: Could not recover jumptable at 0x6b833016. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = DisconnectNamedPipe(hNamedPipe);
  return BVar1;
}



void DnsHostnameToComputerNameExW(void)

{
                    // 0x33030  298  DnsHostnameToComputerNameExW
                    // WARNING: Could not recover jumptable at 0x6b833036. Too many branches
                    // WARNING: Treating indirect jump as call
  DnsHostnameToComputerNameExW();
  return;
}



void EnterSynchronizationBarrier(void)

{
                    // 0x33050  312  EnterSynchronizationBarrier
                    // WARNING: Could not recover jumptable at 0x6b833056. Too many branches
                    // WARNING: Treating indirect jump as call
  EnterSynchronizationBarrier();
  return;
}



BOOL EnumCalendarInfoExEx
               (CALINFO_ENUMPROCEXEX pCalInfoEnumProcExEx,LPCWSTR lpLocaleName,CALID Calendar,
               LPCWSTR lpReserved,CALTYPE CalType,LPARAM lParam)

{
  BOOL BVar1;
  
                    // 0x33070  315  EnumCalendarInfoExEx
                    // WARNING: Could not recover jumptable at 0x6b833076. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumCalendarInfoExEx(pCalInfoEnumProcExEx,lpLocaleName,Calendar,lpReserved,CalType,lParam)
  ;
  return BVar1;
}



BOOL EnumCalendarInfoW(CALINFO_ENUMPROCW lpCalInfoEnumProc,LCID Locale,CALID Calendar,
                      CALTYPE CalType)

{
  BOOL BVar1;
  
                    // 0x33090  317  EnumCalendarInfoW
                    // WARNING: Could not recover jumptable at 0x6b833096. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumCalendarInfoW(lpCalInfoEnumProc,Locale,Calendar,CalType);
  return BVar1;
}



BOOL EnumDateFormatsExEx(DATEFMT_ENUMPROCEXEX lpDateFmtEnumProcExEx,LPCWSTR lpLocaleName,
                        DWORD dwFlags,LPARAM lParam)

{
  BOOL BVar1;
  
                    // 0x330b0  320  EnumDateFormatsExEx
                    // WARNING: Could not recover jumptable at 0x6b8330b6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumDateFormatsExEx(lpDateFmtEnumProcExEx,lpLocaleName,dwFlags,lParam);
  return BVar1;
}



BOOL EnumDateFormatsExW(DATEFMT_ENUMPROCEXW lpDateFmtEnumProcEx,LCID Locale,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // 0x330d0  321  EnumDateFormatsExW
                    // WARNING: Could not recover jumptable at 0x6b8330d6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumDateFormatsExW(lpDateFmtEnumProcEx,Locale,dwFlags);
  return BVar1;
}



BOOL EnumLanguageGroupLocalesW
               (LANGGROUPLOCALE_ENUMPROCW lpLangGroupLocaleEnumProc,LGRPID LanguageGroup,
               DWORD dwFlags,LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // 0x330f0  324  EnumLanguageGroupLocalesW
                    // WARNING: Could not recover jumptable at 0x6b8330f6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumLanguageGroupLocalesW(lpLangGroupLocaleEnumProc,LanguageGroup,dwFlags,lParam);
  return BVar1;
}



BOOL EnumResourceLanguagesExA
               (HMODULE hModule,LPCSTR lpType,LPCSTR lpName,ENUMRESLANGPROCA lpEnumFunc,
               LONG_PTR lParam,DWORD dwFlags,LANGID LangId)

{
  BOOL BVar1;
  
                    // 0x33110  326  EnumResourceLanguagesExA
                    // WARNING: Could not recover jumptable at 0x6b833116. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumResourceLanguagesExA(hModule,lpType,lpName,lpEnumFunc,lParam,dwFlags,LangId);
  return BVar1;
}



BOOL EnumResourceLanguagesExW
               (HMODULE hModule,LPCWSTR lpType,LPCWSTR lpName,ENUMRESLANGPROCW lpEnumFunc,
               LONG_PTR lParam,DWORD dwFlags,LANGID LangId)

{
  BOOL BVar1;
  
                    // 0x33130  327  EnumResourceLanguagesExW
                    // WARNING: Could not recover jumptable at 0x6b833136. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumResourceLanguagesExW(hModule,lpType,lpName,lpEnumFunc,lParam,dwFlags,LangId);
  return BVar1;
}



BOOL EnumResourceNamesExA
               (HMODULE hModule,LPCSTR lpType,ENUMRESNAMEPROCA lpEnumFunc,LONG_PTR lParam,
               DWORD dwFlags,LANGID LangId)

{
  BOOL BVar1;
  
                    // 0x33150  330  EnumResourceNamesExA
                    // WARNING: Could not recover jumptable at 0x6b833156. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumResourceNamesExA(hModule,lpType,lpEnumFunc,lParam,dwFlags,LangId);
  return BVar1;
}



BOOL EnumResourceNamesExW
               (HMODULE hModule,LPCWSTR lpType,ENUMRESNAMEPROCW lpEnumFunc,LONG_PTR lParam,
               DWORD dwFlags,LANGID LangId)

{
  BOOL BVar1;
  
                    // 0x33170  331  EnumResourceNamesExW
                    // WARNING: Could not recover jumptable at 0x6b833176. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumResourceNamesExW(hModule,lpType,lpEnumFunc,lParam,dwFlags,LangId);
  return BVar1;
}



BOOL EnumResourceTypesExA
               (HMODULE hModule,ENUMRESTYPEPROCA lpEnumFunc,LONG_PTR lParam,DWORD dwFlags,
               LANGID LangId)

{
  BOOL BVar1;
  
                    // 0x33190  334  EnumResourceTypesExA
                    // WARNING: Could not recover jumptable at 0x6b833196. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumResourceTypesExA(hModule,lpEnumFunc,lParam,dwFlags,LangId);
  return BVar1;
}



BOOL EnumResourceTypesExW
               (HMODULE hModule,ENUMRESTYPEPROCW lpEnumFunc,LONG_PTR lParam,DWORD dwFlags,
               LANGID LangId)

{
  BOOL BVar1;
  
                    // 0x331b0  335  EnumResourceTypesExW
                    // WARNING: Could not recover jumptable at 0x6b8331b6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumResourceTypesExW(hModule,lpEnumFunc,lParam,dwFlags,LangId);
  return BVar1;
}



BOOL EnumSystemCodePagesW(CODEPAGE_ENUMPROCW lpCodePageEnumProc,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // 0x331d0  338  EnumSystemCodePagesW
                    // WARNING: Could not recover jumptable at 0x6b8331d6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumSystemCodePagesW(lpCodePageEnumProc,dwFlags);
  return BVar1;
}



BOOL EnumSystemLanguageGroupsW
               (LANGUAGEGROUP_ENUMPROCW lpLanguageGroupEnumProc,DWORD dwFlags,LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // 0x331f0  343  EnumSystemLanguageGroupsW
                    // WARNING: Could not recover jumptable at 0x6b8331f6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumSystemLanguageGroupsW(lpLanguageGroupEnumProc,dwFlags,lParam);
  return BVar1;
}



BOOL EnumSystemLocalesA(LOCALE_ENUMPROCA lpLocaleEnumProc,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // 0x33210  344  EnumSystemLocalesA
                    // WARNING: Could not recover jumptable at 0x6b833216. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumSystemLocalesA(lpLocaleEnumProc,dwFlags);
  return BVar1;
}



BOOL EnumTimeFormatsEx(TIMEFMT_ENUMPROCEX lpTimeFmtEnumProcEx,LPCWSTR lpLocaleName,DWORD dwFlags,
                      LPARAM lParam)

{
  BOOL BVar1;
  
                    // 0x33230  348  EnumTimeFormatsEx
                    // WARNING: Could not recover jumptable at 0x6b833236. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumTimeFormatsEx(lpTimeFmtEnumProcEx,lpLocaleName,dwFlags,lParam);
  return BVar1;
}



void FatalAppExitA(UINT uAction,LPCSTR lpMessageText)

{
                    // WARNING: Could not recover jumptable at 0x6b833250. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x33250  363  FatalAppExitA
  FatalAppExitA(uAction,lpMessageText);
  return;
}



void FatalAppExitW(UINT uAction,LPCWSTR lpMessageText)

{
                    // WARNING: Could not recover jumptable at 0x6b833260. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x33260  364  FatalAppExitW
  FatalAppExitW(uAction,lpMessageText);
  return;
}



int FindNLSString(LCID Locale,DWORD dwFindNLSStringFlags,LPCWSTR lpStringSource,int cchSource,
                 LPCWSTR lpStringValue,int cchValue,LPINT pcchFound)

{
  int iVar1;
  
                    // 0x33270  397  FindNLSString
                    // WARNING: Could not recover jumptable at 0x6b833276. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = FindNLSString(Locale,dwFindNLSStringFlags,lpStringSource,cchSource,lpStringValue,cchValue,
                        pcchFound);
  return iVar1;
}



int FindStringOrdinal(DWORD dwFindStringOrdinalFlags,LPCWSTR lpStringSource,int cchSource,
                     LPCWSTR lpStringValue,int cchValue,BOOL bIgnoreCase)

{
  int iVar1;
  
                    // 0x33290  413  FindStringOrdinal
                    // WARNING: Could not recover jumptable at 0x6b833296. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = FindStringOrdinal(dwFindStringOrdinalFlags,lpStringSource,cchSource,lpStringValue,cchValue
                            ,bIgnoreCase);
  return iVar1;
}



BOOL FreeEnvironmentStringsA(LPCH param_1)

{
  BOOL BVar1;
  
                    // 0x332b0  431  FreeEnvironmentStringsA
                    // WARNING: Could not recover jumptable at 0x6b8332b6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = FreeEnvironmentStringsA(param_1);
  return BVar1;
}



BOOL FreeUserPhysicalPages(HANDLE hProcess,PULONG_PTR NumberOfPages,PULONG_PTR PageArray)

{
  BOOL BVar1;
  
                    // 0x332d0  438  FreeUserPhysicalPages
                    // WARNING: Could not recover jumptable at 0x6b8332d6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = FreeUserPhysicalPages(hProcess,NumberOfPages,PageArray);
  return BVar1;
}



void GetAppContainerAce(void)

{
                    // 0x332f0  443  GetAppContainerAce
                    // WARNING: Could not recover jumptable at 0x6b8332f6. Too many branches
                    // WARNING: Treating indirect jump as call
  GetAppContainerAce();
  return;
}



void GetAppContainerNamedObjectPath(void)

{
                    // 0x33310  444  GetAppContainerNamedObjectPath
                    // WARNING: Could not recover jumptable at 0x6b833316. Too many branches
                    // WARNING: Treating indirect jump as call
  GetAppContainerNamedObjectPath();
  return;
}



HRESULT GetApplicationRecoveryCallback
                  (HANDLE hProcess,APPLICATION_RECOVERY_CALLBACK *pRecoveryCallback,
                  PVOID *ppvParameter,PDWORD pdwPingInterval,PDWORD pdwFlags)

{
  HRESULT HVar1;
  
                    // 0x33330  445  GetApplicationRecoveryCallback
                    // WARNING: Could not recover jumptable at 0x6b833336. Too many branches
                    // WARNING: Treating indirect jump as call
  HVar1 = GetApplicationRecoveryCallback
                    (hProcess,pRecoveryCallback,ppvParameter,pdwPingInterval,pdwFlags);
  return HVar1;
}



HRESULT GetApplicationRestartSettings
                  (HANDLE hProcess,PWSTR pwzCommandline,PDWORD pcchSize,PDWORD pdwFlags)

{
  HRESULT HVar1;
  
                    // 0x33350  447  GetApplicationRestartSettings
                    // WARNING: Could not recover jumptable at 0x6b833356. Too many branches
                    // WARNING: Treating indirect jump as call
  HVar1 = GetApplicationRestartSettings(hProcess,pwzCommandline,pcchSize,pdwFlags);
  return HVar1;
}



BOOL GetCPInfoExW(UINT CodePage,DWORD dwFlags,LPCPINFOEXW lpCPInfoEx)

{
  BOOL BVar1;
  
                    // 0x33370  457  GetCPInfoExW
                    // WARNING: Could not recover jumptable at 0x6b833376. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetCPInfoExW(CodePage,dwFlags,lpCPInfoEx);
  return BVar1;
}



void GetCachedSigningLevel(void)

{
                    // 0x33390  458  GetCachedSigningLevel
                    // WARNING: Could not recover jumptable at 0x6b833396. Too many branches
                    // WARNING: Treating indirect jump as call
  GetCachedSigningLevel();
  return;
}



DWORD GetCompressedFileSizeA(LPCSTR lpFileName,LPDWORD lpFileSizeHigh)

{
  DWORD DVar1;
  
                    // 0x333b0  478  GetCompressedFileSizeA
                    // WARNING: Could not recover jumptable at 0x6b8333b6. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = GetCompressedFileSizeA(lpFileName,lpFileSizeHigh);
  return DVar1;
}



DWORD GetCompressedFileSizeW(LPCWSTR lpFileName,LPDWORD lpFileSizeHigh)

{
  DWORD DVar1;
  
                    // 0x333d0  481  GetCompressedFileSizeW
                    // WARNING: Could not recover jumptable at 0x6b8333d6. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = GetCompressedFileSizeW(lpFileName,lpFileSizeHigh);
  return DVar1;
}



BOOL GetComputerNameExA(COMPUTER_NAME_FORMAT NameType,LPSTR lpBuffer,LPDWORD nSize)

{
  BOOL BVar1;
  
                    // 0x333f0  483  GetComputerNameExA
                    // WARNING: Could not recover jumptable at 0x6b8333f6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetComputerNameExA(NameType,lpBuffer,nSize);
  return BVar1;
}



int GetCurrencyFormatEx(LPCWSTR lpLocaleName,DWORD dwFlags,LPCWSTR lpValue,CURRENCYFMTW *lpFormat,
                       LPWSTR lpCurrencyStr,int cchCurrency)

{
  int iVar1;
  
                    // 0x33410  527  GetCurrencyFormatEx
                    // WARNING: Could not recover jumptable at 0x6b833416. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = GetCurrencyFormatEx(lpLocaleName,dwFlags,lpValue,lpFormat,lpCurrencyStr,cchCurrency);
  return iVar1;
}



int GetCurrencyFormatW(LCID Locale,DWORD dwFlags,LPCWSTR lpValue,CURRENCYFMTW *lpFormat,
                      LPWSTR lpCurrencyStr,int cchCurrency)

{
  int iVar1;
  
                    // 0x33430  528  GetCurrencyFormatW
  iVar1 = FUN_6b844d67(Locale,dwFlags,lpValue,lpFormat,lpCurrencyStr,cchCurrency);
  return iVar1;
}



BOOL GetCurrentActCtx(HANDLE *lphActCtx)

{
  BOOL BVar1;
  
                    // 0x33460  529  GetCurrentActCtx
                    // WARNING: Could not recover jumptable at 0x6b833466. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetCurrentActCtx(lphActCtx);
  return BVar1;
}



DWORD GetCurrentDirectoryA(DWORD nBufferLength,LPSTR lpBuffer)

{
  DWORD DVar1;
  
                    // 0x33480  534  GetCurrentDirectoryA
                    // WARNING: Could not recover jumptable at 0x6b833486. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = GetCurrentDirectoryA(nBufferLength,lpBuffer);
  return DVar1;
}



int GetDateFormatA(LCID Locale,DWORD dwFlags,SYSTEMTIME *lpDate,LPCSTR lpFormat,LPSTR lpDateStr,
                  int cchDate)

{
  int iVar1;
  
                    // 0x334a0  548  GetDateFormatA
                    // WARNING: Could not recover jumptable at 0x6b8334a6. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = GetDateFormatA(Locale,dwFlags,lpDate,lpFormat,lpDateStr,cchDate);
  return iVar1;
}



int GetDateFormatEx(LPCWSTR lpLocaleName,DWORD dwFlags,SYSTEMTIME *lpDate,LPCWSTR lpFormat,
                   LPWSTR lpDateStr,int cchDate,LPCWSTR lpCalendar)

{
  int iVar1;
  
                    // 0x334c0  550  GetDateFormatEx
                    // WARNING: Could not recover jumptable at 0x6b8334c6. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = GetDateFormatEx(lpLocaleName,dwFlags,lpDate,lpFormat,lpDateStr,cchDate,lpCalendar);
  return iVar1;
}



int GetDurationFormatEx(LPCWSTR lpLocaleName,DWORD dwFlags,SYSTEMTIME *lpDuration,
                       ULONGLONG ullDuration,LPCWSTR lpFormat,LPWSTR lpDurationStr,int cchDuration)

{
  int iVar1;
  
                    // 0x334e0  567  GetDurationFormatEx
  iVar1 = GetDurationFormatEx(lpLocaleName,dwFlags,lpDuration,ullDuration,lpFormat,lpDurationStr,
                              cchDuration);
  return iVar1;
}



DWORD GetDynamicTimeZoneInformation(PDYNAMIC_TIME_ZONE_INFORMATION pTimeZoneInformation)

{
  DWORD DVar1;
  
                    // 0x33510  568  GetDynamicTimeZoneInformation
                    // WARNING: Could not recover jumptable at 0x6b833516. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = GetDynamicTimeZoneInformation(pTimeZoneInformation);
  return DVar1;
}



void GetEnabledXStateFeatures(void)

{
                    // WARNING: Could not recover jumptable at 0x6b833530. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x33530  569  GetEnabledXStateFeatures
  GetEnabledXStateFeatures();
  return;
}



LPCH GetEnvironmentStrings(void)

{
  LPCH pCVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b833540. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x33540  571  GetEnvironmentStrings
  pCVar1 = GetEnvironmentStrings();
  return pCVar1;
}



void GetEraNameCountedString(void)

{
                    // 0x33550  576  GetEraNameCountedString
                    // WARNING: Could not recover jumptable at 0x6b833556. Too many branches
                    // WARNING: Treating indirect jump as call
  GetEraNameCountedString();
  return;
}



UINT GetErrorMode(void)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b833570. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x33570  577  GetErrorMode
  UVar1 = GetErrorMode();
  return UVar1;
}



BOOL GetFileMUIInfo(DWORD dwFlags,PCWSTR pcwszFilePath,PFILEMUIINFO pFileMUIInfo,
                   DWORD *pcbFileMUIInfo)

{
  BOOL BVar1;
  
                    // 0x33580  591  GetFileMUIInfo
                    // WARNING: Could not recover jumptable at 0x6b833586. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetFileMUIInfo(dwFlags,pcwszFilePath,pFileMUIInfo,pcbFileMUIInfo);
  return BVar1;
}



BOOL GetFileMUIPath(DWORD dwFlags,PCWSTR pcwszFilePath,PWSTR pwszLanguage,PULONG pcchLanguage,
                   PWSTR pwszFileMUIPath,PULONG pcchFileMUIPath,PULONGLONG pululEnumerator)

{
  BOOL BVar1;
  
                    // 0x335a0  592  GetFileMUIPath
                    // WARNING: Could not recover jumptable at 0x6b8335a6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetFileMUIPath(dwFlags,pcwszFilePath,pwszLanguage,pcchLanguage,pwszFileMUIPath,
                         pcchFileMUIPath,pululEnumerator);
  return BVar1;
}



SIZE_T GetLargePageMinimum(void)

{
  SIZE_T SVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8335c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x335c0  613  GetLargePageMinimum
  SVar1 = GetLargePageMinimum();
  return SVar1;
}



void GetMemoryErrorHandlingCapabilities(void)

{
                    // 0x335d0  632  GetMemoryErrorHandlingCapabilities
                    // WARNING: Could not recover jumptable at 0x6b8335d6. Too many branches
                    // WARNING: Treating indirect jump as call
  GetMemoryErrorHandlingCapabilities();
  return;
}



BOOL GetNLSVersionEx(NLS_FUNCTION function,LPCWSTR lpLocaleName,
                    LPNLSVERSIONINFOEX lpVersionInformation)

{
  BOOL BVar1;
  
                    // 0x335f0  640  GetNLSVersionEx
                    // WARNING: Could not recover jumptable at 0x6b8335f6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetNLSVersionEx(function,lpLocaleName,lpVersionInformation);
  return BVar1;
}



BOOL GetNamedPipeAttribute
               (HANDLE Pipe,PIPE_ATTRIBUTE_TYPE AttributeType,PSTR AttributeName,
               PVOID AttributeValue,PSIZE_T AttributeValueLength)

{
  BOOL BVar1;
  
                    // 0x33610  641  GetNamedPipeAttribute
                    // WARNING: Could not recover jumptable at 0x6b833616. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetNamedPipeAttribute
                    (Pipe,AttributeType,AttributeName,AttributeValue,AttributeValueLength);
  return BVar1;
}



BOOL GetNamedPipeClientComputerNameW
               (HANDLE Pipe,LPWSTR ClientComputerName,ULONG ClientComputerNameLength)

{
  BOOL BVar1;
  
                    // 0x33630  643  GetNamedPipeClientComputerNameW
                    // WARNING: Could not recover jumptable at 0x6b833636. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetNamedPipeClientComputerNameW(Pipe,ClientComputerName,ClientComputerNameLength);
  return BVar1;
}



BOOL GetNamedPipeHandleStateW
               (HANDLE hNamedPipe,LPDWORD lpState,LPDWORD lpCurInstances,
               LPDWORD lpMaxCollectionCount,LPDWORD lpCollectDataTimeout,LPWSTR lpUserName,
               DWORD nMaxUserNameSize)

{
  BOOL BVar1;
  
                    // 0x33650  647  GetNamedPipeHandleStateW
                    // WARNING: Could not recover jumptable at 0x6b833656. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetNamedPipeHandleStateW
                    (hNamedPipe,lpState,lpCurInstances,lpMaxCollectionCount,lpCollectDataTimeout,
                     lpUserName,nMaxUserNameSize);
  return BVar1;
}



BOOL GetNumaNodeProcessorMaskEx(USHORT Node,PGROUP_AFFINITY ProcessorMask)

{
  BOOL BVar1;
  
                    // 0x33670  658  GetNumaNodeProcessorMaskEx
                    // WARNING: Could not recover jumptable at 0x6b833676. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetNumaNodeProcessorMaskEx(Node,ProcessorMask);
  return BVar1;
}



BOOL GetNumaProximityNodeEx(ULONG ProximityId,PUSHORT NodeNumber)

{
  BOOL BVar1;
  
                    // 0x33690  662  GetNumaProximityNodeEx
                    // WARNING: Could not recover jumptable at 0x6b833696. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetNumaProximityNodeEx(ProximityId,NodeNumber);
  return BVar1;
}



int GetNumberFormatEx(LPCWSTR lpLocaleName,DWORD dwFlags,LPCWSTR lpValue,NUMBERFMTW *lpFormat,
                     LPWSTR lpNumberStr,int cchNumber)

{
  int iVar1;
  
                    // 0x336b0  664  GetNumberFormatEx
                    // WARNING: Could not recover jumptable at 0x6b8336b6. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = GetNumberFormatEx(lpLocaleName,dwFlags,lpValue,lpFormat,lpNumberStr,cchNumber);
  return iVar1;
}



BOOL GetPhysicallyInstalledSystemMemory(PULONGLONG TotalMemoryInKilobytes)

{
  BOOL BVar1;
  
                    // 0x336d0  680  GetPhysicallyInstalledSystemMemory
                    // WARNING: Could not recover jumptable at 0x6b8336d6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetPhysicallyInstalledSystemMemory(TotalMemoryInKilobytes);
  return BVar1;
}



DWORD GetPriorityClass(HANDLE hProcess)

{
  DWORD DVar1;
  
                    // 0x336f0  681  GetPriorityClass
                    // WARNING: Could not recover jumptable at 0x6b8336f6. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = GetPriorityClass(hProcess);
  return DVar1;
}



BOOL GetProcessGroupAffinity(HANDLE hProcess,PUSHORT GroupCount,PUSHORT GroupArray)

{
  BOOL BVar1;
  
                    // 0x33710  696  GetProcessGroupAffinity
                    // WARNING: Could not recover jumptable at 0x6b833716. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetProcessGroupAffinity(hProcess,GroupCount,GroupArray);
  return BVar1;
}



BOOL GetProcessHandleCount(HANDLE hProcess,PDWORD pdwHandleCount)

{
  BOOL BVar1;
  
                    // 0x33730  697  GetProcessHandleCount
                    // WARNING: Could not recover jumptable at 0x6b833736. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetProcessHandleCount(hProcess,pdwHandleCount);
  return BVar1;
}



DWORD GetProcessHeaps(DWORD NumberOfHeaps,PHANDLE ProcessHeaps)

{
  DWORD DVar1;
  
                    // 0x33750  699  GetProcessHeaps
                    // WARNING: Could not recover jumptable at 0x6b833756. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = GetProcessHeaps(NumberOfHeaps,ProcessHeaps);
  return DVar1;
}



BOOL GetProcessPreferredUILanguages
               (DWORD dwFlags,PULONG pulNumLanguages,PZZWSTR pwszLanguagesBuffer,
               PULONG pcchLanguagesBuffer)

{
  BOOL BVar1;
  
                    // 0x33770  705  GetProcessPreferredUILanguages
                    // WARNING: Could not recover jumptable at 0x6b833776. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetProcessPreferredUILanguages
                    (dwFlags,pulNumLanguages,pwszLanguagesBuffer,pcchLanguagesBuffer);
  return BVar1;
}



BOOL GetProcessPriorityBoost(HANDLE hProcess,PBOOL pDisablePriorityBoost)

{
  BOOL BVar1;
  
                    // 0x33790  706  GetProcessPriorityBoost
                    // WARNING: Could not recover jumptable at 0x6b833796. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetProcessPriorityBoost(hProcess,pDisablePriorityBoost);
  return BVar1;
}



BOOL GetProcessShutdownParameters(LPDWORD lpdwLevel,LPDWORD lpdwFlags)

{
  BOOL BVar1;
  
                    // 0x337b0  707  GetProcessShutdownParameters
                    // WARNING: Could not recover jumptable at 0x6b8337b6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetProcessShutdownParameters(lpdwLevel,lpdwFlags);
  return BVar1;
}



BOOL GetProcessWorkingSetSizeEx
               (HANDLE hProcess,PSIZE_T lpMinimumWorkingSetSize,PSIZE_T lpMaximumWorkingSetSize,
               PDWORD Flags)

{
  BOOL BVar1;
  
                    // 0x337d0  711  GetProcessWorkingSetSizeEx
                    // WARNING: Could not recover jumptable at 0x6b8337d6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetProcessWorkingSetSizeEx(hProcess,lpMinimumWorkingSetSize,lpMaximumWorkingSetSize,Flags)
  ;
  return BVar1;
}



BOOL GetQueuedCompletionStatusEx
               (HANDLE CompletionPort,LPOVERLAPPED_ENTRY lpCompletionPortEntries,ULONG ulCount,
               PULONG ulNumEntriesRemoved,DWORD dwMilliseconds,BOOL fAlertable)

{
  BOOL BVar1;
  
                    // 0x337f0  721  GetQueuedCompletionStatusEx
                    // WARNING: Could not recover jumptable at 0x6b8337f6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetQueuedCompletionStatusEx
                    (CompletionPort,lpCompletionPortEntries,ulCount,ulNumEntriesRemoved,
                     dwMilliseconds,fAlertable);
  return BVar1;
}



int GetStringScripts(DWORD dwFlags,LPCWSTR lpString,int cchString,LPWSTR lpScripts,int cchScripts)

{
  int iVar1;
  
                    // 0x33810  729  GetStringScripts
                    // WARNING: Could not recover jumptable at 0x6b833816. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = GetStringScripts(dwFlags,lpString,cchString,lpScripts,cchScripts);
  return iVar1;
}



int GetSystemDefaultLocaleName(LPWSTR lpLocaleName,int cchLocaleName)

{
  int iVar1;
  
                    // 0x33830  739  GetSystemDefaultLocaleName
                    // WARNING: Could not recover jumptable at 0x6b833836. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = GetSystemDefaultLocaleName(lpLocaleName,cchLocaleName);
  return iVar1;
}



BOOL GetSystemFileCacheSize
               (PSIZE_T lpMinimumFileCacheSize,PSIZE_T lpMaximumFileCacheSize,PDWORD lpFlags)

{
  BOOL BVar1;
  
                    // 0x33850  743  GetSystemFileCacheSize
                    // WARNING: Could not recover jumptable at 0x6b833856. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetSystemFileCacheSize(lpMinimumFileCacheSize,lpMaximumFileCacheSize,lpFlags);
  return BVar1;
}



BOOL GetSystemPreferredUILanguages
               (DWORD dwFlags,PULONG pulNumLanguages,PZZWSTR pwszLanguagesBuffer,
               PULONG pcchLanguagesBuffer)

{
  BOOL BVar1;
  
                    // 0x33870  747  GetSystemPreferredUILanguages
                    // WARNING: Could not recover jumptable at 0x6b833876. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetSystemPreferredUILanguages
                    (dwFlags,pulNumLanguages,pwszLanguagesBuffer,pcchLanguagesBuffer);
  return BVar1;
}



BOOL GetSystemTimes(LPFILETIME lpIdleTime,LPFILETIME lpKernelTime,LPFILETIME lpUserTime)

{
  BOOL BVar1;
  
                    // 0x33890  753  GetSystemTimes
                    // WARNING: Could not recover jumptable at 0x6b833896. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetSystemTimes(lpIdleTime,lpKernelTime,lpUserTime);
  return BVar1;
}



UINT GetSystemWindowsDirectoryA(LPSTR lpBuffer,UINT uSize)

{
  uint uVar1;
  
                    // 0x338b0  754  GetSystemWindowsDirectoryA
  uVar1 = FUN_6b851f2f(lpBuffer,(ushort)uSize);
  return uVar1;
}



BOOL GetThreadContext(HANDLE hThread,LPCONTEXT lpContext)

{
  BOOL BVar1;
  
                    // 0x338d0  765  GetThreadContext
                    // WARNING: Could not recover jumptable at 0x6b8338d6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetThreadContext(hThread,lpContext);
  return BVar1;
}



DWORD GetThreadErrorMode(void)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8338f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x338f0  767  GetThreadErrorMode
  DVar1 = GetThreadErrorMode();
  return DVar1;
}



BOOL GetThreadGroupAffinity(HANDLE hThread,PGROUP_AFFINITY GroupAffinity)

{
  BOOL BVar1;
  
                    // 0x33900  768  GetThreadGroupAffinity
                    // WARNING: Could not recover jumptable at 0x6b833906. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetThreadGroupAffinity(hThread,GroupAffinity);
  return BVar1;
}



BOOL GetThreadIOPendingFlag(HANDLE hThread,PBOOL lpIOIsPending)

{
  BOOL BVar1;
  
                    // 0x33920  769  GetThreadIOPendingFlag
                    // WARNING: Could not recover jumptable at 0x6b833926. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetThreadIOPendingFlag(hThread,lpIOIsPending);
  return BVar1;
}



DWORD GetThreadId(HANDLE Thread)

{
  DWORD DVar1;
  
                    // 0x33940  770  GetThreadId
                    // WARNING: Could not recover jumptable at 0x6b833946. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = GetThreadId(Thread);
  return DVar1;
}



BOOL GetThreadIdealProcessorEx(HANDLE hThread,PPROCESSOR_NUMBER lpIdealProcessor)

{
  BOOL BVar1;
  
                    // 0x33960  771  GetThreadIdealProcessorEx
                    // WARNING: Could not recover jumptable at 0x6b833966. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetThreadIdealProcessorEx(hThread,lpIdealProcessor);
  return BVar1;
}



BOOL GetThreadPriorityBoost(HANDLE hThread,PBOOL pDisablePriorityBoost)

{
  BOOL BVar1;
  
                    // 0x33980  776  GetThreadPriorityBoost
                    // WARNING: Could not recover jumptable at 0x6b833986. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetThreadPriorityBoost(hThread,pDisablePriorityBoost);
  return BVar1;
}



int GetTimeFormatA(LCID Locale,DWORD dwFlags,SYSTEMTIME *lpTime,LPCSTR lpFormat,LPSTR lpTimeStr,
                  int cchTime)

{
  int iVar1;
  
                    // 0x339a0  783  GetTimeFormatA
                    // WARNING: Could not recover jumptable at 0x6b8339a6. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = GetTimeFormatA(Locale,dwFlags,lpTime,lpFormat,lpTimeStr,cchTime);
  return iVar1;
}



int GetTimeFormatEx(LPCWSTR lpLocaleName,DWORD dwFlags,SYSTEMTIME *lpTime,LPCWSTR lpFormat,
                   LPWSTR lpTimeStr,int cchTime)

{
  int iVar1;
  
                    // 0x339c0  785  GetTimeFormatEx
                    // WARNING: Could not recover jumptable at 0x6b8339c6. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = GetTimeFormatEx(lpLocaleName,dwFlags,lpTime,lpFormat,lpTimeStr,cchTime);
  return iVar1;
}



BOOL GetTimeZoneInformationForYear
               (USHORT wYear,PDYNAMIC_TIME_ZONE_INFORMATION pdtzi,LPTIME_ZONE_INFORMATION ptzi)

{
  BOOL BVar1;
  
                    // 0x339e0  789  GetTimeZoneInformationForYear
                    // WARNING: Could not recover jumptable at 0x6b8339e6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetTimeZoneInformationForYear(wYear,pdtzi,ptzi);
  return BVar1;
}



BOOL GetUILanguageInfo(DWORD dwFlags,PCZZWSTR pwmszLanguage,PZZWSTR pwszFallbackLanguages,
                      PDWORD pcchFallbackLanguages,PDWORD pAttributes)

{
  BOOL BVar1;
  
                    // 0x33a00  790  GetUILanguageInfo
                    // WARNING: Could not recover jumptable at 0x6b833a06. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = GetUILanguageInfo(dwFlags,pwmszLanguage,pwszFallbackLanguages,pcchFallbackLanguages,
                            pAttributes);
  return BVar1;
}



void GetXStateFeaturesMask(void)

{
                    // 0x33a20  814  GetXStateFeaturesMask
                    // WARNING: Could not recover jumptable at 0x6b833a26. Too many branches
                    // WARNING: Treating indirect jump as call
  GetXStateFeaturesMask();
  return;
}



SIZE_T HeapCompact(HANDLE hHeap,DWORD dwFlags)

{
  SIZE_T SVar1;
  
                    // 0x33a40  844  HeapCompact
                    // WARNING: Could not recover jumptable at 0x6b833a46. Too many branches
                    // WARNING: Treating indirect jump as call
  SVar1 = HeapCompact(hHeap,dwFlags);
  return SVar1;
}



BOOL HeapLock(HANDLE hHeap)

{
  BOOL BVar1;
  
                    // 0x33a60  848  HeapLock
                    // WARNING: Could not recover jumptable at 0x6b833a66. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = HeapLock(hHeap);
  return BVar1;
}



BOOL HeapQueryInformation
               (HANDLE HeapHandle,HEAP_INFORMATION_CLASS HeapInformationClass,PVOID HeapInformation,
               SIZE_T HeapInformationLength,PSIZE_T ReturnLength)

{
  BOOL BVar1;
  
                    // 0x33a80  849  HeapQueryInformation
                    // WARNING: Could not recover jumptable at 0x6b833a86. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = HeapQueryInformation
                    (HeapHandle,HeapInformationClass,HeapInformation,HeapInformationLength,
                     ReturnLength);
  return BVar1;
}



void HeapSummary(void)

{
                    // 0x33aa0  853  HeapSummary
                    // WARNING: Could not recover jumptable at 0x6b833aa6. Too many branches
                    // WARNING: Treating indirect jump as call
  HeapSummary();
  return;
}



BOOL HeapUnlock(HANDLE hHeap)

{
  BOOL BVar1;
  
                    // 0x33ac0  854  HeapUnlock
                    // WARNING: Could not recover jumptable at 0x6b833ac6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = HeapUnlock(hHeap);
  return BVar1;
}



BOOL HeapWalk(HANDLE hHeap,LPPROCESS_HEAP_ENTRY lpEntry)

{
  BOOL BVar1;
  
                    // 0x33ae0  856  HeapWalk
                    // WARNING: Could not recover jumptable at 0x6b833ae6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = HeapWalk(hHeap,lpEntry);
  return BVar1;
}



int IdnToAscii(DWORD dwFlags,LPCWSTR lpUnicodeCharStr,int cchUnicodeChar,LPWSTR lpASCIICharStr,
              int cchASCIIChar)

{
  int iVar1;
  
                    // 0x33b00  857  IdnToAscii
                    // WARNING: Could not recover jumptable at 0x6b833b06. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = IdnToAscii(dwFlags,lpUnicodeCharStr,cchUnicodeChar,lpASCIICharStr,cchASCIIChar);
  return iVar1;
}



int IdnToNameprepUnicode
              (DWORD dwFlags,LPCWSTR lpUnicodeCharStr,int cchUnicodeChar,LPWSTR lpNameprepCharStr,
              int cchNameprepChar)

{
  int iVar1;
  
                    // 0x33b20  858  IdnToNameprepUnicode
                    // WARNING: Could not recover jumptable at 0x6b833b26. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = IdnToNameprepUnicode
                    (dwFlags,lpUnicodeCharStr,cchUnicodeChar,lpNameprepCharStr,cchNameprepChar);
  return iVar1;
}



int IdnToUnicode(DWORD dwFlags,LPCWSTR lpASCIICharStr,int cchASCIIChar,LPWSTR lpUnicodeCharStr,
                int cchUnicodeChar)

{
  int iVar1;
  
                    // 0x33b40  859  IdnToUnicode
                    // WARNING: Could not recover jumptable at 0x6b833b46. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = IdnToUnicode(dwFlags,lpASCIICharStr,cchASCIIChar,lpUnicodeCharStr,cchUnicodeChar);
  return iVar1;
}



void InitializeContext2(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
                       undefined4 param_5,undefined4 param_6)

{
                    // 0x33b60  866  InitializeContext2
  InitializeContext2(param_1,param_2,param_3,param_4,param_5,param_6);
  return;
}



void InitializeContext(void)

{
                    // 0x33b90  867  InitializeContext
                    // WARNING: Could not recover jumptable at 0x6b833b96. Too many branches
                    // WARNING: Treating indirect jump as call
  InitializeContext();
  return;
}



void InitializeSynchronizationBarrier(void)

{
                    // 0x33bb0  875  InitializeSynchronizationBarrier
                    // WARNING: Could not recover jumptable at 0x6b833bb6. Too many branches
                    // WARNING: Treating indirect jump as call
  InitializeSynchronizationBarrier();
  return;
}



BOOL IsDBCSLeadByteEx(UINT CodePage,BYTE TestChar)

{
  BOOL BVar1;
  
                    // 0x33bd0  899  IsDBCSLeadByteEx
                    // WARNING: Could not recover jumptable at 0x6b833bd6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = IsDBCSLeadByteEx(CodePage,TestChar);
  return BVar1;
}



BOOL IsNLSDefinedString(NLS_FUNCTION Function,DWORD dwFlags,LPNLSVERSIONINFO lpVersionInformation,
                       LPCWSTR lpString,INT cchStr)

{
  BOOL BVar1;
  
                    // 0x33bf0  902  IsNLSDefinedString
                    // WARNING: Could not recover jumptable at 0x6b833bf6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = IsNLSDefinedString(Function,dwFlags,lpVersionInformation,lpString,cchStr);
  return BVar1;
}



BOOL IsNormalizedString(NORM_FORM NormForm,LPCWSTR lpString,int cwLength)

{
  BOOL BVar1;
  
                    // 0x33c10  904  IsNormalizedString
                    // WARNING: Could not recover jumptable at 0x6b833c16. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = IsNormalizedString(NormForm,lpString,cwLength);
  return BVar1;
}



BOOL IsThreadAFiber(void)

{
  int in_FS_OFFSET;
  
                    // 0x33c30  909  IsThreadAFiber
  return *(ushort *)(*(int *)(in_FS_OFFSET + 0x18) + 0xfca) >> 2 & 1;
}



BOOL IsValidLanguageGroup(LGRPID LanguageGroup,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // 0x33c50  914  IsValidLanguageGroup
                    // WARNING: Could not recover jumptable at 0x6b833c56. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = IsValidLanguageGroup(LanguageGroup,dwFlags);
  return BVar1;
}



BOOL IsValidLocaleName(LPCWSTR lpLocaleName)

{
  BOOL BVar1;
  
                    // 0x33c70  916  IsValidLocaleName
                    // WARNING: Could not recover jumptable at 0x6b833c76. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = IsValidLocaleName(lpLocaleName);
  return BVar1;
}



void IsValidNLSVersion(void)

{
                    // 0x33c90  917  IsValidNLSVersion
                    // WARNING: Could not recover jumptable at 0x6b833c96. Too many branches
                    // WARNING: Treating indirect jump as call
  IsValidNLSVersion();
  return;
}



void K32EmptyWorkingSet(void)

{
                    // 0x33cb0  921  K32EmptyWorkingSet
                    // WARNING: Could not recover jumptable at 0x6b833cb6. Too many branches
                    // WARNING: Treating indirect jump as call
  K32EmptyWorkingSet();
  return;
}



void K32EnumDeviceDrivers(void)

{
                    // 0x33cd0  922  K32EnumDeviceDrivers
                    // WARNING: Could not recover jumptable at 0x6b833cd6. Too many branches
                    // WARNING: Treating indirect jump as call
  K32EnumDeviceDrivers();
  return;
}



void K32EnumPageFilesA(void)

{
                    // 0x33cf0  923  K32EnumPageFilesA
                    // WARNING: Could not recover jumptable at 0x6b833cf6. Too many branches
                    // WARNING: Treating indirect jump as call
  K32EnumPageFilesA();
  return;
}



void K32EnumPageFilesW(void)

{
                    // 0x33d10  924  K32EnumPageFilesW
                    // WARNING: Could not recover jumptable at 0x6b833d16. Too many branches
                    // WARNING: Treating indirect jump as call
  K32EnumPageFilesW();
  return;
}



void K32EnumProcessModulesEx(void)

{
                    // 0x33d30  926  K32EnumProcessModulesEx
                    // WARNING: Could not recover jumptable at 0x6b833d36. Too many branches
                    // WARNING: Treating indirect jump as call
  K32EnumProcessModulesEx();
  return;
}



void K32EnumProcessModules(void)

{
                    // 0x33d50  925  K32EnumProcessModules
                    // WARNING: Could not recover jumptable at 0x6b833d56. Too many branches
                    // WARNING: Treating indirect jump as call
  K32EnumProcessModules();
  return;
}



void K32EnumProcesses(void)

{
                    // 0x33d70  927  K32EnumProcesses
                    // WARNING: Could not recover jumptable at 0x6b833d76. Too many branches
                    // WARNING: Treating indirect jump as call
  K32EnumProcesses();
  return;
}



void K32GetDeviceDriverBaseNameA(void)

{
                    // 0x33d90  928  K32GetDeviceDriverBaseNameA
                    // WARNING: Could not recover jumptable at 0x6b833d96. Too many branches
                    // WARNING: Treating indirect jump as call
  K32GetDeviceDriverBaseNameA();
  return;
}



void K32GetDeviceDriverBaseNameW(void)

{
                    // 0x33db0  929  K32GetDeviceDriverBaseNameW
                    // WARNING: Could not recover jumptable at 0x6b833db6. Too many branches
                    // WARNING: Treating indirect jump as call
  K32GetDeviceDriverBaseNameW();
  return;
}



void K32GetDeviceDriverFileNameA(void)

{
                    // 0x33dd0  930  K32GetDeviceDriverFileNameA
                    // WARNING: Could not recover jumptable at 0x6b833dd6. Too many branches
                    // WARNING: Treating indirect jump as call
  K32GetDeviceDriverFileNameA();
  return;
}



void K32GetDeviceDriverFileNameW(void)

{
                    // 0x33df0  931  K32GetDeviceDriverFileNameW
                    // WARNING: Could not recover jumptable at 0x6b833df6. Too many branches
                    // WARNING: Treating indirect jump as call
  K32GetDeviceDriverFileNameW();
  return;
}



void K32GetMappedFileNameA(void)

{
                    // 0x33e10  932  K32GetMappedFileNameA
                    // WARNING: Could not recover jumptable at 0x6b833e16. Too many branches
                    // WARNING: Treating indirect jump as call
  K32GetMappedFileNameA();
  return;
}



void K32GetMappedFileNameW(void)

{
                    // 0x33e30  933  K32GetMappedFileNameW
                    // WARNING: Could not recover jumptable at 0x6b833e36. Too many branches
                    // WARNING: Treating indirect jump as call
  K32GetMappedFileNameW();
  return;
}



void K32GetModuleBaseNameA(void)

{
                    // 0x33e50  934  K32GetModuleBaseNameA
                    // WARNING: Could not recover jumptable at 0x6b833e56. Too many branches
                    // WARNING: Treating indirect jump as call
  K32GetModuleBaseNameA();
  return;
}



void K32GetModuleBaseNameW(void)

{
                    // 0x33e70  935  K32GetModuleBaseNameW
                    // WARNING: Could not recover jumptable at 0x6b833e76. Too many branches
                    // WARNING: Treating indirect jump as call
  K32GetModuleBaseNameW();
  return;
}



void K32GetModuleFileNameExA(void)

{
                    // 0x33e90  936  K32GetModuleFileNameExA
                    // WARNING: Could not recover jumptable at 0x6b833e96. Too many branches
                    // WARNING: Treating indirect jump as call
  K32GetModuleFileNameExA();
  return;
}



void K32GetModuleFileNameExW(void)

{
                    // 0x33eb0  937  K32GetModuleFileNameExW
                    // WARNING: Could not recover jumptable at 0x6b833eb6. Too many branches
                    // WARNING: Treating indirect jump as call
  K32GetModuleFileNameExW();
  return;
}



void K32GetPerformanceInfo(void)

{
                    // 0x33ed0  939  K32GetPerformanceInfo
                    // WARNING: Could not recover jumptable at 0x6b833ed6. Too many branches
                    // WARNING: Treating indirect jump as call
  K32GetPerformanceInfo();
  return;
}



void K32GetProcessImageFileNameA(void)

{
                    // 0x33ef0  940  K32GetProcessImageFileNameA
                    // WARNING: Could not recover jumptable at 0x6b833ef6. Too many branches
                    // WARNING: Treating indirect jump as call
  K32GetProcessImageFileNameA();
  return;
}



void K32GetProcessImageFileNameW(void)

{
                    // 0x33f10  941  K32GetProcessImageFileNameW
                    // WARNING: Could not recover jumptable at 0x6b833f16. Too many branches
                    // WARNING: Treating indirect jump as call
  K32GetProcessImageFileNameW();
  return;
}



void K32GetProcessMemoryInfo(void)

{
                    // 0x33f30  942  K32GetProcessMemoryInfo
                    // WARNING: Could not recover jumptable at 0x6b833f36. Too many branches
                    // WARNING: Treating indirect jump as call
  K32GetProcessMemoryInfo();
  return;
}



void K32GetWsChangesEx(void)

{
                    // 0x33f50  944  K32GetWsChangesEx
                    // WARNING: Could not recover jumptable at 0x6b833f56. Too many branches
                    // WARNING: Treating indirect jump as call
  K32GetWsChangesEx();
  return;
}



void K32GetWsChanges(void)

{
                    // 0x33f70  943  K32GetWsChanges
                    // WARNING: Could not recover jumptable at 0x6b833f76. Too many branches
                    // WARNING: Treating indirect jump as call
  K32GetWsChanges();
  return;
}



void K32InitializeProcessForWsWatch(void)

{
                    // 0x33f90  945  K32InitializeProcessForWsWatch
                    // WARNING: Could not recover jumptable at 0x6b833f96. Too many branches
                    // WARNING: Treating indirect jump as call
  K32InitializeProcessForWsWatch();
  return;
}



void K32QueryWorkingSetEx(void)

{
                    // 0x33fb0  947  K32QueryWorkingSetEx
                    // WARNING: Could not recover jumptable at 0x6b833fb6. Too many branches
                    // WARNING: Treating indirect jump as call
  K32QueryWorkingSetEx();
  return;
}



void K32QueryWorkingSet(void)

{
                    // 0x33fd0  946  K32QueryWorkingSet
                    // WARNING: Could not recover jumptable at 0x6b833fd6. Too many branches
                    // WARNING: Treating indirect jump as call
  K32QueryWorkingSet();
  return;
}



void LoadStringBaseExW(void)

{
                    // 0x33ff0  974  LoadStringBaseExW
                    // WARNING: Could not recover jumptable at 0x6b833ff6. Too many branches
                    // WARNING: Treating indirect jump as call
  LoadStringBaseExW();
  return;
}



void LocateXStateFeature(void)

{
                    // 0x34010  990  LocateXStateFeature
                    // WARNING: Could not recover jumptable at 0x6b834016. Too many branches
                    // WARNING: Treating indirect jump as call
  LocateXStateFeature();
  return;
}



BOOL MapUserPhysicalPages(PVOID VirtualAddress,ULONG_PTR NumberOfPages,PULONG_PTR PageArray)

{
  BOOL BVar1;
  
                    // 0x34030  994  MapUserPhysicalPages
                    // WARNING: Could not recover jumptable at 0x6b834036. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = MapUserPhysicalPages(VirtualAddress,NumberOfPages,PageArray);
  return BVar1;
}



LPVOID MapViewOfFileExNuma(HANDLE hFileMappingObject,DWORD dwDesiredAccess,DWORD dwFileOffsetHigh,
                          DWORD dwFileOffsetLow,SIZE_T dwNumberOfBytesToMap,LPVOID lpBaseAddress,
                          DWORD nndPreferred)

{
  LPVOID pvVar1;
  
                    // 0x34050  998  MapViewOfFileExNuma
                    // WARNING: Could not recover jumptable at 0x6b834056. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = MapViewOfFileExNuma(hFileMappingObject,dwDesiredAccess,dwFileOffsetHigh,dwFileOffsetLow,
                               dwNumberOfBytesToMap,lpBaseAddress,nndPreferred);
  return pvVar1;
}



BOOL MoveFileWithProgressW
               (LPCWSTR lpExistingFileName,LPCWSTR lpNewFileName,
               LPPROGRESS_ROUTINE lpProgressRoutine,LPVOID lpData,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // 0x34070  1011  MoveFileWithProgressW
                    // WARNING: Could not recover jumptable at 0x6b834076. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = MoveFileWithProgressW(lpExistingFileName,lpNewFileName,lpProgressRoutine,lpData,dwFlags);
  return BVar1;
}



BOOL NeedCurrentDirectoryForExePathA(LPCSTR ExeName)

{
  BOOL BVar1;
  
                    // 0x34090  1014  NeedCurrentDirectoryForExePathA
                    // WARNING: Could not recover jumptable at 0x6b834096. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = NeedCurrentDirectoryForExePathA(ExeName);
  return BVar1;
}



BOOL NeedCurrentDirectoryForExePathW(LPCWSTR ExeName)

{
  BOOL BVar1;
  
                    // 0x340b0  1015  NeedCurrentDirectoryForExePathW
                    // WARNING: Could not recover jumptable at 0x6b8340b6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = NeedCurrentDirectoryForExePathW(ExeName);
  return BVar1;
}



int NormalizeString(NORM_FORM NormForm,LPCWSTR lpSrcString,int cwSrcLength,LPWSTR lpDstString,
                   int cwDstLength)

{
  int iVar1;
  
                    // 0x340d0  1020  NormalizeString
                    // WARNING: Could not recover jumptable at 0x6b8340d6. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = NormalizeString(NormForm,lpSrcString,cwSrcLength,lpDstString,cwDstLength);
  return iVar1;
}



void NotifyMountMgr(void)

{
                    // WARNING: Could not recover jumptable at 0x6b8340f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x340f0  1021  NotifyMountMgr
  NotifyMountMgr();
  return;
}



void OpenConsoleWStub(LPCWSTR param_1,DWORD param_2,BOOL param_3,DWORD param_4)

{
                    // 0x34100  1027  OpenConsoleWStub
  OpenConsoleW(param_1,param_2,param_3,param_4);
  return;
}



HANDLE OpenFileById(HANDLE hVolumeHint,LPFILE_ID_DESCRIPTOR lpFileId,DWORD dwDesiredAccess,
                   DWORD dwShareMode,LPSECURITY_ATTRIBUTES lpSecurityAttributes,
                   DWORD dwFlagsAndAttributes)

{
  HANDLE pvVar1;
  
                    // 0x34110  1031  OpenFileById
                    // WARNING: Could not recover jumptable at 0x6b834116. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = OpenFileById(hVolumeHint,lpFileId,dwDesiredAccess,dwShareMode,lpSecurityAttributes,
                        dwFlagsAndAttributes);
  return pvVar1;
}



void OutputDebugStringW(LPCWSTR lpOutputString)

{
                    // WARNING: Could not recover jumptable at 0x6b834130. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x34130  1053  OutputDebugStringW
  OutputDebugStringW(lpOutputString);
  return;
}



BOOL PeekNamedPipe(HANDLE hNamedPipe,LPVOID lpBuffer,DWORD nBufferSize,LPDWORD lpBytesRead,
                  LPDWORD lpTotalBytesAvail,LPDWORD lpBytesLeftThisMessage)

{
  BOOL BVar1;
  
                    // 0x34140  1062  PeekNamedPipe
                    // WARNING: Could not recover jumptable at 0x6b834146. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = PeekNamedPipe(hNamedPipe,lpBuffer,nBufferSize,lpBytesRead,lpTotalBytesAvail,
                        lpBytesLeftThisMessage);
  return BVar1;
}



void PrivCopyFileExW(void)

{
                    // 0x34160  1069  PrivCopyFileExW
                    // WARNING: Could not recover jumptable at 0x6b834166. Too many branches
                    // WARNING: Treating indirect jump as call
  PrivCopyFileExW();
  return;
}



void PssCaptureSnapshot(void)

{
                    // 0x34180  1076  PssCaptureSnapshot
                    // WARNING: Could not recover jumptable at 0x6b834186. Too many branches
                    // WARNING: Treating indirect jump as call
  PssCaptureSnapshot();
  return;
}



void PssDuplicateSnapshot(void)

{
                    // 0x341a0  1077  PssDuplicateSnapshot
                    // WARNING: Could not recover jumptable at 0x6b8341a6. Too many branches
                    // WARNING: Treating indirect jump as call
  PssDuplicateSnapshot();
  return;
}



void PssFreeSnapshot(void)

{
                    // 0x341c0  1078  PssFreeSnapshot
                    // WARNING: Could not recover jumptable at 0x6b8341c6. Too many branches
                    // WARNING: Treating indirect jump as call
  PssFreeSnapshot();
  return;
}



void PssQuerySnapshot(void)

{
                    // 0x341e0  1079  PssQuerySnapshot
                    // WARNING: Could not recover jumptable at 0x6b8341e6. Too many branches
                    // WARNING: Treating indirect jump as call
  PssQuerySnapshot();
  return;
}



void PssWalkMarkerCreate(void)

{
                    // 0x34200  1080  PssWalkMarkerCreate
                    // WARNING: Could not recover jumptable at 0x6b834206. Too many branches
                    // WARNING: Treating indirect jump as call
  PssWalkMarkerCreate();
  return;
}



void PssWalkMarkerFree(void)

{
                    // 0x34220  1081  PssWalkMarkerFree
                    // WARNING: Could not recover jumptable at 0x6b834226. Too many branches
                    // WARNING: Treating indirect jump as call
  PssWalkMarkerFree();
  return;
}



void PssWalkMarkerGetPosition(void)

{
                    // 0x34240  1082  PssWalkMarkerGetPosition
                    // 0x34240  1087  PssWalkMarkerTell
                    // WARNING: Could not recover jumptable at 0x6b834246. Too many branches
                    // WARNING: Treating indirect jump as call
  PssWalkMarkerGetPosition();
  return;
}



void PssWalkMarkerRewind(void)

{
                    // 0x34260  1083  PssWalkMarkerRewind
                    // 0x34260  1085  PssWalkMarkerSeekToBeginning
                    // WARNING: Could not recover jumptable at 0x6b834266. Too many branches
                    // WARNING: Treating indirect jump as call
  PssWalkMarkerSeekToBeginning();
  return;
}



void PssWalkMarkerSeek(void)

{
                    // 0x34280  1084  PssWalkMarkerSeek
                    // 0x34280  1086  PssWalkMarkerSetPosition
                    // WARNING: Could not recover jumptable at 0x6b834286. Too many branches
                    // WARNING: Treating indirect jump as call
  PssWalkMarkerSetPosition();
  return;
}



void PssWalkSnapshot(void)

{
                    // 0x342a0  1088  PssWalkSnapshot
                    // WARNING: Could not recover jumptable at 0x6b8342a6. Too many branches
                    // WARNING: Treating indirect jump as call
  PssWalkSnapshot();
  return;
}



BOOL PulseEvent(HANDLE hEvent)

{
  BOOL BVar1;
  
                    // 0x342c0  1089  PulseEvent
                    // WARNING: Could not recover jumptable at 0x6b8342c6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = PulseEvent(hEvent);
  return BVar1;
}



BOOL QueryActCtxSettingsW
               (DWORD dwFlags,HANDLE hActCtx,PCWSTR settingsNameSpace,PCWSTR settingName,
               PWSTR pvBuffer,SIZE_T dwBuffer,SIZE_T *pdwWrittenOrRequired)

{
  BOOL BVar1;
  
                    // 0x342e0  1091  QueryActCtxSettingsW
                    // WARNING: Could not recover jumptable at 0x6b8342e6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = QueryActCtxSettingsW
                    (dwFlags,hActCtx,settingsNameSpace,settingName,pvBuffer,dwBuffer,
                     pdwWrittenOrRequired);
  return BVar1;
}



BOOL QueryFullProcessImageNameA(HANDLE hProcess,DWORD dwFlags,LPSTR lpExeName,PDWORD lpdwSize)

{
  BOOL BVar1;
  
                    // 0x34300  1098  QueryFullProcessImageNameA
                    // WARNING: Could not recover jumptable at 0x6b834306. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = QueryFullProcessImageNameA(hProcess,dwFlags,lpExeName,lpdwSize);
  return BVar1;
}



BOOL QueryFullProcessImageNameW(HANDLE hProcess,DWORD dwFlags,LPWSTR lpExeName,PDWORD lpdwSize)

{
  BOOL BVar1;
  
                    // 0x34320  1099  QueryFullProcessImageNameW
                    // WARNING: Could not recover jumptable at 0x6b834326. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = QueryFullProcessImageNameW(hProcess,dwFlags,lpExeName,lpdwSize);
  return BVar1;
}



BOOL QueryIdleProcessorCycleTimeEx(USHORT Group,PULONG BufferLength,PULONG64 ProcessorIdleCycleTime)

{
  BOOL BVar1;
  
                    // 0x34340  1101  QueryIdleProcessorCycleTimeEx
                    // WARNING: Could not recover jumptable at 0x6b834346. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = QueryIdleProcessorCycleTimeEx(Group,BufferLength,ProcessorIdleCycleTime);
  return BVar1;
}



BOOL QueryIdleProcessorCycleTime(PULONG BufferLength,PULONG64 ProcessorIdleCycleTime)

{
  BOOL BVar1;
  
                    // 0x34360  1100  QueryIdleProcessorCycleTime
                    // WARNING: Could not recover jumptable at 0x6b834366. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = QueryIdleProcessorCycleTime(BufferLength,ProcessorIdleCycleTime);
  return BVar1;
}



BOOL QueryMemoryResourceNotification(HANDLE ResourceNotificationHandle,PBOOL ResourceState)

{
  BOOL BVar1;
  
                    // 0x34380  1104  QueryMemoryResourceNotification
                    // WARNING: Could not recover jumptable at 0x6b834386. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = QueryMemoryResourceNotification(ResourceNotificationHandle,ResourceState);
  return BVar1;
}



BOOL QueryProcessAffinityUpdateMode(HANDLE hProcess,LPDWORD lpdwFlags)

{
  BOOL BVar1;
  
                    // 0x343a0  1107  QueryProcessAffinityUpdateMode
                    // WARNING: Could not recover jumptable at 0x6b8343a6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = QueryProcessAffinityUpdateMode(hProcess,lpdwFlags);
  return BVar1;
}



BOOL QueryProcessCycleTime(HANDLE ProcessHandle,PULONG64 CycleTime)

{
  BOOL BVar1;
  
                    // 0x343c0  1108  QueryProcessCycleTime
                    // WARNING: Could not recover jumptable at 0x6b8343c6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = QueryProcessCycleTime(ProcessHandle,CycleTime);
  return BVar1;
}



BOOL QueryThreadpoolStackInformation(PTP_POOL ptpp,PTP_POOL_STACK_INFORMATION ptpsi)

{
  int iVar1;
  
                    // 0x343e0  1112  QueryThreadpoolStackInformation
  iVar1 = TpQueryPoolStackInformation(ptpp,ptpsi);
  if (-1 >= iVar1) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  }
  return (uint)(-1 < iVar1);
}



HANDLE ReOpenFile(HANDLE hOriginalFile,DWORD dwDesiredAccess,DWORD dwShareMode,
                 DWORD dwFlagsAndAttributes)

{
  HANDLE pvVar1;
  
                    // 0x34410  1129  ReOpenFile
                    // WARNING: Could not recover jumptable at 0x6b834416. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = ReOpenFile(hOriginalFile,dwDesiredAccess,dwShareMode,dwFlagsAndAttributes);
  return pvVar1;
}



void ReadDirectoryChangesExW(void)

{
                    // 0x34430  1141  ReadDirectoryChangesExW
                    // WARNING: Could not recover jumptable at 0x6b834436. Too many branches
                    // WARNING: Treating indirect jump as call
  ReadDirectoryChangesExW();
  return;
}



BOOL ReadDirectoryChangesW
               (HANDLE hDirectory,LPVOID lpBuffer,DWORD nBufferLength,BOOL bWatchSubtree,
               DWORD dwNotifyFilter,LPDWORD lpBytesReturned,LPOVERLAPPED lpOverlapped,
               LPOVERLAPPED_COMPLETION_ROUTINE lpCompletionRoutine)

{
  BOOL BVar1;
  
                    // 0x34450  1142  ReadDirectoryChangesW
                    // WARNING: Could not recover jumptable at 0x6b834456. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = ReadDirectoryChangesW
                    (hDirectory,lpBuffer,nBufferLength,bWatchSubtree,dwNotifyFilter,lpBytesReturned,
                     lpOverlapped,lpCompletionRoutine);
  return BVar1;
}



BOOL ReadProcessMemory(HANDLE hProcess,LPCVOID lpBaseAddress,LPVOID lpBuffer,SIZE_T nSize,
                      SIZE_T *lpNumberOfBytesRead)

{
  BOOL BVar1;
  
                    // 0x34470  1146  ReadProcessMemory
                    // WARNING: Could not recover jumptable at 0x6b834476. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = ReadProcessMemory(hProcess,lpBaseAddress,lpBuffer,nSize,lpNumberOfBytesRead);
  return BVar1;
}



LSTATUS RegCloseKey(HKEY hKey)

{
  LSTATUS LVar1;
  
                    // 0x34490  1149  RegCloseKey
                    // WARNING: Could not recover jumptable at 0x6b834496. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegCloseKey(hKey);
  return LVar1;
}



LSTATUS RegCopyTreeW(HKEY hKeySrc,LPCWSTR lpSubKey,HKEY hKeyDest)

{
  LSTATUS LVar1;
  
                    // 0x344b0  1150  RegCopyTreeW
                    // WARNING: Could not recover jumptable at 0x6b8344b6. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegCopyTreeW(hKeySrc,lpSubKey,hKeyDest);
  return LVar1;
}



LSTATUS RegCreateKeyExA(HKEY hKey,LPCSTR lpSubKey,DWORD Reserved,LPSTR lpClass,DWORD dwOptions,
                       REGSAM samDesired,LPSECURITY_ATTRIBUTES lpSecurityAttributes,PHKEY phkResult,
                       LPDWORD lpdwDisposition)

{
  LSTATUS LVar1;
  
                    // 0x344d0  1151  RegCreateKeyExA
                    // WARNING: Could not recover jumptable at 0x6b8344d6. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegCreateKeyExA(hKey,lpSubKey,Reserved,lpClass,dwOptions,samDesired,lpSecurityAttributes,
                          phkResult,lpdwDisposition);
  return LVar1;
}



LSTATUS RegCreateKeyExW(HKEY hKey,LPCWSTR lpSubKey,DWORD Reserved,LPWSTR lpClass,DWORD dwOptions,
                       REGSAM samDesired,LPSECURITY_ATTRIBUTES lpSecurityAttributes,PHKEY phkResult,
                       LPDWORD lpdwDisposition)

{
  LSTATUS LVar1;
  
                    // 0x344f0  1152  RegCreateKeyExW
                    // WARNING: Could not recover jumptable at 0x6b8344f6. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegCreateKeyExW(hKey,lpSubKey,Reserved,lpClass,dwOptions,samDesired,lpSecurityAttributes,
                          phkResult,lpdwDisposition);
  return LVar1;
}



LSTATUS RegDeleteKeyExA(HKEY hKey,LPCSTR lpSubKey,REGSAM samDesired,DWORD Reserved)

{
  LSTATUS LVar1;
  
                    // 0x34510  1153  RegDeleteKeyExA
                    // WARNING: Could not recover jumptable at 0x6b834516. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegDeleteKeyExA(hKey,lpSubKey,samDesired,Reserved);
  return LVar1;
}



LSTATUS RegDeleteKeyExW(HKEY hKey,LPCWSTR lpSubKey,REGSAM samDesired,DWORD Reserved)

{
  LSTATUS LVar1;
  
                    // 0x34530  1154  RegDeleteKeyExW
                    // WARNING: Could not recover jumptable at 0x6b834536. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegDeleteKeyExW(hKey,lpSubKey,samDesired,Reserved);
  return LVar1;
}



LSTATUS RegDeleteTreeA(HKEY hKey,LPCSTR lpSubKey)

{
  LSTATUS LVar1;
  
                    // 0x34550  1155  RegDeleteTreeA
                    // WARNING: Could not recover jumptable at 0x6b834556. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegDeleteTreeA(hKey,lpSubKey);
  return LVar1;
}



LSTATUS RegDeleteTreeW(HKEY hKey,LPCWSTR lpSubKey)

{
  LSTATUS LVar1;
  
                    // 0x34570  1156  RegDeleteTreeW
                    // WARNING: Could not recover jumptable at 0x6b834576. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegDeleteTreeW(hKey,lpSubKey);
  return LVar1;
}



LSTATUS RegDeleteValueA(HKEY hKey,LPCSTR lpValueName)

{
  LSTATUS LVar1;
  
                    // 0x34590  1157  RegDeleteValueA
                    // WARNING: Could not recover jumptable at 0x6b834596. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegDeleteValueA(hKey,lpValueName);
  return LVar1;
}



LSTATUS RegDeleteValueW(HKEY hKey,LPCWSTR lpValueName)

{
  LSTATUS LVar1;
  
                    // 0x345b0  1158  RegDeleteValueW
                    // WARNING: Could not recover jumptable at 0x6b8345b6. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegDeleteValueW(hKey,lpValueName);
  return LVar1;
}



LSTATUS RegDisablePredefinedCacheEx(void)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b8345d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x345d0  1159  RegDisablePredefinedCacheEx
  LVar1 = RegDisablePredefinedCacheEx();
  return LVar1;
}



LSTATUS RegEnumKeyExA(HKEY hKey,DWORD dwIndex,LPSTR lpName,LPDWORD lpcchName,LPDWORD lpReserved,
                     LPSTR lpClass,LPDWORD lpcchClass,PFILETIME lpftLastWriteTime)

{
  LSTATUS LVar1;
  
                    // 0x345e0  1160  RegEnumKeyExA
                    // WARNING: Could not recover jumptable at 0x6b8345e6. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegEnumKeyExA(hKey,dwIndex,lpName,lpcchName,lpReserved,lpClass,lpcchClass,
                        lpftLastWriteTime);
  return LVar1;
}



LSTATUS RegEnumKeyExW(HKEY hKey,DWORD dwIndex,LPWSTR lpName,LPDWORD lpcchName,LPDWORD lpReserved,
                     LPWSTR lpClass,LPDWORD lpcchClass,PFILETIME lpftLastWriteTime)

{
  LSTATUS LVar1;
  
                    // 0x34600  1161  RegEnumKeyExW
                    // WARNING: Could not recover jumptable at 0x6b834606. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegEnumKeyExW(hKey,dwIndex,lpName,lpcchName,lpReserved,lpClass,lpcchClass,
                        lpftLastWriteTime);
  return LVar1;
}



LSTATUS RegEnumValueA(HKEY hKey,DWORD dwIndex,LPSTR lpValueName,LPDWORD lpcchValueName,
                     LPDWORD lpReserved,LPDWORD lpType,LPBYTE lpData,LPDWORD lpcbData)

{
  LSTATUS LVar1;
  
                    // 0x34620  1162  RegEnumValueA
                    // WARNING: Could not recover jumptable at 0x6b834626. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegEnumValueA(hKey,dwIndex,lpValueName,lpcchValueName,lpReserved,lpType,lpData,lpcbData);
  return LVar1;
}



LSTATUS RegEnumValueW(HKEY hKey,DWORD dwIndex,LPWSTR lpValueName,LPDWORD lpcchValueName,
                     LPDWORD lpReserved,LPDWORD lpType,LPBYTE lpData,LPDWORD lpcbData)

{
  LSTATUS LVar1;
  
                    // 0x34640  1163  RegEnumValueW
                    // WARNING: Could not recover jumptable at 0x6b834646. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegEnumValueW(hKey,dwIndex,lpValueName,lpcchValueName,lpReserved,lpType,lpData,lpcbData);
  return LVar1;
}



LSTATUS RegFlushKey(HKEY hKey)

{
  LSTATUS LVar1;
  
                    // 0x34660  1164  RegFlushKey
                    // WARNING: Could not recover jumptable at 0x6b834666. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegFlushKey(hKey);
  return LVar1;
}



LSTATUS RegGetKeySecurity(HKEY hKey,SECURITY_INFORMATION SecurityInformation,
                         PSECURITY_DESCRIPTOR pSecurityDescriptor,LPDWORD lpcbSecurityDescriptor)

{
  LSTATUS LVar1;
  
                    // 0x34680  1165  RegGetKeySecurity
                    // WARNING: Could not recover jumptable at 0x6b834686. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegGetKeySecurity(hKey,SecurityInformation,pSecurityDescriptor,lpcbSecurityDescriptor);
  return LVar1;
}



LSTATUS RegGetValueA(HKEY hkey,LPCSTR lpSubKey,LPCSTR lpValue,DWORD dwFlags,LPDWORD pdwType,
                    PVOID pvData,LPDWORD pcbData)

{
  LSTATUS LVar1;
  
                    // 0x346a0  1166  RegGetValueA
                    // WARNING: Could not recover jumptable at 0x6b8346a6. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegGetValueA(hkey,lpSubKey,lpValue,dwFlags,pdwType,pvData,pcbData);
  return LVar1;
}



LSTATUS RegGetValueW(HKEY hkey,LPCWSTR lpSubKey,LPCWSTR lpValue,DWORD dwFlags,LPDWORD pdwType,
                    PVOID pvData,LPDWORD pcbData)

{
  LSTATUS LVar1;
  
                    // 0x346c0  1167  RegGetValueW
                    // WARNING: Could not recover jumptable at 0x6b8346c6. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegGetValueW(hkey,lpSubKey,lpValue,dwFlags,pdwType,pvData,pcbData);
  return LVar1;
}



LSTATUS RegLoadKeyA(HKEY hKey,LPCSTR lpSubKey,LPCSTR lpFile)

{
  LSTATUS LVar1;
  
                    // 0x346e0  1168  RegLoadKeyA
                    // WARNING: Could not recover jumptable at 0x6b8346e6. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegLoadKeyA(hKey,lpSubKey,lpFile);
  return LVar1;
}



LSTATUS RegLoadKeyW(HKEY hKey,LPCWSTR lpSubKey,LPCWSTR lpFile)

{
  LSTATUS LVar1;
  
                    // 0x34700  1169  RegLoadKeyW
                    // WARNING: Could not recover jumptable at 0x6b834706. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegLoadKeyW(hKey,lpSubKey,lpFile);
  return LVar1;
}



LSTATUS RegLoadMUIStringA(HKEY hKey,LPCSTR pszValue,LPSTR pszOutBuf,DWORD cbOutBuf,LPDWORD pcbData,
                         DWORD Flags,LPCSTR pszDirectory)

{
  LSTATUS LVar1;
  
                    // 0x34720  1170  RegLoadMUIStringA
                    // WARNING: Could not recover jumptable at 0x6b834726. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegLoadMUIStringA(hKey,pszValue,pszOutBuf,cbOutBuf,pcbData,Flags,pszDirectory);
  return LVar1;
}



LSTATUS RegLoadMUIStringW(HKEY hKey,LPCWSTR pszValue,LPWSTR pszOutBuf,DWORD cbOutBuf,LPDWORD pcbData
                         ,DWORD Flags,LPCWSTR pszDirectory)

{
  LSTATUS LVar1;
  
                    // 0x34740  1171  RegLoadMUIStringW
                    // WARNING: Could not recover jumptable at 0x6b834746. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegLoadMUIStringW(hKey,pszValue,pszOutBuf,cbOutBuf,pcbData,Flags,pszDirectory);
  return LVar1;
}



LSTATUS RegNotifyChangeKeyValue
                  (HKEY hKey,BOOL bWatchSubtree,DWORD dwNotifyFilter,HANDLE hEvent,
                  BOOL fAsynchronous)

{
  LSTATUS LVar1;
  
                    // 0x34760  1172  RegNotifyChangeKeyValue
                    // WARNING: Could not recover jumptable at 0x6b834766. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegNotifyChangeKeyValue(hKey,bWatchSubtree,dwNotifyFilter,hEvent,fAsynchronous);
  return LVar1;
}



LSTATUS RegOpenCurrentUser(REGSAM samDesired,PHKEY phkResult)

{
  LSTATUS LVar1;
  
                    // 0x34780  1173  RegOpenCurrentUser
                    // WARNING: Could not recover jumptable at 0x6b834786. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegOpenCurrentUser(samDesired,phkResult);
  return LVar1;
}



LSTATUS RegOpenKeyExA(HKEY hKey,LPCSTR lpSubKey,DWORD ulOptions,REGSAM samDesired,PHKEY phkResult)

{
  LSTATUS LVar1;
  
                    // 0x347a0  1174  RegOpenKeyExA
                    // WARNING: Could not recover jumptable at 0x6b8347a6. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegOpenKeyExA(hKey,lpSubKey,ulOptions,samDesired,phkResult);
  return LVar1;
}



LSTATUS RegOpenUserClassesRoot(HANDLE hToken,DWORD dwOptions,REGSAM samDesired,PHKEY phkResult)

{
  LSTATUS LVar1;
  
                    // 0x347c0  1176  RegOpenUserClassesRoot
                    // WARNING: Could not recover jumptable at 0x6b8347c6. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegOpenUserClassesRoot(hToken,dwOptions,samDesired,phkResult);
  return LVar1;
}



LSTATUS RegQueryInfoKeyA(HKEY hKey,LPSTR lpClass,LPDWORD lpcchClass,LPDWORD lpReserved,
                        LPDWORD lpcSubKeys,LPDWORD lpcbMaxSubKeyLen,LPDWORD lpcbMaxClassLen,
                        LPDWORD lpcValues,LPDWORD lpcbMaxValueNameLen,LPDWORD lpcbMaxValueLen,
                        LPDWORD lpcbSecurityDescriptor,PFILETIME lpftLastWriteTime)

{
  LSTATUS LVar1;
  
                    // 0x347e0  1177  RegQueryInfoKeyA
                    // WARNING: Could not recover jumptable at 0x6b8347e6. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegQueryInfoKeyA(hKey,lpClass,lpcchClass,lpReserved,lpcSubKeys,lpcbMaxSubKeyLen,
                           lpcbMaxClassLen,lpcValues,lpcbMaxValueNameLen,lpcbMaxValueLen,
                           lpcbSecurityDescriptor,lpftLastWriteTime);
  return LVar1;
}



LSTATUS RegQueryInfoKeyW(HKEY hKey,LPWSTR lpClass,LPDWORD lpcchClass,LPDWORD lpReserved,
                        LPDWORD lpcSubKeys,LPDWORD lpcbMaxSubKeyLen,LPDWORD lpcbMaxClassLen,
                        LPDWORD lpcValues,LPDWORD lpcbMaxValueNameLen,LPDWORD lpcbMaxValueLen,
                        LPDWORD lpcbSecurityDescriptor,PFILETIME lpftLastWriteTime)

{
  LSTATUS LVar1;
  
                    // 0x34800  1178  RegQueryInfoKeyW
                    // WARNING: Could not recover jumptable at 0x6b834806. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegQueryInfoKeyW(hKey,lpClass,lpcchClass,lpReserved,lpcSubKeys,lpcbMaxSubKeyLen,
                           lpcbMaxClassLen,lpcValues,lpcbMaxValueNameLen,lpcbMaxValueLen,
                           lpcbSecurityDescriptor,lpftLastWriteTime);
  return LVar1;
}



LSTATUS RegQueryValueExA(HKEY hKey,LPCSTR lpValueName,LPDWORD lpReserved,LPDWORD lpType,
                        LPBYTE lpData,LPDWORD lpcbData)

{
  LSTATUS LVar1;
  
                    // 0x34820  1179  RegQueryValueExA
                    // WARNING: Could not recover jumptable at 0x6b834826. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegQueryValueExA(hKey,lpValueName,lpReserved,lpType,lpData,lpcbData);
  return LVar1;
}



LSTATUS RegQueryValueExW(HKEY hKey,LPCWSTR lpValueName,LPDWORD lpReserved,LPDWORD lpType,
                        LPBYTE lpData,LPDWORD lpcbData)

{
  LSTATUS LVar1;
  
                    // 0x34840  1180  RegQueryValueExW
                    // WARNING: Could not recover jumptable at 0x6b834846. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegQueryValueExW(hKey,lpValueName,lpReserved,lpType,lpData,lpcbData);
  return LVar1;
}



LSTATUS RegRestoreKeyA(HKEY hKey,LPCSTR lpFile,DWORD dwFlags)

{
  LSTATUS LVar1;
  
                    // 0x34860  1181  RegRestoreKeyA
                    // WARNING: Could not recover jumptable at 0x6b834866. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegRestoreKeyA(hKey,lpFile,dwFlags);
  return LVar1;
}



LSTATUS RegRestoreKeyW(HKEY hKey,LPCWSTR lpFile,DWORD dwFlags)

{
  LSTATUS LVar1;
  
                    // 0x34880  1182  RegRestoreKeyW
                    // WARNING: Could not recover jumptable at 0x6b834886. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegRestoreKeyW(hKey,lpFile,dwFlags);
  return LVar1;
}



LSTATUS RegSaveKeyExA(HKEY hKey,LPCSTR lpFile,LPSECURITY_ATTRIBUTES lpSecurityAttributes,DWORD Flags
                     )

{
  LSTATUS LVar1;
  
                    // 0x348a0  1183  RegSaveKeyExA
                    // WARNING: Could not recover jumptable at 0x6b8348a6. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegSaveKeyExA(hKey,lpFile,lpSecurityAttributes,Flags);
  return LVar1;
}



LSTATUS RegSaveKeyExW(HKEY hKey,LPCWSTR lpFile,LPSECURITY_ATTRIBUTES lpSecurityAttributes,
                     DWORD Flags)

{
  LSTATUS LVar1;
  
                    // 0x348c0  1184  RegSaveKeyExW
                    // WARNING: Could not recover jumptable at 0x6b8348c6. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegSaveKeyExW(hKey,lpFile,lpSecurityAttributes,Flags);
  return LVar1;
}



LSTATUS RegSetKeySecurity(HKEY hKey,SECURITY_INFORMATION SecurityInformation,
                         PSECURITY_DESCRIPTOR pSecurityDescriptor)

{
  LSTATUS LVar1;
  
                    // 0x348e0  1185  RegSetKeySecurity
                    // WARNING: Could not recover jumptable at 0x6b8348e6. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegSetKeySecurity(hKey,SecurityInformation,pSecurityDescriptor);
  return LVar1;
}



LSTATUS RegSetValueExA(HKEY hKey,LPCSTR lpValueName,DWORD Reserved,DWORD dwType,BYTE *lpData,
                      DWORD cbData)

{
  LSTATUS LVar1;
  
                    // 0x34900  1186  RegSetValueExA
                    // WARNING: Could not recover jumptable at 0x6b834906. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegSetValueExA(hKey,lpValueName,Reserved,dwType,lpData,cbData);
  return LVar1;
}



LSTATUS RegSetValueExW(HKEY hKey,LPCWSTR lpValueName,DWORD Reserved,DWORD dwType,BYTE *lpData,
                      DWORD cbData)

{
  LSTATUS LVar1;
  
                    // 0x34920  1187  RegSetValueExW
                    // WARNING: Could not recover jumptable at 0x6b834926. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegSetValueExW(hKey,lpValueName,Reserved,dwType,lpData,cbData);
  return LVar1;
}



LSTATUS RegUnLoadKeyA(HKEY hKey,LPCSTR lpSubKey)

{
  LSTATUS LVar1;
  
                    // 0x34940  1188  RegUnLoadKeyA
                    // WARNING: Could not recover jumptable at 0x6b834946. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegUnLoadKeyA(hKey,lpSubKey);
  return LVar1;
}



LSTATUS RegUnLoadKeyW(HKEY hKey,LPCWSTR lpSubKey)

{
  LSTATUS LVar1;
  
                    // 0x34960  1189  RegUnLoadKeyW
                    // WARNING: Could not recover jumptable at 0x6b834966. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = RegUnLoadKeyW(hKey,lpSubKey);
  return LVar1;
}



void RegisterBadMemoryNotification(void)

{
                    // 0x34980  1192  RegisterBadMemoryNotification
                    // WARNING: Could not recover jumptable at 0x6b834986. Too many branches
                    // WARNING: Treating indirect jump as call
  RegisterBadMemoryNotification();
  return;
}



HANDLE RegisterWaitForSingleObjectEx
                 (HANDLE hObject,WAITORTIMERCALLBACK Callback,PVOID Context,ULONG dwMilliseconds,
                 ULONG dwFlags)

{
  HANDLE pvVar1;
  
                    // 0x349a0  1198  RegisterWaitForSingleObjectEx
                    // WARNING: Could not recover jumptable at 0x6b8349a6. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = RegisterWaitForSingleObjectEx(hObject,Callback,Context,dwMilliseconds,dwFlags);
  return pvVar1;
}



int ResolveLocaleName(LPCWSTR lpNameToResolve,LPWSTR lpLocaleName,int cchLocaleName)

{
  int iVar1;
  
                    // 0x349c0  1231  ResolveLocaleName
                    // WARNING: Could not recover jumptable at 0x6b8349c6. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = ResolveLocaleName(lpNameToResolve,lpLocaleName,cchLocaleName);
  return iVar1;
}



void RtlFillMemory(void *param_1,size_t param_2,int param_3)

{
                    // 0x349e0  1236  RtlFillMemory
  memset(param_1,param_3,param_2);
  return;
}



PVOID RtlPcToFileHeader(PVOID PcValue,PVOID *BaseOfImage)

{
  PVOID pvVar1;
  
                    // 0x34a00  1238  RtlPcToFileHeader
                    // WARNING: Could not recover jumptable at 0x6b834a06. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = RtlPcToFileHeader(PcValue,BaseOfImage);
  return pvVar1;
}



void SetCachedSigningLevel(void)

{
                    // 0x34a20  1245  SetCachedSigningLevel
                    // WARNING: Could not recover jumptable at 0x6b834a26. Too many branches
                    // WARNING: Treating indirect jump as call
  SetCachedSigningLevel();
  return;
}



BOOL SetCalendarInfoW(LCID Locale,CALID Calendar,CALTYPE CalType,LPCWSTR lpCalData)

{
  BOOL BVar1;
  
                    // 0x34a40  1247  SetCalendarInfoW
                    // WARNING: Could not recover jumptable at 0x6b834a46. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetCalendarInfoW(Locale,Calendar,CalType,lpCalData);
  return BVar1;
}



BOOL SetComputerNameA(LPCSTR lpComputerName)

{
  BOOL BVar1;
  
                    // 0x34a60  1254  SetComputerNameA
                    // WARNING: Could not recover jumptable at 0x6b834a66. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetComputerNameA(lpComputerName);
  return BVar1;
}



void SetComputerNameEx2W(void)

{
                    // 0x34a80  1255  SetComputerNameEx2W
                    // WARNING: Could not recover jumptable at 0x6b834a86. Too many branches
                    // WARNING: Treating indirect jump as call
  SetComputerNameEx2W();
  return;
}



BOOL SetComputerNameExA(COMPUTER_NAME_FORMAT NameType,LPCSTR lpBuffer)

{
  BOOL BVar1;
  
                    // 0x34aa0  1256  SetComputerNameExA
                    // WARNING: Could not recover jumptable at 0x6b834aa6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetComputerNameExA(NameType,lpBuffer);
  return BVar1;
}



BOOL SetComputerNameExW(COMPUTER_NAME_FORMAT NameType,LPCWSTR lpBuffer)

{
  BOOL BVar1;
  
                    // 0x34ac0  1257  SetComputerNameExW
                    // WARNING: Could not recover jumptable at 0x6b834ac6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetComputerNameExW(NameType,lpBuffer);
  return BVar1;
}



BOOL SetComputerNameW(LPCWSTR lpComputerName)

{
  BOOL BVar1;
  
                    // 0x34ae0  1258  SetComputerNameW
                    // WARNING: Could not recover jumptable at 0x6b834ae6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetComputerNameW(lpComputerName);
  return BVar1;
}



BOOL SetCurrentDirectoryA(LPCSTR lpPathName)

{
  BOOL BVar1;
  
                    // 0x34b00  1292  SetCurrentDirectoryA
                    // WARNING: Could not recover jumptable at 0x6b834b06. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetCurrentDirectoryA(lpPathName);
  return BVar1;
}



BOOL SetDynamicTimeZoneInformation(DYNAMIC_TIME_ZONE_INFORMATION *lpTimeZoneInformation)

{
  BOOL BVar1;
  
                    // 0x34b20  1299  SetDynamicTimeZoneInformation
                    // WARNING: Could not recover jumptable at 0x6b834b26. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetDynamicTimeZoneInformation(lpTimeZoneInformation);
  return BVar1;
}



BOOL SetEnvironmentStringsW(LPWCH NewEnvironment)

{
  BOOL BVar1;
  
                    // 0x34b40  1302  SetEnvironmentStringsW
                    // WARNING: Could not recover jumptable at 0x6b834b46. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetEnvironmentStringsW(NewEnvironment);
  return BVar1;
}



BOOL SetEnvironmentVariableA(LPCSTR lpName,LPCSTR lpValue)

{
  BOOL BVar1;
  
                    // 0x34b60  1303  SetEnvironmentVariableA
                    // WARNING: Could not recover jumptable at 0x6b834b66. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetEnvironmentVariableA(lpName,lpValue);
  return BVar1;
}



void SetFileApisToANSI(void)

{
                    // WARNING: Could not recover jumptable at 0x6b834b80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x34b80  1308  SetFileApisToANSI
  SetFileApisToANSI();
  return;
}



void SetFileApisToOEM(void)

{
                    // WARNING: Could not recover jumptable at 0x6b834b90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x34b90  1309  SetFileApisToOEM
  SetFileApisToOEM();
  return;
}



BOOL SetFileIoOverlappedRange(HANDLE FileHandle,PUCHAR OverlappedRangeStart,ULONG Length)

{
  BOOL BVar1;
  
                    // 0x34ba0  1317  SetFileIoOverlappedRange
                    // WARNING: Could not recover jumptable at 0x6b834ba6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetFileIoOverlappedRange(FileHandle,OverlappedRangeStart,Length);
  return BVar1;
}



BOOL SetLocalTime(SYSTEMTIME *lpSystemTime)

{
  BOOL BVar1;
  
                    // 0x34bc0  1337  SetLocalTime
                    // WARNING: Could not recover jumptable at 0x6b834bc6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetLocalTime(lpSystemTime);
  return BVar1;
}



BOOL SetLocaleInfoW(LCID Locale,LCTYPE LCType,LPCWSTR lpLCData)

{
  BOOL BVar1;
  
                    // 0x34be0  1339  SetLocaleInfoW
                    // WARNING: Could not recover jumptable at 0x6b834be6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetLocaleInfoW(Locale,LCType,lpLCData);
  return BVar1;
}



BOOL SetNamedPipeHandleState
               (HANDLE hNamedPipe,LPDWORD lpMode,LPDWORD lpMaxCollectionCount,
               LPDWORD lpCollectDataTimeout)

{
  BOOL BVar1;
  
                    // 0x34c00  1343  SetNamedPipeHandleState
                    // WARNING: Could not recover jumptable at 0x6b834c06. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetNamedPipeHandleState(hNamedPipe,lpMode,lpMaxCollectionCount,lpCollectDataTimeout);
  return BVar1;
}



BOOL SetProcessAffinityUpdateMode(HANDLE hProcess,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // 0x34c20  1346  SetProcessAffinityUpdateMode
                    // WARNING: Could not recover jumptable at 0x6b834c26. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetProcessAffinityUpdateMode(hProcess,dwFlags);
  return BVar1;
}



BOOL SetProcessPreferredUILanguages
               (DWORD dwFlags,PCZZWSTR pwszLanguagesBuffer,PULONG pulNumLanguages)

{
  BOOL BVar1;
  
                    // 0x34c40  1353  SetProcessPreferredUILanguages
                    // WARNING: Could not recover jumptable at 0x6b834c46. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetProcessPreferredUILanguages(dwFlags,pwszLanguagesBuffer,pulNumLanguages);
  return BVar1;
}



BOOL SetProcessPriorityBoost(HANDLE hProcess,BOOL bDisablePriorityBoost)

{
  BOOL BVar1;
  
                    // 0x34c60  1354  SetProcessPriorityBoost
                    // WARNING: Could not recover jumptable at 0x6b834c66. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetProcessPriorityBoost(hProcess,bDisablePriorityBoost);
  return BVar1;
}



BOOL SetProcessWorkingSetSizeEx
               (HANDLE hProcess,SIZE_T dwMinimumWorkingSetSize,SIZE_T dwMaximumWorkingSetSize,
               DWORD Flags)

{
  BOOL BVar1;
  
                    // 0x34c80  1357  SetProcessWorkingSetSizeEx
                    // WARNING: Could not recover jumptable at 0x6b834c86. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetProcessWorkingSetSizeEx(hProcess,dwMinimumWorkingSetSize,dwMaximumWorkingSetSize,Flags)
  ;
  return BVar1;
}



BOOL SetStdHandleEx(DWORD nStdHandle,HANDLE hHandle,PHANDLE phPrevValue)

{
  BOOL BVar1;
  
                    // 0x34ca0  1361  SetStdHandleEx
                    // WARNING: Could not recover jumptable at 0x6b834ca6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetStdHandleEx(nStdHandle,hHandle,phPrevValue);
  return BVar1;
}



BOOL SetStdHandle(DWORD nStdHandle,HANDLE hHandle)

{
  BOOL BVar1;
  
                    // 0x34cc0  1360  SetStdHandle
                    // WARNING: Could not recover jumptable at 0x6b834cc6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetStdHandle(nStdHandle,hHandle);
  return BVar1;
}



BOOL SetSystemFileCacheSize(SIZE_T MinimumFileCacheSize,SIZE_T MaximumFileCacheSize,DWORD Flags)

{
  BOOL BVar1;
  
                    // 0x34ce0  1362  SetSystemFileCacheSize
                    // WARNING: Could not recover jumptable at 0x6b834ce6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetSystemFileCacheSize(MinimumFileCacheSize,MaximumFileCacheSize,Flags);
  return BVar1;
}



BOOL SetSystemTime(SYSTEMTIME *lpSystemTime)

{
  BOOL BVar1;
  
                    // 0x34d00  1364  SetSystemTime
                    // WARNING: Could not recover jumptable at 0x6b834d06. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetSystemTime(lpSystemTime);
  return BVar1;
}



BOOL SetThreadContext(HANDLE hThread,CONTEXT *lpContext)

{
  BOOL BVar1;
  
                    // 0x34d20  1370  SetThreadContext
                    // WARNING: Could not recover jumptable at 0x6b834d26. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetThreadContext(hThread,lpContext);
  return BVar1;
}



BOOL SetThreadGroupAffinity
               (HANDLE hThread,GROUP_AFFINITY *GroupAffinity,PGROUP_AFFINITY PreviousGroupAffinity)

{
  BOOL BVar1;
  
                    // 0x34d40  1374  SetThreadGroupAffinity
                    // WARNING: Could not recover jumptable at 0x6b834d46. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetThreadGroupAffinity(hThread,GroupAffinity,PreviousGroupAffinity);
  return BVar1;
}



BOOL SetThreadIdealProcessorEx
               (HANDLE hThread,PPROCESSOR_NUMBER lpIdealProcessor,
               PPROCESSOR_NUMBER lpPreviousIdealProcessor)

{
  BOOL BVar1;
  
                    // 0x34d60  1376  SetThreadIdealProcessorEx
                    // WARNING: Could not recover jumptable at 0x6b834d66. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetThreadIdealProcessorEx(hThread,lpIdealProcessor,lpPreviousIdealProcessor);
  return BVar1;
}



BOOL SetThreadPriorityBoost(HANDLE hThread,BOOL bDisablePriorityBoost)

{
  BOOL BVar1;
  
                    // 0x34d80  1381  SetThreadPriorityBoost
                    // WARNING: Could not recover jumptable at 0x6b834d86. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetThreadPriorityBoost(hThread,bDisablePriorityBoost);
  return BVar1;
}



LANGID SetThreadUILanguage(LANGID LangId)

{
  LANGID LVar1;
  
                    // 0x34da0  1385  SetThreadUILanguage
                    // WARNING: Could not recover jumptable at 0x6b834da6. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = SetThreadUILanguage(LangId);
  return LVar1;
}



BOOL SetThreadpoolStackInformation(PTP_POOL ptpp,PTP_POOL_STACK_INFORMATION ptpsi)

{
  int iVar1;
  
                    // 0x34dc0  1386  SetThreadpoolStackInformation
  iVar1 = TpSetPoolStackInformation(ptpp,ptpsi);
  if (-1 >= iVar1) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  }
  return (uint)(-1 < iVar1);
}



BOOL SetThreadpoolThreadMinimum(PTP_POOL ptpp,DWORD cthrdMic)

{
  int iVar1;
  
                    // 0x34df0  1388  SetThreadpoolThreadMinimum
  iVar1 = TpSetPoolMinThreads(ptpp,cthrdMic);
  if (-1 >= iVar1) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  }
  return (uint)(-1 < iVar1);
}



BOOL SetTimeZoneInformation(TIME_ZONE_INFORMATION *lpTimeZoneInformation)

{
  BOOL BVar1;
  
                    // 0x34e20  1393  SetTimeZoneInformation
                    // WARNING: Could not recover jumptable at 0x6b834e26. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetTimeZoneInformation(lpTimeZoneInformation);
  return BVar1;
}



void SetVolumeMountPointWStub(LPCWSTR param_1,LPCWSTR param_2)

{
                    // 0x34e40  1403  SetVolumeMountPointWStub
  SetVolumeMountPointW(param_1,param_2);
  return;
}



void SetXStateFeaturesMask(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
                    // 0x34e50  1406  SetXStateFeaturesMask
  SetXStateFeaturesMask(param_1,param_2,param_3);
  return;
}



DWORD SignalObjectAndWait(HANDLE hObjectToSignal,HANDLE hObjectToWaitOn,DWORD dwMilliseconds,
                         BOOL bAlertable)

{
  DWORD DVar1;
  
                    // 0x34e70  1409  SignalObjectAndWait
                    // WARNING: Could not recover jumptable at 0x6b834e76. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = SignalObjectAndWait(hObjectToSignal,hObjectToWaitOn,dwMilliseconds,bAlertable);
  return DVar1;
}



DWORD SuspendThread(HANDLE hThread)

{
  DWORD DVar1;
  
                    // 0x34e90  1419  SuspendThread
                    // WARNING: Could not recover jumptable at 0x6b834e96. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = SuspendThread(hThread);
  return DVar1;
}



BOOL TerminateThread(HANDLE hThread,DWORD dwExitCode)

{
  BOOL BVar1;
  
                    // 0x34eb0  1427  TerminateThread
                    // WARNING: Could not recover jumptable at 0x6b834eb6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = TerminateThread(hThread,dwExitCode);
  return BVar1;
}



BOOL TransactNamedPipe(HANDLE hNamedPipe,LPVOID lpInBuffer,DWORD nInBufferSize,LPVOID lpOutBuffer,
                      DWORD nOutBufferSize,LPDWORD lpBytesRead,LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  
                    // 0x34ed0  1449  TransactNamedPipe
                    // WARNING: Could not recover jumptable at 0x6b834ed6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = TransactNamedPipe(hNamedPipe,lpInBuffer,nInBufferSize,lpOutBuffer,nOutBufferSize,
                            lpBytesRead,lpOverlapped);
  return BVar1;
}



BOOL TrySubmitThreadpoolCallback(PTP_SIMPLE_CALLBACK pfns,PVOID pv,PTP_CALLBACK_ENVIRON pcbe)

{
  int iVar1;
  
                    // 0x34ef0  1454  TrySubmitThreadpoolCallback
  iVar1 = TpSimpleTryPost(pfns,pv,pcbe);
  if (-1 >= iVar1) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  }
  return (uint)(-1 < iVar1);
}



LONG UnhandledExceptionFilter(_EXCEPTION_POINTERS *ExceptionInfo)

{
  LONG LVar1;
  
                    // 0x34f20  1459  UnhandledExceptionFilter
                    // WARNING: Could not recover jumptable at 0x6b834f26. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = UnhandledExceptionFilter(ExceptionInfo);
  return LVar1;
}



HRESULT UnregisterApplicationRestart(void)

{
  HRESULT HVar1;
  
                    // WARNING: Could not recover jumptable at 0x6b834f40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x34f40  1465  UnregisterApplicationRestart
  HVar1 = UnregisterApplicationRestart();
  return HVar1;
}



void UnregisterBadMemoryNotification(void)

{
                    // 0x34f50  1466  UnregisterBadMemoryNotification
                    // WARNING: Could not recover jumptable at 0x6b834f56. Too many branches
                    // WARNING: Treating indirect jump as call
  UnregisterBadMemoryNotification();
  return;
}



DWORD VerLanguageNameA(DWORD wLang,LPSTR szLang,DWORD cchLang)

{
  DWORD DVar1;
  
                    // 0x34f70  1477  VerLanguageNameA
                    // WARNING: Could not recover jumptable at 0x6b834f76. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = VerLanguageNameA(wLang,szLang,cchLang);
  return DVar1;
}



DWORD VerLanguageNameW(DWORD wLang,LPWSTR szLang,DWORD cchLang)

{
  DWORD DVar1;
  
                    // 0x34f90  1478  VerLanguageNameW
                    // WARNING: Could not recover jumptable at 0x6b834f96. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = VerLanguageNameW(wLang,szLang,cchLang);
  return DVar1;
}



BOOL VerifyScripts(DWORD dwFlags,LPCWSTR lpLocaleScripts,int cchLocaleScripts,LPCWSTR lpTestScripts,
                  int cchTestScripts)

{
  BOOL BVar1;
  
                    // 0x34fb0  1481  VerifyScripts
                    // WARNING: Could not recover jumptable at 0x6b834fb6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = VerifyScripts(dwFlags,lpLocaleScripts,cchLocaleScripts,lpTestScripts,cchTestScripts);
  return BVar1;
}



LPVOID VirtualAllocExNuma(HANDLE hProcess,LPVOID lpAddress,SIZE_T dwSize,DWORD flAllocationType,
                         DWORD flProtect,DWORD nndPreferred)

{
  LPVOID pvVar1;
  
                    // 0x34fd0  1486  VirtualAllocExNuma
                    // WARNING: Could not recover jumptable at 0x6b834fd6. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = VirtualAllocExNuma(hProcess,lpAddress,dwSize,flAllocationType,flProtect,nndPreferred);
  return pvVar1;
}



LPVOID VirtualAllocEx(HANDLE hProcess,LPVOID lpAddress,SIZE_T dwSize,DWORD flAllocationType,
                     DWORD flProtect)

{
  LPVOID pvVar1;
  
                    // 0x34ff0  1485  VirtualAllocEx
                    // WARNING: Could not recover jumptable at 0x6b834ff6. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = VirtualAllocEx(hProcess,lpAddress,dwSize,flAllocationType,flProtect);
  return pvVar1;
}



BOOL VirtualFreeEx(HANDLE hProcess,LPVOID lpAddress,SIZE_T dwSize,DWORD dwFreeType)

{
  BOOL BVar1;
  
                    // 0x35010  1488  VirtualFreeEx
                    // WARNING: Could not recover jumptable at 0x6b835016. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = VirtualFreeEx(hProcess,lpAddress,dwSize,dwFreeType);
  return BVar1;
}



BOOL VirtualProtectEx(HANDLE hProcess,LPVOID lpAddress,SIZE_T dwSize,DWORD flNewProtect,
                     PDWORD lpflOldProtect)

{
  BOOL BVar1;
  
                    // 0x35030  1491  VirtualProtectEx
                    // WARNING: Could not recover jumptable at 0x6b835036. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = VirtualProtectEx(hProcess,lpAddress,dwSize,flNewProtect,lpflOldProtect);
  return BVar1;
}



SIZE_T VirtualQueryEx(HANDLE hProcess,LPCVOID lpAddress,PMEMORY_BASIC_INFORMATION lpBuffer,
                     SIZE_T dwLength)

{
  SIZE_T SVar1;
  
                    // 0x35050  1493  VirtualQueryEx
                    // WARNING: Could not recover jumptable at 0x6b835056. Too many branches
                    // WARNING: Treating indirect jump as call
  SVar1 = VirtualQueryEx(hProcess,lpAddress,lpBuffer,dwLength);
  return SVar1;
}



BOOL WaitForDebugEvent(LPDEBUG_EVENT lpDebugEvent,DWORD dwMilliseconds)

{
  BOOL BVar1;
  
                    // 0x35070  1497  WaitForDebugEvent
                    // WARNING: Could not recover jumptable at 0x6b835076. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = WaitForDebugEvent(lpDebugEvent,dwMilliseconds);
  return BVar1;
}



BOOL WaitNamedPipeW(LPCWSTR lpNamedPipeName,DWORD nTimeOut)

{
  BOOL BVar1;
  
                    // 0x35090  1508  WaitNamedPipeW
                    // WARNING: Could not recover jumptable at 0x6b835096. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = WaitNamedPipeW(lpNamedPipeName,nTimeOut);
  return BVar1;
}



void WerRegisterAdditionalProcess(void)

{
                    // 0x350b0  1513  WerRegisterAdditionalProcess
                    // WARNING: Could not recover jumptable at 0x6b8350b6. Too many branches
                    // WARNING: Treating indirect jump as call
  WerRegisterAdditionalProcess();
  return;
}



void WerRegisterAppLocalDump(void)

{
                    // 0x350d0  1514  WerRegisterAppLocalDump
                    // WARNING: Could not recover jumptable at 0x6b8350d6. Too many branches
                    // WARNING: Treating indirect jump as call
  WerRegisterAppLocalDump();
  return;
}



void WerRegisterExcludedMemoryBlock(void)

{
                    // 0x350f0  1516  WerRegisterExcludedMemoryBlock
                    // WARNING: Could not recover jumptable at 0x6b8350f6. Too many branches
                    // WARNING: Treating indirect jump as call
  WerRegisterExcludedMemoryBlock();
  return;
}



void WerUnregisterAdditionalProcess(void)

{
                    // 0x35110  1525  WerUnregisterAdditionalProcess
                    // WARNING: Could not recover jumptable at 0x6b835116. Too many branches
                    // WARNING: Treating indirect jump as call
  WerUnregisterAdditionalProcess();
  return;
}



void WerUnregisterAppLocalDump(void)

{
                    // WARNING: Could not recover jumptable at 0x6b835130. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x35130  1526  WerUnregisterAppLocalDump
  WerUnregisterAppLocalDump();
  return;
}



void WerUnregisterCustomMetadata(void)

{
                    // 0x35140  1527  WerUnregisterCustomMetadata
                    // WARNING: Could not recover jumptable at 0x6b835146. Too many branches
                    // WARNING: Treating indirect jump as call
  WerUnregisterCustomMetadata();
  return;
}



void WerUnregisterExcludedMemoryBlock(void)

{
                    // 0x35160  1528  WerUnregisterExcludedMemoryBlock
                    // WARNING: Could not recover jumptable at 0x6b835166. Too many branches
                    // WARNING: Treating indirect jump as call
  WerUnregisterExcludedMemoryBlock();
  return;
}



HRESULT WerUnregisterFile(PCWSTR pwzFilePath)

{
  HRESULT HVar1;
  
                    // 0x35180  1529  WerUnregisterFile
                    // WARNING: Could not recover jumptable at 0x6b835186. Too many branches
                    // WARNING: Treating indirect jump as call
  HVar1 = WerUnregisterFile(pwzFilePath);
  return HVar1;
}



HRESULT WerUnregisterMemoryBlock(PVOID pvAddress)

{
  HRESULT HVar1;
  
                    // 0x351a0  1531  WerUnregisterMemoryBlock
                    // WARNING: Could not recover jumptable at 0x6b8351a6. Too many branches
                    // WARNING: Treating indirect jump as call
  HVar1 = WerUnregisterMemoryBlock(pvAddress);
  return HVar1;
}



HRESULT WerUnregisterRuntimeExceptionModule(PCWSTR pwszOutOfProcessCallbackDll,PVOID pContext)

{
  HRESULT HVar1;
  
                    // 0x351c0  1533  WerUnregisterRuntimeExceptionModule
                    // WARNING: Could not recover jumptable at 0x6b8351c6. Too many branches
                    // WARNING: Treating indirect jump as call
  HVar1 = WerUnregisterRuntimeExceptionModule(pwszOutOfProcessCallbackDll,pContext);
  return HVar1;
}



BOOL Wow64GetThreadContext(HANDLE hThread,PWOW64_CONTEXT lpContext)

{
  BOOL BVar1;
  
                    // 0x351e0  1544  Wow64GetThreadContext
                    // WARNING: Could not recover jumptable at 0x6b8351e6. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = Wow64GetThreadContext(hThread,lpContext);
  return BVar1;
}



BOOL Wow64SetThreadContext(HANDLE hThread,WOW64_CONTEXT *lpContext)

{
  BOOL BVar1;
  
                    // 0x35200  1547  Wow64SetThreadContext
                    // WARNING: Could not recover jumptable at 0x6b835206. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = Wow64SetThreadContext(hThread,lpContext);
  return BVar1;
}



DWORD Wow64SuspendThread(HANDLE hThread)

{
  DWORD DVar1;
  
                    // 0x35220  1548  Wow64SuspendThread
                    // WARNING: Could not recover jumptable at 0x6b835226. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = Wow64SuspendThread(hThread);
  return DVar1;
}



BOOL WriteProcessMemory(HANDLE hProcess,LPVOID lpBaseAddress,LPCVOID lpBuffer,SIZE_T nSize,
                       SIZE_T *lpNumberOfBytesWritten)

{
  BOOL BVar1;
  
                    // 0x35240  1569  WriteProcessMemory
                    // WARNING: Could not recover jumptable at 0x6b835246. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = WriteProcessMemory(hProcess,lpBaseAddress,lpBuffer,nSize,lpNumberOfBytesWritten);
  return BVar1;
}



BOOL ZombifyActCtx(HANDLE hActCtx)

{
  BOOL BVar1;
  
                    // 0x35260  1575  ZombifyActCtx
                    // WARNING: Could not recover jumptable at 0x6b835266. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = ZombifyActCtx(hActCtx);
  return BVar1;
}



void lstrcmpi(char *param_1,char *param_2)

{
                    // 0x35280  1591  lstrcmpi
  FUN_6b85f7f2(param_1,param_2);
  return;
}



BOOL AddIntegrityLabelToBoundaryDescriptor(HANDLE *BoundaryDescriptor,PSID IntegrityLabel)

{
  int iVar1;
  
                    // 0x352a0  13  AddIntegrityLabelToBoundaryDescriptor
  iVar1 = RtlAddIntegrityLabelToBoundaryDescriptor(BoundaryDescriptor,IntegrityLabel);
  if (iVar1 < 0) {
    BaseSetLastNTError(iVar1);
  }
  return (uint)(iVar1 >= 0);
}



undefined4 CheckForReadOnlyResourceFilter(int **param_1)

{
  int iVar1;
  undefined4 uVar2;
  int local_8;
  
                    // 0x352d0  130  CheckForReadOnlyResourceFilter
  iVar1 = RtlQueryProtectedPolicy(&DAT_6b8848b0,&local_8);
  if (iVar1 < 0) {
    local_8 = 0;
  }
  if (local_8 == 0) {
    uVar2 = 0;
  }
  else {
    uVar2 = CheckForReadOnlyResource(param_1,0);
  }
  return uVar2;
}



HANDLE Toolhelp32ReadProcessMemory
                 (DWORD param_1,LPCVOID param_2,LPVOID param_3,SIZE_T param_4,SIZE_T *param_5)

{
  HANDLE hProcess;
  HANDLE pvVar1;
  
                    // 0x35310  1448  Toolhelp32ReadProcessMemory
  hProcess = OpenProcess(0x10,0,param_1);
  pvVar1 = hProcess;
  if (hProcess != (HANDLE)0x0) {
    pvVar1 = (HANDLE)ReadProcessMemory(hProcess,param_2,param_3,param_4,param_5);
    CloseHandle(hProcess);
  }
  return pvVar1;
}



uint __fastcall FUN_6b83534e(uint param_1)

{
  uint uVar1;
  
  if ((0xf < param_1) || (uVar1 = (&DAT_6b8b0970)[param_1], (&DAT_6b8b0970)[param_1] == 0)) {
    uVar1 = param_1;
  }
  return uVar1;
}



int __fastcall FUN_6b835361(undefined4 param_1)

{
  int iVar1;
  
  RtlAcquireSRWLockExclusive(&DAT_6b8b0920);
  iVar1 = 0;
  do {
    if ((&DAT_6b8b0970)[iVar1] == 0) break;
    iVar1 = iVar1 + 1;
  } while (iVar1 < 0x10);
  if (iVar1 < 0x10) {
    (&DAT_6b8b0970)[iVar1] = param_1;
  }
  else {
    iVar1 = -5;
  }
  RtlReleaseSRWLockExclusive(&DAT_6b8b0920);
  return iVar1;
}



INT GetExpandedNameA(LPSTR lpszSource,LPSTR lpszBuffer)

{
  HANDLE hObject;
  int iVar1;
  INT IVar2;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar3;
  undefined4 extraout_EDX_01;
  undefined8 uVar4;
  int local_b4;
  LPSTR local_b0;
  undefined4 local_ac [2];
  byte local_a3;
  _OFSTRUCT local_98;
  uint local_c;
  
                    // 0x353b0  580  GetExpandedNameA
  local_c = DAT_6b8b0140 ^ (uint)&local_b4;
  local_b0 = lpszSource;
  memset(&local_98,0,0x88);
  local_b4 = 0;
  hObject = (HANDLE)OpenFile(lpszSource,&local_98,0);
  uVar3 = extraout_EDX;
  if (hObject != (HANDLE)0xffffffff) {
    iVar1 = FUN_6b866337(local_ac,(HFILE)hObject,&local_b4);
    if ((iVar1 == 1) || (local_b4 < 0xe)) {
      CloseHandle(hObject);
      uVar4 = FUN_6b835c38(lpszBuffer,0x104,(int)local_b0);
      uVar3 = (undefined4)((ulonglong)uVar4 >> 0x20);
      if ((-1 < (int)uVar4) && (iVar1 == 1)) {
        uVar4 = FUN_6b8663e2(local_ac);
        uVar3 = (undefined4)((ulonglong)uVar4 >> 0x20);
        if ((int)uVar4 == 1) {
          FUN_6b86663b(lpszBuffer,local_a3);
          uVar3 = extraout_EDX_01;
        }
      }
    }
    else {
      CloseHandle(hObject);
      uVar3 = extraout_EDX_00;
    }
  }
  IVar2 = FUN_6b8224af(local_c ^ (uint)&local_b4,uVar3);
  return IVar2;
}



INT GetExpandedNameW(LPWSTR lpszSource,LPWSTR lpszBuffer)

{
  char cVar1;
  INT IVar2;
  char *pcVar3;
  undefined4 extraout_EDX;
  undefined4 uVar4;
  undefined8 uVar5;
  undefined auStack300 [4];
  short local_128;
  undefined2 uStack294;
  CHAR *local_124;
  undefined4 local_120;
  LPWSTR local_11c;
  CHAR local_118 [268];
  uint local_c;
  
                    // 0x35490  581  GetExpandedNameW
  local_c = DAT_6b8b0140 ^ (uint)auStack300;
  RtlInitUnicodeString(&local_120,lpszSource);
  local_128 = 0;
  uStack294 = 0x106;
  local_124 = local_118;
  uVar5 = RtlUnicodeStringToAnsiString(&local_128,&local_120,0);
  uVar4 = (undefined4)((ulonglong)uVar5 >> 0x20);
  if ((-1 < (int)uVar5) &&
     (IVar2 = GetExpandedNameA(local_118,(LPSTR)lpszBuffer), uVar4 = extraout_EDX, IVar2 != -1)) {
    uVar5 = FUN_6b835c38(local_118,0x106,(int)lpszBuffer);
    uVar4 = (undefined4)((ulonglong)uVar5 >> 0x20);
    if (-1 < (int)uVar5) {
      pcVar3 = local_118;
      do {
        cVar1 = *pcVar3;
        pcVar3 = pcVar3 + 1;
      } while (cVar1 != '\0');
      local_120 = 0x2080000;
      local_128 = (short)pcVar3 - ((short)local_118 + 1);
      local_11c = lpszBuffer;
      uVar5 = RtlAnsiStringToUnicodeString(&local_120,&local_128,0);
      uVar4 = (undefined4)((ulonglong)uVar5 >> 0x20);
    }
  }
  IVar2 = FUN_6b8224af(local_c ^ (uint)auStack300,uVar4);
  return IVar2;
}



void LZClose(INT hFile)

{
  HGLOBAL hMem;
  HANDLE hObject;
  HANDLE *ppvVar1;
  
                    // 0x35580  952  LZClose
                    // 0x35580  953  LZCloseFile
  if ((uint)hFile < 0x410) {
    if (hFile < 0x400) {
      hObject = (HANDLE)FUN_6b83534e(hFile);
      CloseHandle(hObject);
      if (hFile < 0x10) {
        (&DAT_6b8b0970)[hFile] = 0;
      }
    }
    else {
      hMem = *(HGLOBAL *)(hFile * 4 + 0x6b8af930);
      *(undefined4 *)(hFile * 4 + 0x6b8af930) = 0;
      ppvVar1 = (HANDLE *)GlobalLock(hMem);
      if (ppvVar1 != (HANDLE *)0x0) {
        CloseHandle(*ppvVar1);
        if ((HGLOBAL *)ppvVar1[0xb] != (HGLOBAL *)0x0) {
          FUN_6b8660e6((HGLOBAL *)ppvVar1[0xb]);
        }
        GlobalUnlock(hMem);
        GlobalFree(hMem);
      }
    }
  }
  return;
}



INT LZCreateFileW(int param_1,DWORD param_2,DWORD param_3,DWORD param_4,short *param_5)

{
  int iVar1;
  HANDLE hObject;
  DWORD DVar2;
  INT IVar3;
  
                    // 0x35610  955  LZCreateFileW
  iVar1 = FUN_6b8147b5((short *)&_Dst_6b8b0a50,0x106,param_1);
  if (-1 < iVar1) {
    hObject = CreateFileW((LPCWSTR)&_Dst_6b8b0a50,param_2,param_3,(LPSECURITY_ATTRIBUTES)0x0,param_4
                          ,0x80,(HANDLE)0x0);
    if (hObject == (HANDLE)0xffffffff) {
      DVar2 = GetLastError();
      if (DVar2 != 2) {
        return -1;
      }
      FUN_6b8665d1();
      hObject = CreateFileW((LPCWSTR)&_Dst_6b8b0a50,param_2,param_3,(LPSECURITY_ATTRIBUTES)0x0,
                            param_4,0x80,(HANDLE)0x0);
      if (hObject == (HANDLE)0xffffffff) {
        return -1;
      }
    }
    if (param_4 != 3) {
      iVar1 = FUN_6b835361(hObject);
      if (iVar1 == -5) {
        CloseHandle(hObject);
        return -5;
      }
      return iVar1;
    }
    IVar3 = LZInit((INT)hObject);
    if (IVar3 < 0) {
      CloseHandle(hObject);
    }
    if (param_5 == (short *)0x0) {
      return IVar3;
    }
    iVar1 = FUN_6b8147b5(param_5,0x104,(int)&_Dst_6b8b0a50);
    if (-1 < iVar1) {
      return IVar3;
    }
  }
  return -7;
}



INT LZInit(INT hfSource)

{
  int iVar1;
  int iVar2;
  int iVar3;
  LONG LVar4;
  HGLOBAL hMem;
  INT *pIVar5;
  INT IVar6;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 uVar7;
  undefined8 uVar8;
  int local_20;
  undefined4 local_1c [2];
  char local_14;
  INT local_10;
  INT local_c;
  uint local_8;
  
                    // 0x356e0  957  LZInit
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_20 = 0;
  uVar8 = FUN_6b866337(local_1c,hfSource,&local_20);
  uVar7 = (undefined4)((ulonglong)uVar8 >> 0x20);
  if ((int)uVar8 == 1) {
    uVar8 = FUN_6b8663e2(local_1c);
    uVar7 = (undefined4)((ulonglong)uVar8 >> 0x20);
    if ((int)uVar8 == 1) {
      if (local_14 == 'A') {
        RtlAcquireSRWLockExclusive(&DAT_6b8b0920);
        iVar3 = DAT_6b8b09b0;
        iVar1 = (&DAT_6b8b0930)[DAT_6b8b09b0];
        iVar2 = DAT_6b8b09b0;
        while (iVar1 != 0) {
          DAT_6b8b09b0 = iVar2 + 1;
          if (0xf < DAT_6b8b09b0) {
            DAT_6b8b09b0 = 0;
          }
          if (DAT_6b8b09b0 == iVar3) goto LAB_6b8357fd;
          iVar2 = DAT_6b8b09b0;
          iVar1 = (&DAT_6b8b0930)[DAT_6b8b09b0];
        }
        DAT_6b8b09b0 = iVar2;
        hMem = GlobalAlloc(0x42,0x30);
        if (hMem != (HGLOBAL)0x0) {
          pIVar5 = (INT *)GlobalLock(hMem);
          if (pIVar5 == (INT *)0x0) {
            GlobalFree(hMem);
          }
          else {
            *pIVar5 = hfSource;
            *(undefined2 *)((int)pIVar5 + 6) = 0;
            pIVar5[2] = local_10;
            *(undefined *)(pIVar5 + 1) = 0x41;
            pIVar5[3] = local_c;
            pIVar5[10] = 0;
            pIVar5[0xb] = 0;
            (&DAT_6b8b0930)[iVar2] = hMem;
            GlobalUnlock(hMem);
            DAT_6b8b09b0 = DAT_6b8b09b0 + 1;
            if (0xf < DAT_6b8b09b0) {
              DAT_6b8b09b0 = 0;
            }
          }
        }
LAB_6b8357fd:
        RtlReleaseSRWLockExclusive(&DAT_6b8b0920);
        uVar7 = extraout_EDX_00;
      }
      goto LAB_6b835814;
    }
  }
  else if (0xd < local_20) goto LAB_6b835814;
  LVar4 = _llseek(hfSource,0,0);
  uVar7 = extraout_EDX;
  if (LVar4 == 0) {
    FUN_6b835361(hfSource);
    uVar7 = extraout_EDX_01;
  }
LAB_6b835814:
  IVar6 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar7);
  return IVar6;
}



INT LZOpenFileA(LPSTR lpFileName,LPOFSTRUCT lpReOpenBuf,WORD wStyle)

{
  HANDLE hObject;
  int iVar1;
  INT IVar2;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 uVar3;
  undefined8 uVar4;
  uint local_11c;
  char local_118 [268];
  uint local_c;
  
                    // 0x35830  958  LZOpenFileA
  local_c = DAT_6b8b0140 ^ (uint)&local_11c;
  uVar4 = FUN_6b835c38(local_118,0x106,(int)lpFileName);
  uVar3 = (undefined4)((ulonglong)uVar4 >> 0x20);
  if ((int)uVar4 < 0) goto LAB_6b8358e1;
  local_11c = (uint)wStyle;
  hObject = (HANDLE)OpenFile(local_118,lpReOpenBuf,local_11c);
  if (hObject == (HANDLE)0xffffffff) {
    uVar3 = extraout_EDX;
    if (lpReOpenBuf->nErrCode != 2) goto LAB_6b8358e1;
    FUN_6b86654f(local_118);
    hObject = (HANDLE)OpenFile(local_118,lpReOpenBuf,local_11c);
    uVar3 = extraout_EDX_00;
    if (hObject == (HANDLE)0xffffffff) goto LAB_6b8358e1;
  }
  if ((wStyle & 0xff0f) == 0) {
    IVar2 = LZInit((INT)hObject);
    uVar3 = extraout_EDX_02;
    if (-1 < IVar2) goto LAB_6b8358e1;
  }
  else {
    iVar1 = FUN_6b835361(hObject);
    uVar3 = extraout_EDX_01;
    if (iVar1 != -5) goto LAB_6b8358e1;
  }
  CloseHandle(hObject);
  uVar3 = extraout_EDX_03;
LAB_6b8358e1:
  IVar2 = FUN_6b8224af(local_c ^ (uint)&local_11c,uVar3);
  return IVar2;
}



INT LZOpenFileW(LPWSTR lpFileName,LPOFSTRUCT lpReOpenBuf,WORD wStyle)

{
  INT IVar1;
  undefined4 extraout_EDX;
  undefined4 uVar2;
  undefined8 uVar3;
  undefined auStack300 [4];
  undefined4 local_128;
  CHAR *local_124;
  undefined local_120 [8];
  CHAR local_118 [268];
  uint local_c;
  
                    // 0x35900  959  LZOpenFileW
  local_c = DAT_6b8b0140 ^ (uint)auStack300;
  RtlInitUnicodeString(local_120,lpFileName);
  local_128 = 0x1040000;
  local_124 = local_118;
  uVar3 = RtlUnicodeStringToAnsiString(&local_128,local_120,0);
  uVar2 = (undefined4)((ulonglong)uVar3 >> 0x20);
  if (-1 < (int)uVar3) {
    LZOpenFileA(local_118,lpReOpenBuf,wStyle);
    uVar2 = extraout_EDX;
  }
  IVar1 = FUN_6b8224af(local_c ^ (uint)auStack300,uVar2);
  return IVar1;
}



INT LZRead(INT hFile,CHAR *lpBuffer,INT cbRead)

{
  HGLOBAL hMem;
  HGLOBAL pvVar1;
  uint hFile_00;
  HFILE *pHVar2;
  HGLOBAL *ppvVar3;
  HGLOBAL pvVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int local_20;
  CHAR *local_18;
  UINT local_14;
  uint local_10;
  int local_c;
  int local_8;
  
                    // 0x35990  960  LZRead
  local_14 = 0;
  if ((uint)hFile < 0x410) {
    local_c = cbRead;
    if (cbRead < 0) {
      local_14 = 0xfffffff9;
    }
    else if (hFile < 0x400) {
      hFile_00 = FUN_6b83534e(hFile);
      local_14 = _hread(hFile_00,lpBuffer,cbRead);
    }
    else {
      hMem = *(HGLOBAL *)(hFile * 4 + 0x6b8af930);
      pHVar2 = (HFILE *)GlobalLock(hMem);
      if (pHVar2 == (HFILE *)0x0) {
        local_14 = 0xfffffffa;
      }
      else {
        ppvVar3 = (HGLOBAL *)pHVar2[0xb];
        if (ppvVar3 == (HGLOBAL *)0x0) {
          ppvVar3 = FUN_6b86612e((HGLOBAL)0x400,(HGLOBAL)0x402);
          pHVar2[0xb] = (HFILE)ppvVar3;
          if (ppvVar3 == (HGLOBAL *)0x0) {
            iVar7 = -5;
LAB_6b835b87:
            GlobalUnlock(hMem);
            return iVar7;
          }
          ppvVar3[7] = (HGLOBAL)0x0;
          pvVar4 = (HGLOBAL)((int)ppvVar3[1] + (int)ppvVar3[0xb] + 1);
          ppvVar3[2] = pvVar4;
          ppvVar3[3] = pvVar4;
          ppvVar3[6] = ppvVar3[4];
          ppvVar3[10] = (HGLOBAL)0x0;
          ppvVar3[5] = (HGLOBAL)((int)ppvVar3[0xc] + (int)ppvVar3[4]);
        }
        pvVar4 = ppvVar3[5];
        pvVar1 = ppvVar3[4];
        iVar7 = ((int)ppvVar3[4] - (int)ppvVar3[6]) + (int)ppvVar3[10];
        if ((*(ushort *)((int)pHVar2 + 6) & 1) == 0) {
          local_10 = 1;
          *(ushort *)((int)pHVar2 + 6) = *(ushort *)((int)pHVar2 + 6) | 1;
        }
        else {
          local_10 = (uint)(pHVar2[10] < iVar7);
        }
        local_18 = lpBuffer;
        local_20 = iVar7;
        if (0 < cbRead) {
          while (pHVar2[10] < pHVar2[2]) {
            iVar6 = pHVar2[10] - iVar7;
            iVar5 = (int)ppvVar3[6] - (int)ppvVar3[4];
            if ((int)pvVar4 - (int)pvVar1 <= iVar6) {
              iVar6 = -1;
            }
            if (-1 < iVar6) {
              local_8 = 0;
              if (iVar6 < iVar5) {
                local_8 = 0;
                do {
                  iVar7 = local_20;
                  if (cbRead < 1) break;
                  *local_18 = *(CHAR *)(iVar6 + (int)ppvVar3[4]);
                  local_18 = local_18 + 1;
                  iVar6 = iVar6 + 1;
                  local_8 = local_8 + 1;
                  cbRead = local_c + -1;
                  local_c = cbRead;
                } while (iVar6 < iVar5);
              }
              pHVar2[10] = pHVar2[10] + local_8;
              local_14 = local_14 + local_8;
              cbRead = local_c;
            }
            iVar6 = pHVar2[10];
            if (cbRead < 1) break;
            if (iVar6 < pHVar2[2]) {
              if (local_10 == 0) {
                local_8 = (iVar5 - (int)ppvVar3[8]) + ((int)pvVar4 - (int)pvVar1) + iVar7;
              }
              else {
                local_8 = iVar6 - (int)ppvVar3[8];
                if (local_8 < 0) {
                  local_8 = 0;
                }
              }
              iVar6 = cbRead + iVar6;
              iVar5 = pHVar2[2] + -1;
              iVar7 = iVar6;
              if (iVar5 <= iVar6) {
                iVar7 = iVar5;
              }
              if ((iVar7 <= local_8) && (local_8 = iVar6, iVar5 <= iVar6)) {
                local_8 = iVar5;
              }
              ppvVar3[6] = ppvVar3[4];
              if (*(char *)(pHVar2 + 1) != 'A') {
                iVar7 = -8;
                goto LAB_6b835b87;
              }
              iVar7 = FUN_6b8667a1(*pHVar2,-2,local_8,local_10,local_8,(int *)ppvVar3);
              if (iVar7 < 0) goto LAB_6b835b87;
              if (((int)ppvVar3[6] - (int)ppvVar3[4] < 1) ||
                 (iVar7 = (int)ppvVar3[10] - ((int)ppvVar3[6] - (int)ppvVar3[4]),
                 (int)ppvVar3[10] < local_8)) {
                iVar7 = -3;
                goto LAB_6b835b87;
              }
              local_10 = 0;
              cbRead = local_c;
              local_20 = iVar7;
            }
          }
        }
        GlobalUnlock(hMem);
      }
    }
  }
  else {
    local_14 = 0xffffffff;
  }
  return local_14;
}



LONG LZSeek(INT hFile,LONG lOffset,INT iOrigin)

{
  HGLOBAL hMem;
  uint hFile_00;
  LONG LVar1;
  LPVOID pvVar2;
  int iVar3;
  
                    // 0x35bb0  961  LZSeek
  if (0x40f < (uint)hFile) {
    return -1;
  }
  if (hFile < 0x400) {
    hFile_00 = FUN_6b83534e(hFile);
    LVar1 = _llseek(hFile_00,lOffset,iOrigin);
    return LVar1;
  }
  hMem = *(HGLOBAL *)(hFile * 4 + 0x6b8af930);
  pvVar2 = GlobalLock(hMem);
  if (pvVar2 == (LPVOID)0x0) {
    return -6;
  }
  if (iOrigin == 0) {
    iVar3 = 0;
  }
  else if (iOrigin == 1) {
    iVar3 = *(int *)((int)pvVar2 + 0x28);
  }
  else {
    if (iOrigin != 2) goto LAB_6b835c25;
    iVar3 = *(int *)((int)pvVar2 + 8);
  }
  iVar3 = iVar3 + lOffset;
  if (-1 < iVar3) {
    *(int *)((int)pvVar2 + 0x28) = iVar3;
    GlobalUnlock(hMem);
    return iVar3;
  }
LAB_6b835c25:
  GlobalUnlock(hMem);
  return -7;
}



void __fastcall FUN_6b835c38(char *param_1,uint param_2,int param_3)

{
  int iVar1;
  
  iVar1 = 0;
  if ((param_2 == 0) || (0x7fffffff < param_2)) {
    iVar1 = -0x3ffffff3;
  }
  if (iVar1 < 0) {
    if (param_2 != 0) {
      *param_1 = '\0';
    }
  }
  else {
    FUN_6b835c6b(param_1,param_2,param_1,param_3);
  }
  return;
}



int __fastcall FUN_6b835c6b(char *param_1,int param_2,undefined4 param_3,int param_4)

{
  int iVar1;
  int iVar2;
  
  if (param_2 != 0) {
    iVar2 = 0x7ffffffe;
    iVar1 = param_4 - (int)param_1;
    do {
      if ((iVar2 == 0) || (param_1[iVar1] == '\0')) break;
      *param_1 = param_1[iVar1];
      param_1 = param_1 + 1;
      iVar2 = iVar2 + -1;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
    if (param_2 != 0) goto LAB_6b835c9b;
  }
  param_1 = param_1 + -1;
LAB_6b835c9b:
  *param_1 = '\0';
  return (-(uint)(param_2 != 0) & 0x7ffffffb) + 0x80000005;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL CommConfigDialogA(LPCSTR lpszName,HWND hWnd,LPCOMMCONFIG lpCC)

{
  int iVar1;
  BOOL BVar2;
  undefined4 *in_FS_OFFSET;
  undefined local_30 [8];
  undefined local_28 [4];
  LPCWSTR local_24;
  BOOL local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x35cc0  154  CommConfigDialogA
  local_8 = &DAT_6b891eb8;
  uStack12 = 0x6b835ccc;
  iVar1 = RtlInitAnsiStringEx(local_30,lpszName);
  if (-1 < iVar1) {
    iVar1 = RtlAnsiStringToUnicodeString(local_28,local_30,1);
    if (-1 < iVar1) {
      local_20 = 0;
      local_8 = (undefined *)0x0;
      BVar2 = CommConfigDialogW(local_24,hWnd,lpCC);
      local_8 = (undefined *)0xfffffffe;
      local_20 = BVar2;
      FUN_6b835d39();
      goto LAB_6b835d24;
    }
  }
  BaseSetLastNTError(iVar1);
  BVar2 = 0;
LAB_6b835d24:
  *in_FS_OFFSET = local_14;
  return BVar2;
}



void FUN_6b835d39(void)

{
  int unaff_EBP;
  
  RtlFreeUnicodeString(unaff_EBP + -0x24);
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL CommConfigDialogW(LPCWSTR lpszName,HWND hWnd,LPCOMMCONFIG lpCC)

{
  FARPROC pFVar1;
  undefined4 *in_FS_OFFSET;
  undefined4 local_30;
  LPCWSTR local_2c;
  HMODULE local_28;
  BOOL local_24;
  DWORD local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x35d50  155  CommConfigDialogW
  local_8 = &DAT_6b891ed8;
  uStack12 = 0x6b835d5c;
  local_30 = 0;
  local_2c = (LPCWSTR)0x0;
  local_24 = 1;
  local_28 = (HMODULE)0x0;
  local_20 = 0;
  FUN_6b836077(lpszName,(undefined2 *)&local_30);
  local_8 = (undefined *)0x0;
  if (local_2c != (LPCWSTR)0x0) {
    local_28 = LoadLibraryW(local_2c);
    if (local_28 != (HMODULE)0x0) {
      pFVar1 = GetProcAddress(local_28,"drvCommConfigDialogW");
      if (pFVar1 == (FARPROC)0x0) {
        local_24 = 0;
        local_20 = GetLastError();
      }
      else {
        _guard_check_icall();
        local_20 = (*pFVar1)(lpszName,hWnd,lpCC);
      }
      goto LAB_6b835ddf;
    }
    local_20 = GetLastError();
  }
  local_24 = 0;
LAB_6b835ddf:
  local_8 = (undefined *)0xfffffffe;
  FUN_6b835e08();
  *in_FS_OFFSET = local_14;
  return local_24;
}



void FUN_6b835e08(void)

{
  HMODULE unaff_EBX;
  int unaff_EBP;
  int unaff_ESI;
  undefined4 unaff_EDI;
  int in_FS_OFFSET;
  
  if (*(int *)(unaff_EBP + -0x28) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EDI,
                *(int *)(unaff_EBP + -0x28));
    unaff_EBX = *(HMODULE *)(unaff_EBP + -0x24);
    unaff_ESI = *(int *)(unaff_EBP + -0x1c);
  }
  if (unaff_EBX != (HMODULE)0x0) {
    FreeLibrary(unaff_EBX);
  }
  if (unaff_ESI != 0) {
    RtlSetLastWin32Error(unaff_ESI);
    *(undefined4 *)(unaff_EBP + -0x20) = unaff_EDI;
  }
  return;
}



undefined4 FUN_6b835e40(undefined4 param_1,int param_2,void *param_3,size_t param_4,short *param_5)

{
  undefined4 uVar1;
  undefined4 *puVar2;
  void *_Dst;
  int in_FS_OFFSET;
  
  if (param_2 == 1) {
    RtlInitUnicodeString(param_5,0);
    puVar2 = (undefined4 *)KernelBaseGetGlobalData();
    _Dst = (void *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar2,
                                   param_4);
    *(void **)(param_5 + 2) = _Dst;
    if (_Dst == (void *)0x0) {
      uVar1 = 0xc000009a;
    }
    else {
      memcpy(_Dst,param_3,param_4);
      param_5[1] = (short)param_4;
      *param_5 = (short)param_4 + -2;
      uVar1 = 0;
    }
  }
  else {
    uVar1 = 0xc000000d;
  }
  return uVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL GetDefaultCommConfigA(LPCSTR lpszName,LPCOMMCONFIG lpCC,LPDWORD lpdwSize)

{
  int iVar1;
  BOOL BVar2;
  undefined4 *in_FS_OFFSET;
  undefined local_30 [8];
  undefined local_28 [4];
  LPCWSTR local_24;
  BOOL local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x35eb0  553  GetDefaultCommConfigA
  local_8 = &DAT_6b891e78;
  uStack12 = 0x6b835ebc;
  local_20 = 0;
  iVar1 = RtlInitAnsiStringEx(local_30,lpszName);
  if (-1 < iVar1) {
    iVar1 = RtlAnsiStringToUnicodeString(local_28,local_30,1);
    if (-1 < iVar1) {
      local_8 = (undefined *)0x0;
      BVar2 = GetDefaultCommConfigW(local_24,lpCC,lpdwSize);
      local_8 = (undefined *)0xfffffffe;
      local_20 = BVar2;
      FUN_6b835f29();
      goto LAB_6b835f14;
    }
  }
  BaseSetLastNTError(iVar1);
  BVar2 = 0;
LAB_6b835f14:
  *in_FS_OFFSET = local_14;
  return BVar2;
}



void FUN_6b835f29(void)

{
  int unaff_EBP;
  
  RtlFreeUnicodeString(unaff_EBP + -0x24);
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL GetDefaultCommConfigW(LPCWSTR lpszName,LPCOMMCONFIG lpCC,LPDWORD lpdwSize)

{
  FARPROC pFVar1;
  undefined4 *in_FS_OFFSET;
  undefined4 local_30;
  LPCWSTR local_2c;
  HMODULE local_28;
  BOOL local_24;
  DWORD local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x35f40  554  GetDefaultCommConfigW
  local_8 = &DAT_6b891e98;
  uStack12 = 0x6b835f4c;
  local_30 = 0;
  local_2c = (LPCWSTR)0x0;
  local_24 = 1;
  local_28 = (HMODULE)0x0;
  local_20 = 0;
  FUN_6b836077(lpszName,(undefined2 *)&local_30);
  local_8 = (undefined *)0x0;
  if (local_2c != (LPCWSTR)0x0) {
    local_28 = LoadLibraryW(local_2c);
    if (local_28 != (HMODULE)0x0) {
      pFVar1 = GetProcAddress(local_28,"drvGetDefaultCommConfigW");
      if (pFVar1 != (FARPROC)0x0) {
        _guard_check_icall();
        local_20 = (*pFVar1)(lpszName,lpCC,lpdwSize);
        goto LAB_6b835fc4;
      }
    }
    local_20 = GetLastError();
  }
  local_24 = 0;
LAB_6b835fc4:
  local_8 = (undefined *)0xfffffffe;
  FUN_6b835fed();
  *in_FS_OFFSET = local_14;
  return local_24;
}



void FUN_6b835fed(void)

{
  HMODULE unaff_EBX;
  int unaff_EBP;
  int unaff_ESI;
  undefined4 unaff_EDI;
  int in_FS_OFFSET;
  
  if (*(int *)(unaff_EBP + -0x28) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EDI,
                *(int *)(unaff_EBP + -0x28));
    unaff_EBX = *(HMODULE *)(unaff_EBP + -0x24);
    unaff_ESI = *(int *)(unaff_EBP + -0x1c);
  }
  if (unaff_EBX != (HMODULE)0x0) {
    FreeLibrary(unaff_EBX);
  }
  if (unaff_ESI != 0) {
    RtlSetLastWin32Error(unaff_ESI);
    *(undefined4 *)(unaff_EBP + -0x20) = unaff_EDI;
  }
  return;
}



undefined4
FUN_6b836030(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
            undefined4 *param_5)

{
  char cVar1;
  undefined local_14 [8];
  undefined local_c [8];
  
  RtlInitUnicodeString(local_14,param_5[1]);
  RtlInitUnicodeString(local_c,param_3);
  cVar1 = RtlEqualUnicodeString(local_14,local_c,1);
  if (cVar1 != '\0') {
    *param_5 = 1;
  }
  return 0;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

void __fastcall FUN_6b836077(undefined4 param_1,undefined2 *param_2)

{
  short sVar1;
  HMODULE hModule;
  int iVar2;
  undefined4 *puVar3;
  short *psVar4;
  undefined4 *puVar5;
  undefined4 *in_FS_OFFSET;
  uint uVar6;
  undefined4 uVar7;
  uint *puVar8;
  undefined4 uVar9;
  wchar_t *pwVar10;
  FARPROC *ppFVar11;
  undefined4 uVar12;
  undefined4 uVar13;
  code *local_80;
  undefined4 local_7c;
  wchar_t *local_78;
  int local_48;
  undefined4 local_44;
  HMODULE local_40;
  undefined2 *local_3c;
  FARPROC local_38;
  uint local_34;
  FARPROC local_30;
  short *local_2c;
  uint local_28;
  short *local_24;
  FARPROC local_20 [3];
  undefined4 local_14 [2];
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b891ef8;
  uStack12 = 0x6b836083;
  local_3c = param_2;
  memset(&local_80,0,0x38);
  local_48 = 0;
  local_80 = FUN_6b836030;
  local_7c = 4;
  local_44 = param_1;
  hModule = LoadLibraryW(L"cfgmgr32.dll");
  local_40 = hModule;
  if (hModule != (HMODULE)0x0) {
    local_8 = (undefined *)0x0;
    local_20[0] = GetProcAddress(hModule,"CM_Get_Device_ID_List_SizeW");
    local_2c = (short *)GetProcAddress(hModule,"CM_Get_Device_ID_ListW");
    local_30 = GetProcAddress(hModule,"CM_Locate_DevNodeW");
    local_38 = GetProcAddress(hModule,"CM_Open_DevNode_Key");
    if ((((local_20[0] != (FARPROC)0x0) && (local_2c != (short *)0x0)) && (local_30 != (FARPROC)0x0)
        ) && (local_38 != (FARPROC)0x0)) {
      local_24 = (short *)0x0;
      local_28 = 0;
      uVar12 = 2;
      pwVar10 = L"MODEM";
      puVar8 = &local_28;
      _guard_check_icall();
      iVar2 = (*local_20[0])(puVar8,pwVar10,uVar12);
      if (iVar2 == 0) {
        uVar6 = local_28 + 2;
        if ((local_28 < uVar6) && (local_34 = uVar6 * 2, uVar6 < local_34)) {
          puVar3 = (undefined4 *)KernelBaseGetGlobalData();
          local_24 = (short *)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),*puVar3,
                                              local_34);
        }
        if (local_24 != (short *)0x0) {
          local_8 = (undefined *)0x1;
          uVar12 = 2;
          pwVar10 = L"modem";
          psVar4 = local_24;
          uVar6 = local_28;
          _guard_check_icall();
          iVar2 = (*(code *)local_2c)(pwVar10,psVar4,uVar6,uVar12);
          psVar4 = local_24;
          if (iVar2 == 0) {
            for (; local_2c = psVar4, *psVar4 != 0;
                psVar4 = local_2c + ((int)psVar4 - (int)(local_2c + 1) >> 1) + 1) {
              local_34 = 0;
              uVar12 = 0;
              puVar8 = &local_34;
              _guard_check_icall();
              iVar2 = (*local_30)(puVar8,psVar4,uVar12);
              if (iVar2 == 0) {
                uVar13 = 1;
                ppFVar11 = local_20;
                uVar9 = 0;
                uVar7 = 0;
                uVar12 = 0xf003f;
                uVar6 = local_34;
                _guard_check_icall();
                iVar2 = (*local_38)(uVar6,uVar12,uVar7,uVar9,ppFVar11,uVar13);
                if (iVar2 == 0) {
                  local_48 = 0;
                  local_78 = L"FriendlyName";
                  iVar2 = RtlQueryRegistryValuesEx(0x40000000,local_20[0],&local_80,&local_48,0);
                  if ((-1 < iVar2) && (local_48 != 0)) {
                    local_80 = FUN_6b835e40;
                    local_78 = L"ConfigDialog";
                    iVar2 = RtlQueryRegistryValuesEx(0x40000000,local_20[0],&local_80,param_2,0);
                    local_80 = FUN_6b836030;
                    if (iVar2 < 0) {
                      BaseSetLastNTError(iVar2);
                      CloseHandle(local_20[0]);
                    }
                    else {
                      CloseHandle(local_20[0]);
                      if (*(int *)(param_2 + 2) == 0) goto LAB_6b83629c;
                    }
                    __local_unwind4(&DAT_6b8b0140,(int)local_14,0xfffffffe);
                    goto LAB_6b83637f;
                  }
                  CloseHandle(local_20[0]);
                }
              }
LAB_6b83629c:
              psVar4 = local_2c;
              do {
                sVar1 = *psVar4;
                psVar4 = psVar4 + 1;
              } while (sVar1 != 0);
            }
          }
          local_8 = (undefined *)0x0;
          FUN_6b836338();
        }
      }
    }
    local_8 = (undefined *)0xfffffffe;
    FUN_6b836355();
  }
  if (*(int *)(param_2 + 2) == 0) {
    local_78 = (wchar_t *)0x0;
    iVar2 = RtlQueryRegistryValuesEx(4,L"SERIALCOMM",&local_80,&local_48,0);
    if ((iVar2 < 0) || (local_48 == 0)) {
      RtlSetLastWin32Error(0x57);
    }
    else {
      puVar3 = (undefined4 *)KernelBaseGetGlobalData();
      puVar3 = (undefined4 *)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),*puVar3,0x1a)
      ;
      *(undefined4 **)(param_2 + 2) = puVar3;
      if (puVar3 == (undefined4 *)0x0) {
        BaseSetLastNTError(0xc000009a);
      }
      else {
        param_2[1] = 0x1a;
        *param_2 = 0x18;
        puVar5 = (undefined4 *)L"serialui.dll";
        for (iVar2 = 6; iVar2 != 0; iVar2 = iVar2 + -1) {
          *puVar3 = *puVar5;
          puVar5 = puVar5 + 1;
          puVar3 = puVar3 + 1;
        }
        *(undefined2 *)puVar3 = *(undefined2 *)puVar5;
      }
    }
  }
LAB_6b83637f:
  *in_FS_OFFSET = local_14[0];
  return;
}



void FUN_6b836338(void)

{
  int unaff_EBP;
  undefined4 unaff_EDI;
  int in_FS_OFFSET;
  
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EDI,
              *(undefined4 *)(unaff_EBP + -0x20));
  return;
}



void FUN_6b836355(void)

{
  HMODULE unaff_ESI;
  
  FreeLibrary(unaff_ESI);
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL SetDefaultCommConfigA(LPCSTR lpszName,LPCOMMCONFIG lpCC,DWORD dwSize)

{
  int iVar1;
  BOOL BVar2;
  undefined4 *in_FS_OFFSET;
  undefined local_30 [8];
  undefined local_28 [4];
  LPCWSTR local_24;
  BOOL local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x363a0  1294  SetDefaultCommConfigA
  local_8 = &DAT_6b891e38;
  uStack12 = 0x6b8363ac;
  local_20 = 1;
  iVar1 = RtlInitAnsiStringEx(local_30,lpszName);
  if (-1 < iVar1) {
    iVar1 = RtlAnsiStringToUnicodeString(local_28,local_30,1);
    if (-1 < iVar1) {
      local_8 = (undefined *)0x0;
      BVar2 = SetDefaultCommConfigW(local_24,lpCC,dwSize);
      local_8 = (undefined *)0xfffffffe;
      local_20 = BVar2;
      FUN_6b83641a();
      goto LAB_6b836405;
    }
  }
  BaseSetLastNTError(iVar1);
  BVar2 = 0;
LAB_6b836405:
  *in_FS_OFFSET = local_14;
  return BVar2;
}



void FUN_6b83641a(void)

{
  int unaff_EBP;
  
  RtlFreeUnicodeString(unaff_EBP + -0x24);
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL SetDefaultCommConfigW(LPCWSTR lpszName,LPCOMMCONFIG lpCC,DWORD dwSize)

{
  FARPROC pFVar1;
  undefined4 *in_FS_OFFSET;
  undefined4 local_30;
  LPCWSTR local_2c;
  HMODULE local_28;
  BOOL local_24;
  DWORD local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x36430  1295  SetDefaultCommConfigW
  local_8 = &DAT_6b891e58;
  uStack12 = 0x6b83643c;
  local_30 = 0;
  local_2c = (LPCWSTR)0x0;
  local_24 = 1;
  local_28 = (HMODULE)0x0;
  local_20 = 0;
  FUN_6b836077(lpszName,(undefined2 *)&local_30);
  local_8 = (undefined *)0x0;
  if (local_2c != (LPCWSTR)0x0) {
    local_28 = LoadLibraryW(local_2c);
    if (local_28 != (HMODULE)0x0) {
      pFVar1 = GetProcAddress(local_28,"drvSetDefaultCommConfigW");
      if (pFVar1 == (FARPROC)0x0) {
        local_24 = 0;
        local_20 = GetLastError();
      }
      else {
        _guard_check_icall();
        local_20 = (*pFVar1)(lpszName,lpCC,dwSize);
      }
      goto LAB_6b8364bf;
    }
    local_20 = GetLastError();
  }
  local_24 = 0;
LAB_6b8364bf:
  local_8 = (undefined *)0xfffffffe;
  FUN_6b8364e8();
  *in_FS_OFFSET = local_14;
  return local_24;
}



void FUN_6b8364e8(void)

{
  HMODULE unaff_EBX;
  int unaff_EBP;
  int unaff_ESI;
  undefined4 unaff_EDI;
  int in_FS_OFFSET;
  
  if (*(int *)(unaff_EBP + -0x28) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EDI,
                *(int *)(unaff_EBP + -0x28));
    unaff_EBX = *(HMODULE *)(unaff_EBP + -0x24);
    unaff_ESI = *(int *)(unaff_EBP + -0x1c);
  }
  if (unaff_EBX != (HMODULE)0x0) {
    FreeLibrary(unaff_EBX);
  }
  if (unaff_ESI != 0) {
    RtlSetLastWin32Error(unaff_ESI);
    *(undefined4 *)(unaff_EBP + -0x20) = unaff_EDI;
  }
  return;
}



void __fastcall FUN_6b836520(undefined4 param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined8 uVar2;
  undefined local_210 [8];
  undefined local_208 [56];
  uint local_1d0;
  undefined4 local_1cc;
  undefined4 local_1c8;
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)local_210;
  uVar2 = NtQueryEvent(param_1,0,local_210,8,0);
  uVar1 = (undefined4)((ulonglong)uVar2 >> 0x20);
  if (-1 < (int)uVar2) {
    local_1d0 = FUN_6b838215();
    local_1cc = param_1;
    uVar2 = CsrClientCallServer(local_208,0,0x1001000a,0xc);
    uVar1 = (undefined4)((ulonglong)uVar2 >> 0x20);
    if (-1 < (int)uVar2) {
      *param_2 = local_1c8;
    }
  }
  FUN_6b8224af(local_c ^ (uint)local_210,uVar1);
  return;
}



int __fastcall
FUN_6b83659e(uint param_1,LPCWSTR param_2,wchar_t *param_3,LPCWSTR param_4,ushort *param_5,
            int param_6,undefined4 *param_7,uint param_8,int param_9,int param_10)

{
  bool bVar1;
  int iVar2;
  int in_FS_OFFSET;
  undefined *local_28 [2];
  undefined local_20 [8];
  undefined local_18 [4];
  undefined4 local_14;
  int local_10;
  undefined4 local_c;
  DWORD local_8;
  
  bVar1 = false;
  local_c = 0;
  local_8 = 0;
  if (((param_1 & 0xfffffff0) == 0x10) &&
     (iVar2 = FUN_6b838d45(param_2,&local_c,&local_8), iVar2 != 0)) {
    FUN_6b8392ab(param_2,0x14,local_c,local_8);
    local_10 = -0x3ffffefe;
  }
  else {
    local_10 = FUN_6b8366bd(param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8,param_9,
                            param_10);
    if (local_10 == -0x3fffffde) {
      local_14 = *(undefined4 *)(param_9 + 8);
      *(undefined4 *)(param_9 + 8) =
           *(undefined4 *)(*(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x10) + 0x7c);
      local_10 = FUN_6b8366bd(param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8,
                              param_9,param_10);
      if (local_10 < 0) {
        *(undefined4 *)(param_9 + 8) = local_14;
      }
      if ((param_1 == 0x20) && (local_10 == -0x3fffffde)) {
        return -0x3fffffde;
      }
    }
    else if (local_10 == -0x3ffffbec) {
      bVar1 = true;
    }
    FUN_6b8392ab(param_2,param_1,local_c,local_8);
    if (bVar1) {
      RtlInitUnicodeString(local_20,param_2);
      local_28[0] = local_20;
      NtRaiseHardError(0xc0000414,1,1,local_28,1,local_18);
    }
  }
  return local_10;
}



// WARNING: Function: __SEH_prolog4_GS replaced with injection: SEH_prolog4
// WARNING: Could not reconcile some variable overlaps

int __fastcall
FUN_6b8366bd(uint param_1,LPCWSTR param_2,wchar_t *param_3,LPCWSTR param_4,ushort *param_5,
            int param_6,undefined4 *param_7,uint param_8,int param_9,int param_10)

{
  short *psVar1;
  void **ppvVar2;
  char cVar3;
  WCHAR WVar4;
  HANDLE pvVar5;
  undefined4 *puVar6;
  ushort *puVar7;
  wchar_t wVar8;
  short sVar9;
  BOOL BVar10;
  uint uVar11;
  int *piVar12;
  LPWSTR lpszShortPath;
  LPCWSTR pWVar13;
  wchar_t *pwVar14;
  UINT UVar15;
  char *pcVar16;
  wchar_t *pwVar17;
  short *psVar18;
  int iVar19;
  uint uVar20;
  DWORD DVar21;
  int iVar22;
  undefined4 *in_FS_OFFSET;
  bool bVar23;
  undefined4 local_2d8;
  undefined4 local_2d4;
  ushort *local_2d0;
  LPCWSTR local_2cc;
  int local_2c8;
  wchar_t *local_2c4;
  DWORD local_2c0;
  wchar_t *local_2bc;
  LPWSTR local_2b8;
  int local_2b4;
  uint local_2b0;
  ushort local_2ac [2];
  void *local_2a8;
  ushort local_2a4 [2];
  void *local_2a0;
  ushort local_29c [2];
  void *local_298;
  uint local_294;
  void *local_290;
  uint local_28c;
  char *local_288;
  wchar_t *local_284;
  uint local_280;
  void *local_27c;
  uint local_278;
  char *local_274;
  LPWSTR local_270;
  LPCWSTR local_26c;
  int local_268;
  int local_264;
  wchar_t *local_260;
  wchar_t *local_25c;
  wchar_t *local_258;
  ushort local_254;
  short local_252;
  wchar_t *local_250;
  wchar_t *local_24c;
  char local_245;
  DWORD local_244;
  int local_240;
  WCHAR local_23c [264];
  undefined4 local_2c;
  undefined4 uStack40;
  undefined2 uStack36;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b891f40;
  uStack12 = 0x6b8366cc;
  local_2c4 = param_3;
  local_2cc = param_4;
  local_2d0 = param_5;
  local_268 = param_9;
  local_2c8 = param_10;
  local_240 = 0xc0000001;
  local_2c = 0x70002e;
  uStack40 = 0x660069;
  uStack36 = 0;
  local_2bc = (wchar_t *)0x0;
  local_2d8 = 0;
  local_2d4 = 0;
  local_26c = param_2;
  if ((param_5 == (ushort *)0x0) || (0x8000 < *param_5)) {
    local_2b0 = param_1;
    BaseSetLastNTError(0xc000000d);
    local_240 = -0x3ffffff3;
    goto LAB_6b837882;
  }
  local_2b8 = (LPWSTR)0x0;
  local_27c = (void *)0x0;
  local_288 = (char *)0x0;
  local_274 = (char *)0x0;
  local_278 = local_278 & 0xffff0000;
  local_298 = (void *)0x0;
  local_29c[0] = 0;
  local_290 = (void *)0x0;
  local_294 = local_294 & 0xffff0000;
  local_2a0 = (void *)0x0;
  local_2a4[0] = 0;
  local_2a8 = (void *)0x0;
  local_2ac[0] = 0;
  local_258 = (wchar_t *)0x0;
  local_270 = (LPWSTR)0x0;
  uVar20 = param_1 & 0xfffffff0;
  if ((*(int *)(*(int *)(in_FS_OFFSET[0xc] + 0x10) + 0x10) == 0) ||
     (local_245 = '\0', (param_8 & 0x10) != 0)) {
    local_245 = '\x01';
  }
  local_8 = (undefined *)0x0;
  local_2b0 = uVar20;
  if (uVar20 == 0x10) {
    iVar22 = in_FS_OFFSET[0xc];
    if ((param_9 == 0) || ((*(uint *)(param_9 + 0x2c) & 0x100) == 0)) {
      pvVar5 = *(HANDLE *)(*(int *)(iVar22 + 0x10) + 0x18);
      *(HANDLE *)(param_6 + 0x48) = pvVar5;
      *(undefined4 *)(param_6 + 0x4c) = *(undefined4 *)(*(int *)(iVar22 + 0x10) + 0x1c);
      *(undefined4 *)(param_6 + 0x50) = *(undefined4 *)(*(int *)(iVar22 + 0x10) + 0x20);
      if ((*(uint *)(*(int *)(iVar22 + 0x10) + 0x68) & 0x600) != 0) {
        if ((pvVar5 != (HANDLE)0x0) &&
           (BVar10 = GetHandleInformation(pvVar5,&local_2c0), BVar10 == 0)) {
          *(undefined4 *)(param_6 + 0x48) = 0;
        }
        if ((*(int *)(param_6 + 0x4c) != 0) &&
           (BVar10 = GetHandleInformation(*(HANDLE *)(param_6 + 0x4c),&local_2c0), BVar10 == 0)) {
          if (*(int *)(param_6 + 0x50) == *(int *)(param_6 + 0x4c)) {
            *(undefined4 *)(param_6 + 0x50) = 0;
          }
          *(undefined4 *)(param_6 + 0x4c) = 0;
        }
        pvVar5 = *(HANDLE *)(param_6 + 0x50);
        if (((pvVar5 != (HANDLE)0x0) && (pvVar5 != *(HANDLE *)(param_6 + 0x4c))) &&
           (BVar10 = GetHandleInformation(pvVar5,&local_2c0), BVar10 == 0)) {
          *(undefined4 *)(param_6 + 0x50) = 0;
        }
      }
    }
    else {
      *(undefined4 *)(param_6 + 0x48) = *(undefined4 *)(param_9 + 0x38);
      *(undefined4 *)(param_6 + 0x4c) = *(undefined4 *)(param_9 + 0x3c);
      *(undefined4 *)(param_6 + 0x50) = *(undefined4 *)(param_9 + 0x40);
    }
    uVar11 = FUN_6b837f52(*(int *)(param_6 + 0x48));
    if ((char)uVar11 != '\0') {
      *(undefined4 *)(param_6 + 0x48) = 0;
    }
    uVar11 = FUN_6b837f52(*(int *)(param_6 + 0x4c));
    if ((char)uVar11 != '\0') {
      *(undefined4 *)(param_6 + 0x4c) = 0;
    }
    uVar11 = FUN_6b837f52(*(int *)(param_6 + 0x50));
    if ((char)uVar11 != '\0') {
      *(undefined4 *)(param_6 + 0x50) = 0;
    }
  }
  if ((uVar20 == 0x40) || (uVar20 == 0x80)) {
    local_245 = '\x01';
  }
  iVar22 = 2;
  for (; (*local_26c == L' ' || (*local_26c == L'\t')); local_26c = local_26c + 1) {
  }
  pWVar13 = local_26c;
  do {
    WVar4 = *pWVar13;
    pWVar13 = pWVar13 + 1;
  } while (WVar4 != L'\0');
  local_244 = (int)pWVar13 - (int)(local_26c + 1) >> 1;
  pwVar14 = (wchar_t *)(local_244 + 0x105);
  local_25c = pwVar14;
  piVar12 = (int *)KernelBaseGetGlobalData();
  lpszShortPath =
       (LPWSTR)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),*piVar12 + 0x200000,
                               (int)pwVar14 * 2);
  local_2b8 = lpszShortPath;
  if (lpszShortPath == (LPWSTR)0x0) goto LAB_6b83696f;
  local_260 = (wchar_t *)GetShortPathNameW(local_26c,lpszShortPath,(DWORD)local_25c);
  if ((local_260 == (wchar_t *)0x0) || (local_25c < local_260)) {
    local_240 = -0x3fffffc7;
  }
  else {
    RtlInitUnicodeString(&local_254,lpszShortPath);
    local_240 = RtlUnicodeStringToOemString(&local_28c,&local_254,1);
    pwVar14 = local_2c4;
    if (-1 < local_240) {
      local_2b4 = 1;
      uVar20 = local_28c & 0xffff;
      for (pcVar16 = local_288;
          (local_260 = (wchar_t *)(uVar20 - 1), uVar20 != 0 && (*pcVar16 != '.'));
          pcVar16 = pcVar16 + 1) {
        if (*pcVar16 == '\\') {
          local_2b4 = 1;
        }
        else {
          local_2b4 = local_2b4 + 1;
        }
        uVar20 = (uint)local_260;
      }
      pwVar17 = local_26c;
      do {
        wVar8 = *pwVar17;
        pwVar17 = pwVar17 + 1;
      } while (wVar8 != L'\0');
      local_284 = (wchar_t *)((int)pwVar17 - (int)(local_26c + 1) >> 1);
      local_244 = (DWORD)local_284;
      if (*local_2c4 == L'\"') {
        local_24c = local_2c4 + 1;
        do {
          wVar8 = *local_24c;
          if (wVar8 == L'\0') break;
          local_24c = local_24c + 1;
        } while (wVar8 != L'\"');
      }
      else {
        local_25c = local_2c4;
        do {
          wVar8 = *local_25c;
          local_25c = local_25c + 1;
        } while (wVar8 != L'\0');
        if (((uint)((int)local_25c - (int)(local_2c4 + 1) >> 1) < local_284) ||
           (iVar19 = _wcsnicmp(local_26c,local_2c4,(size_t)local_284), iVar19 != 0)) {
          for (; (wVar8 = *pwVar14, wVar8 != L'\0' && ((wVar8 == L' ' || (wVar8 == L'\t'))));
              pwVar14 = pwVar14 + 1) {
          }
          if (wVar8 == L'\"') {
            local_24c = pwVar14 + 1;
            do {
              wVar8 = *local_24c;
              if (wVar8 == L'\0') break;
              local_24c = local_24c + 1;
            } while (wVar8 != L'\"');
          }
          else {
            while (((local_24c = pwVar14, wVar8 != L'\0' && (wVar8 != L' ')) && (wVar8 != L'\t'))) {
              pwVar14 = pwVar14 + 1;
              wVar8 = *pwVar14;
            }
          }
        }
        else {
          local_24c = pwVar14 + (int)local_284;
        }
      }
      for (; (wVar8 = *local_24c, wVar8 != L'\0' && ((wVar8 == L' ' || (wVar8 == L'\t'))));
          local_24c = local_24c + 1) {
      }
      local_284 = local_24c + 1;
      pwVar14 = local_24c;
      do {
        wVar8 = *pwVar14;
        pwVar14 = pwVar14 + 1;
      } while (wVar8 != L'\0');
      local_260 = (wchar_t *)((int)pwVar14 - (int)local_284 >> 1);
      local_254 = (short)local_260 * 2;
      local_252 = local_254 + 2;
      local_250 = local_24c;
      local_240 = RtlUnicodeStringToOemString(&local_280,&local_254,1);
      if (-1 < local_240) {
        if (0x80U - local_2b4 <= (local_280 & 0xffff)) goto LAB_6b836c05;
        piVar12 = (int *)KernelBaseGetGlobalData();
        local_258 = (wchar_t *)
                    RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),*piVar12 + 0x200000,
                                    0x208);
        if (local_258 != (wchar_t *)0x0) {
          piVar12 = (int *)KernelBaseGetGlobalData();
          local_270 = (LPWSTR)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),
                                              *piVar12 + 0x200000,0x208);
          pwVar14 = local_258;
          if (local_270 != (LPWSTR)0x0) {
            if (local_2b0 == 0x20) {
              FUN_6b812c57(local_258,0x104,(int)L"wowexec.pif");
              local_244 = 0;
LAB_6b836d5d:
              pwVar14 = local_258;
              local_24c = wcsrchr(local_258,L'\\');
              if (local_24c == (wchar_t *)0x0) {
                local_24c = wcsrchr(pwVar14,L':');
              }
              pwVar14 = local_24c + 1;
              bVar23 = local_24c != (wchar_t *)0x0;
              local_24c = pwVar14;
              if (bVar23) {
                for (; ((wVar8 = *pwVar14, wVar8 != L'\0' && (wVar8 != L' ')) && (wVar8 != L'\t'));
                    pwVar14 = pwVar14 + 1) {
                  local_258[local_244] = wVar8;
                  local_244 = local_244 + 1;
                }
                local_258[local_244] = L'\0';
                local_24c = pwVar14;
              }
              if (local_244 != 0) {
                local_244 = SearchPathW((LPCWSTR)0x0,local_258,(LPCWSTR)&local_2c,0x104,local_270,
                                        (LPWSTR *)0x0);
                if (0x103 < local_244) goto LAB_6b83696f;
                if (local_244 != 0) goto LAB_6b836e26;
              }
              *local_270 = L'\0';
LAB_6b836e26:
              pWVar13 = local_2cc;
              if (local_2cc != (LPCWSTR)0x0) {
LAB_6b836f17:
                local_260 = (wchar_t *)GetFullPathNameW(pWVar13,0x105,local_23c,(LPWSTR *)0x0);
                if (local_260 != (wchar_t *)0x0) {
                  if ((wchar_t *)0x105 < local_260) goto LAB_6b83772b;
                  local_260 = (wchar_t *)GetShortPathNameW(local_23c,local_23c,0x105);
                }
                if (local_260 < (wchar_t *)0x106) {
                  if (local_260 == (wchar_t *)0x0) {
                    RtlInitUnicodeString(&local_254,local_2cc);
                  }
                  else {
                    local_250 = local_23c;
                    local_254 = (short)local_260 * 2;
                    local_252 = 0x20a;
                  }
                  local_240 = RtlUnicodeStringToAnsiString(&local_278,&local_254,1);
                  if (-1 < local_240) {
                    if (0x42 < (ushort)local_278) goto LAB_6b836c05;
                    goto LAB_6b836fc8;
                  }
                }
                goto LAB_6b83772b;
              }
              local_260 = (wchar_t *)RtlGetCurrentDirectory_U(0x20a,local_23c);
              if (0x209 < ((uint)local_260 & 0xfffffffe)) {
                pWVar13 = (LPCWSTR)___report_rangecheckfailure();
                goto LAB_6b836f17;
              }
              *(undefined2 *)((int)local_23c + ((uint)local_260 & 0xfffffffe)) = 0;
              local_260 = (wchar_t *)GetShortPathNameW(local_23c,local_23c,0x105);
              if ((wchar_t *)0x105 < local_260) goto LAB_6b83772b;
              if (local_260 == (wchar_t *)0x0) {
                RtlInitUnicodeString(&local_254,local_23c);
                local_260 = (wchar_t *)(uint)(local_254 >> 1);
              }
              else {
                local_254 = (short)local_260 * 2;
                local_250 = local_23c;
                local_252 = 0x20a;
              }
              if (local_260 + -1 < (wchar_t *)0x41) {
                local_240 = RtlUnicodeStringToAnsiString(&local_278,&local_254,1);
              }
              else {
                local_240 = -0x3ffffff3;
              }
              if (local_240 < 0) goto LAB_6b83772b;
LAB_6b836fc8:
              cVar3 = *local_274;
              if (cVar3 < '[') {
                sVar9 = cVar3 + -0x41;
              }
              else {
                sVar9 = cVar3 + -0x61;
              }
              *(short *)(param_6 + 0x98) = sVar9;
              if ((local_268 != 0) && ((*(uint *)(local_268 + 0x2c) & 0x200) != 0)) {
                psVar18 = *(short **)(local_268 + 4);
                if (psVar18 == (short *)0x0) {
                  iVar19 = 0;
                }
                else {
                  psVar1 = psVar18 + 1;
                  do {
                    sVar9 = *psVar18;
                    psVar18 = psVar18 + 1;
                  } while (sVar9 != 0);
                  iVar19 = (int)psVar18 - (int)psVar1 >> 1;
                }
                pwVar14 = (wchar_t *)(iVar19 * 2 + 0x2a);
                local_284 = pwVar14;
                piVar12 = (int *)KernelBaseGetGlobalData();
                pwVar14 = (wchar_t *)
                          RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),
                                          *piVar12 + 0x200000,pwVar14);
                local_2bc = pwVar14;
                if (pwVar14 != (wchar_t *)0x0) {
                  FUN_6b81fb19(pwVar14,(uint)local_284,L"hotkey.%u %s");
                  *(uint *)(local_268 + 0x2c) = *(uint *)(local_268 + 0x2c) & 0xfffffdff;
                  *(undefined4 *)(local_268 + 0x38) = 0;
                  *(wchar_t **)(local_268 + 4) = pwVar14;
                }
              }
              local_264 = 2;
              local_244 = ((local_280 & 0xffff) + 6 & 0xfffffffc) +
                          ((local_28c & 0xffff) + 4 & 0xfffffffc);
              if (*local_2d0 != 0) {
                iVar22 = 3;
                local_264 = 3;
                local_244 = local_244 + (*local_2d0 + 3 & 0xfffffffc);
              }
              if ((ushort)local_278 != 0) {
                iVar22 = iVar22 + 1;
                local_244 = local_244 + ((local_278 & 0xffff) + 4 & 0xfffffffc);
                local_264 = iVar22;
              }
              DVar21 = local_244;
              if (*local_270 != L'\0') {
                iVar22 = iVar22 + 1;
                local_264 = iVar22;
                RtlInitUnicodeString(&local_254,local_270);
                local_240 = RtlUnicodeStringToAnsiString(&local_294,&local_254,1);
                if (local_240 < 0) goto LAB_6b83772b;
                local_244 = DVar21 + ((local_294 & 0xffff) + 4 & 0xfffffffc);
              }
              if (local_268 != 0) {
                DVar21 = local_244 + 0x44;
                local_264 = iVar22 + 1;
                iVar19 = local_264;
                if (*(int *)(local_268 + 8) != 0) {
                  local_264 = iVar22 + 2;
                  local_244 = DVar21;
                  RtlInitUnicodeString(&local_254,*(undefined4 *)(local_268 + 8));
                  local_240 = RtlUnicodeStringToAnsiString(local_29c,&local_254,1);
                  if (local_240 < 0) goto LAB_6b83772b;
                  DVar21 = DVar21 + (local_29c[0] + 4 & 0xfffffffc);
                  iVar19 = iVar22 + 2;
                }
                iVar22 = iVar19;
                local_244 = DVar21;
                if (*(int *)(local_268 + 0xc) != 0) {
                  iVar22 = iVar22 + 1;
                  local_264 = iVar22;
                  RtlInitUnicodeString(&local_254,*(undefined4 *)(local_268 + 0xc));
                  local_240 = RtlUnicodeStringToOemString(local_2a4,&local_254,1);
                  if (local_240 < 0) goto LAB_6b83772b;
                  local_244 = DVar21 + (local_2a4[0] + 4 & 0xfffffffc);
                }
                DVar21 = local_244;
                if (*(int *)(local_268 + 4) != 0) {
                  iVar22 = iVar22 + 1;
                  local_264 = iVar22;
                  RtlInitUnicodeString(&local_254,*(undefined4 *)(local_268 + 4));
                  local_240 = RtlUnicodeStringToAnsiString(local_2ac,&local_254,1);
                  if (local_240 < 0) goto LAB_6b83772b;
                  local_244 = DVar21 + (local_2ac[0] + 4 & 0xfffffffc);
                }
              }
              DVar21 = local_244;
              if (local_2c8 != 0) {
                iVar22 = iVar22 + 1;
                local_264 = iVar22;
                iVar19 = FUN_6b837ebf(local_2c8,&local_2d8);
                if (iVar19 < 0) goto LAB_6b836c05;
                local_244 = DVar21 + 8;
              }
              iVar22 = CsrAllocateCaptureBuffer(iVar22,local_244);
              if (iVar22 == 0) goto LAB_6b83696f;
              ppvVar2 = (void **)(param_6 + 0x5c);
              CsrAllocateMessagePointer(iVar22,(local_280 & 0xffff) + 6 & 0xfffffffc,ppvVar2);
              memmove(*ppvVar2,local_27c,local_280 & 0xffff);
              *(undefined *)((local_280 & 0xffff) + (int)*ppvVar2) = 0xd;
              *(undefined *)((local_280 & 0xffff) + 1 + (int)*ppvVar2) = 10;
              *(undefined *)((local_280 & 0xffff) + 2 + (int)*ppvVar2) = 0;
              *(short *)(param_6 + 0x90) = (short)local_280 + 3;
              ppvVar2 = (void **)(param_6 + 0x60);
              CsrAllocateMessagePointer(iVar22,(local_28c & 0xffff) + 4 & 0xfffffffc,ppvVar2);
              memmove(*ppvVar2,local_288,local_28c & 0xffff);
              *(undefined *)((local_28c & 0xffff) + (int)*ppvVar2) = 0;
              *(short *)(param_6 + 0x92) = (short)local_28c + 1;
              if (local_290 == (void *)0x0) {
                *(undefined2 *)(param_6 + 0x94) = 0;
                *(undefined4 *)(param_6 + 100) = 0;
              }
              else {
                CsrAllocateMessagePointer
                          (iVar22,(local_294 & 0xffff) + 4 & 0xfffffffc,
                           (undefined4 *)(param_6 + 100));
                memmove(*(void **)(param_6 + 100),local_290,local_294 & 0xffff);
                *(undefined *)((local_294 & 0xffff) + *(int *)(param_6 + 100)) = 0;
                *(short *)(param_6 + 0x94) = (short)local_294 + 1;
              }
              puVar7 = local_2d0;
              if (*local_2d0 == 0) {
                *(undefined4 *)(param_6 + 0x70) = 0;
                *(undefined4 *)(param_6 + 0x6c) = 0;
              }
              else {
                CsrAllocateMessagePointer
                          (iVar22,*local_2d0 + 3 & 0xfffffffc,(undefined4 *)(param_6 + 0x6c));
                memmove(*(void **)(param_6 + 0x6c),*(void **)(puVar7 + 2),(uint)*puVar7);
                *(uint *)(param_6 + 0x70) = (uint)*puVar7;
              }
              if ((ushort)local_278 == 0) {
                *(undefined4 *)(param_6 + 0x68) = 0;
                sVar9 = 0;
              }
              else {
                CsrAllocateMessagePointer
                          (iVar22,(local_278 & 0xffff) + 4 & 0xfffffffc,
                           (undefined4 *)(param_6 + 0x68));
                memmove(*(void **)(param_6 + 0x68),local_274,local_278 & 0xffff);
                *(undefined *)((local_278 & 0xffff) + *(int *)(param_6 + 0x68)) = 0;
                sVar9 = (short)local_278 + 1;
              }
              iVar19 = local_268;
              *(short *)(param_6 + 0x96) = sVar9;
              if (local_268 == 0) {
                *(undefined4 *)(param_6 + 0x74) = 0;
              }
              else {
                CsrAllocateMessagePointer(iVar22,0x44,(undefined4 *)(param_6 + 0x74));
                *(undefined4 *)(*(int *)(param_6 + 0x74) + 0x10) = *(undefined4 *)(iVar19 + 0x10);
                *(undefined4 *)(*(int *)(param_6 + 0x74) + 0x14) = *(undefined4 *)(iVar19 + 0x14);
                *(undefined4 *)(*(int *)(param_6 + 0x74) + 0x18) = *(undefined4 *)(iVar19 + 0x18);
                *(undefined4 *)(*(int *)(param_6 + 0x74) + 0x1c) = *(undefined4 *)(iVar19 + 0x1c);
                *(undefined4 *)(*(int *)(param_6 + 0x74) + 0x20) = *(undefined4 *)(iVar19 + 0x20);
                *(undefined4 *)(*(int *)(param_6 + 0x74) + 0x24) = *(undefined4 *)(iVar19 + 0x24);
                *(undefined4 *)(*(int *)(param_6 + 0x74) + 0x28) = *(undefined4 *)(iVar19 + 0x28);
                *(undefined4 *)(*(int *)(param_6 + 0x74) + 0x2c) = *(undefined4 *)(iVar19 + 0x2c);
                *(undefined2 *)(*(int *)(param_6 + 0x74) + 0x30) = *(undefined2 *)(iVar19 + 0x30);
                **(undefined4 **)(param_6 + 0x74) = 0x44;
              }
              if (local_298 == (void *)0x0) {
                *(undefined4 *)(param_6 + 0x78) = 0;
                *(undefined4 *)(param_6 + 0x7c) = 0;
              }
              else {
                CsrAllocateMessagePointer
                          (iVar22,local_29c[0] + 4 & 0xfffffffc,(undefined4 *)(param_6 + 0x78));
                memmove(*(void **)(param_6 + 0x78),local_298,(uint)local_29c[0]);
                *(undefined *)((uint)local_29c[0] + *(int *)(param_6 + 0x78)) = 0;
                *(uint *)(param_6 + 0x7c) = local_29c[0] + 1;
              }
              if (local_2a0 == (void *)0x0) {
                *(undefined4 *)(param_6 + 0x80) = 0;
                *(undefined4 *)(param_6 + 0x84) = 0;
              }
              else {
                CsrAllocateMessagePointer
                          (iVar22,local_2a4[0] + 4 & 0xfffffffc,(undefined4 *)(param_6 + 0x80));
                memmove(*(void **)(param_6 + 0x80),local_2a0,(uint)local_2a4[0]);
                *(undefined *)((uint)local_2a4[0] + *(int *)(param_6 + 0x80)) = 0;
                *(uint *)(param_6 + 0x84) = local_2a4[0] + 1;
              }
              if (local_2a8 == (void *)0x0) {
                *(undefined4 *)(param_6 + 0x88) = 0;
                *(undefined4 *)(param_6 + 0x8c) = 0;
              }
              else {
                CsrAllocateMessagePointer
                          (iVar22,local_2ac[0] + 4 & 0xfffffffc,(undefined4 *)(param_6 + 0x88));
                memmove(*(void **)(param_6 + 0x88),local_2a8,(uint)local_2ac[0]);
                *(undefined *)((uint)local_2ac[0] + *(int *)(param_6 + 0x88)) = 0;
                *(uint *)(param_6 + 0x8c) = local_2ac[0] + 1;
              }
              if (local_2c8 == 0) {
                *(undefined4 *)(param_6 + 0x9c) = 0;
              }
              else {
                CsrAllocateMessagePointer(iVar22,8,(undefined4 *)(param_6 + 0x9c));
                puVar6 = *(undefined4 **)(param_6 + 0x9c);
                *puVar6 = local_2d8;
                puVar6[1] = local_2d4;
              }
              uVar20 = local_2b0;
              if (local_2b0 == 0x20) {
                *(undefined4 *)(param_6 + 0x3c) = 0xffffffff;
              }
              else if (local_245 == '\0') {
                uVar11 = FUN_6b838215();
                *(uint *)(param_6 + 0x3c) = uVar11;
              }
              else {
                *(undefined4 *)(param_6 + 0x3c) = 0;
              }
              *(undefined2 *)(param_6 + 0x9a) = 0;
              *(uint *)(param_6 + 0x40) = uVar20;
              UVar15 = GetConsoleCP();
              *(UINT *)(param_6 + 0x54) = UVar15;
              *(uint *)(param_6 + 0x58) = param_8;
              local_240 = CsrClientCallServer(param_6,iVar22,0x10010005,0x68);
              if ((local_240 == -0x3fffffde) && (*(int *)(param_6 + 0x7c) == 0)) {
                CsrFreeCaptureBuffer(iVar22);
              }
              else {
                CsrFreeCaptureBuffer(iVar22);
                if ((local_240 < 0) || (*(int *)(param_6 + 0x30) < 0)) {
                  local_240 = *(int *)(param_6 + 0x30);
                }
                else {
                  *param_7 = *(undefined4 *)(param_6 + 0x38);
                  local_240 = 0;
                }
              }
            }
            else {
              if (local_244 < 0x104) {
                FUN_6b812c57(local_258,0x104,(int)local_26c);
                local_24c = wcsrchr(pwVar14,L'.');
                if ((local_24c != (wchar_t *)0x0) &&
                   (4 < ((int)pwVar14 - (int)local_24c >> 1) + 0x104U)) {
                  FUN_6b81fb91(local_24c,10,(int)&local_2c);
                  DVar21 = GetFileAttributesW(pwVar14);
                  if ((DVar21 == 0xffffffff) || ((DVar21 & 0x10) != 0)) {
                    uVar20 = 0;
                    local_244 = 0;
                  }
                  else {
                    pwVar17 = pwVar14 + 1;
                    do {
                      wVar8 = *pwVar14;
                      pwVar14 = pwVar14 + 1;
                    } while (wVar8 != L'\0');
                    uVar20 = ((int)pwVar14 - (int)pwVar17 >> 1) + 1;
                    local_244 = uVar20;
                    FUN_6b81709d(local_270,0x104,(int)local_258,uVar20);
                  }
                  if (uVar20 == 0) goto LAB_6b836d5d;
                  goto LAB_6b836e26;
                }
              }
LAB_6b836c05:
              local_240 = -0x3ffffff3;
            }
            goto LAB_6b83772b;
          }
        }
LAB_6b83696f:
        local_240 = -0x3fffffe9;
      }
    }
  }
LAB_6b83772b:
  local_8 = (undefined *)0xfffffffe;
  FUN_6b837751();
LAB_6b837882:
  *in_FS_OFFSET = local_14;
  return local_240;
}



void FUN_6b837751(void)

{
  undefined4 unaff_EBX;
  int unaff_EBP;
  int in_FS_OFFSET;
  
  if (*(int *)(unaff_EBP + -0x2e4) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EBX,
                *(int *)(unaff_EBP + -0x2e4));
  }
  if (*(int *)(unaff_EBP + -0x254) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EBX,
                *(int *)(unaff_EBP + -0x254));
  }
  if (*(int *)(unaff_EBP + -0x26c) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EBX,
                *(int *)(unaff_EBP + -0x26c));
  }
  if (*(int *)(unaff_EBP + -0x278) != 0) {
    RtlFreeOemString(unaff_EBP + -0x27c);
  }
  if (*(int *)(unaff_EBP + -0x284) != 0) {
    RtlFreeOemString(unaff_EBP + -0x288);
  }
  if (*(int *)(unaff_EBP + -0x28c) != 0) {
    RtlFreeAnsiString(unaff_EBP + -0x290);
  }
  if (*(int *)(unaff_EBP + -0x270) != 0) {
    RtlFreeAnsiString(unaff_EBP + -0x274);
  }
  if (*(int *)(unaff_EBP + -0x294) != 0) {
    RtlFreeAnsiString(unaff_EBP + -0x298);
  }
  if (*(int *)(unaff_EBP + -0x29c) != 0) {
    RtlFreeAnsiString(unaff_EBP + -0x2a0);
  }
  if (*(int *)(unaff_EBP + -0x2a4) != 0) {
    RtlFreeAnsiString(unaff_EBP + -0x2a8);
  }
  if (*(int *)(unaff_EBP + -0x2b4) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EBX,
                *(int *)(unaff_EBP + -0x2b4));
  }
  if (*(int *)(unaff_EBP + -0x2b8) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EBX,
                *(int *)(unaff_EBP + -0x2b8));
  }
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 __fastcall FUN_6b837894(wchar_t *param_1,int param_2,short *param_3)

{
  wchar_t wVar1;
  WCHAR WVar2;
  int iVar3;
  WCHAR *pWVar4;
  uint uVar5;
  DWORD DVar6;
  uint uVar7;
  wchar_t *pwVar8;
  LPCWSTR pWVar9;
  uint uVar10;
  WCHAR *lpszLongPath;
  short sVar11;
  WCHAR *lpszShortPath;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar12;
  undefined4 local_3c;
  wchar_t *local_2c;
  int local_28;
  WCHAR *local_24;
  LPCWSTR local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b891fe8;
  uStack12 = 0x6b8378a0;
  local_2c = (wchar_t *)0x0;
  local_3c = 0;
  if ((param_2 == 0) || (param_3 == (short *)0x0)) {
    RtlSetLastWin32Error(0x57);
    local_3c = 0;
    goto LAB_6b837d11;
  }
  local_8 = (undefined *)0x0;
  pwVar8 = param_1;
  if ((param_1 == (wchar_t *)0x0) &&
     (iVar3 = RtlCreateEnvironment(1,&local_2c), pwVar8 = local_2c, iVar3 < 0)) {
    BaseSetLastNTError(iVar3);
    local_2c = (wchar_t *)0x0;
  }
  else {
    local_2c = pwVar8;
    iVar3 = 0;
    local_20 = local_2c;
    while ((wVar1 = *local_20, local_20 = local_20 + 1, wVar1 != L'\0' || (*local_20 != L'\0'))) {
      iVar3 = iVar3 + 1;
    }
    uVar7 = (iVar3 + 2) * 2 + 0x208;
    if (uVar7 < 0x10000) {
      pWVar4 = (WCHAR *)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),0,uVar7);
      if (pWVar4 != (WCHAR *)0x0) {
        local_28 = 0x102;
        local_20 = local_2c;
        local_24 = pWVar4;
        while (pwVar8 = local_20, WVar2 = *local_20, WVar2 != L'\0') {
          if (WVar2 == L'=') {
            WVar2 = local_20[1];
            if ((((0x40 < (ushort)WVar2) && ((ushort)WVar2 < 0x5b)) ||
                ((ushort)(WVar2 + L'') < 0x1a)) &&
               ((local_20[2] == L':' && (local_20[3] == L'=')))) {
              do {
                wVar1 = *pwVar8;
                pwVar8 = pwVar8 + 1;
              } while (wVar1 != L'\0');
              if ((6 < (uint)((int)pwVar8 - (int)(local_20 + 1) >> 1)) &&
                 ((((local_20[7] != L'\0' || ((local_20[6] != L'\\' && (local_20[6] != L'/')))) ||
                   (local_20[5] != L':')) ||
                  (((wVar1 = local_20[4], (ushort)wVar1 < 0x41 || (0x5a < (ushort)wVar1)) &&
                   (0x19 < (ushort)(wVar1 + L''))))))) {
                *local_24 = L'=';
                local_24[1] = local_20[1];
                local_24[2] = local_20[2];
                local_24[3] = local_20[3];
                local_24 = local_24 + 4;
                local_20 = local_20 + 4;
                iVar3 = 2;
                lpszLongPath = local_20;
                lpszShortPath = local_24;
                goto LAB_6b837aaa;
              }
            }
            iVar3 = 1;
            lpszLongPath = local_20;
            lpszShortPath = local_24;
          }
          else {
            while (WVar2 != L'\0') {
              *local_24 = WVar2;
              local_24 = local_24 + 1;
              local_20 = local_20 + 1;
              if (WVar2 == L'=') break;
              WVar2 = *local_20;
            }
            lpszLongPath = local_20;
            lpszShortPath = local_24;
            iVar3 = FUN_6b837d5e(pwVar8,(wchar_t *)(((int)local_20 - (int)pwVar8 >> 1) + -1));
          }
LAB_6b837aaa:
          if (iVar3 == 1) {
            do {
              WVar2 = *lpszLongPath;
              *lpszShortPath = WVar2;
              lpszShortPath = lpszShortPath + 1;
              lpszLongPath = lpszLongPath + 1;
              local_24 = lpszShortPath;
              local_20 = lpszLongPath;
            } while (WVar2 != L'\0');
          }
          else {
            pWVar9 = lpszLongPath;
            if (iVar3 == 2) {
              do {
                WVar2 = *pWVar9;
                pWVar9 = pWVar9 + 1;
              } while (WVar2 != L'\0');
              uVar10 = (int)pWVar9 - (int)(lpszLongPath + 1) >> 1;
              uVar7 = uVar10 + 1;
              uVar5 = uVar7 + local_28;
              DVar6 = GetShortPathNameW(lpszLongPath,lpszShortPath,uVar5);
              if ((DVar6 == 0) || (uVar5 <= DVar6)) {
                memmove(lpszShortPath,lpszLongPath,uVar7 * 2);
                DVar6 = uVar10;
              }
              local_24 = lpszShortPath + DVar6 + 1;
              local_20 = lpszLongPath + uVar7;
              if (uVar7 < DVar6) {
                local_28 = local_28 + (uVar7 - DVar6);
              }
            }
            else {
              while (*lpszLongPath != L'\0') {
                if (*lpszLongPath == L';') {
                  uVar7 = (int)lpszLongPath - (int)pWVar9 >> 1;
                  if (uVar7 != 0) {
                    *lpszLongPath = L'\0';
                    uVar10 = uVar7 + local_28;
                    uVar5 = GetShortPathNameW(pWVar9,lpszShortPath,uVar10 + 1);
                    if ((uVar5 == 0) || (uVar10 < uVar5)) {
                      memmove(lpszShortPath,pWVar9,uVar7 * 2);
                      uVar5 = uVar7;
                    }
                    *lpszLongPath = L';';
                    lpszShortPath[uVar5] = L';';
                    lpszShortPath = lpszShortPath + uVar5 + 1;
                    lpszLongPath = lpszLongPath + 1;
                    local_24 = lpszShortPath;
                    local_20 = lpszLongPath;
                    if (uVar7 < uVar5) {
                      local_28 = local_28 + (uVar7 - uVar5);
                    }
                  }
                  while (pWVar9 = lpszLongPath, *lpszLongPath == L';') {
                    *lpszShortPath = L';';
                    lpszShortPath = lpszShortPath + 1;
                    lpszLongPath = lpszLongPath + 1;
                    local_24 = lpszShortPath;
                    local_20 = lpszLongPath;
                  }
                }
                else {
                  lpszLongPath = lpszLongPath + 1;
                  local_20 = lpszLongPath;
                }
              }
              uVar7 = (int)lpszLongPath - (int)pWVar9 >> 1;
              if (uVar7 != 0) {
                DVar6 = GetShortPathNameW(pWVar9,lpszShortPath,uVar7 + local_28 + 1);
                if ((DVar6 == 0) || (uVar7 < DVar6)) {
                  memmove(lpszShortPath,pWVar9,uVar7 * 2);
                  DVar6 = uVar7;
                }
                lpszShortPath = lpszShortPath + DVar6;
                if (uVar7 < DVar6) {
                  local_28 = local_28 + (uVar7 - DVar6);
                }
              }
              *lpszShortPath = *lpszLongPath;
              local_24 = lpszShortPath + 1;
              local_20 = lpszLongPath + 1;
            }
          }
        }
        *local_24 = L'\0';
        local_24 = local_24 + 1;
        sVar11 = (short)local_24 - (short)pWVar4;
        *param_3 = sVar11;
        param_3[1] = sVar11;
        iVar3 = RtlCreateEnvironmentEx(pWVar4,param_3 + 2,0);
        if (-1 < iVar3) {
          iVar3 = RtlUnicodeStringToAnsiString(param_2,param_3,1);
          if (-1 < iVar3) {
            local_3c = 1;
            goto LAB_6b837ca7;
          }
          RtlDestroyEnvironment(*(undefined4 *)(param_3 + 2));
        }
        BaseSetLastNTError(iVar3);
        goto LAB_6b837ca7;
      }
      uVar12 = 0xc000009a;
    }
    else {
      uVar12 = 0xc0000001;
    }
    BaseSetLastNTError(uVar12);
  }
LAB_6b837ca7:
  local_8 = (undefined *)0xfffffffe;
  FUN_6b837cc6();
LAB_6b837d11:
  *in_FS_OFFSET = local_14;
  return local_3c;
}



void FUN_6b837cc6(void)

{
  undefined4 *puVar1;
  undefined4 unaff_EBX;
  int unaff_EBP;
  undefined4 *unaff_ESI;
  int in_FS_OFFSET;
  
  if ((*(int *)(unaff_EBP + -0x54) == 0) && (*(int *)(unaff_EBP + -0x28) != 0)) {
    RtlDestroyEnvironment(*(undefined4 *)(unaff_EBP + -0x28));
  }
  if (*(int *)(unaff_EBP + -0x34) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EBX,
                *(int *)(unaff_EBP + -0x34));
  }
  if (*(int *)(unaff_EBP + -0x38) == 0) {
    *unaff_ESI = unaff_EBX;
    unaff_ESI[1] = unaff_EBX;
    puVar1 = *(undefined4 **)(unaff_EBP + -0x3c);
    *puVar1 = unaff_EBX;
    puVar1[1] = unaff_EBX;
  }
  return;
}



undefined4 BaseDestroyVDMEnvironment(int param_1,int param_2)

{
                    // 0x37d30  52  BaseDestroyVDMEnvironment
  if (*(int *)(param_1 + 4) != 0) {
    RtlFreeAnsiString(param_1);
  }
  if (*(int *)(param_2 + 4) != 0) {
    RtlDestroyEnvironment(*(undefined4 *)(param_2 + 4));
  }
  return 1;
}



undefined4 __fastcall FUN_6b837d5e(wchar_t *param_1,wchar_t *param_2)

{
  int iVar1;
  undefined **ppuVar2;
  int iVar3;
  
  iVar3 = 0;
  ppuVar2 = &_Str1_6b8b0008;
  while ((((wchar_t **)ppuVar2)[-1] != param_2 ||
         (iVar1 = _wcsnicmp((wchar_t *)*ppuVar2,param_1,(size_t)param_2), iVar1 != 0))) {
    ppuVar2 = (undefined **)((wchar_t **)ppuVar2 + 3);
    iVar3 = iVar3 + 1;
    if (0x6b8b0043 < (int)ppuVar2) {
      return 1;
    }
  }
  return (&DAT_6b8b0000)[iVar3 * 3];
}



void __fastcall FUN_6b837db4(undefined4 param_1,int param_2,int param_3,undefined4 param_4)

{
  ushort uVar1;
  undefined2 extraout_var;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar2;
  wchar_t local_620 [520];
  undefined local_210 [520];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  RtlFreeUnicodeString(param_4);
  uVar1 = FUN_6b8210c4(local_210,0x104);
  if ((CONCAT22(extraout_var,uVar1) == 0) || (0x103 < CONCAT22(extraout_var,uVar1))) {
    RtlSetLastWin32Error(0x7b);
    uVar2 = extraout_EDX_00;
  }
  else {
    if (param_2 == 0) {
      FUN_6b81fb19(local_620,0x410,L"\"%s\\ntvdm.exe\"  %s%c");
    }
    else {
      FUN_6b81fb19(local_620,0x410,L"\"%s\\ntvdm.exe\" -i%lx %s%c");
    }
    RtlCreateUnicodeString(param_4,local_620);
    uVar2 = extraout_EDX;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



int __fastcall FUN_6b837ebf(undefined4 param_1,undefined4 *param_2)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int in_FS_OFFSET;
  undefined4 local_8;
  
  local_8 = param_1;
  iVar1 = NtQueryInformationToken(param_1,10,0,0,&local_8);
  if (iVar1 == -0x3fffffdd) {
    piVar2 = (int *)KernelBaseGetGlobalData();
    iVar3 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*piVar2 + 0x200000
                            ,local_8);
    if (iVar3 == 0) {
      iVar1 = -0x3fffffdd;
    }
    else {
      iVar1 = NtQueryInformationToken(param_1,10,iVar3,local_8,&local_8);
      if ((-1 < iVar1) && (param_2 != (undefined4 *)0x0)) {
        *param_2 = *(undefined4 *)(iVar3 + 8);
        param_2[1] = *(undefined4 *)(iVar3 + 0xc);
      }
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iVar3);
    }
  }
  return iVar1;
}



uint __fastcall FUN_6b837f52(int param_1)

{
  uint in_EAX;
  undefined local_14 [8];
  int local_c [2];
  
  if (param_1 != 0) {
    in_EAX = NtQueryVolumeInformationFile(param_1,local_14,local_c,8,4);
    if (-1 < (int)in_EAX) {
      return in_EAX & 0xffffff00 | (uint)(local_c[0] == 0x50);
    }
  }
  return in_EAX & 0xffffff00;
}



void BaseUpdateVDMEntry(int param_1,int *param_2,int param_3,int param_4)

{
  undefined4 extraout_EDX;
  undefined4 uVar1;
  undefined8 uVar2;
  undefined auStack524 [4];
  undefined local_208 [48];
  int local_1d8;
  int local_1d0;
  int local_1cc;
  uint local_1c8;
  int local_1c4;
  int local_1c0;
  undefined2 local_1bc;
  undefined2 local_1ba;
  uint local_c;
  
                    // 0x37f90  74  BaseUpdateVDMEntry
  local_c = DAT_6b8b0140 ^ (uint)auStack524;
  if (param_1 == 0) {
    local_1d0 = *param_2;
    local_1ba = (undefined2)param_3;
  }
  else if (param_1 == 1) {
    local_1c4 = *param_2;
    local_1d0 = param_3;
  }
  if (param_4 == 0x20) {
    local_1c8 = 0xffffffff;
  }
  else if (local_1d0 == 0) {
    local_1c8 = FUN_6b838215();
  }
  else {
    local_1c8 = 0;
  }
  local_1bc = (undefined2)param_1;
  local_1cc = param_4;
  uVar2 = CsrClientCallServer(local_208,0,0x10010006,0x18);
  uVar1 = (undefined4)((ulonglong)uVar2 >> 0x20);
  if (((int)uVar2 < 0) || (local_1d8 < 0)) {
    BaseSetLastNTError(local_1d8);
    uVar1 = extraout_EDX;
  }
  else if (param_1 == 1) {
    *param_2 = local_1c0;
  }
  FUN_6b8224af(local_c ^ (uint)auStack524,uVar1);
  return;
}



undefined4 __fastcall FUN_6b83805e(LPCWSTR param_1)

{
  LSTATUS LVar1;
  uint uVar2;
  uint uVar3;
  undefined4 uVar4;
  uint local_34;
  uint local_30;
  _FILETIME local_2c;
  uint local_24;
  uint local_20;
  uint local_1c;
  uint local_18;
  LPCWSTR local_14;
  HKEY local_10;
  HKEY local_c;
  DWORD local_8;
  
  local_1c = 0;
  uVar4 = 1;
  local_18 = 0;
  local_24 = 0;
  local_20 = 0;
  local_14 = param_1;
  LVar1 = RegOpenKeyExW((HKEY)0x80000001,L"SYSTEM\\CurrentControlSet\\Control\\WOW",0,0x20019,
                        &local_10);
  if (LVar1 != 0) {
    return 1;
  }
  local_8 = 8;
  RegGetValueW(local_10,(LPCWSTR)0x0,L"UTCLimitTimeout",0x20000048,(LPDWORD)0x0,&local_24,&local_8);
  if (((local_24 | local_20) == 0) ||
     (LVar1 = RegOpenKeyExW(local_10,L"UTCLimit",0,0x2001b,&local_c), LVar1 != 0))
  goto LAB_6b83817e;
  local_8 = 8;
  RegGetValueW(local_c,(LPCWSTR)0x0,param_1,0x20000048,(LPDWORD)0x0,&local_1c,&local_8);
  GetSystemTimeAsFileTime(&local_2c);
  local_34 = local_2c.dwLowDateTime;
  local_30 = local_2c.dwHighDateTime;
  if ((local_2c.dwHighDateTime < local_18) ||
     ((local_2c.dwHighDateTime <= local_18 && (local_2c.dwLowDateTime <= local_1c)))) {
LAB_6b838173:
    uVar4 = 0;
  }
  else {
    uVar3 = (local_2c.dwHighDateTime - local_18) - (uint)(local_2c.dwLowDateTime < local_1c);
    uVar2 = local_20 * 10000000 + (int)((ulonglong)local_24 * 10000000 >> 0x20);
    if ((uVar3 < uVar2) ||
       ((uVar3 <= uVar2 &&
        (local_2c.dwLowDateTime - local_1c <= (uint)((ulonglong)local_24 * 10000000)))))
    goto LAB_6b838173;
    RegSetValueExW(local_c,local_14,0,0xb,(BYTE *)&local_34,8);
  }
  RegCloseKey(local_c);
LAB_6b83817e:
  RegCloseKey(local_10);
  return uVar4;
}



void ExitVDM(int param_1,uint param_2)

{
  undefined4 extraout_EDX;
  undefined4 uVar1;
  undefined8 uVar2;
  undefined local_208 [56];
  uint local_1d0;
  uint local_1cc;
  int local_1c8;
  uint local_c;
  
                    // 0x381a0  358  ExitVDM
  local_c = DAT_6b8b0140 ^ (uint)local_208;
  local_1d0 = FUN_6b838215();
  local_1c8 = 0;
  local_1cc = -(uint)(param_1 != 0) & param_2;
  uVar2 = CsrClientCallServer(local_208,0,0x10010008,0xc);
  uVar1 = (undefined4)((ulonglong)uVar2 >> 0x20);
  if ((-1 < (int)uVar2) && (local_1c8 != 0)) {
    NtClose(local_1c8);
    uVar1 = extraout_EDX;
  }
  FUN_6b8224af(local_c ^ (uint)local_208,uVar1);
  return;
}



uint FUN_6b838215(void)

{
  int iVar1;
  uint local_8;
  
  if (DAT_6b8b09b4 == 0) {
    iVar1 = NtQueryInformationProcess(0xffffffff,0x31,&local_8,4,0);
    if (iVar1 < 0) {
      return 0xffffffff;
    }
    if ((local_8 & 1) == 0) {
      DAT_6b8b09b4 = 0;
    }
    else {
      DAT_6b8b09b4 = local_8 & 0xfffffffe;
    }
  }
  return DAT_6b8b09b4;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

DWORD GetLongPathNameTransactedA
                (LPCSTR lpszShortPath,LPSTR lpszLongPath,DWORD cchBuffer,HANDLE hTransaction)

{
  int iVar1;
  DWORD DVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar3;
  undefined4 local_14;
  
                    // 0x38260  626  GetLongPathNameTransactedA
  DVar2 = 0;
  if ((hTransaction == (HANDLE)0xffffffff) || (hTransaction == (HANDLE)0x0)) {
    uVar3 = 0x1a2c;
  }
  else {
    iVar1 = RtlGetCurrentTransaction();
    if (iVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      DVar2 = GetLongPathNameA(lpszShortPath,lpszLongPath,cchBuffer);
      FUN_6b8382bd();
      goto LAB_6b8382d1;
    }
    uVar3 = 0x1a45;
  }
  RtlSetLastWin32Error(uVar3);
LAB_6b8382d1:
  *in_FS_OFFSET = local_14;
  return DVar2;
}



void FUN_6b8382bd(void)

{
  RtlSetCurrentTransaction(0);
  return;
}



// WARNING: Function: __SEH_prolog4_GS replaced with injection: SEH_prolog4
// WARNING: Could not reconcile some variable overlaps

uint GetNextVDMCommand(uint *param_1)

{
  ushort uVar1;
  ushort uVar2;
  undefined2 uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  ushort uVar7;
  uint uVar8;
  uint uVar9;
  undefined4 *in_FS_OFFSET;
  uint local_224;
  uint local_21c;
  undefined local_218 [48];
  int local_1e8;
  uint local_1e0;
  uint local_1dc;
  int local_1d8;
  uint local_1d4;
  uint local_1d0;
  uint local_1cc;
  uint local_1c8;
  uint local_1c4;
  uint local_1c0;
  void *local_1bc;
  void *local_1b8;
  void *local_1b4;
  void *local_1b0;
  void *local_1ac;
  uint local_1a8;
  void *local_1a4;
  void *local_1a0;
  uint local_19c;
  void *local_198;
  uint local_194;
  void *local_190;
  uint local_18c;
  undefined2 local_188;
  ushort local_186;
  ushort local_184;
  ushort local_182;
  ushort local_180;
  undefined4 local_17e;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x382f0  652  GetNextVDMCommand
  local_8 = &DAT_6b891fb0;
  uStack12 = 0x6b8382ff;
  if (param_1 == (uint *)0x0) {
    iVar4 = CsrClientCallServer(local_218,0,0x10009,4);
    if (-1 < iVar4) goto LAB_6b838431;
    goto LAB_6b83842a;
  }
  uVar1 = *(ushort *)(param_1 + 0x26);
  if (uVar1 == 0) {
    local_1e0 = (uint)*(byte *)(DAT_6b8b083c + 0x7f5);
    goto LAB_6b838431;
  }
  if ((uVar1 & 0xd000) == 0) {
    if ((uVar1 == 0x10) || (uVar1 == 0x20)) {
      local_1e0 = FUN_6b838215();
      local_1dc = (uint)*(ushort *)(param_1 + 0x26);
      iVar4 = CsrClientCallServer(local_218,0,0x1001000b,8);
      if (-1 < iVar4) goto LAB_6b838bb5;
    }
    else {
      local_1dc = FUN_6b838215();
      uVar9 = 0;
      if ((*(ushort *)(param_1 + 0x26) & 0x100) == 0) {
        local_1e0 = 0;
      }
      else {
        local_1e0 = *param_1;
      }
      local_184 = *(ushort *)((int)param_1 + 0x92);
      local_182 = *(ushort *)(param_1 + 0x25);
      local_186 = *(ushort *)(param_1 + 0x24);
      local_1a8 = param_1[0xc];
      local_1c0 = param_1[2];
      local_17e = local_17e & 0xffff0000 | (uint)uVar1;
      local_1d8 = 0;
      local_19c = param_1[0x1f];
      local_194 = param_1[0x21];
      local_18c = param_1[0x23];
      local_180 = *(ushort *)((int)param_1 + 0x96);
      local_21c = 0x44;
      iVar4 = 1;
      if (local_186 != 0) {
        local_21c = (local_186 + 3 & 0xfffffffc) + 0x44;
        iVar4 = 2;
      }
      if (*(ushort *)((int)param_1 + 0x92) != 0) {
        local_21c = (*(ushort *)((int)param_1 + 0x92) + 3 & 0xfffffffc) + local_21c;
        iVar4 = iVar4 + 1;
      }
      if (*(ushort *)(param_1 + 0x25) != 0) {
        local_21c = (*(ushort *)(param_1 + 0x25) + 3 & 0xfffffffc) + local_21c;
        iVar4 = iVar4 + 1;
      }
      if (param_1[0xb] != 0) {
        iVar4 = iVar4 + 1;
        if (param_1[0xc] == 0) {
          uVar8 = 4;
        }
        else {
          uVar8 = param_1[0xc] + 3 & 0xfffffffc;
        }
        uVar8 = FUN_6b839286(local_21c,uVar8,&local_21c);
        if ((int)uVar8 < 0) {
          iVar4 = -0x3fffff6b;
          goto LAB_6b83842a;
        }
      }
      if (*(ushort *)((int)param_1 + 0x96) == 0) {
        local_1b0 = (void *)0x0;
        uVar8 = local_21c;
      }
      else {
        uVar8 = local_21c + (*(ushort *)((int)param_1 + 0x96) + 3 & 0xfffffffc);
        iVar4 = iVar4 + 1;
      }
      if (param_1[0x1f] == 0) {
        local_1a0 = (void *)0x0;
      }
      else {
        uVar8 = uVar8 + (param_1[0x1f] + 3 & 0xfffffffc);
        iVar4 = iVar4 + 1;
      }
      if (param_1[0x21] == 0) {
        local_198 = (void *)0x0;
      }
      else {
        uVar8 = uVar8 + (param_1[0x21] + 3 & 0xfffffffc);
        iVar4 = iVar4 + 1;
      }
      if (param_1[0x23] == 0) {
        local_190 = (void *)0x0;
      }
      else {
        uVar8 = uVar8 + (param_1[0x23] + 3 & 0xfffffffc);
        iVar4 = iVar4 + 1;
      }
      uVar8 = CsrAllocateCaptureBuffer(iVar4,uVar8);
      local_21c = uVar8;
      if (uVar8 == 0) {
LAB_6b83869f:
        iVar4 = -0x3fffffe9;
      }
      else {
        if (param_1[7] == 0) {
          local_1bc = (void *)0x0;
        }
        else {
          CsrAllocateMessagePointer(uVar8,*(undefined2 *)(param_1 + 0x24),&local_1bc);
        }
        if (*(short *)((int)param_1 + 0x92) == 0) {
          local_1b8 = (void *)0x0;
        }
        else {
          CsrAllocateMessagePointer(uVar8,*(short *)((int)param_1 + 0x92),&local_1b8);
        }
        if (*(short *)(param_1 + 0x25) == 0) {
          local_1b4 = (void *)0x0;
        }
        else {
          CsrAllocateMessagePointer(uVar8,*(short *)(param_1 + 0x25),&local_1b4);
        }
        if (param_1[0xc] == 0) {
          local_1ac = (void *)0x0;
        }
        else {
          CsrAllocateMessagePointer(uVar8,param_1[0xc],&local_1ac);
        }
        if (*(short *)((int)param_1 + 0x96) == 0) {
          local_1b0 = (void *)0x0;
        }
        else {
          CsrAllocateMessagePointer(uVar8,*(short *)((int)param_1 + 0x96),&local_1b0);
        }
        CsrAllocateMessagePointer(uVar8,0x44,&local_1a4);
        if (param_1[0x1f] == 0) {
          local_1a0 = (void *)0x0;
        }
        else {
          CsrAllocateMessagePointer(uVar8,param_1[0x1f],&local_1a0);
        }
        if (param_1[0x21] == 0) {
          local_198 = (void *)0x0;
        }
        else {
          CsrAllocateMessagePointer(uVar8,param_1[0x21],&local_198);
        }
        if (param_1[0x23] == 0) {
          local_190 = (void *)0x0;
        }
        else {
          CsrAllocateMessagePointer(uVar8,param_1[0x23],&local_190);
        }
        while (iVar4 = CsrClientCallServer(local_218,uVar8,0x10010007,0x68), local_1d8 != 0) {
          iVar4 = NtWaitForSingleObject(local_1d8,0,0);
          if (iVar4 != 0) {
            CsrFreeCaptureBuffer(uVar8);
            goto LAB_6b83842a;
          }
          local_17e = local_17e & 0xffff0000 | (uint)((ushort)local_17e | 8);
          local_1c0 = 0;
        }
        if ((-1 < iVar4) && (iVar4 = local_1e8, -1 < local_1e8)) {
          local_8 = (undefined *)0x2;
          if (*(short *)(param_1 + 0x24) != 0) {
            memmove((void *)param_1[7],local_1bc,(uint)local_186);
          }
          if (*(short *)((int)param_1 + 0x92) != 0) {
            memmove((void *)param_1[8],local_1b8,(uint)local_184);
          }
          if (*(short *)(param_1 + 0x25) != 0) {
            memmove((void *)param_1[9],local_1b4,(uint)local_182);
          }
          if (param_1[0xb] != 0) {
            memmove((void *)param_1[0xb],local_1ac,local_1a8);
          }
          if (*(short *)((int)param_1 + 0x96) != 0) {
            memmove((void *)param_1[10],local_1b0,(uint)local_180);
          }
          if ((local_17e & 0x200) != 0) {
            memmove(param_1 + 0xd,local_1a4,0x44);
          }
          if (param_1[0x1f] != 0) {
            memmove((void *)param_1[0x1e],local_1a0,local_19c);
            param_1[0xf] = param_1[0x1e];
          }
          if (param_1[0x21] != 0) {
            memmove((void *)param_1[0x20],local_198,local_194);
            param_1[0x10] = param_1[0x20];
          }
          if (param_1[0x23] != 0) {
            memmove((void *)param_1[0x22],local_190,local_18c);
            param_1[0xe] = param_1[0x22];
          }
          *(ushort *)(param_1 + 0x24) = local_186;
          *(ushort *)((int)param_1 + 0x92) = local_184;
          *(ushort *)(param_1 + 0x25) = local_182;
          param_1[0xc] = local_1a8;
          uVar3 = 0x200;
          if ((local_17e & 0x200) == 0) {
            uVar3 = 0;
          }
          *(undefined2 *)(param_1 + 0x26) = uVar3;
          *(undefined2 *)((int)param_1 + 0x9a) = local_188;
          param_1[4] = local_1d4;
          param_1[5] = local_1d0;
          param_1[6] = local_1cc;
          *param_1 = local_1e0;
          param_1[3] = local_1c8;
          *(ushort *)((int)param_1 + 0x96) = local_180;
          param_1[0x1f] = local_19c;
          param_1[0x21] = local_194;
          param_1[0x23] = local_18c;
          param_1[1] = local_1c4;
          *(undefined *)(param_1 + 0x27) = local_17e._2_1_;
          local_8 = (undefined *)0x1;
          FUN_6b838b38();
          local_1e0 = 1;
          goto LAB_6b838431;
        }
        if (iVar4 == -0x3ffffff3) {
          local_224 = local_1a8;
          local_21c = (uint)local_186;
          uVar5 = local_194;
          uVar6 = local_19c;
          uVar9 = local_18c;
          uVar7 = local_180;
          uVar1 = local_182;
          uVar2 = local_184;
        }
        else {
          uVar5 = 0;
          uVar6 = 0;
          uVar7 = 0;
          local_224 = 0;
          uVar1 = 0;
          uVar2 = 0;
          local_21c = 0;
        }
        *(short *)(param_1 + 0x24) = (short)local_21c;
        *(ushort *)((int)param_1 + 0x92) = uVar2;
        *(ushort *)(param_1 + 0x25) = uVar1;
        param_1[0xc] = local_224;
        *(ushort *)((int)param_1 + 0x96) = uVar7;
        param_1[0x1f] = uVar6;
        param_1[0x21] = uVar5;
        param_1[0x23] = uVar9;
        CsrFreeCaptureBuffer(uVar8);
      }
    }
  }
  else {
    memset(&local_1e0,0,0x68);
    local_1e0 = *param_1;
    local_1a8 = param_1[0xc];
    local_190 = (void *)param_1[0x22];
    local_17e = local_17e & 0xffff0000 | (uint)uVar1;
    uVar9 = 0;
    local_21c = 0;
    if (param_1[0xb] != 0) {
      if (local_1a8 == 0) {
        uVar9 = 4;
      }
      else {
        uVar9 = local_1a8 + 3 & 0xfffffffc;
      }
      uVar9 = CsrAllocateCaptureBuffer(1,uVar9);
      local_21c = uVar9;
      if (uVar9 == 0) goto LAB_6b83869f;
      CsrAllocateMessagePointer(uVar9,param_1[0xc],&local_1ac);
      memmove(local_1ac,(void *)param_1[0xb],param_1[0xc]);
    }
    iVar4 = CsrClientCallServer(local_218,uVar9,0x10010007,0x68);
    if ((-1 < iVar4) && (iVar4 = local_1e8, -1 < local_1e8)) {
      local_8 = (undefined *)0x0;
      if (param_1[0xb] != 0) {
        memmove((void *)param_1[0xb],local_1ac,param_1[0xc]);
      }
      local_8 = (undefined *)0xfffffffe;
      *param_1 = local_1e0;
      param_1[0xc] = local_1a8;
      if (uVar9 != 0) {
        CsrFreeCaptureBuffer(uVar9);
      }
LAB_6b838bb5:
      local_1e0 = 1;
      goto LAB_6b838431;
    }
    if (uVar9 != 0) {
      CsrFreeCaptureBuffer(uVar9);
    }
  }
LAB_6b83842a:
  BaseSetLastNTError(iVar4);
  local_1e0 = 0;
LAB_6b838431:
  *in_FS_OFFSET = local_14;
  return local_1e0;
}



void FUN_6b838b38(void)

{
  undefined4 unaff_EBX;
  
  CsrFreeCaptureBuffer(unaff_EBX);
  return;
}



// WARNING: Function: __SEH_prolog4_GS replaced with injection: SEH_prolog4

uint GetVDMCurrentDirectories(uint param_1,void *param_2)

{
  uint _Size;
  int iVar1;
  undefined4 *in_FS_OFFSET;
  int local_21c;
  undefined local_218 [48];
  int local_1e8;
  uint local_1e0;
  void *local_1dc;
  uint local_1d8;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x38bd0  798  GetVDMCurrentDirectories
  local_8 = &DAT_6b891f60;
  uStack12 = 0x6b838bdf;
  local_1e0 = FUN_6b838215();
  if (local_1e0 == 0xffffffff) {
    BaseSetLastNTError(0xc000000d);
    _Size = 0;
    goto LAB_6b838d1b;
  }
  local_8 = (undefined *)0x0;
  if ((param_1 == 0) || (param_2 == (void *)0x0)) {
    local_1d8 = 0;
    local_1dc = (void *)0x0;
    local_21c = 0;
LAB_6b838c6f:
    local_1e8 = -1;
    iVar1 = CsrClientCallServer(local_218,local_21c,0x1001000f,0xc);
    _Size = -(uint)(local_1e8 != -1) & local_1d8;
    local_1d8 = _Size;
    if ((iVar1 < 0) || (iVar1 = local_1e8, local_1e8 < 0)) {
      BaseSetLastNTError(iVar1);
      _Size = local_1d8;
    }
    else {
      local_8 = (undefined *)0x1;
      memmove(param_2,local_1dc,_Size);
    }
  }
  else {
    local_21c = CsrAllocateCaptureBuffer(1,param_1);
    if (local_21c != 0) {
      CsrAllocateMessagePointer(local_21c,param_1,&local_1dc);
      local_1d8 = param_1;
      goto LAB_6b838c6f;
    }
    BaseSetLastNTError(0xc0000017);
    _Size = 0;
  }
  local_8 = (undefined *)0xfffffffe;
  FUN_6b838d33();
LAB_6b838d1b:
  *in_FS_OFFSET = local_14;
  return _Size;
}



void FUN_6b838d33(void)

{
  int unaff_EBP;
  
  if (*(int *)(unaff_EBP + -0x218) != 0) {
    CsrFreeCaptureBuffer(*(int *)(unaff_EBP + -0x218));
  }
  return;
}



undefined4 __fastcall FUN_6b838d45(LPCWSTR param_1,undefined4 *param_2,DWORD *param_3)

{
  byte bVar1;
  DWORD DVar2;
  BOOL BVar3;
  int iVar4;
  char cVar5;
  byte bVar6;
  WCHAR *pWVar7;
  uint uVar8;
  wchar_t *_Str1;
  WCHAR WVar9;
  undefined4 uVar10;
  undefined *local_24 [2];
  HANDLE local_1c;
  uint local_18;
  uint local_14;
  undefined local_10 [4];
  LPCWSTR local_c;
  uint local_8;
  
  uVar10 = 0;
  *param_3 = 0;
  *param_2 = 0;
  local_c = param_1;
  local_18 = FUN_6b860f8c();
  if ((local_18 & 1) != 0) {
    return 0;
  }
  local_8 = 0x5a5a5a5a;
  local_1c = CreateFileW(local_c,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0x0);
  if (local_1c == (HANDLE)0xffffffff) {
    *param_2 = 1;
    DVar2 = GetLastError();
    *param_3 = DVar2;
    return 0;
  }
  BVar3 = ReadFile(local_1c,&local_8,4,&local_14,(LPOVERLAPPED)0x0);
  if (BVar3 == 0) {
    *param_2 = 2;
    DVar2 = GetLastError();
    *param_3 = DVar2;
    goto LAB_6b838f66;
  }
  *param_3 = local_8;
  if (local_14 == 0) {
    *param_2 = 4;
  }
  else {
    cVar5 = (char)local_8;
    if (local_14 == 1) {
      if (cVar5 == '\0') {
        *param_2 = 6;
      }
      else {
        if (cVar5 != -1) goto LAB_6b838f66;
        *param_2 = 5;
      }
    }
    else {
      if (local_14 < 2) goto LAB_6b838f66;
      if (local_14 < 4) {
        if ((short)local_8 == 0) {
          *param_2 = 8;
        }
        else {
          if ((short)local_8 != -1) goto LAB_6b838f66;
          *param_2 = 7;
        }
      }
      else {
        if (local_14 != 4) goto LAB_6b838f66;
        if (local_8 == 0) {
          *param_2 = 0xb;
        }
        else if (local_8 == 0xffffffff) {
          *param_2 = 10;
        }
        else {
          if (cVar5 != '<') goto LAB_6b838f66;
          _Str1 = (wchar_t *)0x0;
          WVar9 = *local_c;
          pWVar7 = local_c;
          if (WVar9 == L'\0') goto LAB_6b838f66;
          do {
            if (WVar9 == L'.') {
              _Str1 = pWVar7 + 1;
            }
            WVar9 = pWVar7[1];
            pWVar7 = pWVar7 + 1;
          } while (WVar9 != L'\0');
          if ((_Str1 == (wchar_t *)0x0) ||
             (iVar4 = _wcsicmp(_Str1,(wchar_t *)&_Str2_6b887318), iVar4 != 0)) goto LAB_6b838f66;
          uVar8 = local_8 >> 8;
          cVar5 = (char)(local_8 >> 8);
          if ((cVar5 != '?') && (cVar5 != '!')) {
            bVar6 = (byte)(local_8 >> 0x18);
            bVar1 = (byte)(local_8 >> 0x10);
            if (cVar5 == '\0') {
              local_8 = uVar8;
              if ((bVar1 < 0x20) || ((0x7a < bVar1 || (bVar6 != 0)))) goto LAB_6b838f66;
            }
            else {
              local_8 = uVar8;
              if ((((0x39 < (byte)(cVar5 + 0xbfU)) || (bVar1 < 0x41)) || (0x7a < bVar1)) ||
                 ((bVar6 < 0x41 || (0x7a < bVar6)))) goto LAB_6b838f66;
            }
          }
          *param_2 = 0xc;
          local_8 = uVar8;
        }
      }
    }
  }
  RtlSetLastWin32Error(0xc1);
  uVar10 = 1;
  if ((local_18 & 2) != 0) {
    RtlInitUnicodeString(local_10,local_c);
    local_24[0] = local_10;
    NtRaiseHardError(0xc0000102,1,1,local_24,1,&local_18);
    uVar10 = 1;
  }
LAB_6b838f66:
  CloseHandle(local_1c);
  return uVar10;
}



void __fastcall FUN_6b838f78(undefined4 param_1,undefined4 param_2,uint *param_3,short **param_4)

{
  uint uVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined auStack200 [4];
  short *local_c4;
  short *local_c0;
  short *local_bc;
  short *local_b8;
  short *local_b4;
  _EVENT_DATA_DESCRIPTOR local_b0 [2];
  short *local_90 [4];
  short *local_80 [4];
  short *local_70 [4];
  short **local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined4 local_54;
  short **local_50;
  undefined4 local_4c;
  undefined4 local_48;
  undefined4 local_44;
  short **local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  short **local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  short **local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)auStack200;
  if (5 < *param_3) {
    uVar1 = FUN_6b839446((int)param_3);
    param_2 = extraout_EDX;
    if ((char)uVar1 != '\0') {
      FUN_6b839407(local_90,*param_4);
      FUN_6b839407(local_80,(short *)(param_4 + 9));
      FUN_6b839407(local_70,(short *)(param_4 + 0x49));
      local_c4 = param_4[1];
      local_60 = &local_c4;
      local_c0 = param_4[2];
      local_50 = &local_c0;
      local_bc = param_4[3];
      local_40 = &local_bc;
      local_b8 = param_4[4];
      local_30 = &local_b8;
      local_b4 = param_4[5];
      local_20 = &local_b4;
      local_5c = 0;
      local_58 = 4;
      local_54 = 0;
      local_4c = 0;
      local_48 = 4;
      local_44 = 0;
      local_3c = 0;
      local_38 = 4;
      local_34 = 0;
      local_2c = 0;
      local_28 = 4;
      local_24 = 0;
      local_1c = 0;
      local_18 = 4;
      local_14 = 0;
      FUN_6b839476((int)param_3,&DAT_6b886ae9,4,4,10,local_b0);
      param_2 = extraout_EDX_00;
    }
  }
  FUN_6b8224af(local_c ^ (uint)auStack200,param_2);
  return;
}



void RegisterWowExec(undefined4 param_1)

{
  undefined4 extraout_EDX;
  undefined local_208 [56];
  undefined4 local_1d0;
  uint local_1cc;
  uint local_c;
  
                    // 0x390e0  1201  RegisterWowExec
  local_c = DAT_6b8b0140 ^ (uint)local_208;
  local_1d0 = param_1;
  local_1cc = FUN_6b838215();
  CsrClientCallServer(local_208,0,0x10010011,8);
  FUN_6b8224af(local_c ^ (uint)local_208,extraout_EDX);
  return;
}



// WARNING: Function: __SEH_prolog4_GS replaced with injection: SEH_prolog4

undefined4 SetVDMCurrentDirectories(size_t param_1,void *param_2)

{
  undefined4 uVar1;
  int iVar2;
  undefined4 *in_FS_OFFSET;
  int iVar3;
  undefined local_218 [48];
  int local_1e8;
  uint local_1e0;
  void *local_1dc;
  size_t local_1d8;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x39140  1398  SetVDMCurrentDirectories
  local_8 = &DAT_6b891f88;
  uStack12 = 0x6b83914f;
  local_1e0 = FUN_6b838215();
  if (local_1e0 == 0xffffffff) {
    iVar3 = -0x3ffffff3;
  }
  else {
    if ((param_1 == 0) || (param_2 == (void *)0x0)) {
LAB_6b839271:
      uVar1 = 1;
      goto LAB_6b839274;
    }
    iVar2 = CsrAllocateCaptureBuffer(1,param_1);
    if (iVar2 == 0) {
      iVar3 = -0x3fffffe9;
    }
    else {
      CsrAllocateMessagePointer(iVar2,param_1,&local_1dc);
      local_1d8 = param_1;
      local_8 = (undefined *)0x1;
      memmove(local_1dc,param_2,param_1);
      local_8 = (undefined *)0x0;
      FUN_6b83922d();
      local_8 = (undefined *)0xfffffffe;
      iVar3 = CsrClientCallServer(local_218,iVar2,0x1001000e,0xc);
      CsrFreeCaptureBuffer(iVar2);
      if ((-1 < iVar3) && (-1 < local_1e8)) goto LAB_6b839271;
    }
  }
  BaseSetLastNTError(iVar3);
  uVar1 = 0;
LAB_6b839274:
  *in_FS_OFFSET = local_14;
  return uVar1;
}



void FUN_6b83922d(void)

{
  int unaff_EBP;
  undefined4 unaff_ESI;
  
  if (*(int *)(unaff_EBP + -0x21c) != 0) {
    CsrFreeCaptureBuffer(unaff_ESI);
  }
  return;
}



uint __fastcall FUN_6b839286(uint param_1,int param_2,uint *param_3)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = param_1 + param_2;
  uVar2 = uVar1;
  if (uVar1 < param_1) {
    uVar2 = 0xffffffff;
  }
  *param_3 = uVar2;
  return -(uint)(uVar1 < param_1) & 0x80070216;
}



void __fastcall FUN_6b8392ab(LPCWSTR param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  WCHAR WVar1;
  byte bVar2;
  int iVar3;
  int iVar4;
  LPCWSTR pWVar5;
  undefined4 extraout_ECX;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar6;
  WCHAR *pWVar7;
  LPCWSTR local_234;
  int local_230;
  undefined4 local_22c;
  uint local_228;
  undefined4 local_224;
  undefined4 local_220;
  int local_21c;
  undefined4 local_218;
  LPCWSTR local_214;
  undefined local_210 [520];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  WVar1 = *param_1;
  pWVar7 = param_1;
  pWVar5 = param_1;
  while (WVar1 != L'\0') {
    if (WVar1 == L'\\') {
      pWVar5 = pWVar7 + 1;
    }
    pWVar7 = pWVar7 + 1;
    WVar1 = *pWVar7;
  }
  iVar3 = FUN_6b83805e(pWVar5);
  uVar6 = extraout_EDX;
  if (iVar3 != 0) {
    bVar2 = FUN_6b860f8c();
    iVar3 = FUN_6b861035('\x01');
    iVar4 = FUN_6b861035('\0');
    local_230 = iVar4 + (-(uint)((bVar2 & 1) != 0) & 9) + iVar3 * 3;
    local_228 = 0;
    memset(local_210,0,0x200);
    do {
      if (param_2 == (&DAT_6b8873d0)[local_228]) break;
      local_228 = local_228 + 1;
    } while (local_228 < 10);
    if (9 < local_228) {
      local_228 = 9;
    }
    local_22c = 10;
    local_224 = param_3;
    local_220 = param_4;
    local_21c = 1;
    local_218 = 0x20c;
    local_234 = pWVar5;
    local_214 = param_1;
    FUN_6b850f86(&local_21c);
    FUN_6b861110(extraout_ECX,&local_234);
    uVar6 = extraout_EDX_00;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar6);
  return;
}



void VDMOperationStarted(int param_1)

{
                    // 0x393f0  1476  VDMOperationStarted
  BaseUpdateVDMEntry(2,(int *)0x0,0,param_1);
  return;
}



void __fastcall FUN_6b839407(short **param_1,short *param_2)

{
  short sVar1;
  short *psVar2;
  
  if (param_2 == (short *)0x0) {
    param_2 = &DAT_6b884240;
    psVar2 = (short *)0x2;
  }
  else {
    psVar2 = param_2;
    do {
      sVar1 = *psVar2;
      psVar2 = psVar2 + 1;
    } while (sVar1 != 0);
    psVar2 = (short *)(((int)psVar2 - (int)(param_2 + 1) >> 1) * 2 + 2);
  }
  param_1[2] = psVar2;
  param_1[1] = (short *)0x0;
  param_1[3] = (short *)0x0;
  *param_1 = param_2;
  return;
}



uint __fastcall FUN_6b839446(int param_1)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = 0;
  uVar2 = *(uint *)(param_1 + 0xc) & 0x4000;
  if (((uVar2 != 0) && (uVar2 = *(uint *)(param_1 + 0x14) & 0x4000, *(int *)(param_1 + 0x10) == 0))
     && (uVar2 == *(uint *)(param_1 + 0x14))) {
    uVar1 = 1;
  }
  return uVar2 | uVar1;
}



void __fastcall
FUN_6b839476(int param_1,byte *param_2,undefined4 param_3,undefined4 param_4,ULONG param_5,
            PEVENT_DATA_DESCRIPTOR param_6)

{
  int local_18;
  uint local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  local_18 = (uint)*param_2 << 0x18;
  local_14 = (uint)*(ushort *)(param_2 + 1);
  local_10 = *(undefined4 *)(param_2 + 3);
  local_c = *(undefined4 *)(param_2 + 7);
  *(undefined4 *)&param_6->Ptr = *(undefined4 *)(param_1 + 4);
  *(undefined4 *)((int)&param_6->Ptr + 4) = 0;
  param_6->Size = (uint)**(ushort **)(param_1 + 4);
  param_6->Reserved = 2;
  *(byte **)&param_6[1].Ptr = param_2 + 0xb;
  *(undefined4 *)((int)&param_6[1].Ptr + 4) = 0;
  param_6[1].Size = (uint)*(ushort *)(param_2 + 0xb);
  param_6[1].Reserved = 1;
  local_8 = 0x1e4;
  EventWriteTransfer(*(REGHANDLE *)(param_1 + 0x18),(PCEVENT_DESCRIPTOR)&local_18,(LPCGUID)0x0,
                     (LPCGUID)0x0,param_5,param_6);
  return;
}



void __fastcall FUN_6b8394fa(char **param_1)

{
  char *pcVar1;
  
  pcVar1 = param_1[1];
  *param_1 = pcVar1;
  while (*pcVar1 == ' ') {
    *param_1 = *param_1 + 1;
    pcVar1 = *param_1;
  }
  return;
}



BOOL BuildCommDCBA(LPCSTR lpDef,LPDCB lpDCB)

{
  int iVar1;
  BOOL BVar2;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar3;
  undefined4 local_1c [5];
  uint local_8;
  
                    // 0x39510  110  BuildCommDCBA
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  iVar1 = FUN_6b83965c(lpDef,(int)lpDCB,local_1c);
  uVar3 = extraout_EDX;
  if (iVar1 == 0) {
    RtlSetLastWin32Error(0x57);
    uVar3 = extraout_EDX_00;
  }
  BVar2 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar3);
  return BVar2;
}



BOOL BuildCommDCBAndTimeoutsA(LPCSTR lpDef,LPDCB lpDCB,LPCOMMTIMEOUTS lpCommTimeouts)

{
  int iVar1;
  
                    // 0x39560  111  BuildCommDCBAndTimeoutsA
  iVar1 = FUN_6b83965c(lpDef,(int)lpDCB,&lpCommTimeouts->ReadIntervalTimeout);
  if (iVar1 == 0) {
    RtlSetLastWin32Error(0x57);
  }
  return (uint)(iVar1 != 0);
}



BOOL BuildCommDCBAndTimeoutsW(LPCWSTR lpDef,LPDCB lpDCB,LPCOMMTIMEOUTS lpCommTimeouts)

{
  int iVar1;
  BOOL BVar2;
  undefined local_18 [4];
  LPCSTR local_14;
  undefined local_10 [12];
  
                    // 0x39590  112  BuildCommDCBAndTimeoutsW
  RtlInitUnicodeString(local_10,lpDef);
  iVar1 = RtlUnicodeStringToAnsiString(local_18,local_10,1);
  if (iVar1 < 0) {
    BaseSetLastNTError(iVar1);
    BVar2 = 0;
  }
  else {
    BVar2 = BuildCommDCBAndTimeoutsA(local_14,lpDCB,lpCommTimeouts);
    RtlFreeAnsiString(local_18);
  }
  return BVar2;
}



BOOL BuildCommDCBW(LPCWSTR lpDef,LPDCB lpDCB)

{
  int iVar1;
  BOOL BVar2;
  undefined local_18 [4];
  LPCSTR local_14;
  undefined local_10 [12];
  
                    // 0x39600  113  BuildCommDCBW
  RtlInitUnicodeString(local_10,lpDef);
  iVar1 = RtlUnicodeStringToAnsiString(local_18,local_10,1);
  if (iVar1 < 0) {
    BaseSetLastNTError(iVar1);
    BVar2 = 0;
  }
  else {
    BVar2 = BuildCommDCBA(local_14,lpDCB);
    RtlFreeAnsiString(local_18);
  }
  return BVar2;
}



undefined4 __fastcall FUN_6b83965c(char *param_1,int param_2,undefined4 *param_3)

{
  byte bVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  long lVar5;
  uint uVar6;
  char **extraout_ECX;
  char **extraout_ECX_00;
  char **extraout_ECX_01;
  char **extraout_ECX_02;
  char **extraout_ECX_03;
  int extraout_EDX;
  int extraout_EDX_00;
  undefined local_96;
  undefined local_95;
  int local_94;
  undefined2 local_90;
  undefined local_8e;
  undefined local_8d;
  char *local_8c;
  char *local_88;
  char *local_84;
  char *local_80;
  int local_7c;
  int local_78;
  int local_74;
  uint local_70;
  int local_6c;
  int local_68;
  int local_64;
  int local_60;
  int local_5c;
  int local_58;
  int local_54;
  int local_50;
  int local_4c;
  int local_48;
  int local_44;
  code *local_40 [3];
  char **local_34;
  
  local_94 = 0;
  local_95 = 0;
  local_96 = 0;
  uVar6 = 0;
  local_5c = 0;
  local_74 = 0;
  bVar1 = 0;
  local_58 = 0;
  local_44 = 0;
  local_6c = 0;
  local_60 = 0;
  local_54 = 0;
  local_68 = 0;
  local_4c = 0;
  local_48 = 0;
  local_70 = 0;
  local_8e = 0;
  local_8d = 0;
  local_78 = 0;
  local_7c = 0;
  local_50 = 0;
  local_64 = 0;
  local_90 = 0;
  local_84 = (char *)0x0;
  local_80 = (char *)0x0;
  local_8c = param_1;
  local_88 = param_1;
  memset(local_40,0,0x38);
  local_40[0] = FUN_6b83a070;
  local_34 = &local_8c;
  RtlQueryRegistryValuesEx(4,L"SERIALCOMM",local_40,0,0);
  iVar2 = FUN_6b83a0d6(&local_8c,"#");
  if (iVar2 == 0) {
    if (*local_8c != '\0') {
      do {
        iVar2 = FUN_6b83a0d6(&local_8c,"BAUD=#");
        if (iVar2 == 0) {
          iVar2 = FUN_6b83a0d6(&local_8c,"PARITY=@");
          if (iVar2 == 0) {
            iVar2 = FUN_6b83a0d6(&local_8c,"DATA=#");
            if (iVar2 == 0) {
              iVar2 = FUN_6b83a0d6(&local_8c,"STOP=1.5");
              if (iVar2 == 0) {
                iVar2 = FUN_6b83a0d6(&local_8c,"STOP=#");
                if (iVar2 == 0) {
                  iVar2 = FUN_6b83a0d6(&local_8c,"TO=ON");
                  if (iVar2 == 0) {
                    iVar2 = FUN_6b83a0d6(&local_8c,"TO=OFF");
                    if (iVar2 == 0) {
                      iVar2 = FUN_6b83a0d6(&local_8c,"XON=ON");
                      if (iVar2 == 0) {
                        iVar2 = FUN_6b83a0d6(&local_8c,"XON=OFF");
                        if (iVar2 == 0) {
                          iVar2 = FUN_6b83a0d6(&local_8c,"ODSR=ON");
                          if (iVar2 == 0) {
                            iVar2 = FUN_6b83a0d6(&local_8c,"ODSR=OFF");
                            if (iVar2 == 0) {
                              iVar2 = FUN_6b83a0d6(&local_8c,"IDSR=ON");
                              if (iVar2 == 0) {
                                iVar2 = FUN_6b83a0d6(&local_8c,"IDSR=OFF");
                                if (iVar2 == 0) {
                                  iVar2 = FUN_6b83a0d6(&local_8c,"OCTS=ON");
                                  if (iVar2 == 0) {
                                    iVar2 = FUN_6b83a0d6(&local_8c,"OCTS=OFF");
                                    if (iVar2 == 0) {
                                      iVar2 = FUN_6b83a0d6(&local_8c,"DTR=*");
                                      if (iVar2 == 0) {
                                        iVar2 = FUN_6b83a0d6(&local_8c,"RTS=*");
                                        if (iVar2 == 0) {
                                          return 0;
                                        }
                                        iVar2 = FUN_6b839f62(local_84,local_80,
                                                             (undefined *)((int)&local_90 + 1));
                                        if (iVar2 == 0) {
                                          return 0;
                                        }
                                        local_48 = 1;
                                      }
                                      else {
                                        iVar2 = FUN_6b839e62(local_84,local_80,
                                                             (undefined *)&local_90);
                                        if (iVar2 == 0) {
                                          return 0;
                                        }
                                        local_4c = 1;
                                      }
                                    }
                                    else {
                                      local_64 = 0;
                                      local_68 = 1;
                                    }
                                  }
                                  else {
                                    local_68 = 1;
                                    local_64 = 1;
                                  }
                                }
                                else {
                                  local_50 = 0;
                                  local_54 = 1;
                                }
                              }
                              else {
                                local_54 = 1;
                                local_50 = 1;
                              }
                            }
                            else {
                              local_7c = 0;
                              local_60 = 1;
                            }
                          }
                          else {
                            local_60 = 1;
                            local_7c = 1;
                          }
                        }
                        else {
                          local_78 = 0;
                          local_6c = 1;
                        }
                      }
                      else {
                        local_6c = 1;
                        local_78 = 1;
                      }
                    }
                    else {
                      local_44 = 1;
                      bVar1 = 0;
                    }
                  }
                  else {
                    bVar1 = 1;
                    local_44 = 1;
                  }
                }
                else {
                  lVar5 = atol(local_84);
                  iVar2 = FUN_6b83a04f(lVar5,&local_96);
                  if (iVar2 == 0) {
                    return 0;
                  }
                  local_74 = 1;
                  local_95 = local_96;
                }
              }
              else {
                local_74 = 1;
                local_95 = 1;
                local_96 = 1;
              }
            }
            else {
              lVar5 = atol(local_84);
              iVar2 = FUN_6b839e45(lVar5,&local_8e);
              if (iVar2 == 0) {
                return 0;
              }
              local_5c = 1;
            }
          }
          else {
            iVar2 = FUN_6b839f19(*local_84,&local_8d);
            if (iVar2 == 0) {
              return 0;
            }
            local_58 = 1;
          }
        }
        else {
          uVar6 = atol(local_84);
          iVar2 = FUN_6b839d7d(uVar6,&local_70);
          if (iVar2 == 0) {
            return 0;
          }
          local_94 = 1;
        }
        FUN_6b8394fa(&local_8c);
      } while (*local_8c != '\0');
      uVar6 = (uint)local_90;
      local_94 = extraout_EDX_00;
      if (extraout_EDX_00 != 0) goto LAB_6b839c56;
      goto LAB_6b839c63;
    }
  }
  else {
    local_78 = 0;
    local_7c = 0;
    uVar6 = 0x101;
    uVar3 = atol(local_84);
    iVar2 = FUN_6b839d7d(uVar3,&local_70);
    if (iVar2 == 0) {
      return 0;
    }
    local_94 = 1;
    FUN_6b8394fa(&local_8c);
    iVar4 = FUN_6b83a0d6(extraout_ECX,",");
    iVar2 = local_7c;
    if (iVar4 != 0) {
      FUN_6b8394fa(&local_8c);
      iVar2 = FUN_6b83a0d6(extraout_ECX_00,",");
      if ((iVar2 == 0) && (iVar2 = FUN_6b83a0d6(&local_8c,"@"), iVar2 != 0)) {
        iVar2 = FUN_6b839f19(*local_84,&local_8d);
        if (iVar2 == 0) {
          return 0;
        }
        local_58 = 1;
        FUN_6b8394fa(&local_8c);
      }
      iVar4 = FUN_6b83a0d6(&local_8c,",");
      iVar2 = local_7c;
      if (iVar4 != 0) {
        FUN_6b8394fa(&local_8c);
        iVar2 = FUN_6b83a0d6(extraout_ECX_01,"#");
        if (iVar2 != 0) {
          lVar5 = atol(local_84);
          iVar2 = FUN_6b839e45(lVar5,&local_8e);
          if (iVar2 == 0) {
            return 0;
          }
          local_5c = 1;
          FUN_6b8394fa(&local_8c);
        }
        iVar4 = FUN_6b83a0d6(&local_8c,",");
        iVar2 = local_7c;
        if (iVar4 != 0) {
          FUN_6b8394fa(&local_8c);
          iVar2 = FUN_6b83a0d6(extraout_ECX_02,"1.5");
          if (iVar2 == 0) {
            iVar2 = FUN_6b83a0d6(&local_8c,"#");
            if (iVar2 != 0) {
              lVar5 = atol(local_84);
              iVar2 = FUN_6b83a04f(lVar5,&local_96);
              if (iVar2 == 0) {
                return 0;
              }
              local_74 = 1;
              FUN_6b8394fa(&local_8c);
              local_95 = local_96;
            }
          }
          else {
            local_95 = 1;
            local_74 = 1;
            FUN_6b8394fa(&local_8c);
          }
          iVar4 = FUN_6b83a0d6(&local_8c,",");
          iVar2 = local_7c;
          if (iVar4 != 0) {
            FUN_6b8394fa(&local_8c);
            iVar2 = FUN_6b83a0d6(extraout_ECX_03,"x");
            if (iVar2 == 0) {
              iVar2 = FUN_6b83a0d6(&local_8c,"p");
              local_78 = 0;
              if (iVar2 == 0) {
                local_7c = 0;
                iVar2 = 0;
                goto LAB_6b839919;
              }
              local_7c = 1;
              uVar6 = 0x202;
            }
            else {
              local_78 = 1;
              local_7c = 0;
            }
            FUN_6b8394fa(&local_8c);
            iVar2 = extraout_EDX;
          }
        }
      }
    }
LAB_6b839919:
    if (*local_8c != '\0') {
      return 0;
    }
    local_60 = 1;
    local_68 = 1;
    local_4c = 1;
    local_48 = 1;
    local_6c = 1;
    local_64 = iVar2;
LAB_6b839c56:
    *(uint *)(param_2 + 4) = local_70;
LAB_6b839c63:
    if (local_5c != 0) {
      *(undefined *)(param_2 + 0x12) = local_8e;
    }
    if (local_74 != 0) {
      *(undefined *)(param_2 + 0x14) = local_95;
      goto LAB_6b839c9b;
    }
    if ((local_94 != 0) && (local_70 == 0x6e)) {
      *(undefined *)(param_2 + 0x14) = 2;
      goto LAB_6b839c9b;
    }
  }
  *(undefined *)(param_2 + 0x14) = 0;
LAB_6b839c9b:
  if (local_58 != 0) {
    *(undefined *)(param_2 + 0x13) = local_8d;
  }
  if (local_6c != 0) {
    if (local_78 == 0) {
      uVar3 = *(uint *)(param_2 + 8) & 0xfffffcff;
    }
    else {
      uVar3 = *(uint *)(param_2 + 8) | 0x300;
    }
    *(uint *)(param_2 + 8) = uVar3;
  }
  if (local_68 != 0) {
    if (local_64 == 0) {
      uVar3 = *(uint *)(param_2 + 8) & 0xfffffffb;
    }
    else {
      uVar3 = *(uint *)(param_2 + 8) | 4;
    }
    *(uint *)(param_2 + 8) = uVar3;
  }
  if (local_60 != 0) {
    if (local_7c == 0) {
      uVar3 = *(uint *)(param_2 + 8) & 0xfffffff7;
    }
    else {
      uVar3 = *(uint *)(param_2 + 8) | 8;
    }
    *(uint *)(param_2 + 8) = uVar3;
  }
  if (local_54 != 0) {
    if (local_50 == 0) {
      uVar3 = *(uint *)(param_2 + 8) & 0xffffffbf;
    }
    else {
      uVar3 = *(uint *)(param_2 + 8) | 0x40;
    }
    *(uint *)(param_2 + 8) = uVar3;
  }
  if (local_4c != 0) {
    *(uint *)(param_2 + 8) =
         *(uint *)(param_2 + 8) ^ ((uVar6 & 0xff) << 4 ^ *(uint *)(param_2 + 8)) & 0x30;
  }
  if (local_48 != 0) {
    *(uint *)(param_2 + 8) =
         *(uint *)(param_2 + 8) ^ ((uVar6 >> 8) << 0xc ^ *(uint *)(param_2 + 8)) & 0x3000;
  }
  if (local_44 != 0) {
    *param_3 = 0;
    param_3[1] = 0;
    param_3[2] = 0;
    param_3[3] = 0;
    param_3[4] = -(uint)bVar1 & 60000;
  }
  return 1;
}



undefined4 __fastcall FUN_6b839d7d(uint param_1,uint *param_2)

{
  uint uVar1;
  bool bVar2;
  
  if (param_1 < 0x6f) {
    uVar1 = 0x6e;
    if (param_1 == 0x6e) goto LAB_6b839e3c;
    if (param_1 < 0x19) {
      if (param_1 == 0x18) goto LAB_6b839e1b;
      if (param_1 == 0xb) goto LAB_6b839e3c;
      if (param_1 == 0xc) {
LAB_6b839dff:
        uVar1 = 0x4b0;
        goto LAB_6b839e3c;
      }
      if (param_1 == 0xf) goto LAB_6b839e14;
      bVar2 = param_1 == 0x13;
      goto LAB_6b839e2d;
    }
    if (param_1 != 0x1e) {
      if (param_1 != 0x30) {
        if (param_1 == 0x3c) goto LAB_6b839e06;
        uVar1 = param_1;
        if (param_1 != 0x60) goto LAB_6b839e3c;
        goto LAB_6b839dd5;
      }
      goto LAB_6b839e3a;
    }
  }
  else {
    if (0x960 < param_1) {
      if (param_1 == 0x12c0) {
LAB_6b839e3a:
        uVar1 = 0x12c0;
        goto LAB_6b839e3c;
      }
      if (param_1 == 0x2580) {
LAB_6b839dd5:
        uVar1 = 0x2580;
        goto LAB_6b839e3c;
      }
      bVar2 = param_1 == 0x4b00;
LAB_6b839e2d:
      uVar1 = param_1;
      if (bVar2) {
        uVar1 = 0x4b00;
      }
      goto LAB_6b839e3c;
    }
    if (param_1 == 0x960) {
LAB_6b839e1b:
      uVar1 = 0x960;
      goto LAB_6b839e3c;
    }
    if (param_1 == 0x96) {
LAB_6b839e14:
      uVar1 = 0x96;
      goto LAB_6b839e3c;
    }
    if (param_1 != 300) {
      if (param_1 != 600) {
        uVar1 = param_1;
        if (param_1 != 0x4b0) goto LAB_6b839e3c;
        goto LAB_6b839dff;
      }
LAB_6b839e06:
      uVar1 = 600;
      goto LAB_6b839e3c;
    }
  }
  uVar1 = 300;
LAB_6b839e3c:
  *param_2 = uVar1;
  return 1;
}



undefined4 __fastcall FUN_6b839e45(int param_1,undefined *param_2)

{
  if ((((param_1 != 5) && (param_1 != 6)) && (param_1 != 7)) && (param_1 != 8)) {
    return 0;
  }
  *param_2 = (char)param_1;
  return 1;
}



undefined4 __fastcall FUN_6b839e62(char *param_1,char *param_2,undefined *param_3)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = tolower((int)*param_1);
  if (iVar1 == 0x6f) {
    iVar1 = tolower((int)param_1[1]);
    if ((iVar1 != 0x6e) || (param_2 != param_1 + 1)) goto LAB_6b839ea0;
    *param_3 = 1;
LAB_6b839e9b:
    uVar2 = 1;
  }
  else {
LAB_6b839ea0:
    iVar1 = tolower((int)*param_1);
    if (iVar1 == 0x6f) {
      iVar1 = tolower((int)param_1[1]);
      if (iVar1 == 0x66) {
        iVar1 = tolower((int)param_1[2]);
        if ((iVar1 == 0x66) && (param_2 == param_1 + 2)) {
          *param_3 = 0;
          goto LAB_6b839e9b;
        }
      }
    }
    iVar1 = tolower((int)*param_1);
    if (iVar1 == 0x68) {
      iVar1 = tolower((int)param_1[1]);
      if ((iVar1 == 0x73) && (param_2 == param_1 + 2)) {
        *param_3 = 2;
        goto LAB_6b839e9b;
      }
    }
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 __fastcall FUN_6b839f19(char param_1,undefined *param_2)

{
  int iVar1;
  
  iVar1 = tolower((int)param_1);
  if (iVar1 == 0x65) {
    *param_2 = 2;
  }
  else if (iVar1 == 0x6d) {
    *param_2 = 3;
  }
  else if (iVar1 == 0x6e) {
    *param_2 = 0;
  }
  else if (iVar1 == 0x6f) {
    *param_2 = 1;
  }
  else {
    if (iVar1 != 0x73) {
      return 0;
    }
    *param_2 = 4;
  }
  return 1;
}



undefined4 __fastcall FUN_6b839f62(char *param_1,char *param_2,undefined *param_3)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = tolower((int)*param_1);
  if (iVar1 == 0x6f) {
    iVar1 = tolower((int)param_1[1]);
    if ((iVar1 != 0x6e) || (param_2 != param_1 + 1)) goto LAB_6b839fa3;
    *param_3 = 1;
LAB_6b839f9b:
    uVar2 = 1;
  }
  else {
LAB_6b839fa3:
    iVar1 = tolower((int)*param_1);
    if (iVar1 == 0x6f) {
      iVar1 = tolower((int)param_1[1]);
      if (iVar1 == 0x66) {
        iVar1 = tolower((int)param_1[2]);
        if ((iVar1 == 0x66) && (param_2 == param_1 + 2)) {
          *param_3 = 0;
          goto LAB_6b839f9b;
        }
      }
    }
    iVar1 = tolower((int)*param_1);
    if (iVar1 == 0x68) {
      iVar1 = tolower((int)param_1[1]);
      if ((iVar1 == 0x73) && (param_2 == param_1 + 2)) {
        *param_3 = 2;
        goto LAB_6b839f9b;
      }
    }
    iVar1 = tolower((int)*param_1);
    if (iVar1 == 0x74) {
      iVar1 = tolower((int)param_1[1]);
      if ((iVar1 == 0x67) && (param_2 == param_1 + 2)) {
        *param_3 = 3;
        goto LAB_6b839f9b;
      }
    }
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 __fastcall FUN_6b83a04f(int param_1,undefined *param_2)

{
  undefined uVar1;
  
  if (param_1 == 1) {
    uVar1 = 0;
  }
  else {
    if (param_1 != 2) {
      return 0;
    }
    uVar1 = 2;
  }
  *param_2 = uVar1;
  return 1;
}



undefined4
FUN_6b83a070(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
            undefined4 param_5,char **param_6)

{
  int iVar1;
  char **extraout_ECX;
  undefined local_14 [8];
  undefined local_c [4];
  char *local_8;
  
  RtlInitUnicodeString(local_14,param_3);
  iVar1 = RtlUnicodeStringToAnsiString(local_c,local_14,1);
  if (-1 < iVar1) {
    iVar1 = FUN_6b83a0d6(param_6,local_8);
    if (iVar1 != 0) {
      FUN_6b8394fa(param_6);
      iVar1 = FUN_6b83a0d6(extraout_ECX,":");
      if (iVar1 != 0) {
        FUN_6b8394fa(param_6);
      }
    }
    RtlFreeAnsiString(local_c);
  }
  return 0;
}



undefined4 __fastcall FUN_6b83a0d6(char **param_1,char *param_2)

{
  char cVar1;
  char cVar2;
  int iVar3;
  int iVar4;
  char *pcVar5;
  char *local_c;
  
  pcVar5 = *param_1;
  local_c = param_2;
  do {
    cVar2 = *local_c;
    if (cVar2 == '\0') {
      param_1[1] = pcVar5;
      return 1;
    }
    if (cVar2 == '#') {
      param_1[2] = pcVar5;
      param_1[3] = pcVar5;
      cVar2 = *pcVar5;
      while ((cVar2 != '\0' && (iVar3 = isdigit((int)cVar2), iVar3 != 0))) {
        param_1[3] = param_1[3] + 1;
        cVar2 = *param_1[3];
      }
      param_1[3] = param_1[3] + -1;
      pcVar5 = param_1[3];
      if (pcVar5 <= param_1[2] && param_1[2] != pcVar5) {
        return 0;
      }
LAB_6b83a1f0:
      pcVar5 = pcVar5 + 1;
    }
    else if (cVar2 == '*') {
      param_1[2] = pcVar5;
      param_1[3] = pcVar5;
      cVar2 = *pcVar5;
      while ((cVar2 != '\0' && (cVar2 != ' '))) {
        pcVar5 = param_1[3] + 1;
        param_1[3] = pcVar5;
        cVar2 = *pcVar5;
      }
      param_1[3] = pcVar5 + -1;
    }
    else {
      if (cVar2 == '@') {
        if (*pcVar5 == '\0') {
          return 0;
        }
        param_1[3] = pcVar5;
        param_1[2] = pcVar5;
        goto LAB_6b83a1f0;
      }
      if (cVar2 == '[') {
        cVar2 = *pcVar5;
        local_c = local_c + 1;
        cVar1 = *local_c;
        if ((cVar2 != '\0') && (cVar2 != ' ')) {
          iVar3 = toupper((int)cVar2);
          iVar4 = toupper((int)cVar1);
          if (iVar3 == iVar4) {
            while (cVar1 != ']') {
              iVar3 = toupper((int)cVar2);
              iVar4 = toupper((int)cVar1);
              if (iVar4 != iVar3) {
                return 0;
              }
              pcVar5 = pcVar5 + 1;
              local_c = local_c + 1;
              cVar2 = *pcVar5;
              cVar1 = *local_c;
            }
            goto LAB_6b83a13c;
          }
        }
        while (cVar1 != ']') {
          local_c = local_c + 1;
          cVar1 = *local_c;
        }
      }
      else {
        if (*pcVar5 == '\0') {
          return 0;
        }
        iVar3 = toupper((int)*pcVar5);
        iVar4 = toupper((int)cVar2);
        if (iVar3 != iVar4) {
          return 0;
        }
        pcVar5 = pcVar5 + 1;
      }
    }
LAB_6b83a13c:
    local_c = local_c + 1;
  } while( true );
}



DWORD CreateTapePartition(HANDLE hDevice,DWORD dwPartitionMethod,DWORD dwCount,DWORD dwSize)

{
  DWORD DVar1;
  undefined4 extraout_EDX;
  DWORD local_14;
  DWORD local_10;
  DWORD local_c;
  uint local_8;
  
                    // 0x3a270  248  CreateTapePartition
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_14 = dwPartitionMethod;
  local_10 = dwCount;
  local_c = dwSize;
  FUN_6b85dc76((int)hDevice,0x1fc028,&local_14,0xc,0,0);
  DVar1 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,extraout_EDX);
  return DVar1;
}



DWORD EraseTape(HANDLE hDevice,DWORD dwEraseType,BOOL bImmediate)

{
  DWORD DVar1;
  DWORD local_c;
  uint local_8;
  
                    // 0x3a2c0  354  EraseTape
  local_c = dwEraseType;
  local_8 = bImmediate & 0xff;
  DVar1 = FUN_6b85dc76((int)hDevice,0x1fc000,&local_c,8,0,0);
  return DVar1;
}



DWORD GetTapePosition(HANDLE hDevice,DWORD dwPositionType,LPDWORD lpdwPartition,
                     LPDWORD lpdwOffsetLow,LPDWORD lpdwOffsetHigh)

{
  DWORD DVar1;
  undefined4 extraout_EDX;
  DWORD local_18;
  DWORD local_14;
  DWORD local_10;
  DWORD local_c;
  uint local_8;
  
                    // 0x3a300  759  GetTapePosition
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_18 = dwPositionType;
  DVar1 = FUN_6b85dc76((int)hDevice,0x1f400c,&local_18,0x10,&local_18,0x10);
  if (DVar1 == 0) {
    *lpdwPartition = local_14;
    *lpdwOffsetLow = local_10;
  }
  else {
    local_c = 0;
    *lpdwPartition = 0;
    *lpdwOffsetLow = 0;
  }
  *lpdwOffsetHigh = local_c;
  DVar1 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,extraout_EDX);
  return DVar1;
}



DWORD GetTapeStatus(HANDLE hDevice)

{
  DWORD DVar1;
  
                    // 0x3a370  760  GetTapeStatus
  DVar1 = FUN_6b85dc76((int)hDevice,0x1f4024,0,0,0,0);
  return DVar1;
}



DWORD PrepareTape(HANDLE hDevice,DWORD dwOperation,BOOL bImmediate)

{
  DWORD DVar1;
  DWORD local_c;
  uint local_8;
  
                    // 0x3a3a0  1068  PrepareTape
  local_c = dwOperation;
  local_8 = bImmediate & 0xff;
  DVar1 = FUN_6b85dc76((int)hDevice,0x1f4004,&local_c,8,0,0);
  return DVar1;
}



DWORD SetTapeParameters(HANDLE hDevice,DWORD dwOperation,LPVOID lpTapeInformation)

{
  DWORD DVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  
                    // 0x3a3e0  1366  SetTapeParameters
  if (dwOperation == 0) {
    uVar3 = 4;
    uVar2 = 0x1f4020;
  }
  else {
    if (dwOperation != 1) {
      return 1;
    }
    uVar3 = 8;
    uVar2 = 0x1fc018;
  }
  DVar1 = FUN_6b85dc76((int)hDevice,uVar2,lpTapeInformation,uVar3,0,0);
  return DVar1;
}



DWORD SetTapePosition(HANDLE hDevice,DWORD dwPositionMethod,DWORD dwPartition,DWORD dwOffsetLow,
                     DWORD dwOffsetHigh,BOOL bImmediate)

{
  DWORD DVar1;
  undefined4 extraout_EDX;
  DWORD local_20;
  DWORD local_1c;
  DWORD local_18;
  DWORD local_14;
  undefined local_10;
  uint local_8;
  
                    // 0x3a420  1367  SetTapePosition
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_20 = dwPositionMethod;
  local_1c = dwPartition;
  local_18 = dwOffsetLow;
  local_14 = dwOffsetHigh;
  local_10 = (undefined)bImmediate;
  FUN_6b85dc76((int)hDevice,0x1f4010,&local_20,0x18,0,0);
  DVar1 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,extraout_EDX);
  return DVar1;
}



DWORD WriteTapemark(HANDLE hDevice,DWORD dwTapemarkType,DWORD dwTapemarkCount,BOOL bImmediate)

{
  DWORD DVar1;
  undefined4 extraout_EDX;
  DWORD local_14;
  DWORD local_10;
  undefined local_c;
  uint local_8;
  
                    // 0x3a480  1574  WriteTapemark
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_14 = dwTapemarkType;
  local_10 = dwTapemarkCount;
  local_c = (undefined)bImmediate;
  FUN_6b85dc76((int)hDevice,0x1fc008,&local_14,0xc,0,0);
  DVar1 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,extraout_EDX);
  return DVar1;
}



BOOL CreateHardLinkTransactedA
               (LPCSTR lpFileName,LPCSTR lpExistingFileName,
               LPSECURITY_ATTRIBUTES lpSecurityAttributes,HANDLE hTransaction)

{
  int iVar1;
  BOOL BVar2;
  undefined local_14 [4];
  LPCWSTR local_10;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x3a4d0  211  CreateHardLinkTransactedA
  iVar1 = Basep8BitStringToDynamicUnicodeString(local_14,lpFileName);
  if (iVar1 == 0) {
    return 0;
  }
  if (lpExistingFileName == (LPCSTR)0x0) {
    local_8 = (LPCWSTR)0x0;
  }
  else {
    iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpExistingFileName);
    if (iVar1 == 0) {
      BVar2 = 0;
      goto LAB_6b83a52c;
    }
  }
  BVar2 = CreateHardLinkTransactedW(local_10,local_8,lpSecurityAttributes,hTransaction);
  if (lpExistingFileName != (LPCSTR)0x0) {
    RtlFreeUnicodeString(local_c);
  }
LAB_6b83a52c:
  RtlFreeUnicodeString(local_14);
  return BVar2;
}



undefined4 CreateSocketHandle(void)

{
                    // 0x3a550  243  CreateSocketHandle
                    // 0x3a550  1467  UnregisterConsoleIME
  RtlSetLastWin32Error(0x78);
  return 0;
}



undefined4 GetHandleContext(void)

{
                    // 0x3a560  611  GetHandleContext
  RtlSetLastWin32Error(0x78);
  return 0;
}



undefined4 RegisterConsoleIME(void)

{
                    // 0x3a580  1193  RegisterConsoleIME
                    // 0x3a580  1328  SetHandleContext
  RtlSetLastWin32Error(0x78);
  return 0;
}



uint __fastcall FUN_6b83a58d(int *param_1,int param_2,int param_3)

{
  undefined2 *puVar1;
  int iVar2;
  int iVar3;
  int in_FS_OFFSET;
  uint local_c;
  uint local_8;
  
  iVar2 = 0;
  local_c = 0;
  local_8 = 0;
  iVar3 = 0;
  if (param_2 != 0) {
    do {
      local_c = FUN_6b814837(local_8,(uint)*(ushort *)(*(int *)(param_3 + iVar3 * 4) + 2),&local_8);
      if ((int)local_c < 0) {
        return local_c;
      }
      iVar3 = iVar3 + 1;
    } while (iVar3 != param_2);
  }
  iVar3 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_8);
  *param_1 = iVar3;
  if (iVar3 == 0) {
    local_c = 0xc0000017;
  }
  else if (param_2 != 0) {
    do {
      puVar1 = *(undefined2 **)(param_3 + iVar2 * 4);
      *puVar1 = 0;
      if (iVar2 == 0) {
        iVar3 = *param_1;
      }
      else {
        iVar3 = *(int *)(param_3 + -4 + iVar2 * 4);
        iVar3 = (uint)*(ushort *)(iVar3 + 2) + *(int *)(iVar3 + 4);
      }
      iVar2 = iVar2 + 1;
      *(int *)(puVar1 + 2) = iVar3;
    } while (iVar2 != param_2);
  }
  return local_c;
}



void BasepFinishPackageActivationForSxS
               (undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
               undefined4 param_5,undefined4 param_6)

{
                    // 0x3a630  87  BasepFinishPackageActivationForSxS
  FUN_6b864bc9();
  return;
}



void BasepGetPackageActivationTokenForSxS(undefined4 param_1,undefined4 param_2,HANDLE *param_3)

{
                    // 0x3a660  93  BasepGetPackageActivationTokenForSxS
  FUN_6b864d16(param_3);
  return;
}



int FUN_6b83a680(int param_1,LANGID param_2,HANDLE *param_3)

{
  int iVar1;
  wchar_t *_Str1;
  HANDLE pvVar2;
  int iVar3;
  LPCWSTR *ppWVar4;
  int in_FS_OFFSET;
  ACTCTXW local_34;
  undefined4 local_14;
  undefined4 local_10;
  uint local_c;
  int local_8;
  
  local_34.cbSize = 0x20;
  local_8 = 0;
  ppWVar4 = (LPCWSTR *)&local_34.dwFlags;
  for (iVar3 = 7; iVar3 != 0; iVar3 = iVar3 + -1) {
    *ppWVar4 = (LPCWSTR)0x0;
    ppWVar4 = ppWVar4 + 1;
  }
  iVar3 = 0;
  if ((param_3 == (HANDLE *)0x0) || (*param_3 = (HANDLE)0x0, param_1 == -1)) {
    iVar1 = -0x3ffffff3;
  }
  else {
    local_10 = 0;
    local_14 = 1;
    iVar3 = RtlQueryInformationActivationContext(0,param_1,&local_14,3,0,0,&local_8);
    if (iVar3 != -0x3fffffdd) {
      return iVar3;
    }
    if (local_8 == 0) {
      return -0x3fffffdd;
    }
    iVar3 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_8);
    if (iVar3 == 0) {
      return -0x3fffffdd;
    }
    iVar1 = RtlQueryInformationActivationContext(0,param_1,&local_14,3,iVar3,local_8,&local_8);
    if (-1 < iVar1) {
      if (param_1 == -4) {
        local_34.dwFlags = local_34.dwFlags | 0x40;
        local_34.lpSource = *(LPCWSTR *)(iVar3 + 0x40);
      }
      else {
        local_34.lpSource = *(LPCWSTR *)(iVar3 + 0x44);
        _Str1 = wcsrchr(*(wchar_t **)(iVar3 + 0x44),L'.');
        if ((_Str1 == (wchar_t *)0x0) || (iVar1 = _wcsicmp(_Str1,L".Manifest"), iVar1 != 0)) {
          iVar1 = RtlQueryInformationActivationContext(0,param_1,0,7,&local_c,4,&local_8);
          if (iVar1 < 0) goto LAB_6b83a7da;
          if (local_c != 0) {
            local_34.lpResourceName = (LPCWSTR)(local_c & 0xffff);
            local_34.dwFlags = local_34.dwFlags | 8;
          }
        }
      }
      local_34.dwFlags = local_34.dwFlags | 2;
      local_34.wLangId = param_2;
      pvVar2 = CreateActCtxW(&local_34);
      if (pvVar2 == (HANDLE)0xffffffff) {
        iVar1 = *(int *)(*(int *)(in_FS_OFFSET + 0x18) + 0xbf4);
      }
      else {
        iVar1 = 0;
        *param_3 = pvVar2;
      }
    }
  }
LAB_6b83a7da:
  if (iVar3 != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iVar3);
  }
  return iVar1;
}



int FUN_6b83a7f9(undefined4 param_1,undefined4 param_2,int param_3,int *param_4,int *param_5,
                int *param_6,int *param_7,int *param_8,int *param_9,uint *param_10,uint param_11,
                int param_12,uint *param_13)

{
  int iVar1;
  int iVar2;
  undefined4 extraout_ECX;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  wchar_t *local_18;
  int local_14;
  int local_10;
  undefined4 *local_8;
  
  memset(param_13,0,400);
  iVar1 = NtWow64ReadVirtualMemory64
                    (param_7[1],param_11 + 0x10,param_12 + (uint)(0xffffffef < param_11),&local_14,8
                     ,0,0);
  if (-1 < iVar1) {
    param_7[4] = local_14;
    param_7[5] = local_10;
    local_24 = *(undefined4 *)*param_6;
    local_20 = ((undefined4 *)*param_6)[1];
    local_1c = 0x140012;
    local_18 = L".Manifest";
    iVar1 = FUN_6b83aaf4(*param_4,(int)&local_24);
    if (-1 < iVar1) {
      local_1c = 0x10000e;
      local_18 = L".Config";
      iVar1 = FUN_6b83aaf4(*param_8,(int)&local_24);
      if (-1 < iVar1) {
        local_24 = *(undefined4 *)param_6[1];
        local_20 = ((undefined4 *)param_6[1])[1];
        local_1c = 0x140012;
        local_18 = L".Manifest";
        iVar1 = FUN_6b83aaf4(param_4[1],(int)&local_24);
        if (-1 < iVar1) {
          local_1c = 0x10000e;
          local_18 = L".Config";
          iVar1 = FUN_6b83aaf4(param_8[1],(int)&local_24);
          if (-1 < iVar1) {
            iVar1 = FUN_6b81ad7d(local_8,extraout_ECX,1,param_1,param_2,param_3,param_4,param_5,
                                 param_6,param_7,1,param_8,param_9,param_13,
                                 (undefined2 *)(param_13 + 2),(undefined2 *)(param_13 + 0xc));
            iVar2 = FUN_6b81b001(iVar1);
            if ((iVar2 != 0) || (iVar2 = FUN_6b81932c(iVar1), iVar2 != 0)) {
              iVar1 = 0;
            }
            if (-1 < iVar1) {
              if (*param_13 != 0) {
                iVar1 = RtlAppendUnicodeStringToString(param_10,*param_6);
                if (iVar1 < 0) {
                  return iVar1;
                }
                iVar1 = RtlpApplyLengthFunction
                                  (0,8,param_10,RtlGetLengthWithoutLastFullDosOrNtPathElement_exref)
                ;
                if (iVar1 < 0) {
                  return iVar1;
                }
                *(undefined2 *)(param_10[1] + (uint)(*(ushort *)param_10 >> 1) * 2) = 0;
                param_13[0x16] = *param_10;
                param_13[0x17] = param_10[1];
              }
              iVar1 = 0;
            }
          }
        }
      }
    }
  }
  return iVar1;
}



int FUN_6b83a9be(void)

{
  bool bVar1;
  bool bVar2;
  ushort uVar3;
  short *psVar4;
  
  uVar3 = 0;
  psVar4 = DAT_6b8b0874;
  bVar1 = false;
  do {
    uVar3 = uVar3 + 1;
    bVar2 = false;
    if (*psVar4 == 0) {
      if (bVar1) {
        return (uint)uVar3 * 2;
      }
      bVar2 = true;
    }
    bVar1 = bVar2;
    psVar4 = psVar4 + 1;
  } while( true );
}



void __fastcall FUN_6b83a9ee(int param_1,undefined *param_2)

{
  char *pcVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar2;
  undefined4 *puVar3;
  int in_FS_OFFSET;
  ulonglong uVar4;
  ulonglong uVar5;
  undefined4 local_5c;
  int local_58;
  undefined4 local_54 [19];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  *param_2 = 0;
  local_5c = 0;
  local_58 = param_1;
  if (param_1 == 0) {
    uVar4 = NtOpenProcessToken(0xffffffff,8,&local_58);
    uVar5 = uVar4 & 0xffffffff00000000;
    if ((int)uVar4 < 0) goto LAB_6b83aab8;
  }
  uVar4 = NtQueryInformationToken(local_58,0x19,local_54,0x4c,&local_5c);
  uVar5 = uVar4 & 0xffffffff00000000;
  if ((int)uVar4 < 0) {
    if ((int)uVar4 != -0x3fffffdd) goto LAB_6b83aab8;
    uVar5 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_5c);
    puVar3 = (undefined4 *)uVar5;
    if (puVar3 == (undefined4 *)0x0) goto LAB_6b83aab8;
    uVar4 = NtQueryInformationToken(local_58,0x19,puVar3,local_5c,&local_5c);
    uVar5 = uVar4 & 0xffffffff00000000 | uVar5 & 0xffffffff;
    if ((int)uVar4 < 0) goto LAB_6b83aab8;
  }
  else {
    puVar3 = local_54;
  }
  pcVar1 = (char *)RtlSubAuthorityCountSid(*puVar3);
  uVar4 = RtlSubAuthoritySid(*puVar3,*pcVar1 + -1);
  uVar5 = uVar4 & 0xffffffff00000000 | ZEXT48(puVar3);
  if (0x1000 < *(uint *)uVar4) {
    *param_2 = 1;
    uVar5 = uVar4 & 0xffffffff00000000 | ZEXT48(puVar3);
  }
LAB_6b83aab8:
  uVar2 = (undefined4)(uVar5 >> 0x20);
  puVar3 = (undefined4 *)uVar5;
  if (local_58 != param_1) {
    NtClose(local_58);
    uVar2 = extraout_EDX;
  }
  if ((puVar3 != (undefined4 *)0x0) && (puVar3 != local_54)) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar3);
    uVar2 = extraout_EDX_00;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



int __thiscall FUN_6b83aaf4(undefined4 this,int param_2)

{
  int iVar1;
  int iVar2;
  
  iVar2 = 0;
  do {
    iVar1 = RtlAppendUnicodeStringToString(this,param_2);
    if (iVar1 < 0) {
      return iVar1;
    }
    iVar2 = iVar2 + 1;
    param_2 = param_2 + 8;
  } while (iVar2 != 2);
  return 0;
}



bool ZombifyActCtxWorker(undefined4 param_1)

{
  int iVar1;
  
                    // 0x3ab30  1576  ZombifyActCtxWorker
  iVar1 = RtlZombifyActivationContext(param_1);
  if (-1 >= iVar1) {
    BaseSetLastNTError(iVar1);
  }
  return -1 < iVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int GetComPlusPackageInstallStatus(void)

{
  int iVar1;
  int iVar2;
  int local_8;
  
                    // 0x3ab60  469  GetComPlusPackageInstallStatus
  local_8 = _DAT_7ffe02e0;
  iVar2 = _DAT_7ffe02e0;
  if (_DAT_7ffe02e0 == -1) {
    iVar2 = 0;
    iVar1 = NtQuerySystemInformation(0x3b,&local_8,4,0);
    if (-1 < iVar1) {
      iVar2 = local_8;
    }
  }
  return iVar2;
}



undefined4 SetComPlusPackageInstallStatus(uint param_1)

{
  int iVar1;
  
                    // 0x3aba0  1248  SetComPlusPackageInstallStatus
  if ((param_1 & 0xfffffffe) == 0) {
    iVar1 = NtSetSystemInformation(0x3b,&param_1,4);
    if (-1 < iVar1) {
      return 1;
    }
  }
  else {
    iVar1 = -0x3ffffff3;
  }
  BaseSetLastNTError(iVar1);
  return 0;
}



// _PtFuncCompare parameter of bsearch
// 

void __cdecl _PtFuncCompare_6b83abe0(void *param_1,void *param_2)

{
  memcmp(param_1,param_2,0x10);
  return;
}



void ApplicationRecoveryFinished(BOOL bSuccess)

{
                    // 0x3ac00  37  ApplicationRecoveryFinished
  FUN_6b86393d(bSuccess);
  return;
}



HRESULT ApplicationRecoveryInProgress(PBOOL pbCancelled)

{
  HRESULT HVar1;
  
                    // 0x3ac20  38  ApplicationRecoveryInProgress
  HVar1 = FUN_6b8639af(pbCancelled);
  return HVar1;
}



DWORD GetApplicationRecoveryCallbackWorker
                (HANDLE param_1,undefined4 *param_2,undefined4 *param_3,undefined4 *param_4,
                undefined4 *param_5)

{
  DWORD DVar1;
  undefined4 uVar2;
  undefined4 local_44 [2];
  undefined4 local_3c;
  undefined4 local_34;
  undefined4 local_c;
  undefined4 local_8;
  
                    // 0x3ac40  446  GetApplicationRecoveryCallbackWorker
  memset(local_44,0,0x40);
  if ((param_1 == (HANDLE)0x0) || (param_2 == (undefined4 *)0x0)) {
    DVar1 = 0x80070057;
  }
  else {
    DVar1 = FUN_6b862ecd(param_1,local_44);
    if (-1 < (int)DVar1) {
      uVar2 = RtlDecodeSystemPointer(local_3c);
      *param_2 = uVar2;
      if (param_3 != (undefined4 *)0x0) {
        *param_3 = local_34;
      }
      if (param_4 != (undefined4 *)0x0) {
        *param_4 = local_c;
      }
      if (param_5 != (undefined4 *)0x0) {
        *param_5 = local_8;
      }
    }
  }
  return DVar1;
}



void GetApplicationRestartSettingsWorker
               (undefined4 param_1,short *param_2,uint *param_3,undefined4 *param_4)

{
                    // 0x3acc0  448  GetApplicationRestartSettingsWorker
  FUN_6b862fe5(param_1,param_2,param_3,param_4);
  return;
}



HRESULT UnregisterApplicationRecoveryCallback(void)

{
  HRESULT HVar1;
  
                    // 0x3ace0  1464  UnregisterApplicationRecoveryCallback
  HVar1 = FUN_6b817fb6(0,0,0,0);
  return HVar1;
}



HRESULT WerGetFlags(HANDLE hProcess,PDWORD pdwFlags)

{
  DWORD DVar1;
  
                    // 0x3ad00  1511  WerGetFlags
                    // 0x3ad00  1512  WerGetFlagsWorker
  DVar1 = FUN_6b862e21(hProcess,pdwFlags);
  return DVar1;
}



void WerRegisterFileWorker(wchar_t *param_1,int param_2,uint param_3)

{
                    // 0x3ad20  1518  WerRegisterFileWorker
  FUN_6b863a4f(param_1,param_2,param_3);
  return;
}



void WerRegisterMemoryBlockWorker(int param_1,uint param_2)

{
                    // 0x3ad40  1520  WerRegisterMemoryBlockWorker
  FUN_6b8626a2(param_1,param_2);
  return;
}



void WerRegisterRuntimeExceptionModuleWorker(undefined4 param_1,int param_2)

{
                    // 0x3ad60  1522  WerRegisterRuntimeExceptionModuleWorker
  FUN_6b863d25(param_1,param_2);
  return;
}



void WerUnregisterFileWorker(wchar_t *param_1)

{
                    // 0x3ad80  1530  WerUnregisterFileWorker
  FUN_6b863eeb(param_1);
  return;
}



void WerUnregisterMemoryBlockWorker(int param_1)

{
                    // 0x3ada0  1532  WerUnregisterMemoryBlockWorker
  FUN_6b86401b(param_1);
  return;
}



void WerUnregisterRuntimeExceptionModuleWorker(ushort *param_1,int param_2)

{
                    // 0x3adc0  1534  WerUnregisterRuntimeExceptionModuleWorker
  FUN_6b864157(param_1,param_2);
  return;
}



undefined4 WerpInitiateRemoteRecovery(void)

{
                    // 0x3ade0  1536  WerpInitiateRemoteRecovery
  FUN_6b86443e();
  return 0;
}



undefined4 WerpNotifyUseStringResourceWorker(void)

{
                    // 0x3adf0  1539  WerpNotifyUseStringResourceWorker
  return 0x80004001;
}



BOOL GetProcessWorkingSetSize
               (HANDLE hProcess,PSIZE_T lpMinimumWorkingSetSize,PSIZE_T lpMaximumWorkingSetSize)

{
  BOOL BVar1;
  DWORD local_8;
  
                    // 0x3ae00  710  GetProcessWorkingSetSize
  BVar1 = GetProcessWorkingSetSizeEx
                    (hProcess,lpMinimumWorkingSetSize,lpMaximumWorkingSetSize,&local_8);
  return BVar1;
}



BOOL MapUserPhysicalPagesScatter
               (PVOID *VirtualAddresses,ULONG_PTR NumberOfPages,PULONG_PTR PageArray)

{
  int iVar1;
  
                    // 0x3ae30  995  MapUserPhysicalPagesScatter
  iVar1 = NtMapUserPhysicalPagesScatter(VirtualAddresses,NumberOfPages,PageArray);
  if (-1 >= iVar1) {
    BaseSetLastNTError(iVar1);
  }
  return (uint)(-1 < iVar1);
}



BOOL CancelTimerQueueTimer(HANDLE TimerQueue,HANDLE Timer)

{
  BOOL BVar1;
  
                    // 0x3ae60  122  CancelTimerQueueTimer
  BVar1 = DeleteTimerQueueTimer(TimerQueue,Timer,(HANDLE)0x0);
  if (BVar1 == 0) {
    GetLastError();
  }
  return (uint)(BVar1 != 0);
}



BOOL DeleteTimerQueue(HANDLE TimerQueue)

{
  BOOL BVar1;
  
                    // 0x3ae90  286  DeleteTimerQueue
  BVar1 = DeleteTimerQueueEx(TimerQueue,(HANDLE)0x0);
  if (BVar1 == 0) {
    GetLastError();
  }
  return (uint)(BVar1 != 0);
}



HANDLE SetTimerQueueTimer(HANDLE TimerQueue,WAITORTIMERCALLBACK Callback,PVOID Parameter,
                         DWORD DueTime,DWORD Period,BOOL PreferIo)

{
  BOOL BVar1;
  HANDLE local_8;
  
                    // 0x3aec0  1394  SetTimerQueueTimer
  BVar1 = CreateTimerQueueTimer
                    (&local_8,TimerQueue,Callback,Parameter,DueTime,Period,(uint)(PreferIo != 0));
  return (HANDLE)(-(uint)(BVar1 != 0) & (uint)local_8);
}



int BasepReportFault(int **param_1)

{
  bool bVar1;
  undefined3 extraout_var;
  int iVar2;
  
                    // 0x3af00  104  BasepReportFault
  bVar1 = FUN_6b865753(param_1);
  if (CONCAT31(extraout_var,bVar1) == 0) {
    iVar2 = 8;
  }
  else {
    iVar2 = FUN_6b8657aa((int)param_1);
  }
  return iVar2;
}



DWORD DisableThreadProfiling(HANDLE PerformanceDataHandle)

{
  int iVar1;
  DWORD DVar2;
  
                    // 0x3af30  293  DisableThreadProfiling
  iVar1 = RtlDisableThreadProfiling(PerformanceDataHandle);
  if (iVar1 < 0) {
    DVar2 = RtlNtStatusToDosErrorNoTeb(iVar1);
  }
  else {
    DVar2 = 0;
  }
  return DVar2;
}



DWORD EnableThreadProfiling
                (HANDLE ThreadHandle,DWORD Flags,DWORD64 HardwareCounters,
                HANDLE *PerformanceDataHandle)

{
  int iVar1;
  DWORD DVar2;
  
                    // 0x3af60  306  EnableThreadProfiling
  iVar1 = RtlEnableThreadProfiling(ThreadHandle,Flags,HardwareCounters,PerformanceDataHandle);
  if (iVar1 < 0) {
    DVar2 = RtlNtStatusToDosErrorNoTeb(iVar1);
  }
  else {
    DVar2 = 0;
  }
  return DVar2;
}



DWORD QueryThreadProfiling(HANDLE ThreadHandle,PBOOLEAN Enabled)

{
  int iVar1;
  DWORD DVar2;
  
                    // 0x3afa0  1111  QueryThreadProfiling
  iVar1 = RtlQueryThreadProfiling(ThreadHandle,Enabled);
  if (iVar1 < 0) {
    DVar2 = RtlNtStatusToDosErrorNoTeb(iVar1);
  }
  else {
    DVar2 = 0;
  }
  return DVar2;
}



DWORD ReadThreadProfilingData
                (HANDLE PerformanceDataHandle,DWORD Flags,PPERFORMANCE_DATA PerformanceData)

{
  int iVar1;
  DWORD DVar2;
  
                    // 0x3afd0  1147  ReadThreadProfilingData
  iVar1 = RtlReadThreadProfilingData(PerformanceDataHandle,Flags,PerformanceData);
  if (iVar1 < 0) {
    DVar2 = RtlNtStatusToDosErrorNoTeb(iVar1);
  }
  else {
    DVar2 = 0;
  }
  return DVar2;
}



void __fastcall FUN_6b83aff7(HFILE param_1,uint param_2,int param_3,int param_4)

{
  uint *puVar1;
  ushort uVar2;
  undefined2 uVar3;
  undefined2 uVar4;
  int iVar5;
  int *piVar6;
  uint *_Dst;
  uint uVar7;
  ushort *puVar8;
  byte *pbVar9;
  uint *puVar10;
  uint *puVar11;
  uint *puVar12;
  uint *puVar13;
  ushort *puVar14;
  LONG LVar15;
  LONG LVar16;
  byte *pbVar17;
  int iVar18;
  uint *extraout_EDX;
  uint *extraout_EDX_00;
  uint *extraout_EDX_01;
  uint *extraout_EDX_02;
  uint *puVar19;
  uint uVar20;
  byte *extraout_EDX_03;
  undefined4 *puVar21;
  uint uVar22;
  uint uVar23;
  uint *puVar24;
  undefined4 *puVar25;
  int iVar26;
  HFILE HVar27;
  int in_FS_OFFSET;
  bool bVar28;
  undefined8 uVar29;
  uint *local_29c;
  uint local_298;
  uint local_294;
  undefined4 *local_290;
  LONG local_28c;
  int local_268;
  uint local_264;
  undefined4 *local_260;
  uint **local_25c;
  HFILE local_258;
  uint local_254;
  uint local_250;
  uint *local_24c;
  uint *local_248;
  undefined4 *local_244;
  int local_240;
  uint local_23c;
  uint *local_238;
  uint *local_234;
  undefined4 *local_230;
  uint *local_22c;
  uint *local_228;
  uint *local_224;
  undefined4 local_220;
  ushort local_21a;
  int local_1e4;
  uint local_1cc;
  byte *local_168;
  undefined4 local_118;
  ushort local_112;
  int local_10c;
  int local_f8;
  int local_e0;
  int local_dc;
  uint local_c8;
  uint local_c4;
  uint auStack144 [33];
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_250 = 0xffffffff;
  local_290 = (undefined4 *)0x0;
  local_230 = (undefined4 *)0x0;
  local_260 = (undefined4 *)0x0;
  local_240 = 0;
  local_248 = (uint *)0x0;
  local_268 = 0;
  local_22c = (uint *)0x0;
  local_28c = 0;
  local_238 = (uint *)0x0;
  local_29c = (uint *)0x0;
  local_224 = (uint *)0xffffffff;
  local_294 = 0;
  local_258 = param_1;
  local_254 = param_2;
  _llseek(param_1,param_3,0);
  _hread(param_1,&local_220,0x108);
  iVar5 = (uint)local_21a * 0x28 + param_3 + 0x108;
  puVar21 = &local_220;
  puVar25 = &local_118;
  for (iVar18 = 0x42; iVar18 != 0; iVar18 = iVar18 + -1) {
    *puVar25 = *puVar21;
    puVar21 = puVar21 + 1;
    puVar25 = puVar25 + 1;
  }
  piVar6 = (int *)KernelBaseGetGlobalData();
  uVar29 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                           *piVar6 + 0x1c0000U | 8,(uint)local_21a * 0x28);
  pbVar17 = (byte *)((ulonglong)uVar29 >> 0x20);
  _Dst = (uint *)uVar29;
  if (_Dst == (uint *)0x0) goto LAB_6b83c90c;
  memset(_Dst,0,(uint)local_21a * 0x28);
  HVar27 = local_258;
  _llseek(local_258,param_3 + 0x108,0);
  _hread(HVar27,_Dst,(uint)local_21a * 0x28);
  uVar22 = 0;
  local_298 = 0;
  puVar1 = _Dst + (uint)local_21a * 10;
  if (_Dst < puVar1) {
    puVar12 = _Dst + 4;
    iVar18 = ((uint)local_21a * 0x28 - 1) / 0x28 + 1;
    do {
      if (uVar22 <= puVar12[1] && puVar12[1] != uVar22) {
        uVar22 = *puVar12 + puVar12[1];
      }
      puVar12 = puVar12 + 10;
      iVar18 = iVar18 + -1;
      local_298 = uVar22;
    } while (iVar18 != 0);
  }
  uVar22 = 0;
  local_23c = 0;
  local_244 = *(undefined4 **)(param_4 + 0x10);
  for (puVar21 = local_244; puVar21 != (undefined4 *)0x0; puVar21 = (undefined4 *)*puVar21) {
    puVar25 = (undefined4 *)puVar21[4];
    if ((puVar25 != (undefined4 *)0x0) || (puVar21[3] != 0)) {
      local_248 = (uint *)((int)local_248 + 1);
      local_240 = local_240 + 1;
      local_260 = (undefined4 *)((int)local_260 + (uint)*(ushort *)(puVar21[1] + 0xe) * 2 + 2);
      iVar18 = 0;
      for (; puVar25 != (undefined4 *)0x0; puVar25 = (undefined4 *)*puVar25) {
        local_22c = (uint *)((int)local_22c + 1);
        if (iVar18 == 0) {
LAB_6b83b238:
          iVar26 = puVar25[1];
          local_230 = (undefined4 *)((int)local_230 + (uint)*(ushort *)(iVar26 + 0xe) * 2 + 2);
          local_268 = local_268 + 1;
        }
        else {
          iVar26 = puVar25[1];
          puVar8 = *(ushort **)(iVar18 + 0x10);
          puVar14 = *(ushort **)(iVar26 + 0x10);
          do {
            uVar2 = *puVar8;
            bVar28 = uVar2 < *puVar14;
            if (uVar2 != *puVar14) {
LAB_6b83b229:
              uVar7 = -(uint)bVar28 | 1;
              goto LAB_6b83b22e;
            }
            if (uVar2 == 0) break;
            uVar2 = puVar8[1];
            bVar28 = uVar2 < puVar14[1];
            if (uVar2 != puVar14[1]) goto LAB_6b83b229;
            puVar8 = puVar8 + 2;
            puVar14 = puVar14 + 2;
          } while (uVar2 != 0);
          uVar7 = 0;
LAB_6b83b22e:
          uVar22 = local_23c;
          if (uVar7 != 0) goto LAB_6b83b238;
        }
        uVar22 = uVar22 + (puVar25[5] + 3 & 0xfffffffc);
        iVar18 = iVar26;
        local_23c = uVar22;
      }
      iVar18 = 0;
      for (puVar25 = (undefined4 *)puVar21[3]; puVar25 != (undefined4 *)0x0;
          puVar25 = (undefined4 *)*puVar25) {
        local_22c = (uint *)((int)local_22c + 1);
        if ((iVar18 == 0) || (*(short *)(iVar18 + 4) != *(short *)(puVar25[1] + 4))) {
          local_268 = local_268 + 1;
        }
        uVar22 = uVar22 + (puVar25[5] + 3 & 0xfffffffc);
        iVar18 = puVar25[1];
        local_23c = uVar22;
      }
    }
  }
  for (local_25c = *(uint ***)(param_4 + 0xc); local_25c != (uint **)0x0;
      local_25c = (uint **)*local_25c) {
    puVar21 = local_25c[4];
    if ((puVar21 != (undefined4 *)0x0) || (local_25c[3] != (uint *)0x0)) {
      local_248 = (uint *)((int)local_248 + 1);
      iVar18 = 0;
      for (; puVar21 != (undefined4 *)0x0; puVar21 = (undefined4 *)*puVar21) {
        local_22c = (uint *)((int)local_22c + 1);
        if (iVar18 == 0) {
LAB_6b83b34a:
          iVar26 = puVar21[1];
          local_268 = local_268 + 1;
          local_230 = (undefined4 *)((int)local_230 + (uint)*(ushort *)(iVar26 + 0xe) * 2 + 2);
        }
        else {
          iVar26 = puVar21[1];
          puVar8 = *(ushort **)(iVar18 + 0x10);
          puVar14 = *(ushort **)(iVar26 + 0x10);
          do {
            uVar2 = *puVar8;
            bVar28 = uVar2 < *puVar14;
            if (uVar2 != *puVar14) {
LAB_6b83b341:
              uVar22 = -(uint)bVar28 | 1;
              goto LAB_6b83b346;
            }
            if (uVar2 == 0) break;
            uVar2 = puVar8[1];
            bVar28 = uVar2 < puVar14[1];
            if (uVar2 != puVar14[1]) goto LAB_6b83b341;
            puVar8 = puVar8 + 2;
            puVar14 = puVar14 + 2;
          } while (uVar2 != 0);
          uVar22 = 0;
LAB_6b83b346:
          if (uVar22 != 0) goto LAB_6b83b34a;
        }
        uVar22 = local_23c + (puVar21[5] + 3 & 0xfffffffc);
        iVar18 = iVar26;
        local_23c = uVar22;
      }
      iVar18 = 0;
      for (puVar21 = local_25c[3]; puVar21 != (undefined4 *)0x0; puVar21 = (undefined4 *)*puVar21) {
        local_22c = (uint *)((int)local_22c + 1);
        if ((iVar18 == 0) || (*(short *)(iVar18 + 4) != *(short *)(puVar21[1] + 4))) {
          local_268 = local_268 + 1;
        }
        uVar22 = uVar22 + (puVar21[5] + 3 & 0xfffffffc);
        iVar18 = puVar21[1];
        local_23c = uVar22;
      }
    }
  }
  uVar7 = (int)local_260 +
          (int)local_22c * 0x18 + local_268 * 0x18 + (int)local_248 * 0x18 + 0x10 +
          (-((int)local_260 + (int)local_230) & 3U) + (int)local_230;
  pbVar9 = FUN_6b83f3e4((byte *)_Dst,(byte *)puVar1,(byte *)".rsrc");
  puVar10 = (uint *)FUN_6b83f3e4((byte *)_Dst,(byte *)puVar1,(byte *)".rsrc1");
  puVar11 = (uint *)FUN_6b83f3e4((byte *)_Dst,(byte *)puVar1,(byte *)".reloc");
  puVar12 = local_238;
  if (pbVar9 == (byte *)0x0) {
    uVar23 = 0x7fffffff;
  }
  else {
    puVar13 = (uint *)(pbVar9 + 0x28);
    local_224 = (uint *)(((int)pbVar9 - (int)_Dst) / 0x28);
    pbVar17 = (byte *)(((int)pbVar9 - (int)_Dst) % 0x28);
    if ((puVar13 == puVar10) || (puVar1 <= puVar13)) {
      uVar23 = 0x7fffffff;
    }
    else {
      if (puVar11 == (uint *)0x0) {
        uVar23 = 0x7fffffff;
      }
      else {
        uVar23 = *(int *)(pbVar9 + 0x34) - *(int *)(pbVar9 + 0xc);
        pbVar17 = pbVar9;
      }
      if (uVar23 < uVar7) goto LAB_6b83c90c;
    }
    if (uVar23 < uVar22 + uVar7) {
      if (puVar11 == puVar13) {
        uVar23 = 0x7fffffff;
      }
      else {
        if (puVar10 == (uint *)0x0) {
          iVar18 = (int)puVar11 - (int)_Dst;
          uVar22 = puVar11[3];
        }
        else {
          iVar18 = (int)puVar10 - (int)_Dst;
          uVar22 = puVar10[3];
        }
        local_250 = iVar18 / 0x28;
        puVar12 = (uint *)(uVar22 - *(int *)(pbVar9 + 0xc));
      }
    }
  }
  local_264 = 0;
  uVar22 = uVar7;
  local_23c = uVar7;
  for (puVar21 = local_244; puVar21 != (undefined4 *)0x0; puVar21 = (undefined4 *)*puVar21) {
    puVar11 = (uint *)puVar21[4];
    uVar20 = local_23c;
    if ((puVar11 != (uint *)0x0) || (puVar21[3] != 0)) {
      while (local_228 = puVar11, local_228 != (uint *)0x0) {
        uVar22 = FUN_6b83f032((int *)&local_228,(uint)puVar12,uVar22,uVar23,&local_264);
        puVar11 = local_228;
        puVar12 = extraout_EDX;
        uVar20 = uVar22;
      }
      local_228 = (uint *)puVar21[3];
      local_23c = uVar20;
      while (local_228 != (uint *)0x0) {
        uVar22 = FUN_6b83f032((int *)&local_228,(uint)puVar12,uVar22,uVar23,&local_264);
        puVar12 = extraout_EDX_00;
        uVar20 = uVar22;
      }
    }
    local_23c = uVar20;
  }
  for (puVar21 = *(undefined4 **)(param_4 + 0xc); puVar21 != (undefined4 *)0x0;
      puVar21 = (undefined4 *)*puVar21) {
    puVar11 = (uint *)puVar21[4];
    uVar20 = local_23c;
    if ((puVar11 != (uint *)0x0) || (puVar21[3] != 0)) {
      while (local_228 = puVar11, local_228 != (uint *)0x0) {
        uVar22 = FUN_6b83f032((int *)&local_228,(uint)puVar12,uVar22,uVar23,&local_264);
        puVar11 = local_228;
        puVar12 = extraout_EDX_01;
        uVar20 = uVar22;
      }
      local_228 = (uint *)puVar21[3];
      local_23c = uVar20;
      while (local_228 != (uint *)0x0) {
        uVar22 = FUN_6b83f032((int *)&local_228,(uint)puVar12,uVar22,uVar23,&local_264);
        puVar12 = extraout_EDX_02;
        uVar20 = uVar22;
      }
    }
    local_23c = uVar20;
  }
  if (local_264 == 0) {
    local_264 = uVar22;
  }
  puVar12 = (uint *)FUN_6b83f3e4((byte *)_Dst,(byte *)puVar1,(byte *)".debug");
  if ((puVar12 != (uint *)0x0) &&
     ((pbVar17 = local_168, local_168 == (byte *)0x0 || (puVar12 != puVar1 + -10))))
  goto LAB_6b83c90c;
  local_25c = (uint **)0x0;
  for (puVar11 = _Dst;
      (puVar13 = (uint *)local_25c, puVar11 < puVar1 &&
      ((local_168 < (byte *)puVar11[3] ||
       (puVar13 = puVar11, (byte *)(puVar11[4] + puVar11[3]) <= local_168))));
      puVar11 = puVar11 + 10) {
  }
  local_25c = (uint **)puVar13;
  puVar11 = (uint *)FUN_6b83f3e4((byte *)_Dst,(byte *)puVar1,(byte *)".reloc");
  if (local_224 == (uint *)0xffffffff) {
    puVar13 = puVar11;
    if ((puVar11 == (uint *)0x0) && (puVar13 = puVar12, puVar12 == (uint *)0x0)) {
      local_224 = (uint *)(uint)local_112;
    }
    else {
      local_224 = (uint *)(((int)puVar13 - (int)_Dst) / 0x28);
    }
    local_112 = local_112 + 1;
  }
  if (local_250 == 0xffffffff) {
    if (puVar10 != (uint *)0x0) {
      local_112 = local_112 - 1;
      goto LAB_6b83b772;
    }
  }
  else {
    if (puVar10 == (uint *)0x0) {
      if (puVar11 == (uint *)0x0) {
        if (puVar12 == (uint *)0x0) {
          local_250 = (uint)local_112;
          goto LAB_6b83b75d;
        }
        iVar18 = (int)puVar12 - (int)_Dst;
      }
      else {
        iVar18 = (int)puVar11 - (int)_Dst;
      }
      local_250 = iVar18 / 0x28;
    }
    else {
      local_250 = ((int)puVar10 - (int)_Dst) / 0x28;
      local_112 = local_112 - 1;
    }
LAB_6b83b75d:
    local_112 = local_112 + 1;
LAB_6b83b772:
  }
  uVar22 = ((uint)local_112 - (uint)local_21a) * 0x28;
  uVar23 = ((local_1cc + (uint)local_21a * -0x28) - param_3) - 0x108;
  if (uVar22 < uVar23 || uVar22 - uVar23 == 0) {
    if (uVar22 != 0) {
      iVar18 = 0;
      do {
        uVar23 = auStack144[iVar18 * 2];
        if ((uVar23 != 0) && (uVar23 < local_1cc)) {
          auStack144[iVar18 * 2] = uVar23 + uVar22;
        }
        iVar18 = iVar18 + 1;
      } while (iVar18 < 0x10);
    }
  }
  else {
    uVar22 = uVar22 - uVar23;
    local_294 = local_dc + -1 + uVar22 & ~(local_dc - 1U);
    iVar18 = 0;
    do {
      uVar23 = auStack144[iVar18 * 2];
      if ((uVar23 != 0) && (uVar23 < local_c4)) {
        auStack144[iVar18 * 2] = uVar23 + uVar22;
      }
      iVar18 = iVar18 + 1;
    } while (iVar18 < 0x10);
    local_c4 = local_c4 + uVar22;
  }
  uVar22 = iVar5 + uVar22;
  uVar23 = (uint)local_112;
  piVar6 = (int *)KernelBaseGetGlobalData();
  uVar29 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                           *piVar6 + 0x1c0000U | 8,(int)(short)(uVar23 * 0x28));
  pbVar17 = (byte *)((ulonglong)uVar29 >> 0x20);
  puVar11 = (uint *)uVar29;
  if (puVar11 == (uint *)0x0) goto LAB_6b83c90c;
  memset(puVar11,0,uVar23 * 0x28);
  local_244 = (undefined4 *)0x0;
  puVar24 = (uint *)0x0;
  local_228 = (uint *)0x0;
  puVar13 = puVar11 + (int)local_224 * 10;
  local_238 = puVar11;
  local_234 = puVar13;
  local_224 = _Dst;
  if (_Dst < puVar1) {
    local_24c = _Dst + 10;
    puVar19 = puVar11;
    do {
      if (local_224 == puVar10) {
        if ((local_250 == 0xffffffff) && (local_24c < puVar1)) {
          local_228 = (uint *)((int)puVar24 + (local_24c[-7] - local_24c[3]));
          puVar24 = local_228;
        }
      }
      else if (puVar19 == puVar13) {
        local_244 = (undefined4 *)&DAT_00000001;
        uVar23 = local_dc + -1 + local_264 & ~(local_dc - 1U);
        iVar18 = 10;
        puVar13 = local_224;
        puVar24 = puVar19;
        if (pbVar9 == (byte *)0x0) {
          puVar24 = (uint *)((local_264 - 1) + local_e0 & ~(local_e0 - 1U));
          puVar13 = puVar19;
          for (; iVar18 != 0; iVar18 = iVar18 + -1) {
            *puVar13 = 0;
            puVar13 = puVar13 + 1;
          }
          local_228 = puVar24;
          iVar18 = FUN_6b8409b0(puVar19,0,(int)".rsrc");
          if (iVar18 < 0) goto LAB_6b83c8ee;
          local_238[3] = local_24c[-7];
          local_238[5] = local_24c[-5];
          local_238[9] = 0x40000040;
          local_238[4] = uVar23;
          local_238[2] = local_264;
          puVar19 = local_238;
        }
        else {
          for (; iVar18 != 0; iVar18 = iVar18 + -1) {
            *puVar24 = *puVar13;
            puVar13 = puVar13 + 1;
            puVar24 = puVar24 + 1;
          }
          puVar19[4] = uVar23;
          puVar19[2] = local_264;
          if (uVar23 == local_24c[-6]) {
            puVar24 = (uint *)0x0;
            local_228 = (uint *)0x0;
          }
          else {
            puVar24 = (uint *)((int)local_228 + ((local_264 - 1) + local_e0 & ~(local_e0 - 1U)));
            local_228 = puVar24;
            if (local_24c < puVar1) {
              puVar24 = (uint *)((int)puVar24 + (local_24c[-7] - local_24c[3]));
              local_228 = puVar24;
            }
          }
        }
        puVar19 = puVar19 + 10;
        puVar13 = local_234;
        local_238 = puVar19;
        if (pbVar9 == (byte *)0x0) goto LAB_6b83b9ff;
      }
      else {
        if ((local_250 == 0xffffffff) || (puVar19 != puVar11 + local_250 * 10)) {
          if (puVar13 <= puVar19) goto LAB_6b83b9ff;
          puVar13 = local_224;
          puVar24 = puVar19;
          for (iVar18 = 10; iVar18 != 0; iVar18 = iVar18 + -1) {
            *puVar24 = *puVar13;
            puVar13 = puVar13 + 1;
            puVar24 = puVar24 + 1;
          }
        }
        else {
          puVar13 = puVar19;
          for (iVar18 = 10; iVar18 != 0; iVar18 = iVar18 + -1) {
            *puVar13 = 0;
            puVar13 = puVar13 + 1;
          }
          iVar18 = FUN_6b8409b0(puVar19,0,(int)".rsrc1");
          if (iVar18 < 0) goto LAB_6b83c8ee;
          if (puVar10 == (uint *)0x0) {
            uVar23 = local_24c[-7];
            local_238[3] = uVar23;
            local_238[9] = 0x40000040;
            local_228 = (uint *)((((local_23c - 1) + local_e0 & ~(local_e0 - 1U)) - uVar23) +
                                local_234[3]);
          }
          else {
            local_238[3] = puVar10[3];
            local_238[9] = 0x40000040;
            local_228 = (uint *)(((local_e0 + -1 + local_23c & ~(local_e0 - 1U)) - local_24c[-7]) +
                                local_234[3]);
          }
          puVar19 = local_238 + 10;
LAB_6b83b9ff:
          puVar13 = local_224;
          puVar24 = puVar19;
          for (iVar18 = 10; iVar18 != 0; iVar18 = iVar18 + -1) {
            *puVar24 = *puVar13;
            puVar13 = puVar13 + 1;
            puVar24 = puVar24 + 1;
          }
          puVar19[3] = puVar19[3] + (int)local_228;
        }
        puVar19 = puVar19 + 10;
        puVar13 = local_234;
        puVar24 = local_228;
        local_238 = puVar19;
      }
      local_224 = local_224 + 10;
      local_24c = local_24c + 10;
    } while (local_224 < puVar1);
    if (local_244 == (undefined4 *)0x0) goto LAB_6b83ba4f;
LAB_6b83bab8:
    local_c8 = puVar11[(uint)local_112 * 10 + -7] + puVar11[(uint)local_112 * 10 + -6] + -1 +
               local_e0 & ~(local_e0 - 1U);
    piVar6 = (int *)KernelBaseGetGlobalData();
    puVar13 = (uint *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                                      *piVar6 + 0x1c0000U | 8,uVar7);
    local_224 = puVar13;
    if (puVar13 != (uint *)0x0) {
      memset(puVar13,0,uVar7);
      *puVar13 = 0;
      puVar13[1] = 0;
      *(undefined2 *)(puVar13 + 2) = 4;
      *(undefined2 *)((int)puVar13 + 10) = 0;
      *(short *)(puVar13 + 3) = (short)local_240;
      *(short *)((int)puVar13 + 0xe) = (short)local_248 - (short)local_240;
      puVar13 = puVar13 + 4;
      iVar18 = (int)local_248 * 2;
      puVar24 = puVar13 + iVar18 + (local_268 + (int)local_248 * 2) * 2;
      puVar19 = puVar24 + (int)((int)local_22c + local_268 * 2) * 2;
      local_22c = puVar19 + (int)local_22c * 4;
      local_238 = (uint *)((int)local_22c + (int)local_260 + (int)local_230);
      local_248 = puVar13;
      puVar13 = puVar13 + iVar18;
      for (local_230 = *(undefined4 **)(param_4 + 0x10); local_230 != (undefined4 *)0x0;
          local_230 = (undefined4 *)*local_230) {
        *local_248 = (int)local_22c - (int)local_224 | 0x80000000;
        local_248[1] = (int)puVar13 - (int)local_224 | 0x80000000;
        local_248 = local_248 + 2;
        *(undefined2 *)local_22c = *(undefined2 *)(local_230[1] + 0xe);
        wcsncpy((wchar_t *)((int)local_22c + 2),*(wchar_t **)(local_230[1] + 0x10),
                (uint)*(ushort *)(local_230[1] + 0xe));
        uVar3 = *(undefined2 *)(local_230 + 6);
        local_22c = (uint *)((int)local_22c + (uint)*(ushort *)(local_230[1] + 0xe) * 2 + 2);
        uVar4 = *(undefined2 *)(local_230 + 5);
        *puVar13 = 0;
        puVar13[1] = 0;
        *(undefined2 *)(puVar13 + 2) = 4;
        local_240 = 0;
        *(undefined2 *)((int)puVar13 + 10) = 0;
        *(undefined2 *)(puVar13 + 3) = uVar3;
        *(undefined2 *)((int)puVar13 + 0xe) = uVar4;
        local_228 = puVar13 + 4;
        piVar6 = (int *)local_230[4];
        if (piVar6 != (int *)0x0) {
          local_24c = (uint *)((int)puVar24 - (int)local_224);
          local_244 = (undefined4 *)(-4 - (int)local_224);
          do {
            if (local_240 == 0) {
LAB_6b83be11:
              *local_228 = (int)local_22c - (int)local_224 | 0x80000000;
              local_228[1] = (uint)local_24c | 0x80000000;
              local_228 = local_228 + 2;
              *(undefined2 *)local_22c = *(undefined2 *)(piVar6[1] + 0xe);
              wcsncpy((wchar_t *)((int)local_22c + 2),*(wchar_t **)(piVar6[1] + 0x10),
                      (uint)*(ushort *)(piVar6[1] + 0xe));
              local_240 = piVar6[1];
              uVar2 = *(ushort *)(local_240 + 0xe);
              uVar3 = *(undefined2 *)((int)piVar6 + 0x1e);
              *puVar24 = 0;
              local_22c = (uint *)((int)local_22c + (uint)uVar2 * 2 + 2);
              puVar24[1] = 0;
              *(undefined2 *)(puVar24 + 2) = 4;
              *(undefined4 *)((int)puVar24 + 10) = 0;
              *(undefined2 *)((int)puVar24 + 0xe) = uVar3;
              puVar24 = puVar24 + 4;
              local_24c = local_24c + 4;
            }
            else {
              puVar8 = *(ushort **)(piVar6[1] + 0x10);
              puVar14 = *(ushort **)(local_240 + 0x10);
              do {
                uVar2 = *puVar14;
                bVar28 = uVar2 < *puVar8;
                if (uVar2 != *puVar8) {
LAB_6b83bdfe:
                  uVar23 = -(uint)bVar28 | 1;
                  goto LAB_6b83be03;
                }
                if (uVar2 == 0) break;
                uVar2 = puVar14[1];
                bVar28 = uVar2 < puVar8[1];
                if (uVar2 != puVar8[1]) goto LAB_6b83bdfe;
                puVar14 = puVar14 + 2;
                puVar8 = puVar8 + 2;
              } while (uVar2 != 0);
              uVar23 = 0;
LAB_6b83be03:
              if (uVar23 != 0) goto LAB_6b83be11;
            }
            local_24c = local_24c + 2;
            *puVar24 = (uint)*(ushort *)(piVar6 + 8);
            puVar24[1] = (int)local_244 + 4 + (int)puVar19;
            puVar24 = puVar24 + 2;
            iVar18 = piVar6[2];
            uVar23 = piVar6[5];
            uVar20 = local_234[3];
            puVar19[3] = 0;
            *puVar19 = iVar18 + uVar20;
            puVar19[1] = uVar23;
            puVar19[2] = 0x4e4;
            puVar19 = puVar19 + 4;
            piVar6 = (int *)*piVar6;
          } while (piVar6 != (int *)0x0);
        }
        piVar6 = (int *)local_230[3];
        local_244 = (undefined4 *)0x0;
        if (piVar6 != (int *)0x0) {
          local_260 = (undefined4 *)((int)puVar24 - (int)local_224);
          local_240 = -(int)local_224 + -4;
          do {
            if ((local_244 == (undefined4 *)0x0) ||
               (*(short *)(local_244 + 1) != *(short *)(piVar6[1] + 4))) {
              *local_228 = (uint)*(ushort *)(piVar6[1] + 4);
              local_228[1] = (uint)local_260 | 0x80000000;
              local_228 = local_228 + 2;
              local_244 = (undefined4 *)piVar6[1];
              uVar3 = *(undefined2 *)((int)piVar6 + 0x1e);
              *puVar24 = 0;
              puVar24[1] = 0;
              *(undefined2 *)(puVar24 + 2) = 4;
              *(undefined4 *)((int)puVar24 + 10) = 0;
              *(undefined2 *)((int)puVar24 + 0xe) = uVar3;
              puVar24 = puVar24 + 4;
              local_260 = local_260 + 4;
            }
            local_260 = local_260 + 2;
            *puVar24 = (uint)*(ushort *)(piVar6 + 8);
            puVar24[1] = -(int)local_224 + (int)puVar19;
            puVar24 = puVar24 + 2;
            iVar18 = piVar6[2];
            uVar23 = piVar6[5];
            uVar20 = local_234[3];
            puVar19[3] = 0;
            *puVar19 = iVar18 + uVar20;
            puVar19[1] = uVar23;
            puVar19[2] = 0x4e4;
            puVar19 = puVar19 + 4;
            piVar6 = (int *)*piVar6;
          } while (piVar6 != (int *)0x0);
        }
        puVar13 = local_228;
      }
      for (local_260 = *(undefined4 **)(param_4 + 0xc); HVar27 = local_258,
          local_260 != (undefined4 *)0x0; local_260 = (undefined4 *)*local_260) {
        *local_248 = (uint)*(ushort *)(local_260[1] + 4);
        local_248[1] = (int)puVar13 - (int)local_224 | 0x80000000;
        local_248 = local_248 + 2;
        uVar3 = *(undefined2 *)(local_260 + 6);
        uVar4 = *(undefined2 *)(local_260 + 5);
        *puVar13 = 0;
        puVar13[1] = 0;
        *(undefined2 *)(puVar13 + 2) = 4;
        local_240 = 0;
        *(undefined2 *)((int)puVar13 + 10) = 0;
        *(undefined2 *)(puVar13 + 3) = uVar3;
        *(undefined2 *)((int)puVar13 + 0xe) = uVar4;
        local_228 = puVar13 + 4;
        piVar6 = (int *)local_260[4];
        if (piVar6 != (int *)0x0) {
          local_230 = (undefined4 *)((int)puVar24 - (int)local_224);
          local_244 = (undefined4 *)(-4 - (int)local_224);
          do {
            if (local_240 == 0) {
LAB_6b83c0e5:
              *local_228 = (int)local_22c - (int)local_224 | 0x80000000;
              local_228[1] = (uint)local_230 | 0x80000000;
              local_228 = local_228 + 2;
              *(undefined2 *)local_22c = *(undefined2 *)(piVar6[1] + 0xe);
              wcsncpy((wchar_t *)((int)local_22c + 2),*(wchar_t **)(piVar6[1] + 0x10),
                      (uint)*(ushort *)(piVar6[1] + 0xe));
              local_240 = piVar6[1];
              uVar2 = *(ushort *)(local_240 + 0xe);
              uVar3 = *(undefined2 *)((int)piVar6 + 0x1e);
              *puVar24 = 0;
              local_22c = (uint *)((int)local_22c + (uint)uVar2 * 2 + 2);
              puVar24[1] = 0;
              *(undefined2 *)(puVar24 + 2) = 4;
              *(undefined4 *)((int)puVar24 + 10) = 0;
              *(undefined2 *)((int)puVar24 + 0xe) = uVar3;
              puVar24 = puVar24 + 4;
              local_230 = local_230 + 4;
            }
            else {
              puVar8 = *(ushort **)(piVar6[1] + 0x10);
              puVar14 = *(ushort **)(local_240 + 0x10);
              do {
                uVar2 = *puVar14;
                bVar28 = uVar2 < *puVar8;
                if (uVar2 != *puVar8) {
LAB_6b83c0d2:
                  uVar23 = -(uint)bVar28 | 1;
                  goto LAB_6b83c0d7;
                }
                if (uVar2 == 0) break;
                uVar2 = puVar14[1];
                bVar28 = uVar2 < puVar8[1];
                if (uVar2 != puVar8[1]) goto LAB_6b83c0d2;
                puVar14 = puVar14 + 2;
                puVar8 = puVar8 + 2;
              } while (uVar2 != 0);
              uVar23 = 0;
LAB_6b83c0d7:
              if (uVar23 != 0) goto LAB_6b83c0e5;
            }
            local_230 = local_230 + 2;
            *puVar24 = (uint)*(ushort *)(piVar6 + 8);
            puVar24[1] = (int)local_244 + 4 + (int)puVar19;
            puVar24 = puVar24 + 2;
            iVar18 = piVar6[2];
            uVar23 = piVar6[5];
            uVar20 = local_234[3];
            puVar19[3] = 0;
            *puVar19 = iVar18 + uVar20;
            puVar19[1] = uVar23;
            puVar19[2] = 0x4e4;
            puVar19 = puVar19 + 4;
            piVar6 = (int *)*piVar6;
          } while (piVar6 != (int *)0x0);
        }
        piVar6 = (int *)local_260[3];
        local_244 = (undefined4 *)0x0;
        if (piVar6 != (int *)0x0) {
          local_230 = (undefined4 *)((int)puVar24 - (int)local_224);
          local_240 = -(int)local_224 + -4;
          do {
            if ((local_244 == (undefined4 *)0x0) ||
               (*(short *)(local_244 + 1) != *(short *)(piVar6[1] + 4))) {
              *local_228 = (uint)*(ushort *)(piVar6[1] + 4);
              local_228[1] = (uint)local_230 | 0x80000000;
              local_228 = local_228 + 2;
              local_244 = (undefined4 *)piVar6[1];
              uVar3 = *(undefined2 *)((int)piVar6 + 0x1e);
              *puVar24 = 0;
              puVar24[1] = 0;
              *(undefined2 *)(puVar24 + 2) = 4;
              *(undefined4 *)((int)puVar24 + 10) = 0;
              *(undefined2 *)((int)puVar24 + 0xe) = uVar3;
              puVar24 = puVar24 + 4;
              local_230 = local_230 + 4;
            }
            local_230 = local_230 + 2;
            *puVar24 = (uint)*(ushort *)(piVar6 + 8);
            puVar24[1] = -(int)local_224 + (int)puVar19;
            puVar24 = puVar24 + 2;
            iVar18 = piVar6[2];
            uVar23 = piVar6[5];
            uVar20 = local_234[3];
            puVar19[3] = 0;
            *puVar19 = iVar18 + uVar20;
            puVar19[1] = uVar23;
            puVar19[2] = 0x4e4;
            puVar19 = puVar19 + 4;
            piVar6 = (int *)*piVar6;
          } while (piVar6 != (int *)0x0);
        }
        puVar13 = local_228;
      }
      uVar20 = 0;
      uVar23 = ~-(uint)(local_238 < local_22c) & (uint)((int)local_238 + (1 - (int)local_22c)) >> 1;
      puVar13 = local_22c;
      if (uVar23 != 0) {
        do {
          uVar20 = uVar20 + 1;
          *(undefined2 *)puVar13 = 0;
          puVar13 = (uint *)((int)puVar13 + 2);
        } while (uVar20 < uVar23);
      }
      _llseek(local_258,0,0);
      uVar23 = local_254;
      FUN_6b83fb4d(HVar27,local_254,param_3 + 0x108);
      _llseek(uVar23,uVar22,0);
      _llseek(HVar27,iVar5,0);
      if (uVar22 < local_1cc) {
        FUN_6b83fb4d(HVar27,uVar23,local_1cc - uVar22);
      }
      uVar22 = local_dc - (local_dc - 1U & local_c4) & local_dc - 1U;
      local_c4 = local_c4 + uVar22;
      if (0xf < (int)uVar22) {
        uVar20 = uVar22 >> 4;
        uVar22 = uVar22 + uVar20 * -0x10;
        do {
          _hwrite(uVar23,"",0x10);
          uVar20 = uVar20 - 1;
          HVar27 = local_258;
        } while (uVar20 != 0);
      }
      _hwrite(uVar23,"",uVar22);
      _llseek(HVar27,(local_1cc - 1) + local_1e4 & ~(local_1e4 - 1U),0);
      local_f8 = 0;
      bVar28 = false;
      puVar24 = puVar11;
      for (puVar13 = _Dst; puVar13 < puVar1; puVar13 = puVar13 + 10) {
        if (puVar13 == puVar10) {
          puVar13 = puVar13 + 10;
        }
        if (puVar24 == local_234) {
          bVar28 = true;
          uVar22 = _llseek(uVar23,0,1);
          puVar24[5] = uVar22;
          auStack144[4] = local_234[3];
          auStack144[5] = local_23c;
          local_28c = _llseek(uVar23,0,1);
          _hwrite(uVar23,(LPCCH)local_224,uVar7);
          local_290 = FUN_6b8403ca(param_4,uVar23,local_dc,local_234[4] - uVar7,(undefined4 *)0x0);
          LVar15 = _llseek(uVar23,0,1);
          uVar23 = local_254;
          if (local_250 == 0xffffffff) {
            _llseek(local_254,local_28c,0);
            _hwrite(local_254,(LPCCH)local_224,uVar7);
            uVar23 = local_254;
            _llseek(local_254,LVar15,0);
            LVar15 = _llseek(local_258,0,1);
            _llseek(local_258,puVar13[4] + LVar15,0);
          }
          local_f8 = local_f8 + puVar24[4];
          if (pbVar9 == (byte *)0x0) {
LAB_6b83c51d:
            puVar24 = puVar24 + 10;
            goto LAB_6b83c5f5;
          }
        }
        else {
          if ((local_250 != 0xffffffff) && (puVar24 == puVar11 + local_250 * 10)) {
            uVar22 = _llseek(uVar23,0,1);
            puVar24[5] = uVar22;
            FUN_6b8403ca(param_4,uVar23,local_dc,0xffffffff,local_290);
            LVar15 = _llseek(uVar23,0,1);
            puVar24[4] = LVar15 - puVar24[5];
            puVar24[2] = LVar15 - puVar24[5];
            _llseek(local_254,local_28c,0);
            _hwrite(local_254,(LPCCH)local_224,uVar7);
            uVar23 = local_254;
            _llseek(local_254,LVar15,0);
            local_f8 = local_f8 + puVar24[4];
            goto LAB_6b83c51d;
          }
          if (puVar24 < local_234) {
            if (puVar13[5] != 0) {
              uVar22 = _llseek(uVar23,0,1);
              if (puVar13[5] != uVar22) {
                _llseek(uVar23,local_294 + puVar13[5],0);
              }
              goto LAB_6b83c5f5;
            }
          }
          else {
LAB_6b83c5f5:
            if (puVar13[5] != 0) {
              uVar22 = _llseek(uVar23,0,1);
              puVar24[5] = uVar22;
              _llseek(local_258,puVar13[5],0);
              FUN_6b83fb4d(local_258,uVar23,puVar13[4]);
            }
          }
          if ((uint **)puVar13 == local_25c) {
            local_29c = puVar24;
          }
          if ((*(byte *)(puVar24 + 9) & 0x40) != 0) {
            local_f8 = local_f8 + puVar24[4];
          }
        }
        puVar24 = puVar24 + 10;
      }
      if (puVar10 != (uint *)0x0) {
        local_f8 = local_f8 - puVar10[4];
      }
      if (!bVar28) {
        uVar22 = _llseek(uVar23,0,1);
        local_234[5] = uVar22;
        auStack144[4] = local_234[3];
        auStack144[5] = local_23c;
        LVar15 = _llseek(uVar23,0,1);
        uVar22 = local_254;
        _hwrite(local_254,(LPCCH)local_224,uVar7);
        FUN_6b8403ca(param_4,uVar22,local_dc,local_234[4] - uVar7,(undefined4 *)0x0);
        LVar16 = _llseek(uVar22,0,1);
        uVar22 = local_254;
        if (local_250 == 0xffffffff) {
          _llseek(local_254,LVar15,0);
          _hwrite(uVar22,(LPCCH)local_224,uVar7);
          _llseek(uVar22,LVar16,0);
        }
        local_f8 = local_f8 + puVar24[4];
      }
      pbVar17 = FUN_6b83f3e4((byte *)puVar11,(byte *)(puVar11 + (uint)local_112 * 10),
                             (byte *)".reloc");
      uVar22 = local_254;
      if (pbVar17 != (byte *)0x0) {
        auStack144[10] = *(uint *)(pbVar17 + 0xc);
      }
      _llseek(local_254,param_3 + 0x108,0);
      _hwrite(uVar22,(LPCCH)puVar11,(uint)local_112 * 0x28);
      local_238 = (uint *)_llseek(uVar22,0,2);
      _hwrite(uVar22,(LPCCH)0x0,0);
      pbVar17 = FUN_6b83f3e4((byte *)puVar11,(byte *)(puVar11 + (uint)local_112 * 10),
                             (byte *)".debug");
      iVar5 = FUN_6b83e243(local_258,uVar22,(int)puVar12,(int)pbVar17,(int)local_25c,(int)local_29c,
                           (int)&local_220,(int)&local_118,local_298,(uint *)&local_238);
      if (iVar5 == 0) {
        if (pbVar9 == (byte *)0x0) {
          uVar7 = local_234[4];
        }
        else {
          uVar7 = *(int *)(pbVar9 + 0x10) - local_234[4];
        }
        FUN_6b83e58b(local_258,uVar22,(int)puVar11,uVar7,(int)&local_118,local_1cc);
      }
      if (((local_25c != (uint **)0x0) && (puVar12 == (uint *)0x0)) && (auStack144[13] != 0)) {
        LVar15 = _llseek(local_258,0,2);
        LVar16 = _llseek(uVar22,0,2);
        if (local_10c != 0) {
          local_10c = local_10c + (LVar16 - (int)local_238);
        }
        _llseek(local_258,(LONG)local_238,0);
        FUN_6b83fb4d(local_258,uVar22,LVar15 - (int)local_238);
      }
      _llseek(uVar22,param_3,0);
      _hwrite(uVar22,(LPCCH)&local_118,0x108);
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,_Dst);
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_224);
    }
  }
  else {
LAB_6b83ba4f:
    puVar13 = local_234;
    puVar24 = local_234;
    for (iVar18 = 10; iVar18 != 0; iVar18 = iVar18 + -1) {
      *puVar24 = 0;
      puVar24 = puVar24 + 1;
    }
    iVar18 = FUN_6b8409b0(local_234,0,(int)".rsrc");
    if (-1 < iVar18) {
      puVar13[2] = local_264;
      puVar13[4] = (local_264 - 1) + local_dc & ~(local_dc - 1U);
      puVar13[3] = ((local_224[-8] - 1) + local_e0 & ~(local_e0 - 1U)) + local_224[-7];
      puVar13[9] = 0x40000040;
      goto LAB_6b83bab8;
    }
  }
LAB_6b83c8ee:
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar11);
  pbVar17 = extraout_EDX_03;
LAB_6b83c90c:
  FUN_6b8224af(local_c ^ (uint)&stack0xfffffffc,pbVar17);
  return;
}



void __fastcall FUN_6b83c91d(HFILE param_1,uint param_2,int param_3,int param_4)

{
  uint *puVar1;
  ushort uVar2;
  undefined2 uVar3;
  undefined2 uVar4;
  int iVar5;
  int *piVar6;
  uint *_Dst;
  uint uVar7;
  ushort *puVar8;
  byte *pbVar9;
  uint *puVar10;
  uint *puVar11;
  uint *puVar12;
  uint *puVar13;
  ushort *puVar14;
  LONG LVar15;
  LONG LVar16;
  byte *pbVar17;
  int iVar18;
  uint *extraout_EDX;
  uint *extraout_EDX_00;
  uint *extraout_EDX_01;
  uint *extraout_EDX_02;
  uint *puVar19;
  uint uVar20;
  byte *extraout_EDX_03;
  undefined4 *puVar21;
  uint uVar22;
  uint uVar23;
  uint *puVar24;
  undefined4 *puVar25;
  int iVar26;
  HFILE HVar27;
  int in_FS_OFFSET;
  bool bVar28;
  undefined8 uVar29;
  uint *local_27c;
  uint local_278;
  uint local_274;
  undefined4 *local_270;
  LONG local_26c;
  int local_248;
  uint local_244;
  undefined4 *local_240;
  uint **local_23c;
  HFILE local_238;
  uint local_234;
  uint local_230;
  uint *local_22c;
  uint *local_228;
  undefined4 *local_224;
  int local_220;
  uint local_21c;
  uint *local_218;
  uint *local_214;
  undefined4 *local_210;
  uint *local_20c;
  uint *local_208;
  uint *local_204;
  undefined4 local_200;
  ushort local_1fa;
  int local_1c4;
  uint local_1ac;
  byte *local_158;
  undefined4 local_108;
  ushort local_102;
  int local_fc;
  int local_e8;
  int local_d0;
  int local_cc;
  uint local_b8;
  uint local_b4;
  uint auStack144 [33];
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_230 = 0xffffffff;
  local_270 = (undefined4 *)0x0;
  local_210 = (undefined4 *)0x0;
  local_240 = (undefined4 *)0x0;
  local_220 = 0;
  local_228 = (uint *)0x0;
  local_248 = 0;
  local_20c = (uint *)0x0;
  local_26c = 0;
  local_218 = (uint *)0x0;
  local_27c = (uint *)0x0;
  local_204 = (uint *)0xffffffff;
  local_274 = 0;
  local_238 = param_1;
  local_234 = param_2;
  _llseek(param_1,param_3,0);
  _hread(param_1,&local_200,0xf8);
  iVar5 = (uint)local_1fa * 0x28 + param_3 + 0xf8;
  puVar21 = &local_200;
  puVar25 = &local_108;
  for (iVar18 = 0x3e; iVar18 != 0; iVar18 = iVar18 + -1) {
    *puVar25 = *puVar21;
    puVar21 = puVar21 + 1;
    puVar25 = puVar25 + 1;
  }
  piVar6 = (int *)KernelBaseGetGlobalData();
  uVar29 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                           *piVar6 + 0x1c0000U | 8,(uint)local_1fa * 0x28);
  pbVar17 = (byte *)((ulonglong)uVar29 >> 0x20);
  _Dst = (uint *)uVar29;
  if (_Dst == (uint *)0x0) goto LAB_6b83e232;
  memset(_Dst,0,(uint)local_1fa * 0x28);
  HVar27 = local_238;
  _llseek(local_238,param_3 + 0xf8,0);
  _hread(HVar27,_Dst,(uint)local_1fa * 0x28);
  uVar22 = 0;
  local_278 = 0;
  puVar1 = _Dst + (uint)local_1fa * 10;
  if (_Dst < puVar1) {
    puVar12 = _Dst + 4;
    iVar18 = ((uint)local_1fa * 0x28 - 1) / 0x28 + 1;
    do {
      if (uVar22 <= puVar12[1] && puVar12[1] != uVar22) {
        uVar22 = *puVar12 + puVar12[1];
      }
      puVar12 = puVar12 + 10;
      iVar18 = iVar18 + -1;
      local_278 = uVar22;
    } while (iVar18 != 0);
  }
  uVar22 = 0;
  local_21c = 0;
  local_224 = *(undefined4 **)(param_4 + 0x10);
  for (puVar21 = local_224; puVar21 != (undefined4 *)0x0; puVar21 = (undefined4 *)*puVar21) {
    puVar25 = (undefined4 *)puVar21[4];
    if ((puVar25 != (undefined4 *)0x0) || (puVar21[3] != 0)) {
      local_228 = (uint *)((int)local_228 + 1);
      local_220 = local_220 + 1;
      local_240 = (undefined4 *)((int)local_240 + (uint)*(ushort *)(puVar21[1] + 0xe) * 2 + 2);
      iVar18 = 0;
      for (; puVar25 != (undefined4 *)0x0; puVar25 = (undefined4 *)*puVar25) {
        local_20c = (uint *)((int)local_20c + 1);
        if (iVar18 == 0) {
LAB_6b83cb5e:
          iVar26 = puVar25[1];
          local_210 = (undefined4 *)((int)local_210 + (uint)*(ushort *)(iVar26 + 0xe) * 2 + 2);
          local_248 = local_248 + 1;
        }
        else {
          iVar26 = puVar25[1];
          puVar8 = *(ushort **)(iVar18 + 0x10);
          puVar14 = *(ushort **)(iVar26 + 0x10);
          do {
            uVar2 = *puVar8;
            bVar28 = uVar2 < *puVar14;
            if (uVar2 != *puVar14) {
LAB_6b83cb4f:
              uVar7 = -(uint)bVar28 | 1;
              goto LAB_6b83cb54;
            }
            if (uVar2 == 0) break;
            uVar2 = puVar8[1];
            bVar28 = uVar2 < puVar14[1];
            if (uVar2 != puVar14[1]) goto LAB_6b83cb4f;
            puVar8 = puVar8 + 2;
            puVar14 = puVar14 + 2;
          } while (uVar2 != 0);
          uVar7 = 0;
LAB_6b83cb54:
          uVar22 = local_21c;
          if (uVar7 != 0) goto LAB_6b83cb5e;
        }
        uVar22 = uVar22 + (puVar25[5] + 3 & 0xfffffffc);
        iVar18 = iVar26;
        local_21c = uVar22;
      }
      iVar18 = 0;
      for (puVar25 = (undefined4 *)puVar21[3]; puVar25 != (undefined4 *)0x0;
          puVar25 = (undefined4 *)*puVar25) {
        local_20c = (uint *)((int)local_20c + 1);
        if ((iVar18 == 0) || (*(short *)(iVar18 + 4) != *(short *)(puVar25[1] + 4))) {
          local_248 = local_248 + 1;
        }
        uVar22 = uVar22 + (puVar25[5] + 3 & 0xfffffffc);
        iVar18 = puVar25[1];
        local_21c = uVar22;
      }
    }
  }
  for (local_23c = *(uint ***)(param_4 + 0xc); local_23c != (uint **)0x0;
      local_23c = (uint **)*local_23c) {
    puVar21 = local_23c[4];
    if ((puVar21 != (undefined4 *)0x0) || (local_23c[3] != (uint *)0x0)) {
      local_228 = (uint *)((int)local_228 + 1);
      iVar18 = 0;
      for (; puVar21 != (undefined4 *)0x0; puVar21 = (undefined4 *)*puVar21) {
        local_20c = (uint *)((int)local_20c + 1);
        if (iVar18 == 0) {
LAB_6b83cc70:
          iVar26 = puVar21[1];
          local_248 = local_248 + 1;
          local_210 = (undefined4 *)((int)local_210 + (uint)*(ushort *)(iVar26 + 0xe) * 2 + 2);
        }
        else {
          iVar26 = puVar21[1];
          puVar8 = *(ushort **)(iVar18 + 0x10);
          puVar14 = *(ushort **)(iVar26 + 0x10);
          do {
            uVar2 = *puVar8;
            bVar28 = uVar2 < *puVar14;
            if (uVar2 != *puVar14) {
LAB_6b83cc67:
              uVar22 = -(uint)bVar28 | 1;
              goto LAB_6b83cc6c;
            }
            if (uVar2 == 0) break;
            uVar2 = puVar8[1];
            bVar28 = uVar2 < puVar14[1];
            if (uVar2 != puVar14[1]) goto LAB_6b83cc67;
            puVar8 = puVar8 + 2;
            puVar14 = puVar14 + 2;
          } while (uVar2 != 0);
          uVar22 = 0;
LAB_6b83cc6c:
          if (uVar22 != 0) goto LAB_6b83cc70;
        }
        uVar22 = local_21c + (puVar21[5] + 3 & 0xfffffffc);
        iVar18 = iVar26;
        local_21c = uVar22;
      }
      iVar18 = 0;
      for (puVar21 = local_23c[3]; puVar21 != (undefined4 *)0x0; puVar21 = (undefined4 *)*puVar21) {
        local_20c = (uint *)((int)local_20c + 1);
        if ((iVar18 == 0) || (*(short *)(iVar18 + 4) != *(short *)(puVar21[1] + 4))) {
          local_248 = local_248 + 1;
        }
        uVar22 = uVar22 + (puVar21[5] + 3 & 0xfffffffc);
        iVar18 = puVar21[1];
        local_21c = uVar22;
      }
    }
  }
  uVar7 = (int)local_240 +
          (int)local_20c * 0x18 + local_248 * 0x18 + (int)local_228 * 0x18 + 0x10 +
          (-((int)local_240 + (int)local_210) & 3U) + (int)local_210;
  pbVar9 = FUN_6b83f3e4((byte *)_Dst,(byte *)puVar1,(byte *)".rsrc");
  puVar10 = (uint *)FUN_6b83f3e4((byte *)_Dst,(byte *)puVar1,(byte *)".rsrc1");
  puVar11 = (uint *)FUN_6b83f3e4((byte *)_Dst,(byte *)puVar1,(byte *)".reloc");
  puVar12 = local_218;
  if (pbVar9 == (byte *)0x0) {
    uVar23 = 0x7fffffff;
  }
  else {
    puVar13 = (uint *)(pbVar9 + 0x28);
    local_204 = (uint *)(((int)pbVar9 - (int)_Dst) / 0x28);
    pbVar17 = (byte *)(((int)pbVar9 - (int)_Dst) % 0x28);
    if ((puVar13 == puVar10) || (puVar1 <= puVar13)) {
      uVar23 = 0x7fffffff;
    }
    else {
      if (puVar11 == (uint *)0x0) {
        uVar23 = 0x7fffffff;
      }
      else {
        uVar23 = *(int *)(pbVar9 + 0x34) - *(int *)(pbVar9 + 0xc);
        pbVar17 = pbVar9;
      }
      if (uVar23 < uVar7) goto LAB_6b83e232;
    }
    if (uVar23 < uVar22 + uVar7) {
      if (puVar11 == puVar13) {
        uVar23 = 0x7fffffff;
      }
      else {
        if (puVar10 == (uint *)0x0) {
          iVar18 = (int)puVar11 - (int)_Dst;
          uVar22 = puVar11[3];
        }
        else {
          iVar18 = (int)puVar10 - (int)_Dst;
          uVar22 = puVar10[3];
        }
        local_230 = iVar18 / 0x28;
        puVar12 = (uint *)(uVar22 - *(int *)(pbVar9 + 0xc));
      }
    }
  }
  local_244 = 0;
  uVar22 = uVar7;
  local_21c = uVar7;
  for (puVar21 = local_224; puVar21 != (undefined4 *)0x0; puVar21 = (undefined4 *)*puVar21) {
    puVar11 = (uint *)puVar21[4];
    uVar20 = local_21c;
    if ((puVar11 != (uint *)0x0) || (puVar21[3] != 0)) {
      while (local_208 = puVar11, local_208 != (uint *)0x0) {
        uVar22 = FUN_6b83f032((int *)&local_208,(uint)puVar12,uVar22,uVar23,&local_244);
        puVar11 = local_208;
        puVar12 = extraout_EDX;
        uVar20 = uVar22;
      }
      local_208 = (uint *)puVar21[3];
      local_21c = uVar20;
      while (local_208 != (uint *)0x0) {
        uVar22 = FUN_6b83f032((int *)&local_208,(uint)puVar12,uVar22,uVar23,&local_244);
        puVar12 = extraout_EDX_00;
        uVar20 = uVar22;
      }
    }
    local_21c = uVar20;
  }
  for (puVar21 = *(undefined4 **)(param_4 + 0xc); puVar21 != (undefined4 *)0x0;
      puVar21 = (undefined4 *)*puVar21) {
    puVar11 = (uint *)puVar21[4];
    uVar20 = local_21c;
    if ((puVar11 != (uint *)0x0) || (puVar21[3] != 0)) {
      while (local_208 = puVar11, local_208 != (uint *)0x0) {
        uVar22 = FUN_6b83f032((int *)&local_208,(uint)puVar12,uVar22,uVar23,&local_244);
        puVar11 = local_208;
        puVar12 = extraout_EDX_01;
        uVar20 = uVar22;
      }
      local_208 = (uint *)puVar21[3];
      local_21c = uVar20;
      while (local_208 != (uint *)0x0) {
        uVar22 = FUN_6b83f032((int *)&local_208,(uint)puVar12,uVar22,uVar23,&local_244);
        puVar12 = extraout_EDX_02;
        uVar20 = uVar22;
      }
    }
    local_21c = uVar20;
  }
  if (local_244 == 0) {
    local_244 = uVar22;
  }
  puVar12 = (uint *)FUN_6b83f3e4((byte *)_Dst,(byte *)puVar1,(byte *)".debug");
  if ((puVar12 != (uint *)0x0) &&
     ((pbVar17 = local_158, local_158 == (byte *)0x0 || (puVar12 != puVar1 + -10))))
  goto LAB_6b83e232;
  local_23c = (uint **)0x0;
  for (puVar11 = _Dst;
      (puVar13 = (uint *)local_23c, puVar11 < puVar1 &&
      ((local_158 < (byte *)puVar11[3] ||
       (puVar13 = puVar11, (byte *)(puVar11[4] + puVar11[3]) <= local_158))));
      puVar11 = puVar11 + 10) {
  }
  local_23c = (uint **)puVar13;
  puVar11 = (uint *)FUN_6b83f3e4((byte *)_Dst,(byte *)puVar1,(byte *)".reloc");
  if (local_204 == (uint *)0xffffffff) {
    puVar13 = puVar11;
    if ((puVar11 == (uint *)0x0) && (puVar13 = puVar12, puVar12 == (uint *)0x0)) {
      local_204 = (uint *)(uint)local_102;
    }
    else {
      local_204 = (uint *)(((int)puVar13 - (int)_Dst) / 0x28);
    }
    local_102 = local_102 + 1;
  }
  if (local_230 == 0xffffffff) {
    if (puVar10 != (uint *)0x0) {
      local_102 = local_102 - 1;
      goto LAB_6b83d098;
    }
  }
  else {
    if (puVar10 == (uint *)0x0) {
      if (puVar11 == (uint *)0x0) {
        if (puVar12 == (uint *)0x0) {
          local_230 = (uint)local_102;
          goto LAB_6b83d083;
        }
        iVar18 = (int)puVar12 - (int)_Dst;
      }
      else {
        iVar18 = (int)puVar11 - (int)_Dst;
      }
      local_230 = iVar18 / 0x28;
    }
    else {
      local_230 = ((int)puVar10 - (int)_Dst) / 0x28;
      local_102 = local_102 - 1;
    }
LAB_6b83d083:
    local_102 = local_102 + 1;
LAB_6b83d098:
  }
  uVar22 = ((uint)local_102 - (uint)local_1fa) * 0x28;
  uVar23 = ((local_1ac + (uint)local_1fa * -0x28) - param_3) - 0xf8;
  if (uVar22 < uVar23 || uVar22 - uVar23 == 0) {
    if (uVar22 != 0) {
      iVar18 = 0;
      do {
        uVar23 = auStack144[iVar18 * 2];
        if ((uVar23 != 0) && (uVar23 < local_1ac)) {
          auStack144[iVar18 * 2] = uVar23 + uVar22;
        }
        iVar18 = iVar18 + 1;
      } while (iVar18 < 0x10);
    }
  }
  else {
    uVar22 = uVar22 - uVar23;
    local_274 = local_cc + -1 + uVar22 & ~(local_cc - 1U);
    iVar18 = 0;
    do {
      uVar23 = auStack144[iVar18 * 2];
      if ((uVar23 != 0) && (uVar23 < local_b4)) {
        auStack144[iVar18 * 2] = uVar23 + uVar22;
      }
      iVar18 = iVar18 + 1;
    } while (iVar18 < 0x10);
    local_b4 = local_b4 + uVar22;
  }
  uVar22 = iVar5 + uVar22;
  uVar23 = (uint)local_102;
  piVar6 = (int *)KernelBaseGetGlobalData();
  uVar29 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                           *piVar6 + 0x1c0000U | 8,(int)(short)(uVar23 * 0x28));
  pbVar17 = (byte *)((ulonglong)uVar29 >> 0x20);
  puVar11 = (uint *)uVar29;
  if (puVar11 == (uint *)0x0) goto LAB_6b83e232;
  memset(puVar11,0,uVar23 * 0x28);
  local_224 = (undefined4 *)0x0;
  puVar24 = (uint *)0x0;
  local_208 = (uint *)0x0;
  puVar13 = puVar11 + (int)local_204 * 10;
  local_218 = puVar11;
  local_214 = puVar13;
  local_204 = _Dst;
  if (_Dst < puVar1) {
    local_22c = _Dst + 10;
    puVar19 = puVar11;
    do {
      if (local_204 == puVar10) {
        if ((local_230 == 0xffffffff) && (local_22c < puVar1)) {
          local_208 = (uint *)((int)puVar24 + (local_22c[-7] - local_22c[3]));
          puVar24 = local_208;
        }
      }
      else if (puVar19 == puVar13) {
        local_224 = (undefined4 *)&DAT_00000001;
        uVar23 = local_cc + -1 + local_244 & ~(local_cc - 1U);
        iVar18 = 10;
        puVar13 = local_204;
        puVar24 = puVar19;
        if (pbVar9 == (byte *)0x0) {
          puVar24 = (uint *)((local_244 - 1) + local_d0 & ~(local_d0 - 1U));
          puVar13 = puVar19;
          for (; iVar18 != 0; iVar18 = iVar18 + -1) {
            *puVar13 = 0;
            puVar13 = puVar13 + 1;
          }
          local_208 = puVar24;
          iVar18 = FUN_6b8409b0(puVar19,0,(int)".rsrc");
          if (iVar18 < 0) goto LAB_6b83e214;
          local_218[3] = local_22c[-7];
          local_218[5] = local_22c[-5];
          local_218[9] = 0x40000040;
          local_218[4] = uVar23;
          local_218[2] = local_244;
          puVar19 = local_218;
        }
        else {
          for (; iVar18 != 0; iVar18 = iVar18 + -1) {
            *puVar24 = *puVar13;
            puVar13 = puVar13 + 1;
            puVar24 = puVar24 + 1;
          }
          puVar19[4] = uVar23;
          puVar19[2] = local_244;
          if (uVar23 == local_22c[-6]) {
            puVar24 = (uint *)0x0;
            local_208 = (uint *)0x0;
          }
          else {
            puVar24 = (uint *)((int)local_208 + ((local_244 - 1) + local_d0 & ~(local_d0 - 1U)));
            local_208 = puVar24;
            if (local_22c < puVar1) {
              puVar24 = (uint *)((int)puVar24 + (local_22c[-7] - local_22c[3]));
              local_208 = puVar24;
            }
          }
        }
        puVar19 = puVar19 + 10;
        puVar13 = local_214;
        local_218 = puVar19;
        if (pbVar9 == (byte *)0x0) goto LAB_6b83d325;
      }
      else {
        if ((local_230 == 0xffffffff) || (puVar19 != puVar11 + local_230 * 10)) {
          if (puVar13 <= puVar19) goto LAB_6b83d325;
          puVar13 = local_204;
          puVar24 = puVar19;
          for (iVar18 = 10; iVar18 != 0; iVar18 = iVar18 + -1) {
            *puVar24 = *puVar13;
            puVar13 = puVar13 + 1;
            puVar24 = puVar24 + 1;
          }
        }
        else {
          puVar13 = puVar19;
          for (iVar18 = 10; iVar18 != 0; iVar18 = iVar18 + -1) {
            *puVar13 = 0;
            puVar13 = puVar13 + 1;
          }
          iVar18 = FUN_6b8409b0(puVar19,0,(int)".rsrc1");
          if (iVar18 < 0) goto LAB_6b83e214;
          if (puVar10 == (uint *)0x0) {
            uVar23 = local_22c[-7];
            local_218[3] = uVar23;
            local_218[9] = 0x40000040;
            local_208 = (uint *)((((local_21c - 1) + local_d0 & ~(local_d0 - 1U)) - uVar23) +
                                local_214[3]);
          }
          else {
            local_218[3] = puVar10[3];
            local_218[9] = 0x40000040;
            local_208 = (uint *)(((local_d0 + -1 + local_21c & ~(local_d0 - 1U)) - local_22c[-7]) +
                                local_214[3]);
          }
          puVar19 = local_218 + 10;
LAB_6b83d325:
          puVar13 = local_204;
          puVar24 = puVar19;
          for (iVar18 = 10; iVar18 != 0; iVar18 = iVar18 + -1) {
            *puVar24 = *puVar13;
            puVar13 = puVar13 + 1;
            puVar24 = puVar24 + 1;
          }
          puVar19[3] = puVar19[3] + (int)local_208;
        }
        puVar19 = puVar19 + 10;
        puVar13 = local_214;
        puVar24 = local_208;
        local_218 = puVar19;
      }
      local_204 = local_204 + 10;
      local_22c = local_22c + 10;
    } while (local_204 < puVar1);
    if (local_224 == (undefined4 *)0x0) goto LAB_6b83d375;
LAB_6b83d3de:
    local_b8 = puVar11[(uint)local_102 * 10 + -7] + puVar11[(uint)local_102 * 10 + -6] + -1 +
               local_d0 & ~(local_d0 - 1U);
    piVar6 = (int *)KernelBaseGetGlobalData();
    puVar13 = (uint *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                                      *piVar6 + 0x1c0000U | 8,uVar7);
    local_204 = puVar13;
    if (puVar13 != (uint *)0x0) {
      memset(puVar13,0,uVar7);
      *puVar13 = 0;
      puVar13[1] = 0;
      *(undefined2 *)(puVar13 + 2) = 4;
      *(undefined2 *)((int)puVar13 + 10) = 0;
      *(short *)(puVar13 + 3) = (short)local_220;
      *(short *)((int)puVar13 + 0xe) = (short)local_228 - (short)local_220;
      puVar13 = puVar13 + 4;
      iVar18 = (int)local_228 * 2;
      puVar24 = puVar13 + iVar18 + (local_248 + (int)local_228 * 2) * 2;
      puVar19 = puVar24 + (int)((int)local_20c + local_248 * 2) * 2;
      local_20c = puVar19 + (int)local_20c * 4;
      local_218 = (uint *)((int)local_20c + (int)local_240 + (int)local_210);
      local_228 = puVar13;
      puVar13 = puVar13 + iVar18;
      for (local_210 = *(undefined4 **)(param_4 + 0x10); local_210 != (undefined4 *)0x0;
          local_210 = (undefined4 *)*local_210) {
        *local_228 = (int)local_20c - (int)local_204 | 0x80000000;
        local_228[1] = (int)puVar13 - (int)local_204 | 0x80000000;
        local_228 = local_228 + 2;
        *(undefined2 *)local_20c = *(undefined2 *)(local_210[1] + 0xe);
        wcsncpy((wchar_t *)((int)local_20c + 2),*(wchar_t **)(local_210[1] + 0x10),
                (uint)*(ushort *)(local_210[1] + 0xe));
        uVar3 = *(undefined2 *)(local_210 + 6);
        local_20c = (uint *)((int)local_20c + (uint)*(ushort *)(local_210[1] + 0xe) * 2 + 2);
        uVar4 = *(undefined2 *)(local_210 + 5);
        *puVar13 = 0;
        puVar13[1] = 0;
        *(undefined2 *)(puVar13 + 2) = 4;
        local_220 = 0;
        *(undefined2 *)((int)puVar13 + 10) = 0;
        *(undefined2 *)(puVar13 + 3) = uVar3;
        *(undefined2 *)((int)puVar13 + 0xe) = uVar4;
        local_208 = puVar13 + 4;
        piVar6 = (int *)local_210[4];
        if (piVar6 != (int *)0x0) {
          local_22c = (uint *)((int)puVar24 - (int)local_204);
          local_224 = (undefined4 *)(-4 - (int)local_204);
          do {
            if (local_220 == 0) {
LAB_6b83d737:
              *local_208 = (int)local_20c - (int)local_204 | 0x80000000;
              local_208[1] = (uint)local_22c | 0x80000000;
              local_208 = local_208 + 2;
              *(undefined2 *)local_20c = *(undefined2 *)(piVar6[1] + 0xe);
              wcsncpy((wchar_t *)((int)local_20c + 2),*(wchar_t **)(piVar6[1] + 0x10),
                      (uint)*(ushort *)(piVar6[1] + 0xe));
              local_220 = piVar6[1];
              uVar2 = *(ushort *)(local_220 + 0xe);
              uVar3 = *(undefined2 *)((int)piVar6 + 0x1e);
              *puVar24 = 0;
              local_20c = (uint *)((int)local_20c + (uint)uVar2 * 2 + 2);
              puVar24[1] = 0;
              *(undefined2 *)(puVar24 + 2) = 4;
              *(undefined4 *)((int)puVar24 + 10) = 0;
              *(undefined2 *)((int)puVar24 + 0xe) = uVar3;
              puVar24 = puVar24 + 4;
              local_22c = local_22c + 4;
            }
            else {
              puVar8 = *(ushort **)(piVar6[1] + 0x10);
              puVar14 = *(ushort **)(local_220 + 0x10);
              do {
                uVar2 = *puVar14;
                bVar28 = uVar2 < *puVar8;
                if (uVar2 != *puVar8) {
LAB_6b83d724:
                  uVar23 = -(uint)bVar28 | 1;
                  goto LAB_6b83d729;
                }
                if (uVar2 == 0) break;
                uVar2 = puVar14[1];
                bVar28 = uVar2 < puVar8[1];
                if (uVar2 != puVar8[1]) goto LAB_6b83d724;
                puVar14 = puVar14 + 2;
                puVar8 = puVar8 + 2;
              } while (uVar2 != 0);
              uVar23 = 0;
LAB_6b83d729:
              if (uVar23 != 0) goto LAB_6b83d737;
            }
            local_22c = local_22c + 2;
            *puVar24 = (uint)*(ushort *)(piVar6 + 8);
            puVar24[1] = (int)local_224 + 4 + (int)puVar19;
            puVar24 = puVar24 + 2;
            iVar18 = piVar6[2];
            uVar23 = piVar6[5];
            uVar20 = local_214[3];
            puVar19[3] = 0;
            *puVar19 = iVar18 + uVar20;
            puVar19[1] = uVar23;
            puVar19[2] = 0x4e4;
            puVar19 = puVar19 + 4;
            piVar6 = (int *)*piVar6;
          } while (piVar6 != (int *)0x0);
        }
        piVar6 = (int *)local_210[3];
        local_224 = (undefined4 *)0x0;
        if (piVar6 != (int *)0x0) {
          local_240 = (undefined4 *)((int)puVar24 - (int)local_204);
          local_220 = -(int)local_204 + -4;
          do {
            if ((local_224 == (undefined4 *)0x0) ||
               (*(short *)(local_224 + 1) != *(short *)(piVar6[1] + 4))) {
              *local_208 = (uint)*(ushort *)(piVar6[1] + 4);
              local_208[1] = (uint)local_240 | 0x80000000;
              local_208 = local_208 + 2;
              local_224 = (undefined4 *)piVar6[1];
              uVar3 = *(undefined2 *)((int)piVar6 + 0x1e);
              *puVar24 = 0;
              puVar24[1] = 0;
              *(undefined2 *)(puVar24 + 2) = 4;
              *(undefined4 *)((int)puVar24 + 10) = 0;
              *(undefined2 *)((int)puVar24 + 0xe) = uVar3;
              puVar24 = puVar24 + 4;
              local_240 = local_240 + 4;
            }
            local_240 = local_240 + 2;
            *puVar24 = (uint)*(ushort *)(piVar6 + 8);
            puVar24[1] = -(int)local_204 + (int)puVar19;
            puVar24 = puVar24 + 2;
            iVar18 = piVar6[2];
            uVar23 = piVar6[5];
            uVar20 = local_214[3];
            puVar19[3] = 0;
            *puVar19 = iVar18 + uVar20;
            puVar19[1] = uVar23;
            puVar19[2] = 0x4e4;
            puVar19 = puVar19 + 4;
            piVar6 = (int *)*piVar6;
          } while (piVar6 != (int *)0x0);
        }
        puVar13 = local_208;
      }
      for (local_240 = *(undefined4 **)(param_4 + 0xc); HVar27 = local_238,
          local_240 != (undefined4 *)0x0; local_240 = (undefined4 *)*local_240) {
        *local_228 = (uint)*(ushort *)(local_240[1] + 4);
        local_228[1] = (int)puVar13 - (int)local_204 | 0x80000000;
        local_228 = local_228 + 2;
        uVar3 = *(undefined2 *)(local_240 + 6);
        uVar4 = *(undefined2 *)(local_240 + 5);
        *puVar13 = 0;
        puVar13[1] = 0;
        *(undefined2 *)(puVar13 + 2) = 4;
        local_220 = 0;
        *(undefined2 *)((int)puVar13 + 10) = 0;
        *(undefined2 *)(puVar13 + 3) = uVar3;
        *(undefined2 *)((int)puVar13 + 0xe) = uVar4;
        local_208 = puVar13 + 4;
        piVar6 = (int *)local_240[4];
        if (piVar6 != (int *)0x0) {
          local_210 = (undefined4 *)((int)puVar24 - (int)local_204);
          local_224 = (undefined4 *)(-4 - (int)local_204);
          do {
            if (local_220 == 0) {
LAB_6b83da0b:
              *local_208 = (int)local_20c - (int)local_204 | 0x80000000;
              local_208[1] = (uint)local_210 | 0x80000000;
              local_208 = local_208 + 2;
              *(undefined2 *)local_20c = *(undefined2 *)(piVar6[1] + 0xe);
              wcsncpy((wchar_t *)((int)local_20c + 2),*(wchar_t **)(piVar6[1] + 0x10),
                      (uint)*(ushort *)(piVar6[1] + 0xe));
              local_220 = piVar6[1];
              uVar2 = *(ushort *)(local_220 + 0xe);
              uVar3 = *(undefined2 *)((int)piVar6 + 0x1e);
              *puVar24 = 0;
              local_20c = (uint *)((int)local_20c + (uint)uVar2 * 2 + 2);
              puVar24[1] = 0;
              *(undefined2 *)(puVar24 + 2) = 4;
              *(undefined4 *)((int)puVar24 + 10) = 0;
              *(undefined2 *)((int)puVar24 + 0xe) = uVar3;
              puVar24 = puVar24 + 4;
              local_210 = local_210 + 4;
            }
            else {
              puVar8 = *(ushort **)(piVar6[1] + 0x10);
              puVar14 = *(ushort **)(local_220 + 0x10);
              do {
                uVar2 = *puVar14;
                bVar28 = uVar2 < *puVar8;
                if (uVar2 != *puVar8) {
LAB_6b83d9f8:
                  uVar23 = -(uint)bVar28 | 1;
                  goto LAB_6b83d9fd;
                }
                if (uVar2 == 0) break;
                uVar2 = puVar14[1];
                bVar28 = uVar2 < puVar8[1];
                if (uVar2 != puVar8[1]) goto LAB_6b83d9f8;
                puVar14 = puVar14 + 2;
                puVar8 = puVar8 + 2;
              } while (uVar2 != 0);
              uVar23 = 0;
LAB_6b83d9fd:
              if (uVar23 != 0) goto LAB_6b83da0b;
            }
            local_210 = local_210 + 2;
            *puVar24 = (uint)*(ushort *)(piVar6 + 8);
            puVar24[1] = (int)local_224 + 4 + (int)puVar19;
            puVar24 = puVar24 + 2;
            iVar18 = piVar6[2];
            uVar23 = piVar6[5];
            uVar20 = local_214[3];
            puVar19[3] = 0;
            *puVar19 = iVar18 + uVar20;
            puVar19[1] = uVar23;
            puVar19[2] = 0x4e4;
            puVar19 = puVar19 + 4;
            piVar6 = (int *)*piVar6;
          } while (piVar6 != (int *)0x0);
        }
        piVar6 = (int *)local_240[3];
        local_224 = (undefined4 *)0x0;
        if (piVar6 != (int *)0x0) {
          local_210 = (undefined4 *)((int)puVar24 - (int)local_204);
          local_220 = -(int)local_204 + -4;
          do {
            if ((local_224 == (undefined4 *)0x0) ||
               (*(short *)(local_224 + 1) != *(short *)(piVar6[1] + 4))) {
              *local_208 = (uint)*(ushort *)(piVar6[1] + 4);
              local_208[1] = (uint)local_210 | 0x80000000;
              local_208 = local_208 + 2;
              local_224 = (undefined4 *)piVar6[1];
              uVar3 = *(undefined2 *)((int)piVar6 + 0x1e);
              *puVar24 = 0;
              puVar24[1] = 0;
              *(undefined2 *)(puVar24 + 2) = 4;
              *(undefined4 *)((int)puVar24 + 10) = 0;
              *(undefined2 *)((int)puVar24 + 0xe) = uVar3;
              puVar24 = puVar24 + 4;
              local_210 = local_210 + 4;
            }
            local_210 = local_210 + 2;
            *puVar24 = (uint)*(ushort *)(piVar6 + 8);
            puVar24[1] = -(int)local_204 + (int)puVar19;
            puVar24 = puVar24 + 2;
            iVar18 = piVar6[2];
            uVar23 = piVar6[5];
            uVar20 = local_214[3];
            puVar19[3] = 0;
            *puVar19 = iVar18 + uVar20;
            puVar19[1] = uVar23;
            puVar19[2] = 0x4e4;
            puVar19 = puVar19 + 4;
            piVar6 = (int *)*piVar6;
          } while (piVar6 != (int *)0x0);
        }
        puVar13 = local_208;
      }
      uVar20 = 0;
      uVar23 = ~-(uint)(local_218 < local_20c) & (uint)((int)local_218 + (1 - (int)local_20c)) >> 1;
      puVar13 = local_20c;
      if (uVar23 != 0) {
        do {
          uVar20 = uVar20 + 1;
          *(undefined2 *)puVar13 = 0;
          puVar13 = (uint *)((int)puVar13 + 2);
        } while (uVar20 < uVar23);
      }
      _llseek(local_238,0,0);
      uVar23 = local_234;
      FUN_6b83fb4d(HVar27,local_234,param_3 + 0xf8);
      _llseek(uVar23,uVar22,0);
      _llseek(HVar27,iVar5,0);
      if (uVar22 < local_1ac) {
        FUN_6b83fb4d(HVar27,uVar23,local_1ac - uVar22);
      }
      uVar22 = local_cc - (local_cc - 1U & local_b4) & local_cc - 1U;
      local_b4 = local_b4 + uVar22;
      if (0xf < (int)uVar22) {
        uVar20 = uVar22 >> 4;
        uVar22 = uVar22 + uVar20 * -0x10;
        do {
          _hwrite(uVar23,"",0x10);
          uVar20 = uVar20 - 1;
          HVar27 = local_238;
        } while (uVar20 != 0);
      }
      _hwrite(uVar23,"",uVar22);
      _llseek(HVar27,(local_1ac - 1) + local_1c4 & ~(local_1c4 - 1U),0);
      local_e8 = 0;
      bVar28 = false;
      puVar24 = puVar11;
      for (puVar13 = _Dst; puVar13 < puVar1; puVar13 = puVar13 + 10) {
        if (puVar13 == puVar10) {
          puVar13 = puVar13 + 10;
        }
        if (puVar24 == local_214) {
          bVar28 = true;
          uVar22 = _llseek(uVar23,0,1);
          puVar24[5] = uVar22;
          auStack144[4] = local_214[3];
          auStack144[5] = local_21c;
          local_26c = _llseek(uVar23,0,1);
          _hwrite(uVar23,(LPCCH)local_204,uVar7);
          local_270 = FUN_6b8403ca(param_4,uVar23,local_cc,local_214[4] - uVar7,(undefined4 *)0x0);
          LVar15 = _llseek(uVar23,0,1);
          uVar23 = local_234;
          if (local_230 == 0xffffffff) {
            _llseek(local_234,local_26c,0);
            _hwrite(local_234,(LPCCH)local_204,uVar7);
            uVar23 = local_234;
            _llseek(local_234,LVar15,0);
            LVar15 = _llseek(local_238,0,1);
            _llseek(local_238,puVar13[4] + LVar15,0);
          }
          local_e8 = local_e8 + puVar24[4];
          if (pbVar9 == (byte *)0x0) {
LAB_6b83de43:
            puVar24 = puVar24 + 10;
            goto LAB_6b83df1b;
          }
        }
        else {
          if ((local_230 != 0xffffffff) && (puVar24 == puVar11 + local_230 * 10)) {
            uVar22 = _llseek(uVar23,0,1);
            puVar24[5] = uVar22;
            FUN_6b8403ca(param_4,uVar23,local_cc,0xffffffff,local_270);
            LVar15 = _llseek(uVar23,0,1);
            puVar24[4] = LVar15 - puVar24[5];
            puVar24[2] = LVar15 - puVar24[5];
            _llseek(local_234,local_26c,0);
            _hwrite(local_234,(LPCCH)local_204,uVar7);
            uVar23 = local_234;
            _llseek(local_234,LVar15,0);
            local_e8 = local_e8 + puVar24[4];
            goto LAB_6b83de43;
          }
          if (puVar24 < local_214) {
            if (puVar13[5] != 0) {
              uVar22 = _llseek(uVar23,0,1);
              if (puVar13[5] != uVar22) {
                _llseek(uVar23,local_274 + puVar13[5],0);
              }
              goto LAB_6b83df1b;
            }
          }
          else {
LAB_6b83df1b:
            if (puVar13[5] != 0) {
              uVar22 = _llseek(uVar23,0,1);
              puVar24[5] = uVar22;
              _llseek(local_238,puVar13[5],0);
              FUN_6b83fb4d(local_238,uVar23,puVar13[4]);
            }
          }
          if ((uint **)puVar13 == local_23c) {
            local_27c = puVar24;
          }
          if ((*(byte *)(puVar24 + 9) & 0x40) != 0) {
            local_e8 = local_e8 + puVar24[4];
          }
        }
        puVar24 = puVar24 + 10;
      }
      if (puVar10 != (uint *)0x0) {
        local_e8 = local_e8 - puVar10[4];
      }
      if (!bVar28) {
        uVar22 = _llseek(uVar23,0,1);
        local_214[5] = uVar22;
        auStack144[4] = local_214[3];
        auStack144[5] = local_21c;
        LVar15 = _llseek(uVar23,0,1);
        uVar22 = local_234;
        _hwrite(local_234,(LPCCH)local_204,uVar7);
        FUN_6b8403ca(param_4,uVar22,local_cc,local_214[4] - uVar7,(undefined4 *)0x0);
        LVar16 = _llseek(uVar22,0,1);
        uVar22 = local_234;
        if (local_230 == 0xffffffff) {
          _llseek(local_234,LVar15,0);
          _hwrite(uVar22,(LPCCH)local_204,uVar7);
          _llseek(uVar22,LVar16,0);
        }
        local_e8 = local_e8 + puVar24[4];
      }
      pbVar17 = FUN_6b83f3e4((byte *)puVar11,(byte *)(puVar11 + (uint)local_102 * 10),
                             (byte *)".reloc");
      uVar22 = local_234;
      if (pbVar17 != (byte *)0x0) {
        auStack144[10] = *(uint *)(pbVar17 + 0xc);
      }
      _llseek(local_234,param_3 + 0xf8,0);
      _hwrite(uVar22,(LPCCH)puVar11,(uint)local_102 * 0x28);
      local_218 = (uint *)_llseek(uVar22,0,2);
      _hwrite(uVar22,(LPCCH)0x0,0);
      pbVar17 = FUN_6b83f3e4((byte *)puVar11,(byte *)(puVar11 + (uint)local_102 * 10),
                             (byte *)".debug");
      iVar5 = FUN_6b83e3e7(local_238,uVar22,(int)puVar12,(int)pbVar17,(int)local_23c,(int)local_27c,
                           (int)&local_200,(int)&local_108,local_278,(uint *)&local_218);
      if (iVar5 == 0) {
        if (pbVar9 == (byte *)0x0) {
          uVar7 = local_214[4];
        }
        else {
          uVar7 = *(int *)(pbVar9 + 0x10) - local_214[4];
        }
        FUN_6b83e72c(local_238,uVar22,(int)puVar11,uVar7,(int)&local_108,local_1ac);
      }
      if (((local_23c != (uint **)0x0) && (puVar12 == (uint *)0x0)) && (auStack144[13] != 0)) {
        LVar15 = _llseek(local_238,0,2);
        LVar16 = _llseek(uVar22,0,2);
        if (local_fc != 0) {
          local_fc = local_fc + (LVar16 - (int)local_218);
        }
        _llseek(local_238,(LONG)local_218,0);
        FUN_6b83fb4d(local_238,uVar22,LVar15 - (int)local_218);
      }
      _llseek(uVar22,param_3,0);
      _hwrite(uVar22,(LPCCH)&local_108,0xf8);
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,_Dst);
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_204);
    }
  }
  else {
LAB_6b83d375:
    puVar13 = local_214;
    puVar24 = local_214;
    for (iVar18 = 10; iVar18 != 0; iVar18 = iVar18 + -1) {
      *puVar24 = 0;
      puVar24 = puVar24 + 1;
    }
    iVar18 = FUN_6b8409b0(local_214,0,(int)".rsrc");
    if (-1 < iVar18) {
      puVar13[2] = local_244;
      puVar13[4] = (local_244 - 1) + local_cc & ~(local_cc - 1U);
      puVar13[3] = ((local_204[-8] - 1) + local_d0 & ~(local_d0 - 1U)) + local_204[-7];
      puVar13[9] = 0x40000040;
      goto LAB_6b83d3de;
    }
  }
LAB_6b83e214:
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar11);
  pbVar17 = extraout_EDX_03;
LAB_6b83e232:
  FUN_6b8224af(local_c ^ (uint)&stack0xfffffffc,pbVar17);
  return;
}



undefined4 __fastcall
FUN_6b83e243(HFILE param_1,HFILE param_2,int param_3,int param_4,int param_5,int param_6,int param_7
            ,int param_8,uint param_9,uint *param_10)

{
  LPCCH pCVar1;
  int *piVar2;
  LPCCH lpBuffer;
  int iVar3;
  int iVar4;
  LPCCH pCVar5;
  uint *puVar6;
  uint uVar7;
  uint uVar8;
  int in_FS_OFFSET;
  uint local_c;
  
  local_c = 0;
  if (param_5 == 0) {
    return 0;
  }
  if (*(int *)(param_8 + 0xbc) == 0) {
    return 0;
  }
  piVar2 = (int *)KernelBaseGetGlobalData();
  lpBuffer = (LPCCH)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                                    *piVar2 + 0x1c0000U | 8,*(undefined4 *)(param_8 + 0xbc));
  if (lpBuffer == (LPCCH)0x0) {
    return 8;
  }
  if (param_3 == 0) {
    local_c = *param_10;
  }
  iVar4 = *(int *)(param_7 + 0xb8) - *(int *)(param_5 + 0xc);
  _llseek(param_1,*(int *)(param_5 + 0x14) + iVar4,0);
  iVar3 = (*(uint *)(param_8 + 0xbc) / 0x1c) * 0x1c;
  pCVar1 = lpBuffer + iVar3;
  _hread(param_1,lpBuffer,*(uint *)(param_8 + 0xbc));
  if (param_3 != 0) {
    if (lpBuffer < pCVar1) {
      piVar2 = (int *)(lpBuffer + 0x18);
      iVar3 = (iVar3 - 1U) / 0x1c + 1;
      do {
        piVar2[-1] = piVar2[-1] + (*(int *)(param_4 + 0xc) - *(int *)(param_3 + 0xc));
        *piVar2 = *piVar2 + (*(int *)(param_4 + 0x14) - *(int *)(param_3 + 0x14));
        piVar2 = piVar2 + 7;
        iVar3 = iVar3 + -1;
      } while (iVar3 != 0);
    }
    goto LAB_6b83e3a4;
  }
  uVar7 = 0xffffffff;
  pCVar5 = lpBuffer;
  uVar8 = uVar7;
  if (lpBuffer < pCVar1) {
    do {
      if ((param_9 <= *(uint *)(pCVar5 + 0x18)) && (*(uint *)(pCVar5 + 0x18) < uVar7)) {
        uVar7 = *(uint *)(pCVar5 + 0x18);
      }
      pCVar5 = pCVar5 + 0x1c;
    } while (pCVar5 < pCVar1);
    uVar8 = uVar7;
    if (uVar7 == 0xffffffff) goto LAB_6b83e32c;
  }
  else {
LAB_6b83e32c:
    uVar7 = _llseek(param_1,0,2);
  }
  *param_10 = uVar7;
  if (lpBuffer < pCVar1) {
    puVar6 = (uint *)(lpBuffer + 0x18);
    iVar3 = (iVar3 - 1U) / 0x1c + 1;
    do {
      if (param_9 <= *puVar6) {
        *puVar6 = (*puVar6 - uVar8) + local_c;
      }
      puVar6 = puVar6 + 7;
      iVar3 = iVar3 + -1;
    } while (iVar3 != 0);
  }
LAB_6b83e3a4:
  _llseek(param_2,*(int *)(param_6 + 0x14) + iVar4,0);
  _hwrite(param_2,lpBuffer,*(long *)(param_8 + 0xbc));
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpBuffer);
  return 0;
}



undefined4 __fastcall
FUN_6b83e3e7(HFILE param_1,HFILE param_2,int param_3,int param_4,int param_5,int param_6,int param_7
            ,int param_8,uint param_9,uint *param_10)

{
  LPCCH pCVar1;
  int *piVar2;
  LPCCH lpBuffer;
  int iVar3;
  int iVar4;
  LPCCH pCVar5;
  uint *puVar6;
  uint uVar7;
  uint uVar8;
  int in_FS_OFFSET;
  uint local_c;
  
  local_c = 0;
  if (param_5 == 0) {
    return 0;
  }
  if (*(int *)(param_8 + 0xac) == 0) {
    return 0;
  }
  piVar2 = (int *)KernelBaseGetGlobalData();
  lpBuffer = (LPCCH)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                                    *piVar2 + 0x1c0000U | 8,*(undefined4 *)(param_8 + 0xac));
  if (lpBuffer == (LPCCH)0x0) {
    return 8;
  }
  if (param_3 == 0) {
    local_c = *param_10;
  }
  iVar4 = *(int *)(param_7 + 0xa8) - *(int *)(param_5 + 0xc);
  _llseek(param_1,*(int *)(param_5 + 0x14) + iVar4,0);
  iVar3 = (*(uint *)(param_8 + 0xac) / 0x1c) * 0x1c;
  pCVar1 = lpBuffer + iVar3;
  _hread(param_1,lpBuffer,*(uint *)(param_8 + 0xac));
  if (param_3 != 0) {
    if (lpBuffer < pCVar1) {
      piVar2 = (int *)(lpBuffer + 0x18);
      iVar3 = (iVar3 - 1U) / 0x1c + 1;
      do {
        piVar2[-1] = piVar2[-1] + (*(int *)(param_4 + 0xc) - *(int *)(param_3 + 0xc));
        *piVar2 = *piVar2 + (*(int *)(param_4 + 0x14) - *(int *)(param_3 + 0x14));
        piVar2 = piVar2 + 7;
        iVar3 = iVar3 + -1;
      } while (iVar3 != 0);
    }
    goto LAB_6b83e548;
  }
  uVar7 = 0xffffffff;
  pCVar5 = lpBuffer;
  uVar8 = uVar7;
  if (lpBuffer < pCVar1) {
    do {
      if ((param_9 <= *(uint *)(pCVar5 + 0x18)) && (*(uint *)(pCVar5 + 0x18) < uVar7)) {
        uVar7 = *(uint *)(pCVar5 + 0x18);
      }
      pCVar5 = pCVar5 + 0x1c;
    } while (pCVar5 < pCVar1);
    uVar8 = uVar7;
    if (uVar7 == 0xffffffff) goto LAB_6b83e4d0;
  }
  else {
LAB_6b83e4d0:
    uVar7 = _llseek(param_1,0,2);
  }
  *param_10 = uVar7;
  if (lpBuffer < pCVar1) {
    puVar6 = (uint *)(lpBuffer + 0x18);
    iVar3 = (iVar3 - 1U) / 0x1c + 1;
    do {
      if (param_9 <= *puVar6) {
        *puVar6 = (*puVar6 - uVar8) + local_c;
      }
      puVar6 = puVar6 + 7;
      iVar3 = iVar3 + -1;
    } while (iVar3 != 0);
  }
LAB_6b83e548:
  _llseek(param_2,*(int *)(param_6 + 0x14) + iVar4,0);
  _hwrite(param_2,lpBuffer,*(long *)(param_8 + 0xac));
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpBuffer);
  return 0;
}



void __fastcall
FUN_6b83e58b(HFILE param_1,uint param_2,int param_3,int param_4,int param_5,int param_6)

{
  HFILE hFile;
  int lOffset;
  int *piVar1;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint uVar2;
  uint uVar3;
  int lOffset_00;
  int iVar4;
  int local_50;
  uint local_4c;
  HFILE local_48;
  CHAR local_44 [12];
  int local_38;
  int local_28;
  int local_24;
  int local_20;
  CHAR local_1c [12];
  int local_10;
  uint local_c;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  iVar4 = *(int *)(param_5 + 0x54) - param_6;
  local_4c = param_2;
  local_48 = param_1;
  if (iVar4 != 0) {
    uVar2 = *(uint *)(param_5 + 0x88);
    uVar3 = param_2;
    if ((uVar2 != 0) && (uVar2 < *(uint *)(param_5 + 0x54))) {
      _llseek(param_1,uVar2 - iVar4,0);
      _hread(local_48,local_44,0x28);
      uVar3 = local_4c;
      local_38 = local_38 + iVar4;
      local_28 = local_28 + iVar4;
      local_24 = local_24 + iVar4;
      local_20 = local_20 + iVar4;
      _llseek(local_4c,uVar2,0);
      _hwrite(uVar3,local_44,0x28);
      param_2 = extraout_EDX;
    }
    uVar2 = *(uint *)(param_5 + 0x90);
    if ((uVar2 != 0) && (uVar2 < *(uint *)(param_5 + 0x54))) {
      lOffset = uVar2 - iVar4;
      while( true ) {
        _llseek(local_48,lOffset,0);
        _hread(local_48,local_1c,0x14);
        param_2 = extraout_EDX_00;
        if (local_c == 0) break;
        local_10 = local_10 + iVar4;
        _llseek(uVar3,uVar2,0);
        _hwrite(uVar3,local_1c,0x14);
        hFile = local_48;
        param_2 = 0;
        piVar1 = (int *)(param_3 + 0x10);
        while( true ) {
          if (*(ushort *)(param_5 + 6) <= param_2) goto LAB_6b83e71b;
          uVar3 = piVar1[-1];
          if ((uVar3 <= local_c) && (local_c < *piVar1 + uVar3)) break;
          param_2 = param_2 + 1;
          piVar1 = piVar1 + 10;
        }
        lOffset_00 = (*(int *)(param_2 * 0x28 + 0x14 + param_3) - uVar3) + local_c;
        _llseek(local_48,lOffset_00 - param_4,0);
        uVar3 = local_4c;
        _llseek(local_4c,lOffset_00,0);
        while( true ) {
          _hread(hFile,&local_50,4);
          if (local_50 == 0) break;
          if (-1 < local_50) {
            local_50 = local_50 + iVar4;
          }
          _hwrite(uVar3,(LPCCH)&local_50,4);
        }
        lOffset = lOffset + 0x14;
        uVar2 = uVar2 + 0x14;
      }
    }
  }
LAB_6b83e71b:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



void __fastcall
FUN_6b83e72c(HFILE param_1,uint param_2,int param_3,int param_4,int param_5,int param_6)

{
  HFILE hFile;
  int lOffset;
  int *piVar1;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint uVar2;
  uint uVar3;
  int lOffset_00;
  int iVar4;
  int local_50;
  uint local_4c;
  HFILE local_48;
  CHAR local_44 [12];
  int local_38;
  int local_28;
  int local_24;
  int local_20;
  CHAR local_1c [12];
  int local_10;
  uint local_c;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  iVar4 = *(int *)(param_5 + 0x54) - param_6;
  local_4c = param_2;
  local_48 = param_1;
  if (iVar4 != 0) {
    uVar2 = *(uint *)(param_5 + 0x78);
    uVar3 = param_2;
    if ((uVar2 != 0) && (uVar2 < *(uint *)(param_5 + 0x54))) {
      _llseek(param_1,uVar2 - iVar4,0);
      _hread(local_48,local_44,0x28);
      uVar3 = local_4c;
      local_38 = local_38 + iVar4;
      local_28 = local_28 + iVar4;
      local_24 = local_24 + iVar4;
      local_20 = local_20 + iVar4;
      _llseek(local_4c,uVar2,0);
      _hwrite(uVar3,local_44,0x28);
      param_2 = extraout_EDX;
    }
    uVar2 = *(uint *)(param_5 + 0x80);
    if ((uVar2 != 0) && (uVar2 < *(uint *)(param_5 + 0x54))) {
      lOffset = uVar2 - iVar4;
      while( true ) {
        _llseek(local_48,lOffset,0);
        _hread(local_48,local_1c,0x14);
        param_2 = extraout_EDX_00;
        if (local_c == 0) break;
        local_10 = local_10 + iVar4;
        _llseek(uVar3,uVar2,0);
        _hwrite(uVar3,local_1c,0x14);
        hFile = local_48;
        param_2 = 0;
        piVar1 = (int *)(param_3 + 0x10);
        while( true ) {
          if (*(ushort *)(param_5 + 6) <= param_2) goto LAB_6b83e8b9;
          uVar3 = piVar1[-1];
          if ((uVar3 <= local_c) && (local_c < *piVar1 + uVar3)) break;
          param_2 = param_2 + 1;
          piVar1 = piVar1 + 10;
        }
        lOffset_00 = (*(int *)(param_2 * 0x28 + 0x14 + param_3) - uVar3) + local_c;
        _llseek(local_48,lOffset_00 - param_4,0);
        uVar3 = local_4c;
        _llseek(local_4c,lOffset_00,0);
        while( true ) {
          _hread(hFile,&local_50,4);
          if (local_50 == 0) break;
          if (-1 < local_50) {
            local_50 = local_50 + iVar4;
          }
          _hwrite(uVar3,(LPCCH)&local_50,4);
        }
        lOffset = lOffset + 0x14;
        uVar2 = uVar2 + 0x14;
      }
    }
  }
LAB_6b83e8b9:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



undefined4 __fastcall
FUN_6b83e8ca(int *param_1,int *param_2,ushort param_3,int param_4,HGLOBAL param_5,int *param_6,
            int *param_7)

{
  ushort uVar1;
  int iVar2;
  int **ppiVar3;
  int **ppiVar4;
  ushort *puVar5;
  uint uVar6;
  int *piVar7;
  undefined4 *puVar8;
  undefined4 uVar9;
  ushort *puVar10;
  int iVar11;
  int **extraout_ECX;
  int **extraout_ECX_00;
  int **extraout_ECX_01;
  int **extraout_ECX_02;
  int iVar12;
  ushort *puVar13;
  int **ppiVar14;
  uint uVar15;
  int in_FS_OFFSET;
  bool bVar16;
  bool bVar17;
  ushort *local_28;
  ushort *local_24;
  int **local_1c;
  int **local_c;
  
  iVar2 = *param_1;
  iVar12 = *param_2;
  uVar15 = 0;
  bVar17 = false;
  ppiVar4 = (int **)((uint)(iVar2 != 2) * 4 + 0xc + param_4);
  for (local_c = (int **)*ppiVar4; local_c != (int **)0x0; local_c = (int **)*local_c) {
    if (iVar2 == 2) {
      uVar1 = *(ushort *)((int)local_c[1] + 4);
      if (uVar1 == *(ushort *)(param_1 + 1)) {
LAB_6b83e995:
        local_1c = local_c + (iVar12 != 2) + 3;
        if (local_1c != (int **)0x0) goto LAB_6b83eaab;
        break;
      }
      if (*(ushort *)(param_1 + 1) < uVar1) break;
    }
    else {
      puVar13 = *(ushort **)((int)local_c[1] + 0x10);
      puVar5 = (ushort *)param_1[4];
      do {
        bVar16 = *puVar5 < *puVar13;
        if (*puVar5 != *puVar13) {
LAB_6b83e97a:
          uVar6 = -(uint)bVar16 | 1;
          goto LAB_6b83e981;
        }
        if (*puVar5 == 0) break;
        uVar1 = puVar5[1];
        bVar16 = uVar1 < puVar13[1];
        if (uVar1 != puVar13[1]) goto LAB_6b83e97a;
        puVar5 = puVar5 + 2;
        puVar13 = puVar13 + 2;
      } while (uVar1 != 0);
      uVar6 = 0;
LAB_6b83e981:
      if (uVar6 == 0) goto LAB_6b83e995;
      if ((int)uVar6 < 0) break;
    }
    ppiVar4 = local_c;
  }
  piVar7 = (int *)KernelBaseGetGlobalData();
  local_c = (int **)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                                    *piVar7 + 0x1c0000U | 8,0x1c);
  if (local_c != (int **)0x0) {
    piVar7 = (int *)local_c;
    for (iVar11 = 7; iVar11 != 0; iVar11 = iVar11 + -1) {
      *piVar7 = 0;
      piVar7 = piVar7 + 1;
    }
    bVar17 = true;
    if (iVar2 == 2) {
      piVar7 = (int *)KernelBaseGetGlobalData();
      puVar8 = (undefined4 *)
               RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                               *piVar7 + 0x1c0000U | 8,0x14);
      ((int *)local_c)[1] = (int)puVar8;
      if (puVar8 == (undefined4 *)0x0) {
        if (*param_1 == 2) {
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1);
        }
        if (*param_2 == 2) {
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_2);
        }
        uVar9 = *(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18);
        param_2 = (int *)local_c;
        goto LAB_6b83ea62;
      }
      *puVar8 = 0;
      puVar8[1] = 0;
      puVar8[2] = 0;
      puVar8[3] = 0;
      puVar8[4] = 0;
      *(undefined4 *)((int *)local_c)[1] = 2;
      *(undefined2 *)(((int *)local_c)[1] + 4) = *(undefined2 *)(param_1 + 1);
    }
    else {
      ((int *)local_c)[1] = (int)param_1;
    }
    *local_c = *ppiVar4;
    local_1c = (int **)((int *)local_c + 3);
    *ppiVar4 = (int *)local_c;
    if (iVar12 != 2) {
      local_1c = (int **)((int *)local_c + 4);
    }
LAB_6b83eaab:
    ppiVar4 = (int **)*local_1c;
    while (ppiVar14 = ppiVar4, ppiVar14 != (int **)0x0) {
      if (iVar12 == 2) {
        if (*(ushort *)(param_2 + 1) == *(ushort *)(ppiVar14[1] + 1)) {
LAB_6b83ebb4:
          if (*(short *)((int)ppiVar14 + 0x1e) != 1) {
            ppiVar4 = (int **)*local_1c;
            if (ppiVar4 != (int **)0x0) goto LAB_6b83ec78;
            goto joined_r0x6b83ed7e;
          }
          ppiVar4 = ppiVar14;
          if (param_3 != *(ushort *)(ppiVar14 + 8)) goto joined_r0x6b83ed7e;
          ppiVar14[5] = param_7;
          if (*param_1 == 2) {
            RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1);
            ppiVar4 = extraout_ECX;
          }
          if (*param_2 == 2) {
            RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_2);
            ppiVar4 = extraout_ECX_00;
          }
          if (param_6 == (int *)0x0) goto LAB_6b83ec11;
          goto LAB_6b83ec27;
        }
        if (*(ushort *)(param_2 + 1) < *(ushort *)(ppiVar14[1] + 1)) break;
      }
      else {
        local_28 = (ushort *)ppiVar14[1][4];
        local_24 = (ushort *)param_2[4];
        do {
          uVar1 = *local_24;
          bVar16 = uVar1 < *local_28;
          if (uVar1 != *local_28) {
LAB_6b83eb87:
            local_28 = (ushort *)(-(uint)bVar16 | 1);
            goto LAB_6b83eb92;
          }
          if (uVar1 == 0) break;
          uVar1 = local_24[1];
          bVar16 = uVar1 < local_28[1];
          if (uVar1 != local_28[1]) goto LAB_6b83eb87;
          local_24 = local_24 + 2;
          local_28 = local_28 + 2;
        } while (uVar1 != 0);
        local_28 = (ushort *)0x0;
LAB_6b83eb92:
        if (local_28 == (ushort *)0x0) goto LAB_6b83ebb4;
        if ((int)local_28 < 0) break;
      }
      local_1c = ppiVar14;
      ppiVar4 = (int **)*ppiVar14;
    }
    if (param_6 == (int *)0x0) goto LAB_6b83eaec;
    if (iVar12 == 2) {
      local_c[5] = (int *)((int)local_c[5] + 1);
    }
    else {
      local_c[6] = (int *)((int)local_c[6] + 1);
    }
    piVar7 = (int *)KernelBaseGetGlobalData();
    ppiVar4 = (int **)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                                      *piVar7 + 0x1c0000U | 8,0x24);
    if (ppiVar4 != (int **)0x0) {
      ppiVar14 = ppiVar4;
      for (iVar12 = 9; iVar12 != 0; iVar12 = iVar12 + -1) {
        *ppiVar14 = (int *)0x0;
        ppiVar14 = ppiVar14 + 1;
      }
      *ppiVar4 = *local_1c;
      *local_1c = (int *)ppiVar4;
      ppiVar4[1] = param_2;
      ppiVar4[3] = param_1;
      *(undefined2 *)((int)ppiVar4 + 0x1e) = 1;
      *(ushort *)(ppiVar4 + 8) = param_3;
      ppiVar4[5] = param_7;
      ppiVar4[6] = param_6;
      if ((bVar17) && (param_5 != (HGLOBAL)0x0)) {
        if (iVar2 == 2) {
          puVar13 = (ushort *)(uint)*(ushort *)(param_1 + 1);
        }
        else {
          puVar13 = (ushort *)param_1[4];
          puVar10 = &DAT_6b887b48;
          puVar5 = puVar13;
          do {
            uVar1 = *puVar10;
            bVar17 = uVar1 < *puVar5;
            if (uVar1 != *puVar5) {
LAB_6b83ee72:
              uVar15 = -(uint)bVar17 | 1;
              break;
            }
            if (uVar1 == 0) break;
            uVar1 = puVar10[1];
            bVar17 = uVar1 < puVar5[1];
            if (uVar1 != puVar5[1]) goto LAB_6b83ee72;
            puVar10 = puVar10 + 2;
            puVar5 = puVar5 + 2;
          } while (uVar1 != 0);
          if (uVar15 == 0) {
            return 0;
          }
        }
        FUN_6b83fcd7(param_5,puVar13,1);
      }
      return 0;
    }
  }
  if (*param_1 == 2) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1);
  }
  if (*param_2 != 2) {
    return 8;
  }
  uVar9 = *(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18);
LAB_6b83ea62:
  RtlFreeHeap(uVar9,0,param_2);
  return 8;
LAB_6b83ec78:
  if (iVar12 == 2) {
    bVar17 = *(short *)(ppiVar4[1] + 1) == *(short *)((*local_1c)[1] + 4);
LAB_6b83ecfc:
    if (!bVar17) goto LAB_6b83ed15;
  }
  else {
    local_28 = *(ushort **)((*local_1c)[1] + 0x10);
    puVar13 = (ushort *)ppiVar4[1][4];
    do {
      bVar17 = *puVar13 < *local_28;
      if (*puVar13 != *local_28) {
LAB_6b83ecf1:
        uVar15 = -(uint)bVar17 | 1;
        goto LAB_6b83ecf6;
      }
      if (*puVar13 == 0) break;
      uVar1 = puVar13[1];
      bVar17 = uVar1 < local_28[1];
      if (uVar1 != local_28[1]) goto LAB_6b83ecf1;
      local_28 = local_28 + 2;
      puVar13 = puVar13 + 2;
    } while (uVar1 != 0);
    uVar15 = 0;
LAB_6b83ecf6:
    if (uVar15 != 0) {
      bVar17 = false;
      goto LAB_6b83ecfc;
    }
  }
  if ((param_3 < *(ushort *)(ppiVar4 + 8) || param_3 == *(ushort *)(ppiVar4 + 8)) ||
     (ppiVar3 = (int **)*ppiVar4, local_1c = ppiVar4, ppiVar4 = ppiVar3, ppiVar3 == (int **)0x0))
  goto LAB_6b83ed15;
  goto LAB_6b83ec78;
LAB_6b83ed15:
  local_1c = ppiVar4;
  ppiVar4 = local_1c;
  if ((local_1c != (int **)0x0) && (param_3 == *(ushort *)(local_1c + 8))) {
    if (*param_1 == 2) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1);
      ppiVar4 = extraout_ECX_01;
    }
    if (*param_2 == 2) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_2);
      ppiVar4 = extraout_ECX_02;
    }
    ppiVar14 = local_1c;
    if (param_6 == (int *)0x0) {
LAB_6b83ec11:
      uVar9 = FUN_6b83f06e(param_4,param_5,local_c,ppiVar14,ppiVar4,(uint)(iVar2 == 2),
                           (uint)(iVar12 == 2));
      return uVar9;
    }
    local_1c[5] = param_7;
LAB_6b83ec27:
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,ppiVar14[6]);
    ppiVar14[6] = param_6;
    return 0;
  }
joined_r0x6b83ed7e:
  if (param_6 != (int *)0x0) {
    uVar9 = FUN_6b83f5ad(ppiVar4,param_1,param_2,(int)local_c,ppiVar14,(uint)param_3,
                         (uint)(iVar12 == 2),param_7,param_6);
    return uVar9;
  }
LAB_6b83eaec:
  if (*param_1 == 2) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1);
  }
  if (*param_2 == 2) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_2);
  }
  return 0x57;
}



undefined4 * __fastcall FUN_6b83ee98(wchar_t *param_1,int *param_2)

{
  size_t _MaxCount;
  short *psVar1;
  wchar_t wVar2;
  short sVar3;
  int *piVar4;
  undefined4 *puVar5;
  int iVar6;
  wchar_t *pwVar7;
  int in_FS_OFFSET;
  int *local_10;
  
  if (param_1 < (wchar_t *)0x10000) {
    piVar4 = (int *)KernelBaseGetGlobalData();
    puVar5 = (undefined4 *)
             RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                             *piVar4 + 0x1c0000U | 8,0x14);
    if (puVar5 != (undefined4 *)0x0) {
      *puVar5 = 0;
      puVar5[1] = 0;
      puVar5[2] = 0;
      puVar5[3] = 0;
      puVar5[4] = 0;
      *puVar5 = 2;
      *(short *)(puVar5 + 1) = (short)param_1;
      return puVar5;
    }
  }
  else {
    pwVar7 = param_1;
    do {
      wVar2 = *pwVar7;
      pwVar7 = pwVar7 + 1;
    } while (wVar2 != L'\0');
    local_10 = param_2 + 1;
    puVar5 = (undefined4 *)*local_10;
    _MaxCount = ((int)pwVar7 - (int)(param_1 + 1) >> 1) + 1;
    if (puVar5 != (undefined4 *)0x0) {
      do {
        iVar6 = wcsncmp((wchar_t *)puVar5[4],param_1,_MaxCount);
        if (iVar6 == 0) break;
        local_10 = puVar5 + 1;
        puVar5 = (undefined4 *)*local_10;
      } while (puVar5 != (undefined4 *)0x0);
      if (puVar5 != (undefined4 *)0x0) {
        return puVar5;
      }
    }
    piVar4 = (int *)KernelBaseGetGlobalData();
    puVar5 = (undefined4 *)
             RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                             *piVar4 + 0x1c0000U | 8,0x14);
    if (puVar5 != (undefined4 *)0x0) {
      *puVar5 = 0;
      puVar5[1] = 0;
      puVar5[2] = 0;
      puVar5[3] = 0;
      puVar5[4] = 0;
      piVar4 = (int *)KernelBaseGetGlobalData();
      iVar6 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                              *piVar4 + 0x1c0000U | 8,_MaxCount * 2);
      puVar5[4] = iVar6;
      if (iVar6 != 0) {
        iVar6 = 0;
        *puVar5 = 1;
        puVar5[2] = *param_2;
        *(short *)(puVar5 + 3) = (short)_MaxCount * 2 + 2;
        *(short *)((int)puVar5 + 0xe) = (short)_MaxCount + -1;
        do {
          psVar1 = (short *)(iVar6 + (int)param_1);
          sVar3 = *psVar1;
          if ((ushort)(sVar3 - 0x61U) < 0x1a) {
            sVar3 = *psVar1 + -0x20;
          }
          *(short *)(puVar5[4] + iVar6) = sVar3;
          iVar6 = iVar6 + 2;
        } while (*psVar1 != 0);
        *param_2 = *param_2 + (uint)*(ushort *)(puVar5 + 3);
        puVar5[1] = 0;
        *local_10 = (int)puVar5;
        return puVar5;
      }
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar5);
    }
  }
  return (undefined4 *)0x0;
}



int __fastcall FUN_6b83f032(int *param_1,uint param_2,uint param_3,uint param_4,uint *param_5)

{
  int *piVar1;
  uint uVar2;
  
  piVar1 = (int *)*param_1;
  uVar2 = piVar1[5] + 3U & 0xfffffffc;
  if ((param_3 < param_2) && (param_4 < uVar2 + param_3)) {
    *param_5 = param_3;
    param_3 = param_2;
  }
  piVar1[2] = param_3;
  *param_1 = *piVar1;
  return uVar2 + param_3;
}



undefined4 __fastcall
FUN_6b83f06e(int param_1,HGLOBAL param_2,undefined4 *param_3,int **param_4,undefined4 param_5,
            int param_6,int param_7)

{
  short *psVar1;
  ushort uVar2;
  short sVar3;
  int *piVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  ushort *puVar7;
  uint uVar8;
  int **ppiVar9;
  ushort *puVar10;
  int *piVar11;
  int in_FS_OFFSET;
  bool bVar12;
  
  puVar6 = (undefined4 *)((uint)(param_6 == 0) * 4 + 0xc + param_1);
  for (puVar5 = (undefined4 *)*puVar6; puVar5 != param_3; puVar5 = (undefined4 *)*puVar5) {
    puVar6 = puVar5;
  }
  ppiVar9 = (int **)(param_3 + (param_7 == 0) + 3);
  piVar11 = (int *)0x0;
  if ((int **)*ppiVar9 != param_4) {
    do {
      if (param_7 == 0) {
        puVar10 = (ushort *)param_4[1][4];
        puVar7 = *(ushort **)((*ppiVar9)[1] + 0x10);
        do {
          bVar12 = *puVar7 < *puVar10;
          if (*puVar7 != *puVar10) {
LAB_6b83f124:
            uVar8 = -(uint)bVar12 | 1;
            goto LAB_6b83f12b;
          }
          if (*puVar7 == 0) break;
          uVar2 = puVar7[1];
          bVar12 = uVar2 < puVar10[1];
          if (uVar2 != puVar10[1]) goto LAB_6b83f124;
          puVar7 = puVar7 + 2;
          puVar10 = puVar10 + 2;
        } while (uVar2 != 0);
        uVar8 = 0;
LAB_6b83f12b:
        bVar12 = uVar8 == 0;
      }
      else {
        bVar12 = *(short *)((*ppiVar9)[1] + 4) == *(short *)(param_4[1] + 1);
      }
      if (bVar12) {
        piVar4 = *ppiVar9;
        if (piVar11 == (int *)0x0) {
          piVar11 = piVar4;
        }
        if (1 < *(ushort *)((int)piVar4 + 0x1e)) {
          *(ushort *)((int)piVar4 + 0x1e) = *(ushort *)((int)piVar4 + 0x1e) - 1;
        }
      }
      ppiVar9 = (int **)*ppiVar9;
    } while ((int **)*ppiVar9 != param_4);
    if (piVar11 != (int *)0x0) {
      sVar3 = *(short *)((int)piVar11 + 0x1e);
      goto joined_r0x6b83f16a;
    }
  }
  psVar1 = (short *)((int)param_4 + 0x1e);
  *psVar1 = *psVar1 + -1;
  sVar3 = *psVar1;
joined_r0x6b83f16a:
  if (sVar3 == 0) {
    if (param_7 == 0) {
      param_3[6] = param_3[6] + -1;
    }
    else {
      param_3[5] = param_3[5] + -1;
    }
  }
  *ppiVar9 = *param_4;
  FUN_6b83f4ff((int)param_4);
  if ((param_3[3] == 0) && (param_3[4] == 0)) {
    *puVar6 = *param_3;
    if (param_6 == 0) {
      puVar10 = *(ushort **)(param_3[1] + 0x10);
    }
    else {
      puVar10 = (ushort *)(uint)*(ushort *)(param_3[1] + 4);
    }
    FUN_6b83fcd7(param_2,puVar10,0);
    if (*(int *)param_3[1] == 2) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,(int *)param_3[1]);
    }
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_3);
  }
  return 0;
}



// lpEnumFunc parameter of EnumResourceLanguagesExW
// 

void lpEnumFunc_6b83f1f0(HMODULE param_1,wchar_t *param_2,int *param_3,ushort param_4,int *param_5)

{
  int *piVar1;
  int *piVar2;
  int *piVar3;
  int *piVar4;
  HGLOBAL hResData;
  LPVOID _Src;
  int iVar5;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 uVar6;
  undefined4 extraout_EDX_04;
  undefined4 extraout_EDX_05;
  undefined4 extraout_EDX_06;
  int in_FS_OFFSET;
  undefined8 uVar7;
  HRSRC local_1c;
  int *local_18;
  wchar_t *local_14;
  int *local_10;
  uint local_c;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_1c = (HRSRC)0x0;
  local_18 = param_3;
  local_10 = param_3;
  local_c = (uint)param_4;
  local_14 = param_2;
  uVar7 = LdrFindResourceEx_U(0x10,param_1,&local_14,3,&local_1c);
  uVar6 = (undefined4)((ulonglong)uVar7 >> 0x20);
  if ((int)uVar7 < 0) {
    BaseSetLastNTError((int)uVar7);
    uVar6 = extraout_EDX;
    goto LAB_6b83f2b6;
  }
  if (local_1c == (HRSRC)0x0) goto LAB_6b83f2b6;
  piVar1 = FUN_6b83ee98(param_2,param_5);
  if (piVar1 == (int *)0x0) {
    param_5[5] = 8;
    uVar6 = extraout_EDX_00;
    goto LAB_6b83f2b6;
  }
  piVar2 = FUN_6b83ee98((wchar_t *)local_18,param_5);
  if (piVar2 == (int *)0x0) {
    param_5[5] = 8;
    uVar6 = extraout_EDX_01;
LAB_6b83f27f:
    if (*piVar1 == 2) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,piVar1);
      uVar6 = extraout_EDX_02;
    }
    if ((piVar2 == (int *)0x0) || (*piVar2 != 2)) goto LAB_6b83f2b6;
  }
  else {
    piVar3 = (int *)SizeofResource(param_1,local_1c);
    uVar6 = extraout_EDX_04;
    local_18 = piVar3;
    if (piVar3 == (int *)0x0) goto LAB_6b83f27f;
    piVar4 = (int *)KernelBaseGetGlobalData();
    uVar7 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                            *piVar4 + 0x1c0000U | 8,piVar3);
    uVar6 = (undefined4)((ulonglong)uVar7 >> 0x20);
    piVar3 = (int *)uVar7;
    if (piVar3 == (int *)0x0) goto LAB_6b83f27f;
    memset(piVar3,0,(size_t)local_18);
    hResData = LoadResource(param_1,local_1c);
    if ((hResData == (HGLOBAL)0x0) || (_Src = LockResource(hResData), _Src == (LPVOID)0x0)) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,piVar3);
      uVar6 = extraout_EDX_05;
      goto LAB_6b83f27f;
    }
    memcpy(piVar3,_Src,(size_t)local_18);
    FreeResource(hResData);
    iVar5 = FUN_6b83e8ca(piVar1,piVar2,param_4,(int)param_5,(HGLOBAL)0x0,piVar3,local_18);
    uVar6 = extraout_EDX_06;
    if (iVar5 == 0) goto LAB_6b83f2b6;
    param_5[5] = 8;
    piVar2 = piVar3;
  }
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,piVar2);
  uVar6 = extraout_EDX_03;
LAB_6b83f2b6:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar6);
  return;
}



// lpEnumFunc parameter of EnumResourceNamesExW
// 

undefined4 lpEnumFunc_6b83f390(HMODULE param_1,LPCWSTR param_2,LPCWSTR param_3,LONG_PTR param_4)

{
  EnumResourceLanguagesExW(param_1,param_2,param_3,lpEnumFunc_6b83f1f0,param_4,0x10,0);
  return 1;
}



// lpEnumFunc parameter of EnumResourceTypesExW
// 

undefined4 lpEnumFunc_6b83f3c0(HMODULE param_1,LPCWSTR param_2,LONG_PTR param_3)

{
  EnumResourceNamesExW(param_1,param_2,lpEnumFunc_6b83f390,param_3,0x10,0);
  return 1;
}



byte * __fastcall FUN_6b83f3e4(byte *param_1,byte *param_2,byte *param_3)

{
  byte bVar1;
  byte *pbVar2;
  uint uVar3;
  byte *pbVar4;
  bool bVar5;
  
  do {
    pbVar2 = param_1;
    pbVar4 = param_3;
    if (param_2 <= param_1) {
      return (byte *)0x0;
    }
    do {
      bVar1 = *pbVar2;
      bVar5 = bVar1 < *pbVar4;
      if (bVar1 != *pbVar4) {
LAB_6b83f414:
        uVar3 = -(uint)bVar5 | 1;
        goto LAB_6b83f419;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar2[1];
      bVar5 = bVar1 < pbVar4[1];
      if (bVar1 != pbVar4[1]) goto LAB_6b83f414;
      pbVar2 = pbVar2 + 2;
      pbVar4 = pbVar4 + 2;
    } while (bVar1 != 0);
    uVar3 = 0;
LAB_6b83f419:
    if (uVar3 == 0) {
      return param_1;
    }
    param_1 = param_1 + 0x28;
  } while( true );
}



void __fastcall FUN_6b83f430(int param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int in_FS_OFFSET;
  
  puVar1 = *(undefined4 **)(param_1 + 0xc);
  while (puVar1 != (undefined4 *)0x0) {
    *(undefined4 *)(param_1 + 0xc) = *puVar1;
    while (puVar2 = (undefined4 *)puVar1[3], puVar2 != (undefined4 *)0x0) {
      puVar1[3] = *puVar2;
      FUN_6b83f4ff((int)puVar2);
    }
    while (puVar2 = (undefined4 *)puVar1[4], puVar2 != (undefined4 *)0x0) {
      puVar1[4] = *puVar2;
      FUN_6b83f4ff((int)puVar2);
    }
    if (*(int *)puVar1[1] == 2) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,(int *)puVar1[1]);
    }
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar1);
    puVar1 = *(undefined4 **)(param_1 + 0xc);
  }
  puVar1 = *(undefined4 **)(param_1 + 0x10);
  while (puVar1 != (undefined4 *)0x0) {
    *(undefined4 *)(param_1 + 0x10) = *puVar1;
    while (puVar2 = (undefined4 *)puVar1[3], puVar2 != (undefined4 *)0x0) {
      puVar1[3] = *puVar2;
      FUN_6b83f4ff((int)puVar2);
    }
    while (puVar2 = (undefined4 *)puVar1[4], puVar2 != (undefined4 *)0x0) {
      puVar1[4] = *puVar2;
      FUN_6b83f4ff((int)puVar2);
    }
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar1);
    puVar1 = *(undefined4 **)(param_1 + 0x10);
  }
  FUN_6b83f567(param_1);
  return;
}



void __fastcall FUN_6b83f4ff(int param_1)

{
  int in_FS_OFFSET;
  
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,
              *(undefined4 *)(param_1 + 0x18));
  *(undefined4 *)(param_1 + 0x18) = 0;
  if (**(int **)(param_1 + 4) == 2) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,*(int **)(param_1 + 4));
    *(undefined4 *)(param_1 + 4) = 0;
  }
  if (**(int **)(param_1 + 0xc) == 2) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,*(int **)(param_1 + 0xc));
    *(undefined4 *)(param_1 + 0xc) = 0;
  }
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1);
  return;
}



void __fastcall FUN_6b83f567(int param_1)

{
  int *piVar1;
  int *piVar2;
  int in_FS_OFFSET;
  
  piVar2 = *(int **)(param_1 + 4);
  while (piVar2 != (int *)0x0) {
    piVar1 = (int *)piVar2[1];
    if (*piVar2 == 1) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,piVar2[4]);
      piVar2[4] = 0;
    }
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,piVar2);
    piVar2 = piVar1;
  }
  return;
}



undefined4 __fastcall
FUN_6b83f5ad(undefined4 param_1,int *param_2,int *param_3,int param_4,undefined4 *param_5,
            int param_6,int param_7,undefined4 param_8,undefined4 param_9)

{
  ushort uVar1;
  int *piVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  ushort *puVar6;
  uint uVar7;
  int iVar8;
  undefined4 *puVar9;
  ushort *puVar10;
  undefined4 *puVar11;
  int in_FS_OFFSET;
  bool bVar12;
  
  piVar2 = (int *)KernelBaseGetGlobalData();
  puVar3 = (undefined4 *)
           RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                           *piVar2 + 0x1c0000U | 8,0x24);
  if (puVar3 == (undefined4 *)0x0) {
    if (*param_2 == 2) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_2);
    }
    if (*param_3 == 2) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_3);
    }
    uVar4 = 8;
  }
  else {
    puVar11 = puVar3;
    for (iVar8 = 9; iVar8 != 0; iVar8 = iVar8 + -1) {
      *puVar11 = 0;
      puVar11 = puVar11 + 1;
    }
    puVar3[1] = param_3;
    puVar3[5] = param_8;
    puVar3[6] = param_9;
    puVar3[3] = param_2;
    *(short *)(puVar3 + 8) = (short)param_6;
    *(undefined2 *)((int)puVar3 + 0x1e) = 1;
    puVar11 = param_5;
    if (param_6 < (int)(uint)*(ushort *)(param_5 + 8)) {
      *(short *)((int)puVar3 + 0x1e) = *(short *)((int)param_5 + 0x1e) + 1;
      puVar9 = (undefined4 *)((uint)(param_7 == 0) * 4 + 0xc + param_4);
      puVar11 = (undefined4 *)*puVar9;
      while (puVar5 = puVar11, param_5 != puVar5) {
        puVar9 = puVar5;
        puVar11 = (undefined4 *)*puVar5;
      }
      *puVar3 = puVar5;
      *puVar9 = puVar3;
    }
    else {
      do {
        puVar9 = puVar11;
        if (param_7 == 0) {
          puVar10 = *(ushort **)(puVar9[1] + 0x10);
          puVar6 = (ushort *)param_3[4];
          do {
            uVar1 = *puVar6;
            bVar12 = uVar1 < *puVar10;
            if (uVar1 != *puVar10) {
LAB_6b83f6ca:
              uVar7 = -(uint)bVar12 | 1;
              goto LAB_6b83f6cf;
            }
            if (uVar1 == 0) break;
            uVar1 = puVar6[1];
            bVar12 = uVar1 < puVar10[1];
            if (uVar1 != puVar10[1]) goto LAB_6b83f6ca;
            puVar6 = puVar6 + 2;
            puVar10 = puVar10 + 2;
          } while (uVar1 != 0);
          uVar7 = 0;
LAB_6b83f6cf:
          if (uVar7 != 0) {
            bVar12 = false;
            goto LAB_6b83f6d5;
          }
        }
        else {
          bVar12 = *(short *)(param_3 + 1) == *(short *)(puVar9[1] + 4);
LAB_6b83f6d5:
          if (!bVar12) break;
        }
        if (param_6 <= (int)(uint)*(ushort *)(puVar9 + 8)) break;
        *(short *)((int)puVar9 + 0x1e) = *(short *)((int)puVar9 + 0x1e) + 1;
        puVar11 = (undefined4 *)*puVar9;
        param_5 = puVar9;
      } while ((undefined4 *)*puVar9 != (undefined4 *)0x0);
      uVar4 = *param_5;
      *param_5 = puVar3;
      *puVar3 = uVar4;
    }
    uVar4 = 0;
  }
  return uVar4;
}



undefined4 __fastcall
FUN_6b83f700(undefined4 *param_1,uint param_2,undefined4 *param_3,ushort *param_4,int param_5,
            int param_6)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  undefined4 *local_8;
  
  if (param_1 == (undefined4 *)0x0) {
    return 0;
  }
  if (param_3 == (undefined4 *)0x0) {
    return 0;
  }
  local_8 = param_1;
  if (0x83 < param_2) {
    puVar2 = param_3;
    puVar3 = param_1;
    for (iVar1 = 0x21; iVar1 != 0; iVar1 = iVar1 + -1) {
      *puVar3 = *puVar2;
      puVar2 = puVar2 + 1;
      puVar3 = puVar3 + 1;
    }
    local_8 = (undefined4 *)0x88;
    param_1[1] = param_2;
    if (param_3[0x11] != 0) {
      param_1[0x11] = 0x88;
      memcpy(param_1 + 0x22,(void *)(param_3[0x11] + (int)param_3),param_3[0x12]);
      local_8 = (undefined4 *)((param_3[0x12] + 7 & 0xfffffff8) + 0x88);
    }
    puVar2 = local_8;
    if (param_3[0x13] != 0) {
      param_1[0x13] = local_8;
      memcpy((void *)((int)local_8 + (int)param_1),(void *)(param_3[0x13] + (int)param_3),
             param_3[0x14]);
      local_8 = (undefined4 *)((int)puVar2 + (param_3[0x14] + 7 & 0xfffffff8));
    }
    puVar3 = local_8;
    puVar2 = (undefined4 *)param_1[1];
    if (local_8 < puVar2) {
      if (param_5 == 0) {
        if (param_3[0x15] != 0) {
          param_1[0x15] = local_8;
          memcpy((void *)((int)local_8 + (int)param_1),(void *)(param_3[0x15] + (int)param_3),
                 param_3[0x16]);
          puVar2 = (undefined4 *)param_1[1];
          local_8 = (undefined4 *)((int)puVar3 + (param_3[0x16] + 7 & 0xfffffff8));
        }
        if (puVar2 <= local_8) goto LAB_6b83f834;
        param_1[0x17] = local_8;
        iVar1 = FUN_6b83fed3((uint *)((int)local_8 + (int)param_1),(int)puVar2 - (int)local_8,
                             (uint *)(param_3[0x17] + (int)param_3),param_3[0x18],(uint)param_4,
                             param_6,(int *)&local_8);
        if (iVar1 == 0) {
          return 0;
        }
        if ((undefined4 *)param_1[1] <= local_8) goto LAB_6b83f834;
        param_1[0x18] = (int)local_8 - param_1[0x17];
        if ((int)local_8 - param_1[0x17] == 0) {
          param_1[0x17] = 0;
        }
        puVar2 = (undefined4 *)((int)local_8 + 3U & 0xfffffffc);
      }
      else {
        param_1[0x15] = local_8;
        iVar1 = FUN_6b83ffcc((undefined2 *)((int)local_8 + (int)param_1),(int)puVar2 - (int)local_8,
                             (ushort *)(param_3[0x15] + (int)param_3),param_3[0x16],param_4,param_6,
                             (int *)&local_8);
        if (iVar1 == 0) {
          return 0;
        }
        puVar3 = (undefined4 *)param_1[1];
        if (puVar3 <= local_8) goto LAB_6b83f834;
        param_1[0x16] = (int)local_8 - param_1[0x15];
        if ((int)local_8 - param_1[0x15] == 0) {
          param_1[0x15] = 0;
        }
        puVar2 = (undefined4 *)((int)local_8 + 7U & 0xfffffff8);
        local_8 = puVar2;
        if (param_3[0x17] != 0) {
          param_1[0x17] = puVar2;
          memcpy((void *)((int)puVar2 + (int)param_1),(void *)(param_3[0x17] + (int)param_3),
                 param_3[0x18]);
          puVar3 = (undefined4 *)param_1[1];
          puVar2 = (undefined4 *)((param_3[0x18] + 7 & 0xfffffff8) + (int)local_8);
        }
        if (puVar3 <= puVar2) goto LAB_6b83f834;
      }
      if (param_3[0x19] != 0) {
        param_1[0x19] = puVar2;
        memcpy((void *)((int)puVar2 + (int)param_1),(void *)(param_3[0x19] + (int)param_3),
               param_3[0x1a]);
        puVar2 = (undefined4 *)((param_3[0x1a] + 7 & 0xfffffff8) + (int)puVar2);
      }
      if (param_3[0x1b] != 0) {
        param_1[0x1b] = puVar2;
        memcpy((void *)((int)puVar2 + (int)param_1),(void *)(param_3[0x1b] + (int)param_3),
               param_3[0x1c]);
        puVar2 = (undefined4 *)((param_3[0x1c] + 7 & 0xfffffff8) + (int)puVar2);
      }
      if (puVar2 < (undefined4 *)param_1[1]) {
        if (param_3[0x1d] != 0) {
          param_1[0x1d] = puVar2;
          memcpy((void *)((int)puVar2 + (int)param_1),(void *)(param_3[0x1d] + (int)param_3),
                 param_3[0x1e]);
          puVar2 = (undefined4 *)((param_3[0x1e] + 7 & 0xfffffff8) + (int)puVar2);
        }
        if (param_3[0x1f] != 0) {
          param_1[0x1f] = puVar2;
          memcpy((void *)((int)puVar2 + (int)param_1),(void *)(param_3[0x1f] + (int)param_3),
                 param_3[0x20]);
          puVar2 = (undefined4 *)((param_3[0x20] + 7 & 0xfffffff8) + (int)puVar2);
        }
        if (puVar2 < (undefined4 *)param_1[1]) {
          param_1[1] = puVar2;
          return 1;
        }
      }
    }
  }
LAB_6b83f834:
  RtlSetLastWin32Error(0x6f);
  return 0;
}



undefined4 __fastcall FUN_6b83f989(int param_1,ushort *param_2,short param_3)

{
  ushort uVar1;
  ushort *puVar2;
  uint uVar3;
  ushort *puVar4;
  uint uVar5;
  int *piVar6;
  ushort **ppuVar7;
  ushort *puVar8;
  int iVar9;
  undefined4 uVar10;
  bool bVar11;
  
  piVar6 = *(int **)(param_1 + 0x10);
  uVar10 = 1;
  if (piVar6 != (int *)0x0) {
    do {
      puVar4 = *(ushort **)(piVar6[1] + 0x10);
      puVar2 = &DAT_6b887b48;
      do {
        uVar1 = *puVar2;
        bVar11 = uVar1 < *puVar4;
        if (uVar1 != *puVar4) {
LAB_6b83f9dc:
          uVar3 = -(uint)bVar11 | 1;
          goto LAB_6b83f9e2;
        }
        if (uVar1 == 0) break;
        uVar1 = puVar2[1];
        bVar11 = uVar1 < puVar4[1];
        if (uVar1 != puVar4[1]) goto LAB_6b83f9dc;
        puVar2 = puVar2 + 2;
        puVar4 = puVar4 + 2;
      } while (uVar1 != 0);
      uVar3 = 0;
LAB_6b83f9e2:
    } while ((uVar3 != 0) && (piVar6 = (int *)*piVar6, piVar6 != (int *)0x0));
    if ((piVar6 != (int *)0x0) && (piVar6 = (int *)piVar6[3], piVar6 != (int *)0x0)) {
      do {
        if (*(short *)(piVar6[1] + 4) == 1) break;
        piVar6 = (int *)*piVar6;
      } while (piVar6 != (int *)0x0);
      if (piVar6 != (int *)0x0) {
        if ((*(short *)((int)piVar6 + 0x1e) == 1) &&
           ((param_3 == 0 || (param_3 == *(short *)(piVar6 + 8))))) {
          if (param_2 < (ushort *)0x10000) {
            if (param_2 == (ushort *)&DAT_00000010) {
              return 1;
            }
            bVar11 = param_2 == (ushort *)0x18;
          }
          else {
            puVar2 = &DAT_6b887b48;
            puVar4 = param_2;
            do {
              uVar1 = *puVar4;
              bVar11 = uVar1 < *puVar2;
              if (uVar1 != *puVar2) {
LAB_6b83fa79:
                uVar3 = -(uint)bVar11 | 1;
                goto LAB_6b83fa7d;
              }
              if (uVar1 == 0) break;
              uVar1 = puVar4[1];
              bVar11 = uVar1 < puVar2[1];
              if (uVar1 != puVar2[1]) goto LAB_6b83fa79;
              puVar4 = puVar4 + 2;
              puVar2 = puVar2 + 2;
            } while (uVar1 != 0);
            uVar3 = 0;
LAB_6b83fa7d:
            bVar11 = uVar3 == 0;
          }
          if (!bVar11) {
            iVar9 = piVar6[6];
            if ((*(byte *)(iVar9 + 0x10) & 2) == 0) {
              if (param_2 < (ushort *)0x10000) {
                if (*(int *)(iVar9 + 0x6c) != 0) {
                  ppuVar7 = (ushort **)(*(int *)(iVar9 + 0x6c) + iVar9);
                  uVar3 = *(uint *)(iVar9 + 0x70) >> 2;
                  if (uVar3 != 0) {
                    do {
                      uVar3 = uVar3 - 1;
                      if (*ppuVar7 == param_2) goto LAB_6b83fac2;
                      ppuVar7 = ppuVar7 + 1;
                    } while (0 < (int)uVar3);
                  }
                }
              }
              else if (*(int *)(iVar9 + 100) != 0) {
                puVar4 = (ushort *)(*(int *)(iVar9 + 100) + iVar9);
                uVar3 = *(uint *)(iVar9 + 0x68) >> 1;
                if (uVar3 != 0) {
                  do {
                    puVar2 = puVar4;
                    puVar8 = param_2;
                    if (*puVar4 == 0) {
                      return 1;
                    }
                    do {
                      uVar1 = *puVar2;
                      bVar11 = uVar1 < *puVar8;
                      if (uVar1 != *puVar8) {
LAB_6b83fb0c:
                        uVar5 = -(uint)bVar11 | 1;
                        goto LAB_6b83fb12;
                      }
                      if (uVar1 == 0) break;
                      uVar1 = puVar2[1];
                      bVar11 = uVar1 < puVar8[1];
                      if (uVar1 != puVar8[1]) goto LAB_6b83fb0c;
                      puVar2 = puVar2 + 2;
                      puVar8 = puVar8 + 2;
                    } while (uVar1 != 0);
                    uVar5 = 0;
LAB_6b83fb12:
                    if (uVar5 == 0) {
                      return 0;
                    }
                    puVar2 = puVar4;
                    do {
                      uVar1 = *puVar2;
                      puVar2 = puVar2 + 1;
                    } while (uVar1 != 0);
                    iVar9 = ((int)puVar2 - (int)(puVar4 + 1) >> 1) + 1;
                    if (iVar9 == 1) {
                      return 1;
                    }
                    puVar4 = puVar4 + iVar9;
                    uVar3 = uVar3 - iVar9;
                  } while (0 < (int)uVar3);
                }
              }
            }
            else {
LAB_6b83fac2:
              uVar10 = 0;
            }
          }
        }
        else {
          uVar10 = 0;
        }
      }
    }
  }
  return uVar10;
}



LPCCH __fastcall FUN_6b83fb4d(HFILE param_1,HFILE param_2,uint param_3)

{
  int *piVar1;
  LPCCH lpBuffer;
  UINT UVar2;
  LPCCH pCVar3;
  uint uBytes;
  int in_FS_OFFSET;
  LPCCH local_8;
  
  local_8 = (LPCCH)0x0;
  piVar1 = (int *)KernelBaseGetGlobalData();
  lpBuffer = (LPCCH)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                                    *piVar1 + 0x1c0000U | 8,0x1000);
  pCVar3 = lpBuffer;
  if (lpBuffer != (LPCCH)0x0) {
    memset(lpBuffer,0,0x1000);
    pCVar3 = (LPCCH)0x0;
    if (param_3 != 0) {
      do {
        uBytes = param_3;
        if (0x1000 < param_3) {
          uBytes = 0x1000;
        }
        param_3 = param_3 - uBytes;
        UVar2 = _hread(param_1,lpBuffer,uBytes);
        if ((-(uint)(UVar2 != uBytes) & UVar2) != 0) {
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpBuffer);
          return local_8;
        }
        pCVar3 = local_8 + uBytes;
        _hwrite(param_2,lpBuffer,uBytes);
        local_8 = pCVar3;
      } while (param_3 != 0);
    }
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpBuffer);
  }
  return pCVar3;
}



// WARNING: Could not reconcile some variable overlaps

void __fastcall FUN_6b83fc0e(HFILE param_1,uint param_2,int param_3,int param_4)

{
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 uVar1;
  int local_104 [5];
  undefined4 local_ee;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  _llseek(param_1,param_3,0);
  _hread(param_1,local_104,0xf8);
  uVar1 = extraout_EDX;
  if ((local_104[0] == 0x4550) && (((local_ee & 2) != 0 || ((local_ee & 0x2000) != 0)))) {
    if (local_ee._2_2_ == 0x20b) {
      FUN_6b83aff7(param_1,param_2,param_3,param_4);
      uVar1 = extraout_EDX_00;
    }
    else if (local_ee._2_2_ == 0x10b) {
      FUN_6b83c91d(param_1,param_2,param_3,param_4);
      uVar1 = extraout_EDX_01;
    }
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar1);
  return;
}



undefined4 __fastcall FUN_6b83fcd7(HGLOBAL param_1,ushort *param_2,int param_3)

{
  uint uVar1;
  ushort uVar2;
  undefined4 *puVar3;
  LPVOID pvVar4;
  ushort *puVar5;
  uint uVar6;
  int *piVar7;
  undefined4 *puVar8;
  int iVar9;
  ushort *puVar10;
  int *piVar11;
  int in_FS_OFFSET;
  bool bVar12;
  undefined4 uVar13;
  int local_c;
  
  pvVar4 = GlobalLock(param_1);
  if (pvVar4 == (LPVOID)0x0) {
    return 0;
  }
  piVar11 = *(int **)((int)pvVar4 + 0x10);
  if (piVar11 == (int *)0x0) {
    return 0;
  }
  do {
    puVar10 = *(ushort **)(piVar11[1] + 0x10);
    puVar5 = &DAT_6b887b48;
    do {
      uVar2 = *puVar5;
      bVar12 = uVar2 < *puVar10;
      if (uVar2 != *puVar10) {
LAB_6b83fd36:
        uVar6 = -(uint)bVar12 | 1;
        goto LAB_6b83fd3d;
      }
      if (uVar2 == 0) break;
      uVar2 = puVar5[1];
      bVar12 = uVar2 < puVar10[1];
      if (uVar2 != puVar10[1]) goto LAB_6b83fd36;
      puVar5 = puVar5 + 2;
      puVar10 = puVar10 + 2;
    } while (uVar2 != 0);
    uVar6 = 0;
LAB_6b83fd3d:
  } while ((uVar6 != 0) && (piVar11 = (int *)*piVar11, piVar11 != (int *)0x0));
  if (piVar11 == (int *)0x0) {
    return 0;
  }
  piVar11 = (int *)piVar11[3];
  if (piVar11 == (int *)0x0) {
    return 0;
  }
  do {
    if (*(short *)(piVar11[1] + 4) == 1) break;
    piVar11 = (int *)*piVar11;
  } while (piVar11 != (int *)0x0);
  if (piVar11 == (int *)0x0) {
    return 0;
  }
  if (*(short *)((int)piVar11 + 0x1e) == 0) {
    return 0;
  }
  if (param_2 < (ushort *)0x10000) {
    bVar12 = false;
    local_c = 0;
  }
  else {
    bVar12 = true;
    if (*param_2 == 0) {
      return 1;
    }
    local_c = 1;
  }
  puVar3 = (undefined4 *)piVar11[6];
  uVar6 = puVar3[1];
  if (param_3 == 0) {
LAB_6b83fe40:
    uVar1 = uVar6 + 0x46;
    if (uVar6 < uVar1) {
      piVar7 = (int *)KernelBaseGetGlobalData();
      puVar8 = (undefined4 *)
               RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                               *piVar7 + 0x1c0000U | 8,uVar1);
      if (puVar8 != (undefined4 *)0x0) {
        iVar9 = FUN_6b83f700(puVar8,uVar1,puVar3,param_2,local_c,param_3);
        if (iVar9 == 0) {
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar8);
          return 0;
        }
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar3);
        piVar11[6] = (int)puVar8;
        piVar11[5] = puVar8[1];
        return 1;
      }
      uVar13 = 8;
      goto LAB_6b83fec4;
    }
  }
  else if (bVar12) {
    puVar10 = param_2;
    do {
      uVar2 = *puVar10;
      puVar10 = puVar10 + 1;
    } while (uVar2 != 0);
    if (uVar6 < uVar6 + (((int)puVar10 - (int)(param_2 + 1) >> 1) + 1) * 2) {
      puVar10 = param_2;
      do {
        uVar2 = *puVar10;
        puVar10 = puVar10 + 1;
      } while (uVar2 != 0);
      uVar6 = uVar6 + 2 + ((int)puVar10 - (int)(param_2 + 1) >> 1) * 2;
      puVar10 = param_2;
      do {
        uVar2 = *puVar10;
        puVar10 = puVar10 + 1;
      } while (uVar2 != 0);
      if (uVar6 < uVar6 + (((int)puVar10 - (int)(param_2 + 1) >> 1) + 1) * 2) {
        puVar10 = param_2;
        do {
          uVar2 = *puVar10;
          puVar10 = puVar10 + 1;
        } while (uVar2 != 0);
        uVar6 = uVar6 + (((int)puVar10 - (int)(param_2 + 1) >> 1) + 1) * 2;
        goto LAB_6b83fe40;
      }
    }
  }
  else {
    uVar1 = uVar6 + 4;
    if ((uVar6 < uVar1) && (uVar6 = uVar6 + 8, uVar1 < uVar6)) goto LAB_6b83fe40;
  }
  uVar13 = 0x6f;
LAB_6b83fec4:
  RtlSetLastWin32Error(uVar13);
  return 0;
}



undefined4 __fastcall
FUN_6b83fed3(uint *param_1,uint param_2,uint *param_3,uint param_4,uint param_5,int param_6,
            int *param_7)

{
  int iVar1;
  bool bVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  undefined4 uVar6;
  
  bVar2 = false;
  if (((param_1 == (uint *)0x0) || (param_3 == (uint *)0x0)) || (param_7 == (int *)0x0)) {
    uVar6 = 0x57;
  }
  else {
    if ((param_6 == 0) || (param_4 <= param_2)) {
      iVar1 = *param_7;
      uVar5 = param_4 >> 2;
      iVar3 = iVar1;
      if (param_6 == 0) {
        if (uVar5 != 0) {
          uVar4 = 4;
          do {
            uVar5 = uVar5 - 1;
            if (*param_3 != param_5) {
              if (param_2 < uVar4) goto LAB_6b83ffb7;
              *(uint *)((int)param_1 + (iVar3 - iVar1)) = *param_3;
              iVar3 = iVar3 + 4;
              uVar4 = uVar4 + 4;
            }
            param_3 = param_3 + 1;
          } while (0 < (int)uVar5);
        }
LAB_6b83ff7e:
        *param_7 = iVar3;
        return 1;
      }
      if (param_4 + 4 <= param_2) {
        if (uVar5 != 0) {
          do {
            uVar5 = uVar5 - 1;
            if ((!bVar2) && (param_5 <= *param_3)) {
              if (*param_3 == param_5) {
                return 0;
              }
              *param_1 = param_5;
              param_1 = param_1 + 1;
              bVar2 = true;
              iVar3 = iVar3 + 4;
            }
            iVar3 = iVar3 + 4;
            *param_1 = *param_3;
            param_3 = param_3 + 1;
            param_1 = param_1 + 1;
          } while (0 < (int)uVar5);
          if (bVar2) goto LAB_6b83ff7e;
        }
        if ((iVar3 - iVar1) + 4U <= param_2) {
          *param_1 = param_5;
          iVar3 = iVar3 + 4;
          goto LAB_6b83ff7e;
        }
      }
    }
LAB_6b83ffb7:
    uVar6 = 0x6f;
  }
  RtlSetLastWin32Error(uVar6);
  return 0;
}



undefined4 __fastcall
FUN_6b83ffcc(undefined2 *param_1,uint param_2,ushort *param_3,uint param_4,ushort *param_5,
            int param_6,int *param_7)

{
  size_t sVar1;
  ushort uVar2;
  ushort *puVar3;
  uint uVar4;
  ushort *puVar5;
  int iVar6;
  int iVar7;
  ushort *puVar8;
  bool bVar9;
  bool bVar10;
  undefined4 uVar11;
  uint local_8;
  
  local_8 = 1;
  bVar10 = false;
  if ((((param_1 == (undefined2 *)0x0) || (param_3 == (ushort *)0x0)) || (param_7 == (int *)0x0)) ||
     (param_5 == (ushort *)0x0)) {
LAB_6b84029c:
    uVar11 = 0x57;
  }
  else {
    if ((param_6 == 0) || ((int)param_4 <= (int)param_2)) {
      if (((int)param_2 < 0) || ((int)param_4 < 0)) goto LAB_6b84029c;
      iVar7 = *param_7;
      param_4 = param_4 >> 1;
      puVar3 = param_5;
      do {
        uVar2 = *puVar3;
        puVar3 = puVar3 + 1;
      } while (uVar2 != 0);
      if (param_6 == 0) {
        if (param_4 != 0) {
          do {
            if (*param_3 == 0) break;
            puVar5 = param_3;
            do {
              uVar2 = *puVar5;
              puVar5 = puVar5 + 1;
            } while (uVar2 != 0);
            iVar6 = ((int)puVar5 - (int)(param_3 + 1) >> 1) + 1;
            puVar5 = param_3;
            puVar8 = param_5;
            if (iVar6 - ((int)puVar3 - (int)(param_5 + 1) >> 1) == 1) {
              do {
                bVar10 = *puVar5 < *puVar8;
                if (*puVar5 != *puVar8) {
LAB_6b84023e:
                  local_8 = -(uint)bVar10 | 1;
                  goto LAB_6b840246;
                }
                if (*puVar5 == 0) break;
                uVar2 = puVar5[1];
                bVar10 = uVar2 < puVar8[1];
                if (uVar2 != puVar8[1]) goto LAB_6b84023e;
                puVar5 = puVar5 + 2;
                puVar8 = puVar8 + 2;
              } while (uVar2 != 0);
              local_8 = 0;
            }
LAB_6b840246:
            sVar1 = iVar6 * 2;
            if (local_8 == 0) {
              local_8 = 1;
            }
            else {
              if (param_2 < (sVar1 - *param_7) + iVar7) goto LAB_6b840298;
              memcpy(param_1,param_3,sVar1);
              param_1 = param_1 + iVar6;
              iVar7 = iVar7 + sVar1;
            }
            param_4 = param_4 - iVar6;
            param_3 = param_3 + iVar6;
          } while (0 < (int)param_4);
        }
LAB_6b8401b6:
        if ((iVar7 - *param_7) + 2U <= param_2) {
          iVar7 = iVar7 + 2;
          *param_1 = 0;
        }
        *param_7 = iVar7;
        return 1;
      }
      if (param_4 != 0) {
        do {
          puVar3 = param_3;
          puVar5 = param_5;
          if (*param_3 == 0) break;
          do {
            uVar2 = *puVar3;
            bVar9 = uVar2 < *puVar5;
            if (uVar2 != *puVar5) {
LAB_6b8400ae:
              uVar4 = -(uint)bVar9 | 1;
              goto LAB_6b8400b5;
            }
            if (uVar2 == 0) break;
            uVar2 = puVar3[1];
            bVar9 = uVar2 < puVar5[1];
            if (uVar2 != puVar5[1]) goto LAB_6b8400ae;
            puVar3 = puVar3 + 2;
            puVar5 = puVar5 + 2;
          } while (uVar2 != 0);
          uVar4 = 0;
LAB_6b8400b5:
          if (uVar4 == 0) {
            return 0;
          }
          if ((!bVar10) && (0 < (int)uVar4)) {
            puVar3 = param_5;
            do {
              uVar2 = *puVar3;
              puVar3 = puVar3 + 1;
            } while (uVar2 != 0);
            iVar6 = (int)puVar3 - (int)(param_5 + 1) >> 1;
            sVar1 = iVar6 * 2 + 2;
            if (param_2 < (sVar1 - *param_7) + iVar7) goto LAB_6b840298;
            memcpy(param_1,param_5,sVar1);
            param_1 = param_1 + iVar6 + 1;
            bVar10 = true;
            iVar7 = iVar7 + sVar1;
          }
          puVar3 = param_3;
          do {
            uVar2 = *puVar3;
            puVar3 = puVar3 + 1;
          } while (uVar2 != 0);
          iVar6 = ((int)puVar3 - (int)(param_3 + 1) >> 1) + 1;
          if (iVar6 == 1) break;
          sVar1 = iVar6 * 2;
          if (param_2 < (sVar1 - *param_7) + iVar7) goto LAB_6b840298;
          memcpy(param_1,param_3,sVar1);
          param_1 = param_1 + iVar6;
          param_4 = param_4 - iVar6;
          param_3 = param_3 + iVar6;
          iVar7 = iVar7 + sVar1;
        } while (0 < (int)param_4);
        if (bVar10) goto LAB_6b8401b6;
      }
      puVar3 = param_5;
      do {
        uVar2 = *puVar3;
        puVar3 = puVar3 + 1;
      } while (uVar2 != 0);
      iVar6 = (int)puVar3 - (int)(param_5 + 1) >> 1;
      sVar1 = iVar6 * 2 + 2;
      if ((sVar1 - *param_7) + iVar7 <= param_2) {
        memcpy(param_1,param_5,sVar1);
        param_1 = param_1 + iVar6 + 1;
        iVar7 = iVar7 + sVar1;
        goto LAB_6b8401b6;
      }
    }
LAB_6b840298:
    uVar11 = 0x6f;
  }
  RtlSetLastWin32Error(uVar11);
  return 0;
}



void __fastcall FUN_6b8402ad(HGLOBAL param_1,LPCWSTR param_2)

{
  LPVOID pvVar1;
  LPCWSTR lpFileName;
  HANDLE hObject;
  UINT UVar2;
  HANDLE hObject_00;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar3;
  short local_4c [30];
  int local_10;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  pvVar1 = GlobalLock(param_1);
  if (pvVar1 != (LPVOID)0x0) {
    lpFileName = (LPCWSTR)GlobalLock(*(HGLOBAL *)((int)pvVar1 + 0x18));
    if (lpFileName != (LPCWSTR)0x0) {
      hObject = CreateFileW(lpFileName,0x80000000,0,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0x0);
      GlobalUnlock(*(HGLOBAL *)((int)pvVar1 + 0x18));
      if (hObject != (HANDLE)0xffffffff) {
        UVar2 = _hread((HFILE)hObject,local_4c,0x40);
        if (UVar2 == 0x40) {
          if (local_4c[0] == 0x5a4d) {
            if (local_10 == 0) {
              CloseHandle(hObject);
            }
            else {
              hObject_00 = CreateFileW(param_2,0xc0000000,0,(LPSECURITY_ATTRIBUTES)0x0,2,0x80,
                                       (HANDLE)0x0);
              if (hObject_00 != (HANDLE)0xffffffff) {
                FUN_6b83fc0e((HFILE)hObject,(uint)hObject_00,local_10,(int)pvVar1);
                CloseHandle(hObject_00);
              }
              CloseHandle(hObject);
            }
          }
          else {
            CloseHandle(hObject);
          }
        }
        else {
          CloseHandle(hObject);
        }
      }
      GlobalUnlock(param_1);
      uVar3 = extraout_EDX_00;
      goto LAB_6b8403bb;
    }
    GlobalUnlock(param_1);
  }
  GetLastError();
  uVar3 = extraout_EDX;
LAB_6b8403bb:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar3);
  return;
}



undefined4 * __fastcall
FUN_6b8403ca(int param_1,HFILE param_2,int param_3,uint param_4,undefined4 *param_5)

{
  bool bVar1;
  LONG LVar2;
  uint uVar3;
  undefined4 *puVar4;
  uint uVar5;
  uint local_10;
  undefined4 *local_c;
  
  puVar4 = *(undefined4 **)(param_1 + 0x10);
  local_10 = param_4;
  for (; puVar4 != (undefined4 *)0x0; puVar4 = (undefined4 *)*puVar4) {
    local_c = (undefined4 *)puVar4[4];
    bVar1 = true;
    while( true ) {
      for (; local_c != (undefined4 *)0x0; local_c = (undefined4 *)*local_c) {
        if ((param_5 == (undefined4 *)0x0) || (local_c == param_5)) {
          if ((param_4 == 0) || (uVar5 = local_c[5], param_4 < uVar5)) goto LAB_6b840521;
          _hwrite(param_2,(LPCCH)local_c[6],uVar5);
          uVar3 = -uVar5 & 3;
          if (uVar3 != 0) {
            _hwrite(param_2,"PADDINGXXPADDING",uVar3);
          }
          param_4 = local_10 - (uVar3 + uVar5);
          param_5 = (undefined4 *)0x0;
          local_10 = param_4;
        }
      }
      if (!bVar1) break;
      local_c = (undefined4 *)puVar4[3];
      bVar1 = false;
    }
  }
  for (puVar4 = *(undefined4 **)(param_1 + 0xc); puVar4 != (undefined4 *)0x0;
      puVar4 = (undefined4 *)*puVar4) {
    local_c = (undefined4 *)puVar4[4];
    bVar1 = true;
    while( true ) {
      for (; local_c != (undefined4 *)0x0; local_c = (undefined4 *)*local_c) {
        if ((param_5 == (undefined4 *)0x0) || (local_c == param_5)) {
          if ((param_4 == 0) || (uVar5 = local_c[5], param_4 < uVar5)) goto LAB_6b840521;
          _hwrite(param_2,(LPCCH)local_c[6],uVar5);
          uVar3 = -uVar5 & 3;
          if (uVar3 != 0) {
            _hwrite(param_2,"PADDINGXXPADDING",uVar3);
          }
          param_4 = local_10 - (uVar3 + uVar5);
          param_5 = (undefined4 *)0x0;
          local_10 = param_4;
        }
      }
      if (!bVar1) break;
      local_c = (undefined4 *)puVar4[3];
      bVar1 = false;
    }
  }
  local_c = (undefined4 *)0x0;
LAB_6b840521:
  LVar2 = _llseek(param_2,0,1);
  uVar5 = (param_3 + -1 + LVar2 & -param_3) - LVar2;
  if (uVar5 != 0) {
    if (0xf < uVar5) {
      uVar3 = uVar5 >> 4;
      do {
        _hwrite(param_2,"PADDINGXXPADDING",0x10);
        uVar5 = uVar5 - 0x10;
        uVar3 = uVar3 - 1;
      } while (uVar3 != 0);
    }
    _hwrite(param_2,"PADDINGXXPADDING",uVar5);
  }
  return local_c;
}



HANDLE BeginUpdateResourceA(LPCSTR pFileName,BOOL bDeleteExistingResources)

{
  int iVar1;
  HANDLE pvVar2;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x40580  107  BeginUpdateResourceA
  if (pFileName == (LPCSTR)0x0) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,pFileName);
    if (iVar1 != 0) {
      pvVar2 = BeginUpdateResourceW(local_8,bDeleteExistingResources);
      RtlFreeUnicodeString(local_c);
      return pvVar2;
    }
  }
  return (HANDLE)0x0;
}



HANDLE BeginUpdateResourceW(LPCWSTR pFileName,BOOL bDeleteExistingResources)

{
  HGLOBAL hMem;
  LPVOID lParam;
  uint uVar1;
  HGLOBAL hMem_00;
  LPCWSTR lpFileName;
  DWORD DVar2;
  HMODULE hModule;
  DWORD DVar3;
  uint local_c;
  uint local_8;
  
                    // 0x405d0  108  BeginUpdateResourceW
  DVar3 = 0;
  local_8 = 0;
  if ((pFileName == (LPCWSTR)0x0) || (*pFileName == L'\0')) {
    DVar3 = 0x57;
  }
  else {
    hMem = GlobalAlloc(0x42,0x1c);
    if (hMem == (HGLOBAL)0x0) {
      DVar3 = 8;
    }
    else {
      lParam = GlobalLock(hMem);
      if (lParam == (LPVOID)0x0) {
        DVar3 = 8;
      }
      else {
        uVar1 = FUN_6b84097e(pFileName,0x7fffffff,(int *)&local_c);
        if ((int)uVar1 < 0) {
          DVar3 = uVar1 & 0xffff;
        }
        else {
          *(undefined4 *)((int)lParam + 0x14) = 0;
          uVar1 = FUN_6b839286(local_c,1,&local_8);
          if (((int)uVar1 < 0) || ((int)((ulonglong)local_8 * 2 >> 0x20) != 0)) {
            DVar3 = 0x216;
          }
          else {
            hMem_00 = GlobalAlloc(0x42,(SIZE_T)((ulonglong)local_8 * 2));
            *(HGLOBAL *)((int)lParam + 0x18) = hMem_00;
            if (hMem_00 == (HGLOBAL)0x0) {
              DVar3 = 8;
            }
            else {
              lpFileName = (LPCWSTR)GlobalLock(hMem_00);
              if (lpFileName == (LPCWSTR)0x0) {
                DVar3 = 8;
              }
              else {
                local_c = FUN_6b812c57(lpFileName,local_8,(int)pFileName);
                GlobalUnlock(*(HGLOBAL *)((int)lParam + 0x18));
                if ((int)local_c < 0) {
                  DVar3 = local_c & 0xffff;
                }
                else {
                  DVar2 = GetFileAttributesW(lpFileName);
                  if (DVar2 == 0xffffffff) {
                    DVar3 = GetLastError();
                    if (DVar3 == 0) {
                      DVar3 = 2;
                    }
                  }
                  else if ((DVar2 & 0x17) == 0) {
                    hModule = LoadLibraryExW(pFileName,(HANDLE)0x0,3);
                    if (hModule == (HMODULE)0x0) {
                      DVar3 = GetLastError();
                      if (DVar3 == 0) {
                        DVar3 = 0xc1;
                      }
                    }
                    else {
                      if (bDeleteExistingResources == 0) {
                        EnumResourceTypesExW(hModule,lpEnumFunc_6b83f3c0,(LONG_PTR)lParam,0x10,0);
                      }
                      FreeLibrary(hModule);
                      if (*(int *)((int)lParam + 0x14) == 0) {
                        GlobalUnlock(hMem);
                        return hMem;
                      }
                    }
                  }
                  else {
                    DVar3 = 0x13;
                  }
                }
              }
              GlobalFree(*(HGLOBAL *)((int)lParam + 0x18));
            }
          }
        }
        GlobalUnlock(hMem);
      }
      GlobalFree(hMem);
    }
  }
  RtlSetLastWin32Error(DVar3);
  return (HANDLE)0x0;
}



BOOL EndUpdateResourceA(HANDLE hUpdate,BOOL fDiscard)

{
  BOOL BVar1;
  
                    // 0x40780  309  EndUpdateResourceA
  BVar1 = EndUpdateResourceW(hUpdate,fDiscard);
  return BVar1;
}



BOOL EndUpdateResourceW(HANDLE hUpdate,BOOL fDiscard)

{
  LPVOID pvVar1;
  uint uVar2;
  WCHAR *pWVar3;
  UINT UVar4;
  DWORD DVar5;
  LPVOID pvVar6;
  BOOL BVar7;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  HGLOBAL pvVar8;
  uint uVar9;
  undefined4 uVar10;
  LPCWSTR local_224;
  HGLOBAL local_220;
  WCHAR *local_21c;
  WCHAR local_218;
  undefined2 local_216;
  undefined2 local_214;
  uint local_c;
  
                    // 0x40790  310  EndUpdateResourceW
  local_c = DAT_6b8b0140 ^ (uint)&local_224;
  uVar9 = 0;
  local_220 = hUpdate;
  local_224 = (LPCWSTR)0x0;
  RtlSetLastWin32Error(0);
  if (hUpdate == (HANDLE)0x0) {
    uVar10 = 0x57;
LAB_6b8407c9:
    RtlSetLastWin32Error(uVar10);
    uVar10 = extraout_EDX;
    goto LAB_6b840967;
  }
  pvVar1 = GlobalLock(hUpdate);
  if (fDiscard == 0) {
    uVar10 = extraout_EDX_00;
    if (pvVar1 == (LPVOID)0x0) goto LAB_6b840967;
    local_224 = (LPCWSTR)GlobalLock(*(HGLOBAL *)((int)pvVar1 + 0x18));
    if (local_224 == (LPCWSTR)0x0) {
      uVar10 = 0x54f;
      goto LAB_6b8407c9;
    }
    uVar2 = FUN_6b81ec6c(&local_218,0x104,local_224,&local_21c,(uint *)0x0);
    if ((int)uVar2 < 0) {
      uVar9 = uVar2 & 0xffff;
    }
    else {
      do {
        pWVar3 = local_21c;
        local_21c = pWVar3 + -1;
        if (*local_21c == L'\\') break;
      } while (&local_218 <= local_21c);
      *pWVar3 = L'\0';
      UVar4 = GetTempFileNameW(&local_218,(LPCWSTR)&lpPrefixString_6b887b50,0,&local_218);
      pvVar8 = local_220;
      if (UVar4 == 0) {
        DVar5 = GetTempPathW(0x104,&local_218);
        if (DVar5 == 0) {
          local_218 = L'.';
          local_216 = 0x5c;
          local_214 = 0;
        }
        UVar4 = GetTempFileNameW(&local_218,(LPCWSTR)&lpPrefixString_6b887b50,0,&local_218);
        if (UVar4 == 0) {
          GetLastError();
          goto LAB_6b84090a;
        }
        DVar5 = FUN_6b8402ad(pvVar8,&local_218);
      }
      else {
        DVar5 = FUN_6b8402ad(local_220,&local_218);
      }
      if (DVar5 == 0) {
        BVar7 = MoveFileExW(&local_218,local_224,3);
        if (BVar7 != 0) goto LAB_6b84090a;
        DVar5 = GetLastError();
        if (DVar5 == 0) {
          DVar5 = 0x54f;
        }
      }
      DeleteFileW(&local_218);
      uVar9 = DVar5;
    }
LAB_6b84090a:
    GlobalUnlock(*(HGLOBAL *)((int)pvVar1 + 0x18));
    GlobalFree(*(HGLOBAL *)((int)pvVar1 + 0x18));
  }
  pvVar8 = local_220;
  if (pvVar1 != (LPVOID)0x0) {
    if (local_224 == (LPCWSTR)0x0) {
      pvVar6 = GlobalLock(*(HGLOBAL *)((int)pvVar1 + 0x18));
      if (pvVar6 != (LPVOID)0x0) {
        GlobalFree(*(HGLOBAL *)((int)pvVar1 + 0x18));
        goto LAB_6b84093b;
      }
    }
    else {
LAB_6b84093b:
      FUN_6b83f430((int)pvVar1);
    }
    pvVar8 = local_220;
    GlobalUnlock(local_220);
  }
  GlobalFree(pvVar8);
  RtlSetLastWin32Error(uVar9);
  uVar10 = extraout_EDX_01;
LAB_6b840967:
  BVar7 = FUN_6b8224af(local_c ^ (uint)&local_224,uVar10);
  return BVar7;
}



void __fastcall FUN_6b84097e(short *param_1,uint param_2,int *param_3)

{
  int iVar1;
  
  if ((param_1 == (short *)0x0) || (0x7fffffff < param_2)) {
    iVar1 = -0x7ff8ffa9;
  }
  else {
    iVar1 = FUN_6b8409f5(param_1,param_2,param_3);
  }
  if ((iVar1 < 0) && (param_3 != (int *)0x0)) {
    *param_3 = 0;
  }
  return;
}



int __thiscall FUN_6b8409b0(void *this,undefined4 param_1,int param_2)

{
  int iVar1;
  int iVar2;
  
  iVar1 = 8;
  iVar2 = param_2 - (int)this;
  do {
    if ((iVar1 == -0x7ffffff6) || (*(char *)((int)this + iVar2) == '\0')) break;
    *(char *)this = *(char *)((int)this + iVar2);
    this = (void *)((int)this + 1);
    iVar1 = iVar1 + -1;
  } while (iVar1 != 0);
  if (iVar1 == 0) {
    this = (void *)((int)this + -1);
  }
  *(char *)this = '\0';
  return (-(uint)(iVar1 != 0) & 0x7ff8ff86) + 0x8007007a;
}



int __fastcall FUN_6b8409f5(short *param_1,int param_2,int *param_3)

{
  int iVar1;
  
  iVar1 = param_2;
  if (param_2 != 0) {
    do {
      if (*param_1 == 0) break;
      param_1 = param_1 + 1;
      iVar1 = iVar1 + -1;
    } while (iVar1 != 0);
  }
  if (param_3 != (int *)0x0) {
    if (iVar1 == 0) {
      *param_3 = 0;
    }
    else {
      *param_3 = param_2 - iVar1;
    }
  }
  return (-(uint)(iVar1 != 0) & 0x7ff8ffa9) + 0x80070057;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL UpdateResourceA(HANDLE hUpdate,LPCSTR lpType,LPCSTR lpName,WORD wLanguage,LPVOID lpData,
                    DWORD cb)

{
  char cVar1;
  int iVar2;
  LPCSTR pCVar3;
  BOOL BVar4;
  undefined4 *in_FS_OFFSET;
  undefined local_3c [4];
  LPCWSTR local_38;
  undefined local_34 [4];
  LPCWSTR local_30;
  undefined2 local_2c [2];
  LPCSTR local_28;
  int local_24;
  BOOL local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x40a40  1473  UpdateResourceA
  local_8 = &DAT_6b892008;
  uStack12 = 0x6b840a4c;
  BVar4 = 0;
  local_20 = 0;
  if ((lpType == (LPCSTR)0x0) || (lpName == (LPCSTR)0x0)) {
    BaseSetLastNTError(0xc000000d);
    BVar4 = 0;
    goto LAB_6b840b42;
  }
  RtlInitUnicodeString(local_34,0);
  RtlInitUnicodeString(local_3c,0);
  local_8 = (undefined *)0x0;
  if (lpType < (LPCSTR)0x10000) {
LAB_6b840abf:
    if ((LPCSTR)0xffff < lpName) {
      pCVar3 = lpName;
      do {
        cVar1 = *pCVar3;
        pCVar3 = pCVar3 + 1;
      } while (cVar1 != '\0');
      local_24 = (int)pCVar3 - (int)(lpName + 1);
      local_2c[0] = (undefined2)local_24;
      local_28 = lpName;
      iVar2 = RtlAnsiStringToUnicodeString(local_3c,local_2c,1);
      lpName = (LPCSTR)local_38;
      if (iVar2 < 0) goto LAB_6b840ab4;
    }
    BVar4 = UpdateResourceW(hUpdate,(LPCWSTR)lpType,(LPCWSTR)lpName,wLanguage,lpData,cb);
  }
  else {
    pCVar3 = lpType;
    do {
      cVar1 = *pCVar3;
      pCVar3 = pCVar3 + 1;
    } while (cVar1 != '\0');
    local_24 = (int)pCVar3 - (int)(lpType + 1);
    local_2c[0] = (undefined2)local_24;
    local_28 = lpType;
    iVar2 = RtlAnsiStringToUnicodeString(local_34,local_2c,1);
    lpType = (LPCSTR)local_30;
    if (-1 < iVar2) goto LAB_6b840abf;
LAB_6b840ab4:
    BaseSetLastNTError(iVar2);
  }
  local_8 = (undefined *)0xfffffffe;
  local_20 = BVar4;
  FUN_6b840b21();
LAB_6b840b42:
  *in_FS_OFFSET = local_14;
  return BVar4;
}



void FUN_6b840b21(void)

{
  int unaff_EBP;
  
  RtlFreeUnicodeString(unaff_EBP + -0x30);
  RtlFreeUnicodeString(unaff_EBP + -0x38);
  return;
}



// WARNING: Removing unreachable block (ram,0x6b840c17)
// WARNING: Removing unreachable block (ram,0x6b840c41)
// WARNING: Removing unreachable block (ram,0x6b840c4c)
// WARNING: Removing unreachable block (ram,0x6b840c84)
// WARNING: Removing unreachable block (ram,0x6b840cda)

BOOL UpdateResourceW(HANDLE hUpdate,LPCWSTR lpType,LPCWSTR lpName,WORD wLanguage,LPVOID lpData,
                    DWORD cb)

{
  int *piVar1;
  LPVOID pvVar2;
  int *piVar3;
  int *piVar4;
  int in_FS_OFFSET;
  int iVar5;
  
                    // 0x40b60  1474  UpdateResourceW
  RtlSetLastWin32Error(0);
  piVar1 = (int *)GlobalLock(hUpdate);
  if ((piVar1 == (int *)0x0) || (cb != 0)) {
    iVar5 = 0x57;
  }
  else {
    pvVar2 = GlobalLock((HGLOBAL)piVar1[6]);
    if (pvVar2 == (LPVOID)0x0) {
      iVar5 = 0x54f;
    }
    else {
      iVar5 = FUN_6b83f989((int)piVar1,(ushort *)lpType,wLanguage);
      if (iVar5 == 0) {
        GlobalUnlock(hUpdate);
        iVar5 = 0x32;
      }
      else {
        piVar3 = FUN_6b83ee98(lpName,piVar1);
        if (piVar3 == (int *)0x0) {
          piVar1[5] = 8;
        }
        else {
          piVar4 = FUN_6b83ee98(lpType,piVar1);
          if (piVar4 != (int *)0x0) {
            iVar5 = FUN_6b83e8ca(piVar4,piVar3,wLanguage,(int)piVar1,hUpdate,(int *)0x0,(int *)0x0);
            if (iVar5 == 0) {
              GlobalUnlock(hUpdate);
              return 1;
            }
            GlobalFree((HGLOBAL)piVar1[6]);
            FUN_6b83f430((int)piVar1);
            GlobalUnlock(hUpdate);
            goto LAB_6b840b91;
          }
          piVar1[5] = 8;
          if (*piVar3 == 2) {
            RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,piVar3);
          }
          FUN_6b83f567((int)piVar1);
        }
        iVar5 = 8;
        GlobalUnlock(hUpdate);
      }
    }
  }
LAB_6b840b91:
  RtlSetLastWin32Error(iVar5);
  return 0;
}



undefined4 BaseCheckAppcompatCacheExWorker(void)

{
                    // 0x40d00  47  BaseCheckAppcompatCacheExWorker
  return 0;
}



undefined4 BaseCheckAppcompatCacheWorker(void)

{
                    // 0x40d10  48  BaseCheckAppcompatCacheWorker
  return 0;
}



undefined4 BaseCleanupAppcompatCacheSupportWorker(void)

{
                    // 0x40d20  51  BaseCleanupAppcompatCacheSupportWorker
  return 1;
}



bool BaseFlushAppcompatCacheWorker(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined *puVar3;
  undefined local_c8 [132];
  undefined4 local_44;
  
                    // 0x40d30  58  BaseFlushAppcompatCacheWorker
  memset(local_c8,0,0xc4);
  puVar3 = local_c8;
  local_44 = 0xfff;
  uVar2 = 3;
  _guard_check_icall();
  iVar1 = NtApphelpCacheControl(uVar2,puVar3);
  return -1 < iVar1;
}



// WARNING: Function: _chkstk replaced with injection: alloca_probe

void BaseReadAppCompatDataForProcessWorker(HANDLE param_1,void **param_2,void **param_3)

{
  BOOL BVar1;
  DWORD DVar2;
  HANDLE hProcess;
  uint uVar3;
  undefined4 extraout_EDX;
  void *pvVar4;
  void *extraout_EDX_00;
  void *extraout_EDX_01;
  undefined4 extraout_EDX_02;
  void *extraout_EDX_03;
  void *extraout_EDX_04;
  void *extraout_EDX_05;
  void *pvVar5;
  void *lpBuffer;
  int in_FS_OFFSET;
  undefined8 uVar6;
  int *Wow64Process;
  void *local_10f4;
  int local_10f0;
  int local_10ec;
  int local_10e8;
  HANDLE local_10e4;
  void **local_10e0;
  void **local_10dc;
  undefined local_10d8 [488];
  void *local_ef0;
  undefined local_c58 [488];
  LPCVOID local_a70;
  undefined local_7d8 [728];
  LPCVOID local_500;
  void *local_4fc;
  uint local_c;
  
                    // 0x40d90  70  BaseReadAppCompatDataForProcessWorker
  local_c = DAT_6b8b0140 ^ (uint)&local_10f4;
  pvVar5 = (void *)0x0;
  local_10e0 = param_2;
  local_10dc = param_3;
  local_10e4 = param_1;
  memset(local_10d8,0,0x480);
  memset(local_c58,0,0x480);
  memset(local_7d8,0,0x7c8);
  local_10f4 = (void *)0x0;
  lpBuffer = (void *)0x0;
  local_10ec = 0;
  local_10f0 = 0;
  if ((param_1 == (HANDLE)0x0) || (local_10e0 == (void **)0x0)) {
    uVar6 = CONCAT44(extraout_EDX,0x57);
    local_ef0 = pvVar5;
LAB_6b840fea:
    pvVar4 = (void *)((ulonglong)uVar6 >> 0x20);
    if ((int)uVar6 == 0) {
LAB_6b840ff2:
      if (((*(int *)((int)lpBuffer + 0x208) == 0x11c0) &&
          (*(int *)((int)lpBuffer + 0x20c) == -0x53f21255)) &&
         (*local_10e0 = lpBuffer, local_10dc != (void **)0x0)) {
        *local_10dc = local_ef0;
        local_10dc[1] = local_10f4;
      }
      goto LAB_6b840e85;
    }
  }
  else {
    uVar6 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,0x11c0);
    pvVar4 = (void *)((ulonglong)uVar6 >> 0x20);
    lpBuffer = (void *)uVar6;
    if (lpBuffer == (void *)0x0) goto LAB_6b840e85;
    if (param_1 == (HANDLE)0xffffffff) {
      local_ef0 = *(void **)(*(int *)(in_FS_OFFSET + 0x30) + 0x1e8);
      pvVar4 = (void *)((int)local_ef0 >> 0x1f);
      local_10f4 = pvVar4;
      if (((uint)local_ef0 | (uint)pvVar4) == 0) goto LAB_6b840e6d;
      memcpy(lpBuffer,local_ef0,0x11c0);
      pvVar4 = extraout_EDX_01;
      goto LAB_6b840ff2;
    }
    BVar1 = IsWow64Process(param_1,&local_10ec);
    if (BVar1 == 0) {
LAB_6b840ec2:
      DVar2 = GetLastError();
      uVar6 = CONCAT44(extraout_EDX_02,DVar2);
      local_ef0 = pvVar5;
      goto LAB_6b840fea;
    }
    Wow64Process = &local_10f0;
    hProcess = GetCurrentProcess();
    BVar1 = IsWow64Process(hProcess,Wow64Process);
    if (BVar1 == 0) goto LAB_6b840ec2;
    if ((local_10f0 == 0) || (local_10ec != 0)) {
      local_10e8 = 0;
      if (local_10ec == 0) goto LAB_6b840f07;
      DVar2 = FUN_6b841067(param_1,local_c58);
      pvVar4 = extraout_EDX_04;
      if (DVar2 != 0) goto LAB_6b840e6d;
      local_4fc = (void *)0x0;
      local_ef0 = local_a70;
LAB_6b840f7d:
      local_10f4 = local_4fc;
      if (((uint)local_ef0 | (uint)local_4fc) == 0) goto LAB_6b840e6d;
      if ((local_10f0 == 0) || (local_10e8 == 0)) {
        BVar1 = ReadProcessMemory(local_10e4,local_ef0,lpBuffer,0x11c0,(SIZE_T *)0x0);
        pvVar4 = extraout_EDX_05;
        pvVar5 = local_ef0;
        if (BVar1 == 0) goto LAB_6b840ec2;
      }
      else {
        uVar3 = FUN_6b84122c(local_10e4,lpBuffer,local_ef0,local_4fc,0x11c0,0);
        pvVar4 = (void *)0xc0000000;
        if ((uVar3 & 0xc0000000) == 0xc0000000) {
          uVar6 = RtlNtStatusToDosError(uVar3);
          goto LAB_6b840fea;
        }
      }
      goto LAB_6b840ff2;
    }
    local_10e8 = 1;
LAB_6b840f07:
    if (local_10f0 == 0) {
      DVar2 = FUN_6b841156(param_1,local_10d8);
      pvVar4 = extraout_EDX_03;
      if (DVar2 == 0) {
        local_4fc = (void *)((int)local_ef0 >> 0x1f);
        pvVar4 = local_4fc;
        goto LAB_6b840f7d;
      }
    }
    else {
      uVar6 = FUN_6b8410d0((int)param_1,(int)local_7d8);
      pvVar4 = (void *)((ulonglong)uVar6 >> 0x20);
      local_ef0 = local_500;
      if ((int)uVar6 == 0) goto LAB_6b840f7d;
    }
  }
LAB_6b840e6d:
  if (lpBuffer != (void *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpBuffer);
    pvVar4 = extraout_EDX_00;
  }
LAB_6b840e85:
  FUN_6b8224af(local_c ^ (uint)&local_10f4,pvVar4);
  return;
}



bool BaseUpdateAppcompatCacheWorker(wchar_t *param_1,uint param_2,int param_3)

{
  uint uVar1;
  bool bVar2;
  
                    // 0x41040  73  BaseUpdateAppcompatCacheWorker
  if (param_3 == 0) {
    bVar2 = false;
  }
  else {
    uVar1 = FUN_6b866f29(param_1,param_2);
    bVar2 = -1 < (int)uVar1;
  }
  return bVar2;
}



DWORD __fastcall FUN_6b841067(HANDLE param_1,LPVOID param_2)

{
  int iVar1;
  BOOL BVar2;
  DWORD DVar3;
  LPCVOID local_8;
  
  DVar3 = 0;
  local_8 = (LPCVOID)0x0;
  if ((param_1 == (HANDLE)0x0) || (param_2 == (LPVOID)0x0)) {
    DVar3 = 0x57;
  }
  else {
    iVar1 = NtQueryInformationProcess(param_1,0x1a,&local_8,4,0);
    if (iVar1 < 0) {
      DVar3 = RtlNtStatusToDosError(iVar1);
    }
    else if (local_8 == (LPCVOID)0x0) {
      DVar3 = 0xd;
    }
    else {
      BVar2 = ReadProcessMemory(param_1,local_8,param_2,0x480,(SIZE_T *)0x0);
      if (BVar2 == 0) {
        DVar3 = GetLastError();
      }
    }
  }
  return DVar3;
}



void __fastcall FUN_6b8410d0(int param_1,int param_2)

{
  int iVar1;
  int extraout_EDX;
  int extraout_EDX_00;
  int extraout_EDX_01;
  int iVar2;
  undefined local_3c [8];
  uint local_34;
  uint local_30;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  iVar2 = param_2;
  if ((param_1 != 0) && (param_2 != 0)) {
    memset(local_3c,0,0x30);
    iVar1 = FUN_6b8411ca(local_3c);
    if ((iVar1 < 0) ||
       ((iVar2 = extraout_EDX, (local_34 | local_30) != 0 &&
        (iVar1 = FUN_6b84122c(param_1,param_2,local_34,local_30,0x7c8,0), iVar2 = extraout_EDX_01,
        iVar1 < 0)))) {
      RtlNtStatusToDosError(iVar1);
      iVar2 = extraout_EDX_00;
    }
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,iVar2);
  return;
}



DWORD __fastcall FUN_6b841156(HANDLE param_1,LPVOID param_2)

{
  BOOL BVar1;
  int iVar2;
  DWORD DVar3;
  LPCVOID *ppvVar4;
  LPCVOID local_20 [6];
  LPVOID local_8;
  
  ppvVar4 = local_20;
  local_8 = param_2;
  for (iVar2 = 6; iVar2 != 0; iVar2 = iVar2 + -1) {
    *ppvVar4 = (LPCVOID)0x0;
    ppvVar4 = ppvVar4 + 1;
  }
  if ((param_1 == (HANDLE)0x0) || (param_2 == (LPVOID)0x0)) {
    DVar3 = 0x57;
  }
  else {
    DVar3 = 0;
    iVar2 = NtQueryInformationProcess(param_1,0,local_20,0x18,0);
    if (iVar2 < 0) {
      DVar3 = RtlNtStatusToDosError(iVar2);
    }
    else if (local_20[1] == (LPCVOID)0x0) {
      DVar3 = 0xd;
    }
    else {
      BVar1 = ReadProcessMemory(param_1,local_20[1],local_8,0x480,(SIZE_T *)0x0);
      if (BVar1 == 0) {
        DVar3 = GetLastError();
      }
    }
  }
  return DVar3;
}



int FUN_6b8411ca(undefined4 param_1)

{
  FARPROC pFVar1;
  HMODULE hModule;
  int iVar2;
  
  if (DAT_6b8b09b8 == (FARPROC)0x0) {
    hModule = GetModuleHandleW(L"ntdll.dll");
    if (hModule == (HMODULE)0x0) {
      return -0x3ffffecb;
    }
    DAT_6b8b09b8 = GetProcAddress(hModule,"NtWow64QueryInformationProcess64");
    if (DAT_6b8b09b8 == (FARPROC)0x0) {
      return -0x3fffff86;
    }
  }
  pFVar1 = DAT_6b8b09b8;
  _guard_check_icall();
  iVar2 = (*pFVar1)();
  return iVar2;
}



int __fastcall
FUN_6b84122c(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
            undefined4 param_5,undefined4 param_6)

{
  FARPROC pFVar1;
  HMODULE hModule;
  int iVar2;
  undefined4 uVar3;
  
  if (DAT_6b8b09bc == (FARPROC)0x0) {
    hModule = GetModuleHandleW(L"ntdll.dll");
    if (hModule == (HMODULE)0x0) {
      return -0x3ffffecb;
    }
    DAT_6b8b09bc = GetProcAddress(hModule,"NtWow64ReadVirtualMemory64");
    if (DAT_6b8b09bc == (FARPROC)0x0) {
      return -0x3fffff86;
    }
  }
  pFVar1 = DAT_6b8b09bc;
  uVar3 = 0;
  _guard_check_icall();
  iVar2 = (*pFVar1)(param_1,param_3,param_4,param_2,param_5,param_6,uVar3);
  return iVar2;
}



int __fastcall FUN_6b841298(int *param_1,undefined4 *param_2)

{
  int iVar1;
  
  iVar1 = FUN_6b815914(param_1,param_2);
  if (-1 < iVar1) {
    iVar1 = RtlDecodeSystemPointer(DAT_6b8b088c);
    *param_1 = iVar1;
    if (iVar1 != 0) {
      return 0;
    }
    iVar1 = -0x3fffffff;
  }
  return iVar1;
}



int __fastcall
FUN_6b8412c3(undefined4 *param_1,undefined4 *param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  local_14 = 0;
  local_10 = 0;
  local_8 = 0;
  local_c = 0;
  local_1c = 0;
  local_18 = 0;
  iVar1 = OpenPackageInfoByFullNameForUser(param_3,param_4,0,&local_14);
  if (iVar1 != 0) {
    return iVar1;
  }
  iVar1 = GetTargetPlatformContext(local_14,0,&local_10);
  if (iVar1 == 0) {
    local_8 = 4;
    iVar1 = GetPackageTargetPlatformProperty(local_10,1,&local_8,&local_c);
    if (iVar1 != 0) {
      RtlGetDeviceFamilyInfoEnum(0,&local_c,0);
    }
    local_8 = 8;
    iVar1 = GetPackageTargetPlatformProperty(local_10,3,&local_8,&local_1c);
    if (iVar1 != 0) {
      local_1c = 0;
      local_18 = 0;
    }
  }
  else {
    if (iVar1 != 0x490) goto LAB_6b8413b6;
    iVar1 = AppXGetOSMaxVersionTested(param_4,&local_1c);
    if (iVar1 < 0) {
      local_1c = 0;
      local_18 = 0;
    }
    RtlGetDeviceFamilyInfoEnum(0,&local_c,0);
  }
  if (param_1 != (undefined4 *)0x0) {
    *param_1 = local_1c;
    param_1[1] = local_18;
  }
  if (param_2 != (undefined4 *)0x0) {
    *param_2 = local_c;
  }
  iVar1 = 0;
LAB_6b8413b6:
  ClosePackageInfo(local_14);
  return iVar1;
}



bool BasepInitAppCompatData(int param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  bool bVar2;
  undefined4 uVar3;
  undefined *puVar4;
  undefined local_c8 [172];
  int local_1c;
  undefined4 local_18;
  undefined4 local_14;
  
                    // 0x413d0  94  BasepInitAppCompatData
  if (param_1 == 0) {
    bVar2 = false;
  }
  else {
    memset(local_c8,0,0xc4);
    local_18 = param_2;
    local_14 = param_3;
    puVar4 = local_c8;
    local_1c = param_1;
    uVar3 = 10;
    _guard_check_icall();
    iVar1 = NtApphelpCacheControl(uVar3,puVar4);
    bVar2 = -1 < iVar1;
  }
  return bVar2;
}



undefined4
BasepQueryModuleChpeSettings
          (undefined4 *param_1,int param_2,wchar_t *param_3,undefined4 param_4,undefined4 param_5,
          int param_6,int *param_7,undefined4 *param_8,void **param_9,size_t *param_10)

{
  int iVar1;
  undefined4 *extraout_EDX;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  int local_58;
  code *local_54;
  undefined4 local_50;
  undefined4 local_4c;
  undefined4 local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28 [2];
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 *local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  
                    // 0x41440  101  BasepQueryModuleChpeSettings
  if ((param_1 == (undefined4 *)0x0) || (param_2 != 0x20)) {
    uVar2 = 0x57;
  }
  else {
    *(byte *)((int)param_1 + 0x15) = *(byte *)((int)param_1 + 0x15) & 0xfe;
    uVar2 = 0;
    *param_1 = 0;
    local_50 = CONCAT22(local_50._2_2_,0x14c);
    param_1[1] = 0;
    param_1[2] = 0x80000000;
    param_1[3] = 0;
    param_1[4] = 0x2000000;
    *(undefined *)(param_1 + 5) = 0x54;
    param_1[6] = 0;
    param_1[7] = 0;
    local_58 = 0;
    local_30 = 0;
    local_2c = 0;
    local_54 = (code *)0x0;
    local_38 = 0;
    local_34 = 0;
    local_40 = 0;
    local_3c = 0;
    iVar1 = RtlDosPathNameToNtPathName_U_WithStatus(param_3,&local_40,0,0);
    if (iVar1 < 0) {
      uVar2 = 3;
    }
    else {
      local_18 = &local_40;
      local_20 = 0x18;
      local_1c = 0;
      local_14 = 0x40;
      local_10 = 0;
      local_c = 0;
      iVar1 = NtCreateFile(&local_58,0x80100080,&local_20,&local_38,0,0x80,5,1,0x60,0,0);
      if (iVar1 < 0) {
        uVar2 = 0x6e;
      }
      else {
        BasepQueryAppCompat(0,0,0,local_58,0,param_3,param_5,param_6,param_7,param_8,param_9,
                            param_10,&local_44,local_28,&local_48,(ushort *)&local_50,&local_30,
                            &local_4c);
        iVar1 = FUN_6b841298((int *)&local_54,extraout_EDX);
        if (iVar1 < 0) {
          uVar2 = 0x7f;
        }
        else {
          uVar5 = *param_8;
          iVar1 = *param_7;
          uVar3 = 0x20;
          uVar4 = local_50;
          _guard_check_icall();
          (*local_54)(param_1,uVar3,uVar4,iVar1,uVar5,param_4);
        }
      }
    }
    if (local_58 != 0) {
      NtClose(local_58);
    }
    RtlFreeUnicodeString(&local_40);
  }
  return uVar2;
}



void BaseQueryModuleData(undefined4 param_1,undefined4 *param_2,undefined4 param_3,
                        undefined4 param_4,undefined4 param_5,undefined4 param_6,undefined4 param_7)

{
                    // 0x415d0  69  BaseQueryModuleData
  FUN_6b8415f3(param_1,param_2,param_3,param_4,param_5,param_6,param_7);
  return;
}



uint __fastcall
FUN_6b8415f3(undefined4 param_1,undefined4 *param_2,undefined4 param_3,undefined4 param_4,
            undefined4 param_5,undefined4 param_6,undefined4 param_7)

{
  code *pcVar1;
  byte bVar2;
  
  pcVar1 = (code *)FUN_6b815914(param_1,param_2);
  bVar2 = 0;
  if ((-1 < (int)pcVar1) &&
     (pcVar1 = (code *)RtlDecodeSystemPointer(DAT_6b8b0884), bVar2 = 0, pcVar1 != (code *)0x0)) {
    _guard_check_icall();
    pcVar1 = (code *)(*pcVar1)(param_1,param_2,param_3,param_4,param_5,param_6,param_7);
    bVar2 = (byte)pcVar1;
  }
  return (uint)pcVar1 & 0xffffff00 | (uint)bVar2;
}



undefined4 __fastcall FUN_6b841646(uint *param_1,uint param_2,int param_3,uint param_4)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  undefined4 uVar7;
  uint local_10;
  uint local_8;
  
  uVar7 = 0;
  puVar1 = param_1 + 0x2a;
  if (*puVar1 != 0) {
    iVar2 = FUN_6b86ea48(param_2);
    if (iVar2 == 0) {
      uVar7 = 0x8007054f;
    }
    else {
      local_10 = 0;
      if (*puVar1 != 0) {
        while( true ) {
          uVar7 = 0;
          if (*param_1 == 0) break;
          for (uVar3 = FUN_6b86f046(iVar2,*param_1,0x702c); uVar7 = 0, uVar3 != 0;
              uVar3 = FUN_6b86f139(iVar2,*param_1,uVar3)) {
            uVar4 = FUN_6b86e726(iVar2,uVar3);
            if ((uVar4 == 0) || (uVar5 = FUN_6b86f046(iVar2,uVar4,0x3002), uVar5 == 0)) {
LAB_6b84178b:
              uVar7 = 0x8007054e;
              goto LAB_6b841790;
            }
            uVar5 = FUN_6b86f607(iVar2,uVar5);
            uVar4 = FUN_6b86f046(iVar2,uVar4,0x3003);
            if (uVar4 == 0) goto LAB_6b84178b;
            uVar4 = FUN_6b86f607(iVar2,uVar4);
            local_8 = 0;
            if (param_4 != 0) {
              do {
                if (*(uint *)(param_3 + local_8 * 8) == (uVar4 & 0xffff | uVar5 << 0x10)) {
                  iVar6 = FUN_6b86f046(iVar2,uVar3,0x100f);
                  **(char **)(param_3 + 4 + local_8 * 8) = '\x01' - (iVar6 != 0);
                }
                local_8 = local_8 + 1;
              } while (local_8 < param_4);
            }
          }
          param_1 = param_1 + 1;
          local_10 = local_10 + 1;
          if (*puVar1 <= local_10) break;
        }
      }
LAB_6b841790:
      FUN_6b86fd67(iVar2);
    }
  }
  return uVar7;
}



uint __fastcall
FUN_6b8417a0(short *param_1,short *param_2,undefined4 param_3,uint param_4,uint param_5,uint param_6
            ,uint *param_7)

{
  uint uVar1;
  undefined4 local_10;
  byte *local_c;
  byte local_5;
  
  local_10 = param_3;
  local_c = &local_5;
  uVar1 = FUN_6b841a95(param_1,param_2,param_4,param_5,param_6,(int)&local_10,1);
  if (-1 < (int)uVar1) {
    *param_7 = (uint)local_5;
    uVar1 = 0;
  }
  return uVar1;
}



// WARNING: Could not reconcile some variable overlaps

void __fastcall
FUN_6b8417db(short *param_1,undefined4 param_2,HANDLE param_3,short *param_4,short *param_5)

{
  short sVar1;
  char cVar2;
  HANDLE pvVar3;
  int iVar4;
  short *psVar5;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint uVar6;
  uint local_1a4;
  undefined4 local_1a0;
  undefined4 local_19c;
  DWORD local_198;
  uint local_194;
  undefined4 local_190;
  short local_18c [2];
  DWORD *local_188;
  undefined4 local_184;
  undefined4 local_180;
  undefined4 local_17c;
  short *local_178;
  undefined4 local_174;
  undefined4 local_170;
  undefined4 local_16c;
  short *local_168;
  undefined4 local_164;
  int local_160;
  undefined4 local_15c;
  short *local_158;
  undefined4 local_154;
  int local_150;
  undefined4 local_14c;
  undefined4 *local_148;
  undefined4 local_144;
  undefined4 local_140;
  undefined4 local_13c;
  uint *local_138;
  undefined4 local_134;
  undefined4 local_130;
  undefined4 local_12c;
  short *local_128;
  undefined4 local_124;
  int local_120;
  undefined4 local_11c;
  short *local_118;
  undefined4 local_114;
  int local_110;
  undefined4 local_10c;
  short local_108 [128];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_1a0 = param_2;
  pvVar3 = GetCurrentProcess();
  local_194 = (uint)(param_3 == pvVar3);
  uVar6 = DAT_6b8b08a0;
  if (((DAT_6b8b08a0 | DAT_6b8b08a4) == 0) ||
     ((local_194 != 0 && ((*(byte *)(param_1 + 0x114) & 0x10) != 0)))) goto LAB_6b841a84;
  cVar2 = EtwEventEnabled(DAT_6b8b08a0,DAT_6b8b08a4,&DAT_6b8848e0);
  uVar6 = extraout_EDX;
  if (cVar2 == '\0') goto LAB_6b841a84;
  local_19c = 0;
  if (param_3 == (HANDLE)0x0) {
LAB_6b8418ae:
    if (param_4 == (short *)0x0) {
LAB_6b8418b2:
      param_4 = local_18c;
    }
  }
  else if (param_4 == (short *)0x0) {
    local_190 = 0x80;
    memset(local_108,0,0x100);
    if (local_194 == 0) {
      iVar4 = GetPackageFullName(param_3,&local_190,local_108);
    }
    else {
      iVar4 = GetCurrentPackageFullName(&local_190,local_108);
    }
    if (iVar4 == 0) {
      param_4 = local_108;
      goto LAB_6b8418ae;
    }
    goto LAB_6b8418b2;
  }
  if (param_5 == (short *)0x0) {
    param_5 = local_18c;
  }
  if (param_3 == (HANDLE)0x0) {
    local_198 = 0;
  }
  else {
    local_198 = GetProcessId(param_3);
  }
  local_1a4 = (uint)((*(byte *)(param_1 + 0x114) & 3) != 0);
  local_184 = 0;
  local_18c[0] = 0;
  local_188 = &local_198;
  local_180 = 4;
  local_170 = 4;
  local_178 = param_1 + 0x8a;
  local_17c = 0;
  local_174 = 0;
  local_16c = 0;
  psVar5 = param_1;
  do {
    sVar1 = *psVar5;
    psVar5 = psVar5 + 1;
  } while (sVar1 != 0);
  local_164 = 0;
  local_158 = param_1 + 0x94;
  local_15c = 0;
  local_160 = ((int)psVar5 - (int)(param_1 + 1) >> 1) * 2 + 2;
  psVar5 = local_158;
  do {
    sVar1 = *psVar5;
    psVar5 = psVar5 + 1;
  } while (sVar1 != (short)local_19c);
  local_154 = 0;
  local_14c = 0;
  local_144 = 0;
  local_150 = ((int)psVar5 - (int)(param_1 + 0x95) >> 1) * 2 + 2;
  local_13c = 0;
  local_134 = 0;
  local_148 = &local_1a0;
  local_140 = 1;
  local_130 = 1;
  local_138 = &local_1a4;
  local_12c = 0;
  psVar5 = param_4;
  do {
    sVar1 = *psVar5;
    psVar5 = psVar5 + 1;
  } while (sVar1 != 0);
  local_124 = 0;
  local_11c = 0;
  local_120 = ((int)psVar5 - (int)(param_4 + 1) >> 1) * 2 + 2;
  psVar5 = param_5;
  do {
    sVar1 = *psVar5;
    psVar5 = psVar5 + 1;
  } while (sVar1 != 0);
  local_118 = param_5;
  local_114 = 0;
  local_10c = 0;
  local_110 = ((int)psVar5 - (int)(param_5 + 1) >> 1) * 2 + 2;
  local_168 = param_1;
  local_128 = param_4;
  EtwEventWrite(DAT_6b8b08a0,DAT_6b8b08a4,&DAT_6b8848e0,8,&local_188);
  uVar6 = extraout_EDX_00;
  if (local_194 != 0) {
    *(uint *)(param_1 + 0x114) = *(uint *)(param_1 + 0x114) | 0x10;
  }
LAB_6b841a84:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar6);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint __fastcall
FUN_6b841a95(short *param_1,short *param_2,uint param_3,uint param_4,uint param_5,int param_6,
            uint param_7)

{
  int iVar1;
  uint uVar2;
  uint *puVar3;
  byte **ppbVar4;
  short *psVar5;
  int in_FS_OFFSET;
  bool bVar6;
  undefined4 local_18;
  short *local_14;
  short *local_10;
  short *local_c;
  uint *local_8;
  
  local_8 = (uint *)0x0;
  local_c = (short *)0x0;
  local_14 = param_2;
  local_10 = param_1;
  if ((DAT_6b8b08ac == 0) && (uVar2 = FUN_6b81fd2a(), (int)uVar2 < 0)) {
    uVar2 = uVar2 | 0x10000000;
  }
  else {
    uVar2 = 0;
    if (param_7 != 0) {
      do {
        local_c = (short *)FUN_6b81fd05(DAT_6b8b08ac,*(uint *)(param_6 + uVar2 * 8));
        if (local_c == (short *)0x0) {
          return 0x80070490;
        }
        if ((param_5 & *(uint *)(local_c + 0x86)) == 0) {
LAB_6b841b35:
          bVar6 = false;
        }
        else if (DAT_6b8b0238 == -1) {
          bVar6 = *(uint *)(local_c + 0x84) <= param_4;
          if ((bVar6 && param_4 != *(uint *)(local_c + 0x84)) ||
             ((bVar6 && (*(uint *)(local_c + 0x82) <= param_3)))) goto LAB_6b841b35;
          bVar6 = true;
        }
        else {
          bVar6 = DAT_6b8b0238 != 0;
        }
        iVar1 = uVar2 * 8;
        uVar2 = uVar2 + 1;
        **(undefined **)(param_6 + 4 + iVar1) = bVar6;
      } while (uVar2 < param_7);
    }
    if (_DAT_7ffe026a == 0) {
      psVar5 = (short *)0x14c;
    }
    else if (_DAT_7ffe026a == 5) {
      psVar5 = (short *)0x1c0;
    }
    else if (_DAT_7ffe026a == 9) {
      psVar5 = (short *)0x8664;
    }
    else {
      psVar5 = local_14;
      if (_DAT_7ffe026a == 0xc) {
        psVar5 = (short *)0xaa64;
      }
    }
    uVar2 = FUN_6b866bc5(&local_8,&local_18,local_10,param_3,param_4,(ushort)psVar5,0);
    puVar3 = local_8;
    if ((int)uVar2 < 0) {
      uVar2 = uVar2 | 0x10000000;
    }
    else if ((local_8 == (uint *)0x0) ||
            (uVar2 = FUN_6b841646(local_8,(uint)psVar5,param_6,param_7), -1 < (int)uVar2)) {
      psVar5 = local_c;
      if (param_7 != 0) {
        ppbVar4 = (byte **)(param_6 + 4);
        do {
          FUN_6b8417db(psVar5,(uint)**ppbVar4,(HANDLE)0x0,local_10,local_14);
          ppbVar4 = ppbVar4 + 2;
          param_7 = param_7 - 1;
          puVar3 = local_8;
        } while (param_7 != 0);
      }
      uVar2 = 0;
    }
    if (puVar3 != (uint *)0x0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar3);
    }
  }
  return uVar2;
}



uint __thiscall QuirkGetData2Worker(undefined4 this,wchar_t *param_2,int *param_3)

{
  uint uVar1;
  wchar_t *pwVar2;
  undefined4 extraout_ECX;
  
                    // 0x41c30  1116  QuirkGetData2Worker
  if (((param_2 == (wchar_t *)0x0) || (param_3 == (int *)0x0)) || (*param_3 != 0x208)) {
    uVar1 = 0x80070057;
  }
  else {
    if ((DAT_6b8b08ac == 0) && (uVar1 = FUN_6b81fd2a(), this = extraout_ECX, (int)uVar1 < 0)) {
      return uVar1 | 0x10000000;
    }
    pwVar2 = FUN_6b8422a7(this,param_2);
    if (pwVar2 == (wchar_t *)0x0) {
      uVar1 = 0x80070490;
    }
    else {
      param_3[1] = *(int *)(pwVar2 + 0x8a);
      uVar1 = FUN_6b812c57((short *)(param_3 + 2),0x80,(int)pwVar2);
      if ((-1 < (int)uVar1) &&
         (uVar1 = FUN_6b812c57((short *)(param_3 + 0x42),0x80,(int)(pwVar2 + 0x94)), -1 < (int)uVar1
         )) {
        uVar1 = 0;
      }
    }
  }
  return uVar1;
}



uint QuirkGetDataWorker(uint param_1,int *param_2)

{
  uint uVar1;
  int iVar2;
  
                    // 0x41ce0  1117  QuirkGetDataWorker
  if ((param_2 == (int *)0x0) || (*param_2 != 0x208)) {
    uVar1 = 0x80070057;
  }
  else if ((DAT_6b8b08ac == 0) && (uVar1 = FUN_6b81fd2a(), (int)uVar1 < 0)) {
    uVar1 = uVar1 | 0x10000000;
  }
  else {
    iVar2 = FUN_6b81fd05(DAT_6b8b08ac,param_1);
    if (iVar2 == 0) {
      uVar1 = 0x80070490;
    }
    else {
      param_2[1] = param_1;
      uVar1 = FUN_6b812c57((short *)(param_2 + 2),0x80,iVar2);
      if ((-1 < (int)uVar1) &&
         (uVar1 = FUN_6b812c57((short *)(param_2 + 0x42),0x80,iVar2 + 0x128), -1 < (int)uVar1)) {
        uVar1 = 0;
      }
    }
  }
  return uVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint QuirkIsEnabled2Worker(uint param_1,uint param_2,uint param_3)

{
  int iVar1;
  short *psVar2;
  uint uVar3;
  HANDLE pvVar4;
  uint uVar5;
  int in_FS_OFFSET;
  bool bVar6;
  short *psVar7;
  short *psVar8;
  
                    // 0x41d80  1118  QuirkIsEnabled2Worker
  uVar5 = 0;
  iVar1 = *(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x1e8);
  if (((((param_2 & param_3) != 0xffffffff) ||
       ((iVar1 != 0 && ((*(uint *)(iVar1 + 0x2d8) & 0x400) != 0)))) &&
      ((DAT_6b8b08ac != 0 || (iVar1 = FUN_6b81fd2a(), -1 < iVar1)))) &&
     (psVar2 = (short *)FUN_6b81fd05(DAT_6b8b08ac,param_1), psVar2 != (short *)0x0)) {
    FUN_6b81fceb(*(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x1e8));
    uVar5 = 1;
    uVar3 = _allshl();
    if ((uVar3 & *(uint *)(psVar2 + 0x86)) == 0) {
      uVar5 = 0;
    }
    else {
      if (DAT_6b8b0238 == -1) {
        if (((*(uint *)(psVar2 + 0x114) & 1) == 0) &&
           ((((*(uint *)(psVar2 + 0x114) & 2) != 0 ||
             (bVar6 = *(uint *)(psVar2 + 0x84) <= param_3,
             bVar6 && param_3 != *(uint *)(psVar2 + 0x84))) ||
            ((bVar6 && (*(uint *)(psVar2 + 0x82) <= param_2)))))) {
          uVar5 = 0;
        }
      }
      else {
        uVar5 = (uint)(DAT_6b8b0238 != 0);
      }
      if ((uVar5 != 0) && (((byte)*(uint *)(psVar2 + 0x114) & 0xc) == 4)) {
        *(uint *)(psVar2 + 0x114) = *(uint *)(psVar2 + 0x114) | 8;
      }
    }
    if (_DAT_6b8b0860 != 0) {
      psVar8 = (short *)0x0;
      psVar7 = (short *)0x0;
      pvVar4 = GetCurrentProcess();
      FUN_6b8417db(psVar2,uVar5,pvVar4,psVar7,psVar8);
    }
  }
  return uVar5;
}



uint QuirkIsEnabledForPackage2Worker
               (short *param_1,short *param_2,undefined4 param_3,uint param_4,uint param_5,
               uint *param_6)

{
  uint uVar1;
  
                    // 0x41eb0  1120  QuirkIsEnabledForPackage2Worker
  uVar1 = FUN_6b8417a0(param_1,param_2,param_3,param_4,param_5,0xffffffff,param_6);
  if (-1 < (int)uVar1) {
    uVar1 = 0;
  }
  return uVar1;
}



void QuirkIsEnabledForPackage3Worker
               (undefined4 param_1,short *param_2,short *param_3,undefined4 param_4,uint *param_5)

{
  uint uVar1;
  undefined4 local_10;
  byte *local_c;
  byte local_5;
  
                    // 0x41ee0  1121  QuirkIsEnabledForPackage3Worker
  local_10 = param_4;
  local_c = &local_5;
  uVar1 = QuirkIsEnabledForPackage4Worker(param_1,param_2,param_3,(int)&local_10,1);
  if (-1 < (int)uVar1) {
    *param_5 = (uint)local_5;
  }
  return;
}



uint QuirkIsEnabledForPackage4Worker
               (undefined4 param_1,short *param_2,short *param_3,int param_4,uint param_5)

{
  uint uVar1;
  uint local_10;
  uint local_c;
  undefined4 local_8;
  
                    // 0x41f20  1122  QuirkIsEnabledForPackage4Worker
  local_10 = 0;
  local_c = 0;
  local_8 = 0;
  uVar1 = FUN_6b8412c3(&local_10,&local_8,param_1,param_2);
  if (uVar1 == 0) {
    uVar1 = _allshl();
    uVar1 = FUN_6b841a95(param_2,param_3,local_10,local_c,uVar1,param_4,param_5);
    if (-1 < (int)uVar1) {
      uVar1 = 0;
    }
  }
  else if (0 < (int)uVar1) {
    uVar1 = uVar1 & 0xffff | 0x80070000;
  }
  return uVar1;
}



uint QuirkIsEnabledForPackageWorker(short *param_1,short *param_2,undefined4 param_3,uint *param_4)

{
  uint uVar1;
  uint local_10;
  uint local_c;
  undefined4 local_8;
  
                    // 0x41f90  1123  QuirkIsEnabledForPackageWorker
  local_10 = 0;
  local_c = 0;
  local_8 = 0;
  uVar1 = FUN_6b8412c3(&local_10,&local_8,0,param_1);
  if (uVar1 == 0) {
    uVar1 = _allshl();
    uVar1 = FUN_6b8417a0(param_1,param_2,param_3,local_10,local_c,uVar1,param_4);
    if (-1 < (int)uVar1) {
      uVar1 = 0;
    }
  }
  else if (0 < (int)uVar1) {
    uVar1 = uVar1 & 0xffff | 0x80070000;
  }
  return uVar1;
}



uint QuirkIsEnabledForProcessWorker(HANDLE param_1,uint param_2,uint *param_3)

{
  LPCVOID lpBaseAddress;
  uint uVar1;
  HANDLE hProcess;
  BOOL BVar2;
  short *psVar3;
  int extraout_ECX;
  LPVOID pvVar4;
  uint uVar5;
  uint uVar6;
  int in_FS_OFFSET;
  bool bVar7;
  undefined8 uVar8;
  int *Wow64Process;
  uint local_20;
  uint local_1c;
  LPVOID local_18;
  int local_10;
  int local_c;
  int local_8;
  
                    // 0x42000  1124  QuirkIsEnabledForProcessWorker
  uVar6 = 0;
  pvVar4 = (LPVOID)0x0;
  local_8 = 0;
  local_18 = (LPVOID)0x0;
  local_10 = 0;
  local_c = 0;
  if (param_1 == (HANDLE)0xffffffff) {
    uVar1 = QuirkIsEnabledWorker(param_2);
    *param_3 = uVar1;
    local_18 = pvVar4;
    goto LAB_6b84227d;
  }
  uVar6 = BaseReadAppCompatDataForProcess(param_1,&local_8,0);
  bVar7 = uVar6 == 0;
  if (bVar7) {
    lpBaseAddress = *(LPCVOID *)(local_8 + 0x1180);
    uVar6 = *(uint *)(local_8 + 0x1184);
    if (((uint)lpBaseAddress | uVar6) == 0) {
      if ((DAT_6b8b08ac == 0) && (uVar6 = FUN_6b81fd2a(), (int)uVar6 < 0)) {
LAB_6b8420fc:
        local_18 = pvVar4;
        uVar6 = uVar6 | 0x10000000;
        goto LAB_6b84227d;
      }
      psVar3 = (short *)FUN_6b81fd05(DAT_6b8b08ac,param_2);
      if (psVar3 == (short *)0x0) {
LAB_6b84212f:
        local_18 = pvVar4;
        uVar6 = 0x80070490;
        goto LAB_6b84227d;
      }
      FUN_6b81fceb(local_8);
      uVar8 = FUN_6b81fcd4(local_8);
      uVar1 = (uint)((ulonglong)uVar8 >> 0x20);
      local_20 = (uint)uVar8;
      uVar5 = 1;
      uVar6 = _allshl();
      if ((uVar6 & *(uint *)(psVar3 + 0x86)) != 0) {
        if (DAT_6b8b0238 == -1) {
          bVar7 = *(uint *)(psVar3 + 0x84) <= uVar1;
          if (bVar7 && uVar1 != *(uint *)(psVar3 + 0x84)) goto LAB_6b842263;
          if (bVar7) {
LAB_6b84225b:
            uVar5 = 1;
            if (*(uint *)(psVar3 + 0x82) <= local_20) goto LAB_6b842263;
          }
        }
        else {
LAB_6b842242:
          uVar5 = (uint)(DAT_6b8b0238 != 0);
        }
        goto LAB_6b842265;
      }
      goto LAB_6b842263;
    }
    local_18 = (LPVOID)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,
                                       *(undefined4 *)(local_8 + 0x1188));
    if (local_18 == (LPVOID)0x0) {
      uVar6 = 0x8007000e;
      goto LAB_6b84227d;
    }
    Wow64Process = &local_c;
    hProcess = GetCurrentProcess();
    BVar2 = IsWow64Process(hProcess,Wow64Process);
    pvVar4 = local_18;
    if ((BVar2 != 0) && (BVar2 = IsWow64Process(param_1,&local_10), BVar2 != 0)) {
      if ((local_c == 0) || (local_10 != 0)) {
        BVar2 = ReadProcessMemory(param_1,lpBaseAddress,local_18,*(SIZE_T *)(local_8 + 0x1188),
                                  (SIZE_T *)0x0);
        if (BVar2 == 0) goto LAB_6b8420b6;
      }
      else {
        uVar6 = NtWow64ReadVirtualMemory64
                          (param_1,lpBaseAddress,uVar6,local_18,*(undefined4 *)(local_8 + 0x1188),0,
                           0);
        if ((int)uVar6 < 0) goto LAB_6b8420fc;
      }
      psVar3 = (short *)FUN_6b81fd05((int)local_18,param_2);
      if (psVar3 == (short *)0x0) goto LAB_6b84212f;
      FUN_6b81fceb(local_8);
      uVar8 = FUN_6b81fcd4(extraout_ECX);
      uVar5 = 1;
      uVar6 = _allshl();
      local_1c = (uint)((ulonglong)uVar8 >> 0x20);
      local_20 = (uint)uVar8;
      if ((uVar6 & *(uint *)(psVar3 + 0x86)) == 0) {
LAB_6b842263:
        uVar5 = 0;
      }
      else {
        if (DAT_6b8b0238 != -1) goto LAB_6b842242;
        if ((*(uint *)(psVar3 + 0x114) & 1) == 0) {
          if (((*(uint *)(psVar3 + 0x114) & 2) != 0) ||
             (bVar7 = *(uint *)(psVar3 + 0x84) <= local_1c,
             bVar7 && local_1c != *(uint *)(psVar3 + 0x84))) goto LAB_6b842263;
          if (bVar7) goto LAB_6b84225b;
        }
      }
LAB_6b842265:
      *param_3 = uVar5;
      FUN_6b8417db(psVar3,uVar5,param_1,(short *)0x0,(short *)0x0);
      uVar6 = 0;
      goto LAB_6b84227d;
    }
LAB_6b8420b6:
    uVar6 = GetLastError();
    bVar7 = uVar6 == 0;
  }
  local_18 = pvVar4;
  if (!bVar7 && -1 < (int)uVar6) {
    uVar6 = uVar6 & 0xffff | 0x80070000;
  }
LAB_6b84227d:
  if (local_8 != 0) {
    BaseFreeAppCompatDataForProcess(local_8);
  }
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_18);
  return uVar6;
}



wchar_t * __fastcall FUN_6b8422a7(undefined4 param_1,wchar_t *param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  ushort uVar5;
  wchar_t *_Str1;
  bool bVar6;
  undefined local_1c [4];
  int local_18;
  wchar_t *local_14;
  int local_10;
  uint local_c;
  int local_8;
  
  iVar1 = DAT_6b8b08ac;
  local_14 = param_2;
  iVar2 = RtlInitUnicodeStringEx(local_1c,param_2);
  if ((((-1 < iVar2) && (iVar2 = RtlHashUnicodeString(local_1c,1,0,&local_8), -1 < iVar2)) &&
      (local_8 != 0)) && (uVar5 = 0, iVar2 = local_8, *(short *)(iVar1 + 2) != 0)) {
    do {
      iVar4 = (uint)uVar5 * 0x10;
      local_10 = *(int *)(iVar4 + 0x10 + iVar1) + iVar1;
      local_c = 0;
      bVar6 = *(short *)(iVar4 + 8 + iVar1) != 0;
      local_18 = iVar4;
      while (bVar6) {
        _Str1 = (wchar_t *)((local_c & 0xffff) * 0x22c + local_10);
        if ((*(int *)(_Str1 + 0x80) == iVar2) &&
           (iVar3 = _wcsicmp(_Str1,local_14), iVar4 = local_18, iVar2 = local_8, iVar3 == 0)) {
          return _Str1;
        }
        local_c = local_c + 1;
        bVar6 = (ushort)local_c < *(ushort *)(iVar4 + 8 + iVar1);
      }
      uVar5 = uVar5 + 1;
    } while (uVar5 < *(ushort *)(iVar1 + 2));
  }
  return (wchar_t *)0x0;
}



uint AdjustCalendarDate(uint *param_1,int param_2,int param_3)

{
  bool bVar1;
  int iVar2;
  uint uVar3;
  undefined3 extraout_var;
  undefined3 extraout_var_00;
  undefined3 extraout_var_01;
  undefined3 extraout_var_02;
  undefined local_c [8];
  
                    // 0x42370  24  AdjustCalendarDate
  iVar2 = IsValidCalDateTime(param_1,(int)local_c);
  if (iVar2 == 0) {
    return 0;
  }
  if (param_2 != 1) {
    if (param_2 != 2) {
      if (param_2 == 3) {
        param_3 = param_3 * 7;
      }
      else if (param_2 != 4) {
        return 0;
      }
      if (8 < *param_1) {
        if (*param_1 < 0xd) {
LAB_6b84243b:
          bVar1 = FUN_6b846b76(param_1,param_3);
          return CONCAT31(extraout_var_00,bVar1);
        }
        if (*param_1 == 0x16) {
          bVar1 = FUN_6b8490a7((int)param_1,param_3);
          return CONCAT31(extraout_var,bVar1);
        }
        if (*param_1 == 0x17) {
          uVar3 = FUN_6b847a7b(param_1,param_3);
          return uVar3;
        }
LAB_6b8423df:
        SetLastError(0x57);
        return 0;
      }
      if (*param_1 == 8) {
        uVar3 = FUN_6b8480ba((int *)param_1,param_3);
        return uVar3;
      }
      if (*param_1 == 0) goto LAB_6b8423df;
      if (*param_1 < 3) goto LAB_6b84243b;
      if (5 < *param_1) {
        if (*param_1 == 6) {
          uVar3 = FUN_6b84976a(param_1,param_3);
          return uVar3;
        }
        if (*param_1 != 7) goto LAB_6b8423df;
      }
      iVar2 = 4;
      goto LAB_6b8423fb;
    }
    if (8 < *param_1) {
      if (0xc < *param_1) {
        if (*param_1 == 0x16) {
          bVar1 = FUN_6b8490e9((int)param_1,param_3);
          return CONCAT31(extraout_var_01,bVar1);
        }
        if (*param_1 == 0x17) goto LAB_6b8424a5;
        goto LAB_6b8423df;
      }
      goto LAB_6b842531;
    }
    if (*param_1 == 8) {
      uVar3 = FUN_6b8480f7((int *)param_1,param_3);
      return uVar3;
    }
    if (*param_1 == 0) goto LAB_6b8423df;
    if (*param_1 < 3) goto LAB_6b842531;
    if (5 < *param_1) {
      if (*param_1 == 6) goto LAB_6b842474;
      if (*param_1 != 7) goto LAB_6b8423df;
    }
LAB_6b84246d:
    iVar2 = 2;
LAB_6b8423fb:
    uVar3 = FUN_6b8472f5(param_1,iVar2,param_3);
    return uVar3;
  }
  if (*param_1 < 9) {
    if (*param_1 == 8) {
      uVar3 = FUN_6b8481e1((int *)param_1,param_3);
      return uVar3;
    }
    if (*param_1 == 0) goto LAB_6b8423df;
    if (2 < *param_1) {
      if (5 < *param_1) {
        if (*param_1 == 6) {
          param_3 = param_3 * 0xc;
LAB_6b842474:
          uVar3 = FUN_6b8497a2((int)param_1,param_3);
          return uVar3;
        }
        if (*param_1 != 7) goto LAB_6b8423df;
      }
      param_3 = param_3 * 0xc;
      goto LAB_6b84246d;
    }
  }
  else if (0xc < *param_1) {
    if (*param_1 == 0x16) {
      bVar1 = FUN_6b84912b((int)param_1,param_3);
      return CONCAT31(extraout_var_02,bVar1);
    }
    if (*param_1 == 0x17) {
      param_3 = param_3 * 0xc;
LAB_6b8424a5:
      uVar3 = FUN_6b847ab8(param_1,param_3);
      return uVar3;
    }
    goto LAB_6b8423df;
  }
  param_3 = param_3 * 0xc;
LAB_6b842531:
  uVar3 = FUN_6b842544(param_1,param_3);
  return uVar3;
}



void __fastcall FUN_6b842544(uint *param_1,int param_2)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  int extraout_EDX;
  int extraout_EDX_00;
  int extraout_EDX_01;
  int extraout_EDX_02;
  uint local_3c;
  uint local_38;
  int local_34;
  uint local_30;
  uint local_2c;
  int local_28;
  uint local_24;
  uint local_20;
  uint local_18;
  uint local_14;
  uint local_10;
  uint local_c;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  if (param_1 != (uint *)0x0) {
    local_3c = param_1[2];
    uVar3 = param_1[4];
    iVar1 = param_1[3] + param_2;
    local_34 = iVar1 + -1;
    if (local_34 < 0) {
      local_34 = iVar1 + -0xc;
      local_38 = iVar1 % 0xc + 0xc;
    }
    else {
      local_38 = local_34 % 0xc + 1;
    }
    local_34 = local_34 / 0xc;
    uVar2 = GetCalendarDaysInMonth(*param_1,local_38,local_34 + local_3c,param_1[1]);
    if (uVar2 == 0) {
      SetLastError(0x120);
      param_2 = extraout_EDX;
    }
    else {
      local_20 = uVar3;
      if ((int)uVar2 < (int)uVar3) {
        local_20 = uVar2;
      }
      local_30 = *param_1;
      local_2c = param_1[1];
      local_28 = local_3c + local_34;
      local_24 = local_38;
      local_18 = param_1[6];
      local_14 = param_1[7];
      local_10 = param_1[8];
      local_c = param_1[9];
      uVar3 = UpdateCalendarDayOfWeek(&local_30);
      param_2 = extraout_EDX_00;
      if ((uVar3 != 0) &&
         (iVar1 = IsValidCalDateTime(&local_30,(int)&local_3c), param_2 = extraout_EDX_01,
         iVar1 != 0)) {
        FUN_6b84287b(param_1,&local_30);
        param_2 = extraout_EDX_02;
      }
    }
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



undefined4 CompareCalendarDates(uint *param_1,uint *param_2,undefined4 *param_3)

{
  uint uVar1;
  int iVar2;
  bool bVar3;
  undefined local_8 [4];
  
                    // 0x42650  156  CompareCalendarDates
  if (param_3 != (undefined4 *)0x0) {
    iVar2 = IsValidCalDateTime(param_1,(int)local_8);
    if (iVar2 == 0) {
      return 0;
    }
    iVar2 = IsValidCalDateTime(param_2,(int)local_8);
    if (iVar2 == 0) {
      return 0;
    }
    if (*param_1 == *param_2) {
      uVar1 = param_2[1];
      bVar3 = uVar1 <= param_1[1];
      if (bVar3 && param_1[1] != uVar1) {
LAB_6b8426bd:
        *param_3 = 1;
        return 1;
      }
      if (bVar3) {
        uVar1 = param_2[2];
        bVar3 = uVar1 <= param_1[2];
        if (bVar3 && param_1[2] != uVar1) goto LAB_6b8426bd;
        if (bVar3) {
          uVar1 = param_2[3];
          bVar3 = uVar1 <= param_1[3];
          if (bVar3 && param_1[3] != uVar1) goto LAB_6b8426bd;
          if (bVar3) {
            uVar1 = param_2[4];
            bVar3 = uVar1 <= param_1[4];
            if (bVar3 && param_1[4] != uVar1) goto LAB_6b8426bd;
            if (bVar3) {
              *param_3 = 0;
              return 1;
            }
          }
        }
      }
      *param_3 = 0xffffffff;
      return 1;
    }
  }
  SetLastError(0x57);
  return 0;
}



undefined4 ConvertCalDateTimeToSystemTime(uint *param_1,undefined2 *param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined local_34 [4];
  uint local_30 [11];
  
                    // 0x426e0  165  ConvertCalDateTimeToSystemTime
  if ((param_2 != (undefined2 *)0x0) &&
     (iVar1 = IsValidCalDateTime(param_1,(int)local_34), iVar1 != 0)) {
    if (*param_1 < 9) {
      if (*param_1 == 8) {
        uVar2 = FUN_6b848260((int *)param_1,param_2);
        return uVar2;
      }
      if (*param_1 != 0) {
        if (2 < *param_1) {
          if (5 < *param_1) {
            if (*param_1 == 6) {
              uVar2 = FUN_6b849860((int)param_1,param_2);
              return uVar2;
            }
            if (*param_1 != 7) goto LAB_6b842726;
          }
          iVar1 = FUN_6b847376(local_30,param_1);
          if (iVar1 == 0) {
            return 0;
          }
          param_1 = local_30;
        }
LAB_6b84278a:
        uVar2 = FUN_6b846bef((int)param_1,param_2);
        return uVar2;
      }
    }
    else {
      if (*param_1 < 0xd) goto LAB_6b84278a;
      if (*param_1 == 0x16) {
        uVar2 = FUN_6b84916d((int)param_1,param_2);
        return uVar2;
      }
      if (*param_1 == 0x17) {
        uVar2 = FUN_6b847b96(param_1,param_2);
        return uVar2;
      }
    }
  }
LAB_6b842726:
  SetLastError(0x57);
  return 0;
}



uint ConvertNLSDayOfWeekToWin32DayOfWeek(uint param_1)

{
  uint uVar1;
  
                    // 0x427a0  168  ConvertNLSDayOfWeekToWin32DayOfWeek
  if (param_1 < 7) {
    uVar1 = -(uint)(param_1 != 6) & param_1 + 1;
  }
  else {
    SetLastError(0x57);
    uVar1 = 0xffffffff;
  }
  return uVar1;
}



undefined4 ConvertSystemTimeToCalDateTime(ushort *param_1,uint param_2,uint *param_3)

{
  int iVar1;
  undefined4 uVar2;
  uint extraout_EDX;
  
                    // 0x427d0  169  ConvertSystemTimeToCalDateTime
  if (((param_3 != (uint *)0x0) && (param_1 != (ushort *)0x0)) &&
     (iVar1 = FUN_6b843549(param_2), iVar1 != 0)) {
    *param_3 = extraout_EDX;
    if (extraout_EDX < 9) {
      if (extraout_EDX == 8) {
        uVar2 = FUN_6b84829d(param_1,(int *)param_3);
        return uVar2;
      }
      if (extraout_EDX != 0) {
        if (2 < extraout_EDX) {
          if (5 < extraout_EDX) {
            if (extraout_EDX == 6) {
              uVar2 = FUN_6b8498af(param_1,param_3,0);
              return uVar2;
            }
            if (extraout_EDX != 7) goto LAB_6b842817;
          }
          uVar2 = FUN_6b8473a6(param_1,param_3);
          return uVar2;
        }
LAB_6b842871:
        uVar2 = FUN_6b846c58(param_1,extraout_EDX,param_3);
        return uVar2;
      }
    }
    else {
      if (extraout_EDX < 0xd) goto LAB_6b842871;
      if (extraout_EDX == 0x16) {
        uVar2 = FUN_6b84924b(param_1,(int)param_3);
        return uVar2;
      }
      if (extraout_EDX == 0x17) {
        uVar2 = FUN_6b847b5b(param_1,param_3);
        return uVar2;
      }
    }
  }
LAB_6b842817:
  SetLastError(0x57);
  return 0;
}



undefined4 __fastcall FUN_6b84287b(undefined4 *param_1,undefined4 *param_2)

{
  int iVar1;
  
  if ((param_1 != (undefined4 *)0x0) && (param_2 != (undefined4 *)0x0)) {
    for (iVar1 = 10; iVar1 != 0; iVar1 = iVar1 + -1) {
      *param_1 = *param_2;
      param_2 = param_2 + 1;
      param_1 = param_1 + 1;
    }
    return 1;
  }
  return 0;
}



void GetCalendarDateFormat
               (LCID param_1,uint param_2,uint *param_3,ushort *param_4,short *param_5,int param_6)

{
  int iVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar2;
  WCHAR local_b4 [86];
  uint local_8;
  
                    // 0x428a0  459  GetCalendarDateFormat
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  iVar1 = LCIDToLocaleName(param_1,local_b4,0x55,0);
  uVar2 = extraout_EDX;
  if (iVar1 != 0) {
    GetCalendarDateFormatEx(local_b4,param_2,param_3,param_4,param_5,param_6);
    uVar2 = extraout_EDX_00;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



void GetCalendarDateFormatEx
               (undefined4 param_1,uint param_2,uint *param_3,ushort *param_4,short *param_5,
               int param_6)

{
  bool bVar1;
  int iVar2;
  undefined3 extraout_var;
  uint uVar3;
  int iVar4;
  uint uVar5;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar6;
  short *psVar7;
  undefined8 uVar8;
  DWORD dwErrCode;
  int local_2c8;
  ushort local_2c4 [2];
  int local_2c0;
  ushort *local_2bc;
  ushort local_2b8;
  undefined2 local_2b6;
  undefined2 local_2b4;
  undefined2 local_2b2;
  undefined4 local_2b0;
  undefined4 local_2ac;
  ushort local_2a8 [256];
  ushort local_a8 [80];
  uint local_8;
  
                    // 0x42910  460  GetCalendarDateFormatEx
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_2c8 = 0;
  iVar2 = IsValidCalDateTime(param_3,(int)&local_2c0);
  uVar6 = extraout_EDX;
  if (iVar2 == 0) goto LAB_6b842bcd;
  if (*param_3 == 8) {
    bVar1 = FUN_6b8487a1(param_3[2],param_3[1]);
    local_2c8 = CONCAT31(extraout_var,bVar1);
  }
  local_2bc = (ushort *)GetNamedLocaleHashNode();
  if ((((local_2bc == (ushort *)0x0) || (param_6 < 0)) ||
      ((param_5 == (short *)0x0 && (param_6 != 0)))) ||
     (((param_4 != (ushort *)0x0 && (iVar2 = FUN_6b8502c0((short *)param_4), 0xff < iVar2)) ||
      (uVar3 = FUN_6b812d49((uint)local_2bc,*param_3), (short)uVar3 == 0)))) {
LAB_6b842bc3:
    dwErrCode = 0x57;
  }
  else if (((byte)(1U - ((param_2 & 0x3fffffc4) != 0) &
                  1U - ((((byte)param_2 & 0xf0) - 1 & (byte)param_2 & 0x70) != 0)) == 0) ||
          ((param_4 != (ushort *)0x0 && ((param_2 & 0x8000000b) != 0)))) {
LAB_6b842bbc:
    dwErrCode = 0x3ec;
  }
  else {
    iVar2 = GetCalendar(local_2bc,*param_3);
    local_2c0 = iVar2;
    if (iVar2 == 0) goto LAB_6b842bc3;
    if (param_4 == (ushort *)0x0) {
      uVar3 = param_2 & 0xb;
      if (uVar3 < 2) {
        iVar4 = KernelBaseGetGlobalData();
        psVar7 = *(short **)(iVar4 + 0x30);
        if (*(int *)(iVar2 + 4) != 0) {
          psVar7 = psVar7 + *(int *)(psVar7 + *(int *)(iVar2 + 4) + 1);
        }
        uVar3 = 0x1f;
      }
      else if (uVar3 == 2) {
        iVar4 = KernelBaseGetGlobalData();
        psVar7 = *(short **)(iVar4 + 0x30);
        if (*(int *)(iVar2 + 0xc) != 0) {
          psVar7 = psVar7 + *(int *)(psVar7 + *(int *)(iVar2 + 0xc) + 1);
        }
        uVar3 = 0x20;
      }
      else {
        if (uVar3 != 8) goto LAB_6b842bbc;
        iVar4 = KernelBaseGetGlobalData();
        psVar7 = *(short **)(iVar4 + 0x30);
        if (*(int *)(iVar2 + 8) != 0) {
          psVar7 = psVar7 + *(int *)(psVar7 + *(int *)(iVar2 + 8) + 1);
        }
        uVar3 = 0x1006;
      }
      iVar2 = GetUserOverrideWord(local_2bc,0x4d8,0,local_2c4);
      if (iVar2 == 0) {
        uVar5 = 0;
      }
      else {
        uVar5 = FUN_6b812d49((uint)local_2bc,(uint)local_2c4[0]);
        uVar5 = uVar5 & 0xffff;
      }
      if (((int)param_2 < 0) || (*param_3 != uVar5)) {
        if (*psVar7 != 0) {
          param_4 = (ushort *)(psVar7 + 1);
          goto LAB_6b842b2a;
        }
        uVar3 = uVar3 | 0x80000000;
      }
      else {
        uVar3 = uVar5 << 0x10 | uVar3;
      }
      GetLocaleInfoHelper(local_2bc,uVar3,local_a8,0x50);
      param_4 = local_a8;
    }
LAB_6b842b2a:
    local_2b8 = *(ushort *)(param_3 + 2);
    local_2b6 = *(undefined2 *)(param_3 + 3);
    local_2b4 = *(undefined2 *)(param_3 + 5);
    local_2b2 = *(undefined2 *)(param_3 + 4);
    local_2b0 = 0;
    local_2ac = 0;
    uVar3 = FUN_6b812372(local_2bc,param_2,&local_2b8,param_4,local_2a8,*param_3,local_2c0,0,
                         param_3[1],local_2c8);
    if (param_6 < (int)uVar3) {
      dwErrCode = 0x7a;
    }
    else {
      if (uVar3 == 0) goto LAB_6b842bc3;
      uVar8 = FUN_6b812c57(param_5,uVar3,(int)local_2a8);
      uVar6 = (undefined4)((ulonglong)uVar8 >> 0x20);
      if (-1 < (int)uVar8) goto LAB_6b842bcd;
      dwErrCode = 0xe;
    }
  }
  SetLastError(dwErrCode);
  uVar6 = extraout_EDX_00;
LAB_6b842bcd:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar6);
  return;
}



int __fastcall FUN_6b842bde(uint *param_1)

{
  int iVar1;
  uint *puVar2;
  uint *puVar3;
  uint local_2c [4];
  undefined4 local_1c;
  
  if (param_1 != (uint *)0x0) {
    if (*param_1 < 9) {
      if (*param_1 == 8) {
        iVar1 = FUN_6b84834a((int *)param_1);
        return iVar1;
      }
      if (*param_1 != 0) {
        if (2 < *param_1) {
          if (5 < *param_1) {
            if (*param_1 == 6) {
              iVar1 = FUN_6b849a7d(param_1);
              return iVar1;
            }
            if (*param_1 != 7) goto LAB_6b842c0e;
          }
          iVar1 = FUN_6b847484(param_1);
          return iVar1;
        }
LAB_6b842c67:
        iVar1 = FUN_6b846d60((int)param_1);
        return iVar1;
      }
    }
    else {
      if (*param_1 < 0xd) goto LAB_6b842c67;
      if (*param_1 == 0x16) {
        puVar2 = param_1;
        puVar3 = local_2c;
        for (iVar1 = 10; iVar1 != 0; iVar1 = iVar1 + -1) {
          *puVar3 = *puVar2;
          puVar2 = puVar2 + 1;
          puVar3 = puVar3 + 1;
        }
        local_2c[3] = 1;
        local_1c = 1;
        iVar1 = FUN_6b8493a6((int)local_2c,(int)param_1);
        return iVar1 + 1;
      }
      if (*param_1 == 0x17) {
        iVar1 = FUN_6b847bd3(param_1);
        return iVar1;
      }
    }
  }
LAB_6b842c0e:
  SetLastError(0x57);
  return 0;
}



uint GetCalendarDaysInMonth(uint param_1,uint param_2,uint param_3,uint param_4)

{
  uint uVar1;
  
                    // 0x42c80  461  GetCalendarDaysInMonth
  if (param_1 < 9) {
    if (param_1 == 8) {
      uVar1 = FUN_6b84839a(param_2,param_3,param_4);
      return uVar1;
    }
    if (param_1 != 0) {
      if (2 < param_1) {
        if (5 < param_1) {
          if (param_1 == 6) {
            uVar1 = FUN_6b849ac1(param_2,param_3,param_4);
            return uVar1;
          }
          if (param_1 != 7) goto LAB_6b842cab;
        }
        uVar1 = FUN_6b8474a6(param_1,param_2,param_3,param_4);
        return uVar1;
      }
LAB_6b842d16:
      uVar1 = FUN_6b846d8b(param_2,param_3,param_4);
      return uVar1;
    }
  }
  else {
    if (param_1 < 0xd) goto LAB_6b842d16;
    if (param_1 == 0x16) {
      uVar1 = FUN_6b849304(param_2,param_3,param_4);
      return uVar1;
    }
    if (param_1 == 0x17) {
      uVar1 = FUN_6b847c2b(param_2,param_3,param_4);
      return uVar1;
    }
  }
LAB_6b842cab:
  SetLastError(0x57);
  return 0;
}



int __fastcall FUN_6b842d2e(uint param_1,uint param_2,uint param_3)

{
  bool bVar1;
  undefined3 extraout_var;
  int iVar2;
  
  if (param_1 < 9) {
    if (param_1 == 8) {
      iVar2 = FUN_6b8488b1(param_2,param_3);
      if (iVar2 == 0) {
        return 0;
      }
      return (-(uint)(GuardCFFunctionTable[0x2a5].Pad[param_2 * 2 + -2] < 4) & 0xffffffe5) + 0x17b +
             (uint)GuardCFFunctionTable[0x2a5].Pad[param_2 * 2 + -2];
    }
    if (param_1 != 0) {
      if (2 < param_1) {
        if (5 < param_1) {
          if (param_1 == 6) {
            iVar2 = FUN_6b849ce3(param_2,param_3);
            if (iVar2 == 0) {
              return 0;
            }
            bVar1 = FUN_6b849bcd(param_2,1);
            return (CONCAT31(extraout_var,bVar1) != 0) + 0x162;
          }
          if (param_1 != 7) goto LAB_6b842d5d;
        }
        iVar2 = FUN_6b8474e3(param_1,param_2,param_3);
        return iVar2;
      }
LAB_6b842df4:
      iVar2 = FUN_6b846de7(param_2,param_3);
      return iVar2;
    }
  }
  else {
    if (param_1 < 0xd) goto LAB_6b842df4;
    if (param_1 == 0x16) {
      iVar2 = FUN_6b849354(param_2,param_3);
      return iVar2;
    }
    if (param_1 == 0x17) {
      iVar2 = FUN_6b847f48(param_2,param_3);
      if (iVar2 == 0) {
        return 0;
      }
      iVar2 = FUN_6b847c63(param_2);
      return iVar2;
    }
  }
LAB_6b842d5d:
  SetLastError(0x57);
  return 0;
}



undefined4 GetCalendarDifferenceInDays(uint *param_1,uint *param_2,int *param_3)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  undefined local_c [8];
  
                    // 0x42e10  462  GetCalendarDifferenceInDays
  if (param_3 == (int *)0x0) {
LAB_6b842e6c:
    SetLastError(0x57);
    return 0;
  }
  iVar2 = IsValidCalDateTime(param_1,(int)local_c);
  if (iVar2 == 0) {
    return 0;
  }
  iVar2 = IsValidCalDateTime(param_2,(int)local_c);
  if (iVar2 == 0) {
    return 0;
  }
  uVar1 = *param_1;
  if (uVar1 != *param_2) goto LAB_6b842e6c;
  if (uVar1 < 9) {
    if (uVar1 == 8) {
      iVar3 = FUN_6b84860e((int *)param_1);
      iVar2 = FUN_6b84860e((int *)param_2);
LAB_6b842e8f:
      iVar2 = iVar2 - iVar3;
      goto LAB_6b842ee5;
    }
    if (uVar1 == 0) goto LAB_6b842e6c;
    if (2 < uVar1) {
      if (5 < uVar1) {
        if (uVar1 == 6) {
          iVar3 = FUN_6b849b5c((int)param_1);
          iVar2 = FUN_6b849b5c((int)param_2);
          goto LAB_6b842e8f;
        }
        if (uVar1 != 7) goto LAB_6b842e6c;
      }
      iVar2 = FUN_6b847513(param_1,param_2);
      goto LAB_6b842ee5;
    }
  }
  else if (0xc < uVar1) {
    if (uVar1 == 0x16) {
      iVar2 = FUN_6b8493a6((int)param_1,(int)param_2);
      goto LAB_6b842ee5;
    }
    if (uVar1 != 0x17) goto LAB_6b842e6c;
    iVar3 = FUN_6b847f6f(param_1);
    iVar2 = FUN_6b847f6f(param_2);
    goto LAB_6b842e8f;
  }
  iVar2 = FUN_6b846e0f((int)param_1,(int)param_2);
LAB_6b842ee5:
  *param_3 = iVar2;
  return 1;
}



uint GetCalendarMonthsInYear(uint param_1,uint param_2,uint param_3)

{
  char cVar1;
  int iVar2;
  uint uVar3;
  undefined3 extraout_var;
  
                    // 0x42f00  466  GetCalendarMonthsInYear
  iVar2 = FUN_6b843549(param_1);
  if (iVar2 == 0) {
    SetLastError(0x57);
    return 0;
  }
  if (param_1 < 9) {
    if (param_1 == 8) {
      cVar1 = FUN_6b8483ca(param_2,param_3);
      return CONCAT31(extraout_var,cVar1);
    }
    if (param_1 == 0) {
      return 0;
    }
    if (2 < param_1) {
      if (5 < param_1) {
        if (param_1 == 6) {
          uVar3 = FUN_6b849ce3(param_2,param_3);
          goto LAB_6b842fa4;
        }
        if (param_1 != 7) {
          return 0;
        }
      }
      uVar3 = FUN_6b8477ee(param_1,10,10,param_2,param_3);
      goto LAB_6b842fa4;
    }
  }
  else if (0xc < param_1) {
    if (param_1 == 0x16) {
      uVar3 = FUN_6b849406(param_2,param_3);
      return uVar3;
    }
    if (param_1 != 0x17) {
      return 0;
    }
    uVar3 = FUN_6b847f48(param_2,param_3);
    goto LAB_6b842fa4;
  }
  uVar3 = FUN_6b8472ad(param_2,param_3);
LAB_6b842fa4:
  return -(uint)(uVar3 != 0) & 0xc;
}



undefined4 GetCalendarSupportedDateRange(uint param_1,uint *param_2,int param_3)

{
  int iVar1;
  undefined4 uVar2;
  uint *extraout_EDX;
  
                    // 0x42fc0  467  GetCalendarSupportedDateRange
  if (((param_2 == (uint *)0x0) || (param_3 == 0)) || (iVar1 = FUN_6b843549(param_1), iVar1 == 0)) {
    SetLastError(0x57);
    return 0;
  }
  *param_2 = param_1;
  *extraout_EDX = param_1;
  if (param_1 < 9) {
    if (param_1 == 8) {
      uVar2 = FUN_6b8483f4((int)param_2,(int)extraout_EDX);
      return uVar2;
    }
    if (param_1 == 0) {
      return 0;
    }
    if (2 < param_1) {
      if (5 < param_1) {
        if (param_1 == 6) {
          uVar2 = FUN_6b849afe((int)param_2,(int)extraout_EDX);
          return uVar2;
        }
        if (param_1 != 7) {
          return 0;
        }
      }
      uVar2 = FUN_6b847540(param_1,(int)param_2,(int)extraout_EDX);
      return uVar2;
    }
  }
  else if (0xc < param_1) {
    if (param_1 == 0x16) {
      uVar2 = FUN_6b849449((int)param_2,(int)extraout_EDX);
      return uVar2;
    }
    if (param_1 != 0x17) {
      return 0;
    }
    uVar2 = FUN_6b847c9b((int)param_2,(int)extraout_EDX);
    return uVar2;
  }
  uVar2 = FUN_6b846f5e((int)param_2,(int)extraout_EDX);
  return uVar2;
}



undefined4 GetCalendarWeekNumber(uint *param_1,uint param_2,uint param_3,int *param_4)

{
  uint uVar1;
  int iVar2;
  undefined local_c [8];
  
                    // 0x43070  468  GetCalendarWeekNumber
  if (((param_2 < 7) && (param_3 < 3)) && (param_4 != (int *)0x0)) {
    iVar2 = IsValidCalDateTime(param_1,(int)local_c);
    if (iVar2 != 0) {
      if (param_3 == 0) {
        iVar2 = FUN_6b843118(param_1,param_2);
      }
      else {
        uVar1 = *param_1;
        if ((uVar1 == 0) || (((5 < uVar1 && (uVar1 != 7)) && (3 < uVar1 - 9)))) {
          if (param_3 == 1) {
            iVar2 = 7;
          }
          else {
            iVar2 = 4;
          }
          iVar2 = FUN_6b8431e1(param_1,param_2,iVar2);
        }
        else {
          if (param_3 == 1) {
            iVar2 = 7;
          }
          else {
            iVar2 = 4;
          }
          iVar2 = FUN_6b846fbb(param_1,param_2,iVar2);
        }
      }
      *param_4 = iVar2;
      return 1;
    }
  }
  else {
    SetLastError(0x57);
  }
  return 0;
}



int __fastcall FUN_6b843118(uint *param_1,int param_2)

{
  int iVar1;
  uint uVar2;
  
  iVar1 = FUN_6b842bde(param_1);
  uVar2 = UpdateCalendarDayOfWeek(param_1);
  if (uVar2 == 0) {
    iVar1 = 0;
  }
  else {
    iVar1 = ((iVar1 - 1U) + (((param_1[5] - (iVar1 - 1U) % 7) - param_2) + 0xe) % 7) / 7 + 1;
  }
  return iVar1;
}



undefined4 __fastcall FUN_6b84315a(undefined4 param_1)

{
  void *this;
  undefined local_24 [8];
  undefined4 local_1c;
  int local_10;
  
  switch(param_1) {
  case 1:
  case 2:
  case 4:
  case 5:
  case 6:
  case 7:
  case 9:
  case 10:
  case 0xb:
  case 0xc:
    return 1;
  case 3:
    return 0x74c;
  case 8:
    return 0x14df;
  default:
    SetLastError(0x57);
    return 0;
  case 0x16:
    FUN_6b8489c1(local_24);
    FUN_6b84b191(this,local_10);
    return local_1c;
  case 0x17:
    return 0x526;
  }
}



void __thiscall FUN_6b8431e1(void *this,int param_1,int param_2)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  int extraout_EDX;
  int extraout_EDX_00;
  uint local_30 [10];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  iVar1 = FUN_6b842bde((uint *)this);
  uVar2 = iVar1 - 1;
  UpdateCalendarDayOfWeek((uint *)this);
  uVar3 = (uint)(param_1 + 0xe + ((int)uVar2 % 7 - *(int *)((int)this + 0x14))) % 7;
  if ((uVar3 != 0) && (param_2 <= (int)uVar3)) {
    uVar3 = uVar3 - 7;
  }
  if ((int)(uVar2 - uVar3) < 0) {
    FUN_6b84287b(local_30,(undefined4 *)this);
    uVar2 = AdjustCalendarDate(local_30,4,~uVar2);
    iVar1 = extraout_EDX;
    if (uVar2 != 0) {
      FUN_6b8431e1(local_30,param_1,param_2);
      iVar1 = extraout_EDX_00;
    }
  }
  else {
    iVar1 = (int)(uVar2 - uVar3) % 7;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,iVar1);
  return;
}



int IsCalendarLeapDay(uint param_1,uint param_2,uint param_3,uint param_4,uint param_5)

{
  int iVar1;
  DWORD dwErrCode;
  
                    // 0x43280  895  IsCalendarLeapDay
  if (param_1 < 9) {
    if (param_1 == 8) {
      iVar1 = FUN_6b84870a(param_2,param_3,param_4,param_5);
      return iVar1;
    }
    if (param_1 != 0) {
      if (param_1 < 3) goto LAB_6b84332d;
      if (param_1 < 6) {
LAB_6b8432c2:
        iVar1 = FUN_6b84774d(param_1,param_2,param_3,param_4,param_5);
        return iVar1;
      }
      if (param_1 == 6) {
        iVar1 = FUN_6b849b86(param_2,param_3,param_4,param_5);
        return iVar1;
      }
      if (param_1 == 7) goto LAB_6b8432c2;
    }
  }
  else {
    if (param_1 < 0xd) {
LAB_6b84332d:
      iVar1 = FUN_6b84709f(param_2,param_3,param_4,param_5);
      return iVar1;
    }
    if (param_1 == 0x16) {
      iVar1 = FUN_6b8494b0(param_2,param_3,param_4,param_5);
      return iVar1;
    }
    if (param_1 == 0x17) {
      iVar1 = FUN_6b847edc(param_2,param_3,param_4,param_5);
      if (iVar1 == 0) {
        return 0;
      }
      dwErrCode = 0;
      goto LAB_6b843310;
    }
  }
  dwErrCode = 0x57;
LAB_6b843310:
  SetLastError(dwErrCode);
  return 0;
}



int IsCalendarLeapMonth(uint param_1,uint param_2,uint param_3,uint param_4)

{
  int iVar1;
  DWORD dwErrCode;
  
                    // 0x43350  896  IsCalendarLeapMonth
  if (param_1 < 9) {
    if (param_1 == 8) {
      iVar1 = FUN_6b848763(param_2,param_3,param_4);
      return iVar1;
    }
    if (param_1 != 0) {
      if (param_1 < 3) goto LAB_6b8433ee;
      if (param_1 < 6) {
LAB_6b84338f:
        iVar1 = FUN_6b84778e(param_1,param_2,param_3,param_4);
        return iVar1;
      }
      if (param_1 == 6) {
        iVar1 = FUN_6b849c99(param_2,param_3,param_4);
        goto LAB_6b8433ce;
      }
      if (param_1 == 7) goto LAB_6b84338f;
    }
  }
  else {
    if (param_1 < 0xd) {
LAB_6b8433ee:
      iVar1 = FUN_6b847127(param_2,param_3,param_4);
      return iVar1;
    }
    if (param_1 == 0x16) {
      iVar1 = FUN_6b849527(param_2,param_3,param_4);
      return iVar1;
    }
    if (param_1 == 0x17) {
      iVar1 = FUN_6b847f14(param_2,param_3,param_4);
LAB_6b8433ce:
      if (iVar1 == 0) {
        return 0;
      }
      dwErrCode = 0;
      goto LAB_6b8433d4;
    }
  }
  dwErrCode = 0x57;
LAB_6b8433d4:
  SetLastError(dwErrCode);
  return 0;
}



uint IsCalendarLeapYear(uint param_1,uint param_2,uint param_3)

{
  bool bVar1;
  undefined3 extraout_var;
  uint uVar2;
  undefined3 extraout_var_00;
  undefined3 extraout_var_01;
  undefined3 extraout_var_02;
  
                    // 0x43410  897  IsCalendarLeapYear
  if (param_1 < 9) {
    if (param_1 == 8) {
      bVar1 = FUN_6b8487a1(param_2,param_3);
      return CONCAT31(extraout_var_00,bVar1);
    }
    if (param_1 != 0) {
      if (2 < param_1) {
        if (5 < param_1) {
          if (param_1 == 6) {
            bVar1 = FUN_6b849bcd(param_2,param_3);
            return CONCAT31(extraout_var,bVar1);
          }
          if (param_1 != 7) goto LAB_6b843437;
        }
        uVar2 = FUN_6b8477b5(param_1,param_2,param_3);
        return uVar2;
      }
LAB_6b843495:
      uVar2 = FUN_6b84715a(param_2,param_3);
      return uVar2;
    }
  }
  else {
    if (param_1 < 0xd) goto LAB_6b843495;
    if (param_1 == 0x16) {
      bVar1 = FUN_6b84956d(param_2,param_3);
      return CONCAT31(extraout_var_02,bVar1);
    }
    if (param_1 == 0x17) {
      bVar1 = FUN_6b847e46(param_2,param_3);
      return CONCAT31(extraout_var_01,bVar1);
    }
  }
LAB_6b843437:
  SetLastError(0x57);
  return 0;
}



undefined4 IsValidCalDateTime(uint *param_1,int param_2)

{
  undefined4 uVar1;
  
                    // 0x434b0  912  IsValidCalDateTime
  if ((param_1 == (uint *)0x0) || (param_2 == 0)) {
    SetLastError(0x57);
    return 0;
  }
  if (*param_1 < 9) {
    if (*param_1 == 8) {
      uVar1 = FUN_6b8487cd(param_1,1);
      return uVar1;
    }
    if (*param_1 != 0) {
      if (2 < *param_1) {
        if (5 < *param_1) {
          if (*param_1 == 6) {
            uVar1 = FUN_6b849bfb((int)param_1,1);
            return uVar1;
          }
          if (*param_1 != 7) goto LAB_6b8434e7;
        }
        uVar1 = FUN_6b847887(param_1,1);
        return uVar1;
      }
LAB_6b84352b:
      uVar1 = FUN_6b84719b((int)param_1,1);
      return uVar1;
    }
  }
  else {
    if (*param_1 < 0xd) goto LAB_6b84352b;
    if (*param_1 == 0x16) {
      uVar1 = FUN_6b8495b9((int)param_1);
      return uVar1;
    }
    if (*param_1 == 0x17) {
      uVar1 = FUN_6b847e71(param_1,1);
      return uVar1;
    }
  }
LAB_6b8434e7:
  SetLastError(0x57);
  return 0;
}



undefined4 __fastcall FUN_6b843549(uint param_1)

{
  undefined4 uVar1;
  
  if ((param_1 == 0) || ((uVar1 = 1, 0xc < param_1 && (1 < param_1 - 0x16)))) {
    uVar1 = 0;
  }
  return uVar1;
}



uint UpdateCalendarDayOfWeek(uint *param_1)

{
  bool bVar1;
  uint uVar2;
  undefined3 extraout_var;
  undefined3 extraout_var_00;
  
                    // 0x43570  1471  UpdateCalendarDayOfWeek
  if (param_1 == (uint *)0x0) {
    SetLastError(0x57);
    return 0;
  }
  if (*param_1 < 9) {
    if (*param_1 == 8) {
      uVar2 = FUN_6b8488d8((int *)param_1);
      return uVar2;
    }
    if (*param_1 != 0) {
      if (2 < *param_1) {
        if (5 < *param_1) {
          if (*param_1 == 6) {
            uVar2 = FUN_6b849d05((int)param_1);
            return uVar2;
          }
          if (*param_1 != 7) goto LAB_6b8435ae;
        }
        bVar1 = FUN_6b847986(param_1);
        return CONCAT31(extraout_var,bVar1);
      }
LAB_6b8435ea:
      uVar2 = FUN_6b8472cf((int)param_1);
      return uVar2;
    }
  }
  else {
    if (*param_1 < 0xd) goto LAB_6b8435ea;
    if (*param_1 == 0x16) {
      bVar1 = FUN_6b84960d((int)param_1);
      return CONCAT31(extraout_var_00,bVar1);
    }
    if (*param_1 == 0x17) {
      uVar2 = FUN_6b84804c(param_1);
      return uVar2;
    }
  }
LAB_6b8435ae:
  SetLastError(0x57);
  return 0;
}



BOOL EnumCalendarInfoExA(CALINFO_ENUMPROCEXA lpCalInfoEnumProcEx,LCID Locale,CALID Calendar,
                        CALTYPE CalType)

{
  undefined4 uVar1;
  BOOL BVar2;
  
                    // 0x43600  314  EnumCalendarInfoExA
  uVar1 = NlsValidateLocale(&Locale,0);
  if (((CalType & 0x10000000) == 0) && ((CalType & 0xfffffff) < 0x38)) {
    BVar2 = Internal_EnumCalendarInfo(lpCalInfoEnumProcEx,uVar1,Calendar,CalType,0,1,0,0);
  }
  else {
    SetLastError(0x3ec);
    BVar2 = 0;
  }
  return BVar2;
}



BOOL EnumDateFormatsA(DATEFMT_ENUMPROCA lpDateFmtEnumProc,LCID Locale,DWORD dwFlags)

{
  undefined4 uVar1;
  BOOL BVar2;
  
                    // 0x43660  318  EnumDateFormatsA
  uVar1 = NlsValidateLocale(&Locale,0);
  BVar2 = Internal_EnumDateFormats(lpDateFmtEnumProc,uVar1,dwFlags,0,0,0,0);
  return BVar2;
}



BOOL EnumDateFormatsExA(DATEFMT_ENUMPROCEXA lpDateFmtEnumProcEx,LCID Locale,DWORD dwFlags)

{
  undefined4 uVar1;
  BOOL BVar2;
  
                    // 0x43690  319  EnumDateFormatsExA
  uVar1 = NlsValidateLocale(&Locale,0);
  BVar2 = Internal_EnumDateFormats(lpDateFmtEnumProcEx,uVar1,dwFlags,0,1,0,0);
  return BVar2;
}



BOOL EnumLanguageGroupLocalesA
               (LANGGROUPLOCALE_ENUMPROCA lpLangGroupLocaleEnumProc,LGRPID LanguageGroup,
               DWORD dwFlags,LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // 0x436c0  323  EnumLanguageGroupLocalesA
  BVar1 = Internal_EnumLanguageGroupLocales
                    (lpLangGroupLocaleEnumProc,LanguageGroup,dwFlags,lParam,0);
  return BVar1;
}



BOOL EnumSystemCodePagesA(CODEPAGE_ENUMPROCA lpCodePageEnumProc,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // 0x436f0  337  EnumSystemCodePagesA
  BVar1 = Internal_EnumSystemCodePages(lpCodePageEnumProc,dwFlags,0);
  return BVar1;
}



BOOL EnumSystemLanguageGroupsA
               (LANGUAGEGROUP_ENUMPROCA lpLanguageGroupEnumProc,DWORD dwFlags,LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // 0x43710  342  EnumSystemLanguageGroupsA
  BVar1 = Internal_EnumSystemLanguageGroups(lpLanguageGroupEnumProc,dwFlags,lParam,0);
  return BVar1;
}



BOOL EnumTimeFormatsA(TIMEFMT_ENUMPROCA lpTimeFmtEnumProc,LCID Locale,DWORD dwFlags)

{
  undefined4 uVar1;
  BOOL BVar2;
  
                    // 0x43730  347  EnumTimeFormatsA
  uVar1 = NlsValidateLocale(&Locale,0);
  if ((dwFlags & 2) == 0) {
    BVar2 = Internal_EnumTimeFormats(lpTimeFmtEnumProc,uVar1,dwFlags,0,0,0);
  }
  else {
    SetLastError(0x3ec);
    BVar2 = 0;
  }
  return BVar2;
}



BOOL EnumUILanguagesA(UILANGUAGE_ENUMPROCA lpUILanguageEnumProc,DWORD dwFlags,LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // 0x43780  350  EnumUILanguagesA
  BVar1 = Internal_EnumUILanguages(lpUILanguageEnumProc,dwFlags,lParam,0);
  return BVar1;
}



int FoldStringA(DWORD dwMapFlags,LPCSTR lpSrcStr,int cchSrc,LPSTR lpDestStr,int cchDest)

{
  UINT UVar1;
  int iVar2;
  DWORD DVar3;
  WCHAR *lpDestStr_00;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 extraout_EDX_04;
  undefined4 extraout_EDX_05;
  undefined4 extraout_EDX_06;
  undefined4 uVar4;
  LPCWSTR lpSrcStr_00;
  int in_FS_OFFSET;
  LPCWSTR *ppWVar5;
  int *piVar6;
  int local_210;
  LPCWSTR local_20c;
  WCHAR local_208 [128];
  WCHAR local_108 [128];
  uint local_8;
  
                    // 0x437a0  425  FoldStringA
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  if ((cchDest < 0) || (((cchDest != 0 && (lpDestStr == (LPSTR)0x0)) || (lpSrcStr == lpDestStr)))) {
    DVar3 = 0x57;
LAB_6b843954:
    SetLastError(DVar3);
    uVar4 = extraout_EDX_06;
  }
  else {
    memset(local_108,0,0x100);
    local_20c = local_108;
    piVar6 = &local_210;
    ppWVar5 = &local_20c;
    UVar1 = GetACP();
    iVar2 = FUN_6b8445cc(UVar1,lpSrcStr,(char *)cchSrc,ppWVar5,piVar6);
    uVar4 = extraout_EDX;
    if (iVar2 != 0) {
      lpDestStr_00 = local_208;
      iVar2 = 0x80;
      lpSrcStr_00 = local_20c;
      do {
        while( true ) {
          iVar2 = FoldStringW(dwMapFlags,lpSrcStr_00,local_210,lpDestStr_00,iVar2);
          uVar4 = extraout_EDX_02;
          if (((iVar2 != 0) || (DVar3 = GetLastError(), uVar4 = extraout_EDX_00, DVar3 != 0x7a)) ||
             (lpDestStr_00 != local_208)) goto LAB_6b8438c0;
          SetLastError(0);
          iVar2 = FoldStringW(dwMapFlags,lpSrcStr_00,local_210,(LPWSTR)0x0,0);
          if (iVar2 == 0) break;
          lpDestStr_00 = (WCHAR *)RtlAllocateHeap(*(undefined4 *)
                                                   (*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                                  iVar2 * 2);
          lpSrcStr_00 = local_20c;
          if (lpDestStr_00 == (LPCWSTR)0x0) {
            if ((local_20c != local_108) && (local_20c != (LPCWSTR)0x0)) {
              RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_20c);
            }
            DVar3 = 0xe;
            goto LAB_6b843954;
          }
        }
        DVar3 = GetLastError();
        uVar4 = extraout_EDX_01;
      } while (DVar3 == 0);
LAB_6b8438c0:
      if ((lpSrcStr_00 != local_108) && (lpSrcStr_00 != (LPCWSTR)0x0)) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpSrcStr_00);
        uVar4 = extraout_EDX_03;
      }
      if (0 < iVar2) {
        UVar1 = GetACP();
        WideCharToMultiByte(UVar1,0,lpDestStr_00,iVar2,lpDestStr,cchDest,(LPCSTR)0x0,(LPBOOL)0x0);
        uVar4 = extraout_EDX_04;
      }
      if ((lpDestStr_00 != local_208) && (lpDestStr_00 != (LPCWSTR)0x0)) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpDestStr_00);
        uVar4 = extraout_EDX_05;
      }
    }
  }
  iVar2 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar4);
  return iVar2;
}



BOOL GetCPInfoExA(UINT CodePage,DWORD dwFlags,LPCPINFOEXA lpCPInfoEx)

{
  UINT CodePage_00;
  int iVar1;
  BOOL BVar2;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 uVar3;
  _cpinfoexW *p_Var4;
  undefined auStack564 [4];
  _cpinfoexW local_230;
  uint local_c;
  
                    // 0x43980  456  GetCPInfoExA
  local_c = DAT_6b8b0140 ^ (uint)auStack564;
  if (lpCPInfoEx == (LPCPINFOEXA)0x0) {
    SetLastError(0x57);
    uVar3 = extraout_EDX;
  }
  else {
    BVar2 = GetCPInfoExW(CodePage,dwFlags,&local_230);
    uVar3 = extraout_EDX_00;
    if (BVar2 == 1) {
      CodePage_00 = GetACP();
      iVar1 = WideCharToMultiByte(CodePage_00,0,local_230.CodePageName,-1,lpCPInfoEx->CodePageName,
                                  0x104,(LPCSTR)0x0,(LPBOOL)0x0);
      uVar3 = extraout_EDX_01;
      if (iVar1 == 0) goto LAB_6b8439fb;
    }
    p_Var4 = &local_230;
    for (iVar1 = 6; iVar1 != 0; iVar1 = iVar1 + -1) {
      lpCPInfoEx->MaxCharSize = p_Var4->MaxCharSize;
      p_Var4 = (_cpinfoexW *)p_Var4->DefaultChar;
      lpCPInfoEx = (LPCPINFOEXA)lpCPInfoEx->DefaultChar;
    }
  }
LAB_6b8439fb:
  BVar2 = FUN_6b8224af(local_c ^ (uint)auStack564,uVar3);
  return BVar2;
}



int GetCalendarInfoA(LCID Locale,CALID Calendar,CALTYPE CalType,LPSTR lpCalData,int cchData,
                    LPDWORD lpValue)

{
  int iVar1;
  WCHAR *lpWideCharStr;
  UINT CodePage;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 uVar2;
  undefined4 extraout_EDX_04;
  uint uVar3;
  int in_FS_OFFSET;
  DWORD DVar4;
  WCHAR local_108 [128];
  uint local_8;
  
                    // 0x43a20  463  GetCalendarInfoA
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  if ((cchData < 0) || ((lpCalData == (LPSTR)0x0 && (cchData != 0)))) goto LAB_6b843a93;
  if (((CalType & 0x10000000) != 0) || (0x37 < (CalType & 0xfffffff))) {
    DVar4 = 0x3ec;
    goto LAB_6b843a95;
  }
  if ((CalType & 0x20000000) == 0) {
    if ((lpValue == (LPDWORD)0x0) && ((lpCalData != (LPSTR)0x0 || (cchData == 0))))
    goto LAB_6b843aba;
  }
  else if ((lpCalData == (LPSTR)0x0) && ((cchData == 0 && (lpValue != (LPDWORD)0x0)))) {
LAB_6b843aba:
    lpWideCharStr = local_108;
    uVar3 = 0x80;
    do {
      iVar1 = GetCalendarInfoW(Locale,Calendar,CalType,
                               (LPWSTR)(-(uint)(lpCalData != (LPSTR)0x0) & (uint)lpWideCharStr),
                               -(uint)(lpCalData != (LPSTR)0x0) & uVar3,lpValue);
      uVar2 = extraout_EDX_00;
      if (iVar1 != 0) {
        if ((0 < iVar1) && ((CalType & 0x20000000) == 0)) {
          CodePage = FUN_6b8446ba(Locale,CalType);
          if (CodePage == 0) {
            SetLastError(0x57);
            uVar2 = extraout_EDX_02;
          }
          else {
            WideCharToMultiByte(CodePage,0,lpWideCharStr,iVar1,lpCalData,cchData,(LPCSTR)0x0,
                                (LPBOOL)0x0);
            uVar2 = extraout_EDX_03;
          }
        }
LAB_6b843bb6:
        if (lpWideCharStr != local_108) {
LAB_6b843bc0:
          if (lpWideCharStr != (LPCWSTR)0x0) {
            RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpWideCharStr);
            uVar2 = extraout_EDX_04;
          }
        }
        goto LAB_6b843a9d;
      }
      if ((lpValue != (LPDWORD)0x0) ||
         (DVar4 = GetLastError(), uVar2 = extraout_EDX_01, DVar4 != 0x7a)) goto LAB_6b843bb6;
      if (lpWideCharStr != local_108) goto LAB_6b843bc0;
      SetLastError(0);
      uVar3 = GetCalendarInfoW(Locale,Calendar,CalType,(LPWSTR)0x0,0,(LPDWORD)0x0);
    } while ((uVar3 == 0) ||
            (lpWideCharStr =
                  (WCHAR *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                           uVar3 * 2), lpWideCharStr != (LPCWSTR)0x0));
    DVar4 = 0xe;
    goto LAB_6b843a95;
  }
LAB_6b843a93:
  DVar4 = 0x57;
LAB_6b843a95:
  SetLastError(DVar4);
  uVar2 = extraout_EDX;
LAB_6b843a9d:
  iVar1 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return iVar1;
}



int GetCurrencyFormatA(LCID Locale,DWORD dwFlags,LPCSTR lpValue,CURRENCYFMTA *lpFormat,
                      LPSTR lpCurrencyStr,int cchCurrency)

{
  LPCSTR pCVar1;
  UINT UVar2;
  int iVar3;
  DWORD DVar4;
  WCHAR *lpWideCharStr;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 extraout_EDX_04;
  undefined4 extraout_EDX_05;
  undefined4 extraout_EDX_06;
  undefined4 extraout_EDX_07;
  undefined4 extraout_EDX_08;
  undefined4 extraout_EDX_09;
  undefined4 extraout_EDX_10;
  undefined4 extraout_EDX_11;
  undefined4 extraout_EDX_12;
  undefined4 uVar5;
  undefined4 extraout_EDX_13;
  undefined4 extraout_EDX_14;
  undefined4 extraout_EDX_15;
  CURRENCYFMTA *pCVar6;
  CURRENCYFMTW *pCVar7;
  LPCWSTR pWVar8;
  int in_FS_OFFSET;
  CURRENCYFMTW local_238;
  UINT local_218;
  int local_214;
  LPCWSTR local_210;
  CURRENCYFMTW *local_20c;
  WCHAR local_208 [128];
  WCHAR local_108 [128];
  uint local_8;
  
                    // 0x43bf0  526  GetCurrencyFormatA
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_20c = (CURRENCYFMTW *)0x0;
  local_218 = FUN_6b8446ba(Locale,dwFlags);
  if ((((local_218 == 0) || (cchCurrency < 0)) ||
      ((lpCurrencyStr == (LPSTR)0x0 && (cchCurrency != 0)))) || (lpValue == lpCurrencyStr)) {
    SetLastError(0x57);
    uVar5 = extraout_EDX_15;
  }
  else {
    local_210 = local_108;
    iVar3 = FUN_6b8445cc(local_218,lpValue,(char *)0xffffffff,&local_210,&local_214);
    uVar5 = extraout_EDX;
    if (iVar3 != 0) {
      if (lpFormat != (CURRENCYFMTA *)0x0) {
        pCVar1 = lpFormat->lpDecimalSep;
        pCVar6 = lpFormat;
        pCVar7 = &local_238;
        for (iVar3 = 8; UVar2 = local_218, iVar3 != 0; iVar3 = iVar3 + -1) {
          pCVar7->NumDigits = pCVar6->NumDigits;
          pCVar6 = (CURRENCYFMTA *)&pCVar6->LeadingZero;
          pCVar7 = (CURRENCYFMTW *)&pCVar7->LeadingZero;
        }
        local_238.lpDecimalSep = (LPWSTR)0x0;
        local_238.lpThousandSep = (LPWSTR)0x0;
        local_238.lpCurrencySymbol = (LPWSTR)0x0;
        iVar3 = FUN_6b8445cc(local_218,pCVar1,(char *)0xffffffff,&local_238.lpDecimalSep,&local_214)
        ;
        uVar5 = extraout_EDX_00;
        if (((iVar3 == 0) ||
            (iVar3 = FUN_6b8445cc(UVar2,lpFormat->lpThousandSep,(char *)0xffffffff,
                                  &local_238.lpThousandSep,&local_214), uVar5 = extraout_EDX_01,
            iVar3 == 0)) ||
           (iVar3 = FUN_6b8445cc(UVar2,lpFormat->lpCurrencySymbol,(char *)0xffffffff,
                                 &local_238.lpCurrencySymbol,&local_214), uVar5 = extraout_EDX_02,
           iVar3 == 0)) {
          if ((local_210 != local_108) && (local_210 != (LPCWSTR)0x0)) {
            RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_210);
            uVar5 = extraout_EDX_03;
          }
          if (local_238.lpDecimalSep != (LPWSTR)0x0) {
            RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,
                        local_238.lpDecimalSep);
            uVar5 = extraout_EDX_04;
          }
          if (local_238.lpThousandSep != (LPWSTR)0x0) {
            RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,
                        local_238.lpThousandSep);
            uVar5 = extraout_EDX_05;
          }
          goto LAB_6b843f00;
        }
        local_20c = &local_238;
      }
      lpWideCharStr = local_208;
      iVar3 = 0x80;
      pWVar8 = local_210;
      do {
        iVar3 = FUN_6b844d67(Locale,dwFlags,pWVar8,local_20c,lpWideCharStr,iVar3);
        uVar5 = extraout_EDX_06;
        if (((iVar3 != 0) || (DVar4 = GetLastError(), uVar5 = extraout_EDX_07, DVar4 != 0x7a)) ||
           (lpWideCharStr != local_208)) goto LAB_6b843e28;
        SetLastError(0);
        iVar3 = FUN_6b844d67(Locale,dwFlags,pWVar8,local_20c,(LPWSTR)0x0,0);
      } while ((iVar3 == 0) ||
              (lpWideCharStr =
                    (WCHAR *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8
                                             ,iVar3 * 2), pWVar8 = local_210,
              lpWideCharStr != (LPWSTR)0x0));
      SetLastError(0xe);
      iVar3 = 0;
      uVar5 = extraout_EDX_08;
      pWVar8 = local_210;
LAB_6b843e28:
      if ((pWVar8 != local_108) && (pWVar8 != (LPCWSTR)0x0)) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pWVar8);
        uVar5 = extraout_EDX_09;
      }
      if (lpFormat != (CURRENCYFMTA *)0x0) {
        if (local_238.lpDecimalSep != (LPWSTR)0x0) {
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_238.lpDecimalSep
                     );
          uVar5 = extraout_EDX_10;
        }
        if (local_238.lpThousandSep != (LPWSTR)0x0) {
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,
                      local_238.lpThousandSep);
          uVar5 = extraout_EDX_11;
        }
        if (local_238.lpCurrencySymbol != (LPWSTR)0x0) {
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,
                      local_238.lpCurrencySymbol);
          uVar5 = extraout_EDX_12;
        }
      }
      if (0 < iVar3) {
        WideCharToMultiByte(local_218,0,lpWideCharStr,iVar3,lpCurrencyStr,cchCurrency,(LPCSTR)0x0,
                            (LPBOOL)0x0);
        uVar5 = extraout_EDX_13;
      }
      if ((lpWideCharStr != local_208) && (lpWideCharStr != (LPCWSTR)0x0)) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpWideCharStr);
        uVar5 = extraout_EDX_14;
      }
    }
  }
LAB_6b843f00:
  iVar3 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar5);
  return iVar3;
}



void GetDateFormatAWorker
               (UINT *param_1,LCID param_2,DWORD param_3,SYSTEMTIME *param_4,LPCSTR param_5,
               LPSTR param_6,int param_7)

{
  int iVar1;
  DWORD DVar2;
  WCHAR *lpDateStr;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 uVar3;
  undefined4 extraout_EDX_04;
  undefined4 extraout_EDX_05;
  LPCWSTR lpFormat;
  int in_FS_OFFSET;
  int local_21c;
  UINT *local_218;
  LPSTR local_214;
  SYSTEMTIME *local_210;
  LPCWSTR local_20c;
  WCHAR local_208 [128];
  WCHAR local_108 [128];
  uint local_8;
  
                    // 0x43f20  549  GetDateFormatAWorker
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_214 = param_6;
  local_20c = local_208;
  local_218 = param_1;
  local_210 = param_4;
  iVar1 = FUN_6b8445cc(*param_1,param_5,(char *)0xffffffff,&local_20c,&local_21c);
  uVar3 = extraout_EDX;
  if (iVar1 != 0) {
    lpDateStr = local_108;
    iVar1 = 0x80;
    lpFormat = local_20c;
    do {
      iVar1 = GetDateFormatW(param_2,param_3,param_4,lpFormat,lpDateStr,iVar1);
      uVar3 = extraout_EDX_01;
      if (((iVar1 != 0) || (DVar2 = GetLastError(), uVar3 = extraout_EDX_00, DVar2 != 0x7a)) ||
         (lpDateStr != local_108)) {
        if ((lpFormat != local_208) && (lpFormat != (LPCWSTR)0x0)) {
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpFormat);
          uVar3 = extraout_EDX_02;
        }
        if (0 < iVar1) {
          WideCharToMultiByte(*local_218,0,lpDateStr,iVar1,local_214,param_7,(LPCSTR)0x0,(LPBOOL)0x0
                             );
          uVar3 = extraout_EDX_03;
        }
        if ((lpDateStr != local_108) && (lpDateStr != (LPCWSTR)0x0)) {
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpDateStr);
          uVar3 = extraout_EDX_04;
        }
        goto LAB_6b84407b;
      }
      SetLastError(0);
      iVar1 = GetDateFormatW(param_2,param_3,local_210,lpFormat,(LPWSTR)0x0,0);
      param_4 = local_210;
    } while ((iVar1 == 0) ||
            (lpDateStr = (WCHAR *)RtlAllocateHeap(*(undefined4 *)
                                                   (*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                                  iVar1 * 2), lpFormat = local_20c,
            param_4 = local_210, lpDateStr != (LPCWSTR)0x0));
    if ((local_20c != local_208) && (local_20c != (LPCWSTR)0x0)) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_20c);
    }
    SetLastError(0xe);
    uVar3 = extraout_EDX_05;
  }
LAB_6b84407b:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar3);
  return;
}



int GetGeoInfoA(GEOID Location,GEOTYPE GeoType,LPSTR lpGeoData,int cchData,LANGID LangId)

{
  int iVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 uVar2;
  WCHAR local_a8 [80];
  uint local_8;
  
                    // 0x440d0  608  GetGeoInfoA
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  memset(local_a8,0,0xa0);
  if ((lpGeoData == (LPSTR)0x0) && (0 < cchData)) {
    SetLastError(0x57);
    uVar2 = extraout_EDX;
  }
  else {
    iVar1 = GetGeoInfoW(Location,GeoType,local_a8,0x50,LangId);
    uVar2 = extraout_EDX_00;
    if (iVar1 != 0) {
      WideCharToMultiByte(0,0,local_a8,iVar1,lpGeoData,cchData,(LPCSTR)0x0,(LPBOOL)0x0);
      uVar2 = extraout_EDX_01;
    }
  }
  iVar1 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return iVar1;
}



int GetNumberFormatA(LCID Locale,DWORD dwFlags,LPCSTR lpValue,NUMBERFMTA *lpFormat,LPSTR lpNumberStr
                    ,int cchNumber)

{
  LPCSTR pCVar1;
  UINT UVar2;
  int iVar3;
  DWORD DVar4;
  WCHAR *lpWideCharStr;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 extraout_EDX_04;
  undefined4 extraout_EDX_05;
  undefined4 extraout_EDX_06;
  undefined4 extraout_EDX_07;
  undefined4 extraout_EDX_08;
  undefined4 extraout_EDX_09;
  undefined4 extraout_EDX_10;
  undefined4 extraout_EDX_11;
  undefined4 extraout_EDX_12;
  undefined4 uVar5;
  NUMBERFMTA *pNVar6;
  NUMBERFMTW *pNVar7;
  LPCWSTR pWVar8;
  int in_FS_OFFSET;
  NUMBERFMTW local_238;
  LPSTR local_220;
  NUMBERFMTA *local_21c;
  UINT local_218;
  int local_214;
  LPCWSTR local_210;
  NUMBERFMTW *local_20c;
  WCHAR local_208 [128];
  WCHAR local_108 [128];
  uint local_8;
  
                    // 0x44160  663  GetNumberFormatA
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_21c = lpFormat;
  local_220 = lpNumberStr;
  local_20c = (NUMBERFMTW *)0x0;
  local_218 = FUN_6b8446ba(Locale,dwFlags);
  if ((((local_218 == 0) || (cchNumber < 0)) || ((lpNumberStr == (LPSTR)0x0 && (cchNumber != 0))))
     || (lpValue == lpNumberStr)) {
    SetLastError(0x57);
    uVar5 = extraout_EDX_12;
  }
  else {
    local_210 = local_108;
    iVar3 = FUN_6b8445cc(local_218,lpValue,(char *)0xffffffff,&local_210,&local_214);
    uVar5 = extraout_EDX;
    if (iVar3 != 0) {
      if (lpFormat != (NUMBERFMTA *)0x0) {
        pCVar1 = lpFormat->lpDecimalSep;
        pNVar6 = lpFormat;
        pNVar7 = &local_238;
        for (iVar3 = 6; UVar2 = local_218, iVar3 != 0; iVar3 = iVar3 + -1) {
          pNVar7->NumDigits = pNVar6->NumDigits;
          pNVar6 = (NUMBERFMTA *)&pNVar6->LeadingZero;
          pNVar7 = (NUMBERFMTW *)&pNVar7->LeadingZero;
        }
        local_238.lpDecimalSep = (LPWSTR)0x0;
        local_238.lpThousandSep = (LPWSTR)0x0;
        iVar3 = FUN_6b8445cc(local_218,pCVar1,(char *)0xffffffff,&local_238.lpDecimalSep,&local_214)
        ;
        uVar5 = extraout_EDX_00;
        if ((iVar3 == 0) ||
           (iVar3 = FUN_6b8445cc(UVar2,lpFormat->lpThousandSep,(char *)0xffffffff,
                                 &local_238.lpThousandSep,&local_214), uVar5 = extraout_EDX_01,
           iVar3 == 0)) {
          if ((local_210 != local_108) && (local_210 != (LPCWSTR)0x0)) {
            RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_210);
            uVar5 = extraout_EDX_02;
          }
          if (local_238.lpDecimalSep != (LPWSTR)0x0) {
            RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,
                        local_238.lpDecimalSep);
            uVar5 = extraout_EDX_03;
          }
          goto LAB_6b84440f;
        }
        local_20c = &local_238;
      }
      lpWideCharStr = local_208;
      iVar3 = 0x80;
      pWVar8 = local_210;
      do {
        iVar3 = FUN_6b8188a0(Locale,dwFlags,pWVar8,local_20c,lpWideCharStr,iVar3);
        uVar5 = extraout_EDX_04;
        if (((iVar3 != 0) || (DVar4 = GetLastError(), uVar5 = extraout_EDX_05, DVar4 != 0x7a)) ||
           (lpWideCharStr != local_208)) goto LAB_6b844356;
        SetLastError(0);
        iVar3 = FUN_6b8188a0(Locale,dwFlags,pWVar8,local_20c,(LPWSTR)0x0,0);
      } while ((iVar3 == 0) ||
              (lpWideCharStr =
                    (WCHAR *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8
                                             ,iVar3 * 2), pWVar8 = local_210,
              lpWideCharStr != (LPWSTR)0x0));
      SetLastError(0xe);
      iVar3 = 0;
      uVar5 = extraout_EDX_06;
      pWVar8 = local_210;
LAB_6b844356:
      if ((pWVar8 != local_108) && (pWVar8 != (LPCWSTR)0x0)) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pWVar8);
        uVar5 = extraout_EDX_07;
      }
      if (local_21c != (NUMBERFMTA *)0x0) {
        if (local_238.lpDecimalSep != (LPWSTR)0x0) {
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_238.lpDecimalSep
                     );
          uVar5 = extraout_EDX_08;
        }
        if (local_238.lpThousandSep != (LPWSTR)0x0) {
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,
                      local_238.lpThousandSep);
          uVar5 = extraout_EDX_09;
        }
      }
      if (0 < iVar3) {
        WideCharToMultiByte(local_218,0,lpWideCharStr,iVar3,local_220,cchNumber,(LPCSTR)0x0,
                            (LPBOOL)0x0);
        uVar5 = extraout_EDX_10;
      }
      if ((lpWideCharStr != local_208) && (lpWideCharStr != (LPCWSTR)0x0)) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpWideCharStr);
        uVar5 = extraout_EDX_11;
      }
    }
  }
LAB_6b84440f:
  iVar3 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar5);
  return iVar3;
}



void GetTimeFormatAWorker
               (UINT *param_1,LCID param_2,DWORD param_3,SYSTEMTIME *param_4,LPCSTR param_5,
               LPSTR param_6,int param_7)

{
  int iVar1;
  DWORD DVar2;
  WCHAR *lpTimeStr;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 uVar3;
  undefined4 extraout_EDX_04;
  undefined4 extraout_EDX_05;
  LPCWSTR lpFormat;
  int in_FS_OFFSET;
  int local_21c;
  UINT *local_218;
  LPSTR local_214;
  SYSTEMTIME *local_210;
  LPCWSTR local_20c;
  WCHAR local_208 [128];
  WCHAR local_108 [128];
  uint local_8;
  
                    // 0x44430  784  GetTimeFormatAWorker
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_214 = param_6;
  local_20c = local_208;
  local_218 = param_1;
  local_210 = param_4;
  iVar1 = FUN_6b8445cc(*param_1,param_5,(char *)0xffffffff,&local_20c,&local_21c);
  uVar3 = extraout_EDX;
  if (iVar1 != 0) {
    lpTimeStr = local_108;
    iVar1 = 0x80;
    lpFormat = local_20c;
    do {
      iVar1 = GetTimeFormatW(param_2,param_3,param_4,lpFormat,lpTimeStr,iVar1);
      uVar3 = extraout_EDX_01;
      if (((iVar1 != 0) || (DVar2 = GetLastError(), uVar3 = extraout_EDX_00, DVar2 != 0x7a)) ||
         (lpTimeStr != local_108)) {
        if ((lpFormat != local_208) && (lpFormat != (LPCWSTR)0x0)) {
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpFormat);
          uVar3 = extraout_EDX_02;
        }
        if (0 < iVar1) {
          WideCharToMultiByte(*local_218,0,lpTimeStr,iVar1,local_214,param_7,(LPCSTR)0x0,(LPBOOL)0x0
                             );
          uVar3 = extraout_EDX_03;
        }
        if ((lpTimeStr != local_108) && (lpTimeStr != (LPCWSTR)0x0)) {
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpTimeStr);
          uVar3 = extraout_EDX_04;
        }
        goto LAB_6b84458b;
      }
      SetLastError(0);
      iVar1 = GetTimeFormatW(param_2,param_3,local_210,lpFormat,(LPWSTR)0x0,0);
      param_4 = local_210;
    } while ((iVar1 == 0) ||
            (lpTimeStr = (WCHAR *)RtlAllocateHeap(*(undefined4 *)
                                                   (*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                                  iVar1 * 2), lpFormat = local_20c,
            param_4 = local_210, lpTimeStr != (LPCWSTR)0x0));
    if ((local_20c != local_208) && (local_20c != (LPCWSTR)0x0)) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_20c);
    }
    SetLastError(0xe);
    uVar3 = extraout_EDX_05;
  }
LAB_6b84458b:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar3);
  return;
}



undefined4 __fastcall
FUN_6b8445cc(UINT param_1,LPCSTR param_2,char *param_3,LPWSTR *param_4,int *param_5)

{
  char cVar1;
  LPWSTR lpWideCharStr;
  int iVar2;
  LPCSTR pCVar3;
  int in_FS_OFFSET;
  DWORD dwErrCode;
  char *local_8;
  
  if (param_2 == (LPCSTR)0x0) {
    *param_4 = (LPWSTR)0x0;
    *param_5 = 0;
    return 1;
  }
  if ((int)param_3 < 0) {
    pCVar3 = param_2;
    do {
      cVar1 = *pCVar3;
      pCVar3 = pCVar3 + 1;
    } while (cVar1 != '\0');
    param_3 = pCVar3 + (1 - (int)(param_2 + 1));
    if (param_3 < (char *)0x80000000) goto LAB_6b844615;
  }
  else {
LAB_6b844615:
    lpWideCharStr = *param_4;
    if (((lpWideCharStr == (LPWSTR)0x0) || (local_8 = (char *)0x7f, 0x7f < (int)param_3)) &&
       (lpWideCharStr =
             (LPWSTR)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                     (int)param_3 * 2 + 2), local_8 = param_3,
       lpWideCharStr == (LPWSTR)0x0)) {
      dwErrCode = 0xe;
      goto LAB_6b8446ab;
    }
    if (param_3 == (char *)0x0) {
      *lpWideCharStr = L'\0';
      *param_5 = 0;
LAB_6b844688:
      *param_4 = lpWideCharStr;
      return 1;
    }
    iVar2 = MultiByteToWideChar(param_1,0,param_2,(int)param_3,lpWideCharStr,(int)local_8);
    if ((iVar2 != 0) && (iVar2 <= (int)local_8)) {
      lpWideCharStr[iVar2] = L'\0';
      *param_5 = iVar2;
      goto LAB_6b844688;
    }
    if ((lpWideCharStr != *param_4) && (lpWideCharStr != (LPWSTR)0x0)) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpWideCharStr);
    }
  }
  dwErrCode = 0x57;
LAB_6b8446ab:
  SetLastError(dwErrCode);
  return 0;
}



UINT __fastcall FUN_6b8446ba(LCID param_1,uint param_2)

{
  int iVar1;
  UINT UVar2;
  BOOL BVar3;
  UINT local_8;
  
  local_8 = 0;
  if (((param_2 & 0x60000000) == 0) && (param_1 != 0x800)) {
    if ((param_1 == 0x409) || (param_1 == 0x7f)) {
      if (DAT_6b8b09c0 != 0) {
        return DAT_6b8b09c0;
      }
      BVar3 = IsValidCodePage(0x4e4);
      DAT_6b8b09c0 = (-(uint)(BVar3 != 0) & 0xffff06fb) + 0xfde9;
      return DAT_6b8b09c0;
    }
    iVar1 = GetLocaleInfoW(param_1,0xa0001004,(LPWSTR)&local_8,2);
    if (iVar1 == 0) {
      SetLastError(0x57);
      return 0;
    }
    if (local_8 != 0) {
      return local_8;
    }
  }
  UVar2 = GetACP();
  return UVar2;
}



BOOL SetCalendarInfoA(LCID Locale,CALID Calendar,CALTYPE CalType,LPCSTR lpCalData)

{
  LPCWSTR pWVar1;
  UINT UVar2;
  int iVar3;
  BOOL BVar4;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 uVar5;
  int in_FS_OFFSET;
  int local_110;
  WCHAR *local_10c;
  WCHAR local_108 [128];
  uint local_8;
  
                    // 0x44740  1246  SetCalendarInfoA
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  UVar2 = FUN_6b8446ba(Locale,CalType);
  if (UVar2 == 0) {
    SetLastError(0x57);
    uVar5 = extraout_EDX;
  }
  else {
    local_10c = local_108;
    iVar3 = FUN_6b8445cc(UVar2,lpCalData,(char *)0xffffffff,&local_10c,&local_110);
    pWVar1 = local_10c;
    uVar5 = extraout_EDX_00;
    if (((iVar3 != 0) &&
        (SetCalendarInfoW(Locale,Calendar,CalType,local_10c), uVar5 = extraout_EDX_01,
        pWVar1 != local_108)) && (pWVar1 != (LPCWSTR)0x0)) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pWVar1);
      uVar5 = extraout_EDX_02;
    }
  }
  BVar4 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar5);
  return BVar4;
}



BOOL SetLocaleInfoA(LCID Locale,LCTYPE LCType,LPCSTR lpLCData)

{
  LPCWSTR pWVar1;
  UINT UVar2;
  int iVar3;
  BOOL BVar4;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 uVar5;
  int in_FS_OFFSET;
  DWORD dwErrCode;
  int local_110;
  WCHAR *local_10c;
  WCHAR local_108 [128];
  uint local_8;
  
                    // 0x447f0  1338  SetLocaleInfoA
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  UVar2 = FUN_6b8446ba(Locale,LCType);
  if (UVar2 == 0) {
    dwErrCode = 0x57;
  }
  else {
    local_10c = local_108;
    iVar3 = FUN_6b8445cc(UVar2,lpLCData,(char *)0xffffffff,&local_10c,&local_110);
    pWVar1 = local_10c;
    uVar5 = extraout_EDX_00;
    if (iVar3 == 0) goto LAB_6b84489f;
    if (0xf8f < (LCType & 0xfffffff) - 0x70) {
      SetLocaleInfoW(Locale,LCType,local_10c);
      uVar5 = extraout_EDX_01;
      if ((pWVar1 != local_108) && (pWVar1 != (LPCWSTR)0x0)) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pWVar1);
        uVar5 = extraout_EDX_02;
      }
      goto LAB_6b84489f;
    }
    dwErrCode = 0x3ec;
  }
  SetLastError(dwErrCode);
  uVar5 = extraout_EDX;
LAB_6b84489f:
  BVar4 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar5);
  return BVar4;
}



uint __fastcall
FUN_6b8448ae(uint *param_1,short *param_2,uint param_3,int param_4,int param_5,ushort param_6,
            ushort param_7,ushort param_8)

{
  ushort uVar1;
  ushort *puVar2;
  uint uVar3;
  uint local_8;
  
  local_8 = 0;
  *param_1 = 0;
  if (param_2 != (short *)0x0) {
    *param_2 = 1;
  }
  if (2 < param_3) {
    if (param_3 < 5) {
      puVar2 = (ushort *)GetPtrCalDataArray(param_3,param_5,*(undefined4 *)(param_4 + 0x14));
      uVar1 = *puVar2;
      if (uVar1 != 0) {
        while( true ) {
          uVar3 = GetPtrCalData(param_3,param_5,puVar2 + 1,local_8 + 1);
          if (*(ushort *)(uVar3 + 4) < param_6) break;
          if (((param_6 == *(ushort *)(uVar3 + 4)) &&
              ((*(ushort *)(uVar3 + 6) < param_7 ||
               ((param_7 == *(ushort *)(uVar3 + 6) && (*(ushort *)(uVar3 + 8) <= param_8)))))) ||
             (local_8 = local_8 + 1 & 0xffff, uVar1 <= (ushort)local_8)) break;
        }
        if ((ushort)local_8 < uVar1) {
          param_6 = param_6 - *(short *)(uVar3 + 10);
          *param_1 = uVar3;
          if (param_2 != (short *)0x0) {
            *param_2 = uVar1 - (ushort)local_8;
          }
        }
        goto LAB_6b84499b;
      }
    }
    else if ((param_3 == 5) || (param_3 == 7)) {
      local_8 = param_5 + *(int *)(param_5 + 2 + *(int *)(param_4 + 0x14) * 2) * 2;
      param_6 = param_6 - *(short *)(local_8 + 10);
      *param_1 = local_8;
      goto LAB_6b84499b;
    }
  }
  local_8 = 0;
LAB_6b84499b:
  return local_8 & 0xffff0000 | (uint)param_6;
}



bool __fastcall FUN_6b8449a5(ushort *param_1,undefined4 *param_2)

{
  bool bVar1;
  int iVar2;
  undefined3 extraout_var;
  int local_2c;
  int local_28;
  int local_24;
  ushort local_20;
  ushort local_1c;
  
  iVar2 = FUN_6b84829d(param_1,&local_2c);
  if (iVar2 != 0) {
    param_1[1] = local_20;
    *param_1 = (ushort)local_24;
    param_1[3] = local_1c;
    bVar1 = FUN_6b8487a1(local_24,local_28);
    *param_2 = CONCAT31(extraout_var,bVar1);
  }
  return iVar2 != 0;
}



bool __fastcall FUN_6b8449ea(ushort *param_1,uint param_2)

{
  int iVar1;
  undefined4 local_2c [2];
  ushort local_24;
  ushort local_20;
  ushort local_1c;
  
  iVar1 = FUN_6b8498af(param_1,local_2c,param_2);
  if (iVar1 != 0) {
    *param_1 = local_24;
    param_1[1] = local_20;
    param_1[3] = local_1c;
  }
  return iVar1 != 0;
}



bool __fastcall FUN_6b844a23(undefined2 *param_1)

{
  int iVar1;
  undefined local_2c [8];
  undefined2 local_24;
  undefined2 local_20;
  undefined2 local_1c;
  
  iVar1 = FUN_6b84924b(param_1,(int)local_2c);
  if (iVar1 != 0) {
    *param_1 = local_24;
    param_1[1] = local_20;
    param_1[3] = local_1c;
  }
  return iVar1 != 0;
}



undefined4 __fastcall FUN_6b844a5b(ushort *param_1)

{
  int iVar1;
  uint local_2c [2];
  ushort local_24;
  ushort local_20;
  ushort local_1c;
  
  iVar1 = FUN_6b846c58(param_1,1,local_2c);
  if ((iVar1 != 0) && (iVar1 = FUN_6b847cfc(local_2c), iVar1 != 0)) {
    *param_1 = local_24;
    param_1[1] = local_20;
    param_1[3] = local_1c;
    return 1;
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __fastcall FUN_6b844aa3(undefined4 param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 extraout_EDX;
  WCHAR local_10 [4];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  if (_DAT_6b8b09c4 == 0) {
    iVar1 = GetCalendarInfoEx(L"ja-JP",3,(LPCWSTR)0x0,0x3d,local_10,3,(LPDWORD)0x0);
    DAT_6b8b09c8 = 0;
    if ((iVar1 != 0) && (local_10[0] == L'1')) {
      DAT_6b8b09c8 = 1;
    }
    _DAT_6b8b09c4 = 1;
    param_2 = extraout_EDX;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



undefined4 __fastcall FUN_6b844b0b(uint param_1)

{
  if ((param_1 & 3) == 0) {
    if (((int)((ulonglong)param_1 % 100) != 0) ||
       ((int)(((ulonglong)param_1 % 100 << 0x20 | (ulonglong)param_1) % 400) == 0)) {
      return 1;
    }
  }
  return 0;
}



// WARNING: Type propagation algorithm not settling

void __fastcall FUN_6b844b33(uint param_1,int param_2)

{
  ushort uVar1;
  short sVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  short sVar7;
  short sVar8;
  short sVar9;
  ushort uVar10;
  int extraout_EDX;
  int iVar11;
  undefined4 *puVar12;
  undefined8 uVar13;
  undefined local_24 [4];
  undefined4 local_20;
  undefined4 uStack28;
  undefined4 uStack24;
  undefined4 uStack20;
  short local_10;
  short sStack14;
  undefined2 local_c;
  undefined2 uStack10;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  if (5000 < param_1) {
    param_1 = param_1 - 5000;
  }
  uVar3 = param_1 / 100;
  iVar11 = 0;
  local_10 = 0;
  sStack14 = 0;
  sVar2 = sStack14;
  local_c = 0;
  sVar8 = local_10;
  if (uVar3 == 0) goto LAB_6b844bd5;
  param_1 = param_1 % 100;
  if (uVar3 < 4) {
    uVar4 = uVar3;
    sVar8 = 0;
LAB_6b844b97:
    sVar9 = sVar8;
    sStack14 = 0;
    sVar7 = sStack14;
    sStack14 = sVar2;
  }
  else {
    sVar9 = 0x5ea;
    local_c = 0x5ea;
    uVar4 = uVar3 - 4;
    sVar8 = 0x5ea;
    if (uVar3 - 4 < 4) goto LAB_6b844b97;
    uVar4 = uVar3 - 8;
    sStack14 = 0x5ea;
    sVar7 = 0x5ea;
  }
  local_10 = 0;
  if ((uVar4 != 0) && (sVar2 = (short)uVar4 + 0x5e6, local_10 = sVar2, sVar7 == 0)) {
    local_10 = 0;
    sVar7 = sVar2;
    sStack14 = sVar2;
  }
  sVar8 = sVar9;
  if ((sVar7 != 0) && (sVar8 = local_10, local_10 == 0)) {
    local_c = 0;
    sVar8 = sVar7;
    sStack14 = sVar9;
  }
LAB_6b844bd5:
  local_10 = sVar8;
  uStack10 = 0;
  uVar3 = param_1 / 10;
  if (uVar3 == 0) {
    sVar2 = 0;
  }
  else {
    param_1 = param_1 % 10;
    switch(uVar3) {
    case 1:
      sVar2 = 0x5d9;
      break;
    case 2:
      sVar2 = 0x5db;
      break;
    case 3:
      sVar2 = 0x5dc;
      break;
    case 4:
      sVar2 = 0x5de;
      break;
    case 5:
      sVar2 = 0x5e0;
      break;
    case 6:
      sVar2 = 0x5e1;
      break;
    case 7:
      sVar2 = 0x5e2;
      break;
    case 8:
      sVar2 = 0x5e4;
      break;
    case 9:
      sVar2 = 0x5e6;
      break;
    default:
      sVar2 = (short)param_2;
    }
  }
  if (param_1 == 0) {
    uVar10 = 0;
  }
  else {
    uVar10 = (short)param_1 + 0x5cf;
  }
  sVar8 = sVar2;
  uVar1 = uVar10;
  if ((((uVar10 != 0x5d4) || (sVar8 = 0x5d8, uVar1 = 0x5d5, sVar2 == 0x5d9)) &&
      (uVar10 = uVar1, sVar2 = sVar8, uVar10 == 0x5d5)) && (sVar8 == 0x5d9)) {
    uVar10 = 0x5d6;
    sVar2 = 0x5d8;
  }
  local_24 = 0;
  local_20 = 0;
  uStack28 = 0;
  uStack24 = 0;
  uStack20 = 0;
  if (uVar10 == 0) {
    puVar12 = (undefined4 *)local_24;
  }
  else {
    local_24 = (uint)uVar10;
    puVar12 = (undefined4 *)((int)local_24 + 2);
  }
  if (sVar2 != 0) {
    *(short *)puVar12 = sVar2;
    puVar12 = (undefined4 *)((int)puVar12 + 2);
  }
  uVar13 = FUN_6b812c57((short *)puVar12,9 - ((int)puVar12 - (int)local_24 >> 1),(int)&local_10);
  iVar5 = (int)((ulonglong)uVar13 >> 0x20);
  if (-1 < (int)uVar13) {
    iVar5 = FUN_6b8502c0((short *)local_24);
    if (iVar5 < 2) {
      local_24 = CONCAT22((short)local_24,0x27);
    }
    else {
      iVar5 = FUN_6b8502c0((short *)((int)local_24 + 2));
      memcpy(&local_20,(void *)((int)local_24 + 2),iVar5 * 2);
      local_24 = local_24 & 0xffff | 0x220000;
    }
    iVar6 = FUN_6b8502c0((short *)local_24);
    iVar6 = iVar6 + -1;
    iVar5 = extraout_EDX;
    if (iVar6 < 9) {
      for (; -1 < iVar6; iVar6 = iVar6 + -1) {
        *(undefined2 *)(param_2 + iVar11 * 2) = *(undefined2 *)((int)local_24 + iVar6 * 2);
        iVar11 = iVar11 + 1;
      }
      *(undefined2 *)(param_2 + iVar11 * 2) = 0;
      iVar5 = param_2;
    }
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,iVar5);
  return;
}



int __fastcall
FUN_6b844d67(undefined4 param_1,DWORD param_2,LPCWSTR param_3,CURRENCYFMTW *param_4,LPWSTR param_5,
            int param_6)

{
  LPCWSTR lpLocaleName;
  int iVar1;
  
  lpLocaleName = (LPCWSTR)InternalLcidToName();
  if (lpLocaleName == (LPCWSTR)0x0) {
    SetLastError(0x57);
    iVar1 = 0;
  }
  else {
    iVar1 = GetCurrencyFormatEx(lpLocaleName,param_2,param_3,param_4,param_5,param_6);
  }
  return iVar1;
}



int GetDurationFormat(LCID Locale,DWORD dwFlags,SYSTEMTIME *lpDuration,ULONGLONG ullDuration,
                     LPCWSTR lpFormat,LPWSTR lpDurationStr,int cchDuration)

{
  LPCWSTR lpLocaleName;
  int iVar1;
  
                    // 0x44db0  566  GetDurationFormat
  lpLocaleName = (LPCWSTR)InternalLcidToName();
  if (lpLocaleName == (LPCWSTR)0x0) {
    SetLastError(0x57);
    iVar1 = 0;
  }
  else {
    iVar1 = GetDurationFormatEx(lpLocaleName,dwFlags,lpDuration,ullDuration,lpFormat,lpDurationStr,
                                cchDuration);
  }
  return iVar1;
}



int __fastcall FUN_6b844df0(int param_1,int param_2)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  int in_FS_OFFSET;
  undefined4 local_10;
  int local_c;
  undefined4 local_8;
  
  local_8 = 0;
  local_10 = 0;
  local_c = 0;
  if ((((param_1 == 0) || (param_2 == 0)) ||
      (uVar2 = RtlSizeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_2),
      uVar2 == 0xffffffff)) || (uVar2 < 0xaa)) {
    iVar3 = -0x3ffffff3;
  }
  else {
    RtlInitUnicodeString(&local_10,param_1);
    iVar3 = RtlUnicodeStringToInteger(&local_10,0x10,&local_8);
    if (-1 < iVar3) {
      local_10 = 0xaa0000;
      local_c = param_2;
      cVar1 = RtlLCIDToCultureName(local_8,&local_10);
      if (cVar1 == '\0') {
        iVar3 = -0x3fffffff;
      }
    }
  }
  return iVar3;
}



int __fastcall FUN_6b844e80(int param_1,void *param_2,int param_3)

{
  int iVar1;
  
  iVar1 = 0;
  if (param_1 == 0) {
    iVar1 = FUN_6b844df0(param_3 + 0xc,(int)param_2);
  }
  else if (*(uint *)(param_3 + 8) < 0x25) {
    memcpy(param_2,(void *)(param_3 + 0xc),*(size_t *)(param_3 + 8));
  }
  else {
    iVar1 = -0x3ffffdfa;
  }
  return iVar1;
}



void __fastcall FUN_6b844ec2(byte *param_1)

{
  int iVar1;
  undefined4 local_c;
  uint local_8;
  
  local_c = 8;
  local_8 = 0;
  iVar1 = NtQuerySystemInformation(0x67,&local_c,8,0);
  if (-1 < iVar1) {
    *param_1 = (byte)(local_8 >> 5) & 1;
  }
  return;
}



void __fastcall FUN_6b844ef7(void *param_1,int param_2)

{
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar1;
  undefined4 extraout_EDX_01;
  int in_FS_OFFSET;
  undefined8 uVar2;
  undefined4 local_fc;
  undefined4 local_f8;
  undefined4 *local_f4;
  undefined4 local_f0;
  undefined4 local_ec;
  undefined4 local_e8;
  undefined4 local_e4;
  undefined4 local_e0;
  undefined4 local_dc;
  undefined4 local_d8;
  undefined4 local_d4;
  int local_d0;
  undefined local_cc [196];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_d0 = 0;
  local_d4 = 0;
  memset(local_cc,0,0xba);
  local_dc = 0;
  local_d8 = 0;
  local_e4 = 0;
  local_e0 = 0;
  RtlInitUnicodeString
            (&local_e4,L"\\Registry\\Machine\\System\\CurrentControlSet\\Control\\NLS\\Language");
  uVar1 = extraout_EDX;
  if (param_1 == (void *)0x0) goto LAB_6b8450b4;
  uVar2 = RtlSizeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1);
  uVar1 = (undefined4)((ulonglong)uVar2 >> 0x20);
  if (((uint)uVar2 == 0xffffffff) || ((uint)uVar2 < 0xac)) goto LAB_6b8450b4;
  local_f4 = &local_e4;
  local_fc = 0x18;
  local_f8 = 0;
  local_f0 = 0x40;
  local_ec = 0;
  local_e8 = 0;
  uVar2 = NtOpenKey(&local_d0,0x20019,&local_fc);
  uVar1 = (undefined4)((ulonglong)uVar2 >> 0x20);
  if (-1 < (int)uVar2) {
    RtlInitUnicodeString(&local_dc,L"PreviousInstallLanguage");
    uVar2 = NtQueryValueKey(local_d0,&local_dc,2,local_cc,0xba,&local_d4);
    uVar1 = (undefined4)((ulonglong)uVar2 >> 0x20);
    if ((int)uVar2 < 0) {
      if ((int)uVar2 == -0x3fffffcc) {
        memset(local_cc,0,0xba);
        local_d4 = 0;
        RtlInitUnicodeString(&local_dc,L"InstallLanguage");
        uVar2 = NtQueryValueKey(local_d0,&local_dc,2,local_cc,0xba,&local_d4);
        uVar1 = (undefined4)((ulonglong)uVar2 >> 0x20);
        if (-1 < (int)uVar2) goto LAB_6b845084;
      }
    }
    else {
LAB_6b845084:
      FUN_6b844e80(param_2,param_1,(int)local_cc);
      uVar1 = extraout_EDX_00;
    }
  }
  if (local_d0 != 0) {
    NtClose(local_d0);
    uVar1 = extraout_EDX_01;
  }
LAB_6b8450b4:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar1);
  return;
}



int __fastcall
FUN_6b8450c3(uint param_1,PZZWSTR param_2,uint param_3,uint param_4,uint param_5,undefined4 param_6,
            uint *param_7)

{
  int iVar1;
  PZZWSTR pwszLanguagesBuffer;
  BOOL BVar2;
  uint uVar3;
  PZZWSTR pWVar4;
  int in_FS_OFFSET;
  ULONG local_1c;
  short *local_18;
  PZZWSTR local_14;
  ULONG local_10;
  uint local_c;
  
  local_10 = 0;
  local_1c = 0x57;
  local_c = param_1 & 0x100;
  uVar3 = -(uint)(local_c != 0) & 0x100;
  local_14 = param_2;
  local_18 = (short *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,0xae);
  if (local_18 == (short *)0x0) {
    return -0x3fffffe9;
  }
  iVar1 = FUN_6b844ef7(local_18,uVar3 + 1 & 0x100);
  pWVar4 = (PZZWSTR)0x0;
  if (iVar1 < 0) goto LAB_6b8451ac;
  pwszLanguagesBuffer = local_14;
  if (local_14 == (PZZWSTR)0x0) {
    pwszLanguagesBuffer =
         (PZZWSTR)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                  local_1c * 2);
    pWVar4 = pwszLanguagesBuffer;
    if (pwszLanguagesBuffer == (PZZWSTR)0x0) {
      iVar1 = -0x3fffffe9;
      goto LAB_6b8451ac;
    }
    BVar2 = GetSystemPreferredUILanguages
                      ((uint)(local_c == 0) * 4 + 0x404,&local_10,pwszLanguagesBuffer,&local_1c);
    if (BVar2 == 0) {
      iVar1 = -0x3fffff1b;
      goto LAB_6b8451ac;
    }
  }
  iVar1 = FUN_6b8451e5(uVar3 + 1,pwszLanguagesBuffer,local_18,param_3,param_4,param_5,param_6,
                       param_7);
LAB_6b8451ac:
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_18);
  if (pWVar4 != (PZZWSTR)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pWVar4);
  }
  return iVar1;
}



// WARNING: Could not reconcile some variable overlaps

void __fastcall
FUN_6b8451e5(uint param_1,short *param_2,short *param_3,uint param_4,uint param_5,uint param_6,
            undefined4 param_7,uint *param_8)

{
  short sVar1;
  int iVar2;
  char cVar3;
  uint uVar4;
  short *psVar5;
  int iVar6;
  FARPROC pFVar7;
  wchar_t **ppwVar8;
  short *psVar9;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 extraout_EDX_04;
  undefined4 extraout_EDX_05;
  undefined4 extraout_EDX_06;
  undefined4 extraout_EDX_07;
  undefined4 extraout_EDX_08;
  undefined4 extraout_EDX_09;
  undefined4 extraout_EDX_10;
  undefined4 extraout_EDX_11;
  undefined4 extraout_EDX_12;
  undefined4 extraout_EDX_13;
  undefined4 extraout_EDX_14;
  short *psVar10;
  uint uVar11;
  int in_FS_OFFSET;
  ulonglong uVar12;
  ulonglong uVar13;
  int *piVar14;
  undefined *puVar15;
  undefined4 *puVar16;
  undefined4 uVar17;
  undefined auStack1080 [4];
  char *local_434;
  uint local_430;
  uint local_42c;
  uint uStack1064;
  wchar_t *pwStack1060;
  int local_420;
  int local_41c;
  FARPROC pFStack1048;
  ushort local_414 [2];
  int local_410;
  short *local_40c;
  uint local_408;
  int local_404;
  wchar_t *local_400;
  short *local_3fc;
  undefined2 local_3f8 [2];
  uint local_3f4;
  FARPROC pFStack1008;
  uint local_3ec;
  short *local_3e8;
  short *local_3e4;
  short *local_3e0;
  short *local_3dc;
  short *local_3d8;
  short *local_3d4;
  undefined4 local_3d0;
  int local_3cc;
  HMODULE local_3c8;
  short *local_3c4;
  int local_3c0;
  FARPROC pFStack956;
  int iStack952;
  undefined4 local_3b4;
  HMODULE local_3b0;
  uint local_3ac;
  FARPROC local_3a8;
  undefined4 local_3a4;
  short *local_3a0;
  undefined4 uStack924;
  int iStack920;
  ushort *puStack916;
  undefined4 uStack912;
  undefined4 uStack908;
  undefined4 uStack904;
  uint *local_384;
  undefined4 local_380;
  undefined4 local_37c;
  undefined4 local_378;
  undefined4 local_374;
  wchar_t *pwStack880;
  undefined4 uStack876;
  int iStack872;
  undefined4 uStack868;
  wchar_t *pwStack864;
  undefined4 uStack860;
  int iStack856;
  undefined4 uStack852;
  wchar_t *pwStack848;
  undefined4 uStack844;
  int iStack840;
  undefined4 uStack836;
  wchar_t *pwStack832;
  undefined4 uStack828;
  int iStack824;
  undefined4 uStack820;
  uint *puStack816;
  undefined4 uStack812;
  undefined4 uStack808;
  undefined4 uStack804;
  char *pcStack800;
  undefined4 uStack796;
  char *pcStack792;
  undefined4 uStack788;
  wchar_t *pwStack784;
  undefined4 uStack780;
  int iStack776;
  undefined4 uStack772;
  uint *puStack768;
  undefined4 uStack764;
  undefined4 uStack760;
  undefined4 uStack756;
  char *pcStack752;
  undefined4 uStack748;
  char *pcStack744;
  undefined4 uStack740;
  wchar_t *pwStack736;
  undefined4 uStack732;
  int iStack728;
  undefined4 uStack724;
  uint *puStack720;
  undefined4 uStack716;
  undefined4 uStack712;
  undefined4 uStack708;
  char *pcStack704;
  undefined4 uStack700;
  char *pcStack696;
  undefined4 uStack692;
  wchar_t *pwStack688;
  undefined4 uStack684;
  int iStack680;
  undefined4 uStack676;
  char *pcStack672;
  undefined4 uStack668;
  char *pcStack664;
  undefined4 uStack660;
  uint *puStack656;
  undefined4 uStack652;
  undefined4 uStack648;
  undefined4 uStack644;
  uint *local_280;
  undefined4 local_27c;
  undefined4 local_278;
  undefined4 local_274;
  short *local_270;
  undefined4 local_26c;
  int local_268;
  undefined4 local_264;
  short *local_260;
  undefined4 local_25c;
  int local_258;
  undefined4 local_254;
  uint *local_250;
  undefined4 local_24c;
  undefined4 local_248;
  undefined4 local_244;
  undefined auStack576 [12];
  uint uStack564;
  undefined2 auStack560 [262];
  uint local_24;
  
  local_24 = DAT_6b8b0140 ^ (uint)auStack1080;
  local_3e0 = param_3;
  local_384 = param_8;
  local_3c0 = 0;
  local_40c = (short *)0x0;
  local_3e4 = (short *)0x0;
  local_3fc = (short *)0x0;
  local_3dc = (short *)0x0;
  local_404 = 0;
  local_41c = 0;
  local_3d0 = 0;
  local_3f4 = 0;
  local_400 = (wchar_t *)0x0;
  local_3b4 = 0;
  local_3b0 = (HMODULE)0x0;
  local_42c = 0;
  local_3ac = 0;
  local_3c4 = (short *)0x0;
  local_420 = 0;
  local_3c8 = (HMODULE)0x0;
  local_3a8 = (FARPROC)0x0;
  local_3cc = 0;
  local_380 = 0xf750e6c3;
  local_37c = 0x11d138ee;
  local_378 = 0xc000e585;
  local_374 = 0xee95c24f;
  local_408 = param_1;
  local_3e8 = param_2;
  uVar13 = 0;
  if ((param_4 & 0xfffffffe) == 0) {
    local_3ec = param_1 & 0xff;
    local_430 = 2;
    if (local_3ec == 1) {
      uVar13 = 0;
      if ((((param_2 != (short *)0x0) && (uVar13 = 0, param_3 != (short *)0x0)) &&
          (uVar13 = 0, *param_2 != 0)) && (uVar13 = 0, *param_3 != 0)) {
        local_434 = "OnMachineUILanguageSwitch";
LAB_6b84553b:
        if (param_2 != (short *)0x0) {
          if ((local_408 & 0x100) == 0) {
            local_40c = param_2;
            uVar12 = RtlpConvertCultureNamesToLCIDs(param_2,&local_3fc);
          }
          else {
            local_3fc = param_2;
            uVar12 = RtlpConvertLCIDsToCultureNames(param_2,&local_40c);
          }
          uVar13 = uVar12 & 0xffffffff00000000 | ZEXT48(local_3c4);
          if ((int)uVar12 < 0) goto LAB_6b845333;
        }
LAB_6b845577:
        if (param_3 != (short *)0x0) {
          if ((local_408 & 0x100) == 0) {
            local_3e4 = param_3;
            uVar12 = RtlpConvertCultureNamesToLCIDs(param_3,&local_3dc);
          }
          else {
            local_3dc = param_3;
            uVar12 = RtlpConvertLCIDsToCultureNames(param_3,&local_3e4);
          }
          uVar13 = uVar12 & 0xffffffff00000000 | ZEXT48(local_3c4);
          if ((int)uVar12 < 0) goto LAB_6b845333;
        }
LAB_6b8455af:
        uVar11 = param_5;
        if (((param_5 | param_6) != 0) &&
           (cVar3 = EtwEventEnabled(param_5,param_6,&DAT_6b887058), cVar3 != '\0')) {
          psVar10 = (short *)0x0;
          local_3d8 = (short *)0x0;
          local_3d4 = (short *)0x0;
          iVar6 = FUN_6b84640e(local_3e8,&local_3d8);
          psVar5 = local_3d8;
          if ((-1 < iVar6) &&
             (iVar6 = FUN_6b84640e(local_3e0,&local_3d4), psVar10 = local_3d4, -1 < iVar6)) {
            local_27c = 0;
            local_280 = &local_408;
            local_278 = 4;
            local_274 = 0;
            psVar9 = psVar5;
            do {
              sVar1 = *psVar9;
              psVar9 = psVar9 + 1;
            } while (sVar1 != 0);
            local_26c = 0;
            local_264 = 0;
            local_270 = psVar5;
            local_268 = ((int)psVar9 - (int)(psVar5 + 1) >> 1) * 2 + 2;
            psVar9 = local_3d4;
            do {
              sVar1 = *psVar9;
              psVar9 = psVar9 + 1;
            } while (sVar1 != (short)local_3c0);
            local_260 = local_3d4;
            local_25c = 0;
            local_254 = 0;
            local_258 = ((int)psVar9 - (int)(local_3d4 + 1) >> 1) * 2 + 2;
            local_24c = 0;
            local_250 = &param_4;
            local_248 = 4;
            local_244 = 0;
            EtwEventWrite(param_5,param_6,&DAT_6b887058,4,&local_280);
          }
          if (psVar5 != (short *)0x0) {
            RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,psVar5);
            psVar10 = local_3d4;
          }
          uVar11 = param_5;
          if (psVar10 != (short *)0x0) {
            RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,psVar10);
            uVar11 = param_5;
          }
        }
        local_3c8 = LoadLibraryW(L"wintrust.dll");
        uVar4 = local_42c;
        uVar13 = CONCAT44(extraout_EDX_06,local_3c4);
        if (local_3c8 == (HMODULE)0x0) goto LAB_6b845338;
        pFVar7 = GetProcAddress(local_3c8,"CryptCATAdminAcquireContext");
        local_3a8 = GetProcAddress(local_3c8,"CryptCATAdminReleaseContext");
        uVar4 = local_42c;
        uVar13 = CONCAT44(extraout_EDX_07,local_3c4);
        if ((pFVar7 == (FARPROC)0x0) ||
           (uVar13 = CONCAT44(extraout_EDX_07,local_3c4), local_3a8 == (FARPROC)0x0))
        goto LAB_6b845338;
        uVar17 = 0;
        puVar16 = &local_380;
        piVar14 = &local_3cc;
        _guard_check_icall();
        iVar6 = (*pFVar7)(piVar14,puVar16,uVar17);
        uVar13 = CONCAT44(extraout_EDX_08,local_3c4);
        uVar4 = local_42c;
        if (iVar6 == 0) goto LAB_6b845338;
        RtlInitUnicodeString
                  (local_414,
                   L"\\Registry\\Machine\\System\\CurrentControlSet\\Control\\MUI\\CallbackDlls");
        puStack916 = local_414;
        uStack924 = 0x18;
        iStack920 = 0;
        uStack912 = 0x40;
        uStack908 = 0;
        uStack904 = 0;
        uVar12 = NtOpenKey(&local_404,0x20019,&uStack924);
        if ((int)uVar12 < 0) {
          uVar4 = local_42c;
          uVar13 = uVar12 & 0xffffffff00000000 | ZEXT48(local_3c4);
          if ((int)uVar12 == -0x3fffffcc) {
            uVar4 = 0;
            uVar13 = uVar12 & 0xffffffff00000000 | ZEXT48(local_3c4);
          }
          goto LAB_6b845338;
        }
        iStack952 = 0x216;
        iVar6 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,0x216);
        local_420 = iVar6;
        uVar12 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,0x20a);
        local_400 = (wchar_t *)uVar12;
        uVar13 = uVar12 & 0xffffffff00000000 | ZEXT48(local_3c4);
        if ((iVar6 != 0) &&
           (uVar13 = uVar12 & 0xffffffff00000000 | ZEXT48(local_3c4), local_400 != (wchar_t *)0x0))
        {
          uStack1064 = 0x2080000;
          local_3c0 = 0;
          pwStack1060 = local_400;
          do {
            uVar13 = NtEnumerateKey(local_404,local_3c0,0,auStack576,0x1fe,&local_3d0);
            iVar6 = (int)uVar13;
            if (iVar6 < 0) {
              uVar4 = local_42c;
              uVar13 = uVar13 & 0xffffffff00000000 | ZEXT48(local_3c4);
              if (iVar6 == -0x7fffffe6) break;
LAB_6b8460da:
              local_42c = local_42c | 1;
            }
            else {
              pFStack1008 = (FARPROC)0x0;
              pFStack1048 = (FARPROC)0x0;
              pFStack956 = (FARPROC)0x0;
              if (0x1e8 < uStack564 + 1) {
LAB_6b8458bb:
                iVar6 = -0x3fffffe9;
                goto LAB_6b8460da;
              }
              *(undefined2 *)((int)auStack560 + (uStack564 & 0xfffffffe)) = 0;
              RtlInitUnicodeString(local_414,auStack560);
              iStack920 = local_404;
              puStack916 = local_414;
              uStack924 = 0x18;
              uStack912 = 0x40;
              uStack908 = 0;
              uStack904 = 0;
              iVar6 = NtOpenKey(&local_41c,0x20019,&uStack924);
              if (iVar6 < 0) goto LAB_6b8460da;
              RtlInitUnicodeString(local_414,L"Type");
              iVar6 = NtQueryValueKey(local_41c,local_414,local_430,local_420,iStack952,&local_3d0);
              if ((iVar6 < 0) || (*(int *)(local_420 + 4) != 4)) goto LAB_6b8460da;
              local_3f4 = *(uint *)(local_420 + 0xc);
              if ((local_3ec & local_3f4) != 0) {
                RtlInitUnicodeString(local_414,L"DllPath");
                iVar6 = NtQueryValueKey(local_41c,local_414,local_430,local_420,iStack952,&local_3d0
                                       );
                if (iVar6 < 0) {
                  if (iVar6 == -0x7ffffffb) {
                    iVar2 = *(int *)(local_420 + 8);
                    if (iVar2 == 0) goto LAB_6b8460da;
                    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_420);
                    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_400);
                    iStack952 = iVar2 + 0xe;
                    local_420 = RtlAllocateHeap(*(undefined4 *)
                                                 (*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,iStack952)
                    ;
                    local_400 = (wchar_t *)
                                RtlAllocateHeap(*(undefined4 *)
                                                 (*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,iVar2 + 2)
                    ;
                    if ((local_420 == 0) || (local_400 == (wchar_t *)0x0)) goto LAB_6b8458bb;
                    iVar6 = NtQueryValueKey(local_41c,local_414,local_430,local_420,iStack952,
                                            &local_3d0);
                  }
                  if (iVar6 < 0) goto LAB_6b8460da;
                }
                if (*(uint *)(local_420 + 4) == local_430) {
                  *(undefined2 *)(local_420 + 0xc + (*(uint *)(local_420 + 8) & 0xfffffffe)) = 0;
                  RtlInitUnicodeString(local_414,local_420 + 0xc);
                  iVar6 = RtlExpandEnvironmentStrings_U(0,local_414,&uStack1064,&local_3b4);
                  if (iVar6 < 0) {
                    if (iVar6 == -0x3fffffdd) {
                      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_400)
                      ;
                      pwStack1060 = (wchar_t *)
                                    RtlAllocateHeap(*(undefined4 *)
                                                     (*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                                    local_3b4);
                      local_400 = pwStack1060;
                      iVar6 = RtlExpandEnvironmentStrings_U(0,local_414,&uStack1064,&local_3b4);
                    }
                    if (iVar6 < 0) goto LAB_6b8460da;
                  }
                  pwStack1060[uStack1064 >> 1 & 0x7fff] = L'\0';
                  _wcslwr(pwStack1060);
                  cVar3 = RtlDoesFileExists_U(pwStack1060);
                  if (cVar3 == '\0') {
                    if (((uVar11 | param_6) != 0) &&
                       (cVar3 = EtwEventEnabled(uVar11,param_6,&DAT_6b887068), cVar3 != '\0')) {
                      pwStack880 = pwStack1060;
                      iStack872 = (uStack1064 & 0xffff) + local_430;
                      ppwVar8 = &pwStack880;
                      uVar17 = 1;
                      uStack876 = 0;
                      uStack868 = 0;
                      puVar15 = &DAT_6b887068;
LAB_6b845bc9:
                      EtwEventWrite(uVar11,param_6,puVar15,uVar17,ppwVar8);
                    }
                  }
                  else {
                    cVar3 = FUN_6b84676a(local_3c8,local_3cc,pwStack1060,(char)param_7);
                    if (cVar3 == '\0') {
                      local_42c = local_42c | 0x1000;
                      if (((uVar11 | param_6) == 0) ||
                         (cVar3 = EtwEventEnabled(uVar11,param_6,&DAT_6b887078), cVar3 == '\0'))
                      goto LAB_6b8460df;
                      pwStack864 = pwStack1060;
                      iStack856 = (uStack1064 & 0xffff) + local_430;
                      ppwVar8 = &pwStack864;
                      uVar17 = 1;
                      uStack860 = 0;
                      uStack852 = 0;
                      puVar15 = &DAT_6b887078;
LAB_6b845c57:
                      EtwEventWrite(uVar11,param_6,puVar15,uVar17,ppwVar8);
                      goto LAB_6b8460df;
                    }
                    local_3b0 = LoadLibraryW(pwStack1060);
                    if (local_3b0 == (HMODULE)0x0) {
                      if (((uVar11 | param_6) != 0) &&
                         (cVar3 = EtwEventEnabled(uVar11,param_6,&DAT_6b887098), cVar3 != '\0')) {
                        pwStack848 = pwStack1060;
                        iStack840 = (uStack1064 & 0xffff) + local_430;
                        ppwVar8 = &pwStack848;
                        uVar17 = 1;
                        uStack844 = 0;
                        uStack836 = 0;
                        puVar15 = &DAT_6b887098;
                        goto LAB_6b845bc9;
                      }
                    }
                    else {
                      local_3d8 = (short *)(local_3ec & 1);
                      if (local_3d8 == (short *)0x0) {
                        if ((local_3ec & 0x20) == 0) {
                          pFStack1048 = GetProcAddress(local_3b0,local_434);
                          if (pFStack1048 != (FARPROC)0x0) goto LAB_6b845f70;
                          if (((uVar11 | param_6) != 0) &&
                             (cVar3 = EtwEventEnabled(uVar11,param_6,&DAT_6b887088), cVar3 != '\0'))
                          {
                            pwStack736 = pwStack1060;
                            iStack728 = (uStack1064 & 0xffff) + local_430;
                            uStack732 = 0;
                            uStack724 = 0;
                            uStack716 = 0;
                            uStack708 = 0;
                            puStack720 = &local_3f4;
                            uStack712 = 4;
                            pcStack696 = local_434;
                            do {
                              cVar3 = *pcStack696;
                              pcStack696 = pcStack696 + 1;
                            } while (cVar3 != '\0');
                            pcStack704 = local_434;
                            uStack700 = 0;
                            uStack692 = 0;
                            pcStack696 = pcStack696 + (1 - (int)(local_434 + 1));
                            ppwVar8 = &pwStack736;
                            goto LAB_6b845db7;
                          }
                        }
                        else {
                          pFStack956 = GetProcAddress(local_3b0,local_434);
                          if (pFStack956 == (FARPROC)0x0) {
                            if (((uVar11 | param_6) != 0) &&
                               (cVar3 = EtwEventEnabled(uVar11,param_6,&DAT_6b887088), cVar3 != '\0'
                               )) {
                              pwStack784 = pwStack1060;
                              iStack776 = (uStack1064 & 0xffff) + local_430;
                              uStack780 = 0;
                              uStack772 = 0;
                              uStack764 = 0;
                              uStack756 = 0;
                              puStack768 = &local_3f4;
                              uStack760 = 4;
                              pcStack744 = local_434;
                              do {
                                cVar3 = *pcStack744;
                                pcStack744 = pcStack744 + 1;
                              } while (cVar3 != '\0');
                              pcStack752 = local_434;
                              uStack748 = 0;
                              uStack740 = 0;
                              pcStack744 = pcStack744 + (1 - (int)(local_434 + 1));
                              ppwVar8 = &pwStack784;
LAB_6b845db7:
                              uVar17 = 3;
                              puVar15 = &DAT_6b887088;
                              goto LAB_6b845bc9;
                            }
                          }
                          else {
LAB_6b845f70:
                            if (-1 < iVar6) {
                              if ((local_3f4 & 0x100) == 0) {
                                psVar5 = local_40c;
                                psVar10 = local_3e4;
                                if (local_3d8 != (short *)0x0) goto LAB_6b845fbd;
                                psVar5 = local_3e4;
                                if (((local_3ec & 0x10) != 0) ||
                                   (psVar5 = local_40c, (local_3ec & 0x20) == 0)) goto LAB_6b845ffe;
                                _guard_check_icall();
                                local_3ac = (*pFStack956)();
                              }
                              else {
                                psVar5 = local_3fc;
                                psVar10 = local_3dc;
                                if (local_3d8 == (short *)0x0) {
                                  if ((local_3ec & 0x10) != 0) {
                                    psVar5 = local_3dc;
                                  }
LAB_6b845ffe:
                                  uVar4 = param_4;
                                  _guard_check_icall();
                                  local_3ac = (*pFStack1048)(psVar5,uVar4);
                                }
                                else {
LAB_6b845fbd:
                                  uVar4 = param_4;
                                  _guard_check_icall();
                                  local_3ac = (*pFStack1008)(psVar5,psVar10,uVar4);
                                }
                              }
                              local_42c = local_42c | local_3ac;
                              if (((uVar11 | param_6) == 0) ||
                                 (cVar3 = EtwEventEnabled(uVar11,param_6,&DAT_6b887048),
                                 cVar3 == '\0')) goto LAB_6b8460df;
                              pwStack688 = pwStack1060;
                              iStack680 = (uStack1064 & 0xffff) + local_430;
                              uStack684 = 0;
                              uStack676 = 0;
                              pcStack664 = local_434;
                              do {
                                cVar3 = *pcStack664;
                                pcStack664 = pcStack664 + 1;
                              } while (cVar3 != '\0');
                              pcStack672 = local_434;
                              uStack668 = 0;
                              uStack660 = 0;
                              pcStack664 = pcStack664 + (1 - (int)(local_434 + 1));
                              uStack652 = 0;
                              puStack656 = &local_3ac;
                              ppwVar8 = &pwStack688;
                              uVar17 = 3;
                              uStack648 = 4;
                              uStack644 = 0;
                              puVar15 = &DAT_6b887048;
                              goto LAB_6b845c57;
                            }
                          }
                        }
                      }
                      else {
                        pFStack1008 = GetProcAddress(local_3b0,local_434);
                        if (pFStack1008 != (FARPROC)0x0) goto LAB_6b845f70;
                        if (((uVar11 | param_6) != 0) &&
                           (cVar3 = EtwEventEnabled(uVar11,param_6,&DAT_6b887088), cVar3 != '\0')) {
                          pwStack832 = pwStack1060;
                          iStack824 = (uStack1064 & 0xffff) + local_430;
                          uStack828 = 0;
                          uStack820 = 0;
                          uStack812 = 0;
                          uStack804 = 0;
                          puStack816 = &local_3f4;
                          uStack808 = 4;
                          pcStack792 = local_434;
                          do {
                            cVar3 = *pcStack792;
                            pcStack792 = pcStack792 + 1;
                          } while (cVar3 != '\0');
                          pcStack800 = local_434;
                          uStack796 = 0;
                          uStack788 = 0;
                          pcStack792 = pcStack792 + (1 - (int)(local_434 + 1));
                          ppwVar8 = &pwStack832;
                          goto LAB_6b845db7;
                        }
                      }
                    }
                  }
                }
                goto LAB_6b8460da;
              }
            }
LAB_6b8460df:
            if (local_41c != 0) {
              NtClose(local_41c);
              local_41c = 0;
            }
            if (local_3b0 != (HMODULE)0x0) {
              LdrUnloadDll(local_3b0);
            }
            local_3c0 = local_3c0 + 1;
            local_3b0 = (HMODULE)0x0;
            uVar4 = local_42c;
            uVar13 = ZEXT48(local_3c4);
          } while (iVar6 != -0x7fffffe6);
          goto LAB_6b845338;
        }
      }
    }
    else if ((local_3ec == 2) || (local_3ec == 4)) {
      uVar13 = 0;
      if ((param_3 == (short *)0x0) &&
         ((uVar13 = 0, param_2 != (short *)0x0 && (uVar13 = 0, *param_2 != 0)))) {
        RtlInitUnicodeString(local_414,param_2);
        uVar13 = CONCAT44(extraout_EDX_05,local_3c4);
        if (((ushort)local_430 <= local_414[0]) &&
           (uVar13 = ZEXT48(local_3c4),
           *(short *)(local_410 + 2 + (uint)(local_414[0] >> 1) * 2) == 0)) {
          if (local_3ec == local_430) {
            local_434 = "OnUILanguageAdd";
          }
          else {
            local_434 = "OnUILanguageRemove";
          }
          goto LAB_6b84553b;
        }
      }
    }
    else if (local_3ec == 8) {
      uVar13 = 0;
      if (param_3 == (short *)0x0) {
        if (param_2 == (short *)0x0) {
          local_3f8[0] = 0;
          uVar12 = NtQueryInstallUILanguage(local_3f8);
          uVar13 = uVar12 & 0xffffffff00000000 | ZEXT48(local_3c4);
          if (-1 < (int)uVar12) {
            uVar13 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,0xac);
            local_3c4 = (short *)uVar13;
            if (local_3c4 != (short *)0x0) {
              local_3a4 = 0xaa0000;
              local_3a0 = local_3c4;
              cVar3 = RtlLCIDToCultureName(local_3f8[0],&local_3a4);
              uVar13 = CONCAT44(extraout_EDX_04,local_3c4);
              if (cVar3 != '\0') {
                local_40c = local_3a0;
                uVar12 = RtlpConvertCultureNamesToLCIDs(local_3a0,&local_3fc);
                uVar13 = uVar12 & 0xffffffff00000000 | ZEXT48(local_3c4);
                if (-1 < (int)uVar12) {
                  local_408 = local_408 | 0x100;
                  goto LAB_6b845497;
                }
              }
            }
          }
        }
        else {
          uVar13 = 0;
          if (*param_2 != 0) {
LAB_6b845497:
            local_434 = "OnMachineUILanguageInit";
            param_2 = local_3e8;
            param_3 = local_3e0;
            goto LAB_6b84553b;
          }
        }
      }
    }
    else if (local_3ec == 0x10) {
      uVar13 = 0;
      if (((param_2 == (short *)0x0) && (uVar13 = 0, param_3 != (short *)0x0)) &&
         (uVar13 = 0, *param_3 != 0)) {
        local_434 = "OnMachineUILanguageClear";
        goto LAB_6b845577;
      }
    }
    else {
      uVar13 = 0;
      if (((local_3ec == 0x20) && (uVar13 = 0, param_2 == (short *)0x0)) &&
         (uVar13 = 0, param_3 == (short *)0x0)) {
        local_434 = "OnUserProfileChanged";
        goto LAB_6b8455af;
      }
    }
  }
LAB_6b845333:
  uVar4 = 1;
LAB_6b845338:
  local_3c4 = (short *)uVar13;
  if (local_384 != (uint *)0x0) {
    *local_384 = uVar4;
  }
  if (local_404 != 0) {
    NtClose(local_404);
    uVar13 = CONCAT44(extraout_EDX,local_3c4);
    local_404 = 0;
  }
  local_3c4 = (short *)uVar13;
  if (local_41c != 0) {
    NtClose(local_41c);
    uVar13 = CONCAT44(extraout_EDX_00,local_3c4);
    local_41c = 0;
  }
  local_3c4 = (short *)uVar13;
  if (local_420 != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_420);
    uVar13 = CONCAT44(extraout_EDX_01,local_3c4);
  }
  local_3c4 = (short *)uVar13;
  if (local_400 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_400);
    uVar13 = CONCAT44(extraout_EDX_02,local_3c4);
  }
  local_3c4 = (short *)uVar13;
  psVar5 = local_3c4;
  if ((local_40c != (short *)0x0) && (local_40c != local_3e8)) {
    psVar5 = (short *)(-(uint)(local_3c4 != local_40c) & (uint)local_3c4);
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_40c);
    uVar13 = CONCAT44(extraout_EDX_03,local_3c4);
  }
  local_3c4 = (short *)uVar13;
  if ((local_3fc != (short *)0x0) && (local_3fc != local_3e8)) {
    psVar5 = (short *)((uint)psVar5 & -(uint)(psVar5 != local_3fc));
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_3fc);
    uVar13 = CONCAT44(extraout_EDX_09,local_3c4);
  }
  local_3c4 = (short *)uVar13;
  if ((local_3e4 != (short *)0x0) && (local_3e4 != local_3e0)) {
    psVar5 = (short *)((uint)psVar5 & -(uint)(psVar5 != local_3e4));
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_3e4);
    uVar13 = CONCAT44(extraout_EDX_10,local_3c4);
  }
  local_3c4 = (short *)uVar13;
  if ((local_3dc != (short *)0x0) && (local_3dc != local_3e0)) {
    psVar5 = (short *)((uint)psVar5 & -(uint)(psVar5 != local_3dc));
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_3dc);
    uVar13 = CONCAT44(extraout_EDX_11,local_3c4);
  }
  local_3c4 = (short *)uVar13;
  if (psVar5 != (short *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,psVar5);
    uVar13 = CONCAT44(extraout_EDX_12,local_3c4);
  }
  pFVar7 = local_3a8;
  local_3c4 = (short *)uVar13;
  if (local_3cc != 0) {
    uVar17 = 0;
    iVar6 = local_3cc;
    _guard_check_icall();
    (*pFVar7)(iVar6,uVar17);
    uVar13 = CONCAT44(extraout_EDX_13,local_3c4);
  }
  local_3c4 = (short *)uVar13;
  if (local_3c8 != (HMODULE)0x0) {
    FreeLibrary(local_3c8);
    uVar13 = CONCAT44(extraout_EDX_14,local_3c4);
  }
  local_3c4 = (short *)uVar13;
  FUN_6b8224af(local_24 ^ (uint)auStack1080,(int)(uVar13 >> 0x20));
  return;
}



void __fastcall FUN_6b846224(HMODULE param_1,undefined4 param_2,char param_3)

{
  FARPROC pFVar1;
  FARPROC pFVar2;
  FARPROC pFVar3;
  int iVar4;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar5;
  undefined4 *puVar6;
  undefined4 uVar7;
  undefined4 *puVar8;
  undefined4 uVar9;
  undefined4 local_90;
  undefined4 local_8c;
  undefined4 uStack136;
  undefined4 uStack132;
  undefined4 local_80;
  undefined4 local_7c;
  undefined4 local_78;
  undefined4 local_74;
  undefined4 local_70;
  undefined4 local_6c;
  undefined4 *local_68;
  undefined4 local_64;
  int local_60;
  undefined4 local_58;
  undefined4 local_4c;
  int local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  FARPROC local_2c;
  undefined4 local_28;
  undefined4 local_24;
  HMODULE local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_24 = 0;
  local_28 = param_2;
  memset(&local_80,0,0x34);
  local_1c = 0xaac56b;
  local_18 = 0x11d0cd44;
  local_90 = 0;
  local_14 = 0xc000c28c;
  local_10 = 0xee95c24f;
  local_8c = 0;
  uStack136 = 0;
  uStack132 = 0;
  local_20 = LoadLibraryW(L"crypt32.dll");
  uVar5 = extraout_EDX;
  if (local_20 != (HMODULE)0x0) {
    pFVar1 = GetProcAddress(param_1,"WinVerifyTrust");
    pFVar2 = GetProcAddress(param_1,"WTHelperProvDataFromStateData");
    pFVar3 = GetProcAddress(param_1,"WTHelperGetProvSignerFromChain");
    local_2c = GetProcAddress(local_20,"CertVerifyCertificateChainPolicy");
    if ((((pFVar1 != (FARPROC)0x0) && (pFVar2 != (FARPROC)0x0)) && (pFVar3 != (FARPROC)0x0)) &&
       (local_2c != (FARPROC)0x0)) {
      local_8c = local_28;
      local_68 = &local_90;
      puVar8 = &local_80;
      puVar6 = &local_1c;
      local_90 = 0x10;
      local_58 = 0x10;
      uVar5 = 0xffffffff;
      local_80 = 0x34;
      local_7c = 0;
      local_78 = 0;
      local_6c = 1;
      local_74 = 2;
      local_70 = 0;
      local_64 = 1;
      _guard_check_icall();
      iVar4 = (*pFVar1)(uVar5,puVar6,puVar8);
      if (iVar4 == 0) {
        iVar4 = local_60;
        _guard_check_icall();
        iVar4 = (*pFVar2)(iVar4);
        if (iVar4 != 0) {
          uVar9 = 0;
          uVar7 = 0;
          uVar5 = 0;
          _guard_check_icall();
          iVar4 = (*pFVar3)(iVar4,uVar5,uVar7,uVar9);
          pFVar2 = local_2c;
          if (iVar4 != 0) {
            local_38 = 0xc;
            local_30 = 0;
            local_48 = 0;
            local_44 = 0;
            local_40 = 0;
            local_3c = 0;
            local_34 = 0;
            if (param_3 != '\0') {
              local_34 = 0x10000;
            }
            puVar8 = &local_4c;
            puVar6 = &local_38;
            local_4c = 0x14;
            uVar5 = *(undefined4 *)(iVar4 + 0x28);
            uVar7 = 7;
            _guard_check_icall();
            iVar4 = (*pFVar2)(uVar7,uVar5,puVar6,puVar8);
            if ((iVar4 != 0) && (local_48 == 0)) {
              local_24 = 1;
            }
          }
        }
        if (local_60 != 0) {
          puVar8 = &local_80;
          local_64 = 2;
          puVar6 = &local_1c;
          uVar5 = 0;
          _guard_check_icall();
          (*pFVar1)(uVar5,puVar6,puVar8);
        }
      }
    }
    FreeLibrary(local_20);
    uVar5 = extraout_EDX_00;
  }
  FUN_6b8224af(local_c ^ (uint)&stack0xfffffffc,uVar5);
  return;
}



undefined4 __fastcall FUN_6b84640e(short *param_1,short **param_2)

{
  short *psVar1;
  short *_Dst;
  int iVar2;
  uint uVar3;
  int in_FS_OFFSET;
  undefined4 local_10;
  int local_c;
  int local_8;
  
  local_c = 0;
  uVar3 = 0x156;
  local_8 = 0;
  local_10 = 0;
  if ((param_2 == (short **)0x0) || (*param_2 != (short *)0x0)) {
    local_10 = 0xc000000d;
  }
  else {
    if ((param_1 == (short *)0x0) || (*param_1 == 0)) {
      uVar3 = 8;
    }
    _Dst = (short *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,
                                    uVar3 * 2);
    *_Dst = 0;
    *param_2 = _Dst;
    if ((param_1 == (short *)0x0) || (*param_1 == 0)) {
      FUN_6b812c57(_Dst,uVar3,(int)L"(null)");
    }
    else {
      do {
        iVar2 = FUN_6b84097e(param_1,uVar3 - local_c,&local_8);
        if ((iVar2 < 0) || (uVar3 < (uint)(((int)_Dst - (int)*param_2 >> 1) + 1 + local_8))) {
          if (_Dst == (short *)0x0) {
            return 0x80000005;
          }
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,_Dst);
          return 0x80000005;
        }
        memcpy(_Dst,param_1,local_8 * 2 + 2);
        local_c = local_c + 1 + local_8;
        param_1 = param_1 + local_8 + 1;
        psVar1 = _Dst + local_8;
        _Dst = psVar1 + 1;
      } while ((*param_1 != 0) && (*psVar1 = 0x2c, *param_1 != 0));
      local_10 = 0;
    }
  }
  return local_10;
}



BOOL NotifyUILanguageChange
               (DWORD dwFlags,PCWSTR pcwstrNewLanguage,PCWSTR pcwstrPreviousLanguage,
               DWORD dwReserved,PDWORD pdwStatusRtrn)

{
  char cVar1;
  int iVar2;
  DWORD dwErrCode;
  BOOL BVar3;
  undefined4 extraout_EDX;
  uint local_30;
  uint local_2c;
  undefined4 local_28;
  DWORD local_24;
  uint local_20;
  uint local_1c;
  DWORD *local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  uint local_8;
  
                    // 0x46530  1022  NotifyUILanguageChange
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_28 = 0;
  local_20 = 0;
  local_1c = 0;
  local_30 = 0;
  local_2c = local_2c & 0xffffff00;
  iVar2 = EtwEventRegister(&DAT_6b8870b8,0,0,&local_20);
  if (iVar2 != 0) {
    local_20 = 0;
    local_1c = 0;
  }
  if (((local_20 | local_1c) != 0) &&
     (cVar1 = EtwEventEnabled(local_20,local_1c,&DAT_6b887038), cVar1 != '\0')) {
    local_18 = (DWORD *)0x6b887ed0;
    local_14 = 0;
    local_10 = 0x36;
    local_c = 0;
    EtwEventWrite(local_20,local_1c,&DAT_6b887038,1,&local_18);
  }
  if (pcwstrNewLanguage == (PCWSTR)0x0) {
LAB_6b846705:
    local_24 = FUN_6b844ec2((byte *)&local_2c);
    if (((-1 < (int)local_24) &&
        (local_24 = FUN_6b8451e5(dwFlags,pcwstrNewLanguage,pcwstrPreviousLanguage,dwReserved,
                                 local_20,local_1c,local_2c,pdwStatusRtrn), -1 < (int)local_24)) &&
       ((dwFlags & 8) != 0)) {
      local_24 = FUN_6b8450c3(dwFlags,pcwstrNewLanguage,dwReserved,local_20,local_1c,local_2c,
                              pdwStatusRtrn);
    }
  }
  else {
    local_24 = RtlGetUILanguageInfo
                         ((-(uint)((dwFlags & 0x100) != 0) & 0xfffffffc) + 0x88,pcwstrNewLanguage,0,
                          0,&local_30);
    if ((dwFlags & 4) == 0) {
      if (-1 < (int)local_24) goto LAB_6b8466f0;
    }
    else if (local_24 == 0xc0000034) {
LAB_6b8466f0:
      if ((dwFlags & 8) == 0 || (local_30 & 4) == 0) goto LAB_6b846705;
    }
    local_24 = 0xc000000d;
  }
  dwErrCode = RtlNtStatusToDosError(local_24);
  SetLastError(dwErrCode);
  if (local_24 != 0) {
    if (pdwStatusRtrn != (PDWORD)0x0) {
      *pdwStatusRtrn = local_24;
    }
    if ((local_20 | local_1c) == 0) goto LAB_6b8466cd;
    cVar1 = EtwEventEnabled(local_20,local_1c,&DAT_6b8870a8);
    if (cVar1 != '\0') {
      local_14 = 0;
      local_18 = &local_24;
      local_c = 0;
      local_10 = 4;
      EtwEventWrite(local_20,local_1c,&DAT_6b8870a8,1,&local_18);
    }
  }
  if (((local_20 | local_1c) != 0) &&
     (cVar1 = EtwEventEnabled(local_20,local_1c,&DAT_6b887028), cVar1 != '\0')) {
    local_14 = 0;
    local_c = 0;
    local_18 = (DWORD *)0x6b887ed0;
    local_10 = 0x36;
    EtwEventWrite(local_20,local_1c,&DAT_6b887028,1,&local_18);
  }
LAB_6b8466cd:
  EtwEventUnregister(local_20,local_1c);
  BVar3 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,extraout_EDX);
  return BVar3;
}



void __fastcall FUN_6b84676a(HMODULE param_1,int param_2,LPCWSTR param_3,char param_4)

{
  FARPROC pFVar1;
  FARPROC pFVar2;
  DWORD DVar3;
  int iVar4;
  int extraout_EDX;
  int extraout_EDX_00;
  int extraout_EDX_01;
  int extraout_EDX_02;
  int extraout_EDX_03;
  HLOCAL hMem;
  undefined8 uVar5;
  undefined4 *puVar6;
  HANDLE pvVar7;
  undefined4 *puVar8;
  HLOCAL pvVar9;
  SIZE_T *pSVar10;
  undefined4 uVar11;
  SIZE_T SVar12;
  FARPROC *ppFVar13;
  undefined4 local_2c0;
  LPCWSTR local_2bc;
  HANDLE local_2b8;
  undefined4 local_2b4;
  undefined4 local_2b0;
  undefined4 local_2ac;
  undefined *local_2a8;
  LPCWSTR local_2a4;
  undefined4 local_2a0;
  undefined4 local_29c;
  HLOCAL local_298;
  SIZE_T local_294;
  undefined4 local_290;
  undefined4 local_28c;
  undefined4 local_288;
  undefined4 local_284;
  undefined4 local_280;
  undefined4 local_27c;
  undefined4 local_278;
  undefined4 local_274;
  undefined4 *local_270;
  undefined4 local_26c;
  undefined4 local_268;
  undefined4 local_264;
  undefined4 local_260;
  undefined4 local_25c;
  undefined4 local_258;
  FARPROC local_254;
  FARPROC local_250;
  int local_24c;
  FARPROC local_248;
  FARPROC local_244;
  FARPROC local_240;
  HANDLE local_23c;
  LPCWSTR local_238;
  SIZE_T local_234;
  FARPROC local_230;
  undefined4 local_22c;
  undefined local_228 [528];
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_23c = (HANDLE)0xffffffff;
  hMem = (HLOCAL)0x0;
  local_238 = param_3;
  local_18 = 0xf750e6c3;
  local_14 = 0x11d138ee;
  local_10 = 0xc000e585;
  local_c = 0xee95c24f;
  local_24c = param_2;
  if ((param_1 != (HMODULE)0x0) && (param_2 != 0)) {
    local_230 = GetProcAddress(param_1,"CryptCATAdminCalcHashFromFileHandle");
    pFVar1 = GetProcAddress(param_1,"CryptCATAdminEnumCatalogFromHash");
    local_244 = pFVar1;
    local_240 = GetProcAddress(param_1,"CryptCATCatalogInfoFromContext");
    pFVar2 = GetProcAddress(param_1,"WinVerifyTrust");
    local_250 = pFVar2;
    local_254 = GetProcAddress(param_1,"CryptCATAdminReleaseCatalogContext");
    if ((local_230 == (FARPROC)0x0) ||
       ((((pFVar1 == (FARPROC)0x0 || (local_240 == (FARPROC)0x0)) || (pFVar2 == (FARPROC)0x0)) ||
        ((local_254 == (FARPROC)0x0 ||
         (local_23c = CreateFileW(local_238,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,
                                  (HANDLE)0x0), local_23c == (HANDLE)0xffffffff)))))) {
      GetLastError();
      param_2 = extraout_EDX;
      goto LAB_6b846b60;
    }
    local_288 = 0x34;
    local_270 = &local_2b0;
    local_280 = 0;
    local_268 = 0;
    local_264 = 0;
    local_25c = 0;
    local_258 = 0;
    local_27c = 2;
    local_278 = 0;
    local_26c = 3;
    local_260 = 0x10;
    local_284 = 0;
    local_234 = 100;
    do {
      hMem = LocalAlloc(0,local_234);
      pFVar1 = local_230;
      if (hMem == (HLOCAL)0x0) goto LAB_6b84693b;
      pSVar10 = &local_234;
      uVar11 = 0;
      pvVar7 = local_23c;
      pvVar9 = hMem;
      _guard_check_icall();
      iVar4 = (*pFVar1)(pvVar7,pSVar10,pvVar9,uVar11);
      if (iVar4 != 0) {
        local_2a4 = local_238;
        local_274 = 2;
        local_2ac = 0;
        local_2a8 = (undefined *)0x0;
        local_2a0 = 0;
        local_29c = 0;
        local_290 = 0;
        local_28c = 0;
        local_2b0 = 0x28;
        local_294 = local_234;
        local_248 = (FARPROC)0x0;
        pFVar1 = local_244;
        local_298 = hMem;
        goto LAB_6b846afb;
      }
      DVar3 = GetLastError();
      LocalFree(hMem);
    } while (DVar3 == 0x7a);
    hMem = (HLOCAL)0x0;
LAB_6b84693b:
    pFVar1 = local_250;
    local_270 = &local_2c0;
    local_2b4 = 0;
    local_2bc = local_238;
    local_2b8 = local_23c;
    puVar8 = &local_288;
    puVar6 = &local_18;
    local_274 = 1;
    uVar11 = 0;
    local_2c0 = 0x10;
    _guard_check_icall();
    iVar4 = (*pFVar1)(uVar11,puVar6,puVar8);
    param_2 = extraout_EDX_00;
    if (iVar4 == 0) {
      uVar5 = FUN_6b846224(param_1,local_238,param_4);
      param_2 = (int)((ulonglong)uVar5 >> 0x20);
    }
  }
LAB_6b846b43:
  if (hMem != (HLOCAL)0x0) {
    LocalFree(hMem);
    param_2 = extraout_EDX_02;
  }
  if (local_23c != (HANDLE)0xffffffff) {
    CloseHandle(local_23c);
    param_2 = extraout_EDX_03;
  }
LAB_6b846b60:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
LAB_6b846afb:
  ppFVar13 = &local_248;
  uVar11 = 0;
  iVar4 = local_24c;
  pvVar9 = hMem;
  SVar12 = local_234;
  _guard_check_icall();
  pFVar2 = (FARPROC)(*pFVar1)(iVar4,pvVar9,SVar12,uVar11,ppFVar13);
  local_230 = pFVar2;
  if (pFVar2 == (FARPROC)0x0) goto LAB_6b84693b;
  uVar11 = 0;
  puVar6 = &local_22c;
  local_22c = 0x20c;
  _guard_check_icall();
  iVar4 = (*local_240)(pFVar2,puVar6,uVar11);
  pFVar2 = local_250;
  if (iVar4 != 0) {
    local_2a8 = local_228;
    puVar8 = &local_288;
    local_26c = 4;
    puVar6 = &local_18;
    uVar11 = 0;
    _guard_check_icall();
    (*pFVar2)(uVar11,puVar6,puVar8);
    local_26c = 0;
    local_2a8 = local_228;
    puVar8 = &local_288;
    puVar6 = &local_18;
    uVar11 = 0;
    _guard_check_icall();
    iVar4 = (*pFVar2)(uVar11,puVar6,puVar8);
    pFVar1 = local_244;
    if ((iVar4 == 0) &&
       (iVar4 = FUN_6b846224(param_1,local_228,param_4), pFVar2 = local_254, pFVar1 = local_244,
       iVar4 != 0)) {
      uVar11 = 0;
      iVar4 = local_24c;
      pFVar1 = local_230;
      _guard_check_icall();
      (*pFVar2)(iVar4,pFVar1,uVar11);
      param_2 = extraout_EDX_01;
      goto LAB_6b846b43;
    }
  }
  local_248 = local_230;
  goto LAB_6b846afb;
}



bool __fastcall FUN_6b846b76(undefined4 *param_1,int param_2)

{
  int iVar1;
  undefined4 local_2c [6];
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  if (param_1 != (undefined4 *)0x0) {
    iVar1 = FUN_6b846cda(param_1[2],param_1[3],param_1[4]);
    if (iVar1 + param_2 < 0) {
      SetLastError(0x120);
    }
    else {
      iVar1 = FUN_6b846e38(iVar1 + param_2,local_2c);
      if (iVar1 != 0) {
        local_2c[0] = *param_1;
        local_14 = param_1[6];
        local_10 = param_1[7];
        local_c = param_1[8];
        local_8 = param_1[9];
        iVar1 = FUN_6b84287b(param_1,local_2c);
        return iVar1 != 0;
      }
    }
  }
  return false;
}



undefined4 __fastcall FUN_6b846bef(int param_1,undefined2 *param_2)

{
  if (*(uint *)(param_1 + 8) < 0x641) {
    SetLastError(0x120);
    return 0;
  }
  *param_2 = *(undefined2 *)(param_1 + 8);
  param_2[1] = *(undefined2 *)(param_1 + 0xc);
  param_2[3] = *(undefined2 *)(param_1 + 0x10);
  param_2[4] = *(undefined2 *)(param_1 + 0x18);
  param_2[5] = *(undefined2 *)(param_1 + 0x1c);
  param_2[6] = *(undefined2 *)(param_1 + 0x20);
  param_2[7] = (short)((ulonglong)*(uint *)(param_1 + 0x24) / 10000);
  param_2[2] = *(undefined2 *)(param_1 + 0x14);
  return 1;
}



undefined4 __fastcall FUN_6b846c58(ushort *param_1,undefined4 param_2,undefined4 *param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_30;
  undefined4 local_2c;
  uint local_28;
  uint local_24;
  uint local_20;
  uint local_1c;
  uint local_18;
  uint local_14;
  uint local_10;
  int local_c;
  
  local_28 = (uint)*param_1;
  local_24 = (uint)param_1[1];
  local_20 = (uint)param_1[3];
  local_18 = (uint)param_1[4];
  local_14 = (uint)param_1[5];
  local_10 = (uint)param_1[6];
  local_c = (uint)param_1[7] * 10000;
  uVar2 = 0;
  local_1c = (uint)param_1[2];
  local_2c = 1;
  local_30 = param_2;
  iVar1 = FUN_6b84719b((int)&local_30,1);
  if (iVar1 == 0) {
    SetLastError(0x57);
  }
  else {
    iVar1 = FUN_6b84287b(param_3,&local_30);
    if (iVar1 != 0) {
      uVar2 = 1;
    }
  }
  return uVar2;
}



int __fastcall FUN_6b846cda(uint param_1,int param_2,int param_3)

{
  int iVar1;
  int iVar2;
  
  if (((param_1 & 3) == 0) &&
     (((int)((ulonglong)param_1 % 100) != 0 ||
      ((int)(((ulonglong)param_1 % 100 << 0x20 | (ulonglong)param_1) % 400) == 0)))) {
    iVar2 = *(int *)(&DAT_6b88809c + param_2 * 4);
  }
  else {
    iVar2 = *(int *)(&DAT_6b8880dc + param_2 * 4);
  }
  iVar1 = param_1 - 1;
  return iVar1 / 4 + param_3 + ((iVar2 + iVar1 / 400) - iVar1 / 100) + iVar1 * 0x16d + -1;
}



uint __fastcall FUN_6b846d3f(int param_1)

{
  int iVar1;
  
  if (param_1 == 0) {
    return 0xffffffff;
  }
  iVar1 = FUN_6b846cda(*(uint *)(param_1 + 8),*(int *)(param_1 + 0xc),*(int *)(param_1 + 0x10));
  return (iVar1 + 1U) % 7;
}



int __fastcall FUN_6b846d60(int param_1)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  
  uVar1 = *(uint *)(param_1 + 8);
  iVar2 = FUN_6b846cda(uVar1,*(int *)(param_1 + 0xc),*(int *)(param_1 + 0x10));
  iVar3 = FUN_6b846cda(uVar1,1,1);
  return (1 - iVar3) + iVar2;
}



int __fastcall FUN_6b846d8b(int param_1,uint param_2,int param_3)

{
  int iVar1;
  
  iVar1 = FUN_6b8472ad(param_2,param_3);
  if (iVar1 != 0) {
    if (param_1 - 1U < 0xc) {
      iVar1 = FUN_6b844b0b(param_2);
      if (iVar1 != 0) {
        return *(int *)(&DAT_6b8880a0 + param_1 * 4) - *(int *)(&DAT_6b88809c + param_1 * 4);
      }
      return *(int *)(&DAT_6b8880e0 + param_1 * 4) - *(int *)(&DAT_6b8880dc + param_1 * 4);
    }
    SetLastError(0x57);
  }
  return 0;
}



int __fastcall FUN_6b846de7(uint param_1,int param_2)

{
  int iVar1;
  
  iVar1 = FUN_6b8472ad(param_1,param_2);
  if (iVar1 != 0) {
    iVar1 = FUN_6b84715a(param_1,param_2);
    iVar1 = (iVar1 != 0) + 0x16d;
  }
  return iVar1;
}



int __fastcall FUN_6b846e0f(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  
  iVar1 = FUN_6b846cda(*(uint *)(param_1 + 8),*(int *)(param_1 + 0xc),*(int *)(param_1 + 0x10));
  iVar2 = FUN_6b846cda(*(uint *)(param_2 + 8),*(int *)(param_2 + 0xc),*(int *)(param_2 + 0x10));
  return iVar2 - iVar1;
}



undefined4 __fastcall FUN_6b846e38(int param_1,undefined4 *param_2)

{
  bool bVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  undefined4 local_38;
  undefined4 local_34;
  int local_30;
  int local_2c;
  int local_28;
  uint local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 *local_10;
  int local_c;
  undefined4 local_8;
  
  uVar6 = 0;
  iVar2 = (param_1 % 0x23ab1) / 0x8eac;
  if (iVar2 == 4) {
    iVar2 = 3;
  }
  local_8 = 0x16d;
  iVar5 = param_1 % 0x23ab1 + iVar2 * -0x8eac;
  iVar3 = iVar5 / 0x5b5;
  iVar5 = iVar5 % 0x5b5;
  iVar4 = iVar5 / 0x16d;
  if (iVar4 == 4) {
    iVar4 = 3;
  }
  local_30 = ((iVar2 + (param_1 / 0x23ab1) * 4) * 0x19 + iVar3) * 4 + 1 + iVar4;
  iVar5 = iVar5 + iVar4 * -0x16d;
  if ((iVar4 == 3) && ((iVar3 != 0x18 || (iVar2 == 3)))) {
    bVar1 = true;
  }
  else {
    bVar1 = false;
  }
  local_2c = (iVar5 >> 5) + 1;
  if (bVar1) {
    for (; *(int *)(&DAT_6b8880a0 + local_2c * 4) <= iVar5; local_2c = local_2c + 1) {
    }
    iVar2 = *(int *)(&DAT_6b88809c + local_2c * 4);
  }
  else {
    for (; *(int *)(&DAT_6b8880e0 + local_2c * 4) <= iVar5; local_2c = local_2c + 1) {
    }
    iVar2 = *(int *)(&DAT_6b8880dc + local_2c * 4);
  }
  local_28 = (iVar5 - iVar2) + 1;
  local_38 = 1;
  local_34 = 1;
  local_20 = 0;
  local_1c = 0;
  local_18 = 0;
  local_14 = 0;
  local_10 = param_2;
  local_c = local_30;
  iVar2 = FUN_6b84719b((int)&local_38,0);
  if (iVar2 != 0) {
    local_24 = FUN_6b846d3f((int)&local_38);
    iVar2 = FUN_6b84287b(local_10,&local_38);
    if (iVar2 != 0) {
      uVar6 = 1;
    }
  }
  return uVar6;
}



undefined4 __fastcall FUN_6b846f5e(int param_1,int param_2)

{
  *(undefined4 *)(param_1 + 0x18) = 0;
  *(undefined4 *)(param_1 + 4) = 1;
  *(undefined4 *)(param_1 + 8) = 1;
  *(undefined4 *)(param_1 + 0xc) = 1;
  *(undefined4 *)(param_1 + 0x10) = 1;
  *(undefined4 *)(param_1 + 0x14) = 1;
  *(undefined4 *)(param_1 + 0x1c) = 0;
  *(undefined4 *)(param_1 + 0x20) = 0;
  *(undefined4 *)(param_1 + 0x24) = 0;
  *(undefined4 *)(param_2 + 4) = 1;
  *(undefined4 *)(param_2 + 8) = 9999;
  *(undefined4 *)(param_2 + 0xc) = 0xc;
  *(undefined4 *)(param_2 + 0x10) = 0x1f;
  *(undefined4 *)(param_2 + 0x14) = 5;
  *(undefined4 *)(param_2 + 0x18) = 0x17;
  *(undefined4 *)(param_2 + 0x1c) = 0x3b;
  *(undefined4 *)(param_2 + 0x20) = 0x3b;
  *(undefined4 *)(param_2 + 0x24) = 9999999;
  return 1;
}



void __fastcall FUN_6b846fbb(uint *param_1,int param_2,int param_3)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  int extraout_EDX;
  int extraout_EDX_00;
  uint local_30 [10];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  iVar1 = FUN_6b842bde(param_1);
  UpdateCalendarDayOfWeek(param_1);
  iVar3 = param_1[5] - (iVar1 + -1) % 7;
  uVar4 = ((param_2 - iVar3) + 0xeU) % 7;
  if ((uVar4 != 0) && (param_3 <= (int)uVar4)) {
    uVar4 = uVar4 - 7;
  }
  iVar1 = (iVar1 + -1) - uVar4;
  if (iVar1 < 0) {
    uVar4 = param_1[2];
    uVar2 = FUN_6b84315a(*param_1);
    if (uVar2 < uVar4) {
      uVar4 = FUN_6b842d2e(*param_1,uVar4 - 1,param_1[1]);
    }
    else {
      uVar4 = 0x16d;
    }
    uVar2 = (uint)(param_2 + 0xe + ((int)uVar4 % 7 - iVar3)) % 7;
    if ((uVar2 != 0) && (param_3 <= (int)uVar2)) {
      uVar2 = uVar2 - 7;
    }
    iVar1 = uVar4 - uVar2;
    if (iVar1 < 0) {
      FUN_6b84287b(local_30,param_1);
      uVar4 = AdjustCalendarDate(local_30,4,~uVar4);
      iVar1 = extraout_EDX;
      if (uVar4 != 0) {
        FUN_6b846fbb(local_30,param_2,param_3);
        iVar1 = extraout_EDX_00;
      }
      goto LAB_6b84708e;
    }
  }
  iVar1 = iVar1 % 7;
LAB_6b84708e:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,iVar1);
  return;
}



undefined4 __fastcall FUN_6b84709f(uint param_1,int param_2,uint param_3,int param_4)

{
  int iVar1;
  uint uVar2;
  
  iVar1 = FUN_6b8472ad(param_3,param_4);
  if (iVar1 != 0) {
    if (param_2 - 1U < 0xc) {
      iVar1 = FUN_6b84715a(param_3,param_4);
      if (iVar1 == 0) {
        uVar2 = *(int *)(&DAT_6b8880e0 + param_2 * 4) - *(int *)(&DAT_6b8880dc + param_2 * 4);
      }
      else {
        uVar2 = *(int *)(&DAT_6b8880a0 + param_2 * 4) - *(int *)(&DAT_6b88809c + param_2 * 4);
      }
      if (param_1 <= uVar2) {
        SetLastError(0);
        if (iVar1 == 0) {
          return 0;
        }
        if (param_2 != 2) {
          return 0;
        }
        if (param_1 != 0x1d) {
          return 0;
        }
        return 1;
      }
    }
    SetLastError(0x57);
  }
  return 0;
}



undefined4 __fastcall FUN_6b847127(int param_1,int param_2,int param_3)

{
  int iVar1;
  DWORD dwErrCode;
  
  iVar1 = FUN_6b8472ad(param_2,param_3);
  if (iVar1 != 0) {
    if (param_1 - 1U < 0xc) {
      dwErrCode = 0;
    }
    else {
      dwErrCode = 0x57;
    }
    SetLastError(dwErrCode);
  }
  return 0;
}



undefined4 __fastcall FUN_6b84715a(uint param_1,int param_2)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = FUN_6b8472ad(param_1,param_2);
  if (iVar1 == 0) {
    return 0;
  }
  uVar2 = 0;
  SetLastError(0);
  if ((param_1 & 3) == 0) {
    if (((int)((ulonglong)param_1 % 100) != 0) ||
       ((int)(((ulonglong)param_1 % 100 << 0x20 | (ulonglong)param_1) % 400) == 0)) {
      uVar2 = 1;
    }
  }
  return uVar2;
}



undefined4 __thiscall FUN_6b84719b(int this,int param_2)

{
  bool bVar1;
  byte bVar2;
  undefined3 extraout_var;
  undefined3 extraout_var_00;
  uint uVar3;
  DWORD dwErrCode;
  
  if (this == 0) {
    return 0;
  }
  if (*(int *)(this + 4) == 1) {
    if (0x270e < *(uint *)(this + 8) - 1) {
      dwErrCode = 0x120;
      goto LAB_6b8471fd;
    }
    bVar1 = FUN_6b84720b(*(uint *)(this + 0x10),*(int *)(this + 0xc),*(uint *)(this + 8));
    if (CONCAT31(extraout_var,bVar1) == 0) {
      return 0;
    }
    bVar2 = FUN_6b84726e(this);
    if (CONCAT31(extraout_var_00,bVar2) == 0) {
      return 0;
    }
    if (((param_2 == 0) || (*(int *)(this + 0x14) == -1)) ||
       (uVar3 = FUN_6b846d3f(this), *(uint *)(this + 0x14) == uVar3)) {
      return 1;
    }
  }
  dwErrCode = 0x57;
LAB_6b8471fd:
  SetLastError(dwErrCode);
  return 0;
}



bool __fastcall FUN_6b84720b(uint param_1,int param_2,uint param_3)

{
  int iVar1;
  bool bVar2;
  
  if (param_2 - 1U < 0xc) {
    iVar1 = FUN_6b84715a(param_3,1);
    if (iVar1 != 0) {
      bVar2 = param_1 <=
              (uint)(*(int *)(&DAT_6b8880a0 + param_2 * 4) - *(int *)(&DAT_6b88809c + param_2 * 4));
      goto LAB_6b847259;
    }
    if (param_1 <=
        (uint)(*(int *)(&DAT_6b8880e0 + param_2 * 4) - *(int *)(&DAT_6b8880dc + param_2 * 4))) {
      return true;
    }
  }
  bVar2 = false;
LAB_6b847259:
  if (!bVar2) {
    SetLastError(0x57);
  }
  return bVar2;
}



byte __fastcall FUN_6b84726e(int param_1)

{
  byte bVar1;
  
  bVar1 = ~-(9999999 < *(uint *)(param_1 + 0x24)) &
          ~-(0x3b < *(uint *)(param_1 + 0x20)) &
          ~-(0x3b < *(uint *)(param_1 + 0x1c)) & *(uint *)(param_1 + 0x18) < 0x18;
  if (bVar1 == 0) {
    SetLastError(0x57);
  }
  return bVar1;
}



undefined4 __fastcall FUN_6b8472ad(int param_1,int param_2)

{
  DWORD dwErrCode;
  
  if (param_2 == 1) {
    if (param_1 - 1U < 9999) {
      return 1;
    }
    dwErrCode = 0x120;
  }
  else {
    dwErrCode = 0x57;
  }
  SetLastError(dwErrCode);
  return 0;
}



uint __fastcall FUN_6b8472cf(int param_1)

{
  int iVar1;
  uint uVar2;
  
  iVar1 = FUN_6b84719b(param_1,0);
  if (iVar1 == 0) {
    return 0;
  }
  uVar2 = FUN_6b846d3f(param_1);
  if (uVar2 != 0xffffffff) {
    *(uint *)(param_1 + 0x14) = uVar2;
    uVar2 = 1;
  }
  return uVar2;
}



undefined4 __fastcall FUN_6b8472f5(uint *param_1,int param_2,int param_3)

{
  bool bVar1;
  int iVar2;
  undefined3 extraout_var;
  undefined3 extraout_var_00;
  uint local_30 [2];
  ushort local_28;
  uint local_24;
  uint local_20;
  uint local_1c;
  
  iVar2 = FUN_6b847376(local_30,param_1);
  if (iVar2 != 0) {
    if (param_2 == 2) {
      iVar2 = FUN_6b842544(local_30,param_3);
    }
    else {
      bVar1 = FUN_6b846b76(local_30,param_3);
      iVar2 = CONCAT31(extraout_var,bVar1);
    }
    if ((iVar2 != 0) &&
       (bVar1 = FUN_6b8479ca(*param_1,local_28,(ushort)local_24,(ushort)local_20,(int)param_1),
       CONCAT31(extraout_var_00,bVar1) != 0)) {
      param_1[3] = local_24;
      param_1[4] = local_20;
      param_1[5] = local_1c;
      iVar2 = FUN_6b847887(param_1,0);
      if (iVar2 != 0) {
        return 1;
      }
      RtlSetLastWin32Error(0x120);
    }
  }
  return 0;
}



void __fastcall FUN_6b847376(undefined4 *param_1,uint *param_2)

{
  int iVar1;
  
  iVar1 = FUN_6b847633(*param_2,param_2[2],param_2[1]);
  FUN_6b84287b(param_1,param_2);
  param_1[2] = iVar1;
  *param_1 = 1;
  param_1[1] = 1;
  return;
}



undefined4 __fastcall FUN_6b8473a6(ushort *param_1,uint *param_2)

{
  uint uVar1;
  bool bVar2;
  int iVar3;
  undefined3 extraout_var;
  uint *puVar4;
  uint *puVar5;
  uint local_2c [2];
  ushort local_24;
  ushort local_20;
  ushort local_1c;
  
  iVar3 = FUN_6b846c58(param_1,1,local_2c);
  if (iVar3 != 0) {
    uVar1 = *param_2;
    puVar4 = local_2c;
    puVar5 = param_2;
    for (iVar3 = 10; iVar3 != 0; iVar3 = iVar3 + -1) {
      *puVar5 = *puVar4;
      puVar4 = puVar4 + 1;
      puVar5 = puVar5 + 1;
    }
    *param_2 = uVar1;
    bVar2 = FUN_6b8479ca(uVar1,local_24,local_20,local_1c,(int)param_2);
    if (CONCAT31(extraout_var,bVar2) != 0) {
      return 1;
    }
  }
  return 0;
}



undefined4 __fastcall FUN_6b8473f2(undefined4 param_1,int param_2,uint param_3,uint *param_4)

{
  ushort uVar1;
  int iVar2;
  int iVar3;
  ushort *puVar4;
  uint uVar5;
  uint uVar6;
  
  uVar6 = 0;
  iVar2 = GetCalendar(0,param_1);
  if (iVar2 != 0) {
    iVar3 = KernelBaseGetGlobalData();
    puVar4 = (ushort *)
             GetPtrCalDataArray(param_1,*(undefined4 *)(iVar3 + 0x30),*(undefined4 *)(iVar2 + 0x14))
    ;
    if (*puVar4 != 0) {
      do {
        if (param_3 <= uVar6) break;
        iVar2 = KernelBaseGetGlobalData();
        iVar2 = GetPtrCalData(param_1,*(undefined4 *)(iVar2 + 0x30),puVar4 + 1,uVar6 + 1);
        uVar1 = *(ushort *)(iVar2 + 10);
        if ((short)uVar1 < 0) {
          uVar5 = -(uint)uVar1;
        }
        else {
          uVar5 = uVar1 + 1;
        }
        *(uint *)(param_2 + uVar6 * 4) = uVar5 & 0xffff;
        uVar6 = uVar6 + 1;
      } while (uVar6 < *puVar4);
      if (uVar6 != 0) {
        *param_4 = uVar6;
        return 1;
      }
    }
  }
  return 0;
}



void __fastcall FUN_6b847484(uint *param_1)

{
  int iVar1;
  undefined4 local_2c [10];
  
  iVar1 = FUN_6b847376(local_2c,param_1);
  if (iVar1 == 0) {
    return;
  }
  FUN_6b846d60((int)local_2c);
  return;
}



void __fastcall FUN_6b8474a6(uint param_1,uint param_2,uint param_3,uint param_4)

{
  uint uVar1;
  
  uVar1 = FUN_6b8477ee(param_1,10,param_2,param_3,param_4);
  if (uVar1 != 0) {
    uVar1 = FUN_6b847633(param_1,param_3,param_4);
    FUN_6b846d8b(param_2,uVar1,1);
  }
  return;
}



int __fastcall FUN_6b8474e3(uint param_1,uint param_2,uint param_3)

{
  int iVar1;
  DWORD DVar2;
  
  iVar1 = FUN_6b8477b5(param_1,param_2,param_3);
  if (iVar1 == 0) {
    DVar2 = GetLastError();
    iVar1 = (-(uint)(DVar2 != 0) & 0xfffffe93) + 0x16d;
  }
  else {
    iVar1 = 0x16e;
  }
  return iVar1;
}



void __fastcall FUN_6b847513(uint *param_1,uint *param_2)

{
  undefined4 local_54 [10];
  undefined4 local_2c [10];
  
  FUN_6b847376(local_54,param_1);
  FUN_6b847376(local_2c,param_2);
  FUN_6b846e0f((int)local_54,(int)local_2c);
  return;
}



undefined4 __fastcall FUN_6b847540(int param_1,int param_2,int param_3)

{
  ushort uVar1;
  uint uVar2;
  
  if (param_1 == 3) {
    *(undefined4 *)(param_2 + 4) = 1;
    *(undefined4 *)(param_2 + 8) = 1;
    *(undefined4 *)(param_2 + 0xc) = 9;
    *(undefined4 *)(param_2 + 0x10) = 8;
    *(undefined4 *)(param_2 + 0x14) = 2;
    uVar2 = FUN_6b84770e();
    *(uint *)(param_3 + 4) = uVar2 & 0xffff;
    uVar1 = FUN_6b84771f();
    *(uint *)(param_3 + 8) = (uint)uVar1;
  }
  else if (param_1 == 4) {
    *(undefined4 *)(param_2 + 4) = 1;
    *(undefined4 *)(param_2 + 8) = 1;
    *(undefined4 *)(param_2 + 0xc) = 1;
    *(undefined4 *)(param_2 + 0x10) = 1;
    *(undefined4 *)(param_2 + 0x14) = 1;
    *(undefined4 *)(param_3 + 4) = 1;
    *(undefined4 *)(param_3 + 8) = 0x1f98;
  }
  else if (param_1 == 5) {
    *(undefined4 *)(param_2 + 4) = 1;
    *(undefined4 *)(param_2 + 8) = 0x91e;
    *(undefined4 *)(param_2 + 0xc) = 1;
    *(undefined4 *)(param_2 + 0x10) = 1;
    *(undefined4 *)(param_2 + 0x14) = 1;
    *(undefined4 *)(param_3 + 4) = 1;
    *(undefined4 *)(param_3 + 8) = 0x302c;
  }
  else {
    if (param_1 != 7) goto LAB_6b847605;
    *(undefined4 *)(param_2 + 4) = 1;
    *(undefined4 *)(param_2 + 8) = 0x220;
    *(undefined4 *)(param_2 + 0xc) = 1;
    *(undefined4 *)(param_2 + 0x10) = 1;
    *(undefined4 *)(param_2 + 0x14) = 1;
    *(undefined4 *)(param_3 + 4) = 1;
    *(undefined4 *)(param_3 + 8) = 0x292e;
  }
  *(undefined4 *)(param_3 + 0x14) = 5;
  *(undefined4 *)(param_3 + 0x10) = 0x1f;
  *(undefined4 *)(param_3 + 0xc) = 0xc;
LAB_6b847605:
  *(undefined4 *)(param_3 + 0x1c) = 0x3b;
  *(undefined4 *)(param_3 + 0x20) = 0x3b;
  *(undefined4 *)(param_3 + 0x18) = 0x17;
  *(undefined4 *)(param_3 + 0x24) = 9999999;
  *(undefined4 *)(param_2 + 0x18) = 0;
  *(undefined4 *)(param_2 + 0x1c) = 0;
  *(undefined4 *)(param_2 + 0x20) = 0;
  *(undefined4 *)(param_2 + 0x24) = 0;
  return 1;
}



int __fastcall FUN_6b847633(uint param_1,int param_2,int param_3)

{
  ushort *puVar1;
  int *piVar2;
  int iVar3;
  int in_FS_OFFSET;
  uint local_c;
  uint local_8;
  
  local_c = param_1;
  local_8 = param_1;
  puVar1 = (ushort *)FUN_6b8476d6();
  if (puVar1 == (ushort *)0x0) {
    local_8 = 5;
  }
  else {
    local_8 = (uint)*puVar1;
  }
  piVar2 = (int *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                  local_8 << 2);
  if (piVar2 == (int *)0x0) {
    RtlSetLastWin32Error(8);
    param_2 = 0;
  }
  else {
    iVar3 = FUN_6b8473f2(param_1,(int)piVar2,local_8,&local_c);
    if (iVar3 == 0) {
      param_2 = 0;
    }
    else if (2 < param_1) {
      if (param_1 < 5) {
        param_2 = param_2 + -1 + piVar2[local_c - param_3];
      }
      else if ((param_1 == 5) || (param_1 == 7)) {
        param_2 = param_2 - *piVar2;
      }
    }
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,piVar2);
  }
  return param_2;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 FUN_6b8476d6(void)

{
  int iVar1;
  
  if (_DAT_6b8b09cc == 0) {
    iVar1 = GetCalendar(0,3);
    if (iVar1 != 0) {
      DAT_6b8b09d0 = GetPtrCalDataArray(3,0,0);
    }
    _DAT_6b8b09cc = 1;
  }
  return DAT_6b8b09d0;
}



uint FUN_6b84770e(void)

{
  ushort *puVar1;
  
  puVar1 = (ushort *)FUN_6b8476d6();
  if (puVar1 != (ushort *)0x0) {
    return (uint)puVar1 & 0xffff0000 | (uint)*puVar1;
  }
  return 5;
}



short FUN_6b84771f(void)

{
  short *psVar1;
  int iVar2;
  
  psVar1 = (short *)FUN_6b8476d6();
  if ((psVar1 == (short *)0x0) || (*psVar1 == 0)) {
    iVar2 = 0;
  }
  else {
    iVar2 = *(int *)(psVar1 + 2);
  }
  if (iVar2 != 0) {
    return 10000 - *(short *)(iVar2 + 4);
  }
  return 0x1f2d;
}



void __fastcall FUN_6b84774d(uint param_1,uint param_2,uint param_3,uint param_4,uint param_5)

{
  uint uVar1;
  
  uVar1 = FUN_6b8477ee(param_1,10,param_3,param_4,param_5);
  if (uVar1 != 0) {
    uVar1 = FUN_6b847633(param_1,param_4,param_5);
    FUN_6b84709f(param_2,param_3,uVar1,1);
  }
  return;
}



undefined4 __fastcall FUN_6b84778e(uint param_1,uint param_2,uint param_3,uint param_4)

{
  uint uVar1;
  
  uVar1 = FUN_6b8477ee(param_1,10,param_2,param_3,param_4);
  if (uVar1 != 0) {
    RtlSetLastWin32Error(0);
  }
  return 0;
}



void __fastcall FUN_6b8477b5(uint param_1,uint param_2,uint param_3)

{
  uint uVar1;
  
  uVar1 = FUN_6b8477ee(param_1,10,10,param_2,param_3);
  if (uVar1 != 0) {
    uVar1 = FUN_6b847633(param_1,param_2,param_3);
    FUN_6b84715a(uVar1,1);
  }
  return;
}



uint __fastcall FUN_6b8477ee(uint param_1,uint param_2,uint param_3,uint param_4,uint param_5)

{
  bool bVar1;
  uint uVar2;
  undefined3 extraout_var;
  uint uVar3;
  uint uVar4;
  undefined4 uVar5;
  
  uVar3 = 0;
  if (param_1 == 3) {
    uVar3 = FUN_6b847910(param_2,param_3,param_4,param_5);
    return uVar3;
  }
  uVar4 = 1;
  if (param_5 != 1) {
    uVar5 = 0x57;
    goto LAB_6b847878;
  }
  uVar2 = FUN_6b847633(param_1,param_4,1);
  if (param_1 == 4) {
    uVar3 = 0x1f98;
LAB_6b84785a:
    if (uVar4 <= param_4) goto LAB_6b84785f;
  }
  else {
    if (param_1 == 5) {
      uVar4 = 0x91e;
      uVar3 = 0x302c;
      goto LAB_6b84785a;
    }
    if (param_1 == 7) {
      uVar4 = 0x220;
      uVar3 = 0x292e;
      goto LAB_6b84785a;
    }
LAB_6b84785f:
    if (param_4 <= uVar3) {
      bVar1 = FUN_6b84720b(param_2,param_3,uVar2);
      return CONCAT31(extraout_var,bVar1);
    }
  }
  uVar5 = 0x120;
LAB_6b847878:
  RtlSetLastWin32Error(uVar5);
  return 0;
}



void __thiscall FUN_6b847887(void *this,int param_1)

{
  byte bVar1;
  bool bVar2;
  undefined3 extraout_var;
  uint uVar3;
  int iVar4;
  undefined3 extraout_var_00;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 uVar5;
  uint local_34 [5];
  int local_20;
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)local_34;
  bVar1 = FUN_6b84726e((int)this);
  uVar5 = extraout_EDX;
                    // WARNING: Load size is inaccurate
  if ((((CONCAT31(extraout_var,bVar1) != 0) &&
       (uVar3 = FUN_6b8477ee(*this,*(uint *)((int)this + 0x10),*(uint *)((int)this + 0xc),
                             *(uint *)((int)this + 8),*(uint *)((int)this + 4)),
       uVar5 = extraout_EDX_00, uVar3 != 0)) && (param_1 != 0)) &&
     (((iVar4 = FUN_6b84287b(local_34,(undefined4 *)this), uVar5 = extraout_EDX_01, iVar4 != 0 &&
       (bVar2 = FUN_6b847986(local_34), uVar5 = extraout_EDX_02,
       CONCAT31(extraout_var_00,bVar2) != 0)) && (*(int *)((int)this + 0x14) != local_20)))) {
    RtlSetLastWin32Error(0x120);
    uVar5 = extraout_EDX_03;
  }
  FUN_6b8224af(local_c ^ (uint)local_34,uVar5);
  return;
}



undefined4 __fastcall FUN_6b847910(uint param_1,uint param_2,int param_3,uint param_4)

{
  bool bVar1;
  uint uVar2;
  undefined3 extraout_var;
  
  if (((((param_4 != 0) && (uVar2 = FUN_6b84770e(), param_4 <= (uVar2 & 0xffff))) && (param_3 != 0))
      && ((((param_4 != 1 || (param_3 != 1)) || ((8 < param_2 && ((param_2 != 9 || (7 < param_1)))))
           ) && (uVar2 = FUN_6b847633(3,param_3,param_4), uVar2 < 10000)))) &&
     (bVar1 = FUN_6b84720b(param_1,param_2,uVar2), CONCAT31(extraout_var,bVar1) != 0)) {
    return 1;
  }
  RtlSetLastWin32Error(0x120);
  return 0;
}



bool __fastcall FUN_6b847986(uint *param_1)

{
  int iVar1;
  uint uVar2;
  bool bVar3;
  undefined4 local_30 [11];
  
  iVar1 = FUN_6b847887(param_1,0);
  if ((iVar1 == 0) || (iVar1 = FUN_6b847376(local_30,param_1), iVar1 == 0)) {
    bVar3 = false;
  }
  else {
    uVar2 = FUN_6b846d3f((int)local_30);
    bVar3 = uVar2 != 0xffffffff;
    if (bVar3) {
      param_1[5] = uVar2;
    }
  }
  return bVar3;
}



bool __fastcall FUN_6b8479ca(uint param_1,ushort param_2,ushort param_3,ushort param_4,int param_5)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  bool bVar4;
  uint local_c;
  uint local_8;
  
  local_c = 0;
  local_8 = param_1;
  iVar1 = GetCalendar(0,param_1);
  iVar2 = KernelBaseGetGlobalData();
  uVar3 = FUN_6b8448ae(&local_c,(short *)&local_8,param_1,iVar1,*(int *)(iVar2 + 0x30),param_2,
                       param_3,param_4);
  bVar4 = local_c != 0;
  if (bVar4) {
    *(uint *)(param_5 + 4) = local_8 & 0xffff;
    *(uint *)(param_5 + 8) = uVar3 & 0xffff;
  }
  else {
    RtlSetLastWin32Error(0x120);
  }
  return bVar4;
}



undefined4 __fastcall FUN_6b847a36(int param_1,int param_2)

{
  int iVar1;
  uint local_2c [2];
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  
  iVar1 = FUN_6b846e38(param_1,local_2c);
  if ((iVar1 != 0) && (iVar1 = FUN_6b847cfc(local_2c), iVar1 != 0)) {
    *(undefined4 *)(param_2 + 8) = local_24;
    *(undefined4 *)(param_2 + 0xc) = local_20;
    *(undefined4 *)(param_2 + 0x10) = local_1c;
    *(undefined4 *)(param_2 + 0x14) = local_18;
    return 1;
  }
  return 0;
}



undefined4 __fastcall FUN_6b847a7b(uint *param_1,int param_2)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = FUN_6b847f6f(param_1);
  if (iVar1 != 0) {
    if ((iVar1 + param_2) - 0xa95d2U < 0xfd52) {
      uVar2 = FUN_6b847a36(iVar1 + param_2,(int)param_1);
      return uVar2;
    }
    SetLastError(0x120);
  }
  return 0;
}



undefined4 __fastcall FUN_6b847ab8(uint *param_1,int param_2)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  
  uVar7 = param_1[4];
  iVar1 = param_1[3] + param_2;
  iVar3 = iVar1 + -1;
  if (iVar3 < 0) {
    iVar3 = iVar1 + -0xc;
    uVar5 = iVar1 % 0xc + 0xc;
  }
  else {
    uVar5 = iVar3 % 0xc + 1;
  }
  uVar6 = param_1[2] + iVar3 / 0xc;
  if (uVar6 - 0x526 < 0xb7) {
    if (0x1d < uVar7) {
      uVar2 = FUN_6b847c2b(uVar5,uVar6,param_1[1]);
      if (uVar2 < uVar7) {
        uVar7 = uVar2;
      }
    }
    param_1[4] = uVar7;
    param_1[3] = uVar5;
    param_1[2] = uVar6;
    iVar3 = FUN_6b847f6f(param_1);
    param_1[5] = (iVar3 + 1U) % 7;
    uVar4 = 1;
  }
  else {
    SetLastError(0x120);
    uVar4 = 0;
  }
  return uVar4;
}



undefined4 __fastcall FUN_6b847b5b(ushort *param_1,uint *param_2)

{
  int iVar1;
  uint *puVar2;
  uint local_2c [10];
  
  iVar1 = FUN_6b846c58(param_1,1,local_2c);
  if ((iVar1 != 0) && (iVar1 = FUN_6b847cfc(local_2c), iVar1 != 0)) {
    puVar2 = local_2c;
    for (iVar1 = 10; iVar1 != 0; iVar1 = iVar1 + -1) {
      *param_2 = *puVar2;
      puVar2 = puVar2 + 1;
      param_2 = param_2 + 1;
    }
    return 1;
  }
  return 0;
}



undefined4 __fastcall FUN_6b847b96(uint *param_1,undefined2 *param_2)

{
  int iVar1;
  uint *puVar2;
  uint local_2c [10];
  
  puVar2 = local_2c;
  for (iVar1 = 10; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar2 = *param_1;
    param_1 = param_1 + 1;
    puVar2 = puVar2 + 1;
  }
  iVar1 = FUN_6b847fa1(local_2c);
  if ((iVar1 != 0) && (iVar1 = FUN_6b846bef((int)local_2c,param_2), iVar1 != 0)) {
    return 1;
  }
  return 0;
}



int __fastcall FUN_6b847bd3(uint *param_1)

{
  int iVar1;
  int iVar2;
  uint *puVar3;
  uint local_2c [4];
  undefined4 local_1c;
  
  iVar1 = FUN_6b847e71(param_1,1);
  if ((iVar1 != 0) && (iVar1 = FUN_6b847f6f(param_1), iVar1 != 0)) {
    puVar3 = local_2c;
    for (iVar2 = 10; iVar2 != 0; iVar2 = iVar2 + -1) {
      *puVar3 = *param_1;
      param_1 = param_1 + 1;
      puVar3 = puVar3 + 1;
    }
    local_2c[3] = 1;
    local_1c = 1;
    FUN_6b84804c(local_2c);
    iVar2 = FUN_6b847f6f(local_2c);
    if (iVar2 != 0) {
      return (iVar1 - iVar2) + 1;
    }
  }
  return 0;
}



int __fastcall FUN_6b847c2b(int param_1,int param_2,int param_3)

{
  int iVar1;
  
  iVar1 = FUN_6b847f14(param_1,param_2,param_3);
  if (iVar1 != 0) {
    iVar1 = ((1 << ((char)param_1 - 1U & 0x1f) & (uint)*(ushort *)(&DAT_6b8857f0 + param_2 * 8)) !=
            0) + 0x1d;
  }
  return iVar1;
}



int __fastcall FUN_6b847c63(int param_1)

{
  uint uVar1;
  ushort uVar2;
  int iVar3;
  int iVar4;
  
  uVar2 = *(ushort *)(&DAT_6b8857f0 + param_1 * 8);
  iVar3 = 0;
  iVar4 = 0xc;
  do {
    uVar1 = (uint)uVar2;
    uVar2 = uVar2 >> 1;
    iVar3 = iVar3 + 0x1d + (uVar1 & 1);
    iVar4 = iVar4 + -1;
  } while (iVar4 != 0);
  return iVar3;
}



undefined4 __fastcall FUN_6b847c9b(int param_1,int param_2)

{
  *(undefined4 *)(param_1 + 8) = 0x526;
  *(undefined4 *)(param_1 + 0x18) = 0;
  *(undefined4 *)(param_1 + 0x1c) = 0;
  *(undefined4 *)(param_1 + 4) = 1;
  *(undefined4 *)(param_1 + 0xc) = 1;
  *(undefined4 *)(param_1 + 0x10) = 1;
  *(undefined4 *)(param_1 + 0x14) = 1;
  *(undefined4 *)(param_1 + 0x20) = 0;
  *(undefined4 *)(param_1 + 0x24) = 0;
  *(undefined4 *)(param_2 + 4) = 1;
  *(undefined4 *)(param_2 + 8) = 0x5dc;
  *(undefined4 *)(param_2 + 0xc) = 0xc;
  *(undefined4 *)(param_2 + 0x10) = 0x1e;
  *(undefined4 *)(param_2 + 0x14) = 2;
  *(undefined4 *)(param_2 + 0x18) = 0x17;
  *(undefined4 *)(param_2 + 0x1c) = 0x3b;
  *(undefined4 *)(param_2 + 0x20) = 0x3b;
  *(undefined4 *)(param_2 + 0x24) = 9999999;
  return 1;
}



undefined4 __fastcall FUN_6b847cfc(uint *param_1)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  ushort uVar5;
  uint uVar6;
  uint *puVar7;
  uint *puVar8;
  uint local_30 [4];
  uint local_20;
  uint local_8;
  
  iVar1 = FUN_6b846cda(param_1[2],param_1[3],param_1[4]);
  if ((iVar1 - 0xa95d2U < 0xfd52) &&
     (uVar2 = (int)(iVar1 - 0xa95d2U) / 0x163, local_8 = uVar2, uVar2 < 0xb8)) {
    puVar7 = param_1;
    puVar8 = local_30;
    for (iVar1 = 10; iVar1 != 0; iVar1 = iVar1 + -1) {
      *puVar8 = *puVar7;
      puVar7 = puVar7 + 1;
      puVar8 = puVar8 + 1;
    }
    do {
      uVar6 = uVar2;
      local_30[2] = (uint)*(ushort *)(&DAT_6b888122 + uVar6 * 8);
      local_30[3] = (uint)*(ushort *)(&DAT_6b888124 + local_8 * 8);
      local_20 = (uint)*(ushort *)(&DAT_6b888126 + local_8 * 8);
      iVar1 = FUN_6b846e0f((int)local_30,(int)param_1);
      local_8 = local_8 + 1;
      if (iVar1 < 1) break;
      uVar2 = local_8;
    } while ((int)local_8 < 0xb8);
    if (iVar1 != 0) {
      uVar6 = uVar6 - 1;
      if ((int)uVar6 < 0) goto LAB_6b847e34;
      if ((int)uVar6 < 0xb8) {
        local_30[2] = (uint)*(ushort *)(&DAT_6b888122 + uVar6 * 8);
        local_30[3] = (uint)*(ushort *)(&DAT_6b888124 + uVar6 * 8);
        local_20 = (uint)*(ushort *)(&DAT_6b888126 + uVar6 * 8);
        iVar1 = FUN_6b846e0f((int)local_30,(int)param_1);
      }
    }
    if (uVar6 < 0xb8) {
      local_30[0] = 0x17;
      local_30[2] = uVar6 + 0x526;
      uVar5 = *(ushort *)(&DAT_6b888120 + uVar6 * 8);
      iVar4 = 1;
      local_8 = (uint)uVar5;
      local_30[1] = 1;
      iVar3 = (uVar5 & 1) + 0x1d;
      local_30[3] = 1;
      if (iVar3 <= iVar1) {
        do {
          uVar5 = uVar5 >> 1;
          iVar1 = iVar1 - iVar3;
          local_8 = (uint)uVar5;
          iVar3 = (uVar5 & 1) + 0x1d;
          iVar4 = iVar4 + 1;
        } while (iVar3 <= iVar1);
        local_30[3] = iVar4;
      }
      local_20 = iVar1 + 1;
      puVar7 = local_30;
      for (iVar1 = 10; iVar1 != 0; iVar1 = iVar1 + -1) {
        *param_1 = *puVar7;
        puVar7 = puVar7 + 1;
        param_1 = param_1 + 1;
      }
      return 1;
    }
  }
LAB_6b847e34:
  SetLastError(0x120);
  return 0;
}



bool __fastcall FUN_6b847e46(int param_1,int param_2)

{
  int iVar1;
  
  iVar1 = FUN_6b847f48(param_1,param_2);
  if (iVar1 == 0) {
    return false;
  }
  SetLastError(0);
  iVar1 = FUN_6b847c63(param_1);
  return (bool)('\x01' - (iVar1 != 0x163));
}



undefined4 __thiscall FUN_6b847e71(void *this,int param_1)

{
  int iVar1;
  
                    // WARNING: Load size is inaccurate
  if (*this == 0x17) {
    iVar1 = FUN_6b847edc(*(uint *)((int)this + 0x10),*(int *)((int)this + 0xc),
                         *(int *)((int)this + 8),*(int *)((int)this + 4));
    if (iVar1 == 0) {
      return 0;
    }
    if ((((*(uint *)((int)this + 0x18) < 0x18) && (*(uint *)((int)this + 0x1c) < 0x3c)) &&
        (*(uint *)((int)this + 0x20) < 0x3c)) &&
       ((*(uint *)((int)this + 0x24) < 10000000 &&
        ((param_1 == 0 ||
         (iVar1 = FUN_6b847f6f((uint *)this), *(uint *)((int)this + 0x14) == (iVar1 + 1U) % 7))))))
    {
      return 1;
    }
  }
  SetLastError(0x57);
  return 0;
}



undefined4 __fastcall FUN_6b847edc(uint param_1,int param_2,int param_3,int param_4)

{
  uint uVar1;
  
  uVar1 = FUN_6b847c2b(param_2,param_3,param_4);
  if (uVar1 != 0) {
    if ((param_1 != 0) && (param_1 <= uVar1)) {
      return 1;
    }
    SetLastError(0x57);
  }
  return 0;
}



undefined4 __fastcall FUN_6b847f14(int param_1,int param_2,int param_3)

{
  int iVar1;
  
  iVar1 = FUN_6b847f48(param_2,param_3);
  if (iVar1 != 0) {
    if (param_1 - 1U < 0xc) {
      return 1;
    }
    SetLastError(0x57);
  }
  return 0;
}



undefined4 __fastcall FUN_6b847f48(int param_1,int param_2)

{
  DWORD dwErrCode;
  
  if (param_2 == 1) {
    if (param_1 - 0x526U < 0xb7) {
      return 1;
    }
    dwErrCode = 0x120;
  }
  else {
    dwErrCode = 0x57;
  }
  SetLastError(dwErrCode);
  return 0;
}



void __fastcall FUN_6b847f6f(uint *param_1)

{
  int iVar1;
  uint *puVar2;
  uint local_2c [4];
  int local_1c;
  
  puVar2 = local_2c;
  for (iVar1 = 10; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar2 = *param_1;
    param_1 = param_1 + 1;
    puVar2 = puVar2 + 1;
  }
  iVar1 = FUN_6b847fa1(local_2c);
  if (iVar1 != 0) {
    FUN_6b846cda(local_2c[2],local_2c[3],local_1c);
  }
  return;
}



undefined4 __fastcall FUN_6b847fa1(uint *param_1)

{
  bool bVar1;
  uint uVar2;
  undefined3 extraout_var;
  ushort uVar3;
  int iVar4;
  undefined4 uVar5;
  int iVar6;
  uint *puVar7;
  uint local_30 [4];
  uint local_20;
  uint local_1c;
  uint local_18;
  uint local_14;
  uint local_10;
  uint local_c;
  uint local_8;
  
  uVar5 = 1;
  local_30[0] = 1;
  local_30[1] = 1;
  uVar2 = param_1[2];
  iVar6 = param_1[4] - 1;
  local_30[2] = (uint)*(ushort *)(&DAT_6b8857f2 + uVar2 * 8);
  local_30[3] = (uint)*(ushort *)(&DAT_6b8857f4 + uVar2 * 8);
  local_20 = (uint)*(ushort *)(&DAT_6b8857f6 + uVar2 * 8);
  local_1c = param_1[5];
  local_18 = param_1[6];
  local_14 = param_1[7];
  local_10 = param_1[8];
  local_c = param_1[9];
  uVar3 = *(ushort *)(&DAT_6b8857f0 + uVar2 * 8);
  local_8 = (uint)uVar3;
  if (1 < param_1[3]) {
    iVar4 = param_1[3] - 1;
    do {
      uVar2 = local_8 & 1;
      uVar3 = uVar3 >> 1;
      local_8 = (uint)uVar3;
      iVar6 = iVar6 + 0x1d + uVar2;
      iVar4 = iVar4 + -1;
    } while (iVar4 != 0);
  }
  bVar1 = FUN_6b846b76(local_30,iVar6);
  if (CONCAT31(extraout_var,bVar1) == 0) {
    uVar5 = 0;
  }
  else {
    puVar7 = local_30;
    for (iVar6 = 10; iVar6 != 0; iVar6 = iVar6 + -1) {
      *param_1 = *puVar7;
      puVar7 = puVar7 + 1;
      param_1 = param_1 + 1;
    }
  }
  return uVar5;
}



undefined4 __fastcall FUN_6b84804c(uint *param_1)

{
  int iVar1;
  
  iVar1 = FUN_6b847e71(param_1,0);
  if (iVar1 == 0) {
    return 0;
  }
  iVar1 = FUN_6b847f6f(param_1);
  param_1[5] = (iVar1 + 1U) % 7;
  return 1;
}



undefined4 __fastcall FUN_6b848075(int param_1,int param_2)

{
  int iVar1;
  int local_2c [2];
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  
  iVar1 = FUN_6b846e38(param_1,local_2c);
  if ((iVar1 != 0) && (iVar1 = FUN_6b8484df(local_2c), iVar1 != 0)) {
    *(undefined4 *)(param_2 + 8) = local_24;
    *(undefined4 *)(param_2 + 0xc) = local_20;
    *(undefined4 *)(param_2 + 0x10) = local_1c;
    *(undefined4 *)(param_2 + 0x14) = local_18;
    return 1;
  }
  return 0;
}



undefined4 __fastcall FUN_6b8480ba(int *param_1,int param_2)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = FUN_6b84860e(param_1);
  if (iVar1 != 0) {
    if ((iVar1 + param_2) - 0x8d115U < 0x3a8ff) {
      uVar2 = FUN_6b848075(iVar1 + param_2,(int)param_1);
      return uVar2;
    }
    SetLastError(0x120);
  }
  return 0;
}



undefined4 __fastcall FUN_6b8480f7(int *param_1,int param_2)

{
  uint uVar1;
  int iVar2;
  char cVar3;
  undefined3 extraout_var;
  undefined3 extraout_var_00;
  undefined3 extraout_var_01;
  uint uVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  
  iVar5 = param_1[2];
  uVar1 = param_1[4];
  if (iVar5 - 0x14dfU < 0x291) {
    uVar6 = param_1[3] + param_2;
    if (param_2 < 0) {
      if ((int)uVar6 < 1) {
        iVar7 = -uVar6;
        iVar2 = iVar5;
        if (0x290 < iVar5 - 0x14e0U) goto LAB_6b8481cf;
        while( true ) {
          iVar5 = iVar2 + -1;
          cVar3 = FUN_6b8483ca(iVar5,param_1[1]);
          if (iVar7 <= CONCAT31(extraout_var_00,cVar3)) break;
          if (0x290 < iVar2 - 0x14e1U) goto LAB_6b8481cf;
          iVar7 = iVar7 - CONCAT31(extraout_var_00,cVar3);
          iVar2 = iVar5;
        }
        cVar3 = FUN_6b8483ca(iVar5,param_1[1]);
        uVar6 = CONCAT31(extraout_var_01,cVar3) - iVar7;
      }
    }
    else {
      while( true ) {
        cVar3 = FUN_6b8483ca(iVar5,param_1[1]);
        if ((int)uVar6 <= CONCAT31(extraout_var,cVar3)) break;
        if (0x290 < iVar5 - 0x14deU) goto LAB_6b8481cf;
        uVar6 = uVar6 - CONCAT31(extraout_var,cVar3);
        iVar5 = iVar5 + 1;
      }
    }
    uVar4 = FUN_6b84839a(uVar6,iVar5,param_1[1]);
    if (uVar4 != 0) {
      if ((int)uVar1 <= (int)uVar4) {
        uVar4 = uVar1;
      }
      param_1[4] = uVar4;
      param_1[3] = uVar6;
      param_1[2] = iVar5;
      iVar5 = FUN_6b84860e(param_1);
      param_1[5] = (iVar5 + 1U) % 7;
      return 1;
    }
  }
  else {
LAB_6b8481cf:
    SetLastError(0x120);
  }
  return 0;
}



undefined4 __fastcall FUN_6b8481e1(int *param_1,int param_2)

{
  char cVar1;
  undefined3 extraout_var;
  uint uVar2;
  uint uVar3;
  undefined4 uVar4;
  uint uVar5;
  int iVar6;
  
  uVar3 = param_1[4];
  iVar6 = param_1[2] + param_2;
  uVar5 = param_1[3];
  if (iVar6 - 0x14dfU < 0x291) {
    cVar1 = FUN_6b8483ca(iVar6,param_1[1]);
    if ((int)CONCAT31(extraout_var,cVar1) < (int)uVar5) {
      uVar5 = CONCAT31(extraout_var,cVar1);
    }
    uVar2 = FUN_6b84839a(uVar5,iVar6,param_1[1]);
    if ((int)uVar2 < (int)uVar3) {
      uVar3 = uVar2;
    }
    param_1[4] = uVar3;
    param_1[3] = uVar5;
    param_1[2] = iVar6;
    iVar6 = FUN_6b84860e(param_1);
    param_1[5] = (iVar6 + 1U) % 7;
    uVar4 = 1;
  }
  else {
    SetLastError(0x120);
    uVar4 = 0;
  }
  return uVar4;
}



undefined4 __fastcall FUN_6b848260(int *param_1,undefined2 *param_2)

{
  int iVar1;
  int *piVar2;
  int local_2c [10];
  
  piVar2 = local_2c;
  for (iVar1 = 10; iVar1 != 0; iVar1 = iVar1 + -1) {
    *piVar2 = *param_1;
    param_1 = param_1 + 1;
    piVar2 = piVar2 + 1;
  }
  iVar1 = FUN_6b848644(local_2c);
  if ((iVar1 != 0) && (iVar1 = FUN_6b846bef((int)local_2c,param_2), iVar1 != 0)) {
    return 1;
  }
  return 0;
}



undefined4 __fastcall FUN_6b84829d(ushort *param_1,int *param_2)

{
  int iVar1;
  int *piVar2;
  int local_2c [10];
  
  iVar1 = FUN_6b846c58(param_1,1,local_2c);
  if ((iVar1 != 0) && (iVar1 = FUN_6b8484df(local_2c), iVar1 != 0)) {
    piVar2 = local_2c;
    for (iVar1 = 10; iVar1 != 0; iVar1 = iVar1 + -1) {
      *param_2 = *piVar2;
      piVar2 = piVar2 + 1;
      param_2 = param_2 + 1;
    }
    return 1;
  }
  return 0;
}



int __fastcall FUN_6b8482d8(int param_1,uint param_2,int param_3,uint param_4,int param_5)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  
  if (param_2 == param_4) {
    iVar1 = param_3 - param_5;
  }
  else {
    iVar1 = param_3;
    uVar2 = param_2;
    uVar3 = param_4;
    if (param_2 > param_4) {
      iVar1 = param_5;
      uVar2 = param_4;
      param_5 = param_3;
      uVar3 = param_2;
    }
    iVar1 = (uint)(byte)(&DAT_6b8886e0)[uVar2 + param_1 * 0xe] - iVar1;
    while (uVar2 = uVar2 + 1, uVar2 < uVar3) {
      iVar1 = iVar1 + (uint)(byte)(&DAT_6b8886e0)[uVar2 + param_1 * 0xe];
    }
    iVar1 = iVar1 + param_5;
    if (param_2 <= param_4) {
      iVar1 = -iVar1;
    }
  }
  return iVar1;
}



int __fastcall FUN_6b84834a(int *param_1)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  int local_2c [4];
  undefined4 local_1c;
  
  iVar1 = FUN_6b8487cd(param_1,1);
  if ((iVar1 != 0) && (iVar1 = FUN_6b84860e(param_1), iVar1 != 0)) {
    piVar3 = local_2c;
    for (iVar2 = 10; iVar2 != 0; iVar2 = iVar2 + -1) {
      *piVar3 = *param_1;
      param_1 = param_1 + 1;
      piVar3 = piVar3 + 1;
    }
    local_2c[3] = 1;
    local_1c = 1;
    iVar2 = FUN_6b84860e(local_2c);
    if (iVar2 != 0) {
      return (iVar1 - iVar2) + 1;
    }
  }
  return 0;
}



uint __fastcall FUN_6b84839a(uint param_1,int param_2,int param_3)

{
  uint uVar1;
  
  uVar1 = FUN_6b848870(param_1,param_2,param_3);
  if (uVar1 != 0) {
    uVar1 = (uint)(byte)(&DAT_6b8886e0)
                        [param_1 + (uint)GuardCFFunctionTable[0x2a5].Pad[param_2 * 2 + -2] * 0xe];
  }
  return uVar1;
}



char __fastcall FUN_6b8483ca(int param_1,int param_2)

{
  bool bVar1;
  char cVar2;
  int iVar3;
  undefined3 extraout_var;
  
  iVar3 = FUN_6b8488b1(param_1,param_2);
  if (iVar3 == 0) {
    cVar2 = '\0';
  }
  else {
    bVar1 = FUN_6b8487a1(param_1,param_2);
    cVar2 = (CONCAT31(extraout_var,bVar1) != 0) + '\f';
  }
  return cVar2;
}



void __fastcall FUN_6b8483f4(int param_1,int param_2)

{
  *(undefined4 *)(param_1 + 8) = 0x14df;
  *(undefined4 *)(param_1 + 0xc) = 4;
  *(undefined4 *)(param_1 + 4) = 1;
  *(undefined4 *)(param_1 + 0x10) = 7;
  *(undefined4 *)(param_1 + 0x14) = 6;
  *(undefined4 *)(param_1 + 0x18) = 0;
  *(undefined4 *)(param_1 + 0x1c) = 0;
  *(undefined4 *)(param_1 + 0x20) = 0;
  *(undefined4 *)(param_1 + 0x24) = 0;
  *(undefined4 *)(param_2 + 0x14) = 0;
  *(undefined4 *)(param_2 + 4) = 1;
  *(undefined4 *)(param_2 + 8) = 5999;
  *(undefined4 *)(param_2 + 0xc) = 0xd;
  *(undefined4 *)(param_2 + 0x10) = 0x1d;
  *(undefined4 *)(param_2 + 0x18) = 0x17;
  *(undefined4 *)(param_2 + 0x1c) = 0x3b;
  *(undefined4 *)(param_2 + 0x20) = 0x3b;
  *(undefined4 *)(param_2 + 0x24) = 9999999;
  return;
}



undefined __fastcall FUN_6b848459(int param_1,int param_2)

{
  undefined uVar1;
  uint uVar2;
  uint uVar3;
  
  if ((param_2 != 0) && (uVar3 = param_1 - 0x62f, uVar3 < 0x291)) {
    uVar2 = (uint)(byte)(&DAT_6b885730)[uVar3 * 2];
    uVar1 = (&DAT_6b885731)[uVar3 * 2];
    *(uint *)(param_2 + 0x10) = uVar2;
    if (uVar2 == 0) {
      *(undefined4 *)(param_2 + 0x10) = 1;
    }
    else {
      if (uVar2 == 0x1e) {
        *(undefined4 *)(param_2 + 0xc) = 3;
        return uVar1;
      }
      if (uVar2 == 0x1f) {
        *(undefined4 *)(param_2 + 0x10) = 2;
      }
      else {
        if (uVar2 != 0x20) {
          if (uVar2 != 0x21) {
            *(undefined4 *)(param_2 + 0xc) = 4;
            return uVar1;
          }
          *(undefined4 *)(param_2 + 0xc) = 3;
          *(undefined4 *)(param_2 + 0x10) = 0x1d;
          return uVar1;
        }
        *(undefined4 *)(param_2 + 0x10) = 3;
      }
    }
    *(undefined4 *)(param_2 + 0xc) = 5;
    return uVar1;
  }
  return 0;
}



undefined4 __fastcall FUN_6b8484df(int *param_1)

{
  int iVar1;
  uint uVar2;
  undefined4 uVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  int *piVar8;
  int *piVar9;
  int local_3c [4];
  uint local_2c;
  uint local_14;
  uint local_10;
  int *local_c;
  uint local_8;
  
  local_8 = param_1[2];
  local_c = param_1;
  iVar1 = FUN_6b846cda(local_8,param_1[3],param_1[4]);
  if (iVar1 - 0x8d115U < 0x3a8ff) {
    piVar9 = local_3c;
    for (iVar4 = 10; iVar4 != 0; iVar4 = iVar4 + -1) {
      *piVar9 = *param_1;
      param_1 = param_1 + 1;
      piVar9 = piVar9 + 1;
    }
    local_3c[0] = 8;
    local_3c[1] = 1;
    local_3c[2] = local_8 + 0xeb0;
    uVar2 = FUN_6b848459(local_8,(int)local_3c);
    piVar9 = local_c;
    local_10 = uVar2;
    if ((local_c[3] != 1) || (local_c[4] != 1)) {
      local_14 = local_c[2];
      iVar4 = FUN_6b846cda(local_14,1,1);
      iVar6 = uVar2 * 0xe;
      local_8 = (uint)(byte)(&DAT_6b8886e0)[local_3c[3] + iVar6];
      uVar2 = local_2c + (iVar1 - iVar4);
      if (local_8 < uVar2) {
        uVar7 = (iVar1 - iVar4) + (local_2c - local_8);
        uVar2 = local_3c[3] + 1;
        local_3c[3] = uVar2;
        local_2c = 1;
        if (1 < uVar7) {
          uVar5 = (uint)(byte)(&DAT_6b8886e0)[uVar2 + iVar6];
          if (uVar5 < uVar7) {
            do {
              uVar7 = uVar7 - uVar5;
              uVar2 = uVar2 + 1;
              local_3c[3] = uVar2;
              if ((0xd < uVar2) || ((&DAT_6b8886e0)[uVar2 + iVar6] == '\0')) {
                local_3c[2] = local_3c[2] + 1;
                local_10 = (uint)*(byte *)((int)L"ext-ms-win-oobe-query-l1-1-0" + local_14 * 2 + 1);
                uVar2 = 1;
                local_3c[3] = 1;
              }
              iVar6 = local_10 * 0xe;
              uVar5 = (uint)(byte)(&DAT_6b8886e0)[uVar2 + iVar6];
            } while (uVar5 < uVar7);
            piVar9 = local_c;
          }
          local_2c = uVar7;
        }
      }
      else {
        local_2c = uVar2;
      }
    }
    piVar8 = local_3c;
    for (iVar1 = 10; iVar1 != 0; iVar1 = iVar1 + -1) {
      *piVar9 = *piVar8;
      piVar8 = piVar8 + 1;
      piVar9 = piVar9 + 1;
    }
    uVar3 = 1;
  }
  else {
    SetLastError(0x120);
    uVar3 = 0;
  }
  return uVar3;
}



int __fastcall FUN_6b84860e(int *param_1)

{
  int iVar1;
  int *piVar2;
  int local_2c [4];
  int local_1c;
  
  piVar2 = local_2c;
  for (iVar1 = 10; iVar1 != 0; iVar1 = iVar1 + -1) {
    *piVar2 = *param_1;
    param_1 = param_1 + 1;
    piVar2 = piVar2 + 1;
  }
  iVar1 = FUN_6b848644(local_2c);
  if (iVar1 == 0) {
    iVar1 = 0;
  }
  else {
    iVar1 = FUN_6b846cda(local_2c[2],local_2c[3],local_1c);
  }
  return iVar1;
}



undefined4 __fastcall FUN_6b848644(int *param_1)

{
  bool bVar1;
  int iVar2;
  undefined3 extraout_var;
  int *piVar3;
  undefined local_64 [12];
  uint local_58;
  int local_54;
  int local_3c [4];
  undefined4 local_2c;
  int local_28;
  int local_24;
  int local_20;
  int local_1c;
  int local_18;
  
  local_3c[2] = param_1[2] + -0xeb0;
  iVar2 = FUN_6b848459(local_3c[2],(int)local_64);
  if (iVar2 != 0) {
    local_28 = param_1[5];
    local_3c[1] = 1;
    local_3c[0] = 1;
    local_2c = 1;
    local_3c[3] = 1;
    local_24 = param_1[6];
    local_20 = param_1[7];
    local_1c = param_1[8];
    local_18 = param_1[9];
    if ((param_1[3] == local_58) && (param_1[4] == local_54)) {
      *param_1 = 1;
      param_1[1] = 1;
      param_1[2] = local_3c[2];
      param_1[3] = 1;
      param_1[4] = 1;
      param_1[5] = local_28;
      param_1[6] = param_1[6];
      param_1[7] = param_1[7];
      param_1[8] = param_1[8];
      param_1[9] = param_1[9];
      return 1;
    }
    iVar2 = FUN_6b8482d8(iVar2,param_1[3],param_1[4],local_58,local_54);
    bVar1 = FUN_6b846b76(local_3c,iVar2);
    if (CONCAT31(extraout_var,bVar1) != 0) {
      piVar3 = local_3c;
      for (iVar2 = 10; iVar2 != 0; iVar2 = iVar2 + -1) {
        *param_1 = *piVar3;
        piVar3 = piVar3 + 1;
        param_1 = param_1 + 1;
      }
      return 1;
    }
  }
  return 0;
}



undefined4 __fastcall FUN_6b84870a(uint param_1,uint param_2,int param_3,int param_4)

{
  bool bVar1;
  int iVar2;
  undefined3 extraout_var;
  undefined4 uVar3;
  
  iVar2 = FUN_6b848838(param_1,param_2,param_3,param_4);
  if (iVar2 == 0) {
LAB_6b84875b:
    uVar3 = 0;
  }
  else {
    SetLastError(0);
    iVar2 = FUN_6b848763(param_2,param_3,param_4);
    if (iVar2 == 0) {
      bVar1 = FUN_6b8487a1(param_3,param_4);
      if (((CONCAT31(extraout_var,bVar1) == 0) || (param_2 != 6)) || (param_1 != 0x1e))
      goto LAB_6b84875b;
    }
    uVar3 = 1;
  }
  return uVar3;
}



int __fastcall FUN_6b848763(uint param_1,int param_2,int param_3)

{
  bool bVar1;
  int iVar2;
  undefined3 extraout_var;
  
  iVar2 = FUN_6b848870(param_1,param_2,param_3);
  if (iVar2 != 0) {
    iVar2 = 0;
    SetLastError(0);
    bVar1 = FUN_6b8487a1(param_2,param_3);
    if ((CONCAT31(extraout_var,bVar1) != 0) && (param_1 == 7)) {
      iVar2 = 1;
    }
  }
  return iVar2;
}



bool __fastcall FUN_6b8487a1(int param_1,int param_2)

{
  int iVar1;
  
  iVar1 = FUN_6b8488b1(param_1,param_2);
  if (iVar1 == 0) {
    return false;
  }
  SetLastError(0);
  return (param_1 * 7 + 1U) % 0x13 < 7;
}



undefined4 __thiscall FUN_6b8487cd(void *this,int param_1)

{
  int iVar1;
  
                    // WARNING: Load size is inaccurate
  if (*this == 8) {
    iVar1 = FUN_6b848838(*(uint *)((int)this + 0x10),*(uint *)((int)this + 0xc),
                         *(int *)((int)this + 8),*(int *)((int)this + 4));
    if (iVar1 == 0) {
      return 0;
    }
    if ((((*(uint *)((int)this + 0x18) < 0x18) && (*(uint *)((int)this + 0x1c) < 0x3c)) &&
        (*(uint *)((int)this + 0x20) < 0x3c)) &&
       ((*(uint *)((int)this + 0x24) < 10000000 &&
        ((param_1 == 0 ||
         (iVar1 = FUN_6b84860e((int *)this), *(uint *)((int)this + 0x14) == (iVar1 + 1U) % 7)))))) {
      return 1;
    }
  }
  SetLastError(0x57);
  return 0;
}



undefined4 __fastcall FUN_6b848838(uint param_1,uint param_2,int param_3,int param_4)

{
  uint uVar1;
  
  uVar1 = FUN_6b84839a(param_2,param_3,param_4);
  if (uVar1 != 0) {
    if ((param_1 != 0) && (param_1 <= uVar1)) {
      return 1;
    }
    SetLastError(0x57);
  }
  return 0;
}



undefined4 __fastcall FUN_6b848870(uint param_1,int param_2,int param_3)

{
  char cVar1;
  int iVar2;
  undefined3 extraout_var;
  
  iVar2 = FUN_6b8488b1(param_2,param_3);
  if (iVar2 != 0) {
    cVar1 = FUN_6b8483ca(param_2,param_3);
    if ((param_1 != 0) && (param_1 <= CONCAT31(extraout_var,cVar1))) {
      return 1;
    }
    SetLastError(0x57);
  }
  return 0;
}



undefined4 __fastcall FUN_6b8488b1(int param_1,int param_2)

{
  DWORD dwErrCode;
  
  if (param_2 == 1) {
    if (param_1 - 0x14dfU < 0x291) {
      return 1;
    }
    dwErrCode = 0x120;
  }
  else {
    dwErrCode = 0x57;
  }
  SetLastError(dwErrCode);
  return 0;
}



undefined4 __fastcall FUN_6b8488d8(int *param_1)

{
  int iVar1;
  
  iVar1 = FUN_6b8487cd(param_1,0);
  if (iVar1 == 0) {
    return 0;
  }
  iVar1 = FUN_6b84860e(param_1);
  param_1[5] = (iVar1 + 1U) % 7;
  return 1;
}



longlong FUN_6b848901(undefined4 param_1,int param_2)

{
  longlong lVar1;
  longlong lVar2;
  
  lVar1 = _alldiv(param_1,param_2,0x2a69c000,0xc9);
  if (((int)((ulonglong)lVar1 >> 0x20) < 1) && (lVar1 < 0)) {
    lVar2 = _allmul(lVar1,0x2a69c000,0xc9);
    if (lVar2 != CONCAT44(param_2,param_1)) {
      lVar1 = lVar1 + -1;
    }
  }
  else if ((lVar1 == 0) && ((param_2 < 1 && (param_2 < 0)))) {
    lVar1 = -1;
  }
  return lVar1;
}



undefined4 * __thiscall FUN_6b84896d(void *this,int param_1)

{
  undefined4 uVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  
  FUN_6b8489e8(this,0x3764f,0x37b9da);
  *(undefined ***)this = &PTR_FUN_6b8803a8;
  uVar1 = *(undefined4 *)(param_1 + 4);
  *(undefined4 *)((int)this + 4) = uVar1;
  iVar2 = *(int *)(param_1 + 8);
  *(int *)((int)this + 8) = iVar2;
  iVar3 = *(int *)(param_1 + 0xc);
  *(int *)((int)this + 0xc) = iVar3;
  iVar4 = *(int *)(param_1 + 0x10);
  *(int *)((int)this + 0x10) = iVar4;
  uVar5 = FUN_6b848d20(this,uVar1,iVar2,iVar3,iVar4);
  if ((char)uVar5 == '\0') {
    *(undefined *)((int)this + 0x1c) = 1;
  }
  return (undefined4 *)this;
}



undefined4 * __fastcall FUN_6b8489c1(void *param_1)

{
  undefined4 *extraout_ECX;
  
  FUN_6b8489e8(param_1,0x3764f,0x37b9da);
  *extraout_ECX = &PTR_FUN_6b8803a8;
  extraout_ECX[1] = 1;
  extraout_ECX[2] = 1;
  extraout_ECX[3] = 1;
  extraout_ECX[4] = 1;
  return extraout_ECX;
}



undefined4 * __thiscall FUN_6b8489e8(void *this,undefined4 param_1,undefined4 param_2)

{
  *(undefined4 *)((int)this + 0x14) = param_1;
  *(undefined4 *)((int)this + 0x18) = param_2;
  *(undefined ***)this = &PTR_FUN_6b88021c;
  *(undefined4 *)((int)this + 4) = 0;
  *(undefined4 *)((int)this + 8) = 0;
  *(undefined4 *)((int)this + 0xc) = 0;
  *(undefined4 *)((int)this + 0x10) = 0;
  *(undefined *)((int)this + 0x1c) = 0;
  return (undefined4 *)this;
}



undefined4 * __thiscall FUN_6b848a20(void *this,byte param_1)

{
  int in_FS_OFFSET;
  
  *(undefined ***)this = &PTR_FUN_6b88021c;
  if ((param_1 & 1) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,this);
  }
  return (undefined4 *)this;
}



void __thiscall FUN_6b848a50(void *this,int param_1)

{
  int iVar1;
  code *pcVar2;
  char cVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  undefined4 uVar8;
  int iVar9;
  
  iVar1 = *(int *)((int)this + 0x10);
  iVar7 = *(int *)((int)this + 8);
  iVar4 = param_1 + *(int *)((int)this + 0xc);
  iVar5 = iVar4 + -1;
  if (iVar5 < 0) {
    iVar6 = iVar4 % 0xc + 0xc;
    iVar5 = iVar4 + -0xc;
  }
  else {
    iVar6 = iVar5 % 0xc + 1;
  }
  iVar4 = iVar7 + iVar5 / 0xc;
                    // WARNING: Load size is inaccurate
  uVar8 = *(undefined4 *)((int)this + 4);
  pcVar2 = *(code **)(*this + 0x74);
  iVar9 = iVar6;
  _guard_check_icall();
  cVar3 = (*pcVar2)(uVar8,iVar4,iVar9);
  if (cVar3 == '\0') {
    *(undefined *)((int)this + 0x1c) = 1;
  }
  else {
    iVar7 = iVar7 + iVar5 / 0xc;
    iVar5 = FUN_6b848b36(this,iVar7,iVar6,iVar1);
    *(int *)((int)this + 8) = iVar7;
    *(int *)((int)this + 0xc) = iVar6;
    *(int *)((int)this + 0x10) = iVar5;
  }
  return;
}



void __thiscall FUN_6b848ae0(void *this,int param_1)

{
  code *pcVar1;
  char cVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  
                    // WARNING: Load size is inaccurate
  iVar5 = *(int *)((int)this + 8) + param_1;
  uVar6 = *(undefined4 *)((int)this + 4);
  pcVar1 = *(code **)(*this + 0x70);
  iVar3 = iVar5;
  _guard_check_icall();
  cVar2 = (*pcVar1)(uVar6,iVar3);
  if (cVar2 == '\0') {
    *(undefined *)((int)this + 0x1c) = 1;
  }
  else {
    iVar3 = FUN_6b848bb8(iVar5,*(int *)((int)this + 0xc));
    iVar4 = FUN_6b848b36(this,iVar5,iVar3,*(int *)((int)this + 0x10));
    *(int *)((int)this + 8) = iVar5;
    *(int *)((int)this + 0xc) = iVar3;
    *(int *)((int)this + 0x10) = iVar4;
  }
  return;
}



int __thiscall FUN_6b848b36(void *this,int param_1,int param_2,int param_3)

{
  int iVar1;
  
  if (param_1 == 1) {
    if ((param_2 < 2) && (param_2 = 1, param_3 < 1)) {
      param_3 = 1;
      param_2 = 1;
    }
  }
  else if (((param_1 == 0x24a2) && (9 < param_2)) && (param_2 = 10, 0xd < param_3)) {
    param_3 = 0xd;
  }
  iVar1 = FUN_6b848c7c(this,param_1,param_2);
  if (iVar1 < param_3) {
    param_3 = iVar1;
  }
  return param_3;
}



void __fastcall FUN_6b848b90(int param_1)

{
  int iVar1;
  int iVar2;
  void *this;
  
  iVar1 = FUN_6b848bb8(*(int *)(param_1 + 8),*(int *)(param_1 + 0xc));
  iVar2 = FUN_6b848b36(this,*(int *)(param_1 + 8),iVar1,*(int *)(param_1 + 0x10));
  *(int *)(param_1 + 0xc) = iVar1;
  *(int *)(param_1 + 0x10) = iVar2;
  return;
}



int FUN_6b848bb8(int param_1,int param_2)

{
  if (param_1 == 1) {
    if (param_2 < 2) {
      param_2 = 1;
    }
  }
  else if ((param_1 == 0x24a2) && (9 < param_2)) {
    param_2 = 10;
  }
  return param_2;
}



int * __thiscall FUN_6b848be5(void *this,int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  
  iVar1 = *(int *)(&DAT_6b8887f0 + param_1 * 4);
  iVar2 = _ftol2_sse();
  FUN_6b848e7f(this,(DAT_6b8b0170 - iVar2) + 0xb4);
                    // WARNING: Load size is inaccurate
  *(int *)this = *this + iVar1 + param_2 + -1;
  return (int *)this;
}



uint __thiscall FUN_6b848c43(void *this,int param_1)

{
  uint uVar1;
  
  *(undefined4 *)(param_1 + 4) = *(undefined4 *)((int)this + 4);
  *(undefined4 *)(param_1 + 8) = *(undefined4 *)((int)this + 8);
  *(undefined4 *)(param_1 + 0xc) = *(undefined4 *)((int)this + 0xc);
  *(undefined4 *)(param_1 + 0x10) = *(undefined4 *)((int)this + 0x10);
  uVar1 = FUN_6b84b1c8((int *)this);
  *(uint *)(param_1 + 0x14) = uVar1;
  return uVar1 & 0xffffff00 | (uint)(*(char *)((int)this + 0x1c) == '\0');
}



int __thiscall FUN_6b848c7c(void *this,undefined4 param_1,int param_2)

{
  code *pcVar1;
  char cVar2;
  int iVar3;
  
  iVar3 = *(int *)(&DAT_6b8887f4 + param_2 * 4) - *(int *)(&DAT_6b8887f0 + param_2 * 4);
  if (param_2 == 0xc) {
                    // WARNING: Load size is inaccurate
    pcVar1 = *(code **)(*this + 100);
    _guard_check_icall();
    cVar2 = (*pcVar1)(param_1);
    if (cVar2 == '\0') {
      iVar3 = iVar3 + -1;
    }
  }
  return iVar3;
}



uint FUN_6b848cc0(void)

{
  int *piVar1;
  int *piVar2;
  undefined local_c [4];
  undefined local_8 [4];
  
  piVar1 = FUN_6b848be5(local_8,1,1);
  piVar2 = FUN_6b848be5(local_c,1,1);
  return (uint)piVar2 & 0xffffff00 | (uint)(*piVar2 - *piVar1 == 0x16e);
}



void __fastcall FUN_6b848cfe(int *param_1)

{
  code *pcVar1;
  int iVar2;
  
  iVar2 = param_1[2];
  pcVar1 = *(code **)(*param_1 + 100);
  _guard_check_icall();
  (*pcVar1)(iVar2);
  return;
}



uint __thiscall FUN_6b848d20(void *this,undefined4 param_1,int param_2,int param_3,int param_4)

{
  code *pcVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  
                    // WARNING: Load size is inaccurate
  pcVar1 = *(code **)(*this + 0x74);
  iVar3 = param_2;
  iVar4 = param_3;
  _guard_check_icall();
  uVar2 = (*pcVar1)(param_1,iVar3,iVar4);
  if ((char)uVar2 != '\0') {
    if ((param_2 == 0x24a2) && (param_3 == 10)) {
      iVar3 = 0xd;
    }
    else {
      iVar3 = FUN_6b848c7c(this,param_2,param_3);
    }
    uVar2 = 0;
    if ((0 < param_4) && (param_4 <= iVar3)) {
      return 1;
    }
  }
  return uVar2 & 0xffffff00;
}



bool FUN_6b848d80(int param_1)

{
  return param_1 == 1;
}



uint __thiscall FUN_6b848d90(void *this,undefined4 param_1,int param_2,int param_3)

{
  code *pcVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  
                    // WARNING: Load size is inaccurate
  pcVar1 = *(code **)(*this + 0x70);
  iVar4 = param_2;
  _guard_check_icall();
  uVar2 = (*pcVar1)(param_1,iVar4);
  if ((((char)uVar2 == '\0') || (uVar3 = 1, param_3 < 1)) ||
     (uVar2 = (uint)(param_2 != 0x24a2) * 2 + 10, (int)uVar2 < param_3)) {
    uVar3 = 0;
  }
  return uVar2 & 0xffffff00 | uVar3;
}



uint __thiscall FUN_6b848de0(void *this,undefined4 param_1,int param_2)

{
  code *pcVar1;
  uint uVar2;
  
                    // WARNING: Load size is inaccurate
  pcVar1 = *(code **)(*this + 0x6c);
  _guard_check_icall();
  uVar2 = (*pcVar1)(param_1);
  if (((char)uVar2 == '\0') || (uVar2 = param_2 - 1, 0x24a1 < uVar2)) {
    uVar2 = uVar2 & 0xffffff00;
  }
  else {
    uVar2 = CONCAT31((int3)(uVar2 >> 8),1);
  }
  return uVar2;
}



void * __thiscall FUN_6b848e18(void *this,double param_1)

{
  undefined4 local_c;
  undefined4 local_8;
  
  FUN_6b849e90(&local_c,52.5);
  FUN_6b84a683(this,param_1,local_c,local_8);
  return this;
}



void * __thiscall FUN_6b848e60(int this,void *param_2)

{
  FUN_6b848be5(param_2,*(int *)(this + 0xc),*(int *)(this + 0x10));
  return param_2;
}



int * __thiscall FUN_6b848e7f(void *this,int param_1)

{
  undefined4 *puVar1;
  int iVar2;
  float10 fVar3;
  int local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 uStack52;
  double local_30;
  undefined4 local_28;
  undefined4 local_24;
  int local_20;
  undefined4 uStack28;
  double local_18;
  double local_10;
  
  FUN_6b849e90(&local_38,0.0);
  FUN_6b849e90(&local_20,2.0);
  FUN_6b849e90(&local_18,(double)CONCAT44(uStack52,local_38) + (double)CONCAT44(uStack28,local_20));
  local_40 = param_1 + 1;
  puVar1 = (undefined4 *)FUN_6b848e18(&local_10,(double)local_40);
  fVar3 = (float10)FUN_6b84a4fd((double)CONCAT44(uStack52,local_38),*puVar1,puVar1[1]);
  local_30 = floor((double)fVar3);
  local_30 = local_30 - 1.0;
  local_10 = local_30 + 3.0;
  for (; local_10 != local_30; local_30 = local_30 + 1.0) {
    FUN_6b848e18(&local_28,local_30);
    FUN_6b849f55(&local_20,(double)CONCAT44(local_24,local_28));
    local_40 = local_20;
    local_3c = uStack28;
    iVar2 = FUN_6b849eba(&local_38,(double *)&local_40);
    if (((char)iVar2 != '\0') && (iVar2 = FUN_6b849eba(&local_40,&local_18), (char)iVar2 != '\0'))
    break;
  }
  iVar2 = _ftol2_sse();
  *(int *)this = iVar2 + -1;
  return (int *)this;
}



void __thiscall FUN_6b848fa0(void *this,int param_1)

{
  code *pcVar1;
  char cVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  int iVar6;
  undefined4 unaff_ESI;
  undefined4 uVar7;
  undefined8 uVar8;
  int local_c;
  int local_8;
  
  FUN_6b848e7f(&local_8,param_1);
  local_c = local_8 - DAT_6b8b0170;
  floor((double)local_c / 365.242189 + 0.5);
  iVar3 = _ftol2_sse();
  iVar6 = iVar3 + 1;
  if (iVar3 < 0) {
    iVar6 = iVar3;
  }
  piVar4 = FUN_6b848be5(&local_c,1,1);
  local_8 = (param_1 + 1) - *piVar4;
  iVar5 = FUN_6b84b0df(local_8);
                    // WARNING: Load size is inaccurate
  local_8 = local_8 - *(int *)(&DAT_6b8887f0 + iVar5 * 4);
  uVar8 = CONCAT44(unaff_ESI,local_8);
  uVar7 = *(undefined4 *)((int)this + 4);
  pcVar1 = *(code **)(*this + 0x78);
  iVar3 = iVar6;
  local_c = iVar5;
  _guard_check_icall();
  cVar2 = (*pcVar1)(uVar7,iVar3,iVar5,uVar8);
  if (cVar2 == '\0') {
    *(undefined *)((int)this + 0x1c) = 1;
  }
  else {
    *(int *)((int)this + 0xc) = local_c;
    *(int *)((int)this + 8) = iVar6;
    *(int *)((int)this + 0x10) = local_8;
  }
  return;
}



int __fastcall FUN_6b849060(void *param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar1 = *(int *)((int)param_1 + 0xc);
  iVar2 = *(int *)((int)param_1 + 8);
  iVar3 = FUN_6b848c7c(param_1,iVar2,iVar1);
  if ((((iVar2 != 1) || (iVar1 != 1)) && (iVar2 == 0x24a2)) && (iVar1 == 10)) {
    iVar3 = 0xd;
  }
  return iVar3;
}



undefined4 __fastcall FUN_6b849090(int param_1)

{
  if ((*(int *)(param_1 + 8) != 1) && (*(int *)(param_1 + 8) == 0x24a2)) {
    return 10;
  }
  return 0xc;
}



bool __fastcall FUN_6b8490a7(int param_1,int param_2)

{
  undefined local_24 [28];
  char local_8;
  
  FUN_6b84896d(local_24,param_1);
  FUN_6b84b120(local_24,param_2);
  if (local_8 == '\0') {
    FUN_6b848c43(local_24,param_1);
  }
  else {
    SetLastError(0x57);
  }
  return local_8 == '\0';
}



bool __fastcall FUN_6b8490e9(int param_1,int param_2)

{
  undefined local_24 [28];
  char local_8;
  
  FUN_6b84896d(local_24,param_1);
  FUN_6b848a50(local_24,param_2);
  if (local_8 == '\0') {
    FUN_6b848c43(local_24,param_1);
  }
  else {
    SetLastError(0x57);
  }
  return local_8 == '\0';
}



bool __fastcall FUN_6b84912b(int param_1,int param_2)

{
  undefined local_24 [28];
  char local_8;
  
  FUN_6b84896d(local_24,param_1);
  FUN_6b848ae0(local_24,param_2);
  if (local_8 == '\0') {
    FUN_6b848c43(local_24,param_1);
  }
  else {
    SetLastError(0x57);
  }
  return local_8 == '\0';
}



// WARNING: Could not reconcile some variable overlaps

void __fastcall FUN_6b84916d(int param_1,undefined2 *param_2)

{
  code *pcVar1;
  uint uVar2;
  uint extraout_EDX;
  int *piVar3;
  int local_44 [7];
  char local_28;
  undefined8 local_24;
  int local_1c;
  undefined2 local_18;
  undefined2 local_16;
  undefined2 local_14;
  undefined2 local_a;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  FUN_6b84896d(local_44,param_1);
  piVar3 = &local_1c;
  pcVar1 = *(code **)(local_44[0] + 0x7c);
  _guard_check_icall();
  (*pcVar1)(piVar3);
  local_24 = _allmul(local_1c + -0x8eac4,local_1c + -0x8eac4 >> 0x1f,0x2a69c000,0xc9);
  if ((local_28 == '\0') && (-1 < local_24)) {
    RtlTimeToTimeFields(&local_24,&local_18);
    *param_2 = local_18;
    param_2[1] = local_16;
    param_2[3] = local_14;
    param_2[2] = local_a;
    param_2[4] = *(undefined2 *)(param_1 + 0x18);
    param_2[5] = *(undefined2 *)(param_1 + 0x1c);
    param_2[6] = *(undefined2 *)(param_1 + 0x20);
    uVar2 = *(uint *)(param_1 + 0x24) % 10000;
    param_2[7] = (short)((ulonglong)*(uint *)(param_1 + 0x24) / 10000);
  }
  else {
    SetLastError(0x57);
    uVar2 = extraout_EDX;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



void __fastcall FUN_6b84924b(undefined2 *param_1,int param_2)

{
  char cVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar2;
  longlong lVar3;
  undefined local_44 [32];
  undefined4 local_24;
  int local_20;
  undefined2 local_18;
  undefined2 local_16;
  undefined2 local_14;
  undefined4 local_12;
  undefined4 local_e;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_18 = *param_1;
  local_16 = param_1[1];
  local_14 = param_1[3];
  local_12 = 0;
  local_e = 0;
  cVar1 = RtlTimeFieldsToTime(&local_18,&local_24);
  if (cVar1 == '\0') {
    SetLastError(0x57);
    uVar2 = extraout_EDX;
  }
  else {
    FUN_6b8489c1(local_44);
    lVar3 = FUN_6b848901(local_24,local_20);
    FUN_6b84b191(local_44,(int)lVar3 + 0x8eac4);
    FUN_6b848c43(local_44,param_2);
    *(uint *)(param_2 + 0x18) = (uint)(ushort)param_1[4];
    *(uint *)(param_2 + 0x1c) = (uint)(ushort)param_1[5];
    *(uint *)(param_2 + 0x20) = (uint)(ushort)param_1[6];
    *(uint *)(param_2 + 0x24) = (uint)(ushort)param_1[7] * 10000;
    uVar2 = extraout_EDX_00;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



int __fastcall FUN_6b849304(int param_1,int param_2,int param_3)

{
  int iVar1;
  void *this;
  undefined local_28 [28];
  char local_c;
  
  FUN_6b8489c1(local_28);
  FUN_6b84b340(this,param_3);
  FUN_6b84b3e0(local_28,param_2);
  FUN_6b84b390(local_28,param_1);
  if (local_c == '\0') {
    iVar1 = FUN_6b849060(local_28);
  }
  else {
    SetLastError(0x57);
    iVar1 = 0;
  }
  return iVar1;
}



int __fastcall FUN_6b849354(int param_1,int param_2)

{
  char cVar1;
  void *this;
  int iVar2;
  int local_24 [7];
  char local_8;
  
  FUN_6b8489c1(local_24);
  FUN_6b84b340(this,param_2);
  FUN_6b84b3e0(local_24,param_1);
  if (local_8 == '\0') {
    cVar1 = FUN_6b848cfe(local_24);
    iVar2 = (cVar1 != '\0') + 0x16d;
  }
  else {
    SetLastError(0x57);
    iVar2 = 0;
  }
  return iVar2;
}



int __fastcall FUN_6b8493a6(int param_1,int param_2)

{
  undefined local_4c [12];
  int local_40;
  int local_3c;
  char local_30;
  undefined local_2c [12];
  int local_20;
  int local_1c;
  char local_10;
  int local_c;
  int local_8;
  
  FUN_6b84896d(local_2c,param_1);
  FUN_6b84896d(local_4c,param_2);
  if ((local_10 == '\0') && (local_30 == '\0')) {
    FUN_6b848be5(&local_c,local_20,local_1c);
    FUN_6b848be5(&local_8,local_40,local_3c);
    local_8 = local_8 - local_c;
  }
  else {
    SetLastError(0x57);
    local_8 = 0;
  }
  return local_8;
}



undefined4 __fastcall FUN_6b849406(int param_1,int param_2)

{
  undefined4 uVar1;
  void *this;
  undefined local_24 [28];
  char local_8;
  
  FUN_6b8489c1(local_24);
  FUN_6b84b340(this,param_2);
  FUN_6b84b3e0(local_24,param_1);
  if (local_8 != '\0') {
    SetLastError(0x57);
    return 0;
  }
  uVar1 = FUN_6b849090((int)local_24);
  return uVar1;
}



undefined4 __fastcall FUN_6b849449(int param_1,int param_2)

{
  void *this;
  undefined local_24 [20];
  int local_10;
  int local_c;
  
  FUN_6b8489c1(local_24);
  FUN_6b84b191(this,local_10);
  FUN_6b848c43(local_24,param_1);
  *(undefined4 *)(param_1 + 0x18) = 0;
  *(undefined4 *)(param_1 + 0x1c) = 0;
  *(undefined4 *)(param_1 + 0x20) = 0;
  *(undefined4 *)(param_1 + 0x24) = 0;
  FUN_6b84b191(local_24,local_c);
  FUN_6b848c43(local_24,param_2);
  *(undefined4 *)(param_2 + 0x1c) = 0x3b;
  *(undefined4 *)(param_2 + 0x20) = 0x3b;
  *(undefined4 *)(param_2 + 0x18) = 0x17;
  *(undefined4 *)(param_2 + 0x24) = 9999999;
  return 1;
}



undefined4 __fastcall FUN_6b8494b0(int param_1,int param_2,int param_3,int param_4)

{
  char cVar1;
  void *this;
  int local_28 [7];
  char local_c;
  
  FUN_6b8489c1(local_28);
  FUN_6b84b340(this,param_4);
  FUN_6b84b3e0(local_28,param_3);
  FUN_6b84b390(local_28,param_2);
  FUN_6b84b300(local_28,param_1);
  if (local_c == '\0') {
    cVar1 = FUN_6b848cfe(local_28);
    if (((cVar1 != '\0') && (param_2 == 0xc)) && (param_1 == 0x1e)) {
      return 1;
    }
  }
  else {
    SetLastError(0x57);
  }
  return 0;
}



undefined4 __fastcall FUN_6b849527(int param_1,int param_2,int param_3)

{
  void *this;
  undefined local_24 [28];
  char local_8;
  
  FUN_6b8489c1(local_24);
  FUN_6b84b340(this,param_3);
  FUN_6b84b3e0(local_24,param_2);
  FUN_6b84b390(local_24,param_1);
  if (local_8 != '\0') {
    SetLastError(0x57);
  }
  return 0;
}



bool __fastcall FUN_6b84956d(int param_1,int param_2)

{
  char cVar1;
  void *this;
  bool bVar2;
  int local_24 [7];
  char local_8;
  
  FUN_6b8489c1(local_24);
  FUN_6b84b340(this,param_2);
  FUN_6b84b3e0(local_24,param_1);
  if (local_8 == '\0') {
    cVar1 = FUN_6b848cfe(local_24);
    bVar2 = cVar1 != '\0';
  }
  else {
    SetLastError(0x57);
    bVar2 = false;
  }
  return bVar2;
}



undefined4 __fastcall FUN_6b8495b9(int param_1)

{
  int iVar1;
  int local_24 [7];
  char local_8;
  
  FUN_6b84896d(local_24,param_1);
  if ((((local_8 == '\0') && (iVar1 = FUN_6b84b1c8(local_24), iVar1 == *(int *)(param_1 + 0x14))) &&
      (*(uint *)(param_1 + 0x18) < 0x18)) &&
     (((*(uint *)(param_1 + 0x1c) < 0x3c && (*(uint *)(param_1 + 0x20) < 0x3c)) &&
      (*(uint *)(param_1 + 0x24) < 10000000)))) {
    return 1;
  }
  SetLastError(0x57);
  return 0;
}



bool __fastcall FUN_6b84960d(int param_1)

{
  int iVar1;
  int local_24 [7];
  char local_8;
  
  FUN_6b84896d(local_24,param_1);
  if (local_8 == '\0') {
    iVar1 = FUN_6b84b1c8(local_24);
    *(int *)(param_1 + 0x14) = iVar1;
  }
  else {
    SetLastError(0x57);
  }
  return local_8 == '\0';
}



undefined4 __fastcall FUN_6b849644(int param_1,undefined4 *param_2,uint param_3)

{
  bool bVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  undefined3 extraout_var;
  undefined3 extraout_var_00;
  uint *puVar5;
  uint uVar6;
  uint uVar7;
  int iVar8;
  
  if (param_1 - 0x376c5U < 0x344316) {
    iVar2 = FUN_6b84996c(param_3);
    uVar7 = param_1 + 1 + iVar2;
    uVar3 = (uVar7 * 0x1e - 0x67eb16) / 0x2987;
    uVar6 = uVar3 + 1;
    uVar4 = FUN_6b849915(uVar6);
    iVar2 = FUN_6b849ce3(uVar6,1);
    iVar8 = 0;
    if (iVar2 == 0) {
      iVar2 = 0;
    }
    else {
      bVar1 = FUN_6b849bcd(uVar6,1);
      iVar2 = (CONCAT31(extraout_var,bVar1) != 0) + 0x162;
    }
    if (uVar7 < uVar4) {
      uVar6 = uVar3;
      uVar4 = uVar4 - iVar2;
    }
    else if (uVar7 == uVar4) {
      iVar2 = FUN_6b849ce3(uVar3,1);
      if (iVar2 != 0) {
        bVar1 = FUN_6b849bcd(uVar3,1);
        iVar8 = (CONCAT31(extraout_var_00,bVar1) != 0) + 0x162;
      }
      uVar4 = uVar4 - iVar8;
      uVar6 = uVar3;
    }
    else if (iVar2 + uVar4 < uVar7) {
      uVar6 = uVar3 + 2;
      uVar4 = iVar2 + uVar4;
    }
    puVar5 = &DAT_6b8887c0;
    uVar3 = 1;
    uVar7 = uVar7 - uVar4;
    do {
      if (uVar7 < *puVar5 || uVar7 == *puVar5) break;
      uVar3 = uVar3 + 1;
      puVar5 = puVar5 + 1;
    } while (uVar3 < 0xd);
    if (uVar3 - 2 < 0xc) {
      iVar2 = *(int *)(&DAT_6b8887bc + (uVar3 - 1) * 4);
      param_2[3] = uVar3 - 1;
      param_2[2] = uVar6;
      param_2[4] = uVar7 - iVar2;
      param_2[5] = (param_1 + 1U) % 7;
      *param_2 = 6;
      param_2[1] = 1;
      return 1;
    }
  }
  return 0;
}



undefined4 __fastcall FUN_6b84976a(undefined4 *param_1,int param_2)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = FUN_6b849b5c((int)param_1);
  if ((param_2 + iVar1) - 0x376c5U < 0x344316) {
    uVar2 = FUN_6b849644(param_2 + iVar1,param_1,0);
  }
  else {
    SetLastError(0x120);
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 __fastcall FUN_6b8497a2(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  
  uVar6 = *(uint *)(param_1 + 0x10);
  iVar2 = *(int *)(param_1 + 0xc) + param_2;
  iVar1 = *(int *)(param_1 + 8);
  iVar3 = iVar2 + -1;
  if (iVar3 < 0) {
    uVar5 = iVar2 % 0xc + 0xc;
    iVar3 = iVar2 + -0xc;
  }
  else {
    uVar5 = iVar3 % 0xc + 1;
  }
  iVar3 = iVar3 / 0xc;
  iVar2 = FUN_6b849c99(uVar5,iVar1 + iVar3,*(int *)(param_1 + 4));
  if (iVar2 != 0) {
    if ((0x1d < uVar6) &&
       (uVar4 = FUN_6b849ac1(uVar5,iVar1 + iVar3,*(int *)(param_1 + 4)), uVar4 < uVar6)) {
      uVar6 = uVar4;
    }
    if (((iVar1 + iVar3 != 0x25c2) || (uVar5 != 4)) || (uVar6 < 4)) {
      *(uint *)(param_1 + 0x10) = uVar6;
      *(uint *)(param_1 + 0xc) = uVar5;
      *(int *)(param_1 + 8) = iVar1 + iVar3;
      iVar3 = FUN_6b849b5c(param_1);
      *(uint *)(param_1 + 0x14) = (iVar3 + 1U) % 7;
      return 1;
    }
  }
  SetLastError(0x120);
  return 0;
}



undefined4 __fastcall FUN_6b849860(int param_1,undefined2 *param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_2c [6];
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  iVar1 = FUN_6b849b5c(param_1);
  if ((iVar1 != 0) && (iVar1 = FUN_6b846e38(iVar1,local_2c), iVar1 != 0)) {
    local_14 = *(undefined4 *)(param_1 + 0x18);
    local_10 = *(undefined4 *)(param_1 + 0x1c);
    local_c = *(undefined4 *)(param_1 + 0x20);
    local_8 = *(undefined4 *)(param_1 + 0x24);
    uVar2 = FUN_6b846bef((int)local_2c,param_2);
    return uVar2;
  }
  return 0;
}



undefined4 __fastcall FUN_6b8498af(ushort *param_1,undefined4 *param_2,uint param_3)

{
  int iVar1;
  
  iVar1 = FUN_6b846cda((uint)*param_1,(uint)param_1[1],(uint)param_1[3]);
  if ((iVar1 != 0) && (iVar1 = FUN_6b849644(iVar1,param_2,param_3), iVar1 != 0)) {
    param_2[6] = (uint)param_1[4];
    param_2[7] = (uint)param_1[5];
    param_2[8] = (uint)param_1[6];
    param_2[9] = (uint)param_1[7] * 10000;
    param_2[5] = (uint)param_1[2];
    return 1;
  }
  return 0;
}



int __fastcall FUN_6b849915(int param_1)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  
  uVar1 = (param_1 - 1U) / 0x1e;
  iVar3 = (uVar1 * 0x4ddd2) / 0x1e + 0x376c5;
  iVar4 = param_1 + uVar1 * -0x1e + -1;
  if (iVar4 != 0) {
    uVar1 = iVar4 * 0xb + 0xe;
    do {
      uVar2 = uVar1 % 0x1e;
      uVar1 = uVar1 - 0xb;
      iVar3 = iVar3 + (uVar2 < 0xb) + 0x162;
      iVar4 = iVar4 + -1;
    } while (iVar4 != 0);
  }
  return iVar3;
}



void __fastcall FUN_6b84996c(uint param_1)

{
  int iVar1;
  uint extraout_EDX;
  wchar_t *pwVar2;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  uint uVar3;
  undefined *local_224;
  int local_220;
  undefined local_21c [532];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_220 = 0;
  iVar1 = OpenRegKey(&local_220,0,L"Control Panel\\International",0x20019,3);
  if (iVar1 < 0) {
    SetLastError(0x3f1);
    uVar3 = extraout_EDX;
  }
  else {
    local_224 = local_21c;
    pwVar2 = L"AddHijriDateTemp";
    if ((param_1 & 0x40000000) == 0) {
      pwVar2 = L"AddHijriDate";
    }
    iVar1 = FUN_6b812da7(local_220,pwVar2,&local_224);
    uVar3 = extraout_EDX_00;
    if (local_220 != 0) {
      NtClose(local_220);
      local_220 = 0;
      uVar3 = extraout_EDX_01;
    }
    if ((((-1 < iVar1) &&
         (pwVar2 = (wchar_t *)(local_224 + *(int *)(local_224 + 8)),
         0x17 < *(uint *)(local_224 + 0xc))) &&
        (iVar1 = wcsncmp(pwVar2,L"AddHijriDate",0xc), uVar3 = extraout_EDX_02, iVar1 == 0)) &&
       (pwVar2[0xc] != L'\0')) {
      uVar3 = (uint)(ushort)pwVar2[0xd];
    }
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar3);
  return;
}



int __fastcall FUN_6b849a7d(undefined4 *param_1)

{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined4 local_2c [4];
  undefined4 local_1c;
  
  iVar1 = FUN_6b849bfb((int)param_1,1);
  if (iVar1 != 0) {
    iVar1 = FUN_6b849b5c((int)param_1);
    puVar3 = local_2c;
    for (iVar2 = 10; iVar2 != 0; iVar2 = iVar2 + -1) {
      *puVar3 = *param_1;
      param_1 = param_1 + 1;
      puVar3 = puVar3 + 1;
    }
    local_2c[3] = 1;
    local_1c = 1;
    iVar2 = FUN_6b849b5c((int)local_2c);
    iVar1 = (iVar1 - iVar2) + 1;
  }
  return iVar1;
}



int __fastcall FUN_6b849ac1(uint param_1,int param_2,int param_3)

{
  bool bVar1;
  int iVar2;
  undefined3 extraout_var;
  
  iVar2 = FUN_6b849c99(param_1,param_2,param_3);
  if (iVar2 != 0) {
    if (param_1 == 0xc) {
      bVar1 = FUN_6b849bcd(param_2,param_3);
      iVar2 = (CONCAT31(extraout_var,bVar1) != 0) + 0x1d;
    }
    else {
      iVar2 = (param_1 & 1) + 0x1d;
    }
  }
  return iVar2;
}



undefined4 __fastcall FUN_6b849afe(int param_1,int param_2)

{
  *(undefined4 *)(param_1 + 0x14) = 4;
  *(undefined4 *)(param_1 + 0x18) = 0;
  *(undefined4 *)(param_1 + 0x1c) = 0;
  *(undefined4 *)(param_1 + 4) = 1;
  *(undefined4 *)(param_1 + 8) = 1;
  *(undefined4 *)(param_1 + 0xc) = 1;
  *(undefined4 *)(param_1 + 0x10) = 1;
  *(undefined4 *)(param_1 + 0x20) = 0;
  *(undefined4 *)(param_1 + 0x24) = 0;
  *(undefined4 *)(param_2 + 4) = 1;
  *(undefined4 *)(param_2 + 0xc) = 4;
  *(undefined4 *)(param_2 + 8) = 0x25c2;
  *(undefined4 *)(param_2 + 0x10) = 3;
  *(undefined4 *)(param_2 + 0x14) = 5;
  *(undefined4 *)(param_2 + 0x18) = 0x17;
  *(undefined4 *)(param_2 + 0x1c) = 0x3b;
  *(undefined4 *)(param_2 + 0x20) = 0x3b;
  *(undefined4 *)(param_2 + 0x24) = 9999999;
  return 1;
}



int __fastcall FUN_6b849b5c(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  iVar3 = FUN_6b84996c(0);
  iVar1 = *(int *)(&DAT_6b8887bc + *(int *)(param_1 + 0xc) * 4);
  iVar2 = *(int *)(param_1 + 0x10);
  iVar4 = FUN_6b849915(*(int *)(param_1 + 8));
  return iVar4 + -1 + ((iVar1 + iVar2) - iVar3);
}



int __fastcall FUN_6b849b86(uint param_1,uint param_2,int param_3,int param_4)

{
  bool bVar1;
  int iVar2;
  undefined3 extraout_var;
  
  iVar2 = FUN_6b849c61(param_1,param_2,param_3,param_4);
  if (iVar2 != 0) {
    iVar2 = 0;
    SetLastError(0);
    bVar1 = FUN_6b849bcd(param_3,param_4);
    if (((CONCAT31(extraout_var,bVar1) != 0) && (param_2 == 0xc)) && (param_1 == 0x1e)) {
      iVar2 = 1;
    }
  }
  return iVar2;
}



bool __fastcall FUN_6b849bcd(int param_1,int param_2)

{
  int iVar1;
  
  iVar1 = FUN_6b849ce3(param_1,param_2);
  if (iVar1 == 0) {
    return false;
  }
  SetLastError(0);
  return (param_1 * 0xb + 0xeU) % 0x1e < 0xb;
}



undefined4 __thiscall FUN_6b849bfb(int this,int param_2)

{
  int iVar1;
  
  iVar1 = FUN_6b849c61(*(uint *)(this + 0x10),*(uint *)(this + 0xc),*(int *)(this + 8),
                       *(int *)(this + 4));
  if (iVar1 != 0) {
    if ((((*(uint *)(this + 0x18) < 0x18) && (*(uint *)(this + 0x1c) < 0x3c)) &&
        (*(uint *)(this + 0x20) < 0x3c)) &&
       ((*(uint *)(this + 0x24) < 10000000 &&
        ((param_2 == 0 || (iVar1 = FUN_6b849b5c(this), *(uint *)(this + 0x14) == (iVar1 + 1U) % 7)))
        ))) {
      return 1;
    }
    SetLastError(0x57);
  }
  return 0;
}



undefined4 __fastcall FUN_6b849c61(uint param_1,uint param_2,int param_3,int param_4)

{
  uint uVar1;
  
  uVar1 = FUN_6b849ac1(param_2,param_3,param_4);
  if (uVar1 != 0) {
    if ((param_1 != 0) && (param_1 <= uVar1)) {
      return 1;
    }
    SetLastError(0x57);
  }
  return 0;
}



undefined4 __fastcall FUN_6b849c99(uint param_1,int param_2,int param_3)

{
  int iVar1;
  DWORD dwErrCode;
  
  iVar1 = FUN_6b849ce3(param_2,param_3);
  if (iVar1 != 0) {
    if (param_1 - 1 < 0xc) {
      if ((param_2 != 0x25c2) || (param_1 < 5)) {
        return 1;
      }
      dwErrCode = 0x120;
    }
    else {
      dwErrCode = 0x57;
    }
    SetLastError(dwErrCode);
  }
  return 0;
}



undefined4 __fastcall FUN_6b849ce3(int param_1,int param_2)

{
  DWORD dwErrCode;
  
  if (param_2 == 1) {
    if (param_1 - 1U < 0x25c2) {
      return 1;
    }
    dwErrCode = 0x120;
  }
  else {
    dwErrCode = 0x57;
  }
  SetLastError(dwErrCode);
  return 0;
}



undefined4 __fastcall FUN_6b849d05(int param_1)

{
  int iVar1;
  
  iVar1 = FUN_6b849bfb(param_1,0);
  if (iVar1 == 0) {
    return 0;
  }
  iVar1 = FUN_6b849b5c(param_1);
  *(uint *)(param_1 + 0x14) = (iVar1 + 1U) % 7;
  return 1;
}



int __fastcall FUN_6b849d2e(int param_1,int param_2)

{
  int iVar1;
  
  iVar1 = param_1 / param_2;
  if (iVar1 < 0) {
    if (iVar1 * param_2 - param_1 != 0) {
      return iVar1 + -1;
    }
  }
  else if (iVar1 == 0) {
    if (param_1 < 0) {
      if (param_2 < 0) {
        return 0;
      }
    }
    else if (-1 < param_2) {
      return 0;
    }
    iVar1 = -1;
  }
  return iVar1;
}



float10 __fastcall FUN_6b849d5d(double *param_1,double *param_2,double param_3)

{
  float10 fVar1;
  
  if (param_1 == param_2) {
    fVar1 = (float10)0;
  }
  else {
    fVar1 = FUN_6b849d9b(param_1 + 1,param_2,*param_1,1.0,param_3);
  }
  return fVar1;
}



float10 __fastcall
FUN_6b849d9b(double *param_1,double *param_2,double param_3,double param_4,double param_5)

{
  double dVar1;
  uint uVar2;
  uint uVar3;
  float10 fVar4;
  float10 fVar5;
  
  uVar3 = 0;
  uVar2 = ~-(uint)(param_2 < param_1) & (uint)((int)param_2 + (7 - (int)param_1)) >> 3;
  if (uVar2 == 0) {
    fVar5 = (float10)param_3;
  }
  else {
    fVar4 = (float10)param_4;
    fVar5 = (float10)param_3;
    do {
      fVar4 = fVar4 * (float10)param_5;
      dVar1 = *param_1;
      param_1 = param_1 + 1;
      uVar3 = uVar3 + 1;
      fVar5 = (float10)dVar1 * fVar4 + fVar5;
    } while (uVar3 != uVar2);
  }
  return fVar5;
}



float10 FUN_6b849de4(double param_1)

{
  uint uVar1;
  float10 fVar2;
  float10 fVar3;
  
  fVar3 = (float10)1;
  fVar2 = (float10)param_1;
  uVar1 = 2;
  while( true ) {
    if ((uVar1 & 1) != 0) {
      fVar3 = fVar3 * fVar2;
    }
    uVar1 = uVar1 >> 1;
    if (uVar1 == 0) break;
    fVar2 = fVar2 * fVar2;
  }
  return fVar3;
}



float10 FUN_6b849e07(double param_1,double param_2)

{
  short sVar1;
  char extraout_CL;
  float10 fVar2;
  
  FUN_6b849e35(param_1);
  sVar1 = FUN_6b849e35(param_2);
  fVar2 = (float10)param_1;
  if (extraout_CL != (char)sVar1) {
    fVar2 = -fVar2;
  }
  return fVar2;
}



short FUN_6b849e35(double param_1)

{
  ushort uVar1;
  byte bVar3;
  short sVar2;
  
  if (param_1 == 0.0) {
    param_1 = param_1 / 1.0;
  }
  uVar1 = (ushort)(param_1 == 0.0) << 0xe;
  bVar3 = 0.0 < param_1 | (byte)(uVar1 >> 8);
  if ((ushort)((ushort)(0.0 < param_1) << 8 | uVar1) == 0) {
    sVar2 = CONCAT11(bVar3,1);
  }
  else {
    sVar2 = (ushort)bVar3 << 8;
  }
  return sVar2;
}



float10 FUN_6b849e5f(double param_1)

{
  float10 fVar1;
  double dVar2;
  double dVar3;
  
  dVar3 = (param_1 * 3.141592653589793) / 180.0;
  fVar1 = (float10)_CIsin();
  dVar2 = (double)fVar1;
  fVar1 = (float10)_CIcos(dVar2,dVar3);
  return (float10)dVar2 / fVar1;
}



double * __thiscall FUN_6b849e90(void *this,double param_1)

{
  float10 fVar1;
  
  fVar1 = FUN_6b84a6c8(param_1 + 180.0);
  *(double *)this = (double)(fVar1 - (float10)180.0);
  return (double *)this;
}



int __thiscall FUN_6b849eba(void *this,double *param_1)

{
  double dVar1;
  double dVar2;
  uint3 uVar4;
  int iVar3;
  
  dVar1 = *param_1;
                    // WARNING: Load size is inaccurate
  dVar2 = *this;
  uVar4 = (uint3)((uint)param_1 >> 8) & 0xffff00 |
          (uint3)(byte)(dVar1 < dVar2 | (byte)((ushort)((ushort)(dVar1 == dVar2) << 0xe) >> 8));
  if (dVar1 < dVar2) {
    iVar3 = (uint)uVar4 << 8;
  }
  else {
    iVar3 = CONCAT31(uVar4,1);
  }
  return iVar3;
}



void __thiscall FUN_6b849ed7(void *this,double *param_1,undefined4 param_2,undefined4 param_3)

{
  float10 fVar1;
  
                    // WARNING: Load size is inaccurate
  fVar1 = (float10)FUN_6b84a312(*this - (double)CONCAT44(param_3,param_2) / 360.0);
                    // WARNING: Load size is inaccurate
  *param_1 = (double)((float10)*this - fVar1);
  return;
}



float10 __fastcall FUN_6b849f10(double *param_1)

{
  float10 fVar1;
  
  fVar1 = (float10)*param_1;
  if ((ushort)((ushort)((float10)0 < fVar1) << 8 | (ushort)((float10)0 == fVar1) << 0xe) == 0) {
    fVar1 = fVar1 + (float10)360.0;
  }
  return fVar1;
}



float10 __fastcall FUN_6b849f24(int param_1)

{
  int local_8;
  
  FUN_6b84a80b(&local_8,param_1,7);
  return (float10)(local_8 + -0xa955b) / (float10)36525.0;
}



void * __thiscall FUN_6b849f55(void *this,double param_1)

{
  undefined4 extraout_ECX;
  float10 fVar1;
  float10 fVar2;
  float10 fVar3;
  float10 fVar4;
  
  fVar1 = FUN_6b84a65e(param_1);
  fVar2 = FUN_6b84a868(extraout_ECX);
  fVar3 = (float10)_CIcos();
  fVar4 = (float10)FUN_6b84a704((double)fVar1);
  FUN_6b849e90(this,(double)(fVar4 + (float10)(double)((fVar3 * (float10)9.74e-05 -
                                                       (float10)0.005575) +
                                                      (float10)(double)((float10)36000.76953744 *
                                                                        (float10)(double)fVar1 +
                                                                        (float10)282.7771834 +
                                                                       fVar2 * (float10)
                                                  5.729577951308232e-06))));
  return this;
}



float10 FUN_6b849ff0(int param_1)

{
  float10 fVar1;
  int local_8;
  
  FUN_6b84a80b(&local_8,param_1,1);
  fVar1 = FUN_6b849de4((double)(local_8 + -0xa14f3) + 0.5);
  return (fVar1 / (float10)41048480.0 - (float10)15.0) / (float10)86400.0;
}



void FUN_6b84a040(int param_1)

{
  undefined4 extraout_EDX;
  double local_20;
  undefined8 local_18;
  undefined8 local_10;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_20 = 196.58333;
  local_18 = 0xc010451eb851eb85;
  local_10 = 0x3f967154d6f1e9bd;
  FUN_6b849d5d(&local_20,(double *)&local_8,(double)(param_1 + -0x640));
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,extraout_EDX);
  return;
}



void FUN_6b84a0b0(int param_1)

{
  undefined4 extraout_EDX;
  double local_28;
  undefined8 local_20;
  undefined8 local_18;
  undefined8 local_10;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_28 = 8.118780842;
  local_20 = 0xbf74db7f75b495a7;
  local_18 = 0x3f6b545a52e55dc6;
  local_10 = 0xbefbf1601a96051a;
  FUN_6b849d5d(&local_28,(double *)&local_8,(double)(param_1 + -0x6a4));
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,extraout_EDX);
  return;
}



void FUN_6b84a120(int param_1)

{
  undefined4 extraout_EDX;
  float10 fVar1;
  double local_60;
  undefined8 local_58;
  undefined8 local_50;
  undefined8 local_48;
  undefined8 local_40;
  undefined8 local_38;
  undefined8 local_30;
  undefined8 local_28;
  undefined8 local_20;
  undefined8 local_18;
  undefined8 local_10;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_60 = -9e-06;
  local_58 = 0x3f6f7d73c9257860;
  local_50 = 0x3fb564628027d88c;
  local_48 = 0x3febb41bfbdf090f;
  local_40 = 0x4013786594af4f0e;
  local_38 = 0x402fb0e9f6a93f29;
  local_30 = 0x403f550f733a8a40;
  local_28 = 0x404325603925bb7b;
  local_20 = 0x403c50f850df15a5;
  local_18 = 0x402745bc87db2b34;
  local_10 = 0x400059b0ab2e1694;
  fVar1 = FUN_6b849f24(param_1);
  FUN_6b849d5d(&local_60,(double *)&local_8,(double)fVar1);
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,extraout_EDX);
  return;
}



void FUN_6b84a1c0(int param_1)

{
  undefined4 extraout_EDX;
  float10 fVar1;
  double local_48;
  undefined8 local_40;
  undefined8 local_38;
  undefined8 local_30;
  undefined8 local_28;
  undefined8 local_20;
  undefined8 local_18;
  undefined8 local_10;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_48 = -2e-05;
  local_40 = 0x3f3376d549731099;
  local_38 = 0x3f99c9d5a187a4a5;
  local_30 = 0xbfc72f5dbb9cf9a0;
  local_28 = 0x3fe1b280f12c27a6;
  local_20 = 0xbfeb94ff0025bfad;
  local_18 = 0x3fe5aa8650e77920;
  local_10 = 0xbfcb362e90364389;
  fVar1 = FUN_6b849f24(param_1);
  FUN_6b849d5d(&local_48,(double *)&local_8,(double)fVar1);
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,extraout_EDX);
  return;
}



float10 FUN_6b84a240(int param_1)

{
  return (float10)(param_1 + -0x78d) / (float10)86400.0;
}



void FUN_6b84a265(double param_1)

{
  code *pcVar1;
  int iVar2;
  int *piVar3;
  undefined4 extraout_EDX;
  int local_40;
  code *local_3c [11];
  int local_10;
  code *local_c;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_40 = 0x7e4;
  local_3c[0] = FUN_6b849ff0;
  local_3c[1] = (code *)0x7c4;
  local_3c[2] = FUN_6b84a240;
  local_3c[3] = (code *)0x76c;
  local_3c[4] = FUN_6b84a1c0;
  local_3c[5] = (code *)0x708;
  local_3c[6] = FUN_6b84a120;
  local_3c[7] = (code *)0x6a4;
  local_3c[8] = FUN_6b84a0b0;
  local_3c[9] = (code *)0x654;
  local_3c[10] = FUN_6b84a040;
  local_10 = -0x80000000;
  local_c = FUN_6b849ff0;
  iVar2 = FUN_6b84a586(param_1);
  piVar3 = &local_40;
  do {
    if (*piVar3 == iVar2 || *piVar3 < iVar2) break;
    piVar3 = piVar3 + 2;
  } while (piVar3 != &local_10);
  pcVar1 = (code *)piVar3[1];
  _guard_check_icall();
  (*pcVar1)();
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,extraout_EDX);
  return;
}



void FUN_6b84a312(double param_1)

{
  double dVar1;
  double dVar2;
  undefined4 extraout_EDX;
  float10 fVar3;
  float10 fVar4;
  float10 fVar5;
  float10 fVar6;
  float10 fVar7;
  float10 fVar8;
  float10 fVar9;
  double dVar10;
  double local_2c;
  double local_24;
  undefined8 local_1c;
  undefined8 local_14;
  undefined8 local_c;
  
  local_c._4_4_ = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  fVar3 = FUN_6b84a65e(param_1);
  dVar1 = (double)fVar3;
  local_24 = 280.46645;
  local_1c = 0x40e19418a272862f;
  local_14 = 0x3f33deda158aabc0;
  FUN_6b849d5d(&local_24,(double *)&local_c,(double)fVar3);
  local_2c = 357.5291;
  local_24 = 35999.0503;
  local_1c = 0xbf246f22cd8a61ee;
  local_14 = 0xbea01b2b29a4692b;
  fVar3 = FUN_6b849d5d(&local_2c,(double *)&local_c,dVar1);
  dVar10 = (double)fVar3;
  local_24 = 0.016708617;
  local_1c = 0xbf060a1c525fe303;
  local_14 = 0xbe8096dd18f8b401;
  fVar3 = FUN_6b849d5d(&local_24,(double *)&local_c,dVar1);
  dVar2 = (double)fVar3;
  fVar3 = (float10)FUN_6b84a7b4(dVar1);
  fVar3 = FUN_6b849e5f((double)(fVar3 * (float10)0.5));
  dVar1 = (double)(fVar3 * fVar3);
  fVar3 = (float10)_CIsin(dVar10);
  fVar4 = (float10)_CIsin();
  fVar5 = (float10)_CIcos();
  fVar6 = FUN_6b849de4(dVar1);
  fVar7 = (float10)_CIsin();
  fVar8 = FUN_6b849de4(dVar2);
  fVar9 = (float10)_CIsin();
  fVar4 = ((float10)(double)((float10)(double)(fVar5 * (float10)(double)fVar3 *
                                                       (float10)dVar2 * (float10)4.0 *
                                                       (float10)dVar1 +
                                              (float10)(double)(fVar4 * (float10)dVar1 -
                                                               ((float10)dVar2 + (float10)dVar2) *
                                                               (float10)(double)fVar3)) -
                            fVar7 * (float10)(double)(fVar6 * (float10)0.5)) -
          fVar9 * (float10)(double)(fVar8 * (float10)1.25)) / (float10)6.283185307179586;
  fVar3 = ABS(fVar4);
  if ((float10)0.5 < fVar3) {
    fVar3 = (float10)0.5;
  }
  FUN_6b849e07((double)fVar3,(double)fVar4);
  FUN_6b8224af(local_c._4_4_ ^ (uint)&stack0xfffffffc,extraout_EDX);
  return;
}



void FUN_6b84a4fd(double param_1,undefined4 param_2,undefined4 param_3)

{
  float10 fVar1;
  double local_14;
  double local_c;
  
  local_c = (double)CONCAT44(param_3,param_2);
  FUN_6b849f55(&local_14,(double)CONCAT44(param_3,param_2));
  FUN_6b849e90(&local_14,local_14 - param_1);
  fVar1 = FUN_6b849f10(&local_14);
  fVar1 = (float10)local_c - fVar1 * (float10)1.014561636111111;
  local_c = (double)fVar1;
  local_14 = (double)fVar1;
  FUN_6b849f55(&local_14,local_14);
  FUN_6b849e90(&local_14,local_14 - param_1);
  return;
}



int FUN_6b84a586(double param_1)

{
  int *piVar1;
  int local_10 [2];
  int local_8;
  
  floor(param_1 - 1.0);
  local_8 = _ftol2_sse();
  piVar1 = FUN_6b84a5bc(local_10,&local_8);
  return *piVar1;
}



int * __fastcall FUN_6b84a5bc(int *param_1,int *param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  iVar4 = *param_2;
  iVar1 = FUN_6b849d2e(iVar4,0x23ab1);
  iVar4 = iVar4 + iVar1 * -0x23ab1;
  iVar2 = iVar4 / 0x8eac;
  if (iVar4 - 0x23ab0U < 0x8eac) {
    iVar2 = iVar2 + -1;
  }
  iVar4 = iVar4 + iVar2 * -0x8eac;
  iVar5 = iVar4 % 0x5b5;
  iVar3 = iVar5 / 0x16d;
  if (iVar5 - 0x5b4U < 0x16d) {
    iVar3 = iVar3 + -1;
  }
  *param_1 = ((iVar2 + iVar1 * 4) * 0x19 + iVar4 / 0x5b5) * 4 + 1 + iVar3;
  param_1[1] = iVar5 + iVar3 * -0x16d + 1;
  return param_1;
}



float10 FUN_6b84a65e(double param_1)

{
  float10 fVar1;
  
  fVar1 = (float10)FUN_6b84a265(param_1);
  return ((fVar1 + (float10)param_1) - (float10)730120.5) / (float10)36525.0;
}



double * __thiscall FUN_6b84a683(void *this,double param_1,undefined4 param_2,undefined4 param_3)

{
  double *pdVar1;
  double local_1c;
  double local_14;
  undefined4 local_c;
  undefined4 uStack8;
  
  local_14 = param_1 + 0.5;
  uStack8 = param_3;
  local_c = param_2;
  pdVar1 = (double *)FUN_6b849ed7(&local_14,&local_1c,param_2,param_3);
  *(double *)this = *pdVar1 - (double)CONCAT44(uStack8,local_c) / 360.0;
  return (double *)this;
}



float10 FUN_6b84a6c8(double param_1)

{
  float10 fVar1;
  double dVar2;
  
  dVar2 = floor(param_1 / 360.0);
  fVar1 = (float10)param_1 - (float10)dVar2 * (float10)360.0;
  if ((ushort)((ushort)((float10)0 < fVar1) << 8 | (ushort)((float10)0 == fVar1) << 0xe) == 0) {
    fVar1 = (float10)360.0 + fVar1;
  }
  return fVar1;
}



void FUN_6b84a704(double param_1)

{
  undefined4 extraout_EDX;
  float10 fVar1;
  double dVar2;
  double local_3c;
  undefined8 local_34;
  undefined8 local_2c;
  double local_24;
  undefined8 local_1c;
  undefined8 local_14;
  undefined8 local_c;
  
  local_c._4_4_ = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_24 = 124.9;
  local_1c = 0xc09e3889374bc6a8;
  local_14 = 0x3f60e66cb10342ab;
  local_3c = 201.11;
  local_34 = 0x40f194189a6b50b1;
  local_2c = 0x3f42ad81adea8976;
  FUN_6b849d5d(&local_24,(double *)&local_c,param_1);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)-0.004778);
  FUN_6b849d5d(&local_3c,&local_24,param_1);
  _CIsin(dVar2);
  FUN_6b8224af(local_c._4_4_ ^ (uint)&stack0xfffffffc,extraout_EDX);
  return;
}



void FUN_6b84a7b4(double param_1)

{
  undefined4 extraout_EDX;
  double local_2c;
  undefined8 local_24;
  undefined8 local_1c;
  undefined8 local_14;
  undefined8 local_c;
  
  local_c._4_4_ = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_2c = 23.43929111111111;
  local_24 = 0xbf8aa1edb45c4bea;
  local_1c = 0xbe85ff2de9770fa3;
  local_14 = 0x3ea0e5fc8b8ade57;
  FUN_6b849d5d(&local_2c,(double *)&local_c,param_1);
  FUN_6b8224af(local_c._4_4_ ^ (uint)&stack0xfffffffc,extraout_EDX);
  return;
}



int * __fastcall FUN_6b84a80b(int *param_1,int param_2,int param_3)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int extraout_ECX;
  int extraout_ECX_00;
  undefined *puVar6;
  
  uVar2 = FUN_6b84b427(param_2);
  puVar6 = &DAT_6b88885c;
  if ((char)uVar2 == '\0') {
    puVar6 = &DAT_6b888828;
  }
  iVar3 = FUN_6b849d2e(param_2 + -1,100);
  iVar1 = *(int *)(puVar6 + param_3 * 4 + -4);
  iVar4 = FUN_6b849d2e(extraout_ECX,400);
  iVar5 = FUN_6b849d2e(extraout_ECX_00,4);
  *param_1 = ((iVar1 + extraout_ECX * 0x16d) - iVar3) + iVar4 + iVar5;
  return param_1;
}



float10 __fastcall FUN_6b84a868(undefined4 param_1)

{
  float10 fVar1;
  double dVar2;
  
  fVar1 = (float10)_CIsin(param_1,param_1);
  dVar2 = (double)(fVar1 * (float10)403406.0 + (float10)0.0);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)195207.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)119433.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)112392.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)3891.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)2819.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)1721.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)660.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)350.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)334.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)314.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)268.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)242.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)234.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)158.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)132.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)129.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)114.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)99.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)93.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)86.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)78.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)72.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)68.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)64.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)46.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)38.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)37.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)32.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)29.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)28.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)27.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)27.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)25.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)24.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)21.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)21.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)20.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)18.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)17.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)14.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)13.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)13.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)13.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)12.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)10.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)10.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  dVar2 = (double)(fVar1 * (float10)10.0 + (float10)dVar2);
  fVar1 = (float10)_CIsin();
  return fVar1 * (float10)10.0 + (float10)dVar2;
}



int __fastcall FUN_6b84b0df(int param_1)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  
  piVar2 = (int *)&DAT_6b8887f4;
  iVar3 = 0xd;
  do {
    iVar1 = iVar3 / 2;
    if (piVar2[iVar1] < param_1) {
      piVar2 = piVar2 + iVar1 + 1;
      iVar1 = iVar3 + (-1 - iVar1);
    }
    iVar3 = iVar1;
  } while (0 < iVar1);
  return (int)(piVar2 + -0x1ae221fd) >> 2;
}



void __thiscall FUN_6b84b120(void *this,int param_1)

{
  code *pcVar1;
  void **ppvVar2;
  void *local_8;
  
  if (param_1 != 0) {
                    // WARNING: Load size is inaccurate
    ppvVar2 = &local_8;
    pcVar1 = *(code **)(*this + 0x7c);
    local_8 = this;
    _guard_check_icall();
    (*pcVar1)(ppvVar2);
    local_8 = (void *)((int)local_8 + param_1);
    FUN_6b84b191(this,(int)local_8);
  }
  return;
}



void __thiscall FUN_6b84b160(void *this,int param_1)

{
  int iVar1;
  int iVar2;
  
                    // WARNING: Load size is inaccurate
  iVar1 = *this;
  _guard_check_icall();
  iVar2 = (**(code **)(iVar1 + 0x10))();
  iVar2 = iVar2 + param_1;
  _guard_check_icall();
  (**(code **)(iVar1 + 0x14))(iVar2);
  return;
}



void __thiscall FUN_6b84b191(void *this,int param_1)

{
  code *pcVar1;
  
  if ((param_1 < *(int *)((int)this + 0x14)) || (*(int *)((int)this + 0x18) < param_1)) {
    *(undefined *)((int)this + 0x1c) = 1;
  }
  else {
                    // WARNING: Load size is inaccurate
    pcVar1 = *(code **)(*this + 0x80);
    _guard_check_icall();
    (*pcVar1)(param_1);
  }
  return;
}



int __fastcall FUN_6b84b1c8(int *param_1)

{
  code *pcVar1;
  int iVar2;
  int **ppiVar3;
  int *local_8;
  
  ppiVar3 = &local_8;
  pcVar1 = *(code **)(*param_1 + 0x7c);
  local_8 = param_1;
  _guard_check_icall();
  (*pcVar1)(ppiVar3);
  iVar2 = ((int)local_8 + 1) % 7;
  if (iVar2 < 0) {
    iVar2 = iVar2 + 7;
  }
  return iVar2;
}



uint __thiscall FUN_6b84b200(int this,uint param_2)

{
  return param_2 & 0xffffff00 | (uint)(param_2 == *(uint *)(this + 4));
}



int __fastcall FUN_6b84b220(int *param_1)

{
  code *pcVar1;
  int iVar2;
  int iVar3;
  
  pcVar1 = *(code **)(*param_1 + 0x58);
  _guard_check_icall();
  iVar2 = (*pcVar1)();
  pcVar1 = *(code **)(*param_1 + 0x60);
  _guard_check_icall();
  iVar3 = (*pcVar1)();
  return iVar3 + iVar2 + -1;
}



void __fastcall FUN_6b84b260(int *param_1)

{
  code *pcVar1;
  
  pcVar1 = *(code **)(*param_1 + 0xc);
  _guard_check_icall();
  (*pcVar1)();
  return;
}



int __fastcall FUN_6b84b280(int *param_1)

{
  code *pcVar1;
  int iVar2;
  int iVar3;
  
  pcVar1 = *(code **)(*param_1 + 0x40);
  _guard_check_icall();
  iVar2 = (*pcVar1)();
  pcVar1 = *(code **)(*param_1 + 0x48);
  _guard_check_icall();
  iVar3 = (*pcVar1)();
  return iVar3 + iVar2 + -1;
}



int __fastcall FUN_6b84b2c0(int *param_1)

{
  code *pcVar1;
  int iVar2;
  int iVar3;
  
  pcVar1 = *(code **)(*param_1 + 0x1c);
  _guard_check_icall();
  iVar2 = (*pcVar1)();
  pcVar1 = *(code **)(*param_1 + 0x24);
  _guard_check_icall();
  iVar3 = (*pcVar1)();
  return iVar3 + iVar2 + -1;
}



void __thiscall FUN_6b84b300(void *this,int param_1)

{
  code *pcVar1;
  char cVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  int iVar6;
  
  uVar5 = *(undefined4 *)((int)this + 0xc);
                    // WARNING: Load size is inaccurate
  uVar4 = *(undefined4 *)((int)this + 8);
  uVar3 = *(undefined4 *)((int)this + 4);
  pcVar1 = *(code **)(*this + 0x78);
  iVar6 = param_1;
  _guard_check_icall();
  cVar2 = (*pcVar1)(uVar3,uVar4,uVar5,iVar6);
  if (cVar2 == '\0') {
    *(undefined *)((int)this + 0x1c) = 1;
  }
  else {
    *(int *)((int)this + 0x10) = param_1;
  }
  return;
}



void __thiscall FUN_6b84b340(void *this,int param_1)

{
  code *pcVar1;
  char cVar2;
  int iVar3;
  
                    // WARNING: Load size is inaccurate
  pcVar1 = *(code **)(*this + 0x6c);
  iVar3 = param_1;
  _guard_check_icall();
  cVar2 = (*pcVar1)(iVar3);
  if (cVar2 == '\0') {
    *(undefined *)((int)this + 0x1c) = 1;
  }
  else {
                    // WARNING: Load size is inaccurate
    *(int *)((int)this + 4) = param_1;
    pcVar1 = *(code **)(*this + 0x68);
    _guard_check_icall();
    (*pcVar1)();
  }
  return;
}



void __thiscall FUN_6b84b390(void *this,int param_1)

{
  code *pcVar1;
  char cVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  int iVar5;
  
                    // WARNING: Load size is inaccurate
  uVar4 = *(undefined4 *)((int)this + 8);
  uVar3 = *(undefined4 *)((int)this + 4);
  pcVar1 = *(code **)(*this + 0x74);
  iVar5 = param_1;
  _guard_check_icall();
  cVar2 = (*pcVar1)(uVar3,uVar4,iVar5);
  if (cVar2 == '\0') {
    *(undefined *)((int)this + 0x1c) = 1;
  }
  else {
                    // WARNING: Load size is inaccurate
    *(int *)((int)this + 0xc) = param_1;
    pcVar1 = *(code **)(*this + 0x68);
    _guard_check_icall();
    (*pcVar1)();
  }
  return;
}



void __thiscall FUN_6b84b3e0(void *this,int param_1)

{
  code *pcVar1;
  char cVar2;
  undefined4 uVar3;
  int iVar4;
  
                    // WARNING: Load size is inaccurate
  uVar3 = *(undefined4 *)((int)this + 4);
  pcVar1 = *(code **)(*this + 0x70);
  iVar4 = param_1;
  _guard_check_icall();
  cVar2 = (*pcVar1)(uVar3,iVar4);
  if (cVar2 == '\0') {
    *(undefined *)((int)this + 0x1c) = 1;
  }
  else {
                    // WARNING: Load size is inaccurate
    *(int *)((int)this + 8) = param_1;
    pcVar1 = *(code **)(*this + 0x68);
    _guard_check_icall();
    (*pcVar1)();
  }
  return;
}



uint FUN_6b84b427(int param_1)

{
  uint uVar1;
  
  uVar1 = param_1 / 4;
  if ((param_1 % 4 == 0) &&
     ((uVar1 = param_1 / 100, param_1 % 100 != 0 || (uVar1 = param_1 / 400, param_1 % 400 == 0)))) {
    return CONCAT31((int3)(uVar1 >> 8),1);
  }
  return uVar1 & 0xffffff00;
}



BOOL EnumSystemGeoID(GEOCLASS GeoClass,GEOID ParentGeoId,GEO_ENUMPROC lpGeoEnumProc)

{
  int iVar1;
  int iVar2;
  BOOL BVar3;
  int iVar4;
  int *piVar5;
  
                    // 0x4b470  340  EnumSystemGeoID
  iVar1 = KernelBaseGetGlobalData();
  iVar1 = *(int *)(iVar1 + 0x3c);
  iVar2 = KernelBaseGetGlobalData();
  if (lpGeoEnumProc == (GEO_ENUMPROC)0x0) {
    RtlSetLastWin32Error(0x57);
    BVar3 = 0;
  }
  else if (((GeoClass == 0x10) || (GeoClass == 0xe)) || (GeoClass == 0)) {
    iVar4 = 0;
    if (0 < iVar1) {
      piVar5 = (int *)(*(int *)(iVar2 + 0x40) + 0x38);
      do {
        if ((((piVar5[-1] == GeoClass) || (GeoClass == 0)) &&
            ((*piVar5 == ParentGeoId || (ParentGeoId == 0)))) &&
           ((*(short *)(piVar5 + 5) != 0 && (piVar5[-0xe] != 0x10d)))) {
          iVar2 = piVar5[-0xe];
          _guard_check_icall();
          BVar3 = (*lpGeoEnumProc)(iVar2);
          if (BVar3 == 0) break;
        }
        iVar4 = iVar4 + 1;
        piVar5 = piVar5 + 0x1a;
      } while (iVar4 < iVar1);
    }
    BVar3 = 1;
  }
  else {
    RtlSetLastWin32Error(0x3ec);
    BVar3 = 0;
  }
  return BVar3;
}



undefined4 EnumSystemGeoNames(int param_1,undefined *param_2,undefined4 param_3)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  int iVar4;
  int iVar5;
  LPCWSTR lpString1;
  LPCWSTR pWVar6;
  
                    // 0x4b520  341  EnumSystemGeoNames
  iVar1 = KernelBaseGetGlobalData();
  iVar1 = *(int *)(iVar1 + 0x34);
  iVar2 = KernelBaseGetGlobalData();
  lpString1 = *(LPCWSTR *)(iVar2 + 0x38);
  iVar2 = KernelBaseGetGlobalData();
  iVar2 = *(int *)(iVar2 + 0x40);
  if (param_2 == (undefined *)0x0) {
    RtlSetLastWin32Error(0x57);
    uVar3 = 0;
  }
  else if (((param_1 == 0x10) || (param_1 == 0xe)) || (param_1 == 0)) {
    iVar5 = 0;
    if (0 < iVar1) {
      do {
        iVar4 = CompareStringOrdinal(lpString1,-1,(LPCWSTR)&lpString2_6b8888e0,-1,1);
        if ((iVar4 != 2) &&
           ((*(int *)(*(int *)(lpString1 + 4) * 0x68 + 0x34 + iVar2) == param_1 || (param_1 == 0))))
        {
          pWVar6 = lpString1;
          uVar3 = param_3;
          _guard_check_icall();
          iVar4 = (*(code *)param_2)(pWVar6,uVar3);
          if (iVar4 == 0) break;
        }
        iVar5 = iVar5 + 1;
        lpString1 = lpString1 + 6;
      } while (iVar5 < iVar1);
    }
    uVar3 = 1;
  }
  else {
    RtlSetLastWin32Error(0x3ec);
    uVar3 = 0;
  }
  return uVar3;
}



undefined4 GetGeoInfoEx(LPCWSTR param_1,int param_2,short *param_3,uint param_4)

{
  uint *puVar1;
  undefined4 uVar2;
  
                    // 0x4b5e0  609  GetGeoInfoEx
  if (((-1 < (int)param_4) &&
      (((param_3 != (short *)0x0 || ((int)param_4 < 1)) && (param_1 != (LPCWSTR)0x0)))) &&
     (puVar1 = (uint *)FUN_6b84b677(param_1), puVar1 != (uint *)0x0)) {
    uVar2 = FUN_6b84b941(puVar1,param_2,param_3,param_4);
    return uVar2;
  }
  RtlSetLastWin32Error(0x57);
  return 0;
}



int * __fastcall FUN_6b84b626(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  int iVar6;
  
  iVar2 = KernelBaseGetGlobalData();
  iVar2 = *(int *)(iVar2 + 0x3c);
  iVar3 = KernelBaseGetGlobalData();
  iVar6 = 0;
  iVar2 = iVar2 + -1;
  iVar5 = iVar2;
  if (-1 < iVar2) {
    do {
      iVar5 = iVar5 >> 1;
      piVar4 = (int *)(iVar5 * 0x68 + *(int *)(iVar3 + 0x40));
      iVar1 = *piVar4;
      if (param_1 == iVar1) {
        return piVar4;
      }
      if (param_1 < iVar1) {
        iVar2 = iVar5 + -1;
      }
      else {
        iVar6 = iVar5 + 1;
      }
      iVar5 = iVar2 + iVar6;
    } while (iVar6 <= iVar2);
  }
  return (int *)0x0;
}



int __fastcall FUN_6b84b677(LPCWSTR param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  iVar2 = KernelBaseGetGlobalData();
  iVar4 = 0;
  iVar1 = *(int *)(iVar2 + 0x38);
  iVar2 = KernelBaseGetGlobalData();
  iVar2 = *(int *)(iVar2 + 0x34) + -1;
  if (-1 < iVar2) {
    do {
      iVar5 = (iVar2 + iVar4) / 2;
      iVar3 = CompareStringOrdinal(param_1,-1,(LPCWSTR)(iVar5 * 0xc + iVar1),-1,1);
      if (iVar3 == 2) {
        iVar2 = KernelBaseGetGlobalData();
        if (*(int *)(iVar2 + 0x3c) <= iVar5) {
          return 0;
        }
        iVar2 = KernelBaseGetGlobalData();
        return *(int *)(iVar5 * 0xc + 8 + iVar1) * 0x68 + *(int *)(iVar2 + 0x40);
      }
      if (iVar3 == 1) {
        iVar2 = iVar5 + -1;
      }
      else {
        iVar4 = iVar5 + 1;
      }
    } while (iVar4 <= iVar2);
  }
  return 0;
}



int GetGeoInfoW(GEOID Location,GEOTYPE GeoType,LPWSTR lpGeoData,int cchData,LANGID LangId)

{
  ushort uVar1;
  uint *puVar2;
  uint uVar3;
  int iVar4;
  GEOTYPE extraout_EDX;
  GEOTYPE extraout_EDX_00;
  GEOTYPE extraout_EDX_01;
  GEOTYPE GVar5;
  GEOTYPE extraout_EDX_02;
  GEOTYPE extraout_EDX_03;
  GEOTYPE extraout_EDX_04;
  undefined8 uVar6;
  undefined4 uVar7;
  uint uVar8;
  uint local_ac;
  WCHAR local_a8 [80];
  uint local_8;
  
                    // 0x4b710  610  GetGeoInfoW
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  memset(local_a8,0,0xa0);
  local_ac = (uint)LangId;
  uVar6 = NlsValidateLocale(&local_ac,0);
  if ((cchData < 0) || (((lpGeoData == (LPWSTR)0x0 && (0 < cchData)) || ((int)uVar6 == 0)))) {
LAB_6b84b926:
    uVar7 = 0x57;
  }
  else {
    GVar5 = (GEOTYPE)((ulonglong)uVar6 >> 0x20);
    if (Location == -1) goto LAB_6b84b930;
    puVar2 = (uint *)FUN_6b84b626(Location);
    if (puVar2 == (uint *)0x0) goto LAB_6b84b926;
    if (GeoType == 1) {
      GVar5 = GeoType;
      if (puVar2[0xd] != 0x10) goto LAB_6b84b930;
      uVar3 = *puVar2;
      uVar8 = 0;
LAB_6b84b8e4:
      uVar7 = 10;
LAB_6b84b8e6:
      FUN_6b850b3f(uVar3,uVar7,uVar8,local_a8,0x50);
LAB_6b84b8ec:
      uVar3 = FUN_6b8502c0(local_a8);
      GVar5 = extraout_EDX_02;
      if (cchData == 0) goto LAB_6b84b930;
      if ((int)(uVar3 + 1) <= cchData) {
        FUN_6b81709d(lpGeoData,cchData,(int)local_a8,uVar3);
        GVar5 = extraout_EDX_03;
        goto LAB_6b84b930;
      }
    }
    else {
      if (GeoType != 6) {
        if (GeoType != 7) {
          if (GeoType != 0xd) {
            FUN_6b84b941(puVar2,GeoType,lpGeoData,cchData);
            GVar5 = extraout_EDX;
            goto LAB_6b84b930;
          }
          uVar3 = puVar2[0xe];
          uVar8 = 3;
          goto LAB_6b84b8e4;
        }
        if (LangId == 0) {
          LangId = GetUserDefaultLangID();
        }
        uVar3 = (uint)LangId;
        if (LangId < 0x400) {
          uVar3 = uVar3 | 0x400;
        }
        GVar5 = 0x400;
        local_ac = uVar3;
        if (uVar3 == 0) goto LAB_6b84b930;
        uVar8 = 8;
        uVar7 = 0x10;
        goto LAB_6b84b8e6;
      }
      if (LangId == 0) {
        LangId = GetUserDefaultLangID();
      }
      local_ac = (uint)LangId;
      iVar4 = GetLocaleInfoW(local_ac,0x59,local_a8,0x50);
      GVar5 = extraout_EDX_00;
      if ((iVar4 == 0) && (uVar1 = LangId & 0x3ff | 0x400, uVar1 != LangId)) {
        local_ac = (uint)uVar1;
        GetLocaleInfoW(local_ac,0x59,local_a8,0x50);
        GVar5 = extraout_EDX_01;
      }
      if (local_a8[0] == L'\0') goto LAB_6b84b930;
      iVar4 = FUN_6b81eeab(local_a8,0x50,(int)&DAT_6b888890);
      if ((-1 < iVar4) && (iVar4 = FUN_6b81eeab(local_a8,0x50,(int)(puVar2 + 0xf)), -1 < iVar4)) {
        _wcslwr(local_a8);
        goto LAB_6b84b8ec;
      }
    }
    uVar7 = 0x7a;
  }
  RtlSetLastWin32Error(uVar7);
  GVar5 = extraout_EDX_04;
LAB_6b84b930:
  iVar4 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,GVar5);
  return iVar4;
}



void __fastcall FUN_6b84b941(uint *param_1,int param_2,short *param_3,uint param_4)

{
  ushort uVar1;
  uint uVar2;
  uint uVar3;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  uint extraout_EDX_03;
  uint *puVar4;
  undefined4 uVar5;
  uint local_a8 [40];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  puVar4 = (uint *)0x0;
  memset(local_a8,0,0xa0);
  uVar3 = extraout_EDX;
  if ((param_2 == 0xd) &&
     (param_1 = (uint *)FUN_6b84b626(param_1[0xe]), uVar3 = extraout_EDX_00, param_1 != (uint *)0x0)
     ) {
    param_2 = 0x11;
  }
  switch(param_2) {
  case 2:
    puVar4 = param_1 + 1;
    break;
  case 3:
    puVar4 = param_1 + 7;
    break;
  case 4:
    puVar4 = param_1 + 0xf;
    break;
  case 5:
    puVar4 = param_1 + 0x11;
    break;
  default:
    RtlSetLastWin32Error(0x3ec);
    uVar3 = extraout_EDX_02;
    break;
  case 8:
switchD_6b84b99f_caseD_8:
    uVar2 = GetStringTableEntry(*param_1,local_a8,0x50,5);
    if (uVar2 != 0) goto LAB_6b84ba76;
    uVar5 = 0x57;
    goto LAB_6b84ba5d;
  case 9:
    uVar2 = GetStringTableEntry(*param_1,local_a8,0x50,6);
    if (uVar2 == 0) goto switchD_6b84b99f_caseD_8;
LAB_6b84ba76:
    puVar4 = local_a8;
    if (uVar2 == 0) goto LAB_6b84bab5;
    goto LAB_6b84babe;
  case 10:
  case 0xb:
    goto LAB_6b84ba65;
  case 0xc:
    uVar1 = *(ushort *)(param_1 + 0x13);
LAB_6b84b9d7:
    uVar3 = (uint)uVar1;
    uVar2 = 3;
    goto LAB_6b84b9d9;
  case 0xd:
    puVar4 = (uint *)&DAT_6b888894;
    goto LAB_6b84bab5;
  case 0xe:
    uVar3 = (uint)*(ushort *)((int)param_1 + 0x4e);
    uVar2 = 0;
    goto LAB_6b84b9d9;
  case 0xf:
    puVar4 = param_1 + 0x14;
    break;
  case 0x10:
    puVar4 = param_1 + 0x16;
    break;
  case 0x11:
    puVar4 = param_1 + 0xf;
    if (((*(short *)puVar4 == 0x58) && (*(short *)((int)param_1 + 0x3e) == 0x58)) &&
       (uVar1 = *(ushort *)(param_1 + 0x13), uVar1 != 0)) goto LAB_6b84b9d7;
    break;
  case 0x12:
    uVar3 = *param_1;
    uVar2 = 0;
LAB_6b84b9d9:
    FUN_6b850b3f(uVar3,10,uVar2,(short *)local_a8,0x50);
    puVar4 = local_a8;
    goto LAB_6b84bab5;
  }
  if (puVar4 != (uint *)0x0) {
LAB_6b84bab5:
    uVar2 = FUN_6b8502c0((short *)puVar4);
LAB_6b84babe:
    uVar3 = param_4;
    if (param_4 != 0) {
      if ((int)param_4 < (int)(uVar2 + 1)) {
        uVar5 = 0x7a;
LAB_6b84ba5d:
        RtlSetLastWin32Error(uVar5);
        uVar3 = extraout_EDX_01;
      }
      else {
        FUN_6b81709d(param_3,param_4,(int)puVar4,uVar2);
        uVar3 = extraout_EDX_03;
      }
    }
  }
LAB_6b84ba65:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar3);
  return;
}



void GetUserDefaultGeoName(short *param_1,uint param_2)

{
  undefined *puVar1;
  int iVar2;
  GEOID GVar3;
  int *piVar4;
  uint uVar5;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  int *piVar6;
  undefined4 uVar7;
  undefined *local_2c4;
  int local_2c0;
  undefined local_2bc [532];
  int local_a8 [40];
  uint local_8;
  
                    // 0x4bb40  791  GetUserDefaultGeoName
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_2c0 = 0;
  if (((int)param_2 < 0) || ((param_1 == (short *)0x0 && (0 < (int)param_2)))) {
    uVar7 = 0x57;
  }
  else {
    iVar2 = OpenRegKey(&local_2c0,0,L"Control Panel\\International\\Geo",0x20019,1);
    if (iVar2 < 0) {
LAB_6b84bbf8:
      GVar3 = GetUserGeoID(0x10);
      if ((GVar3 < 1) || (piVar4 = FUN_6b84b626(GVar3), piVar4 == (int *)0x0)) {
LAB_6b84bc49:
        piVar6 = (int *)&DAT_6b888894;
      }
      else {
        piVar6 = piVar4 + 0xf;
        if ((*(short *)piVar6 == 0x58) &&
           ((*(short *)((int)piVar4 + 0x3e) == 0x58 && (*(ushort *)(piVar4 + 0x13) != 0)))) {
          FUN_6b850b3f((uint)*(ushort *)(piVar4 + 0x13),10,3,(short *)local_a8,0x50);
          piVar6 = local_a8;
        }
        else if (piVar6 == (int *)0x0) goto LAB_6b84bc49;
      }
    }
    else {
      local_2c4 = local_2bc;
      iVar2 = FUN_6b812da7(local_2c0,L"Name",&local_2c4);
      puVar1 = local_2c4;
      if ((iVar2 < 0) || (*(uint *)(local_2c4 + 0xc) < 3)) goto LAB_6b84bbf8;
      uVar5 = *(uint *)(local_2c4 + 0xc) >> 1;
      if (0x50 < uVar5) {
        uVar5 = 0x50;
      }
      FUN_6b812c57((short *)local_a8,uVar5,(int)(local_2c4 + *(int *)(local_2c4 + 8)));
      piVar6 = (int *)(puVar1 + *(int *)(puVar1 + 8));
      if (piVar6 == (int *)0x0) goto LAB_6b84bbf8;
    }
    if (local_2c0 != 0) {
      NtClose(local_2c0);
      local_2c0 = 0;
    }
    uVar5 = FUN_6b8502c0((short *)piVar6);
    uVar7 = extraout_EDX;
    if (param_2 == 0) goto LAB_6b84bca4;
    if ((int)(uVar5 + 1) <= (int)param_2) {
      FUN_6b81709d(param_1,param_2,(int)piVar6,uVar5);
      uVar7 = extraout_EDX_00;
      goto LAB_6b84bca4;
    }
    uVar7 = 0x7a;
  }
  RtlSetLastWin32Error(uVar7);
  uVar7 = extraout_EDX_01;
LAB_6b84bca4:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar7);
  return;
}



BOOL SetUserGeoID(GEOID GeoId)

{
  int *piVar1;
  BOOL BVar2;
  
                    // 0x4bcc0  1396  SetUserGeoID
  piVar1 = FUN_6b84b626(GeoId);
  BVar2 = FUN_6b84bd40(piVar1);
  return BVar2;
}



void SetUserGeoName(LPCWSTR param_1)

{
  undefined4 *puVar1;
  int iVar2;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar3;
  WCHAR local_10 [4];
  uint local_8;
  
                    // 0x4bce0  1397  SetUserGeoName
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  puVar1 = (undefined4 *)FUN_6b84b677(param_1);
  iVar2 = GetUserDefaultGeoName(local_10,4);
  if ((iVar2 == 0) ||
     (iVar2 = CompareStringOrdinal(param_1,-1,local_10,iVar2,1), uVar3 = extraout_EDX, iVar2 != 2))
  {
    FUN_6b84bd40(puVar1);
    uVar3 = extraout_EDX_00;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar3);
  return;
}



void __fastcall FUN_6b84bd40(undefined4 *param_1)

{
  int iVar1;
  int iVar2;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 *puVar3;
  wchar_t *pwVar4;
  undefined4 uVar5;
  int local_214;
  undefined4 local_210 [130];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_214 = 0;
  memset(local_210,0,0x208);
  iVar1 = CheckGroupPolicyEnabled(L"PreventGeoIdChange",1);
  if (iVar1 == 0) {
    if (param_1 == (undefined4 *)0x0) {
      uVar5 = 0x57;
    }
    else {
      iVar1 = OpenRegKey(&local_214,0,L"Control Panel\\International\\Geo",0x2001f,3);
      if (-1 < iVar1) {
        puVar3 = param_1 + 0xf;
        if (((*(short *)puVar3 == 0x58) && (*(short *)((int)param_1 + 0x3e) == 0x58)) &&
           (*(ushort *)(param_1 + 0x13) != 0)) {
          FUN_6b850b3f((uint)*(ushort *)(param_1 + 0x13),10,3,(short *)local_210,0x104);
          puVar3 = local_210;
        }
        iVar1 = FUN_6b8502c0((short *)puVar3);
        iVar1 = FUN_6b850be7(local_214,L"Name",puVar3,iVar1 * 2 + 2);
        FUN_6b850b3f(*param_1,10,0,(short *)local_210,0x104);
        pwVar4 = L"Nation";
        if (param_1[0xd] != 0x10) {
          pwVar4 = L"Region";
        }
        iVar2 = FUN_6b8502c0((short *)local_210);
        iVar2 = FUN_6b850be7(local_214,pwVar4,local_210,iVar2 * 2 + 2);
        if (local_214 != 0) {
          NtClose(local_214);
          local_214 = 0;
        }
        if ((bool)(~(iVar2 != 0) & ~(iVar1 != 0))) {
          RtlPublishWnfStateData(0xa3bc2035,0x41950223,0,param_1,4,0);
          RtlPublishWnfStateData(0xa3bc1035,0x389022a,0,0,0,0);
          uVar5 = extraout_EDX_00;
        }
        else {
          RtlSetLastWin32Error(0x54f);
          uVar5 = extraout_EDX_01;
        }
        goto LAB_6b84bee3;
      }
      uVar5 = 0x54f;
    }
  }
  else {
    uVar5 = 0x4ec;
  }
  RtlSetLastWin32Error(uVar5);
  uVar5 = extraout_EDX;
LAB_6b84bee3:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar5);
  return;
}



int __fastcall FUN_6b84bef1(int *param_1,int param_2)

{
  ushort uVar1;
  bool bVar2;
  byte bVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  uint uVar8;
  ushort *puVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  ushort **ppuVar13;
  ushort *puVar14;
  uint local_20;
  uint local_1c;
  uint local_18;
  int local_14;
  int local_10;
  int local_8;
  
  iVar4 = param_1[0xe];
  FUN_6b84d664(param_1,(int)(param_1 + 0x17));
  if ((uint)param_1[0x1b] < (uint)param_1[0x18]) {
    puVar14 = (ushort *)param_1[0x12];
    while( true ) {
      ppuVar13 = (ushort **)(param_1 + 0xe);
      *ppuVar13 = puVar14;
      if ((ushort *)param_1[0xf] <= puVar14) break;
      param_1[0x12] = (int)puVar14;
      param_1[0x1b] = param_1[0x17];
      FUN_6b84d664(param_1,(int)ppuVar13);
      if ((ushort *)param_1[0xf] <= (ushort *)param_1[0x12]) break;
      *ppuVar13 = (ushort *)param_1[0x12];
      iVar5 = FUN_6b81cd80(param_1);
      if (iVar5 == 2) {
        param_1[0x23] = param_1[0x12] - iVar4 >> 1;
        return (int)*ppuVar13 - iVar4 >> 1;
      }
      if (param_2 != 0) break;
      puVar14 = *ppuVar13;
      param_1[0x12] = (int)puVar14;
      if (*(int *)(*param_1 + 0x104) != 0) {
        *(ushort *)((int)param_1 + 0x56) = *puVar14;
        uVar10 = (uint)*puVar14;
        if (param_1[1] != 0) {
          uVar10 = (uVar10 & 0xff) + *(int *)(param_1[1] + (uint)(*puVar14 >> 8) * 4);
        }
        local_8 = 0;
        param_1[0x14] = *(int *)(DAT_6b8b0800 + uVar10 * 4);
        bVar3 = (*(char *)((int)param_1 + 0x51) == '\x03') - 1U & *(byte *)((int)param_1 + 0x53) &
                0xc0;
        if (bVar3 != 0x40) {
          if (bVar3 != 0x80) {
            if (bVar3 != 0xc0) goto LAB_6b84c95f;
            uVar10 = *(uint *)(*param_1 + 0xfc) & 0x20;
            uVar1 = *(ushort *)(*(int *)(*param_1 + 0x104) + 0x14);
            if (((uVar1 != 0) && (puVar14 + (uVar10 != 0) + 7 <= (ushort *)param_1[0xf])) &&
               (local_8 = FUN_6b85026b(puVar14,(ushort *)param_1[0xf],8,
                                       *(ushort *)(*(int *)(*param_1 + 0x104) + 4),
                                       *(ushort *)(*(int *)(*param_1 + 0x104) + 6),uVar10,
                                       param_1[0x10]), 7 < local_8)) {
              iVar5 = 0;
              local_1c = uVar1 - 1;
              bVar2 = false;
              local_10 = 0;
              if ((uVar10 != 0) && (8 < local_8)) {
                iVar5 = param_1[1];
                uVar1 = *puVar14;
                if (iVar5 == 0) {
                  local_18 = *(uint *)(DAT_6b8b0800 + (uint)uVar1 * 4);
                }
                else {
                  local_18 = *(uint *)(DAT_6b8b0800 +
                                      ((uVar1 & 0xff) + *(int *)(iVar5 + (uint)(uVar1 >> 8) * 4)) *
                                      4);
                }
                uVar6 = (uint)puVar14[1];
                if (iVar5 != 0) {
                  uVar6 = (uVar6 & 0xff) + *(int *)(iVar5 + (uint)(puVar14[1] >> 8) * 4);
                }
                if (((*(uint *)(DAT_6b8b0800 + uVar6 * 4) ^ local_18) & 0xe7ffffff) == 0) {
                  iVar5 = 1;
                  bVar2 = true;
                }
                else {
                  iVar5 = 0;
                }
              }
              if (-1 < (int)local_1c) {
                do {
                  iVar11 = (int)(local_1c + local_10) / 2;
                  iVar7 = FUN_6b85023c((int)(puVar14 + iVar5),
                                       (ushort *)(iVar11 * 0x14 + *(int *)(*param_1 + 0x120)),8);
                  if (iVar7 == 0) {
                    param_1[0x14] = *(int *)(iVar11 * 0x14 + 0x10 + *(int *)(*param_1 + 0x120));
                    if (bVar2) goto LAB_6b84c953;
                    puVar9 = puVar14 + 7;
                    goto LAB_6b84c950;
                  }
                  if (iVar7 < 0) {
                    local_1c = iVar11 + -1;
                  }
                  else {
                    local_10 = iVar11 + 1;
                  }
                } while (local_10 <= (int)local_1c);
              }
            }
            uVar1 = *(ushort *)(*(int *)(*param_1 + 0x104) + 0x12);
            if ((uVar1 != 0) && (puVar14 + (uVar10 != 0) + 6 <= (ushort *)param_1[0xf])) {
              if (local_8 == 0) {
                local_8 = FUN_6b85026b(puVar14,(ushort *)param_1[0xf],7,
                                       *(ushort *)(*(int *)(*param_1 + 0x104) + 4),
                                       *(ushort *)(*(int *)(*param_1 + 0x104) + 6),uVar10,
                                       param_1[0x10]);
              }
              if (6 < local_8) {
                iVar5 = 0;
                local_18 = uVar1 - 1;
                bVar2 = false;
                local_10 = 0;
                if ((uVar10 != 0) && (7 < local_8)) {
                  iVar5 = param_1[1];
                  uVar1 = *puVar14;
                  if (iVar5 == 0) {
                    local_1c = *(uint *)(DAT_6b8b0800 + (uint)uVar1 * 4);
                  }
                  else {
                    local_1c = *(uint *)(DAT_6b8b0800 +
                                        ((uVar1 & 0xff) + *(int *)(iVar5 + (uint)(uVar1 >> 8) * 4))
                                        * 4);
                  }
                  uVar6 = (uint)puVar14[1];
                  if (iVar5 != 0) {
                    uVar6 = (uVar6 & 0xff) + *(int *)(iVar5 + (uint)(puVar14[1] >> 8) * 4);
                  }
                  if (((*(uint *)(DAT_6b8b0800 + uVar6 * 4) ^ local_1c) & 0xe7ffffff) == 0) {
                    iVar5 = 1;
                    bVar2 = true;
                  }
                  else {
                    iVar5 = 0;
                  }
                }
                if (-1 < (int)local_18) {
                  do {
                    iVar11 = (int)(local_18 + local_10) / 2;
                    iVar7 = FUN_6b85023c((int)(puVar14 + iVar5),
                                         (ushort *)(iVar11 * 0x14 + *(int *)(*param_1 + 0x11c)),7);
                    if (iVar7 == 0) {
                      param_1[0x14] = *(int *)(iVar11 * 0x14 + 0x10 + *(int *)(*param_1 + 0x11c));
                      if (bVar2) goto LAB_6b84c953;
                      puVar9 = puVar14 + 6;
                      goto LAB_6b84c950;
                    }
                    if (iVar7 < 0) {
                      local_18 = iVar11 + -1;
                    }
                    else {
                      local_10 = iVar11 + 1;
                    }
                  } while (local_10 <= (int)local_18);
                }
              }
            }
            uVar1 = *(ushort *)(*(int *)(*param_1 + 0x104) + 0x10);
            if ((uVar1 != 0) && (puVar14 + (uVar10 != 0) + 5 <= (ushort *)param_1[0xf])) {
              if (local_8 == 0) {
                local_8 = FUN_6b85026b(puVar14,(ushort *)param_1[0xf],6,
                                       *(ushort *)(*(int *)(*param_1 + 0x104) + 4),
                                       *(ushort *)(*(int *)(*param_1 + 0x104) + 6),uVar10,
                                       param_1[0x10]);
              }
              if (5 < local_8) {
                iVar5 = 0;
                local_1c = uVar1 - 1;
                bVar2 = false;
                local_10 = 0;
                if ((uVar10 != 0) && (6 < local_8)) {
                  iVar5 = param_1[1];
                  uVar1 = *puVar14;
                  if (iVar5 == 0) {
                    local_20 = *(uint *)(DAT_6b8b0800 + (uint)uVar1 * 4);
                  }
                  else {
                    local_20 = *(uint *)(DAT_6b8b0800 +
                                        ((uVar1 & 0xff) + *(int *)(iVar5 + (uint)(uVar1 >> 8) * 4))
                                        * 4);
                  }
                  uVar10 = (uint)puVar14[1];
                  if (iVar5 != 0) {
                    uVar10 = (uVar10 & 0xff) + *(int *)(iVar5 + (uint)(puVar14[1] >> 8) * 4);
                  }
                  if (((*(uint *)(DAT_6b8b0800 + uVar10 * 4) ^ local_20) & 0xe7ffffff) == 0) {
                    iVar5 = 1;
                    bVar2 = true;
                  }
                  else {
                    iVar5 = 0;
                  }
                }
                if (-1 < (int)local_1c) {
                  do {
                    iVar11 = (int)(local_1c + local_10) / 2;
                    iVar7 = FUN_6b85023c((int)(puVar14 + iVar5),
                                         (ushort *)(iVar11 * 0x10 + *(int *)(*param_1 + 0x118)),6);
                    if (iVar7 == 0) {
                      param_1[0x14] = *(int *)(*(int *)(*param_1 + 0x118) + 0xc + iVar11 * 0x10);
                      if (bVar2) goto LAB_6b84c953;
                      puVar9 = puVar14 + 5;
                      goto LAB_6b84c950;
                    }
                    if (iVar7 < 0) {
                      local_1c = iVar11 + -1;
                    }
                    else {
                      local_10 = iVar11 + 1;
                    }
                  } while (local_10 <= (int)local_1c);
                }
              }
            }
          }
          iVar5 = *param_1;
          iVar7 = *(int *)(iVar5 + 0x114);
          uVar10 = *(uint *)(iVar5 + 0xfc) & 0x20;
          uVar1 = *(ushort *)(*(int *)(iVar5 + 0x104) + 0xe);
          if ((uVar1 != 0) && (puVar14 + (uVar10 != 0) + 4 <= (ushort *)param_1[0xf])) {
            if (local_8 == 0) {
              local_8 = FUN_6b85026b(puVar14,(ushort *)param_1[0xf],5,
                                     *(ushort *)(*(int *)(*param_1 + 0x104) + 4),
                                     *(ushort *)(*(int *)(*param_1 + 0x104) + 6),uVar10,
                                     param_1[0x10]);
            }
            if (4 < local_8) {
              iVar5 = 0;
              local_14 = 0;
              local_10 = uVar1 - 1;
              bVar2 = false;
              if ((uVar10 != 0) && (5 < local_8)) {
                iVar5 = param_1[1];
                uVar1 = *puVar14;
                if (iVar5 == 0) {
                  local_20 = *(uint *)(DAT_6b8b0800 + (uint)uVar1 * 4);
                }
                else {
                  local_20 = *(uint *)(DAT_6b8b0800 +
                                      ((uVar1 & 0xff) + *(int *)(iVar5 + (uint)(uVar1 >> 8) * 4)) *
                                      4);
                }
                uVar6 = (uint)puVar14[1];
                if (iVar5 != 0) {
                  uVar6 = (uVar6 & 0xff) + *(int *)(iVar5 + (uint)(puVar14[1] >> 8) * 4);
                }
                if (((*(uint *)(DAT_6b8b0800 + uVar6 * 4) ^ local_20) & 0xe7ffffff) == 0) {
                  iVar5 = 1;
                  bVar2 = true;
                }
                else {
                  iVar5 = 0;
                }
              }
              if (-1 < local_10) {
                do {
                  iVar12 = (local_10 + local_14) / 2;
                  iVar11 = FUN_6b85023c((int)(puVar14 + iVar5),(ushort *)(iVar12 * 0x10 + iVar7),5);
                  if (iVar11 == 0) {
                    param_1[0x14] = *(int *)(iVar7 + 0xc + iVar12 * 0x10);
                    if (bVar2) goto LAB_6b84c953;
                    puVar9 = puVar14 + 4;
                    goto LAB_6b84c950;
                  }
                  if (iVar11 < 0) {
                    local_10 = iVar12 + -1;
                  }
                  else {
                    local_14 = iVar12 + 1;
                  }
                } while (local_14 <= local_10);
              }
            }
          }
          iVar5 = *(int *)(*param_1 + 0x110);
          uVar1 = *(ushort *)(*(int *)(*param_1 + 0x104) + 0xc);
          if ((uVar1 != 0) && (puVar14 + (uVar10 != 0) + 3 <= (ushort *)param_1[0xf])) {
            if (local_8 == 0) {
              local_8 = FUN_6b85026b(puVar14,(ushort *)param_1[0xf],4,
                                     *(ushort *)(*(int *)(*param_1 + 0x104) + 4),
                                     *(ushort *)(*(int *)(*param_1 + 0x104) + 6),uVar10,
                                     param_1[0x10]);
            }
            if (3 < local_8) {
              iVar7 = 0;
              bVar2 = false;
              local_1c = uVar1 - 1;
              local_10 = 0;
              if ((uVar10 != 0) && (4 < local_8)) {
                iVar7 = param_1[1];
                uVar1 = *puVar14;
                if (iVar7 == 0) {
                  local_20 = *(uint *)(DAT_6b8b0800 + (uint)uVar1 * 4);
                }
                else {
                  local_20 = *(uint *)(DAT_6b8b0800 +
                                      ((uVar1 & 0xff) + *(int *)(iVar7 + (uint)(uVar1 >> 8) * 4)) *
                                      4);
                }
                uVar10 = (uint)puVar14[1];
                if (iVar7 != 0) {
                  uVar10 = (uVar10 & 0xff) + *(int *)(iVar7 + (uint)(puVar14[1] >> 8) * 4);
                }
                if (((*(uint *)(DAT_6b8b0800 + uVar10 * 4) ^ local_20) & 0xe7ffffff) == 0) {
                  iVar7 = 1;
                  bVar2 = true;
                }
                else {
                  iVar7 = 0;
                }
              }
              if (-1 < (int)local_1c) {
                do {
                  iVar12 = (int)(local_1c + local_10) / 2;
                  iVar11 = FUN_6b85023c((int)(puVar14 + iVar7),(ushort *)(iVar12 * 0xc + iVar5),4);
                  if (iVar11 == 0) {
                    param_1[0x14] = *(int *)(iVar12 * 0xc + 8 + iVar5);
                    if (bVar2) goto LAB_6b84c953;
                    puVar9 = puVar14 + 3;
                    goto LAB_6b84c950;
                  }
                  if (iVar11 < 0) {
                    local_1c = iVar12 + -1;
                  }
                  else {
                    local_10 = iVar12 + 1;
                  }
                } while (local_10 <= (int)local_1c);
              }
            }
          }
        }
        iVar5 = *param_1;
        iVar7 = *(int *)(iVar5 + 0x10c);
        uVar10 = *(uint *)(iVar5 + 0xfc) & 0x20;
        uVar1 = *(ushort *)(*(int *)(iVar5 + 0x104) + 10);
        if ((uVar1 != 0) && (puVar14 + (uVar10 != 0) + 2 <= (ushort *)param_1[0xf])) {
          if (local_8 == 0) {
            local_8 = FUN_6b85026b(puVar14,(ushort *)param_1[0xf],3,
                                   *(ushort *)(*(int *)(*param_1 + 0x104) + 4),
                                   *(ushort *)(*(int *)(*param_1 + 0x104) + 6),uVar10,param_1[0x10])
            ;
          }
          if (2 < local_8) {
            iVar5 = 0;
            local_10 = uVar1 - 1;
            local_14 = 0;
            bVar2 = false;
            if ((uVar10 != 0) && (3 < local_8)) {
              iVar5 = param_1[1];
              uVar6 = (uint)*puVar14;
              if (iVar5 != 0) {
                uVar6 = (uVar6 & 0xff) + *(int *)(iVar5 + (uint)(*puVar14 >> 8) * 4);
              }
              uVar8 = (uint)puVar14[1];
              if (iVar5 != 0) {
                uVar8 = (uVar8 & 0xff) + *(int *)(iVar5 + (uint)(puVar14[1] >> 8) * 4);
              }
              if (((*(uint *)(DAT_6b8b0800 + uVar6 * 4) ^ *(uint *)(DAT_6b8b0800 + uVar8 * 4)) &
                  0xe7ffffff) == 0) {
                iVar5 = 1;
                bVar2 = true;
              }
              else {
                iVar5 = 0;
              }
            }
            if (-1 < local_10) {
              do {
                iVar12 = (local_10 + local_14) / 2;
                iVar11 = FUN_6b85023c((int)(puVar14 + iVar5),(ushort *)(iVar12 * 0xc + iVar7),3);
                if (iVar11 == 0) {
                  param_1[0x14] = *(int *)(iVar12 * 0xc + 8 + iVar7);
                  if (bVar2) goto LAB_6b84c953;
                  puVar9 = puVar14 + 2;
                  goto LAB_6b84c950;
                }
                if (iVar11 < 0) {
                  local_10 = iVar12 + -1;
                }
                else {
                  local_14 = iVar12 + 1;
                }
              } while (local_14 <= local_10);
            }
          }
        }
        iVar5 = *(int *)(*param_1 + 0x108);
        uVar1 = *(ushort *)(*(int *)(*param_1 + 0x104) + 8);
        if ((uVar1 != 0) && (puVar14 + (uVar10 != 0) + 1 <= (ushort *)param_1[0xf])) {
          if (local_8 == 0) {
            local_8 = FUN_6b85026b(puVar14,(ushort *)param_1[0xf],2,
                                   *(ushort *)(*(int *)(*param_1 + 0x104) + 4),
                                   *(ushort *)(*(int *)(*param_1 + 0x104) + 6),uVar10,param_1[0x10])
            ;
          }
          if (1 < local_8) {
            iVar7 = 0;
            local_1c = uVar1 - 1;
            bVar2 = false;
            local_10 = 0;
            if ((uVar10 != 0) && (2 < local_8)) {
              iVar7 = param_1[1];
              uVar1 = *puVar14;
              if (iVar7 == 0) {
                local_20 = *(uint *)(DAT_6b8b0800 + (uint)uVar1 * 4);
              }
              else {
                local_20 = *(uint *)(DAT_6b8b0800 +
                                    ((uVar1 & 0xff) + *(int *)(iVar7 + (uint)(uVar1 >> 8) * 4)) * 4)
                ;
              }
              uVar10 = (uint)puVar14[1];
              if (iVar7 != 0) {
                uVar10 = (uVar10 & 0xff) + *(int *)(iVar7 + (uint)(puVar14[1] >> 8) * 4);
              }
              if (((*(uint *)(DAT_6b8b0800 + uVar10 * 4) ^ local_20) & 0xe7ffffff) == 0) {
                iVar7 = 1;
                bVar2 = true;
              }
              else {
                iVar7 = 0;
              }
            }
            if (-1 < (int)local_1c) {
LAB_6b84c905:
              iVar12 = (int)(local_1c + local_10) / 2;
              iVar11 = FUN_6b85023c((int)(puVar14 + iVar7),(ushort *)(iVar5 + iVar12 * 8),2);
              if (iVar11 != 0) goto code_r0x6b84c920;
              param_1[0x14] = *(int *)(iVar5 + 4 + iVar12 * 8);
              if (!bVar2) {
                puVar9 = puVar14 + 1;
LAB_6b84c950:
                param_1[0x12] = (int)puVar9;
              }
LAB_6b84c953:
              puVar9 = (ushort *)param_1[0x12];
              param_1[0x12] = (int)puVar14;
              puVar14 = puVar9;
            }
          }
        }
      }
LAB_6b84c95f:
      puVar14 = puVar14 + 1;
    }
    SetLastError(0);
    iVar4 = -1;
  }
  else {
    param_1[0x23] = 0;
    iVar4 = 0;
  }
  return iVar4;
code_r0x6b84c920:
  if (iVar11 < 0) {
    local_1c = iVar12 + -1;
  }
  else {
    local_10 = iVar12 + 1;
  }
  if ((int)local_1c < local_10) goto LAB_6b84c95f;
  goto LAB_6b84c905;
}



int __fastcall FUN_6b84c994(int *param_1,int param_2)

{
  uint *puVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  int in_FS_OFFSET;
  int *local_8;
  
  puVar1 = (uint *)(param_1 + 0xe);
  uVar2 = *puVar1;
  local_8 = (int *)0x0;
  uVar3 = param_1[0x12];
  FUN_6b84d664(param_1,(int)(param_1 + 0x17));
  iVar6 = param_1[0xf];
  if ((uint)param_1[0x1b] < (uint)param_1[0x18]) {
    iVar5 = (int)(iVar6 - *puVar1) >> 1;
    if ((iVar5 == 0) || (*(int *)(*param_1 + 0x104) == 0)) {
      uVar4 = iVar6 - 2;
      goto LAB_6b84ca40;
    }
    local_8 = (int *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                     iVar5 * 4 + 4);
    if (local_8 != (int *)0x0) {
      iVar6 = FUN_6b84cadc(param_1,puVar1,local_8,iVar5 + 1);
      if (iVar6 == 0) goto LAB_6b84ca9e;
      iVar5 = *local_8;
LAB_6b84ca3d:
      uVar4 = local_8[iVar5];
LAB_6b84ca40:
      *puVar1 = uVar4;
      do {
        if (uVar4 < uVar3) {
LAB_6b84ca47:
          SetLastError(0);
          iVar6 = -1;
LAB_6b84ca52:
          if (local_8 == (int *)0x0) {
            return iVar6;
          }
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_8);
          return iVar6;
        }
        param_1[0x12] = uVar4;
        param_1[0x1b] = param_1[0x17];
        iVar6 = FUN_6b81cd80(param_1);
        if (iVar6 == 2) {
          iVar6 = param_1[0x12];
          param_1[0x23] = (int)(iVar6 - uVar2) >> 1;
          if (param_2 != 0) {
            FUN_6b84d664(param_1,(int)puVar1);
            uVar3 = param_1[0x12];
            param_1[0x12] = iVar6;
            if (uVar3 < (uint)param_1[0xf]) goto LAB_6b84ca47;
          }
          iVar6 = (int)(*puVar1 - uVar2) >> 1;
          goto LAB_6b84ca52;
        }
        iVar5 = iVar5 + -1;
        if (iVar5 < 1) goto LAB_6b84ca47;
        if (local_8 != (int *)0x0) goto LAB_6b84ca3d;
        *puVar1 = *puVar1 - 2;
LAB_6b84ca9e:
        uVar4 = *puVar1;
      } while( true );
    }
    SetLastError(8);
    iVar6 = -1;
  }
  else {
    iVar6 = (int)(iVar6 - uVar2) >> 1;
    param_1[0x23] = iVar6;
  }
  return iVar6;
}



undefined4 __fastcall FUN_6b84cadc(int *param_1,uint *param_2,int *param_3,int param_4)

{
  ushort uVar1;
  uint uVar2;
  bool bVar3;
  byte bVar4;
  undefined4 uVar5;
  int iVar6;
  uint uVar7;
  int iVar8;
  ushort *puVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  uint local_24;
  uint local_20;
  int local_1c;
  int local_18;
  int local_8;
  
  uVar2 = param_2[4];
  if ((param_3 == (int *)0x0) || (param_4 == 0)) {
LAB_6b84d5ba:
    uVar5 = 0;
  }
  else {
    iVar11 = *(int *)(*param_1 + 0x104);
    *param_3 = 0;
    if (iVar11 != 0) {
      param_2[4] = *param_2;
      if (*param_2 < param_2[1]) {
        do {
          *param_3 = *param_3 + 1;
          if (param_4 <= *param_3) goto LAB_6b84d5ba;
          param_3[*param_3] = param_2[4];
          puVar9 = (ushort *)param_2[4];
          if (*(int *)(*param_1 + 0x104) != 0) {
            *(ushort *)((int)param_2 + 0x1e) = *puVar9;
            uVar10 = (uint)*puVar9;
            if (param_1[1] != 0) {
              uVar10 = (uVar10 & 0xff) + *(int *)(param_1[1] + (uint)(*puVar9 >> 8) * 4);
            }
            local_8 = 0;
            param_2[6] = *(uint *)(DAT_6b8b0800 + uVar10 * 4);
            bVar4 = (*(char *)((int)param_2 + 0x19) == '\x03') - 1U & *(byte *)((int)param_2 + 0x1b)
                    & 0xc0;
            if (bVar4 != 0x40) {
              if (bVar4 != 0x80) {
                if (bVar4 != 0xc0) goto LAB_6b84d5a0;
                iVar11 = *param_1;
                uVar10 = *(uint *)(iVar11 + 0xfc) & 0x20;
                uVar1 = *(ushort *)(*(int *)(iVar11 + 0x104) + 0x14);
                if (((uVar1 != 0) && (puVar9 + (uVar10 != 0) + 7 <= (ushort *)param_2[1])) &&
                   (local_8 = FUN_6b85026b(puVar9,(ushort *)param_2[1],8,
                                           *(ushort *)(*(int *)(iVar11 + 0x104) + 4),
                                           *(ushort *)(*(int *)(iVar11 + 0x104) + 6),uVar10,
                                           param_2[2]), 7 < local_8)) {
                  iVar6 = 0;
                  local_24 = uVar1 - 1;
                  bVar3 = false;
                  local_18 = 0;
                  if ((uVar10 != 0) && (8 < local_8)) {
                    iVar6 = param_1[1];
                    uVar1 = *puVar9;
                    if (iVar6 == 0) {
                      local_20 = *(uint *)(DAT_6b8b0800 + (uint)uVar1 * 4);
                    }
                    else {
                      local_20 = *(uint *)(DAT_6b8b0800 +
                                          ((uVar1 & 0xff) + *(int *)(iVar6 + (uint)(uVar1 >> 8) * 4)
                                          ) * 4);
                    }
                    uVar7 = (uint)puVar9[1];
                    if (iVar6 != 0) {
                      uVar7 = (uVar7 & 0xff) + *(int *)(iVar6 + (uint)(puVar9[1] >> 8) * 4);
                    }
                    if (((*(uint *)(DAT_6b8b0800 + uVar7 * 4) ^ local_20) & 0xe7ffffff) == 0) {
                      iVar6 = 1;
                      bVar3 = true;
                    }
                    else {
                      iVar6 = 0;
                    }
                  }
                  if (-1 < (int)local_24) {
                    do {
                      iVar12 = (int)(local_24 + local_18) / 2;
                      iVar8 = FUN_6b85023c((int)(puVar9 + iVar6),
                                           (ushort *)(iVar12 * 0x14 + *(int *)(iVar11 + 0x120)),8);
                      if (iVar8 == 0) {
                        param_2[6] = *(uint *)(iVar12 * 0x14 + 0x10 + *(int *)(iVar11 + 0x120));
                        if (bVar3) goto LAB_6b84d597;
                        puVar9 = puVar9 + 7;
                        goto LAB_6b84d594;
                      }
                      if (iVar8 < 0) {
                        local_24 = iVar12 + -1;
                      }
                      else {
                        local_18 = iVar12 + 1;
                      }
                    } while (local_18 <= (int)local_24);
                  }
                }
                uVar1 = *(ushort *)(*(int *)(iVar11 + 0x104) + 0x12);
                if ((uVar1 != 0) && (puVar9 + (uVar10 != 0) + 6 <= (ushort *)param_2[1])) {
                  if (local_8 == 0) {
                    local_8 = FUN_6b85026b(puVar9,(ushort *)param_2[1],7,
                                           *(ushort *)(*(int *)(iVar11 + 0x104) + 4),
                                           *(ushort *)(*(int *)(iVar11 + 0x104) + 6),uVar10,
                                           param_2[2]);
                  }
                  if (6 < local_8) {
                    iVar6 = 0;
                    local_20 = uVar1 - 1;
                    bVar3 = false;
                    local_18 = 0;
                    if ((uVar10 != 0) && (7 < local_8)) {
                      iVar6 = param_1[1];
                      uVar1 = *puVar9;
                      if (iVar6 == 0) {
                        local_24 = *(uint *)(DAT_6b8b0800 + (uint)uVar1 * 4);
                      }
                      else {
                        local_24 = *(uint *)(DAT_6b8b0800 +
                                            ((uVar1 & 0xff) +
                                            *(int *)(iVar6 + (uint)(uVar1 >> 8) * 4)) * 4);
                      }
                      uVar7 = (uint)puVar9[1];
                      if (iVar6 != 0) {
                        uVar7 = (uVar7 & 0xff) + *(int *)(iVar6 + (uint)(puVar9[1] >> 8) * 4);
                      }
                      if (((*(uint *)(DAT_6b8b0800 + uVar7 * 4) ^ local_24) & 0xe7ffffff) == 0) {
                        iVar6 = 1;
                        bVar3 = true;
                      }
                      else {
                        iVar6 = 0;
                      }
                    }
                    if (-1 < (int)local_20) {
                      do {
                        iVar12 = (int)(local_20 + local_18) / 2;
                        iVar8 = FUN_6b85023c((int)(puVar9 + iVar6),
                                             (ushort *)(iVar12 * 0x14 + *(int *)(iVar11 + 0x11c)),7)
                        ;
                        if (iVar8 == 0) {
                          param_2[6] = *(uint *)(iVar12 * 0x14 + 0x10 + *(int *)(iVar11 + 0x11c));
                          if (bVar3) goto LAB_6b84d597;
                          puVar9 = puVar9 + 6;
                          goto LAB_6b84d594;
                        }
                        if (iVar8 < 0) {
                          local_20 = iVar12 + -1;
                        }
                        else {
                          local_18 = iVar12 + 1;
                        }
                      } while (local_18 <= (int)local_20);
                    }
                  }
                }
                uVar1 = *(ushort *)(*(int *)(iVar11 + 0x104) + 0x10);
                if ((uVar1 != 0) && (puVar9 + (uVar10 != 0) + 5 <= (ushort *)param_2[1])) {
                  if (local_8 == 0) {
                    local_8 = FUN_6b85026b(puVar9,(ushort *)param_2[1],6,
                                           *(ushort *)(*(int *)(iVar11 + 0x104) + 4),
                                           *(ushort *)(*(int *)(iVar11 + 0x104) + 6),uVar10,
                                           param_2[2]);
                  }
                  if (5 < local_8) {
                    iVar6 = 0;
                    local_20 = uVar1 - 1;
                    bVar3 = false;
                    local_18 = 0;
                    if ((uVar10 != 0) && (6 < local_8)) {
                      iVar6 = param_1[1];
                      uVar1 = *puVar9;
                      if (iVar6 == 0) {
                        local_24 = *(uint *)(DAT_6b8b0800 + (uint)uVar1 * 4);
                      }
                      else {
                        local_24 = *(uint *)(DAT_6b8b0800 +
                                            ((uVar1 & 0xff) +
                                            *(int *)(iVar6 + (uint)(uVar1 >> 8) * 4)) * 4);
                      }
                      uVar10 = (uint)puVar9[1];
                      if (iVar6 != 0) {
                        uVar10 = (uVar10 & 0xff) + *(int *)(iVar6 + (uint)(puVar9[1] >> 8) * 4);
                      }
                      if (((*(uint *)(DAT_6b8b0800 + uVar10 * 4) ^ local_24) & 0xe7ffffff) == 0) {
                        iVar6 = 1;
                        bVar3 = true;
                      }
                      else {
                        iVar6 = 0;
                      }
                    }
                    if (-1 < (int)local_20) {
                      do {
                        iVar12 = (int)(local_20 + local_18) / 2;
                        iVar8 = FUN_6b85023c((int)(puVar9 + iVar6),
                                             (ushort *)(iVar12 * 0x10 + *(int *)(iVar11 + 0x118)),6)
                        ;
                        if (iVar8 == 0) {
                          param_2[6] = *(uint *)(*(int *)(iVar11 + 0x118) + 0xc + iVar12 * 0x10);
                          if (bVar3) goto LAB_6b84d597;
                          puVar9 = puVar9 + 5;
                          goto LAB_6b84d594;
                        }
                        if (iVar8 < 0) {
                          local_20 = iVar12 + -1;
                        }
                        else {
                          local_18 = iVar12 + 1;
                        }
                      } while (local_18 <= (int)local_20);
                    }
                  }
                }
              }
              iVar11 = *param_1;
              iVar6 = *(int *)(iVar11 + 0x114);
              uVar10 = *(uint *)(iVar11 + 0xfc) & 0x20;
              uVar1 = *(ushort *)(*(int *)(iVar11 + 0x104) + 0xe);
              if ((uVar1 != 0) && (puVar9 + (uVar10 != 0) + 4 <= (ushort *)param_2[1])) {
                if (local_8 == 0) {
                  local_8 = FUN_6b85026b(puVar9,(ushort *)param_2[1],5,
                                         *(ushort *)(*(int *)(*param_1 + 0x104) + 4),
                                         *(ushort *)(*(int *)(*param_1 + 0x104) + 6),uVar10,
                                         param_2[2]);
                }
                if (4 < local_8) {
                  iVar11 = 0;
                  local_1c = 0;
                  local_18 = uVar1 - 1;
                  bVar3 = false;
                  if ((uVar10 != 0) && (5 < local_8)) {
                    iVar11 = param_1[1];
                    uVar1 = *puVar9;
                    if (iVar11 == 0) {
                      local_24 = *(uint *)(DAT_6b8b0800 + (uint)uVar1 * 4);
                    }
                    else {
                      local_24 = *(uint *)(DAT_6b8b0800 +
                                          ((uVar1 & 0xff) +
                                          *(int *)(iVar11 + (uint)(uVar1 >> 8) * 4)) * 4);
                    }
                    uVar7 = (uint)puVar9[1];
                    if (iVar11 != 0) {
                      uVar7 = (uVar7 & 0xff) + *(int *)(iVar11 + (uint)(puVar9[1] >> 8) * 4);
                    }
                    if (((*(uint *)(DAT_6b8b0800 + uVar7 * 4) ^ local_24) & 0xe7ffffff) == 0) {
                      iVar11 = 1;
                      bVar3 = true;
                    }
                    else {
                      iVar11 = 0;
                    }
                  }
                  if (-1 < local_18) {
                    do {
                      iVar12 = (local_18 + local_1c) / 2;
                      iVar8 = FUN_6b85023c((int)(puVar9 + iVar11),(ushort *)(iVar12 * 0x10 + iVar6),
                                           5);
                      if (iVar8 == 0) {
                        param_2[6] = *(uint *)(iVar6 + 0xc + iVar12 * 0x10);
                        if (bVar3) goto LAB_6b84d597;
                        puVar9 = puVar9 + 4;
                        goto LAB_6b84d594;
                      }
                      if (iVar8 < 0) {
                        local_18 = iVar12 + -1;
                      }
                      else {
                        local_1c = iVar12 + 1;
                      }
                    } while (local_1c <= local_18);
                  }
                }
              }
              iVar11 = *(int *)(*param_1 + 0x110);
              uVar1 = *(ushort *)(*(int *)(*param_1 + 0x104) + 0xc);
              if ((uVar1 != 0) && (puVar9 + (uVar10 != 0) + 3 <= (ushort *)param_2[1])) {
                if (local_8 == 0) {
                  local_8 = FUN_6b85026b(puVar9,(ushort *)param_2[1],4,
                                         *(ushort *)(*(int *)(*param_1 + 0x104) + 4),
                                         *(ushort *)(*(int *)(*param_1 + 0x104) + 6),uVar10,
                                         param_2[2]);
                }
                if (3 < local_8) {
                  iVar6 = 0;
                  bVar3 = false;
                  local_20 = uVar1 - 1;
                  local_18 = 0;
                  if ((uVar10 != 0) && (4 < local_8)) {
                    iVar6 = param_1[1];
                    uVar1 = *puVar9;
                    if (iVar6 == 0) {
                      local_24 = *(uint *)(DAT_6b8b0800 + (uint)uVar1 * 4);
                    }
                    else {
                      local_24 = *(uint *)(DAT_6b8b0800 +
                                          ((uVar1 & 0xff) + *(int *)(iVar6 + (uint)(uVar1 >> 8) * 4)
                                          ) * 4);
                    }
                    uVar10 = (uint)puVar9[1];
                    if (iVar6 != 0) {
                      uVar10 = (uVar10 & 0xff) + *(int *)(iVar6 + (uint)(puVar9[1] >> 8) * 4);
                    }
                    if (((*(uint *)(DAT_6b8b0800 + uVar10 * 4) ^ local_24) & 0xe7ffffff) == 0) {
                      iVar6 = 1;
                      bVar3 = true;
                    }
                    else {
                      iVar6 = 0;
                    }
                  }
                  if (-1 < (int)local_20) {
                    do {
                      iVar12 = (int)(local_20 + local_18) / 2;
                      iVar8 = FUN_6b85023c((int)(puVar9 + iVar6),(ushort *)(iVar12 * 0xc + iVar11),4
                                          );
                      if (iVar8 == 0) {
                        param_2[6] = *(uint *)(iVar12 * 0xc + 8 + iVar11);
                        if (bVar3) goto LAB_6b84d597;
                        puVar9 = puVar9 + 3;
                        goto LAB_6b84d594;
                      }
                      if (iVar8 < 0) {
                        local_20 = iVar12 + -1;
                      }
                      else {
                        local_18 = iVar12 + 1;
                      }
                    } while (local_18 <= (int)local_20);
                  }
                }
              }
            }
            iVar11 = *param_1;
            iVar6 = *(int *)(iVar11 + 0x10c);
            uVar10 = *(uint *)(iVar11 + 0xfc) & 0x20;
            uVar1 = *(ushort *)(*(int *)(iVar11 + 0x104) + 10);
            if ((uVar1 != 0) && (puVar9 + (uVar10 != 0) + 2 <= (ushort *)param_2[1])) {
              if (local_8 == 0) {
                local_8 = FUN_6b85026b(puVar9,(ushort *)param_2[1],3,
                                       *(ushort *)(*(int *)(*param_1 + 0x104) + 4),
                                       *(ushort *)(*(int *)(*param_1 + 0x104) + 6),uVar10,param_2[2]
                                      );
              }
              if (2 < local_8) {
                iVar11 = 0;
                local_1c = 0;
                local_18 = uVar1 - 1;
                bVar3 = false;
                if ((uVar10 != 0) && (3 < local_8)) {
                  iVar11 = param_1[1];
                  uVar1 = *puVar9;
                  if (iVar11 == 0) {
                    local_24 = *(uint *)(DAT_6b8b0800 + (uint)uVar1 * 4);
                  }
                  else {
                    local_24 = *(uint *)(DAT_6b8b0800 +
                                        ((uVar1 & 0xff) + *(int *)(iVar11 + (uint)(uVar1 >> 8) * 4))
                                        * 4);
                  }
                  uVar7 = (uint)puVar9[1];
                  if (iVar11 != 0) {
                    uVar7 = (uVar7 & 0xff) + *(int *)(iVar11 + (uint)(puVar9[1] >> 8) * 4);
                  }
                  if (((*(uint *)(DAT_6b8b0800 + uVar7 * 4) ^ local_24) & 0xe7ffffff) == 0) {
                    iVar11 = 1;
                    bVar3 = true;
                  }
                  else {
                    iVar11 = 0;
                  }
                }
                if (-1 < local_18) {
                  do {
                    iVar12 = (local_18 + local_1c) / 2;
                    iVar8 = FUN_6b85023c((int)(puVar9 + iVar11),(ushort *)(iVar12 * 0xc + iVar6),3);
                    if (iVar8 == 0) {
                      param_2[6] = *(uint *)(iVar12 * 0xc + 8 + iVar6);
                      if (bVar3) goto LAB_6b84d597;
                      puVar9 = puVar9 + 2;
                      goto LAB_6b84d594;
                    }
                    if (iVar8 < 0) {
                      local_18 = iVar12 + -1;
                    }
                    else {
                      local_1c = iVar12 + 1;
                    }
                  } while (local_1c <= local_18);
                }
              }
            }
            iVar11 = *(int *)(*param_1 + 0x108);
            uVar1 = *(ushort *)(*(int *)(*param_1 + 0x104) + 8);
            if ((uVar1 != 0) && (puVar9 + (uVar10 != 0) + 1 <= (ushort *)param_2[1])) {
              if (local_8 == 0) {
                local_8 = FUN_6b85026b(puVar9,(ushort *)param_2[1],2,
                                       *(ushort *)(*(int *)(*param_1 + 0x104) + 4),
                                       *(ushort *)(*(int *)(*param_1 + 0x104) + 6),uVar10,param_2[2]
                                      );
              }
              if (1 < local_8) {
                iVar6 = 0;
                bVar3 = false;
                local_20 = uVar1 - 1;
                local_18 = 0;
                if ((uVar10 != 0) && (2 < local_8)) {
                  iVar6 = param_1[1];
                  uVar1 = *puVar9;
                  if (iVar6 == 0) {
                    local_24 = *(uint *)(DAT_6b8b0800 + (uint)uVar1 * 4);
                  }
                  else {
                    local_24 = *(uint *)(DAT_6b8b0800 +
                                        ((uVar1 & 0xff) + *(int *)(iVar6 + (uint)(uVar1 >> 8) * 4))
                                        * 4);
                  }
                  uVar10 = (uint)puVar9[1];
                  if (iVar6 != 0) {
                    uVar10 = (uVar10 & 0xff) + *(int *)(iVar6 + (uint)(puVar9[1] >> 8) * 4);
                  }
                  if (((*(uint *)(DAT_6b8b0800 + uVar10 * 4) ^ local_24) & 0xe7ffffff) == 0) {
                    iVar6 = 1;
                    bVar3 = true;
                  }
                  else {
                    iVar6 = 0;
                  }
                }
                if (-1 < (int)local_20) {
LAB_6b84d549:
                  iVar12 = (int)(local_20 + local_18) / 2;
                  iVar8 = FUN_6b85023c((int)(puVar9 + iVar6),(ushort *)(iVar11 + iVar12 * 8),2);
                  if (iVar8 != 0) goto code_r0x6b84d564;
                  param_2[6] = *(uint *)(iVar11 + 4 + iVar12 * 8);
                  if (!bVar3) {
                    puVar9 = puVar9 + 1;
LAB_6b84d594:
                    param_2[4] = (uint)puVar9;
                  }
LAB_6b84d597:
                  puVar9 = (ushort *)param_2[4];
                }
              }
            }
          }
LAB_6b84d5a0:
          param_2[4] = (uint)(puVar9 + 1);
        } while (puVar9 + 1 < (ushort *)param_2[1]);
      }
      param_2[4] = uVar2;
    }
    uVar5 = 1;
  }
  return uVar5;
code_r0x6b84d564:
  if (iVar8 < 0) {
    local_20 = iVar12 + -1;
  }
  else {
    local_18 = iVar12 + 1;
  }
  if ((int)local_20 < local_18) goto LAB_6b84d5a0;
  goto LAB_6b84d549;
}



void __fastcall FUN_6b84d5c3(int param_1,int param_2)

{
  ushort *puVar1;
  undefined4 uVar2;
  int iVar3;
  ushort uVar4;
  uint uVar5;
  byte local_8;
  undefined local_7;
  undefined local_6;
  
  puVar1 = (ushort *)(param_2 + 0x1c);
  *(undefined4 *)(param_2 + 0x20) = 0;
  iVar3 = FUN_6b85037c(param_1,*(ushort **)(param_2 + 0x10),*(ushort **)(param_2 + 4),puVar1,
                       &local_8);
  if (iVar3 < 1) {
    uVar5 = (uint)*(ushort *)(param_2 + 0x1e);
    if (param_1 != 0) {
      uVar5 = (uVar5 & 0xff) + *(int *)(param_1 + (uint)(*(ushort *)(param_2 + 0x1e) >> 8) * 4);
    }
    uVar2 = *(undefined4 *)(DAT_6b8b0800 + uVar5 * 4);
    *(undefined4 *)(param_2 + 0x18) = uVar2;
    uVar4 = (short)uVar2 << 8 | (ushort)*(byte *)(param_2 + 0x1a);
    *(undefined *)(param_2 + 0x1a) = 2;
    *(byte *)(param_2 + 0x1b) = *(byte *)(param_2 + 0x1b) & 0x3f;
    *puVar1 = uVar4;
    *(ushort *)(param_2 + 0x18) = uVar4;
  }
  else {
    *(uint *)(param_2 + 0x18) = *puVar1 | 0x2020000;
    *(uint *)(param_2 + 0x20) = (uint)CONCAT21(CONCAT11(local_8,local_7),local_6);
    *(int *)(param_2 + 0x10) = *(int *)(param_2 + 0x10) + iVar3 * 2 + -2;
  }
  return;
}



void __fastcall FUN_6b84d664(int *param_1,int param_2)

{
  bool bVar1;
  char cVar2;
  byte bVar3;
  ushort uVar4;
  int iVar5;
  uint uVar6;
  uint uVar7;
  int iVar8;
  int iVar9;
  ushort *puVar10;
  ushort *puVar11;
  int iVar12;
  uint uVar13;
  int iVar14;
  uint local_28;
  uint local_24;
  int local_20;
  int local_1c;
  int local_c;
  
  puVar10 = *(ushort **)(param_2 + 0x10);
  puVar11 = *(ushort **)(param_2 + 4);
  if (puVar10 < puVar11) {
    do {
      uVar4 = *puVar10;
      uVar13 = (uint)uVar4;
      if (param_1[1] != 0) {
        uVar13 = (uVar13 & 0xff) + *(int *)(param_1[1] + (uint)(uVar4 >> 8) * 4);
      }
      cVar2 = (char)((uint)*(undefined4 *)(DAT_6b8b0800 + uVar13 * 4) >> 8);
      if (cVar2 == '\0') {
        if ((param_1[10] != 0) && (uVar4 == 0)) {
          return;
        }
        if (uVar4 == 0xdb40) {
          iVar12 = *(int *)(param_2 + 0x14);
          if (iVar12 < 1) {
            if (puVar10 + 1 < puVar11) {
              uVar4 = puVar10[1];
            }
            else {
              uVar4 = 0;
            }
          }
          else {
            uVar4 = *(ushort *)(param_2 + 10 + iVar12 * 2);
          }
          if ((ushort)(uVar4 + 0x2300) < 0xf0) {
            if (iVar12 < 1) {
              puVar10 = puVar10 + 1;
              *(ushort **)(param_2 + 0x10) = puVar10;
              if (puVar10 < puVar11) {
                uVar4 = *puVar10;
              }
              else {
                uVar4 = 0;
              }
              *(ushort *)(param_2 + 0x1e) = uVar4;
            }
            else {
              *(int *)(param_2 + 0x14) = iVar12 + -1;
              *(undefined2 *)(param_2 + 0x1e) = *(undefined2 *)(param_2 + 0xc + (iVar12 + -1) * 2);
            }
          }
        }
      }
      else if (cVar2 == '\x01') {
        if ((param_1[4] == 0) && (param_1[7] == 0)) {
          return;
        }
        if (*(int *)(*param_1 + 0x104) != 0) {
          *(ushort *)(param_2 + 0x1e) = uVar4;
          uVar13 = (uint)*puVar10;
          if (param_1[1] != 0) {
            uVar13 = (uVar13 & 0xff) + *(int *)(param_1[1] + (uint)(*puVar10 >> 8) * 4);
          }
          local_c = 0;
          *(undefined4 *)(param_2 + 0x18) = *(undefined4 *)(DAT_6b8b0800 + uVar13 * 4);
          bVar3 = (*(char *)(param_2 + 0x19) == '\x03') - 1U & *(byte *)(param_2 + 0x1b) & 0xc0;
          if (bVar3 != 0x40) {
            if (bVar3 != 0x80) {
              if (bVar3 != 0xc0) goto LAB_6b84e115;
              iVar12 = *param_1;
              uVar13 = *(uint *)(iVar12 + 0xfc) & 0x20;
              uVar4 = *(ushort *)(*(int *)(iVar12 + 0x104) + 0x14);
              if (((uVar4 != 0) && (puVar10 + (uVar13 != 0) + 7 <= *(ushort **)(param_2 + 4))) &&
                 (local_c = FUN_6b85026b(puVar10,*(ushort **)(param_2 + 4),8,
                                         *(ushort *)(*(int *)(iVar12 + 0x104) + 4),
                                         *(ushort *)(*(int *)(iVar12 + 0x104) + 6),uVar13,
                                         *(int *)(param_2 + 8)), 7 < local_c)) {
                iVar5 = 0;
                iVar9 = uVar4 - 1;
                bVar1 = false;
                local_1c = 0;
                if ((uVar13 != 0) && (8 < local_c)) {
                  iVar5 = param_1[1];
                  uVar6 = (uint)*puVar10;
                  if (iVar5 != 0) {
                    uVar6 = (uVar6 & 0xff) + *(int *)(iVar5 + (uint)(*puVar10 >> 8) * 4);
                  }
                  uVar7 = (uint)puVar10[1];
                  if (iVar5 != 0) {
                    uVar7 = (uVar7 & 0xff) + *(int *)(iVar5 + (uint)(puVar10[1] >> 8) * 4);
                  }
                  if (((*(uint *)(DAT_6b8b0800 + uVar7 * 4) ^ *(uint *)(DAT_6b8b0800 + uVar6 * 4)) &
                      0xe7ffffff) == 0) {
                    iVar5 = 1;
                    bVar1 = true;
                  }
                  else {
                    iVar5 = 0;
                  }
                }
                if (-1 < iVar9) {
                  do {
                    iVar14 = (iVar9 + local_1c) / 2;
                    iVar8 = FUN_6b85023c((int)(puVar10 + iVar5),
                                         (ushort *)(iVar14 * 0x14 + *(int *)(iVar12 + 0x120)),8);
                    if (iVar8 == 0) {
                      *(undefined4 *)(param_2 + 0x18) =
                           *(undefined4 *)(iVar14 * 0x14 + 0x10 + *(int *)(iVar12 + 0x120));
                      if (!bVar1) {
                        *(int *)(param_2 + 0x10) = *(int *)(param_2 + 0x10) + 0xe;
                      }
                      goto LAB_6b84e145;
                    }
                    if (iVar8 < 0) {
                      iVar9 = iVar14 + -1;
                    }
                    else {
                      local_1c = iVar14 + 1;
                    }
                  } while (local_1c <= iVar9);
                }
              }
              uVar4 = *(ushort *)(*(int *)(iVar12 + 0x104) + 0x12);
              if (uVar4 != 0) {
                puVar11 = *(ushort **)(param_2 + 0x10);
                if (puVar11 + (uVar13 != 0) + 6 <= *(ushort **)(param_2 + 4)) {
                  if (local_c == 0) {
                    local_c = FUN_6b85026b(puVar11,*(ushort **)(param_2 + 4),7,
                                           *(ushort *)(*(int *)(iVar12 + 0x104) + 4),
                                           *(ushort *)(*(int *)(iVar12 + 0x104) + 6),uVar13,
                                           *(int *)(param_2 + 8));
                  }
                  if (6 < local_c) {
                    iVar9 = 0;
                    local_20 = 0;
                    local_28 = uVar4 - 1;
                    bVar1 = false;
                    if ((uVar13 != 0) && (7 < local_c)) {
                      iVar9 = param_1[1];
                      uVar4 = *puVar11;
                      if (iVar9 == 0) {
                        local_24 = *(uint *)(DAT_6b8b0800 + (uint)uVar4 * 4);
                      }
                      else {
                        local_24 = *(uint *)(DAT_6b8b0800 +
                                            ((uVar4 & 0xff) +
                                            *(int *)(iVar9 + (uint)(uVar4 >> 8) * 4)) * 4);
                      }
                      uVar6 = (uint)puVar11[1];
                      if (iVar9 != 0) {
                        uVar6 = (uVar6 & 0xff) + *(int *)(iVar9 + (uint)(puVar11[1] >> 8) * 4);
                      }
                      if (((*(uint *)(DAT_6b8b0800 + uVar6 * 4) ^ local_24) & 0xe7ffffff) == 0) {
                        iVar9 = 1;
                        bVar1 = true;
                      }
                      else {
                        iVar9 = 0;
                      }
                    }
                    if (-1 < (int)local_28) {
                      do {
                        iVar8 = (int)(local_20 + local_28) / 2;
                        iVar5 = FUN_6b85023c((int)(puVar11 + iVar9),
                                             (ushort *)(iVar8 * 0x14 + *(int *)(iVar12 + 0x11c)),7);
                        if (iVar5 == 0) {
                          *(undefined4 *)(param_2 + 0x18) =
                               *(undefined4 *)(iVar8 * 0x14 + 0x10 + *(int *)(iVar12 + 0x11c));
                          if (!bVar1) {
                            *(int *)(param_2 + 0x10) = *(int *)(param_2 + 0x10) + 0xc;
                          }
                          goto LAB_6b84e145;
                        }
                        if (iVar5 < 0) {
                          local_28 = iVar8 + -1;
                        }
                        else {
                          local_20 = iVar8 + 1;
                        }
                      } while (local_20 <= (int)local_28);
                    }
                  }
                }
              }
              uVar4 = *(ushort *)(*(int *)(iVar12 + 0x104) + 0x10);
              if (uVar4 != 0) {
                puVar11 = *(ushort **)(param_2 + 0x10);
                if (puVar11 + (uVar13 != 0) + 5 <= *(ushort **)(param_2 + 4)) {
                  if (local_c == 0) {
                    local_c = FUN_6b85026b(puVar11,*(ushort **)(param_2 + 4),6,
                                           *(ushort *)(*(int *)(iVar12 + 0x104) + 4),
                                           *(ushort *)(*(int *)(iVar12 + 0x104) + 6),uVar13,
                                           *(int *)(param_2 + 8));
                  }
                  if (5 < local_c) {
                    iVar5 = 0;
                    iVar9 = uVar4 - 1;
                    bVar1 = false;
                    local_1c = 0;
                    if ((uVar13 != 0) && (6 < local_c)) {
                      iVar5 = param_1[1];
                      uVar4 = *puVar11;
                      if (iVar5 == 0) {
                        local_28 = *(uint *)(DAT_6b8b0800 + (uint)uVar4 * 4);
                      }
                      else {
                        local_28 = *(uint *)(DAT_6b8b0800 +
                                            ((uVar4 & 0xff) +
                                            *(int *)(iVar5 + (uint)(uVar4 >> 8) * 4)) * 4);
                      }
                      uVar13 = (uint)puVar11[1];
                      if (iVar5 != 0) {
                        uVar13 = (uVar13 & 0xff) + *(int *)(iVar5 + (uint)(puVar11[1] >> 8) * 4);
                      }
                      if (((*(uint *)(DAT_6b8b0800 + uVar13 * 4) ^ local_28) & 0xe7ffffff) == 0) {
                        iVar5 = 1;
                        bVar1 = true;
                      }
                      else {
                        iVar5 = 0;
                      }
                    }
                    if (-1 < iVar9) {
                      do {
                        iVar14 = (iVar9 + local_1c) / 2;
                        iVar8 = FUN_6b85023c((int)(puVar11 + iVar5),
                                             (ushort *)(iVar14 * 0x10 + *(int *)(iVar12 + 0x118)),6)
                        ;
                        if (iVar8 == 0) {
                          *(undefined4 *)(param_2 + 0x18) =
                               *(undefined4 *)(*(int *)(iVar12 + 0x118) + 0xc + iVar14 * 0x10);
                          if (!bVar1) {
                            *(int *)(param_2 + 0x10) = *(int *)(param_2 + 0x10) + 10;
                          }
                          goto LAB_6b84e145;
                        }
                        if (iVar8 < 0) {
                          iVar9 = iVar14 + -1;
                        }
                        else {
                          local_1c = iVar14 + 1;
                        }
                      } while (local_1c <= iVar9);
                    }
                  }
                }
              }
            }
            iVar12 = *param_1;
            iVar9 = *(int *)(iVar12 + 0x114);
            uVar13 = *(uint *)(iVar12 + 0xfc) & 0x20;
            uVar4 = *(ushort *)(*(int *)(iVar12 + 0x104) + 0xe);
            if (uVar4 != 0) {
              puVar11 = *(ushort **)(param_2 + 0x10);
              if (puVar11 + (uVar13 != 0) + 4 <= *(ushort **)(param_2 + 4)) {
                if (local_c == 0) {
                  local_c = FUN_6b85026b(puVar11,*(ushort **)(param_2 + 4),5,
                                         *(ushort *)(*(int *)(*param_1 + 0x104) + 4),
                                         *(ushort *)(*(int *)(*param_1 + 0x104) + 6),uVar13,
                                         *(int *)(param_2 + 8));
                }
                if (4 < local_c) {
                  iVar12 = 0;
                  local_20 = 0;
                  local_1c = uVar4 - 1;
                  bVar1 = false;
                  if ((uVar13 != 0) && (5 < local_c)) {
                    iVar12 = param_1[1];
                    uVar4 = *puVar11;
                    if (iVar12 == 0) {
                      local_28 = *(uint *)(DAT_6b8b0800 + (uint)uVar4 * 4);
                    }
                    else {
                      local_28 = *(uint *)(DAT_6b8b0800 +
                                          ((uVar4 & 0xff) +
                                          *(int *)(iVar12 + (uint)(uVar4 >> 8) * 4)) * 4);
                    }
                    uVar6 = (uint)puVar11[1];
                    if (iVar12 != 0) {
                      uVar6 = (uVar6 & 0xff) + *(int *)(iVar12 + (uint)(puVar11[1] >> 8) * 4);
                    }
                    if (((*(uint *)(DAT_6b8b0800 + uVar6 * 4) ^ local_28) & 0xe7ffffff) == 0) {
                      iVar12 = 1;
                      bVar1 = true;
                    }
                    else {
                      iVar12 = 0;
                    }
                  }
                  if (-1 < local_1c) {
                    do {
                      iVar8 = (local_1c + local_20) / 2;
                      iVar5 = FUN_6b85023c((int)(puVar11 + iVar12),(ushort *)(iVar8 * 0x10 + iVar9),
                                           5);
                      if (iVar5 == 0) {
                        *(undefined4 *)(param_2 + 0x18) =
                             *(undefined4 *)(iVar9 + 0xc + iVar8 * 0x10);
                        if (!bVar1) {
                          *(int *)(param_2 + 0x10) = *(int *)(param_2 + 0x10) + 8;
                        }
                        goto LAB_6b84e145;
                      }
                      if (iVar5 < 0) {
                        local_1c = iVar8 + -1;
                      }
                      else {
                        local_20 = iVar8 + 1;
                      }
                    } while (local_20 <= local_1c);
                  }
                }
              }
            }
            iVar12 = *(int *)(*param_1 + 0x110);
            uVar4 = *(ushort *)(*(int *)(*param_1 + 0x104) + 0xc);
            if (uVar4 != 0) {
              puVar11 = *(ushort **)(param_2 + 0x10);
              if (puVar11 + (uVar13 != 0) + 3 <= *(ushort **)(param_2 + 4)) {
                if (local_c == 0) {
                  local_c = FUN_6b85026b(puVar11,*(ushort **)(param_2 + 4),4,
                                         *(ushort *)(*(int *)(*param_1 + 0x104) + 4),
                                         *(ushort *)(*(int *)(*param_1 + 0x104) + 6),uVar13,
                                         *(int *)(param_2 + 8));
                }
                if (3 < local_c) {
                  iVar5 = 0;
                  bVar1 = false;
                  iVar9 = uVar4 - 1;
                  local_1c = 0;
                  if ((uVar13 != 0) && (4 < local_c)) {
                    iVar5 = param_1[1];
                    uVar4 = *puVar11;
                    if (iVar5 == 0) {
                      local_28 = *(uint *)(DAT_6b8b0800 + (uint)uVar4 * 4);
                    }
                    else {
                      local_28 = *(uint *)(DAT_6b8b0800 +
                                          ((uVar4 & 0xff) + *(int *)(iVar5 + (uint)(uVar4 >> 8) * 4)
                                          ) * 4);
                    }
                    uVar13 = (uint)puVar11[1];
                    if (iVar5 != 0) {
                      uVar13 = (uVar13 & 0xff) + *(int *)(iVar5 + (uint)(puVar11[1] >> 8) * 4);
                    }
                    if (((*(uint *)(DAT_6b8b0800 + uVar13 * 4) ^ local_28) & 0xe7ffffff) == 0) {
                      iVar5 = 1;
                      bVar1 = true;
                    }
                    else {
                      iVar5 = 0;
                    }
                  }
                  if (-1 < iVar9) {
                    do {
                      iVar14 = (iVar9 + local_1c) / 2;
                      iVar8 = FUN_6b85023c((int)(puVar11 + iVar5),(ushort *)(iVar14 * 0xc + iVar12),
                                           4);
                      if (iVar8 == 0) {
                        *(undefined4 *)(param_2 + 0x18) = *(undefined4 *)(iVar14 * 0xc + 8 + iVar12)
                        ;
                        if (!bVar1) {
                          *(int *)(param_2 + 0x10) = *(int *)(param_2 + 0x10) + 6;
                        }
                        goto LAB_6b84e145;
                      }
                      if (iVar8 < 0) {
                        iVar9 = iVar14 + -1;
                      }
                      else {
                        local_1c = iVar14 + 1;
                      }
                    } while (local_1c <= iVar9);
                  }
                }
              }
            }
          }
          iVar12 = *param_1;
          iVar9 = *(int *)(iVar12 + 0x10c);
          uVar13 = *(uint *)(iVar12 + 0xfc) & 0x20;
          uVar4 = *(ushort *)(*(int *)(iVar12 + 0x104) + 10);
          if (uVar4 != 0) {
            puVar11 = *(ushort **)(param_2 + 0x10);
            if (puVar11 + (uVar13 != 0) + 2 <= *(ushort **)(param_2 + 4)) {
              if (local_c == 0) {
                local_c = FUN_6b85026b(puVar11,*(ushort **)(param_2 + 4),3,
                                       *(ushort *)(*(int *)(*param_1 + 0x104) + 4),
                                       *(ushort *)(*(int *)(*param_1 + 0x104) + 6),uVar13,
                                       *(int *)(param_2 + 8));
              }
              if (2 < local_c) {
                iVar12 = 0;
                local_20 = 0;
                local_1c = uVar4 - 1;
                bVar1 = false;
                if ((uVar13 != 0) && (3 < local_c)) {
                  iVar12 = param_1[1];
                  uVar4 = *puVar11;
                  if (iVar12 == 0) {
                    local_28 = *(uint *)(DAT_6b8b0800 + (uint)uVar4 * 4);
                  }
                  else {
                    local_28 = *(uint *)(DAT_6b8b0800 +
                                        ((uVar4 & 0xff) + *(int *)(iVar12 + (uint)(uVar4 >> 8) * 4))
                                        * 4);
                  }
                  uVar6 = (uint)puVar11[1];
                  if (iVar12 != 0) {
                    uVar6 = (uVar6 & 0xff) + *(int *)(iVar12 + (uint)(puVar11[1] >> 8) * 4);
                  }
                  if (((*(uint *)(DAT_6b8b0800 + uVar6 * 4) ^ local_28) & 0xe7ffffff) == 0) {
                    iVar12 = 1;
                    bVar1 = true;
                  }
                  else {
                    iVar12 = 0;
                  }
                }
                if (-1 < local_1c) {
                  do {
                    iVar8 = (local_1c + local_20) / 2;
                    iVar5 = FUN_6b85023c((int)(puVar11 + iVar12),(ushort *)(iVar8 * 0xc + iVar9),3);
                    if (iVar5 == 0) {
                      *(undefined4 *)(param_2 + 0x18) = *(undefined4 *)(iVar8 * 0xc + 8 + iVar9);
                      if (!bVar1) {
                        *(int *)(param_2 + 0x10) = *(int *)(param_2 + 0x10) + 4;
                      }
                      goto LAB_6b84e145;
                    }
                    if (iVar5 < 0) {
                      local_1c = iVar8 + -1;
                    }
                    else {
                      local_20 = iVar8 + 1;
                    }
                  } while (local_20 <= local_1c);
                }
              }
            }
          }
          iVar12 = *(int *)(*param_1 + 0x108);
          uVar4 = *(ushort *)(*(int *)(*param_1 + 0x104) + 8);
          if (uVar4 != 0) {
            puVar11 = *(ushort **)(param_2 + 0x10);
            if (puVar11 + (uVar13 != 0) + 1 <= *(ushort **)(param_2 + 4)) {
              if (local_c == 0) {
                local_c = FUN_6b85026b(puVar11,*(ushort **)(param_2 + 4),2,
                                       *(ushort *)(*(int *)(*param_1 + 0x104) + 4),
                                       *(ushort *)(*(int *)(*param_1 + 0x104) + 6),uVar13,
                                       *(int *)(param_2 + 8));
              }
              if (1 < local_c) {
                iVar5 = 0;
                bVar1 = false;
                iVar9 = uVar4 - 1;
                local_1c = 0;
                if ((uVar13 != 0) && (2 < local_c)) {
                  iVar5 = param_1[1];
                  uVar4 = *puVar11;
                  if (iVar5 == 0) {
                    local_28 = *(uint *)(DAT_6b8b0800 + (uint)uVar4 * 4);
                  }
                  else {
                    local_28 = *(uint *)(DAT_6b8b0800 +
                                        ((uVar4 & 0xff) + *(int *)(iVar5 + (uint)(uVar4 >> 8) * 4))
                                        * 4);
                  }
                  uVar13 = (uint)puVar11[1];
                  if (iVar5 != 0) {
                    uVar13 = (uVar13 & 0xff) + *(int *)(iVar5 + (uint)(puVar11[1] >> 8) * 4);
                  }
                  if (((*(uint *)(DAT_6b8b0800 + uVar13 * 4) ^ local_28) & 0xe7ffffff) == 0) {
                    iVar5 = 1;
                    bVar1 = true;
                  }
                  else {
                    iVar5 = 0;
                  }
                }
                if (-1 < iVar9) {
LAB_6b84e0e0:
                  iVar14 = (iVar9 + local_1c) / 2;
                  iVar8 = FUN_6b85023c((int)(puVar11 + iVar5),(ushort *)(iVar12 + iVar14 * 8),2);
                  if (iVar8 != 0) goto code_r0x6b84e0fb;
                  *(undefined4 *)(param_2 + 0x18) = *(undefined4 *)(iVar12 + 4 + iVar14 * 8);
                  if (!bVar1) {
                    *(int *)(param_2 + 0x10) = *(int *)(param_2 + 0x10) + 2;
                  }
LAB_6b84e145:
                  puVar11 = *(ushort **)(param_2 + 0x10);
                  *(ushort **)(param_2 + 0x10) = puVar10;
                  if (puVar10 != puVar11) {
                    return;
                  }
                }
              }
            }
          }
        }
      }
      else {
        if (cVar2 == '\x06') {
          iVar12 = param_1[3];
        }
        else {
          if (5 < (byte)(cVar2 - 7U)) {
            return;
          }
          iVar12 = param_1[5];
        }
        if (iVar12 == 0) {
          return;
        }
      }
LAB_6b84e115:
      puVar10 = (ushort *)(*(int *)(param_2 + 0x10) + 2);
      *(ushort **)(param_2 + 0x10) = puVar10;
      puVar11 = *(ushort **)(param_2 + 4);
    } while (puVar10 < puVar11);
  }
  return;
code_r0x6b84e0fb:
  if (iVar8 < 0) {
    iVar9 = iVar14 + -1;
  }
  else {
    local_1c = iVar14 + 1;
  }
  if (iVar9 < local_1c) goto LAB_6b84e115;
  goto LAB_6b84e0e0;
}



ushort __fastcall FUN_6b84e1d3(uint param_1)

{
  return *(ushort *)
          ((uint)*(byte *)((param_1 & 0xf) +
                          (uint)*(ushort *)
                                 (DAT_6b8b0818 +
                                 ((uint)(*(ushort *)(DAT_6b8b0818 + ((param_1 & 0xffff) >> 8) * 2)
                                        >> 1) + ((param_1 & 0xff) >> 4)) * 2) + DAT_6b8b0818) * 6 +
          DAT_6b8b0814) & 0x100;
}



ushort __fastcall FUN_6b84e210(ushort param_1)

{
  if ((param_1 != 0x27) && (param_1 != 0x2019)) {
    return *(ushort *)
            ((uint)*(byte *)((param_1 & 0xf) +
                            (uint)*(ushort *)
                                   (DAT_6b8b0818 +
                                   ((uint)(*(ushort *)(DAT_6b8b0818 + (uint)(param_1 >> 8) * 2) >> 1
                                          ) + ((param_1 & 0xff) >> 4)) * 2) + DAT_6b8b0818) * 6 +
            DAT_6b8b0814) & 0x38;
  }
  return 0;
}



uint __fastcall
FUN_6b84e25e(int param_1,uint param_2,int param_3,int param_4,int param_5,int param_6)

{
  byte bVar1;
  bool bVar2;
  ushort uVar3;
  undefined2 extraout_var;
  undefined2 extraout_var_00;
  undefined2 extraout_var_01;
  undefined2 *puVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  uint uVar8;
  uint local_8;
  
  bVar2 = false;
  uVar7 = param_2;
  if (param_4 != 0) {
    if (param_4 < (int)param_2) {
      SetLastError(0x7a);
      uVar7 = 0;
    }
    else {
      local_8 = 0;
      if (0 < (int)param_2) {
        do {
          uVar3 = *(ushort *)(param_1 + local_8 * 2);
          if (uVar3 == 0xd801) {
            FUN_6b84e496((short *)&DAT_6b8888e8,param_1,param_2,(int *)&local_8,param_3);
          }
          else {
            bVar1 = *(byte *)(param_1 + local_8 * 2);
            *(ushort *)(param_3 + local_8 * 2) =
                 *(short *)(param_6 +
                           ((uint)*(ushort *)
                                   (param_6 +
                                   ((uint)*(ushort *)(param_6 + (uint)(uVar3 >> 8) * 2) +
                                   (uint)(bVar1 >> 4)) * 2) + (bVar1 & 0xf)) * 2) + uVar3;
          }
          local_8 = local_8 + 1;
        } while ((int)local_8 < (int)param_2);
      }
      uVar8 = 0;
      uVar7 = 0;
      local_8 = 0;
      if (0 < (int)param_2) {
        do {
          uVar7 = local_8;
          if (bVar2) {
            local_8 = (uint)*(ushort *)(param_1 + local_8 * 2);
            uVar3 = FUN_6b84e1d3(local_8);
            if (CONCAT22(extraout_var_00,uVar3) == 0) {
              uVar3 = FUN_6b84e210((ushort)local_8);
              if ((CONCAT22(extraout_var_01,uVar3) != 0) && (bVar2 = false, -1 < (int)uVar8)) {
                if ((int)uVar8 < (int)uVar7) {
                  puVar4 = (undefined2 *)(param_3 + uVar8 * 2);
                  iVar6 = uVar7 - uVar8;
                  do {
                    *puVar4 = *(undefined2 *)((param_1 - param_3) + (int)puVar4);
                    puVar4 = puVar4 + 1;
                    iVar6 = iVar6 + -1;
                  } while (iVar6 != 0);
                }
                goto LAB_6b84e455;
              }
            }
            else if ((-1 < (int)uVar8) && (*(ushort *)(param_3 + uVar7 * 2) == (ushort)local_8)) {
LAB_6b84e455:
              uVar8 = 0xffffffff;
            }
          }
          else {
            uVar3 = *(ushort *)(param_1 + local_8 * 2);
            if (uVar3 == 0xd801) {
              FUN_6b84e496((short *)&DAT_6b8845f0,param_1,param_2,(int *)&local_8,param_3);
            }
            else {
              bVar1 = *(byte *)(param_1 + local_8 * 2);
              *(ushort *)(param_3 + local_8 * 2) =
                   *(short *)(param_5 +
                             ((uint)*(ushort *)
                                     (param_5 +
                                     ((uint)*(ushort *)(param_5 + (uint)(uVar3 >> 8) * 2) +
                                     (uint)(bVar1 >> 4)) * 2) + (bVar1 & 0xf)) * 2) + uVar3;
            }
            uVar7 = local_8;
            uVar3 = *(ushort *)(param_3 + local_8 * 2);
            uVar5 = (uint)uVar3;
            uVar8 = local_8;
            if (uVar3 != *(ushort *)(param_1 + local_8 * 2)) {
              uVar8 = 0xffffffff;
            }
            if (uVar5 == 0x1c4) {
              uVar5 = 0x1c5;
LAB_6b84e3d7:
              *(short *)(param_3 + local_8 * 2) = (short)uVar5;
            }
            else {
              if (uVar5 == 0x1c7) {
                uVar5 = 0x1c8;
                goto LAB_6b84e3d7;
              }
              if (uVar5 == 0x1ca) {
                uVar5 = 0x1cb;
                goto LAB_6b84e3d7;
              }
              uVar5 = uVar5 - 0x1f1;
              if (uVar5 == 0) {
                uVar5 = 0x1f2;
                goto LAB_6b84e3d7;
              }
            }
            uVar3 = FUN_6b84e1d3(uVar5 & 0xffff0000 | (uint)*(ushort *)(param_1 + local_8 * 2));
            if (CONCAT22(extraout_var,uVar3) != 0) {
              bVar2 = true;
            }
          }
          uVar7 = uVar7 + 1;
          local_8 = uVar7;
        } while ((int)uVar7 < (int)param_2);
        if ((-1 < (int)uVar8) && ((int)uVar8 < (int)uVar7)) {
          puVar4 = (undefined2 *)(param_3 + uVar8 * 2);
          iVar6 = uVar7 - uVar8;
          do {
            *puVar4 = *(undefined2 *)((int)puVar4 + (param_1 - param_3));
            puVar4 = puVar4 + 1;
            iVar6 = iVar6 + -1;
          } while (iVar6 != 0);
        }
      }
    }
  }
  return uVar7;
}



void __fastcall FUN_6b84e496(short *param_1,int param_2,int param_3,int *param_4,int param_5)

{
  int iVar1;
  short sVar2;
  short sVar3;
  int iVar4;
  uint uVar5;
  
  iVar4 = *param_4;
  *(undefined2 *)(param_5 + iVar4 * 2) = 0xd801;
  iVar1 = iVar4 + 1;
  if (((iVar1 < param_3) &&
      (uVar5 = (uint)*(ushort *)(param_2 + 2 + iVar4 * 2), *(int *)(param_1 + 2) <= (int)uVar5)) &&
     ((int)uVar5 <= *(int *)(param_1 + 4))) {
    sVar2 = *(short *)(param_2 + iVar1 * 2);
    sVar3 = *param_1;
    *param_4 = iVar1;
    *(short *)(param_5 + iVar1 * 2) = sVar2 + sVar3;
  }
  return;
}



uint __fastcall FUN_6b84e4dc(uint param_1,byte *param_2,byte *param_3)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = 0;
  uVar2 = ~-(uint)(param_3 < param_2) & (int)param_3 - (int)param_2;
  if (uVar2 != 0) {
    do {
      if (2 < *param_2) {
        param_1 = (*param_2 ^ param_1) * 0x83;
      }
      param_2 = param_2 + 1;
      uVar1 = uVar1 + 1;
    } while (uVar1 != uVar2);
  }
  return param_1;
}



undefined4 __fastcall FUN_6b84e514(int param_1,uint param_2,int param_3,int param_4)

{
  int iVar1;
  DWORD dwErrCode;
  
  if (((param_1 == 0) || (param_4 == 0)) || (param_3 == 0)) {
    dwErrCode = 0x57;
  }
  else {
    iVar1 = FUN_6b811eff(param_2);
    if (iVar1 == 0) {
      return 0;
    }
    if (DAT_6b8b0800 != 0) {
      return 1;
    }
    dwErrCode = 2;
  }
  SetLastError(dwErrCode);
  return 0;
}



void __fastcall FUN_6b84e554(int param_1,int param_2,uint param_3)

{
  byte *_Dst;
  void *pvVar1;
  uint uVar2;
  rsize_t rVar3;
  
  _Dst = *(byte **)(param_1 + 0x28);
  uVar2 = FUN_6b84e4dc(*(uint *)(param_2 + 0x18),_Dst,*(byte **)(param_2 + 4));
  *(uint *)(param_2 + 0x18) = uVar2;
  if ((param_3 & 2) == 0) {
    uVar2 = FUN_6b84e4dc(*(uint *)(param_2 + 0x1c),*(byte **)(param_1 + 0x2c),
                         *(byte **)(param_2 + 8));
    *(uint *)(param_2 + 0x1c) = uVar2;
  }
  if ((param_3 & 0x20001) != 0x20001) {
    uVar2 = FUN_6b84e4dc(*(uint *)(param_2 + 0x20),*(byte **)(param_1 + 0x30),
                         *(byte **)(param_2 + 0xc));
    *(uint *)(param_2 + 0x20) = uVar2;
  }
  if (*(int *)(param_1 + 0x14) == 0) {
    uVar2 = FUN_6b84e4dc(*(uint *)(param_2 + 0x28),*(byte **)(param_1 + 0x38),
                         *(byte **)(param_2 + 0x14));
    *(uint *)(param_2 + 0x28) = uVar2;
  }
  if ((param_3 & 2) == 0) {
    uVar2 = FUN_6b84e4dc(*(uint *)(param_2 + 0x24),*(byte **)(param_1 + 0x34),
                         *(byte **)(param_2 + 0x10));
    *(uint *)(param_2 + 0x24) = uVar2;
  }
  rVar3 = *(int *)(param_1 + 0x48) - *(int *)(param_2 + 4);
  memmove_s(_Dst,rVar3,*(void **)(param_2 + 4),rVar3);
  *(byte **)(param_1 + 0x48) = _Dst + rVar3;
  rVar3 = *(int *)(param_1 + 0x4c) - *(int *)(param_2 + 8);
  pvVar1 = *(void **)(param_1 + 0x2c);
  memmove_s(pvVar1,rVar3,*(void **)(param_2 + 8),rVar3);
  *(rsize_t *)(param_1 + 0x4c) = rVar3 + (int)pvVar1;
  rVar3 = *(int *)(param_1 + 0x50) - *(int *)(param_2 + 0xc);
  pvVar1 = *(void **)(param_1 + 0x30);
  memmove_s(pvVar1,rVar3,*(void **)(param_2 + 0xc),rVar3);
  *(rsize_t *)(param_1 + 0x50) = rVar3 + (int)pvVar1;
  rVar3 = *(int *)(param_1 + 0x54) - *(int *)(param_2 + 0x10);
  pvVar1 = *(void **)(param_1 + 0x34);
  memmove_s(pvVar1,rVar3,*(void **)(param_2 + 0x10),rVar3);
  *(rsize_t *)(param_1 + 0x54) = rVar3 + (int)pvVar1;
  rVar3 = *(int *)(param_1 + 0x58) - *(int *)(param_2 + 0x14);
  pvVar1 = *(void **)(param_1 + 0x38);
  memmove_s(pvVar1,rVar3,*(void **)(param_2 + 0x14),rVar3);
  *(rsize_t *)(param_1 + 0x58) = rVar3 + (int)pvVar1;
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_6b84e690(int param_1,uint param_2,short *param_3,uint param_4,uint *param_5)

{
  byte bVar1;
  char cVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  ushort *puVar7;
  undefined uVar8;
  ushort uVar9;
  byte bVar10;
  ushort *extraout_EDX;
  ushort *extraout_EDX_00;
  ushort *extraout_EDX_01;
  ushort *extraout_EDX_02;
  ushort *extraout_EDX_03;
  ushort *extraout_EDX_04;
  ushort *extraout_EDX_05;
  ushort *extraout_EDX_06;
  ushort *extraout_EDX_07;
  ushort *puVar11;
  ushort *extraout_EDX_08;
  ushort *extraout_EDX_09;
  ushort uVar12;
  undefined *puVar13;
  ushort *puVar14;
  ushort *puVar15;
  ushort **local_e64;
  ushort *local_e60;
  undefined *local_e5c;
  byte *local_e58;
  byte *local_e54;
  ushort *local_e50;
  int local_e4c;
  int local_e48;
  int local_e44;
  int local_e40;
  int local_e3c;
  uint *local_e38;
  ushort *local_e34;
  undefined2 local_e30 [2];
  byte local_e2c;
  undefined local_e2b;
  undefined local_e2a;
  byte local_e25;
  ushort *local_e24;
  int local_e20;
  int local_e1c;
  byte local_e18;
  int local_e14;
  int local_e10;
  int local_e0c;
  int local_e08;
  int local_e04;
  int local_e00;
  ushort *local_dfc;
  undefined *local_df8;
  ushort *local_de8;
  ushort *local_de4;
  int local_de0;
  ushort *local_ddc;
  undefined *local_dd8;
  byte *local_dd4;
  byte *local_dd0;
  ushort *local_dcc;
  ushort *local_dc8;
  ushort *local_dc4;
  byte local_dc0;
  ushort *local_dbc;
  byte local_db5;
  ushort *local_db4;
  ushort *local_db0;
  ushort *local_dac;
  ushort *local_da8;
  ushort *local_da4;
  ushort *local_da0;
  undefined *local_d9c;
  ushort *local_d98;
  ushort *local_d94;
  ushort *local_d90;
  ushort *local_d8c;
  ushort local_d88 [1728];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_e38 = param_5;
  iVar3 = FUN_6b84e514(param_1,param_2,(int)param_3,param_4);
  puVar11 = extraout_EDX;
  if (iVar3 != 0) {
    local_de0 = 0xc0;
    local_dfc = local_d88;
    if (0x7fffffff < param_4) {
      iVar3 = FUN_6b8502c0(param_3);
      param_4 = iVar3 + 1;
    }
    FUN_6b811d83((int *)&local_e24,param_1,param_2,(int)param_3,param_4);
    local_e64 = &local_e24;
    local_e4c = -0x7ee3623b;
    local_e48 = -0x7ee3623b;
    local_e44 = -0x7ee3623b;
    local_e40 = -0x7ee3623b;
    local_e3c = -0x7ee3623b;
    local_e34 = local_dc8;
    puVar11 = extraout_EDX_00;
    puVar15 = local_ddc;
    if (local_dc8 < local_de4) {
      local_db0 = local_ddc;
      iVar3 = local_e20;
      do {
        puVar14 = local_dc8;
        puVar11 = DAT_6b8b0800;
        uVar4 = (uint)*local_dc8;
        if (iVar3 != 0) {
          uVar4 = *(int *)(iVar3 + (uint)(*local_dc8 >> 8) * 4) + (uVar4 & 0xff);
        }
        local_dc4 = DAT_6b8b0800 + uVar4 * 2;
        local_dc0 = *(byte *)((int)local_dc4 + 1);
        local_da0 = local_dc4;
        if (local_dc0 < 0xd) {
          if (local_dc0 < 5) {
            if (local_dc0 != 4) {
              if (local_dc0 == 0) {
                if (*local_dc8 == 0xdb40) {
                  puVar14 = local_dc8 + 1;
                  if (puVar14 < local_de4) {
                    uVar12 = *puVar14;
                  }
                  else {
                    uVar12 = 0;
                  }
                  puVar11 = (ushort *)0xef;
                  if (0xef < (ushort)(uVar12 + 0x2300)) goto LAB_6b84ff1d;
                  goto LAB_6b84fc5f;
                }
                goto LAB_6b84ff1d;
              }
              if (local_dc0 == 1) {
                if (local_df8 < local_dd8) {
                  if ((local_e08 == 0) ||
                     ((0x14 < *(byte *)((int)local_dc4 + 1) &&
                      (*(byte *)((int)local_dc4 + 1) != 0x29)))) {
                    cVar2 = *(char *)(local_dc4 + 1);
                  }
                  else {
                    cVar2 = '\x02';
                  }
                  local_dd8[-1] = local_dd8[-1] + cVar2;
                }
                else {
                  if ((local_e08 == 0) ||
                     ((0x14 < *(byte *)((int)local_dc4 + 1) &&
                      (*(byte *)((int)local_dc4 + 1) != 0x29)))) {
                    uVar8 = *(undefined *)(local_dc4 + 1);
                  }
                  else {
                    uVar8 = 2;
                  }
                  *local_dd8 = uVar8;
                  local_dd8 = local_dd8 + 1;
                }
                goto LAB_6b84ff0b;
              }
              if (local_dc0 != 2) {
                if (local_dc0 != 3) goto LAB_6b84ff1d;
                local_da4 = (ushort *)0xffff;
                local_e25 = *(byte *)local_dc4;
                bVar1 = *(byte *)((int)local_dc4 + 3) & local_e18;
                local_db5 = bVar1 | 0xc4;
                puVar15 = local_dc8;
                if (local_e25 < 2) {
                  do {
                    while( true ) {
                      puVar15 = puVar15 + -1;
                      puVar11 = local_da4;
                      if (puVar15 < local_de8) goto LAB_6b84f8ab;
                      uVar4 = (uint)*puVar15;
                      if (iVar3 != 0) {
                        uVar4 = (uVar4 & 0xff) + *(int *)(iVar3 + (uint)(*puVar15 >> 8) * 4);
                      }
                      uVar4 = *(uint *)(DAT_6b8b0800 + uVar4 * 2);
                      bVar10 = (byte)(uVar4 >> 8);
                      if (2 < bVar10) break;
                      if (bVar10 == 2) goto LAB_6b84f8ab;
                    }
                    if (bVar10 != 3) {
                      puVar11 = (ushort *)(uVar4 & 0xffff);
                      goto LAB_6b84f8ab;
                    }
                  } while ((byte)uVar4 < 2);
                  local_da4 = (ushort *)(uint)((ushort)uVar4 & 0xff | 0x2200);
                  bVar10 = (byte)(uVar4 >> 0x18) & local_e18;
                  local_db4 = (ushort *)(bVar10 | 0xc4);
                  *local_dd0 = bVar10 & 0xc6 | 0xc4;
                  local_dd0[local_de0 * 2] = (byte)local_db4 & 0xe4;
                  if (local_e25 != 0) {
                    local_da4 = (ushort *)((uint)local_da4 & 0xff87);
                    local_dd0[local_de0] = 5;
                    goto LAB_6b84f982;
                  }
                  local_dd0[local_de0] = 4;
                  local_dd0[local_de0 * 3] = (byte)local_db4 & 0xc5;
                }
                else {
                  local_da4 = (ushort *)(uint)(ushort)(local_e25 | 0x2200);
                  *local_dd0 = bVar1 & 0xc6 | 0xc4;
                  local_dd0[local_de0] = 3;
                  local_dd0[local_de0 * 2] = bVar1 & 0xe4 | 0xc4;
LAB_6b84f982:
                  local_dd0[local_de0 * 3] = bVar1 & 0xc5 | 0xc4;
                }
                local_dd0 = local_dd0 + 1;
                puVar11 = local_da4;
LAB_6b84f8ab:
                if ((local_e08 == 0) ||
                   ((0x14 < *(byte *)((int)local_dc4 + 1) && (*(byte *)((int)local_dc4 + 1) != 0x29)
                    ))) {
                  uVar8 = *(undefined *)(local_dc4 + 1);
                }
                else {
                  uVar8 = 2;
                }
                *local_dd8 = uVar8;
                *local_dd4 = 2;
                cVar2 = (char)((uint)puVar11 >> 8);
                *(char *)local_ddc = cVar2;
                local_db0 = local_ddc + 1;
                *(char *)((int)local_ddc + 1) = (char)puVar11;
                if (((byte)(cVar2 + 0x57U) < 7) ||
                   ((local_e00 != 0 && ((byte)(cVar2 + 0x40U) < 0x30)))) {
                  if (local_dc8 + -1 < local_de8) {
                    *(undefined *)local_db0 = 0;
                  }
                  else {
                    uVar12 = local_dc8[-1];
                    uVar4 = (uint)uVar12;
                    if (local_e20 != 0) {
                      uVar4 = *(int *)(local_e20 + (uint)(uVar12 >> 8) * 4) + (uVar4 & 0xff);
                    }
                    *(undefined *)local_db0 = *(undefined *)(DAT_6b8b0800 + uVar4 * 2 + 1);
                  }
                  local_db0 = (ushort *)((int)local_ddc + 3);
                }
                iVar3 = local_e20;
                puVar15 = local_db0;
                local_ddc = local_db0;
                if ((short)puVar11 != -1) {
                  local_dd8 = local_dd8 + 1;
                  local_dd4 = local_dd4 + 1;
                }
                goto LAB_6b84ff1d;
              }
              cVar2 = *(char *)((int)local_dc4 + 1);
              puVar14 = local_dc4;
              while (puVar7 = puVar14, DAT_6b8b0800 = puVar11, cVar2 == '\x02') {
                uVar12 = *(ushort *)(local_e1c + (uint)puVar7[1] * 4);
                uVar4 = (uint)uVar12;
                if (iVar3 != 0) {
                  uVar4 = *(int *)(iVar3 + (uint)(uVar12 >> 8) * 4) + (uVar4 & 0xff);
                }
                puVar11 = puVar11 + uVar4 * 2;
                uVar12 = *puVar11;
                *(char *)((int)puVar15 + 1) = (char)uVar12;
                *(char *)puVar15 = (char)(uVar12 >> 8);
                puVar15 = puVar15 + 1;
                if ((local_e08 == 0) ||
                   ((0x14 < *(byte *)((int)puVar11 + 1) && (*(byte *)((int)puVar11 + 1) != 0x29))))
                {
                  uVar8 = *(undefined *)(puVar11 + 1);
                }
                else {
                  uVar8 = 2;
                }
                *local_dd8 = uVar8;
                if ((local_e0c == 0) ||
                   ((0x14 < *(byte *)((int)puVar11 + 1) && (*(byte *)((int)puVar11 + 1) != 0x29))))
                {
                  bVar1 = *(byte *)((int)puVar11 + 3) & 0x3f;
                }
                else {
                  bVar1 = 2;
                }
                *local_dd4 = bVar1 & local_e18;
                local_dd8 = local_dd8 + 1;
                local_dd4 = local_dd4 + 1;
                uVar12 = *(ushort *)(local_e1c + 2 + (uint)puVar7[1] * 4);
                uVar4 = (uint)uVar12;
                if (local_e20 != 0) {
                  uVar4 = *(int *)(local_e20 + (uint)(uVar12 >> 8) * 4) + (uVar4 & 0xff);
                }
                puVar14 = DAT_6b8b0800 + uVar4 * 2;
                local_dc4 = puVar7;
                iVar3 = local_e20;
                puVar11 = DAT_6b8b0800;
                cVar2 = *(char *)((int)(DAT_6b8b0800 + uVar4 * 2) + 1);
              }
              uVar12 = *puVar7;
              *(char *)((int)puVar15 + 1) = (char)uVar12;
              *(char *)puVar15 = (char)(uVar12 >> 8);
              if ((local_e08 == 0) ||
                 ((0x14 < *(byte *)((int)puVar7 + 1) && (*(byte *)((int)puVar7 + 1) != 0x29)))) {
                local_ddc = (ushort *)((uint)puVar11 & 0xffffff00 | (uint)*(byte *)(puVar7 + 1));
              }
              else {
                local_ddc = (ushort *)CONCAT31((int3)((uint)puVar11 >> 8),2);
              }
              *local_dd8 = (char)local_ddc;
              local_da0 = puVar7;
              goto LAB_6b84f79b;
            }
            iVar3 = FUN_6b85037c(iVar3,local_dc8,local_de4,local_e30,&local_e2c);
            if (iVar3 < 1) {
              uVar8 = *(undefined *)local_dc4;
              *(undefined *)((int)local_ddc + 1) = *(undefined *)(local_dc4 + 1);
              *(undefined *)local_ddc = uVar8;
              *local_dd8 = 2;
              bVar1 = *(byte *)((int)local_dc4 + 3);
              puVar11 = local_ddc;
              puVar15 = local_ddc;
              goto LAB_6b84fd75;
            }
            *(char *)local_ddc = (char)((ushort)local_e30[0] >> 8);
            *(char *)((int)local_ddc + 1) = (char)local_e30[0];
            *(byte *)((int)local_ddc + 3) = local_e2c;
            *(undefined *)(local_ddc + 1) = 0xff;
            *(undefined *)((int)local_ddc + 5) = local_e2b;
            *(undefined *)(local_ddc + 2) = 0xff;
            *(undefined *)((int)local_ddc + 7) = local_e2a;
            *(undefined *)(local_ddc + 3) = 0xff;
            local_ddc = local_ddc + 4;
            *local_dd8 = 2;
            *local_dd4 = 2;
            local_dd8 = local_dd8 + 1;
            local_dd4 = local_dd4 + 1;
            local_dc8 = local_dc8 + iVar3 + -1;
            puVar11 = (ushort *)0xff00;
          }
          else {
            if (local_dc0 != 5) {
              if (local_dc0 == 6) {
                if (local_e14 == 0) {
                  uVar12 = ~(ushort)((uint)((int)puVar15 - (int)local_dfc) >> 1);
                  if (uVar12 < 2) {
                    uVar12 = 2;
                  }
                  *(char *)local_dcc = (char)(uVar12 >> 8);
                  local_d9c._0_1_ = (undefined)uVar12;
                  *(undefined *)((int)local_dcc + 1) = local_d9c._0_1_;
                  local_d9c._0_2_ = (ushort)*(byte *)local_dc4 * 0x100;
                  if ((local_e08 == 0) ||
                     ((0x14 < *(byte *)((int)local_dc4 + 1) &&
                      (*(byte *)((int)local_dc4 + 1) != 0x29)))) {
                    uVar4 = (uint)*(byte *)(local_dc4 + 1);
                  }
                  else {
                    uVar4 = 2;
                  }
                  if ((local_e0c == 0) ||
                     ((0x14 < *(byte *)((int)local_dc4 + 1) &&
                      (*(byte *)((int)local_dc4 + 1) != 0x29)))) {
                    uVar12 = (ushort)(*(byte *)((int)local_dc4 + 3) & 0x3f);
                  }
                  else {
                    uVar12 = 2;
                  }
                  uVar12 = (short)local_d9c + (local_e18 & uVar12 | (ushort)(uVar4 << 3));
                  local_d9c = (undefined *)(uint)uVar12;
                  *(char *)(local_dcc + 1) = (char)((uint)local_d9c >> 8);
                  local_d9c._0_1_ = (undefined)uVar12;
                  *(undefined *)((int)local_dcc + 3) = local_d9c._0_1_;
                  puVar11 = local_dcc;
                  local_dcc = local_dcc + 2;
                  goto LAB_6b84ff0b;
                }
              }
              else if ((local_dc0 < 7) || (0xc < local_dc0)) goto LAB_6b84ff1d;
              if (local_e10 != 0) goto LAB_6b84ff1d;
              uVar12 = *local_dc4;
              *(char *)((int)puVar15 + 1) = (char)uVar12;
              *(char *)puVar15 = (char)(uVar12 >> 8);
              *local_dd8 = *(undefined *)(local_dc4 + 1);
              bVar1 = *(byte *)((int)local_dc4 + 3) & local_e18;
LAB_6b84fd75:
              bVar1 = bVar1 & 0x3f;
              goto LAB_6b84f7bf;
            }
            *puVar15 = 0xfffd;
            puVar11 = puVar15 + 1;
            uVar8 = *(undefined *)local_dc4;
            *(undefined *)((int)puVar15 + 3) = *(undefined *)(local_dc4 + 1);
            *(undefined *)puVar11 = uVar8;
            local_ddc = puVar15 + 2;
            *local_dd8 = 2;
            *local_dd4 = 2;
LAB_6b84fef9:
            local_dd8 = local_dd8 + 1;
            local_dd4 = local_dd4 + 1;
          }
LAB_6b84ff0b:
          local_db0 = local_ddc;
          iVar3 = local_e20;
          puVar15 = local_ddc;
        }
        else {
          puVar11 = local_e24;
          if (*(int *)(local_e24 + 0x82) != 0) {
            local_dbc = (ushort *)0x0;
            local_da4 = (ushort *)0x0;
            bVar1 = (*(char *)((int)local_dc4 + 1) == '\x03') - 1U & *(byte *)((int)local_dc4 + 3) &
                    0xc0;
            if (bVar1 == 0x40) goto LAB_6b84f03a;
            if (bVar1 == 0x80) {
LAB_6b84eceb:
              local_d8c = *(ushort **)(local_e24 + 0x82);
              local_d98 = (ushort *)(*(uint *)(local_e24 + 0x7e) & 0x20);
              puVar11 = local_d98;
              if ((local_d8c[7] != 0) && (puVar14 + (local_d98 != (ushort *)0x0) + 4 <= local_de4))
              {
                if (local_da4 == (ushort *)0x0) {
                  local_da4 = (ushort *)
                              FUN_6b85026b(puVar14,local_de4,5,local_d8c[2],local_d8c[3],
                                           (int)local_d98,0);
                }
                puVar11 = local_d98;
                if (4 < (int)local_da4) {
                  local_da8 = (ushort *)0x0;
                  local_d94 = (ushort *)0x0;
                  local_d9c = (undefined *)(local_d8c[7] - 1);
                  if ((local_d98 == (ushort *)0x0) || (local_de4 <= puVar14 + 5)) {
LAB_6b84ee20:
                    iVar5 = 0;
                  }
                  else {
                    uVar4 = (uint)*puVar14;
                    if (local_e20 != 0) {
                      uVar4 = (uVar4 & 0xff) + *(int *)(local_e20 + (uint)(*puVar14 >> 8) * 4);
                    }
                    local_d90 = *(ushort **)(DAT_6b8b0800 + uVar4 * 2);
                    uVar4 = (uint)puVar14[1];
                    if (local_e20 != 0) {
                      uVar4 = (uVar4 & 0xff) + *(int *)(local_e20 + (uint)(puVar14[1] >> 8) * 4);
                    }
                    puVar11 = DAT_6b8b0800;
                    if (((*(uint *)(DAT_6b8b0800 + uVar4 * 2) ^ (uint)local_d90) & 0xe7ffffff) != 0)
                    goto LAB_6b84ee20;
                    iVar5 = 1;
                    local_d94 = (ushort *)&DAT_00000001;
                  }
                  iVar3 = local_e20;
                  if (-1 < (int)local_d9c) {
                    local_dac = puVar14 + iVar5;
                    do {
                      local_d90 = (ushort *)((int)(local_d9c + (int)local_da8) / 2);
                      local_db4 = (ushort *)(*(int *)(local_e24 + 0x8a) + (int)local_d90 * 0x10);
                      iVar5 = FUN_6b85023c((int)local_dac,local_db4,5);
                      puVar11 = extraout_EDX_04;
                      if (iVar5 == 0) {
                        local_dc4 = local_db4 + 6;
                        puVar14 = puVar14 + (int)(local_d94 + 2);
                        local_dc8 = puVar14;
                        local_dbc = local_d94;
                        local_da0 = local_dc4;
                        goto LAB_6b84f371;
                      }
                      if (iVar5 < 0) {
                        local_d9c = (undefined *)((int)local_d90 + -1);
                      }
                      else {
                        local_da8 = (ushort *)((int)local_d90 + 1);
                      }
                    } while ((int)local_da8 <= (int)local_d9c);
                  }
                }
              }
              if ((local_d8c[6] != 0) &&
                 (puVar11 = local_d98, puVar14 + (local_d98 != (ushort *)0x0) + 3 <= local_de4)) {
                if (local_da4 == (ushort *)0x0) {
                  local_da4 = (ushort *)
                              FUN_6b85026b(puVar14,local_de4,4,local_d8c[2],local_d8c[3],
                                           (int)local_d98,0);
                }
                puVar11 = local_d98;
                if (3 < (int)local_da4) {
                  local_d98 = (ushort *)0x0;
                  local_d94 = (ushort *)0x0;
                  local_d8c = (ushort *)(local_d8c[6] - 1);
                  if ((puVar11 == (ushort *)0x0) || (local_de4 <= puVar14 + 4)) {
LAB_6b84efbe:
                    iVar5 = 0;
                  }
                  else {
                    uVar4 = (uint)*puVar14;
                    if (local_e20 != 0) {
                      uVar4 = (uVar4 & 0xff) + *(int *)(local_e20 + (uint)(*puVar14 >> 8) * 4);
                    }
                    local_d90 = *(ushort **)(DAT_6b8b0800 + uVar4 * 2);
                    uVar4 = (uint)puVar14[1];
                    if (local_e20 != 0) {
                      uVar4 = (uVar4 & 0xff) + *(int *)(local_e20 + (uint)(puVar14[1] >> 8) * 4);
                    }
                    puVar11 = DAT_6b8b0800;
                    if (((*(uint *)(DAT_6b8b0800 + uVar4 * 2) ^ (uint)local_d90) & 0xe7ffffff) != 0)
                    goto LAB_6b84efbe;
                    iVar5 = 1;
                    local_d94 = (ushort *)&DAT_00000001;
                  }
                  iVar3 = local_e20;
                  if (-1 < (int)local_d8c) {
                    local_db4 = puVar14 + iVar5;
                    do {
                      local_d90 = (ushort *)((int)((int)local_d8c + (int)local_d98) / 2);
                      local_dac = (ushort *)(*(int *)(local_e24 + 0x88) + (int)local_d90 * 0xc);
                      iVar5 = FUN_6b85023c((int)local_db4,local_dac,4);
                      puVar11 = extraout_EDX_05;
                      if (iVar5 == 0) {
                        local_dc4 = local_dac + 4;
                        puVar14 = puVar14 + (int)((int)local_d94 + 3);
                        local_dc8 = puVar14;
                        local_dbc = local_d94;
                        local_da0 = local_dc4;
                        goto LAB_6b84f371;
                      }
                      if (iVar5 < 0) {
                        local_d8c = (ushort *)((int)local_d90 + -1);
                      }
                      else {
                        local_d98 = (ushort *)((int)local_d90 + 1);
                      }
                    } while ((int)local_d98 <= (int)local_d8c);
                  }
                }
              }
LAB_6b84f03a:
              local_d9c = *(undefined **)(local_e24 + 0x82);
              local_da8 = (ushort *)(*(uint *)(local_e24 + 0x7e) & 0x20);
              if ((*(short *)(local_d9c + 10) != 0) &&
                 (puVar11 = local_de4, puVar14 + (local_da8 != (ushort *)0x0) + 2 <= local_de4)) {
                if (local_da4 == (ushort *)0x0) {
                  local_da4 = (ushort *)
                              FUN_6b85026b(puVar14,local_de4,3,*(ushort *)(local_d9c + 4),
                                           *(ushort *)(local_d9c + 6),(int)local_da8,0);
                }
                puVar11 = local_de4;
                if (2 < (int)local_da4) {
                  local_d98 = (ushort *)0x0;
                  local_d94 = (ushort *)0x0;
                  local_d8c = (ushort *)(*(ushort *)(local_d9c + 10) - 1);
                  if ((local_da8 == (ushort *)0x0) || (local_de4 <= puVar14 + 3)) {
LAB_6b84f16d:
                    iVar5 = 0;
                  }
                  else {
                    uVar4 = (uint)*puVar14;
                    if (local_e20 != 0) {
                      uVar4 = (uVar4 & 0xff) + *(int *)(local_e20 + (uint)(*puVar14 >> 8) * 4);
                    }
                    local_d90 = *(ushort **)(DAT_6b8b0800 + uVar4 * 2);
                    uVar4 = (uint)puVar14[1];
                    if (local_e20 != 0) {
                      uVar4 = (uVar4 & 0xff) + *(int *)(local_e20 + (uint)(puVar14[1] >> 8) * 4);
                    }
                    puVar11 = DAT_6b8b0800;
                    if (((*(uint *)(DAT_6b8b0800 + uVar4 * 2) ^ (uint)local_d90) & 0xe7ffffff) != 0)
                    goto LAB_6b84f16d;
                    iVar5 = 1;
                    local_d94 = (ushort *)&DAT_00000001;
                  }
                  iVar3 = local_e20;
                  if (-1 < (int)local_d8c) {
                    local_db4 = puVar14 + iVar5;
                    do {
                      local_d90 = (ushort *)((int)((int)local_d8c + (int)local_d98) / 2);
                      local_dac = (ushort *)(*(int *)(local_e24 + 0x86) + (int)local_d90 * 0xc);
                      iVar5 = FUN_6b85023c((int)local_db4,local_dac,3);
                      puVar11 = extraout_EDX_06;
                      if (iVar5 == 0) {
                        local_dc4 = local_dac + 4;
                        puVar14 = puVar14 + (int)(local_d94 + 1);
                        local_dc8 = puVar14;
                        local_dbc = local_d94;
                        local_da0 = local_dc4;
                        goto LAB_6b84f371;
                      }
                      if (iVar5 < 0) {
                        local_d8c = (ushort *)((int)local_d90 + -1);
                      }
                      else {
                        local_d98 = (ushort *)((int)local_d90 + 1);
                      }
                    } while ((int)local_d98 <= (int)local_d8c);
                  }
                }
              }
              if ((*(short *)(local_d9c + 8) != 0) &&
                 (puVar11 = local_da8, puVar14 + (local_da8 != (ushort *)0x0) + 1 <= local_de4)) {
                puVar7 = local_da4;
                if (local_da4 == (ushort *)0x0) {
                  puVar7 = (ushort *)
                           FUN_6b85026b(puVar14,local_de4,2,*(ushort *)(local_d9c + 4),
                                        *(ushort *)(local_d9c + 6),(int)local_da8,0);
                }
                puVar11 = local_da8;
                if (1 < (int)puVar7) {
                  iVar5 = 0;
                  local_d98 = (ushort *)0x0;
                  local_d8c = (ushort *)0x0;
                  local_d94 = (ushort *)(*(ushort *)(local_d9c + 8) - 1);
                  if (local_da8 != (ushort *)0x0) {
                    if (puVar14 + 2 < local_de4) {
                      uVar4 = (uint)*puVar14;
                      if (iVar3 != 0) {
                        uVar4 = (uVar4 & 0xff) + *(int *)(iVar3 + (uint)(*puVar14 >> 8) * 4);
                      }
                      local_d90 = *(ushort **)(DAT_6b8b0800 + uVar4 * 2);
                      uVar4 = (uint)puVar14[1];
                      if (iVar3 != 0) {
                        uVar4 = (uVar4 & 0xff) + *(int *)(iVar3 + (uint)(puVar14[1] >> 8) * 4);
                      }
                      puVar11 = DAT_6b8b0800;
                      if (((*(uint *)(DAT_6b8b0800 + uVar4 * 2) ^ (uint)local_d90) & 0xe7ffffff) ==
                          0) {
                        iVar5 = 1;
                        local_d8c = (ushort *)&DAT_00000001;
                        goto LAB_6b84f2fd;
                      }
                    }
                    iVar5 = 0;
                  }
LAB_6b84f2fd:
                  if (-1 < (int)local_d94) {
                    local_d90 = puVar14 + iVar5;
                    do {
                      iVar5 = (int)((int)local_d98 + (int)local_d94) / 2;
                      local_db4 = (ushort *)(*(int *)(local_e24 + 0x84) + iVar5 * 8);
                      iVar3 = FUN_6b85023c((int)local_d90,local_db4,2);
                      puVar11 = extraout_EDX_07;
                      if (iVar3 == 0) {
                        local_dc4 = local_db4 + 2;
                        puVar14 = local_d90 + 1;
                        local_dc8 = puVar14;
                        local_dbc = local_d8c;
                        local_da0 = local_dc4;
                        break;
                      }
                      if (iVar3 < 0) {
                        local_d94 = (ushort *)(iVar5 + -1);
                      }
                      else {
                        local_d98 = (ushort *)(iVar5 + 1);
                      }
                    } while ((int)local_d98 <= (int)local_d94);
                  }
                }
              }
            }
            else if (bVar1 == 0xc0) {
              local_d9c = (undefined *)(*(uint *)(local_e24 + 0x7e) & 0x20);
              if (((*(short *)(*(int *)(local_e24 + 0x82) + 0x14) != 0) &&
                  (local_dc8 + (local_d9c != (undefined *)0x0) + 7 <= local_de4)) &&
                 (local_da4 = (ushort *)
                              FUN_6b85026b(local_dc8,local_de4,8,
                                           *(ushort *)(*(int *)(local_e24 + 0x82) + 4),
                                           *(ushort *)(*(int *)(local_e24 + 0x82) + 6),
                                           (int)local_d9c,0), 7 < (int)local_da4)) {
                iVar5 = 0;
                local_da8 = (ushort *)0x0;
                local_d94 = (ushort *)0x0;
                local_d8c = (ushort *)(*(ushort *)(*(int *)(local_e24 + 0x82) + 0x14) - 1);
                if (local_d9c != (undefined *)0x0) {
                  if (puVar14 + 8 < local_de4) {
                    uVar4 = (uint)*puVar14;
                    if (local_e20 != 0) {
                      uVar4 = (uVar4 & 0xff) + *(int *)(local_e20 + (uint)(*puVar14 >> 8) * 4);
                    }
                    local_d98 = *(ushort **)(DAT_6b8b0800 + uVar4 * 2);
                    uVar4 = (uint)puVar14[1];
                    if (local_e20 != 0) {
                      uVar4 = (uVar4 & 0xff) + *(int *)(local_e20 + (uint)(puVar14[1] >> 8) * 4);
                    }
                    if (((*(uint *)(DAT_6b8b0800 + uVar4 * 2) ^ (uint)local_d98) & 0xe7ffffff) == 0)
                    {
                      iVar5 = 1;
                      local_d94 = (ushort *)&DAT_00000001;
                      goto LAB_6b84e901;
                    }
                  }
                  iVar5 = 0;
                }
LAB_6b84e901:
                iVar3 = local_e20;
                if (-1 < (int)local_d8c) {
                  local_d90 = puVar14 + iVar5;
                  do {
                    local_d98 = (ushort *)((int)((int)local_da8 + (int)local_d8c) / 2);
                    local_dac = (ushort *)(*(int *)(local_e24 + 0x90) + (int)local_d98 * 0x14);
                    iVar5 = FUN_6b85023c((int)local_d90,local_dac,8);
                    if (iVar5 == 0) {
                      local_dc4 = local_dac + 8;
                      puVar14 = puVar14 + (int)((int)local_d94 + 7);
                      puVar11 = extraout_EDX_01;
                      local_dc8 = puVar14;
                      local_dbc = local_d94;
                      local_da0 = local_dc4;
                      goto LAB_6b84f371;
                    }
                    if (iVar5 < 0) {
                      local_d8c = (ushort *)((int)local_d98 + -1);
                    }
                    else {
                      local_da8 = (ushort *)((int)local_d98 + 1);
                    }
                  } while ((int)local_da8 <= (int)local_d8c);
                }
              }
              local_dac = (ushort *)(uint)*(ushort *)(*(int *)(local_e24 + 0x82) + 0x12);
              if ((*(ushort *)(*(int *)(local_e24 + 0x82) + 0x12) != 0) &&
                 (puVar14 + (local_d9c != (undefined *)0x0) + 6 <= local_de4)) {
                if (local_da4 == (ushort *)0x0) {
                  local_da4 = (ushort *)
                              FUN_6b85026b(puVar14,local_de4,7,
                                           *(ushort *)(*(int *)(local_e24 + 0x82) + 4),
                                           *(ushort *)(*(int *)(local_e24 + 0x82) + 6),
                                           (int)local_d9c,0);
                }
                if (6 < (int)local_da4) {
                  iVar5 = 0;
                  local_da8 = (ushort *)0x0;
                  local_d8c = (ushort *)(((uint)local_dac & 0xffff) - 1);
                  local_d94 = (ushort *)0x0;
                  if (local_d9c != (undefined *)0x0) {
                    if (puVar14 + 7 < local_de4) {
                      uVar4 = (uint)*puVar14;
                      if (iVar3 != 0) {
                        uVar4 = (uVar4 & 0xff) + *(int *)(iVar3 + (uint)(*puVar14 >> 8) * 4);
                      }
                      local_d98 = *(ushort **)(DAT_6b8b0800 + uVar4 * 2);
                      uVar4 = (uint)puVar14[1];
                      if (iVar3 != 0) {
                        uVar4 = (uVar4 & 0xff) + *(int *)(iVar3 + (uint)(puVar14[1] >> 8) * 4);
                      }
                      if (((*(uint *)(DAT_6b8b0800 + uVar4 * 2) ^ (uint)local_d98) & 0xe7ffffff) ==
                          0) {
                        iVar5 = 1;
                        local_d94 = (ushort *)&DAT_00000001;
                        goto LAB_6b84eac7;
                      }
                    }
                    iVar5 = 0;
                  }
LAB_6b84eac7:
                  if (-1 < (int)local_d8c) {
                    local_dac = puVar14 + iVar5;
                    do {
                      local_d98 = (ushort *)((int)((int)local_da8 + (int)local_d8c) / 2);
                      local_d90 = (ushort *)(*(int *)(local_e24 + 0x8e) + (int)local_d98 * 0x14);
                      iVar5 = FUN_6b85023c((int)local_dac,local_d90,7);
                      if (iVar5 == 0) {
                        local_dc4 = local_d90 + 8;
                        puVar14 = puVar14 + (int)(local_d94 + 3);
                        puVar11 = extraout_EDX_02;
                        local_dc8 = puVar14;
                        local_dbc = local_d94;
                        local_da0 = local_dc4;
                        goto LAB_6b84f371;
                      }
                      if (iVar5 < 0) {
                        local_d8c = (ushort *)((int)local_d98 + -1);
                      }
                      else {
                        local_da8 = (ushort *)((int)local_d98 + 1);
                      }
                    } while ((int)local_da8 <= (int)local_d8c);
                  }
                }
              }
              local_dac = (ushort *)(uint)*(ushort *)(*(int *)(local_e24 + 0x82) + 0x10);
              if ((*(ushort *)(*(int *)(local_e24 + 0x82) + 0x10) != 0) &&
                 (puVar14 + (local_d9c != (undefined *)0x0) + 5 <= local_de4)) {
                if (local_da4 == (ushort *)0x0) {
                  local_da4 = (ushort *)
                              FUN_6b85026b(puVar14,local_de4,6,
                                           *(ushort *)(*(int *)(local_e24 + 0x82) + 4),
                                           *(ushort *)(*(int *)(local_e24 + 0x82) + 6),
                                           (int)local_d9c,0);
                }
                if (5 < (int)local_da4) {
                  iVar5 = 0;
                  local_da8 = (ushort *)0x0;
                  local_d8c = (ushort *)(((uint)local_dac & 0xffff) - 1);
                  local_d94 = (ushort *)0x0;
                  if (local_d9c != (undefined *)0x0) {
                    if (puVar14 + 6 < local_de4) {
                      uVar4 = (uint)*puVar14;
                      if (iVar3 != 0) {
                        uVar4 = (uVar4 & 0xff) + *(int *)(iVar3 + (uint)(*puVar14 >> 8) * 4);
                      }
                      uVar6 = (uint)puVar14[1];
                      if (iVar3 != 0) {
                        uVar6 = (uVar6 & 0xff) + *(int *)(iVar3 + (uint)(puVar14[1] >> 8) * 4);
                      }
                      if (((*(uint *)(DAT_6b8b0800 + uVar6 * 2) ^
                           *(uint *)(DAT_6b8b0800 + uVar4 * 2)) & 0xe7ffffff) == 0) {
                        iVar5 = 1;
                        local_d94 = (ushort *)&DAT_00000001;
                        goto LAB_6b84ec6d;
                      }
                    }
                    iVar5 = 0;
                  }
LAB_6b84ec6d:
                  if (-1 < (int)local_d8c) {
                    local_dac = puVar14 + iVar5;
                    do {
                      local_d98 = (ushort *)((int)((int)local_da8 + (int)local_d8c) / 2);
                      local_d90 = (ushort *)(*(int *)(local_e24 + 0x8c) + (int)local_d98 * 0x10);
                      iVar5 = FUN_6b85023c((int)local_dac,local_d90,6);
                      if (iVar5 == 0) {
                        local_dc4 = local_d90 + 6;
                        puVar14 = puVar14 + (int)((int)local_d94 + 5);
                        puVar11 = extraout_EDX_03;
                        local_dc8 = puVar14;
                        local_dbc = local_d94;
                        local_da0 = local_dc4;
                        goto LAB_6b84f371;
                      }
                      if (iVar5 < 0) {
                        local_d8c = (ushort *)((int)local_d98 + -1);
                      }
                      else {
                        local_da8 = (ushort *)((int)local_d98 + 1);
                      }
                    } while ((int)local_da8 <= (int)local_d8c);
                  }
                }
              }
              goto LAB_6b84eceb;
            }
LAB_6b84f371:
            local_dc0 = *(byte *)((int)local_da0 + 1);
          }
          if ((local_dc0 != 0xd) || (local_e04 == 0)) {
LAB_6b84f68f:
            uVar12 = *local_da0;
            *(char *)((int)puVar15 + 1) = (char)uVar12;
            *(char *)puVar15 = (char)(uVar12 >> 8);
            local_ddc = puVar15 + 1;
            if (((byte)(local_dc0 + 0x57) < 7) ||
               ((local_e00 != 0 && ((byte)(local_dc0 + 0x40) < 0x30)))) {
              *(undefined *)local_ddc = *(undefined *)(local_dc4 + 1);
              local_ddc = (ushort *)((int)puVar15 + 3);
            }
            else {
              if ((local_e08 == 0) ||
                 ((0x14 < *(byte *)((int)local_dc4 + 1) && (*(byte *)((int)local_dc4 + 1) != 0x29)))
                 ) {
                uVar8 = *(undefined *)(local_dc4 + 1);
              }
              else {
                uVar8 = 2;
              }
              *local_dd8 = uVar8;
              local_dd8 = local_dd8 + 1;
            }
            if ((local_e0c == 0) ||
               ((0x14 < *(byte *)((int)local_dc4 + 1) && (*(byte *)((int)local_dc4 + 1) != 0x29))))
            {
              bVar1 = *(byte *)((int)local_dc4 + 3) & 0x3f;
            }
            else {
              bVar1 = 2;
            }
            *local_dd4 = bVar1 & local_e18;
            local_dd4 = local_dd4 + 1;
            if (local_dbc != (ushort *)0x0) {
              uVar12 = *local_dc4;
              *(char *)((int)local_ddc + 1) = (char)uVar12;
              *(char *)local_ddc = (char)(uVar12 >> 8);
              if ((local_e08 == 0) ||
                 ((0x14 < *(byte *)((int)local_dc4 + 1) && (*(byte *)((int)local_dc4 + 1) != 0x29)))
                 ) {
                uVar8 = *(undefined *)(local_dc4 + 1);
              }
              else {
                uVar8 = 2;
              }
              *local_dd8 = uVar8;
              puVar7 = local_dc4;
              puVar15 = local_ddc;
LAB_6b84f79b:
              if ((local_e0c == 0) ||
                 ((0x14 < *(byte *)((int)puVar7 + 1) && (*(byte *)((int)puVar7 + 1) != 0x29)))) {
                bVar1 = *(byte *)((int)puVar7 + 3) & 0x3f;
              }
              else {
                bVar1 = 2;
              }
              bVar1 = bVar1 & local_e18;
              puVar11 = local_ddc;
LAB_6b84f7bf:
              local_ddc = puVar15 + 1;
              *local_dd4 = bVar1;
              goto LAB_6b84fef9;
            }
            goto LAB_6b84ff0b;
          }
          local_d9c = (undefined *)0x0;
          local_db4 = (ushort *)0x3ff;
          local_d98 = (ushort *)0x0;
          local_d8c = (ushort *)0x0;
          local_dac = (ushort *)&DAT_6b884700;
          puVar11 = (ushort *)0x37;
          if ((ushort)(*puVar14 + 0x2400) < 0x400) {
            if (local_de8 < puVar14) {
              if (puVar14[-1] != 0xd835) goto LAB_6b84f68f;
              puVar13 = &DAT_6b884c10;
              puVar11 = (ushort *)0x9;
            }
            else {
              puVar13 = &DAT_6b884700;
            }
          }
          else {
            puVar13 = &DAT_6b884700;
          }
          iVar3 = 0;
          do {
            uVar4 = (int)((int)puVar11 + iVar3) >> 1;
            if (*puVar14 == *(ushort *)(puVar13 + uVar4 * 2)) break;
            if (*puVar14 < *(ushort *)(puVar13 + uVar4 * 2)) {
              puVar11 = (ushort *)(uVar4 - 1);
            }
            else {
              iVar3 = uVar4 + 1;
            }
          } while (iVar3 <= (int)puVar11);
          local_d90 = (ushort *)(uint)*(ushort *)(puVar13 + (uVar4 & 0xfffffffe) * 2);
          uVar12 = *puVar14;
          puVar11 = (ushort *)(uint)uVar12;
          if ((uVar12 < *(ushort *)(puVar13 + (uVar4 & 0xfffffffe) * 2)) ||
             (local_db4 = local_d90, *(ushort *)(puVar13 + (uVar4 & 0xfffffffe) * 2 + 2) < uVar12))
          {
            local_db4 = (ushort *)0x0;
          }
          uVar12 = (ushort)local_db4;
          puVar15 = local_db0;
          if (uVar12 == 0) goto LAB_6b84f68f;
          if ((uVar12 < 0xdc00) || (0xdfff < uVar12)) {
            uVar9 = 0;
          }
          else {
            uVar9 = 0xd835;
            local_d9c = (undefined *)0xd835;
          }
          while (puVar11 = puVar14, *puVar14 == uVar12) {
            local_d8c = (ushort *)((int)local_d8c + 1);
            puVar11 = puVar14 + 1;
            if (uVar9 != 0) {
              if ((local_de4 <= puVar11) || (*puVar11 != uVar9)) {
                puVar11 = puVar14 + 2;
                local_dc8 = puVar11;
                break;
              }
              puVar11 = puVar14 + 2;
            }
            local_dc8 = puVar11;
            if ((local_de4 <= puVar11) || (puVar14 = puVar11, 0x12 < (int)local_d8c)) break;
          }
          uVar4 = 0;
          uVar9 = (ushort)local_d9c;
          if ((puVar11 < local_de4) && ((int)local_d8c < 0x13)) {
            local_d90 = local_d8c;
            do {
              if ((*puVar11 < uVar12) || ((int)local_db4 < (int)(*puVar11 - 9))) break;
              uVar4 = uVar4 + 1;
              local_d90 = (ushort *)((int)local_d90 + 1);
              puVar15 = puVar11 + 1;
              if (uVar9 != 0) {
                if ((local_de4 <= puVar15) || (*puVar15 != uVar9)) break;
                puVar15 = puVar11 + 2;
              }
              if ((local_de4 <= puVar15) || (puVar11 = puVar15, 0x12 < (int)local_d90)) break;
            } while( true );
          }
          *(undefined *)local_db0 = 0xd;
          *(undefined *)((int)local_ddc + 1) = 2;
          *(char *)(local_ddc + 1) = (char)uVar4 + '\x02';
          local_ddc = (ushort *)((int)local_ddc + 3);
          *local_dd8 = *(undefined *)(local_dc4 + 1);
          local_dd8 = local_dd8 + 1;
          *local_dd4 = *(byte *)((int)local_dc4 + 3) & local_e18 & 0x3f;
          local_dd4 = local_dd4 + 1;
          puVar14 = local_dc8;
          if ((uVar4 & 1) != 0) {
            *(byte *)local_ddc = 0x20;
          }
          for (; 0 < (int)uVar4; uVar4 = uVar4 - 1) {
            bVar1 = (*(char *)puVar14 - (char)local_db4) + 2;
            if ((uVar4 & 1) == 0) {
              *(byte *)local_ddc = bVar1 * '\x10';
            }
            else {
              *(byte *)local_ddc = *(byte *)local_ddc | bVar1;
              local_ddc = (ushort *)((int)local_ddc + 1);
            }
            puVar11 = puVar14 + 1;
            if (uVar9 != 0) {
              puVar11 = puVar14 + 2;
            }
            puVar14 = puVar11;
          }
          *(byte *)local_ddc = -(char)local_d8c - 2;
          puVar15 = (ushort *)((int)local_ddc + 1);
          puVar11 = local_d8c;
          iVar3 = local_e20;
          local_ddc = puVar15;
          local_dc8 = puVar14 + -1;
          local_db0 = puVar15;
          if (uVar9 != 0) {
            puVar14 = puVar14 + -2;
LAB_6b84fc5f:
            local_dc8 = puVar14;
          }
        }
LAB_6b84ff1d:
        if (0x7a < (int)((int)local_dc8 - (int)local_e34 & 0xfffffffeU)) {
          FUN_6b84e554((int)&local_e24,(int)&local_e64,param_2);
          local_e34 = local_dc8;
          local_db0 = local_ddc;
          puVar11 = extraout_EDX_08;
          iVar3 = local_e20;
          puVar15 = local_ddc;
        }
        local_e5c = local_dd8;
        local_dc8 = local_dc8 + 1;
        local_e58 = local_dd4;
        local_e54 = local_dd0;
        local_e50 = local_dcc;
        param_5 = local_e38;
        local_e60 = puVar15;
      } while (local_dc8 < local_de4);
    }
    if (puVar15 != local_dfc) {
      FUN_6b84e554((int)&local_e24,(int)&local_e64,param_2);
      puVar11 = extraout_EDX_09;
    }
    uVar4 = (((uint)(local_e4c * -0x61c88647) >> 0x10 ^ local_e4c * -0x61c88647) + local_e48) *
            -0x61c88647;
    uVar4 = ((uVar4 >> 0x10 ^ uVar4) + local_e44) * -0x61c88647;
    uVar4 = ((uVar4 >> 0x10 ^ uVar4) + local_e40) * -0x61c88647;
    uVar4 = ((uVar4 >> 0x10 ^ uVar4) + local_e3c) * -0x61c88647;
    *param_5 = uVar4 ^ uVar4 >> 0x10;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,puVar11);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 __fastcall FUN_6b85003c(ushort *param_1,int param_2)

{
  ushort *puVar1;
  ushort uVar2;
  short sVar3;
  undefined4 uVar4;
  ushort uVar5;
  uint uVar6;
  bool bVar7;
  bool bVar8;
  
  if ((_DAT_6b8b082c == 0) || (DAT_6b8b0800 == 0)) {
    SetLastError(2);
LAB_6b8501e6:
    uVar4 = 0;
  }
  else {
    puVar1 = param_1 + param_2;
    if (param_1 < puVar1) {
      do {
        uVar2 = *param_1;
        uVar6 = (uint)uVar2;
        if (*(char *)(DAT_6b8b0800 + 1 + uVar6 * 4) == '\0') {
          if (uVar6 < 0x2010) {
            if (uVar6 < 0x200c) {
              if (uVar6 < 0x641) {
                if ((((uVar6 != 0x640) && (uVar6 != 0)) && (uVar6 != 0xad)) && (uVar6 != 0x34f))
                goto LAB_6b8501e6;
              }
              else if ((uVar6 != 0xecc) && (uVar6 != 0x1806)) {
                bVar7 = uVar6 - 0x180b < 2;
                bVar8 = uVar6 - 0x180b == 2;
                goto LAB_6b8501cc;
              }
            }
          }
          else if (uVar6 < 0x3192) {
            if (uVar6 < 0x3190) {
              if (uVar6 < 0x202a) goto LAB_6b8501e6;
              if (0x202e < uVar6) {
                if (uVar6 < 0x2060) goto LAB_6b8501e6;
                if (0x2064 < uVar6) {
                  bVar7 = uVar6 - 0x206a < 5;
                  bVar8 = uVar6 - 0x206a == 5;
                  goto LAB_6b8501cc;
                }
              }
            }
          }
          else {
            if (uVar6 == 0xdb40) {
              if (param_1 + 1 < puVar1) {
                sVar3 = 0x2300;
                uVar5 = 0xef;
                goto LAB_6b8501c6;
              }
              goto LAB_6b8501e6;
            }
            if (uVar6 < 0xfe00) goto LAB_6b8501e6;
            if (0xfe0f < uVar6) {
              if (0xfff8 < uVar6) {
                bVar7 = uVar2 < 0xfffd;
                bVar8 = uVar2 == 0xfffd;
                goto LAB_6b8501cc;
              }
              goto LAB_6b8501e6;
            }
          }
        }
        else {
          if ((((0xdfff < uVar2) && (uVar2 < 0xf900)) || ((0xdb7f < uVar2 && (uVar2 < 0xdc00)))) ||
             ((0xdbff < uVar2 && (uVar2 < 0xe000)))) goto LAB_6b8501e6;
          uVar5 = 0x3ff;
          if ((ushort)(uVar2 + 0x2800) < 0x400) {
            if (puVar1 <= param_1 + 1) goto LAB_6b8501e6;
            sVar3 = 0x2400;
LAB_6b8501c6:
            param_1 = param_1 + 1;
            bVar7 = (ushort)(sVar3 + *param_1) < uVar5;
            bVar8 = (ushort)(sVar3 + *param_1) == uVar5;
LAB_6b8501cc:
            if (!bVar7 && !bVar8) goto LAB_6b8501e6;
          }
        }
        param_1 = param_1 + 1;
      } while (param_1 < puVar1);
    }
    uVar4 = 1;
  }
  return uVar4;
}



undefined4 FUN_6b8501f0(undefined4 param_1,int param_2,int param_3,ushort *param_4,uint param_5)

{
  undefined4 uVar1;
  DWORD dwErrCode;
  
  if ((param_5 == 0) || (param_4 == (ushort *)0x0)) {
    dwErrCode = 0x57;
  }
  else {
    if (param_3 == 0) {
      if (0x7fffffff < param_5) {
        param_5 = FUN_6b8502c0((short *)param_4);
      }
      if (param_2 == 1) {
        uVar1 = FUN_6b85003c(param_4,param_5);
        return uVar1;
      }
    }
    dwErrCode = 0x3ec;
  }
  SetLastError(dwErrCode);
  return 0;
}



int __fastcall FUN_6b85023c(int param_1,ushort *param_2,int param_3)

{
  int iVar1;
  int iVar2;
  
  if (0 < param_3) {
    iVar1 = param_1 - (int)param_2;
    do {
      iVar2 = (uint)*(ushort *)(iVar1 + (int)param_2) - (uint)*param_2;
      if (iVar2 != 0) {
        return iVar2;
      }
      param_2 = param_2 + 1;
      param_3 = param_3 + -1;
    } while (0 < param_3);
  }
  return 0;
}



int __fastcall
FUN_6b85026b(ushort *param_1,ushort *param_2,int param_3,ushort param_4,ushort param_5,int param_6,
            int param_7)

{
  ushort uVar1;
  ushort *puVar2;
  
  if (param_6 != 0) {
    param_3 = param_3 + 1;
  }
  puVar2 = param_1;
  if (param_2 == (ushort *)0x0) {
    param_7 = 1;
  }
  for (; (((0 < param_3 && (puVar2 < param_2)) && ((uVar1 = *puVar2, uVar1 != 0 || (param_7 == 0))))
         && ((uVar1 <= param_5 && (param_4 <= uVar1)))); puVar2 = puVar2 + 1) {
    param_3 = param_3 + -1;
  }
  return (int)puVar2 - (int)param_1 >> 1;
}



int __fastcall FUN_6b8502c0(short *param_1)

{
  short *psVar1;
  short *psVar2;
  
  psVar1 = param_1;
  psVar2 = param_1;
  if (*param_1 != 0) {
    while ((((psVar2 = psVar1 + 1, *psVar2 != 0 && (psVar2 = psVar1 + 2, *psVar2 != 0)) &&
            (psVar2 = psVar1 + 3, *psVar2 != 0)) &&
           (((psVar2 = psVar1 + 4, *psVar2 != 0 && (psVar2 = psVar1 + 5, *psVar2 != 0)) &&
            ((psVar2 = psVar1 + 6, *psVar2 != 0 &&
             ((psVar2 = psVar1 + 7, *psVar2 != 0 && (psVar2 = psVar1 + 8, *psVar2 != 0))))))))) {
      psVar2 = psVar1 + 9;
      if ((*psVar2 == 0) ||
         (((((psVar2 = psVar1 + 10, *psVar2 == 0 || (psVar2 = psVar1 + 0xb, *psVar2 == 0)) ||
            (psVar2 = psVar1 + 0xc, *psVar2 == 0)) ||
           ((psVar2 = psVar1 + 0xd, *psVar2 == 0 || (psVar2 = psVar1 + 0xe, *psVar2 == 0)))) ||
          ((psVar2 = psVar1 + 0xf, *psVar2 == 0 ||
           (psVar2 = psVar1 + 0x10, psVar1 = psVar2, *psVar2 == 0)))))) break;
    }
  }
  return (int)psVar2 - (int)param_1 >> 1;
}



uint __fastcall FUN_6b850345(int param_1)

{
  uint uVar1;
  
  uVar1 = param_1 - 0x1100;
  if (0xff < uVar1) {
    if (param_1 - 0xa960U < 0x1d) {
      return param_1 - 0xa860;
    }
    uVar1 = param_1 - 0xd693;
    if (0x16 < param_1 - 0xd7b0U) {
      uVar1 = param_1 - 0xd697;
    }
  }
  return uVar1;
}



// WARNING: Could not reconcile some variable overlaps

int __fastcall
FUN_6b85037c(int param_1,ushort *param_2,ushort *param_3,undefined2 *param_4,byte *param_5)

{
  uint uVar1;
  uint uVar2;
  ushort uVar3;
  int iVar4;
  byte bVar5;
  ushort *puVar6;
  ushort *puVar7;
  undefined4 *puVar8;
  undefined4 local_2c;
  uint local_28;
  undefined4 local_24;
  undefined4 local_20;
  uint local_1c;
  undefined4 local_18;
  int local_14;
  uint local_10;
  ushort *local_c;
  
  local_2c = 0;
  local_24 = 0;
  local_20 = 0;
  puVar7 = param_2;
  if (param_2 < param_3) {
    iVar4 = 0;
    do {
      if ((5 < iVar4) || (*puVar7 == 0)) break;
      puVar7 = puVar7 + 1;
      iVar4 = iVar4 + 2;
    } while (puVar7 < param_3);
  }
  if (1 < (int)((int)puVar7 - (int)param_2 & 0xfffffffeU)) {
    uVar3 = *param_2;
    local_1c = (uint)uVar3;
    local_18 = 0x30;
    if ((((((0x10ff < uVar3) && (uVar3 < 0x1160)) || ((0xa95f < uVar3 && (uVar3 < 0xa97d)))) ||
         ((0x115f < uVar3 && (uVar3 < 0x11a8)))) || ((0xd7af < uVar3 && (uVar3 < 0xd7c7)))) ||
       (((0x11a7 < uVar3 && (uVar3 < 0x1200)) || ((ushort)(uVar3 + 0x2835) < 0x31)))) {
      if (((uVar3 < 0x1100) || (0x115f < uVar3)) && (0x1c < (ushort)(uVar3 + 0x56a0))) {
        uVar3 = 0x115f;
        puVar6 = param_2;
      }
      else {
        puVar6 = param_2 + 1;
      }
      local_10 = 1;
      local_28 = (uint)(uVar3 == 0x115f);
      puVar8 = &local_2c;
      local_14 = param_1;
      local_c = param_2;
      uVar1 = FUN_6b850345((uint)uVar3);
      FUN_6b850660(1,(byte *)(DAT_6b8b0820 + uVar1 * 8),(byte *)puVar8);
      if ((puVar6 < puVar7) &&
         (((uVar3 = *puVar6, 0x115f < uVar3 && (uVar3 < 0x11a8)) ||
          ((ushort)(uVar3 + 0x2850) < 0x17)))) {
        puVar6 = puVar6 + 1;
      }
      else {
        uVar3 = 0x1160;
      }
      if (uVar3 == 0x1160) {
        local_28 = 1;
      }
      puVar8 = &local_2c;
      uVar1 = FUN_6b850345((uint)uVar3);
      FUN_6b850660(2,(byte *)(DAT_6b8b0820 + uVar1 * 8),(byte *)puVar8);
      if (puVar6 < puVar7) {
        uVar3 = *puVar6;
        if (((0x11a7 < uVar3) && (uVar3 < 0x1200)) || ((ushort)(uVar3 + 0x2835) < 0x31)) {
          puVar8 = &local_2c;
          uVar1 = FUN_6b850345((uint)uVar3);
          FUN_6b850660(3,(byte *)(DAT_6b8b0820 + uVar1 * 8),(byte *)puVar8);
          puVar6 = puVar6 + 1;
        }
      }
      if ((char)local_2c == '\0') {
        local_2c = 0;
        local_28 = 0;
        local_24 = 0;
        local_20 = 0;
        puVar8 = &local_2c;
        uVar1 = FUN_6b850345(local_1c & 0xffff);
        FUN_6b850660(1,(byte *)(DAT_6b8b0820 + uVar1 * 8),(byte *)puVar8);
        puVar7 = local_c;
        puVar8 = &local_2c;
        puVar6 = local_c + 1;
        uVar1 = FUN_6b850345(0x1160);
        FUN_6b850660(2,(byte *)(DAT_6b8b0820 + uVar1 * 8),(byte *)puVar8);
      }
      else {
        local_10 = local_28;
        puVar7 = local_c;
      }
      uVar1 = (uint)(ushort)(((char)local_24 * 0x15 + (short)local_24._1_1_) * 0x1c +
                             (short)local_24._2_1_ + 0xac00);
      if (local_10 != 0) {
        uVar1 = uVar1 + 0xffff;
        if ((ushort)uVar1 < 0xac00) {
          uVar1 = 0x3260;
        }
        local_24._3_1_ = local_24._3_1_ + 0x80;
      }
      uVar2 = uVar1 & 0xffff;
      if (local_14 != 0) {
        uVar2 = *(int *)(local_14 + (uVar2 >> 8) * 4) + (uVar1 & 0xff);
        puVar7 = local_c;
      }
      *param_4 = *(undefined2 *)(DAT_6b8b0800 + uVar2 * 4);
      if (local_24._3_1_ < 3) {
        local_24._3_1_ = 2;
      }
      *param_5 = local_24._3_1_;
      if ((byte)local_20 < 3) {
        local_20._0_1_ = 2;
      }
      param_5[1] = (byte)local_20;
      bVar5 = 2;
      if (2 < local_20._1_1_) {
        bVar5 = local_20._1_1_;
      }
      param_5[2] = bVar5;
      return (int)puVar6 - (int)puVar7 >> 1;
    }
  }
  return 0;
}



void __fastcall FUN_6b850660(int param_1,byte *param_2,byte *param_3)

{
  byte bVar1;
  
  *param_3 = *param_3 | *param_2;
  if ((char)param_3[8] < (char)param_2[1]) {
    param_3[8] = param_2[1];
  }
  if ((char)param_3[9] < (char)param_2[2]) {
    param_3[9] = param_2[2];
  }
  if ((char)param_3[10] < (char)param_2[3]) {
    param_3[10] = param_2[3];
  }
  if (param_1 == 1) {
    bVar1 = param_2[4];
    if (param_3[0xb] <= bVar1 && bVar1 != param_3[0xb]) {
      param_3[0xb] = bVar1;
    }
  }
  else if (param_1 == 2) {
    bVar1 = param_2[4];
    if (param_3[0xc] <= bVar1 && bVar1 != param_3[0xc]) {
      param_3[0xc] = bVar1;
    }
  }
  else if ((param_1 == 3) && (bVar1 = param_2[4], param_3[0xd] <= bVar1 && bVar1 != param_3[0xd])) {
    param_3[0xd] = bVar1;
  }
  return;
}



void FUN_6b8506d0(undefined4 param_1,undefined **param_2,undefined4 param_3,int *param_4,
                 undefined4 param_5)

{
  code *pcVar1;
  undefined4 uVar2;
  undefined *puVar3;
  int iVar4;
  
  if (*param_4 < 0) {
    uVar2 = RtlNtStatusToDosError(*param_4);
  }
  else {
    uVar2 = 0;
  }
  iVar4 = param_4[1];
  puVar3 = param_2[3];
  pcVar1 = (code *)*param_2;
  _guard_check_icall();
  (*pcVar1)(param_1,puVar3,param_3,uVar2,iVar4,param_5);
  return;
}



void FUN_6b850710(int param_1,undefined4 param_2)

{
  code *pcVar1;
  undefined4 uVar2;
  
  pcVar1 = *(code **)(param_1 + 8);
  if (pcVar1 != (code *)0x0) {
    uVar2 = *(undefined4 *)(param_1 + 0xc);
    _guard_check_icall();
    (*pcVar1)(uVar2,param_2);
  }
  return;
}



void FUN_6b850740(undefined4 param_1,int param_2)

{
  code *pcVar1;
  int in_FS_OFFSET;
  undefined4 uVar2;
  
  uVar2 = *(undefined4 *)(param_2 + 0xc);
  pcVar1 = *(code **)(param_2 + 4);
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_2);
  if (pcVar1 != (code *)0x0) {
    _guard_check_icall();
    (*pcVar1)(param_1,uVar2);
  }
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 __fastcall FUN_6b85077a(undefined4 param_1,int param_2,int param_3,int *param_4)

{
  int *piVar1;
  undefined4 *in_FS_OFFSET;
  int iVar2;
  int local_58 [3];
  code *local_4c;
  undefined4 local_48;
  undefined4 local_44;
  code *local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  int local_28;
  int *local_24;
  undefined4 local_20 [3];
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b892028;
  uStack12 = 0x6b850786;
  local_24 = (int *)0x0;
  local_20[0] = 0;
  local_2c = param_1;
  local_28 = param_2;
  if (param_2 == 0) {
    SetLastError(0x57);
    RaiseException(0xc000000d,0,0,(ULONG_PTR *)0x0);
    local_20[0] = 0;
    goto LAB_6b85089f;
  }
  local_8 = (undefined *)0x0;
  local_30 = 1;
  local_24 = (int *)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),0,0x10);
  if (local_24 == (int *)0x0) {
    iVar2 = -0x3fffffe9;
LAB_6b850883:
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar2);
  }
  else {
    *local_24 = param_2;
    if (param_4 == (int *)0x0) {
      local_58[0] = 3;
      local_58[1] = 0;
      local_58[2] = 0;
      local_4c = (code *)0x0;
      local_48 = 0;
      local_44 = 0;
      local_40 = (code *)0x0;
      local_3c = 0;
      local_38 = 1;
      local_34 = 0x28;
    }
    else {
      piVar1 = local_58;
      for (iVar2 = 10; param_2 = local_28, iVar2 != 0; iVar2 = iVar2 + -1) {
        *piVar1 = *param_4;
        param_4 = param_4 + 1;
        piVar1 = piVar1 + 1;
      }
    }
    local_24[1] = (int)local_40;
    local_40 = FUN_6b850740;
    if ((local_58[2] == 0) || (local_4c == (code *)0x0)) {
      local_24[2] = 0;
    }
    else {
      local_24[2] = (int)local_4c;
      local_4c = FUN_6b850710;
    }
    *local_24 = param_2;
    local_24[3] = param_3;
    iVar2 = TpAllocIoCompletion(local_20,local_2c,FUN_6b8506d0,local_24,local_58);
    if (iVar2 < 0) {
      local_20[0] = 0;
      goto LAB_6b850883;
    }
  }
  local_8 = (undefined *)0xfffffffe;
  local_30 = 0;
  FUN_6b8508b6();
LAB_6b85089f:
  *in_FS_OFFSET = local_14;
  return local_20[0];
}



void FUN_6b8508b6(void)

{
  int unaff_EBX;
  int unaff_EBP;
  int unaff_ESI;
  int in_FS_OFFSET;
  
  if (((*(int *)(unaff_EBP + -0x2c) != unaff_EBX) || (*(int *)(unaff_EBP + -0x1c) == 0)) &&
     (unaff_ESI != 0)) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EBX,unaff_ESI);
  }
  return;
}



int __fastcall FUN_6b8508d7(int param_1,void *param_2,undefined **param_3)

{
  code *pcVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  
  iVar3 = 0;
  if (((param_1 != 0) && (*(int *)(param_1 + 0x20c) == -0x53f21255)) &&
     (*(int *)(param_1 + 0x208) == 0x11c0)) {
    uVar2 = (uint)*(ushort *)(param_1 + 0x214);
    uVar6 = 0;
    uVar5 = 0;
    pcVar1 = (code *)*param_3;
    _guard_check_icall();
    iVar3 = (*pcVar1)(uVar5,uVar6,uVar2);
    if (iVar3 != 0) {
      memmove(param_2,(void *)(param_1 + 0x218),0x1c8);
      pcVar1 = (code *)param_3[2];
      iVar4 = iVar3;
      _guard_check_icall();
      (*pcVar1)(iVar4,param_2);
    }
  }
  return iVar3;
}



undefined4 __fastcall FUN_6b850955(undefined4 param_1,undefined4 param_2,int param_3,int param_4)

{
  int iVar1;
  uint uVar2;
  void *pvVar3;
  undefined4 uVar4;
  int in_FS_OFFSET;
  undefined4 local_18;
  uint local_14;
  uint local_10;
  void *local_c;
  undefined4 *local_8;
  
  pvVar3 = (void *)0x0;
  local_8 = (undefined4 *)0x0;
  uVar4 = 0;
  local_14 = 0;
  local_10 = 0;
  local_c = (void *)0x0;
  local_18 = param_1;
  iVar1 = FUN_6b850a41(param_1,param_2,0x9008,(int *)&local_8,&local_14,param_4);
  if ((iVar1 != 0) &&
     (iVar1 = FUN_6b850a41(local_18,param_2,0x9009,(int *)&local_c,&local_10,param_4),
     pvVar3 = local_c, iVar1 != 0)) {
    uVar2 = local_10;
    if (0x2f < local_10) {
      uVar2 = 0x30;
    }
    *(uint *)(param_3 + 0x3c) = uVar2;
    memcpy((void *)(param_3 + 0x40),local_c,uVar2 << 4);
    if ((local_14 != 0) && (iVar1 = FUN_6b815764(local_8,&local_18), iVar1 != 0)) {
      *(undefined4 *)(param_3 + 0x38) = 5;
      *(undefined4 *)(param_3 + 0x18) = *local_8;
      *(undefined4 *)(param_3 + 0x1c) = local_8[1];
      *(undefined4 *)(param_3 + 0x20) = local_8[2];
      *(undefined4 *)(param_3 + 0x24) = local_8[3];
    }
    uVar4 = 1;
  }
  if (local_8 != (undefined4 *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_8);
    pvVar3 = local_c;
  }
  if (pvVar3 != (void *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pvVar3);
  }
  return uVar4;
}



undefined4 __fastcall
FUN_6b850a41(undefined4 param_1,undefined4 param_2,undefined4 param_3,int *param_4,uint *param_5,
            int param_6)

{
  code *pcVar1;
  int iVar2;
  int iVar3;
  undefined4 uVar4;
  int in_FS_OFFSET;
  uint *puVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 local_c;
  uint local_8;
  
  puVar5 = &local_8;
  pcVar1 = *(code **)(param_6 + 0xc);
  uVar4 = 0;
  uVar9 = 0;
  iVar3 = 0;
  local_8 = 0;
  uVar6 = param_1;
  uVar7 = param_2;
  uVar8 = param_3;
  _guard_check_icall();
  iVar2 = (*pcVar1)(uVar6,uVar7,uVar8,uVar9,puVar5);
  if (iVar2 != 0) {
    if (local_8 == 0) {
      uVar4 = 1;
      goto LAB_6b850aef;
    }
    iVar2 = FUN_6b850b02(&local_c,(int)((ulonglong)local_8 * 0x10),
                         (int)((ulonglong)local_8 * 0x10 >> 0x20));
    if (-1 < iVar2) {
      iVar3 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,local_c);
      if (iVar3 != 0) {
        puVar5 = &local_8;
        pcVar1 = *(code **)(param_6 + 0xc);
        iVar2 = iVar3;
        _guard_check_icall();
        iVar2 = (*pcVar1)(param_1,param_2,param_3,iVar2,puVar5);
        if (iVar2 != 0) {
          uVar4 = 1;
          goto LAB_6b850aef;
        }
      }
    }
  }
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iVar3);
  iVar3 = 0;
  local_8 = 0;
LAB_6b850aef:
  *param_4 = iVar3;
  *param_5 = local_8;
  return uVar4;
}



undefined4 __thiscall FUN_6b850b02(void *this,undefined4 param_1,int param_2)

{
  undefined4 uVar1;
  
  uVar1 = 0;
  if (param_2 != 0) {
    uVar1 = 0x80070216;
    param_1 = 0xffffffff;
  }
  *(undefined4 *)this = param_1;
  return uVar1;
}



void __fastcall FUN_6b850b28(uint param_1,uint param_2,void *param_3)

{
  FUN_6b850b02(param_3,(int)((ulonglong)param_1 * (ulonglong)param_2),
               (int)((ulonglong)param_1 * (ulonglong)param_2 >> 0x20));
  return;
}



void __fastcall
FUN_6b850b3f(undefined4 param_1,undefined4 param_2,uint param_3,short *param_4,uint param_5)

{
  uint uVar1;
  undefined8 uVar2;
  ushort local_410;
  ushort local_40e;
  undefined *local_40c;
  undefined local_408 [1024];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  if (param_5 < 0x200) {
    local_410 = (short)param_5 * 2;
    local_40c = local_408;
    local_40e = local_410;
    uVar2 = RtlIntegerToUnicodeString(param_1,param_2,&local_410);
    param_2 = (undefined4)((ulonglong)uVar2 >> 0x20);
    if (-1 < (int)uVar2) {
      for (uVar1 = (uint)(local_410 >> 1); uVar1 < param_3; uVar1 = uVar1 + 1) {
        if (param_5 == 0) goto LAB_6b850bd7;
        *param_4 = 0x30;
        param_4 = param_4 + 1;
        param_5 = param_5 - 1;
      }
      uVar2 = FUN_6b812c57(param_4,param_5,(int)local_40c);
      param_2 = (undefined4)((ulonglong)uVar2 >> 0x20);
    }
  }
LAB_6b850bd7:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



void __fastcall
FUN_6b850be7(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 local_c;
  undefined4 uStack8;
  
  local_c = param_1;
  uStack8 = param_1;
  RtlInitUnicodeString(&local_c,param_2);
  NtSetValueKey(param_1,&local_c,0,1,param_3,param_4);
  return;
}



uint __thiscall FUN_6b850c16(void *this,wchar_t *param_1)

{
  HMODULE hModule;
  FARPROC pFVar1;
  errno_t eVar2;
  uint uVar3;
  wchar_t *pwVar4;
  undefined4 uVar5;
  wchar_t *pwVar6;
  undefined4 uVar7;
  void *pvVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  
  hModule = LoadLibraryExW(L"ntdll.dll",(HANDLE)0x0,0x800);
  if ((hModule == (HMODULE)0x0) ||
     (pFVar1 = GetProcAddress(hModule,"RtlGetPersistedStateLocation"), pFVar1 == (FARPROC)0x0)) {
    uVar3 = 0x80004005;
  }
  else {
    uVar10 = 0;
    uVar9 = 0x20a;
    uVar7 = 1;
    uVar5 = 0;
    pwVar4 = L"Amcache";
    pwVar6 = param_1;
    pvVar8 = this;
    _guard_check_icall();
    uVar3 = (*pFVar1)(pwVar4,uVar5,pwVar6,uVar7,pvVar8,uVar9,uVar10);
    uVar3 = uVar3 | 0x10000000;
    if (-1 < (int)uVar3) {
      return uVar3;
    }
  }
  eVar2 = wcscpy_s((wchar_t *)this,0x105,param_1);
  return uVar3 & -(uint)(eVar2 != 0);
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __thiscall FUN_6b850c96(void *this,uint *param_1)

{
  wint_t wVar1;
  HMODULE hModule;
  FARPROC pFVar2;
  HANDLE pvVar3;
  BOOL BVar4;
  uint *puVar5;
  undefined4 extraout_EDX;
  uint uVar6;
  PBOOL pBVar7;
  int iVar8;
  uint *puVar9;
  uint uVar10;
  short *psVar11;
  uint **ppuVar12;
  PBOOL *Wow64Process;
  short local_21c [2];
  undefined4 local_218;
  uint *local_214;
  undefined4 local_210;
  uint local_18 [4];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_214 = param_1;
  memset(this,0,0x5a);
  memset(&local_210,0,0x208);
  puVar5 = local_214;
  uVar6 = 0;
  iVar8 = (int)&local_210 + 2;
  do {
    wVar1 = *(wint_t *)((int)puVar5 + (iVar8 - ((int)&local_210 + 2)));
    if (wVar1 == 0) break;
    wVar1 = towlower(wVar1);
    *(wint_t *)(iVar8 + -2) = wVar1;
    uVar6 = uVar6 + 1;
    iVar8 = iVar8 + 2;
  } while (uVar6 < 0x104);
  if (_DAT_6b8b09d4 != 0) goto LAB_6b850db0;
  pBVar7 = (PBOOL)&DAT_00000001;
  _DAT_6b8b09d4 = 1;
  hModule = GetModuleHandleW(L"kernel32");
  if ((hModule == (HMODULE)0x0) ||
     (pFVar2 = GetProcAddress(hModule,"IsWow64Process2"), pFVar2 == (FARPROC)0x0)) {
LAB_6b850d94:
    Wow64Process = &Wow64Process_6b8b0240;
    pvVar3 = GetCurrentProcess();
    BVar4 = IsWow64Process(pvVar3,(PBOOL)Wow64Process);
    if (BVar4 != 0) goto LAB_6b850db0;
  }
  else {
    ppuVar12 = &local_214;
    psVar11 = local_21c;
    pvVar3 = GetCurrentProcess();
    _guard_check_icall();
    iVar8 = (*pFVar2)(pvVar3,psVar11,ppuVar12);
    if (iVar8 == 0) goto LAB_6b850d94;
    pBVar7 = (PBOOL)(uint)(local_21c[0] != 0);
  }
  Wow64Process_6b8b0240 = pBVar7;
LAB_6b850db0:
  puVar5 = &local_210;
  if (Wow64Process_6b8b0240 == (PBOOL)0x0) {
    do {
      puVar9 = puVar5;
      local_214 = puVar9 + 3;
      puVar5 = puVar9 + 4;
    } while (puVar5 <= local_18);
    uVar6 = 0;
    for (puVar9 = puVar9 + 5; puVar9 <= &local_8; puVar9 = puVar9 + 1) {
      puVar5 = puVar9;
    }
    uVar10 = ~-(uint)(&local_8 < puVar5) & (int)&local_8 - (int)puVar5;
    if (uVar10 != 0) {
      do {
        uVar6 = uVar6 + 1;
      } while (uVar6 < uVar10);
    }
  }
  else {
    FUN_6b851335(&local_210,&local_218);
  }
  FUN_6b850f02((wchar_t *)this,0x2d,L"%.16ls|%I64x");
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,extraout_EDX);
  return;
}



int __cdecl FUN_6b850f02(wchar_t *param_1,uint param_2,wchar_t *param_3)

{
  int iVar1;
  
  iVar1 = 0;
  if ((param_2 == 0) || (0x7fffffff < param_2)) {
    iVar1 = -0x7ff8ffa9;
  }
  if (iVar1 < 0) {
    if (param_2 != 0) {
      *param_1 = L'\0';
    }
  }
  else {
    iVar1 = FUN_6b850f46(param_1,param_2,&stack0x00000010,param_3,&stack0x00000010);
  }
  return iVar1;
}



undefined4 __fastcall
FUN_6b850f46(wchar_t *param_1,int param_2,undefined4 param_3,wchar_t *param_4,va_list param_5)

{
  uint _Count;
  uint uVar1;
  undefined4 uVar2;
  
  _Count = param_2 - 1;
  uVar2 = 0;
  uVar1 = _vsnwprintf(param_1,_Count,param_4,param_5);
  if (((int)uVar1 < 0) || (_Count < uVar1)) {
    uVar2 = 0x8007007a;
  }
  else if (uVar1 != _Count) {
    return 0;
  }
  param_1[_Count] = L'\0';
  return uVar2;
}



void __fastcall FUN_6b850f86(int *param_1)

{
  int iVar1;
  uint uVar2;
  LSTATUS LVar3;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 extraout_EDX_04;
  undefined4 extraout_EDX_05;
  undefined4 extraout_EDX_06;
  undefined4 extraout_EDX_07;
  undefined4 extraout_EDX_08;
  undefined4 uVar4;
  char *pcVar5;
  DWORD local_694;
  HKEY local_690;
  HKEY local_68c;
  HKEY local_688;
  wchar_t local_684 [260];
  undefined local_47c [524];
  wchar_t local_270 [262];
  WCHAR local_64 [46];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  memset(local_47c,0,0x20a);
  memset(local_270,0,0x20a);
  local_690 = (HKEY)0x0;
  local_688 = (HKEY)0x0;
  local_68c = (HKEY)0x0;
  uVar4 = extraout_EDX;
  if ((param_1[1] != 0x20c) || (*param_1 != 1)) goto LAB_6b85122e;
  iVar1 = FUN_6b850c96(local_64,(uint *)param_1[2]);
  if (iVar1 < 0) {
    pcVar5 = "Failed to hash File path [%#x]";
    uVar4 = 0x79;
  }
  else {
    iVar1 = FUN_6b850f02(local_270,0x105,L"%s\\%s");
    if (iVar1 < 0) {
      pcVar5 = "StringCchPrintf for StoreDirectory [%#x]";
      uVar4 = 0x87;
    }
    else {
      uVar2 = FUN_6b850c16(local_47c,local_270);
      if ((int)uVar2 < 0) {
        pcVar5 = "AeGetPersistedLocation failed [%#x]";
        uVar4 = 0x92;
      }
      else {
        iVar1 = FUN_6b850f02(local_684,0x104,L"%s\\%s");
        if (-1 < iVar1) {
          LVar3 = RegLoadAppKeyW(local_684,&local_690,0x20019,0,0);
          if (LVar3 == 0) {
            LVar3 = RegOpenKeyExW(local_690,L"Root",0,0x20019,&local_68c);
            if (LVar3 == 0) {
              LVar3 = RegOpenKeyExW(local_68c,L"InventoryApplicationFile",0,0x20019,&local_688);
              if (LVar3 == 0) {
                local_694 = 0x100;
                LVar3 = RegGetValueW(local_688,local_64,L"ProgramId",2,(LPDWORD)0x0,param_1 + 3,
                                     &local_694);
                if ((LVar3 != 0) && (LVar3 != 2)) {
                  FUN_6b8671a2(3,"AeWERQueryFileInfo",0xd7,"Failed to get program id [%d]");
                }
                local_694 = 0x100;
                LVar3 = RegGetValueW(local_688,local_64,L"FileId",2,(LPDWORD)0x0,param_1 + 0x43,
                                     &local_694);
                uVar4 = extraout_EDX_04;
                if ((LVar3 != 0) && (LVar3 != 2)) {
                  FUN_6b8671a2(3,"AeWERQueryFileInfo",0xea,"Failed to get file id [%d]");
                  uVar4 = extraout_EDX_05;
                }
                goto LAB_6b85122e;
              }
              uVar4 = extraout_EDX_03;
              if (LVar3 == 2) goto LAB_6b85122e;
              pcVar5 = "Failed to open file key [%d]";
              uVar4 = 0xc2;
            }
            else {
              uVar4 = extraout_EDX_02;
              if (LVar3 == 2) goto LAB_6b85122e;
              pcVar5 = "Failed to open file key [%d]";
              uVar4 = 0xb8;
            }
          }
          else {
            pcVar5 = "RegLoadAppKey failed [%d]";
            uVar4 = 0xab;
          }
          FUN_6b8671a2(1,"AeWERQueryFileInfo",uVar4,pcVar5);
          uVar4 = extraout_EDX_01;
          goto LAB_6b85122e;
        }
        pcVar5 = "StringCchPrintf [%#x]";
        uVar4 = 0xa0;
      }
    }
  }
  FUN_6b8671a2(1,"AeWERQueryFileInfo",uVar4,pcVar5);
  uVar4 = extraout_EDX_00;
LAB_6b85122e:
  if (local_688 != (HKEY)0x0) {
    RegCloseKey(local_688);
    uVar4 = extraout_EDX_06;
  }
  if (local_68c != (HKEY)0x0) {
    RegCloseKey(local_68c);
    uVar4 = extraout_EDX_07;
  }
  if (local_690 != (HKEY)0x0) {
    RegCloseKey(local_690);
    uVar4 = extraout_EDX_08;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar4);
  return;
}



void __fastcall FUN_6b85127b(uint *param_1)

{
  undefined4 extraout_EDX;
  undefined4 uVar1;
  undefined8 uVar2;
  undefined local_3c [4];
  undefined4 local_38;
  undefined4 local_34;
  undefined *local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  int local_20;
  undefined4 local_1c;
  int local_18;
  int local_14;
  int local_10;
  undefined4 uStack12;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_38 = 0x18;
  local_20 = 0;
  local_34 = 0;
  local_28 = 0;
  local_24 = 0;
  local_2c = 0x40;
  local_30 = &DAT_6b8807a4;
  uVar2 = NtOpenKey(&local_20,0x101,&local_38);
  uVar1 = (undefined4)((ulonglong)uVar2 >> 0x20);
  if (-1 < (int)uVar2) {
    local_1c = 0;
    local_18 = 0;
    local_14 = 0;
    local_10 = 0;
    uStack12 = 0;
    uVar2 = NtQueryValueKey(local_20,&DAT_6b88079c,2,&local_1c,0x14,local_3c);
    uVar1 = (undefined4)((ulonglong)uVar2 >> 0x20);
    if (((-1 < (int)uVar2) && (local_18 == 4)) && (local_14 == 4)) {
      *param_1 = (uint)(local_10 == 1);
    }
  }
  if (local_20 != 0) {
    NtClose(local_20);
    uVar1 = extraout_EDX;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar1);
  return;
}



void __fastcall FUN_6b851335(uint *param_1,undefined4 *param_2)

{
  ulonglong uVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  uint *puVar4;
  uint uVar5;
  longlong lVar6;
  longlong lVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  uint *local_8;
  
  uVar2 = 0x52bc33fedbe4cbb5;
  uVar8 = 0x52bc33fedbe4cbb5;
  uVar10 = 0x52bc33fedbe4cbb5;
  uVar9 = 0x52bc33fedbe4cbb5;
  local_8 = param_1;
  do {
    puVar4 = local_8;
    lVar6 = uVar2 + ((ulonglong)*puVar4 * 0xd6d018f5 & 0xffffffff |
                    (ulonglong)
                    (puVar4[1] * -0x292fe70b + (int)((ulonglong)*puVar4 * 0xd6d018f5 >> 0x20)) <<
                    0x20);
    lVar6 = FUN_6b85181e(0x1d,(uint)lVar6,(uint)((ulonglong)lVar6 >> 0x20));
    uVar2 = lVar6 + uVar10;
    lVar6 = uVar8 + ((ulonglong)puVar4[2] * 0xa2aa033b & 0xffffffff |
                    (ulonglong)
                    (puVar4[3] * -0x5d55fcc5 + (int)((ulonglong)puVar4[2] * 0xa2aa033b >> 0x20)) <<
                    0x20);
    lVar6 = FUN_6b85181e(0x1d,(uint)lVar6,(uint)((ulonglong)lVar6 >> 0x20));
    uVar8 = lVar6 + uVar9;
    lVar6 = uVar10 + ((ulonglong)puVar4[4] * 0x62992fc1 & 0xffffffff |
                     (ulonglong)
                     (puVar4[5] * 0x62992fc1 + (int)((ulonglong)puVar4[4] * 0x62992fc1 >> 0x20)) <<
                     0x20);
    lVar6 = FUN_6b85181e(0x1d,(uint)lVar6,(uint)((ulonglong)lVar6 >> 0x20));
    uVar10 = uVar2 + lVar6;
    local_8 = puVar4 + 8;
    lVar6 = uVar9 + ((ulonglong)puVar4[6] * 0x30bc5b29 & 0xffffffff |
                    (ulonglong)
                    (puVar4[7] * 0x30bc5b29 + (int)((ulonglong)puVar4[6] * 0x30bc5b29 >> 0x20)) <<
                    0x20);
    lVar6 = FUN_6b85181e(0x1d,(uint)lVar6,(uint)((ulonglong)lVar6 >> 0x20));
    uVar9 = uVar8 + lVar6;
  } while (local_8 <= param_1 + 0x7a);
  uVar1 = (uVar9 + uVar2 & 0xffffffff) * 0xd6d018f5;
  lVar6 = uVar8 + (uVar1 & 0xffffffff |
                  (ulonglong)
                  (uint)((int)(uVar9 + uVar2 >> 0x20) * -0x292fe70b + (int)(uVar1 >> 0x20)) << 0x20)
  ;
  lVar6 = FUN_6b85181e(0x25,(uint)lVar6,(uint)((ulonglong)lVar6 >> 0x20));
  uVar10 = lVar6 * -0x5d55fcc5 ^ uVar10;
  uVar1 = (uVar10 + uVar8 & 0xffffffff) * 0xa2aa033b;
  lVar6 = uVar2 + (uVar1 & 0xffffffff |
                  (ulonglong)
                  (uint)((int)(uVar10 + uVar8 >> 0x20) * -0x5d55fcc5 + (int)(uVar1 >> 0x20)) << 0x20
                  );
  lVar6 = FUN_6b85181e(0x25,(uint)lVar6,(uint)((ulonglong)lVar6 >> 0x20));
  uVar9 = lVar6 * -0x292fe70b ^ uVar9;
  uVar3 = uVar9 + uVar8;
  uVar1 = (uVar3 & 0xffffffff) * 0xa2aa033b;
  lVar6 = uVar10 + (uVar1 & 0xffffffff |
                   (ulonglong)(uint)((int)(uVar3 >> 0x20) * -0x5d55fcc5 + (int)(uVar1 >> 0x20)) <<
                   0x20);
  lVar7 = FUN_6b85181e(0x25,(uint)lVar6,(uint)((ulonglong)lVar6 >> 0x20));
  lVar6 = uVar9 + ((uVar10 + uVar2 & 0xffffffff) * 0xd6d018f5 & 0xffffffff |
                  (uVar10 + uVar2) * -0x292fe70b & 0xffffffff00000000);
  lVar6 = FUN_6b85181e(0x25,(uint)lVar6,(uint)((ulonglong)lVar6 >> 0x20));
  uVar2 = (lVar6 * -0x5d55fcc5 ^ lVar7 * -0x292fe70b ^ uVar2 ^ uVar8) + 0x52bc33fedbe4cbb5;
  if (0xf < (int)param_1 + (0x208 - (int)local_8)) {
    lVar6 = uVar2 + ((ulonglong)*local_8 * 0x62992fc1 & 0xffffffff |
                    (ulonglong)
                    (puVar4[9] * 0x62992fc1 + (int)((ulonglong)*local_8 * 0x62992fc1 >> 0x20)) <<
                    0x20);
    uVar8 = FUN_6b85181e(0x1d,(uint)lVar6,(uint)((ulonglong)lVar6 >> 0x20));
    local_8 = puVar4 + 0xc;
    lVar6 = uVar2 + ((ulonglong)puVar4[10] * 0x62992fc1 & 0xffffffff |
                    (ulonglong)
                    (puVar4[0xb] * 0x62992fc1 + (int)((ulonglong)puVar4[10] * 0x62992fc1 >> 0x20))
                    << 0x20);
    uVar9 = FUN_6b85181e(0x1d,(uint)lVar6,(uint)((ulonglong)lVar6 >> 0x20));
    uVar10 = (uVar9 & 0xffffffff) * 0x30bc5b29;
    uVar5 = (int)(uVar9 >> 0x20) * 0x30bc5b29 + (int)(uVar10 >> 0x20);
    lVar6 = ((uVar8 & 0xffffffff) * 0x30bc5b29 & 0xffffffff) * 0xd6d018f5;
    lVar7 = FUN_6b85181e(0x15,(uint)lVar6,
                         (int)(uVar8 * 0x30bc5b29 >> 0x20) * -0x292fe70b +
                         (int)((ulonglong)lVar6 >> 0x20));
    lVar6 = (uVar10 & 0xffffffff) * 0x30bc5b29;
    lVar6 = FUN_6b85181e(0x15,(uint)lVar6,uVar5 * 0x30bc5b29 + (int)((ulonglong)lVar6 >> 0x20));
    lVar6 = (lVar7 + (uVar10 & 0xffffffff | (ulonglong)uVar5 << 0x20) ^ uVar8 * 0x30bc5b29) + lVar6;
    uVar2 = uVar2 + CONCAT44((uint)((ulonglong)lVar6 >> 0x20) ^ uVar5,(uint)lVar6 ^ (uint)uVar10);
  }
  if (7 < (int)param_1 + (0x208 - (int)local_8)) {
    uVar2 = uVar2 + ((ulonglong)*local_8 * 0x30bc5b29 & 0xffffffff |
                    (ulonglong)
                    (local_8[1] * 0x30bc5b29 + (int)((ulonglong)*local_8 * 0x30bc5b29 >> 0x20)) <<
                    0x20);
    local_8 = local_8 + 2;
    lVar6 = FUN_6b85181e(0x37,(uint)uVar2,(uint)(uVar2 >> 0x20));
    uVar2 = uVar2 ^ lVar6 * -0x5d55fcc5;
  }
  if (3 < (int)param_1 + (0x208 - (int)local_8)) {
    uVar2 = uVar2 + (ulonglong)*local_8 * 0x30bc5b29;
    local_8 = local_8 + 1;
    lVar6 = FUN_6b85181e(0x1a,(uint)uVar2,(uint)(uVar2 >> 0x20));
    uVar2 = uVar2 ^ lVar6 * -0x5d55fcc5;
  }
  if (1 < (int)param_1 + (0x208 - (int)local_8)) {
    uVar2 = uVar2 + (ulonglong)*(ushort *)local_8 * 0x30bc5b29;
    local_8 = (uint *)((int)local_8 + 2);
    lVar6 = FUN_6b85181e(0x30,(uint)uVar2,(uint)(uVar2 >> 0x20));
    uVar2 = uVar2 ^ lVar6 * -0x5d55fcc5;
  }
  if (0 < (int)param_1 + (0x208 - (int)local_8)) {
    uVar2 = uVar2 + (ulonglong)*(byte *)local_8 * 0x30bc5b29;
    lVar6 = FUN_6b85181e(0x25,(uint)uVar2,(uint)(uVar2 >> 0x20));
    uVar2 = uVar2 ^ lVar6 * -0x5d55fcc5;
  }
  uVar10 = FUN_6b85181e(0x1c,(uint)uVar2,(uint)(uVar2 >> 0x20));
  uVar2 = (uVar2 ^ uVar10) * -0x292fe70b;
  uVar10 = FUN_6b85181e(0x1d,(uint)uVar2,(uint)(uVar2 >> 0x20));
  *param_2 = (int)(uVar2 ^ uVar10);
  param_2[1] = (int)((uVar2 ^ uVar10) >> 0x20);
  return;
}



undefined8 __thiscall FUN_6b85181e(byte param_1,uint param_2,uint param_3)

{
  uint uVar1;
  uint uVar2;
  byte bVar3;
  
  uVar2 = param_3;
  if ((param_1 & 0x20) != 0) {
    uVar2 = param_2;
    param_2 = param_3;
  }
  bVar3 = param_1 & 0x1f;
  uVar1 = param_2;
  if (bVar3 != 0) {
    uVar1 = param_2 >> bVar3 | uVar2 << 0x20 - bVar3;
    uVar2 = uVar2 >> bVar3 | param_2 << 0x20 - bVar3;
  }
  return CONCAT44(uVar2,uVar1);
}



int * BaseFormatTimeOut(int *param_1,uint param_2)

{
  int iVar1;
  
                    // 0x51860  60  BaseFormatTimeOut
  if (param_2 == 0xffffffff) {
    param_1 = (int *)0x0;
  }
  else {
    iVar1 = (int)((ulonglong)param_2 * 10000);
    *param_1 = -iVar1;
    param_1[1] = -((int)((ulonglong)param_2 * 10000 >> 0x20) + (uint)(iVar1 != 0));
  }
  return param_1;
}



void __fastcall FUN_6b85188d(int **param_1,int **param_2)

{
  int *piVar1;
  DWORD DVar2;
  int **ppiVar3;
  int iVar4;
  int **extraout_EDX;
  int **extraout_EDX_00;
  int **extraout_EDX_01;
  int **ppiVar5;
  int *piVar6;
  int in_FS_OFFSET;
  undefined8 uVar7;
  size_t local_214;
  WCHAR local_210 [260];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_214 = 0;
  iVar4 = 0x1c;
  if ((param_1 != (int **)0x0) && (piVar1 = param_1[1], -1 < (int)piVar1)) {
    ppiVar5 = param_2;
    if ((*param_1 != (int *)0x0) ||
       ((((uint)piVar1 & 7) == 0 || (((uint)piVar1 & 0x7ffffff8) != 0)))) goto LAB_6b851a32;
    if (((uint)piVar1 & 2) != 0) {
      if ((((int *)0xffff < param_1[3]) ||
          (DVar2 = GetModuleFileNameW((HMODULE)param_1[2],local_210,0x104), ppiVar5 = extraout_EDX,
          DVar2 == 0)) || (DVar2 == 0x104)) goto LAB_6b851a32;
      local_214 = DVar2 * 2 + 2;
      iVar4 = (int)param_1[4] * 8 + 0x1c + (DVar2 * 2 + 5 & 0xfffffffc);
    }
  }
  uVar7 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iVar4);
  ppiVar5 = (int **)((ulonglong)uVar7 >> 0x20);
  ppiVar3 = (int **)uVar7;
  if (ppiVar3 != (int **)0x0) {
    if ((param_1 == (int **)0x0) || ((int)param_1[1] < 0)) {
      *ppiVar3 = (int *)0x0;
      ppiVar3[1] = (int *)0x80000000;
      param_1 = ppiVar5;
    }
    else {
      *ppiVar3 = *param_1;
      piVar1 = param_1[1];
      ppiVar3[1] = piVar1;
      if (((uint)piVar1 & 1) == 0) {
        ppiVar5 = ppiVar3 + 7;
        memcpy(ppiVar5,local_210,local_214);
        ppiVar3[3] = (int *)ppiVar5;
        *(short *)((int)ppiVar3 + 10) = (short)local_214;
        *(short *)(ppiVar3 + 2) = (short)local_214 + -2;
        *(undefined2 *)(ppiVar3 + 4) = *(undefined2 *)(param_1 + 3);
        piVar1 = param_1[4];
        ppiVar3[5] = piVar1;
        piVar6 = (int *)0x0;
        ppiVar3[6] = (int *)(local_214 + 3 + (int)ppiVar5 & 0xfffffffc);
        if (piVar1 != (int *)0x0) {
          do {
            iVar4 = FUN_6b82157b(ppiVar3[6] + (int)piVar6 * 2,(void *)param_1[5][(int)piVar6]);
            if (iVar4 < 0) goto LAB_6b851987;
            piVar6 = (int *)((int)piVar6 + 1);
          } while (piVar6 < ppiVar3[5]);
        }
      }
      else {
        iVar4 = FUN_6b82157b(ppiVar3 + 2,param_1[2]);
        if ((iVar4 < 0) || (param_1 = extraout_EDX_00, *(short *)(ppiVar3 + 2) == 0)) {
LAB_6b851987:
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,ppiVar3);
          ppiVar5 = extraout_EDX_01;
          goto LAB_6b851a32;
        }
      }
    }
    *param_2 = (int *)ppiVar3;
    ppiVar5 = param_1;
  }
LAB_6b851a32:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,ppiVar5);
  return;
}



undefined4 BasepAnsiStringToDynamicUnicodeString(undefined4 param_1,undefined4 param_2)

{
  int iVar1;
  undefined local_c [8];
  
                    // 0x51a50  79  BasepAnsiStringToDynamicUnicodeString
  iVar1 = RtlInitAnsiStringEx(local_c,param_2);
  if (-1 < iVar1) {
    iVar1 = RtlAnsiStringToUnicodeString(param_1,local_c,1);
    if (-1 < iVar1) {
      return 1;
    }
    if (iVar1 != -0x7ffffffb) {
      BaseSetLastNTError(iVar1);
      return 0;
    }
  }
  RtlSetLastWin32Error(0xce);
  return 0;
}



undefined4 BaseVerifyUnicodeString(ushort *param_1)

{
  ushort uVar1;
  char cVar2;
  
                    // 0x51ab0  75  BaseVerifyUnicodeString
  uVar1 = param_1[1];
  if (*(int *)(param_1 + 2) == 0) {
    if ((uVar1 == 0) && (*param_1 == 0)) {
      return 0;
    }
  }
  else if ((((uVar1 != 0) && (*param_1 <= uVar1)) && (((*param_1 | uVar1) & 1) == 0)) &&
          (cVar2 = CsrVerifyRegion(*(int *)(param_1 + 2),uVar1), cVar2 != '\0')) {
    return 0;
  }
  return 0xc0000022;
}



int BasepAllocateActivationContextActivationBlock
              (uint param_1,uint param_2,uint param_3,uint **param_4)

{
  int iVar1;
  undefined4 *puVar2;
  uint *puVar3;
  int in_FS_OFFSET;
  uint local_c;
  uint local_8;
  
                    // 0x51b10  78  BasepAllocateActivationContextActivationBlock
  local_c = 0;
  local_8 = 0;
  if (param_4 != (uint **)0x0) {
    *param_4 = (uint *)0x0;
  }
  if ((param_1 & 0xfffffffc) != 0) {
    return -0x3fffff11;
  }
  if (param_4 == (uint **)0x0) {
    return -0x3fffff0e;
  }
  iVar1 = RtlQueryInformationActivationContext(1,0,0,1,&local_c,8,0);
  if (iVar1 < 0) {
    DbgPrintEx(0x33,0,"SXS: %s - Failure getting active activation context; ntstatus %08lx\n",
               "BasepAllocateActivationContextActivationBlock",iVar1);
  }
  else {
    if ((local_8 & 1) != 0) {
      RtlReleaseActivationContext(local_c);
      local_c = 0;
    }
    if (((param_1 & 2) == 0) || (local_c != 0)) {
      puVar2 = (undefined4 *)KernelBaseGetGlobalData();
      puVar3 = (uint *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar2
                                       ,0x10);
      *param_4 = puVar3;
      if (puVar3 == (uint *)0x0) {
        iVar1 = -0x3fffffe9;
        goto LAB_6b851beb;
      }
      *puVar3 = 0;
      (*param_4)[3] = local_c;
      local_c = 0;
      if ((param_1 & 1) != 0) {
        **param_4 = **param_4 | 1;
      }
      (*param_4)[1] = param_2;
      (*param_4)[2] = param_3;
    }
    iVar1 = 0;
  }
LAB_6b851beb:
  if (local_c != 0) {
    RtlReleaseActivationContext(local_c);
  }
  return iVar1;
}



void BasepFreeActivationContextActivationBlock(int param_1)

{
  int in_FS_OFFSET;
  
                    // 0x51c10  88  BasepFreeActivationContextActivationBlock
  if (param_1 != 0) {
    if (*(int *)(param_1 + 0xc) != 0) {
      RtlReleaseActivationContext(*(undefined4 *)(param_1 + 0xc));
      *(undefined4 *)(param_1 + 0xc) = 0;
    }
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1);
  }
  return;
}



uint BasepMapModuleHandle(uint param_1,char param_2)

{
  int in_FS_OFFSET;
  
                    // 0x51c50  96  BasepMapModuleHandle
  if (param_1 == 0) {
    param_1 = *(uint *)(*(int *)(in_FS_OFFSET + 0x30) + 8);
  }
  else if (((param_1 & 3) != 0) && (param_2 == '\0')) {
    param_1 = 0;
  }
  return param_1;
}



// WARNING: Function: __SEH_prolog4_GS replaced with injection: SEH_prolog4

DWORD GetLongPathNameA(LPCSTR lpszShortPath,LPSTR lpszLongPath,DWORD cchBuffer)

{
  DWORD _Size;
  int iVar1;
  DWORD DVar2;
  int *piVar3;
  LPWSTR lpszLongPath_00;
  code *pcVar4;
  undefined4 *in_FS_OFFSET;
  short local_254 [2];
  LPWSTR local_250;
  DWORD local_24c;
  DWORD local_248;
  ushort local_244 [2];
  void *local_240;
  LPSTR local_23c;
  undefined local_238 [2];
  short local_236;
  LPCWSTR local_234;
  LPWSTR local_230;
  DWORD local_22c;
  WCHAR local_228 [266];
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x51c80  625  GetLongPathNameA
  local_8 = &DAT_6b892048;
  uStack12 = 0x6b851c8f;
  local_23c = lpszLongPath;
  local_230 = (LPWSTR)0x0;
  if (lpszShortPath == (LPCSTR)0x0) {
    RtlSetLastWin32Error(0x57);
    _Size = 0;
  }
  else {
    local_240 = (void *)0x0;
    local_234 = (LPCWSTR)0x0;
    _Size = 0;
    local_22c = 0;
    local_8 = (undefined *)0x0;
    iVar1 = Basep8BitStringToDynamicUnicodeString(local_238,lpszShortPath);
    if (iVar1 != 0) {
      lpszLongPath_00 = local_228;
      local_230 = lpszLongPath_00;
      DVar2 = GetLongPathNameW(local_234,lpszLongPath_00,0x104);
      local_24c = DVar2;
      local_248 = DVar2;
      if (0x103 < DVar2) {
        piVar3 = (int *)KernelBaseGetGlobalData();
        lpszLongPath_00 =
             (LPWSTR)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),*piVar3 + 0x200000,
                                     local_248 * 2);
        local_230 = lpszLongPath_00;
        if (lpszLongPath_00 == (LPWSTR)0x0) {
          RtlSetLastWin32Error(8);
          DVar2 = 0;
          _Size = local_22c;
        }
        else {
          DVar2 = GetLongPathNameW(local_234,lpszLongPath_00,local_24c);
          _Size = local_22c;
        }
      }
      if (DVar2 != 0) {
        local_254[0] = (short)DVar2 * 2;
        local_236 = local_254[0] + 2;
        local_250 = lpszLongPath_00;
        pcVar4 = (code *)GetUnicodeStringToEightBitStringRoutine(local_244,local_254,1);
        _guard_check_icall();
        iVar1 = (*pcVar4)();
        if (iVar1 < 0) {
          BaseSetLastNTError(iVar1);
          _Size = 0;
          local_22c = _Size;
        }
        else {
          _Size = (DWORD)local_244[0];
          if ((local_23c == (LPSTR)0x0) || (cchBuffer <= _Size)) {
            _Size = _Size + 1;
            local_22c = _Size;
          }
          else {
            local_22c = _Size;
            memmove(local_23c,local_240,_Size);
            local_23c[_Size] = '\0';
          }
        }
      }
    }
    local_8 = (undefined *)0xfffffffe;
    FUN_6b851e2b();
  }
  *in_FS_OFFSET = local_14;
  return _Size;
}



void FUN_6b851e2b(void)

{
  undefined4 unaff_EBX;
  int unaff_EBP;
  int unaff_EDI;
  int in_FS_OFFSET;
  
  if (*(int *)(unaff_EBP + -0x230) != 0) {
    RtlFreeUnicodeString(unaff_EBP + -0x234);
  }
  if (*(int *)(unaff_EBP + -0x23c) != 0) {
    RtlFreeAnsiString(unaff_EBP + -0x240);
  }
  if ((unaff_EDI != 0) && (unaff_EDI != unaff_EBP + -0x224)) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EBX,unaff_EDI);
  }
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

int FUN_6b851e80(LPTHREAD_START_ROUTINE param_1,LPVOID param_2,HANDLE *param_3)

{
  HANDLE pvVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined4 *in_FS_OFFSET;
  undefined4 local_3c [7];
  int local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b892068;
  uStack12 = 0x6b851e8c;
  puVar3 = local_3c;
  for (iVar2 = 7; iVar2 != 0; iVar2 = iVar2 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  iVar2 = 0;
  local_20 = 0;
  RtlActivateActivationContextUnsafeFast();
  local_8 = (undefined *)0x0;
  pvVar1 = CreateRemoteThread((HANDLE)0xffffffff,(LPSECURITY_ATTRIBUTES)0x0,0,param_1,param_2,4,
                              (LPDWORD)0x0);
  *param_3 = pvVar1;
  if (pvVar1 == (HANDLE)0x0) {
    iVar2 = *(int *)(in_FS_OFFSET[6] + 0xbf4);
    local_20 = iVar2;
    if (-1 < iVar2) {
      iVar2 = -0x3fffffff;
      local_20 = -0x3fffffff;
    }
  }
  local_8 = (undefined *)0xfffffffe;
  FUN_6b851f13();
  *in_FS_OFFSET = local_14;
  return iVar2;
}



void FUN_6b851f13(void)

{
  RtlDeactivateActivationContextUnsafeFast();
  return;
}



void FUN_6b851f20(undefined4 param_1)

{
  code *pcVar1;
  
  RtlExitUserThread(param_1);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



uint __fastcall FUN_6b851f2f(undefined4 param_1,ushort param_2)

{
  int iVar1;
  int iVar2;
  code *pcVar3;
  ushort local_14;
  ushort local_12;
  undefined4 local_10;
  undefined4 local_c;
  uint local_8;
  
  local_c = param_1;
  iVar1 = KernelBaseGetGlobalData();
  iVar2 = KernelBaseGetGlobalData();
  iVar1 = RtlUnicodeToMultiByteSize
                    (&local_8,*(undefined4 *)(iVar2 + 0xc),*(undefined2 *)(iVar1 + 10));
  if (-1 < iVar1) {
    if (param_2 < (ushort)local_8) {
      return local_8;
    }
    local_10 = local_c;
    local_12 = param_2;
    iVar1 = KernelBaseGetGlobalData();
    pcVar3 = (code *)GetUnicodeStringToEightBitStringRoutine(&local_14,iVar1 + 8,0);
    _guard_check_icall();
    iVar1 = (*pcVar3)();
    if (-1 < iVar1) {
      return (uint)local_14;
    }
  }
  return 0;
}



void __fastcall FUN_6b851faf(int param_1,undefined4 param_2)

{
  undefined8 uVar1;
  undefined local_220 [8];
  undefined4 local_218 [132];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  if (param_1 != 0) {
    uVar1 = NtQueryInformationFile(param_1,local_220,local_218,0x210,9);
    param_2 = (undefined4)((ulonglong)uVar1 >> 0x20);
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



// WARNING: Removing unreachable block (ram,0x6b81b6cb)
// WARNING: Removing unreachable block (ram,0x6b81b674)
// WARNING: Removing unreachable block (ram,0x6b81b69e)
// WARNING: Removing unreachable block (ram,0x6b81b6b7)

UINT GetAtomNameA(ATOM nAtom,LPSTR lpBuffer,int nSize)

{
  uint uVar1;
  undefined4 *puVar2;
  LPSTR pCVar3;
  int iVar4;
  UINT UVar5;
  int in_FS_OFFSET;
  undefined2 in_stack_00000006;
  short sStack44;
  short sStack42;
  LPSTR pCStack40;
  ushort uStack36;
  undefined2 uStack34;
  LPSTR pCStack32;
  int iStack28;
  LPSTR pCStack24;
  uint uStack20;
  uint uStack16;
  undefined4 uStack12;
  char cStack5;
  
                    // 0x52020  450  GetAtomNameA
  cStack5 = '\0';
  uStack12 = 0;
  UVar5 = 0;
  uStack16 = 0;
  uStack20 = nSize;
  if (0x7000 < (uint)nSize) {
    uStack20 = 0x7000;
  }
  if (uStack20 == 0) {
    iVar4 = -0x7ffffffb;
  }
  else {
    uVar1 = uStack20 * 2;
    puVar2 = (undefined4 *)KernelBaseGetGlobalData();
    pCVar3 = (LPSTR)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar2,
                                    uVar1);
    if (pCVar3 == (LPSTR)0x0) {
      iVar4 = -0x3fffffe9;
    }
    else {
      pCStack24 = pCVar3;
      uStack16 = uVar1;
      iVar4 = FUN_6b81bb24(&iStack28);
      if ((-1 < iVar4) &&
         (iVar4 = RtlQueryAtomInAtomTable(iStack28,_nAtom,0,0,pCStack24,&uStack16), uVar1 = uStack16
         , -1 < iVar4)) {
        if (cStack5 == '\0') {
          pCStack40 = pCStack24;
          sStack44 = (short)uStack16;
          sStack42 = sStack44 + 2;
          pCStack32 = lpBuffer;
          uStack36 = 0;
          uStack34 = (undefined2)uStack20;
          iVar4 = RtlUnicodeStringToAnsiString(&uStack36,&sStack44,0);
          if (-1 < iVar4) {
            UVar5 = (UINT)uStack36;
          }
        }
        else {
          UVar5 = uStack16 >> 1;
          if (pCStack24 != lpBuffer) {
            memmove(lpBuffer,pCStack24,uStack16);
          }
          if (UVar5 < uStack20) {
            *(undefined2 *)(lpBuffer + (uVar1 & 0xfffffffe)) = 0;
          }
        }
      }
      if (pCVar3 != (LPSTR)0x0) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pCVar3);
      }
      if (-1 < iVar4) {
        return UVar5;
      }
    }
  }
  BaseSetLastNTError(iVar4);
  return 0;
}



void GlobalAddAtomExA(uint param_1,undefined4 param_2)

{
                    // 0x52040  816  GlobalAddAtomExA
  FUN_6b81b8e7('\0','\0',param_1,param_2);
  return;
}



// WARNING: Removing unreachable block (ram,0x6b81b6c3)
// WARNING: Removing unreachable block (ram,0x6b8268c1)
// WARNING: Removing unreachable block (ram,0x6b8268df)
// WARNING: Removing unreachable block (ram,0x6b81b6cb)
// WARNING: Removing unreachable block (ram,0x6b81b6d1)
// WARNING: Removing unreachable block (ram,0x6b81b6e2)

UINT GlobalGetAtomNameA(ATOM nAtom,LPSTR lpBuffer,int nSize)

{
  LPSTR _Src;
  ushort uVar1;
  undefined4 *puVar2;
  int iVar3;
  int iVar4;
  uint _Size;
  UINT UVar5;
  int in_FS_OFFSET;
  undefined2 in_stack_00000006;
  ushort uStack44;
  short sStack42;
  LPSTR pCStack40;
  ushort uStack36;
  undefined2 uStack34;
  LPSTR pCStack32;
  uint uStack20;
  uint uStack16;
  int iStack12;
  char cStack5;
  
                    // 0x52060  827  GlobalGetAtomNameA
  cStack5 = '\0';
  iStack12 = 0;
  UVar5 = 0;
  uStack16 = 0;
  uStack20 = nSize;
  if (0x7000 < (uint)nSize) {
    uStack20 = 0x7000;
  }
  if (uStack20 == 0) {
    iVar4 = -0x7ffffffb;
  }
  else {
    iStack12 = uStack20 * 2 + 8;
    puVar2 = (undefined4 *)KernelBaseGetGlobalData();
    iVar3 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar2,iStack12);
    if (iVar3 == 0) {
      iVar4 = -0x3fffffe9;
    }
    else {
      iVar4 = NtQueryInformationAtom(_nAtom,0,iVar3,iStack12,&iStack12);
      if (-1 < iVar4) {
        uVar1 = *(ushort *)(iVar3 + 4);
        _Size = (uint)uVar1;
        _Src = (LPSTR)(iVar3 + 6);
        uStack16 = _Size;
        if (-1 < iVar4) {
          if (cStack5 == '\0') {
            sStack42 = uVar1 + 2;
            pCStack32 = lpBuffer;
            uStack36 = 0;
            uStack34 = (undefined2)uStack20;
            uStack44 = uVar1;
            pCStack40 = _Src;
            iVar4 = RtlUnicodeStringToAnsiString(&uStack36,&uStack44,0);
            if (-1 < iVar4) {
              UVar5 = (UINT)uStack36;
            }
          }
          else {
            UVar5 = (UINT)(uVar1 >> 1);
            if (_Src != lpBuffer) {
              memmove(lpBuffer,_Src,_Size);
            }
            if (UVar5 < uStack20) {
              *(undefined2 *)(lpBuffer + (_Size & 0xfffffffe)) = 0;
            }
          }
        }
      }
      if (iVar3 != 0) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iVar3);
      }
      if (-1 < iVar4) {
        return UVar5;
      }
    }
  }
  BaseSetLastNTError(iVar4);
  return 0;
}



BOOL InitAtomTable(DWORD nSize)

{
  int iVar1;
  int local_8;
  
                    // 0x52080  860  InitAtomTable
  if (DAT_6b8b07d0 == 0) {
    if ((nSize < 4) || (0x1ff < nSize)) {
      nSize = 0x25;
    }
    local_8 = 0;
    iVar1 = RtlCreateAtomTable(nSize,&local_8);
    if (iVar1 < 0) {
      return 0;
    }
    LOCK();
    iVar1 = DAT_6b8b07d0;
    if (DAT_6b8b07d0 == 0) {
      DAT_6b8b07d0 = local_8;
      iVar1 = 0;
    }
    if (iVar1 != 0) {
      RtlDestroyAtomTable(local_8);
    }
  }
  return 1;
}



DWORD AddLocalAlternateComputerNameA(LPCSTR param_1,int param_2)

{
  DWORD DVar1;
  int in_FS_OFFSET;
  wchar_t *local_8;
  
                    // 0x520e0  14  AddLocalAlternateComputerNameA
  local_8 = (wchar_t *)0x0;
  if (param_1 == (LPCSTR)0x0) {
    DVar1 = 0x57;
  }
  else {
    DVar1 = FUN_6b85280f(param_1,&local_8);
    if (DVar1 == 0) {
      DVar1 = AddLocalAlternateComputerNameW(local_8,param_2);
    }
    if (local_8 != (wchar_t *)0x0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_8);
    }
  }
  return DVar1;
}



DWORD AddLocalAlternateComputerNameW(wchar_t *param_1,int param_2)

{
  int iVar1;
  DWORD DVar2;
  BOOL BVar3;
  undefined4 *puVar4;
  wchar_t *ComputerName;
  int in_FS_OFFSET;
  DWORD local_c [2];
  
                    // 0x52140  15  AddLocalAlternateComputerNameW
  local_c[0] = 0;
  if (((param_1 == (wchar_t *)0x0) || (param_2 != 0)) || (iVar1 = FUN_6b87360d(), iVar1 == 0)) {
    DVar2 = 0x57;
  }
  else {
    iVar1 = FUN_6b85222e((undefined *)
                         L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\DnsCache\\Parameters"
                         ,L"AlternateComputerNames",param_1);
    DVar2 = RtlNtStatusToDosError(iVar1);
    if (((DVar2 == 0) &&
        (BVar3 = DnsHostnameToComputerNameW(param_1,(LPWSTR)0x0,local_c), BVar3 == 0)) &&
       (DVar2 = GetLastError(), DVar2 == 0xea)) {
      DVar2 = local_c[0] + 1;
      local_c[0] = DVar2;
      puVar4 = (undefined4 *)KernelBaseGetGlobalData();
      ComputerName = (wchar_t *)
                     RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar4,
                                     DVar2 * 2);
      if (ComputerName == (wchar_t *)0x0) {
        DVar2 = 8;
      }
      else {
        BVar3 = DnsHostnameToComputerNameW(param_1,ComputerName,local_c);
        if ((BVar3 == 0) || (iVar1 = FUN_6b852b30(ComputerName), iVar1 == 0)) {
          DVar2 = GetLastError();
        }
        else {
          DVar2 = 0;
        }
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,ComputerName);
      }
    }
  }
  return DVar2;
}



int __fastcall FUN_6b85222e(undefined *param_1,undefined4 param_2,wchar_t *param_3)

{
  wchar_t wVar1;
  int iVar2;
  undefined4 *puVar3;
  int iVar4;
  wchar_t *pwVar5;
  short *psVar6;
  int in_FS_OFFSET;
  uint local_18;
  undefined4 local_14;
  int local_10;
  undefined *local_c;
  uint local_8;
  
  local_10 = 0;
  psVar6 = (short *)0x0;
  local_8 = 0;
  local_18 = 0;
  local_14 = param_2;
  local_c = param_1;
  iVar2 = FUN_6b873779(0,param_1,param_2,(void *)0x0,&local_8);
  if ((iVar2 == -0x3ffffddb) || (iVar2 == -0x3fffffcc)) {
    iVar2 = FUN_6b8523ae(local_c,param_2,param_3);
  }
  else {
    if (iVar2 == -0x7ffffffb) {
      pwVar5 = param_3;
      do {
        wVar1 = *pwVar5;
        pwVar5 = pwVar5 + 1;
      } while (wVar1 != L'\0');
      iVar2 = local_8 + 1 + ((int)pwVar5 - (int)(param_3 + 1) >> 1);
      local_10 = iVar2;
      puVar3 = (undefined4 *)KernelBaseGetGlobalData();
      psVar6 = (short *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                                        *puVar3,iVar2 * 2);
      if (psVar6 == (short *)0x0) {
        return -0x3fffffe9;
      }
      iVar2 = FUN_6b873779(0,local_c,local_14,psVar6,&local_8);
    }
    if (((-1 < iVar2) && (iVar4 = FUN_6b8524f6(psVar6,param_3,&local_18), iVar4 != 0)) &&
       (iVar4 = FUN_6b852368((int)psVar6,local_10,param_3,local_8), iVar4 == 0)) {
      pwVar5 = param_3 + 1;
      do {
        wVar1 = *param_3;
        param_3 = param_3 + 1;
      } while (wVar1 != L'\0');
      iVar2 = FUN_6b852b68(local_c,local_14,psVar6,
                           (local_8 + ((int)param_3 - (int)pwVar5 >> 1)) * 2 + 4);
    }
    if (psVar6 != (short *)0x0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,psVar6);
    }
  }
  return iVar2;
}



undefined4 __fastcall FUN_6b852368(int param_1,int param_2,wchar_t *param_3,int param_4)

{
  wchar_t *pwVar1;
  wchar_t wVar2;
  
  wcscpy_s((wchar_t *)(param_1 + param_4 * 2),param_2 - param_4,param_3);
  pwVar1 = param_3 + 1;
  do {
    wVar2 = *param_3;
    param_3 = param_3 + 1;
  } while (wVar2 != L'\0');
  *(undefined2 *)(param_1 + 2 + (((int)param_3 - (int)pwVar1 >> 1) + param_4) * 2) = 0;
  return 0;
}



int __fastcall FUN_6b8523ae(undefined4 param_1,undefined4 param_2,short *param_3)

{
  short sVar1;
  undefined4 *puVar2;
  void *_Dst;
  short *psVar3;
  int iVar4;
  int in_FS_OFFSET;
  
  psVar3 = param_3;
  do {
    sVar1 = *psVar3;
    psVar3 = psVar3 + 1;
  } while (sVar1 != 0);
  puVar2 = (undefined4 *)KernelBaseGetGlobalData();
  _Dst = (void *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar2,
                                 ((int)psVar3 - (int)(param_3 + 1) >> 1) * 2 + 4);
  if (_Dst == (void *)0x0) {
    iVar4 = -0x3fffffe9;
  }
  else {
    psVar3 = param_3;
    do {
      sVar1 = *psVar3;
      psVar3 = psVar3 + 1;
    } while (sVar1 != 0);
    memcpy(_Dst,param_3,((int)psVar3 - (int)(param_3 + 1) >> 1) * 2);
    psVar3 = param_3;
    do {
      sVar1 = *psVar3;
      psVar3 = psVar3 + 1;
    } while (sVar1 != 0);
    *(undefined2 *)((int)_Dst + ((int)psVar3 - (int)(param_3 + 1) >> 1) * 2) = 0;
    psVar3 = param_3;
    do {
      sVar1 = *psVar3;
      psVar3 = psVar3 + 1;
    } while (sVar1 != 0);
    *(undefined2 *)((int)_Dst + ((int)psVar3 - (int)(param_3 + 1) >> 1) * 2 + 2) = 0;
    psVar3 = param_3 + 1;
    do {
      sVar1 = *param_3;
      param_3 = param_3 + 1;
    } while (sVar1 != 0);
    iVar4 = FUN_6b852b68(param_1,param_2,_Dst,((int)param_3 - (int)psVar3 >> 1) * 2 + 4);
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,_Dst);
  }
  return iVar4;
}



void __fastcall FUN_6b8524a9(undefined2 *param_1,uint *param_2)

{
  int iVar1;
  
  iVar1 = FUN_6b873779((int)L"Dnscache",
                       (undefined *)
                       L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\DnsCache\\Parameters"
                       ,L"AlternateComputerNames",param_1,param_2);
  if (iVar1 == -0x3fffffcc) {
    if ((param_1 == (undefined2 *)0x0) || (iVar1 = 0, *param_2 == 0)) {
      *param_2 = 1;
      iVar1 = -0x7ffffffb;
    }
    else {
      *param_1 = 0;
      *param_2 = 0;
    }
  }
  RtlNtStatusToDosError(iVar1);
  return;
}



// WARNING: Could not reconcile some variable overlaps

int __fastcall FUN_6b8524f6(short *param_1,short *param_2,uint *param_3)

{
  short sVar1;
  bool bVar2;
  int iVar3;
  short *psVar4;
  short *psVar5;
  uint uVar6;
  int iVar7;
  short *local_14;
  short *local_10;
  short *local_c;
  undefined4 local_8;
  
  local_8 = 0;
  uVar6 = 0;
  local_10 = (short *)0x0;
  iVar7 = 0;
  bVar2 = false;
  local_c = param_2;
  do {
    if (bVar2) {
      return iVar7;
    }
    iVar7 = FUN_6b852bfd(param_1,uVar6,&local_10,(int *)&local_14);
    if (iVar7 == 0) {
      psVar5 = local_10;
      do {
        sVar1 = *psVar5;
        psVar5 = psVar5 + 1;
      } while (sVar1 != (short)local_8);
      local_14 = local_c + 1;
      psVar4 = local_c;
      do {
        sVar1 = *psVar4;
        psVar4 = psVar4 + 1;
      } while (sVar1 != (short)local_8);
      if ((int)psVar5 - (int)(local_10 + 1) >> 1 == (int)psVar4 - (int)local_14 >> 1) {
        psVar5 = local_c;
        do {
          sVar1 = *psVar5;
          psVar5 = psVar5 + 1;
        } while (sVar1 != (short)local_8);
        iVar3 = _memicmp(local_10,local_c,((int)psVar5 - (int)(local_c + 1) >> 1) * 2);
        if (iVar3 == 0) {
          bVar2 = true;
          *param_3 = uVar6;
        }
      }
    }
    uVar6 = uVar6 + 1;
  } while (iVar7 == 0);
  return iVar7;
}



bool __fastcall FUN_6b8525b4(short *param_1)

{
  int iVar1;
  undefined4 *puVar2;
  short *psVar3;
  int in_FS_OFFSET;
  bool bVar4;
  uint local_c;
  uint local_8;
  
  local_8 = 0;
  local_c = 0;
  iVar1 = FUN_6b873779((int)L"Dnscache",
                       (undefined *)
                       L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\DnsCache\\Parameters"
                       ,L"AlternateComputerNames",(void *)0x0,&local_8);
  bVar4 = false;
  if (iVar1 == -0x7ffffffb) {
    puVar2 = (undefined4 *)KernelBaseGetGlobalData();
    psVar3 = (short *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar2,
                                      local_8 * 2);
    bVar4 = false;
    if (psVar3 != (short *)0x0) {
      iVar1 = FUN_6b873779((int)L"Dnscache",
                           (undefined *)
                           L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\DnsCache\\Parameters"
                           ,L"AlternateComputerNames",psVar3,&local_8);
      iVar1 = RtlNtStatusToDosError(iVar1);
      bVar4 = false;
      if (iVar1 == 0) {
        iVar1 = FUN_6b8524f6(psVar3,param_1,&local_c);
        bVar4 = iVar1 == 0;
      }
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,psVar3);
    }
  }
  return bVar4;
}



undefined4 FUN_6b852660(void)

{
  int iVar1;
  uint uVar2;
  undefined4 *puVar3;
  DWORD DVar4;
  BOOL BVar5;
  LPWSTR ComputerName;
  short *psVar6;
  undefined4 uVar7;
  int in_FS_OFFSET;
  int local_24;
  wchar_t *local_20;
  uint local_1c;
  short *local_18;
  LPCWSTR local_14;
  uint local_10;
  DWORD local_c;
  undefined4 local_8;
  
  psVar6 = (short *)0x0;
  local_10 = 0;
  local_14 = (LPCWSTR)0x0;
  ComputerName = (LPWSTR)0x0;
  local_c = 0;
  local_8 = 0;
  local_18 = (short *)0x0;
  iVar1 = FUN_6b873779((int)L"Dnscache",
                       (undefined *)
                       L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\DnsCache\\Parameters"
                       ,L"AlternateComputerNames",(void *)0x0,&local_10);
  uVar2 = RtlNtStatusToDosError(iVar1);
  if (uVar2 == 0xea) {
    puVar3 = (undefined4 *)KernelBaseGetGlobalData();
    psVar6 = (short *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar3,
                                      local_10 * 2);
    local_18 = psVar6;
    if (psVar6 == (short *)0x0) {
      RtlSetLastWin32Error(8);
      return 1;
    }
    iVar1 = FUN_6b873779((int)L"Dnscache",
                         (undefined *)
                         L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\DnsCache\\Parameters"
                         ,L"AlternateComputerNames",psVar6,&local_10);
    uVar2 = RtlNtStatusToDosError(iVar1);
  }
  uVar7 = 1;
  if (uVar2 == 0) {
    if (psVar6 == (short *)0x0) {
      return 0;
    }
    do {
      local_1c = uVar2;
      DVar4 = FUN_6b852bfd(psVar6,uVar2,&local_14,&local_24);
      if (DVar4 == 0) {
        BVar5 = DnsHostnameToComputerNameW(local_14,ComputerName,&local_c);
        if (BVar5 == 0) {
          DVar4 = GetLastError();
          if (DVar4 == 0xea) {
            DVar4 = local_c + 1;
            local_c = DVar4;
            puVar3 = (undefined4 *)KernelBaseGetGlobalData();
            ComputerName = (LPWSTR)RtlAllocateHeap(*(undefined4 *)
                                                    (*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar3,
                                                   DVar4 * 2);
            if (ComputerName == (LPWSTR)0x0) {
              DVar4 = 8;
              goto LAB_6b852788;
            }
            BVar5 = DnsHostnameToComputerNameW(local_14,ComputerName,&local_c);
            if (BVar5 == 0) {
              DVar4 = GetLastError();
            }
            else {
              DVar4 = 0;
            }
          }
          if (DVar4 != 0) goto LAB_6b852788;
        }
        iVar1 = _wcsicmp(ComputerName,local_20);
        if (iVar1 == 0) {
          local_8 = 1;
        }
      }
LAB_6b852788:
      uVar2 = local_1c + 1;
      psVar6 = local_18;
    } while (DVar4 == 0);
    local_1c = uVar2;
    if (DVar4 == 0x490) {
      uVar7 = local_8;
    }
  }
  if (local_18 != (short *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_18);
  }
  if (ComputerName != (LPWSTR)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,ComputerName);
  }
  return uVar7;
}



DWORD __fastcall FUN_6b85280f(LPCSTR param_1,LPWSTR *param_2)

{
  char *cbMultiByte;
  char cVar1;
  DWORD DVar2;
  int iVar3;
  undefined4 *puVar4;
  LPWSTR lpWideCharStr;
  LPCSTR pCVar5;
  int in_FS_OFFSET;
  LPCSTR local_8;
  
  if (param_1 == (LPCSTR)0x0) {
    *param_2 = (LPWSTR)0x0;
    DVar2 = 0;
  }
  else {
    pCVar5 = param_1;
    do {
      cVar1 = *pCVar5;
      pCVar5 = pCVar5 + 1;
    } while (cVar1 != '\0');
    cbMultiByte = pCVar5 + (1 - (int)(param_1 + 1));
    local_8 = param_1;
    iVar3 = FUN_6b850b02(&local_8,(int)(ZEXT48(cbMultiByte) * 2),
                         (int)(ZEXT48(cbMultiByte) * 2 >> 0x20));
    if (iVar3 < 0) {
      DVar2 = 0xd;
    }
    else {
      puVar4 = (undefined4 *)KernelBaseGetGlobalData();
      lpWideCharStr =
           (LPWSTR)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar4,
                                   local_8);
      *param_2 = lpWideCharStr;
      if (lpWideCharStr == (LPWSTR)0x0) {
        DVar2 = 8;
      }
      else {
        iVar3 = MultiByteToWideChar(0,0,param_1,(int)cbMultiByte,lpWideCharStr,(int)cbMultiByte);
        if (iVar3 == 0) {
          DVar2 = GetLastError();
        }
        else {
          DVar2 = 0;
        }
      }
    }
  }
  return DVar2;
}



wchar_t * __fastcall FUN_6b852894(wchar_t *param_1,int param_2)

{
  wchar_t wVar1;
  size_t sVar2;
  undefined4 *puVar3;
  wchar_t *pwVar4;
  rsize_t _MaxCount;
  int in_FS_OFFSET;
  
  if (param_1 != (wchar_t *)0x0) {
    sVar2 = wcscspn(param_1,(wchar_t *)&_Src_6b886d1c);
    _MaxCount = sVar2;
    if (param_2 != 0) {
      pwVar4 = param_1;
      do {
        wVar1 = *pwVar4;
        pwVar4 = pwVar4 + 1;
      } while (wVar1 != L'\0');
      _MaxCount = 0;
      if (sVar2 != (int)pwVar4 - (int)(param_1 + 1) >> 1) {
        pwVar4 = param_1;
        do {
          wVar1 = *pwVar4;
          pwVar4 = pwVar4 + 1;
        } while (wVar1 != L'\0');
        _MaxCount = (((int)pwVar4 - (int)(param_1 + 1) >> 1) - sVar2) - 1;
      }
    }
    puVar3 = (undefined4 *)KernelBaseGetGlobalData();
    pwVar4 = (wchar_t *)
             RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar3,
                             _MaxCount * 2 + 2);
    if (pwVar4 != (wchar_t *)0x0) {
      if (param_2 != 0) {
        param_1 = param_1 + sVar2 + 1;
      }
      wcsncpy_s(pwVar4,_MaxCount + 1,param_1,_MaxCount);
      return pwVar4;
    }
  }
  return (wchar_t *)0x0;
}



undefined4 __fastcall FUN_6b85294c(short *param_1)

{
  int iVar1;
  
  iVar1 = FUN_6b852972((undefined *)
                       L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\LanmanServer\\Parameters"
                       ,L"OptionalNames",param_1);
  if (iVar1 < 0) {
    BaseSetLastNTError(iVar1);
    return 0;
  }
  return 1;
}



int __fastcall FUN_6b852972(undefined *param_1,undefined4 param_2,short *param_3)

{
  bool bVar1;
  int iVar2;
  undefined4 *puVar3;
  short *psVar4;
  int iVar5;
  int in_FS_OFFSET;
  uint local_c;
  uint local_8;
  
  local_c = 0;
  local_8 = 0;
  bVar1 = false;
  iVar2 = FUN_6b873779(0,param_1,param_2,(void *)0x0,&local_8);
  if (iVar2 == -0x7ffffffb) {
    puVar3 = (undefined4 *)KernelBaseGetGlobalData();
    psVar4 = (short *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar3,
                                      local_8 * 2);
    if (psVar4 == (short *)0x0) {
      iVar2 = -0x3fffffe9;
    }
    else {
      iVar2 = FUN_6b873779(0,param_1,param_2,psVar4,&local_8);
      iVar5 = RtlNtStatusToDosError(iVar2);
      if (iVar5 == 0) {
        do {
          iVar2 = FUN_6b8524f6(psVar4,param_3,&local_c);
          if (iVar2 != 0) break;
          iVar2 = FUN_6b852a5c(psVar4,local_c,(int *)&local_8);
          bVar1 = true;
        } while (iVar2 == 0);
        if (bVar1) {
          iVar2 = FUN_6b852b68(param_1,param_2,psVar4,local_8 * 2 + 2);
        }
        else {
          iVar2 = -0x3ffffddb;
        }
      }
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,psVar4);
    }
  }
  return iVar2;
}



int __fastcall FUN_6b852a5c(short *param_1,uint param_2,int *param_3)

{
  short *psVar1;
  short sVar2;
  int iVar3;
  int iVar4;
  int local_14;
  short *local_10;
  int local_c;
  short *local_8;
  
  local_10 = (short *)0x0;
  local_8 = (short *)0x0;
  local_14 = 0;
  local_c = 0;
  iVar3 = FUN_6b852bfd(param_1,param_2,&local_8,&local_14);
  if (iVar3 == 0) {
    iVar3 = FUN_6b852bfd(param_1,param_2 + 1,&local_10,&local_c);
    if (iVar3 == 0) {
      iVar4 = *param_3 - local_c;
      memmove(local_8,local_10,iVar4 * 2);
      local_14 = local_14 + iVar4;
      *param_3 = local_14;
      param_1[local_14] = 0;
    }
    else if (iVar3 == 0x490) {
      iVar3 = 0;
      psVar1 = local_8 + 1;
      do {
        sVar2 = *local_8;
        local_8 = local_8 + 1;
      } while (sVar2 != 0);
      *param_3 = *param_3 + (-1 - ((int)local_8 - (int)psVar1 >> 1));
      param_1[*param_3] = 0;
    }
  }
  return iVar3;
}



undefined4 __fastcall FUN_6b852b0d(wchar_t *param_1)

{
  int iVar1;
  
  iVar1 = FUN_6b85222e((undefined *)
                       L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\DnsCache\\Parameters"
                       ,L"AlternateComputerNames",param_1);
  if (iVar1 < 0) {
    BaseSetLastNTError(iVar1);
    return 0;
  }
  return 1;
}



undefined4 __fastcall FUN_6b852b30(wchar_t *param_1)

{
  int iVar1;
  
  iVar1 = FUN_6b87368d(param_1);
  if (iVar1 == 0) {
    iVar1 = -0x3ffffff3;
  }
  else {
    iVar1 = FUN_6b85222e((undefined *)
                         L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\LanmanServer\\Parameters"
                         ,L"OptionalNames",param_1);
    if (-1 < iVar1) {
      return 1;
    }
  }
  BaseSetLastNTError(iVar1);
  return 0;
}



int __fastcall
FUN_6b852b68(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  undefined4 local_30;
  undefined4 local_2c;
  undefined *local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined local_18 [8];
  undefined local_10 [8];
  undefined4 local_8;
  
  local_8 = 0;
  RtlInitUnicodeString(local_10,param_1);
  local_28 = local_10;
  local_30 = 0x18;
  local_2c = 0;
  local_24 = 0x40;
  local_20 = 0;
  local_1c = 0;
  iVar1 = NtCreateKey(&local_8,0x2001f,&local_30,0,0,0,0);
  if (-1 < iVar1) {
    RtlInitUnicodeString(local_18,param_2);
    iVar1 = NtSetValueKey(local_8,local_18,0,7,param_3,param_4);
    if (-1 < iVar1) {
      NtFlushKey(local_8);
    }
    NtClose(local_8);
  }
  return iVar1;
}



undefined4 __fastcall FUN_6b852bfd(short *param_1,uint param_2,short **param_3,int *param_4)

{
  short sVar1;
  short *psVar2;
  int iVar3;
  undefined4 uVar4;
  uint uVar5;
  
  uVar4 = 0;
  iVar3 = 0;
  uVar5 = 0;
  if (param_2 != 0) {
    do {
      if (*param_1 == 0) goto LAB_6b852c6b;
      psVar2 = param_1;
      do {
        sVar1 = *psVar2;
        psVar2 = psVar2 + 1;
      } while (sVar1 != 0);
      iVar3 = iVar3 + ((int)psVar2 - (int)(param_1 + 1) >> 1) + 1;
      psVar2 = param_1;
      do {
        sVar1 = *psVar2;
        psVar2 = psVar2 + 1;
      } while (sVar1 != 0);
      param_1 = param_1 + ((int)psVar2 - (int)(param_1 + 1) >> 1) + 1;
      uVar5 = uVar5 + 1;
    } while (uVar5 < param_2);
  }
  if (*param_1 == 0) {
LAB_6b852c6b:
    uVar4 = 0x490;
  }
  else {
    *param_3 = param_1;
    *param_4 = iVar3;
  }
  return uVar4;
}



BOOL DnsHostnameToComputerNameA(LPCSTR Hostname,LPSTR ComputerName,LPDWORD nSize)

{
  char cVar1;
  int iVar2;
  BOOL BVar3;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 uVar4;
  undefined local_40 [8];
  ushort local_38;
  undefined2 local_36;
  LPSTR local_34;
  undefined2 local_30;
  undefined2 local_2e;
  undefined2 *local_2c;
  undefined2 local_28 [16];
  uint local_8;
  
                    // 0x52c80  297  DnsHostnameToComputerNameA
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  cVar1 = RtlCreateUnicodeStringFromAsciiz(local_40,Hostname);
  if (cVar1 == '\0') {
    iVar2 = -0x3fffffe9;
    uVar4 = extraout_EDX;
  }
  else {
    local_28[0] = 0;
    local_2c = local_28;
    local_30 = 0;
    local_2e = 0x20;
    iVar2 = RtlDnsHostNameToComputerName(&local_30,local_40,0);
    if (-1 < iVar2) {
      local_34 = ComputerName;
      local_38 = 0;
      local_36 = *(undefined2 *)nSize;
      iVar2 = RtlUnicodeStringToAnsiString(&local_38,&local_30,0);
      if (-1 < iVar2) {
        *nSize = (uint)local_38;
      }
    }
    RtlFreeUnicodeString(local_40);
    uVar4 = extraout_EDX_00;
  }
  if (iVar2 < 0) {
    BaseSetLastNTError(iVar2);
    uVar4 = extraout_EDX_01;
  }
  BVar3 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar4);
  return BVar3;
}



BOOL DnsHostnameToComputerNameW(LPCWSTR Hostname,LPWSTR ComputerName,LPDWORD nSize)

{
  ushort uVar1;
  LPWSTR pWVar2;
  int iVar3;
  BOOL BVar4;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar5;
  undefined4 extraout_EDX_01;
  undefined local_40 [8];
  LPWSTR local_38;
  ushort local_34;
  undefined2 local_32;
  undefined2 *local_30;
  undefined2 local_2c [16];
  uint local_c;
  
                    // 0x52d40  299  DnsHostnameToComputerNameW
  local_c = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_38 = ComputerName;
  local_2c[0] = 0;
  local_30 = local_2c;
  local_34 = 0;
  local_32 = 0x20;
  RtlInitUnicodeString(local_40,Hostname);
  iVar3 = RtlDnsHostNameToComputerName(&local_34,local_40,0);
  pWVar2 = local_38;
  if (iVar3 < 0) {
    BaseSetLastNTError(iVar3);
    uVar5 = extraout_EDX_01;
  }
  else {
    uVar1 = local_34 >> 1;
    if (*nSize < uVar1 + 1) {
      BaseSetLastNTError(0x80000005);
      uVar5 = extraout_EDX_00;
    }
    else {
      memcpy(local_38,local_30,(uint)local_34);
      pWVar2[uVar1] = L'\0';
      uVar5 = extraout_EDX;
    }
    *nSize = (uint)(local_34 >> 1);
  }
  BVar4 = FUN_6b8224af(local_c ^ (uint)&stack0xfffffffc,uVar5);
  return BVar4;
}



DWORD EnumerateLocalComputerNamesA(uint param_1,int param_2,LPSTR param_3,uint *param_4)

{
  DWORD DVar1;
  int iVar2;
  undefined4 *puVar3;
  LPWSTR lpWideCharStr;
  int in_FS_OFFSET;
  
                    // 0x52e00  352  EnumerateLocalComputerNamesA
  lpWideCharStr = (LPWSTR)0x0;
  if (param_4 == (uint *)0x0) {
LAB_6b852e97:
    DVar1 = 0x57;
  }
  else {
    if (param_3 == (LPSTR)0x0) {
      if (*param_4 != 0) goto LAB_6b852e97;
    }
    else {
      puVar3 = (undefined4 *)KernelBaseGetGlobalData();
      lpWideCharStr =
           (LPWSTR)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar3,
                                   *param_4 * 2);
      if (lpWideCharStr == (LPWSTR)0x0) {
        return 8;
      }
    }
    DVar1 = EnumerateLocalComputerNamesW(param_1,param_2,lpWideCharStr,param_4);
    if ((DVar1 == 0) &&
       (iVar2 = WideCharToMultiByte(0,0,lpWideCharStr,*param_4 + 1,param_3,*param_4 + 1,(LPCSTR)0x0,
                                    (LPBOOL)0x0), iVar2 == 0)) {
      DVar1 = GetLastError();
    }
    if (lpWideCharStr != (LPWSTR)0x0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpWideCharStr);
    }
  }
  return DVar1;
}



DWORD EnumerateLocalComputerNamesW(uint param_1,int param_2,LPWSTR param_3,uint *param_4)

{
  undefined4 *puVar1;
  LPWSTR lpBuffer;
  BOOL BVar2;
  uint uVar3;
  DWORD DVar4;
  int in_FS_OFFSET;
  uint local_c;
  uint local_8;
  
                    // 0x52eb0  353  EnumerateLocalComputerNamesW
  DVar4 = 0;
  local_8 = 0;
  if ((param_2 == 0) && (param_1 < 3)) {
    if (param_1 == 0) {
      if (param_4 != (uint *)0x0) {
        local_8 = -(uint)(*param_4 != 0) & *param_4 - 1;
        BVar2 = GetComputerNameExW(ComputerNamePhysicalDnsFullyQualified,param_3,&local_8);
        if (BVar2 == 0) {
          DVar4 = GetLastError();
        }
        else if (param_3 == (LPWSTR)0x0) {
          DVar4 = 0x1f;
        }
        else {
          param_3[local_8 + 1] = L'\0';
        }
        *param_4 = local_8 + 1;
        return DVar4;
      }
    }
    else if (param_1 == 1) {
      if ((param_4 != (uint *)0x0) && ((param_3 != (LPWSTR)0x0 || (*param_4 == 0)))) {
        DVar4 = FUN_6b8524a9(param_3,param_4);
        return DVar4;
      }
    }
    else if (((param_1 == 2) && (param_4 != (uint *)0x0)) &&
            ((param_3 != (LPWSTR)0x0 || (*param_4 == 0)))) {
      local_8 = *param_4;
      puVar1 = (undefined4 *)KernelBaseGetGlobalData();
      lpBuffer = (LPWSTR)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                                         *puVar1,*param_4 * 2);
      if (lpBuffer != (LPWSTR)0x0) {
        BVar2 = GetComputerNameExW(ComputerNamePhysicalDnsFullyQualified,lpBuffer,&local_8);
        if ((BVar2 == 0) && (DVar4 = GetLastError(), DVar4 != 0)) {
          if (DVar4 == 0xea) {
            local_c = 0;
            DVar4 = FUN_6b8524a9((undefined2 *)0x0,&local_c);
            if (DVar4 == 0) {
              DVar4 = 0xea;
            }
            *param_4 = local_c + local_8;
          }
        }
        else {
          local_c = (*param_4 - local_8) - 1;
          DVar4 = FUN_6b8524a9(lpBuffer + local_8 + 1,&local_c);
          uVar3 = local_c + 1 + local_8;
          *param_4 = uVar3;
          if (DVar4 == 0) {
            memcpy(param_3,lpBuffer,uVar3 * 2 + 2);
          }
        }
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpBuffer);
        return DVar4;
      }
      return 8;
    }
  }
  return 0x57;
}



void __fastcall FUN_6b853047(undefined4 param_1,undefined4 param_2,short *param_3,uint *param_4)

{
  short *psVar1;
  short sVar2;
  int iVar3;
  uint uVar4;
  int extraout_EDX;
  int iVar5;
  uint _Size;
  undefined8 uVar6;
  undefined local_b0 [8];
  undefined local_a8 [8];
  undefined local_a0 [4];
  undefined4 local_9c;
  undefined4 local_98;
  undefined *local_94;
  undefined4 local_90;
  undefined4 local_8c;
  undefined4 local_88;
  uint *local_84;
  undefined4 local_80;
  undefined local_7c [8];
  int local_74;
  uint local_70;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_84 = param_4;
  RtlInitUnicodeString(local_a8,param_2);
  local_94 = local_a8;
  local_9c = 0x18;
  local_8c = 0;
  local_88 = 0;
  local_90 = 0x40;
  local_98 = param_1;
  uVar6 = NtOpenKey(&local_80,0x20019,&local_9c);
  iVar5 = (int)((ulonglong)uVar6 >> 0x20);
  if (-1 < (int)uVar6) {
    RtlInitUnicodeString(local_b0,L"ComputerName");
    iVar3 = NtQueryValueKey(local_80,local_b0,1,local_7c,0x6c,local_a0);
    NtClose(local_80);
    iVar5 = extraout_EDX;
    if ((-1 < iVar3) && (iVar5 = extraout_EDX, 1 < local_70)) {
      _Size = local_70 & 0xfffffffe;
      local_70 = _Size;
      if (*(short *)(local_7c + _Size + local_74 + -2) == 0) {
        _Size = _Size - 2;
      }
      uVar4 = (_Size >> 1) + 1;
      local_70 = _Size;
      if (*local_84 < uVar4) {
        *local_84 = uVar4;
        iVar5 = local_74;
      }
      else {
        memcpy(param_3,local_7c + local_74,_Size);
        psVar1 = param_3 + 1;
        *(undefined2 *)(_Size + (int)param_3) = 0;
        do {
          sVar2 = *param_3;
          param_3 = param_3 + 1;
        } while (sVar2 != 0);
        *local_84 = (int)param_3 - (int)psVar1 >> 1;
        iVar5 = 0;
      }
    }
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,iVar5);
  return;
}



DWORD RemoveLocalAlternateComputerNameA(LPCSTR param_1,int param_2)

{
  DWORD DVar1;
  int in_FS_OFFSET;
  LPCWSTR local_8;
  
                    // 0x531a0  1215  RemoveLocalAlternateComputerNameA
  local_8 = (LPCWSTR)0x0;
  if (param_1 == (LPCSTR)0x0) {
    DVar1 = 0x57;
  }
  else {
    DVar1 = FUN_6b85280f(param_1,&local_8);
    if (DVar1 == 0) {
      DVar1 = RemoveLocalAlternateComputerNameW(local_8,param_2);
    }
    if (local_8 != (LPCWSTR)0x0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_8);
    }
  }
  return DVar1;
}



DWORD RemoveLocalAlternateComputerNameW(LPCWSTR param_1,int param_2)

{
  int iVar1;
  DWORD DVar2;
  BOOL BVar3;
  undefined4 *puVar4;
  LPWSTR ComputerName;
  int in_FS_OFFSET;
  DWORD local_c [2];
  
                    // 0x53200  1216  RemoveLocalAlternateComputerNameW
  local_c[0] = 0;
  if ((param_2 == 0) && (param_1 != (LPCWSTR)0x0)) {
    iVar1 = FUN_6b852972((undefined *)
                         L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\DnsCache\\Parameters"
                         ,L"AlternateComputerNames",param_1);
    DVar2 = RtlNtStatusToDosError(iVar1);
    if (((DVar2 == 0) &&
        (BVar3 = DnsHostnameToComputerNameW(param_1,(LPWSTR)0x0,local_c), BVar3 == 0)) &&
       (DVar2 = GetLastError(), DVar2 == 0xea)) {
      DVar2 = local_c[0] + 1;
      local_c[0] = DVar2;
      puVar4 = (undefined4 *)KernelBaseGetGlobalData();
      ComputerName = (LPWSTR)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                                             *puVar4,DVar2 * 2);
      if (ComputerName == (LPWSTR)0x0) {
        DVar2 = 8;
      }
      else {
        BVar3 = DnsHostnameToComputerNameW(param_1,ComputerName,local_c);
        if ((BVar3 == 0) ||
           ((iVar1 = FUN_6b852660(), iVar1 == 0 && (iVar1 = FUN_6b85294c(ComputerName), iVar1 == 0))
           )) {
          DVar2 = GetLastError();
        }
        else {
          DVar2 = 0;
        }
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,ComputerName);
      }
    }
  }
  else {
    DVar2 = 0x57;
  }
  return DVar2;
}



DWORD SetLocalPrimaryComputerNameA(LPCSTR param_1,int param_2)

{
  DWORD DVar1;
  int in_FS_OFFSET;
  wchar_t *local_8;
  
                    // 0x53300  1335  SetLocalPrimaryComputerNameA
  local_8 = (wchar_t *)0x0;
  if (param_1 == (LPCSTR)0x0) {
    DVar1 = 0x57;
  }
  else {
    DVar1 = FUN_6b85280f(param_1,&local_8);
    if (DVar1 == 0) {
      DVar1 = SetLocalPrimaryComputerNameW(local_8,param_2);
    }
    if (local_8 != (wchar_t *)0x0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_8);
    }
  }
  return DVar1;
}



DWORD SetLocalPrimaryComputerNameW(wchar_t *param_1,int param_2)

{
  bool bVar1;
  wchar_t *lpBuffer;
  wchar_t *lpBuffer_00;
  undefined3 extraout_var;
  BOOL BVar2;
  undefined4 *puVar3;
  wchar_t *pwVar4;
  int iVar5;
  DWORD DVar6;
  int in_FS_OFFSET;
  DWORD local_c;
  DWORD local_8;
  
                    // 0x53360  1336  SetLocalPrimaryComputerNameW
  DVar6 = 0;
  local_8 = 0;
  local_c = 0;
  lpBuffer = FUN_6b852894(param_1,0);
  lpBuffer_00 = FUN_6b852894(param_1,1);
  if ((param_1 != (wchar_t *)0x0) && (param_2 == 0)) {
    bVar1 = FUN_6b8525b4(param_1);
    if (CONCAT31(extraout_var,bVar1) != 0) {
      BVar2 = GetComputerNameExW(ComputerNamePhysicalNetBIOS,(LPWSTR)0x0,&local_8);
      if ((BVar2 == 0) && (DVar6 = GetLastError(), DVar6 == 0xea)) {
        puVar3 = (undefined4 *)KernelBaseGetGlobalData();
        pwVar4 = (wchar_t *)
                 RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar3,
                                 local_8 * 2);
        if (pwVar4 == (wchar_t *)0x0) {
          DVar6 = 8;
        }
        else {
          BVar2 = GetComputerNameExW(ComputerNamePhysicalNetBIOS,pwVar4,&local_8);
          if ((BVar2 == 0) || (iVar5 = FUN_6b852b30(pwVar4), iVar5 == 0)) {
            DVar6 = GetLastError();
          }
          else {
            DVar6 = 0;
          }
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pwVar4);
        }
      }
      pwVar4 = FUN_6b8737ed(4);
      if (pwVar4 != (wchar_t *)0x0) {
        iVar5 = FUN_6b852b30(pwVar4);
        if (iVar5 == 0) {
          DVar6 = GetLastError();
        }
        else {
          DVar6 = 0;
        }
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pwVar4);
      }
      if (DVar6 == 0) {
        BVar2 = GetComputerNameExW(ComputerNamePhysicalDnsFullyQualified,(LPWSTR)0x0,&local_c);
        if (BVar2 == 0) {
          DVar6 = GetLastError();
          if (DVar6 == 0xea) {
            puVar3 = (undefined4 *)KernelBaseGetGlobalData();
            pwVar4 = (wchar_t *)
                     RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar3,
                                     local_c * 2);
            if (pwVar4 == (wchar_t *)0x0) {
              DVar6 = 8;
              goto LAB_6b8535a4;
            }
            BVar2 = GetComputerNameExW(ComputerNamePhysicalDnsFullyQualified,pwVar4,&local_c);
            if ((BVar2 == 0) || (iVar5 = FUN_6b852b0d(pwVar4), iVar5 == 0)) {
              DVar6 = GetLastError();
            }
            else {
              DVar6 = 0;
            }
            RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pwVar4);
          }
          if (DVar6 != 0) goto LAB_6b8535a4;
        }
        pwVar4 = FUN_6b8737ed(7);
        if (pwVar4 != (wchar_t *)0x0) {
          iVar5 = FUN_6b852b0d(pwVar4);
          if (iVar5 == 0) {
            DVar6 = GetLastError();
          }
          else {
            DVar6 = 0;
          }
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pwVar4);
          if (DVar6 != 0) goto LAB_6b8535a4;
        }
        BVar2 = SetComputerNameExW(ComputerNamePhysicalDnsHostname,lpBuffer);
        if (((BVar2 != 0) || (DVar6 = GetLastError(), DVar6 == 0)) &&
           ((BVar2 = SetComputerNameExW(ComputerNamePhysicalDnsDomain,lpBuffer_00), BVar2 != 0 ||
            (DVar6 = GetLastError(), DVar6 == 0)))) {
          DVar6 = RemoveLocalAlternateComputerNameW(param_1,0);
        }
      }
LAB_6b8535a4:
      if (lpBuffer != (wchar_t *)0x0) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpBuffer);
      }
      if (lpBuffer_00 == (wchar_t *)0x0) {
        return DVar6;
      }
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpBuffer_00);
      return DVar6;
    }
    if (lpBuffer != (wchar_t *)0x0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpBuffer);
    }
    if (lpBuffer_00 != (wchar_t *)0x0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpBuffer_00);
    }
  }
  return 0x57;
}



BOOL AssignProcessToJobObject(HANDLE hJob,HANDLE hProcess)

{
  int iVar1;
  
                    // 0x535e0  40  AssignProcessToJobObject
  iVar1 = NtAssignProcessToJobObject(hJob,hProcess);
  if (-1 >= iVar1) {
    BaseSetLastNTError(iVar1);
  }
  return (uint)(-1 < iVar1);
}



// WARNING: Could not reconcile some variable overlaps

void __fastcall FUN_6b853608(code *param_1,undefined4 param_2)

{
  WCHAR WVar1;
  code *pcVar2;
  HANDLE hFindVolume;
  uint uVar3;
  DWORD DVar4;
  int iVar5;
  BOOL BVar6;
  uint uVar7;
  WCHAR *pWVar8;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar9;
  undefined4 *puVar10;
  undefined4 local_430 [2];
  undefined4 local_428;
  code *local_424;
  undefined4 local_420;
  WCHAR local_41c [259];
  WCHAR aWStack534 [2];
  undefined local_212 [6];
  WCHAR local_20c [258];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_428 = 0;
  local_424 = param_1;
  local_420 = param_2;
  hFindVolume = FindFirstVolumeW(aWStack534 + 1,0x104);
  if (hFindVolume == (HANDLE)0xffffffff) {
    GetLastError();
    uVar9 = extraout_EDX;
  }
  else {
    pWVar8 = aWStack534 + 1;
    do {
      WVar1 = *pWVar8;
      pWVar8 = pWVar8 + 1;
    } while (WVar1 != L'\0');
    uVar3 = (int)pWVar8 - (int)local_212 >> 1 & 0xffff;
    uVar7 = uVar3;
    while (uVar7 * 2 - 2 < 0x208) {
      aWStack534[uVar3] = L'\0';
      DVar4 = QueryDosDeviceW(local_20c,local_41c,0x104);
      if ((short)DVar4 == 0) {
        GetLastError();
        goto LAB_6b85375a;
      }
      iVar5 = FUN_6b82157b(local_430,local_41c);
      pcVar2 = local_424;
      if (iVar5 < 0) goto LAB_6b85375a;
      puVar10 = local_430;
      uVar9 = local_420;
      _guard_check_icall();
      iVar5 = (*pcVar2)(puVar10,uVar9);
      if (iVar5 != 0) goto LAB_6b85375a;
      BVar6 = FindNextVolumeW(hFindVolume,aWStack534 + 1,0x104);
      if (BVar6 == 0) goto LAB_6b853741;
      pWVar8 = aWStack534 + 1;
      do {
        WVar1 = *pWVar8;
        pWVar8 = pWVar8 + 1;
      } while (WVar1 != (WCHAR)local_428);
      uVar7 = (int)pWVar8 - (int)local_212 >> 1 & 0xffff;
    }
    ___report_rangecheckfailure();
LAB_6b853741:
    GetLastError();
LAB_6b85375a:
    FindVolumeClose(hFindVolume);
    uVar9 = extraout_EDX_00;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar9);
  return;
}



void FUN_6b853780(ushort *param_1,undefined4 *param_2)

{
  uint *puVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  undefined4 local_30 [6];
  undefined2 *local_18;
  ushort local_c;
  undefined2 *local_8;
  
  puVar1 = param_2 + 2;
  piVar2 = param_2 + 1;
  local_8 = (undefined2 *)*piVar2;
  iVar3 = FUN_6b853cea(local_8,*puVar1,param_1,piVar2,(int *)puVar1);
  if (-1 < iVar3) {
    *puVar1 = *puVar1 - 2;
    *piVar2 = *piVar2 + 2;
    puVar5 = local_30;
    for (iVar3 = 10; iVar3 != 0; iVar3 = iVar3 + -1) {
      *puVar5 = 0;
      puVar5 = puVar5 + 1;
    }
    local_18 = local_8;
    local_c = *param_1;
    iVar3 = NtQueryInformationJobObject(*param_2,0x1f,local_30,0x28,0);
    if (-1 < iVar3) {
      puVar5 = local_30;
      puVar6 = (undefined4 *)(param_2[4] * 0x28 + param_2[3]);
      for (iVar4 = 10; iVar4 != 0; iVar4 = iVar4 + -1) {
        *puVar6 = *puVar5;
        puVar5 = puVar5 + 1;
        puVar6 = puVar6 + 1;
      }
      param_2[4] = param_2[4] + 1;
    }
  }
  RtlNtStatusToDosError(iVar3);
  return;
}



DWORD __fastcall FUN_6b853802(LPVOID param_1,LPVOID *param_2,int *param_3)

{
  HANDLE pvVar1;
  int iVar2;
  SIZE_T SVar3;
  LPVOID *ppvVar4;
  DWORD DVar5;
  DWORD dwFlags;
  LPVOID pvVar6;
  SIZE_T dwBytes;
  LPVOID local_24 [2];
  int local_1c;
  LPVOID local_18;
  int local_10;
  int local_c;
  LPVOID local_8;
  
  ppvVar4 = local_24;
  local_8 = param_1;
  for (iVar2 = 7; iVar2 != 0; iVar2 = iVar2 + -1) {
    *ppvVar4 = (LPVOID)0x0;
    ppvVar4 = ppvVar4 + 1;
  }
  while( true ) {
    if (local_18 != (LPVOID)0x0) {
      DVar5 = 0;
      pvVar6 = local_18;
      pvVar1 = GetProcessHeap();
      HeapFree(pvVar1,DVar5,pvVar6);
    }
    ppvVar4 = local_24;
    for (iVar2 = 7; iVar2 != 0; iVar2 = iVar2 + -1) {
      *ppvVar4 = (LPVOID)0x0;
      ppvVar4 = ppvVar4 + 1;
    }
    DVar5 = FUN_6b853608(FUN_6b822220,local_24);
    if (DVar5 != 0) goto LAB_6b8538b4;
    SVar3 = local_c * 0x2a + local_10;
    dwBytes = SVar3;
    pvVar1 = GetProcessHeap();
    local_18 = HeapAlloc(pvVar1,DVar5,dwBytes);
    if (local_18 == (LPVOID)0x0) break;
    local_24[0] = local_8;
    local_24[1] = (LPVOID)((int)local_18 + local_c * 0x28);
    local_1c = SVar3 + local_c * -0x28;
    DVar5 = FUN_6b853608(FUN_6b853780,local_24);
    if (((DVar5 != 0) && (DVar5 != 0x7a)) || (DVar5 != 0x7a)) goto LAB_6b8538ab;
  }
  DVar5 = 0xe;
LAB_6b8538ab:
  if (DVar5 != 0) {
LAB_6b8538b4:
    if (local_18 != (LPVOID)0x0) {
      dwFlags = 0;
      pvVar6 = local_18;
      pvVar1 = GetProcessHeap();
      HeapFree(pvVar1,dwFlags,pvVar6);
    }
    if (DVar5 != 0) {
      return DVar5;
    }
  }
  *param_2 = local_18;
  *param_3 = local_c;
  return DVar5;
}



void __fastcall FUN_6b8538e2(undefined4 param_1,void *param_2,undefined4 *param_3)

{
  HANDLE pvVar1;
  undefined4 *puVar2;
  int iVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  DWORD DVar6;
  SIZE_T dwBytes;
  undefined4 local_40 [6];
  undefined4 *local_28;
  ushort local_1c;
  undefined4 local_14;
  ushort local_10;
  int local_c;
  
  puVar2 = local_40;
  local_14 = param_1;
  for (iVar3 = 10; iVar3 != 0; iVar3 = iVar3 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  iVar3 = FUN_6b82157b((undefined4 *)&local_10,param_2);
  if (-1 < iVar3) {
    dwBytes = local_10 + 0x2a;
    DVar6 = 0;
    pvVar1 = GetProcessHeap();
    puVar2 = (undefined4 *)HeapAlloc(pvVar1,DVar6,dwBytes);
    local_c = FUN_6b853c92((undefined2 *)(puVar2 + 10),local_10 + 2,&local_10);
    if (-1 < local_c) {
      local_28 = puVar2 + 10;
      local_1c = local_10;
      local_c = NtQueryInformationJobObject(local_14,0x1f,local_40,0x28,0);
      if (-1 < local_c) {
        puVar4 = local_40;
        puVar5 = puVar2;
        for (iVar3 = 10; iVar3 != 0; iVar3 = iVar3 + -1) {
          *puVar5 = *puVar4;
          puVar4 = puVar4 + 1;
          puVar5 = puVar5 + 1;
        }
        *param_3 = puVar2;
        iVar3 = local_c;
        goto LAB_6b853986;
      }
    }
    iVar3 = local_c;
    if (puVar2 != (undefined4 *)0x0) {
      DVar6 = 0;
      pvVar1 = GetProcessHeap();
      HeapFree(pvVar1,DVar6,puVar2);
      iVar3 = local_c;
    }
  }
LAB_6b853986:
  RtlNtStatusToDosError(iVar3);
  return;
}



HANDLE CreateJobObjectA(LPSECURITY_ATTRIBUTES lpJobAttributes,LPCSTR lpName)

{
  int iVar1;
  HANDLE pvVar2;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x539a0  215  CreateJobObjectA
  if (lpName == (LPCSTR)0x0) {
    local_8 = (LPCWSTR)0x0;
  }
  else {
    iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpName);
    if (iVar1 == 0) {
      return (HANDLE)0x0;
    }
  }
  pvVar2 = CreateJobObjectW(lpJobAttributes,local_8);
  if (lpName != (LPCSTR)0x0) {
    RtlFreeUnicodeString(local_c);
  }
  return pvVar2;
}



HANDLE CreateJobObjectW(LPSECURITY_ATTRIBUTES lpJobAttributes,LPCWSTR lpName)

{
  int iVar1;
  undefined *puVar2;
  undefined4 uVar3;
  undefined local_2c [24];
  undefined local_14 [8];
  HANDLE local_c;
  undefined4 local_8;
  
                    // 0x539f0  216  CreateJobObjectW
  if (lpName == (LPCWSTR)0x0) {
    puVar2 = (undefined *)0x0;
  }
  else {
    RtlInitUnicodeString(local_14,lpName);
    puVar2 = local_14;
  }
  iVar1 = BaseFormatObjectAttributes(local_2c,lpJobAttributes,puVar2,&local_8);
  if ((-1 < iVar1) && (iVar1 = NtCreateJobObject(&local_c,0x1f003f,local_8), -1 < iVar1)) {
    if (iVar1 == 0x40000000) {
      uVar3 = 0xb7;
    }
    else {
      uVar3 = 0;
    }
    RtlSetLastWin32Error(uVar3);
    return local_c;
  }
  BaseSetLastNTError(iVar1);
  return (HANDLE)0x0;
}



BOOL CreateJobSet(ULONG NumJob,PJOB_SET_ARRAY UserJobSet,ULONG Flags)

{
  int iVar1;
  
                    // 0x53a70  217  CreateJobSet
  iVar1 = NtCreateJobSet(NumJob,UserJobSet,Flags);
  if (-1 >= iVar1) {
    BaseSetLastNTError(iVar1);
  }
  return (uint)(-1 < iVar1);
}



HANDLE OpenJobObjectA(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCSTR lpName)

{
  int iVar1;
  HANDLE pvVar2;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x53aa0  1034  OpenJobObjectA
  if (lpName == (LPCSTR)0x0) {
    local_8 = (LPCWSTR)0x0;
  }
  else {
    iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpName);
    if (iVar1 == 0) {
      return (HANDLE)0x0;
    }
  }
  pvVar2 = OpenJobObjectW(dwDesiredAccess,bInheritHandle,local_8);
  if (lpName != (LPCSTR)0x0) {
    RtlFreeUnicodeString(local_c);
  }
  return pvVar2;
}



HANDLE OpenJobObjectW(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCWSTR lpName)

{
  int iVar1;
  undefined4 local_2c;
  undefined4 local_28;
  undefined *local_24;
  uint local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined local_14 [8];
  HANDLE local_c;
  undefined4 local_8;
  
                    // 0x53b00  1035  OpenJobObjectW
  if (lpName == (LPCWSTR)0x0) {
    iVar1 = -0x3ffffff3;
  }
  else {
    RtlInitUnicodeString(local_14,lpName);
    iVar1 = BaseGetNamedObjectDirectory(&local_8);
    if (-1 < iVar1) {
      local_28 = local_8;
      local_2c = 0x18;
      local_1c = 0;
      local_18 = 0;
      local_20 = -(uint)(bInheritHandle != 0) & 2;
      local_24 = local_14;
      BasepAdjustObjectAttributesForPrivateNamespace(&local_2c);
      iVar1 = NtOpenJobObject(&local_c,dwDesiredAccess,&local_2c);
      if (-1 < iVar1) {
        return local_c;
      }
    }
  }
  BaseSetLastNTError(iVar1);
  return (HANDLE)0x0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void QueryIoRateControlInformationJobObject
               (LPVOID param_1,void *param_2,LPVOID *param_3,int *param_4)

{
  undefined4 uVar1;
  undefined4 uVar2;
  uint uVar3;
  DWORD DVar4;
  undefined4 extraout_ECX;
  undefined4 extraout_EDX;
  int *local_4c;
  LPVOID *local_48;
  uint local_44;
  _EVENT_DATA_DESCRIPTOR local_40 [2];
  uint *local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  uint local_c;
  
                    // 0x53b90  1103  QueryIoRateControlInformationJobObject
  local_c = DAT_6b8b0140 ^ (uint)&local_4c;
  local_48 = param_3;
  local_4c = param_4;
  FUN_6b854228(&DAT_6b8b0040);
  if (5 < _DAT_6b8b0040) {
    uVar3 = FUN_6b839446((int)&DAT_6b8b0040);
    if ((char)uVar3 != '\0') {
      local_18 = 4;
      local_44 = (uint)(param_2 != (void *)0x0);
      local_1c = 0;
      local_14 = 0;
      local_20 = &local_44;
      FUN_6b839476((int)&DAT_6b8b0040,&DAT_6b886bee,extraout_ECX,extraout_ECX,3,local_40);
    }
  }
  uVar2 = DAT_6b8b005c;
  uVar1 = DAT_6b8b0058;
  _DAT_6b8b0040 = 0;
  DAT_6b8b0058 = 0;
  DAT_6b8b005c = 0;
  EventUnregister((REGHANDLE)CONCAT44(uVar2,uVar1));
  if (param_2 == (void *)0x0) {
    DVar4 = FUN_6b853802(param_1,local_48,local_4c);
  }
  else {
    DVar4 = FUN_6b8538e2(param_1,param_2,local_48);
    *local_4c = 1;
  }
  RtlSetLastWin32Error(DVar4);
  FUN_6b8224af(local_c ^ (uint)&local_4c,extraout_EDX);
  return;
}



void __fastcall FUN_6b853c92(undefined2 *param_1,uint param_2,ushort *param_3)

{
  int iVar1;
  uint uVar2;
  undefined2 *local_c;
  undefined2 *local_8;
  
  uVar2 = param_2 >> 1;
  iVar1 = 0;
  if ((uVar2 == 0) || (0x7fff < uVar2)) {
    iVar1 = -0x3ffffff3;
  }
  if (-1 < iVar1) {
    local_c = param_1;
    local_8 = param_1;
    iVar1 = FUN_6b853e02(param_3,&local_c,(uint *)&local_8);
    if (iVar1 < 0) {
      *param_1 = 0;
    }
    else {
      FUN_6b853daa(param_1,uVar2,(int *)0x0,(int)local_c,(int)local_8);
    }
  }
  return;
}



int __fastcall
FUN_6b853cea(undefined2 *param_1,uint param_2,ushort *param_3,int *param_4,int *param_5)

{
  int iVar1;
  uint uVar2;
  int local_10;
  int local_c;
  uint local_8;
  
  uVar2 = param_2 >> 1;
  iVar1 = 0;
  if ((uVar2 == 0) || (0x7fff < uVar2)) {
    iVar1 = -0x3ffffff3;
  }
  if (iVar1 < 0) {
    return iVar1;
  }
  iVar1 = FUN_6b853e02(param_3,&local_10,&local_8);
  if (iVar1 < 0) {
    if (uVar2 != 0) {
      *param_1 = 0;
    }
LAB_6b853d7a:
    if (-1 < iVar1) goto LAB_6b853d86;
  }
  else {
    if (uVar2 == 0) {
      if (local_8 != 0) {
        if (param_1 == (undefined2 *)0x0) {
          return -0x3ffffff3;
        }
        iVar1 = -0x7ffffffb;
      }
      goto LAB_6b853d7a;
    }
    local_c = 0;
    iVar1 = FUN_6b853daa(param_1,uVar2,&local_c,local_10,local_8);
    uVar2 = uVar2 - local_c;
    param_1 = param_1 + local_c;
    if (-1 < iVar1) goto LAB_6b853d7a;
  }
  if (iVar1 != -0x7ffffffb) {
    return iVar1;
  }
LAB_6b853d86:
  if (param_4 != (int *)0x0) {
    *param_4 = (int)param_1;
  }
  if (param_5 != (int *)0x0) {
    *param_5 = (param_2 & 1) + uVar2 * 2;
  }
  return iVar1;
}



int __fastcall FUN_6b853daa(undefined2 *param_1,int param_2,int *param_3,int param_4,int param_5)

{
  int iVar1;
  int iVar2;
  
  iVar1 = 0;
  if (param_2 != 0) {
    iVar2 = param_4 - (int)param_1;
    do {
      if (param_5 == 0) break;
      *param_1 = *(undefined2 *)(iVar2 + (int)param_1);
      param_1 = param_1 + 1;
      param_5 = param_5 + -1;
      iVar1 = iVar1 + 1;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
    if (param_2 != 0) goto LAB_6b853ddf;
  }
  param_1 = param_1 + -1;
  iVar1 = iVar1 + -1;
LAB_6b853ddf:
  *param_1 = 0;
  if (param_3 != (int *)0x0) {
    *param_3 = iVar1;
  }
  return (-(uint)(param_2 != 0) & 0x7ffffffb) + 0x80000005;
}



void __fastcall FUN_6b853e02(ushort *param_1,undefined4 *param_2,uint *param_3)

{
  int iVar1;
  
  *param_3 = 0;
  *param_2 = 0;
  iVar1 = FUN_6b853e38(param_1);
  if ((-1 < iVar1) && (param_1 != (ushort *)0x0)) {
    *param_2 = *(undefined4 *)(param_1 + 2);
    *param_3 = (uint)(*param_1 >> 1);
  }
  return;
}



undefined4 __fastcall FUN_6b853e38(ushort *param_1)

{
  ushort uVar1;
  ushort uVar2;
  undefined4 uVar3;
  
  uVar3 = 0;
  uVar1 = *param_1;
  if ((((((uVar1 & 1) != 0) || (uVar2 = param_1[1], (uVar2 & 1) != 0)) || (uVar2 < uVar1)) ||
      (uVar2 == 0xffff)) || ((*(int *)(param_1 + 2) == 0 && ((uVar1 != 0 || (uVar2 != 0)))))) {
    uVar3 = 0xc000000d;
  }
  return uVar3;
}



BOOL SetInformationJobObject
               (HANDLE hJob,JOBOBJECTINFOCLASS JobObjectInformationClass,
               LPVOID lpJobObjectInformation,DWORD cbJobObjectInformationLength)

{
  BOOL BVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 uVar2;
  bool bVar3;
  undefined8 uVar4;
  int local_8c;
  undefined4 local_88;
  HANDLE local_84;
  undefined local_80 [16];
  byte local_70;
  int local_5c;
  uint local_c;
  
                    // 0x53e80  1331  SetInformationJobObject
  local_c = DAT_6b8b0140 ^ (uint)&local_8c;
  local_88 = 0;
  local_84 = hJob;
  local_8c = -0x3fffffff;
  if (JobObjectInformationClass == JobObjectBasicLimitInformation) {
    bVar3 = cbJobObjectInformationLength == 0x30;
LAB_6b853ed7:
    if (!bVar3) {
      BaseSetLastNTError(0xc0000004);
      uVar2 = extraout_EDX;
      goto LAB_6b853fbb;
    }
    memcpy(local_80,lpJobObjectInformation,cbJobObjectInformationLength);
    if ((local_70 & 0x20) != 0) {
      if (local_5c == 0x20) {
LAB_6b853f58:
        local_5c = 2;
      }
      else if (local_5c == 0x40) {
        local_5c = 1;
      }
      else if (local_5c == 0x80) {
        local_5c = 3;
      }
      else if (local_5c == 0x100) {
        local_5c = 4;
      }
      else if (local_5c == 0x4000) {
        local_5c = 5;
      }
      else {
        if (local_5c != 0x8000) goto LAB_6b853f58;
        local_5c = 6;
      }
    }
    lpJobObjectInformation = local_80;
    if ((local_70 & 1) != 0) {
      local_8c = 0xe;
      local_8c = RtlAcquirePrivilege(&local_8c,1,0,&local_88);
    }
  }
  else if (JobObjectInformationClass == JobObjectExtendedLimitInformation) {
    bVar3 = cbJobObjectInformationLength == 0x70;
    goto LAB_6b853ed7;
  }
  uVar4 = NtSetInformationJobObject
                    (local_84,JobObjectInformationClass,lpJobObjectInformation,
                     cbJobObjectInformationLength);
  uVar2 = (undefined4)((ulonglong)uVar4 >> 0x20);
  if (-1 < local_8c) {
    RtlReleasePrivilege(local_88);
    local_88 = 0;
    uVar2 = extraout_EDX_00;
  }
  if ((int)uVar4 < 0) {
    BaseSetLastNTError((int)uVar4);
    uVar2 = extraout_EDX_01;
  }
LAB_6b853fbb:
  BVar1 = FUN_6b8224af(local_c ^ (uint)&local_8c,uVar2);
  return BVar1;
}



// WARNING: Could not reconcile some variable overlaps
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void SetIoRateControlInformationJobObject(undefined4 param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  int iVar2;
  uint uVar3;
  undefined4 uVar4;
  undefined4 extraout_EDX;
  undefined2 local_cc [2];
  uint local_c8;
  undefined4 local_c4;
  undefined4 local_bc;
  undefined4 local_b8;
  undefined4 local_b4;
  undefined4 local_b0;
  undefined4 local_ac;
  uint local_a8;
  undefined4 local_a4;
  void *local_a0;
  undefined4 local_9c;
  undefined4 local_98;
  uint local_94;
  undefined4 local_90;
  undefined4 local_8c;
  undefined4 local_88;
  undefined4 local_84;
  _EVENT_DATA_DESCRIPTOR local_80 [2];
  undefined4 *local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined4 local_54;
  undefined4 *local_50;
  undefined4 local_4c;
  undefined4 local_48;
  undefined4 local_44;
  uint *local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 *local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined2 *local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  uint local_c;
  
                    // 0x53fe0  1332  SetIoRateControlInformationJobObject
  local_c = DAT_6b8b0140 ^ (uint)local_cc;
  local_b8 = *param_2;
  local_b4 = param_2[1];
  local_b0 = param_2[2];
  local_ac = param_2[3];
  local_9c = param_2[7];
  local_98 = param_2[8];
  local_a0 = (void *)param_2[6];
  local_a8 = 0;
  local_a4 = 0;
  local_94 = 0;
  iVar2 = FUN_6b82157b(&local_c8,local_a0);
  if (-1 < iVar2) {
    local_94 = local_94 & 0xffff0000 | local_c8 & 0xffff;
    FUN_6b854228(&DAT_6b8b0040);
    if (5 < _DAT_6b8b0040) {
      uVar3 = FUN_6b839446((int)&DAT_6b8b0040);
      if ((char)uVar3 != '\0') {
        local_90 = local_b8;
        local_8c = local_b4;
        local_60 = &local_90;
        local_88 = local_b0;
        local_84 = local_ac;
        local_50 = &local_88;
        local_c8 = local_a8;
        local_c4 = local_a4;
        local_40 = &local_c8;
        local_bc = local_9c;
        local_30 = &local_bc;
        local_cc[0] = (undefined2)local_94;
        local_20 = local_cc;
        local_58 = 8;
        local_48 = 8;
        local_38 = 8;
        local_5c = 0;
        local_54 = 0;
        local_4c = 0;
        local_44 = 0;
        local_3c = 0;
        local_34 = 0;
        local_2c = 0;
        local_28 = 4;
        local_24 = 0;
        local_1c = 0;
        local_18 = 2;
        local_14 = 0;
        FUN_6b839476((int)&DAT_6b8b0040,&DAT_6b886b73,8,8,7,local_80);
      }
    }
    uVar1 = DAT_6b8b005c;
    uVar4 = DAT_6b8b0058;
    _DAT_6b8b0040 = 0;
    DAT_6b8b0058 = 0;
    DAT_6b8b005c = 0;
    EventUnregister((REGHANDLE)CONCAT44(uVar1,uVar4));
    iVar2 = NtSetInformationJobObject(param_1,0x1f,&local_b8,0x28);
  }
  uVar4 = RtlNtStatusToDosError(iVar2);
  RtlSetLastWin32Error(uVar4);
  FUN_6b8224af(local_c ^ (uint)local_cc,extraout_EDX);
  return;
}



BOOL TerminateJobObject(HANDLE hJob,UINT uExitCode)

{
  int iVar1;
  
                    // 0x54200  1425  TerminateJobObject
  iVar1 = NtTerminateJobObject(hJob,uExitCode);
  if (-1 >= iVar1) {
    BaseSetLastNTError(iVar1);
  }
  return (uint)(-1 < iVar1);
}



void __fastcall FUN_6b854228(PVOID param_1)

{
  int iVar1;
  ULONG UVar2;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar3;
  undefined local_18 [8];
  undefined4 uStack16;
  undefined4 uStack12;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  iVar1 = *(int *)((int)param_1 + 4);
  local_18._0_4_ = *(ulong *)(iVar1 + -0x10);
  local_18._4_4_ = *(undefined4 *)(iVar1 + -0xc);
  uStack16 = *(undefined4 *)(iVar1 + -8);
  uStack12 = *(undefined4 *)(iVar1 + -4);
  *(undefined4 *)((int)param_1 + 0x20) = 0;
  *(undefined4 *)((int)param_1 + 0x24) = 0;
  UVar2 = EventRegister((LPCGUID)local_18,FID_conflict___TlgEnableCallback_36,param_1,
                        (PREGHANDLE)((int)param_1 + 0x18));
  uVar3 = extraout_EDX;
  if (UVar2 == 0) {
    EventSetInformation(*(undefined4 *)(PREGHANDLE)((int)param_1 + 0x18),
                        *(undefined4 *)((int)param_1 + 0x1c),2,*(undefined2 **)((int)param_1 + 4),
                        **(undefined2 **)((int)param_1 + 4));
    uVar3 = extraout_EDX_00;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar3);
  return;
}



// Library Function - Multiple Matches With Different Base Names
//  __TlgEnableCallback@36
//  __tlgEnableCallback@36
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release
// EnableCallback parameter of EventRegister
// 

void FID_conflict___TlgEnableCallback_36
               (undefined4 param_1,int param_2,uint param_3,int param_4,int param_5,int param_6,
               int param_7,undefined4 param_8,int *param_9)

{
  code *pcVar1;
  int iVar2;
  
  if (param_9 != (int *)0x0) {
    if (param_2 == 0) {
      *param_9 = 0;
    }
    else if (param_2 == 1) {
      if ((char)param_3 == '\0') {
        iVar2 = 0x100;
      }
      else {
        iVar2 = (param_3 & 0xff) + 1;
      }
      *param_9 = iVar2;
      param_9[2] = param_4;
      param_9[3] = param_5;
      param_9[4] = param_6;
      param_9[5] = param_7;
    }
    pcVar1 = (code *)param_9[8];
    if (pcVar1 != (code *)0x0) {
      iVar2 = param_9[9];
      _guard_check_icall();
      (*pcVar1)(param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8,iVar2);
    }
  }
  return;
}



void * __fastcall FUN_6b85432b(uint param_1)

{
  void *_Dst;
  int iVar1;
  int in_FS_OFFSET;
  
  _Dst = (void *)FUN_6b854391(0x470);
  if (_Dst != (void *)0x0) {
    memset(_Dst,0,0x470);
    *(undefined *)((int)_Dst + 0x45d) = 1;
    if ((param_1 != 0) && (iVar1 = FUN_6b856631((size_t *)((int)_Dst + 0x434),param_1), iVar1 == 0))
    {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,_Dst);
      _Dst = (void *)0x0;
    }
    if (_Dst != (void *)0x0) {
      return _Dst;
    }
  }
  RtlSetLastWin32Error(8);
  return _Dst;
}



void __fastcall FUN_6b854391(undefined4 param_1)

{
  int *piVar1;
  int in_FS_OFFSET;
  
  piVar1 = (int *)KernelBaseGetGlobalData();
  RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*piVar1 + 0x40000,param_1);
  return;
}



void __fastcall FUN_6b8543b6(HANDLE param_1,int param_2)

{
  uint *puVar1;
  int iVar2;
  DWORD DVar3;
  int iVar4;
  uint extraout_EDX;
  uint uVar5;
  uint uVar6;
  undefined local_44 [4];
  int local_40;
  HANDLE local_3c;
  int local_38;
  uint local_34;
  DWORD local_30;
  uint local_2c [2];
  char local_21;
  uint local_20;
  uint local_1c;
  uint local_18;
  uint local_14;
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_21 = '\0';
  uVar6 = 0x1000;
  local_3c = param_1;
  local_30 = GetFileSize(param_1,local_2c);
  if ((local_30 != 0xffffffff) || (DVar3 = GetLastError(), uVar5 = extraout_EDX, DVar3 == 0)) {
    local_20 = 0;
    local_1c = 0;
    local_14 = local_2c[0];
    local_18 = local_30;
    while (iVar4 = FUN_6b856631((size_t *)(param_2 + 0x434),uVar6), iVar4 != 0) {
      local_40 = 0;
      local_38 = NtFsControlFile(param_1,0,0,0,local_44,0x940cf,&local_20,0x10,
                                 *(int *)(param_2 + 0x43c) + *(int *)(param_2 + 0x440),
                                 uVar6 - *(int *)(param_2 + 0x440));
      local_34 = local_30;
      if ((-1 < local_38) || (local_38 == -0x7ffffffb)) {
        if (((local_40 == 0) &&
            (((-1 < local_38 && ((local_20 | local_1c) == 0)) && (-1 < (int)local_2c[0])))) &&
           ((0 < (int)local_2c[0] || (local_30 != 0)))) {
          local_21 = '\x01';
        }
        *(int *)(param_2 + 0x440) = *(int *)(param_2 + 0x440) + local_40;
        iVar4 = *(int *)(param_2 + 0x440);
        iVar2 = *(int *)(param_2 + 0x43c);
        uVar5 = *(uint *)(iVar4 + -8 + iVar2);
        puVar1 = (uint *)(iVar4 + -0x10 + iVar2);
        local_20 = uVar5 + *puVar1;
        local_1c = *(int *)(iVar4 + -4 + iVar2) + *(int *)(iVar4 + -0xc + iVar2) +
                   (uint)CARRY4(uVar5,*puVar1);
      }
      uVar5 = *(uint *)(param_2 + 0x440);
      if (uVar5 + 0x10 <= uVar6) {
        if (-1 < local_38) goto LAB_6b8544f1;
        break;
      }
      uVar6 = uVar6 + 0x1000;
      param_1 = local_3c;
    }
    *(undefined4 *)(param_2 + 0x440) = 0;
    uVar5 = 0;
LAB_6b8544f1:
    if (((local_21 == '\0') && (uVar5 < 0x10)) ||
       ((puVar1 = *(uint **)(param_2 + 0x43c), local_21 == '\0' &&
        ((((*puVar1 | puVar1[1]) == 0 && (puVar1[2] == local_30)) && (puVar1[3] == local_2c[0]))))))
    {
      *(undefined4 *)(param_2 + 0x440) = 0;
    }
    else {
      *(uint *)(param_2 + 0x440) = uVar5 + 0x10;
      *(DWORD *)(uVar5 + (int)puVar1) = local_30;
      *(undefined4 *)(uVar5 + 8 + (int)puVar1) = 0;
      *(undefined4 *)(uVar5 + 0xc + (int)puVar1) = 0;
      *(uint *)(uVar5 + 4 + (int)puVar1) = local_2c[0];
      *(undefined *)(param_2 + 0x448) = 1;
      uVar5 = uVar5 + 0x10;
    }
  }
  FUN_6b8224af(local_c ^ (uint)&stack0xfffffffc,uVar5);
  return;
}



BOOL BackupRead(HANDLE hFile,LPBYTE lpBuffer,DWORD nNumberOfBytesToRead,LPDWORD lpNumberOfBytesRead,
               BOOL bAbort,BOOL bProcessSecurity,LPVOID *lpContext)

{
  uint *puVar1;
  BOOL BVar2;
  int *piVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  DWORD extraout_EDX;
  DWORD extraout_EDX_00;
  DWORD extraout_EDX_01;
  DWORD extraout_EDX_02;
  DWORD extraout_EDX_03;
  bool bVar7;
  undefined auStack92 [4];
  size_t local_58;
  LPBYTE local_54;
  LPDWORD local_50;
  DWORD local_4c;
  undefined local_48;
  int **local_44;
  undefined local_40 [8];
  undefined local_38 [32];
  int local_18;
  uint local_c;
  
                    // 0x54570  42  BackupRead
  local_c = DAT_6b8b0140 ^ (uint)auStack92;
  piVar3 = (int *)*lpContext;
  local_54 = lpBuffer;
  local_44 = (int **)lpContext;
  local_4c = nNumberOfBytesToRead;
  local_50 = lpNumberOfBytesRead;
  local_48 = (undefined)bProcessSecurity;
  if (bAbort == 0) {
    *lpNumberOfBytesRead = 0;
    if ((piVar3 == (int *)0xffffffff) || (nNumberOfBytesToRead == 0)) goto LAB_6b8545cf;
    if (piVar3 == (int *)0x0) {
      piVar3 = (int *)FUN_6b85432b(0x400);
      nNumberOfBytesToRead = extraout_EDX_00;
      if (piVar3 == (int *)0x0) goto LAB_6b8545cf;
      iVar5 = NtQueryInformationFile(hFile,local_40,local_38,0x28,4);
      if (iVar5 < 0) {
        BaseSetLastNTError(iVar5);
        nNumberOfBytesToRead = extraout_EDX_03;
        goto LAB_6b8545cf;
      }
      piVar3[0x118] = local_18;
    }
    else if (*(int *)(&DAT_6b889090 + piVar3[0x10a] * 4) == 0) goto LAB_6b8545bc;
    *local_44 = piVar3;
    do {
      uVar6 = 0;
      if (*(char *)((int)piVar3 + 0x45d) == '\0') {
        uVar4 = piVar3[0x108];
        uVar6 = piVar3[0x109];
      }
      else {
        piVar3[2] = 0;
        piVar3[3] = 0;
        piVar3[0x108] = 0;
        piVar3[0x109] = 0;
        piVar3[0x111] = 0;
        piVar3[0x110] = 0;
        *(undefined *)((int)piVar3 + 0x45e) = 0;
        uVar4 = uVar6;
      }
      BVar2 = 1;
      if ((*(char *)((int)piVar3 + 0x45d) != '\0') ||
         ((-1 < (int)uVar6 && ((0 < (int)uVar6 || ((uint)piVar3[0x10b] <= uVar4)))))) {
        iVar5 = *(int *)(&DAT_6b889090 + piVar3[0x10a] * 4);
        if (iVar5 < 8) {
          if (iVar5 == 7) {
            BVar2 = FUN_6b854ebf((int)hFile,piVar3,&local_54);
          }
          else if (iVar5 == 1) {
            BVar2 = FUN_6b854b89(hFile,piVar3,&local_54);
          }
          else if (iVar5 == 2) {
            BVar2 = FUN_6b854c7f(hFile,piVar3,&local_54);
          }
          else if (iVar5 == 3) {
            BVar2 = FUN_6b8550ad((uint)hFile,piVar3,&local_54);
          }
          else {
            if (iVar5 != 4) goto LAB_6b854731;
            BVar2 = FUN_6b85486d(hFile,piVar3,&local_54);
          }
        }
        else if (iVar5 == 8) {
          BVar2 = FUN_6b854f71(hFile,piVar3,&local_54);
        }
        else if (iVar5 == 10) {
          BVar2 = FUN_6b855304((int)hFile,piVar3,&local_54);
        }
        else if (iVar5 == 0xb) {
          BVar2 = FUN_6b854d5f(hFile,piVar3,&local_54);
        }
        else {
LAB_6b854731:
          *(undefined *)((int)piVar3 + 0x45d) = 1;
          piVar3[0x10a] = piVar3[0x10a] + 1;
        }
      }
      nNumberOfBytesToRead = piVar3[0x109];
      uVar6 = piVar3[0x10b];
      uVar4 = piVar3[0x108];
      if ((int)nNumberOfBytesToRead < 1) {
        if (((int)nNumberOfBytesToRead < 0) || (uVar4 < uVar6)) {
          bVar7 = -1 < (int)(-nNumberOfBytesToRead - (uint)(uVar6 < uVar4));
          if ((-nNumberOfBytesToRead != (uint)(uVar6 < uVar4) && bVar7) ||
             ((bVar7 && (local_4c <= uVar6 - uVar4)))) {
            iVar5 = piVar3[0x108];
            local_58 = local_4c;
          }
          else {
            iVar5 = piVar3[0x108];
            local_58 = uVar6 - iVar5;
          }
          memcpy(local_54,(void *)(iVar5 + (int)piVar3),local_58);
          puVar1 = (uint *)(piVar3 + 0x108);
          uVar6 = *puVar1;
          *puVar1 = *puVar1 + local_58;
          piVar3[0x109] = piVar3[0x109] + (uint)CARRY4(uVar6,local_58);
          local_4c = local_4c - local_58;
          *local_50 = *local_50 + local_58;
          local_54 = local_54 + local_58;
          uVar6 = piVar3[0x10b];
          uVar4 = piVar3[0x108];
          nNumberOfBytesToRead = piVar3[0x109];
        }
        if ((-1 < (int)nNumberOfBytesToRead) &&
           ((0 < (int)nNumberOfBytesToRead || (uVar6 <= uVar4)))) goto LAB_6b854813;
      }
      else {
LAB_6b854813:
        iVar5 = FUN_6b8555ae(piVar3);
        nNumberOfBytesToRead = extraout_EDX_01;
        if (iVar5 == 0) goto LAB_6b8545cf;
      }
      if (BVar2 == 0) goto LAB_6b8545cf;
    } while ((*(int *)(&DAT_6b889090 + piVar3[0x10a] * 4) != 0) && (local_4c != 0));
    if (*local_50 == 0) {
      FUN_6b856689(hFile);
      FUN_6b8565a6((int *)local_44);
      nNumberOfBytesToRead = extraout_EDX_02;
    }
  }
  else {
    if (piVar3 == (int *)0x0) goto LAB_6b8545cf;
LAB_6b8545bc:
    FUN_6b856689(hFile);
    FUN_6b8565a6((int *)local_44);
    nNumberOfBytesToRead = extraout_EDX;
  }
LAB_6b8545cf:
  BVar2 = FUN_6b8224af(local_c ^ (uint)auStack92,nNumberOfBytesToRead);
  return BVar2;
}



BOOL __fastcall FUN_6b85486d(undefined4 param_1,int *param_2,LPVOID *param_3)

{
  size_t *psVar1;
  HANDLE *ppvVar2;
  int iVar3;
  HANDLE pvVar4;
  int iVar5;
  BOOL BVar6;
  DWORD DVar7;
  uint uVar8;
  int *piVar9;
  undefined4 local_38;
  undefined4 local_34;
  undefined2 *local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined local_20 [8];
  uint local_18;
  int local_14;
  undefined2 local_10;
  undefined2 local_e;
  int *local_c;
  
  if ((*(char *)((int)param_2 + 0x465) == '\0') || ((param_2[0x11a] & 0x40000U) != 0)) {
    local_c = (int *)param_1;
    if (*(char *)((int)param_2 + 0x45d) == '\0') {
      pvVar4 = (HANDLE)param_2[0x10c];
      if (pvVar4 == (HANDLE)0xffffffff) {
        piVar9 = (int *)(param_2[0x116] + param_2[0x113]);
        param_2[2] = 0;
        param_2[3] = 0;
        local_10 = *(undefined2 *)(piVar9 + 1);
        local_c = piVar9 + 6;
        local_30 = &local_10;
        local_38 = 0x18;
        local_2c = 0x40;
        local_28 = 0;
        local_24 = 0;
        local_34 = param_1;
        local_e = local_10;
        iVar5 = NtOpenFile(param_2 + 0x10c,0x100081,&local_38,local_20,7,
                           (param_2[0x118] & 0x400U) << 0xb | 0x4020);
        if (iVar5 < 0) {
          param_2[0x113] = param_2[0x113] + *piVar9;
          if (*piVar9 != 0) {
            param_2[2] = 1;
            *(undefined *)((int)param_2 + 0x45e) = 1;
          }
        }
        else {
          BVar6 = LockFile((HANDLE)param_2[0x10c],0,0,0xffffffff,0xffffffff);
          if (BVar6 != 0) {
            param_2[1] = 0;
            param_2[4] = piVar9[1];
            param_2[0x10b] = piVar9[1] + 0x14;
            memcpy(param_2 + 5,piVar9 + 6,piVar9[1]);
            if (*piVar9 != 0) {
              param_2[0x113] = param_2[0x113] + *piVar9;
              *(undefined *)((int)param_2 + 0x45e) = 1;
            }
            iVar5 = FUN_6b8564dd(piVar9[1],(int)(piVar9 + 6));
            if (iVar5 == 0) {
              return 1;
            }
            *param_2 = 4;
            ppvVar2 = (HANDLE *)(param_2 + 0x10c);
            param_2[0x110] = 0;
            param_2[0x111] = 0;
            *(undefined *)(param_2 + 0x112) = 0;
            BVar6 = GetFileInformationByHandleEx(*ppvVar2,FileAttributeTagInfo,&local_18,8);
            if (BVar6 == 0) {
              local_18 = 0;
            }
            if (((local_18 & 0x200) != 0) &&
               (iVar5 = FUN_6b8543b6(*ppvVar2,(int)param_2), iVar5 != 0)) {
              param_2[2] = 0;
              param_2[3] = 0;
              param_2[1] = 8;
              return 1;
            }
            DVar7 = GetFileSize(*ppvVar2,(LPDWORD)(param_2 + 3));
            param_2[2] = DVar7;
            return 1;
          }
        }
        RtlSetLastWin32Error(0x20);
        return 0;
      }
      if (((0 < param_2[0x109]) ||
          ((-1 < param_2[0x109] && ((uint)param_2[0x10b] <= (uint)param_2[0x108])))) &&
         ((*param_2 == 4 || (*param_2 == 9)))) {
        BVar6 = FUN_6b8551df(pvVar4,param_2,param_3);
        return BVar6;
      }
    }
    else if ((param_2[0x118] & 0x4010U) != 0x4000) {
      if (*(char *)(param_2 + 0x117) == '\0') {
        psVar1 = (size_t *)(param_2 + 0x114);
        uVar8 = 0x400;
        while( true ) {
          iVar5 = FUN_6b856631(psVar1,uVar8);
          if (iVar5 == 0) {
            return 0;
          }
          iVar5 = NtQueryInformationFile(local_c,&local_18,param_2[0x116],*psVar1,0x16);
          if ((-1 < iVar5) && (local_14 != 0)) break;
          if ((iVar5 != -0x7ffffffb) && (iVar5 != -0x3fffffdd)) {
            return 1;
          }
          uVar8 = *psVar1 * 2;
        }
        param_2[0x113] = 0;
        *(undefined *)(param_2 + 0x117) = 1;
      }
      iVar5 = param_2[0x113];
      iVar3 = param_2[0x116];
      param_2[0x10c] = -1;
      *(undefined *)((int)param_2 + 0x45d) = 0;
      if ((3 < *(uint *)(iVar3 + 4 + iVar5)) && (*(short *)(iVar3 + 0x1a + iVar5) == 0x3a)) {
        if (*(int *)(iVar3 + iVar5) == 0) {
          return 1;
        }
        param_2[0x113] = *(int *)(iVar3 + iVar5) + iVar5;
      }
      param_2[2] = 1;
    }
  }
  return 1;
}



void __fastcall FUN_6b854b24(int *param_1,void **param_2)

{
  uint *puVar1;
  void *_Dst;
  uint uVar2;
  int *piVar3;
  int iVar4;
  int *local_8;
  
  local_8 = param_1;
  iVar4 = FUN_6b856568(param_1,(int *)param_2[2],&local_8);
  piVar3 = local_8;
  if (iVar4 != 0) {
    _Dst = *param_2;
    memcpy(_Dst,(void *)((param_1[0x10f] - param_1[0x10b]) + param_1[0x108]),(size_t)local_8);
    puVar1 = (uint *)(param_1 + 0x108);
    uVar2 = *puVar1;
    *puVar1 = *puVar1 + (int)piVar3;
    param_1[0x109] = param_1[0x109] + (uint)CARRY4(uVar2,(uint)piVar3);
                    // WARNING: Load size is inaccurate
    *(int *)param_2[1] = *param_2[1] + (int)piVar3;
    param_2[2] = (void *)((int)param_2[2] - (int)piVar3);
    *param_2 = (void *)((int)_Dst + (int)piVar3);
  }
  return;
}



BOOL __fastcall FUN_6b854b89(HANDLE param_1,int *param_2,LPVOID *param_3)

{
  DWORD DVar1;
  DWORD DVar2;
  int iVar3;
  BOOL BVar4;
  uint local_c [2];
  
  if (*(char *)((int)param_2 + 0x45d) == '\0') {
    BVar4 = FUN_6b8551df(param_1,param_2,param_3);
  }
  else {
    if ((((param_2[0x118] & 0x4000U) == 0) && ((param_2[0x118] & 0x10U) == 0)) &&
       (DVar1 = GetFileSize(param_1,local_c), (DVar1 | local_c[0]) != 0)) {
      if ((DVar1 == 0xffffffff) && (DVar2 = GetLastError(), DVar2 != 0)) {
        return 0;
      }
      *param_2 = 1;
      param_2[1] = 0;
      param_2[4] = 0;
      param_2[0x10b] = 0x14;
      *(undefined *)((int)param_2 + 0x45d) = 0;
      param_2[0x110] = 0;
      param_2[0x111] = 0;
      *(undefined *)(param_2 + 0x112) = 0;
      if (((param_2[0x118] & 0x400200U) == 0x200) &&
         (iVar3 = FUN_6b8543b6(param_1,(int)param_2), iVar3 != 0)) {
        param_2[2] = 0;
        param_2[3] = 0;
        param_2[1] = 8;
      }
      else {
        param_2[2] = DVar1;
        param_2[3] = local_c[0];
        local_c[0] = 0;
        SetFilePointer(param_1,0,(PLONG)local_c,0);
      }
    }
    BVar4 = 1;
  }
  return BVar4;
}



int __fastcall FUN_6b854c7f(undefined4 param_1,int *param_2,void **param_3)

{
  int iVar1;
  undefined local_10 [4];
  int local_c;
  int local_8;
  
  if (*(char *)((int)param_2 + 0x45d) == '\0') {
    if ((-1 < param_2[0x109]) &&
       ((0 < param_2[0x109] || ((uint)param_2[0x10b] <= (uint)param_2[0x108])))) {
      FUN_6b854b24(param_2,param_3);
    }
LAB_6b854d55:
    iVar1 = 1;
  }
  else {
    do {
      iVar1 = NtQueryEaFile(param_1,local_10,param_2[0x10f],param_2[0x10d],0,0,0,0,1);
      if ((-1 < iVar1) && (local_c != 0)) {
        *(undefined2 *)(param_2 + 0x117) = 1;
        *param_2 = 2;
        param_2[1] = 0;
        param_2[4] = 0;
        param_2[0x10b] = 0x14;
        param_2[2] = local_c;
        param_2[3] = 0;
        goto LAB_6b854d55;
      }
      if ((iVar1 != -0x7ffffffb) && (iVar1 != -0x3fffffdd)) goto LAB_6b854d55;
      iVar1 = NtQueryInformationFile(param_1,local_10,&local_8,4,7);
      if (iVar1 < 0) goto LAB_6b854d55;
      iVar1 = FUN_6b856631((size_t *)(param_2 + 0x10d),(uint)(local_8 * 5) >> 2);
    } while (iVar1 != 0);
    *(undefined *)((int)param_2 + 0x45f) = 1;
  }
  return iVar1;
}



void __fastcall FUN_6b854d5f(HANDLE param_1,int *param_2,void **param_3)

{
  DWORD DVar1;
  int iVar2;
  void **extraout_EDX;
  void **extraout_EDX_00;
  void **extraout_EDX_01;
  void **extraout_EDX_02;
  uint uVar3;
  undefined8 uVar4;
  undefined local_30 [4];
  int local_2c;
  DWORD local_28;
  DWORD local_24;
  undefined4 local_20;
  undefined4 local_1c;
  DWORD local_18;
  DWORD local_14;
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  if (*(char *)((int)param_2 + 0x45d) == '\0') {
    if ((-1 < param_2[0x109]) &&
       ((0 < param_2[0x109] || ((uint)param_2[0x10b] <= (uint)param_2[0x108])))) {
      FUN_6b854b24(param_2,param_3);
      param_3 = extraout_EDX_02;
    }
  }
  else {
    uVar3 = 0x1000;
    if (((param_2[0x118] & 0x10U) == 0) &&
       ((local_28 = GetFileSize(param_1,&local_24), local_28 != 0xffffffff ||
        (DVar1 = GetLastError(), param_3 = extraout_EDX, DVar1 == 0)))) {
      local_20 = 0;
      local_1c = 0;
      local_14 = local_24;
      local_18 = local_28;
      while (iVar2 = FUN_6b856631((size_t *)(param_2 + 0x10d),uVar3), iVar2 != 0) {
        local_2c = 0;
        uVar4 = NtFsControlFile(param_1,0,0,0,local_30,0x903b0,&local_20,0x10,param_2[0x10f],uVar3);
        param_3 = (void **)((ulonglong)uVar4 >> 0x20);
        iVar2 = (int)uVar4;
        if (iVar2 != -0x7ffffffb) {
          if (((iVar2 != -0x3ffffff0) && (iVar2 != -0x3ffffffe)) && (iVar2 != -0x3fffff45)) {
            if (iVar2 < 0) {
              BaseSetLastNTError(iVar2);
              param_3 = extraout_EDX_01;
            }
            else if (*(int *)(param_2[0x10f] + 4) != 0) {
              *(undefined2 *)(param_2 + 0x117) = 1;
              *param_2 = 0xb;
              param_2[1] = 0x10;
              param_2[4] = 0;
              param_2[0x10b] = 0x14;
              param_2[2] = local_2c;
              param_2[3] = 0;
            }
          }
          goto LAB_6b854eae;
        }
        uVar3 = uVar3 * 2;
      }
      *(undefined *)((int)param_2 + 0x45f) = 1;
      param_3 = extraout_EDX_00;
    }
  }
LAB_6b854eae:
  FUN_6b8224af(local_c ^ (uint)&stack0xfffffffc,param_3);
  return;
}



undefined4 __fastcall FUN_6b854ebf(int param_1,int *param_2,void **param_3)

{
  int iVar1;
  int local_c;
  int local_8;
  
  local_c = param_1;
  local_8 = param_1;
  if (*(char *)((int)param_2 + 0x45d) == '\0') {
    if ((-1 < param_2[0x109]) &&
       ((0 < param_2[0x109] || ((uint)param_2[0x10b] <= (uint)param_2[0x108])))) {
      FUN_6b854b24(param_2,param_3);
    }
  }
  else {
    iVar1 = FUN_6b856631((size_t *)(param_2 + 0x10d),0x400);
    if (iVar1 == 0) {
      *(undefined *)((int)param_2 + 0x45f) = 1;
      return 0;
    }
    iVar1 = NtFsControlFile(param_1,0,0,0,&local_c,0x9009c,0,0,param_2[0x10f],param_2[0x10d]);
    if (-1 < iVar1) {
      *(undefined2 *)(param_2 + 0x117) = 1;
      *param_2 = 7;
      param_2[1] = 0;
      param_2[4] = 0;
      param_2[0x10b] = 0x14;
      param_2[2] = local_8;
      param_2[3] = 0;
    }
  }
  return 1;
}



// WARNING: Could not reconcile some variable overlaps

undefined4 __fastcall FUN_6b854f71(undefined4 param_1,int *param_2,void **param_3)

{
  size_t *psVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  undefined local_10 [4];
  undefined4 local_c;
  
  if ((param_2[0x118] & 0x400400U) == 0x400) {
    if (*(char *)((int)param_2 + 0x45d) == '\0') {
      if ((-1 < param_2[0x109]) &&
         ((0 < param_2[0x109] || ((uint)param_2[0x10b] <= (uint)param_2[0x108])))) {
        FUN_6b854b24(param_2,param_3);
      }
    }
    else {
      psVar1 = (size_t *)(param_2 + 0x10d);
      local_c = CONCAT22(0x4000,(undefined2)local_c);
      iVar2 = NtFsControlFile(param_1,0,0,0,local_10,0x900a8,0,0,param_2[0x10f],*psVar1);
      if ((iVar2 == -0x7ffffffb) || (iVar2 == -0x3fffffdd)) {
        if (local_c._2_2_ == 0) {
          local_c._2_2_ = 0x4000;
          local_c = CONCAT22(0x4000,(undefined2)local_c);
        }
        iVar2 = FUN_6b856631(psVar1,(uint)local_c._2_2_);
        if (iVar2 == 0) {
          *(undefined *)((int)param_2 + 0x45f) = 1;
          return 0;
        }
        iVar2 = NtFsControlFile(param_1,0,0,0,local_10,0x900a8,0,0,param_2[0x10f],*psVar1);
      }
      if (-1 < iVar2) {
        uVar4 = 8;
        *(undefined *)(param_2 + 0x117) = 1;
        *param_2 = 8;
        param_2[1] = 0;
        param_2[4] = 0;
        param_2[0x10b] = 0x14;
        uVar3 = (uint)*(ushort *)((int *)param_2[0x10f] + 1);
        if (-1 < *(int *)param_2[0x10f]) {
          uVar4 = 0x18;
        }
        param_2[2] = uVar3 + uVar4;
        param_2[3] = (uint)CARRY4(uVar3,uVar4);
        if (local_c <= (uint)param_2[2] && param_2[2] != local_c) {
          param_2[2] = local_c;
          param_2[3] = 0;
        }
        *(undefined *)((int)param_2 + 0x45d) = 0;
      }
    }
  }
  return 1;
}



undefined4 __fastcall FUN_6b8550ad(uint param_1,int *param_2,void **param_3)

{
  size_t *psVar1;
  int iVar2;
  uint local_8;
  
  if (*(char *)(param_3 + 3) != '\0') {
    local_8 = param_1;
    if (*(char *)((int)param_2 + 0x45d) == '\0') {
      if ((-1 < param_2[0x109]) &&
         ((0 < param_2[0x109] || ((uint)param_2[0x10b] <= (uint)param_2[0x108])))) {
        FUN_6b854b24(param_2,param_3);
      }
    }
    else {
      psVar1 = (size_t *)(param_2 + 0x10d);
      while( true ) {
        memset((void *)param_2[0x10f],0,*psVar1);
        iVar2 = NtQuerySecurityObject(param_1,0x1007f,param_2[0x10f],*psVar1,&local_8);
        if (-1 < iVar2) break;
        if ((iVar2 != -0x7ffffffb) && (iVar2 != -0x3fffffdd)) {
          iVar2 = NtQuerySecurityObject(param_1,0x7f,param_2[0x10f],*psVar1,&local_8);
          if (-1 < iVar2) break;
          if ((iVar2 != -0x7ffffffb) && (iVar2 != -0x3fffffdd)) {
            iVar2 = NtQuerySecurityObject(param_1,0x77,param_2[0x10f],*psVar1,&local_8);
          }
        }
        if (-1 < iVar2) break;
        if ((iVar2 != -0x7ffffffb) && (iVar2 != -0x3fffffdd)) {
          return 1;
        }
        iVar2 = FUN_6b856631(psVar1,local_8);
        if (iVar2 == 0) {
          return 0;
        }
      }
      *(undefined *)(param_2 + 0x117) = 1;
      *param_2 = 3;
      param_2[1] = 2;
      param_2[4] = 0;
      param_2[0x10b] = 0x14;
      iVar2 = RtlLengthSecurityDescriptor(param_2[0x10f]);
      param_2[2] = iVar2;
      param_2[3] = 0;
      *(undefined *)((int)param_2 + 0x45d) = 0;
    }
  }
  return 1;
}



BOOL __fastcall FUN_6b8551df(HANDLE param_1,int *param_2,LPVOID *param_3)

{
  uint *puVar1;
  uint uVar2;
  DWORD DVar3;
  int *piVar4;
  DWORD DVar5;
  int iVar6;
  BOOL BVar7;
  DWORD *pDVar8;
  uint local_14 [2];
  int *local_c;
  HANDLE local_8;
  
  local_8 = param_1;
  if (*(char *)(param_2 + 0x112) == '\0') {
    if (param_2[0x109] < 1) {
      if (param_2[0x109] < 0) {
        return 1;
      }
      if ((uint)param_2[0x108] < (uint)param_2[0x10b]) {
        return 1;
      }
    }
    iVar6 = FUN_6b856568(param_2,(int *)param_3[2],&local_c);
    if (iVar6 != 0) {
      BVar7 = ReadFile(local_8,*param_3,(DWORD)local_c,local_14,(LPOVERLAPPED)0x0);
      if (local_14[0] != 0) {
        puVar1 = (uint *)(param_2 + 0x108);
        uVar2 = *puVar1;
        *puVar1 = *puVar1 + local_14[0];
        piVar4 = (int *)param_3[1];
        param_2[0x109] = param_2[0x109] + (uint)CARRY4(uVar2,local_14[0]);
        param_3[2] = (LPVOID)((int)param_3[2] - local_14[0]);
        *piVar4 = *piVar4 + local_14[0];
        *param_3 = (LPVOID)((int)*param_3 + local_14[0]);
        return BVar7;
      }
      if (BVar7 != 0) {
        if (local_c != (int *)0x0) {
          RtlSetLastWin32Error(0x45d);
          return 0;
        }
        return BVar7;
      }
      return 0;
    }
  }
  else {
    pDVar8 = (DWORD *)(param_2[0x111] + param_2[0x10f]);
    uVar2 = pDVar8[2];
    DVar5 = pDVar8[3];
    param_2[2] = uVar2 + 8;
    param_2[3] = DVar5 + (0xfffffff7 < uVar2);
    *param_2 = 9;
    param_2[1] = 8;
    param_2[4] = 0;
    param_2[0x10b] = 0x1c;
    DVar5 = *pDVar8;
    DVar3 = pDVar8[1];
    param_2[0x106] = DVar5;
    param_2[0x107] = DVar3;
    param_2[5] = DVar5;
    param_2[6] = DVar3;
    *(undefined *)(param_2 + 0x112) = 0;
    local_c = (int *)pDVar8[1];
    DVar5 = SetFilePointer(param_1,*pDVar8,(PLONG)&local_c,0);
    if ((DVar5 == *pDVar8) && (local_c == (int *)pDVar8[1])) {
      return 1;
    }
    *(undefined *)((int)param_2 + 0x45f) = 1;
  }
  return 0;
}



undefined4 __fastcall FUN_6b855304(int param_1,int *param_2,void **param_3)

{
  size_t *psVar1;
  int iVar2;
  int local_c;
  int local_8;
  
  local_c = param_1;
  local_8 = param_1;
  if (*(char *)((int)param_2 + 0x45d) == '\0') {
    if (param_2[0x109] < 0) {
      return 1;
    }
    if ((param_2[0x109] < 1) && ((uint)param_2[0x108] < (uint)param_2[0x10b])) {
      return 1;
    }
    FUN_6b854b24(param_2,param_3);
    return 1;
  }
  psVar1 = (size_t *)(param_2 + 0x10d);
  iVar2 = FUN_6b856631(psVar1,0x400);
  if (iVar2 == 0) {
LAB_6b8553f2:
    *(undefined *)((int)param_2 + 0x45f) = 1;
    return 0;
  }
  iVar2 = NtFsControlFile(param_1,0,0,0,&local_c,0x901f8,0,0,param_2[0x10f],*psVar1);
  if (iVar2 == -0x7ffffffb) {
    iVar2 = FUN_6b856631(psVar1,*(int *)param_2[0x10f] - *psVar1);
    if (iVar2 == 0) goto LAB_6b8553f2;
    iVar2 = NtFsControlFile(param_1,0,0,0,&local_c,0x901f8,0,0,param_2[0x10f],*psVar1);
  }
  if ((((iVar2 != -0x7fe6ffd7) && (iVar2 != -0x3ffffff0)) && (iVar2 != -0x3ffffffe)) &&
     ((iVar2 != -0x3fe6fffb && (iVar2 != -0x3fffff45)))) {
    if (iVar2 < 0) {
      BaseSetLastNTError(iVar2);
      return 0;
    }
    *(undefined2 *)(param_2 + 0x117) = 1;
    *param_2 = 10;
    param_2[1] = 0;
    param_2[4] = 0;
    param_2[0x10b] = 0x14;
    param_2[2] = local_8;
    param_2[3] = 0;
  }
  return 1;
}



BOOL BackupSeek(HANDLE hFile,DWORD dwLowBytesToSeek,DWORD dwHighBytesToSeek,
               LPDWORD lpdwLowByteSeeked,LPDWORD lpdwHighByteSeeked,LPVOID *lpContext)

{
  uint *puVar1;
  int *piVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  DWORD DVar7;
  bool bVar8;
  uint local_20;
  DWORD local_1c;
  LONG local_18;
  uint local_14;
  uint local_10;
  int local_c;
  uint local_8;
  
                    // 0x55430  43  BackupSeek
  local_8 = 0;
  local_c = 0;
  piVar2 = (int *)*lpContext;
  *lpdwHighByteSeeked = 0;
  *lpdwLowByteSeeked = 0;
  if (((piVar2 == (int *)0xffffffff) || (piVar2 == (int *)0x0)) ||
     (*(char *)((int)piVar2 + 0x45d) != '\0')) {
    return 0;
  }
  if (piVar2[0x109] < 0) {
    return 0;
  }
  if ((piVar2[0x109] < 1) && ((uint)piVar2[0x108] < (uint)piVar2[0x10b])) {
    return 0;
  }
  iVar3 = FUN_6b856504(piVar2,&local_14);
  if (iVar3 == 0) {
    return 0;
  }
  uVar6 = dwHighBytesToSeek & 0x7fffffff;
  uVar4 = dwLowBytesToSeek;
  if (((int)local_10 <= (int)uVar6) &&
     (((int)local_10 < (int)uVar6 || (local_14 < dwLowBytesToSeek)))) {
    uVar4 = local_14;
    uVar6 = local_10;
  }
  iVar3 = *piVar2;
  local_10 = 1;
  if ((iVar3 == 1) || (iVar3 == 4)) {
LAB_6b855597:
    if (*piVar2 != 1) goto LAB_6b855518;
  }
  else {
    if (iVar3 != 9) goto LAB_6b855549;
    uVar5 = piVar2[0x108];
    if ((piVar2[0x109] < 1) && ((piVar2[0x109] < 0 || (uVar5 < 8)))) {
      local_8 = 8 - uVar5;
      local_c = -(uint)(8 < uVar5) - piVar2[0x109];
      if (((int)uVar6 < local_c) || (((int)uVar6 <= local_c && (uVar4 <= local_8)))) {
        uVar4 = 0;
        uVar6 = 0;
        goto LAB_6b855597;
      }
      bVar8 = uVar4 < local_8;
      uVar4 = uVar4 - local_8;
      uVar6 = (uVar6 - local_c) - (uint)bVar8;
    }
LAB_6b855518:
    hFile = (HANDLE)piVar2[0x10c];
  }
  local_18 = 0;
  local_1c = SetFilePointer(hFile,0,&local_18,1);
  local_20 = uVar6;
  SetFilePointer(hFile,uVar4,(PLONG)&local_20,1);
LAB_6b855549:
  if ((dwHighBytesToSeek != uVar6) || (dwLowBytesToSeek != uVar4)) {
    local_10 = 0;
  }
  uVar5 = uVar4 + local_8;
  DVar7 = uVar6 + local_c + (uint)CARRY4(uVar4,local_8);
  puVar1 = (uint *)(piVar2 + 0x108);
  uVar4 = *puVar1;
  *puVar1 = *puVar1 + uVar5;
  piVar2[0x109] = piVar2[0x109] + DVar7 + (uint)CARRY4(uVar4,uVar5);
  *lpdwLowByteSeeked = uVar5;
  *lpdwHighByteSeeked = DVar7;
  iVar3 = FUN_6b8555ae(piVar2);
  uVar4 = -(uint)(iVar3 != 0) & local_10;
  if (uVar4 == 0) {
    RtlSetLastWin32Error(0x19);
    return 0;
  }
  return uVar4;
}



int __fastcall FUN_6b8555ae(int *param_1)

{
  HANDLE hObject;
  int iVar1;
  int *local_c;
  int *local_8;
  
  local_c = param_1;
  local_8 = param_1;
  iVar1 = FUN_6b856504(param_1,(uint *)&local_c);
  if (iVar1 != 0) {
    if (((uint)local_c | (uint)local_8) == 0) {
      iVar1 = param_1[0x111];
      if ((iVar1 != param_1[0x110]) && (*(char *)(param_1 + 0x112) == '\0')) {
        iVar1 = iVar1 + 0x10;
        param_1[0x111] = iVar1;
      }
      if (iVar1 == param_1[0x110]) {
        if (((*(char *)((int)param_1 + 0x449) == '\0') &&
            (hObject = (HANDLE)param_1[0x10c], hObject != (HANDLE)0x0)) &&
           (hObject != (HANDLE)0xffffffff)) {
          CloseHandle(hObject);
          param_1[0x10c] = -1;
        }
        *(undefined *)((int)param_1 + 0x45d) = 1;
        param_1[0x10b] = 0;
        *(undefined *)(param_1 + 0x112) = 1;
        param_1[0x108] = 0;
        param_1[0x109] = 0;
        if (*(char *)((int)param_1 + 0x45e) == '\0') {
          param_1[0x10a] = param_1[0x10a] + 1;
          *(undefined *)(param_1 + 0x117) = 0;
          *param_1 = *(int *)(&DAT_6b889090 + param_1[0x10a] * 4);
        }
      }
      else {
        *(undefined *)(param_1 + 0x112) = 1;
        param_1[0x10b] = 0;
        param_1[0x108] = 0;
        param_1[0x109] = 0;
      }
    }
    iVar1 = 1;
  }
  return iVar1;
}



BOOL BackupWrite(HANDLE hFile,LPBYTE lpBuffer,DWORD nNumberOfBytesToWrite,
                LPDWORD lpNumberOfBytesWritten,BOOL bAbort,BOOL bProcessSecurity,LPVOID *lpContext)

{
  uint *puVar1;
  uint uVar2;
  int *piVar3;
  uint uVar4;
  int iVar5;
  BOOL BVar6;
  int *local_24;
  uint local_20;
  uint local_1c;
  LPBYTE local_18;
  uint *local_14;
  int *local_10;
  undefined local_c;
  
                    // 0x55690  44  BackupWrite
  local_18 = lpBuffer;
  piVar3 = (int *)*lpContext;
  local_10 = (int *)nNumberOfBytesToWrite;
  BVar6 = 0;
  local_14 = lpNumberOfBytesWritten;
  local_c = (undefined)bProcessSecurity;
  if (bAbort == 0) {
    *lpNumberOfBytesWritten = 0;
    if (piVar3 != (int *)0xffffffff) {
      if ((piVar3 == (int *)0x0) && (piVar3 = (int *)FUN_6b85432b(0), piVar3 == (int *)0x0)) {
        return 0;
      }
      *lpContext = piVar3;
      while( true ) {
        if (piVar3[0x10b] == 0) {
          *(undefined2 *)((int)piVar3 + 0x45d) = 0x101;
          FUN_6b855eac((int)piVar3,&local_18,0x14);
        }
        if (local_10 == (int *)0x0) {
          return 1;
        }
        if (piVar3[0x10b] == 0x14) {
          if (piVar3[4] != 0) {
            uVar4 = piVar3[4] + 0x14;
            if ((uVar4 < 0x14) || (iVar5 = FUN_6b855eac((int)piVar3,&local_18,uVar4), iVar5 == 0)) {
              RtlSetLastWin32Error(0xd);
              return 0;
            }
            if (local_10 == (int *)0x0) {
              if (*piVar3 != 4) {
                return 1;
              }
              if (0 < piVar3[0x109]) {
                return 1;
              }
              if (((uint)piVar3[0x109] < 0x80000000) && ((uint)piVar3[0x10b] < (uint)piVar3[0x108]))
              {
                return 1;
              }
            }
          }
          if ((((piVar3[0x10b] == 0x14) && (*piVar3 == 9)) &&
              (FUN_6b855eac((int)piVar3,&local_18,0x1c), local_10 == (int *)0x0)) &&
             (piVar3[0x10b] == 0x14)) {
            return 1;
          }
        }
        iVar5 = FUN_6b856568(piVar3,local_10,&local_24);
        if (iVar5 == 0) {
          return 0;
        }
        iVar5 = FUN_6b856504(piVar3,&local_20);
        if (iVar5 == 0) break;
        if ((*(char *)((int)piVar3 + 0x45f) == '\0') || (uVar4 = local_20 | local_1c, uVar4 != 0)) {
          *(undefined *)((int)piVar3 + 0x45f) = 0;
          switch(*piVar3) {
          case 1:
            BVar6 = FUN_6b8563cd(hFile,piVar3,&local_18);
            break;
          case 2:
            BVar6 = FUN_6b855bf0(hFile,piVar3,&local_18);
            break;
          case 3:
            BVar6 = FUN_6b8561b9(hFile,piVar3,&local_18);
            break;
          case 4:
            BVar6 = FUN_6b855964(hFile,piVar3,&local_18);
            break;
          case 5:
            BVar6 = FUN_6b855f7c(hFile,piVar3,&local_18);
            break;
          default:
            RtlSetLastWin32Error(0xd);
            BVar6 = 0;
            break;
          case 7:
            BVar6 = FUN_6b8560e6(hFile,piVar3,&local_18);
            break;
          case 8:
            BVar6 = FUN_6b856155(hFile,piVar3,&local_18);
            break;
          case 9:
            BVar6 = FUN_6b8562de(hFile,piVar3,&local_18);
            break;
          case 10:
            BVar6 = FUN_6b856485(hFile,piVar3,&local_18);
            break;
          case 0xb:
            BVar6 = FUN_6b855ce5(hFile,piVar3,&local_18);
          }
          iVar5 = FUN_6b8555ae(piVar3);
          if (iVar5 == 0) {
            return 0;
          }
          uVar4 = 0;
        }
        else {
          puVar1 = (uint *)(piVar3 + 0x108);
          uVar2 = *puVar1;
          *puVar1 = *puVar1 + (int)local_24;
          piVar3[0x109] = piVar3[0x109] + (uint)CARRY4(uVar2,(uint)local_24);
          local_10 = (int *)((int)local_10 - (int)local_24);
          *local_14 = *local_14 + (int)local_24;
          local_18 = local_18 + (int)local_24;
        }
        if (BVar6 == 0) {
          return 0;
        }
        if (local_10 == (int *)0x0) {
          if (*local_14 == uVar4) {
            FUN_6b8565a6((int *)lpContext);
            return BVar6;
          }
          return BVar6;
        }
      }
      return 0;
    }
  }
  else if (piVar3 != (int *)0x0) {
    FUN_6b8565a6((int *)lpContext);
  }
  return 1;
}



void __fastcall FUN_6b855964(undefined4 param_1,int *param_2,LPCVOID *param_3)

{
  uint *puVar1;
  HANDLE *ppvVar2;
  uint uVar3;
  int *extraout_EDX;
  int *extraout_EDX_00;
  int *piVar4;
  int *extraout_EDX_01;
  bool bVar5;
  undefined8 uVar6;
  undefined4 local_254;
  undefined4 local_250;
  undefined2 *local_24c;
  undefined4 local_248;
  undefined4 local_244;
  undefined4 local_240;
  undefined local_23c [8];
  undefined2 local_234;
  undefined2 local_232;
  int *local_230;
  undefined4 local_22c;
  int local_228 [135];
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  piVar4 = param_2;
  local_22c = param_1;
  if (*(char *)(param_2 + 0x119) == '\0') {
    *(undefined *)(param_2 + 0x119) = 1;
    uVar6 = NtQueryVolumeInformationFile(param_1,local_23c,local_228,0x218,5);
    piVar4 = (int *)((ulonglong)uVar6 >> 0x20);
    bVar5 = -1 < (int)uVar6;
    *(bool *)((int)param_2 + 0x465) = bVar5;
    if (bVar5) {
      param_2[0x11a] = local_228[0];
    }
  }
  if ((*(char *)((int)param_2 + 0x465) != '\0') && ((param_2[0x11a] & 0x40000U) == 0)) {
    piVar4 = (int *)param_3[2];
    puVar1 = (uint *)(param_2 + 0x108);
    uVar3 = *puVar1;
    *puVar1 = *puVar1 + (int)piVar4;
    param_2[0x109] = param_2[0x109] + (uint)CARRY4(uVar3,(uint)piVar4);
                    // WARNING: Load size is inaccurate
    *(int *)param_3[1] = *param_3[1] + (int)piVar4;
    param_3[2] = (LPCVOID)((int)param_3[2] - (int)piVar4);
    *param_3 = (LPCVOID)((int)*param_3 + (int)piVar4);
    goto LAB_6b855b13;
  }
  if (*(char *)((int)param_2 + 0x45d) == '\0') {
LAB_6b855b00:
    if ((HANDLE)param_2[0x10c] != (HANDLE)0xffffffff) {
      FUN_6b8563cd((HANDLE)param_2[0x10c],param_2,param_3);
      piVar4 = extraout_EDX_01;
      goto LAB_6b855b13;
    }
  }
  else {
    local_234 = *(undefined2 *)(param_2 + 4);
    ppvVar2 = (HANDLE *)(param_2 + 0x10c);
    local_230 = param_2 + 5;
    local_232 = local_234;
    if (*ppvVar2 != (HANDLE)0xffffffff) {
      CloseHandle(*ppvVar2);
      *ppvVar2 = (HANDLE)0xffffffff;
      *(undefined *)((int)param_2 + 0x449) = 0;
    }
    local_250 = local_22c;
    local_24c = &local_234;
    local_254 = 0x18;
    local_248 = 0x40;
    local_244 = 0;
    local_240 = 0;
    uVar6 = NtCreateFile(ppvVar2,0x100002,&local_254,local_23c,0,0x80,7,5,
                         (param_2[0x118] & 0x400U) << 0xb | 0x4020,0,0);
    piVar4 = (int *)((ulonglong)uVar6 >> 0x20);
    if (-1 < (int)uVar6) {
      if ((*(byte *)(param_2 + 1) & 8) != 0) {
        *(undefined *)((int)param_2 + 0x449) = 1;
        NtFsControlFile(*ppvVar2,0,0,0,local_23c,0x900c4,0,0,0,0);
        piVar4 = extraout_EDX_00;
      }
      goto LAB_6b855b00;
    }
    BaseSetLastNTError((int)uVar6);
    piVar4 = extraout_EDX;
  }
  *(undefined *)((int)param_2 + 0x45f) = 1;
LAB_6b855b13:
  FUN_6b8224af(local_c ^ (uint)&stack0xfffffffc,piVar4);
  return;
}



undefined4 __fastcall FUN_6b855b24(int *param_1,void **param_2)

{
  uint *puVar1;
  void *_Src;
  uint uVar2;
  int iVar3;
  uint local_10;
  void **local_c;
  int *local_8;
  
  local_c = param_2;
  if (*(char *)((int)param_1 + 0x45d) != '\0') {
    *(undefined *)((int)param_1 + 0x45d) = 0;
    if (param_1[3] != 0) {
      RtlSetLastWin32Error(0xd);
      return 0;
    }
    if (((-1 < param_1[3]) && ((uint)param_1[0x10d] < (uint)param_1[2])) &&
       (iVar3 = FUN_6b856631((size_t *)(param_1 + 0x10d),param_1[2]), iVar3 == 0)) {
      return 0;
    }
  }
  iVar3 = FUN_6b856568(param_1,(int *)param_2[2],&local_8);
  if (iVar3 != 0) {
    _Src = *param_2;
    memcpy((void *)((param_1[0x10f] - param_1[0x10b]) + param_1[0x108]),_Src,(size_t)local_8);
    puVar1 = (uint *)(param_1 + 0x108);
    uVar2 = *puVar1;
    *puVar1 = *puVar1 + (int)local_8;
    param_1[0x109] = param_1[0x109] + (uint)CARRY4(uVar2,(uint)local_8);
    local_c[2] = (void *)((int)local_c[2] - (int)local_8);
                    // WARNING: Load size is inaccurate
    *(int *)local_c[1] = *local_c[1] + (int)local_8;
    *local_c = (void *)((int)_Src + (int)local_8);
    iVar3 = FUN_6b856504(param_1,&local_10);
    if (iVar3 != 0) {
      if ((local_10 | (uint)local_c) != 0) {
        return 2;
      }
      return 1;
    }
  }
  return 0;
}



void __fastcall FUN_6b855bf0(undefined4 param_1,int *param_2,void **param_3)

{
  int iVar1;
  undefined4 extraout_EDX;
  undefined4 uVar2;
  undefined4 extraout_EDX_00;
  uint uVar3;
  bool bVar4;
  undefined8 uVar5;
  undefined local_238 [8];
  undefined local_230 [8];
  int local_228 [135];
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  iVar1 = FUN_6b855b24(param_2,param_3);
  uVar2 = extraout_EDX;
  if ((iVar1 == 1) &&
     ((*(char *)((int)param_2 + 0x465) == '\0' || ((param_2[0x11a] & 0x800000U) != 0)))) {
    uVar5 = NtSetEaFile(param_1,local_230,param_2[0x10f],param_2[2]);
    uVar2 = (undefined4)((ulonglong)uVar5 >> 0x20);
    uVar3 = (uint)uVar5;
    if (((int)uVar3 < 0) && (*(char *)(param_2 + 0x119) == '\0')) {
      *(undefined *)(param_2 + 0x119) = 1;
      uVar5 = NtQueryVolumeInformationFile(param_1,local_238,local_228,0x218,5);
      uVar2 = (undefined4)((ulonglong)uVar5 >> 0x20);
      bVar4 = -1 < (int)uVar5;
      *(bool *)((int)param_2 + 0x465) = bVar4;
      if (bVar4) {
        param_2[0x11a] = local_228[0];
      }
    }
    if (*(char *)((int)param_2 + 0x465) != '\0') {
      uVar3 = uVar3 & -(uint)((param_2[0x11a] & 0x800000U) != 0);
    }
    if ((int)uVar3 < 0) {
      BaseSetLastNTError(uVar3);
      uVar2 = extraout_EDX_00;
    }
  }
  FUN_6b8224af(local_c ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



undefined4 __fastcall FUN_6b855ce5(undefined4 param_1,int *param_2,void **param_3)

{
  uint uVar1;
  undefined4 *puVar2;
  int iVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  int in_FS_OFFSET;
  size_t local_2c;
  undefined4 uStack40;
  undefined4 *local_24;
  undefined local_20 [8];
  undefined4 local_18;
  uint local_14;
  undefined4 *local_10;
  int local_c;
  uint local_8;
  
  local_2c = 0;
  uStack40 = 0;
  local_24 = (undefined4 *)0x0;
  local_18 = param_1;
  iVar3 = FUN_6b855b24(param_2,param_3);
  if (iVar3 == 1) {
    uVar1 = param_2[2];
    if ((param_2[3] != 0) || (7 < uVar1)) {
      puVar5 = (undefined4 *)(param_2[0x10f] + 8);
      local_c = param_2[3] + -1 + (uint)(7 < uVar1);
      puVar4 = local_24;
      for (local_8 = uVar1 - 8; (local_10 = puVar5, local_c != 0 || (0x27 < local_8));
          local_8 = local_8 - uVar1) {
        local_14 = puVar5[9];
        if ((local_c + -1 + (uint)(0x27 < local_8) == 0) && (local_8 - 0x28 < local_14)) break;
        iVar3 = FUN_6b856631(&local_2c,local_14 + 0x24);
        puVar2 = local_10;
        puVar4 = local_24;
        if (iVar3 == 0) {
          if (local_24 == (undefined4 *)0x0) {
            return 0;
          }
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_24);
          return 0;
        }
        *local_24 = *puVar5;
        local_24[1] = puVar5[1];
        local_24[2] = puVar5[2];
        local_24[3] = puVar5[3];
        local_24[4] = puVar5[4];
        local_24[5] = puVar5[5];
        local_24[6] = puVar5[6];
        local_24[7] = puVar5[7];
        local_24[8] = local_10[9];
        if (local_10[9] != 0) {
          memcpy(local_24 + 9,local_10 + 10,local_10[9]);
        }
        iVar3 = NtFsControlFile(local_18,0,0,0,local_20,0x983ac,puVar4,local_14 + 0x24,0,0);
        if (iVar3 < 0) {
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar4);
          BaseSetLastNTError(iVar3);
          return 0;
        }
        uVar1 = puVar2[8];
        if (uVar1 == 0) {
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar4);
          return 1;
        }
        if ((local_c == 0) && (local_8 < uVar1)) goto LAB_6b855d4b;
        local_c = local_c - (uint)(local_8 < uVar1);
        puVar5 = (undefined4 *)((int)puVar2 + uVar1);
      }
      if (puVar4 == (undefined4 *)0x0) goto LAB_6b855d5d;
LAB_6b855d4b:
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar4);
    }
LAB_6b855d5d:
    RtlSetLastWin32Error(0xd);
  }
  else if (iVar3 == 2) {
    return 1;
  }
  return 0;
}



undefined4 __fastcall FUN_6b855eac(int param_1,void **param_2,uint param_3)

{
  uint *puVar1;
  void *pvVar2;
  uint uVar3;
  void *_Src;
  int *piVar4;
  int iVar5;
  void *_Size;
  
  pvVar2 = param_2[2];
  iVar5 = -(uint)(param_3 < *(uint *)(param_1 + 0x420)) - *(int *)(param_1 + 0x424);
  if ((iVar5 < 0) ||
     ((_Size = pvVar2, iVar5 < 1 && ((void *)(param_3 - *(uint *)(param_1 + 0x420)) <= pvVar2)))) {
    _Size = (void *)(param_3 - *(int *)(param_1 + 0x420));
  }
  if (_Size < (void *)0x214) {
    uVar3 = *(uint *)(param_1 + 0x424);
    if (((int)uVar3 < 1) &&
       (((0x7fffffff < uVar3 || (*(uint *)(param_1 + 0x420) <= 0x214U - (int)_Size)) &&
        (-1 < (int)uVar3)))) {
      _Src = *param_2;
      memcpy((void *)(*(int *)(param_1 + 0x420) + param_1),_Src,(size_t)_Size);
      puVar1 = (uint *)(param_1 + 0x420);
      uVar3 = *puVar1;
      *puVar1 = *puVar1 + (int)_Size;
      piVar4 = (int *)param_2[1];
      *(int *)(param_1 + 0x424) = *(int *)(param_1 + 0x424) + (uint)CARRY4(uVar3,(uint)_Size);
      *piVar4 = *piVar4 + (int)_Size;
      param_2[2] = (void *)((int)pvVar2 - (int)_Size);
      *param_2 = (void *)((int)_Src + (int)_Size);
      if ((*(uint *)(param_1 + 0x420) == param_3) && (*(int *)(param_1 + 0x424) == 0)) {
        *(uint *)(param_1 + 0x42c) = param_3;
      }
      return 1;
    }
  }
  return 0;
}



undefined4 __fastcall FUN_6b855f7c(undefined4 param_1,int *param_2,void **param_3)

{
  ushort uVar1;
  int iVar2;
  undefined *puVar3;
  HANDLE pvVar4;
  undefined4 uVar5;
  size_t _Size;
  ushort *puVar6;
  int in_FS_OFFSET;
  undefined4 uVar7;
  undefined local_20 [4];
  int local_1c;
  int *local_18;
  ushort *local_14;
  uint local_10;
  ushort *local_c;
  int local_8;
  
  local_18 = param_2;
  iVar2 = FUN_6b855b24(param_2,param_3);
  if (iVar2 != 1) {
    if (iVar2 != 2) {
      return 0;
    }
    return 1;
  }
  puVar6 = (ushort *)param_2[0x10f];
  uVar1 = *puVar6;
  local_14 = (ushort *)0x0;
  local_8 = 0;
  _Size = 2;
  local_10 = 0x5c;
  while (uVar1 != 0) {
    if (uVar1 == 0x5c) {
      local_8 = local_8 + 1;
      _Size = 0;
      local_14 = puVar6;
    }
    puVar6 = puVar6 + 1;
    _Size = _Size + 2;
    uVar1 = *puVar6;
  }
  local_1c = _Size + 0x10;
  local_c = local_14;
  puVar3 = (undefined *)FUN_6b854391(local_1c);
  if (puVar3 == (undefined *)0x0) {
    RtlSetLastWin32Error(8);
    return 0;
  }
  local_14 = local_14 + 1;
  memcpy(puVar3 + 0xc,local_14,_Size);
  uVar5 = 1;
  *(size_t *)(puVar3 + 8) = _Size - 2;
  puVar6 = local_c;
  if (local_8 < 2) {
    local_10 = (uint)*local_c;
    puVar6 = local_14;
  }
  *puVar6 = 0;
  pvVar4 = CreateFileW((LPCWSTR)local_18[0x10f],0xc0000000,7,(LPSECURITY_ATTRIBUTES)0x0,3,0x2000080,
                       (HANDLE)0x0);
  *(HANDLE *)(puVar3 + 4) = pvVar4;
  *puVar6 = (ushort)local_10;
  *puVar3 = 1;
  if (*(int *)(puVar3 + 4) == -1) {
    RtlSetLastWin32Error(2);
  }
  else {
    iVar2 = NtSetInformationFile(param_1,local_20,puVar3,local_1c,0xb);
    CloseHandle(*(HANDLE *)(puVar3 + 4));
    *(undefined4 *)(puVar3 + 4) = 0xffffffff;
    if (-1 < iVar2) {
      if (local_1c == 3) {
        uVar7 = 0xb7;
      }
      else {
        uVar7 = 0;
      }
      RtlSetLastWin32Error(uVar7);
      goto LAB_6b8560ca;
    }
    BaseSetLastNTError(iVar2);
  }
  uVar5 = 0;
LAB_6b8560ca:
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar3);
  return uVar5;
}



undefined4 __fastcall FUN_6b8560e6(undefined4 param_1,int *param_2,void **param_3)

{
  int iVar1;
  undefined4 local_c;
  undefined4 uStack8;
  
  local_c = param_1;
  uStack8 = param_1;
  iVar1 = FUN_6b855b24(param_2,param_3);
  if (iVar1 == 1) {
    memset((void *)(param_2[0x10f] + 0x10),0,0x30);
    iVar1 = NtFsControlFile(param_1,0,0,0,&local_c,0x90098,param_2[0x10f],param_2[2],0,0);
    if (iVar1 < 0) {
      BaseSetLastNTError(iVar1);
    }
  }
  else if (iVar1 != 2) {
    return 0;
  }
  return 1;
}



undefined4 __fastcall FUN_6b856155(undefined4 param_1,int *param_2,void **param_3)

{
  int iVar1;
  undefined4 local_c;
  undefined4 uStack8;
  
  local_c = param_1;
  uStack8 = param_1;
  iVar1 = FUN_6b855b24(param_2,param_3);
  if (iVar1 == 1) {
    param_2[0x118] = param_2[0x118] | 0x400;
    iVar1 = NtFsControlFile(param_1,0,0,0,&local_c,0x900a4,param_2[0x10f],param_2[2],0,0);
    if (-1 < iVar1) {
      return 1;
    }
    BaseSetLastNTError(iVar1);
  }
  else if (iVar1 == 2) {
    return 1;
  }
  return 0;
}



undefined4 __fastcall FUN_6b8561b9(undefined4 param_1,int *param_2,void **param_3)

{
  ushort uVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  
  iVar2 = FUN_6b855b24(param_2,param_3);
  if (iVar2 == 1) {
    if (*(char *)(param_3 + 3) != '\0') {
      iVar2 = param_2[0x10f];
      uVar1 = *(ushort *)(iVar2 + 2);
      uVar4 = uVar1 & 4 | 3;
      if ((uVar1 & 0x10) != 0) {
        uVar4 = uVar1 & 4 | 0x7b;
      }
      if ((uVar1 & 0x400) != 0) {
        *(ushort *)(iVar2 + 2) = uVar1 | 0x100;
        iVar2 = param_2[0x10f];
      }
      if ((*(ushort *)(iVar2 + 2) & 0x800) != 0) {
        *(ushort *)(iVar2 + 2) = *(ushort *)(iVar2 + 2) | 0x200;
        iVar2 = param_2[0x10f];
      }
      iVar2 = NtSetSecurityObject(param_1,uVar4 | 0x10000,iVar2);
      if ((iVar2 < 0) && (iVar2 = NtSetSecurityObject(param_1,uVar4,param_2[0x10f]), iVar2 < 0)) {
        if ((uVar4 & 0x48) != 0) {
          NtSetSecurityObject(param_1,uVar4 & 0x48,param_2[0x10f]);
        }
        if ((uVar4 & 0x10) != 0) {
          NtSetSecurityObject(param_1,0x10,param_2[0x10f]);
        }
        if ((uVar4 & 0x24) != 0) {
          iVar2 = NtSetSecurityObject(param_1,uVar4 & 0x24,param_2[0x10f]);
        }
        iVar3 = NtSetSecurityObject(param_1,3,param_2[0x10f]);
        if ((iVar2 < 0) || (iVar2 = iVar3, iVar3 < 0)) {
          BaseSetLastNTError(iVar2);
          return 0;
        }
      }
    }
  }
  else if (iVar2 != 2) {
    return 0;
  }
  return 1;
}



BOOL __fastcall FUN_6b8562de(HANDLE param_1,int *param_2,LPCVOID *param_3)

{
  uint *puVar1;
  uint uVar2;
  int *piVar3;
  DWORD DVar4;
  HANDLE pvVar5;
  int iVar6;
  BOOL BVar7;
  int local_10;
  uint local_c;
  int *local_8;
  
  if (*(char *)(param_2 + 0x112) != '\0') {
    local_10 = param_2[6];
    param_2[0x106] = param_2[5];
    param_2[0x107] = local_10;
    pvVar5 = param_1;
    if (*(char *)((int)param_2 + 0x449) != '\0') {
      pvVar5 = (HANDLE)param_2[0x10c];
    }
    DVar4 = SetFilePointer(pvVar5,param_2[5],&local_10,0);
    if (DVar4 != param_2[0x106]) {
      return 0;
    }
    if (local_10 != param_2[0x107]) {
      return 0;
    }
    if ((param_2[2] == 8) && (param_2[3] == 0)) {
      pvVar5 = param_1;
      if (*(char *)((int)param_2 + 0x449) != '\0') {
        pvVar5 = (HANDLE)param_2[0x10c];
      }
      SetEndOfFile(pvVar5);
    }
    *(undefined *)(param_2 + 0x112) = 0;
  }
  iVar6 = FUN_6b856568(param_2,(int *)param_3[2],&local_8);
  if (iVar6 == 0) {
    return 0;
  }
  if (*(char *)((int)param_2 + 0x449) != '\0') {
    param_1 = (HANDLE)param_2[0x10c];
  }
  BVar7 = WriteFile(param_1,*param_3,(DWORD)local_8,&local_c,(LPOVERLAPPED)0x0);
  puVar1 = (uint *)(param_2 + 0x108);
  uVar2 = *puVar1;
  *puVar1 = *puVar1 + local_c;
  piVar3 = (int *)param_3[1];
  param_2[0x109] = param_2[0x109] + (uint)CARRY4(uVar2,local_c);
  param_3[2] = (LPCVOID)((int)param_3[2] - local_c);
  *piVar3 = *piVar3 + local_c;
  *param_3 = (LPCVOID)((int)*param_3 + local_c);
  return BVar7;
}



void __fastcall FUN_6b8563cd(HANDLE param_1,int *param_2,LPCVOID *param_3)

{
  uint *puVar1;
  uint uVar2;
  int *piVar3;
  int iVar4;
  undefined local_18 [8];
  uint local_10;
  LONG local_c;
  int *local_8;
  
  if (*(char *)((int)param_2 + 0x45d) != '\0') {
    if ((*(byte *)(param_2 + 1) & 8) == 0) {
      local_8 = (int *)param_2[3];
      local_c = param_2[2];
      SetFilePointer(param_1,local_c,(PLONG)&local_8,0);
      SetEndOfFile(param_1);
      local_c = 0;
      local_8 = (int *)0x0;
      SetFilePointer(param_1,0,(PLONG)&local_8,0);
    }
    else {
      NtFsControlFile(param_1,0,0,0,local_18,0x900c4,0,0,0,0);
    }
    *(undefined *)((int)param_2 + 0x45d) = 0;
  }
  iVar4 = FUN_6b856568(param_2,(int *)param_3[2],&local_8);
  if (iVar4 != 0) {
    WriteFile(param_1,*param_3,(DWORD)local_8,&local_10,(LPOVERLAPPED)0x0);
    puVar1 = (uint *)(param_2 + 0x108);
    uVar2 = *puVar1;
    *puVar1 = *puVar1 + local_10;
    piVar3 = (int *)param_3[1];
    param_2[0x109] = param_2[0x109] + (uint)CARRY4(uVar2,local_10);
    param_3[2] = (LPCVOID)((int)param_3[2] - local_10);
    *piVar3 = *piVar3 + local_10;
    *param_3 = (LPCVOID)((int)*param_3 + local_10);
  }
  return;
}



undefined4 __fastcall FUN_6b856485(undefined4 param_1,int *param_2,void **param_3)

{
  int iVar1;
  undefined4 local_c;
  undefined4 uStack8;
  
  local_c = param_1;
  uStack8 = param_1;
  iVar1 = FUN_6b855b24(param_2,param_3);
  if (iVar1 == 1) {
    iVar1 = NtFsControlFile(param_1,0,0,0,&local_c,0x90200,param_2[0x10f],param_2[2],0,0);
    if (iVar1 < 0) {
      BaseSetLastNTError(iVar1);
    }
  }
  else if (iVar1 != 2) {
    return 0;
  }
  return 1;
}



undefined4 __fastcall FUN_6b8564dd(uint param_1,int param_2)

{
  int iVar1;
  
  if (0xc < param_1) {
    iVar1 = _wcsnicmp((wchar_t *)(param_2 + (param_1 - 0xc & 0xfffffffe)),L":$DATA",6);
    if (iVar1 == 0) {
      return 1;
    }
  }
  return 0;
}



undefined4 __fastcall FUN_6b856504(int *param_1,uint *param_2)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  bool bVar5;
  
  if (-1 < param_1[3]) {
    uVar4 = param_1[0x10b];
    iVar1 = param_1[3] + (uint)CARRY4(uVar4,param_1[2]);
    if ((-1 < iVar1) && ((0 < iVar1 || (uVar4 <= uVar4 + param_1[2])))) {
      uVar2 = uVar4 - param_1[0x108];
      uVar3 = uVar2 + param_1[2];
      uVar4 = (-(uint)(uVar4 < (uint)param_1[0x108]) - param_1[0x109]) + param_1[3] +
              (uint)CARRY4(uVar2,param_1[2]);
      if (*param_1 == 9) {
        bVar5 = 7 < uVar3;
        uVar3 = uVar3 - 8;
        uVar4 = (uVar4 - 1) + (uint)bVar5;
      }
      *param_2 = uVar3;
      param_2[1] = uVar4;
      return 1;
    }
  }
  RtlSetLastWin32Error(0xd);
  return 0;
}



int __fastcall FUN_6b856568(int *param_1,int *param_2,int **param_3)

{
  int iVar1;
  int *local_c;
  int *local_8;
  
  local_c = param_1;
  local_8 = param_1;
  iVar1 = FUN_6b856504(param_1,(uint *)&local_c);
  if (iVar1 != 0) {
    if ((local_8 < (int *)0x80000000) && ((0 < (int)local_8 || (param_2 < local_c)))) {
      local_c = param_2;
    }
    *param_3 = local_c;
    iVar1 = 1;
  }
  return iVar1;
}



void __fastcall FUN_6b8565a6(int *param_1)

{
  int iVar1;
  HANDLE hObject;
  int in_FS_OFFSET;
  
  iVar1 = *param_1;
  if (iVar1 != -1) {
    if (*(int *)(iVar1 + 0x43c) != 0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,*(int *)(iVar1 + 0x43c));
      *(undefined4 *)(iVar1 + 0x43c) = 0;
    }
    if (*(int *)(iVar1 + 0x458) != 0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,*(int *)(iVar1 + 0x458));
      *(undefined4 *)(iVar1 + 0x458) = 0;
    }
    FUN_6b856689(*(HANDLE *)(iVar1 + 0x430));
    hObject = *(HANDLE *)(iVar1 + 0x430);
    if ((hObject != (HANDLE)0x0) && (hObject != (HANDLE)0xffffffff)) {
      CloseHandle(hObject);
    }
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iVar1);
    *param_1 = -1;
  }
  return;
}



undefined4 __fastcall FUN_6b856631(size_t *param_1,uint param_2)

{
  void *_Dst;
  int in_FS_OFFSET;
  
  if (param_1[1] < param_2) {
    _Dst = (void *)FUN_6b854391(param_2);
    if (_Dst == (void *)0x0) {
      RtlSetLastWin32Error(8);
      return 0;
    }
    memcpy(_Dst,(void *)param_1[2],*param_1);
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1[2]);
    param_1[2] = (size_t)_Dst;
    param_1[1] = param_2;
  }
  *param_1 = param_2;
  return 1;
}



void __fastcall FUN_6b856689(HANDLE param_1)

{
  FILETIME local_c;
  
  local_c.dwLowDateTime = 0xffffffff;
  local_c.dwHighDateTime = 0xffffffff;
  if ((param_1 != (HANDLE)0x0) && (param_1 != (HANDLE)0xffffffff)) {
    SetFileTime(param_1,&local_c,&local_c,&local_c);
  }
  return;
}



void __fastcall FUN_6b8566b0(int param_1)

{
  int iVar1;
  int local_8;
  
  if (param_1 != 0) {
    local_8 = param_1;
    iVar1 = NtSetInformationThread(0xfffffffe,5,&local_8,4);
    if (iVar1 < 0) {
      RtlRaiseStatus(iVar1);
    }
  }
  return;
}



int __fastcall FUN_6b8566da(int *param_1)

{
  int iVar1;
  int iVar2;
  int in_FS_OFFSET;
  undefined4 local_c;
  int local_8;
  
  iVar1 = *(int *)(in_FS_OFFSET + 0x18);
  local_8 = 0;
  local_c = 0;
  iVar2 = 0;
  *param_1 = 0;
  if (*(int *)(iVar1 + 0xf9c) != 0) {
    iVar2 = NtOpenThreadToken(0xfffffffe,0x2000004,1,&local_8);
    if ((-1 < iVar2) && (iVar2 = NtSetInformationThread(0xfffffffe,5,&local_c,4), -1 < iVar2)) {
      *param_1 = local_8;
      local_8 = 0;
    }
    if (local_8 != 0) {
      NtClose(local_8);
    }
  }
  return iVar2;
}



void BaseWriteErrorElevationRequiredEvent(void)

{
  int iVar1;
  undefined4 local_c;
  undefined4 local_8;
  
                    // 0x56760  76  BaseWriteErrorElevationRequiredEvent
  iVar1 = EtwEventRegister(&DAT_6b8870d8,0,0,&local_c);
  if (iVar1 == 0) {
    EtwEventWrite(local_c,local_8,&DAT_6b8870c8,0,0);
    EtwEventUnregister(local_c,local_8);
  }
  return;
}



int __fastcall FUN_6b8567a1(uint param_1,uint *param_2,uint *param_3)

{
  uint uVar1;
  int iVar2;
  uint local_c;
  uint local_8;
  
  local_c = param_1;
  local_8 = param_1;
  iVar2 = FUN_6b864e54(param_1,(int *)&local_8);
  uVar1 = local_8;
  if (-1 < iVar2) {
    iVar2 = FUN_6b864f9f(local_8,*param_3,&local_c);
    if (local_c == 0) {
      if ((uVar1 == 0) || (((uVar1 == 1 && (*param_3 != 0)) || (uVar1 - 0x10 < 3)))) {
        *param_2 = *param_2 & 0xfffffffd;
      }
      *param_3 = 0;
    }
    else {
      iVar2 = -0x3ffffbd4;
    }
  }
  return iVar2;
}



int __fastcall FUN_6b856802(int param_1)

{
  int iVar1;
  
  if (*(char *)(*(int *)(param_1 + 0xc) + 0x19) == '\0') {
    iVar1 = *(int *)(param_1 + 0x5c) - *(int *)(*(int *)(param_1 + 0x84) + 4);
  }
  else {
    iVar1 = *(int *)(param_1 + 0x5c) - *(int *)(*(int *)(param_1 + 0xa8) + 4);
  }
  return iVar1;
}



void __fastcall FUN_6b85682a(undefined4 param_1,undefined4 param_2)

{
  undefined4 extraout_EDX;
  undefined4 uVar1;
  undefined8 uVar2;
  undefined local_38 [4];
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined local_18 [16];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_34 = 0x18;
  local_28 = 0x40;
  local_24 = 0;
  local_20 = 0;
  local_30 = param_1;
  local_2c = param_2;
  uVar2 = NtOpenKey(&local_1c,0x80000000,&local_34);
  uVar1 = (undefined4)((ulonglong)uVar2 >> 0x20);
  if (-1 < (int)uVar2) {
    NtEnumerateValueKey(local_1c,0,0,local_18,0x10,local_38);
    NtClose(local_1c);
    uVar1 = extraout_EDX;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar1);
  return;
}



void __fastcall FUN_6b8568a9(int *param_1,ushort *param_2)

{
  ushort *puVar1;
  undefined4 uVar2;
  uint uVar3;
  ushort *extraout_EDX;
  ushort *extraout_EDX_00;
  ushort *extraout_EDX_01;
  uint *puVar4;
  int iVar5;
  undefined8 uVar6;
  undefined local_22c [4];
  undefined2 local_228;
  undefined2 local_226;
  undefined *local_224;
  ushort *local_220;
  ushort local_21c;
  undefined2 local_21a;
  int local_218;
  int *local_214;
  int local_210;
  undefined local_20c [8];
  undefined2 local_204;
  undefined local_200 [504];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  puVar1 = param_2;
  iVar5 = DAT_6b8b083c;
  local_214 = param_1;
  if ((*(uint *)(param_2 + 0xc) | *(uint *)(param_2 + 0xe)) != 0) {
    for (puVar4 = (uint *)((DAT_6b8b083c - *(int *)(DAT_6b8b083c + 0x9e8)) + *(int *)(param_2 + 0xc)
                          ); puVar4 != (uint *)0x0;
        puVar4 = (uint *)((*puVar4 - *(int *)(iVar5 + 0x9e8)) + iVar5)) {
      local_21c = *(ushort *)(puVar4 + 2);
      puVar1 = (ushort *)(uint)local_21c;
      local_21a = *(undefined2 *)((int)puVar4 + 10);
      if ((puVar4[4] | puVar4[5]) == 0) {
        local_218 = 0;
      }
      else {
        local_218 = (puVar4[4] - *(int *)(iVar5 + 0x9e8)) + iVar5;
      }
      if (local_21c != 0) {
        uVar6 = FUN_6b857301(param_1,param_2,puVar4,(short *)&local_21c);
        puVar1 = (ushort *)((ulonglong)uVar6 >> 0x20);
        param_1 = local_214;
        iVar5 = DAT_6b8b083c;
        if (((int)uVar6 < 0) && ((int)uVar6 != -0x3fffffea)) goto LAB_6b856a62;
      }
      if ((*puVar4 | puVar4[1]) == 0) break;
    }
  }
  if (((((*(uint *)(param_2 + 0x10) | *(uint *)(param_2 + 0x12)) != 0) &&
       (iVar5 = (iVar5 - *(int *)(iVar5 + 0x9e8)) + *(int *)(param_2 + 0x10), iVar5 != 0)) &&
      (uVar2 = FUN_6b81c868((int)param_1,(short **)0x0,(short **)&local_220), puVar1 = extraout_EDX,
      (char)uVar2 != '\0')) &&
     ((iVar5 = FUN_6b81bef2(local_214,iVar5,local_220,'\x01',&local_210), puVar1 = extraout_EDX_00,
      -1 < iVar5 && (local_210 != -1)))) {
    do {
      iVar5 = NtEnumerateValueKey(local_210,0,0,local_20c,0x200,local_22c);
      if (iVar5 < 0) break;
      local_224 = local_200;
      local_228 = local_204;
      local_226 = local_204;
      uVar3 = NtDeleteValueKey(local_210,&local_228);
    } while (-1 < (int)(-(uint)(uVar3 != 0xc0000034) & uVar3));
    NtClose(local_210);
    puVar1 = extraout_EDX_01;
  }
LAB_6b856a62:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,puVar1);
  return;
}



void __fastcall FUN_6b856a71(int param_1)

{
  int iVar1;
  int extraout_EDX;
  int iVar2;
  int extraout_EDX_00;
  int extraout_EDX_01;
  int extraout_EDX_02;
  int iVar3;
  uint *puVar4;
  undefined local_224 [4];
  ushort local_220;
  ushort local_21e;
  undefined *local_21c;
  ushort local_218;
  undefined2 local_216;
  int local_214;
  int local_210;
  undefined local_20c [12];
  ushort local_200;
  undefined local_1fc [500];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  iVar3 = 0;
  iVar2 = *(int *)(param_1 + 8);
  if (((*(uint *)(iVar2 + 0x18) | *(uint *)(iVar2 + 0x1c)) != 0) &&
     (puVar4 = (uint *)((*(int *)(iVar2 + 0x18) - *(int *)(DAT_6b8b083c + 0x9e8)) + DAT_6b8b083c),
     puVar4 != (uint *)0x0)) {
    do {
      local_218 = *(ushort *)(puVar4 + 2);
      local_216 = *(undefined2 *)((int)puVar4 + 10);
      if ((puVar4[4] | puVar4[5]) == 0) {
        local_214 = 0;
      }
      else {
        local_214 = (puVar4[4] - *(int *)(DAT_6b8b083c + 0x9e8)) + DAT_6b8b083c;
      }
      iVar1 = FUN_6b811136(param_1,(ushort *)0x0,&local_218,'\x01');
      iVar2 = extraout_EDX;
      if (iVar1 < 0) goto LAB_6b856c40;
    } while (((*puVar4 | puVar4[1]) != 0) &&
            (puVar4 = (uint *)((*puVar4 - *(int *)(DAT_6b8b083c + 0x9e8)) + DAT_6b8b083c),
            puVar4 != (uint *)0x0));
    iVar2 = *(int *)(param_1 + 8);
  }
  if ((*(uint *)(iVar2 + 0x20) | *(uint *)(iVar2 + 0x24)) != 0) {
    iVar2 = (*(int *)(iVar2 + 0x20) - *(int *)(DAT_6b8b083c + 0x9e8)) + DAT_6b8b083c;
    if (iVar2 != 0) {
      if ((*(uint *)(iVar2 + 0x20) | *(uint *)(iVar2 + 0x24)) != 0) {
        iVar3 = (*(int *)(iVar2 + 0x20) - *(int *)(DAT_6b8b083c + 0x9e8)) + DAT_6b8b083c;
      }
      iVar3 = FUN_6b81bef2(param_1,iVar3,(ushort *)0x0,'\0',&local_210);
      iVar2 = extraout_EDX_00;
      if ((-1 < iVar3) && (local_210 != -1)) {
        iVar2 = 0;
        while (iVar3 = NtEnumerateKey(local_210,iVar2,0,local_20c,0x200,local_224),
              iVar3 != -0x7fffffe6) {
          if (iVar3 < 0) {
LAB_6b856c2b:
            NtClose(local_210);
            iVar2 = extraout_EDX_02;
            goto LAB_6b856c40;
          }
          local_21c = local_1fc;
          local_220 = local_200;
          local_21e = local_200;
          iVar3 = FUN_6b85682a(local_210,&local_220);
          if (iVar3 < 0) {
            if (iVar3 != -0x7fffffe6) break;
            iVar3 = 0;
          }
          else {
            iVar3 = FUN_6b811136(param_1,(ushort *)0x0,&local_220,'\x01');
          }
          if (iVar3 < 0) goto LAB_6b856c2b;
          iVar2 = iVar2 + 1;
        }
        NtClose(local_210);
        iVar2 = extraout_EDX_01;
      }
    }
  }
LAB_6b856c40:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,iVar2);
  return;
}



void __fastcall FUN_6b856c4f(int *param_1,ushort *param_2)

{
  ushort *puVar1;
  undefined4 uVar2;
  int iVar3;
  ushort *extraout_EDX;
  ushort *extraout_EDX_00;
  ushort *extraout_EDX_01;
  ushort *extraout_EDX_02;
  uint *puVar4;
  int iVar5;
  undefined8 uVar6;
  ushort local_22c;
  ushort local_22a;
  undefined *local_228;
  undefined local_224 [4];
  int *local_220;
  ushort *local_21c;
  ushort local_218;
  undefined2 local_216;
  int local_214;
  int local_210;
  undefined local_20c [8];
  ushort local_204;
  undefined local_200 [504];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  iVar5 = DAT_6b8b083c;
  puVar1 = param_2;
  local_220 = param_1;
  if ((*(uint *)(param_2 + 0xc) | *(uint *)(param_2 + 0xe)) != 0) {
    for (puVar4 = (uint *)((DAT_6b8b083c - *(int *)(DAT_6b8b083c + 0x9e8)) + *(int *)(param_2 + 0xc)
                          ); puVar4 != (uint *)0x0;
        puVar4 = (uint *)((*puVar4 - *(int *)(iVar5 + 0x9e8)) + iVar5)) {
      local_218 = *(ushort *)(puVar4 + 2);
      puVar1 = (ushort *)(uint)local_218;
      local_216 = *(undefined2 *)((int)puVar4 + 10);
      if ((puVar4[4] | puVar4[5]) == 0) {
        local_214 = 0;
      }
      else {
        local_214 = (puVar4[4] - *(int *)(iVar5 + 0x9e8)) + iVar5;
      }
      if (local_218 != 0) {
        uVar6 = FUN_6b81bd3f(param_1,param_2,puVar4,&local_218);
        puVar1 = (ushort *)((ulonglong)uVar6 >> 0x20);
        iVar3 = (int)uVar6;
        iVar5 = DAT_6b8b083c;
        if (((iVar3 < 0) && (iVar3 != -0x3fffffcc)) && (iVar3 != -0x3fffffdc)) goto LAB_6b856e3a;
      }
      if ((*puVar4 | puVar4[1]) == 0) break;
    }
  }
  if ((((*(uint *)(param_2 + 0x10) | *(uint *)(param_2 + 0x12)) != 0) &&
      (iVar5 = (*(int *)(param_2 + 0x10) - *(int *)(iVar5 + 0x9e8)) + iVar5, iVar5 != 0)) &&
     ((uVar2 = FUN_6b81c868((int)param_1,(short **)0x0,(short **)&local_21c), puVar1 = extraout_EDX,
      (char)uVar2 != '\0' &&
      ((iVar5 = FUN_6b81bef2(param_1,iVar5,local_21c,'\0',&local_210), puVar1 = extraout_EDX_00,
       -1 < iVar5 && (local_210 != -1)))))) {
    iVar5 = 0;
    while (iVar3 = NtEnumerateValueKey(local_210,iVar5,0,local_20c,0x200,local_224),
          iVar3 != -0x7fffffe6) {
      if (iVar3 < 0) {
LAB_6b856e25:
        NtClose(local_210);
        puVar1 = extraout_EDX_02;
        goto LAB_6b856e3a;
      }
      local_228 = local_200;
      local_22c = local_204;
      local_22a = local_204;
      iVar3 = FUN_6b81bd3f(local_220,param_2,(uint *)0x0,&local_22c);
      if (((iVar3 < 0) && (iVar3 != -0x3fffffcc)) && (iVar3 != -0x3fffffdc)) goto LAB_6b856e25;
      iVar5 = iVar5 + 1;
    }
    NtClose(local_210);
    puVar1 = extraout_EDX_01;
  }
LAB_6b856e3a:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,puVar1);
  return;
}



uint __fastcall FUN_6b856e49(int param_1)

{
  uint uVar1;
  
  uVar1 = FUN_6b810e4e(param_1);
  while( true ) {
    if ((int)uVar1 < 0) {
      return uVar1;
    }
    uVar1 = FUN_6b810f40(param_1,2);
    if (uVar1 != 0x105) break;
    uVar1 = FUN_6b811136(param_1,*(ushort **)(param_1 + 0x84),*(ushort **)(param_1 + 0xa8),'\x01');
  }
  return -(uint)(uVar1 != 0x8000001a) & uVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

int __fastcall FUN_6b856e92(int *param_1,ushort *param_2)

{
  short sVar1;
  undefined4 *puVar2;
  ushort *_Dst;
  ushort *puVar3;
  size_t _Size;
  ushort *puVar4;
  ushort *puVar5;
  uint uVar6;
  size_t _Size_00;
  ushort *puVar7;
  undefined4 *in_FS_OFFSET;
  int local_3c;
  void *local_34;
  int local_2c;
  int local_28;
  ushort *local_24;
  undefined4 local_14;
  
  local_2c = -0x3ffffff3;
  if (*param_1 == 8) {
    local_2c = FUN_6b8568a9(param_1,param_2);
  }
  else {
    local_34 = (void *)param_1[0x13];
    if (((local_34 == (void *)0x0) || (_Size_00 = param_1[0x14], _Size_00 == 0)) &&
       ((local_34 = (void *)param_1[0x15], local_34 == (void *)0x0 ||
        (_Size_00 = param_1[0x16], _Size_00 == 0)))) {
      local_2c = -0x3ffffff3;
    }
    else {
      puVar2 = (undefined4 *)KernelBaseGetGlobalData();
      _Dst = (ushort *)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),*puVar2,_Size_00);
      if (_Dst == (ushort *)0x0) {
        local_2c = -0x3fffffe9;
      }
      else {
        local_3c = 0;
        memmove(_Dst,local_34,_Size_00);
        local_28 = 0;
        puVar4 = _Dst;
        while (_Size_00 != 0) {
          if (*(char *)((int)param_1 + 5) == '\0') {
            while( true ) {
              if (_Size_00 == 0) goto LAB_6b8571a2;
              if ((*(byte *)puVar4 == 0) || (0x20 < *(byte *)puVar4)) break;
              _Size_00 = _Size_00 - 1;
              puVar4 = (ushort *)((int)puVar4 + 1);
            }
            if ((_Size_00 == 0) || (*(byte *)puVar4 == 0)) break;
            param_1[0xd] = (int)puVar4;
            puVar5 = puVar4;
            while( true ) {
              if (_Size_00 == 0) goto LAB_6b8571a2;
              if (*(byte *)puVar5 == 0x3d) break;
              _Size_00 = _Size_00 - 1;
              puVar5 = (ushort *)((int)puVar5 + 1);
            }
            puVar7 = puVar5;
            if (_Size_00 == 0) break;
            for (; ((ushort *)param_1[0xd] <= puVar7 && puVar7 != (ushort *)param_1[0xd] &&
                   (*(byte *)((int)puVar7 + -1) < 0x21)); puVar7 = (ushort *)((int)puVar7 + -1)) {
            }
            sVar1 = (short)puVar7 - (short)param_1[0xd];
            *(short *)(param_1 + 0xc) = sVar1;
            if (sVar1 == 0) break;
            *(short *)((int)param_1 + 0x32) = sVar1 + 1;
            do {
              _Size_00 = _Size_00 - 1;
              puVar5 = (ushort *)((int)puVar5 + 1);
              if (_Size_00 == 0) break;
            } while (*(byte *)puVar5 == 0x20);
            param_1[0x13] = (int)puVar5;
            while( true ) {
              if (_Size_00 == 0) goto LAB_6b8571a2;
              if (*(byte *)puVar5 == 0) break;
              _Size_00 = _Size_00 - 1;
              puVar5 = (ushort *)((int)puVar5 + 1);
            }
            if (_Size_00 == 0) break;
            param_1[0x14] = (uint)(ushort)((short)puVar5 - *(short *)(param_1 + 0x13));
            _Size_00 = _Size_00 - 1;
            puVar5 = (ushort *)((int)puVar5 + 1);
            _Size = (int)puVar5 - (int)puVar4;
            *(short *)((int)param_1 + 0x42) = *(short *)((int)param_1 + 0x32) * 2;
            *(undefined2 *)(param_1 + 0x10) = 0;
            puVar2 = (undefined4 *)KernelBaseGetGlobalData();
            local_3c = RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),*puVar2,
                                       (uint)*(ushort *)((int)param_1 + 0x42) + param_1[0x14] * 2 +
                                       2);
            if (local_3c == 0) {
              local_2c = -0x3fffffe9;
              break;
            }
            param_1[0x11] = local_3c;
            param_1[0x15] = (uint)*(ushort *)((int)param_1 + 0x42) + local_3c;
            local_24 = puVar4;
          }
          else {
            uVar6 = _Size_00 >> 1;
            while( true ) {
              if (uVar6 == 0) goto LAB_6b8571a2;
              if ((*puVar4 == 0) || (0x20 < *puVar4)) break;
              uVar6 = uVar6 - 1;
              puVar4 = puVar4 + 1;
            }
            if ((uVar6 == 0) || (*puVar4 == 0)) break;
            param_1[0x11] = (int)puVar4;
            puVar5 = puVar4;
            while( true ) {
              if (uVar6 == 0) goto LAB_6b8571a2;
              if (*puVar5 == 0x3d) break;
              uVar6 = uVar6 - 1;
              puVar5 = puVar5 + 1;
            }
            puVar7 = puVar5;
            if (uVar6 == 0) break;
            do {
              puVar3 = puVar7;
              if (puVar3 < (ushort *)param_1[0x11] || puVar3 == (ushort *)param_1[0x11]) break;
              puVar7 = puVar3 + -1;
            } while (puVar3[-1] < 0x21);
            sVar1 = (short)puVar3 - (short)param_1[0x11];
            *(short *)(param_1 + 0x10) = sVar1;
            if (sVar1 == 0) break;
            *(short *)((int)param_1 + 0x42) = sVar1 + 2;
            do {
              puVar5 = puVar5 + 1;
              uVar6 = uVar6 - 1;
              if (uVar6 == 0) break;
            } while (*puVar5 == 0x20);
            param_1[0x15] = (int)puVar5;
            while( true ) {
              if (uVar6 == 0) goto LAB_6b8571a2;
              if (*puVar5 == 0) break;
              uVar6 = uVar6 - 1;
              puVar5 = puVar5 + 1;
            }
            if (uVar6 == 0) break;
            param_1[0x16] = (uint)(ushort)((short)puVar5 - *(short *)(param_1 + 0x15));
            puVar5 = puVar5 + 1;
            _Size = (int)puVar5 - (int)puVar4;
            _Size_00 = (uVar6 - 1) * 2;
            local_24 = puVar4;
          }
          local_2c = FUN_6b857301(param_1,param_2,(uint *)0x0,(short *)0x0);
          if (local_3c != 0) {
            RtlFreeHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),0,local_3c);
            local_3c = 0;
            RtlInitUnicodeString(param_1 + 0x10,0);
            param_1[0x15] = 0;
            param_1[0x16] = 0;
          }
          puVar4 = puVar5;
          if (local_2c < 0) {
            if (local_2c != -0x3fffffea) break;
            memmove((byte *)((int)_Dst + local_28),local_24,_Size);
            local_28 = local_28 + _Size;
            local_2c = 0;
          }
        }
LAB_6b8571a2:
        if (local_28 != 0) {
          *(undefined *)((int)param_1 + 6) = 1;
          if (*(char *)((int)param_1 + 5) == '\0') {
            param_1[0x13] = (int)_Dst;
            param_1[0x14] = local_28;
          }
          else {
            param_1[0x15] = (int)_Dst;
            param_1[0x16] = local_28;
          }
        }
        FUN_6b8572bc(0);
      }
    }
  }
  *in_FS_OFFSET = local_14;
  return local_2c;
}



void __fastcall FUN_6b8572bc(undefined4 param_1)

{
  int unaff_EBP;
  int in_FS_OFFSET;
  
  if (*(int *)(unaff_EBP + -0x38) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),param_1,
                *(int *)(unaff_EBP + -0x38));
    param_1 = 0;
  }
  if (*(int *)(unaff_EBP + -0x34) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),param_1,
                *(int *)(unaff_EBP + -0x34));
  }
  return;
}



void __fastcall FUN_6b857301(int *param_1,ushort *param_2,uint *param_3,short *param_4)

{
  short *psVar1;
  int iVar2;
  short *psVar3;
  undefined4 uVar4;
  int iVar5;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined2 *puVar6;
  undefined4 extraout_EDX_04;
  undefined4 uVar7;
  undefined local_28 [4];
  ushort *local_24;
  int local_20;
  short *local_1c;
  undefined local_18 [4];
  int local_14;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_1c = param_4;
  local_24 = param_2;
  if ((((param_4 == (short *)0x0) &&
       (uVar4 = FUN_6b81c967((int)param_1,(short **)0x0,&local_1c), uVar7 = extraout_EDX,
       (char)uVar4 == '\0')) ||
      ((psVar3 = local_1c, param_3 == (uint *)0x0 &&
       (param_3 = FUN_6b81c8bc((int)local_24,local_1c), uVar7 = extraout_EDX_00,
       param_3 == (uint *)0x0)))) ||
     (((uVar4 = FUN_6b81c868((int)param_1,(short **)0x0,(short **)&local_24),
       uVar7 = extraout_EDX_01, (char)uVar4 == '\0' ||
       (iVar5 = FUN_6b81bef2(param_1,(int)param_3,local_24,'\x01',&local_20),
       uVar7 = extraout_EDX_02, iVar5 < 0)) || (local_20 == -1)))) goto LAB_6b857483;
  iVar5 = NtQueryValueKey(local_20,psVar3,0,local_18,0x10,local_28);
  if (((-1 < iVar5) || (iVar5 == -0x7ffffffb)) && (local_14 != 1)) {
    NtClose(local_20);
    uVar7 = extraout_EDX_03;
    goto LAB_6b857483;
  }
  iVar5 = 2;
  if ((*param_1 == 2) || (*param_1 == 7)) {
    psVar1 = (short *)param_1[0x16];
    if (psVar1 == (short *)0x0) {
      if ((param_1[0x13] != 0) && (iVar2 = param_1[0x14], iVar2 != 0)) {
        param_1[0x16] = iVar2 * 2;
        iVar5 = RtlMultiByteToUnicodeN(param_1[0x15],iVar2 * 2,&local_1c,param_1[0x13],iVar2);
        if (iVar5 < 0) goto LAB_6b857467;
        *(undefined2 *)(param_1[0x15] + ((uint)local_1c & 0xfffffffe)) = 0;
        psVar1 = local_1c;
        goto LAB_6b85744b;
      }
      puVar6 = &DAT_6b884240;
    }
    else {
LAB_6b85744b:
      local_1c = (short *)((uint)psVar1 >> 1);
      puVar6 = (undefined2 *)param_1[0x15];
      iVar5 = ((uint)psVar1 & 0xfffffffe) + 2;
    }
    NtSetValueKey(local_20,psVar3,0,1,puVar6,iVar5);
  }
  else {
    NtDeleteValueKey(local_20,psVar3);
  }
LAB_6b857467:
  NtClose(local_20);
  uVar7 = extraout_EDX_04;
LAB_6b857483:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar7);
  return;
}



DWORD GetPrivateProfileSectionA
                (LPCSTR lpAppName,LPSTR lpReturnedString,DWORD nSize,LPCSTR lpFileName)

{
  uint uVar1;
  DWORD local_8;
  
                    // 0x574a0  684  GetPrivateProfileSectionA
  local_8 = nSize;
  uVar1 = BaseDllReadWriteIniFile
                    ('\0','\0','\x01',(LPCWSTR)lpFileName,(short *)lpAppName,(short *)0x0,
                     (short *)lpReturnedString,(int *)&local_8);
  if ((int)uVar1 < 0) {
    if (uVar1 == 0x80000005) {
      if (1 < nSize) {
        local_8 = nSize - 2;
        lpReturnedString[nSize - 1] = '\0';
        goto LAB_6b85750c;
      }
    }
    else if (uVar1 == 0xc000007b) {
      RtlSetLastWin32Error(0xd);
    }
    else {
      BaseSetLastNTError(uVar1);
    }
    local_8 = 0;
  }
  else {
    RtlSetLastWin32Error(0);
    local_8 = local_8 - 1;
  }
LAB_6b85750c:
  if (local_8 < nSize) {
    lpReturnedString[local_8] = '\0';
  }
  else if (nSize != 0) {
    lpReturnedString[nSize - 1] = '\0';
  }
  return local_8;
}



DWORD GetPrivateProfileSectionNamesA(LPSTR lpszReturnBuffer,DWORD nSize,LPCSTR lpFileName)

{
  DWORD DVar1;
  
                    // 0x57530  685  GetPrivateProfileSectionNamesA
  DVar1 = GetPrivateProfileStringA
                    ((LPCSTR)0x0,(LPCSTR)0x0,(LPCSTR)0x0,lpszReturnBuffer,nSize,lpFileName);
  return DVar1;
}



BOOL GetPrivateProfileStructA
               (LPCSTR lpszSection,LPCSTR lpszKey,LPVOID lpStruct,UINT uSizeStruct,LPCSTR szFile)

{
  char *pcVar1;
  byte bVar2;
  DWORD DVar3;
  BOOL BVar4;
  char cVar5;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint uVar6;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  LPSTR pCVar7;
  int iVar8;
  CHAR *lpReturnedString;
  int in_FS_OFFSET;
  undefined8 uVar9;
  undefined4 uVar10;
  CHAR local_108 [256];
  uint local_8;
  
                    // 0x57560  690  GetPrivateProfileStructA
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  if (uSizeStruct < 0x7ffffffb) {
    DVar3 = uSizeStruct * 2 + 10;
    if (DVar3 < 0x101) {
      pCVar7 = (LPSTR)0x0;
      lpReturnedString = local_108;
    }
    else {
      uVar9 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,DVar3);
      uVar6 = (uint)((ulonglong)uVar9 >> 0x20);
      pCVar7 = (LPSTR)uVar9;
      if (pCVar7 == (LPSTR)0x0) goto LAB_6b857695;
      DVar3 = uSizeStruct * 2 + 10;
      lpReturnedString = pCVar7;
    }
    DVar3 = GetPrivateProfileStringA(lpszSection,lpszKey,(LPCSTR)0x0,lpReturnedString,DVar3,szFile);
    if (DVar3 == uSizeStruct * 2 + 2) {
      uVar6 = extraout_EDX_00 & 0xffffff00;
      for (iVar8 = uSizeStruct + 1; iVar8 != 0; iVar8 = iVar8 + -1) {
        cVar5 = *lpReturnedString;
        if (9 < (byte)(cVar5 - 0x30U)) {
          cVar5 = cVar5 + -7;
        }
        pcVar1 = lpReturnedString + 1;
        lpReturnedString = lpReturnedString + 2;
        bVar2 = *pcVar1 - 0x30;
        if (9 < bVar2) {
          bVar2 = *pcVar1 - 7U & 0xf;
        }
        bVar2 = cVar5 << 4 | bVar2;
        if (iVar8 == 1) {
          if ((byte)uVar6 != bVar2) {
            uVar10 = 0xd;
            goto LAB_6b857672;
          }
          break;
        }
        uVar6 = uVar6 & 0xffffff00 | (uint)(byte)((byte)uVar6 + bVar2);
        *(byte *)lpStruct = bVar2;
        lpStruct = (LPVOID)((int)lpStruct + 1);
      }
    }
    else {
      uVar10 = 0x18;
LAB_6b857672:
      RtlSetLastWin32Error(uVar10);
      uVar6 = extraout_EDX_01;
    }
    if (pCVar7 != (LPSTR)0x0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pCVar7);
      uVar6 = extraout_EDX_02;
    }
  }
  else {
    RtlSetLastWin32Error(0x57);
    uVar6 = extraout_EDX;
  }
LAB_6b857695:
  BVar4 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar6);
  return BVar4;
}



BOOL GetPrivateProfileStructW
               (LPCWSTR lpszSection,LPCWSTR lpszKey,LPVOID lpStruct,UINT uSizeStruct,LPCWSTR szFile)

{
  WCHAR WVar1;
  DWORD DVar2;
  BOOL BVar3;
  byte bVar4;
  WCHAR WVar5;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint uVar6;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  LPWSTR lpReturnedString;
  int iVar7;
  LPWSTR pWVar8;
  int in_FS_OFFSET;
  undefined8 uVar9;
  undefined4 uVar10;
  byte local_209;
  WCHAR local_208 [256];
  uint local_8;
  
                    // 0x576b0  691  GetPrivateProfileStructW
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  uVar6 = uSizeStruct * 2 + 10;
  if (uVar6 < uSizeStruct) {
    RtlSetLastWin32Error(0x57);
    uVar6 = extraout_EDX;
  }
  else {
    if ((uVar6 < 0x201) && (uVar6 * 2 < 0x201)) {
      lpReturnedString = local_208;
      pWVar8 = (LPWSTR)0x0;
    }
    else {
      uVar9 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,uVar6 * 2);
      uVar6 = (uint)((ulonglong)uVar9 >> 0x20);
      lpReturnedString = (LPWSTR)uVar9;
      if (lpReturnedString == (LPWSTR)0x0) goto LAB_6b85780e;
      uVar6 = uSizeStruct * 2 + 10;
      pWVar8 = lpReturnedString;
    }
    DVar2 = GetPrivateProfileStringW(lpszSection,lpszKey,(LPCWSTR)0x0,lpReturnedString,uVar6,szFile)
    ;
    if (DVar2 == uSizeStruct * 2 + 2) {
      local_209 = 0;
      uVar6 = extraout_EDX_00;
      for (iVar7 = uSizeStruct + 1; iVar7 != 0; iVar7 = iVar7 + -1) {
        WVar5 = *lpReturnedString;
        if (9 < (ushort)(WVar5 + L'')) {
          WVar5 = (WCHAR)(byte)((char)WVar5 - 7);
        }
        WVar1 = lpReturnedString[1];
        lpReturnedString = lpReturnedString + 2;
        if ((ushort)(WVar1 + L'') < 10) {
          uVar6 = (ushort)WVar1 & 0xffffff00 | (uint)(byte)((char)WVar1 - 0x30);
        }
        else {
          uVar6 = (ushort)WVar1 & 0xffffff00 | (byte)((char)WVar1 - 7) & 0xffffff0f;
        }
        bVar4 = (char)WVar5 << 4 | (byte)uVar6;
        if (iVar7 == 1) {
          if (local_209 != bVar4) {
            uVar10 = 0xd;
            goto LAB_6b8577eb;
          }
          break;
        }
        local_209 = local_209 + bVar4;
        uVar6 = 9;
        *(byte *)lpStruct = bVar4;
        lpStruct = (LPVOID)((int)lpStruct + 1);
      }
    }
    else {
      uVar10 = 0x18;
LAB_6b8577eb:
      RtlSetLastWin32Error(uVar10);
      uVar6 = extraout_EDX_01;
    }
    if (pWVar8 != (LPWSTR)0x0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pWVar8);
      uVar6 = extraout_EDX_02;
    }
  }
LAB_6b85780e:
  BVar3 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar6);
  return BVar3;
}



UINT GetProfileIntW(LPCWSTR lpAppName,LPCWSTR lpKeyName,INT nDefault)

{
  UINT UVar1;
  
                    // 0x57830  715  GetProfileIntW
  UVar1 = GetPrivateProfileIntW(lpAppName,lpKeyName,nDefault,(LPCWSTR)0x0);
  return UVar1;
}



DWORD GetProfileSectionA(LPCSTR lpAppName,LPSTR lpReturnedString,DWORD nSize)

{
  DWORD DVar1;
  
                    // 0x57850  716  GetProfileSectionA
  DVar1 = GetPrivateProfileSectionA(lpAppName,lpReturnedString,nSize,(LPCSTR)0x0);
  return DVar1;
}



DWORD GetProfileSectionW(LPCWSTR lpAppName,LPWSTR lpReturnedString,DWORD nSize)

{
  DWORD DVar1;
  
                    // 0x57870  717  GetProfileSectionW
  DVar1 = GetPrivateProfileSectionW(lpAppName,lpReturnedString,nSize,(LPCWSTR)0x0);
  return DVar1;
}



BOOL WritePrivateProfileSectionA(LPCSTR lpAppName,LPCSTR lpString,LPCSTR lpFileName)

{
  uint uVar1;
  BOOL BVar2;
  
                    // 0x57890  1563  WritePrivateProfileSectionA
  uVar1 = BaseDllReadWriteIniFile
                    ('\0','\x01','\x01',(LPCWSTR)lpFileName,(short *)lpAppName,(short *)0x0,
                     (short *)lpString,(int *)0x0);
  if ((int)uVar1 < 0) {
    if (uVar1 == 0xc000007b) {
      RtlSetLastWin32Error(0xd);
    }
    else {
      BaseSetLastNTError(uVar1);
    }
    BVar2 = 0;
  }
  else {
    BVar2 = 1;
  }
  return BVar2;
}



BOOL WritePrivateProfileSectionW(LPCWSTR lpAppName,LPCWSTR lpString,LPCWSTR lpFileName)

{
  uint uVar1;
  BOOL BVar2;
  
                    // 0x578e0  1564  WritePrivateProfileSectionW
  uVar1 = BaseDllReadWriteIniFile
                    ('\x01','\x01','\x01',lpFileName,lpAppName,(short *)0x0,lpString,(int *)0x0);
  if ((int)uVar1 < 0) {
    if (uVar1 == 0xc000007b) {
      RtlSetLastWin32Error(0xd);
    }
    else {
      BaseSetLastNTError(uVar1);
    }
    BVar2 = 0;
  }
  else {
    BVar2 = 1;
  }
  return BVar2;
}



BOOL WritePrivateProfileStructA
               (LPCSTR lpszSection,LPCSTR lpszKey,LPVOID lpStruct,UINT uSizeStruct,LPCSTR szFile)

{
  uint uVar1;
  byte bVar2;
  LPCSTR lpString;
  BOOL BVar3;
  byte bVar4;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  LPCSTR pCVar5;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 uVar6;
  LPCSTR pCVar7;
  int in_FS_OFFSET;
  undefined8 uVar8;
  CHAR local_108 [256];
  uint local_8;
  
                    // 0x57930  1567  WritePrivateProfileStructA
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  if (lpStruct == (LPVOID)0x0) {
    WritePrivateProfileStringA(lpszSection,lpszKey,(LPCSTR)0x0,szFile);
    uVar6 = extraout_EDX;
  }
  else {
    uVar1 = uSizeStruct * 2 + 3;
    if (uVar1 < uSizeStruct) {
      RtlSetLastWin32Error(0x57);
      uVar6 = extraout_EDX_00;
    }
    else {
      if (uVar1 < 0x101) {
        lpString = local_108;
        pCVar7 = (LPCSTR)0x0;
      }
      else {
        uVar8 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,uVar1);
        uVar6 = (undefined4)((ulonglong)uVar8 >> 0x20);
        lpString = (LPCSTR)uVar8;
        pCVar7 = lpString;
        if (lpString == (LPCSTR)0x0) goto LAB_6b857a65;
      }
      bVar4 = 0;
      pCVar5 = lpString;
      if (uSizeStruct != 0) {
        do {
                    // WARNING: Load size is inaccurate
          bVar2 = *lpStruct;
          lpStruct = (LPVOID)((int)lpStruct + 1);
          bVar4 = bVar4 + bVar2;
          *pCVar5 = "0123456789ABCDEFClientProcessId"[bVar2 >> 4];
          pCVar5[1] = "0123456789ABCDEFClientProcessId"[bVar2 & 0xf];
          pCVar5 = pCVar5 + 2;
          uSizeStruct = uSizeStruct - 1;
        } while (uSizeStruct != 0);
      }
      *pCVar5 = "0123456789ABCDEFClientProcessId"[bVar4 >> 4];
      pCVar5[1] = "0123456789ABCDEFClientProcessId"[bVar4 & 0xf];
      pCVar5[2] = '\0';
      WritePrivateProfileStringA(lpszSection,lpszKey,lpString,szFile);
      uVar6 = extraout_EDX_01;
      if (pCVar7 != (LPCSTR)0x0) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pCVar7);
        uVar6 = extraout_EDX_02;
      }
    }
  }
LAB_6b857a65:
  BVar3 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar6);
  return BVar3;
}



BOOL WritePrivateProfileStructW
               (LPCWSTR lpszSection,LPCWSTR lpszKey,LPVOID lpStruct,UINT uSizeStruct,LPCWSTR szFile)

{
  uint uVar1;
  byte bVar2;
  LPCWSTR lpString;
  BOOL BVar3;
  byte bVar4;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  LPCWSTR pWVar5;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 uVar6;
  LPCWSTR pWVar7;
  int in_FS_OFFSET;
  undefined8 uVar8;
  WCHAR local_208 [256];
  uint local_8;
  
                    // 0x57a80  1568  WritePrivateProfileStructW
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  if (lpStruct == (LPVOID)0x0) {
    WritePrivateProfileStringW(lpszSection,lpszKey,(LPCWSTR)0x0,szFile);
    uVar6 = extraout_EDX;
  }
  else {
    uVar1 = uSizeStruct * 2 + 3;
    if (uVar1 < uSizeStruct) {
      RtlSetLastWin32Error(0x57);
      uVar6 = extraout_EDX_00;
    }
    else {
      uVar1 = uVar1 * 2;
      if (uVar1 < 0x201) {
        lpString = local_208;
        pWVar7 = (LPCWSTR)0x0;
      }
      else {
        uVar8 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,uVar1);
        uVar6 = (undefined4)((ulonglong)uVar8 >> 0x20);
        lpString = (LPCWSTR)uVar8;
        pWVar7 = lpString;
        if (lpString == (LPCWSTR)0x0) goto LAB_6b857bc5;
      }
      bVar4 = 0;
      pWVar5 = lpString;
      if (uSizeStruct != 0) {
        do {
                    // WARNING: Load size is inaccurate
          bVar2 = *lpStruct;
          lpStruct = (LPVOID)((int)lpStruct + 1);
          bVar4 = bVar4 + bVar2;
          *pWVar5 = (short)"0123456789ABCDEFClientProcessId"[bVar2 >> 4];
          pWVar5[1] = (short)"0123456789ABCDEFClientProcessId"[bVar2 & 0xf];
          pWVar5 = pWVar5 + 2;
          uSizeStruct = uSizeStruct - 1;
        } while (uSizeStruct != 0);
      }
      *pWVar5 = (short)"0123456789ABCDEFClientProcessId"[bVar4 >> 4];
      pWVar5[1] = (short)"0123456789ABCDEFClientProcessId"[bVar4 & 0xf];
      pWVar5[2] = L'\0';
      WritePrivateProfileStringW(lpszSection,lpszKey,lpString,szFile);
      uVar6 = extraout_EDX_01;
      if (pWVar7 != (LPCWSTR)0x0) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pWVar7);
        uVar6 = extraout_EDX_02;
      }
    }
  }
LAB_6b857bc5:
  BVar3 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar6);
  return BVar3;
}



BOOL WriteProfileSectionA(LPCSTR lpAppName,LPCSTR lpString)

{
  BOOL BVar1;
  
                    // 0x57be0  1570  WriteProfileSectionA
  BVar1 = WritePrivateProfileSectionA(lpAppName,lpString,(LPCSTR)0x0);
  return BVar1;
}



BOOL WriteProfileSectionW(LPCWSTR lpAppName,LPCWSTR lpString)

{
  BOOL BVar1;
  
                    // 0x57c00  1571  WriteProfileSectionW
  BVar1 = WritePrivateProfileSectionW(lpAppName,lpString,(LPCWSTR)0x0);
  return BVar1;
}



BOOL WriteProfileStringA(LPCSTR lpAppName,LPCSTR lpKeyName,LPCSTR lpString)

{
  BOOL BVar1;
  
                    // 0x57c20  1572  WriteProfileStringA
  BVar1 = WritePrivateProfileStringA(lpAppName,lpKeyName,lpString,(LPCSTR)0x0);
  return BVar1;
}



BOOL WriteProfileStringW(LPCWSTR lpAppName,LPCWSTR lpKeyName,LPCWSTR lpString)

{
  BOOL BVar1;
  
                    // 0x57c40  1573  WriteProfileStringW
  BVar1 = WritePrivateProfileStringW(lpAppName,lpKeyName,lpString,(LPCWSTR)0x0);
  return BVar1;
}



undefined4 BaseIsDosApplication(ushort *param_1)

{
  char cVar1;
  uint local_c;
  int local_8;
  
                    // 0x57c60  68  BaseIsDosApplication
  local_c = 8;
  if (7 < *param_1) {
    local_8 = *(int *)(param_1 + 2) + (*param_1 - 8 & 0xfffffffe);
    cVar1 = RtlEqualUnicodeString(&local_c,&DAT_6b880828,1);
    if (cVar1 != '\0') {
      return 2;
    }
    local_c = local_c & 0xffff0000 | 8;
    if (7 < *param_1) {
      local_8 = *(int *)(param_1 + 2) + (*param_1 - 8 & 0xfffffffe);
      cVar1 = RtlEqualUnicodeString(&local_c,&DAT_6b880820,1);
      if (cVar1 != '\0') {
        return 3;
      }
      local_c = local_c & 0xffff0000 | 8;
      if (7 < *param_1) {
        local_8 = *(int *)(param_1 + 2) + (*param_1 - 8 & 0xfffffffe);
        cVar1 = RtlEqualUnicodeString(&local_c,&DAT_6b880830,1);
        if (cVar1 != '\0') {
          return 1;
        }
      }
    }
  }
  return 0;
}



BOOL GetBinaryType(LPCSTR lpApplicationName,LPDWORD lpBinaryType)

{
  BOOL BVar1;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x57d20  452  GetBinaryType
                    // 0x57d20  453  GetBinaryTypeA
  BVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpApplicationName);
  if (BVar1 != 0) {
    BVar1 = GetBinaryTypeW(local_8,lpBinaryType);
    RtlFreeUnicodeString(local_c);
  }
  return BVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL GetBinaryTypeW(LPCWSTR lpApplicationName,LPDWORD lpBinaryType)

{
  char cVar1;
  undefined4 *in_FS_OFFSET;
  int iVar2;
  undefined local_98 [16];
  int local_88;
  uint local_7c;
  short local_78;
  undefined4 local_68;
  undefined4 local_64;
  undefined4 *local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  undefined4 local_48;
  undefined local_40 [8];
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  DWORD local_24;
  byte local_1d;
  undefined4 local_14;
  undefined4 uStack12;
  undefined4 local_8;
  
                    // 0x57d60  454  GetBinaryTypeW
  uStack12 = 0x6b857d6f;
  local_2c = 0;
  local_28 = 0;
  local_24 = 0;
  local_1d = 0;
  local_8 = 0;
  cVar1 = RtlDosPathNameToRelativeNtPathName_U(lpApplicationName,&local_38,0,&local_50);
  if (cVar1 == '\0') {
    iVar2 = -0x3fffffcd;
  }
  else {
    local_2c = local_34;
    if ((short)local_50 == 0) {
      local_48 = 0;
    }
    else {
      local_38 = local_50;
      local_34 = local_4c;
    }
    local_68 = 0x18;
    local_5c = 0x40;
    local_60 = &local_38;
    local_58 = 0;
    local_54 = 0;
    local_64 = local_48;
    iVar2 = NtOpenFile(&local_30,0x100020,&local_68,local_40,5,0x60);
    RtlReleaseRelativeName(&local_50);
    if (-1 < iVar2) {
      iVar2 = NtCreateSection(&local_28,0xf001f,0,0,0x10,0x1000000,local_30);
      NtClose(local_30);
      if (iVar2 < 0) {
        local_28 = 0;
        if (iVar2 == -0x3ffffee5) {
LAB_6b857ec3:
          local_24 = 1;
        }
        else if (iVar2 == -0x3ffffed1) {
          local_24 = BaseIsDosApplication((ushort *)&local_38);
          if (local_24 == 0) {
            iVar2 = -0x3ffffed1;
            goto LAB_6b857d9b;
          }
          local_24 = (uint)(local_24 == 3) * 2 + 1;
        }
        else {
          if (iVar2 == -0x3ffffed0) goto LAB_6b857ec3;
          if (iVar2 == -0x3ffffecf) {
            local_24 = 2;
          }
          else {
            if (iVar2 != -0x3ffffca7) {
              if (iVar2 == -0x3ffffca6) goto LAB_6b857e73;
              goto LAB_6b857d9b;
            }
            local_24 = 0;
          }
        }
LAB_6b857f64:
        *lpBinaryType = local_24;
        local_1d = 1;
        goto LAB_6b857f70;
      }
      iVar2 = NtQuerySection(local_28,1,local_98,0x30,0);
      if (-1 < iVar2) {
        if ((local_7c & 0x2000) != 0) {
LAB_6b857ef7:
          RtlSetLastWin32Error(0xc1);
          goto LAB_6b857f70;
        }
        iVar2 = RtlImageNtHeader(*(undefined4 *)(in_FS_OFFSET[0xc] + 8));
        if (local_78 != *(short *)(iVar2 + 4)) {
          if (local_78 != 0x14c) {
            if ((local_78 == 0x200) || (local_78 == -0x799c)) {
LAB_6b857e73:
              local_24 = 6;
              goto LAB_6b857f64;
            }
            goto LAB_6b857ef7;
          }
          local_24 = 0;
        }
        if (((local_88 != 2) && (local_88 != 3)) && (local_88 == 7)) {
          local_24 = 4;
        }
        goto LAB_6b857f64;
      }
    }
  }
LAB_6b857d9b:
  BaseSetLastNTError(iVar2);
LAB_6b857f70:
  local_8 = 0xfffffffe;
  FUN_6b857f94();
  *in_FS_OFFSET = local_14;
  return (uint)local_1d;
}



void FUN_6b857f94(void)

{
  undefined4 unaff_EBX;
  int unaff_EBP;
  int in_FS_OFFSET;
  
  if (*(int *)(unaff_EBP + -0x24) != 0) {
    NtClose(*(undefined4 *)(unaff_EBP + -0x24));
  }
  if (*(int *)(unaff_EBP + -0x28) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EBX,
                *(undefined4 *)(unaff_EBP + -0x28));
  }
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

DWORD GetLongPathNameTransactedW
                (LPCWSTR lpszShortPath,LPWSTR lpszLongPath,DWORD cchBuffer,HANDLE hTransaction)

{
  int iVar1;
  DWORD DVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar3;
  undefined4 local_14;
  
                    // 0x57fd0  627  GetLongPathNameTransactedW
  DVar2 = 0;
  if ((hTransaction == (HANDLE)0xffffffff) || (hTransaction == (HANDLE)0x0)) {
    uVar3 = 0x1a2c;
  }
  else {
    iVar1 = RtlGetCurrentTransaction();
    if (iVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      DVar2 = GetLongPathNameW(lpszShortPath,lpszLongPath,cchBuffer);
      FUN_6b85802d();
      goto LAB_6b858041;
    }
    uVar3 = 0x1a45;
  }
  RtlSetLastWin32Error(uVar3);
LAB_6b858041:
  *in_FS_OFFSET = local_14;
  return DVar2;
}



void FUN_6b85802d(void)

{
  RtlSetCurrentTransaction(0);
  return;
}



BOOL BindIoCompletionCallback
               (HANDLE FileHandle,LPOVERLAPPED_COMPLETION_ROUTINE Function,ULONG Flags)

{
  int iVar1;
  
                    // 0x58060  109  BindIoCompletionCallback
  iVar1 = RtlSetIoCompletionCallback(FileHandle,Function,Flags);
  if (iVar1 < 0) {
    BaseSetLastNTError(iVar1);
  }
  return (uint)(iVar1 >= 0);
}



BOOL CallNamedPipeA(LPCSTR lpNamedPipeName,LPVOID lpInBuffer,DWORD nInBufferSize,LPVOID lpOutBuffer,
                   DWORD nOutBufferSize,LPDWORD lpBytesRead,DWORD nTimeOut)

{
  BOOL BVar1;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x58090  114  CallNamedPipeA
  BVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpNamedPipeName);
  if (BVar1 != 0) {
    BVar1 = CallNamedPipeW(local_8,lpInBuffer,nInBufferSize,lpOutBuffer,nOutBufferSize,lpBytesRead,
                           nTimeOut);
    RtlFreeUnicodeString(local_c);
  }
  return BVar1;
}



// WARNING: Function: __SEH_prolog4_GS replaced with injection: SEH_prolog4

BOOL GetNamedPipeClientComputerNameA
               (HANDLE Pipe,LPSTR ClientComputerName,ULONG ClientComputerNameLength)

{
  BOOL BVar1;
  int iVar2;
  BOOL BVar3;
  undefined4 *in_FS_OFFSET;
  undefined local_23c [8];
  ushort local_234 [2];
  char *local_230;
  BOOL local_22c;
  WCHAR local_228 [266];
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x580e0  642  GetNamedPipeClientComputerNameA
  local_8 = &DAT_6b8920f0;
  uStack12 = 0x6b8580ef;
  local_22c = 0;
  BVar3 = 1;
  if (ClientComputerNameLength == 0) {
    RtlSetLastWin32Error(0x7a);
  }
  else {
    BVar1 = GetNamedPipeClientComputerNameW(Pipe,local_228,0x208);
    if (BVar1 != 0) {
      RtlInitUnicodeString(local_23c,local_228);
      iVar2 = RtlUnicodeStringToAnsiString(local_234,local_23c,1);
      if (-1 < iVar2) {
        local_8 = (undefined *)0x0;
        if (*local_230 == '\0') {
          *ClientComputerName = '\0';
        }
        else if (ClientComputerNameLength < local_234[0] + 1) {
          RtlSetLastWin32Error(0x7a);
          BVar3 = 0;
        }
        else {
          ClientComputerName[local_234[0]] = '\0';
          memcpy(ClientComputerName,local_230,(uint)local_234[0]);
        }
        local_8 = (undefined *)0xfffffffe;
        local_22c = BVar3;
        FUN_6b8581d3();
        goto LAB_6b8581bb;
      }
      BaseSetLastNTError(iVar2);
    }
  }
  BVar3 = 0;
LAB_6b8581bb:
  *in_FS_OFFSET = local_14;
  return BVar3;
}



void FUN_6b8581d3(void)

{
  int unaff_EBP;
  
  RtlFreeAnsiString(unaff_EBP + -0x230);
  return;
}



BOOL GetNamedPipeClientProcessId(HANDLE Pipe,PULONG ClientProcessId)

{
  BOOL BVar1;
  ULONG_PTR local_8;
  
                    // 0x581f0  644  GetNamedPipeClientProcessId
  local_8 = 4;
  BVar1 = GetNamedPipeAttribute
                    (Pipe,PipeConnectionAttribute,"ClientProcessId",ClientProcessId,&local_8);
  return BVar1;
}



BOOL GetNamedPipeHandleStateA
               (HANDLE hNamedPipe,LPDWORD lpState,LPDWORD lpCurInstances,
               LPDWORD lpMaxCollectionCount,LPDWORD lpCollectDataTimeout,LPSTR lpUserName,
               DWORD nMaxUserNameSize)

{
  undefined4 *puVar1;
  int iVar2;
  BOOL BVar3;
  uint uVar4;
  int in_FS_OFFSET;
  undefined4 uVar5;
  undefined local_14 [2];
  undefined2 local_12;
  LPSTR local_10;
  undefined local_c [2];
  ushort local_a;
  LPWSTR local_8;
  
                    // 0x58220  646  GetNamedPipeHandleStateA
  if (lpUserName == (LPSTR)0x0) {
    BVar3 = GetNamedPipeHandleStateW
                      (hNamedPipe,lpState,lpCurInstances,lpMaxCollectionCount,lpCollectDataTimeout,
                       (LPWSTR)0x0,0);
  }
  else {
    uVar4 = nMaxUserNameSize & 0xffff;
    local_10 = lpUserName;
    local_12 = (undefined2)uVar4;
    if ((uVar4 < nMaxUserNameSize) ||
       (local_a = (ushort)(uVar4 * 2), (uVar4 * 2 & 0xffff) < nMaxUserNameSize)) {
      uVar5 = 0x57;
    }
    else {
      puVar1 = (undefined4 *)KernelBaseGetGlobalData();
      local_8 = (LPWSTR)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                                        *puVar1,local_a);
      if (local_8 != (LPWSTR)0x0) {
        BVar3 = GetNamedPipeHandleStateW
                          (hNamedPipe,lpState,lpCurInstances,lpMaxCollectionCount,
                           lpCollectDataTimeout,local_8,(uint)(local_a >> 1));
        if (BVar3 != 0) {
          RtlInitUnicodeString(local_c,local_8);
          iVar2 = RtlUnicodeStringToAnsiString(local_14,local_c,0);
          if (iVar2 < 0) {
            BaseSetLastNTError(iVar2);
            BVar3 = 0;
          }
        }
        if (local_8 == (LPWSTR)0x0) {
          return BVar3;
        }
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_8);
        return BVar3;
      }
      uVar5 = 8;
    }
    RtlSetLastWin32Error(uVar5);
    BVar3 = 0;
  }
  return BVar3;
}



BOOL GetNamedPipeServerProcessId(HANDLE Pipe,PULONG ServerProcessId)

{
  BOOL BVar1;
  ULONG_PTR local_8;
  
                    // 0x58320  649  GetNamedPipeServerProcessId
  local_8 = 4;
  BVar1 = GetNamedPipeAttribute(Pipe,PipeAttribute,"ServerProcessId",ServerProcessId,&local_8);
  return BVar1;
}



BOOL WaitNamedPipeA(LPCSTR lpNamedPipeName,DWORD nTimeOut)

{
  BOOL BVar1;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x58350  1507  WaitNamedPipeA
  BVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpNamedPipeName);
  if (BVar1 != 0) {
    BVar1 = WaitNamedPipeW(local_8,nTimeOut);
    RtlFreeUnicodeString(local_c);
  }
  return BVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 CheckForReadOnlyResource(int **param_1,uint param_2)

{
  int *piVar1;
  int iVar2;
  undefined4 *in_FS_OFFSET;
  undefined local_68 [20];
  int local_54;
  int local_50;
  undefined4 local_4c [2];
  byte local_44;
  undefined local_40 [4];
  undefined4 local_3c;
  undefined4 local_38;
  uint local_30;
  undefined4 local_2c;
  int local_28;
  int local_24;
  uint local_20 [3];
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x58390  129  CheckForReadOnlyResource
  local_8 = &DAT_6b892110;
  uStack12 = 0x6b85839c;
  if (((((param_2 & 0xfffffffe) == 0) && (piVar1 = *param_1, *piVar1 == -0x3ffffffb)) &&
      (piVar1[5] == 1)) && (1 < (uint)piVar1[4])) {
    local_20[0] = piVar1[6];
    iVar2 = NtQueryVirtualMemory(0xffffffff,local_20[0],0,local_68,0x1c,0);
    if (-1 < iVar2) {
      local_2c = 0;
      if (local_54 != 2) goto LAB_6b8584dc;
      local_24 = 0;
      if (local_50 == 0x1000000) {
        iVar2 = NtQueryVirtualMemory(0xffffffff,local_20[0],6,local_4c,0xc,0);
        if ((iVar2 < 0) || ((local_44 & 1) != 0)) goto LAB_6b8584da;
        local_8 = (undefined *)0x0;
        local_30 = RtlImageDirectoryEntryToData(local_4c[0],1,2,&local_28);
        local_38 = 0;
        local_8 = (undefined *)0xfffffffe;
        if (((local_30 != 0) && (local_30 <= local_20[0])) && (local_20[0] < local_30 + local_28))
        goto LAB_6b8584ab;
      }
      else if ((local_50 == 0x40000) && ((param_2 & 1) != 0)) {
LAB_6b8584ab:
        local_24 = 1;
      }
      if (local_24 != 0) {
        local_3c = 1;
        iVar2 = NtProtectVirtualMemory(0xffffffff,local_20,&local_3c,8,local_40);
        if (-1 < iVar2) {
          local_2c = 0xffffffff;
        }
      }
      goto LAB_6b8584dc;
    }
  }
LAB_6b8584da:
  local_2c = 0;
LAB_6b8584dc:
  *in_FS_OFFSET = local_14;
  return local_2c;
}



HANDLE CreateBoundaryDescriptorA(LPCSTR Name,ULONG Flags)

{
  int iVar1;
  HANDLE pvVar2;
  undefined local_c [8];
  
                    // 0x58500  184  CreateBoundaryDescriptorA
  if (Name == (LPCSTR)0x0) {
    BaseSetLastNTError(0xc000000d);
  }
  else {
    iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,Name);
    if (iVar1 != 0) {
      pvVar2 = (HANDLE)RtlCreateBoundaryDescriptor(local_c,Flags);
      RtlFreeUnicodeString(local_c);
      return pvVar2;
    }
  }
  return (HANDLE)0x0;
}



HANDLE CreatePrivateNamespaceA
                 (LPSECURITY_ATTRIBUTES lpPrivateNamespaceAttributes,LPVOID lpBoundaryDescriptor,
                 LPCSTR lpAliasPrefix)

{
  int iVar1;
  HANDLE pvVar2;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x58560  228  CreatePrivateNamespaceA
  if (lpAliasPrefix == (LPCSTR)0x0) {
    BaseSetLastNTError(0xc000000d);
  }
  else {
    iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpAliasPrefix);
    if (iVar1 != 0) {
      pvVar2 = CreatePrivateNamespaceW(lpPrivateNamespaceAttributes,lpBoundaryDescriptor,local_8);
      RtlFreeUnicodeString(local_c);
      return pvVar2;
    }
  }
  return (HANDLE)0x0;
}



HANDLE OpenPrivateNamespaceA(LPVOID lpBoundaryDescriptor,LPCSTR lpAliasPrefix)

{
  int iVar1;
  HANDLE pvVar2;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x585c0  1039  OpenPrivateNamespaceA
  if (lpAliasPrefix == (LPCSTR)0x0) {
    BaseSetLastNTError(0xc000000d);
  }
  else {
    iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpAliasPrefix);
    if (iVar1 != 0) {
      pvVar2 = OpenPrivateNamespaceW(lpBoundaryDescriptor,local_8);
      RtlFreeUnicodeString(local_c);
      return pvVar2;
    }
  }
  return (HANDLE)0x0;
}



byte __fastcall FUN_6b85860b(uint param_1)

{
  byte bVar1;
  uint uVar2;
  
  uVar2 = param_1 & 0x70;
  if (uVar2 == 0x30) {
    bVar1 = 2;
  }
  else if (uVar2 == 0x20) {
    bVar1 = 1;
  }
  else if (uVar2 == 0x40) {
    bVar1 = 3;
  }
  else {
    bVar1 = -(uVar2 != 0x10) & 3;
  }
  return bVar1;
}



BOOL CopyFileExA(LPCSTR lpExistingFileName,LPCSTR lpNewFileName,LPPROGRESS_ROUTINE lpProgressRoutine
                ,LPVOID lpData,LPBOOL pbCancel,DWORD dwCopyFlags)

{
  BOOL BVar1;
  int iVar2;
  undefined local_14 [4];
  LPCWSTR local_10;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x58640  175  CopyFileExA
  BVar1 = Basep8BitStringToDynamicUnicodeString(local_14,lpExistingFileName);
  if (BVar1 != 0) {
    iVar2 = Basep8BitStringToDynamicUnicodeString(local_c,lpNewFileName);
    if (iVar2 == 0) {
      BVar1 = 0;
    }
    else {
      BVar1 = CopyFileExW(local_10,local_8,lpProgressRoutine,lpData,pbCancel,dwCopyFlags);
      RtlFreeUnicodeString(local_c);
    }
    RtlFreeUnicodeString(local_14);
  }
  return BVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL CopyFileTransactedA(LPCSTR lpExistingFileName,LPCSTR lpNewFileName,
                        LPPROGRESS_ROUTINE lpProgressRoutine,LPVOID lpData,LPBOOL pbCancel,
                        DWORD dwCopyFlags,HANDLE hTransaction)

{
  int iVar1;
  BOOL BVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar3;
  undefined4 local_14;
  
                    // 0x586b0  177  CopyFileTransactedA
  BVar2 = 0;
  if ((hTransaction == (HANDLE)0xffffffff) || (hTransaction == (HANDLE)0x0)) {
    uVar3 = 0x1a2c;
  }
  else {
    iVar1 = RtlGetCurrentTransaction();
    if (iVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      BVar2 = CopyFileExA(lpExistingFileName,lpNewFileName,lpProgressRoutine,lpData,pbCancel,
                          dwCopyFlags);
      FUN_6b858716();
      goto LAB_6b85872a;
    }
    uVar3 = 0x1a45;
  }
  RtlSetLastWin32Error(uVar3);
LAB_6b85872a:
  *in_FS_OFFSET = local_14;
  return BVar2;
}



void FUN_6b858716(void)

{
  RtlSetCurrentTransaction(0);
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL CopyFileTransactedW(LPCWSTR lpExistingFileName,LPCWSTR lpNewFileName,
                        LPPROGRESS_ROUTINE lpProgressRoutine,LPVOID lpData,LPBOOL pbCancel,
                        DWORD dwCopyFlags,HANDLE hTransaction)

{
  int iVar1;
  BOOL BVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar3;
  undefined4 local_14;
  
                    // 0x58750  178  CopyFileTransactedW
  if ((hTransaction == (HANDLE)0xffffffff) || (hTransaction == (HANDLE)0x0)) {
    uVar3 = 0x1a2c;
  }
  else {
    iVar1 = RtlGetCurrentTransaction();
    if (iVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      BVar2 = CopyFileExW(lpExistingFileName,lpNewFileName,lpProgressRoutine,lpData,pbCancel,
                          dwCopyFlags);
      FUN_6b8587b6();
      goto LAB_6b8587cc;
    }
    uVar3 = 0x1a45;
  }
  RtlSetLastWin32Error(uVar3);
  BVar2 = 0;
LAB_6b8587cc:
  *in_FS_OFFSET = local_14;
  return BVar2;
}



void FUN_6b8587b6(void)

{
  RtlSetCurrentTransaction(0);
  return;
}



HANDLE CreateFileTransactedA
                 (LPCSTR lpFileName,DWORD dwDesiredAccess,DWORD dwShareMode,
                 LPSECURITY_ATTRIBUTES lpSecurityAttributes,DWORD dwCreationDisposition,
                 DWORD dwFlagsAndAttributes,HANDLE hTemplateFile,HANDLE hTransaction,
                 PUSHORT pusMiniVersion,PVOID lpExtendedParameter)

{
  int iVar1;
  HANDLE pvVar2;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x587f0  207  CreateFileTransactedA
  iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpFileName);
  if (iVar1 == 0) {
    pvVar2 = (HANDLE)0xffffffff;
  }
  else {
    pvVar2 = CreateFileTransactedW
                       (local_8,dwDesiredAccess,dwShareMode,lpSecurityAttributes,
                        dwCreationDisposition,dwFlagsAndAttributes,hTemplateFile,hTransaction,
                        pusMiniVersion,lpExtendedParameter);
    RtlFreeUnicodeString(local_c);
  }
  return pvVar2;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

HANDLE CreateFileTransactedW
                 (LPCWSTR lpFileName,DWORD dwDesiredAccess,DWORD dwShareMode,
                 LPSECURITY_ATTRIBUTES lpSecurityAttributes,DWORD dwCreationDisposition,
                 DWORD dwFlagsAndAttributes,HANDLE hTemplateFile,HANDLE hTransaction,
                 PUSHORT pusMiniVersion,PVOID lpExtendedParameter)

{
  int iVar1;
  undefined2 extraout_var;
  HANDLE pvVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar3;
  undefined4 local_14;
  
                    // 0x58850  208  CreateFileTransactedW
  if (lpExtendedParameter == (PVOID)0x0) {
    pvVar2 = (HANDLE)0xffffffff;
    if ((hTransaction == (HANDLE)0xffffffff) || (hTransaction == (HANDLE)0x0)) {
      uVar3 = 0x1a2c;
    }
    else {
      iVar1 = RtlGetCurrentTransaction();
      if (iVar1 == 0) {
        RtlSetCurrentTransaction(hTransaction);
        if (pusMiniVersion != (PUSHORT)0x0) {
          FUN_6b86020c();
          FUN_6b86025e(CONCAT22(extraout_var,*pusMiniVersion));
        }
        pvVar2 = CreateFileW(lpFileName,dwDesiredAccess,dwShareMode,lpSecurityAttributes,
                             dwCreationDisposition,dwFlagsAndAttributes,hTemplateFile);
        FUN_6b858900();
        goto LAB_6b858920;
      }
      uVar3 = 0x1a45;
    }
    RtlSetLastWin32Error(uVar3);
  }
  else {
    RtlSetLastWin32Error(0x57);
    pvVar2 = (HANDLE)0xffffffff;
  }
LAB_6b858920:
  *in_FS_OFFSET = local_14;
  return pvVar2;
}



void FUN_6b858900(void)

{
  undefined2 extraout_var;
  int unaff_EBX;
  undefined2 unaff_DI;
  
  RtlSetCurrentTransaction(0);
  if (unaff_EBX != 0) {
    FUN_6b86025e(CONCAT22(extraout_var,unaff_DI));
  }
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

HFILE OpenFile(LPCSTR lpFileName,LPOFSTRUCT lpReOpenBuff,UINT uStyle)

{
  byte bVar1;
  DWORD DVar2;
  undefined3 extraout_var;
  DWORD DVar3;
  BOOL BVar4;
  UINT UVar5;
  uint uVar6;
  byte *pbVar7;
  int iVar8;
  CHAR *pCVar9;
  uint extraout_EDX;
  undefined *hFile;
  LPOFSTRUCT p_Var10;
  DWORD dwCreationDisposition;
  undefined4 *puVar11;
  undefined4 *in_FS_OFFSET;
  bool bVar12;
  undefined4 uVar13;
  undefined4 local_f0;
  WORD local_ec;
  WORD local_ea;
  byte local_e8 [128];
  undefined local_68 [8];
  _FILETIME local_60;
  undefined local_58 [8];
  int local_50;
  byte local_4c;
  undefined local_48 [8];
  DWORD local_40;
  int local_3c;
  DWORD local_38;
  LPSTR local_34;
  DWORD local_30;
  DWORD local_2c;
  undefined *local_28;
  undefined *local_24;
  undefined4 local_14;
  undefined4 uStack12;
  undefined4 local_8;
  
                    // 0x58940  1030  OpenFile
  uStack12 = 0x6b85894f;
  hFile = (undefined *)0x0;
  local_28 = (undefined *)0x0;
  p_Var10 = lpReOpenBuff;
  puVar11 = &local_f0;
  for (iVar8 = 0x22; iVar8 != 0; iVar8 = iVar8 + -1) {
    *puVar11 = *(undefined4 *)p_Var10;
    p_Var10 = (LPOFSTRUCT)&p_Var10->Reserved1;
    puVar11 = puVar11 + 1;
  }
  local_24 = (undefined *)0xffffffff;
  local_8 = 0;
  RtlSetLastWin32Error(0);
  if ((uStyle & 0x100) == 0) {
    local_2c = (-(uint)((uStyle & 1) != 0) & 0xc0000000) + 0x80000000;
    if ((uStyle & 2) != 0) {
      local_2c = 0xc0000000;
    }
    DVar2 = local_2c;
    local_30 = local_2c;
    bVar1 = FUN_6b85860b(uStyle);
    local_38 = CONCAT31(extraout_var,bVar1);
    if ((extraout_EDX & 0x1000) != 0) {
      DVar2 = 0xc0000000;
      local_2c = 0xc0000000;
      local_30 = 0xc0000000;
    }
    dwCreationDisposition = 3 - ((extraout_EDX & 0x1000) != 0);
    local_40 = dwCreationDisposition;
    if ((extraout_EDX & 0x8000) == 0) {
      DVar3 = SearchPathA((LPCSTR)0x0,lpFileName,(LPCSTR)0x0,0x7f,lpReOpenBuff->szPathName,&local_34
                         );
      if (0x7f < DVar3) goto LAB_6b858996;
      if (DVar3 == 0) {
        local_28 = &DAT_00000001;
        DVar3 = GetFullPathNameA(lpFileName,0x7f,lpReOpenBuff->szPathName,&local_34);
        if ((DVar3 == 0) || (0x7f < DVar3)) goto LAB_6b858996;
      }
    }
    if ((uStyle & 0x5000) != 0x4000) {
      if ((uStyle & 0x200) == 0) {
        while (hFile = (undefined *)
                       CreateFileA(lpReOpenBuff->szPathName,DVar2,local_38,
                                   (LPSECURITY_ATTRIBUTES)0x0,dwCreationDisposition,0,(HANDLE)0x0),
              local_24 = hFile, hFile == (undefined *)0xffffffff) {
          if ((((uStyle & 0x2000) == 0) || (UVar5 = GetErrorMode(), (UVar5 & 0x8000) != 0)) ||
             (uVar6 = RtlGetThreadErrorMode(), (uVar6 & 0x40) != 0)) goto LAB_6b858cad;
          DVar2 = GetLastError();
          if (DVar2 == 2) {
            uVar13 = 0xd000000f;
          }
          else {
            if (DVar2 != 3) goto LAB_6b858cad;
            uVar13 = 0xd000003a;
          }
          RtlInitAnsiString(local_58,lpReOpenBuff->szPathName);
          iVar8 = RtlAnsiStringToUnicodeString(local_48,local_58,1);
          if (iVar8 < 0) goto LAB_6b858cad;
          local_28 = local_48;
          iVar8 = NtRaiseHardError(uVar13,1,1,&local_28,3,&local_3c);
          RtlFreeUnicodeString(local_48);
          if ((iVar8 < 0) || (DVar2 = local_2c, dwCreationDisposition = local_40, local_3c != 7))
          goto LAB_6b858cad;
        }
        if ((uStyle & 0x4000) != 0) {
          CloseHandle(hFile);
          goto LAB_6b858a94;
        }
        iVar8 = NtQueryVolumeInformationFile(hFile,local_68,&local_50,8,4);
        if (iVar8 < 0) {
          CloseHandle(hFile);
          BaseSetLastNTError(iVar8);
          goto LAB_6b858ca7;
        }
        if (local_50 - 7U < 2) {
          lpReOpenBuff->fFixedDisk = ~local_4c & 1;
        }
        else {
          lpReOpenBuff->fFixedDisk = '\0';
        }
        BVar4 = GetFileTime(hFile,(LPFILETIME)0x0,(LPFILETIME)0x0,&local_60);
        if (BVar4 == 0) {
          lpReOpenBuff->Reserved1 = 0;
          lpReOpenBuff->Reserved2 = 0;
        }
        else {
          BVar4 = FileTimeToDosDateTime(&local_60,&lpReOpenBuff->Reserved1,&lpReOpenBuff->Reserved2)
          ;
          if (BVar4 == 0) {
            *(undefined4 *)&lpReOpenBuff->Reserved1 = 0;
          }
        }
        lpReOpenBuff->cBytes = 0x88;
        if ((uStyle & 0x400) != 0) {
          if ((local_ec != lpReOpenBuff->Reserved1) || (local_ea != lpReOpenBuff->Reserved2))
          goto LAB_6b858c95;
          pCVar9 = lpReOpenBuff->szPathName;
          pbVar7 = local_e8;
          goto LAB_6b858c6c;
        }
        goto LAB_6b858cad;
      }
      BVar4 = DeleteFileA(lpReOpenBuff->szPathName);
      if (BVar4 != 0) {
        lpReOpenBuff->nErrCode = 0;
        lpReOpenBuff->cBytes = 0x88;
        hFile = &DAT_00000001;
        local_24 = hFile;
        goto LAB_6b858cad;
      }
      lpReOpenBuff->nErrCode = 2;
      goto LAB_6b858ca7;
    }
    if ((local_28 == (undefined *)0x0) &&
       (DVar2 = GetFileAttributesA(lpReOpenBuff->szPathName), DVar2 != 0xffffffff)) {
      if ((DVar2 & 0x10) == 0) {
LAB_6b858a94:
        hFile = &DAT_00000001;
        local_24 = &DAT_00000001;
        lpReOpenBuff->cBytes = 0x88;
        goto LAB_6b858cad;
      }
      uVar13 = 5;
    }
    else {
      uVar13 = 2;
    }
  }
  else {
    DVar2 = GetFullPathNameA(lpFileName,0x7f,lpReOpenBuff->szPathName,&local_34);
    if (DVar2 < 0x80) {
      *(undefined4 *)lpReOpenBuff = 0x188;
      *(undefined4 *)&lpReOpenBuff->Reserved1 = 0;
      local_24 = hFile;
      goto LAB_6b858cad;
    }
LAB_6b858996:
    uVar13 = 0xd;
  }
  RtlSetLastWin32Error(uVar13);
  goto LAB_6b858ca7;
  while( true ) {
    bVar1 = pbVar7[1];
    bVar12 = bVar1 < (byte)pCVar9[1];
    if (bVar1 != pCVar9[1]) goto LAB_6b858c8c;
    pbVar7 = pbVar7 + 2;
    pCVar9 = pCVar9 + 2;
    if (bVar1 == 0) break;
LAB_6b858c6c:
    bVar1 = *pbVar7;
    bVar12 = bVar1 < (byte)*pCVar9;
    if (bVar1 != *pCVar9) {
LAB_6b858c8c:
      uVar6 = -(uint)bVar12 | 1;
      goto LAB_6b858c91;
    }
    if (bVar1 == 0) break;
  }
  uVar6 = 0;
LAB_6b858c91:
  if (uVar6 == 0) goto LAB_6b858cad;
LAB_6b858c95:
  puVar11 = &local_f0;
  for (iVar8 = 0x22; iVar8 != 0; iVar8 = iVar8 + -1) {
    *(undefined4 *)lpReOpenBuff = *puVar11;
    puVar11 = puVar11 + 1;
    lpReOpenBuff = (LPOFSTRUCT)&lpReOpenBuff->Reserved1;
  }
  CloseHandle(hFile);
LAB_6b858ca7:
  hFile = (undefined *)0xffffffff;
  local_24 = hFile;
LAB_6b858cad:
  local_8 = 0xfffffffe;
  FUN_6b858cd0();
  *in_FS_OFFSET = local_14;
  return (HFILE)hFile;
}



void FUN_6b858cd0(void)

{
  DWORD DVar1;
  int unaff_EBP;
  
  DVar1 = GetLastError();
  *(short *)(*(int *)(unaff_EBP + 0xc) + 2) = (short)DVar1;
  return;
}



BOOL ReplaceFileA(LPCSTR lpReplacedFileName,LPCSTR lpReplacementFileName,LPCSTR lpBackupFileName,
                 DWORD dwReplaceFlags,LPVOID lpExclude,LPVOID lpReserved)

{
  int iVar1;
  BOOL BVar2;
  undefined local_1c [4];
  LPCWSTR local_18;
  undefined local_14 [4];
  LPCWSTR local_10;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x58cf0  1221  ReplaceFileA
  BVar2 = 0;
  if ((((lpReplacedFileName == (LPCSTR)0x0) || (lpReplacementFileName == (LPCSTR)0x0)) ||
      (lpExclude != (LPVOID)0x0)) ||
     ((lpReserved != (LPVOID)0x0 || ((dwReplaceFlags & 0xfffffff8) != 0)))) {
    RtlSetLastWin32Error(0x57);
    return 0;
  }
  iVar1 = Basep8BitStringToDynamicUnicodeString(local_1c,lpReplacedFileName);
  if (iVar1 == 0) {
    return 0;
  }
  iVar1 = Basep8BitStringToDynamicUnicodeString(local_14,lpReplacementFileName);
  if (iVar1 == 0) goto LAB_6b858d95;
  if (lpBackupFileName == (LPCSTR)0x0) {
    local_8 = (LPCWSTR)0x0;
LAB_6b858d68:
    BVar2 = ReplaceFileW(local_18,local_10,local_8,dwReplaceFlags,(LPVOID)0x0,(LPVOID)0x0);
    if (lpBackupFileName != (LPCSTR)0x0) {
      RtlFreeUnicodeString(local_c);
    }
  }
  else {
    iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpBackupFileName);
    if (iVar1 != 0) goto LAB_6b858d68;
  }
  RtlFreeUnicodeString(local_14);
LAB_6b858d95:
  RtlFreeUnicodeString(local_1c);
  return BVar2;
}



// WARNING: Could not reconcile some variable overlaps

HANDLE CreateActCtxA(PCACTCTXA pActCtx)

{
  LPCWSTR pWVar1;
  code *pcVar2;
  HANDLE pvVar3;
  int iVar4;
  PCACTCTXA pAVar5;
  uint uVar6;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar7;
  uint uVar8;
  PCACTCTXA *ppAVar9;
  PCACTCTXA pAVar10;
  int in_FS_OFFSET;
  char *pcVar11;
  ULONG UVar12;
  undefined local_25c [4];
  PCACTCTXA local_258;
  LPCWSTR local_254;
  USHORT local_250;
  LANGID local_24e;
  WCHAR *local_24c;
  LPCWSTR local_248;
  HMODULE local_240;
  undefined local_23c [8];
  undefined4 local_234;
  LPCWSTR local_230;
  HANDLE local_22c;
  LPCWSTR local_228;
  int local_224;
  PCACTCTXA local_220;
  undefined4 local_21c;
  WCHAR *local_218;
  WCHAR local_214 [262];
  uint local_8;
  
                    // 0x58dc0  181  CreateActCtxA
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_22c = (HANDLE)0xffffffff;
  local_25c = 0x20;
  local_234 = 0;
  local_230 = (LPCWSTR)0x0;
  local_21c = 0;
  local_218 = (WCHAR *)0x0;
  local_228 = (LPCWSTR)0x0;
  uVar8 = 0;
  ppAVar9 = &local_258;
  for (iVar4 = 7; iVar4 != 0; iVar4 = iVar4 + -1) {
    *ppAVar9 = (PCACTCTXA)0x0;
    ppAVar9 = ppAVar9 + 1;
  }
  local_224 = *(int *)(in_FS_OFFSET + 0x18);
  if ((pActCtx == (PCACTCTXA)0x0) ||
     (pAVar5 = (PCACTCTXA)((int)&pActCtx->cbSize + pActCtx->cbSize),
     pAVar5 < &pActCtx->wProcessorArchitecture)) {
    UVar12 = pActCtx->cbSize;
    pcVar11 = "SXS: %s() Null %p or size 0x%lx too small\n";
LAB_6b85907a:
    DbgPrintEx(0x33,0,pcVar11,"CreateActCtxA",pActCtx,UVar12);
    uVar8 = 0xc000000d;
  }
  else {
    local_258 = (PCACTCTXA)pActCtx->dwFlags;
    local_220 = local_258;
    if ((((uint)local_258 & 0xffffff00) != 0) ||
       ((((uint)local_258 & 1) != 0 && (pAVar5 < &pActCtx->wLangId)))) {
LAB_6b85905d:
      UVar12 = pActCtx->cbSize;
      pcVar11 = "SXS: %s() Bad flags/size 0x%lx/0x%lx\n";
      pActCtx = local_258;
      goto LAB_6b85907a;
    }
    if (((uint)local_258 & 2) == 0) {
      pAVar10 = (PCACTCTXA)((int)&pActCtx->cbSize + pActCtx->cbSize);
    }
    else {
      pAVar10 = pAVar5;
      if (pAVar5 < &pActCtx->lpAssemblyDirectory) goto LAB_6b85905d;
    }
    if (((((((uint)local_258 & 4) != 0) && (pAVar10 = pAVar5, pAVar5 < &pActCtx->lpResourceName)) ||
         ((((uint)local_258 & 8) != 0 && (pAVar10 = pAVar5, pAVar5 < &pActCtx->lpApplicationName))))
        || ((((uint)local_258 & 0x20) != 0 && (pAVar10 = pAVar5, pAVar5 < &pActCtx->hModule)))) ||
       ((uVar6 = pActCtx->dwFlags & 0x80, uVar6 != 0 && (pAVar10 < pActCtx + 1))))
    goto LAB_6b85905d;
    if (pActCtx->lpSource == (LPCSTR)0x0) {
      if (uVar6 == 0) {
        uVar8 = 0xc000000d;
        goto LAB_6b8590c6;
      }
      local_254 = (LPCWSTR)0x0;
LAB_6b858f4c:
      if (((byte)local_258 & 1) != 0) {
        local_250 = pActCtx->wProcessorArchitecture;
      }
      if (((byte)local_258 & 2) != 0) {
        local_24e = pActCtx->wLangId;
      }
      if ((char)(byte)local_258 < '\0') {
        local_240 = pActCtx->hModule;
      }
      if (((byte)local_258 & 4) != 0) {
        RtlInitAnsiString(local_23c,pActCtx->lpAssemblyDirectory);
        local_21c = CONCAT22(0x20a,(undefined2)local_21c);
        local_218 = local_214;
        pcVar2 = (code *)GetEightBitStringToUnicodeStringRoutine(&local_21c,local_23c,0);
        _guard_check_icall();
        uVar8 = (*pcVar2)();
        if (uVar8 == 0x80000005) {
          uVar8 = 0xc0000106;
        }
        if ((uVar8 & 0xc0000000) == 0xc0000000) goto LAB_6b85908c;
        local_24c = local_218;
      }
      pWVar1 = local_248;
      if ((((byte)local_258 & 8) == 0) ||
         (local_228 = FUN_6b81b329((short *)pActCtx->lpResourceName), pWVar1 = local_228,
         local_228 != (LPCWSTR)0xffffffff)) {
        local_248 = pWVar1;
        local_22c = CreateActCtxW((PCACTCTXW)local_25c);
        if (local_22c != (HANDLE)0xffffffff) goto LAB_6b85908c;
      }
      else {
        DbgPrintEx(0x33,0,"SXS: %s() BaseDllMapResourceIdA failed\n","CreateActCtxA");
      }
      uVar8 = *(uint *)(local_224 + 0xbf4);
    }
    else {
      RtlInitAnsiString(local_23c,pActCtx->lpSource);
      pcVar2 = (code *)GetEightBitStringToUnicodeStringRoutine(&local_234,local_23c,1);
      _guard_check_icall();
      uVar8 = (*pcVar2)();
      if (-1 < (int)uVar8) {
        local_254 = local_230;
        goto LAB_6b858f4c;
      }
      if (uVar8 == 0x80000005) {
        uVar8 = 0xc0000106;
      }
    }
  }
LAB_6b85908c:
  if (local_230 != (LPCWSTR)0x0) {
    RtlFreeUnicodeString(&local_234);
  }
  if ((local_218 != (WCHAR *)0x0) && (local_218 != local_214)) {
    RtlFreeUnicodeString(&local_21c);
  }
LAB_6b8590c6:
  BaseDllFreeResourceId(local_228);
  uVar7 = extraout_EDX;
  if (local_22c == (HANDLE)0xffffffff) {
    BaseSetLastNTError(uVar8);
    uVar7 = extraout_EDX_00;
  }
  pvVar3 = (HANDLE)FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar7);
  return pvVar3;
}



BOOL CreateDirectoryExA(LPCSTR lpTemplateDirectory,LPCSTR lpNewDirectory,
                       LPSECURITY_ATTRIBUTES lpSecurityAttributes)

{
  BOOL BVar1;
  int iVar2;
  undefined local_14 [4];
  LPCWSTR local_10;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x59100  188  CreateDirectoryExA
  BVar1 = Basep8BitStringToDynamicUnicodeString(local_14,lpTemplateDirectory);
  if (BVar1 != 0) {
    iVar2 = Basep8BitStringToDynamicUnicodeString(local_c,lpNewDirectory);
    if (iVar2 == 0) {
      BVar1 = 0;
    }
    else {
      BVar1 = CreateDirectoryExW(local_10,local_8,lpSecurityAttributes);
      RtlFreeUnicodeString(local_c);
    }
    RtlFreeUnicodeString(local_14);
  }
  return BVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL CreateDirectoryTransactedW
               (LPCWSTR lpTemplateDirectory,LPCWSTR lpNewDirectory,
               LPSECURITY_ATTRIBUTES lpSecurityAttributes,HANDLE hTransaction)

{
  int iVar1;
  BOOL BVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar3;
  undefined4 local_14;
  
                    // 0x59160  191  CreateDirectoryTransactedW
  BVar2 = 0;
  if ((hTransaction == (HANDLE)0xffffffff) || (hTransaction == (HANDLE)0x0)) {
    uVar3 = 0x1a2c;
  }
  else {
    iVar1 = RtlGetCurrentTransaction();
    if (iVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      if (lpTemplateDirectory == (LPCWSTR)0x0) {
        BVar2 = CreateDirectoryW(lpNewDirectory,lpSecurityAttributes);
      }
      else {
        BVar2 = CreateDirectoryExW(lpTemplateDirectory,lpNewDirectory,lpSecurityAttributes);
      }
      FUN_6b8591cc();
      goto LAB_6b8591e0;
    }
    uVar3 = 0x1a45;
  }
  RtlSetLastWin32Error(uVar3);
LAB_6b8591e0:
  *in_FS_OFFSET = local_14;
  return BVar2;
}



void FUN_6b8591cc(void)

{
  RtlSetCurrentTransaction(0);
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL RemoveDirectoryTransactedW(LPCWSTR lpPathName,HANDLE hTransaction)

{
  int iVar1;
  BOOL BVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar3;
  undefined4 local_14;
  
                    // 0x59200  1212  RemoveDirectoryTransactedW
  if ((hTransaction == (HANDLE)0xffffffff) || (hTransaction == (HANDLE)0x0)) {
    uVar3 = 0x1a2c;
  }
  else {
    iVar1 = RtlGetCurrentTransaction();
    if (iVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      BVar2 = RemoveDirectoryW(lpPathName);
      FUN_6b859257();
      goto LAB_6b85926d;
    }
    uVar3 = 0x1a45;
  }
  RtlSetLastWin32Error(uVar3);
  BVar2 = 0;
LAB_6b85926d:
  *in_FS_OFFSET = local_14;
  return BVar2;
}



void FUN_6b859257(void)

{
  RtlSetCurrentTransaction(0);
  return;
}



HANDLE CreateFileMappingNumaA
                 (HANDLE hFile,LPSECURITY_ATTRIBUTES lpFileMappingAttributes,DWORD flProtect,
                 DWORD dwMaximumSizeHigh,DWORD dwMaximumSizeLow,LPCSTR lpName,DWORD nndPreferred)

{
  int iVar1;
  HANDLE pvVar2;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x59290  204  CreateFileMappingNumaA
  if (lpName == (LPCSTR)0x0) {
    local_8 = (LPCWSTR)0x0;
  }
  else {
    iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpName);
    if (iVar1 == 0) {
      return (HANDLE)0x0;
    }
  }
  pvVar2 = CreateFileMappingNumaW
                     (hFile,lpFileMappingAttributes,flProtect,dwMaximumSizeHigh,dwMaximumSizeLow,
                      local_8,nndPreferred);
  if (lpName != (LPCSTR)0x0) {
    RtlFreeUnicodeString(local_c);
  }
  return pvVar2;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL CreateHardLinkTransactedW
               (LPCWSTR lpFileName,LPCWSTR lpExistingFileName,
               LPSECURITY_ATTRIBUTES lpSecurityAttributes,HANDLE hTransaction)

{
  int iVar1;
  BOOL BVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar3;
  undefined4 local_14;
  
                    // 0x592f0  212  CreateHardLinkTransactedW
  if ((hTransaction == (HANDLE)0xffffffff) || (hTransaction == (HANDLE)0x0)) {
    uVar3 = 0x1a2c;
  }
  else {
    iVar1 = RtlGetCurrentTransaction();
    if (iVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      BVar2 = CreateHardLinkW(lpFileName,lpExistingFileName,lpSecurityAttributes);
      FUN_6b85934d();
      goto LAB_6b859363;
    }
    uVar3 = 0x1a45;
  }
  RtlSetLastWin32Error(uVar3);
  BVar2 = 0;
LAB_6b859363:
  *in_FS_OFFSET = local_14;
  return BVar2;
}



void FUN_6b85934d(void)

{
  RtlSetCurrentTransaction(0);
  return;
}



HANDLE CreateMailslotA(LPCSTR lpName,DWORD nMaxMessageSize,DWORD lReadTimeout,
                      LPSECURITY_ATTRIBUTES lpSecurityAttributes)

{
  int iVar1;
  HANDLE pvVar2;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x59380  218  CreateMailslotA
  iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpName);
  if (iVar1 == 0) {
    pvVar2 = (HANDLE)0xffffffff;
  }
  else {
    pvVar2 = CreateMailslotW(local_8,nMaxMessageSize,lReadTimeout,lpSecurityAttributes);
    RtlFreeUnicodeString(local_c);
  }
  return pvVar2;
}



HANDLE CreateMailslotW(LPCWSTR lpName,DWORD nMaxMessageSize,DWORD lReadTimeout,
                      LPSECURITY_ATTRIBUTES lpSecurityAttributes)

{
  char cVar1;
  int iVar2;
  int in_FS_OFFSET;
  undefined4 local_3c;
  undefined4 local_38;
  undefined *local_34;
  undefined4 local_30;
  LPVOID local_2c;
  undefined4 local_28;
  undefined local_24 [8];
  undefined local_1c [4];
  undefined4 local_18;
  int local_14;
  int local_10;
  undefined local_c [4];
  HANDLE local_8;
  
                    // 0x593d0  219  CreateMailslotW
  RtlInitUnicodeString(local_1c,lpName);
  cVar1 = RtlDosPathNameToNtPathName_U(lpName,local_1c,local_c,0);
  if (cVar1 == '\0') {
    RtlSetLastWin32Error(3);
    local_8 = (HANDLE)0xffffffff;
  }
  else {
    local_34 = local_1c;
    local_3c = 0x18;
    local_38 = 0;
    local_30 = 0x40;
    local_2c = (LPVOID)0x0;
    local_28 = 0;
    if ((lpSecurityAttributes != (LPSECURITY_ATTRIBUTES)0x0) &&
       (local_2c = lpSecurityAttributes->lpSecurityDescriptor,
       lpSecurityAttributes->bInheritHandle != 0)) {
      local_30 = 0x42;
    }
    if (lReadTimeout == 0xffffffff) {
      local_10 = -1;
      local_14 = -1;
    }
    else {
      iVar2 = (int)((ulonglong)lReadTimeout * 10000);
      local_14 = -iVar2;
      local_10 = -((int)((ulonglong)lReadTimeout * 10000 >> 0x20) + (uint)(iVar2 != 0));
    }
    iVar2 = NtCreateMailslotFile
                      (&local_8,0x80140000,&local_3c,local_24,2,0,nMaxMessageSize,&local_14);
    if ((iVar2 == -0x3fffff45) || (iVar2 == -0x3ffffff0)) {
      iVar2 = -0x3fffffcd;
    }
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_18);
    if (iVar2 < 0) {
      BaseSetLastNTError(iVar2);
      local_8 = (HANDLE)0xffffffff;
    }
  }
  return local_8;
}



BOOL GetMailslotInfo(HANDLE hMailslot,LPDWORD lpMaxMessageSize,LPDWORD lpNextSize,
                    LPDWORD lpMessageCount,LPDWORD lpReadTimeout)

{
  BOOL BVar1;
  int extraout_EDX;
  int iVar2;
  undefined8 uVar3;
  undefined local_2c [8];
  LPDWORD local_24;
  DWORD local_20 [2];
  DWORD local_18;
  DWORD local_14;
  int local_10;
  int local_c;
  uint local_8;
  
                    // 0x594e0  629  GetMailslotInfo
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_24 = lpMaxMessageSize;
  uVar3 = NtQueryInformationFile(hMailslot,local_2c,local_20,0x18,0x1a);
  iVar2 = (int)((ulonglong)uVar3 >> 0x20);
  if ((int)uVar3 < 0) {
    BaseSetLastNTError((int)uVar3);
    iVar2 = extraout_EDX;
  }
  else {
    if (local_24 != (LPDWORD)0x0) {
      *local_24 = local_20[0];
    }
    if (lpNextSize != (LPDWORD)0x0) {
      *lpNextSize = local_18;
    }
    if (lpMessageCount != (LPDWORD)0x0) {
      *lpMessageCount = local_14;
    }
    if (lpReadTimeout != (LPDWORD)0x0) {
      if ((local_c == -1) && (local_10 == -1)) {
        *lpReadTimeout = 0xffffffff;
      }
      else {
        uVar3 = RtlExtendedLargeIntegerDivide(-local_10,-(local_c + (uint)(local_10 != 0)),10000,0);
        iVar2 = (int)((ulonglong)uVar3 >> 0x20);
        if (iVar2 == 0) {
          *lpReadTimeout = (DWORD)uVar3;
        }
        else {
          *lpReadTimeout = 0xfffffffe;
        }
      }
    }
  }
  BVar1 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,iVar2);
  return BVar1;
}



BOOL SetMailslotInfo(HANDLE hMailslot,DWORD lReadTimeout)

{
  int iVar1;
  undefined local_18 [8];
  int local_10;
  int local_c;
  int *local_8;
  
                    // 0x595a0  1340  SetMailslotInfo
  if (lReadTimeout == 0xffffffff) {
    local_c = -1;
    local_10 = -1;
  }
  else {
    iVar1 = (int)((ulonglong)lReadTimeout * 10000);
    local_10 = -iVar1;
    local_c = -((int)((ulonglong)lReadTimeout * 10000 >> 0x20) + (uint)(iVar1 != 0));
  }
  local_8 = &local_10;
  iVar1 = NtSetInformationFile(hMailslot,local_18,&local_8,4,0x1b);
  if (-1 >= iVar1) {
    BaseSetLastNTError(iVar1);
  }
  return (uint)(-1 < iVar1);
}



HANDLE CreateWaitableTimerW
                 (LPSECURITY_ATTRIBUTES lpTimerAttributes,BOOL bManualReset,LPCWSTR lpTimerName)

{
  HANDLE pvVar1;
  
                    // 0x59610  262  CreateWaitableTimerW
  pvVar1 = CreateWaitableTimerExW(lpTimerAttributes,lpTimerName,(uint)(bManualReset != 0),0x1f0003);
  return pvVar1;
}



HANDLE OpenWaitableTimerA(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCSTR lpTimerName)

{
  int iVar1;
  HANDLE pvVar2;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x59640  1050  OpenWaitableTimerA
  if (lpTimerName == (LPCSTR)0x0) {
    BaseSetLastNTError(0xc000000d);
  }
  else {
    iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpTimerName);
    if (iVar1 != 0) {
      pvVar2 = OpenWaitableTimerW(dwDesiredAccess,bInheritHandle,local_8);
      RtlFreeUnicodeString(local_c);
      return pvVar2;
    }
  }
  return (HANDLE)0x0;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

int __fastcall
FUN_6b85968e(undefined4 param_1,undefined4 *param_2,undefined4 *param_3,undefined4 *param_4,
            undefined4 *param_5,uint param_6)

{
  int iVar1;
  char cVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  uint local_34;
  int local_30;
  undefined local_2c [8];
  undefined4 local_24;
  int local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined4 local_8;
  
  uStack12 = 0x6b85969a;
  local_20 = 0;
  local_24 = 0;
  local_8 = 0;
  *param_2 = 0;
  param_2[1] = 0;
  *param_3 = 0;
  cVar2 = RtlDosPathNameToRelativeNtPathName_U(param_1,param_2,0,&local_44);
  if (cVar2 == '\0') {
    local_20 = -0x3fffffc6;
  }
  else {
    local_24 = 1;
    *param_3 = param_2[1];
    if ((short)local_44 == 0) {
      local_3c = 0;
    }
    else {
      *param_2 = local_44;
      param_2[1] = local_40;
    }
    *param_5 = 0x18;
    param_5[1] = local_3c;
    param_5[3] = 0x40;
    param_5[2] = param_2;
    param_5[4] = 0;
    param_5[5] = 0;
    local_20 = NtOpenFile(param_4,param_6 | 0x100080,param_5,local_2c,7,0x604020);
    if (local_20 < 0) {
      if (local_20 != -0x3ffffff3) goto LAB_6b8597d7;
    }
    else {
      local_20 = NtQueryInformationFile(*param_4,local_2c,&local_34,8,0x23);
      if (((local_20 < 0) &&
          (((local_20 != -0x3ffffffe && (local_20 != -0x3ffffff3)) || (local_20 < 0)))) ||
         (((local_34 & 0x400) == 0 || (local_30 == -0x5ffffffd)))) goto LAB_6b8597d7;
      NtClose(*param_4);
      *param_4 = 0xffffffff;
    }
    local_20 = NtOpenFile(param_4,param_6 | 0x100000,param_5,local_2c,7,0x404020);
  }
LAB_6b8597d7:
  iVar1 = local_20;
  local_8 = 0xfffffffe;
  FUN_6b8597fd();
  *in_FS_OFFSET = local_14;
  return iVar1;
}



void FUN_6b8597fd(void)

{
  int unaff_EBP;
  int unaff_EDI;
  
  if (unaff_EDI != 0) {
    RtlReleaseRelativeName(unaff_EBP + -0x40);
  }
  return;
}



BOOLEAN CreateSymbolicLinkA(LPCSTR lpSymlinkFileName,LPCSTR lpTargetFileName,DWORD dwFlags)

{
  BOOLEAN BVar1;
  int iVar2;
  undefined local_14 [4];
  LPCWSTR local_10;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x59820  244  CreateSymbolicLinkA
  if ((lpSymlinkFileName == (LPCSTR)0x0) || (lpTargetFileName == (LPCSTR)0x0)) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    iVar2 = Basep8BitStringToDynamicUnicodeString(local_c,lpSymlinkFileName);
    if (iVar2 != 0) {
      iVar2 = Basep8BitStringToDynamicUnicodeString(local_14,lpTargetFileName);
      if (iVar2 != 0) {
        BVar1 = CreateSymbolicLinkW(local_8,local_10,dwFlags);
        RtlFreeUnicodeString(local_14);
        RtlFreeUnicodeString(local_c);
        return BVar1;
      }
      RtlFreeUnicodeString(local_c);
    }
  }
  return '\0';
}



BOOLEAN CreateSymbolicLinkTransactedA
                  (LPCSTR lpSymlinkFileName,LPCSTR lpTargetFileName,DWORD dwFlags,
                  HANDLE hTransaction)

{
  BOOLEAN BVar1;
  int iVar2;
  undefined local_14 [4];
  LPCWSTR local_10;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x598a0  245  CreateSymbolicLinkTransactedA
  if ((lpSymlinkFileName == (LPCSTR)0x0) || (lpTargetFileName == (LPCSTR)0x0)) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    iVar2 = Basep8BitStringToDynamicUnicodeString(local_c,lpSymlinkFileName);
    if (iVar2 != 0) {
      iVar2 = Basep8BitStringToDynamicUnicodeString(local_14,lpTargetFileName);
      if (iVar2 != 0) {
        BVar1 = CreateSymbolicLinkTransactedW(local_8,local_10,dwFlags,hTransaction);
        RtlFreeUnicodeString(local_14);
        RtlFreeUnicodeString(local_c);
        return BVar1;
      }
      RtlFreeUnicodeString(local_c);
    }
  }
  return '\0';
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOLEAN CreateSymbolicLinkTransactedW
                  (LPCWSTR lpSymlinkFileName,LPCWSTR lpTargetFileName,DWORD dwFlags,
                  HANDLE hTransaction)

{
  BOOLEAN BVar1;
  int iVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar3;
  undefined4 local_14;
  
                    // 0x59920  246  CreateSymbolicLinkTransactedW
  BVar1 = '\0';
  if ((hTransaction == (HANDLE)0xffffffff) || (hTransaction == (HANDLE)0x0)) {
    uVar3 = 0x1a2c;
  }
  else {
    iVar2 = RtlGetCurrentTransaction();
    if (iVar2 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      BVar1 = CreateSymbolicLinkW(lpSymlinkFileName,lpTargetFileName,dwFlags);
      FUN_6b859980();
      goto LAB_6b859994;
    }
    uVar3 = 0x1a45;
  }
  RtlSetLastWin32Error(uVar3);
LAB_6b859994:
  *in_FS_OFFSET = local_14;
  return BVar1;
}



void FUN_6b859980(void)

{
  RtlSetCurrentTransaction(0);
  return;
}



BOOL DeleteFileTransactedA(LPCSTR lpFileName,HANDLE hTransaction)

{
  BOOL BVar1;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x599b0  281  DeleteFileTransactedA
  BVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpFileName);
  if (BVar1 != 0) {
    BVar1 = DeleteFileTransactedW(local_8,hTransaction);
    RtlFreeUnicodeString(local_c);
  }
  return BVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL DeleteFileTransactedW(LPCWSTR lpFileName,HANDLE hTransaction)

{
  int iVar1;
  BOOL BVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar3;
  undefined4 local_14;
  
                    // 0x599f0  282  DeleteFileTransactedW
  BVar2 = 0;
  if ((hTransaction == (HANDLE)0xffffffff) || (hTransaction == (HANDLE)0x0)) {
    uVar3 = 0x1a2c;
  }
  else {
    iVar1 = RtlGetCurrentTransaction();
    if (iVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      BVar2 = DeleteFileW(lpFileName);
      FUN_6b859a48();
      goto LAB_6b859a5c;
    }
    uVar3 = 0x1a45;
  }
  RtlSetLastWin32Error(uVar3);
LAB_6b859a5c:
  *in_FS_OFFSET = local_14;
  return BVar2;
}



void FUN_6b859a48(void)

{
  RtlSetCurrentTransaction(0);
  return;
}



DWORD GetCompressedFileSizeTransactedA(LPCSTR lpFileName,LPDWORD lpFileSizeHigh,HANDLE hTransaction)

{
  int iVar1;
  DWORD DVar2;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x59a80  479  GetCompressedFileSizeTransactedA
  iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpFileName);
  if (iVar1 == 0) {
    DVar2 = 0xffffffff;
  }
  else {
    DVar2 = GetCompressedFileSizeTransactedW(local_8,lpFileSizeHigh,hTransaction);
    RtlFreeUnicodeString(local_c);
  }
  return DVar2;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

DWORD GetCompressedFileSizeTransactedW
                (LPCWSTR lpFileName,LPDWORD lpFileSizeHigh,HANDLE hTransaction)

{
  int iVar1;
  DWORD DVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar3;
  undefined4 local_14;
  
                    // 0x59ad0  480  GetCompressedFileSizeTransactedW
  DVar2 = 0xffffffff;
  if ((hTransaction == (HANDLE)0xffffffff) || (hTransaction == (HANDLE)0x0)) {
    uVar3 = 0x1a2c;
  }
  else {
    iVar1 = RtlGetCurrentTransaction();
    if (iVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      DVar2 = GetCompressedFileSizeW(lpFileName,lpFileSizeHigh);
      FUN_6b859b2d();
      goto LAB_6b859b41;
    }
    uVar3 = 0x1a45;
  }
  RtlSetLastWin32Error(uVar3);
LAB_6b859b41:
  *in_FS_OFFSET = local_14;
  return DVar2;
}



void FUN_6b859b2d(void)

{
  RtlSetCurrentTransaction(0);
  return;
}



BOOL GetFileAttributesTransactedA
               (LPCSTR lpFileName,GET_FILEEX_INFO_LEVELS fInfoLevelId,LPVOID lpFileInformation,
               HANDLE hTransaction)

{
  BOOL BVar1;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x59b60  585  GetFileAttributesTransactedA
  BVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpFileName);
  if (BVar1 != 0) {
    BVar1 = GetFileAttributesTransactedW(local_8,fInfoLevelId,lpFileInformation,hTransaction);
    RtlFreeUnicodeString(local_c);
  }
  return BVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL GetFileAttributesTransactedW
               (LPCWSTR lpFileName,GET_FILEEX_INFO_LEVELS fInfoLevelId,LPVOID lpFileInformation,
               HANDLE hTransaction)

{
  int iVar1;
  BOOL BVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar3;
  undefined4 local_14;
  
                    // 0x59bb0  586  GetFileAttributesTransactedW
  if ((hTransaction == (HANDLE)0xffffffff) || (hTransaction == (HANDLE)0x0)) {
    uVar3 = 0x1a2c;
  }
  else {
    iVar1 = RtlGetCurrentTransaction();
    if (iVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      BVar2 = GetFileAttributesExW(lpFileName,fInfoLevelId,lpFileInformation);
      FUN_6b859c0d();
      goto LAB_6b859c23;
    }
    uVar3 = 0x1a45;
  }
  RtlSetLastWin32Error(uVar3);
  BVar2 = 0;
LAB_6b859c23:
  *in_FS_OFFSET = local_14;
  return BVar2;
}



void FUN_6b859c0d(void)

{
  RtlSetCurrentTransaction(0);
  return;
}



BOOL MoveFileExA(LPCSTR lpExistingFileName,LPCSTR lpNewFileName,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // 0x59c40  1005  MoveFileExA
  BVar1 = FUN_6b81f3fb(lpExistingFileName,(int)lpNewFileName,0,0,dwFlags,0);
  return BVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL MoveFileTransactedA(LPCSTR lpExistingFileName,LPCSTR lpNewFileName,
                        LPPROGRESS_ROUTINE lpProgressRoutine,LPVOID lpData,DWORD dwFlags,
                        HANDLE hTransaction)

{
  int iVar1;
  BOOL BVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar3;
  undefined4 local_14;
  
                    // 0x59c70  1007  MoveFileTransactedA
  BVar2 = 0;
  if ((hTransaction == (HANDLE)0xffffffff) || (hTransaction == (HANDLE)0x0)) {
    uVar3 = 0x1a2c;
  }
  else {
    iVar1 = RtlGetCurrentTransaction();
    if (iVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      BVar2 = FUN_6b81f3fb(lpExistingFileName,(int)lpNewFileName,lpProgressRoutine,lpData,dwFlags,
                           hTransaction);
      FUN_6b859cd3();
      goto LAB_6b859ce7;
    }
    uVar3 = 0x1a45;
  }
  RtlSetLastWin32Error(uVar3);
LAB_6b859ce7:
  *in_FS_OFFSET = local_14;
  return BVar2;
}



void FUN_6b859cd3(void)

{
  RtlSetCurrentTransaction(0);
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL MoveFileTransactedW(LPCWSTR lpExistingFileName,LPCWSTR lpNewFileName,
                        LPPROGRESS_ROUTINE lpProgressRoutine,LPVOID lpData,DWORD dwFlags,
                        HANDLE hTransaction)

{
  int iVar1;
  BOOL BVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar3;
  undefined4 local_14;
  
                    // 0x59d00  1008  MoveFileTransactedW
  BVar2 = 0;
  if ((hTransaction == (HANDLE)0xffffffff) || (hTransaction == (HANDLE)0x0)) {
    uVar3 = 0x1a2c;
  }
  else {
    iVar1 = RtlGetCurrentTransaction();
    if (iVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      BVar2 = MoveFileWithProgressTransactedW
                        (lpExistingFileName,lpNewFileName,lpProgressRoutine,lpData,dwFlags,
                         hTransaction);
      FUN_6b859d64();
      goto LAB_6b859d78;
    }
    uVar3 = 0x1a45;
  }
  RtlSetLastWin32Error(uVar3);
LAB_6b859d78:
  *in_FS_OFFSET = local_14;
  return BVar2;
}



void FUN_6b859d64(void)

{
  RtlSetCurrentTransaction(0);
  return;
}



BOOL MoveFileWithProgressA
               (LPCSTR lpExistingFileName,LPCSTR lpNewFileName,LPPROGRESS_ROUTINE lpProgressRoutine,
               LPVOID lpData,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // 0x59da0  1010  MoveFileWithProgressA
  BVar1 = FUN_6b81f3fb(lpExistingFileName,(int)lpNewFileName,lpProgressRoutine,lpData,dwFlags,0);
  return BVar1;
}



// WARNING: Function: __SEH_prolog4_GS replaced with injection: SEH_prolog4

bool PrivMoveFileIdentityW(uint param_1,undefined4 param_2,uint param_3)

{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined4 *in_FS_OFFSET;
  int iVar4;
  undefined4 local_e8 [6];
  undefined4 local_d0 [6];
  undefined local_b8 [8];
  undefined4 local_b0;
  undefined4 local_ac;
  undefined4 local_a8;
  undefined4 local_a4;
  undefined4 local_a0;
  uint local_9c;
  uint local_98;
  int local_94;
  int local_90;
  uint local_8c;
  undefined local_85;
  uint local_84;
  int local_80;
  int local_7c;
  int local_78;
  int local_74;
  undefined4 local_70;
  undefined4 local_6c;
  undefined4 local_48 [13];
  undefined4 local_14;
  undefined4 uStack12;
  undefined4 local_8;
  
                    // 0x59dd0  1070  PrivMoveFileIdentityW
  uStack12 = 0x6b859ddf;
  local_84 = param_1;
  local_a8 = param_2;
  local_78 = 0;
  local_7c = -1;
  local_80 = -1;
  local_b0 = 0;
  local_ac = 0;
  local_90 = 0;
  local_a4 = 0;
  local_a0 = 0;
  local_94 = 0;
  local_85 = 1;
  local_8 = 0;
  local_8c = 0x82;
  iVar2 = 0;
  if ((param_3 & 1) != 0) {
    local_8c = 0x10082;
  }
  while( true ) {
    local_74 = 0;
    local_74 = FUN_6b85968e(local_84,&local_b0,&local_90,&local_7c,local_d0,local_8c);
    if (-1 < local_74) break;
    if ((local_8c & param_3 & 2) == 0) {
      if (local_74 < 0) goto LAB_6b85a094;
      break;
    }
    if (local_90 != 0) {
      RtlFreeHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),0,local_90);
      local_90 = 0;
      iVar2 = local_78;
    }
    iVar1 = local_74;
    if (local_7c != -1) {
      NtClose(local_7c);
      local_7c = -1;
    }
    local_8c = local_8c & 0xfffffffd;
    if (-1 < iVar2) {
      iVar2 = iVar1;
      local_78 = iVar1;
    }
  }
  local_84 = 0x100;
  local_9c = local_8c & 2;
  if (local_9c != 0) {
    local_84 = 0x102;
  }
  while (local_98 = local_84,
        local_74 = FUN_6b85968e(local_a8,&local_a4,&local_94,&local_80,local_e8,
                                (uint)(local_9c != 0) * 2 + 0x100), local_74 < 0) {
    if ((local_84 & param_3 & 2) == 0) {
      if (local_74 < 0) goto LAB_6b85a094;
      break;
    }
    if (local_94 != 0) {
      RtlFreeHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),0,local_94);
      local_94 = 0;
      local_84 = local_98;
      iVar2 = local_78;
    }
    iVar1 = local_74;
    if (local_80 != -1) {
      NtClose(local_80);
      local_80 = -1;
    }
    local_84 = local_84 & 0xfffffffd;
    if (-1 < iVar2) {
      iVar2 = iVar1;
      local_78 = iVar1;
    }
    local_74 = 0;
  }
  local_74 = NtQueryInformationFile(local_7c,local_b8,&local_70,0x28,4);
  if (-1 < local_74) {
    puVar3 = local_48;
    for (iVar1 = 10; iVar1 != 0; iVar1 = iVar1 + -1) {
      *puVar3 = 0;
      puVar3 = puVar3 + 1;
    }
    local_48[0] = local_70;
    local_48[1] = local_6c;
    local_74 = NtSetInformationFile(local_80,local_b8,local_48,0x28,4);
  }
  local_9c = param_3 & 2;
  if (local_74 < 0) {
    if (local_9c == 0) goto LAB_6b85a094;
    if (-1 < iVar2) {
      iVar2 = local_74;
      local_78 = local_74;
    }
    local_74 = 0;
  }
  if ((((local_84 & local_8c & 2) != 0) &&
      (local_74 = BasepNotifyTrackingService(&local_7c,local_d0,local_80,&local_a4), local_74 < 0))
     && (local_9c != 0)) {
    if (-1 < iVar2) {
      iVar2 = local_74;
      local_78 = local_74;
    }
    local_74 = 0;
  }
LAB_6b85a094:
  iVar1 = local_74;
  local_8 = 0xfffffffe;
  FUN_6b85a0f4();
  if ((-1 < iVar1) && ((param_3 & 1) != 0)) {
    iVar1 = NtSetInformationFile(local_7c,local_b8,&local_85,1,0xd);
  }
  if (local_80 != -1) {
    NtClose(local_80);
  }
  if (local_7c != -1) {
    NtClose(local_7c);
  }
  iVar4 = iVar1;
  if ((iVar1 < 0) || (iVar4 = iVar2, iVar2 < 0)) {
    BaseSetLastNTError(iVar4);
  }
  *in_FS_OFFSET = local_14;
  return -1 < iVar1;
}



void FUN_6b85a0f4(void)

{
  int unaff_EBP;
  undefined4 unaff_EDI;
  int in_FS_OFFSET;
  
  if (*(int *)(unaff_EBP + -0x8c) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EDI,
                *(undefined4 *)(unaff_EBP + -0x8c));
  }
  if (*(int *)(unaff_EBP + -0x90) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EDI,
                *(undefined4 *)(unaff_EBP + -0x90));
  }
  return;
}



BOOL SetFileAttributesTransactedA(LPCSTR lpFileName,DWORD dwFileAttributes,HANDLE hTransaction)

{
  BOOL BVar1;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x5a170  1311  SetFileAttributesTransactedA
  BVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpFileName);
  if (BVar1 != 0) {
    BVar1 = SetFileAttributesTransactedW(local_8,dwFileAttributes,hTransaction);
    RtlFreeUnicodeString(local_c);
  }
  return BVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL SetFileAttributesTransactedW(LPCWSTR lpFileName,DWORD dwFileAttributes,HANDLE hTransaction)

{
  int iVar1;
  BOOL BVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar3;
  undefined4 local_14;
  
                    // 0x5a1b0  1312  SetFileAttributesTransactedW
  BVar2 = 0;
  if ((hTransaction == (HANDLE)0xffffffff) || (hTransaction == (HANDLE)0x0)) {
    uVar3 = 0x1a2c;
  }
  else {
    iVar1 = RtlGetCurrentTransaction();
    if (iVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      BVar2 = SetFileAttributesW(lpFileName,dwFileAttributes);
      FUN_6b85a20b();
      goto LAB_6b85a21f;
    }
    uVar3 = 0x1a45;
  }
  RtlSetLastWin32Error(uVar3);
LAB_6b85a21f:
  *in_FS_OFFSET = local_14;
  return BVar2;
}



void FUN_6b85a20b(void)

{
  RtlSetCurrentTransaction(0);
  return;
}



undefined4 Heap32First(int *param_1,int param_2,uint param_3)

{
  uint *puVar1;
  ushort uVar2;
  uint *puVar3;
  int iVar4;
  uint *puVar5;
  uint uVar6;
  longlong lVar7;
  int iVar8;
  int iVar9;
  uint uVar10;
  uint *puVar11;
  uint *puVar12;
  uint *puVar13;
  uint *puVar14;
  undefined4 uVar15;
  uint local_14;
  uint local_8;
  
                    // 0x5a240  839  Heap32First
  if ((param_1 == (int *)0x0) || (*param_1 != 0x24)) {
    iVar9 = -0x3ffffffc;
  }
  else {
    local_14 = 0x400000;
    while (iVar8 = RtlCreateQueryDebugBuffer(local_14,0), iVar8 != 0) {
      puVar3 = *(uint **)(iVar8 + 4);
      iVar4 = *(int *)(iVar8 + 0x2c);
      iVar9 = RtlQueryProcessDebugInformation(param_2,0x14,iVar8);
      if (iVar9 != -0x3fffffe9) {
LAB_6b85a2ba:
        if (iVar9 < 0) {
          RtlDestroyQueryDebugBuffer(iVar8);
          goto LAB_6b85a463;
        }
        puVar5 = *(uint **)(iVar8 + 0x38);
        uVar10 = local_8;
        if (((((puVar5 < puVar3) || (puVar12 = puVar5 + 0x11, puVar12 < puVar5)) ||
             (puVar11 = (uint *)(iVar4 + (int)puVar3), puVar11 < puVar3)) || (puVar11 < puVar12)) ||
           ((1 < *puVar5 &&
            (((lVar7 = (ulonglong)(*puVar5 - 1) * 0x40,
              iVar9 = FUN_6b850b02(&local_8,(int)lVar7,(int)((ulonglong)lVar7 >> 0x20)),
              uVar10 = local_8, iVar9 < 0 || (puVar12 < puVar3)) ||
             (((uint *)(local_8 + (int)puVar12) < puVar12 ||
              (puVar11 < (uint *)(local_8 + (int)puVar12))))))))) goto LAB_6b85a449;
        local_8 = 0;
        if (*puVar5 == 0) goto LAB_6b85a363;
        puVar12 = puVar5 + 1;
        goto LAB_6b85a34e;
      }
      if (local_14 * 2 <= local_14) {
        iVar9 = -0x3fffffdd;
        goto LAB_6b85a2ba;
      }
      RtlDestroyQueryDebugBuffer(iVar8);
      local_14 = local_14 * 2;
    }
    iVar9 = -0x3fffffff;
  }
LAB_6b85a463:
  BaseSetLastNTError(iVar9);
  return 0;
  while( true ) {
    local_8 = local_8 + 1;
    puVar12 = puVar12 + 0x10;
    if (*puVar5 <= local_8) break;
LAB_6b85a34e:
    if (*puVar12 == param_3) {
      puVar12 = (uint *)puVar12[0xf];
      uVar10 = local_8;
      if (((puVar12 < puVar3) || (puVar13 = puVar12 + 4, puVar13 < puVar12)) || (puVar11 < puVar13))
      goto LAB_6b85a449;
      param_1[6] = 0;
      param_1[5] = 0;
      param_1[7] = param_2;
      param_1[8] = param_3;
      param_1[1] = param_3;
      if ((*(byte *)(puVar12 + 1) & 2) == 0) goto LAB_6b85a40d;
      uVar10 = local_8 * 0x40;
      goto LAB_6b85a3ba;
    }
  }
LAB_6b85a363:
  uVar15 = 0;
  goto LAB_6b85a365;
LAB_6b85a449:
  local_8 = uVar10;
  RtlDestroyQueryDebugBuffer(iVar8);
  iVar9 = -0x3fffffc2;
  goto LAB_6b85a463;
  while (puVar1 = puVar13 + 1, puVar13 = puVar14, (*(byte *)puVar1 & 2) != 0) {
LAB_6b85a3ba:
    uVar2 = *(ushort *)(puVar5 + local_8 * 0x10 + 3);
    uVar6 = puVar13[-1];
    param_1[6] = param_1[6] + 1;
    param_1[2] = uVar2 + uVar6;
    if (*(uint *)(*(int *)(iVar8 + 0x38) + 0x1c + uVar10) <= (uint)param_1[6]) {
      local_8 = uVar10;
      RtlDestroyQueryDebugBuffer(iVar8);
      RtlSetLastWin32Error(0x12);
      return 0;
    }
    puVar12 = puVar12 + 4;
    puVar14 = puVar13 + 4;
    if (((puVar12 < puVar3) || (puVar14 < puVar12)) || (puVar11 < puVar14)) goto LAB_6b85a449;
  }
LAB_6b85a40d:
  local_8 = uVar10;
  uVar2 = *(ushort *)(puVar12 + 1);
  if ((uVar2 & 0x20f1) == 0) {
    if ((uVar2 & 0x20) == 0) {
      if ((uVar2 & 0x1000) != 0) {
        param_1[4] = 2;
      }
    }
    else {
      param_1[4] = 4;
    }
  }
  else {
    param_1[4] = 1;
  }
  param_1[3] = *puVar12;
  uVar15 = 1;
LAB_6b85a365:
  RtlDestroyQueryDebugBuffer(iVar8);
  return uVar15;
}



bool Heap32ListFirst(undefined4 param_1,int *param_2)

{
  int iVar1;
  int *piVar2;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  int *local_8;
  
                    // 0x5a480  840  Heap32ListFirst
  if ((param_2 == (int *)0x0) || (*param_2 != 0x10)) {
    iVar1 = -0x3ffffffc;
  }
  else {
    local_14 = 0;
    local_10 = 0;
    local_c = 0;
    local_8 = (int *)0x0;
    iVar1 = NtMapViewOfSection(param_1,0xffffffff,&local_8,0,0,&local_14,&local_c,1,0,4);
    if (-1 < iVar1) {
      iVar1 = *local_8;
      if (iVar1 != 0) {
        piVar2 = (int *)(local_8[4] + (int)local_8);
        *param_2 = *piVar2;
        param_2[1] = piVar2[1];
        param_2[2] = piVar2[2];
        param_2[3] = piVar2[3];
        local_8[8] = 1;
      }
      else {
        memset(param_2 + 1,0,*param_2 - 4);
        RtlSetLastWin32Error(0x12);
      }
      NtUnmapViewOfSection(0xffffffff,local_8);
      return iVar1 != 0;
    }
  }
  BaseSetLastNTError(iVar1);
  return false;
}



bool Heap32ListNext(undefined4 param_1,int *param_2)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  int *piVar4;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  uint *local_8;
  
                    // 0x5a530  841  Heap32ListNext
  if ((param_2 == (int *)0x0) || (*param_2 != 0x10)) {
    iVar3 = -0x3ffffffc;
  }
  else {
    local_14 = 0;
    local_10 = 0;
    local_c = 0;
    local_8 = (uint *)0x0;
    iVar3 = NtMapViewOfSection(param_1,0xffffffff,&local_8,0,0,&local_14,&local_c,1,0,4);
    if (-1 < iVar3) {
      uVar2 = local_8[8];
      uVar1 = *local_8;
      if (uVar1 <= uVar2) {
        RtlSetLastWin32Error(0x12);
      }
      else {
        piVar4 = (int *)(uVar2 * 0x10 + local_8[4] + (int)local_8);
        local_8[8] = uVar2 + 1;
        *param_2 = *piVar4;
        param_2[1] = piVar4[1];
        param_2[2] = piVar4[2];
        param_2[3] = piVar4[3];
      }
      NtUnmapViewOfSection(0xffffffff,local_8);
      return uVar1 > uVar2;
    }
  }
  BaseSetLastNTError(iVar3);
  return false;
}



undefined4 Heap32Next(int *param_1)

{
  uint *puVar1;
  ushort uVar2;
  uint uVar3;
  longlong lVar4;
  int iVar5;
  int iVar6;
  uint *puVar7;
  uint *puVar8;
  uint uVar9;
  uint *local_14;
  uint *local_10;
  uint *local_c;
  uint *local_8;
  
                    // 0x5a5d0  842  Heap32Next
  if ((param_1 == (int *)0x0) || (*param_1 != 0x24)) {
    puVar8 = (uint *)0xc0000004;
  }
  else {
    uVar9 = 0;
    local_10 = (uint *)0x400000;
    while (iVar5 = RtlCreateQueryDebugBuffer(local_10,0), iVar5 != 0) {
      local_c = *(uint **)(iVar5 + 4);
      local_14 = *(uint **)(iVar5 + 0x2c);
      local_8 = (uint *)RtlQueryProcessDebugInformation(param_1[7],0x14,iVar5);
      if (local_8 != (uint *)0xc0000017) {
LAB_6b85a64e:
        if ((int)local_8 < 0) {
          RtlDestroyQueryDebugBuffer(iVar5);
          puVar8 = local_8;
          goto LAB_6b85a801;
        }
        local_8 = *(uint **)(iVar5 + 0x38);
        if (((((local_8 < local_c) || (puVar8 = local_8 + 0x11, puVar8 < local_8)) ||
             (local_10 = (uint *)((int)local_14 + (int)local_c), local_10 < local_c)) ||
            (local_10 < puVar8)) ||
           ((uVar3 = *local_8, 1 < uVar3 &&
            (((lVar4 = (ulonglong)(uVar3 - 1) * 0x40,
              iVar6 = FUN_6b850b02(&local_14,(int)lVar4,(int)((ulonglong)lVar4 >> 0x20)), iVar6 < 0
              || (puVar8 < local_c)) ||
             (((uint *)((int)local_14 + (int)puVar8) < puVar8 ||
              (local_10 < (uint *)((int)local_14 + (int)puVar8))))))))) goto LAB_6b85a7e7;
        if (uVar3 == 0) goto LAB_6b85a7d6;
        puVar8 = local_8 + 1;
        goto LAB_6b85a6f4;
      }
      if ((uint *)((int)local_10 * 2) <= local_10) {
        local_8 = (uint *)0xc0000023;
        goto LAB_6b85a64e;
      }
      local_10 = (uint *)((int)local_10 * 2);
      RtlDestroyQueryDebugBuffer(iVar5);
    }
    puVar8 = (uint *)0xc0000001;
  }
LAB_6b85a801:
  BaseSetLastNTError(puVar8);
  return 0;
  while( true ) {
    uVar9 = uVar9 + 1;
    puVar8 = puVar8 + 0x10;
    if (uVar3 <= uVar9) break;
LAB_6b85a6f4:
    if (*puVar8 == param_1[8]) break;
  }
  if (uVar9 < uVar3) {
    param_1[6] = param_1[6] + 1;
    if ((uint)param_1[6] < local_8[uVar9 * 0x10 + 7]) {
      puVar8 = (uint *)(param_1[6] * 0x10 + local_8[uVar9 * 0x10 + 0x10]);
      if (((local_c <= puVar8) && (local_14 = puVar8 + 4, puVar8 <= local_14)) &&
         (local_14 <= local_10)) {
        puVar7 = local_14;
        if ((*(byte *)(puVar8 + 1) & 2) == 0) {
          param_1[2] = param_1[2] + param_1[3];
        }
        else {
          do {
            uVar2 = *(ushort *)(local_8 + uVar9 * 0x10 + 3);
            uVar3 = puVar7[-1];
            param_1[6] = param_1[6] + 1;
            param_1[2] = uVar2 + uVar3;
            local_14 = puVar7;
            if (*(uint *)(*(int *)(iVar5 + 0x38) + 0x1c + uVar9 * 0x40) <= (uint)param_1[6])
            goto LAB_6b85a7d6;
            puVar8 = puVar8 + 4;
            local_14 = puVar7 + 4;
            if (((puVar8 < local_c) || (local_14 < puVar8)) || (local_10 < local_14))
            goto LAB_6b85a7e7;
            puVar1 = puVar7 + 1;
            puVar7 = local_14;
          } while ((*(byte *)puVar1 & 2) != 0);
        }
        param_1[3] = *puVar8;
        uVar2 = *(ushort *)(puVar8 + 1);
        if ((uVar2 & 0x20f1) == 0) {
          if ((uVar2 & 0x20) == 0) {
            if ((uVar2 & 0x1000) != 0) {
              param_1[4] = 2;
            }
          }
          else {
            param_1[4] = 4;
          }
        }
        else {
          param_1[4] = 1;
        }
        RtlDestroyQueryDebugBuffer(iVar5);
        return 1;
      }
LAB_6b85a7e7:
      RtlDestroyQueryDebugBuffer(iVar5);
      puVar8 = (uint *)0xc000003e;
      goto LAB_6b85a801;
    }
  }
LAB_6b85a7d6:
  RtlDestroyQueryDebugBuffer(iVar5);
  RtlSetLastWin32Error(0x12);
  return 0;
}



void Module32First(undefined4 param_1,uint *param_2)

{
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar1;
  undefined auStack1084 [4];
  int local_438;
  uint local_434;
  uint local_430;
  uint local_42c;
  uint local_428;
  uint local_424;
  uint local_420;
  uint local_41c;
  WCHAR local_418 [256];
  WCHAR local_218 [262];
  uint local_c;
  
                    // 0x5a820  1000  Module32First
  local_c = DAT_6b8b0140 ^ (uint)auStack1084;
  if ((param_2 == (uint *)0x0) || (*param_2 < 0x224)) {
    RtlSetLastWin32Error(0x57);
    uVar1 = extraout_EDX_00;
  }
  else {
    local_438 = 0x428;
    Module32FirstW(param_1,&local_438);
    WideCharToMultiByte(0,0x400,local_218,-1,(LPSTR)(param_2 + 0x48),0x104,(LPCSTR)0x0,(LPBOOL)0x0);
    WideCharToMultiByte(0,0x400,local_418,-1,(LPSTR)(param_2 + 8),0x100,(LPCSTR)0x0,(LPBOOL)0x0);
    param_2[1] = local_434;
    param_2[2] = local_430;
    param_2[3] = local_42c;
    param_2[4] = local_428;
    param_2[5] = local_424;
    param_2[6] = local_420;
    param_2[7] = local_41c;
    uVar1 = extraout_EDX;
  }
  FUN_6b8224af(local_c ^ (uint)auStack1084,uVar1);
  return;
}



undefined4 Module32FirstW(undefined4 param_1,int *param_2)

{
  int iVar1;
  undefined4 uVar2;
  int *piVar3;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  int local_8;
  
                    // 0x5a910  1001  Module32FirstW
  if ((param_2 == (int *)0x0) || (*param_2 != 0x428)) {
    iVar1 = -0x3ffffffc;
  }
  else {
    local_14 = 0;
    uVar2 = 1;
    local_10 = 0;
    local_c = 0;
    local_8 = 0;
    iVar1 = NtMapViewOfSection(param_1,0xffffffff,&local_8,0,0,&local_14,&local_c,1,0,4);
    if (-1 < iVar1) {
      if (*(int *)(local_8 + 8) == 0) {
        memset(param_2 + 1,0,*param_2 - 4);
        RtlSetLastWin32Error(0x12);
        uVar2 = 0;
      }
      else {
        piVar3 = (int *)(*(int *)(local_8 + 0x18) + local_8);
        for (iVar1 = 0x10a; iVar1 != 0; iVar1 = iVar1 + -1) {
          *param_2 = *piVar3;
          piVar3 = piVar3 + 1;
          param_2 = param_2 + 1;
        }
        *(undefined4 *)(local_8 + 0x28) = 1;
      }
      NtUnmapViewOfSection(0xffffffff,local_8);
      return uVar2;
    }
  }
  BaseSetLastNTError(iVar1);
  return 0;
}



void Module32Next(undefined4 param_1,uint *param_2)

{
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar1;
  undefined auStack1084 [4];
  int local_438;
  uint local_434;
  uint local_42c;
  uint local_428;
  uint local_424;
  uint local_420;
  uint local_41c;
  WCHAR local_418 [256];
  WCHAR local_218 [262];
  uint local_c;
  
                    // 0x5a9c0  1002  Module32Next
  local_c = DAT_6b8b0140 ^ (uint)auStack1084;
  if ((param_2 == (uint *)0x0) || (*param_2 < 0x224)) {
    RtlSetLastWin32Error(0xd);
    uVar1 = extraout_EDX_00;
  }
  else {
    local_438 = 0x428;
    Module32NextW(param_1,&local_438);
    WideCharToMultiByte(0,0x400,local_418,-1,(LPSTR)(param_2 + 8),0x100,(LPCSTR)0x0,(LPBOOL)0x0);
    WideCharToMultiByte(0,0x400,local_218,-1,(LPSTR)(param_2 + 0x48),0x104,(LPCSTR)0x0,(LPBOOL)0x0);
    param_2[1] = local_434;
    param_2[3] = local_42c;
    param_2[4] = local_428;
    param_2[5] = local_424;
    param_2[6] = local_420;
    param_2[7] = local_41c;
    uVar1 = extraout_EDX;
  }
  FUN_6b8224af(local_c ^ (uint)auStack1084,uVar1);
  return;
}



undefined4 Module32NextW(undefined4 param_1,int *param_2)

{
  uint uVar1;
  int iVar2;
  undefined4 uVar3;
  int *piVar4;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  int local_8;
  
                    // 0x5aab0  1003  Module32NextW
  uVar3 = 0;
  if ((param_2 == (int *)0x0) || (*param_2 != 0x428)) {
    iVar2 = -0x3ffffffc;
  }
  else {
    local_14 = 0;
    local_10 = 0;
    local_c = 0;
    local_8 = 0;
    iVar2 = NtMapViewOfSection(param_1,0xffffffff,&local_8,0,0,&local_14,&local_c,1,0,4);
    if (-1 < iVar2) {
      uVar1 = *(uint *)(local_8 + 0x28);
      if (uVar1 < *(uint *)(local_8 + 8)) {
        *(uint *)(local_8 + 0x28) = uVar1 + 1;
        piVar4 = (int *)(uVar1 * 0x428 + *(int *)(local_8 + 0x18) + local_8);
        for (iVar2 = 0x10a; iVar2 != 0; iVar2 = iVar2 + -1) {
          *param_2 = *piVar4;
          piVar4 = piVar4 + 1;
          param_2 = param_2 + 1;
        }
        uVar3 = 1;
      }
      else {
        RtlSetLastWin32Error(0x12);
      }
      NtUnmapViewOfSection(0xffffffff,local_8);
      return uVar3;
    }
  }
  BaseSetLastNTError(iVar2);
  return 0;
}



void __fastcall FUN_6b85ab4b(undefined4 param_1,undefined4 param_2,undefined2 param_3)

{
  undefined local_14 [8];
  undefined local_c [2];
  undefined2 local_a;
  undefined4 local_8;
  
  local_a = param_3;
  local_8 = param_1;
  RtlInitAnsiString(local_14,param_2);
  RtlAnsiStringToUnicodeString(local_c,local_14,0);
  return;
}



undefined4 Thread32First(undefined4 param_1,int *param_2)

{
  int iVar1;
  undefined4 uVar2;
  int *piVar3;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  int local_8;
  
                    // 0x5ab90  1442  Thread32First
  if ((param_2 == (int *)0x0) || (*param_2 != 0x1c)) {
    iVar1 = -0x3ffffffc;
  }
  else {
    local_14 = 0;
    uVar2 = 1;
    local_10 = 0;
    local_c = 0;
    local_8 = 0;
    iVar1 = NtMapViewOfSection(param_1,0xffffffff,&local_8,0,0,&local_14,&local_c,1,0,4);
    if (-1 < iVar1) {
      if (*(int *)(local_8 + 0xc) == 0) {
        memset(param_2 + 1,0,*param_2 - 4);
        RtlSetLastWin32Error(0x12);
        uVar2 = 0;
      }
      else {
        piVar3 = (int *)(*(int *)(local_8 + 0x1c) + local_8);
        for (iVar1 = 7; iVar1 != 0; iVar1 = iVar1 + -1) {
          *param_2 = *piVar3;
          piVar3 = piVar3 + 1;
          param_2 = param_2 + 1;
        }
        *(undefined4 *)(local_8 + 0x2c) = 1;
      }
      NtUnmapViewOfSection(0xffffffff,local_8);
      return uVar2;
    }
  }
  BaseSetLastNTError(iVar1);
  return 0;
}



undefined4 Thread32Next(undefined4 param_1,int *param_2)

{
  uint uVar1;
  int iVar2;
  undefined4 uVar3;
  int *piVar4;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  int local_8;
  
                    // 0x5ac40  1443  Thread32Next
  uVar3 = 0;
  if ((param_2 == (int *)0x0) || (*param_2 != 0x1c)) {
    iVar2 = -0x3ffffffc;
  }
  else {
    local_14 = 0;
    local_10 = 0;
    local_c = 0;
    local_8 = 0;
    iVar2 = NtMapViewOfSection(param_1,0xffffffff,&local_8,0,0,&local_14,&local_c,1,0,4);
    if (-1 < iVar2) {
      uVar1 = *(uint *)(local_8 + 0x2c);
      if (uVar1 < *(uint *)(local_8 + 0xc)) {
        *(uint *)(local_8 + 0x2c) = uVar1 + 1;
        piVar4 = (int *)(uVar1 * 0x1c + *(int *)(local_8 + 0x1c) + local_8);
        for (iVar2 = 7; iVar2 != 0; iVar2 = iVar2 + -1) {
          *param_2 = *piVar4;
          piVar4 = piVar4 + 1;
          param_2 = param_2 + 1;
        }
        uVar3 = 1;
      }
      else {
        RtlSetLastWin32Error(0x12);
      }
      NtUnmapViewOfSection(0xffffffff,local_8);
      return uVar3;
    }
  }
  BaseSetLastNTError(iVar2);
  return 0;
}



BOOL DefineDosDeviceA(DWORD dwFlags,LPCSTR lpDeviceName,LPCSTR lpTargetPath)

{
  int iVar1;
  BOOL BVar2;
  undefined local_14 [4];
  LPCWSTR local_10;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x5ace0  273  DefineDosDeviceA
  iVar1 = Basep8BitStringToDynamicUnicodeString(local_14,lpDeviceName);
  if (iVar1 == 0) {
    return 0;
  }
  if (lpTargetPath == (LPCSTR)0x0) {
    local_8 = (LPCWSTR)0x0;
  }
  else {
    iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpTargetPath);
    if (iVar1 == 0) {
      BVar2 = 0;
      goto LAB_6b85ad3a;
    }
  }
  BVar2 = DefineDosDeviceW(dwFlags,local_10,local_8);
  if (lpTargetPath != (LPCSTR)0x0) {
    RtlFreeUnicodeString(local_c);
  }
LAB_6b85ad3a:
  RtlFreeUnicodeString(local_14);
  return BVar2;
}



// WARNING: Could not reconcile some variable overlaps

DWORD QueryDosDeviceA(LPCSTR lpDeviceName,LPSTR lpTargetPath,DWORD ucchMax)

{
  LPCWSTR lpDeviceName_00;
  int iVar1;
  undefined4 *puVar2;
  LPWSTR lpTargetPath_00;
  DWORD DVar3;
  code *pcVar4;
  uint uVar5;
  uint uVar6;
  int in_FS_OFFSET;
  uint local_34;
  int local_30;
  undefined4 local_20;
  LPCWSTR local_1c;
  ushort local_18;
  short local_16;
  LPSTR local_14;
  short local_10;
  short local_e;
  LPWSTR local_c;
  
                    // 0x5ad60  1096  QueryDosDeviceA
  uVar5 = 0;
  local_20 = 0;
  local_1c = (LPCWSTR)0x0;
  local_30 = 0;
  if ((lpDeviceName == (LPCSTR)0x0) ||
     (iVar1 = Basep8BitStringToDynamicUnicodeString(&local_20,lpDeviceName), iVar1 != 0)) {
    lpDeviceName_00 = local_1c;
    puVar2 = (undefined4 *)KernelBaseGetGlobalData();
    lpTargetPath_00 =
         (LPWSTR)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar2,
                                 ucchMax * 2);
    if (lpTargetPath_00 != (LPWSTR)0x0) {
      DVar3 = QueryDosDeviceW(lpDeviceName_00,lpTargetPath_00,ucchMax);
      if (DVar3 != 0) {
        uVar5 = DVar3 - 1;
      }
      uVar6 = 0;
      if (uVar5 != 0) {
        do {
          local_34 = 0x7ffe;
          if (uVar5 - uVar6 < 0x7ffe) {
            local_34 = uVar5 - uVar6 & 0xffff;
          }
          local_14 = lpTargetPath + local_30;
          local_18 = 0;
          if (ucchMax - local_30 < 0x10000) {
            local_16 = (short)ucchMax - (short)local_30;
          }
          else {
            local_16 = -1;
          }
          local_c = lpTargetPath_00 + uVar6;
          while( true ) {
            local_10 = (short)local_34 * 2;
            local_e = local_10 + 2;
            pcVar4 = (code *)GetUnicodeStringToEightBitStringRoutine(&local_18,&local_10,0);
            _guard_check_icall();
            iVar1 = (*pcVar4)();
            if (iVar1 != -0x3fffff10) break;
            local_34._0_2_ = (ushort)local_34 >> 1;
            local_34 = (uint)(ushort)local_34;
          }
          if (iVar1 < 0) {
            BaseSetLastNTError(iVar1);
            DVar3 = 0;
            break;
          }
          local_30 = local_30 + (uint)local_18;
          uVar6 = uVar6 + local_34;
        } while (uVar6 < uVar5);
      }
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpTargetPath_00);
      if (local_1c == (LPCWSTR)0x0) {
        return DVar3;
      }
      RtlFreeUnicodeString(&local_20);
      return DVar3;
    }
    RtlSetLastWin32Error(8);
    if (local_1c != (LPCWSTR)0x0) {
      RtlFreeUnicodeString(&local_20);
    }
  }
  return 0;
}



BOOL DeleteVolumeMountPointA(LPCSTR lpszVolumeMountPoint)

{
  BOOL BVar1;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x5af20  289  DeleteVolumeMountPointA
  BVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpszVolumeMountPoint);
  if (BVar1 != 0) {
    BVar1 = DeleteVolumeMountPointW(local_8);
    RtlFreeUnicodeString(local_c);
  }
  return BVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

HANDLE FindFirstVolumeA(LPSTR lpszVolumeName,DWORD cchBufferLength)

{
  ushort uVar1;
  undefined4 *puVar2;
  code *pcVar3;
  int iVar4;
  HANDLE pvVar5;
  undefined4 *in_FS_OFFSET;
  ushort local_34;
  short local_32;
  LPSTR local_30;
  uint local_2c;
  LPWSTR local_28;
  HANDLE local_24;
  ushort local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined4 local_8;
  
                    // 0x5af60  393  FindFirstVolumeA
  uStack12 = 0x6b85af6c;
  local_24 = (HANDLE)0x0;
  local_30 = lpszVolumeName;
  local_32 = (short)cchBufferLength;
  local_34 = local_32 - 1;
  local_28 = (LPWSTR)0x0;
  local_2c = 0;
  local_8 = 0;
  uVar1 = local_32 * 2;
  local_20 = uVar1;
  puVar2 = (undefined4 *)KernelBaseGetGlobalData();
  local_28 = (LPWSTR)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),*puVar2,uVar1);
  if (local_28 == (LPWSTR)0x0) {
    RtlSetLastWin32Error(8);
  }
  else {
    local_2c = local_2c & 0xffff | (uint)local_20 << 0x10;
    pvVar5 = FindFirstVolumeW(local_28,cchBufferLength);
    local_24 = pvVar5;
    if (pvVar5 == (HANDLE)0xffffffff) goto LAB_6b85b032;
    RtlInitUnicodeString(&local_2c,local_28);
    pcVar3 = (code *)GetUnicodeStringToEightBitStringRoutine(&local_34,&local_2c,0);
    _guard_check_icall();
    iVar4 = (*pcVar3)();
    if (-1 < iVar4) {
      if (local_34 < cchBufferLength) {
        local_30[local_34] = '\0';
        goto LAB_6b85b032;
      }
      iVar4 = -0x7ffffffb;
    }
    BaseSetLastNTError(iVar4);
  }
  pvVar5 = (HANDLE)0xffffffff;
  local_24 = (HANDLE)0xffffffff;
LAB_6b85b032:
  local_8 = 0xfffffffe;
  FUN_6b85b057();
  *in_FS_OFFSET = local_14;
  return pvVar5;
}



void FUN_6b85b057(void)

{
  undefined4 unaff_EBX;
  int unaff_EBP;
  int in_FS_OFFSET;
  
  if (*(int *)(unaff_EBP + -0x24) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EBX,
                *(undefined4 *)(unaff_EBP + -0x24));
  }
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

HANDLE FindFirstVolumeMountPointA
                 (LPCSTR lpszRootPathName,LPSTR lpszVolumeMountPoint,DWORD cchBufferLength)

{
  ushort uVar1;
  int iVar2;
  HANDLE pvVar3;
  undefined4 *puVar4;
  code *pcVar5;
  undefined4 *in_FS_OFFSET;
  undefined local_3c [4];
  LPCWSTR local_38;
  ushort local_34;
  short local_32;
  LPSTR local_30;
  uint local_2c;
  LPWSTR local_28;
  HANDLE local_24;
  ushort local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x5b080  394  FindFirstVolumeMountPointA
  local_8 = &DAT_6b8923d0;
  uStack12 = 0x6b85b08c;
  local_24 = (HANDLE)0x0;
  iVar2 = Basep8BitStringToDynamicUnicodeString(local_3c,lpszRootPathName);
  if (iVar2 == 0) {
    pvVar3 = (HANDLE)0xffffffff;
    goto LAB_6b85b17a;
  }
  local_30 = lpszVolumeMountPoint;
  local_32 = (short)cchBufferLength;
  local_34 = local_32 - 1;
  local_28 = (LPWSTR)0x0;
  local_2c = 0;
  local_8 = (undefined *)0x0;
  uVar1 = local_32 * 2;
  local_20 = uVar1;
  puVar4 = (undefined4 *)KernelBaseGetGlobalData();
  local_28 = (LPWSTR)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),*puVar4,uVar1);
  if (local_28 == (LPWSTR)0x0) {
    RtlSetLastWin32Error(8);
LAB_6b85b0fe:
    pvVar3 = (HANDLE)0xffffffff;
    local_24 = (HANDLE)0xffffffff;
  }
  else {
    local_2c = local_2c & 0xffff | (uint)local_20 << 0x10;
    pvVar3 = FindFirstVolumeMountPointW(local_38,local_28,cchBufferLength);
    local_24 = pvVar3;
    if (pvVar3 != (HANDLE)0xffffffff) {
      RtlInitUnicodeString(&local_2c,local_28);
      pcVar5 = (code *)GetUnicodeStringToEightBitStringRoutine(&local_34,&local_2c,0);
      _guard_check_icall();
      iVar2 = (*pcVar5)();
      if (-1 < iVar2) {
        if (local_34 < cchBufferLength) {
          local_30[local_34] = '\0';
          goto LAB_6b85b16c;
        }
        iVar2 = -0x7ffffffb;
      }
      BaseSetLastNTError(iVar2);
      goto LAB_6b85b0fe;
    }
  }
LAB_6b85b16c:
  local_8 = (undefined *)0xfffffffe;
  FUN_6b85b191();
LAB_6b85b17a:
  *in_FS_OFFSET = local_14;
  return pvVar3;
}



void FUN_6b85b191(void)

{
  undefined4 unaff_EBX;
  int unaff_EBP;
  int in_FS_OFFSET;
  
  if (*(int *)(unaff_EBP + -0x24) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EBX,
                *(undefined4 *)(unaff_EBP + -0x24));
  }
  RtlFreeUnicodeString(unaff_EBP + -0x38);
  return;
}



HANDLE FindFirstVolumeMountPointW
                 (LPCWSTR lpszRootPathName,LPWSTR lpszVolumeMountPoint,DWORD cchBufferLength)

{
  int iVar1;
  UINT UVar2;
  uint uVar3;
  undefined4 *puVar4;
  HANDLE hObject;
  HANDLE *ppvVar5;
  HANDLE *ppvVar6;
  int in_FS_OFFSET;
  undefined4 uVar7;
  ushort local_20;
  undefined2 local_1e;
  LPCWSTR local_1c;
  ushort local_18 [2];
  int local_14;
  ushort local_10 [6];
  
                    // 0x5b1c0  395  FindFirstVolumeMountPointW
  if (lpszRootPathName == (LPCWSTR)0x0) {
LAB_6b85b35a:
    uVar7 = 0x57;
LAB_6b85b35c:
    RtlSetLastWin32Error(uVar7);
  }
  else {
    iVar1 = RtlInitUnicodeStringEx(local_18,lpszRootPathName);
    if (-1 < iVar1) {
      if (*(short *)(local_14 + -2 + (uint)(local_18[0] >> 1) * 2) == 0x5c) {
        UVar2 = GetDriveTypeW(lpszRootPathName);
        if (UVar2 == 4) goto LAB_6b85b35a;
        RtlInitUnicodeString(local_10,L"$Extend\\$Reparse:$R:$INDEX_ALLOCATION");
        uVar3 = local_18[0] + 2 + (uint)local_10[0];
        if (uVar3 < 0x10000) {
          local_1e = (undefined2)uVar3;
          local_20 = 0;
          puVar4 = (undefined4 *)KernelBaseGetGlobalData();
          local_1c = (LPCWSTR)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                                              *puVar4,local_1e);
          if (local_1c != (LPCWSTR)0x0) {
            RtlCopyUnicodeString(&local_20,local_18);
            RtlAppendUnicodeStringToString(&local_20,local_10);
            local_1c[local_20 >> 1] = L'\0';
            hObject = CreateFileW(local_1c,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0x2020000,
                                  (HANDLE)0x0);
            RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_1c);
            if (hObject == (HANDLE)0xffffffff) {
              return (HANDLE)0xffffffff;
            }
            puVar4 = (undefined4 *)KernelBaseGetGlobalData();
            ppvVar5 = (HANDLE *)
                      RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar4,
                                      0x18);
            if (ppvVar5 != (HANDLE *)0x0) {
              ppvVar6 = ppvVar5;
              for (iVar1 = 6; iVar1 != 0; iVar1 = iVar1 + -1) {
                *ppvVar6 = (HANDLE)0x0;
                ppvVar6 = ppvVar6 + 1;
              }
              *ppvVar5 = hObject;
              iVar1 = FUN_6b85b5b4(ppvVar5,lpszVolumeMountPoint,cchBufferLength,1);
              if (iVar1 == 0) {
                CloseHandle(*ppvVar5);
                RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,ppvVar5);
                return (HANDLE)0xffffffff;
              }
              return ppvVar5;
            }
            CloseHandle(hObject);
          }
          uVar7 = 8;
          goto LAB_6b85b35c;
        }
      }
      iVar1 = -0x3fffffcd;
    }
    BaseSetLastNTError(iVar1);
  }
  return (HANDLE)0xffffffff;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL FindNextVolumeA(HANDLE hFindVolume,LPSTR lpszVolumeName,DWORD cchBufferLength)

{
  ushort uVar1;
  undefined4 *puVar2;
  code *pcVar3;
  int iVar4;
  BOOL BVar5;
  undefined4 *in_FS_OFFSET;
  ushort local_34;
  short local_32;
  LPSTR local_30;
  uint local_2c;
  LPWSTR local_28;
  BOOL local_24;
  ushort local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined4 local_8;
  
                    // 0x5b380  404  FindNextVolumeA
  uStack12 = 0x6b85b38c;
  local_24 = 0;
  local_30 = lpszVolumeName;
  local_32 = (short)cchBufferLength;
  local_34 = local_32 - 1;
  local_28 = (LPWSTR)0x0;
  local_2c = 0;
  local_8 = 0;
  uVar1 = local_32 * 2;
  local_20 = uVar1;
  puVar2 = (undefined4 *)KernelBaseGetGlobalData();
  local_28 = (LPWSTR)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),*puVar2,uVar1);
  if (local_28 == (LPWSTR)0x0) {
    RtlSetLastWin32Error(8);
  }
  else {
    local_2c = local_2c & 0xffff | (uint)local_20 << 0x10;
    BVar5 = FindNextVolumeW(hFindVolume,local_28,cchBufferLength);
    local_24 = BVar5;
    if (BVar5 == 0) goto LAB_6b85b453;
    RtlInitUnicodeString(&local_2c,local_28);
    pcVar3 = (code *)GetUnicodeStringToEightBitStringRoutine(&local_34,&local_2c,0);
    _guard_check_icall();
    iVar4 = (*pcVar3)();
    if (-1 < iVar4) {
      if (local_34 < cchBufferLength) {
        local_30[local_34] = '\0';
        goto LAB_6b85b453;
      }
      iVar4 = -0x7ffffffb;
    }
    BaseSetLastNTError(iVar4);
  }
  BVar5 = 0;
  local_24 = 0;
LAB_6b85b453:
  local_8 = 0xfffffffe;
  FUN_6b85b478();
  *in_FS_OFFSET = local_14;
  return BVar5;
}



void FUN_6b85b478(void)

{
  undefined4 unaff_EBX;
  int unaff_EBP;
  int in_FS_OFFSET;
  
  if (*(int *)(unaff_EBP + -0x24) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EBX,
                *(undefined4 *)(unaff_EBP + -0x24));
  }
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL FindNextVolumeMountPointA
               (HANDLE hFindVolumeMountPoint,LPSTR lpszVolumeMountPoint,DWORD cchBufferLength)

{
  ushort uVar1;
  undefined4 *puVar2;
  code *pcVar3;
  int iVar4;
  int iVar5;
  undefined4 *in_FS_OFFSET;
  ushort local_34;
  short local_32;
  LPSTR local_30;
  uint local_2c;
  void *local_28;
  int local_24;
  ushort local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined4 local_8;
  
                    // 0x5b4a0  405  FindNextVolumeMountPointA
  uStack12 = 0x6b85b4ac;
  local_24 = 0;
  local_30 = lpszVolumeMountPoint;
  local_32 = (short)cchBufferLength;
  local_34 = local_32 - 1;
  local_28 = (void *)0x0;
  local_2c = 0;
  local_8 = 0;
  uVar1 = local_32 * 2;
  local_20 = uVar1;
  puVar2 = (undefined4 *)KernelBaseGetGlobalData();
  local_28 = (void *)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),*puVar2,uVar1);
  if (local_28 == (void *)0x0) {
    RtlSetLastWin32Error(8);
  }
  else {
    local_2c = local_2c & 0xffff | (uint)local_20 << 0x10;
    iVar5 = FUN_6b85b5b4((undefined4 *)hFindVolumeMountPoint,local_28,cchBufferLength,0);
    local_24 = iVar5;
    if (iVar5 == 0) goto LAB_6b85b572;
    RtlInitUnicodeString(&local_2c,local_28);
    pcVar3 = (code *)GetUnicodeStringToEightBitStringRoutine(&local_34,&local_2c,0);
    _guard_check_icall();
    iVar4 = (*pcVar3)();
    if (-1 < iVar4) {
      if (local_34 < cchBufferLength) {
        local_30[local_34] = '\0';
        goto LAB_6b85b572;
      }
      iVar4 = -0x7ffffffb;
    }
    BaseSetLastNTError(iVar4);
  }
  iVar5 = 0;
  local_24 = 0;
LAB_6b85b572:
  local_8 = 0xfffffffe;
  FUN_6b85b597();
  *in_FS_OFFSET = local_14;
  return iVar5;
}



void FUN_6b85b597(void)

{
  undefined4 unaff_EBX;
  int unaff_EBP;
  int in_FS_OFFSET;
  
  if (*(int *)(unaff_EBP + -0x24) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EBX,
                *(undefined4 *)(unaff_EBP + -0x24));
  }
  return;
}



// WARNING: Could not reconcile some variable overlaps

void __fastcall FUN_6b85b5b4(undefined4 *param_1,void *param_2,int param_3,int param_4)

{
  short sVar1;
  short sVar2;
  void *pvVar3;
  int iVar4;
  undefined4 *puVar5;
  int *lpOutBuffer;
  BOOL BVar6;
  uint uVar7;
  uint *puVar8;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  int in_FS_OFFSET;
  undefined2 *puVar9;
  undefined4 uVar10;
  HANDLE local_74;
  int local_70;
  undefined4 *local_6c;
  undefined4 local_68;
  undefined4 local_64;
  void *local_60;
  undefined2 local_5c;
  undefined2 local_5a;
  undefined4 *local_58;
  undefined2 local_54;
  undefined2 local_52;
  undefined4 *local_50;
  undefined local_4c [8];
  undefined4 local_44;
  undefined4 local_40;
  undefined2 *local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  DWORD local_2c;
  undefined4 local_28;
  undefined4 uStack36;
  int local_20;
  undefined4 uStack28;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)&local_74;
  local_70 = 0;
  local_6c = param_1;
  local_60 = param_2;
  if ((((param_1 != (undefined4 *)0xffffffff) && (param_1 != (undefined4 *)0x0)) &&
      (param_2 != (void *)0x0)) && (param_3 != 0)) {
    local_64 = 0x62;
    do {
      if (param_4 == 0) {
        if (local_6c[4] == 0) {
          puVar9 = (undefined2 *)0x0;
          goto LAB_6b85b659;
        }
        local_28 = local_6c[2];
        uStack36 = local_6c[3];
        local_20 = local_6c[4];
        uStack28 = local_6c[5];
        local_6c[4] = 0;
      }
      else {
        local_58 = &local_18;
        param_4 = 0;
        puVar9 = &local_5c;
        local_14 = 0;
        local_10 = 0;
        local_18 = 0xa0000003;
        local_5a = 0xc;
        local_5c = 0xc;
LAB_6b85b659:
        iVar4 = NtQueryDirectoryFile(*local_6c,0,0,0,local_4c,&local_28,0x10,0x21,1,puVar9,0);
        if (iVar4 < 0) {
          if (iVar4 == -0x3ffffff1) {
            iVar4 = -0x7ffffffa;
          }
          goto LAB_6b85b91d;
        }
      }
      if (local_20 != -0x5ffffffd) {
        uVar10 = 0x12;
        goto LAB_6b85b9d9;
      }
      local_40 = *local_6c;
      local_3c = &local_54;
      local_50 = &local_28;
      local_44 = 0x18;
      local_38 = 0;
      local_34 = 0;
      local_30 = 0;
      local_68 = 0x11;
      local_54 = 8;
      local_52 = 8;
      iVar4 = RtlAcquirePrivilege(&local_68,1,0,&local_70);
      if (iVar4 < 0) {
        local_70 = 0;
      }
      iVar4 = NtOpenFile(&local_74,0x100000,&local_44,local_4c,7,0x206000);
      if (local_70 != 0) {
        RtlReleasePrivilege(local_70);
      }
      if (iVar4 < 0) goto LAB_6b85b91d;
      puVar5 = (undefined4 *)KernelBaseGetGlobalData();
      lpOutBuffer = (int *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                                           *puVar5,0x4000);
      if (lpOutBuffer == (int *)0x0) goto LAB_6b85b8bf;
      BVar6 = DeviceIoControl(local_74,0x900a8,(LPVOID)0x0,0,lpOutBuffer,0x4000,&local_2c,
                              (LPOVERLAPPED)0x0);
      if ((BVar6 == 0) || (*lpOutBuffer != -0x5ffffffd)) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpOutBuffer);
        CloseHandle(local_74);
        uVar10 = extraout_EDX_01;
        goto LAB_6b85b9e1;
      }
      sVar1 = *(short *)((int)lpOutBuffer + 10);
      uVar7 = (uint)*(ushort *)(lpOutBuffer + 2);
      if (((((((sVar1 == 0x60) ||
              ((sVar1 == (short)local_64 && (*(short *)(uVar7 + 0x70 + (int)lpOutBuffer) == 0x5c))))
             && (*(short *)(uVar7 + 0x10 + (int)lpOutBuffer) == 0x5c)) &&
            ((((sVar2 = *(short *)(uVar7 + 0x12 + (int)lpOutBuffer), sVar2 == 0x3f ||
               (sVar2 == 0x5c)) && (*(short *)(uVar7 + 0x14 + (int)lpOutBuffer) == 0x3f)) &&
             (((*(short *)(uVar7 + 0x16 + (int)lpOutBuffer) == 0x5c &&
               (*(short *)(uVar7 + 0x18 + (int)lpOutBuffer) == 0x56)) &&
              ((*(short *)(uVar7 + 0x1a + (int)lpOutBuffer) == 0x6f &&
               ((*(short *)(uVar7 + 0x1c + (int)lpOutBuffer) == 0x6c &&
                (*(short *)(uVar7 + 0x1e + (int)lpOutBuffer) == 0x75)))))))))) &&
           ((*(short *)(uVar7 + 0x20 + (int)lpOutBuffer) == 0x6d &&
            (((*(short *)(uVar7 + 0x22 + (int)lpOutBuffer) == 0x65 &&
              (*(short *)(uVar7 + 0x24 + (int)lpOutBuffer) == 0x7b)) &&
             (*(short *)(uVar7 + 0x36 + (int)lpOutBuffer) == 0x2d)))))) &&
          (((*(short *)(uVar7 + 0x40 + (int)lpOutBuffer) == 0x2d &&
            (*(short *)(uVar7 + 0x4a + (int)lpOutBuffer) == 0x2d)) &&
           ((*(short *)(uVar7 + 0x54 + (int)lpOutBuffer) == 0x2d &&
            ((*(short *)(uVar7 + 0x6e + (int)lpOutBuffer) == 0x7d && (sVar1 == 0x62)))))))) &&
         (*(short *)(uVar7 + 0x12 + (int)lpOutBuffer) == 0x3f)) goto LAB_6b85b889;
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpOutBuffer);
      CloseHandle(local_74);
    } while( true );
  }
  uVar10 = 0x57;
LAB_6b85b9d9:
  RtlSetLastWin32Error(uVar10);
  uVar10 = extraout_EDX_02;
LAB_6b85b9e1:
  FUN_6b8224af(local_c ^ (uint)&local_74,uVar10);
  return;
LAB_6b85b889:
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpOutBuffer);
  iVar4 = param_3 * 2 + 2;
  puVar5 = (undefined4 *)KernelBaseGetGlobalData();
  puVar8 = (uint *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar5,
                                   iVar4);
  if (puVar8 == (uint *)0x0) {
LAB_6b85b8bf:
    CloseHandle(local_74);
    uVar10 = 8;
  }
  else {
    iVar4 = NtQueryInformationFile(local_74,local_4c,puVar8,iVar4,9);
    pvVar3 = local_60;
    if (iVar4 < 0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar8);
      CloseHandle(local_74);
      if (iVar4 == -0x7ffffffb) {
        local_6c[2] = local_28;
        local_6c[3] = uStack36;
        local_6c[4] = local_20;
        local_6c[5] = uStack28;
      }
LAB_6b85b91d:
      BaseSetLastNTError(iVar4);
      uVar10 = extraout_EDX;
      goto LAB_6b85b9e1;
    }
    uVar7 = *puVar8 - 2;
    if (uVar7 <= *puVar8) {
      memcpy(local_60,(void *)((int)puVar8 + 6),uVar7);
      *(undefined2 *)((int)pvVar3 + ((*puVar8 & 0xfffffffe) - 2)) = 0x5c;
      *(undefined2 *)((int)pvVar3 + (*puVar8 & 0xfffffffe)) = 0;
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar8);
      CloseHandle(local_74);
      uVar10 = extraout_EDX_00;
      goto LAB_6b85b9e1;
    }
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar8);
    CloseHandle(local_74);
    uVar10 = 0x6f;
  }
  goto LAB_6b85b9d9;
}



BOOL FindNextVolumeMountPointW
               (HANDLE hFindVolumeMountPoint,LPWSTR lpszVolumeMountPoint,DWORD cchBufferLength)

{
  BOOL BVar1;
  
                    // 0x5ba00  406  FindNextVolumeMountPointW
  BVar1 = FUN_6b85b5b4((undefined4 *)hFindVolumeMountPoint,lpszVolumeMountPoint,cchBufferLength,0);
  return BVar1;
}



BOOL FindVolumeMountPointClose(HANDLE hFindVolumeMountPoint)

{
  BOOL BVar1;
  int in_FS_OFFSET;
  
                    // 0x5ba20  415  FindVolumeMountPointClose
  if ((hFindVolumeMountPoint == (HANDLE)0xffffffff) || (hFindVolumeMountPoint == (HANDLE)0x0)) {
    RtlSetLastWin32Error(0x57);
    BVar1 = 0;
  }
  else {
                    // WARNING: Load size is inaccurate
    BVar1 = CloseHandle(*hFindVolumeMountPoint);
    if (BVar1 != 0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,hFindVolumeMountPoint);
    }
  }
  return BVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL GetVolumeNameForVolumeMountPointA
               (LPCSTR lpszVolumeMountPoint,LPSTR lpszVolumeName,DWORD cchBufferLength)

{
  ushort uVar1;
  BOOL BVar2;
  undefined4 *puVar3;
  code *pcVar4;
  int iVar5;
  undefined4 *in_FS_OFFSET;
  undefined local_3c [4];
  LPCWSTR local_38;
  ushort local_34;
  short local_32;
  LPSTR local_30;
  uint local_2c;
  LPWSTR local_28;
  BOOL local_24;
  ushort local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x5ba70  805  GetVolumeNameForVolumeMountPointA
  local_8 = &DAT_6b892390;
  uStack12 = 0x6b85ba7c;
  local_24 = 0;
  BVar2 = Basep8BitStringToDynamicUnicodeString(local_3c,lpszVolumeMountPoint);
  if (BVar2 == 0) goto LAB_6b85bb65;
  local_30 = lpszVolumeName;
  local_32 = (short)cchBufferLength;
  local_34 = local_32 - 1;
  local_28 = (LPWSTR)0x0;
  local_2c = 0;
  local_8 = (undefined *)0x0;
  uVar1 = local_32 * 2;
  local_20 = uVar1;
  puVar3 = (undefined4 *)KernelBaseGetGlobalData();
  local_28 = (LPWSTR)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),*puVar3,uVar1);
  if (local_28 == (LPWSTR)0x0) {
    RtlSetLastWin32Error(8);
LAB_6b85baea:
    BVar2 = 0;
    local_24 = 0;
  }
  else {
    local_2c = local_2c & 0xffff | (uint)local_20 << 0x10;
    BVar2 = GetVolumeNameForVolumeMountPointW(local_38,local_28,cchBufferLength);
    local_24 = BVar2;
    if (BVar2 != 0) {
      RtlInitUnicodeString(&local_2c,local_28);
      pcVar4 = (code *)GetUnicodeStringToEightBitStringRoutine(&local_34,&local_2c,0);
      _guard_check_icall();
      iVar5 = (*pcVar4)();
      if (-1 < iVar5) {
        if (local_34 < cchBufferLength) {
          local_30[local_34] = '\0';
          goto LAB_6b85bb57;
        }
        iVar5 = -0x7ffffffb;
      }
      BaseSetLastNTError(iVar5);
      goto LAB_6b85baea;
    }
  }
LAB_6b85bb57:
  local_8 = (undefined *)0xfffffffe;
  FUN_6b85bb7c();
LAB_6b85bb65:
  *in_FS_OFFSET = local_14;
  return BVar2;
}



void FUN_6b85bb7c(void)

{
  undefined4 unaff_EBX;
  int unaff_EBP;
  int in_FS_OFFSET;
  
  if (*(int *)(unaff_EBP + -0x24) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EBX,
                *(undefined4 *)(unaff_EBP + -0x24));
  }
  RtlFreeUnicodeString(unaff_EBP + -0x38);
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL GetVolumePathNameA(LPCSTR lpszFileName,LPSTR lpszVolumePathName,DWORD cchBufferLength)

{
  ushort uVar1;
  BOOL BVar2;
  undefined4 *puVar3;
  code *pcVar4;
  int iVar5;
  undefined4 *in_FS_OFFSET;
  undefined local_3c [4];
  LPCWSTR local_38;
  ushort local_34;
  short local_32;
  LPSTR local_30;
  uint local_2c;
  LPWSTR local_28;
  BOOL local_24;
  ushort local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x5bbb0  807  GetVolumePathNameA
  local_8 = &DAT_6b892370;
  uStack12 = 0x6b85bbbc;
  local_24 = 0;
  BVar2 = Basep8BitStringToDynamicUnicodeString(local_3c,lpszFileName);
  if (BVar2 == 0) goto LAB_6b85bca5;
  local_30 = lpszVolumePathName;
  local_32 = (short)cchBufferLength;
  local_34 = local_32 - 1;
  local_28 = (LPWSTR)0x0;
  local_2c = 0;
  local_8 = (undefined *)0x0;
  uVar1 = local_32 * 2;
  local_20 = uVar1;
  puVar3 = (undefined4 *)KernelBaseGetGlobalData();
  local_28 = (LPWSTR)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),*puVar3,uVar1);
  if (local_28 == (LPWSTR)0x0) {
    RtlSetLastWin32Error(8);
LAB_6b85bc2a:
    BVar2 = 0;
    local_24 = 0;
  }
  else {
    local_2c = local_2c & 0xffff | (uint)local_20 << 0x10;
    BVar2 = GetVolumePathNameW(local_38,local_28,cchBufferLength);
    local_24 = BVar2;
    if (BVar2 != 0) {
      RtlInitUnicodeString(&local_2c,local_28);
      pcVar4 = (code *)GetUnicodeStringToEightBitStringRoutine(&local_34,&local_2c,0);
      _guard_check_icall();
      iVar5 = (*pcVar4)();
      if (-1 < iVar5) {
        if (local_34 < cchBufferLength) {
          local_30[local_34] = '\0';
          goto LAB_6b85bc97;
        }
        iVar5 = -0x7ffffffb;
      }
      BaseSetLastNTError(iVar5);
      goto LAB_6b85bc2a;
    }
  }
LAB_6b85bc97:
  local_8 = (undefined *)0xfffffffe;
  FUN_6b85bcbc();
LAB_6b85bca5:
  *in_FS_OFFSET = local_14;
  return BVar2;
}



void FUN_6b85bcbc(void)

{
  undefined4 unaff_EBX;
  int unaff_EBP;
  int in_FS_OFFSET;
  
  if (*(int *)(unaff_EBP + -0x24) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EBX,
                *(undefined4 *)(unaff_EBP + -0x24));
  }
  RtlFreeUnicodeString(unaff_EBP + -0x38);
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

BOOL GetVolumePathNamesForVolumeNameA
               (LPCSTR lpszVolumeName,LPCH lpszVolumePathNames,DWORD cchBufferLength,
               PDWORD lpcchReturnLength)

{
  BOOL BVar1;
  undefined4 *puVar2;
  DWORD DVar3;
  code *pcVar4;
  int iVar5;
  uint uVar6;
  short sVar7;
  undefined4 *in_FS_OFFSET;
  undefined local_3c [4];
  LPCWSTR local_38;
  ushort local_34;
  short local_32;
  LPCH local_30;
  short local_2c;
  short local_2a;
  LPWCH local_28;
  DWORD local_24;
  BOOL local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x5bcf0  809  GetVolumePathNamesForVolumeNameA
  local_8 = &DAT_6b892350;
  uStack12 = 0x6b85bcfc;
  local_20 = 0;
  BVar1 = Basep8BitStringToDynamicUnicodeString(local_3c,lpszVolumeName);
  if (BVar1 == 0) goto LAB_6b85be04;
  local_30 = lpszVolumePathNames;
  local_32 = (short)cchBufferLength;
  local_28 = (LPWCH)0x0;
  local_8 = (undefined *)0x0;
  sVar7 = local_32 * 2;
  local_2a = sVar7;
  if (sVar7 == 0) {
    local_28 = (LPWCH)0x0;
LAB_6b85bd77:
    BVar1 = GetVolumePathNamesForVolumeNameW(local_38,local_28,cchBufferLength,&local_24);
    local_20 = BVar1;
    if (BVar1 == 0) {
      DVar3 = GetLastError();
      if (DVar3 == 0xea) goto LAB_6b85bdaf;
    }
    else {
      sVar7 = (short)local_24 * 2;
LAB_6b85bdaf:
      local_2c = sVar7;
      pcVar4 = (code *)GetUnicodeStringToEightBitStringRoutine(&local_34,&local_2c,0);
      _guard_check_icall();
      iVar5 = (*pcVar4)();
      if ((iVar5 < 0) && (iVar5 != -0x7ffffffb)) {
        BaseSetLastNTError(iVar5);
        goto LAB_6b85bd68;
      }
      if (lpcchReturnLength != (PDWORD)0x0) {
        if (BVar1 == 0) {
          uVar6 = local_24 * 2;
        }
        else {
          uVar6 = (uint)local_34;
        }
        *lpcchReturnLength = uVar6;
      }
    }
  }
  else {
    puVar2 = (undefined4 *)KernelBaseGetGlobalData();
    local_28 = (LPWCH)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),*puVar2,local_2a);
    if (local_28 != (LPWCH)0x0) goto LAB_6b85bd77;
    RtlSetLastWin32Error(8);
LAB_6b85bd68:
    BVar1 = 0;
    local_20 = 0;
  }
  local_8 = (undefined *)0xfffffffe;
  FUN_6b85be19();
LAB_6b85be04:
  *in_FS_OFFSET = local_14;
  return BVar1;
}



void FUN_6b85be19(void)

{
  int unaff_EBP;
  int in_FS_OFFSET;
  
  if (*(int *)(unaff_EBP + -0x24) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,
                *(undefined4 *)(unaff_EBP + -0x24));
  }
  RtlFreeUnicodeString(unaff_EBP + -0x38);
  return;
}



void __fastcall FUN_6b85be41(undefined4 param_1,undefined *param_2)

{
  int iVar1;
  undefined4 *puVar2;
  HANDLE hDevice;
  BOOL BVar3;
  DWORD DVar4;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 uVar5;
  undefined4 *puVar6;
  int in_FS_OFFSET;
  bool bVar7;
  DWORD local_34;
  ushort local_30 [2];
  void *local_2c;
  undefined local_28 [4];
  int local_24;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  iVar1 = RtlInitUnicodeStringEx(local_30,param_1);
  if (iVar1 < 0) {
    BaseSetLastNTError(iVar1);
    uVar5 = extraout_EDX;
  }
  else {
    if (*(short *)((int)local_2c + (uint)(local_30[0] >> 1) * 2 + -2) == 0x5c) {
      local_30[0] = local_30[0] - 2;
    }
    puVar2 = (undefined4 *)KernelBaseGetGlobalData();
    puVar2 = (undefined4 *)
             RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar2,
                             local_30[0] + 0x18);
    if (puVar2 == (undefined4 *)0x0) {
      RtlSetLastWin32Error(8);
      uVar5 = extraout_EDX_00;
    }
    else {
      puVar6 = puVar2;
      for (iVar1 = 6; iVar1 != 0; iVar1 = iVar1 + -1) {
        *puVar6 = 0;
        puVar6 = puVar6 + 1;
      }
      puVar2[4] = 0x18;
      *(ushort *)(puVar2 + 5) = local_30[0];
      memcpy(puVar2 + 6,local_2c,(uint)local_30[0]);
      if ((3 < local_30[0]) && (*(short *)((int)local_2c + 2) == 0x5c)) {
        *(undefined2 *)(puVar2[4] + 2 + (int)puVar2) = 0x3f;
      }
      hDevice = CreateFileW(L"\\\\.\\MountPointManager",0,3,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,
                            (HANDLE)0xffffffff);
      if (hDevice != (HANDLE)0xffffffff) {
        BVar3 = DeviceIoControl(hDevice,0x6d0008,puVar2,local_30[0] + 0x18,local_28,0x20,&local_34,
                                (LPOVERLAPPED)0x0);
        if (BVar3 == 0) {
          DVar4 = GetLastError();
          bVar7 = DVar4 == 0xea;
        }
        else {
          bVar7 = local_24 != 0;
        }
        *param_2 = bVar7;
        CloseHandle(hDevice);
      }
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar2);
      uVar5 = extraout_EDX_01;
    }
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar5);
  return;
}



BOOL SetVolumeMountPointA(LPCSTR lpszVolumeMountPoint,LPCSTR lpszVolumeName)

{
  BOOL BVar1;
  int iVar2;
  undefined local_14 [4];
  LPCWSTR local_10;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x5bfb0  1401  SetVolumeMountPointA
  BVar1 = Basep8BitStringToDynamicUnicodeString(local_14,lpszVolumeMountPoint);
  if (BVar1 != 0) {
    iVar2 = Basep8BitStringToDynamicUnicodeString(local_c,lpszVolumeName);
    if (iVar2 == 0) {
      BVar1 = 0;
    }
    else {
      BVar1 = SetVolumeMountPointW(local_10,local_8);
      RtlFreeUnicodeString(local_c);
    }
    RtlFreeUnicodeString(local_14);
  }
  return BVar1;
}



// WARNING: Could not reconcile some variable overlaps

BOOL SetVolumeMountPointW(LPCWSTR lpszVolumeMountPoint,LPCWSTR lpszVolumeName)

{
  WCHAR WVar1;
  BOOL BVar2;
  DWORD DVar3;
  int iVar4;
  HANDLE pvVar5;
  uint uVar6;
  undefined4 *puVar7;
  short sVar8;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 extraout_EDX_04;
  undefined4 extraout_EDX_05;
  WCHAR *pWVar9;
  uint uVar10;
  int in_FS_OFFSET;
  undefined8 uVar11;
  undefined4 uVar12;
  DWORD local_440;
  undefined4 *local_43c;
  LPCWSTR local_438;
  HANDLE local_434;
  uint local_430;
  short *local_42c;
  uint local_428;
  LPCWSTR local_424;
  undefined4 *local_420;
  char local_419;
  WCHAR local_418 [260];
  WCHAR local_210;
  undefined local_20e [518];
  uint local_8;
  
                    // 0x5c010  1402  SetVolumeMountPointW
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_440 = 0;
  local_419 = '\0';
  local_430 = 0;
  local_42c = (short *)0x0;
  local_428 = 0;
  local_424 = (LPCWSTR)0x0;
  local_438 = lpszVolumeName;
  if ((lpszVolumeMountPoint == (LPCWSTR)0x0) || (lpszVolumeName == (LPCWSTR)0x0)) goto LAB_6b85c3fe;
  BVar2 = GetVolumeNameForVolumeMountPointW(lpszVolumeMountPoint,local_418,0x104);
  if ((BVar2 == 0) && (DVar3 = GetLastError(), DVar3 != 0xce)) {
    iVar4 = RtlInitUnicodeStringEx(&local_430,lpszVolumeMountPoint);
    if ((iVar4 < 0) || (iVar4 = RtlInitUnicodeStringEx(&local_428,lpszVolumeName), iVar4 < 0)) {
LAB_6b85c0a9:
      BaseSetLastNTError(iVar4);
      uVar12 = extraout_EDX;
      goto LAB_6b85c408;
    }
    if (((short)local_430 != 0) && (sVar8 = (short)local_428, sVar8 != 0)) {
      if ((*(short *)((int)local_42c + ((local_430 & 0xfffe) - 2)) != 0x5c) ||
         (*(short *)((int)local_424 + ((local_428 & 0xfffe) - 2)) != 0x5c)) {
        iVar4 = -0x3fffffcd;
        goto LAB_6b85c0a9;
      }
      if (((((sVar8 == 0x60) || ((sVar8 == 0x62 && (local_424[0x30] == L'\\')))) &&
           (*local_424 == L'\\')) &&
          (((((WVar1 = local_424[1], WVar1 == L'?' || (WVar1 == L'\\')) && (local_424[2] == L'?'))
            && ((local_424[3] == L'\\' && (local_424[4] == L'V')))) && (local_424[5] == L'o')))) &&
         (((((local_424[6] == L'l' && (local_424[7] == L'u')) &&
            ((local_424[8] == L'm' &&
             (((local_424[9] == L'e' && (local_424[10] == L'{')) && (local_424[0x13] == L'-'))))))
           && ((local_424[0x18] == L'-' && (local_424[0x1d] == L'-')))) &&
          ((local_424[0x22] == L'-' &&
           (((local_424[0x2f] == L'}' && (sVar8 == 0x62)) && (WVar1 == L'\\')))))))) {
        uVar11 = FUN_6b85be41(lpszVolumeName,&local_419);
        uVar12 = (undefined4)((ulonglong)uVar11 >> 0x20);
        if ((int)uVar11 == 0) goto LAB_6b85c408;
        if (local_419 != '\0') {
          if ((short)local_430 == 6) {
            if (local_42c[1] == 0x3a) {
LAB_6b85c251:
              FUN_6b85c52a(lpszVolumeMountPoint,lpszVolumeName);
              uVar12 = extraout_EDX_00;
              goto LAB_6b85c408;
            }
          }
          else if ((((((short)local_430 == 0xe) && (*local_42c == 0x5c)) && (local_42c[1] == 0x5c))
                   && ((local_42c[2] == 0x2e || (local_42c[2] == 0x3f)))) &&
                  ((local_42c[3] == 0x5c && (local_42c[5] == 0x3a)))) {
            lpszVolumeMountPoint = lpszVolumeMountPoint + 4;
            goto LAB_6b85c251;
          }
          pvVar5 = CreateFileW(L"\\\\.\\MountPointManager",0xc0000000,3,(LPSECURITY_ATTRIBUTES)0x0,3
                               ,0x80,(HANDLE)0xffffffff);
          uVar12 = extraout_EDX_01;
          if (pvVar5 == (HANDLE)0xffffffff) goto LAB_6b85c408;
          CloseHandle(pvVar5);
          pvVar5 = CreateFileW(lpszVolumeMountPoint,0xc0000000,3,(LPSECURITY_ATTRIBUTES)0x0,3,
                               0x2200080,(HANDLE)0xffffffff);
          uVar12 = extraout_EDX_02;
          local_434 = pvVar5;
          if (pvVar5 == (HANDLE)0xffffffff) goto LAB_6b85c408;
          BVar2 = GetVolumePathNameW(lpszVolumeMountPoint,local_418,0x104);
          if ((BVar2 == 1) &&
             (BVar2 = GetVolumeNameForVolumeMountPointW(local_418,&local_210,0x104), BVar2 == 1)) {
            pWVar9 = &local_210;
            do {
              WVar1 = *pWVar9;
              pWVar9 = pWVar9 + 1;
            } while (WVar1 != L'\0');
            iVar4 = (int)pWVar9 - (int)local_20e >> 1;
            local_43c = (undefined4 *)FUN_6b874011(&local_210,iVar4);
            uVar6 = FUN_6b873f44(&local_210,iVar4);
            uVar10 = local_428 >> 1 & 0x7fff;
            local_420 = (undefined4 *)FUN_6b874011(local_424,uVar10);
            uVar10 = FUN_6b873f44(local_424,uVar10);
            if ((uVar6 != 0) || ((uVar10 == 0 && (local_43c != local_420)))) {
              CloseHandle(local_434);
              goto LAB_6b85c3fe;
            }
            RtlSetLastWin32Error(0);
            pvVar5 = local_434;
            lpszVolumeName = local_438;
          }
          puVar7 = (undefined4 *)KernelBaseGetGlobalData();
          puVar7 = (undefined4 *)
                   RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar7,
                                   0x4000);
          local_420 = puVar7;
          if (puVar7 != (undefined4 *)0x0) {
            memset(puVar7 + 1,0,0x3ffc);
            *puVar7 = 0xa0000003;
            *(short *)(puVar7 + 1) = (short)local_428 * 2 + 0xc;
            *(undefined4 *)((int)puVar7 + 6) = 0;
            *(short *)((int)puVar7 + 10) = (short)local_428;
            memcpy(puVar7 + 4,local_424,local_428 & 0xffff);
            *(undefined2 *)((int)local_420 + 0x12) = 0x3f;
            *(ushort *)(local_420 + 3) = *(ushort *)((int)local_420 + 10) + 2;
            *(undefined2 *)((int)local_420 + 0xe) = (undefined2)local_428;
            memcpy((void *)((int)puVar7 + *(ushort *)((int)local_420 + 10) + 0x12),puVar7 + 4,
                   local_428 & 0xffff);
            pvVar5 = local_434;
            local_438 = (LPCWSTR)DeviceIoControl(local_434,0x900a4,local_420,
                                                 *(ushort *)(local_420 + 1) + 8,(LPVOID)0x0,0,
                                                 &local_440,(LPOVERLAPPED)0x0);
            RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_420);
            CloseHandle(pvVar5);
            uVar12 = extraout_EDX_04;
            if (local_438 != (LPCWSTR)0x0) {
              NotifyMountMgr(lpszVolumeMountPoint,lpszVolumeName,1);
              uVar12 = extraout_EDX_05;
            }
            goto LAB_6b85c408;
          }
          CloseHandle(pvVar5);
          uVar12 = 8;
          goto LAB_6b85c400;
        }
      }
    }
LAB_6b85c3fe:
    uVar12 = 0x57;
  }
  else {
    uVar12 = 0x91;
  }
LAB_6b85c400:
  RtlSetLastWin32Error(uVar12);
  uVar12 = extraout_EDX_03;
LAB_6b85c408:
  BVar2 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar12);
  return BVar2;
}



BOOL __fastcall FUN_6b85c52a(ushort *param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  BOOL BVar2;
  undefined2 *lpInBuffer;
  HANDLE hDevice;
  int iVar3;
  uint uVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  int in_FS_OFFSET;
  ushort local_1c [2];
  void *local_18;
  DWORD local_14;
  DWORD local_10;
  ushort *local_c;
  undefined4 *local_8;
  
  local_10 = param_2;
  local_c = param_1;
  puVar1 = (undefined4 *)KernelBaseGetGlobalData();
  puVar1 = (undefined4 *)
           RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar1,0x1e);
  local_8 = puVar1;
  if (puVar1 == (undefined4 *)0x0) {
    RtlSetLastWin32Error(8);
    BVar2 = 0;
  }
  else {
    puVar5 = (undefined4 *)L"\\DosDevices\\";
    puVar6 = puVar1;
    for (iVar3 = 6; iVar3 != 0; iVar3 = iVar3 + -1) {
      *puVar6 = *puVar5;
      puVar5 = puVar5 + 1;
      puVar6 = puVar6 + 1;
    }
    iVar3 = toupper((uint)*local_c);
    *(short *)(puVar1 + 6) = (short)iVar3;
    *(undefined2 *)((int)puVar1 + 0x1a) = 0x3a;
    *(undefined2 *)(puVar1 + 7) = 0;
    RtlInitUnicodeString(local_1c,local_10);
    local_1c[0] = local_1c[0] - 2;
    uVar4 = (uint)local_1c[0];
    local_10 = uVar4 + 0x24;
    puVar1 = (undefined4 *)KernelBaseGetGlobalData();
    lpInBuffer = (undefined2 *)
                 RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar1,
                                 uVar4 + 0x24);
    if (lpInBuffer == (undefined2 *)0x0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_8);
      RtlSetLastWin32Error(8);
      BVar2 = 0;
    }
    else {
      *lpInBuffer = 8;
      lpInBuffer[1] = 0x1c;
      lpInBuffer[2] = 0x24;
      lpInBuffer[3] = local_1c[0];
      puVar1 = local_8;
      puVar5 = (undefined4 *)(lpInBuffer + 4);
      for (iVar3 = 7; iVar3 != 0; iVar3 = iVar3 + -1) {
        *puVar5 = *puVar1;
        puVar1 = puVar1 + 1;
        puVar5 = puVar5 + 1;
      }
      memcpy((void *)((uint)(ushort)lpInBuffer[2] + (int)lpInBuffer),local_18,
             (uint)(ushort)lpInBuffer[3]);
      BVar2 = 0;
      *(undefined2 *)((ushort)lpInBuffer[2] + 2 + (int)lpInBuffer) = 0x3f;
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_8);
      hDevice = CreateFileW(L"\\\\.\\MountPointManager",0xc0000000,3,(LPSECURITY_ATTRIBUTES)0x0,3,
                            0x80,(HANDLE)0xffffffff);
      if (hDevice != (HANDLE)0xffffffff) {
        BVar2 = DeviceIoControl(hDevice,0x6dc000,lpInBuffer,local_10,(LPVOID)0x0,0,&local_14,
                                (LPOVERLAPPED)0x0);
        CloseHandle(hDevice);
      }
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpInBuffer);
    }
  }
  return BVar2;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 DosPathToSessionPathA(int param_1,void *param_2,char **param_3)

{
  char *pcVar1;
  char cVar2;
  BOOL BVar3;
  int iVar4;
  char *_Dst;
  undefined4 uVar5;
  char *pcVar6;
  undefined4 *in_FS_OFFSET;
  undefined local_38 [4];
  char *local_34;
  undefined4 local_30;
  short *local_2c;
  int local_28;
  wchar_t *local_20 [3];
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x5c6c0  301  DosPathToSessionPathA
  local_8 = &DAT_6b892450;
  uStack12 = 0x6b85c6cc;
  local_30 = 0;
  local_2c = (short *)0x0;
  if (param_2 == (void *)0x0) {
LAB_6b85c80f:
    uVar5 = 0x57;
LAB_6b85c811:
    RtlSetLastWin32Error(uVar5);
  }
  else {
    BVar3 = IsBadReadPtr(param_2,1);
    if (BVar3 != 0) goto LAB_6b85c80f;
    BVar3 = IsBadWritePtr(param_3,4);
    if (BVar3 != 0) goto LAB_6b85c80f;
    local_8 = (undefined *)0x0;
    RtlInitAnsiString(local_38,param_2);
    local_28 = RtlAnsiStringToUnicodeString(&local_30,local_38,1);
    local_8 = (undefined *)0xfffffffe;
    if (-1 < local_28) {
      iVar4 = DosPathToSessionPathW(param_1,local_2c,local_20);
      RtlFreeUnicodeString(&local_30);
      if (iVar4 == 0) goto LAB_6b85c817;
      RtlInitUnicodeString(&local_30,local_20[0]);
      iVar4 = RtlUnicodeStringToAnsiString(local_38,&local_30,1);
      if (iVar4 < 0) {
        BaseSetLastNTError(iVar4);
        LocalFree(local_20[0]);
        goto LAB_6b85c817;
      }
      pcVar1 = local_34 + 1;
      pcVar6 = local_34;
      do {
        cVar2 = *pcVar6;
        pcVar6 = pcVar6 + 1;
      } while (cVar2 != '\0');
      _Dst = (char *)LocalAlloc(0,(SIZE_T)(pcVar6 + (1 - (int)pcVar1)));
      if (_Dst != (char *)0x0) {
        strcpy_s(_Dst,(rsize_t)(pcVar6 + (1 - (int)pcVar1)),local_34);
        *param_3 = _Dst;
        LocalFree(local_20[0]);
        RtlFreeAnsiString(local_38);
        uVar5 = 1;
        goto LAB_6b85c819;
      }
      LocalFree(local_20[0]);
      RtlFreeAnsiString(local_38);
      uVar5 = 8;
      goto LAB_6b85c811;
    }
    BaseSetLastNTError(local_28);
  }
LAB_6b85c817:
  uVar5 = 0;
LAB_6b85c819:
  *in_FS_OFFSET = local_14;
  return uVar5;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 DosPathToSessionPathW(int param_1,short *param_2,wchar_t **param_3)

{
  size_t _SizeInWords;
  short sVar1;
  BOOL BVar2;
  wchar_t *_Dst;
  short *psVar3;
  int iVar4;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar5;
  undefined4 local_14;
  
                    // 0x5c830  302  DosPathToSessionPathW
  if (*(char *)(DAT_6b8b083c + 0x9cc) == '\x01') {
    iVar4 = 0xd;
  }
  else {
    iVar4 = (-(uint)(param_1 != 0) & 0x14) + 0x17;
  }
  if (param_2 == (short *)0x0) {
LAB_6b85c95a:
    uVar5 = 0x57;
  }
  else {
    BVar2 = IsBadReadPtr(param_2,2);
    if (BVar2 != 0) goto LAB_6b85c95a;
    BVar2 = IsBadWritePtr(param_3,4);
    if (BVar2 != 0) goto LAB_6b85c95a;
    psVar3 = param_2;
    do {
      sVar1 = *psVar3;
      psVar3 = psVar3 + 1;
    } while (sVar1 != 0);
    _SizeInWords = ((int)psVar3 - (int)(param_2 + 1) >> 1) + iVar4;
    _Dst = (wchar_t *)LocalAlloc(0,_SizeInWords * 2);
    if (_Dst != (wchar_t *)0x0) {
      if (*(char *)(DAT_6b8b083c + 0x9cc) == '\x01') {
        swprintf_s(_Dst,_SizeInWords,(wchar_t *)&_Format_6b88923c);
      }
      else if (param_1 == 0) {
        swprintf_s(_Dst,_SizeInWords,L"%ws\\DosDevices\\%ws",L"GLOBALROOT");
      }
      else {
        swprintf_s(_Dst,_SizeInWords,L"%ws%u\\DosDevices\\%ws",L"GLOBALROOT\\Sessions\\",param_1,
                   param_2);
      }
      *param_3 = _Dst;
      uVar5 = 1;
      goto LAB_6b85c964;
    }
    uVar5 = 8;
  }
  RtlSetLastWin32Error(uVar5);
  uVar5 = 0;
LAB_6b85c964:
  *in_FS_OFFSET = local_14;
  return uVar5;
}



BOOL FindActCtxSectionStringA
               (DWORD dwFlags,GUID *lpExtensionGuid,ULONG ulSectionId,LPCSTR lpStringToFind,
               PACTCTX_SECTION_KEYED_DATA ReturnedData)

{
  int iVar1;
  undefined *puVar2;
  undefined local_c [8];
  
                    // 0x5c980  374  FindActCtxSectionStringA
  puVar2 = (undefined *)0x0;
  if (lpStringToFind != (LPCSTR)0x0) {
    iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpStringToFind);
    if (iVar1 == 0) {
      return 0;
    }
    puVar2 = local_c;
  }
  iVar1 = FUN_6b816313(dwFlags,lpExtensionGuid,ulSectionId,puVar2,&ReturnedData->cbSize);
  if (puVar2 != (undefined *)0x0) {
    RtlFreeUnicodeString(puVar2);
  }
  return (uint)(iVar1 != 0);
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

HANDLE FindFirstFileTransactedW
                 (LPCWSTR lpFileName,FINDEX_INFO_LEVELS fInfoLevelId,LPVOID lpFindFileData,
                 FINDEX_SEARCH_OPS fSearchOp,LPVOID lpSearchFilter,DWORD dwAdditionalFlags,
                 HANDLE hTransaction)

{
  int iVar1;
  HANDLE pvVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar3;
  undefined4 local_14;
  
                    // 0x5c9e0  389  FindFirstFileTransactedW
  pvVar2 = (HANDLE)0xffffffff;
  if ((hTransaction == (HANDLE)0xffffffff) || (hTransaction == (HANDLE)0x0)) {
    uVar3 = 0x1a2c;
  }
  else {
    iVar1 = RtlGetCurrentTransaction();
    if (iVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      pvVar2 = FindFirstFileExW(lpFileName,fInfoLevelId,lpFindFileData,fSearchOp,lpSearchFilter,
                                dwAdditionalFlags);
      FUN_6b85ca4a();
      goto LAB_6b85ca5e;
    }
    uVar3 = 0x1a45;
  }
  RtlSetLastWin32Error(uVar3);
LAB_6b85ca5e:
  *in_FS_OFFSET = local_14;
  return pvVar2;
}



void FUN_6b85ca4a(void)

{
  RtlSetCurrentTransaction(0);
  return;
}



// WARNING: Could not reconcile some variable overlaps

DWORD GetDllDirectoryW(DWORD nBufferLength,LPWSTR lpBuffer)

{
  short sVar1;
  int iVar2;
  DWORD DVar3;
  uint local_c;
  LPWSTR local_8;
  
                    // 0x5ca80  563  GetDllDirectoryW
  RtlSetLastWin32Error(0);
  local_8 = lpBuffer;
  if (nBufferLength < 0x8000) {
    sVar1 = (short)nBufferLength * 2;
  }
  else {
    sVar1 = -2;
  }
  local_c = CONCAT22(sVar1,(undefined2)local_c);
  iVar2 = LdrGetDllDirectory(&local_c);
  if ((iVar2 < 0) && (iVar2 != -0x3fffffdd)) {
    BaseSetLastNTError(iVar2);
    DVar3 = 0;
  }
  else {
    DVar3 = local_c >> 1 & 0x7fff;
  }
  return DVar3;
}



WORD GetActiveProcessorGroupCount(void)

{
  WORD WVar1;
  int iVar2;
  int in_FS_OFFSET;
  DWORD local_c;
  PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX local_8;
  
                    // 0x5cae0  442  GetActiveProcessorGroupCount
  iVar2 = FUN_6b821afa(&local_8,&local_c);
  if (iVar2 == 0) {
    return 0;
  }
  WVar1 = *(WORD *)&(local_8->u).field_0x2;
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_8);
  return WVar1;
}



// WARNING: Could not reconcile some variable overlaps

DWORD GetMaximumProcessorCount(WORD GroupNumber)

{
  byte bVar1;
  DWORD DVar2;
  uint uVar3;
  byte *pbVar4;
  int in_FS_OFFSET;
  DWORD local_10;
  PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX local_c;
  uint local_8;
  
                    // 0x5cb20  630  GetMaximumProcessorCount
  DVar2 = FUN_6b821afa(&local_c,&local_10);
  if (DVar2 != 0) {
    if (GroupNumber == 0xffff) {
      uVar3 = (uint)*(ushort *)&(local_c->u).field_0x2;
      local_8 = 0;
      if (uVar3 != 0) {
        pbVar4 = &(local_c->u).field_0x18;
        do {
          bVar1 = *pbVar4;
          pbVar4 = pbVar4 + 0x2c;
          local_8 = (uint)(ushort)((short)local_8 + (ushort)bVar1);
          uVar3 = uVar3 - 1;
        } while (uVar3 != 0);
      }
    }
    else if (GroupNumber < *(ushort *)&(local_c->u).field_0x2) {
      local_8 = (uint)(byte)(&(local_c->u).field_0x18)[(uint)GroupNumber * 0x2c];
    }
    else {
      local_8 = 0;
      RtlSetLastWin32Error(0x57);
    }
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_c);
    DVar2 = local_8 & 0xffff;
  }
  return DVar2;
}



WORD GetMaximumProcessorGroupCount(void)

{
  WORD WVar1;
  int iVar2;
  int in_FS_OFFSET;
  DWORD local_c;
  PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX local_8;
  
                    // 0x5cbb0  631  GetMaximumProcessorGroupCount
  iVar2 = FUN_6b821afa(&local_8,&local_c);
  if (iVar2 == 0) {
    return 0;
  }
  WVar1 = *(WORD *)&local_8->u;
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_8);
  return WVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

DWORD LoadModule(LPCSTR lpModuleName,LPVOID lpParameterBlock)

{
  byte bVar1;
  code *pcVar2;
  size_t sVar3;
  undefined4 *puVar4;
  int iVar5;
  HANDLE pvVar6;
  DWORD DVar7;
  DWORD DVar8;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar9;
  _STARTUPINFOA local_9c;
  _PROCESS_INFORMATION local_58;
  undefined local_48 [8];
  undefined local_40 [4];
  undefined4 local_3c;
  int local_34;
  uint local_30;
  BOOL local_2c;
  DWORD local_28;
  LPSTR local_24;
  LPSTR local_20;
  undefined4 local_14 [2];
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x5cbf0  971  LoadModule
  local_8 = &DAT_6b892490;
  uStack12 = 0x6b85cbff;
  local_58.hProcess = (HANDLE)0x0;
  local_58.hThread = (HANDLE)0x0;
  local_58.dwProcessId = 0;
  local_58.dwThreadId = 0;
  local_2c = 0;
  if ((*(int *)((int)lpParameterBlock + 0xc) == 0) &&
     (DVar8 = 2, **(short **)((int)lpParameterBlock + 8) == 2)) {
    local_24 = (LPSTR)0x0;
    local_20 = (LPSTR)0x0;
    local_8 = (undefined *)0x1;
    puVar4 = (undefined4 *)KernelBaseGetGlobalData();
    local_20 = (LPSTR)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),*puVar4,0x104);
    if (local_20 == (LPSTR)0x0) {
LAB_6b85cc5b:
      RtlSetLastWin32Error(8);
    }
    else {
      local_28 = SearchPathA((LPCSTR)0x0,lpModuleName,(LPCSTR)&lpExtension_6b8892dc,0x104,local_20,
                             (LPSTR *)0x0);
      if ((local_28 == 0) || (0x103 < local_28)) {
        iVar5 = RtlInitAnsiStringEx(local_48,lpModuleName);
        if ((-1 < iVar5) && (iVar5 = RtlAnsiStringToUnicodeString(local_40,local_48,1), -1 < iVar5))
        {
          iVar5 = RtlDetermineDosPathNameType_U(local_3c);
          RtlFreeUnicodeString(local_40);
          if (iVar5 != 5) {
            pvVar6 = CreateFileA(lpModuleName,0x80000000,3,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,
                                 (HANDLE)0x0);
            if (pvVar6 == (HANDLE)0xffffffff) {
              DVar8 = GetLastError();
              __local_unwind4(&DAT_6b8b0140,(int)local_14,0xfffffffe);
              goto LAB_6b85ced8;
            }
            CloseHandle(pvVar6);
          }
        }
        __local_unwind4(&DAT_6b8b0140,(int)local_14,0xfffffffe);
        goto LAB_6b85ced8;
      }
      memset(&local_9c,0,0x44);
      local_9c.cb = 0x44;
      local_9c.dwFlags = 1;
      local_9c.wShowWindow = *(WORD *)(*(int *)((int)lpParameterBlock + 8) + 2);
      bVar1 = **(byte **)((int)lpParameterBlock + 4);
      local_30 = (uint)bVar1;
      puVar4 = (undefined4 *)KernelBaseGetGlobalData();
      local_34 = local_28 + bVar1;
      local_24 = (LPSTR)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),*puVar4,
                                        local_34 + 2);
      sVar3 = local_28;
      if (local_24 == (LPSTR)0x0) goto LAB_6b85cc5b;
      memcpy(local_24,local_20,local_28);
      local_24[sVar3] = ' ';
      memcpy(local_24 + sVar3 + 1,(void *)(*(int *)((int)lpParameterBlock + 4) + 1),local_30);
      local_24[local_34 + 1] = '\0';
                    // WARNING: Load size is inaccurate
      local_2c = CreateProcessA(local_20,local_24,(LPSECURITY_ATTRIBUTES)0x0,
                                (LPSECURITY_ATTRIBUTES)0x0,0,0,*lpParameterBlock,(LPCSTR)0x0,
                                &local_9c,&local_58);
    }
    local_8 = (undefined *)0x0;
    FUN_6b85ce49();
    pcVar2 = DAT_6b8b0864;
    local_8 = (undefined *)0xfffffffe;
    if (local_2c != 0) {
      if (DAT_6b8b0864 != (code *)0x0) {
        uVar9 = 30000;
        pvVar6 = local_58.hProcess;
        _guard_check_icall();
        (*pcVar2)(pvVar6,uVar9);
      }
      NtClose(local_58.hProcess);
      NtClose(local_58.hThread);
      DVar8 = 0x21;
      goto LAB_6b85ced8;
    }
    DVar7 = GetLastError();
    if (DVar7 == 2) goto LAB_6b85ced8;
    if (DVar7 == 3) {
      DVar8 = 3;
      goto LAB_6b85ced8;
    }
    if (DVar7 == 0xc1) {
      DVar8 = 0xb;
      goto LAB_6b85ced8;
    }
  }
  else {
    BaseSetLastNTError(0xc000000d);
  }
  DVar8 = 0;
LAB_6b85ced8:
  *in_FS_OFFSET = local_14[0];
  return DVar8;
}



void FUN_6b85ce49(void)

{
  undefined4 unaff_EBX;
  int unaff_EBP;
  int in_FS_OFFSET;
  
  if (*(int *)(unaff_EBP + -0x1c) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EBX,
                *(int *)(unaff_EBP + -0x1c));
  }
  if (*(int *)(unaff_EBP + -0x20) != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_EBX,
                *(int *)(unaff_EBP + -0x20));
  }
  return;
}



BOOL SetProcessAffinityMask(HANDLE hProcess,DWORD_PTR dwProcessAffinityMask)

{
  int iVar1;
  
                    // 0x5cef0  1345  SetProcessAffinityMask
  iVar1 = NtSetInformationProcess(hProcess,0x15,&dwProcessAffinityMask,4);
  if (-1 >= iVar1) {
    BaseSetLastNTError(iVar1);
  }
  return (uint)(-1 < iVar1);
}



UINT WinExec(LPCSTR lpCmdLine,UINT uCmdShow)

{
  code *pcVar1;
  BOOL BVar2;
  UINT UVar3;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  DWORD dwCreationFlags;
  HANDLE pvVar4;
  undefined4 uVar5;
  ULONG_PTR local_94;
  undefined4 local_90;
  LPCSTR local_8c;
  _PROCESS_INFORMATION local_88;
  _STARTUPINFOA local_78;
  _PROC_THREAD_ATTRIBUTE_LIST *local_34;
  _PROC_THREAD_ATTRIBUTE_LIST local_2c [32];
  uint local_c;
  
                    // 0x5cf20  1541  WinExec
  local_c = DAT_6b8b0140 ^ (uint)&local_94;
  local_8c = lpCmdLine;
  if ((int)uCmdShow < 0) {
    local_94 = 0x20;
    BVar2 = InitializeProcThreadAttributeList(local_2c,1,0,&local_94);
    uVar5 = extraout_EDX;
    if (BVar2 == 0) goto LAB_6b85d06a;
    local_90 = 1;
    dwCreationFlags = 0x80000;
    BVar2 = UpdateProcThreadAttribute(local_2c,0,0x60001,&local_90,4,(PVOID)0x0,(PSIZE_T)0x0);
    if (BVar2 != 0) {
      local_34 = local_2c;
      goto LAB_6b85cfb3;
    }
  }
  else {
    dwCreationFlags = 0;
LAB_6b85cfb3:
    memset(&local_78,0,0x44);
    local_78.dwFlags = 1;
    local_78.wShowWindow = (WORD)uCmdShow;
    local_78.cb = (uint)(dwCreationFlags != 0) * 4 + 0x44;
    BVar2 = CreateProcessA((LPCSTR)0x0,local_8c,(LPSECURITY_ATTRIBUTES)0x0,
                           (LPSECURITY_ATTRIBUTES)0x0,0,dwCreationFlags,(LPVOID)0x0,(LPCSTR)0x0,
                           &local_78,&local_88);
    pcVar1 = DAT_6b8b0864;
    if (BVar2 == 0) {
      GetLastError();
      uVar5 = extraout_EDX_01;
    }
    else {
      if (DAT_6b8b0864 != (code *)0x0) {
        uVar5 = 30000;
        pvVar4 = local_88.hProcess;
        _guard_check_icall();
        (*pcVar1)(pvVar4,uVar5);
      }
      NtClose(local_88.hProcess);
      NtClose(local_88.hThread);
      uVar5 = extraout_EDX_00;
    }
    if (dwCreationFlags == 0) goto LAB_6b85d06a;
  }
  DeleteProcThreadAttributeList(local_2c);
  uVar5 = extraout_EDX_02;
LAB_6b85d06a:
  UVar3 = FUN_6b8224af(local_c ^ (uint)&local_94,uVar5);
  return UVar3;
}



BOOL GetDevicePowerState(HANDLE hDevice,BOOL *pfOn)

{
  int iVar1;
  BOOL BVar2;
  BOOL BVar3;
  int local_8;
  
                    // 0x5d090  555  GetDevicePowerState
  local_8 = 0;
  iVar1 = NtGetDevicePowerState(hDevice,&local_8);
  if (iVar1 < 0) {
    BaseSetLastNTError(iVar1);
    BVar2 = 0;
  }
  else {
    BVar2 = 1;
    if ((local_8 == 1) || (BVar3 = 0, local_8 == 0)) {
      BVar3 = BVar2;
    }
    *pfOn = BVar3;
  }
  return BVar2;
}



BOOL PowerClearRequest(HANDLE PowerRequest,POWER_REQUEST_TYPE RequestType)

{
  int iVar1;
  HANDLE local_14;
  undefined4 local_10;
  undefined local_c;
  undefined4 local_8;
  
                    // 0x5d0e0  1064  PowerClearRequest
  if (RequestType == PowerRequestDisplayRequired) {
    local_10 = 0;
  }
  else if (RequestType == PowerRequestSystemRequired) {
    local_10 = 1;
  }
  else if (RequestType == PowerRequestAwayModeRequired) {
    local_10 = 2;
  }
  else {
    if (RequestType != (PowerRequestSystemRequired|PowerRequestAwayModeRequired)) {
      BaseSetLastNTError(0xc00000bb);
      return 0;
    }
    local_10 = 3;
  }
  local_14 = PowerRequest;
  local_c = 0;
  local_8 = 0;
  iVar1 = NtPowerInformation(0x2c,&local_14,0x10,0,0);
  if (-1 >= iVar1) {
    BaseSetLastNTError(iVar1);
  }
  return (uint)(-1 < iVar1);
}



HANDLE PowerCreateRequest(PREASON_CONTEXT Context)

{
  int iVar1;
  HANDLE hHeap;
  DWORD dwFlags;
  int *lpMem;
  HANDLE local_c;
  int *local_8;
  
                    // 0x5d160  1065  PowerCreateRequest
  local_8 = (int *)0x0;
  local_c = (HANDLE)0xffffffff;
  iVar1 = FUN_6b85188d((int **)Context,&local_8);
  if (-1 < iVar1) {
    iVar1 = NtPowerInformation(0x2b,local_8,0x1c,&local_c,4);
    if (-1 < iVar1) goto LAB_6b85d19b;
  }
  BaseSetLastNTError(iVar1);
LAB_6b85d19b:
  if (local_8 != (int *)0x0) {
    dwFlags = 0;
    lpMem = local_8;
    hHeap = GetProcessHeap();
    HeapFree(hHeap,dwFlags,lpMem);
  }
  return local_c;
}



BOOL PowerSetRequest(HANDLE PowerRequest,POWER_REQUEST_TYPE RequestType)

{
  int iVar1;
  HANDLE local_14;
  undefined4 local_10;
  undefined local_c;
  undefined4 local_8;
  
                    // 0x5d1c0  1066  PowerSetRequest
  if (RequestType == PowerRequestDisplayRequired) {
    local_10 = 0;
  }
  else if (RequestType == PowerRequestSystemRequired) {
    local_10 = 1;
  }
  else if (RequestType == PowerRequestAwayModeRequired) {
    local_10 = 2;
  }
  else {
    if (RequestType != (PowerRequestSystemRequired|PowerRequestAwayModeRequired)) {
      BaseSetLastNTError(0xc00000bb);
      return 0;
    }
    local_10 = 3;
  }
  local_14 = PowerRequest;
  local_c = 1;
  local_8 = 0;
  iVar1 = NtPowerInformation(0x2c,&local_14,0x10,0,0);
  if (-1 >= iVar1) {
    BaseSetLastNTError(iVar1);
  }
  return (uint)(-1 < iVar1);
}



DWORD GetFirmwareEnvironmentVariableA(LPCSTR lpName,LPCSTR lpGuid,PVOID pBuffer,DWORD nSize)

{
  DWORD DVar1;
  
                    // 0x5d240  599  GetFirmwareEnvironmentVariableA
  DVar1 = GetFirmwareEnvironmentVariableExA((int)lpName,(int)lpGuid,pBuffer,nSize,0);
  return DVar1;
}



undefined4
GetFirmwareEnvironmentVariableExA
          (int param_1,int param_2,undefined4 param_3,undefined4 param_4,undefined4 param_5)

{
  int iVar1;
  undefined4 uVar2;
  undefined local_24 [8];
  undefined local_1c [8];
  undefined local_14 [4];
  int local_10;
  undefined local_c [4];
  int local_8;
  
                    // 0x5d270  600  GetFirmwareEnvironmentVariableExA
  if ((param_1 == 0) || (param_2 == 0)) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    RtlInitString(local_1c,param_1);
    iVar1 = RtlAnsiStringToUnicodeString(local_c,local_1c,1);
    if (-1 < iVar1) {
      RtlInitString(local_24,param_2);
      iVar1 = RtlAnsiStringToUnicodeString(local_14,local_24,1);
      if (-1 < iVar1) {
        uVar2 = GetFirmwareEnvironmentVariableExW(local_8,local_10,param_3,param_4,param_5);
        RtlFreeUnicodeString(local_c);
        RtlFreeUnicodeString(local_14);
        return uVar2;
      }
      RtlFreeUnicodeString(local_c);
    }
    BaseSetLastNTError(iVar1);
  }
  return 0;
}



void GetFirmwareEnvironmentVariableExW
               (int param_1,int param_2,undefined4 param_3,undefined4 param_4,undefined4 param_5)

{
  int iVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar2;
  undefined8 uVar3;
  undefined local_2c [8];
  undefined local_24 [8];
  undefined4 local_1c;
  undefined local_18 [16];
  uint local_8;
  
                    // 0x5d330  601  GetFirmwareEnvironmentVariableExW
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  if ((param_1 == 0) || (param_2 == 0)) {
    RtlSetLastWin32Error(0x57);
    uVar2 = extraout_EDX_00;
  }
  else {
    RtlInitUnicodeString(local_2c,param_1);
    RtlInitUnicodeString(local_24,param_2);
    iVar1 = RtlGUIDFromString(local_24,local_18);
    if (-1 < iVar1) {
      local_1c = param_4;
      uVar3 = NtQuerySystemEnvironmentValueEx(local_2c,local_18,param_3,&local_1c,param_5);
      uVar2 = (undefined4)((ulonglong)uVar3 >> 0x20);
      iVar1 = (int)uVar3;
      if (-1 < iVar1) goto LAB_6b85d3b6;
    }
    BaseSetLastNTError(iVar1);
    uVar2 = extraout_EDX;
  }
LAB_6b85d3b6:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



DWORD GetFirmwareEnvironmentVariableW(LPCWSTR lpName,LPCWSTR lpGuid,PVOID pBuffer,DWORD nSize)

{
  DWORD DVar1;
  
                    // 0x5d3d0  602  GetFirmwareEnvironmentVariableW
  DVar1 = GetFirmwareEnvironmentVariableExW((int)lpName,(int)lpGuid,pBuffer,nSize,0);
  return DVar1;
}



BOOL SetFirmwareEnvironmentVariableA(LPCSTR lpName,LPCSTR lpGuid,PVOID pValue,DWORD nSize)

{
  BOOL BVar1;
  
                    // 0x5d400  1324  SetFirmwareEnvironmentVariableA
  BVar1 = SetFirmwareEnvironmentVariableExA((int)lpName,(int)lpGuid,pValue,nSize,1);
  return BVar1;
}



undefined4
SetFirmwareEnvironmentVariableExA
          (int param_1,int param_2,undefined4 param_3,undefined4 param_4,undefined4 param_5)

{
  int iVar1;
  undefined4 uVar2;
  undefined local_24 [8];
  undefined local_1c [8];
  undefined local_14 [4];
  int local_10;
  undefined local_c [4];
  int local_8;
  
                    // 0x5d430  1325  SetFirmwareEnvironmentVariableExA
  if ((param_1 == 0) || (param_2 == 0)) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    RtlInitString(local_1c,param_1);
    iVar1 = RtlAnsiStringToUnicodeString(local_c,local_1c,1);
    if (-1 < iVar1) {
      RtlInitString(local_24,param_2);
      iVar1 = RtlAnsiStringToUnicodeString(local_14,local_24,1);
      if (-1 < iVar1) {
        uVar2 = SetFirmwareEnvironmentVariableExW(local_8,local_10,param_3,param_4,param_5);
        RtlFreeUnicodeString(local_c);
        RtlFreeUnicodeString(local_14);
        return uVar2;
      }
      RtlFreeUnicodeString(local_c);
    }
    BaseSetLastNTError(iVar1);
  }
  return 0;
}



void SetFirmwareEnvironmentVariableExW
               (int param_1,int param_2,undefined4 param_3,undefined4 param_4,undefined4 param_5)

{
  int iVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar2;
  undefined8 uVar3;
  undefined local_28 [8];
  undefined local_20 [8];
  undefined local_18 [16];
  uint local_8;
  
                    // 0x5d4f0  1326  SetFirmwareEnvironmentVariableExW
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  if ((param_1 == 0) || (param_2 == 0)) {
    RtlSetLastWin32Error(0x57);
    uVar2 = extraout_EDX_00;
  }
  else {
    RtlInitUnicodeString(local_28,param_1);
    RtlInitUnicodeString(local_20,param_2);
    iVar1 = RtlGUIDFromString(local_20,local_18);
    if (-1 < iVar1) {
      uVar3 = NtSetSystemEnvironmentValueEx(local_28,local_18,param_3,param_4,param_5);
      uVar2 = (undefined4)((ulonglong)uVar3 >> 0x20);
      iVar1 = (int)uVar3;
      if (-1 < iVar1) goto LAB_6b85d56d;
    }
    BaseSetLastNTError(iVar1);
    uVar2 = extraout_EDX;
  }
LAB_6b85d56d:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



BOOL SetFirmwareEnvironmentVariableW(LPCWSTR lpName,LPCWSTR lpGuid,PVOID pValue,DWORD nSize)

{
  BOOL BVar1;
  
                    // 0x5d590  1327  SetFirmwareEnvironmentVariableW
  BVar1 = SetFirmwareEnvironmentVariableExW((int)lpName,(int)lpGuid,pValue,nSize,1);
  return BVar1;
}



void GetFirmwareType(undefined4 *param_1)

{
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar1;
  undefined8 uVar2;
  undefined local_28 [16];
  undefined4 local_18;
  uint local_8;
  
                    // 0x5d5c0  603  GetFirmwareType
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  if (param_1 == (undefined4 *)0x0) {
    RtlSetLastWin32Error(0x57);
    uVar1 = extraout_EDX;
  }
  else {
    uVar2 = NtQuerySystemInformation(0x5a,local_28,0x20,0);
    uVar1 = (undefined4)((ulonglong)uVar2 >> 0x20);
    if ((int)uVar2 < 0) {
      BaseSetLastNTError((int)uVar2);
      uVar1 = extraout_EDX_00;
    }
    else {
      *param_1 = local_18;
    }
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar1);
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

DWORD GetFullPathNameTransactedW
                (LPCWSTR lpFileName,DWORD nBufferLength,LPWSTR lpBuffer,LPWSTR *lpFilePart,
                HANDLE hTransaction)

{
  int iVar1;
  DWORD DVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar3;
  undefined4 local_14;
  
                    // 0x5d620  606  GetFullPathNameTransactedW
  if ((hTransaction == (HANDLE)0xffffffff) || (hTransaction == (HANDLE)0x0)) {
    uVar3 = 0x1a2c;
  }
  else {
    iVar1 = RtlGetCurrentTransaction();
    if (iVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      DVar2 = GetFullPathNameW(lpFileName,nBufferLength,lpBuffer,lpFilePart);
      FUN_6b85d680();
      goto LAB_6b85d696;
    }
    uVar3 = 0x1a45;
  }
  RtlSetLastWin32Error(uVar3);
  DVar2 = 0;
LAB_6b85d696:
  *in_FS_OFFSET = local_14;
  return DVar2;
}



void FUN_6b85d680(void)

{
  RtlSetCurrentTransaction(0);
  return;
}



DWORD GetLogicalDriveStringsA(DWORD nBufferLength,LPSTR lpBuffer)

{
  uint uVar1;
  int iVar2;
  DWORD DVar3;
  undefined local_18 [2];
  ushort local_16;
  char *local_14;
  DWORD local_10;
  undefined4 local_c;
  int local_8;
  
                    // 0x5d6b0  620  GetLogicalDriveStringsA
  local_c = 0x5c3a41;
  DVar3 = 0;
  local_8 = 0;
  RtlInitAnsiString(local_18,&local_c);
  uVar1 = GetLogicalDrives();
  iVar2 = 0;
  local_10 = uVar1;
  do {
    *local_14 = (byte)iVar2 + 0x41;
    if ((uVar1 & 1 << ((byte)iVar2 & 0x1f)) != 0) {
      DVar3 = DVar3 + local_16;
      if (DVar3 < (nBufferLength & 0xffff)) {
        memcpy(lpBuffer,local_14,(uint)local_16);
        lpBuffer = lpBuffer + local_16;
        *lpBuffer = '\0';
        uVar1 = local_10;
      }
      else {
        local_8 = 1;
      }
    }
    iVar2 = iVar2 + 1;
  } while (iVar2 < 0x1a);
  if (local_8 != 0) {
    DVar3 = DVar3 + 1;
  }
  return DVar3;
}



BOOL SetVolumeLabelA(LPCSTR lpRootPathName,LPCSTR lpVolumeName)

{
  int iVar1;
  BOOL BVar2;
  undefined local_14 [4];
  LPCWSTR local_10;
  undefined local_c [4];
  LPCWSTR local_8;
  
                    // 0x5d750  1399  SetVolumeLabelA
  if (lpRootPathName == (LPCSTR)0x0) {
    lpRootPathName = "\\";
  }
  iVar1 = Basep8BitStringToDynamicUnicodeString(local_14,lpRootPathName);
  if (iVar1 == 0) {
    return 0;
  }
  if (lpVolumeName == (LPCSTR)0x0) {
    local_8 = (LPCWSTR)0x0;
  }
  else {
    iVar1 = Basep8BitStringToDynamicUnicodeString(local_c,lpVolumeName);
    if (iVar1 == 0) {
      BVar2 = 0;
      goto LAB_6b85d7b0;
    }
  }
  BVar2 = SetVolumeLabelW(local_10,local_8);
  if (lpVolumeName != (LPCSTR)0x0) {
    RtlFreeUnicodeString(local_c);
  }
LAB_6b85d7b0:
  RtlFreeUnicodeString(local_14);
  return BVar2;
}



// WARNING: Function: __SEH_prolog4_GS replaced with injection: SEH_prolog4
// WARNING: Could not reconcile some variable overlaps

BOOL SetVolumeLabelW(LPCWSTR lpRootPathName,LPCWSTR lpVolumeName)

{
  char cVar1;
  BOOL BVar2;
  int iVar3;
  undefined4 *puVar4;
  uint *puVar5;
  undefined4 *in_FS_OFFSET;
  undefined8 uVar6;
  undefined4 uVar7;
  undefined local_270 [8];
  undefined4 local_268;
  undefined4 local_264;
  ushort *local_260;
  undefined4 local_25c;
  undefined4 local_258;
  undefined4 local_254;
  uint *local_250;
  int local_24c;
  WCHAR local_248;
  undefined2 local_246;
  ushort local_244 [2];
  int local_240;
  uint local_23c;
  void *local_238;
  BOOL local_234;
  int local_230;
  int local_22c;
  WCHAR local_228 [266];
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x5d7d0  1400  SetVolumeLabelW
  local_8 = &DAT_6b8924d8;
  uStack12 = 0x6b85d7df;
  local_234 = 0;
  local_248 = L'\\';
  local_246 = 0;
  if (lpVolumeName == (LPCWSTR)0x0) {
    local_23c = 0;
    local_238 = (void *)0x0;
  }
  else {
    RtlInitUnicodeString(&local_23c,lpVolumeName);
  }
  if (lpRootPathName == (LPCWSTR)0x0) {
LAB_6b85d849:
    lpRootPathName = &local_248;
  }
  else {
    BVar2 = GetVolumeNameForVolumeMountPointW(lpRootPathName,local_228,0x104);
    if (BVar2 == 0) {
      if (lpRootPathName == (LPCWSTR)0x0) goto LAB_6b85d849;
    }
    else {
      lpRootPathName = local_228;
    }
  }
  cVar1 = RtlDosPathNameToNtPathName_U(lpRootPathName,local_244,0,0);
  if (cVar1 == '\0') {
    uVar7 = 3;
LAB_6b85d865:
    RtlSetLastWin32Error(uVar7);
  }
  else {
    if (*(short *)(local_240 + -2 + (uint)(local_244[0] >> 1) * 2) == 0x5c) {
      local_268 = 0x18;
      local_264 = 0;
      local_25c = 0x40;
      local_260 = local_244;
      local_258 = 0;
      local_254 = 0;
      uVar6 = NtOpenFile(&local_22c,0x100002,&local_268,local_270,3,0x20);
      local_230 = (int)uVar6;
      if (-1 < local_230) {
        iVar3 = FUN_6b851faf(local_22c,(int)((ulonglong)uVar6 >> 0x20));
        if (iVar3 == 0) {
          RtlFreeHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),0,local_240);
          NtClose(local_22c);
          uVar7 = 0x90;
          goto LAB_6b85d865;
        }
        NtClose(local_22c);
        local_244[0] = local_244[0] - 2;
        local_268 = 0x18;
        local_264 = 0;
        local_25c = 0x40;
        local_260 = local_244;
        local_258 = 0;
        local_254 = 0;
        local_230 = NtOpenFile(&local_22c,0x100002,&local_268,local_270,3,0x20);
        RtlFreeHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),0,local_240);
        iVar3 = local_230;
        if (local_230 < 0) goto LAB_6b85d89e;
        local_250 = (uint *)0x0;
        local_8 = (undefined *)0x0;
        local_234 = 1;
        if ((short)local_23c == 0) {
          iVar3 = 8;
        }
        else {
          iVar3 = (local_23c & 0xffff) + 6;
        }
        local_24c = iVar3;
        puVar4 = (undefined4 *)KernelBaseGetGlobalData();
        puVar5 = (uint *)RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),*puVar4,iVar3);
        local_250 = puVar5;
        if (puVar5 == (uint *)0x0) {
          iVar3 = -0x3fffffe9;
LAB_6b85da7f:
          local_234 = 0;
          BaseSetLastNTError(iVar3);
        }
        else {
          memcpy(puVar5 + 1,local_238,local_23c & 0xffff);
          *puVar5 = local_23c & 0xffff;
          iVar3 = NtSetVolumeInformationFile(local_22c,local_270,puVar5,local_24c,2);
          if (iVar3 < 0) goto LAB_6b85da7f;
        }
        local_8 = (undefined *)0xfffffffe;
        FUN_6b85dab6();
        goto LAB_6b85da9c;
      }
      RtlFreeHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),0,local_240);
      iVar3 = local_230;
    }
    else {
      RtlFreeHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),0,local_240);
      iVar3 = -0x3fffffcd;
    }
LAB_6b85d89e:
    BaseSetLastNTError(iVar3);
  }
  local_234 = 0;
LAB_6b85da9c:
  *in_FS_OFFSET = local_14;
  return local_234;
}



void FUN_6b85dab6(void)

{
  int unaff_EBP;
  undefined4 unaff_ESI;
  int unaff_EDI;
  int in_FS_OFFSET;
  
  NtClose(*(undefined4 *)(unaff_EBP + -0x228));
  if (unaff_EDI != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),unaff_ESI,unaff_EDI);
  }
  return;
}



BOOL GetNumaAvailableMemoryNodeEx(USHORT Node,PULONGLONG AvailableBytes)

{
  int iVar1;
  uint uVar2;
  undefined local_414 [4];
  uint local_410 [2];
  undefined4 auStack1032 [257];
  
                    // 0x5dae0  654  GetNumaAvailableMemoryNodeEx
  iVar1 = NtQuerySystemInformation(0x3c,local_410,0x408,local_414);
  if (iVar1 < 0) {
    BaseSetLastNTError(iVar1);
  }
  else {
    uVar2 = (uint)Node;
    if (uVar2 <= local_410[0]) {
      *(undefined4 *)AvailableBytes = auStack1032[uVar2 * 2];
      *(undefined4 *)((int)AvailableBytes + 4) = auStack1032[uVar2 * 2 + 1];
      return 1;
    }
    RtlSetLastWin32Error(0x57);
  }
  return 0;
}



BOOL GetNumaNodeProcessorMask(UCHAR Node,PULONGLONG ProcessorMask)

{
  BOOL BVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar2;
  WORD local_18 [2];
  _GROUP_AFFINITY local_14;
  uint local_8;
  
                    // 0x5db50  657  GetNumaNodeProcessorMask
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  BVar1 = GetNumaNodeProcessorMaskEx((ushort)Node,&local_14);
  uVar2 = extraout_EDX;
  if (BVar1 != 0) {
    RtlGetCurrentProcessorNumberEx(local_18);
    if (local_14.Group != local_18[0]) {
      local_14.Mask = 0;
    }
    *(KAFFINITY *)ProcessorMask = local_14.Mask;
    *(undefined4 *)((int)ProcessorMask + 4) = 0;
    uVar2 = extraout_EDX_00;
  }
  BVar1 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return BVar1;
}



BOOL GetNumaProcessorNodeEx(PPROCESSOR_NUMBER Processor,PUSHORT NodeNumber)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  ushort uVar4;
  undefined local_414 [4];
  uint local_410 [2];
  uint uStack1032;
  WORD aWStack1028 [512];
  
                    // 0x5dbc0  660  GetNumaProcessorNodeEx
  if (((Processor->Group < 0x14) && (Processor->Number < 0x20)) && (Processor->Reserved == '\0')) {
    iVar1 = NtQuerySystemInformation(0x37,local_410,0x408,local_414);
    if (iVar1 < 0) {
      *NodeNumber = 0xffff;
      BaseSetLastNTError(iVar1);
      return 0;
    }
    uVar2 = _allshl();
    uVar4 = 0;
    uVar3 = 0;
    do {
      if ((aWStack1028[uVar3 * 6] == Processor->Group) && (((&uStack1032)[uVar3 * 3] & uVar2) != 0))
      {
        *NodeNumber = uVar4;
        return 1;
      }
      uVar4 = uVar4 + 1;
      uVar3 = (uint)uVar4;
    } while (uVar3 <= local_410[0]);
  }
  *NodeNumber = 0xffff;
  RtlSetLastWin32Error(0x57);
  return 0;
}



DWORD __fastcall
FUN_6b85dc76(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,undefined4 param_5
            ,undefined4 param_6)

{
  HANDLE hHandle;
  DWORD DVar1;
  int iVar2;
  int local_c;
  int iStack8;
  
  local_c = param_1;
  iStack8 = param_1;
  hHandle = CreateEventA((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCSTR)0x0);
  if (hHandle == (HANDLE)0x0) {
    DVar1 = GetLastError();
  }
  else {
    iVar2 = NtDeviceIoControlFile
                      (param_1,hHandle,0,0,&local_c,param_2,param_3,param_4,param_5,param_6);
    if (iVar2 == 0x103) {
      WaitForSingleObject(hHandle,0xffffffff);
      iVar2 = local_c;
    }
    CloseHandle(hHandle);
    if (iVar2 < 0) {
      DVar1 = BaseSetLastNTError(iVar2);
    }
    else {
      DVar1 = 0;
    }
  }
  return DVar1;
}



DWORD GetTapeParameters(HANDLE hDevice,DWORD dwOperation,LPDWORD lpdwSize,LPVOID lpTapeInformation)

{
  DWORD DVar1;
  undefined4 uVar2;
  
                    // 0x5dd00  758  GetTapeParameters
  if (dwOperation == 0) {
    if (*lpdwSize < 0x20) goto LAB_6b85dd39;
    uVar2 = 0x1f401c;
  }
  else {
    if (dwOperation != 1) {
      return 1;
    }
    if (*lpdwSize < 0x20) {
LAB_6b85dd39:
      *lpdwSize = 0x20;
      return 0xea;
    }
    uVar2 = 0x1f4014;
  }
  DVar1 = FUN_6b85dc76((int)hDevice,uVar2,0,0,lpTapeInformation,0x20);
  return DVar1;
}



BOOL GetThreadSelectorEntry(HANDLE hThread,DWORD dwSelector,LPLDT_ENTRY lpSelectorEntry)

{
  BOOL BVar1;
  undefined4 extraout_EDX;
  undefined4 uVar2;
  undefined8 uVar3;
  DWORD local_14;
  undefined4 local_10;
  undefined4 local_c;
  uint local_8;
  
                    // 0x5dd60  778  GetThreadSelectorEntry
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_14 = dwSelector;
  uVar3 = NtQueryInformationThread(hThread,6,&local_14,0xc,0);
  uVar2 = (undefined4)((ulonglong)uVar3 >> 0x20);
  if ((int)uVar3 < 0) {
    BaseSetLastNTError((int)uVar3);
    uVar2 = extraout_EDX;
  }
  else {
    *(undefined4 *)lpSelectorEntry = local_10;
    lpSelectorEntry->HighWord = local_c;
  }
  BVar1 = FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return BVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

UINT LocalFlags(HLOCAL hMem)

{
  ushort uVar1;
  char cVar2;
  HLOCAL pvVar3;
  undefined4 *in_FS_OFFSET;
  uint local_28;
  HLOCAL local_24;
  uint local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
                    // 0x5ddc0  980  LocalFlags
  local_8 = &DAT_6b8924f8;
  uStack12 = 0x6b85ddcc;
  local_20 = 0x8000;
  RtlLockHeap(DAT_6b8b0734);
  local_8 = (undefined *)0x1;
  pvVar3 = hMem;
  if (((uint)hMem & 4) == 0) {
    local_24 = (HLOCAL)0x0;
    local_28 = 0;
    cVar2 = RtlGetUserInfoHeap(DAT_6b8b0734,0,hMem,&local_24,&local_28);
    if ((cVar2 != '\0') &&
       ((local_24 == (HLOCAL)0x0 || (pvVar3 = local_24, (local_28 & 0x200) == 0)))) {
      local_20 = 0;
      pvVar3 = hMem;
    }
    if (((uint)pvVar3 & 4) == 0) goto LAB_6b85de66;
  }
  cVar2 = RtlIsValidHandle(DAT_6b8b072c,(ushort *)((int)pvVar3 - 4U));
  if (cVar2 != '\0') {
    local_20 = (uint)(byte)*(undefined2 *)((int)pvVar3 - 2);
    uVar1 = *(ushort *)((int)pvVar3 - 4U);
    if ((uVar1 & 8) != 0) {
      local_20 = local_20 | 0x4000;
    }
    if ((uVar1 & 4) != 0) {
      local_20 = local_20 | 0xf00;
    }
  }
LAB_6b85de66:
  if (local_20 == 0x8000) {
    RtlSetLastWin32Error(6);
  }
  local_8 = (undefined *)0xfffffffe;
  FUN_6b85debe();
  *in_FS_OFFSET = local_14;
  return local_20;
}



void FUN_6b85debe(void)

{
  RtlUnlockHeap(DAT_6b8b0734);
  return;
}



int __fastcall FUN_6b85decb(uint *param_1)

{
  int iVar1;
  uint *local_8;
  
  local_8 = param_1;
  iVar1 = FUN_6b85e1df(L"SYSTEM\\CurrentControlSet\\Control\\WinInit",L"Headless",&local_8);
  if (iVar1 != 0) {
    *param_1 = (uint)(local_8 != (uint *)0x0);
    iVar1 = 1;
  }
  return iVar1;
}



void __fastcall FUN_6b85defb(undefined4 *param_1)

{
  BOOL BVar1;
  undefined4 uVar2;
  undefined4 extraout_EDX;
  _OSVERSIONINFOW local_124;
  char local_a;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_124.dwOSVersionInfoSize = 0x11c;
  BVar1 = GetVersionExW(&local_124);
  if (BVar1 != 0) {
    if ((local_a == '\x03') || (local_a == '\x02')) {
      uVar2 = 1;
    }
    else {
      uVar2 = 0;
    }
    *param_1 = uVar2;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,extraout_EDX);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 FUN_6b85df52(void)

{
  int iVar1;
  DWORD DVar2;
  int local_8;
  
  if (_DAT_6b8b09e4 != 0) {
    return 1;
  }
  local_8 = 0;
  iVar1 = FUN_6b85e1df(L"SYSTEM\\Setup",L"SetupSupported",&local_8);
  if (iVar1 == 0) {
    DVar2 = GetLastError();
    if ((DVar2 != 3) && (DVar2 != 2)) {
      return 0;
    }
    RtlSetLastWin32Error(0);
  }
  else if (local_8 != 0) {
    _DAT_6b8b09e0 = 1;
    _DAT_6b8b09e4 = 1;
    return 1;
  }
  iVar1 = FUN_6b85e1df(L"Software\\Microsoft\\CoreShell\\Oobe",L"OobeCompleteWnfSupported",&local_8)
  ;
  if (iVar1 == 0) {
    DVar2 = GetLastError();
    if ((DVar2 != 3) && (DVar2 != 2)) {
      return 0;
    }
    RtlSetLastWin32Error(0);
  }
  if (local_8 != 0) {
    _DAT_6b8b09e0 = 1;
    _DAT_6b8b09e4 = 1;
    return 1;
  }
  _DAT_6b8b09e0 = 0;
  _DAT_6b8b09e4 = 1;
  return 1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 FUN_6b85dfeb(void)

{
  int iVar1;
  int local_c;
  uint local_8;
  
  if (_DAT_6b8b09e8 != 0) {
    return 1;
  }
  iVar1 = FUN_6b85decb(&local_8);
  if ((iVar1 != 0) && (iVar1 = FUN_6b85defb(&local_c), iVar1 != 0)) {
    if ((local_8 == 0) && (local_c == 0)) {
      DAT_6b8b09d8 = 0xa3bc2475;
      DAT_6b8b09dc = 0xd83063e;
    }
    else {
      DAT_6b8b09d8 = 0xa3bc0c75;
      DAT_6b8b09dc = 0x41960b29;
    }
    _DAT_6b8b09e8 = 1;
    return 1;
  }
  return 0;
}



uint __fastcall FUN_6b85e057(uint3 param_1)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  undefined4 local_14;
  undefined4 local_10;
  int local_c;
  undefined4 local_8;
  
  local_8 = 4;
  local_c = 0;
  local_14 = 0;
  uVar3 = 1;
  local_10 = 0;
  uVar1 = FID_conflict__IsRIMFreeInputBufferPresent_0(param_1);
  if ((char)uVar1 == '\0') {
    RtlInitUnicodeString(&local_14,L"Kernel-SkipOOBE");
    iVar2 = NtQueryLicenseValue(&local_14,0,&local_c,local_8,&local_8);
    if (iVar2 == 0) {
      uVar3 = ~-(uint)(local_c != 0) & 1;
    }
  }
  else {
    uVar3 = QueryOOBESupport();
  }
  return uVar3;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 __thiscall OOBEComplete(undefined4 this,undefined4 *param_2)

{
  uint uVar1;
  int iVar2;
  undefined4 uVar3;
  undefined4 local_c;
  undefined4 local_8;
  
                    // 0x5e0d0  1024  OOBEComplete
  local_8 = 0;
  local_c = this;
  if (param_2 == (undefined4 *)0x0) {
    uVar3 = 0x57;
  }
  else {
    uVar1 = FUN_6b85e057((uint3)this);
    if (uVar1 == 0) {
      *param_2 = 1;
      return 1;
    }
    iVar2 = FUN_6b85df52();
    if (iVar2 == 0) {
      return 0;
    }
    if (_DAT_6b8b09e0 != 0) {
      iVar2 = FUN_6b85dfeb();
      if (iVar2 == 0) {
        return 0;
      }
      iVar2 = RtlQueryWnfStateData(&local_c,DAT_6b8b09d8,DAT_6b8b09dc,FUN_6b85e1a0,&local_8,0);
      if (iVar2 < 0) {
        BaseSetLastNTError(iVar2);
        return 0;
      }
      *param_2 = local_8;
      return 1;
    }
    uVar3 = 0x32;
  }
  RtlSetLastWin32Error(uVar3);
  return 0;
}



// Library Function - Single Match
//  _OOBECompleteWnfCallback@32
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

undefined4 _OOBECompleteWnfCallback_32(undefined **param_1,int *param_2,int param_3,int param_4)

{
  code *pcVar1;
  int iVar2;
  undefined *puVar3;
  
  iVar2 = 0;
  if (param_3 == 4) {
    iVar2 = *param_2;
  }
  if (param_4 == 0) {
    *param_1 = (undefined *)(uint)(iVar2 != 0);
  }
  else if (iVar2 == 1) {
    pcVar1 = (code *)*param_1;
    puVar3 = param_1[1];
    _guard_check_icall();
    (*pcVar1)(puVar3);
  }
  return 0;
}



void FUN_6b85e1a0(undefined4 param_1,undefined4 param_2,undefined param_3,undefined param_4,
                 undefined **param_5,int *param_6,int param_7)

{
  _OOBECompleteWnfCallback_32(param_5,param_6,param_7,0);
  return;
}



void FUN_6b85e1c0(undefined4 param_1,undefined4 param_2,undefined param_3,undefined param_4,
                 undefined **param_5,int *param_6,int param_7)

{
  _OOBECompleteWnfCallback_32(param_5,param_6,param_7,1);
  return;
}



undefined4 __fastcall FUN_6b85e1df(LPCWSTR param_1,LPCWSTR param_2,undefined4 *param_3)

{
  LSTATUS LVar1;
  DWORD local_14;
  undefined4 local_10;
  DWORD local_c;
  HKEY local_8;
  
  LVar1 = RegOpenKeyExW((HKEY)0x80000002,param_1,0,1,&local_8);
  if (LVar1 == 0) {
    local_c = 4;
    LVar1 = RegQueryValueExW(local_8,param_2,(LPDWORD)0x0,&local_14,(LPBYTE)&local_10,&local_c);
    if (LVar1 == 0) {
      *param_3 = local_10;
      RegCloseKey(local_8);
      return 1;
    }
    RegCloseKey(local_8);
  }
  RtlSetLastWin32Error(LVar1);
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 RegisterWaitUntilOOBECompleted(int param_1,int param_2,int **param_3)

{
  int iVar1;
  int *piVar2;
  int in_FS_OFFSET;
  undefined4 uVar3;
  undefined4 local_10;
  int local_c;
  int local_8;
  
                    // 0x5e260  1199  RegisterWaitUntilOOBECompleted
  local_c = 0;
  local_8 = 0;
  if ((param_1 == 0) || (param_3 == (int **)0x0)) {
    uVar3 = 0x57;
  }
  else {
    iVar1 = FUN_6b85df52();
    if (iVar1 == 0) {
      return 0;
    }
    if (_DAT_6b8b09e0 != 0) {
      iVar1 = FUN_6b85dfeb();
      if (iVar1 == 0) {
        return 0;
      }
      iVar1 = RtlQueryWnfStateData(&local_10,DAT_6b8b09d8,DAT_6b8b09dc,FUN_6b85e1a0,&local_8,0);
      if (-1 < iVar1) {
        if (local_8 == 1) {
          uVar3 = 0x139f;
          goto LAB_6b85e365;
        }
        piVar2 = (int *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,0xc)
        ;
        if (piVar2 == (int *)0x0) {
          iVar1 = -0x3fffffe9;
        }
        else {
          piVar2[1] = param_2;
          *piVar2 = param_1;
          iVar1 = RtlSubscribeWnfStateChangeNotification
                            (&local_c,DAT_6b8b09d8,DAT_6b8b09dc,local_10,FUN_6b85e1c0,piVar2,0,0,1);
          if (-1 < iVar1) {
            piVar2[2] = local_c;
            *param_3 = piVar2;
            return 1;
          }
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,piVar2);
        }
      }
      BaseSetLastNTError(iVar1);
      return 0;
    }
    uVar3 = 0x32;
  }
LAB_6b85e365:
  RtlSetLastWin32Error(uVar3);
  return 0;
}



undefined4 UnregisterWaitUntilOOBECompleted(int param_1)

{
  int iVar1;
  int in_FS_OFFSET;
  
                    // 0x5e380  1470  UnregisterWaitUntilOOBECompleted
  if (param_1 == 0) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    iVar1 = RtlUnsubscribeWnfStateChangeNotification(*(undefined4 *)(param_1 + 8));
    if (-1 < iVar1) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1);
      return 1;
    }
    BaseSetLastNTError(iVar1);
  }
  return 0;
}



BOOL SetEnvironmentStringsA(LPCH NewEnvironment)

{
  char cVar1;
  char *pcVar2;
  int iVar3;
  char *pcVar4;
  char *pcVar5;
  undefined2 local_14 [2];
  LPCH local_10;
  undefined2 local_c [2];
  undefined4 local_8;
  
  pcVar5 = NewEnvironment;
  do {
    cVar1 = *pcVar5;
    pcVar5 = pcVar5 + 1;
    pcVar4 = NewEnvironment;
  } while (cVar1 != '\0');
  while( true ) {
    if (((int)pcVar5 - (int)(pcVar4 + 1) == 0) ||
       (pcVar2 = strchr(pcVar4 + 1,0x3d), pcVar2 == (char *)0x0)) goto LAB_6b85e418;
    pcVar4 = pcVar4 + ((int)pcVar5 - (int)(pcVar4 + 1)) + 1;
    pcVar5 = pcVar4;
    if (*pcVar4 == '\0') break;
    do {
      cVar1 = *pcVar5;
      pcVar5 = pcVar5 + 1;
    } while (cVar1 != '\0');
  }
  if (pcVar4 + (1 - (int)NewEnvironment) < (char *)0x8000) {
    local_14[0] = SUB42(pcVar4 + (1 - (int)NewEnvironment),0);
    local_10 = NewEnvironment;
    iVar3 = RtlOemStringToUnicodeString(local_c,local_14,1);
    if (-1 < iVar3) {
      iVar3 = RtlSetEnvironmentStrings(local_8,local_c[0]);
      RtlFreeUnicodeString(local_c);
      if (-1 < iVar3) {
        return 1;
      }
    }
  }
LAB_6b85e418:
  BaseSetLastNTError(0xc000000d);
  return 0;
}



void FUN_6b85e474(void)

{
  wchar_t wVar1;
  int iVar2;
  wchar_t *pwVar3;
  void *_Dst;
  undefined4 extraout_EDX;
  undefined4 uVar4;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  int in_FS_OFFSET;
  undefined8 uVar5;
  undefined4 local_23c;
  undefined4 local_238;
  uint *local_234;
  undefined4 local_230;
  undefined4 local_22c;
  undefined4 local_228;
  undefined4 local_224;
  uint local_220;
  uint local_21c;
  int local_218;
  wchar_t local_214;
  undefined local_212 [522];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_224 = 0;
  iVar2 = *(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x10);
  pwVar3 = wcsrchr(*(wchar_t **)(iVar2 + 0x3c),L'\\');
  if (pwVar3 == (wchar_t *)0x0) {
    pwVar3 = *(wchar_t **)(iVar2 + 0x3c);
  }
  else {
    pwVar3 = pwVar3 + 1;
  }
  wcscpy_s(&local_214,0x105,pwVar3);
  pwVar3 = wcsrchr(&local_214,L'.');
  if (pwVar3 != (wchar_t *)0x0) {
    *pwVar3 = L'\0';
  }
  local_218 = 0;
  pwVar3 = &local_214;
  local_21c = 0;
  do {
    wVar1 = *pwVar3;
    pwVar3 = pwVar3 + 1;
  } while (wVar1 != L'\0');
  local_220 = ((int)pwVar3 - (int)local_212 >> 1) * 2 + 0xd8;
  pwVar3 = (wchar_t *)
           RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_220);
  if (pwVar3 != (wchar_t *)0x0) {
    wcscpy_s(pwVar3,local_220 >> 1,
             L"\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Terminal Server\\Compatibility\\Applications\\"
            );
    wcscat_s(pwVar3,local_220 >> 1,&local_214);
    RtlInitUnicodeString(&local_21c,pwVar3);
  }
  uVar5 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,0x224);
  uVar4 = (undefined4)((ulonglong)uVar5 >> 0x20);
  _Dst = (void *)uVar5;
  if ((local_218 != 0) && (_Dst != (void *)0x0)) {
    local_234 = &local_21c;
    local_23c = 0x18;
    local_238 = 0;
    local_230 = 0x40;
    local_22c = 0;
    local_228 = 0;
    uVar5 = NtOpenKey(&local_224,0x20019,&local_23c);
    uVar4 = (undefined4)((ulonglong)uVar5 >> 0x20);
    if (-1 < (int)uVar5) {
      RtlInitUnicodeString(&local_21c,L"Flags");
      NtQueryValueKey(local_224,&local_21c,2,_Dst,0x224,&local_220);
      NtClose(local_224);
      uVar4 = extraout_EDX;
    }
  }
  if (pwVar3 != (wchar_t *)0x0) {
    memset(pwVar3,0,local_21c >> 0x10);
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pwVar3);
    uVar4 = extraout_EDX_00;
  }
  if (_Dst != (void *)0x0) {
    memset(_Dst,0,0x224);
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,_Dst);
    uVar4 = extraout_EDX_01;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar4);
  return;
}



void FUN_6b85e698(void)

{
  HMODULE hModule;
  FARPROC pFVar1;
  int iVar2;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  int iVar3;
  undefined4 uVar4;
  int *piVar5;
  int local_18;
  int local_14;
  undefined4 local_10;
  undefined2 local_c;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_c = 0x500;
  local_14 = 0;
  local_10 = 0;
  hModule = LoadLibraryW(L"advapi32.dll");
  uVar4 = extraout_EDX;
  if (hModule == (HMODULE)0x0) goto LAB_6b85e7b6;
  pFVar1 = GetProcAddress(hModule,"CheckTokenMembership");
  iVar3 = 0;
  if (pFVar1 != (FARPROC)0x0) {
    iVar2 = RtlAllocateAndInitializeSid(&local_10,2,0x20,0x220,0,0,0,0,0,0,&local_14);
    if (iVar2 < 0) {
      uVar4 = RtlNtStatusToDosError(iVar2);
LAB_6b85e73a:
      RtlSetLastWin32Error(uVar4);
    }
    else {
      piVar5 = &local_18;
      uVar4 = 0;
      iVar2 = local_14;
      _guard_check_icall();
      iVar2 = (*pFVar1)(uVar4,iVar2,piVar5);
      if (iVar2 != 0) {
        if (local_18 == 0) {
          uVar4 = 5;
          goto LAB_6b85e73a;
        }
        RtlSetLastWin32Error(0);
        iVar3 = 1;
      }
    }
    if (local_14 != 0) {
      RtlFreeSid(local_14);
      local_14 = 0;
    }
    if (iVar3 == 0) {
      iVar2 = RtlAllocateAndInitializeSid(&local_10,1,0x12,0,0,0,0,0,0,0,&local_14);
      if (iVar2 < 0) {
        uVar4 = RtlNtStatusToDosError(iVar2);
LAB_6b85e7a5:
        RtlSetLastWin32Error(uVar4);
      }
      else {
        piVar5 = &local_18;
        iVar2 = local_14;
        _guard_check_icall();
        iVar3 = (*pFVar1)(iVar3,iVar2,piVar5);
        if (iVar3 != 0) {
          if (local_18 == 0) {
            uVar4 = 5;
            goto LAB_6b85e7a5;
          }
          RtlSetLastWin32Error(0);
        }
      }
    }
  }
  FreeLibrary(hModule);
  uVar4 = extraout_EDX_00;
LAB_6b85e7b6:
  if (local_14 != 0) {
    RtlFreeSid(local_14);
    uVar4 = extraout_EDX_01;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar4);
  return;
}



undefined4 SetTermsrvAppInstallMode(int param_1)

{
  FARPROC pFVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  HMODULE hModule;
  int local_8;
  
                    // 0x5e7e0  1368  SetTermsrvAppInstallMode
  uVar2 = RtlGetSuiteMask();
  if ((uVar2 & 0x10) != 0) {
    iVar3 = FUN_6b818fbc(&local_8);
    if (-1 < iVar3) {
      if (local_8 == 0) {
        return 0;
      }
      iVar3 = FUN_6b822400();
      if (-1 < iVar3) {
        if (DAT_6b8b09f8 == (FARPROC)0x0) {
          hModule = LoadLibraryExW(L"tsappcmp.dll",(HANDLE)0x0,0x800);
          if (hModule != (HMODULE)0x0) {
            DAT_6b8b09f8 = GetProcAddress(hModule,"TermsrvUpdateAllUserMenu");
          }
          if (DAT_6b8b09f8 == (FARPROC)0x0) {
            return 1;
          }
        }
        pFVar1 = DAT_6b8b09f8;
        uVar2 = (uint)(param_1 != 1);
        _guard_check_icall();
        (*pFVar1)(uVar2);
        return 1;
      }
    }
    uVar4 = RtlNtStatusToDosError(iVar3);
    RtlSetLastWin32Error(uVar4);
  }
  return 0;
}



int __fastcall FUN_6b85e884(short *param_1,uint param_2,short *param_3,short **param_4,int *param_5)

{
  int iVar1;
  short *psVar2;
  uint uVar3;
  short *local_8;
  
  local_8 = param_1;
  iVar1 = FUN_6b85ea47(param_1,param_2 >> 1,(int *)&local_8);
  if (-1 < iVar1) {
    iVar1 = 0;
    uVar3 = (param_2 >> 1) - (int)local_8;
    psVar2 = param_1 + (int)local_8;
    if (uVar3 < 2) {
      if (*param_3 != 0) {
        if (param_1 == (short *)0x0) {
          return -0x7ff8ffa9;
        }
        iVar1 = -0x7ff8ff86;
      }
    }
    else {
      local_8 = (short *)0x0;
      iVar1 = FUN_6b85e9d2(psVar2,uVar3,(int *)&local_8,(int)param_3);
      uVar3 = uVar3 - (int)local_8;
      psVar2 = psVar2 + (int)local_8;
      if ((iVar1 < 0) && (iVar1 != -0x7ff8ff86)) {
        return iVar1;
      }
    }
    if (param_4 != (short **)0x0) {
      *param_4 = psVar2;
    }
    if (param_5 != (int *)0x0) {
      *param_5 = (param_2 & 1) + uVar3 * 2;
    }
  }
  return iVar1;
}



int __thiscall FUN_6b85e920(void *this,int param_1,undefined4 *param_2,int *param_3)

{
  int iVar1;
  short *extraout_ECX;
  void *local_8;
  
  local_8 = this;
  iVar1 = FUN_6b85ea31(this,0x105);
  if (iVar1 < 0) {
    *(undefined2 *)this = 0;
  }
  else {
    local_8 = (void *)0x0;
    iVar1 = FUN_6b85e9d2(extraout_ECX,0x105,(int *)&local_8,param_1);
    if ((-1 < iVar1) || (iVar1 == -0x7ff8ff86)) {
      if (param_2 != (undefined4 *)0x0) {
        *param_2 = (void *)((int)this + (int)local_8 * 2);
      }
      if (param_3 != (int *)0x0) {
        *param_3 = (0x105 - (int)local_8) * 2;
      }
    }
  }
  return iVar1;
}



int __fastcall FUN_6b85e98b(char *param_1,int param_2,undefined4 param_3,int param_4)

{
  int iVar1;
  int iVar2;
  
  if (param_2 != 0) {
    iVar2 = 0x7ffffffe;
    iVar1 = param_4 - (int)param_1;
    do {
      if ((iVar2 == 0) || (param_1[iVar1] == '\0')) break;
      *param_1 = param_1[iVar1];
      param_1 = param_1 + 1;
      iVar2 = iVar2 + -1;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
    if (param_2 != 0) goto LAB_6b85e9bb;
  }
  param_1 = param_1 + -1;
LAB_6b85e9bb:
  *param_1 = '\0';
  return (-(uint)(param_2 != 0) & 0x7ff8ff86) + 0x8007007a;
}



int __fastcall FUN_6b85e9d2(short *param_1,int param_2,int *param_3,int param_4)

{
  short sVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  iVar2 = 0;
  if (param_2 != 0) {
    iVar4 = 0x7ffffffe;
    iVar3 = param_4 - (int)param_1;
    do {
      if ((iVar4 == 0) || (sVar1 = *(short *)(iVar3 + (int)param_1), sVar1 == 0)) break;
      *param_1 = sVar1;
      param_1 = param_1 + 1;
      iVar4 = iVar4 + -1;
      iVar2 = iVar2 + 1;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
    if (param_2 != 0) goto LAB_6b85ea0e;
  }
  param_1 = param_1 + -1;
  iVar2 = iVar2 + -1;
LAB_6b85ea0e:
  *param_1 = 0;
  if (param_3 != (int *)0x0) {
    *param_3 = iVar2;
  }
  return (-(uint)(param_2 != 0) & 0x7ff8ff86) + 0x8007007a;
}



undefined4 __fastcall FUN_6b85ea31(undefined4 param_1,uint param_2)

{
  undefined4 uVar1;
  
  uVar1 = 0;
  if ((param_2 == 0) || (0x7fffffff < param_2)) {
    uVar1 = 0x80070057;
  }
  return uVar1;
}



int __fastcall FUN_6b85ea47(short *param_1,uint param_2,int *param_3)

{
  int iVar1;
  
  iVar1 = 0;
  if ((param_2 == 0) || (0x7fffffff < param_2)) {
    iVar1 = -0x7ff8ffa9;
  }
  if (iVar1 < 0) {
    *param_3 = 0;
  }
  else {
    iVar1 = FUN_6b8409f5(param_1,param_2,param_3);
  }
  return iVar1;
}



void __fastcall FUN_6b85ea7d(undefined4 param_1,int param_2)

{
  undefined4 uVar1;
  undefined8 uVar2;
  undefined4 local_64;
  undefined4 local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c [2];
  undefined local_44 [60];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  uVar2 = FUN_6b85eb4a(param_1,param_2,local_4c);
  uVar1 = (undefined4)((ulonglong)uVar2 >> 0x20);
  if (((int)uVar2 != -0x3fffffcc) && (-1 < (int)uVar2)) {
    local_64 = 0x18;
    local_60 = 0;
    local_54 = 0;
    local_50 = 0;
    local_58 = 0x40;
    local_5c = param_1;
    uVar2 = NtQueryFullAttributesFile(&local_64,local_44);
    uVar1 = (undefined4)((ulonglong)uVar2 >> 0x20);
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar1);
  return;
}



void FUN_6b85eaf9(void)

{
  undefined4 extraout_EDX;
  undefined4 local_4c;
  undefined4 local_48;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined local_34 [44];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_4c = 0x18;
  local_48 = 0;
  local_3c = 0;
  local_38 = 0;
  local_40 = 0x40;
  NtQueryAttributesFile(&local_4c,local_34);
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,extraout_EDX);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void __fastcall FUN_6b85eb4a(wchar_t *param_1,int param_2,undefined4 *param_3)

{
  wchar_t wVar1;
  wchar_t *pwVar2;
  int iVar3;
  wchar_t *pwVar4;
  wchar_t *pwVar5;
  wchar_t *extraout_EDX;
  wchar_t *extraout_EDX_00;
  wchar_t *extraout_EDX_01;
  wchar_t *_Str1;
  int *piVar6;
  wchar_t *pwVar7;
  undefined8 uVar8;
  undefined4 local_278;
  undefined4 local_274;
  undefined4 *local_270;
  undefined4 local_26c;
  undefined4 local_268;
  undefined4 local_264;
  undefined4 *local_260;
  undefined4 local_25c;
  int local_258 [2];
  undefined4 local_250;
  undefined *local_24c;
  int local_248;
  wchar_t *local_244;
  int local_240;
  wchar_t *local_23c;
  int local_238 [6];
  undefined local_220 [532];
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  piVar6 = local_238;
  for (iVar3 = 6; iVar3 != 0; iVar3 = iVar3 + -1) {
    *piVar6 = 0;
    piVar6 = piVar6 + 1;
  }
  local_260 = param_3;
  local_25c = 0;
  local_240 = 0;
  local_244 = param_1;
  memset(local_220,0,0x20a);
  local_250 = 0x20a0000;
  local_23c = (wchar_t *)0x0;
  local_24c = local_220;
  pwVar2 = extraout_EDX;
  if (((local_244 != (wchar_t *)0x0) && (param_2 != 0)) && (param_3 != (undefined4 *)0x0)) {
    uVar8 = RtlAppendUnicodeStringToString(&local_250,param_2);
    pwVar2 = (wchar_t *)((ulonglong)uVar8 >> 0x20);
    if (-1 < (int)uVar8) {
      uVar8 = RtlAppendUnicodeToString(&local_250,L"\\inifile.upd");
      pwVar2 = (wchar_t *)((ulonglong)uVar8 >> 0x20);
      if (-1 < (int)uVar8) {
        local_270 = &local_250;
        *param_3 = 0;
        param_3[1] = 0;
        local_278 = 0x18;
        local_274 = 0;
        local_26c = 0x40;
        local_268 = 0;
        local_264 = 0;
        local_258[0] = 0;
        uVar8 = NtOpenFile(&local_240,0x120089,&local_278,local_258,3,0x20);
        pwVar2 = (wchar_t *)((ulonglong)uVar8 >> 0x20);
        if (-1 < (int)uVar8) {
          uVar8 = NtQueryInformationFile(local_240,local_258,local_238,0x18,5);
          pwVar2 = (wchar_t *)((ulonglong)uVar8 >> 0x20);
          if (-1 < (int)(-(uint)((uint)uVar8 != 0x80000005) & (uint)uVar8)) {
            local_248 = local_238[2] + 8;
            uVar8 = NtAllocateVirtualMemory(0xffffffff,&local_23c,0,&local_248,0x2000,4);
            pwVar2 = (wchar_t *)((ulonglong)uVar8 >> 0x20);
            if (-1 < (int)uVar8) {
              uVar8 = NtAllocateVirtualMemory(0xffffffff,&local_23c,0,&local_248,0x1000,4);
              pwVar2 = (wchar_t *)((ulonglong)uVar8 >> 0x20);
              if (-1 < (int)uVar8) {
                uVar8 = NtReadFile(local_240,0,0,0,local_258,local_23c,local_238[2],0,0);
                if ((int)uVar8 == 0x103) {
                  uVar8 = NtWaitForSingleObject(local_240,0,0);
                }
                pwVar5 = local_244;
                pwVar2 = (wchar_t *)((ulonglong)uVar8 >> 0x20);
                if (((-1 < (int)uVar8) && (-1 < local_258[0])) &&
                   (pwVar7 = (wchar_t *)(local_238[2] + (int)local_23c), _Str1 = local_23c,
                   local_23c < pwVar7)) {
                  do {
                    pwVar2 = (wchar_t *)_wcsicmp(_Str1,*(wchar_t **)(pwVar5 + 2));
                    if (-1 < (int)pwVar2) break;
                    local_244 = _Str1 + 1;
                    pwVar4 = _Str1;
                    do {
                      wVar1 = *pwVar4;
                      pwVar4 = pwVar4 + 1;
                    } while (wVar1 != (wchar_t)local_25c);
                    _Str1 = _Str1 + ((int)pwVar4 - (int)local_244 >> 1) + 5;
                  } while (_Str1 < pwVar7);
                  if ((_Str1 < pwVar7) && (pwVar2 == (wchar_t *)0x0)) {
                    pwVar2 = _Str1 + 1;
                    pwVar5 = _Str1;
                    do {
                      wVar1 = *pwVar5;
                      pwVar5 = pwVar5 + 1;
                    } while (wVar1 != L'\0');
                    iVar3 = (int)pwVar5 - (int)pwVar2 >> 1;
                    *local_260 = *(undefined4 *)(_Str1 + iVar3 + 1);
                    local_260[1] = *(undefined4 *)(_Str1 + iVar3 + 3);
                  }
                }
              }
            }
          }
        }
        if (local_23c != (wchar_t *)0x0) {
          NtFreeVirtualMemory(0xffffffff,&local_23c,&local_248,0x8000);
          pwVar2 = extraout_EDX_00;
        }
        if (local_240 != 0) {
          NtClose(local_240);
          pwVar2 = extraout_EDX_01;
        }
      }
    }
  }
  FUN_6b8224af(local_c ^ (uint)&stack0xfffffffc,pwVar2);
  return;
}



void __fastcall FUN_6b85ee49(undefined4 param_1,int *param_2,undefined *param_3)

{
  char cVar1;
  short sVar2;
  char *pcVar3;
  int iVar4;
  code *pcVar5;
  uint uVar6;
  int iVar7;
  int extraout_EDX;
  int extraout_EDX_00;
  int extraout_EDX_01;
  int extraout_EDX_02;
  int extraout_EDX_03;
  char *pcVar8;
  int iVar9;
  uint uVar10;
  int in_FS_OFFSET;
  undefined8 uVar11;
  undefined4 uVar12;
  char **ppcVar13;
  undefined4 *puVar14;
  undefined *puVar15;
  undefined4 uVar16;
  undefined4 *puVar17;
  undefined4 *puVar18;
  undefined4 local_224;
  undefined4 local_220;
  int local_21c;
  undefined4 local_214;
  code *local_210;
  char *local_20c;
  undefined local_208 [512];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  iVar7 = 0;
  *param_3 = 0;
  pcVar8 = (char *)0x0;
  local_224 = 0;
  local_220 = 0;
  iVar9 = 0;
joined_r0x6b85ee9f:
  local_210 = DAT_6b8b0a00;
  if (DAT_6b8b0a00 == (code *)0x0) {
    local_20c = (char *)0x0;
    local_214 = 0;
  }
  else {
    local_20c = (char *)0x0;
    local_214 = 0;
    puVar18 = &local_220;
    puVar17 = &local_224;
    uVar16 = 0x200;
    puVar15 = local_208;
    puVar14 = &local_214;
    ppcVar13 = &local_20c;
    uVar12 = param_1;
    _guard_check_icall();
    uVar11 = (*local_210)(uVar12,ppcVar13,puVar14,puVar15,uVar16,puVar17,puVar18);
    iVar7 = (int)((ulonglong)uVar11 >> 0x20);
    if ((int)uVar11 < 0) {
      if (pcVar8 != (char *)0x0) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pcVar8);
      }
      iVar7 = param_2[3];
      *(undefined4 *)(iVar7 + 0x30) = *(undefined4 *)(iVar7 + 0x1c);
    }
    else {
      if (*local_20c != '[') goto LAB_6b85efa5;
      if (pcVar8 != (char *)0x0) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pcVar8);
      }
      pcVar8 = strrchr(local_20c,0x5d);
      if (pcVar8 == (char *)0x0) {
        pcVar8 = local_20c;
        do {
          cVar1 = *pcVar8;
          pcVar8 = pcVar8 + 1;
        } while (cVar1 != '\0');
        uVar6 = (int)pcVar8 - (int)(local_20c + 1) & 0xffff;
        sVar2 = (short)uVar6;
        uVar6 = uVar6 + 1;
      }
      else {
        uVar6 = (int)pcVar8 - (int)local_20c;
        *pcVar8 = '\0';
        sVar2 = (short)uVar6 + -1;
      }
      uVar10 = uVar6 & 0xffff;
      local_21c = CONCAT22((short)uVar6,sVar2);
      uVar11 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,uVar10);
      iVar7 = (int)((ulonglong)uVar11 >> 0x20);
      pcVar8 = (char *)uVar11;
      if (pcVar8 != (char *)0x0) {
        if (uVar10 != 0) {
          FUN_6b85e98b(pcVar8,uVar10,local_20c + 1,(int)(local_20c + 1));
        }
        param_2[10] = local_21c;
        param_2[0xb] = (int)pcVar8;
        pcVar5 = *(code **)(param_2[3] + 0x20);
        goto LAB_6b85f049;
      }
    }
  }
  goto LAB_6b85f0fd;
LAB_6b85efa5:
  if ((*local_20c != ';') &&
     (pcVar3 = strchr(local_20c,0x3d), iVar7 = extraout_EDX, pcVar3 != (char *)0x0)) {
    sVar2 = (short)pcVar3 - (short)local_20c;
    param_2[0xd] = (int)local_20c;
    pcVar3 = pcVar3 + 1;
    *(short *)((int)param_2 + 0x32) = sVar2;
    param_2[0x14] = 0;
    *(short *)(param_2 + 0xc) = sVar2;
    param_2[0x13] = (int)pcVar3;
    for (; ((cVar1 = *pcVar3, cVar1 != '\0' && (cVar1 != '\n')) && (cVar1 != '\r'));
        pcVar3 = pcVar3 + 1) {
      param_2[0x14] = param_2[0x14] + 1;
    }
    if (iVar9 != 0) {
      param_2[0x17] = iVar9;
      iVar4 = FUN_6b810cc1((int)param_2);
      iVar7 = extraout_EDX_00;
      if (-1 < iVar4) goto joined_r0x6b85ee9f;
    }
    local_210 = *(code **)(param_2[3] + 0x20);
    param_2[0x17] = (int)local_210;
    iVar4 = FUN_6b8101e7(param_2);
    iVar7 = param_2[3];
    param_2[0x19] = *(int *)(iVar7 + 0x20) + *(int *)(iVar7 + 0x1c);
    if (iVar4 < 0) {
      *(undefined4 *)(iVar7 + 0x30) = *(undefined4 *)(iVar7 + 0x1c);
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_20c);
      iVar7 = extraout_EDX_02;
      if (pcVar8 != (char *)0x0) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pcVar8);
        iVar7 = extraout_EDX_03;
      }
LAB_6b85f0fd:
      FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,iVar7);
      return;
    }
    *param_3 = 1;
    pcVar5 = *(code **)(param_2[3] + 0x20);
    if (local_210 != pcVar5) {
LAB_6b85f049:
      param_2[0x17] = (int)pcVar5;
      iVar9 = FUN_6b810e4e((int)param_2);
      iVar7 = extraout_EDX_01;
      if (iVar9 < 0) {
        iVar9 = 0;
      }
      else {
        iVar9 = param_2[0x17];
      }
    }
  }
  goto joined_r0x6b85ee9f;
}



// WARNING: Could not reconcile some variable overlaps

void __fastcall FUN_6b85f10e(ushort *param_1,int param_2,undefined4 *param_3)

{
  uint uVar1;
  wchar_t wVar2;
  ushort uVar3;
  uint uVar4;
  int iVar5;
  wchar_t *pwVar6;
  int extraout_EDX;
  int extraout_EDX_00;
  int extraout_EDX_01;
  wchar_t *pwVar7;
  uint *puVar8;
  wchar_t *_Str1;
  undefined8 uVar9;
  ulonglong uVar10;
  ulonglong uVar11;
  undefined4 local_288;
  undefined4 local_284;
  undefined4 *local_280;
  undefined4 local_27c;
  undefined4 local_278;
  undefined4 local_274;
  int local_270;
  undefined4 local_26c;
  undefined4 local_268;
  undefined4 local_264;
  undefined4 local_260;
  undefined *local_25c;
  uint local_258;
  uint local_254 [2];
  uint local_24c;
  ushort *local_248;
  uint local_244;
  int local_240;
  wchar_t *local_23c;
  uint local_238 [6];
  undefined local_220 [532];
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_260 = 0x20a0000;
  local_24c = 0;
  puVar8 = local_238;
  for (iVar5 = 6; iVar5 != 0; iVar5 = iVar5 + -1) {
    *puVar8 = 0;
    puVar8 = puVar8 + 1;
  }
  local_240 = 0;
  local_23c = (wchar_t *)0x0;
  local_25c = local_220;
  local_244 = 0;
  local_248 = param_1;
  if (((param_1 == (ushort *)0x0) || (param_2 == 0)) || (param_3 == (undefined4 *)0x0))
  goto LAB_6b85f557;
  uVar9 = RtlAppendUnicodeStringToString(&local_260,param_2);
  param_2 = (int)((ulonglong)uVar9 >> 0x20);
  if ((int)uVar9 < 0) goto LAB_6b85f557;
  uVar9 = RtlAppendUnicodeToString(&local_260,L"\\inifile.upd");
  param_2 = (int)((ulonglong)uVar9 >> 0x20);
  if ((int)uVar9 < 0) goto LAB_6b85f557;
  local_280 = &local_260;
  local_288 = 0x18;
  local_284 = 0;
  local_27c = 0x40;
  local_278 = 0;
  local_274 = 0;
  local_254[0] = 0;
  uVar9 = NtCreateFile(&local_240,0x100083,&local_288,local_254,0,0x80,2,3,0x60,0,0);
  param_2 = (int)((ulonglong)uVar9 >> 0x20);
  uVar4 = local_258;
  if (-1 < (int)uVar9) {
    uVar9 = NtQueryInformationFile(local_240,local_254,local_238,0x18,5);
    param_2 = (int)((ulonglong)uVar9 >> 0x20);
    uVar4 = local_258;
    if (-1 < (int)(-(uint)((uint)uVar9 != 0x80000005) & (uint)uVar9)) {
      local_244 = local_238[2];
      uVar1 = local_238[2] + 8;
      if ((local_238[2] < uVar1) &&
         (local_258 = local_238[2] + 0x1008, uVar4 = uVar1, local_244 = uVar1, uVar1 < local_258)) {
        uVar9 = NtAllocateVirtualMemory(0xffffffff,&local_23c,0,&local_258,0x2000,4);
        param_2 = (int)((ulonglong)uVar9 >> 0x20);
        uVar4 = local_258;
        if (-1 < (int)uVar9) {
          uVar10 = NtAllocateVirtualMemory(0xffffffff,&local_23c,0,&local_244,0x1000,4);
          param_2 = (int)(uVar10 >> 0x20);
          uVar4 = local_258;
          if (-1 < (int)uVar10) {
            if (local_238[2] != 0) {
              uVar11 = NtReadFile(local_240,0,0,0,local_254,local_23c,local_238[2],0,0);
              if ((int)uVar11 == 0x103) {
                uVar11 = NtWaitForSingleObject(local_240,0,0);
              }
              param_2 = (int)(uVar11 >> 0x20);
              uVar10 = uVar11 & 0xffffffff00000000 | (ulonglong)local_254[0];
              uVar4 = local_258;
              if ((int)uVar11 < 0) goto LAB_6b85f51a;
            }
            param_2 = (int)(uVar10 >> 0x20);
            uVar4 = local_258;
            if (-1 < (int)uVar10) {
              pwVar7 = (wchar_t *)((int)local_23c + local_238[2]);
              _Str1 = local_23c;
              if (local_23c < pwVar7) {
                do {
                  param_2 = _wcsicmp(_Str1,*(wchar_t **)(local_248 + 2));
                  if (-1 < param_2) break;
                  pwVar6 = _Str1;
                  do {
                    wVar2 = *pwVar6;
                    pwVar6 = pwVar6 + 1;
                  } while (wVar2 != (wchar_t)local_24c);
                  _Str1 = _Str1 + ((int)pwVar6 - (int)(_Str1 + 1) >> 1) + 5;
                } while (_Str1 < pwVar7);
                if ((pwVar7 <= _Str1) || (param_2 != 0)) goto LAB_6b85f3c6;
                pwVar6 = _Str1;
                do {
                  wVar2 = *pwVar6;
                  pwVar6 = pwVar6 + 1;
                } while (wVar2 != L'\0');
                iVar5 = (int)pwVar6 - (int)(_Str1 + 1) >> 1;
                *(undefined4 *)(_Str1 + iVar5 + 1) = *param_3;
                *(undefined4 *)(_Str1 + iVar5 + 3) = param_3[1];
LAB_6b85f46c:
                local_268 = 0;
                local_264 = 0;
                NtSetInformationFile(local_240,local_254,&local_268,8,0xe);
                uVar9 = NtWriteFile(local_240,0,0,0,local_254,local_23c,
                                    (int)pwVar7 + (1 - (int)local_23c),0,0);
                if ((int)uVar9 == 0x103) {
                  uVar9 = NtWaitForSingleObject(local_240,0,0);
                }
                param_2 = (int)((ulonglong)uVar9 >> 0x20);
                uVar4 = local_258;
                if ((-1 < (int)uVar9) && (-1 < (int)local_254[0])) {
                  local_270 = (int)pwVar7 - (int)local_23c;
                  local_26c = 0;
                  NtSetInformationFile(local_240,local_254,&local_270,8,0x14);
                  param_2 = extraout_EDX;
                  uVar4 = local_258;
                }
              }
              else {
LAB_6b85f3c6:
                local_24c = *local_248 + 10;
                uVar4 = local_258;
                if (local_244 <= local_24c + local_244) {
                  local_244 = local_24c + local_244;
                  uVar9 = NtAllocateVirtualMemory(0xffffffff,&local_23c,0,&local_244,0x1000,4);
                  uVar1 = local_24c;
                  param_2 = (int)((ulonglong)uVar9 >> 0x20);
                  uVar4 = local_258;
                  if (-1 < (int)uVar9) {
                    if (_Str1 < pwVar7) {
                      memmove((void *)((int)_Str1 + (local_24c & 0xfffffffe)),_Str1,
                              (int)pwVar7 - (int)_Str1);
                    }
                    pwVar7 = (wchar_t *)((int)pwVar7 + uVar1);
                    FUN_6b81fb91(_Str1,uVar1 - 8,*(int *)(local_248 + 2));
                    uVar3 = *local_248;
                    *(undefined4 *)((int)_Str1 + (uVar3 + 2 & 0xfffffffe)) = *param_3;
                    *(undefined4 *)((int)_Str1 + (uVar3 + 2 & 0xfffffffe) + 4) = param_3[1];
                    goto LAB_6b85f46c;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
LAB_6b85f51a:
  local_258 = uVar4;
  if (local_23c != (wchar_t *)0x0) {
    NtFreeVirtualMemory(0xffffffff,&local_23c,&local_258,0x8000);
    param_2 = extraout_EDX_00;
  }
  if (local_240 != 0) {
    NtClose(local_240);
    param_2 = extraout_EDX_01;
  }
LAB_6b85f557:
  FUN_6b8224af(local_c ^ (uint)&stack0xfffffffc,param_2);
  return;
}



undefined4 TermsrvRestoreKey(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  code *pcVar1;
  undefined4 uVar2;
  
                    // 0x5f570  1438  TermsrvRestoreKey
  pcVar1 = DAT_6b8b08ec;
  if (DAT_6b8b08ec == (code *)0x0) {
    uVar2 = 0;
  }
  else {
    _guard_check_icall();
    uVar2 = (*pcVar1)(param_1,param_2,param_3);
  }
  return uVar2;
}



undefined4 TermsrvSetKeySecurity(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  code *pcVar1;
  undefined4 uVar2;
  
                    // 0x5f5b0  1439  TermsrvSetKeySecurity
  pcVar1 = DAT_6b8b08f0;
  if (DAT_6b8b08f0 == (code *)0x0) {
    uVar2 = 0;
  }
  else {
    _guard_check_icall();
    uVar2 = (*pcVar1)(param_1,param_2,param_3);
  }
  return uVar2;
}



DWORD_PTR SetThreadAffinityMask(HANDLE hThread,DWORD_PTR dwThreadAffinityMask)

{
  int iVar1;
  DWORD_PTR DVar2;
  undefined local_24 [16];
  DWORD_PTR local_14;
  DWORD_PTR local_8;
  
                    // 0x5f5f0  1369  SetThreadAffinityMask
  iVar1 = NtQueryInformationThread(hThread,0,local_24,0x1c,0);
  DVar2 = 0;
  if (-1 < iVar1) {
    local_8 = dwThreadAffinityMask;
    iVar1 = NtSetInformationThread(hThread,4,&local_8,4);
    if ((-1 < iVar1) && (TpCaptureCaller(2), DVar2 = local_14, local_14 != 0)) {
      return local_14;
    }
  }
  BaseSetLastNTError(iVar1);
  return DVar2;
}



BOOLEAN Wow64EnableWow64FsRedirection(BOOLEAN Wow64FsEnableRedirection)

{
  int iVar1;
  undefined3 in_stack_00000005;
  
                    // 0x5f660  1543  Wow64EnableWow64FsRedirection
  iVar1 = RtlWow64EnableFsRedirection(_Wow64FsEnableRedirection);
  if (-1 >= iVar1) {
    BaseSetLastNTError(iVar1);
  }
  return -1 < iVar1;
}



HFILE _lcreat(LPCSTR lpPathName,int iAttribute)

{
  HANDLE pvVar1;
  
                    // 0x5f690  1580  _lcreat
  RtlSetLastWin32Error(0);
  pvVar1 = CreateFileA(lpPathName,0xc0000000,3,(LPSECURITY_ATTRIBUTES)0x0,2,iAttribute & 0x5affb7,
                       (HANDLE)0x0);
  return (HFILE)pvVar1;
}



HFILE _lopen(LPCSTR lpPathName,int iReadWrite)

{
  byte bVar1;
  undefined3 extraout_var;
  DWORD dwDesiredAccess;
  LPSECURITY_ATTRIBUTES lpSecurityAttributes;
  DWORD dwCreationDisposition;
  DWORD dwFlagsAndAttributes;
  HANDLE pvVar2;
  
                    // 0x5f6d0  1582  _lopen
  RtlSetLastWin32Error(0);
  pvVar2 = (HANDLE)0x0;
  dwFlagsAndAttributes = 0;
  dwCreationDisposition = 3;
  lpSecurityAttributes = (LPSECURITY_ATTRIBUTES)0x0;
  bVar1 = FUN_6b85860b(iReadWrite);
  pvVar2 = CreateFileA(lpPathName,dwDesiredAccess,CONCAT31(extraout_var,bVar1),lpSecurityAttributes,
                       dwCreationDisposition,dwFlagsAndAttributes,pvVar2);
  return (HFILE)pvVar2;
}



long _hwrite(HFILE hFile,LPCCH lpBuffer,long lBytes)

{
  int iVar1;
  DWORD local_8;
  
                    // 0x5f720  1578  _hwrite
                    // 0x5f720  1584  _lwrite
  if (lBytes == 0) {
    local_8 = 0;
    iVar1 = SetEndOfFile((HANDLE)hFile);
  }
  else {
    iVar1 = WriteFile((HANDLE)hFile,lpBuffer,lBytes,&local_8,(LPOVERLAPPED)0x0);
  }
  if (iVar1 == 0) {
    local_8 = 0xffffffff;
  }
  return local_8;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

LPWSTR lstrcatW(LPWSTR lpString1,LPCWSTR lpString2)

{
  short *psVar1;
  WCHAR WVar2;
  uint uVar3;
  LPCWSTR pWVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  undefined4 *in_FS_OFFSET;
  undefined4 local_14;
  
                    // 0x5f770  1587  lstrcatW
  pWVar4 = lpString2;
  do {
    WVar2 = *pWVar4;
    pWVar4 = pWVar4 + 1;
  } while (WVar2 != L'\0');
  puVar6 = (undefined4 *)(lpString1 + -1);
  do {
    psVar1 = (short *)((int)puVar6 + 2);
    puVar6 = (undefined4 *)((int)puVar6 + 2);
  } while (*psVar1 != 0);
  puVar5 = (undefined4 *)lpString2;
  for (uVar3 = (uint)((int)pWVar4 - (int)lpString2) >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
    *puVar6 = *puVar5;
    puVar5 = puVar5 + 1;
    puVar6 = puVar6 + 1;
  }
  for (uVar3 = (int)pWVar4 - (int)lpString2 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
    *(undefined *)puVar6 = *(undefined *)puVar5;
    puVar5 = (undefined4 *)((int)puVar5 + 1);
    puVar6 = (undefined4 *)((int)puVar6 + 1);
  }
  *in_FS_OFFSET = local_14;
  return lpString1;
}



int __fastcall FUN_6b85f7f2(char *param_1,char *param_2)

{
  int iVar1;
  
  iVar1 = CompareStringA(0x400,0x40000001,param_1,-1,param_2,-1);
  if ((iVar1 != 0) || (iVar1 = CompareStringA(0x800,0x40000001,param_1,-1,param_2,-1), iVar1 != 0))
  {
    return iVar1 + -2;
  }
  if (param_1 == (char *)0x0) {
    return -(uint)(param_2 != (char *)0x0);
  }
  if (param_2 != (char *)0x0) {
    iVar1 = _stricmp(param_1,param_2);
    return iVar1;
  }
  return 1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

LPWSTR lstrcpyW(LPWSTR lpString1,LPCWSTR lpString2)

{
  WCHAR WVar1;
  int iVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 local_14;
  
                    // 0x5f860  1596  lstrcpyW
  iVar2 = (int)lpString1 - (int)lpString2;
  do {
    WVar1 = *lpString2;
    *(WCHAR *)(iVar2 + (int)lpString2) = WVar1;
    lpString2 = lpString2 + 1;
  } while (WVar1 != L'\0');
  *in_FS_OFFSET = local_14;
  return lpString1;
}



MMRESULT timeGetDevCaps(LPTIMECAPS ptc,UINT cbtc)

{
  BOOL BVar1;
  MMRESULT MVar2;
  
                    // 0x5f8d0  1605  timeGetDevCaps
  BVar1 = InitOnceExecuteOnce(&InitOnce_6b8b08c0,InitFn_6b814d50,(PVOID)0x0,(LPVOID *)0x0);
  if (((BVar1 == 0) || (cbtc < 8)) || (ptc == (LPTIMECAPS)0x0)) {
    MVar2 = 0x61;
  }
  else {
    ptc->wPeriodMin = DAT_6b8b0738;
    MVar2 = 0;
    ptc->wPeriodMax = 1000000;
  }
  return MVar2;
}



MMRESULT timeGetSystemTime(LPMMTIME pmmt,UINT cbmmt)

{
  DWORD DVar1;
  MMRESULT MVar2;
  
                    // 0x5f920  1606  timeGetSystemTime
  if ((cbmmt < 0xc) || (pmmt == (LPMMTIME)0x0)) {
    MVar2 = 0x81;
  }
  else {
    DVar1 = timeGetTime();
    *(DWORD *)&pmmt->u = DVar1;
    MVar2 = 0;
    pmmt->wType = 1;
  }
  return MVar2;
}



void __fastcall FUN_6b85f94f(undefined4 param_1,undefined4 param_2,PVOID *param_3)

{
  int iVar1;
  LSTATUS LVar2;
  void *_Dst;
  undefined4 extraout_EDX;
  undefined4 uVar3;
  int in_FS_OFFSET;
  undefined8 uVar4;
  undefined4 local_480;
  int local_47c;
  undefined4 local_478;
  int local_474;
  undefined4 local_470;
  int local_46c;
  DWORD local_468;
  undefined4 local_464 [19];
  WCHAR local_418 [520];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_470 = 0;
  local_46c = 0;
  local_480 = 0;
  local_47c = 0;
  local_478 = 0;
  local_474 = 0;
  local_418[0] = L'\0';
  uVar4 = NtQueryInformationToken(0xfffffffa,1,local_464,0x4c,&local_468);
  uVar3 = (undefined4)((ulonglong)uVar4 >> 0x20);
  if (-1 < (int)uVar4) {
    uVar4 = RtlConvertSidToUnicodeString(&local_470,local_464[0],1);
    uVar3 = (undefined4)((ulonglong)uVar4 >> 0x20);
    if (-1 < (int)uVar4) {
      iVar1 = FUN_6b83282b(local_418,0x208,local_46c);
      if ((((-1 < iVar1) &&
           (iVar1 = FUN_6b83282b(local_418,0x208,
                                 (int)
                                 L"\\Software\\Classes\\Local Settings\\Software\\Microsoft\\Windows\\CurrentVersion\\AppContainer\\Mappings\\"
                                ), -1 < iVar1)) &&
          (iVar1 = RtlConvertSidToUnicodeString(&local_478,param_2,1), -1 < iVar1)) &&
         (((iVar1 = FUN_6b83282b(local_418,0x208,local_474), -1 < iVar1 &&
           (iVar1 = FUN_6b83282b(local_418,0x208,(int)L"\\Children\\"), -1 < iVar1)) &&
          ((iVar1 = RtlConvertSidToUnicodeString(&local_480,param_1,1), -1 < iVar1 &&
           (iVar1 = FUN_6b83282b(local_418,0x208,local_47c), -1 < iVar1)))))) {
        local_468 = 0;
        LVar2 = RegGetValueW((HKEY)0x80000003,local_418,L"ParentMoniker",2,(LPDWORD)0x0,(PVOID)0x0,
                             &local_468);
        if (LVar2 == 0) {
          _Dst = (void *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,
                                         local_468 * 2);
          *param_3 = _Dst;
          if (_Dst != (void *)0x0) {
            memset(_Dst,0,local_468 * 2);
            RegGetValueW((HKEY)0x80000003,local_418,L"ParentMoniker",2,(LPDWORD)0x0,*param_3,
                         &local_468);
          }
        }
      }
      RtlFreeUnicodeString(&local_470);
      RtlFreeUnicodeString(&local_478);
      RtlFreeUnicodeString(&local_480);
      uVar3 = extraout_EDX;
    }
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar3);
  return;
}



void __fastcall FUN_6b85fb90(short *param_1,uint param_2,int param_3)

{
  int iVar1;
  short *psVar2;
  uint uVar3;
  short *local_8;
  
  uVar3 = param_2 >> 1;
  iVar1 = (-(uint)(uVar3 != 0) & 0x3ffffff3) + 0xc000000d;
  local_8 = param_1;
  if (uVar3 == 0) {
    psVar2 = (short *)0x0;
  }
  else {
    iVar1 = FUN_6b83290d(param_1,uVar3,(int *)&local_8);
    psVar2 = local_8;
  }
  if (-1 < iVar1) {
    FUN_6b8328bd(param_1 + (int)psVar2,uVar3 - (int)psVar2,psVar2,param_3);
  }
  return;
}



int __fastcall FUN_6b85fbdf(short *param_1,uint param_2,int param_3)

{
  int iVar1;
  uint uVar2;
  
  uVar2 = param_2 >> 1;
  iVar1 = (-(uint)(uVar2 != 0) & 0x3ffffff3) + 0xc000000d;
  if (uVar2 != 0) {
    iVar1 = FUN_6b8328bd(param_1,uVar2,param_1,param_3);
  }
  return iVar1;
}



void __fastcall FUN_6b85fc08(PSID param_1,wchar_t *param_2,int *param_3)

{
  wchar_t wVar1;
  short *psVar2;
  BOOL BVar3;
  int iVar4;
  uint uVar5;
  wchar_t *pwVar6;
  wchar_t *pwVar7;
  wchar_t *pwVar8;
  wchar_t *extraout_EDX;
  undefined4 extraout_EDX_00;
  uint extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  wchar_t *extraout_EDX_04;
  wchar_t *extraout_EDX_05;
  wchar_t *extraout_EDX_06;
  wchar_t *extraout_EDX_07;
  wchar_t *extraout_EDX_08;
  wchar_t *extraout_EDX_09;
  wchar_t *extraout_EDX_10;
  short *psVar9;
  uint uVar10;
  int in_FS_OFFSET;
  bool bVar11;
  undefined8 uVar12;
  ulonglong uVar13;
  ulonglong uVar14;
  undefined local_a8 [8];
  undefined local_a0 [8];
  undefined local_98 [8];
  undefined local_90 [8];
  PSID local_88;
  int *local_84;
  int local_80;
  undefined4 local_7c;
  int local_78;
  short *local_74;
  int local_70;
  int local_6c;
  wchar_t *local_68;
  wchar_t *local_64;
  wchar_t *local_60;
  int local_5c;
  wchar_t *local_58;
  int local_54;
  PSID local_50 [18];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_84 = param_3;
  psVar9 = (short *)0x0;
  local_78 = 0;
  local_64 = (wchar_t *)0x0;
  local_58 = (wchar_t *)0x0;
  local_5c = 0;
  local_54 = 0;
  local_74 = (short *)0x0;
  local_68 = param_2;
  memset(local_50,0,0x48);
  local_6c = 0;
  local_80 = 0;
  *local_84 = 0;
  local_70 = 0;
  local_60 = (wchar_t *)0x0;
  uVar12 = NtQueryInformationToken(0xfffffffa,0x1d,&local_78,4,&local_7c);
  pwVar7 = (wchar_t *)((ulonglong)uVar12 >> 0x20);
  if ((int)uVar12 < 0) goto LAB_6b8601fb;
  if (local_78 == 0) {
LAB_6b85fce3:
    uVar12 = AppContainerLookupMoniker(param_1,&local_58);
    pwVar7 = (wchar_t *)((ulonglong)uVar12 >> 0x20);
    if ((int)uVar12 < 0) goto LAB_6b8601fb;
    uVar12 = RtlCreateEnvironmentEx(param_2,&local_54,0);
    if (((-1 < (int)uVar12) &&
        (uVar12 = RtlGetAppContainerSidType(param_1,&local_80), -1 < (int)uVar12)) &&
       (uVar12 = RtlQueryEnvironmentVariable(local_54,L"LOCALAPPDATA",0xc,0,0,&local_5c),
       (int)uVar12 == -0x3fffffdd)) {
      uVar13 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_5c * 2)
      ;
      pwVar7 = (wchar_t *)uVar13;
      if (pwVar7 == (wchar_t *)0x0) {
LAB_6b85fd6a:
        local_64 = (wchar_t *)uVar13;
        uVar12 = CONCAT44((int)(uVar13 >> 0x20),0xc0000017);
      }
      else {
        local_64 = pwVar7;
        memset(pwVar7,0,local_5c * 2);
        uVar12 = RtlQueryEnvironmentVariable(local_54,L"LOCALAPPDATA",0xc,pwVar7,local_5c,&local_5c)
        ;
        if (-1 < (int)uVar12) {
          if (local_80 == 2) {
            pwVar7 = local_58;
            do {
              wVar1 = *pwVar7;
              pwVar7 = pwVar7 + 1;
            } while (wVar1 != L'\0');
            uVar10 = (local_5c + ((int)pwVar7 - (int)(local_58 + 1) >> 1)) * 2 + 0x20;
            uVar14 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,uVar10)
            ;
            uVar13 = uVar14 & 0xffffffff00000000 | ZEXT48(local_64);
            psVar9 = (short *)uVar14;
            if (psVar9 == (short *)0x0) goto LAB_6b85fd6a;
            iVar4 = FUN_6b85fbdf(psVar9,uVar10,(int)local_64);
            uVar12 = CONCAT44(extraout_EDX_00,iVar4);
            if (((iVar4 < 0) ||
                (uVar12 = FUN_6b85fb90(psVar9,uVar10,(int)L"\\Packages\\"), (int)uVar12 < 0)) ||
               (uVar12 = FUN_6b85fb90(psVar9,uVar10,(int)local_58), (int)uVar12 < 0))
            goto LAB_6b860145;
            pwVar7 = L"\\AC";
LAB_6b86002e:
            uVar12 = FUN_6b85fb90(psVar9,uVar10,(int)pwVar7);
            if (-1 < (int)uVar12) {
              RtlInitUnicodeString(local_a0,psVar9);
              RtlInitUnicodeString(local_a8,L"LOCALAPPDATA");
              uVar12 = RtlSetEnvironmentVariable(&local_54,local_a8,local_a0);
              if (-1 < (int)uVar12) {
                uVar10 = uVar10 + 0xe;
                uVar14 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,
                                         uVar10);
                uVar13 = uVar14 & 0xffffffff00000000 | ZEXT48(local_64);
                local_74 = (short *)uVar14;
                if (local_74 == (short *)0x0) goto LAB_6b85fd6a;
                iVar4 = FUN_6b85fbdf(local_74,uVar10,(int)psVar9);
                psVar2 = local_74;
                uVar12 = CONCAT44(extraout_EDX_03,iVar4);
                if ((-1 < iVar4) &&
                   (uVar12 = FUN_6b85fb90(local_74,uVar10,(int)L"\\Temp"), -1 < (int)uVar12)) {
                  RtlInitUnicodeString(local_98,psVar2);
                  RtlInitUnicodeString(local_90,L"TEMP");
                  uVar12 = RtlSetEnvironmentVariable(&local_54,local_90,local_98);
                  if (-1 < (int)uVar12) {
                    RtlInitUnicodeString(local_90,&DAT_6b8873bc);
                    uVar12 = RtlSetEnvironmentVariable(&local_54,local_90,local_98);
                    if (-1 < (int)uVar12) {
                      *local_84 = local_54;
                    }
                  }
                }
              }
            }
          }
          else {
            uVar12 = RtlGetAppContainerParent(param_1,&local_70);
            if ((-1 < (int)uVar12) &&
               (uVar12 = FUN_6b85f94f(param_1,local_70,&local_60), pwVar7 = local_60,
               -1 < (int)uVar12)) {
              local_68 = wcsstr(local_64,local_60);
              if (local_6c == 2) {
                uVar10 = extraout_EDX_01;
                if (local_68 != (wchar_t *)0x0) {
                  pwVar6 = pwVar7 + 1;
                  do {
                    wVar1 = *pwVar7;
                    pwVar7 = pwVar7 + 1;
                  } while (wVar1 != L'\0');
                  pwVar8 = L"\\AC";
                  pwVar7 = local_68 + ((int)pwVar7 - (int)pwVar6 >> 1);
                  do {
                    wVar1 = *pwVar7;
                    uVar10 = (uint)(ushort)wVar1;
                    bVar11 = (ushort)wVar1 < (ushort)*pwVar8;
                    if (wVar1 != *pwVar8) {
LAB_6b85fecb:
                      uVar5 = -(uint)bVar11 | 1;
                      goto LAB_6b85fed0;
                    }
                    if (wVar1 == L'\0') break;
                    wVar1 = pwVar7[1];
                    uVar10 = (uint)(ushort)wVar1;
                    bVar11 = (ushort)wVar1 < (ushort)pwVar8[1];
                    if (wVar1 != pwVar8[1]) goto LAB_6b85fecb;
                    pwVar7 = pwVar7 + 2;
                    pwVar8 = pwVar8 + 2;
                  } while (wVar1 != L'\0');
                  uVar5 = 0;
LAB_6b85fed0:
                  if (uVar5 == 0) goto LAB_6b85ff57;
                }
                uVar12 = CONCAT44(uVar10,0xc000000d);
              }
              else {
                if ((local_6c == 1) && (local_68 != (wchar_t *)0x0)) {
                  pwVar7 = local_60;
                  do {
                    wVar1 = *pwVar7;
                    pwVar7 = pwVar7 + 1;
                  } while (wVar1 != L'\0');
                  pwVar7 = local_68 + ((int)pwVar7 - (int)(local_60 + 1) >> 1);
                  pwVar6 = wcsstr(pwVar7,L"\\AC\\#!");
                  if (pwVar7 == pwVar6) {
                    pwVar7 = pwVar7 + 6;
                    pwVar6 = local_58;
                    do {
                      wVar1 = *pwVar7;
                      bVar11 = (ushort)wVar1 < (ushort)*pwVar6;
                      if (wVar1 != *pwVar6) {
LAB_6b85ff42:
                        uVar10 = -(uint)bVar11 | 1;
                        goto LAB_6b85ff47;
                      }
                      if (wVar1 == L'\0') break;
                      wVar1 = pwVar7[1];
                      bVar11 = (ushort)wVar1 < (ushort)pwVar6[1];
                      if (wVar1 != pwVar6[1]) goto LAB_6b85ff42;
                      pwVar7 = pwVar7 + 2;
                      pwVar6 = pwVar6 + 2;
                    } while (wVar1 != L'\0');
                    uVar10 = 0;
LAB_6b85ff47:
                    pwVar7 = local_58;
                    if (uVar10 == 0) goto LAB_6b8601fb;
                  }
                }
LAB_6b85ff57:
                iVar4 = local_5c * 2;
                if (local_68 == (wchar_t *)0x0) {
                  pwVar7 = local_60;
                  do {
                    wVar1 = *pwVar7;
                    pwVar7 = pwVar7 + 1;
                  } while (wVar1 != L'\0');
                  iVar4 = iVar4 + ((int)pwVar7 - (int)(local_60 + 1) >> 1) * 2 + 0x1e;
                }
                pwVar7 = local_58;
                do {
                  wVar1 = *pwVar7;
                  pwVar7 = pwVar7 + 1;
                } while (wVar1 != L'\0');
                uVar10 = iVar4 + (((int)pwVar7 - (int)(local_58 + 1) >> 1) + 5) * 2;
                uVar14 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,
                                         uVar10);
                uVar13 = uVar14 & 0xffffffff00000000 | ZEXT48(local_64);
                psVar9 = (short *)uVar14;
                if (psVar9 == (short *)0x0) goto LAB_6b85fd6a;
                iVar4 = FUN_6b85fbdf(psVar9,uVar10,(int)local_64);
                uVar12 = CONCAT44(extraout_EDX_02,iVar4);
                if ((-1 < iVar4) &&
                   (((local_68 != (wchar_t *)0x0 ||
                     (((uVar12 = FUN_6b85fb90(psVar9,uVar10,(int)L"\\Packages\\"), -1 < (int)uVar12
                       && (uVar12 = FUN_6b85fb90(psVar9,uVar10,(int)local_60), -1 < (int)uVar12)) &&
                      (uVar12 = FUN_6b85fb90(psVar9,uVar10,(int)&DAT_6b889804), -1 < (int)uVar12))))
                    && (uVar12 = FUN_6b85fb90(psVar9,uVar10,(int)&DAT_6b88981c), pwVar7 = local_58,
                       -1 < (int)uVar12)))) goto LAB_6b86002e;
              }
            }
          }
        }
      }
    }
  }
  else {
    local_7c = 0x48;
    uVar12 = NtQueryInformationToken(0xfffffffa,0x1f,local_50,0x48,&local_7c);
    pwVar7 = (wchar_t *)((ulonglong)uVar12 >> 0x20);
    if ((int)uVar12 < 0) goto LAB_6b8601fb;
    local_88 = local_50[0];
    uVar12 = RtlGetAppContainerSidType(local_50[0],&local_6c);
    if (-1 < (int)uVar12) {
      param_2 = local_68;
      if ((local_6c == 2) &&
         (BVar3 = EqualSid(local_88,param_1), pwVar7 = extraout_EDX, param_2 = local_68, BVar3 != 0)
         ) goto LAB_6b8601fb;
      goto LAB_6b85fce3;
    }
  }
LAB_6b860145:
  pwVar7 = (wchar_t *)((ulonglong)uVar12 >> 0x20);
  if (local_58 != (wchar_t *)0x0) {
    AppContainerFreeMemory(local_58);
    pwVar7 = extraout_EDX_04;
  }
  if (local_64 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_64);
    pwVar7 = extraout_EDX_05;
  }
  if (local_70 != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_70);
    pwVar7 = extraout_EDX_06;
  }
  if (local_60 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_60);
    pwVar7 = extraout_EDX_07;
  }
  if (psVar9 != (short *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,psVar9);
    pwVar7 = extraout_EDX_08;
  }
  if (local_74 != (short *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_74);
    pwVar7 = extraout_EDX_09;
  }
  if (((int)uVar12 < 0) && (local_54 != 0)) {
    RtlDestroyEnvironment(local_54);
    pwVar7 = extraout_EDX_10;
  }
LAB_6b8601fb:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,pwVar7);
  return;
}



undefined2 FUN_6b86020c(void)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int in_FS_OFFSET;
  
  iVar2 = *(int *)(in_FS_OFFSET + 0x18);
  if (*(int *)(iVar2 + 0xfdc) < 0) {
    iVar2 = iVar2 + *(int *)(iVar2 + 0xfdc);
  }
  iVar4 = *(int *)(in_FS_OFFSET + 0x18);
  if (*(int *)(iVar4 + 0xfdc) < 0) {
    iVar4 = iVar4 + *(int *)(iVar4 + 0xfdc);
  }
  iVar3 = *(int *)(in_FS_OFFSET + 0x18);
  iVar1 = *(int *)(iVar3 + 0xfdc);
  if (iVar2 == *(int *)(iVar4 + 0x18)) {
    if (iVar1 < 0) {
      iVar3 = iVar3 + iVar1;
    }
    return *(undefined2 *)(iVar3 + 0x1d0);
  }
  if (iVar1 < 0) {
    iVar3 = iVar3 + iVar1;
  }
  return *(undefined2 *)(iVar3 + 0x2e8);
}



void __fastcall FUN_6b86025e(uint param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  int in_FS_OFFSET;
  
  uVar5 = param_1 & 0xffff;
  iVar4 = *(int *)(in_FS_OFFSET + 0x18);
  *(uint *)(*(int *)(in_FS_OFFSET + 0x18) + 0x1d0) = uVar5;
  if (*(int *)(iVar4 + 0xfdc) < 0) {
    iVar4 = iVar4 + *(int *)(iVar4 + 0xfdc);
  }
  iVar2 = *(int *)(in_FS_OFFSET + 0x18);
  if (*(int *)(iVar2 + 0xfdc) < 0) {
    iVar2 = iVar2 + *(int *)(iVar2 + 0xfdc);
  }
  iVar3 = *(int *)(in_FS_OFFSET + 0x18);
  iVar1 = *(int *)(iVar3 + 0xfdc);
  if (iVar4 == *(int *)(iVar2 + 0x18)) {
    if (iVar1 < 0) {
      iVar3 = iVar3 + iVar1;
    }
    *(uint *)(iVar3 + 0x1d0) = uVar5;
    return;
  }
  if (iVar1 < 0) {
    iVar3 = iVar3 + iVar1;
  }
  *(uint *)(iVar3 + 0x2e8) = uVar5;
  return;
}



void CloseConsoleHandle(HANDLE param_1)

{
                    // 0x602d0  139  CloseConsoleHandle
                    // WARNING: Could not recover jumptable at 0x6b8602d6. Too many branches
                    // WARNING: Treating indirect jump as call
  CloseHandle(param_1);
  return;
}



HANDLE DuplicateConsoleHandle(HANDLE param_1,DWORD param_2,BOOL param_3,DWORD param_4)

{
  HANDLE hTargetProcessHandle;
  HANDLE hSourceProcessHandle;
  BOOL BVar1;
  HANDLE *lpTargetHandle;
  HANDLE local_8;
  
                    // 0x602f0  303  DuplicateConsoleHandle
  lpTargetHandle = &local_8;
  hTargetProcessHandle = GetCurrentProcess();
  hSourceProcessHandle = GetCurrentProcess();
  BVar1 = DuplicateHandle(hSourceProcessHandle,param_1,hTargetProcessHandle,lpTargetHandle,param_2,
                          param_3,param_4);
  if (BVar1 == 0) {
    local_8 = (HANDLE)0xffffffff;
  }
  return local_8;
}



void GetConsoleInputWaitHandle(void)

{
                    // 0x60330  511  GetConsoleInputWaitHandle
  GetStdHandle(0xfffffff6);
  return;
}



void OpenConsoleW(LPCWSTR param_1,DWORD param_2,BOOL param_3,DWORD param_4)

{
  _SECURITY_ATTRIBUTES local_10;
  
                    // 0x60340  1026  OpenConsoleW
  local_10.bInheritHandle = param_3;
  local_10.lpSecurityDescriptor = (LPVOID)0x0;
  local_10.nLength = 0xc;
  CreateFileW(param_1,param_2,param_4,&local_10,3,0,(HANDLE)0x0);
  return;
}



undefined4 VerifyConsoleIoHandle(void)

{
                    // 0x60380  1480  VerifyConsoleIoHandle
  return 0;
}



undefined4 ConsoleMenuControl(int param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined4 local_60;
  undefined4 local_5c;
  undefined4 local_58;
  
                    // 0x60390  163  ConsoleMenuControl
  local_60 = param_2;
  local_5c = param_3;
  iVar1 = FUN_6b860e1c(param_1,local_68,0x300000b,0x10);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
    local_58 = 0;
  }
  return local_58;
}



bool GetConsoleHardwareState(int param_1,undefined4 *param_2,undefined4 *param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined4 local_60;
  undefined4 local_5c;
  
                    // 0x603e0  507  GetConsoleHardwareState
  iVar1 = FUN_6b860e1c(param_1,local_68,0x300000f,8);
  if (-1 < iVar1) {
    *param_2 = local_60;
    *param_3 = local_5c;
  }
  else {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return -1 < iVar1;
}



undefined4
RegisterConsoleVDM(int param_1,int param_2,int param_3,int param_4,undefined4 param_5,
                  undefined4 *param_6,undefined4 *param_7,undefined4 param_8,undefined4 *param_9)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  int local_60;
  int local_58;
  int local_54;
  int local_50;
  int local_4c;
  int local_48;
  int local_44;
  undefined4 local_40;
  undefined4 local_38;
  undefined4 local_30;
  
                    // 0x60440  1195  RegisterConsoleVDM
  local_60 = param_1;
  if (param_1 != 0) {
    local_54 = param_2 >> 0x1f;
    local_58 = param_2;
    local_4c = param_3 >> 0x1f;
    local_50 = param_3;
    local_44 = param_4 >> 0x1f;
    local_48 = param_4;
  }
  iVar1 = FUN_6b860e1c(0,local_68,0x300000e,0x38);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
    uVar2 = 0;
  }
  else {
    if (param_1 != 0) {
      *param_6 = local_40;
      *param_7 = local_38;
      *param_9 = local_30;
    }
    uVar2 = 1;
  }
  return uVar2;
}



bool SetConsoleCursor(int param_1,int param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  int local_60;
  int local_5c;
  
                    // 0x604e0  1262  SetConsoleCursor
  local_5c = param_2 >> 0x1f;
  local_60 = param_2;
  iVar1 = FUN_6b860e1c(param_1,local_68,0x3000009,8);
  if (-1 >= iVar1) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return -1 < iVar1;
}



bool SetConsoleHardwareState(int param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined4 local_60;
  undefined4 local_5c;
  
                    // 0x60530  1268  SetConsoleHardwareState
  local_60 = param_2;
  local_5c = param_3;
  iVar1 = FUN_6b860e1c(param_1,local_68,0x3000010,8);
  if (-1 >= iVar1) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return -1 < iVar1;
}



bool SetConsoleKeyShortcuts(int param_1,undefined param_2,undefined4 param_3,int param_4)

{
  int iVar1;
  undefined4 uVar2;
  int in_FS_OFFSET;
  int local_70;
  undefined4 local_6c;
  undefined4 local_68 [2];
  undefined local_60;
  undefined local_5f;
  
                    // 0x60580  1273  SetConsoleKeyShortcuts
  local_60 = param_1 != 0;
  local_5f = param_2;
  local_6c = param_3;
  local_70 = param_4 << 2;
  iVar1 = FUN_6b860e47(*(int *)(*(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x10) + 0x10),0,local_68,
                       0x300001c,2,(int)&local_70,1,0,0);
  if (-1 >= iVar1) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return -1 < iVar1;
}



bool SetConsoleMenuClose(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined local_60;
  
                    // 0x60600  1276  SetConsoleMenuClose
  local_60 = param_1 != 0;
  iVar1 = FUN_6b860e1c(0,local_68,0x300001d,1);
  if (-1 >= iVar1) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return -1 < iVar1;
}



void SetConsolePalette(int param_1,int param_2,undefined4 param_3)

{
                    // 0x60650  1283  SetConsolePalette
  FUN_6b860667(param_1,param_2,param_3);
  return;
}



bool __fastcall FUN_6b860667(int param_1,int param_2,undefined4 param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  int local_60;
  int local_5c;
  undefined4 local_58;
  
  local_5c = param_2 >> 0x1f;
  local_58 = param_3;
  local_60 = param_2;
  iVar1 = FUN_6b860e1c(param_1,local_68,0x300000c,0x10);
  if (-1 >= iVar1) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return -1 < iVar1;
}



undefined4 ShowConsoleCursor(int param_1,int param_2)

{
  undefined4 local_68 [2];
  undefined local_60;
  undefined4 local_5c;
  
                    // 0x606c0  1408  ShowConsoleCursor
  local_60 = param_2 != 0;
  FUN_6b860e1c(param_1,local_68,0x300000a,8);
  return local_5c;
}



bool WriteConsoleInputVDMA(int param_1,undefined4 param_2,int param_3,undefined4 *param_4)

{
  int iVar1;
  int in_FS_OFFSET;
  undefined4 local_70 [2];
  undefined4 local_68;
  undefined2 local_64;
  int local_c;
  undefined4 local_8;
  
                    // 0x60700  1551  WriteConsoleInputVDMA
  local_8 = param_2;
  local_c = param_3 * 0x14;
  local_64 = 0;
  iVar1 = FUN_6b860e47(*(int *)(*(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x10) + 0x10),param_1,
                       local_70,0x2000010,8,(int)&local_c,1,0,0);
  *param_4 = local_68;
  if (-1 >= iVar1) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  }
  return -1 < iVar1;
}



bool WriteConsoleInputVDMW(int param_1,undefined4 param_2,int param_3,undefined4 *param_4)

{
  int iVar1;
  int in_FS_OFFSET;
  undefined4 local_70 [2];
  undefined4 local_68;
  undefined2 local_64;
  int local_c;
  undefined4 local_8;
  
                    // 0x60770  1552  WriteConsoleInputVDMW
  local_8 = param_2;
  local_c = param_3 * 0x14;
  local_64 = 1;
  iVar1 = FUN_6b860e47(*(int *)(*(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x10) + 0x10),param_1,
                       local_70,0x2000010,8,(int)&local_c,1,0,0);
  *param_4 = local_68;
  if (-1 >= iVar1) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  }
  return -1 < iVar1;
}



bool GetConsoleCharType(int param_1,undefined4 param_2,undefined4 *param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined4 local_60;
  undefined4 local_5c;
  
                    // 0x607e0  497  GetConsoleCharType
  local_60 = param_2;
  iVar1 = FUN_6b860e1c(param_1,local_68,0x3000020,8);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  else {
    *param_3 = local_5c;
  }
  return iVar1 >= 0;
}



bool GetConsoleCursorMode(int param_1,uint *param_2,uint *param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  byte local_60;
  byte local_5f;
  
                    // 0x60840  503  GetConsoleCursorMode
  iVar1 = FUN_6b860e1c(param_1,local_68,0x3000023,2);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  else {
    *param_2 = (uint)local_60;
    *param_3 = (uint)local_5f;
  }
  return iVar1 >= 0;
}



bool GetConsoleNlsMode(int param_1,undefined4 *param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined local_60;
  undefined4 local_5c;
  
                    // 0x608a0  515  GetConsoleNlsMode
  local_60 = 0;
  iVar1 = FUN_6b860e1c(param_1,local_68,0x3000026,8);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  else {
    *param_2 = local_5c;
  }
  return iVar1 >= 0;
}



bool RegisterConsoleOS2(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined local_60;
  
                    // 0x608f0  1194  RegisterConsoleOS2
  local_60 = param_1 != 0;
  iVar1 = FUN_6b860e1c(0,local_68,0x3000024,1);
  if (-1 >= iVar1) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return -1 < iVar1;
}



bool SetConsoleCursorMode(int param_1,int param_2,int param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined local_60;
  undefined local_5f;
  
                    // 0x60940  1264  SetConsoleCursorMode
  local_60 = param_2 != 0;
  local_5f = param_3 != 0;
  iVar1 = FUN_6b860e1c(param_1,local_68,0x3000022,2);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return iVar1 >= 0;
}



undefined4 SetConsoleLocalEUDC(int param_1,undefined2 param_2,undefined4 param_3,undefined4 param_4)

{
  longlong lVar1;
  int iVar2;
  int in_FS_OFFSET;
  undefined4 uVar3;
  undefined local_70 [4];
  undefined4 local_6c;
  undefined4 local_68 [2];
  undefined2 local_60;
  undefined4 local_5e;
  
                    // 0x609a0  1274  SetConsoleLocalEUDC
  local_60 = param_2;
  local_6c = param_4;
  local_5e = param_3;
  lVar1 = ((longlong)((short)param_3 + 7) / 8 & 0xffffffffU) *
          (ulonglong)(uint)(int)(short)((uint)param_3 >> 0x10);
  iVar2 = FUN_6b850b02(local_70,(int)lVar1,(int)((ulonglong)lVar1 >> 0x20));
  if (iVar2 < 0) {
    uVar3 = 0x57;
  }
  else {
    iVar2 = FUN_6b860e47(*(int *)(*(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x10) + 0x10),param_1,
                         local_68,0x3000021,6,(int)local_70,1,0,0);
    if (-1 < iVar2) {
      return 1;
    }
    uVar3 = RtlNtStatusToDosError(iVar2);
  }
  RtlSetLastWin32Error(uVar3);
  return 0;
}



bool SetConsoleNlsMode(int param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [3];
  undefined4 local_5c;
  
                    // 0x60a40  1278  SetConsoleNlsMode
  local_5c = param_2;
  iVar1 = FUN_6b860e1c(param_1,local_68,0x3000027,8);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return iVar1 >= 0;
}



bool SetConsoleOS2OemFormat(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined local_60;
  
                    // 0x60a90  1281  SetConsoleOS2OemFormat
  local_60 = param_1 != 0;
  iVar1 = FUN_6b860e1c(0,local_68,0x3000025,1);
  if (-1 >= iVar1) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return -1 < iVar1;
}



undefined4 GetConsoleFontInfo(int param_1,undefined param_2,uint param_3,undefined4 param_4)

{
  int iVar1;
  undefined4 uVar2;
  int in_FS_OFFSET;
  undefined local_70 [4];
  undefined4 local_6c;
  undefined4 local_68 [2];
  undefined local_60;
  undefined4 local_5c;
  
                    // 0x60ae0  505  GetConsoleFontInfo
  local_60 = param_2;
  iVar1 = FUN_6b850b02(local_70,(int)((ulonglong)param_3 * 8),(int)((ulonglong)param_3 * 8 >> 0x20))
  ;
  if (iVar1 < 0) {
    RtlSetLastWin32Error(0x57);
    local_5c = 0;
  }
  else {
    local_6c = param_4;
    iVar1 = FUN_6b860e47(*(int *)(*(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x10) + 0x10),param_1,
                         local_68,0x3000002,8,0,0,(int)local_70,1);
    if (iVar1 < 0) {
      local_5c = 0;
      uVar2 = RtlNtStatusToDosError(iVar1);
      RtlSetLastWin32Error(uVar2);
    }
  }
  return local_5c;
}



void GetConsoleKeyboardLayoutNameA(short *param_1)

{
                    // 0x60b70  512  GetConsoleKeyboardLayoutNameA
  FUN_6b860ba6(param_1,9,1);
  return;
}



void GetConsoleKeyboardLayoutNameW(short *param_1)

{
                    // 0x60b90  513  GetConsoleKeyboardLayoutNameW
  FUN_6b860ba6(param_1,0x12,0);
  return;
}



undefined4 __fastcall FUN_6b860ba6(short *param_1,uint param_2,int param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined local_60 [18];
  undefined local_4e;
  
  local_4e = param_3 != 0;
  iVar1 = FUN_6b860e1c(0,local_68,0x300001e,0x14);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
    uVar2 = 0;
  }
  else {
    if (param_3 == 0) {
      FUN_6b85fbdf(param_1,param_2,(int)local_60);
    }
    else {
      FUN_6b835c38((char *)param_1,param_2,(int)local_60);
    }
    uVar2 = 1;
  }
  return uVar2;
}



undefined4 GetNumberOfConsoleFonts(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined4 local_60;
  
                    // 0x60c20  666  GetNumberOfConsoleFonts
  iVar1 = FUN_6b860e1c(0,local_68,0x3000000,4);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
    local_60 = 0;
  }
  return local_60;
}



bool SetConsoleFont(int param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined4 local_60;
  
                    // 0x60c60  1267  SetConsoleFont
  local_60 = param_2;
  iVar1 = FUN_6b860e1c(param_1,local_68,0x3000005,4);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return iVar1 >= 0;
}



bool SetConsoleIcon(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  int local_60;
  int local_5c;
  
                    // 0x60cb0  1270  SetConsoleIcon
  local_5c = param_1 >> 0x1f;
  local_60 = param_1;
  iVar1 = FUN_6b860e1c(0,local_68,0x3000006,8);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return iVar1 >= 0;
}



undefined4 SetConsoleMaximumWindowSize(void)

{
                    // 0x60d00  1275  SetConsoleMaximumWindowSize
  return 1;
}



bool InvalidateConsoleDIBits(int param_1,undefined4 *param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined4 local_60;
  undefined4 local_5c;
  
                    // 0x60d10  887  InvalidateConsoleDIBits
  local_60 = *param_2;
  local_5c = param_2[1];
  iVar1 = FUN_6b860e1c(param_1,local_68,0x3000007,8);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return iVar1 >= 0;
}



undefined4 VDMConsoleOperation(uint param_1,uint *param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  uint local_60;
  byte local_5c;
  uint local_58;
  uint local_54;
  uint local_50;
  uint uStack76;
  uint uStack72;
  uint uStack68;
  
                    // 0x60d70  1475  VDMConsoleOperation
  local_60 = param_1;
  if ((param_1 == 4) || (param_1 == 5)) {
    local_58 = *param_2;
    local_54 = param_2[1];
  }
  else if ((param_1 == 7) || (param_1 == 8)) {
    local_5c = param_2 != (uint *)0x0;
  }
  iVar1 = FUN_6b860e1c(0,local_68,0x3000008,0x20);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
    return 0;
  }
  if (param_1 != 2) {
    if (param_1 == 3) {
      *param_2 = local_50;
      param_2[1] = uStack76;
      param_2[2] = uStack72;
      param_2[3] = uStack68;
      return 1;
    }
    if (param_1 < 4) {
      return 1;
    }
    if (param_1 < 6) {
      *param_2 = local_58;
      param_2[1] = local_54;
      return 1;
    }
    if (param_1 != 6) {
      return 1;
    }
  }
  *param_2 = (uint)local_5c;
  return 1;
}



void __fastcall FUN_6b860e1c(int param_1,undefined4 *param_2,undefined4 param_3,int param_4)

{
  int in_FS_OFFSET;
  
  FUN_6b860e47(*(int *)(*(int *)(*(int *)(in_FS_OFFSET + 0x30) + 0x10) + 0x10),param_1,param_2,
               param_3,param_4,0,0,0,0);
  return;
}



void __fastcall
FUN_6b860e47(int param_1,int param_2,undefined4 *param_3,undefined4 param_4,int param_5,int param_6,
            uint param_7,int param_8,uint param_9)

{
  int iVar1;
  int *piVar2;
  undefined4 *extraout_EDX;
  uint uVar3;
  undefined auStack236 [4];
  undefined4 *local_e8;
  int local_e4;
  int local_e0;
  int local_dc;
  uint local_d8 [2];
  int local_d0;
  int local_cc;
  int local_c8;
  int local_c4;
  int local_c0;
  undefined4 *local_b8;
  int local_b4;
  int local_b0 [41];
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)auStack236;
  local_e8 = param_3;
  local_d8[0] = param_9 + 2 + param_7;
  local_e4 = param_2;
  local_dc = param_1;
  if ((local_d8[0] < 0xb) && (0 < param_1)) {
    *param_3 = param_4;
    param_3[1] = param_5;
    local_b4 = (int)param_3 >> 0x1f;
    local_c0 = param_5 + 8;
    local_b8 = param_3;
    local_e0 = param_7 * 0x10;
    local_b0[param_7 * 4 + 2] = (int)(param_3 + 2);
    local_b0[param_7 * 4 + 3] = (int)(param_3 + 2) >> 0x1f;
    local_b0[param_7 * 4] = param_5;
    uVar3 = 0;
    local_cc = param_2 >> 0x1f;
    local_c8 = param_7 + 1;
    local_c4 = param_9 + 1;
    if (param_7 != 0) {
      piVar2 = local_b0 + 2;
      do {
        piVar2[-2] = *(int *)(param_6 + uVar3 * 8);
        iVar1 = *(int *)(param_6 + 4 + uVar3 * 8);
        uVar3 = uVar3 + 1;
        *piVar2 = iVar1;
        piVar2[1] = iVar1 >> 0x1f;
        piVar2 = piVar2 + 4;
      } while (uVar3 < param_7);
    }
    uVar3 = 0;
    if (param_9 != 0) {
      piVar2 = local_b0 + param_7 * 4 + 6;
      do {
        piVar2[-2] = *(int *)(param_8 + uVar3 * 8);
        iVar1 = *(int *)(param_8 + 4 + uVar3 * 8);
        uVar3 = uVar3 + 1;
        *piVar2 = iVar1;
        piVar2[1] = iVar1 >> 0x1f;
        piVar2 = piVar2 + 4;
      } while (uVar3 < param_9);
    }
    local_d0 = param_2;
    NtDeviceIoControlFile(param_1,0,0,0,local_d8,0x500016,&local_d0,(local_d8[0] + 1) * 0x10,0,0);
    param_3 = extraout_EDX;
  }
  FUN_6b8224af(local_c ^ (uint)auStack236,param_3);
  return;
}



void FUN_6b860f8c(void)

{
  undefined4 extraout_EDX;
  undefined4 uVar1;
  undefined8 uVar2;
  undefined local_4c [8];
  undefined local_44 [8];
  undefined local_3c [4];
  undefined4 local_38;
  undefined4 local_34;
  undefined *local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined local_1c [20];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  RtlInitUnicodeString(local_4c,L"CorruptDetection");
  RtlInitUnicodeString(local_44,L"\\REGISTRY\\MACHINE\\SYSTEM\\CurrentControlSet\\Control\\WOW");
  local_30 = local_44;
  local_38 = 0x18;
  local_34 = 0;
  local_2c = 0x40;
  local_28 = 0;
  local_24 = 0;
  uVar2 = NtOpenKey(&local_20,0x20019,&local_38);
  uVar1 = (undefined4)((ulonglong)uVar2 >> 0x20);
  if (-1 < (int)uVar2) {
    NtQueryValueKey(local_20,local_4c,2,local_1c,0x14,local_3c);
    NtClose(local_20);
    uVar1 = extraout_EDX;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar1);
  return;
}



void __fastcall FUN_6b861035(char param_1)

{
  wchar_t *pwVar1;
  undefined4 extraout_EDX;
  undefined4 uVar2;
  undefined8 uVar3;
  undefined local_50 [8];
  undefined local_48 [8];
  undefined local_40 [4];
  undefined4 local_3c;
  undefined4 local_38;
  undefined *local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  char local_1d;
  undefined local_1c [20];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  pwVar1 = L"VDMDisallowed";
  if (param_1 == '\0') {
    pwVar1 = L"DisallowedPolicyDefault";
  }
  local_1d = param_1;
  RtlInitUnicodeString(local_50,pwVar1);
  pwVar1 = L"\\REGISTRY\\MACHINE\\Software\\Policies\\Microsoft\\Windows\\AppCompat";
  if (local_1d == '\0') {
    pwVar1 = L"\\REGISTRY\\MACHINE\\SYSTEM\\CurrentControlSet\\Control\\WOW";
  }
  RtlInitUnicodeString(local_48,pwVar1);
  local_34 = local_48;
  local_3c = 0x18;
  local_38 = 0;
  local_30 = 0x40;
  local_2c = 0;
  local_28 = 0;
  uVar3 = NtOpenKey(&local_24,0x20019,&local_3c);
  uVar2 = (undefined4)((ulonglong)uVar3 >> 0x20);
  if (-1 < (int)uVar3) {
    NtQueryValueKey(local_24,local_50,2,local_1c,0x14,local_40);
    NtClose(local_24);
    uVar2 = extraout_EDX;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



undefined4 FUN_6b861100(void)

{
  RtlInitializeCriticalSection(&DAT_6b8b0a10);
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __fastcall FUN_6b861110(undefined4 param_1,short **param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 extraout_ECX;
  undefined8 uVar3;
  
  RtlRunOnceExecuteOnce(&DAT_6b8b08c4,FUN_6b861100,0,0);
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_6b8b0a10);
  uVar3 = FUN_6b854228(&DAT_6b8b0068);
  if (-1 < (int)uVar3) {
    FUN_6b838f78(extraout_ECX,(int)((ulonglong)uVar3 >> 0x20),(uint *)&DAT_6b8b0068,param_2);
    uVar2 = DAT_6b8b0084;
    uVar1 = DAT_6b8b0080;
    _DAT_6b8b0068 = 0;
    DAT_6b8b0080 = 0;
    DAT_6b8b0084 = 0;
    EventUnregister((REGHANDLE)CONCAT44(uVar2,uVar1));
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_6b8b0a10);
  return;
}



void FUN_6b861190(LPCWSTR *param_1,undefined4 param_2,undefined4 *param_3)

{
  int iVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 extraout_EDX_04;
  undefined4 uVar2;
  undefined **ppuVar3;
  uint uVar4;
  uint uVar5;
  undefined *puVar6;
  int local_34;
  uint local_30;
  undefined *local_2c;
  undefined local_28 [32];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  uVar5 = 0;
  *param_3 = 0;
  iVar1 = FUN_6b861595(param_1);
  uVar2 = extraout_EDX;
  if (iVar1 != 0) {
    local_34 = 0;
    ppuVar3 = &PTR_s__data_6b880ad0;
    local_30 = 0;
    local_2c = (undefined *)0x0;
    do {
      iVar1 = FUN_6b8613cd((int)param_1,*ppuVar3,&local_34,(int *)&local_30);
      if ((-1 < iVar1) &&
         (iVar1 = FUN_6b86182d(local_34,local_30,(int)ppuVar3), uVar2 = extraout_EDX_00, iVar1 != 0)
         ) goto LAB_6b861293;
      ppuVar3 = ppuVar3 + 5;
      local_2c = local_2c + 0x14;
    } while (local_2c < (undefined *)0x14);
    iVar1 = FUN_6b861300((int)param_1,(int *)&local_2c);
    uVar2 = extraout_EDX_01;
    if (-1 < iVar1) {
      iVar1 = FUN_6b8612af((DWORD)param_1,(LONG)local_2c,local_28,&local_30);
      if (-1 < iVar1) {
        uVar4 = 0;
        local_2c = &DAT_6b880870;
        do {
          iVar1 = FUN_6b86182d((int)local_28,local_30,(int)local_2c);
          uVar2 = extraout_EDX_02;
          if (iVar1 != 0) goto LAB_6b861293;
          uVar4 = uVar4 + 0x14;
          local_2c = local_2c + 0x14;
        } while (uVar4 < 0xdc);
      }
      iVar1 = FUN_6b861378((DWORD)param_1,local_28,&local_30);
      uVar2 = extraout_EDX_03;
      if (-1 < iVar1) {
        puVar6 = &DAT_6b880950;
        do {
          iVar1 = FUN_6b86182d((int)local_28,local_30,(int)puVar6);
          uVar2 = extraout_EDX_04;
          if (iVar1 != 0) goto LAB_6b861293;
          uVar5 = uVar5 + 0x14;
          puVar6 = puVar6 + 0x14;
        } while (uVar5 < 0x28);
      }
    }
  }
LAB_6b86129d:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
LAB_6b861293:
  *param_3 = 1;
  goto LAB_6b86129d;
}



undefined4 __fastcall FUN_6b8612af(DWORD param_1,LONG param_2,LPVOID param_3,undefined4 *param_4)

{
  DWORD DVar1;
  BOOL BVar2;
  undefined4 uVar3;
  DWORD local_8;
  
  uVar3 = 0xc0000089;
  local_8 = param_1;
  DVar1 = SetFilePointer(*(HANDLE *)(param_1 + 0x20),param_2,(PLONG)0x0,0);
  if (DVar1 != 0xffffffff) {
    BVar2 = ReadFile(*(HANDLE *)(param_1 + 0x20),param_3,0x20,&local_8,(LPOVERLAPPED)0x0);
    if ((BVar2 != 0) && (local_8 == 0x20)) {
      uVar3 = 0;
      *param_4 = 0x20;
    }
  }
  return uVar3;
}



undefined4 __fastcall FUN_6b861300(int param_1,int *param_2)

{
  BOOL BVar1;
  int iVar2;
  undefined4 uVar3;
  uint uVar4;
  uint uVar5;
  uint local_18;
  uint local_14;
  int *local_10;
  int *local_c;
  
  uVar5 = 0;
  uVar3 = 0xc0000089;
  iVar2 = *(int *)(param_1 + 0x28);
  uVar4 = (uint)*(ushort *)(iVar2 + 6);
  local_c = (int *)((uint)*(ushort *)(iVar2 + 0x14) + iVar2);
  local_10 = param_2;
  BVar1 = GetFileSizeEx(*(HANDLE *)(param_1 + 0x20),(PLARGE_INTEGER)&local_18);
  if (BVar1 != 0) {
    iVar2 = 0;
    for (; uVar4 != 0; uVar4 = uVar4 - 1) {
      if (uVar5 <= (uint)local_c[0xb] && local_c[0xb] != uVar5) {
        uVar5 = local_c[0xb];
        iVar2 = local_c[10];
      }
      local_c = local_c + 10;
    }
    if ((local_14 < 0x80000000) && ((0 < (int)local_14 || (iVar2 + uVar5 + 0x40 < local_18)))) {
      uVar3 = 0;
      *local_10 = iVar2 + uVar5;
    }
  }
  return uVar3;
}



undefined4 __fastcall FUN_6b861378(DWORD param_1,LPVOID param_2,undefined4 *param_3)

{
  BOOL BVar1;
  undefined4 uVar2;
  DWORD local_8;
  
  uVar2 = 0xc0000089;
  local_8 = param_1;
  BVar1 = SetFilePointerEx(*(HANDLE *)(param_1 + 0x20),0xffffffffffffffe0,(PLARGE_INTEGER)0x0,2);
  if (BVar1 != 0) {
    BVar1 = ReadFile(*(HANDLE *)(param_1 + 0x20),param_2,0x20,&local_8,(LPOVERLAPPED)0x0);
    if (BVar1 != 0) {
      if (local_8 == 0x20) {
        uVar2 = 0;
        *param_3 = 0x20;
      }
    }
  }
  return uVar2;
}



undefined4 __fastcall FUN_6b8613cd(int param_1,char *param_2,int *param_3,int *param_4)

{
  char cVar1;
  ushort uVar2;
  int iVar3;
  char *pcVar4;
  uint uVar5;
  char *_Str1;
  
  iVar3 = *(int *)(param_1 + 0x28);
  uVar2 = *(ushort *)(iVar3 + 6);
  uVar5 = 0;
  _Str1 = (char *)(iVar3 + 0x18 + (uint)*(ushort *)(iVar3 + 0x14));
  if (uVar2 != 0) {
    do {
      pcVar4 = param_2;
      do {
        cVar1 = *pcVar4;
        pcVar4 = pcVar4 + 1;
      } while (cVar1 != '\0');
      iVar3 = strncmp(_Str1,param_2,(int)pcVar4 - (int)(param_2 + 1));
      if (iVar3 == 0) {
        uVar5 = *(uint *)(param_1 + 0x2c);
        if (uVar5 <= *(uint *)(_Str1 + 0xc)) {
          return 0xc0000089;
        }
        iVar3 = *(int *)(_Str1 + 0xc);
        *param_3 = *(int *)(param_1 + 4) + *(int *)(_Str1 + 0xc);
        *param_4 = uVar5 - iVar3;
        return 0;
      }
      _Str1 = _Str1 + 0x28;
      uVar5 = uVar5 + 1;
    } while (uVar5 < uVar2);
  }
  return 0xc0000089;
}



void __fastcall FUN_6b86144f(int param_1)

{
  if (*(int *)(param_1 + 0x24) != 0) {
    FreeLibrary(*(HMODULE *)(param_1 + 0x24));
  }
  if (*(int *)(param_1 + 0x20) != -1) {
    CloseHandle(*(HANDLE *)(param_1 + 0x20));
    *(undefined4 *)(param_1 + 0x20) = 0xffffffff;
  }
  *(undefined4 *)(param_1 + 0x34) = 0;
  return;
}



int __fastcall FUN_6b86147c(int param_1,undefined4 param_2,uint *param_3)

{
  int iVar1;
  int local_8;
  
  iVar1 = -0x3ffffff3;
  if ((param_1 != 0) && (param_3 != (uint *)0x0)) {
    local_8 = param_1;
    iVar1 = FUN_6b8614b2(param_1,param_2,param_1,&local_8);
    if (-1 < iVar1) {
      *param_3 = (uint)(local_8 == 1);
    }
  }
  return iVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 __fastcall
FUN_6b8614b2(undefined4 param_1,undefined4 param_2,undefined4 param_3,int *param_4)

{
  code *pcVar1;
  int iVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 *puVar3;
  undefined4 uVar4;
  int *piVar5;
  undefined4 local_64 [8];
  undefined4 local_44;
  int local_30;
  undefined4 local_2c;
  undefined4 local_28;
  uint local_24;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b892560;
  uStack12 = 0x6b8614be;
  local_2c = param_2;
  memset(local_64,0,0x38);
  local_28 = 0xc0000001;
  local_44 = 0xffffffff;
  local_24 = 0;
  local_64[0] = param_1;
  do {
    if (4 < local_24) {
LAB_6b861524:
      if (local_30 != 0) {
        FUN_6b86144f((int)local_64);
      }
      *in_FS_OFFSET = local_14;
      return local_28;
    }
    local_8 = (undefined *)0x0;
    puVar3 = local_64;
    pcVar1 = (code *)(&PTR_FUN_6b880430)[local_24 * 0x1a];
    uVar4 = local_2c;
    piVar5 = param_4;
    _guard_check_icall();
    iVar2 = (*pcVar1)(puVar3,uVar4,piVar5);
    if ((-1 < iVar2) && (*param_4 != 0)) {
      local_28 = 0;
      local_8 = (undefined *)0xfffffffe;
      goto LAB_6b861524;
    }
    local_24 = local_24 + 1;
    local_8 = (undefined *)0xfffffffe;
  } while( true );
}



undefined4 __fastcall FUN_6b861559(int param_1)

{
  short *psVar1;
  int *piVar2;
  undefined4 uVar3;
  
  uVar3 = 0;
  psVar1 = *(short **)(param_1 + 4);
  if ((((*psVar1 == 0x5a4d) && (0 < *(int *)(psVar1 + 0x1e))) &&
      (piVar2 = (int *)(*(int *)(psVar1 + 0x1e) + (int)psVar1), *piVar2 == 0x4550)) &&
     (*(short *)(piVar2 + 1) == 0x14c)) {
    *(int **)(param_1 + 0x28) = piVar2;
    uVar3 = 1;
    *(int *)(param_1 + 0x2c) = piVar2[0x14];
  }
  return uVar3;
}



undefined4 __fastcall FUN_6b861595(LPCWSTR *param_1)

{
  int iVar1;
  
  if ((param_1[0xc] == (LPCWSTR)0x0) &&
     ((param_1[0xd] != (LPCWSTR)0x0 ||
      ((iVar1 = FUN_6b8615d8(param_1), iVar1 != 0 &&
       (iVar1 = FUN_6b861559((int)param_1), iVar1 != 0)))))) {
    return 1;
  }
  param_1[0xc] = (LPCWSTR)&DAT_00000001;
  if (param_1[0xd] != (LPCWSTR)0x0) {
    FUN_6b86144f((int)param_1);
  }
  return 0;
}



undefined4 __fastcall FUN_6b8615d8(LPCWSTR *param_1)

{
  LPCWSTR pWVar1;
  HMODULE lpAddress;
  SIZE_T SVar2;
  
  pWVar1 = (LPCWSTR)CreateFileW(*param_1,0x80000000,5,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0x0)
  ;
  param_1[8] = pWVar1;
  if (pWVar1 != (LPCWSTR)0xffffffff) {
    lpAddress = LoadLibraryExW(*param_1,(HANDLE)0x0,0x22);
    param_1[9] = (LPCWSTR)lpAddress;
    if ((lpAddress != (HMODULE)0x0) &&
       (SVar2 = VirtualQuery(lpAddress,(PMEMORY_BASIC_INFORMATION)(param_1 + 1),0x1c), SVar2 == 0x1c
       )) {
      param_1[0xd] = (LPCWSTR)&DAT_00000001;
      return 1;
    }
  }
  if (param_1[9] != (LPCWSTR)0x0) {
    FreeLibrary((HMODULE)param_1[9]);
  }
  if (param_1[8] != (LPCWSTR)0xffffffff) {
    CloseHandle(param_1[8]);
    param_1[8] = (LPCWSTR)0xffffffff;
  }
  return 0;
}



undefined4 FUN_6b861660(LPCWSTR *param_1,undefined4 param_2,undefined4 *param_3)

{
  int iVar1;
  uint uVar2;
  LPCWSTR *ppWVar3;
  
  uVar2 = 0;
  *param_3 = 0;
  iVar1 = FUN_6b861595(param_1);
  if (iVar1 != 0) {
    ppWVar3 = (LPCWSTR *)&DAT_6b880840;
    do {
      iVar1 = FUN_6b86188f((int)param_1,ppWVar3);
      if (iVar1 != 0) {
        *param_3 = 1;
        return 0;
      }
      uVar2 = uVar2 + 0x14;
      ppWVar3 = ppWVar3 + 5;
    } while (uVar2 < 0x28);
  }
  return 0;
}



// lpEnumFunc parameter of EnumResourceNamesW
// 

bool lpEnumFunc_6b8616b0(HMODULE param_1,undefined4 param_2,LPCWSTR param_3,undefined4 *param_4)

{
  HMODULE pHVar1;
  bool bVar2;
  HRSRC hResInfo;
  HMODULE _Str1;
  DWORD DVar3;
  int iVar4;
  uint uVar5;
  
  bVar2 = false;
  hResInfo = FindResourceW(param_1,param_3,(LPCWSTR)0x18);
  if (hResInfo != (HRSRC)0x0) {
    _Str1 = (HMODULE)LoadResource(param_1,hResInfo);
    DVar3 = SizeofResource(param_1,hResInfo);
    pHVar1 = (HMODULE)((int)&_Str1->unused + DVar3);
    if (((param_1 <= _Str1) && (param_1 <= pHVar1)) && (DVar3 != 0)) {
      while ((_Str1 < pHVar1 && (!bVar2))) {
        uVar5 = 0;
        do {
          if (bVar2) break;
          if (((HMODULE)((int)&_Str1->unused + *(size_t *)((int)&DAT_6b880a70 + uVar5)) < pHVar1) &&
             (iVar4 = _strnicmp((char *)_Str1,*(char **)((int)&_Str2_6b880a74 + uVar5),
                                *(size_t *)((int)&DAT_6b880a70 + uVar5)), iVar4 == 0)) {
            bVar2 = true;
            *param_4 = 1;
          }
          uVar5 = uVar5 + 0xc;
        } while (uVar5 < 0x60);
        _Str1 = (HMODULE)((int)&_Str1->unused + 1);
      }
    }
  }
  return !bVar2;
}



undefined4 FUN_6b861750(LPCWSTR *param_1,ushort *param_2,undefined4 *param_3)

{
  bool bVar1;
  int iVar2;
  BOOL BVar3;
  uint uVar4;
  
  bVar1 = false;
  *param_3 = 0;
  if (param_2 == (ushort *)0x0) {
    iVar2 = FUN_6b861595(param_1);
    if ((iVar2 != 0) &&
       (BVar3 = EnumResourceNamesW((HMODULE)param_1[9],(LPCWSTR)0x18,lpEnumFunc_6b8616b0,
                                   (LONG_PTR)param_3), BVar3 == 0)) {
      GetLastError();
    }
  }
  else if (*param_2 != 0) {
    uVar4 = 0;
    do {
      if (bVar1) {
        return 0;
      }
      if ((*(size_t *)((int)&DAT_6b880a70 + uVar4) * 2 <= (uint)*param_2) &&
         (iVar2 = _wcsnicmp(*(wchar_t **)(param_2 + 2),*(wchar_t **)((int)&_Str2_6b880a78 + uVar4),
                            *(size_t *)((int)&DAT_6b880a70 + uVar4)), iVar2 == 0)) {
        bVar1 = true;
        *param_3 = 1;
      }
      uVar4 = uVar4 + 0xc;
    } while (uVar4 < 0x60);
  }
  return 0;
}



undefined4 FUN_6b8617e0(LPCWSTR *param_1,undefined4 param_2,undefined4 *param_3)

{
  int iVar1;
  uint uVar2;
  ushort *puVar3;
  
  uVar2 = 0;
  *param_3 = 0;
  iVar1 = FUN_6b861595(param_1);
  if (iVar1 != 0) {
    puVar3 = (ushort *)&DAT_6b880980;
    do {
      iVar1 = FUN_6b86191d((int)param_1,puVar3);
      if (iVar1 != 0) {
        *param_3 = 1;
        return 0;
      }
      uVar2 = uVar2 + 0x14;
      puVar3 = puVar3 + 10;
    } while (uVar2 < 0xf0);
  }
  return 0;
}



undefined4 __fastcall FUN_6b86182d(int param_1,uint param_2,int param_3)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  void *_Buf1;
  uint uVar4;
  
  uVar1 = *(uint *)(param_3 + 8);
  uVar4 = *(uint *)(param_3 + 4);
  if (uVar4 < uVar1) {
    iVar2 = *(int *)(param_3 + 0xc);
    _Buf1 = (void *)(uVar4 + param_1);
    do {
      if (param_2 < (uint)((iVar2 - param_1) + (int)_Buf1)) {
        return 0;
      }
      iVar3 = memcmp(_Buf1,*(void **)(param_3 + 0x10),*(size_t *)(param_3 + 0xc));
      if (iVar3 == 0) {
        return 1;
      }
      uVar4 = uVar4 + 1;
      _Buf1 = (void *)((int)_Buf1 + 1);
    } while (uVar4 < uVar1);
  }
  return 0;
}



undefined4 __fastcall FUN_6b86188f(int param_1,LPCWSTR *param_2)

{
  LPCWSTR _Size;
  HRSRC hResInfo;
  byte *_Buf1;
  LPCWSTR pWVar1;
  undefined4 uVar2;
  int iVar3;
  
  uVar2 = 0;
  hResInfo = FindResourceExW(*(HMODULE *)(param_1 + 0x24),*param_2,param_2[1],0);
  if ((((hResInfo != (HRSRC)0x0) &&
       (_Buf1 = (byte *)LoadResource(*(HMODULE *)(param_1 + 0x24),hResInfo), _Buf1 != (byte *)0x0))
      && (*(byte **)(param_1 + 4) < _Buf1)) &&
     (_Size = param_2[3],
     _Buf1 + ((int)_Size - (int)*(byte **)(param_1 + 4)) < *(byte **)(param_1 + 0x2c))) {
    if (param_2[2] == (LPCWSTR)0x0) {
      iVar3 = memcmp(_Buf1,param_2[4],(size_t)_Size);
      if (iVar3 == 0) {
LAB_6b861913:
        uVar2 = 1;
      }
    }
    else if ((param_2[2] == (LPCWSTR)&DAT_00000001) &&
            (pWVar1 = (LPCWSTR)0x0, _Size != (LPCWSTR)0x0)) {
      iVar3 = (int)param_2[4] - (int)_Buf1;
      do {
        if ((*_Buf1 & _Buf1[iVar3]) != 0) goto LAB_6b861913;
        pWVar1 = (LPCWSTR)((int)pWVar1 + 1);
        _Buf1 = _Buf1 + 1;
      } while (pWVar1 < _Size);
    }
  }
  return uVar2;
}



undefined4 __fastcall FUN_6b86191d(int param_1,ushort *param_2)

{
  wchar_t *pwVar1;
  HRSRC hResInfo;
  DWORD DVar2;
  wchar_t *pwVar3;
  int iVar4;
  undefined4 uVar5;
  uint uVar6;
  
  hResInfo = FindResourceExW(*(HMODULE *)(param_1 + 0x24),(LPCWSTR)0x6,(LPCWSTR)(uint)*param_2,
                             param_2[4]);
  if (hResInfo == (HRSRC)0x0) {
    uVar5 = 0;
  }
  else {
    DVar2 = SizeofResource(*(HMODULE *)(param_1 + 0x24),hResInfo);
    pwVar3 = (wchar_t *)LoadResource(*(HMODULE *)(param_1 + 0x24),hResInfo);
    pwVar1 = (wchar_t *)((int)pwVar3 + DVar2);
    if (((pwVar3 == (wchar_t *)0x0) || (pwVar1 <= pwVar3)) ||
       (pwVar3 < *(wchar_t **)(param_1 + 4) || pwVar3 == *(wchar_t **)(param_1 + 4))) {
      uVar5 = 0;
    }
    else {
      uVar5 = 0;
      if (pwVar1 < (wchar_t *)(*(int *)(param_1 + 0x2c) + *(int *)(param_1 + 4))) {
        uVar6 = 0;
        do {
          if (*(uint *)(param_2 + 2) <= uVar6) break;
          pwVar3 = pwVar3 + (ushort)*pwVar3 + 1;
          uVar6 = uVar6 + 1;
        } while (pwVar3 < pwVar1);
        if (pwVar3 < pwVar1) {
          uVar6 = (uint)(ushort)*pwVar3;
          if (((uVar6 != 0) && (pwVar3 + 1 + uVar6 < pwVar1)) &&
             ((uVar6 == *(uint *)(param_2 + 6) &&
              (iVar4 = _wcsnicmp(pwVar3 + 1,*(wchar_t **)(param_2 + 8),*(size_t *)(param_2 + 6)),
              iVar4 == 0)))) {
            uVar5 = 1;
          }
        }
      }
    }
  }
  return uVar5;
}



uint __fastcall FUN_6b8619d0(uint param_1)

{
  uint uVar1;
  bool bVar2;
  
  bVar2 = (int)param_1 < 0;
  if (0 < (int)param_1) {
    param_1 = param_1 & 0xffff | 0x80070000;
    bVar2 = (int)param_1 < 0;
  }
  uVar1 = 0x80004005;
  if (bVar2) {
    uVar1 = param_1;
  }
  return uVar1;
}



uint __fastcall FUN_6b8619e9(LPCSTR param_1,FARPROC *param_2)

{
  DWORD DVar1;
  uint uVar2;
  FARPROC pFVar3;
  
  if ((param_2 == (FARPROC *)0x0) || (param_1 == (LPCSTR)0x0)) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid params\n",0xcd);
    uVar2 = 0x80070057;
  }
  else {
    if (DAT_6b8b0c5c == (HMODULE)0x0) {
      DAT_6b8b0c5c = GetModuleHandleW(L"ntdll.dll");
      if (DAT_6b8b0c5c == (HMODULE)0x0) goto LAB_6b861a16;
    }
    pFVar3 = GetProcAddress(DAT_6b8b0c5c,param_1);
    if (pFVar3 == (FARPROC)0x0) {
LAB_6b861a16:
      DVar1 = GetLastError();
      uVar2 = FUN_6b8619d0(DVar1);
      return uVar2;
    }
    *param_2 = pFVar3;
    uVar2 = 0;
  }
  return uVar2;
}



int __fastcall FUN_6b861a59(short *param_1,uint param_2,int param_3)

{
  int iVar1;
  uint uVar2;
  
  uVar2 = param_2 >> 1;
  iVar1 = (-(uint)(uVar2 != 0) & 0x7ff8ffa9) + 0x80070057;
  if (uVar2 != 0) {
    iVar1 = FUN_6b861ab7(param_1,uVar2,param_1,param_3);
  }
  return iVar1;
}



void __fastcall FUN_6b861a82(short *param_1,uint param_2,int param_3)

{
  int iVar1;
  
  iVar1 = 0;
  if ((param_2 == 0) || (0x7fffffff < param_2)) {
    iVar1 = -0x7ff8ffa9;
  }
  if (iVar1 < 0) {
    if (param_2 != 0) {
      *param_1 = 0;
    }
  }
  else {
    FUN_6b861ab7(param_1,param_2,param_1,param_3);
  }
  return;
}



int __fastcall FUN_6b861ab7(short *param_1,int param_2,undefined4 param_3,int param_4)

{
  short sVar1;
  int iVar2;
  int iVar3;
  
  if (param_2 != 0) {
    iVar3 = 0x7ffffffe;
    iVar2 = param_4 - (int)param_1;
    do {
      if ((iVar3 == 0) || (sVar1 = *(short *)(iVar2 + (int)param_1), sVar1 == 0)) break;
      *param_1 = sVar1;
      param_1 = param_1 + 1;
      iVar3 = iVar3 + -1;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
    if (param_2 != 0) goto LAB_6b861aee;
  }
  param_1 = param_1 + -1;
LAB_6b861aee:
  *param_1 = 0;
  return (-(uint)(param_2 != 0) & 0x7ff8ff86) + 0x8007007a;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 __fastcall FUN_6b861b07(undefined4 *param_1)

{
  uint *puVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  undefined4 uVar5;
  undefined4 *in_FS_OFFSET;
  char *pcVar6;
  undefined4 uVar7;
  undefined4 local_14;
  
  uVar5 = 0x80004005;
  if (param_1 == (undefined4 *)0x0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid args\n",900);
    uVar5 = 0x80070057;
  }
  else {
    iVar2 = FUN_6b818381();
    if (iVar2 == 0) {
      uVar7 = 0x38c;
      pcVar6 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
    }
    else {
      iVar3 = FUN_6b818333();
      if (-1 < iVar3) {
        iVar2 = *(int *)(iVar2 + 0x230);
        if ((iVar2 == 0) || (uVar4 = FUN_6b81826e(iVar2), (int)uVar4 < 0)) {
          DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid PEB entry\n",0x39e);
        }
        else {
          puVar1 = (uint *)(iVar2 + 0x908);
          if (*puVar1 < 0x200) {
            *param_1 = *(undefined4 *)(iVar2 + 0x8e8);
            param_1[1] = *(undefined4 *)(iVar2 + 0x8ec);
            *(undefined4 **)(iVar2 + 0x8e8) = param_1;
            *(undefined4 *)(iVar2 + 0x8ec) = 0;
            LOCK();
            *puVar1 = *puVar1 + 1;
            uVar5 = 0;
          }
          else {
            uVar5 = 0x8007007a;
          }
        }
        FUN_6b861c11();
        goto LAB_6b861b68;
      }
      uVar7 = 0x394;
      pcVar6 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
    }
    DbgPrintEx(0x96,0,pcVar6,uVar7);
  }
LAB_6b861b68:
  *in_FS_OFFSET = local_14;
  return uVar5;
}



void FUN_6b861c11(void)

{
  RtlReleasePebLock();
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 __fastcall FUN_6b861c18(undefined4 *param_1,undefined4 *param_2)

{
  ushort uVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  int *piVar5;
  int *piVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  undefined4 uVar9;
  undefined4 *puVar10;
  undefined4 *in_FS_OFFSET;
  bool bVar11;
  char *pcVar12;
  undefined4 local_14;
  
  uVar9 = 0x80004005;
  if ((param_1 == (undefined4 *)0x0) || (param_2 == (undefined4 *)0x0)) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid args\n",0x1454);
    uVar9 = 0x80070057;
    goto LAB_6b861dc5;
  }
  *param_2 = 0;
  iVar2 = FUN_6b818381();
  if (iVar2 == 0) {
    uVar9 = 0x145e;
    pcVar12 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
  }
  else {
    iVar3 = FUN_6b818333();
    if (-1 < iVar3) {
      iVar2 = *(int *)(iVar2 + 0x230);
      if ((iVar2 == 0) || (uVar4 = FUN_6b81826e(iVar2), (int)uVar4 < 0)) {
        DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid PEB entry\n",0x1470);
      }
      else {
        piVar6 = *(int **)(iVar2 + 0x8f8);
        iVar3 = (int)param_1 >> 0x1f;
        if (piVar6 == (int *)0x0) {
          *param_1 = 0;
          param_1[1] = 0;
          *(undefined4 **)(iVar2 + 0x8f8) = param_1;
          *(int *)(iVar2 + 0x8fc) = iVar3;
        }
        else {
          do {
            puVar8 = param_1 + 6;
            piVar5 = piVar6 + 6;
            do {
              uVar1 = *(ushort *)piVar5;
              bVar11 = uVar1 < *(ushort *)puVar8;
              if (uVar1 != *(ushort *)puVar8) {
LAB_6b861cfd:
                uVar4 = -(uint)bVar11 | 1;
                goto LAB_6b861d02;
              }
              if (uVar1 == 0) break;
              uVar1 = *(ushort *)((int)piVar5 + 2);
              bVar11 = uVar1 < *(ushort *)((int)puVar8 + 2);
              if (uVar1 != *(ushort *)((int)puVar8 + 2)) goto LAB_6b861cfd;
              piVar5 = piVar5 + 1;
              puVar8 = puVar8 + 1;
            } while (uVar1 != 0);
            uVar4 = 0;
LAB_6b861d02:
            if (((uVar4 == 0) && (piVar6[4] == param_1[4])) && (piVar6[5] == param_1[5])) {
              *param_2 = 1;
              goto LAB_6b861cc3;
            }
            piVar6 = (int *)*piVar6;
          } while (piVar6 != (int *)0x0);
          uVar4 = 0;
          puVar8 = *(undefined4 **)(iVar2 + 0x8f8);
          puVar10 = (undefined4 *)0x0;
          while (puVar7 = puVar8, puVar7 != (undefined4 *)0x0) {
            uVar4 = uVar4 + 1;
            puVar10 = puVar7;
            puVar8 = (undefined4 *)*puVar7;
          }
          if (0xf < uVar4) {
            uVar9 = 0x8007007a;
            goto LAB_6b861d8c;
          }
          if (puVar10 == (undefined4 *)0x0) {
            *(undefined4 **)(iVar2 + 0x8f8) = param_1;
            *(int *)(iVar2 + 0x8fc) = iVar3;
          }
          else {
            *puVar10 = param_1;
            puVar10[1] = iVar3;
          }
          *param_1 = 0;
          param_1[1] = 0;
        }
LAB_6b861cc3:
        uVar9 = 0;
      }
LAB_6b861d8c:
      FUN_6b861d9f();
      goto LAB_6b861dc5;
    }
    uVar9 = 0x1466;
    pcVar12 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
  }
  DbgPrintEx(0x96,0,pcVar12,uVar9);
  uVar9 = 0x80004005;
LAB_6b861dc5:
  *in_FS_OFFSET = local_14;
  return uVar9;
}



void FUN_6b861d9f(void)

{
  RtlReleasePebLock();
  return;
}



DWORD __fastcall FUN_6b861dd5(HANDLE param_1,LPVOID param_2)

{
  bool bVar1;
  LPCVOID pvVar2;
  HANDLE hProcess;
  BOOL BVar3;
  uint uVar4;
  DWORD DVar5;
  uint *Wow64Process;
  undefined4 uVar6;
  LPCVOID local_20;
  uint local_1c;
  uint local_18;
  DWORD local_14;
  uint local_10;
  uint local_c;
  
  bVar1 = false;
  local_20 = (LPCVOID)0x0;
  local_10 = 0;
  local_c = 0;
  local_18 = 0;
  local_1c = 0;
  if ((param_1 == (HANDLE)0x0) || (param_2 == (LPVOID)0x0)) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid arguments\n",0xc3b);
    return 0x80070057;
  }
  Wow64Process = &local_1c;
  hProcess = GetCurrentProcess();
  BVar3 = IsWow64Process(hProcess,(PBOOL)Wow64Process);
  local_1c = local_1c & -(uint)(BVar3 != 0);
  if (local_1c == 0) {
LAB_6b861e4a:
    if (local_18 != 0) {
      local_14 = FUN_6b8623ca(param_1,&local_20);
      pvVar2 = local_20;
      if (-1 < (int)local_14) goto joined_r0x6b861f37;
      uVar6 = 0xc92;
      goto LAB_6b861e7f;
    }
  }
  else {
    BVar3 = IsWow64Process(param_1,(PBOOL)&local_18);
    local_18 = -(uint)(BVar3 != 0) & local_18;
    if (local_18 != 0) goto LAB_6b861e4a;
    bVar1 = true;
  }
  if ((local_1c == 0) || (!bVar1)) {
    local_14 = FUN_6b8625be(param_1,&local_20);
    pvVar2 = local_20;
    if (-1 < (int)local_14) goto joined_r0x6b861f37;
    uVar6 = 0xc7f;
  }
  else {
    local_14 = FUN_6b8624ba((int)param_1,(int)&local_10);
    if (-1 < (int)local_14) {
      pvVar2 = (LPCVOID)(local_10 | local_c);
joined_r0x6b861f37:
      if (pvVar2 == (LPCVOID)0x0) {
        return 0x80070490;
      }
      if ((local_1c == 0) || (!bVar1)) {
        BVar3 = ReadProcessMemory(param_1,local_20,param_2,0x968,(SIZE_T *)0x0);
        if (BVar3 == 0) {
          DbgPrintEx(0x96,0,
                     "WER/CrashAPI:%u: ERROR ReadProcessMemory failed while trying to read WerRegistrationData\n"
                     ,0xcbe);
          DVar5 = GetLastError();
          if ((int)DVar5 < 1) {
            return DVar5;
          }
          return DVar5 & 0xffff | 0x80070000;
        }
      }
      else {
        uVar4 = FUN_6b8622f5(param_1,param_2,local_10,local_c,0x968,0);
        if ((uVar4 & 0xc0000000) == 0xc0000000) {
          DbgPrintEx(0x96,0,
                     "WER/CrashAPI:%u: ERROR WerpNtWow64ReadVirtualMemory64 failed while trying to read PebBaseAddress\n"
                     ,0xcaf);
          return uVar4 | 0x10000000;
        }
      }
      uVar4 = FUN_6b81826e((int)param_2);
      if ((int)uVar4 < 0) {
        DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpValidatePebHeader failed\n",0xcc7);
        return 0x80004005;
      }
      *(undefined2 *)((int)param_2 + 0x8a6) = 0;
      return 0;
    }
    uVar6 = 0xc6a;
  }
LAB_6b861e7f:
  DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Failed to read the peb from the process\n",uVar6);
  return local_14;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

ushort * FUN_6b862000(void)

{
  int iVar1;
  ushort *puVar2;
  int iVar3;
  uint uVar4;
  undefined4 *in_FS_OFFSET;
  char *pcVar5;
  undefined4 uVar6;
  undefined4 local_14;
  
  iVar1 = FUN_6b818381();
  if (iVar1 == 0) {
    uVar6 = 0x3d0;
    pcVar5 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
  }
  else {
    iVar3 = FUN_6b818333();
    if (-1 < iVar3) {
      iVar1 = *(int *)(iVar1 + 0x230);
      if (iVar1 == 0) {
LAB_6b86209c:
        DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid PEB entry\n",0x3e0);
LAB_6b8620b2:
        puVar2 = (ushort *)0x0;
      }
      else {
        uVar4 = FUN_6b81826e(iVar1);
        if ((int)uVar4 < 0) goto LAB_6b86209c;
        puVar2 = (ushort *)(iVar1 + 0x918);
        uVar4 = FUN_6b86493a(puVar2);
        if ((int)uVar4 < 0) {
          DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid Heap\n",0x3eb);
          goto LAB_6b8620b2;
        }
      }
      FUN_6b8620d6();
      goto LAB_6b8620c3;
    }
    uVar6 = 0x3d6;
    pcVar5 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
  }
  DbgPrintEx(0x96,0,pcVar5,uVar6);
  puVar2 = (ushort *)0x0;
LAB_6b8620c3:
  *in_FS_OFFSET = local_14;
  return puVar2;
}



void FUN_6b8620d6(void)

{
  RtlReleasePebLock();
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 __fastcall FUN_6b8620dd(int **param_1)

{
  undefined4 uVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  undefined4 *in_FS_OFFSET;
  char *pcVar5;
  undefined4 local_14;
  
  if (param_1 == (int **)0x0) {
    uVar1 = 0x80070057;
  }
  else {
    uVar1 = 0;
    *param_1 = (int *)0x0;
    iVar2 = FUN_6b818381();
    if (iVar2 == 0) {
      uVar1 = 0xeee;
      pcVar5 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
    }
    else {
      iVar3 = FUN_6b818333();
      if (-1 < iVar3) {
        iVar2 = *(int *)(iVar2 + 0x230);
        if ((iVar2 == 0) || (uVar4 = FUN_6b81826e(iVar2), (int)uVar4 < 0)) {
          DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid PEB entry\n",0xefe);
          uVar1 = 0x80004005;
        }
        else if (*(int *)(iVar2 + 0x8a8) == 0x40) {
          *param_1 = (int *)(iVar2 + 0x8a8);
        }
        else {
          DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid handle passed\n",0xf05);
          uVar1 = 0x80070006;
        }
        FUN_6b8621cd();
        goto LAB_6b8621ba;
      }
      uVar1 = 0xef4;
      pcVar5 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
    }
    DbgPrintEx(0x96,0,pcVar5,uVar1);
    uVar1 = 0x80004005;
  }
LAB_6b8621ba:
  *in_FS_OFFSET = local_14;
  return uVar1;
}



void FUN_6b8621cd(void)

{
  RtlReleasePebLock();
  return;
}



uint __fastcall FUN_6b8621d4(int param_1)

{
  uint uVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined4 local_24 [7];
  uint local_8;
  
  uVar1 = 0;
  if (param_1 != 0) {
    puVar3 = local_24;
    for (iVar2 = 8; iVar2 != 0; iVar2 = iVar2 + -1) {
      *puVar3 = 0;
      puVar3 = puVar3 + 1;
    }
    local_24[0] = 0x20;
    iVar2 = NtQueryInformationProcess(param_1,0,local_24,0x20,0);
    if (iVar2 < 0) {
      DbgPrintEx(0x96,0,
                 "WER/CrashAPI:%u: ERROR NtQueryInformationProcess failed with status: 0x%x\n",
                 0x1050,iVar2);
      uVar1 = 0;
    }
    else {
      uVar1 = local_8 & 1;
    }
  }
  return uVar1;
}



undefined4 FUN_6b86222f(byte param_1)

{
  undefined4 uVar1;
  
  if (((param_1 & 7) < 3) && ((param_1 & 0xf0) < 0x90)) {
    uVar1 = *(undefined4 *)(&DAT_6b88b4d0 + ((param_1 & 7) * 9 + (uint)(param_1 >> 4)) * 4);
  }
  else {
    uVar1 = 0xffffffff;
  }
  return uVar1;
}



uint FUN_6b86226b(void)

{
  uint uVar1;
  FARPROC local_8;
  
  local_8 = (FARPROC)0x0;
  uVar1 = FUN_6b8619e9("NtWow64QueryInformationProcess64",&local_8);
  if ((int)uVar1 < 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Unable to get NtWow64QueryInformationProcess64\n",
               0x12f);
  }
  else {
    _guard_check_icall();
    uVar1 = (*local_8)();
    if ((uVar1 & 0xc0000000) == 0xc0000000) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR NtWow64QueryInformationProcess64 failed with 0x%x\n"
                 ,0x13c,uVar1);
    }
    uVar1 = uVar1 | 0x10000000;
  }
  return uVar1;
}



uint __fastcall
FUN_6b8622f5(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
            undefined4 param_5,undefined4 param_6)

{
  uint uVar1;
  undefined4 uVar2;
  FARPROC local_8;
  
  local_8 = (FARPROC)0x0;
  uVar1 = FUN_6b8619e9("NtWow64ReadVirtualMemory64",&local_8);
  if ((int)uVar1 < 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Unable to get NtWow64ReadVirtualMemory64\n",0x160);
  }
  else {
    uVar2 = 0;
    _guard_check_icall();
    uVar1 = (*local_8)(param_1,param_3,param_4,param_2,param_5,param_6,uVar2);
    if ((uVar1 & 0xc0000000) == 0xc0000000) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR NtWow64ReadVirtualMemory64 failed with 0x%x\n",0x16c
                 ,uVar1);
    }
    uVar1 = uVar1 | 0x10000000;
  }
  return uVar1;
}



short * __fastcall FUN_6b86238a(short *param_1)

{
  short sVar1;
  short *psVar2;
  short *psVar3;
  
  if (param_1 == (short *)0x0) {
    return (short *)0x0;
  }
  psVar3 = param_1;
  do {
    sVar1 = *psVar3;
    psVar3 = psVar3 + 1;
  } while (sVar1 != 0);
  psVar3 = param_1 + ((int)psVar3 - (int)(param_1 + 1) >> 1);
  do {
    psVar2 = psVar3;
    if (psVar2 <= param_1) {
      return psVar2;
    }
    sVar1 = psVar2[-1];
    if (sVar1 == 0x5c) {
      return psVar2;
    }
    if (sVar1 == 0x2f) {
      return psVar2;
    }
    psVar3 = psVar2 + -1;
  } while (sVar1 != 0x3a);
  return psVar2;
}



DWORD __fastcall FUN_6b8623ca(HANDLE param_1,LPVOID param_2)

{
  uint uVar1;
  BOOL BVar2;
  DWORD DVar3;
  int local_8;
  
  local_8 = 0;
  if ((param_1 == (HANDLE)0x0) || (param_2 == (LPVOID)0x0)) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid arg\n",0xb58);
    DVar3 = 0x80070057;
  }
  else {
    uVar1 = NtQueryInformationProcess(param_1,0x1a,&local_8,4,0);
    if ((int)uVar1 < 0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR NtQueryInformationProcess failed with status 0x%x\n"
                 ,0xb65,uVar1);
      DVar3 = uVar1 | 0x10000000;
    }
    else if (local_8 == 0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR No 32 PEB for process\n",0xb6d);
      DVar3 = 0x80004005;
    }
    else {
      BVar2 = ReadProcessMemory(param_1,(LPCVOID)(local_8 + 0x230),param_2,4,(SIZE_T *)0x0);
      if (BVar2 == 0) {
        DbgPrintEx(0x96,0,
                   "WER/CrashAPI:%u: ERROR ReadProcessMemory failed while trying to read Peb32BaseAddress\n"
                   ,0xb77);
        DVar3 = GetLastError();
        if (0 < (int)DVar3) {
          DVar3 = DVar3 & 0xffff | 0x80070000;
        }
      }
      else {
        DVar3 = 0;
      }
    }
  }
  return DVar3;
}



void __fastcall FUN_6b8624ba(int param_1,int param_2)

{
  uint uVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 uVar2;
  undefined auStack68 [12];
  uint local_38;
  uint local_34;
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)auStack68;
  if ((param_1 == 0) || (param_2 == 0)) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid arg\n",0xb9d);
    uVar2 = extraout_EDX_03;
  }
  else {
    uVar1 = FUN_6b86226b();
    if ((int)uVar1 < 0) {
      DbgPrintEx(0x96,0,
                 "WER/CrashAPI:%u: ERROR WerpNtWow64QueryInformationProcess64 failed with status 0x%x\n"
                 ,0xbb0,uVar1);
      uVar2 = extraout_EDX;
    }
    else if ((local_38 | local_34) == 0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR No 64 bit PEB for process\n",3000);
      uVar2 = extraout_EDX_00;
    }
    else {
      uVar1 = FUN_6b8622f5(param_1,param_2,local_38 + 0x358,local_34 + (0xfffffca7 < local_38),8,0);
      uVar2 = extraout_EDX_01;
      if ((int)uVar1 < 0) {
        DbgPrintEx(0x96,0,
                   "WER/CrashAPI:%u: ERROR WerpNtWow64ReadVirtualMemory64  failed while trying to read PebBaseAddress\n"
                   ,0xbc4);
        uVar2 = extraout_EDX_02;
      }
    }
  }
  FUN_6b8224af(local_c ^ (uint)auStack68,uVar2);
  return;
}



DWORD __fastcall FUN_6b8625be(HANDLE param_1,LPVOID param_2)

{
  int iVar1;
  DWORD DVar2;
  BOOL BVar3;
  undefined local_1c [4];
  int local_18;
  
  if ((param_1 == (HANDLE)0x0) || (param_2 == (LPVOID)0x0)) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid arg\n",0xbf6);
    DVar2 = 0x80070057;
  }
  else {
    iVar1 = NtQueryInformationProcess(param_1,0,local_1c,0x18,0);
    if (iVar1 < 0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR NtQueryInformationProcess failed\n",0xc00);
      DVar2 = 0x80070006;
    }
    else if (local_18 == 0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR No PEB for process\n",0xc08);
      DVar2 = 0x80004005;
    }
    else {
      BVar3 = ReadProcessMemory(param_1,(LPCVOID)(local_18 + 0x230),param_2,4,(SIZE_T *)0x0);
      if (BVar3 == 0) {
        DbgPrintEx(0x96,0,
                   "WER/CrashAPI:%u: ERROR ReadProcessMemory failed while trying to read PebBaseAddress\n"
                   ,0xc12);
        DVar2 = GetLastError();
        if (0 < (int)DVar2) {
          DVar2 = DVar2 & 0xffff | 0x80070000;
        }
      }
      else {
        DVar2 = 0;
      }
    }
  }
  return DVar2;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 __fastcall FUN_6b8626a2(int param_1,uint param_2)

{
  bool bVar1;
  undefined3 extraout_var;
  int iVar2;
  ushort *puVar3;
  int *piVar4;
  undefined4 uVar5;
  int *piVar6;
  undefined4 *in_FS_OFFSET;
  char *pcVar7;
  undefined4 local_14;
  
  uVar5 = 0x80004005;
  if ((param_1 == 0) || (param_2 == 0)) {
    uVar5 = 0xa5b;
    pcVar7 = "WER/CrashAPI:%u: ERROR Invalid args passed\n";
  }
  else {
    if (param_2 < 0x10001) {
      bVar1 = FUN_6b81813c();
      if (CONCAT31(extraout_var,bVar1) == 0) {
        DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid state\n",0xa69);
        uVar5 = 0x8007139f;
      }
      else {
        iVar2 = FUN_6b8182bd();
        if (iVar2 < 0) {
          DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpInitPEBStore failed\n",0xa6f);
          uVar5 = 0x80004005;
        }
        else {
          FUN_6b86401b(param_1);
          puVar3 = FUN_6b862000();
          if (puVar3 == (ushort *)0x0) {
            DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpGetHeapHandle returned NULL\n",0xa86);
          }
          else {
            piVar4 = FUN_6b8644d6((int)puVar3,0x20);
            if (piVar4 == (int *)0x0) {
              DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR OOM\n",0xa90);
              uVar5 = 0x8007000e;
            }
            else {
              piVar6 = piVar4;
              for (iVar2 = 8; iVar2 != 0; iVar2 = iVar2 + -1) {
                *piVar6 = 0;
                piVar6 = piVar6 + 1;
              }
              *(ushort *)(piVar4 + 2) = *(ushort *)(piVar4 + 2) & 0x3fff;
              piVar4[4] = param_1;
              piVar4[5] = param_1 >> 0x1f;
              piVar4[6] = param_2;
              *(ushort *)(piVar4 + 2) = *(ushort *)(piVar4 + 2) & 0xc020 | 0x20;
              uVar5 = FUN_6b861b07(piVar4);
            }
          }
          FUN_6b862805();
        }
      }
      goto LAB_6b862839;
    }
    uVar5 = 0xa63;
    pcVar7 = "WER/CrashAPI:%u: ERROR Invalid args, too  big block\n";
  }
  DbgPrintEx(0x96,0,pcVar7,uVar5);
  uVar5 = 0x80070057;
LAB_6b862839:
  *in_FS_OFFSET = local_14;
  return uVar5;
}



void FUN_6b862805(void)

{
  int unaff_EBX;
  int unaff_EBP;
  undefined4 unaff_ESI;
  int unaff_EDI;
  
  if ((unaff_EDI < 0) && (unaff_EBX != 0)) {
    FUN_6b864756(*(int *)(unaff_EBP + -0x28),unaff_EBX);
    *(undefined4 *)(unaff_EBP + -0x20) = unaff_ESI;
  }
  return;
}



undefined4 __fastcall FUN_6b86284b(int param_1,undefined4 *param_2,undefined4 *param_3)

{
  ushort *puVar1;
  int iVar2;
  undefined4 uVar3;
  
  if ((param_1 == 0) || (param_2 == (undefined4 *)0x0)) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid args\n",0x5ec);
    uVar3 = 0x80070057;
  }
  else {
    LOCK();
    *(int *)(param_1 + 0x908) = *(int *)(param_1 + 0x908) + -1;
    uVar3 = param_2[1];
    if (param_3 == (undefined4 *)0x0) {
      *(undefined4 *)(param_1 + 0x8e8) = *param_2;
      *(undefined4 *)(param_1 + 0x8ec) = uVar3;
    }
    else {
      *param_3 = *param_2;
      param_3[1] = uVar3;
    }
    puVar1 = FUN_6b862000();
    if (puVar1 == (ushort *)0x0) {
      uVar3 = 0x80004005;
    }
    else {
      iVar2 = FUN_6b864756((int)puVar1,(int)param_2);
      if (iVar2 == 0) {
        uVar3 = 0x80004005;
        DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpHeapFree failed with 0x%x\n",0x603,0x80004005)
        ;
      }
      else {
        uVar3 = 0;
      }
    }
  }
  return uVar3;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 __fastcall FUN_6b8628eb(wchar_t *param_1,undefined4 *param_2,undefined4 *param_3)

{
  int iVar1;
  uint uVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  undefined4 *in_FS_OFFSET;
  undefined4 local_14;
  
  uVar4 = 0x80070490;
  if (param_2 == (undefined4 *)0x0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid args\n",0x518);
    uVar4 = 0x80070057;
  }
  else {
    iVar1 = FUN_6b818381();
    iVar1 = *(int *)(iVar1 + 0x230);
    if ((iVar1 == 0) || (uVar2 = FUN_6b81826e(iVar1), (int)uVar2 < 0)) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR PEB is not initialized\n",0x524);
    }
    else {
      puVar3 = (undefined4 *)0x0;
      for (puVar5 = *(undefined4 **)(iVar1 + 0x8e8); puVar5 != (undefined4 *)0x0;
          puVar5 = (undefined4 *)*puVar5) {
        if (((*(ushort *)(puVar5 + 2) & 0xc000) == 0x4000) &&
           (iVar1 = _wcsnicmp((wchar_t *)((int)puVar5 + 0x12),param_1,0x104), iVar1 == 0)) {
          if (param_3 != (undefined4 *)0x0) {
            *param_3 = puVar3;
          }
          *param_2 = puVar5;
          uVar4 = 0;
          if (puVar5 != (undefined4 *)0x0) goto LAB_6b8629eb;
          break;
        }
        puVar3 = puVar5;
      }
      uVar4 = 0x80070490;
    }
  }
LAB_6b8629eb:
  *in_FS_OFFSET = local_14;
  return uVar4;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 __fastcall FUN_6b8629fd(int param_1,undefined4 *param_2,undefined4 *param_3)

{
  undefined4 *puVar1;
  int iVar2;
  uint uVar3;
  undefined4 *puVar4;
  undefined4 uVar5;
  undefined4 *puVar6;
  undefined4 *in_FS_OFFSET;
  undefined4 local_14;
  
  uVar5 = 0x80004005;
  if (param_2 == (undefined4 *)0x0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid args\n",0x417);
    uVar5 = 0x80070057;
    goto LAB_6b862acc;
  }
  iVar2 = FUN_6b818381();
  iVar2 = *(int *)(iVar2 + 0x230);
  if (iVar2 == 0) {
LAB_6b862aa4:
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR PEB is not initialized\n",0x423);
  }
  else {
    uVar3 = FUN_6b81826e(iVar2);
    if ((int)uVar3 < 0) goto LAB_6b862aa4;
    puVar1 = *(undefined4 **)(iVar2 + 0x8e8);
    puVar6 = (undefined4 *)0x0;
    while (puVar4 = puVar1, puVar4 != (undefined4 *)0x0) {
      if ((((*(ushort *)(puVar4 + 2) & 0xc000) == 0) && (puVar4[4] == param_1)) &&
         (puVar4[5] == param_1 >> 0x1f)) {
        if (param_3 != (undefined4 *)0x0) {
          *param_3 = puVar6;
        }
        *param_2 = puVar4;
        uVar5 = 0;
        if (puVar4 != (undefined4 *)0x0) goto LAB_6b862abe;
        break;
      }
      puVar6 = puVar4;
      puVar1 = (undefined4 *)*puVar4;
    }
    uVar5 = 0x80070490;
  }
LAB_6b862abe:
  FUN_6b862ae1();
LAB_6b862acc:
  *in_FS_OFFSET = local_14;
  return uVar5;
}



void FUN_6b862ae1(void)

{
  return;
}



uint WerpGetDebugger(int param_1,uint *param_2)

{
  LPVOID _Dst;
  undefined *puVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  undefined **ppuVar5;
  int local_2c;
  undefined4 local_28;
  uint local_24;
  undefined *local_20 [4];
  undefined4 local_10;
  undefined4 local_c;
  
                    // 0x62af0  1535  WerpGetDebugger
  local_2c = 0;
  ppuVar5 = local_20;
  for (iVar2 = 6; iVar2 != 0; iVar2 = iVar2 + -1) {
    *ppuVar5 = (undefined *)0x0;
    ppuVar5 = ppuVar5 + 1;
  }
  local_28 = 0;
  if ((param_1 == 0) || (param_2 == (uint *)0x0)) {
    uVar4 = 0x80070057;
  }
  else {
    memset(param_2,0,0x250);
    _Dst = VirtualAlloc((LPVOID)0x0,0x25a,0x1000,4);
    if (_Dst == (LPVOID)0x0) {
      uVar4 = 0x8007000e;
    }
    else {
      local_24 = FUN_6b8621d4(param_1);
      local_20[0] = (undefined *)0x18;
      local_20[1] = (undefined *)0x0;
      local_20[3] = (undefined *)0x40;
      local_20[2] = &DAT_6b880b1c;
      if (local_24 == 0) {
        local_20[2] = &DAT_6b880b24;
      }
      local_10 = 0;
      local_c = 0;
      uVar4 = NtOpenKey(&local_2c,1,local_20);
      if ((int)uVar4 < 0) {
        uVar4 = uVar4 | 0x10000000;
      }
      else {
        memset(_Dst,0,0x25a);
        puVar1 = &DAT_6b880af4;
        if (local_24 == 0) {
          puVar1 = &DAT_6b880afc;
        }
        iVar2 = NtQueryValueKey(local_2c,puVar1,2,_Dst,0x25a,&local_28);
        if ((iVar2 < 0) || (*(int *)((int)_Dst + 4) != 1)) {
          uVar4 = 0x80070490;
        }
        else {
          uVar4 = FUN_6b861a82((short *)(param_2 + 1),0x125,(int)_Dst + 0xc);
          if ((int)uVar4 < 0) {
            DbgPrintEx(0x96,0,
                       "WER/CrashAPI:%u: ERROR Stringcchcopy failed while copying the debugger path 0x%x\n"
                       ,0x1141,uVar4);
          }
          else {
            uVar4 = *param_2;
            *param_2 = uVar4 | 1;
            if (local_24 != 0) {
              *param_2 = uVar4 | 0x7d;
              memset(_Dst,0,0x25a);
              iVar2 = NtQueryValueKey(local_2c,&DAT_6b880aec,2,_Dst,0x25a,&local_28);
              if ((-1 < iVar2) && (*(int *)((int)_Dst + 4) == 4)) {
                *param_2 = (-(uint)(*(int *)((int)_Dst + 0xc) != 0) & 0xfffffffc) + 4 |
                           *param_2 & 0xfffffffb;
              }
              if ((*(byte *)param_2 & 4) != 0) {
                memset(_Dst,0,0x25a);
                iVar2 = NtQueryValueKey(local_2c,&DAT_6b880b14,2,_Dst,0x25a,&local_28);
                if ((-1 < iVar2) && (*(int *)((int)_Dst + 4) == 4)) {
                  uVar4 = *(uint *)((int)_Dst + 0xc);
                  uVar3 = *param_2;
                  if (uVar4 < 8) {
                    *param_2 = (uVar4 << 3 ^ uVar3) & 0x78 ^ uVar3;
                  }
                  else {
                    if (uVar4 == 0x80000000) {
                      uVar3 = uVar3 & 0xfffffff7 | 0x70;
                    }
                    else {
                      uVar3 = uVar3 | 0x78;
                    }
                    *param_2 = uVar3;
                  }
                }
              }
            }
            memset(_Dst,0,0x25a);
            iVar2 = NtQueryValueKey(local_2c,&DAT_6b880ae4,2,_Dst,0x25a,&local_28);
            if (((iVar2 < 0) ||
                (((*(int *)((int)_Dst + 4) != 1 || (*(short *)((int)_Dst + 0xc) != 0x31)) &&
                 ((*(int *)((int)_Dst + 4) != 4 || (*(int *)((int)_Dst + 0xc) == 0)))))) ||
               (iVar2 = FUN_6b86311b(param_1), iVar2 != 0)) {
              uVar4 = 0;
            }
            else {
              uVar4 = 2;
            }
            uVar3 = *param_2;
            *param_2 = uVar3 & 0xfffffffd | uVar4;
            DbgPrintEx(0x96,2,"WER/CrashAPI:%u: TRACE WERP_DEBUGGER_INFO.Available: %u\n",0x11a6,
                       uVar3 & 1);
            DbgPrintEx(0x96,2,"WER/CrashAPI:%u: TRACE WERP_DEBUGGER_INFO.AutoEnabled: %u\n",0x11a7,
                       *param_2 >> 1 & 1);
            DbgPrintEx(0x96,2,"WER/CrashAPI:%u: TRACE WERP_DEBUGGER_INFO.Protected: %u\n",0x11a8,
                       *param_2 >> 2 & 1);
            DbgPrintEx(0x96,2,"WER/CrashAPI:%u: TRACE WERP_DEBUGGER_INFO.ProtectionLevel: %08X\n",
                       0x11a9,*param_2 >> 3 & 0xf);
            DbgPrintEx(0x96,2,"WER/CrashAPI:%u: TRACE WERP_DEBUGGER_INFO.Debugger: %S\n",0x11aa,
                       param_2 + 1);
            uVar4 = 0;
          }
        }
      }
    }
    if (local_2c != 0) {
      NtClose(local_2c);
    }
    if (_Dst != (LPVOID)0x0) {
      VirtualFree(_Dst,0,0x8000);
    }
  }
  return uVar4;
}



// WARNING: Function: __SEH_prolog4_GS replaced with injection: SEH_prolog4

DWORD __fastcall FUN_6b862e21(HANDLE param_1,undefined4 *param_2)

{
  undefined4 *in_FS_OFFSET;
  DWORD local_98c;
  undefined local_988 [2324];
  undefined4 local_74;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b8926e0;
  uStack12 = 0x6b862e30;
  memset(local_988,0,0x968);
  if ((param_1 == (HANDLE)0x0) || (param_2 == (undefined4 *)0x0)) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid params\n",0x1013);
    local_98c = 0x80070057;
  }
  else {
    local_98c = FUN_6b861dd5(param_1,local_988);
    if (-1 < (int)local_98c) {
      *param_2 = local_74;
      local_98c = 0;
    }
  }
  *in_FS_OFFSET = local_14;
  return local_98c;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

DWORD __fastcall FUN_6b862ecd(HANDLE param_1,undefined4 *param_2)

{
  LPVOID _Dst;
  int iVar1;
  DWORD DVar2;
  undefined4 *puVar3;
  undefined4 *in_FS_OFFSET;
  undefined4 local_14;
  
  if ((param_1 == (HANDLE)0x0) || (param_2 == (undefined4 *)0x0)) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid args\n",0xe06);
    DVar2 = 0x80070057;
  }
  else {
    _Dst = VirtualAlloc((LPVOID)0x0,0x968,0x1000,4);
    if (_Dst == (LPVOID)0x0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR OOM\n",0xe15);
      DVar2 = 0x8007000e;
    }
    else {
      memset(_Dst,0,0x968);
      memset(param_2,0,0x40);
      DVar2 = FUN_6b861dd5(param_1,_Dst);
      if (-1 < (int)DVar2) {
        if ((*(uint *)((int)_Dst + 0x8b0) | *(uint *)((int)_Dst + 0x8b4)) == 0) {
          DVar2 = 0x80070490;
        }
        else {
          puVar3 = (undefined4 *)((int)_Dst + 0x8a8);
          for (iVar1 = 0x10; iVar1 != 0; iVar1 = iVar1 + -1) {
            *param_2 = *puVar3;
            puVar3 = puVar3 + 1;
            param_2 = param_2 + 1;
          }
        }
      }
    }
    FUN_6b862f9f();
  }
  *in_FS_OFFSET = local_14;
  return DVar2;
}



void FUN_6b862f9f(void)

{
  SIZE_T unaff_EBX;
  int unaff_EBP;
  
  if (*(LPVOID *)(unaff_EBP + -0x20) != (LPVOID)0x0) {
    VirtualFree(*(LPVOID *)(unaff_EBP + -0x20),unaff_EBX,0x8000);
    *(SIZE_T *)(unaff_EBP + -0x20) = unaff_EBX;
  }
  return;
}



void __fastcall FUN_6b862fe5(HANDLE param_1,short *param_2,uint *param_3,undefined4 *param_4)

{
  uint uVar1;
  short sVar2;
  DWORD DVar3;
  short *psVar4;
  int iVar5;
  undefined *extraout_EDX;
  undefined *puVar6;
  undefined *extraout_EDX_00;
  undefined *extraout_EDX_01;
  undefined8 uVar7;
  HANDLE local_97c;
  undefined local_978 [32];
  undefined4 local_958;
  int local_954;
  short local_8d0;
  undefined local_8ce [2242];
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)&local_97c;
  local_97c = param_1;
  memset(local_978,0,0x968);
  if (param_3 == (uint *)0x0) {
LAB_6b863033:
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid arg\n",0xd9e);
    puVar6 = extraout_EDX;
  }
  else {
    if (param_2 == (short *)0x0) {
      if (*param_3 != 0) goto LAB_6b863033;
    }
    else {
      *param_2 = 0;
    }
    DVar3 = FUN_6b861dd5(local_97c,local_978);
    puVar6 = extraout_EDX_00;
    if (-1 < (int)DVar3) {
      if (local_954 == 0) {
        *param_3 = 0;
      }
      else {
        if (param_4 != (undefined4 *)0x0) {
          *param_4 = local_958;
        }
        psVar4 = &local_8d0;
        puVar6 = local_8ce;
        do {
          sVar2 = *psVar4;
          psVar4 = psVar4 + 1;
        } while (sVar2 != 0);
        iVar5 = (int)psVar4 - (int)puVar6 >> 1;
        uVar1 = iVar5 + 1;
        if (*param_3 < uVar1) {
          *param_3 = uVar1;
        }
        else {
          if (param_2 != (short *)0x0) {
            if (iVar5 == 0) {
              *param_2 = 0;
            }
            else {
              uVar7 = FUN_6b861a82(param_2,*param_3,(int)&local_8d0);
              puVar6 = (undefined *)((ulonglong)uVar7 >> 0x20);
              if ((int)uVar7 < 0) {
                DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR StringCchCopy failed with 0x%x\n",0xdd2,
                           (int)uVar7);
                puVar6 = extraout_EDX_01;
                goto LAB_6b863051;
              }
            }
          }
          *param_3 = uVar1;
        }
      }
    }
  }
LAB_6b863051:
  FUN_6b8224af(local_c ^ (uint)&local_97c,puVar6);
  return;
}



void __fastcall FUN_6b86311b(int param_1)

{
  uint uVar1;
  uint uVar2;
  short *psVar3;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined8 uVar4;
  char *pcVar5;
  undefined4 uVar6;
  undefined local_25c [4];
  short *local_258;
  undefined local_44 [8];
  undefined4 local_3c;
  undefined4 local_38;
  undefined *local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  HANDLE local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 uStack20;
  undefined4 local_10;
  undefined4 uStack12;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_20 = (HANDLE)0x0;
  memset(local_25c,0,0x214);
  local_24 = 0;
  local_1c = 0;
  local_18 = 0;
  uStack20 = 0;
  local_10 = 0;
  uStack12 = 0;
  uVar1 = FUN_6b8621d4(param_1);
  uVar2 = NtQueryInformationProcess(param_1,0x2b,local_25c,0x210,0);
  if ((uVar2 & 0xc0000000) == 0xc0000000) {
    uVar6 = 0x1089;
    pcVar5 = "WER/CrashAPI:%u: ERROR NtQueryInformationProcess failed 0x%x\n";
  }
  else {
    psVar3 = FUN_6b86238a(local_258);
    if (psVar3 == (short *)0x0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpPathTail returned NULL\n",0x1091);
      uVar6 = extraout_EDX_00;
      goto LAB_6b863266;
    }
    local_3c = 0x18;
    local_38 = 0;
    local_30 = 0x40;
    local_34 = &DAT_6b880b04;
    if (uVar1 == 0) {
      local_34 = &DAT_6b880b0c;
    }
    local_2c = 0;
    local_28 = 0;
    uVar4 = NtOpenKey(&local_20,1,&local_3c);
    uVar6 = (undefined4)((ulonglong)uVar4 >> 0x20);
    if ((int)uVar4 < 0) goto LAB_6b863266;
    uVar2 = RtlInitUnicodeStringEx(local_44,psVar3);
    if ((uVar2 & 0xc0000000) != 0xc0000000) {
      uVar4 = NtQueryValueKey(local_20,local_44,2,&local_1c,0x14,&local_24);
      uVar6 = (undefined4)((ulonglong)uVar4 >> 0x20);
      goto LAB_6b863266;
    }
    uVar6 = 0x10ab;
    pcVar5 = "WER/CrashAPI:%u: ERROR RtlInitUnicodeStringEx returned 0x%x\n";
  }
  DbgPrintEx(0x96,0,pcVar5,uVar6,uVar2);
  uVar6 = extraout_EDX;
LAB_6b863266:
  if (local_20 != (HANDLE)0x0) {
    CloseHandle(local_20);
    uVar6 = extraout_EDX_01;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar6);
  return;
}



void WerpLaunchAeDebug(HANDLE param_1,HANDLE param_2,undefined4 *param_3,undefined4 *param_4,
                      uint *param_5)

{
  byte bVar1;
  HANDLE pvVar2;
  DWORD DVar3;
  HANDLE hTargetProcessHandle;
  HANDLE hSourceProcessHandle;
  int iVar4;
  undefined4 *puVar5;
  uint uVar6;
  uint uVar7;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 extraout_EDX_04;
  undefined4 extraout_EDX_05;
  undefined4 extraout_EDX_06;
  undefined4 extraout_EDX_07;
  undefined4 extraout_EDX_08;
  undefined4 extraout_EDX_09;
  undefined4 extraout_EDX_10;
  undefined4 extraout_EDX_11;
  undefined4 extraout_EDX_12;
  LPPROC_THREAD_ATTRIBUTE_LIST lpAttributeList;
  wchar_t *lpCommandLine;
  undefined4 *puVar8;
  uint *puVar9;
  uint *puVar10;
  undefined8 uVar11;
  HANDLE hSourceHandle;
  HANDLE *lpTargetHandle;
  char *pcVar12;
  BOOL BVar13;
  undefined4 uVar14;
  DWORD DVar15;
  HANDLE local_414;
  uint local_410;
  HANDLE local_40c;
  HANDLE local_408;
  uint *local_404;
  undefined4 *local_400;
  wchar_t *local_3fc;
  uint local_3f8;
  SIZE_T local_3f4;
  undefined4 *local_3f0;
  SIZE_T local_3ec;
  undefined4 *local_3e8;
  DWORD local_3e4;
  int local_3e0;
  HANDLE local_3dc;
  uint local_3d8;
  HANDLE local_3d4;
  HANDLE local_3d0;
  _PROCESS_INFORMATION local_3cc;
  _SECURITY_ATTRIBUTES local_3bc;
  _STARTUPINFOW local_3b0;
  LPPROC_THREAD_ATTRIBUTE_LIST local_36c;
  ushort local_364 [6];
  undefined4 local_358;
  uint local_354;
  DWORD local_350;
  undefined4 local_34c;
  undefined4 local_348;
  undefined4 local_344;
  undefined4 *local_340;
  undefined4 local_33c;
  undefined4 *local_338;
  undefined4 local_334;
  undefined4 local_330 [20];
  undefined4 local_2e0 [181];
  uint local_c;
  
                    // 0x63290  1537  WerpLaunchAeDebug
  local_c = DAT_6b8b0140 ^ (uint)&local_414;
  local_414 = (HANDLE)0x0;
  local_40c = param_1;
  local_408 = param_2;
  local_3e8 = param_4;
  local_404 = param_5;
  memset(&local_3b0,0,0x48);
  local_410 = 0xffffffff;
  local_3cc.hProcess = (HANDLE)0x0;
  local_3f4 = 0;
  lpAttributeList = (LPPROC_THREAD_ATTRIBUTE_LIST)0x0;
  local_3e0 = 0;
  local_3dc = (HANDLE)0x0;
  local_3cc.hThread = (HANDLE)0x0;
  local_3f0 = (undefined4 *)0x0;
  local_400 = (undefined4 *)0x0;
  local_3cc.dwProcessId = 0;
  local_3cc.dwThreadId = 0;
  lpCommandLine = (wchar_t *)0x0;
  local_3e4 = GetProcessId(local_40c);
  if (local_3e4 == 0) {
    GetLastError();
    uVar14 = extraout_EDX;
  }
  else {
    DVar3 = GetCurrentProcessId();
    local_3d8 = (uint)(local_3e4 == DVar3);
    lpCommandLine = (wchar_t *)VirtualAlloc((LPVOID)0x0,0x4c0,0x1000,4);
    uVar14 = extraout_EDX_00;
    local_3fc = lpCommandLine;
    if (lpCommandLine != (wchar_t *)0x0) {
      local_3bc.lpSecurityDescriptor = (LPVOID)0x0;
      local_3bc.nLength = 0xc;
      DVar15 = 2;
      BVar13 = 1;
      local_3bc.bInheritHandle = 1;
      lpTargetHandle = &local_414;
      DVar3 = 0;
      hTargetProcessHandle = GetCurrentProcess();
      pvVar2 = local_408;
      hSourceHandle = local_408;
      hSourceProcessHandle = GetCurrentProcess();
      BVar13 = DuplicateHandle(hSourceProcessHandle,hSourceHandle,hTargetProcessHandle,
                               lpTargetHandle,DVar3,BVar13,DVar15);
      local_414 = (HANDLE)((uint)local_414 & -(uint)(BVar13 != 0));
      local_408 = CreateEventW(&local_3bc,1,0,(LPCWSTR)0x0);
      if (((local_408 != (HANDLE)0x0) && (param_3 != (undefined4 *)0x0)) &&
         (iVar4 = NtQuerySystemInformation(1,local_364,0xc,0), -1 < iVar4)) {
        if (pvVar2 == (HANDLE)0x0) {
          local_350 = 0;
        }
        else {
          local_350 = GetThreadId(pvVar2);
        }
        local_354 = (uint)local_364[0];
        local_348 = param_3[3];
        local_358 = 0x28;
        local_34c = 0;
        local_344 = 0;
        if (local_3d8 == 0) {
          local_3f0 = (undefined4 *)VirtualAllocEx(local_40c,(LPVOID)0x0,0x348,0x1000,4);
          if (local_3f0 != (undefined4 *)0x0) {
            puVar5 = local_330;
            for (iVar4 = 0x14; iVar4 != 0; iVar4 = iVar4 + -1) {
              *puVar5 = *param_3;
              param_3 = param_3 + 1;
              puVar5 = puVar5 + 1;
            }
            puVar5 = local_3e8;
            puVar8 = local_2e0;
            for (iVar4 = 0xb3; iVar4 != 0; iVar4 = iVar4 + -1) {
              *puVar8 = *puVar5;
              puVar5 = puVar5 + 1;
              puVar8 = puVar8 + 1;
            }
            local_33c = 0;
            local_334 = 0;
            local_3ec = (int)local_3f0 - (int)&local_358;
            local_340 = (undefined4 *)((int)local_330 + local_3ec);
            local_338 = (undefined4 *)((int)local_2e0 + local_3ec);
            BVar13 = WriteProcessMemory(local_40c,local_3f0,&local_358,0x348,&local_3ec);
            if ((BVar13 != 0) && (puVar5 = local_3f0, local_3ec == 0x348)) goto LAB_6b863526;
          }
        }
        else {
          local_338 = local_3e8;
          local_340 = param_3;
          local_33c = 0;
          local_334 = 0;
          puVar5 = &local_358;
LAB_6b863526:
          local_400 = puVar5;
        }
      }
      puVar10 = local_404 + 1;
      if ((*(short *)puVar10 == 0x22) ||
         (iVar4 = RtlDetermineDosPathNameType_U(puVar10), iVar4 != 5)) {
LAB_6b863594:
        lpCommandLine = local_3fc;
        uVar6 = FUN_6b850f02(local_3fc,0x13b,(wchar_t *)puVar10);
        if ((int)uVar6 < 0) {
          uVar14 = 0x12e9;
          pcVar12 = 
          "WER/CrashAPI:%u: ERROR StringCchPrintf failed while printng the debugger commandline with 0x%x\n"
          ;
        }
        else {
          local_3dc = (HANDLE)RtlGetCurrentTransaction();
          RtlSetCurrentTransaction(0);
          local_3b0.cb = 0x48;
          local_3b0.lpDesktop = L"";
          uVar6 = *local_404;
          DVar3 = (uVar6 & 4) << 0x10;
          uVar7 = local_410;
          if ((uVar6 & 4) != 0) {
            bVar1 = (byte)uVar6;
            uVar6 = uVar6 >> 3 & 0xf;
            uVar7 = uVar6;
            if ((((0x18 < (bVar1 & 0x78)) && (uVar7 = local_410, 0x20 < (bVar1 & 0x78))) &&
                (uVar7 = uVar6, 0x38 < (bVar1 & 0x78))) &&
               (uVar7 = local_410, (bVar1 & 0x78) == 0x70)) {
              local_3f8 = local_3f8 & 0xffffff00;
              iVar4 = NtQueryInformationProcess(local_40c,0x3d,&local_3f8,1,0);
              if (iVar4 < 0) {
                DbgPrintEx(0x96,1,
                           "WER/CrashAPI:%u: WARNING NtQueryInformationProcess/ProcessProtectionInformation failed: NTSTATUS %08X\n"
                           ,0x1319,iVar4);
                uVar7 = local_410;
              }
              else {
                DbgPrintEx(0x96,2,
                           "WER/CrashAPI:%u: TRACE Faulting process protection/signer: %02x/%02x\n",
                           0x131e,local_3f8 & 7,local_3f8 >> 4 & 0xf);
                uVar7 = FUN_6b86222f((byte)local_3f8);
              }
            }
          }
          local_410 = uVar7;
          DbgPrintEx(0x96,2,"WER/CrashAPI:%u: TRACE Mapped protection level %02X -> %08X\n",0x132c,
                     *local_404 >> 3 & 0xf,local_410);
          if (((*(byte *)local_404 & 4) == 0) || (local_410 == 0xffffffff)) {
LAB_6b8637e9:
            BVar13 = CreateProcessW((LPCWSTR)0x0,lpCommandLine,(LPSECURITY_ATTRIBUTES)0x0,
                                    (LPSECURITY_ATTRIBUTES)0x0,1,DVar3,(LPVOID)0x0,(LPCWSTR)0x0,
                                    &local_3b0,&local_3cc);
            if (BVar13 != 0) {
              uVar14 = extraout_EDX_03;
              if (local_408 != (HANDLE)0x0) {
                local_3d4 = local_408;
                local_3d0 = local_3cc.hProcess;
                do {
                  uVar11 = NtWaitForMultipleObjects(2,&local_3d4,1,1,0);
                  uVar14 = (undefined4)((ulonglong)uVar11 >> 0x20);
                  iVar4 = (int)uVar11;
                  if (iVar4 == 0) break;
                } while (((iVar4 == 0xc0) || (iVar4 == 0x101)) || (iVar4 != 1));
              }
              goto LAB_6b86386d;
            }
            DVar3 = GetLastError();
            uVar6 = FUN_6b8619d0(DVar3);
            uVar14 = 0x137d;
            pcVar12 = "WER/CrashAPI:%u: ERROR Debugger spawn failed: 0x%x\n";
          }
          else {
            BVar13 = InitializeProcThreadAttributeList
                               ((LPPROC_THREAD_ATTRIBUTE_LIST)0x0,1,0,&local_3f4);
            if ((BVar13 == 0) && (DVar15 = GetLastError(), DVar15 != 0x7a)) {
              DVar3 = GetLastError();
              uVar6 = FUN_6b8619d0(DVar3);
              uVar14 = 0x133b;
LAB_6b863735:
              pcVar12 = "WER/CrashAPI:%u: ERROR InitializeProcThreadAttributeList failed: 0x%x\n";
            }
            else {
              lpAttributeList =
                   (LPPROC_THREAD_ATTRIBUTE_LIST)VirtualAlloc((LPVOID)0x0,local_3f4,0x1000,4);
              if (lpAttributeList == (LPPROC_THREAD_ATTRIBUTE_LIST)0x0) {
                uVar6 = 0x8007000e;
                uVar14 = 0x1348;
                pcVar12 = "WER/CrashAPI:%u: ERROR Failed to allocate attribute list: 0x%x\n";
              }
              else {
                BVar13 = InitializeProcThreadAttributeList(lpAttributeList,1,0,&local_3f4);
                if (BVar13 == 0) {
                  DVar3 = GetLastError();
                  uVar6 = FUN_6b8619d0(DVar3);
                  uVar14 = 0x1354;
                  goto LAB_6b863735;
                }
                local_3e0 = 1;
                BVar13 = UpdateProcThreadAttribute
                                   (lpAttributeList,0,0x2000b,&local_410,4,(PVOID)0x0,(PSIZE_T)0x0);
                if (BVar13 != 0) {
                  DVar3 = DVar3 | 0x80000;
                  local_36c = lpAttributeList;
                  goto LAB_6b8637e9;
                }
                DVar3 = GetLastError();
                uVar6 = FUN_6b8619d0(DVar3);
                uVar14 = 0x1364;
                pcVar12 = "WER/CrashAPI:%u: ERROR UpdateProcThreadAttribute failed: 0x%x\n";
              }
            }
          }
        }
        DbgPrintEx(0x96,0,pcVar12,uVar14,uVar6);
        uVar14 = extraout_EDX_02;
      }
      else {
        puVar9 = (uint *)(local_3fc + 0x13b);
        RtlGetNtSystemRoot(puVar10);
        iVar4 = FUN_6b850f02((wchar_t *)puVar9,0x125,L"%s\\system32\\%s");
        puVar10 = puVar9;
        if (-1 < iVar4) goto LAB_6b863594;
        DbgPrintEx(0x96,0,
                   "WER/CrashAPI:%u: ERROR StringCchPrintf failed while printing the debugger path with 0x%x\n"
                   ,0x12d4,iVar4);
        uVar14 = extraout_EDX_01;
        lpCommandLine = local_3fc;
      }
LAB_6b86386d:
      if (local_3f0 != (undefined4 *)0x0) {
        VirtualFreeEx(local_40c,local_3f0,0,0x8000);
        uVar14 = extraout_EDX_04;
      }
      if (local_408 != (HANDLE)0x0) {
        CloseHandle(local_408);
        uVar14 = extraout_EDX_05;
      }
    }
  }
  if (local_414 != (HANDLE)0x0) {
    CloseHandle(local_414);
    local_414 = (HANDLE)0x0;
    uVar14 = extraout_EDX_06;
  }
  if (local_3cc.hProcess != (HANDLE)0x0) {
    CloseHandle(local_3cc.hProcess);
    uVar14 = extraout_EDX_07;
  }
  if (local_3cc.hThread != (HANDLE)0x0) {
    CloseHandle(local_3cc.hThread);
    uVar14 = extraout_EDX_08;
  }
  if (local_3e0 != 0) {
    if (lpAttributeList == (LPPROC_THREAD_ATTRIBUTE_LIST)0x0) goto LAB_6b8638f2;
    DeleteProcThreadAttributeList(lpAttributeList);
    uVar14 = extraout_EDX_09;
  }
  if (lpAttributeList != (LPPROC_THREAD_ATTRIBUTE_LIST)0x0) {
    VirtualFree(lpAttributeList,0,0x8000);
    uVar14 = extraout_EDX_10;
  }
LAB_6b8638f2:
  pvVar2 = local_3dc;
  if (local_3dc != (HANDLE)0x0) {
    RtlSetCurrentTransaction(local_3dc);
    CloseHandle(pvVar2);
    uVar14 = extraout_EDX_11;
  }
  if (lpCommandLine != (wchar_t *)0x0) {
    VirtualFree(lpCommandLine,0,0x8000);
    uVar14 = extraout_EDX_12;
  }
  FUN_6b8224af(local_c ^ (uint)&local_414,uVar14);
  return;
}



void __fastcall FUN_6b86393d(int param_1)

{
  int iVar1;
  int *local_8;
  
  local_8 = (int *)0x0;
  iVar1 = FUN_6b8620dd(&local_8);
  if (iVar1 < 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpGetRecoveryInfoForSelf failed with 0x%x\n",0xf73,
               iVar1);
  }
  else if (local_8[0xc] == 1) {
    local_8[0xd] = param_1;
    if ((local_8[8] | local_8[9]) == 0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR No done event for recovery mode\n",0xf86);
    }
    else {
      SetEvent((HANDLE)local_8[8]);
    }
  }
  return;
}



undefined4 __fastcall FUN_6b8639af(undefined4 *param_1)

{
  int *piVar1;
  undefined4 uVar2;
  int iVar3;
  DWORD DVar4;
  int *local_8;
  
  local_8 = (int *)0x0;
  if (param_1 == (undefined4 *)0x0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid params\n",0xf33);
    uVar2 = 0x80070057;
  }
  else {
    *param_1 = 0;
    iVar3 = FUN_6b8620dd(&local_8);
    piVar1 = local_8;
    if (iVar3 < 0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpGetRecoveryInfoForSelf failed with 0x%x\n",0xf3c
                 ,iVar3);
      uVar2 = 0x80004005;
    }
    else if (local_8[0xc] == 0) {
      uVar2 = 0x80004005;
    }
    else {
      DVar4 = WaitForSingleObject((HANDLE)local_8[10],0);
      if (DVar4 == 0) {
        *param_1 = 1;
      }
      else if ((piVar1[6] | piVar1[7]) != 0) {
        SetEvent((HANDLE)piVar1[6]);
      }
      uVar2 = 0;
    }
  }
  return uVar2;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4
// WARNING: Could not reconcile some variable overlaps

uint __fastcall FUN_6b863a4f(wchar_t *param_1,int param_2,uint param_3)

{
  wchar_t wVar1;
  bool bVar2;
  undefined3 extraout_var;
  uint uVar3;
  int iVar4;
  ushort *puVar5;
  int *_Dst;
  wchar_t *pwVar6;
  undefined4 *in_FS_OFFSET;
  uint local_30;
  uint local_24;
  uint local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b892680;
  uStack12 = 0x6b863a5b;
  local_24 = 0;
  bVar2 = FUN_6b81813c();
  if (CONCAT31(extraout_var,bVar2) == 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid state\n",0x8c2);
    uVar3 = 0x8007139f;
  }
  else {
    if (param_1 == (wchar_t *)0x0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid params\n",0x8c8);
    }
    else if (((param_3 & 0xfffffffc) == 0) && ((param_2 == 1 || (param_2 == 2)))) {
      pwVar6 = param_1;
      do {
        wVar1 = *pwVar6;
        pwVar6 = pwVar6 + 1;
      } while (wVar1 != L'\0');
      uVar3 = FUN_6b839286((int)pwVar6 - (int)(param_1 + 1) >> 1,1,&local_24);
      if ((int)uVar3 < 0) {
        DbgPrintEx(0x96,0,
                   "WER/CrashAPI:%u: ERROR Arithmetic overflow when calculating filename size\n",
                   0x8de);
      }
      else {
        local_30 = (uint)((ulonglong)local_24 * 2);
        if ((int)((ulonglong)local_24 * 2 >> 0x20) == 0) {
          local_24 = 0;
        }
        else {
          local_24 = 0x80070216;
          local_30 = 0xffffffff;
        }
        if ((int)local_24 < 0) {
          DbgPrintEx(0x96,0,
                     "WER/CrashAPI:%u: ERROR Arithmetic overflow when calculating filename size\n",
                     0x8e6);
          uVar3 = local_24;
        }
        else {
          local_20 = FUN_6b839286(0x20,local_30,&local_24);
          if ((int)local_20 < 0) {
            DbgPrintEx(0x96,0,
                       "WER/CrashAPI:%u: ERROR Arithmetic overflow when calculating allocation size\n"
                       ,0x8ee);
            uVar3 = local_20;
          }
          else if (local_24 < 0x229) {
            iVar4 = FUN_6b8182bd();
            if (iVar4 < 0) {
              DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpInitPEBStore failed\n",0x8fa);
              uVar3 = 0x80004005;
            }
            else {
              local_8 = (undefined *)0x0;
              FUN_6b863eeb(param_1);
              puVar5 = FUN_6b862000();
              if (puVar5 == (ushort *)0x0) {
                DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Unable to get the heap handle\n",0x90c);
                uVar3 = 0x80004005;
              }
              else {
                _Dst = FUN_6b8644d6((int)puVar5,local_24);
                if (_Dst == (int *)0x0) {
                  DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR OOM\n",0x916);
                  uVar3 = 0x8007000e;
                }
                else {
                  memset(_Dst,0,local_24);
                  *(ushort *)(_Dst + 2) = *(ushort *)(_Dst + 2) & 0x3fff | 0x4000;
                  *(ushort *)(_Dst + 4) =
                       *(ushort *)(_Dst + 4) ^ (*(ushort *)(_Dst + 4) ^ (ushort)param_3) & 0x7fff;
                  *(ushort *)(_Dst + 2) =
                       *(ushort *)(_Dst + 2) ^ (*(ushort *)(_Dst + 2) ^ (ushort)local_24) & 0x3fff;
                  if (param_2 == 1) {
                    *(ushort *)(_Dst + 4) = *(ushort *)(_Dst + 4) & 0x7fff;
                  }
                  else if (param_2 == 2) {
                    *(ushort *)(_Dst + 4) = *(ushort *)(_Dst + 4) | 0x8000;
                  }
                  uVar3 = FUN_6b861a59((short *)((int)_Dst + 0x12),local_30,(int)param_1);
                  if (-1 < (int)uVar3) {
                    local_20 = uVar3;
                    uVar3 = FUN_6b861b07(_Dst);
                  }
                }
              }
              local_8 = (undefined *)0xfffffffe;
              local_20 = uVar3;
              FUN_6b863d0f();
            }
          }
          else {
            DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Final gather block size exceeds limit\n",0x8f4
                      );
            uVar3 = 0x800700ce;
          }
        }
      }
      goto LAB_6b863abb;
    }
    uVar3 = 0x80070057;
  }
LAB_6b863abb:
  *in_FS_OFFSET = local_14;
  return uVar3;
}



void FUN_6b863d0f(void)

{
  int unaff_EBX;
  int unaff_EBP;
  undefined4 unaff_ESI;
  int unaff_EDI;
  
  if ((unaff_EBX < 0) && (unaff_EDI != 0)) {
    FUN_6b864756(*(int *)(unaff_EBP + -0x30),unaff_EDI);
    *(undefined4 *)(unaff_EBP + -0x28) = unaff_ESI;
  }
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

int __fastcall FUN_6b863d25(short *param_1,int param_2)

{
  short sVar1;
  bool bVar2;
  undefined3 extraout_var;
  int iVar3;
  ushort *puVar4;
  int *_Dst;
  short *psVar5;
  int iVar6;
  uint _Size;
  undefined4 *in_FS_OFFSET;
  char *pcVar7;
  undefined4 uVar8;
  undefined4 local_30;
  uint local_2c;
  int *local_28;
  short *local_24;
  int local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b892700;
  uStack12 = 0x6b863d31;
  iVar6 = -0x7fffbffb;
  local_20 = 0x80004005;
  local_28 = (int *)0x0;
  local_30 = 0;
  local_24 = param_1;
  bVar2 = FUN_6b81813c();
  if (CONCAT31(extraout_var,bVar2) == 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid state\n",0x14dd);
    iVar6 = -0x7ff8ec61;
    goto LAB_6b863dbe;
  }
  if (local_24 == (short *)0x0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid arguments in call to function\n",0x14e3);
    iVar6 = -0x7ff8ffa9;
    goto LAB_6b863dbe;
  }
  iVar3 = FUN_6b8182bd();
  if (iVar3 < 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpInitPEBStore failed\n",0x14e9);
    goto LAB_6b863dbe;
  }
  local_8 = (undefined *)0x0;
  psVar5 = local_24;
  do {
    sVar1 = *psVar5;
    psVar5 = psVar5 + 1;
  } while (sVar1 != 0);
  local_2c = ((int)psVar5 - (int)(local_24 + 1) >> 1) * 2 + 2;
  puVar4 = FUN_6b862000();
  if (puVar4 == (ushort *)0x0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Unable to get the heap handle\n",0x14fd);
    local_20 = iVar6;
  }
  else {
    _Size = local_2c + 0x18;
    _Dst = FUN_6b8644d6((int)puVar4,_Size);
    local_28 = _Dst;
    if (_Dst == (int *)0x0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR OOM\n",0x1507);
      iVar6 = -0x7ff8fff2;
      local_20 = iVar6;
    }
    else {
      memset(_Dst,0,_Size);
      _Dst[4] = param_2;
      _Dst[5] = param_2 >> 0x1f;
      _Dst[2] = _Size;
      iVar6 = FUN_6b861a59((short *)(_Dst + 6),local_2c,(int)local_24);
      if (iVar6 < 0) {
        uVar8 = 0x151d;
        pcVar7 = "WER/CrashAPI:%u: ERROR StringCbCopy failed\n";
      }
      else {
        local_20 = iVar6;
        iVar6 = FUN_6b861c18(_Dst,&local_30);
        local_20 = iVar6;
        if (-1 < iVar6) goto LAB_6b863eb6;
        uVar8 = 0x1528;
        pcVar7 = "WER/CrashAPI:%u: ERROR Failed register runtime crash dll\n";
      }
      local_20 = iVar6;
      DbgPrintEx(0x96,0,pcVar7,uVar8);
    }
  }
LAB_6b863eb6:
  local_8 = (undefined *)0xfffffffe;
  FUN_6b863ecf();
LAB_6b863dbe:
  *in_FS_OFFSET = local_14;
  return iVar6;
}



void FUN_6b863ecf(void)

{
  int unaff_EBX;
  int unaff_EBP;
  undefined4 unaff_ESI;
  int unaff_EDI;
  
  if (((unaff_EDI < 0) || (*(int *)(unaff_EBP + -0x2c) != 0)) && (unaff_EBX != 0)) {
    FUN_6b864756(*(int *)(unaff_EBP + -0x30),unaff_EBX);
    *(undefined4 *)(unaff_EBP + -0x24) = unaff_ESI;
  }
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

int __fastcall FUN_6b863eeb(wchar_t *param_1)

{
  bool bVar1;
  undefined3 extraout_var;
  int iVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  undefined4 *in_FS_OFFSET;
  char *pcVar6;
  undefined4 uVar7;
  undefined4 *local_28;
  undefined4 *local_24;
  int local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b8926a0;
  uStack12 = 0x6b863ef7;
  local_28 = (undefined4 *)0x0;
  local_24 = (undefined4 *)0x0;
  iVar5 = -0x7fffbffb;
  local_20 = -0x7fffbffb;
  if (param_1 == (wchar_t *)0x0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid args\n",0x621);
    iVar5 = -0x7ff8ffa9;
  }
  else {
    bVar1 = FUN_6b81813c();
    if (CONCAT31(extraout_var,bVar1) == 0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid state\n",0x627);
      iVar5 = -0x7ff8ec61;
    }
    else {
      iVar2 = FUN_6b818381();
      if (iVar2 == 0) {
        uVar7 = 0x62f;
        pcVar6 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
      }
      else {
        iVar3 = FUN_6b818333();
        if (-1 < iVar3) {
          local_8 = (undefined *)0x0;
          iVar2 = *(int *)(iVar2 + 0x230);
          if ((iVar2 == 0) || (uVar4 = FUN_6b81826e(iVar2), (int)uVar4 < 0)) {
            DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR PEB is not initialized\n",0x63f);
          }
          else {
            iVar5 = FUN_6b8628eb(param_1,&local_28,&local_24);
            local_20 = iVar5;
            if (iVar5 == 0) {
              iVar5 = FUN_6b86284b(iVar2,local_28,local_24);
              local_20 = iVar5;
            }
          }
          local_8 = (undefined *)0xfffffffe;
          FUN_6b864014();
          goto LAB_6b863f7d;
        }
        uVar7 = 0x635;
        pcVar6 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
      }
      DbgPrintEx(0x96,0,pcVar6,uVar7);
    }
  }
LAB_6b863f7d:
  *in_FS_OFFSET = local_14;
  return iVar5;
}



void FUN_6b864014(void)

{
  RtlReleasePebLock();
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

int __fastcall FUN_6b86401b(int param_1)

{
  bool bVar1;
  undefined3 extraout_var;
  int iVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  undefined4 *in_FS_OFFSET;
  char *pcVar6;
  undefined4 uVar7;
  undefined4 *local_28;
  undefined4 *local_24;
  int local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b8926c0;
  uStack12 = 0x6b864027;
  local_28 = (undefined4 *)0x0;
  local_24 = (undefined4 *)0x0;
  iVar5 = -0x7ff8fb70;
  local_20 = -0x7ff8fb70;
  if (param_1 == 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid args\n",0xb02);
    iVar5 = -0x7ff8ffa9;
    goto LAB_6b86413d;
  }
  bVar1 = FUN_6b81813c();
  if (CONCAT31(extraout_var,bVar1) == 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid state\n",0xb08);
    iVar5 = -0x7ff8ec61;
    goto LAB_6b86413d;
  }
  iVar2 = FUN_6b818381();
  if (iVar2 == 0) {
    uVar7 = 0xb10;
    pcVar6 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
  }
  else {
    iVar3 = FUN_6b818333();
    if (-1 < iVar3) {
      local_8 = (undefined *)0x0;
      iVar2 = *(int *)(iVar2 + 0x230);
      if (iVar2 == 0) {
LAB_6b864115:
        DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR PEB is not initialized\n",0xb20);
      }
      else {
        uVar4 = FUN_6b81826e(iVar2);
        if ((int)uVar4 < 0) goto LAB_6b864115;
        iVar5 = FUN_6b8629fd(param_1,&local_28,&local_24);
        local_20 = iVar5;
        if (iVar5 == 0) {
          iVar5 = FUN_6b86284b(iVar2,local_28,local_24);
          local_20 = iVar5;
        }
      }
      local_8 = (undefined *)0xfffffffe;
      FUN_6b864150();
      goto LAB_6b86413d;
    }
    uVar7 = 0xb16;
    pcVar6 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
  }
  DbgPrintEx(0x96,0,pcVar6,uVar7);
  iVar5 = -0x7fffbffb;
LAB_6b86413d:
  *in_FS_OFFSET = local_14;
  return iVar5;
}



void FUN_6b864150(void)

{
  RtlReleasePebLock();
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 __fastcall FUN_6b864157(ushort *param_1,int param_2)

{
  ushort uVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  ushort *puVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  ushort *puVar8;
  undefined4 uVar9;
  undefined4 *puVar10;
  undefined4 *in_FS_OFFSET;
  bool bVar11;
  char *pcVar12;
  undefined4 uVar13;
  undefined4 local_14;
  
  uVar9 = 0x80004005;
  if (param_1 == (ushort *)0x0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid arguments in call to function\n",0x1557);
    uVar9 = 0x80070057;
  }
  else {
    iVar2 = FUN_6b818381();
    if (iVar2 == 0) {
      uVar13 = 0x155f;
      pcVar12 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
    }
    else {
      iVar3 = FUN_6b818333();
      if (-1 < iVar3) {
        iVar2 = *(int *)(iVar2 + 0x230);
        if ((iVar2 == 0) || (uVar4 = FUN_6b81826e(iVar2), (int)uVar4 < 0)) {
          DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid PEB entry\n",0x1571);
        }
        else {
          puVar5 = FUN_6b862000();
          if (puVar5 == (ushort *)0x0) {
            DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Unable to get the heap handle\n",0x157c);
          }
          else {
            puVar6 = *(undefined4 **)(iVar2 + 0x8f8);
            puVar10 = (undefined4 *)0x0;
            while (puVar7 = puVar6, puVar7 != (undefined4 *)0x0) {
              puVar6 = puVar7 + 6;
              puVar8 = param_1;
              do {
                uVar1 = *(ushort *)puVar6;
                bVar11 = uVar1 < *puVar8;
                if (uVar1 != *puVar8) {
LAB_6b864265:
                  uVar4 = -(uint)bVar11 | 1;
                  goto LAB_6b86426a;
                }
                if (uVar1 == 0) break;
                uVar1 = *(ushort *)((int)puVar6 + 2);
                bVar11 = uVar1 < puVar8[1];
                if (uVar1 != puVar8[1]) goto LAB_6b864265;
                puVar6 = puVar6 + 1;
                puVar8 = puVar8 + 2;
              } while (uVar1 != 0);
              uVar4 = 0;
LAB_6b86426a:
              if (((uVar4 == 0) && (puVar7[4] == param_2)) && (puVar7[5] == param_2 >> 0x1f)) {
                uVar9 = puVar7[1];
                if (puVar10 == (undefined4 *)0x0) {
                  *(undefined4 *)(iVar2 + 0x8f8) = *puVar7;
                  *(undefined4 *)(iVar2 + 0x8fc) = uVar9;
                }
                else {
                  *puVar10 = *puVar7;
                  puVar10[1] = uVar9;
                }
                FUN_6b864756((int)puVar5,(int)puVar7);
                uVar9 = 0;
                goto LAB_6b8642d3;
              }
              puVar10 = puVar7;
              puVar6 = (undefined4 *)*puVar7;
            }
            uVar9 = 0x80070002;
          }
        }
LAB_6b8642d3:
        FUN_6b8642e7();
        goto LAB_6b8641be;
      }
      uVar13 = 0x1567;
      pcVar12 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
    }
    DbgPrintEx(0x96,0,pcVar12,uVar13);
  }
LAB_6b8641be:
  *in_FS_OFFSET = local_14;
  return uVar9;
}



void FUN_6b8642e7(void)

{
  RtlReleasePebLock();
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 __fastcall FUN_6b8642ee(int param_1)

{
  undefined4 uVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  code *pcVar5;
  undefined4 *in_FS_OFFSET;
  char *pcVar6;
  undefined4 local_14;
  
  if (param_1 == 0) {
    DbgPrintEx(0x96,0,"WER/Recovery:%u: ERROR Invalid params\n",0x59);
    uVar1 = 0x80070057;
  }
  else if (*(int *)(param_1 + 0x30) == 0) {
    iVar2 = NtClearEvent(*(undefined4 *)(param_1 + 0x18));
    iVar3 = NtClearEvent(*(undefined4 *)(param_1 + 0x20));
    iVar4 = NtClearEvent(*(undefined4 *)(param_1 + 0x28));
    if (iVar4 < 0 || (iVar3 < 0 || iVar2 < 0)) {
      uVar1 = 0x6b;
      pcVar6 = "WER/Recovery:%u: ERROR Invalid events\n";
    }
    else {
      if ((*(uint *)(param_1 + 8) | *(uint *)(param_1 + 0xc)) != 0) {
        *(undefined4 *)(param_1 + 0x30) = 1;
        uVar1 = *(undefined4 *)(param_1 + 0x10);
        pcVar5 = (code *)RtlDecodeSystemPointer(*(undefined4 *)(param_1 + 8));
        _guard_check_icall();
        (*pcVar5)(uVar1);
        *(undefined4 *)(param_1 + 0x30) = 0;
        uVar1 = 0;
        goto LAB_6b86442e;
      }
      uVar1 = 0x8a;
      pcVar6 = "WER/Recovery:%u: ERROR No recovery function found\n";
    }
    DbgPrintEx(0x96,0,pcVar6,uVar1);
    uVar1 = 0x80004005;
  }
  else {
    DbgPrintEx(0x96,0,"WER/Recovery:%u: ERROR Already in recovery\n",0x5f);
    uVar1 = 0x8007139f;
  }
LAB_6b86442e:
  *in_FS_OFFSET = local_14;
  return uVar1;
}



int FUN_6b86443e(void)

{
  int iVar1;
  int *local_8;
  
  local_8 = (int *)0x0;
  iVar1 = FUN_6b8620dd(&local_8);
  if (iVar1 == 0) {
    iVar1 = FUN_6b8642ee((int)local_8);
    if (iVar1 < 0) {
      DbgPrintEx(0x96,0,"WER/Recovery:%u: ERROR WerpInitiateRecovery failed\n",0x225);
    }
    else {
      iVar1 = 0;
    }
  }
  else {
    DbgPrintEx(0x96,0,
               "WER/Recovery:%u: ERROR No recovery rotuine found when control reached WerpRecoveryInvokedRemotely\n"
               ,0x21b);
    iVar1 = -0x7fffbffb;
  }
  return iVar1;
}



undefined4 __fastcall FUN_6b8644a7(int param_1,undefined4 *param_2)

{
  param_2[1] = 0;
  *param_2 = *(undefined4 *)(param_1 + 0x28);
  if ((*(uint *)(param_1 + 0x20) | *(uint *)(param_1 + 0x24)) == 0) {
    *(undefined4 *)(param_1 + 0x24) = 0;
    *(undefined4 **)(param_1 + 0x20) = param_2;
  }
  if ((*(uint *)(param_1 + 0x28) | *(uint *)(param_1 + 0x2c)) != 0) {
    *(undefined4 **)(*(int *)(param_1 + 0x28) + 4) = param_2;
  }
  *(undefined4 *)(param_1 + 0x2c) = 0;
  *(undefined4 **)(param_1 + 0x28) = param_2;
  return 0;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

int * __fastcall FUN_6b8644d6(int param_1,uint param_2)

{
  bool bVar1;
  uint uVar2;
  undefined3 extraout_var;
  int iVar3;
  int *piVar4;
  _SYSTEM_INFO *p_Var5;
  undefined4 *in_FS_OFFSET;
  char *pcVar6;
  undefined4 uVar7;
  _SYSTEM_INFO local_68;
  uint local_44;
  uint local_40;
  undefined4 local_3c;
  int local_38;
  int *local_34;
  uint local_30;
  int *local_2c;
  int *local_28;
  int local_24;
  uint local_20 [3];
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b8927a0;
  uStack12 = 0x6b8644e2;
  local_24 = 0;
  piVar4 = (int *)0x0;
  local_28 = (int *)0x0;
  local_2c = (int *)0x0;
  local_34 = (int *)0x0;
  local_3c = 0;
  local_30 = 0;
  local_38 = param_1;
  if ((param_1 == 0) || (param_2 == 0)) {
    DbgPrintEx(0x96,0,"WER/Heap:%u: ERROR Invalid arguments\n",0x15d);
    SetLastError(0x57);
  }
  else {
    uVar2 = FUN_6b8141f4(param_2,0x20,local_20);
    if ((int)uVar2 < 0) {
      uVar7 = 0x16a;
      pcVar6 = "WER/Heap:%u: ERROR Arithmetic overflow when calculating block size\n";
    }
    else {
      uVar2 = FUN_6b8141f4(local_20[0],7,local_20);
      if (-1 < (int)uVar2) {
        local_20[0] = local_20[0] & 0xfffffff8;
        uVar2 = 0;
      }
      if ((int)uVar2 < 0) {
        uVar7 = 0x175;
        pcVar6 = "WER/Heap:%u: ERROR Arithmetic overflow when aligning block size\n";
      }
      else {
        p_Var5 = &local_68;
        for (iVar3 = 9; iVar3 != 0; iVar3 = iVar3 + -1) {
          p_Var5->u = 0;
          p_Var5 = (_SYSTEM_INFO *)&p_Var5->dwPageSize;
        }
        GetSystemInfo(&local_68);
        iVar3 = local_38;
        local_40 = local_68.dwPageSize;
        if (local_68.dwPageSize == 0) {
          uVar7 = 0x187;
          pcVar6 = "WER/Heap:%u: ERROR Invalid page size, GetSystemInfo  may have failed\n";
        }
        else {
          bVar1 = FUN_6b8648fe(local_38);
          if (CONCAT31(extraout_var,bVar1) != 0) {
            local_8 = (undefined *)0x0;
            if ((*(uint *)(iVar3 + 0x38) | *(uint *)(iVar3 + 0x3c)) == 0) {
              local_24 = 1;
LAB_6b86461c:
              piVar4 = (int *)VirtualAlloc((LPVOID)0x0,local_20[0],0x3000,4);
              local_28 = piVar4;
              if (piVar4 != (int *)0x0) goto LAB_6b864636;
            }
            else {
              if ((*(uint *)(iVar3 + 0x40) | *(uint *)(iVar3 + 0x44)) != 0) {
                piVar4 = FUN_6b864873(iVar3,local_20[0] - 0x20);
                local_44 = (uint)(piVar4 != (int *)0x0);
                local_30 = local_44;
                local_28 = piVar4;
              }
              if (piVar4 == (int *)0x0) {
                uVar2 = local_40 - *(uint *)(iVar3 + 0x38) % local_40;
                if ((uVar2 < local_20[0]) || (uVar2 == local_40)) {
                  local_24 = 1;
                }
                else {
                  piVar4 = *(int **)(iVar3 + 0x38);
                  local_28 = piVar4;
                }
              }
              if (local_24 != 0) goto LAB_6b86461c;
LAB_6b864636:
              if (local_30 == 0) {
                *(uint *)(iVar3 + 0x38) = local_20[0] + (int)piVar4;
                *(int *)(iVar3 + 0x3c) = (int)(local_20[0] + (int)piVar4) >> 0x1f;
                piVar4[4] = local_20[0] - 0x20;
                piVar4[5] = 0;
              }
              local_34 = piVar4 + 8;
              piVar4[2] = (int)local_34;
              piVar4[6] = 1;
              local_2c = local_34;
              FUN_6b8644a7(iVar3,piVar4);
              local_3c = 1;
            }
            local_8 = (undefined *)0xfffffffe;
            FUN_6b86469c();
            goto LAB_6b8646e4;
          }
          uVar7 = 0x18d;
          pcVar6 = "WER/Heap:%u: ERROR Failed to lock the heap\n";
        }
      }
    }
    DbgPrintEx(0x96,0,pcVar6,uVar7);
  }
  local_2c = (int *)0x0;
LAB_6b8646e4:
  *in_FS_OFFSET = local_14;
  return local_2c;
}



void FUN_6b86469c(void)

{
  LPVOID unaff_EBX;
  int unaff_EBP;
  SIZE_T unaff_ESI;
  int unaff_EDI;
  
  FUN_6b864921(unaff_EDI);
  if (((*(int *)(unaff_EBP + -0x38) == 0) && (unaff_EBX != (LPVOID)0x0)) &&
     (*(int *)(unaff_EBP + -0x20) != 0)) {
    VirtualFree(unaff_EBX,unaff_ESI,0x8000);
  }
  return;
}



undefined4 __fastcall FUN_6b8646f4(short *param_1)

{
  int iVar1;
  HANDLE pvVar2;
  undefined4 uVar3;
  
  uVar3 = 0;
  memset(param_1,0,0x48);
  iVar1 = FUN_6b861a82(param_1,0xf,(int)&DAT_6b88b6d8);
  if (iVar1 < 0) {
    DbgPrintEx(0x96,0,"WER/Heap:%u: ERROR Could not set heap signature\n",0x76);
    uVar3 = 0x80004005;
  }
  else {
    pvVar2 = CreateMutexW((LPSECURITY_ATTRIBUTES)0x0,0,(LPCWSTR)0x0);
    *(HANDLE *)(param_1 + 0x18) = pvVar2;
    *(int *)(param_1 + 0x1a) = (int)pvVar2 >> 0x1f;
    if (((uint)pvVar2 | (int)pvVar2 >> 0x1f) == 0) {
      uVar3 = 0x80004005;
    }
  }
  return uVar3;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 __fastcall FUN_6b864756(int param_1,int param_2)

{
  int *piVar1;
  int **ppiVar2;
  bool bVar3;
  undefined3 extraout_var;
  undefined4 uVar4;
  undefined4 *in_FS_OFFSET;
  undefined4 local_14;
  
  uVar4 = 0;
  if ((param_1 == 0) || (param_2 == 0)) {
    DbgPrintEx(0x96,0,"WER/Heap:%u: ERROR Invalid arguments\n",0x224);
    SetLastError(0x57);
  }
  else {
    bVar3 = FUN_6b8648fe(param_1);
    if (CONCAT31(extraout_var,bVar3) != 0) {
      piVar1 = (int *)(param_2 + -0x20);
      if (*(int *)(param_2 + -0x18) == param_2) {
        if (*piVar1 != 0) {
          *(undefined4 *)(*piVar1 + 4) = *(undefined4 *)(param_2 + -0x1c);
        }
        if (*(int **)(param_2 + -0x1c) != (int *)0x0) {
          **(int **)(param_2 + -0x1c) = *piVar1;
        }
        if (piVar1 == *(int **)(param_1 + 0x20)) {
          *(undefined4 *)(param_1 + 0x20) = *(undefined4 *)(param_2 + -0x1c);
          *(undefined4 *)(param_1 + 0x24) = 0;
        }
        if (piVar1 == *(int **)(param_1 + 0x28)) {
          *(int *)(param_1 + 0x28) = *piVar1;
          *(undefined4 *)(param_1 + 0x2c) = 0;
        }
        *(undefined4 *)(param_2 + -8) = 0;
        ppiVar2 = *(int ***)(param_1 + 0x40);
        *(int ***)(param_2 + -0x1c) = ppiVar2;
        if (ppiVar2 != (int **)0x0) {
          *ppiVar2 = piVar1;
        }
        *piVar1 = 0;
        *(int **)(param_1 + 0x40) = piVar1;
        *(undefined4 *)(param_1 + 0x44) = 0;
        uVar4 = 1;
      }
      else {
        DbgPrintEx(0x96,0,"WER/Heap:%u: ERROR Invalid block passed\n",0x23b);
        SetLastError(0x57);
      }
      FUN_6b864838();
      goto LAB_6b864863;
    }
    DbgPrintEx(0x96,0,"WER/Heap:%u: ERROR Failed to lock the heap\n",0x22c);
  }
  uVar4 = 0;
LAB_6b864863:
  *in_FS_OFFSET = local_14;
  return uVar4;
}



void FUN_6b864838(void)

{
  int unaff_EDI;
  
  FUN_6b864921(unaff_EDI);
  return;
}



int * __fastcall FUN_6b864873(int param_1,uint param_2)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  int *piVar6;
  bool bVar7;
  
  piVar6 = (int *)0x0;
  piVar4 = (int *)(*(uint *)(param_1 + 0x40) | *(uint *)(param_1 + 0x44));
  if ((piVar4 != (int *)0x0) &&
     (piVar5 = *(int **)(param_1 + 0x40), piVar4 = piVar6, piVar5 != (int *)0x0)) {
    do {
      uVar1 = piVar5[4];
      uVar2 = piVar5[5];
      if ((uVar1 == param_2) && (piVar4 = piVar5, uVar2 == 0)) break;
      if (((uVar2 != 0) || (param_2 < uVar1)) &&
         ((piVar6 == (int *)0x0 ||
          ((bVar7 = uVar2 < (uint)piVar6[5], bVar7 || uVar2 == piVar6[5] &&
           ((bVar7 || (uVar1 < (uint)piVar6[4])))))))) {
        piVar6 = piVar5;
      }
      piVar5 = (int *)piVar5[1];
      piVar4 = piVar6;
    } while (piVar5 != (int *)0x0);
    if (piVar4 != (int *)0x0) {
      if (*piVar4 != 0) {
        *(int *)(*piVar4 + 4) = piVar4[1];
      }
      if ((int *)piVar4[1] != (int *)0x0) {
        *(int *)piVar4[1] = *piVar4;
      }
      if (*(int **)(param_1 + 0x40) == piVar4) {
        iVar3 = piVar4[1];
        *(int *)(param_1 + 0x40) = iVar3;
        *(int *)(param_1 + 0x44) = iVar3 >> 0x1f;
      }
      memset((void *)piVar4[2],0,piVar4[4]);
    }
  }
  return piVar4;
}



bool __fastcall FUN_6b8648fe(int param_1)

{
  DWORD DVar1;
  
  if (param_1 == 0) {
    SetLastError(0x57);
    return false;
  }
  DVar1 = WaitForSingleObject(*(HANDLE *)(param_1 + 0x30),4000);
  return (bool)('\x01' - (DVar1 != 0));
}



BOOL __fastcall FUN_6b864921(int param_1)

{
  BOOL BVar1;
  
  if (param_1 == 0) {
    SetLastError(0x57);
    return 0;
  }
  BVar1 = ReleaseMutex(*(HANDLE *)(param_1 + 0x30));
  return BVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

uint __fastcall FUN_6b86493a(ushort *param_1)

{
  ushort uVar1;
  uint uVar2;
  ushort *puVar3;
  undefined4 *in_FS_OFFSET;
  bool bVar4;
  undefined4 local_14;
  
  if (param_1 == (ushort *)0x0) {
    DbgPrintEx(0x96,0,"WER/Heap:%u: ERROR Invalid args\n",0x98);
    uVar2 = 0x80070057;
  }
  else {
    uVar2 = 0;
    puVar3 = &DAT_6b88b6d8;
    do {
      uVar1 = *param_1;
      bVar4 = uVar1 < *puVar3;
      if (uVar1 != *puVar3) {
LAB_6b864998:
        uVar2 = -(uint)bVar4 | 1;
        break;
      }
      if (uVar1 == 0) break;
      uVar1 = param_1[1];
      bVar4 = uVar1 < puVar3[1];
      if (uVar1 != puVar3[1]) goto LAB_6b864998;
      param_1 = param_1 + 2;
      puVar3 = puVar3 + 2;
    } while (uVar1 != 0);
    uVar2 = -(uint)(uVar2 != 0) & 0x80004005;
  }
  *in_FS_OFFSET = local_14;
  return uVar2;
}



DWORD __thiscall FUN_6b8649f7(PRPC_ASYNC_STATE this,undefined4 param_2,DWORD param_3)

{
  DWORD DVar1;
  DWORD local_8;
  
  local_8 = 0;
  if (param_3 == 0) {
    param_3 = WaitForSingleObject(*(HANDLE *)&this->u,0xffffffff);
  }
  if (param_3 == 0x102) {
    RpcAsyncCancelCall(this,1);
    WaitForSingleObject(*(HANDLE *)&this->u,0xffffffff);
  }
  DVar1 = RpcAsyncCompleteCall(this,&local_8);
  if ((param_3 == 0) && (param_3 = DVar1, DVar1 == 0)) {
    param_3 = local_8;
  }
  return param_3;
}



DWORD __fastcall FUN_6b864a55(PRPC_ASYNC_STATE param_1)

{
  DWORD DVar1;
  HANDLE pvVar2;
  
  DVar1 = RpcAsyncInitializeHandle(param_1,0x44);
  if (DVar1 == 0) {
    param_1->NotificationType = RpcNotificationTypeEvent;
    pvVar2 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCWSTR)0x0);
    *(HANDLE *)&param_1->u = pvVar2;
    if (pvVar2 == (HANDLE)0x0) {
      DVar1 = GetLastError();
    }
  }
  return DVar1;
}



DWORD FUN_6b864a8f(RPC_BINDING_HANDLE *param_1)

{
  RPC_BINDING_HANDLE pvVar1;
  DWORD DVar2;
  BOOL BVar3;
  int iVar4;
  RPC_SECURITY_QOS *pRVar5;
  HLOCAL pSid;
  RPC_SECURITY_QOS local_2c;
  HLOCAL local_14;
  DWORD local_10;
  RPC_WSTR local_c;
  RPC_BINDING_HANDLE local_8;
  
  pRVar5 = &local_2c;
  for (iVar4 = 7; iVar4 != 0; iVar4 = iVar4 + -1) {
    pRVar5->Version = 0;
    pRVar5 = (RPC_SECURITY_QOS *)&pRVar5->Capabilities;
  }
  local_c = (RPC_WSTR)0x0;
  local_8 = (RPC_BINDING_HANDLE)0x0;
  pSid = (HLOCAL)0x0;
  DVar2 = RpcStringBindingComposeW
                    ((RPC_WSTR)L"0497B57D-2E66-424F-A0C6-157CD5D41700",(RPC_WSTR)L"ncalrpc",
                     (RPC_WSTR)0x0,(RPC_WSTR)0x0,(RPC_WSTR)0x0,&local_c);
  if (DVar2 == 0) {
    DVar2 = RpcBindingFromStringBindingW(local_c,&local_8);
    RpcStringFreeW(&local_c);
    if (DVar2 == 0) {
      local_10 = 0x44;
      pSid = LocalAlloc(0x40,0x44);
      if (pSid == (HLOCAL)0x0) {
        DVar2 = 8;
      }
      else {
        BVar3 = CreateWellKnownSid(WinLocalSystemSid,(PSID)0x0,pSid,&local_10);
        if (BVar3 == 0) {
          DVar2 = GetLastError();
        }
        else {
          local_2c.Version = 3;
          local_2c.ImpersonationType = 3;
          local_2c.Capabilities = 1;
          local_2c.IdentityTracking = 0;
          local_14 = pSid;
          DVar2 = RpcBindingSetAuthInfoExW
                            (local_8,(RPC_WSTR)0x0,6,10,(RPC_AUTH_IDENTITY_HANDLE)0x0,0,&local_2c);
          pvVar1 = local_8;
          if (DVar2 == 0) {
            local_8 = (RPC_BINDING_HANDLE)0x0;
            *param_1 = pvVar1;
          }
        }
      }
    }
  }
  LocalFree(pSid);
  if (local_8 != (RPC_BINDING_HANDLE)0x0) {
    RpcBindingFree(&local_8);
  }
  return DVar2;
}



bool FUN_6b864b7c(void)

{
  BOOL BVar1;
  DWORD dwProcessId;
  DWORD *pSessionId;
  DWORD local_10;
  DWORD local_c;
  DWORD local_8;
  
  local_8 = 0;
  local_c = 0;
  local_10 = 4;
  BVar1 = GetTokenInformation((HANDLE)0xfffffffb,TokenSessionId,&local_8,4,&local_10);
  if (BVar1 == 0) {
    return false;
  }
  pSessionId = &local_c;
  dwProcessId = GetCurrentProcessId();
  ProcessIdToSessionId(dwProcessId,pSessionId);
  return local_8 != local_c;
}



// WARNING: Function: __SEH_prolog4_GS replaced with injection: SEH_prolog4
// WARNING: Removing unreachable block (ram,0x6b864c49)
// WARNING: Removing unreachable block (ram,0x6b864c50)

DWORD FUN_6b864bc9(void)

{
  bool bVar1;
  bool bVar2;
  undefined3 extraout_var;
  DWORD DVar3;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 uVar4;
  undefined4 *in_FS_OFFSET;
  undefined4 *in_stack_00000014;
  RPC_BINDING_HANDLE local_68;
  undefined local_64 [80];
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b8927c0;
  uStack12 = 0x6b864bd5;
  memset(local_64,0,0x44);
  local_68 = (RPC_BINDING_HANDLE)0x0;
  bVar1 = false;
  bVar2 = FUN_6b864b7c();
  *in_stack_00000014 = 0;
  if (((DAT_6b8b0c68 != (RPC_BINDING_HANDLE)0x0) && (CONCAT31(extraout_var,bVar2) == 0)) ||
     (DVar3 = FUN_6b864a8f(&local_68), uVar4 = extraout_ECX, DVar3 == 0)) {
    if ((DAT_6b8b0c68 == (RPC_BINDING_HANDLE)0x0) && (CONCAT31(extraout_var,bVar2) == 0)) {
      LOCK();
      DAT_6b8b0c68 = local_68;
      local_68 = (RPC_BINDING_HANDLE)0x0;
    }
    DVar3 = FUN_6b864a55((PRPC_ASYNC_STATE)local_64);
    uVar4 = extraout_ECX_00;
    if (DVar3 == 0) {
      local_8 = (undefined *)0x0;
      FUN_6b8244f0((char)local_64);
      bVar1 = true;
      local_8 = (undefined *)0xfffffffe;
      uVar4 = extraout_ECX_01;
    }
  }
  if (bVar1) {
    DVar3 = FUN_6b8649f7((PRPC_ASYNC_STATE)local_64,uVar4,DVar3);
  }
  if (local_64._36_4_ != (HANDLE)0x0) {
    CloseHandle(local_64._36_4_);
    local_64._36_4_ = (HANDLE)0x0;
  }
  if (local_68 != (RPC_BINDING_HANDLE)0x0) {
    RpcBindingFree(&local_68);
  }
  *in_FS_OFFSET = local_14;
  return DVar3;
}



// WARNING: Function: __SEH_prolog4_GS replaced with injection: SEH_prolog4
// WARNING: Removing unreachable block (ram,0x6b864d88)
// WARNING: Removing unreachable block (ram,0x6b864d8f)

DWORD FUN_6b864d16(HANDLE *param_1)

{
  bool bVar1;
  bool bVar2;
  undefined3 extraout_var;
  DWORD DVar3;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 uVar4;
  undefined4 *in_FS_OFFSET;
  RPC_BINDING_HANDLE local_68;
  undefined local_64 [80];
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b8927e0;
  uStack12 = 0x6b864d22;
  *param_1 = (HANDLE)0x0;
  memset(local_64,0,0x44);
  local_68 = (RPC_BINDING_HANDLE)0x0;
  bVar1 = false;
  bVar2 = FUN_6b864b7c();
  *param_1 = (HANDLE)0x0;
  if (((DAT_6b8b0c64 != (RPC_BINDING_HANDLE)0x0) && (CONCAT31(extraout_var,bVar2) == 0)) ||
     (DVar3 = FUN_6b864a8f(&local_68), uVar4 = extraout_ECX, DVar3 == 0)) {
    if ((DAT_6b8b0c64 == (RPC_BINDING_HANDLE)0x0) && (CONCAT31(extraout_var,bVar2) == 0)) {
      LOCK();
      DAT_6b8b0c64 = local_68;
      local_68 = (RPC_BINDING_HANDLE)0x0;
    }
    DVar3 = FUN_6b864a55((PRPC_ASYNC_STATE)local_64);
    uVar4 = extraout_ECX_00;
    if (DVar3 == 0) {
      local_8 = (undefined *)0x0;
      FUN_6b82451a((char)local_64);
      bVar1 = true;
      local_8 = (undefined *)0xfffffffe;
      uVar4 = extraout_ECX_01;
    }
  }
  if (bVar1) {
    DVar3 = FUN_6b8649f7((PRPC_ASYNC_STATE)local_64,uVar4,DVar3);
  }
  if (local_64._36_4_ != (HANDLE)0x0) {
    CloseHandle(local_64._36_4_);
    local_64._36_4_ = (HANDLE)0x0;
  }
  if (DVar3 != 0) {
    CloseHandle(*param_1);
    *param_1 = (HANDLE)0x0;
  }
  if (local_68 != (RPC_BINDING_HANDLE)0x0) {
    RpcBindingFree(&local_68);
  }
  *in_FS_OFFSET = local_14;
  return DVar3;
}



int __fastcall FUN_6b864e54(int param_1,int *param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  uint local_10;
  int local_c;
  int local_8;
  
  iVar3 = 0;
  local_8 = param_1;
  if (param_1 == 0) {
    iVar1 = NtOpenThreadToken(0xfffffffe,8,0,&local_8);
    if (iVar1 == -0x3fffff84) {
      iVar1 = NtOpenProcessToken(0xffffffff,8,&local_8);
    }
    iVar3 = local_8;
    if (iVar1 < 0) {
      return iVar1;
    }
  }
  iVar1 = FUN_6b864efc(local_8,&local_c,&local_10);
  if (-1 < iVar1) {
    if (local_c == 0) {
      *param_2 = (local_10 == 0) + 1;
    }
    else {
      *param_2 = 0;
    }
    iVar1 = FUN_6b864f69(local_8,&local_10);
    if ((-1 < iVar1) && (local_10 != 0)) {
      iVar2 = *param_2;
      if (2 < iVar2 - 0x10U) {
        iVar2 = iVar2 + 0x10;
      }
      *param_2 = iVar2;
    }
  }
  if (iVar3 != 0) {
    NtClose(iVar3);
  }
  return iVar1;
}



void __fastcall FUN_6b864efc(undefined4 param_1,undefined4 *param_2,undefined4 *param_3)

{
  int iVar1;
  int local_10;
  undefined local_c [4];
  int local_8;
  
  local_8 = 1;
  *param_3 = 1;
  *param_2 = 0;
  iVar1 = NtQueryInformationToken(param_1,0x12,&local_8,4,local_c);
  if (iVar1 < 0) {
    return;
  }
  if (local_8 != 2) {
    if (local_8 != 1) {
      return;
    }
    *param_3 = 0;
    iVar1 = NtQueryInformationToken(param_1,0x14,&local_10,4,local_c);
    if (iVar1 < 0) {
      return;
    }
    if (local_10 == 0) {
      return;
    }
  }
  *param_2 = 1;
  return;
}



void __fastcall FUN_6b864f69(int param_1,uint *param_2)

{
  int iVar1;
  int local_c;
  undefined4 local_8;
  
  *param_2 = 0;
  local_8 = 4;
  local_c = param_1;
  iVar1 = NtQueryInformationToken(param_1,0x1a,&local_c,4,&local_8);
  if (-1 < iVar1) {
    *param_2 = (uint)(local_c != 0);
  }
  return;
}



undefined4 __fastcall FUN_6b864f9f(uint param_1,uint param_2,uint *param_3)

{
  uint uVar1;
  uint uVar2;
  undefined4 uVar3;
  
  uVar3 = 0;
  uVar1 = param_1 - 0x10;
  uVar2 = param_2;
  if (2 < param_2) {
    uVar2 = param_2 - 0x10;
  }
  if (2 < param_1) {
    param_1 = param_1 - 0x10;
  }
  if (param_1 == 0) {
    *param_3 = 0;
  }
  else {
    if (param_1 == 1) {
      if ((uVar2 == 1) || (uVar2 == 2)) {
        uVar2 = 1;
      }
      else {
        uVar2 = 0;
      }
    }
    else {
      if (param_1 != 2) {
        uVar3 = 0xc00000bb;
        goto LAB_6b864ffe;
      }
      uVar2 = (uint)(uVar2 == 2);
    }
    *param_3 = uVar2;
  }
LAB_6b864ffe:
  if ((param_2 - 0x10 < 3) && (2 < uVar1)) {
    *param_3 = 1;
  }
  return uVar3;
}



int __thiscall
FUN_6b865017(HANDLE this,undefined4 param_2,wchar_t *param_3,undefined4 param_4,wchar_t *param_5,
            undefined4 param_6,short *param_7)

{
  ushort uVar1;
  int iVar2;
  undefined4 uVar3;
  undefined2 extraout_var;
  uint uVar4;
  HANDLE local_8;
  
  local_8 = this;
  FUN_6b8621d4((int)this);
  local_8 = (HANDLE)((uint)local_8 & 0xffff0000);
  iVar2 = IsWow64Process2(this,&local_8,0);
  if (iVar2 == 0) {
    uVar3 = FUN_6b865703();
    DbgPrintEx(0x96,1,"WER/ReportFault:%u: WARNING IsWow64Process2 failed: %u.\n",0xbd,uVar3);
  }
  if ((((uint)local_8 & 0xffff) == 0x14c) || (((uint)local_8 & 0xffff) == 0x1c4)) {
    uVar4 = GetSystemWow64Directory2W(param_7,0x20,local_8);
  }
  else {
    uVar1 = FUN_6b8210c4(param_7,0x20);
    uVar4 = CONCAT22(extraout_var,uVar1);
  }
  if (((uVar4 == 0) || (0x20 < uVar4)) || (*param_7 == 0)) {
    DbgPrintEx(0x96,0,
               "WER/ReportFault:%u: ERROR GetSystemWindowsDirectory failed or the size was inadequate.\n"
               ,0xcd);
    iVar2 = -0x7ff8ff5f;
  }
  else {
    iVar2 = FUN_6b850f02(param_3,0x40,L"%s\\%s");
    if (iVar2 < 0) {
      uVar3 = 0xdf;
    }
    else {
      GetProcessId(this);
      iVar2 = FUN_6b850f02(param_5,0x80,L"%s -u -p %d -s %I64d");
      if (-1 < iVar2) {
        return 0;
      }
      uVar3 = 0x115;
    }
    DbgPrintEx(0x96,0,"WER/ReportFault:%u: ERROR StringCchPrintf failed: HRESULT %08X.\n",uVar3,
               iVar2);
  }
  return iVar2;
}



undefined4 __fastcall FUN_6b865151(int param_1)

{
  if (param_1 < -0x7fe47fff) {
    if (param_1 == -0x7fe48000) {
      return 3;
    }
    if ((((param_1 == -0x7ff8fff8) || (param_1 == -0x7ff8fff2)) || (param_1 == -0x7ff8fb96)) ||
       (((param_1 == -0x7ff8fa56 || (param_1 == -0x7ff8fa51)) || (param_1 == -0x7ff8f8e8)))) {
      return 9;
    }
  }
  else {
    if ((param_1 == -0x7fe47fff) || (param_1 == 0)) {
      return 0;
    }
    if (param_1 == 0x1b0000) {
      return 6;
    }
    if (param_1 == 0x1b0001) {
      return 0;
    }
    if (param_1 == 0x1b0002) {
      return 2;
    }
    if ((0x1b000a < param_1) && (param_1 < 0x1b000d)) {
      return 0;
    }
  }
  return 4;
}



void __fastcall FUN_6b8651d7(undefined4 param_1,PVOID param_2,int param_3,HANDLE *param_4)

{
  HANDLE pvVar1;
  int iVar2;
  uint uVar3;
  BOOL BVar4;
  undefined4 extraout_ECX;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  uint uVar5;
  LPVOID lpAddress;
  wchar_t *pwVar6;
  wchar_t *pwVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  WCHAR *pWVar10;
  undefined auStack596 [4];
  int local_250;
  LPVOID local_24c;
  uint local_248;
  DWORD local_244;
  int local_240;
  PVOID local_23c;
  uint local_238;
  HANDLE *local_234;
  UINT local_230;
  int local_22c;
  _PROCESS_INFORMATION local_228;
  undefined local_218 [44];
  DWORD local_1ec;
  WORD local_1e8;
  LPVOID local_1d4;
  WCHAR local_1d0 [32];
  wchar_t local_190 [64];
  wchar_t local_110 [130];
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)auStack596;
  local_234 = param_4;
  local_23c = param_2;
  memset(local_218 + 4,0,0x44);
  local_240 = 2;
  local_218._0_4_ = 0x48;
  local_228.hProcess = (HANDLE)0x0;
  local_228.hThread = (HANDLE)0x0;
  local_228.dwProcessId = 0;
  local_228.dwThreadId = 0;
  *param_4 = (HANDLE)0x0;
  lpAddress = (LPVOID)0x0;
  local_244 = 0;
  local_250 = 0;
  local_1d0[0] = L'\0';
  local_190[0] = L'\0';
  local_110[0] = L'\0';
  local_1e8 = 0;
  pWVar10 = local_1d0;
  pwVar7 = local_110;
  local_24c = (LPVOID)0x0;
  pwVar6 = local_190;
  local_1ec = 1;
  uVar9 = extraout_ECX;
  uVar8 = extraout_ECX;
  pvVar1 = GetCurrentProcess();
  iVar2 = FUN_6b865017(pvVar1,param_1,pwVar6,uVar9,pwVar7,uVar8,pWVar10);
  if (iVar2 < 0) {
    DbgPrintEx(0x96,0,
               "WER/ReportFault:%u: ERROR Failed to get the paths for the crash vertical: HRESULT %08X.\n"
               ,0x222,iVar2);
    uVar9 = extraout_EDX;
  }
  else {
    pvVar1 = GetCurrentProcess();
    uVar3 = FUN_6b8621d4((int)pvVar1);
    uVar3 = -(uint)(uVar3 != 0) & 0x40000;
    local_238 = uVar3;
    local_230 = SetErrorMode(1);
    SetThreadErrorMode(1,&local_244);
    local_22c = RtlGetCurrentTransaction();
    RtlSetCurrentTransaction(0);
    uVar5 = 0;
    do {
      if (uVar5 == 0) {
        local_250 = 4;
        local_248 = uVar3;
      }
      else if (uVar5 == 1) {
        local_250 = 0;
        local_248 = uVar3 | 0x1000000;
      }
      else {
        if (uVar5 != 2) goto LAB_6b86547b;
        local_250 = 0;
        local_248 = uVar3;
      }
      if (lpAddress != (LPVOID)0x0) {
        VirtualFree(lpAddress,0,0x8000);
        local_24c = (LPVOID)0x0;
      }
      uVar3 = FUN_6b8654cb(&local_24c,&local_250,local_23c,param_3,&local_240);
      lpAddress = local_24c;
      if ((int)uVar3 < 0) {
        DbgPrintEx(0x96,0,
                   "WER/ReportFault:%u: ERROR WerpBuildCreateProcessAttributeList failed, HRESULT %08X.\n"
                   ,0x26e,uVar3);
        lpAddress = local_24c;
        goto LAB_6b86547b;
      }
      local_1d4 = local_24c;
      BVar4 = CreateProcessW(local_190,local_110,(LPSECURITY_ATTRIBUTES)0x0,
                             (LPSECURITY_ATTRIBUTES)0x0,1,
                             -(uint)(local_24c != (LPVOID)0x0) & 0x80000 | local_248,(LPVOID)0x0,
                             local_1d0,(LPSTARTUPINFOW)local_218,&local_228);
      if (BVar4 != 0) break;
      iVar2 = FUN_6b865703();
      if (uVar5 == 0) {
        if (iVar2 != 0x522) {
LAB_6b865419:
          DbgPrintEx(0x96,0,
                     "WER/ReportFault:%u: ERROR CreateProcess/mode%u failed with Win32 error %u.\n",
                     0x296,uVar5,iVar2);
          goto LAB_6b86547b;
        }
        iVar2 = 0x522;
        uVar9 = 0x28b;
      }
      else {
        if ((uVar5 != 1) || (iVar2 != 5)) goto LAB_6b865419;
        uVar9 = 0x291;
      }
      DbgPrintEx(0x96,1,
                 "WER/ReportFault:%u: WARNING CreateProcess/mode%u failed with Win32 error %u.\n",
                 uVar9,uVar5,iVar2);
      uVar5 = uVar5 + 1;
      uVar3 = local_238;
    } while (uVar5 < 3);
    *local_234 = local_228.hProcess;
    NtClose(local_228.hThread);
LAB_6b86547b:
    SetErrorMode(local_230);
    SetThreadErrorMode(local_244,(LPDWORD)0x0);
    uVar9 = extraout_EDX_00;
    if (local_22c != 0) {
      RtlSetCurrentTransaction(local_22c);
      uVar9 = extraout_EDX_01;
    }
    if (lpAddress != (LPVOID)0x0) {
      VirtualFree(lpAddress,0,0x8000);
      uVar9 = extraout_EDX_02;
    }
  }
  FUN_6b8224af(local_c ^ (uint)auStack596,uVar9);
  return;
}



uint __thiscall FUN_6b8654cb(void *this,int *param_1,PVOID param_2,int param_3,int *param_4)

{
  bool bVar1;
  int iVar2;
  int iVar3;
  BOOL BVar4;
  uint uVar5;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  LPPROC_THREAD_ATTRIBUTE_LIST lpAttributeList;
  int iVar6;
  DWORD dwAttributeCount;
  char *pcVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  SIZE_T local_8;
  
  local_8 = 0;
  *(undefined4 *)this = 0;
  lpAttributeList = (LPPROC_THREAD_ATTRIBUTE_LIST)0x0;
  if ((param_1 == (int *)0x0) || (*param_1 == 0)) {
    iVar6 = 0;
  }
  else {
    iVar6 = 1;
  }
  if ((param_2 == (PVOID)0x0) || (param_3 == 0)) {
    iVar2 = 0;
  }
  else {
    iVar2 = 1;
  }
  if ((param_4 == (int *)0x0) || (*param_4 == 0)) {
    iVar3 = 0;
  }
  else {
    iVar3 = 1;
  }
  dwAttributeCount = iVar6 + iVar2 + iVar3;
  if (dwAttributeCount == 0) {
    bVar1 = false;
LAB_6b8655fd:
    if (((param_1 == (int *)0x0) || (*param_1 == 0)) ||
       (BVar4 = UpdateProcThreadAttribute
                          (lpAttributeList,0,0x60001,param_1,4,(PVOID)0x0,(PSIZE_T)0x0), BVar4 != 0)
       ) {
      if (((param_2 == (PVOID)0x0) || (param_3 == 0)) ||
         (BVar4 = UpdateProcThreadAttribute
                            (lpAttributeList,0,0x20002,param_2,param_3 << 2,(PVOID)0x0,(PSIZE_T)0x0)
         , BVar4 != 0)) {
        if (((param_4 == (int *)0x0) || (*param_4 == 0)) ||
           (BVar4 = UpdateProcThreadAttribute
                              (lpAttributeList,0,0x2000e,param_4,4,(PVOID)0x0,(PSIZE_T)0x0),
           BVar4 != 0)) {
          uVar5 = (uint)(lpAttributeList == (LPPROC_THREAD_ATTRIBUTE_LIST)0x0);
          *(LPPROC_THREAD_ATTRIBUTE_LIST *)this = lpAttributeList;
          goto LAB_6b8656d9;
        }
        uVar5 = FUN_6b865703();
        uVar5 = FUN_6b8619d0(uVar5);
        uVar8 = 0x1c4;
        pcVar7 = "WER/ReportFault:%u: ERROR UpdateProcThreadAttribute/CHILD_PROCESS failed: %u.\n";
        uVar9 = extraout_EDX_03;
      }
      else {
        uVar5 = FUN_6b865703();
        uVar5 = FUN_6b8619d0(uVar5);
        uVar8 = 0x1b1;
        pcVar7 = "WER/ReportFault:%u: ERROR UpdateProcThreadAttribute/HANDLE_LIST failed: %u.\n";
        uVar9 = extraout_EDX_02;
      }
    }
    else {
      uVar5 = FUN_6b865703();
      uVar5 = FUN_6b8619d0(uVar5);
      uVar8 = 0x19e;
      pcVar7 = "WER/ReportFault:%u: ERROR UpdateProcThreadAttribute/EXTENDED_FLAGS failed: %u.\n";
      uVar9 = extraout_EDX_01;
    }
    DbgPrintEx(0x96,0,pcVar7,uVar8,uVar9);
  }
  else {
    BVar4 = InitializeProcThreadAttributeList
                      ((LPPROC_THREAD_ATTRIBUTE_LIST)0x0,dwAttributeCount,0,&local_8);
    if ((BVar4 == 0) && (iVar6 = FUN_6b865703(), iVar6 != 0x7a)) {
      uVar5 = FUN_6b865703();
      uVar5 = FUN_6b8619d0(uVar5);
      DbgPrintEx(0x96,0,"WER/ReportFault:%u: ERROR InitializeProcThreadAttributeList failed: %u.\n",
                 0x15c,extraout_EDX);
      bVar1 = false;
    }
    else {
      lpAttributeList = (LPPROC_THREAD_ATTRIBUTE_LIST)VirtualAlloc((LPVOID)0x0,local_8,0x1000,4);
      if (lpAttributeList == (LPPROC_THREAD_ATTRIBUTE_LIST)0x0) {
        uVar5 = 0x8007000e;
        DbgPrintEx(0x96,0,
                   "WER/ReportFault:%u: ERROR Failed to allocate attribute list: HRESULT %08X.\n",
                   0x169,0x8007000e);
        goto LAB_6b8656ec;
      }
      BVar4 = InitializeProcThreadAttributeList(lpAttributeList,dwAttributeCount,0,&local_8);
      if (BVar4 != 0) {
        bVar1 = true;
        goto LAB_6b8655fd;
      }
      uVar5 = FUN_6b865703();
      uVar5 = FUN_6b8619d0(uVar5);
      DbgPrintEx(0x96,0,"WER/ReportFault:%u: ERROR InitializeProcThreadAttributeList failed: %u.\n",
                 0x176,extraout_EDX_00);
      bVar1 = false;
    }
  }
LAB_6b8656d9:
  if (-1 < (int)uVar5) {
    return uVar5;
  }
  if ((bVar1) && (lpAttributeList != (LPPROC_THREAD_ATTRIBUTE_LIST)0x0)) {
    DeleteProcThreadAttributeList(lpAttributeList);
  }
LAB_6b8656ec:
  VirtualFree(lpAttributeList,0,0x8000);
  return uVar5;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

void FUN_6b865703(void)

{
  undefined4 *in_FS_OFFSET;
  undefined4 local_14;
  
  *in_FS_OFFSET = local_14;
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

bool __fastcall FUN_6b865753(int **param_1)

{
  int iVar1;
  undefined4 *in_FS_OFFSET;
  undefined4 local_14;
  
  iVar1 = **param_1;
  *in_FS_OFFSET = local_14;
  return iVar1 != -0x3fffff03;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int __fastcall FUN_6b8657aa(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int in_FS_OFFSET;
  
  iVar6 = 3;
  iVar4 = 0;
  NtSetSystemInformation(0xb1,0,0);
  if (param_1 == 0) {
    DbgPrintEx(0x96,0,"WER/ReportFault:%u: ERROR Invalid params passed\n",0x503);
  }
  else {
    if (_DAT_6b8b0c6c < 1) {
      iVar3 = 0;
      iVar1 = *(int *)(*(int *)(in_FS_OFFSET + 0x18) + 0x24);
      do {
        iVar2 = 0;
        LOCK();
        iVar5 = iVar1;
        if (DAT_6b8b08c8 != 0) {
          iVar2 = DAT_6b8b08c8;
          iVar5 = DAT_6b8b08c8;
        }
        DAT_6b8b08c8 = iVar5;
        iVar5 = iVar4;
        if (iVar2 == 0) break;
        if (iVar2 == iVar1) goto LAB_6b865849;
        iVar4 = 8;
        Sleep(1000);
        iVar3 = iVar3 + 1;
        iVar5 = iVar6;
      } while (iVar3 < 10);
      if (iVar5 == 0) {
        iVar6 = FUN_6b86585f();
      }
LAB_6b865849:
      _DAT_6b8b0c6c = _DAT_6b8b0c6c + 1;
    }
    else {
      iVar6 = 8;
    }
    DAT_6b8b08c8 = 0;
  }
  return iVar6;
}



// WARNING: Function: __SEH_prolog4_GS replaced with injection: SEH_prolog4

void FUN_6b86585f(void)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  HANDLE pvVar3;
  HANDLE pvVar4;
  HANDLE pvVar5;
  DWORD DVar6;
  int iVar7;
  uint uVar8;
  uint uVar9;
  undefined4 *in_FS_OFFSET;
  bool bVar10;
  HANDLE *ppvVar11;
  HANDLE *ppvVar12;
  char *pcVar13;
  DWORD DVar14;
  undefined4 uVar15;
  BOOL BVar16;
  DWORD DVar17;
  _SECURITY_ATTRIBUTES local_84;
  int local_78;
  int *local_74;
  int **local_70;
  HANDLE local_6c;
  DWORD local_68;
  HANDLE local_64;
  undefined4 *local_60;
  HANDLE local_5c;
  HANDLE local_58;
  HANDLE local_54;
  HANDLE local_50;
  uint local_4c;
  undefined4 *local_48;
  DWORD local_44;
  HANDLE local_40 [5];
  HANDLE local_2c [6];
  undefined4 local_14;
  undefined4 uStack12;
  undefined4 local_8;
  
  uStack12 = 0x6b86586b;
  local_44 = 0;
  local_48 = (undefined4 *)0x0;
  local_60 = (undefined4 *)0x0;
  local_54 = (HANDLE)0x0;
  local_64 = (HANDLE)0x0;
  local_6c = (HANDLE)0x0;
  local_5c = (HANDLE)0x0;
  local_58 = (HANDLE)0x0;
  local_40[0] = (HANDLE)0x0;
  local_40[1] = (HANDLE)0x0;
  local_40[2] = (HANDLE)0x0;
  local_40[3] = (HANDLE)0x0;
  local_40[4] = (HANDLE)0x0;
  local_50 = (HANDLE)0x0;
  local_74 = (int *)0x0;
  local_8 = 0;
  local_84.nLength = 0xc;
  local_84.lpSecurityDescriptor = (LPVOID)0x0;
  local_84.bInheritHandle = 1;
  local_54 = CreateEventW(&local_84,1,0,(LPCWSTR)0x0);
  bVar10 = local_54 == (HANDLE)0x0;
  if (bVar10) {
    uVar15 = FUN_6b865703();
    DbgPrintEx(0x96,1,"WER/ReportFault:%u: WARNING CreateEvent/hRecoveryEvent failed: %u.\n",0x305,
               uVar15);
  }
  else {
    local_4c = 1;
    local_40[0] = local_54;
  }
  uVar8 = (uint)!bVar10;
  local_64 = CreateEventW(&local_84,1,0,(LPCWSTR)0x0);
  if (local_64 == (HANDLE)0x0) {
    uVar15 = FUN_6b865703();
    DbgPrintEx(0x96,1,"WER/ReportFault:%u: WARNING CreateEvent/hCompletionEvent failed: %u.\n",0x310
               ,uVar15);
  }
  else {
    local_40[uVar8] = local_64;
    uVar8 = uVar8 + 1;
    local_4c = uVar8;
  }
  local_6c = CreateFileMappingW((HANDLE)0xffffffff,&local_84,4,0,0xf8,(LPCWSTR)0x0);
  if (local_6c == (HANDLE)0x0) {
    uVar8 = FUN_6b865703();
    uVar15 = 0x327;
    pcVar13 = "WER/ReportFault:%u: ERROR CreateFileMapping failed: %u.\n";
LAB_6b865cb9:
    uVar8 = uVar8 | 0x10000000;
  }
  else {
    local_40[uVar8] = local_6c;
    uVar9 = uVar8 + 1;
    local_4c = uVar9;
    local_60 = (undefined4 *)MapViewOfFile(local_6c,6,0,0,0);
    local_48 = local_60;
    if (local_60 == (undefined4 *)0x0) {
      uVar8 = FUN_6b865703();
      uVar15 = 0x333;
      pcVar13 = "WER/ReportFault:%u: ERROR MapViewOfFile failed: %u.\n";
      goto LAB_6b865cb9;
    }
    DVar17 = 0;
    BVar16 = 1;
    DVar14 = 0x1fffff;
    ppvVar11 = &local_5c;
    pvVar3 = GetCurrentProcess();
    pvVar4 = GetCurrentProcess();
    pvVar5 = GetCurrentProcess();
    BVar16 = DuplicateHandle(pvVar5,pvVar4,pvVar3,ppvVar11,DVar14,BVar16,DVar17);
    if (BVar16 == 0) {
      uVar15 = FUN_6b865703();
      DbgPrintEx(0x96,1,
                 "WER/ReportFault:%u: WARNING DuplicateHandle of current process failed: %u.\n",
                 0x34d,uVar15);
    }
    else {
      local_40[uVar9] = local_5c;
      uVar9 = uVar8 + 2;
      local_4c = uVar9;
    }
    DVar17 = 0;
    BVar16 = 1;
    DVar14 = 0x1fffff;
    ppvVar11 = &local_58;
    pvVar3 = GetCurrentProcess();
    pvVar5 = (HANDLE)0xfffffffe;
    pvVar4 = GetCurrentProcess();
    local_78 = DuplicateHandle(pvVar4,pvVar5,pvVar3,ppvVar11,DVar14,BVar16,DVar17);
    if (local_78 == 0) {
      uVar15 = FUN_6b865703();
      DbgPrintEx(0x96,1,
                 "WER/ReportFault:%u: WARNING DuplicateHandle of current thread failed: %u.\n",0x35e
                 ,uVar15);
    }
    else {
      local_40[uVar9] = local_58;
      local_4c = uVar9 + 1;
    }
    puVar2 = local_48;
    *local_48 = 0xf8;
    DVar14 = GetCurrentProcessId();
    pvVar4 = local_54;
    puVar1 = local_60;
    puVar2[1] = DVar14;
    local_48 = local_60;
    local_60[2] = *(undefined4 *)(in_FS_OFFSET[6] + 0x24);
    local_60[0x2a] = local_70;
    local_60[0x2b] = (int)local_70 >> 0x1f;
    local_60[0x2c] = 0x80004005;
    local_60[0x2e] = local_5c;
    local_60[0x2f] = (int)local_5c >> 0x1f;
    local_60[0x30] = local_58;
    local_60[0x31] = (int)local_58 >> 0x1f;
    local_60[0x32] = local_54;
    local_60[0x33] = (int)local_54 >> 0x1f;
    local_60[0x34] = local_64;
    local_60[0x35] = (int)local_64 >> 0x1f;
    local_60[0x38] = 0;
    local_60[0x39] = 0;
    local_60[0x3a] = 0xc0000001;
    local_60[0x3b] = 0;
    DVar14 = GetTickCount();
    pvVar3 = local_6c;
    puVar1[0x3c] = DVar14;
    ppvVar11 = &local_50;
    uVar15 = 0;
    ppvVar12 = local_40;
    pvVar5 = local_6c;
    uVar8 = local_4c;
    DVar14 = GetCurrentProcessId();
    local_78 = RtlWerpReportException(DVar14,pvVar5,ppvVar12,uVar8,uVar15,ppvVar11);
    if (-1 < local_78) {
      if (local_78 != 0x1b000b) {
LAB_6b865bb2:
        if (local_50 != (HANDLE)0x0) {
          local_2c[0] = (HANDLE)0x0;
          local_2c[1] = (HANDLE)0x0;
          local_2c[2] = (HANDLE)0x0;
          DVar14 = 0;
          do {
            uVar8 = 0xd000022d;
            DVar17 = 0xd000022d;
LAB_6b865bd1:
            do {
              local_44 = DVar17;
              pvVar3 = local_64;
              if (uVar8 != 0xd000022d) {
                uVar8 = local_48[0x2c];
                local_44 = uVar8;
                goto LAB_6b865ccb;
              }
              local_2c[0] = local_50;
              DVar17 = 1;
              local_68 = 1;
              if (local_64 != (HANDLE)0x0) {
                local_2c[1] = local_64;
                DVar17 = 2;
                local_68 = 2;
              }
              if (pvVar4 != (HANDLE)0x0) {
                local_2c[DVar17] = pvVar4;
                DVar17 = DVar17 + 1;
                local_68 = DVar17;
              }
              DVar6 = WaitForMultipleObjects(DVar17,local_2c,0,0xffffffff);
              uVar8 = DVar14;
              DVar17 = DVar14;
            } while (DVar6 == 0);
            if (DVar6 == 1) {
              if (pvVar3 != (HANDLE)0x0) goto LAB_6b865bd1;
            }
            else if (DVar6 != 2) {
              uVar8 = DVar6;
              if (0 < (int)DVar6) {
                uVar8 = DVar6 & 0xffff | 0x80070000;
              }
              local_44 = uVar8;
              DbgPrintEx(0x96,0,"WER/ReportFault:%u: ERROR WaitForMultipleObjects returned %08X.\n",
                         0x41e,DVar6);
              DVar17 = local_44;
              goto LAB_6b865bd1;
            }
            if ((pvVar4 == (HANDLE)0x0) || (iVar7 = FUN_6b8620dd(&local_74), iVar7 < 0))
            goto LAB_6b865bd1;
            NtClose(pvVar4);
            pvVar4 = (HANDLE)0x0;
            local_54 = (HANDLE)0x0;
            FUN_6b8642ee((int)local_74);
          } while( true );
        }
        uVar8 = 0x1b0002;
        local_44 = uVar8;
        goto LAB_6b865ccb;
      }
      uVar15 = 0x3b6;
      pcVar13 = 
      "WER/ReportFault:%u: ERROR RtlWerpReportException failed: too many concurrent workers\n";
LAB_6b865b45:
      uVar8 = 0x1b000b;
      local_44 = 0x1b000b;
      DbgPrintEx(0x96,0,pcVar13,uVar15);
      goto LAB_6b865ccb;
    }
    DbgPrintEx(0x96,1,"WER/ReportFault:%u: WARNING RtlWerpReportException failed: NTSTATUS %08X.\n",
               900,local_78);
    if (local_78 == -0x3fffffbf) {
      uVar15 = 0x38f;
      pcVar13 = "WER/ReportFault:%u: ERROR RtlWerpReportException failed: Service port busy\n";
      goto LAB_6b865b45;
    }
    if (**local_70 == -0x3fffff03) {
      uVar8 = 0x80070032;
      local_44 = uVar8;
      goto LAB_6b865ccb;
    }
    uVar8 = FUN_6b8651d7(pvVar3,local_40,local_4c,&local_50);
    if (-1 < (int)uVar8) goto LAB_6b865bb2;
    uVar15 = 0x3a7;
    pcVar13 = "WER/ReportFault:%u: ERROR StartCrashVertical failed: HRESULT %08X.\n";
  }
  local_44 = uVar8;
  DbgPrintEx(0x96,0,pcVar13,uVar15,uVar8);
LAB_6b865ccb:
  local_8 = 0xfffffffe;
  FUN_6b865cf7();
  FUN_6b865151(uVar8);
  *in_FS_OFFSET = local_14;
  return;
}



void FUN_6b865cf7(void)

{
  int unaff_EBX;
  int unaff_EBP;
  LPCVOID unaff_EDI;
  
  if (*(int *)(unaff_EBP + -0x54) != 0) {
    NtClose(*(undefined4 *)(unaff_EBP + -0x54));
  }
  if (*(int *)(unaff_EBP + -0x58) != 0) {
    NtClose(*(undefined4 *)(unaff_EBP + -0x58));
  }
  if (*(int *)(unaff_EBP + -0x60) != 0) {
    NtClose(*(int *)(unaff_EBP + -0x60));
  }
  if (unaff_EBX != 0) {
    NtClose(unaff_EBX);
  }
  if (unaff_EDI != (LPCVOID)0x0) {
    UnmapViewOfFile(unaff_EDI);
  }
  if (*(int *)(unaff_EBP + -0x68) != 0) {
    NtClose(*(int *)(unaff_EBP + -0x68));
  }
  if (*(int *)(unaff_EBP + -0x4c) != 0) {
    NtClose(*(undefined4 *)(unaff_EBP + -0x4c));
  }
  return;
}



int __fastcall FUN_6b865d57(ushort *param_1,int param_2,uint *param_3)

{
  short *psVar1;
  ushort uVar2;
  short sVar3;
  short *psVar4;
  void *_Dst;
  wchar_t *pwVar5;
  uint uVar6;
  int iVar7;
  int in_FS_OFFSET;
  uint local_10;
  void *local_c;
  int local_8;
  
  uVar2 = *param_1;
  uVar6 = (uint)uVar2;
  iVar7 = 0xe;
  if (param_2 != 0) {
    psVar1 = *(short **)(param_1 + 2);
    iVar7 = 0x68;
    for (psVar4 = (short *)((uVar6 - 2) + (int)psVar1); psVar1 <= psVar4; psVar4 = psVar4 + -1) {
      if ((*psVar4 == 0x5c) || (*psVar4 == 0x2f)) {
        psVar4 = psVar4 + 1;
        break;
      }
    }
    if (psVar4 < psVar1) {
      return -0x3ffffff3;
    }
    uVar2 = (short)psVar4 - (short)psVar1 & 0xfffe;
    uVar6 = (uint)uVar2;
  }
  if (0xffff - iVar7 < (int)uVar6) {
    iVar7 = -0x3ffffefa;
  }
  else {
    sVar3 = uVar2 + (short)iVar7;
    local_10 = CONCAT22(sVar3,uVar2);
    local_8 = param_2;
    _Dst = (void *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,sVar3);
    if (_Dst == (void *)0x0) {
      iVar7 = -0x3fffffe9;
    }
    else {
      memcpy(_Dst,*(void **)(param_1 + 2),local_10 & 0xffff);
      pwVar5 = L".Local";
      if (local_8 != 0) {
        pwVar5 = L"microsoft.system.package.metadata\\Application.Local";
      }
      local_c = _Dst;
      iVar7 = RtlAppendUnicodeToString(&local_10,pwVar5);
      if (-1 < iVar7) {
        *(undefined2 *)((int)_Dst + (local_10 >> 1 & 0x7fff) * 2) = 0;
        uVar6 = RtlDoesFileExists_U(_Dst);
        *param_3 = uVar6 & 0xff;
      }
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,_Dst);
    }
  }
  return iVar7;
}



void __fastcall FUN_6b865e65(int *param_1,undefined4 param_2,int *param_3,undefined2 *param_4)

{
  undefined4 *puVar1;
  int iVar2;
  uint uVar3;
  uint extraout_EDX;
  uint extraout_EDX_00;
  uint uVar4;
  undefined8 uVar5;
  undefined local_64 [8];
  undefined local_5c [8];
  undefined4 local_54;
  undefined4 local_50;
  int local_4c;
  undefined4 local_48;
  undefined4 local_44;
  undefined4 local_40;
  uint local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  int *local_2c;
  undefined4 local_28;
  uint local_24;
  undefined4 local_20;
  int local_1c;
  uint local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_14 = 0x18;
  local_c = 0;
  local_38 = 0;
  local_20 = 0;
  local_18 = 0;
  local_24 = 0;
  local_1c = 0;
  local_28 = 0;
  local_2c = param_1;
  local_10 = param_2;
  if (*param_3 == 0) {
    local_4c = param_1[1];
    local_54 = 0x18;
    local_50 = 0;
    local_48 = 0x40;
    local_44 = 0;
    local_40 = 0;
    uVar5 = NtOpenFile(param_3,0x120089,&local_54,local_5c,5,0x60);
    uVar4 = (uint)((ulonglong)uVar5 >> 0x20);
    iVar2 = (int)uVar5;
    if (iVar2 < 0) {
      if ((((iVar2 != -0x3fffffcc) && (iVar2 != -0x3fffff77)) && (iVar2 != -0x3fffff76)) &&
         (((iVar2 != -0x3fffff75 && (iVar2 != -0x3ffffdfc)) &&
          ((iVar2 != -0x3feafffe && (iVar2 != -0x3ffffff1)))))) {
        DbgPrintEx(0x33,0,"SXS: %s() NtOpenFile(%wZ) failed. Status = 0x%x\n",
                   "BasepSxsCreateResourceStreamFromFileHandle",local_4c,iVar2);
        uVar4 = extraout_EDX;
      }
      goto LAB_6b866065;
    }
  }
  uVar5 = LdrResSearchResource(*param_3,&local_14,3,0x8810,&local_20,&local_18,0,0);
  uVar4 = (uint)((ulonglong)uVar5 >> 0x20);
  if ((-1 < (int)uVar5) && (local_18 < 0x800001)) {
    local_3c = local_18;
    uVar5 = NtCreateSection(param_3 + 2,6,0,&local_3c,4,0x8000000,0);
    uVar4 = (uint)((ulonglong)uVar5 >> 0x20);
    if (-1 < (int)uVar5) {
      uVar5 = NtMapViewOfSection(param_3[2],param_3[1],&local_1c,0,0,0,&local_28,2,0,4);
      uVar4 = (uint)((ulonglong)uVar5 >> 0x20);
      if (-1 < (int)uVar5) {
        local_30 = 0;
        param_3[4] = local_1c;
        local_34 = local_20;
        param_3[5] = local_1c >> 0x1f;
        uVar5 = NtSetInformationFile(*param_3,local_64,&local_34,8,0xe);
        uVar4 = (uint)((ulonglong)uVar5 >> 0x20);
        if (((-1 < (int)uVar5) &&
            (uVar3 = FUN_6b866078(*param_3,param_3[4],local_18,&local_24), uVar4 = extraout_EDX_00,
            -1 < (int)uVar3)) && (uVar4 = local_18, local_24 == local_18)) {
          *(int *)(param_4 + 6) = *param_3;
          *param_4 = 0x101;
          puVar1 = (undefined4 *)*local_2c;
          *(undefined4 *)(param_4 + 2) = *puVar1;
          *(undefined4 *)(param_4 + 4) = puVar1[1];
          *(undefined *)(param_4 + 1) = 3;
          iVar2 = param_3[2];
          *(undefined4 *)(param_4 + 0xc) = 0;
          *(undefined4 *)(param_4 + 0xe) = 0;
          *(int *)(param_4 + 8) = iVar2;
          *(uint *)(param_4 + 0x10) = local_18;
        }
      }
    }
  }
LAB_6b866065:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar4);
  return;
}



uint __fastcall
FUN_6b866078(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 *param_4)

{
  uint uVar1;
  undefined4 local_c;
  undefined4 local_8;
  
  local_c = param_1;
  local_8 = param_1;
  uVar1 = NtReadFile(param_1,0,0,0,&local_c,param_2,param_3,0,0);
  if (uVar1 == 0x103) {
    uVar1 = NtWaitForSingleObject(param_1,0,0);
  }
  if ((int)uVar1 < 0) {
    if (uVar1 == 0xc0000011) {
      if (param_4 == (undefined4 *)0x0) {
        return 0xc0000011;
      }
      *param_4 = 0;
      return 0xc0000011;
    }
    if ((uVar1 & 0xc0000000) != 0x80000000) {
      return uVar1;
    }
  }
  if (param_4 != (undefined4 *)0x0) {
    *param_4 = local_8;
  }
  return uVar1;
}



void __fastcall FUN_6b8660e6(HGLOBAL *param_1)

{
  if (param_1 != (HGLOBAL *)0x0) {
    if (*param_1 != (HGLOBAL)0x0) {
      GlobalFree(*param_1);
      *param_1 = (HGLOBAL)0x0;
    }
    if (param_1[1] != (HGLOBAL)0x0) {
      GlobalFree(param_1[1]);
      param_1[1] = (HGLOBAL)0x0;
    }
    if (param_1[4] != (HGLOBAL)0x0) {
      GlobalFree(param_1[4]);
      param_1[4] = (HGLOBAL)0x0;
    }
    LocalFree(param_1);
  }
  return;
}



HGLOBAL * __thiscall FUN_6b86612e(HGLOBAL this,HGLOBAL param_2)

{
  HGLOBAL *ppvVar1;
  HGLOBAL pvVar2;
  
  ppvVar1 = (HGLOBAL *)LocalAlloc(0x40,0x54);
  if (ppvVar1 != (HGLOBAL *)0x0) {
    pvVar2 = GlobalAlloc(0x40,0x1080);
    *ppvVar1 = pvVar2;
    if (pvVar2 != (HGLOBAL)0x0) {
      ppvVar1[0xb] = param_2;
      ppvVar1[0xc] = this;
      while ((param_2 != (HGLOBAL)0x0 && (this != (HGLOBAL)0x0))) {
        pvVar2 = GlobalAlloc(0x40,(int)param_2 + 1);
        ppvVar1[1] = pvVar2;
        if (pvVar2 != (HGLOBAL)0x0) {
          pvVar2 = GlobalAlloc(0x40,(SIZE_T)ppvVar1[0xc]);
          ppvVar1[4] = pvVar2;
          if (pvVar2 != (HGLOBAL)0x0) {
            return ppvVar1;
          }
          GlobalFree(ppvVar1[1]);
        }
        ppvVar1[0xb] = (HGLOBAL)((int)ppvVar1[0xb] + -0x400);
        ppvVar1[0xc] = (HGLOBAL)((int)ppvVar1[0xc] + -0x400);
        param_2 = ppvVar1[0xb];
        this = ppvVar1[0xc];
      }
      GlobalFree(*ppvVar1);
    }
  }
  return (HGLOBAL *)0x0;
}



// WARNING: Could not reconcile some variable overlaps

void __fastcall FUN_6b8661c2(HANDLE param_1,HANDLE param_2,int *param_3)

{
  int iVar1;
  undefined4 extraout_ECX;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 uVar2;
  undefined8 uVar3;
  undefined4 local_1c;
  undefined4 uStack24;
  undefined4 local_14;
  int local_10;
  undefined4 uStack12;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_1c = 0;
  uStack24 = 0;
  local_14 = 0;
  local_10 = 0;
  uStack12 = 0;
  uVar3 = FUN_6b866337(&local_1c,(HFILE)param_1,param_3 + 9);
  uVar2 = (undefined4)((ulonglong)uVar3 >> 0x20);
  if (((int)uVar3 == 1) || (param_3[9] < 0xe)) {
    uVar3 = FUN_6b8663e2(&local_1c);
    uVar2 = (undefined4)((ulonglong)uVar3 >> 0x20);
    if ((int)uVar3 == 1) {
      if ((char)local_14 != 'A') goto LAB_6b866277;
      iVar1 = FUN_6b8667a1((HFILE)param_1,(int)param_2,local_10 + -1,1,extraout_ECX,param_3);
      uVar2 = extraout_EDX;
    }
    else {
      iVar1 = FUN_6b866288((HFILE)param_1,(int)param_2,(int)param_3);
      uVar2 = extraout_EDX_00;
    }
    if ((iVar1 == 1) &&
       (iVar1 = FUN_6b866a95(0x46,(int)param_2,(int)param_3), uVar2 = extraout_EDX_01, iVar1 == 1))
    {
      FUN_6b866421(param_1,param_2);
      uVar2 = extraout_EDX_02;
    }
  }
LAB_6b866277:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



undefined4 __fastcall FUN_6b866288(HFILE param_1,int param_2,int param_3)

{
  LONG LVar1;
  int iVar2;
  UINT lBytes;
  UINT UVar3;
  
  LVar1 = _llseek(param_1,0,0);
  if (LVar1 == 0) {
    if ((param_2 != -2) && (LVar1 = _llseek(param_2,0,0), LVar1 != 0)) {
      return 0xfffffffe;
    }
    UVar3 = *(UINT *)(param_3 + 0x2c);
    iVar2 = *(int *)(param_3 + 4) + 1 + UVar3;
    *(undefined4 *)(param_3 + 0x1c) = 0;
    *(int *)(param_3 + 8) = iVar2;
    *(int *)(param_3 + 0xc) = iVar2;
    *(int *)(param_3 + 0x18) = *(int *)(param_3 + 0x10);
    *(undefined4 *)(param_3 + 0x28) = 0;
    *(int *)(param_3 + 0x14) = *(int *)(param_3 + 0x30) + *(int *)(param_3 + 0x10);
    do {
      lBytes = _hread(param_1,*(LPVOID *)(param_3 + 4),UVar3);
      if (lBytes == 0) break;
      if (lBytes == 0xffffffff) {
        return 0xffffffff;
      }
      UVar3 = _hwrite(param_2,*(LPCCH *)(param_3 + 4),lBytes);
      if (UVar3 != lBytes) {
        if (UVar3 != 0xffffffff) {
          return 0xfffffffe;
        }
        return 0xfffffffc;
      }
      *(int *)(param_3 + 0x28) = *(int *)(param_3 + 0x28) + UVar3;
      UVar3 = *(UINT *)(param_3 + 0x2c);
    } while (lBytes == UVar3);
    if (lBytes != 0xffffffff) {
      return 1;
    }
  }
  return 0xffffffff;
}



void __fastcall FUN_6b866337(undefined4 *param_1,HFILE param_2,LONG *param_3)

{
  byte bVar1;
  LONG LVar2;
  UINT UVar3;
  byte bVar4;
  int extraout_EDX;
  int extraout_EDX_00;
  int extraout_EDX_01;
  int iVar5;
  uint uVar6;
  undefined4 local_18;
  undefined4 local_14;
  undefined local_10;
  undefined local_f;
  byte abStack14 [6];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  uVar6 = 0;
  LVar2 = _llseek(param_2,0,2);
  *param_3 = LVar2;
  iVar5 = extraout_EDX;
  if (((-1 < LVar2) && (LVar2 = _llseek(param_2,0,0), iVar5 = extraout_EDX_00, LVar2 == 0)) &&
     (UVar3 = _hread(param_2,&local_18,0xe), iVar5 = extraout_EDX_01, UVar3 == 0xe)) {
    bVar4 = 0;
    *param_1 = local_18;
    iVar5 = 0;
    param_1[1] = local_14;
    *(undefined *)(param_1 + 2) = local_10;
    *(undefined *)((int)param_1 + 9) = local_f;
    do {
      bVar1 = bVar4 & 0x1f;
      bVar4 = bVar4 + 8;
      uVar6 = uVar6 | (uint)abStack14[iVar5] << bVar1;
      iVar5 = iVar5 + 1;
    } while (iVar5 < 4);
    param_1[3] = uVar6;
    param_1[4] = *param_3;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,iVar5);
  return;
}



void __fastcall FUN_6b8663e2(undefined4 *param_1)

{
  undefined4 extraout_EDX;
  undefined4 local_14;
  undefined4 local_10;
  undefined local_c;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_14 = *param_1;
  local_10 = param_1[1];
  local_c = 0;
  FUN_6b81f4f4((byte *)&local_14,&DAT_6b88c204);
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,extraout_EDX);
  return;
}



undefined4 __fastcall FUN_6b866421(HANDLE param_1,HANDLE param_2)

{
  BOOL BVar1;
  _FILETIME local_1c;
  _FILETIME local_14;
  _FILETIME local_c;
  
  BVar1 = GetFileTime(param_1,&local_1c,&local_14,&local_c);
  if ((BVar1 != 0) && (BVar1 = SetFileTime(param_2,&local_1c,&local_14,&local_c), BVar1 != 0)) {
    return 1;
  }
  return 0xffffffff;
}



BYTE * __fastcall FUN_6b866465(BYTE *param_1)

{
  BYTE *pBVar1;
  BOOL BVar2;
  
  pBVar1 = FUN_6b8664fe(param_1);
  do {
    BVar2 = IsDBCSLeadByte(*pBVar1);
    if (BVar2 == 0) {
      if (*pBVar1 == '\0') {
        return (BYTE *)0x0;
      }
      if (*pBVar1 == '.') {
        return pBVar1 + 1;
      }
    }
    pBVar1 = FUN_6b866ae3(pBVar1);
  } while( true );
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

short * FUN_6b866499(void)

{
  short *psVar1;
  short *psVar2;
  short sVar3;
  
  psVar2 = (short *)&_Dst_6b8b0a50;
  psVar1 = (short *)&_Dst_6b8b0a50;
  sVar3 = __Dst_6b8b0a50;
  if (__Dst_6b8b0a50 != 0) {
    do {
      if ((sVar3 == 0x5c) || (sVar3 == 0x3a)) {
        psVar1 = psVar2 + 1;
      }
      psVar2 = psVar2 + 1;
      sVar3 = *psVar2;
    } while (*psVar2 != 0);
  }
  sVar3 = *psVar1;
  while( true ) {
    if (sVar3 == 0) {
      return (short *)0x0;
    }
    if (sVar3 == 0x2e) break;
    psVar1 = psVar1 + 1;
    sVar3 = *psVar1;
  }
  return psVar1 + 1;
}



BYTE * __fastcall FUN_6b8664fe(BYTE *param_1)

{
  BYTE BVar1;
  BOOL BVar2;
  BYTE *pBVar3;
  
  BVar1 = *param_1;
  pBVar3 = param_1;
  while (BVar1 != '\0') {
    BVar2 = IsDBCSLeadByte(BVar1);
    if ((BVar2 == 0) && (((BVar1 = *param_1, BVar1 == '/' || (BVar1 == '\\')) || (BVar1 == ':')))) {
      pBVar3 = FUN_6b866ae3(param_1);
    }
    param_1 = FUN_6b866ae3(param_1);
    BVar1 = *param_1;
  }
  return pBVar3;
}



uint __fastcall FUN_6b86654f(char *param_1)

{
  char cVar1;
  uint uVar2;
  char *pcVar3;
  uint uVar4;
  char *local_8;
  
  uVar4 = 0;
  local_8 = param_1;
  if (param_1 == (char *)0x0) {
    uVar2 = 0x80070057;
  }
  else {
    uVar2 = FUN_6b86675f(param_1,(int *)&local_8);
  }
  if ((int)uVar2 < 0) {
    return uVar2 & 0xffffff00;
  }
  pcVar3 = local_8;
  if (local_8 == (char *)0x0) {
LAB_6b8665b7:
    pcVar3 = "._";
  }
  else {
    do {
      pcVar3 = pcVar3 + -1;
      cVar1 = pcVar3[(int)param_1];
      if (cVar1 == '.') break;
      if ((cVar1 == '\\') || (cVar1 == ':')) {
        pcVar3 = (char *)0x0;
        break;
      }
    } while (pcVar3 != (char *)0x0);
    if (pcVar3 == (char *)0x0) goto LAB_6b8665b7;
    uVar2 = (int)local_8 - (int)pcVar3;
    if (3 < uVar2) {
      uVar4 = (uint)(byte)(local_8 + -1)[(int)param_1];
      (local_8 + -1)[(int)param_1] = '_';
      goto LAB_6b8665cb;
    }
    pcVar3 = "_";
  }
  uVar2 = strcat_s(param_1,0x106,pcVar3);
LAB_6b8665cb:
  return uVar2 & 0xffffff00 | uVar4;
}



uint FUN_6b8665d1(void)

{
  wchar_t *_Src;
  uint uVar1;
  wchar_t wVar2;
  wchar_t **_Src_00;
  
  wVar2 = L'\0';
  _Src = FUN_6b866499();
  if (_Src == (wchar_t *)0x0) {
    _Src_00 = &_Src_6b88c214;
  }
  else {
    uVar1 = wcsnlen(_Src,(int)(_Src + -0x35c58422) >> 1);
    if (2 < uVar1) {
      wVar2 = _Src[uVar1 - 1];
      _Src[uVar1 - 1] = L'_';
      goto LAB_6b866634;
    }
    _Src_00 = (wchar_t **)&DAT_6b88c210;
  }
  uVar1 = wcscat_s((wchar_t *)&_Dst_6b8b0a50,0x106,(wchar_t *)_Src_00);
LAB_6b866634:
  return uVar1 & 0xffff0000 | (uint)(ushort)wVar2;
}



void __thiscall FUN_6b86663b(void *this,byte param_1)

{
  byte bVar1;
  ushort uVar2;
  byte *_Str;
  BOOL BVar3;
  int iVar4;
  undefined2 extraout_var;
  undefined2 extraout_var_00;
  size_t sVar5;
  byte *pbVar6;
  uint extraout_ECX;
  uint uVar7;
  uint extraout_ECX_00;
  uint extraout_ECX_01;
  byte *pbVar8;
  
  _Str = FUN_6b866465((BYTE *)this);
  if (_Str != (byte *)0x0) {
    if (((0x40 < param_1) && (param_1 < 0x5b)) || ((byte)(param_1 + 0x9f) < 0x1a)) {
                    // WARNING: Load size is inaccurate
      bVar1 = *this;
      uVar7 = extraout_ECX & 0xffffff00 | (uint)bVar1;
      while (bVar1 != 0) {
        BVar3 = IsDBCSLeadByte(bVar1);
        uVar7 = extraout_ECX_00;
        if (BVar3 == 0) {
                    // WARNING: Load size is inaccurate
          bVar1 = *this;
          if ((('@' < (char)bVar1) &&
              (uVar7 = extraout_ECX_00 & 0xffffff00 | (uint)bVar1, (char)bVar1 < '[')) ||
             (('`' < (char)bVar1 && (uVar7 = uVar7 & 0xffffff00 | (uint)bVar1, (char)bVar1 < '{'))))
          break;
          iVar4 = 1;
        }
        else {
          iVar4 = 2;
        }
        this = (void *)((int)this + iVar4);
                    // WARNING: Load size is inaccurate
        bVar1 = *this;
        uVar7 = uVar7 & 0xffffff00 | (uint)bVar1;
      }
      uVar2 = FUN_6b866b09(uVar7);
      if (CONCAT22(extraout_var,uVar2) == 0) {
                    // WARNING: Load size is inaccurate
        uVar2 = FUN_6b866b68(extraout_ECX_01 & 0xffffff00 | (uint)*this);
        if ((CONCAT22(extraout_var_00,uVar2) != 0) && ((byte)(param_1 + 0x9f) < 0x1a)) {
          param_1 = param_1 - 0x20;
        }
      }
      else if ((byte)(param_1 + 0xbf) < 0x1a) {
        param_1 = param_1 + 0x20;
      }
    }
    sVar5 = strnlen((char *)_Str,(size_t)(_Str + (0x104 - (int)this)));
    if (0 < (int)sVar5) {
      BVar3 = IsDBCSLeadByte(*_Str);
      if (((BVar3 == 0) && (*_Str == 0x5f)) && (BVar3 = IsDBCSLeadByte(_Str[1]), BVar3 != 0)) {
        *_Str = param_1;
      }
      else {
        bVar1 = *_Str;
        pbVar6 = _Str;
        pbVar8 = _Str;
        if (bVar1 != 0) {
          do {
            pbVar8 = pbVar6;
            pbVar6 = FUN_6b866ae3(pbVar8);
          } while (*pbVar6 != 0);
          bVar1 = *pbVar8;
        }
        BVar3 = IsDBCSLeadByte(bVar1);
        if ((BVar3 == 0) && (*pbVar8 == 0x5f)) {
          *pbVar8 = param_1;
        }
      }
    }
    if ((*_Str == 0) && (_Str[-1] == 0x2e)) {
      _Str[-1] = 0;
    }
  }
  return;
}



int __thiscall FUN_6b86675f(void *this,int *param_1)

{
  int iVar1;
  
  iVar1 = 0x106;
  do {
                    // WARNING: Load size is inaccurate
    if (*this == '\0') break;
    this = (void *)((int)this + 1);
    iVar1 = iVar1 + -1;
  } while (iVar1 != 0);
  if (param_1 != (int *)0x0) {
    if (iVar1 == 0) {
      *param_1 = 0;
    }
    else {
      *param_1 = 0x106 - iVar1;
    }
  }
  return (-(uint)(iVar1 != 0) & 0x7ff8ffa9) + 0x80070057;
}



int __fastcall
FUN_6b8667a1(HFILE param_1,int param_2,int param_3,int param_4,undefined4 param_5,int *param_6)

{
  byte bVar1;
  byte bVar2;
  LONG LVar3;
  int iVar4;
  byte *pbVar5;
  int iVar6;
  uint uVar7;
  int local_10;
  byte local_6;
  byte local_5;
  
  param_6[8] = 0x10;
  if (param_4 == 1) {
    LVar3 = _llseek(param_1,0xe,0);
    if (LVar3 != 0xe) {
      return -1;
    }
    if ((param_2 != -2) && (LVar3 = _llseek(param_2,0,0), LVar3 != 0)) {
      return -2;
    }
    iVar4 = param_6[1] + param_6[0xb] + 1;
    param_6[7] = 0;
    iVar6 = 0;
    param_6[2] = iVar4;
    param_6[3] = iVar4;
    param_6[6] = param_6[4];
    param_6[5] = param_6[0xc] + param_6[4];
    param_6[10] = 0;
    if (-param_6[8] != -0x1000 && -1 < -param_6[8] + 0x1000) {
      do {
        *(undefined *)(iVar6 + *param_6) = 0x20;
        iVar6 = iVar6 + 1;
      } while (iVar6 < 0x1000 - param_6[8]);
    }
    param_6[0xd] = 0;
    param_6[0xe] = 0x1000 - param_6[8];
  }
  pbVar5 = (byte *)param_6[3];
  if (pbVar5 < (byte *)param_6[2]) goto LAB_6b8669bf;
  iVar4 = FUN_6b866a1b(&local_5,param_1,(int)param_6);
  if (iVar4 == 1) {
    do {
      while( true ) {
        if (param_6[10] != param_3 && param_3 <= param_6[10]) {
          if (param_6[3] == param_6[1] + 1) {
            param_6[7] = 1;
            return 1;
          }
          param_6[3] = param_6[3] + -1;
          return 1;
        }
        param_6[0xd] = (uint)param_6[0xd] >> 1;
        if ((param_6[0xd] & 0x100U) == 0) {
          param_6[0xd] = local_5 | 0xff00;
          pbVar5 = (byte *)param_6[3];
          if (pbVar5 < (byte *)param_6[2]) {
            local_5 = *pbVar5;
            param_6[3] = (int)(pbVar5 + 1);
          }
          else {
            iVar4 = FUN_6b866a1b(&local_5,param_1,(int)param_6);
            if (iVar4 != 1) {
              return -3;
            }
          }
        }
        bVar2 = local_5;
        if ((*(byte *)(param_6 + 0xd) & 1) == 0) {
          pbVar5 = (byte *)param_6[3];
          if (pbVar5 < (byte *)param_6[2]) {
            local_6 = *pbVar5;
            param_6[3] = (int)(pbVar5 + 1);
          }
          else {
            iVar4 = FUN_6b866a1b(&local_6,param_1,(int)param_6);
            if (iVar4 != 1) {
              return -3;
            }
          }
          uVar7 = (uint)local_6;
          local_10 = 0;
          do {
            bVar1 = *(byte *)((((uVar7 & 0xf0) << 4 | (uint)bVar2) + local_10 & 0xfff) + *param_6);
            local_5 = bVar1;
            if ((byte *)param_6[6] < (byte *)param_6[5]) {
              *(byte *)param_6[6] = bVar1;
              param_6[6] = param_6[6] + 1;
              param_6[10] = param_6[10] + 1;
            }
            else {
              param_6[10] = param_6[10] + 1;
              iVar4 = FUN_6b866a95(bVar1,param_2,(int)param_6);
              if (iVar4 != 1) {
                return iVar4;
              }
            }
            *(byte *)(param_6[0xe] + *param_6) = bVar1;
            param_6[0xe] = param_6[0xe] + 1U & 0xfff;
            local_10 = local_10 + 1;
          } while (local_10 <= (int)((uVar7 & 0xf) + 2));
        }
        else {
          if ((byte *)param_6[6] < (byte *)param_6[5]) {
            *(byte *)param_6[6] = local_5;
            param_6[6] = param_6[6] + 1;
            param_6[10] = param_6[10] + 1;
          }
          else {
            param_6[10] = param_6[10] + 1;
            iVar4 = FUN_6b866a95(local_5,param_2,(int)param_6);
            if (iVar4 != 1) {
              return iVar4;
            }
          }
          *(byte *)(param_6[0xe] + *param_6) = bVar2;
          param_6[0xe] = param_6[0xe] + 1U & 0xfff;
        }
        pbVar5 = (byte *)param_6[3];
        if ((byte *)param_6[2] <= pbVar5) break;
LAB_6b8669bf:
        local_5 = *pbVar5;
        param_6[3] = (int)(pbVar5 + 1);
      }
      iVar4 = FUN_6b866a1b(&local_5,param_1,(int)param_6);
      if ((iVar4 != 1) && (iVar4 != 500)) {
        return iVar4;
      }
    } while (iVar4 != 500);
  }
  else if (iVar4 != 500) {
    return iVar4;
  }
  return 1;
}



undefined4 __fastcall FUN_6b866a1b(undefined *param_1,HFILE param_2,int param_3)

{
  undefined *puVar1;
  UINT UVar2;
  undefined4 uVar3;
  undefined uVar4;
  
  **(undefined **)(param_3 + 4) = *(undefined *)(*(int *)(param_3 + 8) + -1);
  UVar2 = _hread(param_2,(LPVOID)(*(int *)(param_3 + 4) + 1),*(UINT *)(param_3 + 0x2c));
  if (UVar2 == *(UINT *)(param_3 + 0x2c)) {
LAB_6b866a5a:
    puVar1 = *(undefined **)(param_3 + 4);
    *(undefined **)(param_3 + 0xc) = puVar1 + 1;
    if (*(int *)(param_3 + 0x1c) == 0) {
      if (*(int *)(param_3 + 0x2c) == 0) goto LAB_6b866a7e;
      uVar4 = puVar1[1];
      *(undefined **)(param_3 + 0xc) = puVar1 + 2;
    }
    else {
      uVar4 = *puVar1;
      *(undefined4 *)(param_3 + 0x1c) = 0;
    }
    *param_1 = uVar4;
    uVar3 = 1;
  }
  else {
    if (UVar2 != 0xffffffff) {
      if (UVar2 == 0) {
        return 500;
      }
      *(UINT *)(param_3 + 8) = *(int *)(param_3 + 4) + 1 + UVar2;
      goto LAB_6b866a5a;
    }
LAB_6b866a7e:
    uVar3 = 0xffffffff;
  }
  return uVar3;
}



int __fastcall FUN_6b866a95(undefined param_1,int param_2,int param_3)

{
  LPCCH lpBuffer;
  long lVar1;
  int lBytes;
  
  lpBuffer = *(LPCCH *)(param_3 + 0x10);
  lBytes = *(int *)(param_3 + 0x18) - (int)lpBuffer;
  *(LPCCH *)(param_3 + 0x18) = lpBuffer;
  if ((param_2 != -2) && (lVar1 = _hwrite(param_2,lpBuffer,lBytes), lVar1 != lBytes)) {
    return (uint)(lVar1 == -1) * 2 + -4;
  }
  **(undefined **)(param_3 + 0x18) = param_1;
  *(int *)(param_3 + 0x18) = *(int *)(param_3 + 0x18) + 1;
  return 1;
}



BYTE * __fastcall FUN_6b866ae3(BYTE *param_1)

{
  BOOL BVar1;
  
  if (*NlsMbCodePageTag_exref != (code)0x0) {
    BVar1 = IsDBCSLeadByte(*param_1);
    if (BVar1 != 0) {
      param_1 = param_1 + 1;
    }
  }
  if (*param_1 != '\0') {
    param_1 = param_1 + 1;
  }
  return param_1;
}



ushort __fastcall FUN_6b866b09(undefined4 param_1)

{
  BOOL BVar1;
  undefined4 local_10;
  ushort local_c [2];
  WCHAR local_8 [2];
  
  local_c[0] = 0;
  local_8[0] = L'\0';
  local_10 = param_1;
  if (*NlsMbCodePageTag_exref != (code)0x0) {
    BVar1 = IsDBCSLeadByte((BYTE)param_1);
    if (BVar1 != 0) {
      return 0;
    }
  }
  RtlMultiByteToUnicodeN(local_8,2,0,&local_10,1);
  GetStringTypeW(1,local_8,1,local_c);
  return local_c[0] >> 1 & 1;
}



ushort __fastcall FUN_6b866b68(undefined4 param_1)

{
  BOOL BVar1;
  undefined4 local_10;
  ushort local_c [2];
  WCHAR local_8 [2];
  
  local_c[0] = 0;
  local_8[0] = L'\0';
  local_10 = param_1;
  if (*NlsMbCodePageTag_exref != (code)0x0) {
    BVar1 = IsDBCSLeadByte((BYTE)param_1);
    if (BVar1 != 0) {
      return 0;
    }
  }
  RtlMultiByteToUnicodeN(local_8,2,0,&local_10,1);
  GetStringTypeW(1,local_8,1,local_c);
  return local_c[0] & 1;
}



int __fastcall
FUN_6b866bc5(undefined4 *param_1,undefined4 *param_2,undefined4 param_3,undefined4 param_4,
            undefined4 param_5,ushort param_6,uint param_7)

{
  uint uVar1;
  undefined *puVar2;
  HANDLE hHeap;
  uint uVar3;
  undefined *puVar4;
  uint uVar5;
  int iVar6;
  undefined4 *puVar7;
  HANDLE *ppvVar8;
  undefined *puVar9;
  undefined4 *puVar10;
  int in_FS_OFFSET;
  undefined4 uVar11;
  uint local_10c;
  undefined *local_108;
  uint local_104;
  uint local_100;
  wchar_t *local_fc;
  HANDLE local_f8;
  uint local_f4;
  uint local_f0;
  uint local_e8;
  undefined *local_e4;
  undefined4 *local_e0;
  undefined4 local_dc;
  undefined4 *local_d8;
  undefined4 *local_d4;
  undefined4 local_d0;
  uint local_cc;
  undefined local_c8 [16];
  ushort local_b8;
  undefined *local_14;
  uint local_10;
  
  ppvVar8 = &local_f8;
  local_d8 = param_1;
  local_d4 = param_2;
  for (iVar6 = 6; iVar6 != 0; iVar6 = iVar6 + -1) {
    *ppvVar8 = (HANDLE)0x0;
    ppvVar8 = ppvVar8 + 1;
  }
  hHeap = GetProcessHeap();
  local_f8 = hHeap;
  memset(&local_d0,0,0xc4);
  local_fc = (wchar_t *)0x0;
  local_e0 = (undefined4 *)0x0;
  local_dc = 0;
  iVar6 = FUN_6b866fae(&local_fc,param_3,param_4,param_5,param_6);
  puVar9 = local_e4;
  if (iVar6 < 0) goto LAB_6b866ec4;
  local_d0 = 1;
  iVar6 = RtlInitUnicodeStringEx(local_c8,local_fc);
  puVar9 = local_e4;
  if (iVar6 < 0) goto LAB_6b866ec4;
  local_b8 = param_6;
  local_cc = FUN_6b814a34(param_7);
  local_100 = local_f0;
  uVar3 = 0x1000;
  puVar9 = local_e4;
  do {
    puVar4 = puVar9;
    local_10c = uVar3;
    uVar5 = local_100;
    puVar2 = local_e4;
    if (local_100 < uVar3) {
      uVar3 = FUN_6b8141f4(uVar3,0xfff,&local_104);
      if ((int)uVar3 < 0) {
        iVar6 = -0x7ffffff5;
      }
      else {
        uVar5 = local_104 & 0xfffff000;
        local_104 = uVar5;
        if (puVar9 == (undefined *)0x0) {
          local_108 = (undefined *)HeapAlloc(hHeap,0,uVar5);
          if (local_108 != (undefined *)0x0) {
            memset(local_108,0,uVar5);
            puVar4 = local_108;
            goto LAB_6b866cdc;
          }
        }
        else {
          puVar4 = (undefined *)HeapReAlloc(hHeap,0,puVar9,uVar5);
LAB_6b866cdc:
          puVar2 = puVar4;
          if (puVar4 != (undefined *)0x0) goto LAB_6b866cf5;
        }
        iVar6 = -0x7ff8fff2;
      }
    }
    else {
LAB_6b866cf5:
      local_e4 = puVar2;
      local_100 = uVar5;
      iVar6 = 0;
      puVar9 = puVar4;
      local_f4 = local_10c;
    }
    if (iVar6 < 0) goto LAB_6b866ec4;
    puVar7 = &local_d0;
    uVar11 = 0;
    local_14 = puVar9;
    local_10 = local_10c;
    _guard_check_icall();
    iVar6 = NtApphelpCacheControl(uVar11,puVar7);
    uVar3 = local_10;
  } while (iVar6 == -0x3fffffdd);
  if (iVar6 < 0) goto LAB_6b866ec4;
  local_104 = local_10;
  puVar4 = puVar9;
  puVar2 = local_e4;
  if (local_100 < local_10) {
    uVar3 = FUN_6b8141f4(local_10,0xfff,(uint *)&local_108);
    if ((int)uVar3 < 0) {
      iVar6 = -0x7ffffff5;
    }
    else {
      local_108 = (undefined *)((uint)local_108 & 0xfffff000);
      if (puVar9 == (undefined *)0x0) {
        puVar4 = (undefined *)HeapAlloc(hHeap,0,(SIZE_T)local_108);
        if (puVar4 != (undefined *)0x0) {
          memset(puVar4,0,(size_t)local_108);
          goto LAB_6b866db9;
        }
      }
      else {
        puVar4 = (undefined *)HeapReAlloc(hHeap,0,puVar9,(SIZE_T)local_108);
LAB_6b866db9:
        puVar2 = puVar4;
        if (puVar4 != (undefined *)0x0) goto LAB_6b866dce;
      }
      iVar6 = -0x7ff8fff2;
    }
  }
  else {
LAB_6b866dce:
    local_e4 = puVar2;
    iVar6 = 0;
    puVar9 = puVar4;
    local_f4 = local_104;
  }
  if (-1 < iVar6) {
    uVar3 = 0;
    do {
      local_e8 = uVar3;
      if (((local_f4 < uVar3) || (uVar5 = FUN_6b8141f4(uVar3,8,&local_100), (int)uVar5 < 0)) ||
         (local_f4 < local_100)) goto LAB_6b866f0d;
      local_108 = *(undefined **)(puVar9 + uVar3);
      uVar5 = *(uint *)(puVar9 + uVar3 + 4);
      local_104 = uVar5;
      uVar3 = FUN_6b8141f4(uVar3,8,&local_e8);
      uVar1 = local_e8;
      puVar9 = local_e4;
      if ((((int)uVar3 < 0) ||
          (uVar3 = FUN_6b8141f4(local_e8,uVar5,&local_10c), puVar9 = local_e4, (int)uVar3 < 0)) ||
         ((uVar3 = FUN_6b8141f4(local_10c,3,&local_10c), puVar9 = local_e4, (int)uVar3 < 0 ||
          (uVar3 = local_10c & 0xfffffffc, local_10c = uVar3, local_f4 < uVar3))))
      goto LAB_6b866f0d;
    } while (local_108 != &DAT_00000001);
    puVar7 = (undefined4 *)(local_e4 + uVar1);
    if (local_104 == 0x1c8) {
      local_e0 = (undefined4 *)
                 RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,0x1c8);
      puVar9 = local_e4;
      if (local_e0 == (undefined4 *)0x0) {
        iVar6 = -0x3fffffe9;
        hHeap = local_f8;
        goto LAB_6b866ec4;
      }
      puVar10 = local_e0;
      for (iVar6 = 0x72; iVar6 != 0; iVar6 = iVar6 + -1) {
        *puVar10 = *puVar7;
        puVar7 = puVar7 + 1;
        puVar10 = puVar10 + 1;
      }
      local_dc = 0x1c8;
    }
LAB_6b866f0d:
    iVar6 = 0;
    *local_d8 = local_e0;
    *local_d4 = local_dc;
    hHeap = local_f8;
  }
LAB_6b866ec4:
  if (local_fc != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_fc);
    hHeap = local_f8;
    puVar9 = local_e4;
  }
  if (puVar9 != (undefined *)0x0) {
    HeapFree(hHeap,0,puVar9);
  }
  return iVar6;
}



uint __fastcall FUN_6b866f29(wchar_t *param_1,uint param_2)

{
  uint uVar1;
  undefined4 uVar2;
  undefined *puVar3;
  undefined local_dc [136];
  undefined4 local_54;
  int local_48;
  undefined4 local_44;
  undefined4 local_40;
  int local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  local_18 = 0;
  local_14 = 0;
  local_10 = 0;
  local_c = 0;
  local_8 = 0;
  uVar1 = FUN_6b813352(&local_18,param_1,param_2);
  if (-1 < (int)uVar1) {
    memset(local_dc,0,0xc4);
    local_44 = local_c;
    local_40 = local_8;
    local_48 = local_18;
    puVar3 = local_dc;
    uVar2 = 1;
    local_54 = 0x109f;
    _guard_check_icall();
    uVar1 = NtApphelpCacheControl(uVar2,puVar3);
  }
  FUN_6b813327(&local_18);
  return uVar1;
}



undefined4 __fastcall
FUN_6b866fae(wchar_t **param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
            ushort param_5)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  wchar_t *pwVar5;
  undefined3 extraout_var;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 uVar6;
  int in_FS_OFFSET;
  undefined4 local_8;
  
  local_8 = 0x200;
  iVar2 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,0x200);
  if (iVar2 == 0) {
LAB_6b866fdb:
    uVar6 = 0xc0000017;
  }
  else {
    iVar3 = PackageIdFromFullName(param_2,0,&local_8,iVar2);
    uVar6 = extraout_ECX;
    if (iVar3 == 0x7a) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iVar2);
      iVar2 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,local_8);
      if (iVar2 == 0) goto LAB_6b866fdb;
      iVar3 = PackageIdFromFullName(param_2,0,&local_8,iVar2);
      uVar6 = extraout_ECX_00;
      if (iVar3 == 0) goto LAB_6b86703e;
      uVar6 = 0xc00000e5;
    }
    else {
LAB_6b86703e:
      uVar4 = FUN_6b867e0b(uVar6,*(short **)(iVar2 + 0x10),uVar6,uVar6,*(short **)(iVar2 + 0x1c),
                           *(short **)(iVar2 + 0x18));
      pwVar5 = (wchar_t *)
               RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,uVar4);
      if (pwVar5 == (wchar_t *)0x0) {
        uVar6 = 0xc0000017;
      }
      else {
        bVar1 = FUN_6b867d9b(pwVar5,uVar4,*(undefined4 *)(iVar2 + 4),*(undefined4 *)(iVar2 + 8),
                             *(undefined4 *)(iVar2 + 0xc),*(undefined2 **)(iVar2 + 0x10),
                             *(undefined2 **)(iVar2 + 0x1c),*(undefined2 **)(iVar2 + 0x18),param_3,
                             param_4,param_5);
        if (CONCAT31(extraout_var,bVar1) == 0) {
          uVar6 = 0xc00000e5;
        }
        else {
          uVar6 = 0;
          *param_1 = pwVar5;
          pwVar5 = (wchar_t *)0x0;
        }
        if (pwVar5 != (wchar_t *)0x0) {
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pwVar5);
        }
      }
    }
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iVar2);
  }
  return uVar6;
}



uint __fastcall FUN_6b8670db(undefined4 param_1,wchar_t *param_2,uint param_3,undefined4 param_4)

{
  uint uVar1;
  undefined4 uVar2;
  undefined *puVar3;
  undefined local_e4 [44];
  undefined4 local_b8;
  int local_ac;
  undefined4 local_a8;
  undefined4 local_a4;
  undefined4 *local_a0;
  undefined4 local_9c;
  int local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  local_18 = 0;
  local_14 = 0;
  local_10 = 0;
  local_c = 0;
  local_8 = 0;
  FUN_6b8671a2(3,"CompatCachepSetFlags",0xb0,"Full path: %ws, Flags: %x");
  uVar1 = FUN_6b813352(&local_18,param_2,param_3);
  if (-1 < (int)uVar1) {
    memset(local_e4,0,0xc4);
    local_ac = local_18;
    local_a8 = local_c;
    local_a4 = local_8;
    local_a0 = &param_4;
    puVar3 = local_e4;
    uVar2 = 2;
    local_b8 = 0x80;
    local_9c = 4;
    _guard_check_icall();
    uVar1 = NtApphelpCacheControl(uVar2,puVar3);
  }
  FUN_6b813327(&local_18);
  return uVar1;
}



void __cdecl
FUN_6b8671a2(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  code *pcVar1;
  undefined *puVar2;
  
  pcVar1 = DAT_6b8b06e4;
  if (DAT_6b8b06e4 != (code *)0x0) {
    puVar2 = &stack0x00000014;
    _guard_check_icall();
    (*pcVar1)(param_1,param_2,param_3,param_4,puVar2);
  }
  return;
}



uint __fastcall FUN_6b8671cf(uint param_1,int param_2,uint param_3)

{
  uint uVar1;
  uint uVar2;
  
  uVar2 = 0;
  uVar1 = ~param_1;
  if (param_3 != 0) {
    do {
      uVar1 = uVar1 >> 8 ^
              *(uint *)(&DAT_6b88c680 + ((*(byte *)(uVar2 + param_2) ^ uVar1) & 0xff) * 4);
      uVar2 = uVar2 + 1;
    } while (uVar2 < param_3);
  }
  return ~uVar1;
}



undefined4 __fastcall FUN_6b867200(wchar_t *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_30;
  undefined4 local_2c;
  undefined *local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined local_18 [8];
  undefined local_10 [4];
  wchar_t *local_c;
  undefined4 local_8;
  
  uVar2 = 0;
  local_c = (wchar_t *)0x0;
  iVar1 = _wcsnicmp(param_1,L"\\SystemRoot\\",0xc);
  if (iVar1 == 0) {
    RtlInitUnicodeString(local_10,param_1);
  }
  else {
    iVar1 = RtlDosPathNameToNtPathName_U_WithStatus(param_1,local_10,0,0);
    if (iVar1 < 0) {
      FUN_6b8671a2(1,"AslDoesDirectoryExistNtPath",0x1de,
                   "RtlDosPathNameToNtPathName_U_WithStatus failed for %S [%x]");
      goto LAB_6b8672b4;
    }
  }
  local_28 = local_10;
  local_30 = 0x18;
  local_2c = 0;
  local_24 = 0x40;
  local_20 = 0;
  local_1c = 0;
  iVar1 = ZwOpenFile(&local_8,0x100080,&local_30,local_18,3,1);
  if (iVar1 < 0) {
    if ((iVar1 != -0x3fffffde) && (iVar1 != -0x3fffffbd)) goto LAB_6b8672b4;
  }
  else {
    ZwClose(local_8);
  }
  uVar2 = 1;
LAB_6b8672b4:
  if ((local_c != param_1) && (local_c != (wchar_t *)0x0)) {
    RtlFreeUnicodeString(local_10);
  }
  return uVar2;
}



undefined4 __fastcall FUN_6b8672cf(undefined4 param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_30;
  undefined4 local_2c;
  undefined *local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined local_18 [8];
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  uVar2 = 0;
  local_8 = 0;
  local_10 = 0;
  local_c = 0;
  RtlInitUnicodeString(local_18,param_1);
  local_28 = local_18;
  local_30 = 0x18;
  local_2c = 0;
  local_24 = 0x40;
  local_20 = 0;
  local_1c = 0;
  iVar1 = ZwOpenFile(&local_8,0x100080,&local_30,&local_10,1,0);
  if (iVar1 < 0) {
    if ((iVar1 == -0x3fffffbd) || (iVar1 == -0x3fffffde)) {
      uVar2 = 1;
    }
  }
  else {
    uVar2 = 1;
    ZwClose(local_8);
  }
  return uVar2;
}



int __fastcall FUN_6b86734d(undefined4 param_1)

{
  int iVar1;
  
  iVar1 = ZwClose(param_1);
  if (iVar1 < 0) {
    FUN_6b8671a2(1,"AslFileClose",0x6fe,"ZwClose failed [%x]");
  }
  return iVar1;
}



undefined4 __fastcall FUN_6b86737b(int param_1)

{
  if (((param_1 != -0x3fffffc6) && (param_1 != -0x3fffffcc)) && (param_1 != -0x3fffff34)) {
    return 0;
  }
  return 1;
}



int __fastcall FUN_6b86739a(undefined4 *param_1,int param_2)

{
  wchar_t *_Str1;
  int iVar1;
  uint uVar2;
  int in_FS_OFFSET;
  undefined4 uVar3;
  char *pcVar4;
  undefined4 local_3c;
  undefined4 local_38;
  undefined *local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined local_24 [8];
  undefined local_1c [4];
  int local_18;
  undefined4 *local_14;
  int local_10;
  uint local_c;
  char local_5;
  
  *param_1 = 0;
  local_c = 0;
  local_5 = '\0';
  local_14 = param_1;
  local_10 = param_2;
  RtlInitUnicodeString(local_1c,param_2);
  uVar2 = 0x208;
  do {
    _Str1 = (wchar_t *)
            RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,uVar2);
    if (_Str1 == (wchar_t *)0x0) {
      FUN_6b8671a2(1,"AslFileOpen",0x68a,"Out of memory");
      iVar1 = -0x3fffffe9;
      goto LAB_6b86751c;
    }
    iVar1 = RtlGetFullPathName_UEx(param_2,uVar2,_Str1,0,&local_c);
    if (iVar1 < 0) {
      pcVar4 = "Failed to get full path [%x]";
      uVar3 = 0x695;
      goto LAB_6b8674ed;
    }
    if (uVar2 < local_c) {
      if (local_5 != '\0') {
        FUN_6b8671a2(1,"AslFileOpen",0x69d,
                     "RtlGetFullPathName_UEx failed to get full path with larger buffer.");
        iVar1 = -0x3fffffdd;
        goto LAB_6b86751c;
      }
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,_Str1);
      _Str1 = (wchar_t *)0x0;
      uVar2 = local_c;
    }
    local_5 = '\x01';
    param_2 = local_10;
  } while (uVar2 <= local_c);
  iVar1 = _wcsnicmp(_Str1,L"\\SystemRoot\\",0xc);
  if ((iVar1 == 0) ||
     (iVar1 = RtlDosPathNameToNtPathName_U_WithStatus(_Str1,local_1c,0,0), -1 < iVar1)) {
    local_38 = 0;
    local_34 = local_1c;
    local_2c = 0;
    local_28 = 0;
    local_3c = 0x18;
    local_30 = 0x40;
    iVar1 = ZwCreateFile(local_14,0x80100080,&local_3c,local_24,0,0x80,1,1,0x60,0,0);
    if (-1 < iVar1) goto LAB_6b86751c;
    pcVar4 = "NtCreateFile failed [%x]";
    uVar3 = 0x6cc;
  }
  else {
    pcVar4 = "RtlDosPathNameToNtPathName_U_WithStatus failed [%x]";
    uVar3 = 0x6b4;
  }
LAB_6b8674ed:
  FUN_6b8671a2(1,"AslFileOpen",uVar3,pcVar4);
LAB_6b86751c:
  if (local_18 != local_10) {
    RtlFreeUnicodeString(local_1c);
  }
  if (_Str1 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,_Str1);
  }
  return iVar1;
}



undefined4 __fastcall FUN_6b86754b(int param_1)

{
  if (((param_1 != -0x3fffff77) && (param_1 != -0x3fffff76)) && (param_1 != -0x3fffff75)) {
    return 0;
  }
  return 1;
}



undefined4 __fastcall FUN_6b86756a(undefined2 *param_1,short *param_2)

{
  uint uVar1;
  short sVar2;
  int iVar3;
  short *psVar4;
  undefined4 uVar5;
  int in_FS_OFFSET;
  int local_c;
  undefined4 local_8;
  
  uVar5 = 0;
  local_c = 0;
  local_8 = 0;
  RtlInitUnicodeString(&local_c,L"\\Registry\\Machine");
  *param_1 = 0;
  psVar4 = param_2;
  do {
    sVar2 = *psVar4;
    psVar4 = psVar4 + 1;
  } while (sVar2 != 0);
  uVar1 = local_c + 2 + ((int)psVar4 - (int)(param_2 + 1) >> 1) * 2;
  iVar3 = *(int *)(in_FS_OFFSET + 0x30);
  param_1[1] = (short)uVar1;
  iVar3 = RtlAllocateHeap(*(undefined4 *)(iVar3 + 0x18),8,uVar1 & 0xffff);
  *(int *)(param_1 + 2) = iVar3;
  if (iVar3 == 0) {
    uVar5 = 0xc0000017;
    FUN_6b8671a2(1,"AslRegistryBuildMachinePath",0x58c,
                 "Failed to allocate %d bytes for user key buffer");
  }
  else {
    RtlAppendUnicodeStringToString(param_1,&local_c);
    if ((param_2 != (short *)0x0) && (*param_2 != 0x5c)) {
      RtlAppendUnicodeToString(param_1,&DAT_6b88423c);
    }
    RtlAppendUnicodeToString(param_1,param_2);
  }
  return uVar5;
}



void __thiscall FUN_6b867627(void *this,undefined4 param_1,undefined4 param_2)

{
  undefined4 extraout_EDX;
  undefined4 uVar1;
  undefined8 uVar2;
  undefined4 local_218;
  undefined local_214 [12];
  uint local_208;
  undefined local_204 [508];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_218 = 0;
  uVar2 = ZwEnumerateKey(param_1,param_2,0,local_214,0x20c,&local_218);
  uVar1 = (undefined4)((ulonglong)uVar2 >> 0x20);
  if ((-1 < (int)uVar2) && ((local_208 >> 1) + 1 < 0x104)) {
    memcpy(this,local_204,local_208);
    *(undefined2 *)((int)this + (local_208 & 0xfffffffe)) = 0;
    uVar1 = extraout_EDX;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar1);
  return;
}



int __fastcall FUN_6b8676b9(undefined4 *param_1,short *param_2)

{
  int iVar1;
  int in_FS_OFFSET;
  undefined4 uVar2;
  char *pcVar3;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 *local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  int local_10;
  undefined4 local_c [2];
  
  local_14 = 0;
  local_10 = 0;
  *param_1 = 0;
  local_c[0] = 0;
  iVar1 = FUN_6b86756a((undefined2 *)&local_14,param_2);
  if (iVar1 < 0) {
    pcVar3 = "AslRegistryBuildMachinePath failed for %ws [%x]";
    uVar2 = 0x614;
  }
  else {
    local_24 = &local_14;
    local_2c = 0x18;
    local_28 = 0;
    local_20 = 0x40;
    local_1c = 0;
    local_18 = 0;
    iVar1 = ZwOpenKey(local_c,0x20019,&local_2c);
    uVar2 = local_c[0];
    if (-1 < iVar1) {
      iVar1 = 0;
      local_c[0] = 0;
      *param_1 = uVar2;
      goto LAB_6b867758;
    }
    if (iVar1 == -0x3fffffcc) goto LAB_6b867758;
    pcVar3 = "NtOpenKey failed for %ws [%x]";
    uVar2 = 0x63f;
  }
  FUN_6b8671a2(1,"AslRegistryGetKey",uVar2,pcVar3);
LAB_6b867758:
  if (local_10 != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_10);
  }
  return iVar1;
}



void __fastcall FUN_6b86777b(undefined4 *param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar1;
  undefined8 uVar2;
  undefined4 local_20;
  undefined local_1c [4];
  int local_18;
  int local_14;
  undefined4 local_10;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_20 = 0;
  *param_1 = 0;
  uVar2 = ZwQueryValueKey(param_2,param_3,2,local_1c,0x14,&local_20);
  uVar1 = (undefined4)((ulonglong)uVar2 >> 0x20);
  if ((int)uVar2 < 0) {
    if ((int)uVar2 != -0x3fffffcc) {
      FUN_6b8671a2(1,"AslRegistryGetUInt32_UStr",0x3a1,"Failed to query key value [%x]");
      uVar1 = extraout_EDX;
    }
  }
  else if ((local_18 == 4) && (local_14 == 4)) {
    *param_1 = local_10;
  }
  else {
    FUN_6b8671a2(1,"AslRegistryGetUInt32_UStr",0x3a8,"Invalid value type");
    uVar1 = extraout_EDX_00;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar1);
  return;
}



int __fastcall FUN_6b86781e(undefined4 *param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  undefined4 local_24;
  undefined4 local_20;
  undefined *local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined local_c [8];
  
  *param_1 = 0;
  iVar1 = RtlInitUnicodeStringEx(local_c,param_3);
  if (iVar1 < 0) {
    FUN_6b8671a2(1,"AslRegistryOpenSubKey",0x31c,"AslRegistryOpenSubKey passed bad Path [%x]");
  }
  else {
    local_14 = 0;
    local_1c = local_c;
    local_10 = 0;
    local_24 = 0x18;
    local_18 = 0x40;
    local_20 = param_2;
    iVar1 = ZwOpenKey(param_1,0x20019,&local_24);
  }
  return iVar1;
}



void __fastcall FUN_6b867897(wchar_t **param_1,void *param_2)

{
  uint uVar1;
  wchar_t *pwVar2;
  HANDLE hFindFile;
  BOOL BVar3;
  int iVar4;
  uint uVar5;
  undefined4 extraout_EDX;
  uint extraout_EDX_00;
  uint extraout_EDX_01;
  uint extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 extraout_EDX_04;
  wchar_t *pwVar6;
  wchar_t *lpFileName;
  int in_FS_OFFSET;
  longlong lVar7;
  undefined4 uVar8;
  char *pcVar9;
  uint local_264;
  wchar_t *local_260;
  byte local_25c;
  DWORD local_23c;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  *param_1 = (wchar_t *)0x0;
  pwVar6 = (wchar_t *)0x0;
  local_260 = (wchar_t *)0x0;
  memset((_WIN32_FIND_DATAW *)&local_25c,0,0x250);
  local_264 = 9;
  uVar1 = FUN_6b81464d(&local_260,param_2);
  lpFileName = local_260;
  if ((int)uVar1 < 0) {
    pcVar9 = "AslStringDuplicate failed [%x]";
    uVar8 = 0x2bd;
LAB_6b867908:
    FUN_6b8671a2(1,"AslPathBuildSignatureForDirectoryFileLongpath",uVar8,pcVar9);
    lVar7 = CONCAT44(extraout_EDX,pwVar6);
    lpFileName = local_260;
  }
  else {
    pwVar2 = wcsrchr(local_260,L'\\');
    pwVar6 = lpFileName;
    if (pwVar2 != (wchar_t *)0x0) {
      pwVar6 = pwVar2 + 1;
    }
    *pwVar6 = L'*';
    pwVar6[1] = L'\0';
    hFindFile = FindFirstFileW(lpFileName,(LPWIN32_FIND_DATAW)&local_25c);
    if (hFindFile == (HANDLE)0xffffffff) {
      GetLastError();
      FUN_6b8671a2(1,"AslPathBuildSignatureForDirectoryFileLongpath",0x2d0,
                   "FindFirstFile failed for %ws [GLE: %x]");
      lVar7 = (ulonglong)extraout_EDX_00 << 0x20;
      goto LAB_6b867aa7;
    }
    uVar1 = 9;
    do {
      if (((local_25c & 0x10) == 0) && (local_23c != 0)) {
        local_264 = uVar1 - 1;
      }
      BVar3 = FindNextFileW(hFindFile,(LPWIN32_FIND_DATAW)&local_25c);
    } while ((BVar3 != 0) && (uVar1 = local_264, 0 < (int)local_264));
    FindClose(hFindFile);
    iVar4 = FUN_6b81485c(param_2,(int *)&local_264);
    lpFileName = local_260;
    if (iVar4 < 0) {
      pcVar9 = "RtlStringCchLengthW failed [%x]";
      uVar8 = 0x2eb;
    }
    else {
      uVar5 = FUN_6b867d76(local_264,0x15,&local_264);
      uVar1 = local_264;
      if (-1 < (int)uVar5) {
        lVar7 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                local_264 * 2);
        pwVar6 = (wchar_t *)lVar7;
        lpFileName = local_260;
        if (pwVar6 == (wchar_t *)0x0) goto LAB_6b867aa7;
        iVar4 = FUN_6b832879(pwVar6,uVar1,L"SIGN.MEDIA=%X %s");
        if (-1 < iVar4) {
          *param_1 = pwVar6;
          lVar7 = (ulonglong)extraout_EDX_02 << 0x20;
          lpFileName = local_260;
          goto LAB_6b867aa7;
        }
        pcVar9 = "RtlStringCchPrintfW failed [%x]";
        uVar8 = 0x312;
        goto LAB_6b867908;
      }
      pcVar9 = "RtlSizeTAdd failed [%x]";
      uVar8 = 0x2f8;
    }
    FUN_6b8671a2(1,"AslPathBuildSignatureForDirectoryFileLongpath",uVar8,pcVar9);
    lVar7 = (ulonglong)extraout_EDX_01 << 0x20;
  }
LAB_6b867aa7:
  uVar8 = (undefined4)((ulonglong)lVar7 >> 0x20);
  if (lpFileName != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpFileName);
    uVar8 = extraout_EDX_03;
  }
  if ((int)lVar7 != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,(int)lVar7);
    uVar8 = extraout_EDX_04;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar8);
  return;
}



void __fastcall FUN_6b867ae4(wchar_t **param_1,LPCWSTR param_2)

{
  wchar_t wVar1;
  HANDLE hFindFile;
  uint uVar2;
  wchar_t *pwVar3;
  int iVar4;
  uint uVar5;
  wchar_t *pwVar6;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  wchar_t *_Str;
  wchar_t *pwVar7;
  int in_FS_OFFSET;
  undefined4 uVar8;
  char *pcVar9;
  size_t local_268;
  uint local_264;
  wchar_t *local_260;
  _WIN32_FIND_DATAW local_25c;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  *param_1 = (wchar_t *)0x0;
  local_260 = (wchar_t *)0x0;
  local_268 = 0;
  memset(&local_25c,0,0x250);
  local_264 = 0;
  hFindFile = FindFirstFileW(param_2,&local_25c);
  if (hFindFile == (HANDLE)0xffffffff) {
    GetLastError();
    FUN_6b8671a2(1,"AslPathBuildSignatureForInternetFileLongpath",0x396,
                 "FindFirstFile failed for %ws [GLE: %d]");
    uVar8 = extraout_EDX;
    goto LAB_6b867d65;
  }
  uVar2 = FUN_6b81464d(&local_260,param_2);
  _Str = local_260;
  if ((int)uVar2 < 0) {
    FUN_6b8671a2(1,"AslPathBuildSignatureForInternetFileLongpath",0x3a7,
                 "AslStringDuplicate failed [%x]");
    pwVar7 = (wchar_t *)0x0;
    _Str = local_260;
  }
  else {
    pwVar7 = wcsrchr(local_260,L'.');
    if (pwVar7 != (wchar_t *)0x0) {
      pwVar6 = pwVar7;
      do {
        wVar1 = *pwVar6;
        pwVar6 = pwVar6 + 1;
      } while (wVar1 != L'\0');
      local_268 = ((int)pwVar6 - (int)(pwVar7 + 1) >> 1) * 2 + 2;
    }
    pwVar3 = wcsrchr(_Str,L'\\');
    pwVar6 = _Str;
    if (pwVar3 != (wchar_t *)0x0) {
      pwVar6 = pwVar3 + 1;
    }
    pwVar3 = wcsrchr(_Str,L'[');
    if (pwVar3 != (wchar_t *)0x0) {
      if (pwVar7 == (wchar_t *)0x0) {
        *pwVar3 = L'\0';
      }
      else {
        memmove(pwVar3,pwVar7,local_268);
      }
    }
    iVar4 = FUN_6b81485c(pwVar6,(int *)&local_264);
    if (iVar4 < 0) {
      pcVar9 = "RtlStringCbLengthW failed to find the string end [%x]";
      uVar8 = 0x3ca;
    }
    else {
      uVar5 = FUN_6b867d76(local_264,0x1a,&local_264);
      uVar2 = local_264;
      if (-1 < (int)uVar5) {
        pwVar7 = (wchar_t *)
                 RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                 local_264 * 2);
        _Str = local_260;
        if (pwVar7 != (wchar_t *)0x0) {
          iVar4 = FUN_6b832879(pwVar7,uVar2,L"SIGN.IE=%X%X %s");
          if (iVar4 < 0) {
            FUN_6b8671a2(1,"AslPathBuildSignatureForInternetFileLongpath",0x3e5,
                         "RtlStringCchPrintfW failed when building internet file signature [%x]");
            _Str = local_260;
          }
          else {
            *param_1 = pwVar7;
            pwVar7 = (wchar_t *)0x0;
            _Str = local_260;
          }
        }
        goto LAB_6b867d2d;
      }
      pcVar9 = "RtlSizeTAdd failed [%x]";
      uVar8 = 0x3d4;
    }
    FUN_6b8671a2(1,"AslPathBuildSignatureForInternetFileLongpath",uVar8,pcVar9);
    pwVar7 = (wchar_t *)0x0;
  }
LAB_6b867d2d:
  if (_Str != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,_Str);
  }
  if (pwVar7 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pwVar7);
  }
  FindClose(hFindFile);
  uVar8 = extraout_EDX_00;
LAB_6b867d65:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar8);
  return;
}



uint __fastcall FUN_6b867d76(uint param_1,int param_2,uint *param_3)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = param_1 + param_2;
  uVar2 = uVar1;
  if (uVar1 < param_1) {
    uVar2 = 0xffffffff;
  }
  *param_3 = uVar2;
  return -(uint)(uVar1 < param_1) & 0xc0000095;
}



byte __fastcall
FUN_6b867d9b(wchar_t *param_1,uint param_2,undefined4 param_3,undefined4 param_4,undefined4 param_5,
            undefined2 *param_6,undefined2 *param_7,undefined2 *param_8,undefined4 param_9,
            undefined4 param_10,ushort param_11)

{
  int iVar1;
  
  memset(param_1,0,param_2);
  if (param_8 == (undefined2 *)0x0) {
    param_8 = &DAT_6b884240;
  }
  if (param_7 == (undefined2 *)0x0) {
    param_7 = &DAT_6b884240;
  }
  if (param_6 == (undefined2 *)0x0) {
    param_6 = &DAT_6b884240;
  }
  iVar1 = swprintf_s(param_1,param_2 >> 1,L"%08I32x\t%016I64x\t%016I64x\t%04hx\t%ls\t%ls\t%ls",
                     param_3,param_4,param_5,param_9,param_10,(uint)param_11,param_6,param_7,param_8
                    );
  return -(iVar1 != -1) & 1;
}



int __fastcall
FUN_6b867e0b(undefined4 param_1,short *param_2,undefined4 param_3,undefined4 param_4,short *param_5,
            short *param_6)

{
  short *psVar1;
  short sVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  iVar5 = 2;
  if (param_2 == (short *)0x0) {
    iVar4 = 0x62;
  }
  else {
    psVar1 = param_2 + 1;
    do {
      sVar2 = *param_2;
      param_2 = param_2 + 1;
    } while (sVar2 != 0);
    iVar4 = ((int)param_2 - (int)psVar1 >> 1) * 2 + 0x62;
  }
  iVar3 = iVar5;
  if (param_5 != (short *)0x0) {
    psVar1 = param_5 + 1;
    do {
      sVar2 = *param_5;
      param_5 = param_5 + 1;
    } while (sVar2 != 0);
    iVar3 = ((int)param_5 - (int)psVar1 >> 1) * 2 + 2;
  }
  if (param_6 != (short *)0x0) {
    psVar1 = param_6 + 1;
    do {
      sVar2 = *param_6;
      param_6 = param_6 + 1;
    } while (sVar2 != 0);
    iVar5 = ((int)param_6 - (int)psVar1 >> 1) * 2 + 2;
  }
  return iVar5 + iVar4 + iVar3;
}



undefined4 __fastcall FUN_6b867e87(wchar_t *param_1,void *param_2,uint param_3)

{
  uint uVar1;
  wchar_t wVar2;
  short sVar3;
  wchar_t *pwVar4;
  int iVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint local_14;
  
  pwVar4 = param_1;
  do {
    wVar2 = *pwVar4;
    pwVar4 = pwVar4 + 1;
  } while (wVar2 != L'\0');
  uVar9 = (int)pwVar4 - (int)(param_1 + 1) >> 1;
  if (param_3 < uVar9 + 1) {
    return 0xc0000023;
  }
  pwVar4 = wcschr(param_1,L':');
  if (pwVar4 == (wchar_t *)0x0) {
    local_14 = 4;
    iVar5 = wcsncmp(param_1,L"\\??\\",4);
    if (iVar5 == 0) goto LAB_6b867f28;
    iVar5 = wcsncmp(param_1,(wchar_t *)&_Str2_6b88515c,2);
    if (iVar5 == 0) {
      local_14 = 2;
      goto LAB_6b867f28;
    }
    pwVar4 = wcschr(param_1,L'\\');
    if (pwVar4 == (wchar_t *)0x0) {
      local_14 = 1;
      goto LAB_6b867f28;
    }
  }
  local_14 = ((uint)((int)pwVar4 - (int)param_1) >> 1) + 1;
LAB_6b867f28:
  memmove(param_2,param_1,local_14 * 2);
  uVar6 = local_14;
  uVar8 = local_14;
  while (uVar6 < uVar9) {
    wVar2 = param_1[uVar6];
    uVar7 = uVar6;
    if ((wVar2 == L'\\') || (wVar2 == L'/')) {
      if ((uVar8 == 0) || (*(short *)((int)param_2 + uVar8 * 2 + -2) != 0x5c)) {
        *(undefined2 *)((int)param_2 + uVar8 * 2) = 0x5c;
        uVar8 = uVar8 + 1;
      }
    }
    else if (wVar2 == L'.') {
      uVar1 = uVar6 + 1;
      if (uVar1 == uVar9) break;
      wVar2 = param_1[uVar6 + 1];
      uVar7 = uVar1;
      if ((((wVar2 != L'\\') && (wVar2 != L'/')) && (uVar7 = uVar6, wVar2 == L'.')) &&
         (((uVar6 + 2 == uVar9 || (param_1[uVar6 + 2] == L'\\')) || (param_1[uVar6 + 2] == L'/'))))
      {
        if (local_14 <= uVar8) {
          do {
            sVar3 = *(short *)((int)param_2 + uVar8 * 2);
            *(undefined2 *)((int)param_2 + uVar8 * 2) = 0;
            if (sVar3 == 0x5c) break;
            uVar8 = uVar8 - 1;
          } while (local_14 <= uVar8);
          if (local_14 <= uVar8) {
            do {
              sVar3 = *(short *)((int)param_2 + uVar8 * 2);
              *(undefined2 *)((int)param_2 + uVar8 * 2) = 0;
              if (sVar3 == 0x5c) break;
              uVar8 = uVar8 - 1;
            } while (local_14 <= uVar8);
            uVar7 = uVar1;
            if (local_14 <= uVar8) goto LAB_6b868088;
          }
        }
        uVar8 = uVar8 + 1;
        uVar7 = uVar1;
      }
    }
    else {
      if (uVar6 < uVar9) {
        do {
          wVar2 = param_1[uVar6];
          if ((wVar2 == L'\\') || (wVar2 == L'/')) break;
          *(wchar_t *)((int)param_2 + uVar8 * 2) = wVar2;
          uVar8 = uVar8 + 1;
          uVar6 = uVar6 + 1;
        } while (uVar6 < uVar9);
        if ((((uVar6 < uVar9) && (1 < uVar8)) && (*(short *)((int)param_2 + uVar8 * 2 + -2) == 0x2e)
            ) && (*(short *)((int)param_2 + uVar8 * 2 + -4) != 0x2e)) {
          uVar8 = uVar8 - 1;
        }
      }
      uVar7 = uVar6 - 1;
    }
LAB_6b868088:
    uVar6 = uVar7 + 1;
  }
  *(undefined2 *)((int)param_2 + uVar8 * 2) = 0;
  return 0;
}



undefined4 __fastcall FUN_6b8680a3(ushort *param_1)

{
  short sVar1;
  ushort uVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  ushort uVar6;
  ushort uVar7;
  ushort uVar8;
  
  uVar6 = *param_1 >> 1;
  if ((*param_1 < 2) || (**(wchar_t **)(param_1 + 2) == L'\0')) {
    FUN_6b8671a2(1,"AslPathCleanUstr",0x2d9,"AslpPathGetFormatInfo failed [%x]");
    return 0xc00000f2;
  }
  if ((7 < uVar6) && (iVar3 = _wcsnicmp(*(wchar_t **)(param_1 + 2),L"\\??\\UNC\\",8), iVar3 == 0)) {
    iVar3 = 5;
    goto LAB_6b86816c;
  }
  iVar3 = 4;
  if (3 < uVar6) {
    iVar4 = wcsncmp(*(wchar_t **)(param_1 + 2),L"\\??\\",4);
    if (iVar4 == 0) {
      iVar3 = 3;
      goto LAB_6b86816c;
    }
    iVar4 = wcsncmp(*(wchar_t **)(param_1 + 2),L"\\\\?\\",4);
    if ((iVar4 == 0) || (iVar4 = wcsncmp(*(wchar_t **)(param_1 + 2),L"\\\\.\\",4), iVar4 == 0))
    goto LAB_6b86816c;
  }
  if ((uVar6 < 3) ||
     (iVar4 = wcsncmp(*(wchar_t **)(param_1 + 2),(wchar_t *)&_Str2_6b88515c,2), iVar4 != 0)) {
    iVar3 = 1;
  }
LAB_6b86816c:
  uVar7 = 0;
  do {
    uVar8 = uVar7;
    uVar2 = uVar7;
    if ((uint)*param_1 <= (uint)uVar7 * 2) break;
    sVar1 = *(short *)((uint)uVar7 * 2 + *(int *)(param_1 + 2));
    if ((sVar1 == 0x5c) || (sVar1 == 0x2f)) {
      iVar3 = iVar3 + -1;
    }
    uVar7 = uVar7 + 1;
    uVar8 = uVar7;
    uVar2 = uVar7;
  } while (0 < iVar3);
  do {
    if (uVar6 <= uVar8) {
LAB_6b868322:
      *(undefined2 *)(*(int *)(param_1 + 2) + (uint)uVar7 * 2) = 0;
      *param_1 = uVar7 * 2;
      return 0;
    }
    if (uVar8 < uVar7) {
      FUN_6b8671a2(1,"AslPathCleanUstr",0x2e5,
                   "AslPathCleanUstr failed with source pointer behind destination pointer.");
      return 0xc00000e5;
    }
    iVar3 = *(int *)(param_1 + 2);
    uVar5 = (uint)uVar8;
    sVar1 = *(short *)(iVar3 + uVar5 * 2);
    if ((sVar1 == 0x5c) || (sVar1 == 0x2f)) {
      if (uVar7 == 0) {
        uVar5 = 0;
      }
      else {
        uVar5 = (uint)uVar7;
        if (*(short *)(iVar3 + -2 + uVar5 * 2) == 0x5c) goto LAB_6b868314;
      }
      *(undefined2 *)(iVar3 + uVar5 * 2) = 0x5c;
      uVar7 = uVar7 + 1;
    }
    else if (sVar1 == 0x2e) {
      if (uVar5 + 1 == (uint)uVar6) goto LAB_6b868322;
      sVar1 = *(short *)(iVar3 + 2 + uVar5 * 2);
      if ((sVar1 != 0x5c) && (sVar1 != 0x2f)) {
        if ((sVar1 != 0x2e) ||
           (((uVar5 + 2 != (uint)uVar6 &&
             (sVar1 = *(short *)(iVar3 + (uVar5 + 2) * 2), sVar1 != 0x5c)) && (sVar1 != 0x2f))))
        goto LAB_6b868314;
        if (uVar2 <= uVar7) {
          do {
            sVar1 = *(short *)(*(int *)(param_1 + 2) + (uint)uVar7 * 2);
            *(undefined2 *)(*(int *)(param_1 + 2) + (uint)uVar7 * 2) = 0;
            if (sVar1 == 0x5c) break;
            uVar7 = uVar7 - 1;
          } while (uVar2 <= uVar7);
          if (uVar2 <= uVar7) {
            do {
              sVar1 = *(short *)(*(int *)(param_1 + 2) + (uint)uVar7 * 2);
              *(undefined2 *)(*(int *)(param_1 + 2) + (uint)uVar7 * 2) = 0;
              if (sVar1 == 0x5c) break;
              uVar7 = uVar7 - 1;
            } while (uVar2 <= uVar7);
            if (uVar2 <= uVar7) goto LAB_6b8682ba;
          }
        }
        uVar7 = uVar7 + 1;
      }
LAB_6b8682ba:
      uVar8 = uVar8 + 1;
    }
    else {
      while (((uVar8 < uVar6 &&
              (sVar1 = *(short *)(*(int *)(param_1 + 2) + (uint)uVar8 * 2), sVar1 != 0x5c)) &&
             (sVar1 != 0x2f))) {
        if (uVar8 != uVar7) {
          *(short *)(*(int *)(param_1 + 2) + (uint)uVar7 * 2) = sVar1;
        }
        uVar7 = uVar7 + 1;
        uVar8 = uVar8 + 1;
      }
      uVar8 = uVar8 - 1;
    }
LAB_6b868314:
    uVar8 = uVar8 + 1;
  } while( true );
}



int __fastcall FUN_6b868380(short *param_1,short *param_2,short *param_3,uint param_4)

{
  int iVar1;
  uint uVar2;
  int local_c;
  int local_8;
  
  local_c = 0;
  local_8 = 0;
  if (param_4 == 0) {
    return -0x3fffffdd;
  }
  iVar1 = FUN_6b81485c(param_1,&local_c);
  if ((iVar1 < 0) || (iVar1 = FUN_6b81485c(param_2,&local_8), iVar1 < 0)) goto LAB_6b868469;
  if (local_c == 0) {
    param_1 = param_2;
    if (local_8 == 0) {
      *param_3 = 0;
      return 0;
    }
LAB_6b8683ef:
    iVar1 = FUN_6b8147b5(param_3,param_4,(int)param_1);
  }
  else {
    if (local_8 == 0) goto LAB_6b8683ef;
    uVar2 = (uint)(param_1[local_c + -1] == 0x5c);
    if (*param_2 == 0x5c) {
      uVar2 = uVar2 + 1;
    }
    if (1 < uVar2) {
      param_2 = param_2 + 1;
      uVar2 = uVar2 - 1;
    }
    iVar1 = FUN_6b8147b5(param_3,param_4,(int)param_1);
    if ((iVar1 < 0) ||
       (((uVar2 == 0 && (iVar1 = FUN_6b83282b(param_3,param_4,(int)&DAT_6b88423c), iVar1 < 0)) ||
        (iVar1 = FUN_6b83282b(param_3,param_4,(int)param_2), iVar1 < 0)))) goto LAB_6b868469;
    iVar1 = 0;
  }
  if (-1 < iVar1) {
    return iVar1;
  }
LAB_6b868469:
  FUN_6b8671a2(1,"AslPathCombine",0x56c,"An RtlString API failed [%x]");
  return iVar1;
}



int __fastcall FUN_6b86848c(short *param_1,uint param_2,int param_3)

{
  undefined *puVar1;
  int iVar2;
  
  memset(param_1,0,param_2 * 2);
  puVar1 = FUN_6b817e77();
  iVar2 = FUN_6b8147b5(param_1,param_2,(int)puVar1);
  if (iVar2 < 0) {
    FUN_6b8671a2(1,"AslPathToSystemPathBuf",0x5a5,"Failed to get system root directory [%x]");
  }
  else {
    iVar2 = FUN_6b83282b(param_1,param_2,param_3);
    if (iVar2 < 0) {
      FUN_6b8671a2(1,"AslPathToSystemPathBuf",0x5b0,"Failed to cat string [%x]");
      iVar2 = -0x3ffffff3;
    }
  }
  return iVar2;
}



void __fastcall FUN_6b86850f(int *param_1)

{
  int local_8;
  
  if ((param_1 != (int *)0x0) && (local_8 = *param_1, local_8 != 0)) {
    if (local_8 != -1) {
      FUN_6b86979c(&local_8);
    }
    *param_1 = 0;
  }
  return;
}



uint __thiscall FUN_6b868538(void *this,wchar_t *param_1,uint **param_2)

{
  longlong lVar1;
  wchar_t *pwVar2;
  uint uVar3;
  int iVar4;
  uint *puVar5;
  uint uVar6;
  void *pvVar7;
  uint *puVar8;
  uint *puVar9;
  undefined4 *puVar10;
  int in_FS_OFFSET;
  undefined4 uVar11;
  char *pcVar12;
  undefined4 local_50;
  undefined4 uStack76;
  undefined4 uStack72;
  undefined4 uStack68;
  undefined4 local_40;
  undefined4 local_3c;
  uint local_38;
  int local_34;
  undefined local_30 [4];
  undefined local_2c [4];
  int local_28;
  short *local_24;
  uint local_20;
  uint local_1c;
  uint *local_18;
  size_t local_14;
  size_t local_10;
  wchar_t *local_c;
  ushort local_8 [2];
  
  if (this == (void *)0x0) {
    return 0xc00000ef;
  }
  if ((param_1 == (wchar_t *)0x0) || (*param_1 == L'\0')) {
    return 0xc00000f1;
  }
  if (param_2 == (uint **)0x0) {
    return 0xc00000f2;
  }
  local_18 = (uint *)0x0;
  local_8[0] = 0;
  local_50 = 0;
  local_38 = 0;
  uStack76 = 0;
  local_34 = 0;
  local_c = (wchar_t *)0x0;
  local_40 = 0;
  uStack72 = 0;
  local_3c = 0;
  *param_2 = (uint *)0x0;
  uStack68 = 0;
  *(undefined2 *)this = 0;
  local_24 = (short *)this;
  uVar3 = RtlDosPathNameToNtPathName_U_WithStatus(param_1,&local_38,0,0);
  if ((int)uVar3 < 0) {
    pcVar12 = "Failed to convert dos path to nt path [%x]";
    uVar11 = 0x8a6;
  }
  else {
    uVar3 = FUN_6b8680a3((ushort *)&local_38);
    if ((int)uVar3 < 0) {
      pcVar12 = "AslPathCleanUstr failed [%x]";
      uVar11 = 0x8b1;
    }
    else {
      uVar3 = FUN_6b869be0((ushort)local_38,4,local_8);
      if ((int)uVar3 < 0) {
        pcVar12 = "RtlUShortAdd failed [%x]";
        uVar11 = 0x8b7;
      }
      else {
        uVar3 = (uint)local_8[0];
        local_c = (wchar_t *)
                  RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,uVar3);
        if (local_c == (wchar_t *)0x0) {
LAB_6b868634:
          uVar3 = 0xc0000017;
          goto LAB_6b8689b7;
        }
        uVar3 = FUN_6b869b50(local_c,uVar3,local_34,local_38 & 0xffff);
        pwVar2 = local_c;
        if ((int)uVar3 < 0) {
          pcVar12 = "RtlStringCbCopyNW failed [%x]";
          uVar11 = 0x8c3;
          goto LAB_6b8685c1;
        }
        iVar4 = FUN_6b869888(local_c);
        if (iVar4 == 0) {
          uVar3 = 0xc0000039;
          FUN_6b8671a2(1,"AslPathWildcardFindFirst",0x8d5,"Failed to split the wildcard path");
          goto LAB_6b8689b7;
        }
        if (iVar4 == 1) {
          *param_2 = (uint *)0xffffffff;
          iVar4 = FUN_6b8672cf(local_34);
          if (iVar4 == 0) {
            uVar3 = 0x80000006;
          }
          else {
            uVar3 = FUN_6b8147b5(local_24,0x104,(int)param_1);
            if ((int)uVar3 < 0) {
              FUN_6b8671a2(1,"AslPathWildcardFindFirst",0x8e7,"RtlStringCbCopyNW failed [%x]");
            }
            else {
              uVar3 = 0;
            }
          }
          goto LAB_6b8689b7;
        }
        puVar5 = (uint *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                         0x20);
        local_18 = puVar5;
        if (puVar5 == (uint *)0x0) goto LAB_6b868634;
        iVar4 = wcsncmp(param_1,L"\\??\\",4);
        puVar9 = puVar5 + 2;
        *puVar5 = (uint)(iVar4 != 0);
        puVar5[1] = (uint)pwVar2;
        local_c = (wchar_t *)0x0;
        uVar3 = 0xc0000095;
        puVar8 = puVar9;
        for (iVar4 = 6; iVar4 != 0; iVar4 = iVar4 + -1) {
          *puVar8 = 0;
          puVar8 = puVar8 + 1;
        }
        uVar6 = *(uint *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18);
        puVar5[4] = 0;
        puVar5[5] = 0;
        puVar5[7] = 0;
        *puVar9 = uVar6;
        puVar5[6] = 0x10;
        puVar5[3] = 0x10;
        local_1c = 8;
        if (puVar5[5] < 8) {
          uVar6 = FUN_6b8141f4(8,0xf,&local_1c);
          if ((int)uVar6 < 0) goto LAB_6b86876e;
          uVar6 = local_1c & 0xfffffff0;
          iVar4 = FUN_6b850b02(local_2c,(int)((ulonglong)puVar5[5] * (ulonglong)puVar5[3]),
                               (int)((ulonglong)puVar5[5] * (ulonglong)puVar5[3] >> 0x20));
          if ((-1 < iVar4) &&
             (lVar1 = (ulonglong)puVar5[3] * (ulonglong)uVar6,
             iVar4 = FUN_6b850b02(&local_10,(int)lVar1,(int)((ulonglong)lVar1 >> 0x20)), -1 < iVar4)
             ) {
            if (puVar5[7] == 0) {
              pvVar7 = (void *)RtlAllocateHeap(*puVar9,0,local_10);
              if (pvVar7 != (void *)0x0) {
                memset(pvVar7,0,local_10);
                goto LAB_6b86883a;
              }
            }
            else {
              pvVar7 = (void *)RtlReAllocateHeap(*puVar9,0,puVar5[7],local_10);
LAB_6b86883a:
              if (pvVar7 != (void *)0x0) {
                puVar5[7] = (uint)pvVar7;
                uVar3 = 0;
                puVar5[5] = uVar6;
                goto LAB_6b86884d;
              }
            }
            uVar3 = 0xc0000017;
          }
LAB_6b86884d:
          if (uVar3 != 0) goto LAB_6b86876e;
LAB_6b8687ac:
          if ((int)uVar3 < 0) {
            pcVar12 = "AslpPathWildcardInitStack failed [%x]";
            uVar11 = 0x90d;
            goto LAB_6b8685c1;
          }
        }
        else {
          uVar3 = 0xc000000d;
LAB_6b86876e:
          if (puVar5[7] != 0) {
            RtlFreeHeap(*puVar9,0,puVar5[7]);
          }
          for (iVar4 = 6; iVar4 != 0; iVar4 = iVar4 + -1) {
            *puVar9 = 0;
            puVar9 = puVar9 + 1;
          }
          if ((int)uVar3 < 0) {
            FUN_6b8671a2(1,"AslpPathWildcardInitStack",0x844,"RtlArrayInitialize failed [%x]");
            goto LAB_6b8687ac;
          }
        }
        puVar5 = local_18;
        RtlInitUnicodeString(&local_40,local_18[1]);
        uVar3 = FUN_6b8695db(&local_50,(ushort *)&local_40,(short *)puVar5[1],1,(short *)0x0,0);
        if ((int)uVar3 < 0) {
          pcVar12 = "AslpPathWildcardAllocMatchNode failed to create root of path [%x]";
          uVar11 = 0x91a;
          goto LAB_6b8685c1;
        }
        local_1c = puVar5[4];
        if (local_1c < puVar5[5]) {
LAB_6b868953:
          iVar4 = FUN_6b850b02(&local_28,(int)((ulonglong)puVar5[3] * (ulonglong)local_1c),
                               (int)((ulonglong)puVar5[3] * (ulonglong)local_1c >> 0x20));
          if ((iVar4 < 0) ||
             (puVar10 = (undefined4 *)(local_28 + puVar5[7]), puVar10 < (undefined4 *)puVar5[7])) {
LAB_6b868980:
            uVar3 = 0xc0000095;
          }
          else {
            *puVar10 = local_50;
            puVar10[1] = uStack76;
            puVar10[2] = uStack72;
            puVar10[3] = uStack68;
            puVar5[4] = puVar5[4] + 1;
            uVar3 = 0;
          }
        }
        else {
          local_20 = local_1c + 1;
          if (local_20 < puVar5[5] || local_20 == puVar5[5]) {
            uVar3 = 0xc000000d;
          }
          else {
            uVar3 = puVar5[6];
            uVar6 = FUN_6b8141f4(local_20,uVar3 - 1,&local_20);
            if ((int)uVar6 < 0) goto LAB_6b868980;
            uVar6 = ~(uVar3 - 1) & local_20;
            iVar4 = FUN_6b850b02(local_30,(int)((ulonglong)puVar5[5] * (ulonglong)puVar5[3]),
                                 (int)((ulonglong)puVar5[5] * (ulonglong)puVar5[3] >> 0x20));
            if ((iVar4 < 0) ||
               (lVar1 = (ulonglong)puVar5[3] * (ulonglong)uVar6,
               iVar4 = FUN_6b850b02(&local_14,(int)lVar1,(int)((ulonglong)lVar1 >> 0x20)), iVar4 < 0
               )) {
              uVar3 = 0xc0000095;
            }
            else {
              if (puVar5[7] == 0) {
                pvVar7 = (void *)RtlAllocateHeap(puVar5[2],0,local_14);
                if (pvVar7 != (void *)0x0) {
                  memset(pvVar7,0,local_14);
                  goto LAB_6b86893c;
                }
              }
              else {
                pvVar7 = (void *)RtlReAllocateHeap(puVar5[2],0,puVar5[7],local_14);
LAB_6b86893c:
                if (pvVar7 != (void *)0x0) {
                  puVar5[7] = (uint)pvVar7;
                  uVar3 = 0;
                  puVar5[5] = uVar6;
                  goto LAB_6b86894f;
                }
              }
              uVar3 = 0xc0000017;
            }
LAB_6b86894f:
            if (uVar3 == 0) goto LAB_6b868953;
          }
        }
        if (-1 < (int)uVar3) {
          local_50 = 0;
          uStack76 = 0;
          uStack72 = 0;
          uStack68 = 0;
          *param_2 = puVar5;
          uVar3 = FUN_6b868a01(local_24,0x104,(int *)puVar5);
          goto LAB_6b8689b7;
        }
        pcVar12 = "AslpPathWildcardPushNode failed [%x]";
        uVar11 = 0x920;
      }
    }
  }
LAB_6b8685c1:
  FUN_6b8671a2(1,"AslPathWildcardFindFirst",uVar11,pcVar12);
LAB_6b8689b7:
  RtlFreeUnicodeString(&local_38);
  if (local_c != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_c);
  }
  if ((int)uVar3 < 0) {
    FUN_6b86979c((int *)&local_18);
    FUN_6b86984a((int)&local_50);
    *param_2 = (uint *)0x0;
  }
  return uVar3;
}



// WARNING: Could not reconcile some variable overlaps

void __fastcall FUN_6b868a01(short *param_1,undefined4 param_2,int *param_3)

{
  longlong lVar1;
  short sVar2;
  ushort uVar3;
  int iVar4;
  uint uVar5;
  void *pvVar6;
  int iVar7;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  size_t sVar8;
  ushort *puVar9;
  uint uVar10;
  uint *puVar11;
  undefined4 *puVar12;
  int in_FS_OFFSET;
  undefined8 uVar13;
  char *pcVar14;
  undefined4 uVar15;
  char *pcVar16;
  undefined4 local_a0;
  undefined4 uStack156;
  undefined4 uStack152;
  undefined4 uStack148;
  undefined local_90 [4];
  undefined2 *local_8c;
  undefined local_88 [4];
  undefined local_84 [4];
  undefined local_80 [4];
  undefined4 local_7c;
  undefined4 local_78;
  short *local_74;
  int local_70;
  int local_6c;
  int local_68;
  int local_64;
  int local_60;
  int local_5c;
  int local_58;
  int local_54;
  size_t local_50;
  size_t local_4c;
  size_t local_48;
  uint local_44;
  void *local_40;
  void *local_3c;
  uint local_38;
  void *local_34;
  ushort local_30 [2];
  int local_2c;
  uint local_28;
  undefined2 *local_24;
  undefined2 *local_20;
  undefined2 *local_1c;
  uint local_18;
  undefined4 local_14;
  undefined2 local_10 [2];
  uint local_c;
  
  uVar13 = CONCAT44(param_2,local_2c);
  local_c = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_74 = param_1;
  if (((param_3 != (int *)0xffffffff) &&
      (uVar13 = CONCAT44(param_2,local_2c), param_1 != (short *)0x0)) &&
     (uVar13 = CONCAT44(param_2,local_2c), param_3 != (int *)0x0)) {
    local_7c = 0;
    local_78 = 0;
    local_44 = 0;
    local_40 = (void *)0x0;
    local_a0 = 0;
    uStack156 = 0;
    uStack152 = 0;
    uStack148 = 0;
    local_30[0] = 0;
    puVar11 = &local_28;
    for (iVar7 = 7; iVar7 != 0; iVar7 = iVar7 + -1) {
      *puVar11 = 0;
      puVar11 = puVar11 + 1;
    }
    uVar13 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,0x268);
    iVar7 = (int)uVar13;
    if (iVar7 != 0) {
      uVar10 = param_3[4];
      local_2c = iVar7;
      if (uVar10 != 0) {
LAB_6b868aad:
        puVar9 = (ushort *)0x0;
        if ((uVar10 - 1 < uVar10) &&
           ((lVar1 = (ulonglong)(uint)param_3[3] * (ulonglong)(uVar10 - 1),
            iVar4 = FUN_6b850b02(&local_54,(int)lVar1,(int)((ulonglong)lVar1 >> 0x20)), iVar4 < 0 ||
            (puVar9 = (ushort *)(local_54 + param_3[7]), puVar9 < (ushort *)param_3[7])))) {
          puVar9 = (ushort *)0x0;
        }
        if (puVar9 == (ushort *)0x0) {
          FUN_6b8671a2(1,"AslpPathWildcardPeekNode",0x7ff,"RtlArrayGet failed to get the next node")
          ;
          pcVar16 = "AslpPathWildcardPeekNode failed [%x]";
          uVar15 = 0x9a2;
LAB_6b8693a5:
          FUN_6b8671a2(1,"AslPathWildcardFindNext",uVar15,pcVar16);
          goto LAB_6b868cc9;
        }
        if (*(int *)(puVar9 + 6) == 0) {
          FUN_6b8671a2(1,"AslPathWildcardFindNext",0x9a7,"Node on the stack with invalid handle.");
          uVar10 = param_3[4];
          if (uVar10 == 0) {
LAB_6b868b5b:
            pcVar16 = "AslpPathWildcardPeekNode failed [%x]";
            uVar15 = 0x81a;
            pcVar14 = "AslpPathWildcardPopNode";
            goto LAB_6b8690a5;
          }
          uVar5 = 0;
          if ((uVar10 - 1 < uVar10) &&
             ((lVar1 = (ulonglong)(uint)param_3[3] * (ulonglong)(uVar10 - 1),
              iVar4 = FUN_6b850b02(&local_58,(int)lVar1,(int)((ulonglong)lVar1 >> 0x20)), iVar4 < 0
              || (uVar5 = local_58 + param_3[7], uVar5 < (uint)param_3[7])))) {
            uVar5 = 0;
          }
          if (uVar5 == 0) {
LAB_6b868b3d:
            FUN_6b8671a2(1,"AslpPathWildcardPeekNode",0x7ff,
                         "RtlArrayGet failed to get the next node");
            goto LAB_6b868b5b;
          }
          FUN_6b86984a(uVar5);
          uVar10 = param_3[4] - 1;
          if (uVar10 < (uint)param_3[4]) {
            uVar5 = param_3[3];
            iVar4 = FUN_6b850b02(&local_5c,(int)((ulonglong)uVar5 * (ulonglong)uVar10),
                                 (int)((ulonglong)uVar5 * (ulonglong)uVar10 >> 0x20));
            iVar7 = local_2c;
            if ((-1 < iVar4) &&
               (local_34 = (void *)(local_5c + param_3[7]), (void *)param_3[7] <= local_34)) {
              pvVar6 = (void *)((param_3[4] - uVar10) - 1);
              local_3c = pvVar6;
              if (pvVar6 != (void *)0x0) {
                iVar4 = FUN_6b850b02(&local_3c,(int)(ZEXT48(pvVar6) * (ulonglong)uVar5),
                                     (int)(ZEXT48(pvVar6) * (ulonglong)uVar5 >> 0x20));
                iVar7 = local_2c;
                if (((iVar4 < 0) ||
                    (iVar4 = FUN_6b850b02(&local_60,
                                          (int)((ulonglong)(uint)param_3[4] * (ulonglong)uVar5),
                                          (int)((ulonglong)(uint)param_3[4] * (ulonglong)uVar5 >>
                                               0x20)), pvVar6 = local_3c, iVar7 = local_2c,
                    iVar4 < 0)) || ((void *)(local_60 + param_3[7]) < (void *)param_3[7]))
                goto LAB_6b868cb6;
                memmove(local_34,(void *)(local_60 + param_3[7]),(size_t)local_3c);
                uVar5 = param_3[3];
              }
              memset((void *)((int)local_34 + (int)pvVar6),0,uVar5);
              param_3[4] = param_3[4] + -1;
              iVar7 = local_2c;
              if (((0x10 < (uint)param_3[4]) && (uVar10 = param_3[5], 0x3ff < uVar10 * param_3[3]))
                 && ((uint)param_3[4] < uVar10 >> 2)) {
                uVar5 = uVar10 >> 1;
                iVar4 = FUN_6b850b02(local_80,(int)((ulonglong)uVar10 * (ulonglong)(uint)param_3[3])
                                     ,(int)((ulonglong)uVar10 * (ulonglong)(uint)param_3[3] >> 0x20)
                                    );
                iVar7 = local_2c;
                if ((-1 < iVar4) &&
                   (iVar4 = FUN_6b850b02(&local_48,
                                         (int)((ulonglong)(uint)param_3[3] * (ulonglong)uVar5),
                                         (int)((ulonglong)(uint)param_3[3] * (ulonglong)uVar5 >>
                                              0x20)), iVar7 = local_2c, -1 < iVar4)) {
                  sVar8 = local_48;
                  if (param_3[7] == 0) {
                    pvVar6 = (void *)RtlAllocateHeap(param_3[2],0,local_48);
                    sVar8 = local_48;
joined_r0x6b868f02:
                    iVar7 = local_2c;
                    if (pvVar6 == (void *)0x0) goto LAB_6b868cb6;
                    memset(pvVar6,0,sVar8);
                  }
                  else {
LAB_6b868c99:
                    pvVar6 = (void *)RtlReAllocateHeap(param_3[2],0,param_3[7],sVar8);
                  }
                  iVar7 = local_2c;
                  if (pvVar6 != (void *)0x0) {
                    param_3[7] = (int)pvVar6;
                    param_3[5] = uVar5;
                  }
                }
              }
            }
          }
        }
        else {
          RtlInitUnicodeString(&local_44,*(undefined4 *)(puVar9 + 4));
          iVar4 = ZwQueryDirectoryFile
                            (*(undefined4 *)(puVar9 + 6),0,0,0,&local_7c,iVar7,0x268,3,1,&local_44,0
                            );
          if (iVar4 < 0) {
            if ((iVar4 != -0x7ffffffa) && (iVar4 != -0x3ffffff1)) {
              FUN_6b8671a2(1,"AslPathWildcardFindNext",0x9bf,
                           "NtQueryDirectoryFile failed to query next file [%x]");
              FUN_6b8671a2(2,"AslPathWildcardFindNext",0x9c0,"FilePath: \'%ws\'  Pattern: \'%ws\'");
            }
            uVar10 = param_3[4];
            if (uVar10 == 0) goto LAB_6b868b5b;
            uVar5 = 0;
            if ((uVar10 - 1 < uVar10) &&
               ((lVar1 = (ulonglong)(uint)param_3[3] * (ulonglong)(uVar10 - 1),
                iVar4 = FUN_6b850b02(&local_64,(int)lVar1,(int)((ulonglong)lVar1 >> 0x20)),
                iVar4 < 0 || (uVar5 = local_64 + param_3[7], uVar5 < (uint)param_3[7])))) {
              uVar5 = 0;
            }
            if (uVar5 == 0) goto LAB_6b868b3d;
            FUN_6b86984a(uVar5);
            uVar10 = param_3[4] - 1;
            if (uVar10 < (uint)param_3[4]) {
              uVar5 = param_3[3];
              iVar4 = FUN_6b850b02(&local_68,(int)((ulonglong)uVar5 * (ulonglong)uVar10),
                                   (int)((ulonglong)uVar5 * (ulonglong)uVar10 >> 0x20));
              iVar7 = local_2c;
              if ((-1 < iVar4) &&
                 (local_3c = (void *)(local_68 + param_3[7]), (void *)param_3[7] <= local_3c)) {
                pvVar6 = (void *)((param_3[4] - uVar10) - 1);
                local_34 = pvVar6;
                if (pvVar6 != (void *)0x0) {
                  iVar4 = FUN_6b850b02(&local_34,(int)(ZEXT48(pvVar6) * (ulonglong)uVar5),
                                       (int)(ZEXT48(pvVar6) * (ulonglong)uVar5 >> 0x20));
                  iVar7 = local_2c;
                  if (((iVar4 < 0) ||
                      (iVar4 = FUN_6b850b02(&local_6c,
                                            (int)((ulonglong)(uint)param_3[4] * (ulonglong)uVar5),
                                            (int)((ulonglong)(uint)param_3[4] * (ulonglong)uVar5 >>
                                                 0x20)), pvVar6 = local_34, iVar7 = local_2c,
                      iVar4 < 0)) || ((void *)(local_6c + param_3[7]) < (void *)param_3[7]))
                  goto LAB_6b868cb6;
                  memmove(local_3c,(void *)(local_6c + param_3[7]),(size_t)local_34);
                  uVar5 = param_3[3];
                }
                memset((void *)((int)local_3c + (int)pvVar6),0,uVar5);
                param_3[4] = param_3[4] + -1;
                iVar7 = local_2c;
                if (((0x10 < (uint)param_3[4]) && (uVar10 = param_3[5], 0x3ff < param_3[3] * uVar10)
                    ) && ((uint)param_3[4] < uVar10 >> 2)) {
                  uVar5 = uVar10 >> 1;
                  iVar4 = FUN_6b850b02(local_84,(int)((ulonglong)uVar10 *
                                                     (ulonglong)(uint)param_3[3]),
                                       (int)((ulonglong)uVar10 * (ulonglong)(uint)param_3[3] >> 0x20
                                            ));
                  iVar7 = local_2c;
                  if ((-1 < iVar4) &&
                     (iVar4 = FUN_6b850b02(&local_4c,
                                           (int)((ulonglong)(uint)param_3[3] * (ulonglong)uVar5),
                                           (int)((ulonglong)(uint)param_3[3] * (ulonglong)uVar5 >>
                                                0x20)), iVar7 = local_2c, -1 < iVar4)) {
                    sVar8 = local_4c;
                    if (param_3[7] != 0) goto LAB_6b868c99;
                    pvVar6 = (void *)RtlAllocateHeap(param_3[2],0,local_4c);
                    sVar8 = local_4c;
                    goto joined_r0x6b868f02;
                  }
                }
              }
            }
            goto LAB_6b868cb6;
          }
          if (*(int *)(iVar7 + 0x3c) == 4) {
            if (*(short *)(iVar7 + 0x5e) == 0x2e) {
              if (*(short *)(iVar7 + 0x60) == 0x2e) goto LAB_6b868cb6;
              goto LAB_6b868f2b;
            }
          }
          else {
LAB_6b868f2b:
            if ((*(int *)(iVar7 + 0x3c) == 2) && (*(short *)(iVar7 + 0x5e) == 0x2e))
            goto LAB_6b868cb6;
          }
          uVar10 = FUN_6b8695db(&local_a0,puVar9,*(short **)(puVar9 + 4),
                                *(uint *)(iVar7 + 0x38) >> 4 & 1,(short *)(iVar7 + 0x5e),
                                *(ushort *)(iVar7 + 0x3c));
          if (uVar10 != 0xc0000273) {
            if ((uVar10 == 0xc0000103) || (uVar10 == 0xc00000ba)) goto LAB_6b868cb6;
            if ((int)uVar10 < 0) {
              pcVar16 = "AslpPathWildcardAllocMatchNode failed [%x]";
              uVar15 = 0x9f9;
              goto LAB_6b8690a0;
            }
            local_34 = (void *)param_3[4];
            if (local_34 < (void *)param_3[5]) {
LAB_6b869048:
              iVar7 = FUN_6b850b02(&local_70,(int)((ulonglong)(uint)param_3[3] * ZEXT48(local_34)),
                                   (int)((ulonglong)(uint)param_3[3] * ZEXT48(local_34) >> 0x20));
              if ((iVar7 < 0) ||
                 (puVar12 = (undefined4 *)(local_70 + param_3[7]),
                 puVar12 < (undefined4 *)param_3[7])) {
LAB_6b869078:
                iVar4 = -0x3fffff6b;
              }
              else {
                *puVar12 = local_a0;
                puVar12[1] = uStack156;
                puVar12[2] = uStack152;
                puVar12[3] = uStack148;
                param_3[4] = param_3[4] + 1;
                iVar4 = 0;
              }
            }
            else {
              local_38 = (int)local_34 + 1;
              if (local_38 < (uint)param_3[5] || local_38 == param_3[5]) {
                iVar4 = -0x3ffffff3;
              }
              else {
                iVar7 = param_3[6];
                uVar10 = FUN_6b8141f4(local_38,iVar7 - 1U,&local_38);
                if ((int)uVar10 < 0) goto LAB_6b869078;
                uVar10 = ~(iVar7 - 1U) & local_38;
                iVar7 = FUN_6b850b02(local_88,(int)((ulonglong)(uint)param_3[5] *
                                                   (ulonglong)(uint)param_3[3]),
                                     (int)((ulonglong)(uint)param_3[5] * (ulonglong)(uint)param_3[3]
                                          >> 0x20));
                if ((iVar7 < 0) ||
                   (lVar1 = (ulonglong)(uint)param_3[3] * (ulonglong)uVar10,
                   iVar7 = FUN_6b850b02(&local_50,(int)lVar1,(int)((ulonglong)lVar1 >> 0x20)),
                   iVar7 < 0)) {
                  iVar4 = -0x3fffff6b;
                }
                else {
                  if (param_3[7] == 0) {
                    pvVar6 = (void *)RtlAllocateHeap(param_3[2],0,local_50);
                    if (pvVar6 != (void *)0x0) {
                      memset(pvVar6,0,local_50);
                      goto LAB_6b869031;
                    }
                  }
                  else {
                    pvVar6 = (void *)RtlReAllocateHeap(param_3[2],0,param_3[7],local_50);
LAB_6b869031:
                    if (pvVar6 != (void *)0x0) {
                      param_3[7] = (int)pvVar6;
                      iVar4 = 0;
                      param_3[5] = uVar10;
                      goto LAB_6b869044;
                    }
                  }
                  iVar4 = -0x3fffffe9;
                }
LAB_6b869044:
                if (iVar4 == 0) goto LAB_6b869048;
              }
            }
            iVar7 = local_2c;
            if (-1 < iVar4) goto LAB_6b868cb6;
            pcVar16 = "AslpPathWildcardPushNode failed [%x]";
            uVar15 = 0x9f1;
            goto LAB_6b8693a5;
          }
          uVar10 = FUN_6b869be0(*puVar9,*(short *)(iVar7 + 0x3c),local_30);
          if ((-1 < (int)uVar10) &&
             (uVar10 = FUN_6b869be0(local_30[0],2,local_30), -1 < (int)uVar10)) {
            local_24 = local_10;
            local_10[0] = 0;
            uVar10 = local_30[0] + 2;
            local_18 = 2;
            local_14 = 2;
            local_28 = 0x20000;
            local_20 = local_24;
            local_1c = local_24;
            if ((0xfffe < uVar10) ||
               ((2 < uVar10 && (iVar7 = RtlpEnsureBufferSize(0,&local_20,uVar10), iVar7 < 0)))) {
              pcVar16 = "RtlEnsureUnicodeStringBufferSizeBytes failed [%x]";
              uVar15 = 0xa2e;
              goto LAB_6b8693a5;
            }
            local_28._0_2_ = 0;
            local_28 = local_18 << 0x10;
            uVar10 = *puVar9 + 2;
            local_24 = local_20;
            if (0xfffe < uVar10) {
LAB_6b869197:
              pcVar16 = "RtlAssignUnicodeStringBuffer failed [%x]";
              uVar15 = 0xa38;
              goto LAB_6b8693a5;
            }
            if (local_18 < uVar10) {
              iVar7 = RtlpEnsureBufferSize(0,&local_20,uVar10);
              if (iVar7 < 0) goto LAB_6b869197;
            }
            local_24 = local_20;
            memmove(local_20 + ((ushort)local_28 >> 1),*(void **)(puVar9 + 2),(uint)*puVar9);
            sVar2 = *puVar9 + (ushort)local_28;
            local_28._0_2_ = (ushort)local_28 + *puVar9;
            local_28 = CONCAT22(sVar2 + 2,(ushort)local_28);
            local_24[(ushort)local_28 >> 1] = 0;
            if (*(short *)(*(int *)(puVar9 + 2) + -2 + (uint)(*puVar9 >> 1) * 2) != 0x5c) {
              uVar10 = (ushort)local_28 + 4;
              if (0xfffe < uVar10) {
LAB_6b869235:
                pcVar16 = "RtlAppendUnicodeStringBuffer failed [%x]";
                uVar15 = 0xa3f;
                goto LAB_6b8693a5;
              }
              if (local_18 < uVar10) {
                iVar7 = RtlpEnsureBufferSize(0,&local_20,uVar10);
                if (iVar7 < 0) goto LAB_6b869235;
              }
              local_24 = local_20;
              local_20[(ushort)local_28 >> 1] = 0x5c;
              uVar3 = (short)local_28 + 2;
              local_28 = CONCAT22((short)local_28 + 4,uVar3);
              local_20[uVar3 >> 1] = 0;
            }
            local_40 = (void *)(local_2c + 0x5e);
            sVar8 = (size_t)*(ushort *)(local_2c + 0x3c);
            local_44 = CONCAT22(*(undefined2 *)(local_2c + 0x3c),*(ushort *)(local_2c + 0x3c));
            uVar10 = (local_28 & 0xffff) + 2 + sVar8;
            if (uVar10 < 0xffff) {
              if (local_18 < uVar10) {
                iVar7 = RtlpEnsureBufferSize(0,&local_20,uVar10);
                if (iVar7 < 0) goto LAB_6b8692d1;
                sVar8 = local_44 & 0xffff;
              }
              local_24 = local_20;
              memmove(local_20 + ((ushort)local_28 >> 1),local_40,sVar8);
              uVar10 = local_28 + local_44;
              local_28 = uVar10 & 0xffff | (uint)(ushort)((short)uVar10 + 2) << 0x10;
              *(undefined2 *)((int)local_24 + (uVar10 & 0xfffe)) = 0;
              if ((*param_3 != 0) &&
                 (iVar7 = RtlNtPathNameToDosPathName(0,&local_28,0,0), iVar7 < 0)) {
                pcVar16 = "RtlNtPathNameToDosPathName failed [%x]";
                uVar15 = 0xa59;
                goto LAB_6b8693a5;
              }
              iVar7 = FUN_6b869b50(local_74,0x208,(int)local_24,local_28 & 0xffff);
              if (-1 < iVar7) goto LAB_6b868cc9;
              pcVar16 = "RtlStringCbCopyNW failed [%x]";
              uVar15 = 0xa64;
            }
            else {
LAB_6b8692d1:
              pcVar16 = "RtlAppendUnicodeStringBuffer failed [%x]";
              uVar15 = 0xa4e;
            }
            goto LAB_6b8693a5;
          }
          pcVar16 = "Failed to compute the path length [%x]";
          uVar15 = 0xa25;
LAB_6b8690a0:
          pcVar14 = "AslPathWildcardFindNext";
LAB_6b8690a5:
          FUN_6b8671a2(1,pcVar14,uVar15,pcVar16);
        }
LAB_6b868cb6:
        uVar10 = param_3[4];
        if (uVar10 == 0) goto LAB_6b868cc9;
        goto LAB_6b868aad;
      }
LAB_6b868cc9:
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_2c);
      uVar13 = CONCAT44(extraout_EDX,local_2c);
    }
    local_2c = (int)uVar13;
    if ((local_20 != (undefined2 *)0x0) && (local_20 != local_1c)) {
      local_8c = local_20;
      RtlFreeUnicodeString(local_90);
      uVar13 = CONCAT44(extraout_EDX_00,local_2c);
    }
    if (local_1c != (undefined2 *)0x0) {
      *local_1c = 0;
    }
  }
  local_2c = (int)uVar13;
  FUN_6b8224af(local_c ^ (uint)&stack0xfffffffc,(int)((ulonglong)uVar13 >> 0x20));
  return;
}



void __fastcall FUN_6b8693b9(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int in_FS_OFFSET;
  
  if (param_1 != (undefined4 *)0x0) {
    puVar2 = (undefined4 *)*param_1;
    while (puVar2 != param_1) {
      if (puVar2[4] != 0) {
        ZwClose(puVar2[4]);
        puVar2[4] = 0;
      }
      puVar1 = (undefined4 *)*puVar2;
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar2);
      puVar2 = puVar1;
    }
    if (param_1[3] != 0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1[3]);
    }
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1);
  }
  return;
}



uint __fastcall FUN_6b869427(int *param_1,undefined4 *param_2,void *param_3)

{
  undefined4 uVar1;
  int **ppiVar2;
  uint uVar3;
  int in_FS_OFFSET;
  
  uVar1 = *(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18);
  *param_2 = 0;
  ppiVar2 = (int **)RtlAllocateHeap(uVar1,8,0x10);
  if (ppiVar2 == (int **)0x0) {
    uVar3 = 0xc0000017;
  }
  else {
    ppiVar2[2] = (int *)0x0;
    ppiVar2[3] = (int *)0x0;
    ppiVar2[1] = (int *)ppiVar2;
    *ppiVar2 = (int *)ppiVar2;
    uVar3 = FUN_6b81464d((short **)(ppiVar2 + 3),param_3);
    if ((-1 < (int)uVar3) && (uVar3 = FUN_6b86955e((short *)ppiVar2[3],ppiVar2), -1 < (int)uVar3)) {
      ppiVar2[2] = *ppiVar2;
      uVar3 = FUN_6b8694b3(param_1,(int *)ppiVar2);
      if (-1 < (int)uVar3) {
        *param_2 = ppiVar2;
        ppiVar2 = (int **)0x0;
      }
    }
    if (ppiVar2 != (int **)0x0) {
      FUN_6b8693b9(ppiVar2);
    }
  }
  return uVar3;
}



int __fastcall FUN_6b8694b3(int *param_1,int *param_2)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  
  piVar1 = (int *)param_2[2];
  if ((int *)param_2[2] == (int *)0x0) {
    iVar2 = -0x7fffffe6;
  }
  else {
    do {
      while( true ) {
        piVar3 = piVar1;
        if (piVar3 == param_2) {
          iVar2 = -0x7fffffe6;
          piVar3 = (int *)0x0;
          goto LAB_6b8694f3;
        }
        iVar2 = FUN_6b869a08((int)piVar3,(int)param_2);
        if (-1 < iVar2) break;
        piVar1 = (int *)piVar3[1];
      }
      piVar1 = (int *)*piVar3;
    } while ((int *)*piVar3 != param_2);
    *param_1 = piVar3[4];
LAB_6b8694f3:
    param_2[2] = (int)piVar3;
  }
  return iVar2;
}



undefined4 __fastcall FUN_6b869501(int param_1,int param_2,int **param_3)

{
  int *piVar1;
  code *pcVar2;
  int **ppiVar3;
  undefined4 uVar4;
  undefined4 extraout_ECX;
  int in_FS_OFFSET;
  undefined8 uVar5;
  
  ppiVar3 = (int **)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,0x18);
  if (ppiVar3 == (int **)0x0) {
    uVar4 = 0xc0000017;
  }
  else {
    uVar4 = 0;
    ppiVar3[1] = (int *)ppiVar3;
    *ppiVar3 = (int *)ppiVar3;
    ppiVar3[5] = (int *)0x0;
    ppiVar3[4] = (int *)0x0;
    ppiVar3[3] = (int *)param_2;
    ppiVar3[2] = (int *)param_1;
    piVar1 = *param_3;
    if ((int **)piVar1[1] != param_3) {
      pcVar2 = (code *)swi(0x29);
      uVar5 = (*pcVar2)();
      param_3 = (int **)((ulonglong)uVar5 >> 0x20);
      ppiVar3 = (int **)uVar5;
      uVar4 = extraout_ECX;
    }
    *ppiVar3 = piVar1;
    ppiVar3[1] = (int *)param_3;
    piVar1[1] = (int)ppiVar3;
    *param_3 = (int *)ppiVar3;
  }
  return uVar4;
}



void __fastcall FUN_6b86955e(short *param_1,int **param_2)

{
  short sVar1;
  short *psVar2;
  bool bVar3;
  short *psVar4;
  int iVar5;
  short *psVar6;
  short *psVar7;
  
  psVar7 = param_1;
  do {
    sVar1 = *psVar7;
    psVar7 = psVar7 + 1;
  } while (sVar1 != 0);
  bVar3 = false;
  psVar4 = param_1 + ((int)psVar7 - (int)(param_1 + 1) >> 1);
  psVar7 = param_1 + ((int)psVar7 - (int)(param_1 + 1) >> 1);
  while( true ) {
    do {
      while( true ) {
        psVar2 = psVar7;
        psVar6 = psVar4;
        psVar7 = psVar2 + -1;
        if (psVar7 <= param_1) {
          if (!bVar3) {
            psVar6 = psVar7;
          }
          FUN_6b869501(-(uint)bVar3 & (uint)psVar7,(int)psVar6,param_2);
          return;
        }
        sVar1 = *psVar7;
        psVar4 = psVar6;
        if ((sVar1 != 0x2a) && (sVar1 != 0x3f)) break;
        bVar3 = true;
      }
    } while ((sVar1 != 0x5c) || (psVar4 = psVar7, !bVar3));
    iVar5 = FUN_6b869501((int)psVar2,(int)psVar6,param_2);
    if (iVar5 < 0) break;
    *psVar7 = 0;
    bVar3 = false;
  }
  return;
}



uint __fastcall
FUN_6b8695db(undefined4 *param_1,ushort *param_2,short *param_3,int param_4,short *param_5,
            ushort param_6)

{
  int iVar1;
  uint uVar2;
  int in_FS_OFFSET;
  undefined4 uVar3;
  char *pcVar4;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 *local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined local_14 [8];
  ushort *local_c;
  ushort local_8 [2];
  
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  for (; param_1[2] = param_3, *param_3 != 0; param_3 = param_3 + 1) {
  }
  param_1[2] = param_3 + 1;
  local_c = param_2;
  if (param_3[1] == 0) {
    uVar2 = (-(uint)(param_4 != 0) & 0xfffffe47) + 0xc0000273;
  }
  else {
    if (param_4 == 0) {
      uVar2 = 0xc0000103;
      goto LAB_6b86978c;
    }
    local_8[0] = *param_2;
    uVar2 = FUN_6b869be0(local_8[0],param_6,local_8);
    if ((int)uVar2 < 0) {
      pcVar4 = "RtlUShortAdd failed [%x]";
      uVar3 = 0xb26;
    }
    else {
      uVar2 = FUN_6b869be0(local_8[0],4,local_8);
      if ((int)uVar2 < 0) {
        pcVar4 = "RtlUShortAdd failed [%x]";
        uVar3 = 0xb2c;
      }
      else {
        *(ushort *)((int)param_1 + 2) = local_8[0];
        *(undefined2 *)param_1 = 0;
        iVar1 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,local_8[0]);
        param_1[1] = iVar1;
        if (iVar1 == 0) {
          uVar2 = 0xc0000017;
          goto LAB_6b86978c;
        }
        uVar2 = FUN_6b869cd8((ushort *)param_1,local_c);
        if ((int)uVar2 < 0) {
          pcVar4 = "RtlUnicodeStringCopy failed [%x]";
          uVar3 = 0xb3b;
        }
        else if ((*(short *)(param_1[1] + -2 + (uint)(*(ushort *)param_1 >> 1) * 2) == 0x5c) ||
                (uVar2 = FUN_6b869c13((ushort *)param_1), -1 < (int)uVar2)) {
          if (((param_5 == (short *)0x0) || (param_6 == 0)) ||
             (uVar2 = FUN_6b869c6e((ushort *)param_1,param_5,(uint)param_6), -1 < (int)uVar2)) {
            local_2c = 0x18;
            local_28 = 0;
            local_1c = 0;
            local_18 = 0;
            local_20 = 0x40;
            local_24 = param_1;
            uVar2 = ZwOpenFile(param_1 + 3,0x100001,&local_2c,local_14,1,0x21);
            if (-1 < (int)uVar2) {
              return uVar2;
            }
            pcVar4 = "Failed to open dir [%x]";
            uVar3 = 0xb61;
          }
          else {
            pcVar4 = "RtlUnicodeStringCbCatStringN failed [%x]";
            uVar3 = 0xb53;
          }
        }
        else {
          pcVar4 = "RtlUnicodeStringCatString failed [%x]";
          uVar3 = 0xb4b;
        }
      }
    }
    FUN_6b8671a2(1,"AslpPathWildcardAllocMatchNode",uVar3,pcVar4);
  }
  if (-1 < (int)uVar2) {
    return uVar2;
  }
LAB_6b86978c:
  FUN_6b86984a((int)param_1);
  return uVar2;
}



void __fastcall FUN_6b86979c(int *param_1)

{
  int iVar1;
  longlong lVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  undefined4 *puVar7;
  int in_FS_OFFSET;
  int *local_8;
  
  if ((param_1 != (int *)0x0) && (iVar1 = *param_1, iVar1 != 0)) {
    uVar5 = *(uint *)(iVar1 + 0x10);
    uVar6 = 0;
    local_8 = param_1;
    if (uVar5 != 0) {
      do {
        uVar3 = 0;
        if ((uVar6 < uVar5) &&
           ((lVar2 = (ulonglong)*(uint *)(iVar1 + 0xc) * (ulonglong)uVar6,
            iVar4 = FUN_6b850b02(&local_8,(int)lVar2,(int)((ulonglong)lVar2 >> 0x20)), iVar4 < 0 ||
            (uVar3 = (int)local_8 + *(int *)(iVar1 + 0x1c), uVar3 < *(uint *)(iVar1 + 0x1c))))) {
          uVar3 = 0;
        }
        FUN_6b86984a(uVar3);
        uVar5 = *(uint *)(iVar1 + 0x10);
        uVar6 = uVar6 + 1;
      } while (uVar6 < uVar5);
    }
    if (*(int *)(iVar1 + 0x1c) != 0) {
      RtlFreeHeap(*(undefined4 *)(iVar1 + 8),0,*(undefined4 *)(iVar1 + 0x1c));
    }
    puVar7 = (undefined4 *)(iVar1 + 8);
    for (iVar4 = 6; iVar4 != 0; iVar4 = iVar4 + -1) {
      *puVar7 = 0;
      puVar7 = puVar7 + 1;
    }
    if (*(int *)(iVar1 + 4) != 0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,*(undefined4 *)(iVar1 + 4)
                 );
      *(undefined4 *)(iVar1 + 4) = 0;
    }
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iVar1);
    *param_1 = 0;
  }
  return;
}



void __fastcall FUN_6b86984a(int param_1)

{
  int in_FS_OFFSET;
  
  if (param_1 != 0) {
    if (*(int *)(param_1 + 0xc) != 0) {
      ZwClose(*(undefined4 *)(param_1 + 0xc));
      *(undefined4 *)(param_1 + 0xc) = 0;
    }
    if (*(int *)(param_1 + 4) != 0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,
                  *(undefined4 *)(param_1 + 4));
      *(undefined4 *)(param_1 + 4) = 0;
    }
    *(undefined4 *)(param_1 + 8) = 0;
  }
  return;
}



// WARNING: Could not reconcile some variable overlaps

int __fastcall FUN_6b869888(wchar_t *param_1)

{
  wchar_t wVar1;
  int iVar2;
  int iVar3;
  wchar_t *pwVar4;
  wchar_t wVar5;
  wchar_t *local_c;
  wchar_t *local_8;
  
  if (param_1 == (wchar_t *)0x0) {
    return 0;
  }
  if (*param_1 == L'\0') {
    return 0;
  }
  local_c = param_1;
  local_8 = param_1;
  RtlInitUnicodeString(&local_c,param_1);
  if (((ushort)local_c < 2) || (*local_8 == L'\0')) {
    FUN_6b8671a2(1,"AslpPathWildcardMakeLeaves",0xbbe,"AslpPathGetFormatInfo failed [%x]");
    return 0;
  }
  local_c._0_2_ = (ushort)local_c >> 1;
  if ((7 < (ushort)local_c) && (iVar2 = _wcsnicmp(local_8,L"\\??\\UNC\\",8), iVar2 == 0)) {
    iVar2 = -4;
    goto LAB_6b86996b;
  }
  if ((ushort)local_c < 4) {
LAB_6b869948:
    if (((ushort)local_c < 3) || (iVar2 = wcsncmp(local_8,(wchar_t *)&_Str2_6b88515c,2), iVar2 != 0)
       ) {
      iVar2 = 0;
      goto LAB_6b86996b;
    }
  }
  else {
    iVar2 = wcsncmp(local_8,L"\\??\\",4);
    if (iVar2 == 0) {
      iVar2 = -2;
      goto LAB_6b86996b;
    }
    iVar2 = wcsncmp(local_8,L"\\\\?\\",4);
    if ((iVar2 != 0) && (iVar2 = wcsncmp(local_8,L"\\\\.\\",4), iVar2 != 0)) goto LAB_6b869948;
  }
  iVar2 = -3;
LAB_6b86996b:
  wVar5 = *param_1;
  pwVar4 = param_1;
  while (wVar5 != L'\0') {
    if (wVar5 == L'\\') {
      if (-1 < iVar2) {
        *pwVar4 = L'\0';
      }
      iVar2 = iVar2 + 1;
    }
    pwVar4 = pwVar4 + 1;
    wVar5 = *pwVar4;
  }
  pwVar4[1] = L'\0';
  wVar5 = *param_1;
  wVar1 = wVar5;
  while (wVar1 != L'\0') {
    while (wVar5 != L'\0') {
      param_1 = param_1 + 1;
      wVar5 = *param_1;
    }
    pwVar4 = param_1 + 1;
    if ((*pwVar4 == L'\0') || (iVar3 = FUN_6b86a089(pwVar4), iVar3 != 0)) break;
    wVar5 = L'\\';
    *param_1 = L'\\';
    iVar2 = iVar2 + -1;
    wVar1 = *pwVar4;
  }
  if (iVar2 + 1 < 0) {
    return 0;
  }
  return iVar2 + 1;
}



int __fastcall FUN_6b869a08(int param_1,int param_2)

{
  int *piVar1;
  uint uVar2;
  short sVar3;
  undefined2 uVar4;
  undefined4 uVar5;
  int iVar6;
  short *psVar7;
  short *psVar8;
  int in_FS_OFFSET;
  uint local_c;
  short *local_8;
  
  local_c = 0;
  local_8 = (short *)0x0;
  if (*(int *)(param_1 + 4) == param_2) {
    piVar1 = (int *)(param_1 + 0x10);
    if (*piVar1 == 0) {
      iVar6 = FUN_6b8676b9(piVar1,*(short **)(param_1 + 0xc));
    }
    else {
      ZwClose(*piVar1);
      *piVar1 = 0;
      iVar6 = -0x7fffffe6;
    }
  }
  else {
    psVar8 = *(short **)(param_1 + 0xc);
    psVar7 = psVar8 + 1;
    do {
      sVar3 = *psVar8;
      psVar8 = psVar8 + 1;
    } while (sVar3 != 0);
    uVar2 = ((int)psVar8 - (int)psVar7 >> 1) * 2 + 0x20a;
    local_c = uVar2 * 0x10000;
    local_8 = (short *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                       uVar2 & 0xffff);
    uVar5 = *(undefined4 *)(*(int *)(param_1 + 4) + 0x10);
    do {
      do {
        *local_8 = 0;
        iVar6 = FUN_6b867627(local_8,uVar5,*(undefined4 *)(param_1 + 0x14));
        if (iVar6 < 0) {
          *(undefined4 *)(param_1 + 0x14) = 0;
          goto LAB_6b869b29;
        }
        *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
        uVar4 = **(undefined2 **)(param_1 + 0xc);
        **(undefined2 **)(param_1 + 0xc) = 0;
        iVar6 = FUN_6b86a0be(*(short **)(param_1 + 8),local_8);
        **(undefined2 **)(param_1 + 0xc) = uVar4;
      } while (iVar6 == 0);
      psVar7 = local_8;
      do {
        sVar3 = *psVar7;
        psVar7 = psVar7 + 1;
      } while (sVar3 != 0);
      local_c = local_c & 0xffff0000 |
                (uint)(ushort)((short)((int)psVar7 - (int)(local_8 + 1) >> 1) * 2);
      RtlAppendUnicodeToString(&local_c,*(undefined4 *)(param_1 + 0xc));
      piVar1 = (int *)(param_1 + 0x10);
      if (*piVar1 != 0) {
        ZwClose(*piVar1);
        *piVar1 = 0;
      }
      iVar6 = FUN_6b86781e(piVar1,uVar5,local_8);
    } while (iVar6 < 0);
  }
LAB_6b869b29:
  if (local_8 != (short *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_8);
  }
  return iVar6;
}



int __fastcall FUN_6b869b50(short *param_1,uint param_2,int param_3,uint param_4)

{
  int iVar1;
  uint uVar2;
  
  uVar2 = param_2 >> 1;
  iVar1 = (-(uint)(uVar2 != 0) & 0x3ffffff3) + 0xc000000d;
  if (uVar2 != 0) {
    if (param_4 >> 1 < 0x7fffffff) {
      iVar1 = FUN_6b869b92(param_1,uVar2,param_1,param_3,param_4 >> 1);
    }
    else {
      iVar1 = -0x3ffffff3;
      *param_1 = 0;
    }
  }
  return iVar1;
}



int __fastcall FUN_6b869b92(short *param_1,int param_2,undefined4 param_3,int param_4,int param_5)

{
  short sVar1;
  int iVar2;
  
  if (param_2 != 0) {
    iVar2 = param_4 - (int)param_1;
    do {
      if ((param_5 == 0) || (sVar1 = *(short *)(iVar2 + (int)param_1), sVar1 == 0)) break;
      *param_1 = sVar1;
      param_1 = param_1 + 1;
      param_5 = param_5 + -1;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
    if (param_2 != 0) goto LAB_6b869bc7;
  }
  param_1 = param_1 + -1;
LAB_6b869bc7:
  *param_1 = 0;
  return (-(uint)(param_2 != 0) & 0x7ffffffb) + 0x80000005;
}



uint __fastcall FUN_6b869be0(ushort param_1,short param_2,ushort *param_3)

{
  ushort uVar1;
  ushort uVar2;
  
  uVar1 = param_1 + param_2;
  uVar2 = uVar1;
  if (uVar1 < param_1) {
    uVar2 = 0xffff;
  }
  *param_3 = uVar2;
  return -(uint)(uVar1 < param_1) & 0xc0000095;
}



int __fastcall FUN_6b869c13(ushort *param_1)

{
  int iVar1;
  int local_14;
  uint local_10;
  uint local_c;
  int local_8;
  
  iVar1 = FUN_6b869d50(param_1,&local_14,&local_c,&local_10);
  if (-1 < iVar1) {
    local_8 = 0;
    iVar1 = FUN_6b869da4(local_14 + local_10 * 2,local_c - local_10,&local_8,&DAT_6b88423c,0x7fff);
    *param_1 = ((short)local_8 + (short)local_10) * 2;
  }
  return iVar1;
}



int __fastcall FUN_6b869c6e(ushort *param_1,short *param_2,uint param_3)

{
  int iVar1;
  int local_14;
  uint local_10;
  uint local_c;
  int local_8;
  
  iVar1 = FUN_6b869d50(param_1,&local_14,&local_c,&local_10);
  if (-1 < iVar1) {
    if (param_3 >> 1 < 0x8000) {
      local_8 = 0;
      iVar1 = FUN_6b869da4(local_14 + local_10 * 2,local_c - local_10,&local_8,param_2,param_3 >> 1)
      ;
      *param_1 = ((short)local_8 + (short)local_10) * 2;
    }
    else {
      iVar1 = -0x3ffffff3;
    }
  }
  return iVar1;
}



int __fastcall FUN_6b869cd8(ushort *param_1,ushort *param_2)

{
  int iVar1;
  undefined2 *puVar2;
  uint uVar3;
  int iVar4;
  int local_10;
  uint local_c;
  int local_8;
  
  iVar1 = FUN_6b869d50(param_1,&local_10,&local_c,(uint *)0x0);
  if (-1 < iVar1) {
    local_8 = 0;
    uVar3 = 0;
    iVar1 = FUN_6b853e38(param_2);
    if ((iVar1 < 0) || (param_2 == (ushort *)0x0)) {
      puVar2 = (undefined2 *)0x0;
    }
    else {
      puVar2 = *(undefined2 **)(param_2 + 2);
      uVar3 = (uint)(*param_2 >> 1);
    }
    iVar4 = 0;
    if (-1 < iVar1) {
      iVar1 = FUN_6b869dfb(local_10,local_c,&local_8,puVar2,uVar3);
      iVar4 = local_8;
    }
    *param_1 = (short)iVar4 * 2;
  }
  return iVar1;
}



int __fastcall FUN_6b869d50(ushort *param_1,undefined4 *param_2,uint *param_3,uint *param_4)

{
  int iVar1;
  
  *param_2 = 0;
  *param_3 = 0;
  if (param_4 != (uint *)0x0) {
    *param_4 = 0;
  }
  iVar1 = FUN_6b853e38(param_1);
  if ((-1 < iVar1) && (param_1 != (ushort *)0x0)) {
    *param_2 = *(undefined4 *)(param_1 + 2);
    *param_3 = (uint)(param_1[1] >> 1);
    if (param_4 != (uint *)0x0) {
      *param_4 = (uint)(*param_1 >> 1);
    }
  }
  return iVar1;
}



undefined4 __fastcall FUN_6b869da4(int param_1,int param_2,int *param_3,short *param_4,int param_5)

{
  int iVar1;
  undefined4 uVar2;
  int iVar3;
  
  iVar1 = 0;
  if (param_2 != 0) {
    iVar3 = param_1 - (int)param_4;
    do {
      if ((param_5 == 0) || (*param_4 == 0)) break;
      *(short *)(iVar3 + (int)param_4) = *param_4;
      param_4 = param_4 + 1;
      param_5 = param_5 + -1;
      iVar1 = iVar1 + 1;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
    uVar2 = 0;
    if (param_2 != 0) goto LAB_6b869ded;
  }
  uVar2 = 0;
  if ((param_5 != 0) && (*param_4 != 0)) {
    uVar2 = 0x80000005;
  }
LAB_6b869ded:
  *param_3 = iVar1;
  return uVar2;
}



undefined4 __fastcall
FUN_6b869dfb(int param_1,int param_2,int *param_3,undefined2 *param_4,int param_5)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  
  iVar2 = 0;
  if (param_2 != 0) {
    iVar1 = param_1 - (int)param_4;
    do {
      if (param_5 == 0) break;
      *(undefined2 *)(iVar1 + (int)param_4) = *param_4;
      param_4 = param_4 + 1;
      param_5 = param_5 + -1;
      iVar2 = iVar2 + 1;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
    uVar3 = 0;
    if (param_2 != 0) goto LAB_6b869e3e;
  }
  uVar3 = 0;
  if (param_5 != 0) {
    uVar3 = 0x80000005;
  }
LAB_6b869e3e:
  *param_3 = iVar2;
  return uVar3;
}



int __fastcall FUN_6b869e4b(wchar_t *param_1,undefined param_2,undefined4 param_3)

{
  int iVar1;
  
  iVar1 = FUN_6b832879(param_1,0x2b,L"{%08lx-%04hx-%04hx-%02hx%02hx-%02hx%02hx%02hx%02hx%02hx%02hx}"
                      );
  if (iVar1 < 0) {
    FUN_6b8671a2(1,"AslGuidToString",0x145,"RtlStringCchPrintfW failed [%x]");
  }
  else {
    iVar1 = 0;
  }
  return iVar1;
}



int __fastcall FUN_6b869ec3(undefined2 *param_1)

{
  wchar_t *pwVar1;
  int iVar2;
  int in_FS_OFFSET;
  
  *param_1 = 0x4c;
  iVar2 = *(int *)(in_FS_OFFSET + 0x30);
  param_1[1] = 0x4e;
  pwVar1 = (wchar_t *)RtlAllocateHeap(*(undefined4 *)(iVar2 + 0x18),8,0x4e);
  if (pwVar1 == (wchar_t *)0x0) {
    FUN_6b8671a2(1,"AslGuidToString_UStr",0xed,"Out of memory");
    iVar2 = -0x3fffffe9;
  }
  else {
    iVar2 = FUN_6b832879(pwVar1,(uint)((ushort)param_1[1] >> 1),
                         L"{%08lx-%04hx-%04hx-%02hx%02hx-%02hx%02hx%02hx%02hx%02hx%02hx}");
    if (iVar2 < 0) {
      FUN_6b8671a2(1,"AslGuidToString_UStr",0x101,"RtlStringCchPrintfW failed [%x]");
    }
    else {
      *(wchar_t **)(param_1 + 2) = pwVar1;
      pwVar1 = (wchar_t *)0x0;
      iVar2 = 0;
    }
    if (pwVar1 != (wchar_t *)0x0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pwVar1);
    }
  }
  return iVar2;
}



int __fastcall FUN_6b869fa2(int *param_1,undefined4 param_2)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  int in_FS_OFFSET;
  undefined4 uVar4;
  char *pcVar5;
  undefined local_14 [8];
  int local_c;
  int local_8;
  
  RtlInitString(local_14,param_2);
  uVar2 = RtlxAnsiStringToUnicodeSize(local_14);
  local_c = 0;
  local_8 = 0;
  *param_1 = 0;
  if (uVar2 < 0x10000) {
    local_8 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,uVar2);
    if (local_8 == 0) {
      iVar3 = -0x3fffffe9;
      FUN_6b8671a2(1,"AslStringAnsiToUnicode",0x18b,"Out of memory");
      goto LAB_6b86a068;
    }
    local_c = uVar2 << 0x10;
    iVar3 = RtlAnsiStringToUnicodeString(&local_c,local_14,0);
    iVar1 = local_8;
    if (-1 < iVar3) {
      local_8 = 0;
      iVar3 = 0;
      *param_1 = iVar1;
      goto LAB_6b86a068;
    }
    pcVar5 = "RtlAnsiStringToUnicodeString failed [%x]";
    uVar4 = 0x194;
  }
  else {
    pcVar5 = "Ansi string is too long to convert at %d";
    iVar3 = -0x3ffffff3;
    uVar4 = 0x184;
  }
  FUN_6b8671a2(1,"AslStringAnsiToUnicode",uVar4,pcVar5);
LAB_6b86a068:
  if (local_8 != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_8);
  }
  return iVar3;
}



undefined4 __fastcall FUN_6b86a089(short *param_1)

{
  short sVar1;
  
  if (param_1 != (short *)0x0) {
    sVar1 = *param_1;
    while (sVar1 != 0) {
      if ((sVar1 == 0x2a) || (sVar1 == 0x3f)) {
        return 1;
      }
      param_1 = param_1 + 1;
      sVar1 = *param_1;
    }
  }
  return 0;
}



undefined4 __fastcall FUN_6b86a0be(short *param_1,short *param_2)

{
  short *psVar1;
  short sVar2;
  short sVar3;
  int iVar4;
  short *local_8;
  
  local_8 = param_2;
  do {
    sVar3 = *param_1;
    psVar1 = param_1;
    do {
      param_1 = psVar1;
      if ((sVar3 == 0) && (*local_8 == 0)) {
        return 1;
      }
      if (sVar3 == 0x3f) {
        param_1 = param_1 + 1;
        goto LAB_6b86a16b;
      }
      if (sVar3 != 0x2a) {
        sVar2 = RtlUpcaseUnicodeChar(*local_8);
        sVar3 = RtlUpcaseUnicodeChar(sVar3);
        if (sVar3 != sVar2) {
          return 0;
        }
        param_1 = param_1 + 1;
        goto LAB_6b86a16b;
      }
      psVar1 = param_1 + 1;
      sVar3 = *psVar1;
    } while (sVar3 == 0x2a);
    if (sVar3 == 0) {
      return 1;
    }
    sVar3 = RtlUpcaseUnicodeChar(sVar3);
    sVar2 = RtlUpcaseUnicodeChar(*local_8);
    if ((sVar3 == sVar2) && (iVar4 = FUN_6b86a0be(psVar1,local_8), iVar4 != 0)) {
      return 1;
    }
LAB_6b86a16b:
    if (*local_8 == 0) {
      return 0;
    }
    local_8 = local_8 + 1;
  } while( true );
}



int __fastcall FUN_6b86a185(int param_1,uint param_2,int param_3,uint param_4)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  
  if ((param_2 != 0) && (param_4 <= param_2)) {
    uVar3 = 0;
    do {
      uVar1 = 0;
      uVar2 = uVar3;
      if (param_4 != 0) {
        do {
          if (param_2 <= uVar2) break;
          if ((*(char *)(uVar2 + param_1) == '\0') && (uVar2 = uVar2 + 1, param_2 <= uVar2)) {
            return 0;
          }
          if (*(char *)(uVar2 + param_1) != *(char *)(uVar1 + param_3)) break;
          uVar1 = uVar1 + 1;
          uVar2 = uVar2 + 1;
        } while (uVar1 < param_4);
      }
      if (uVar1 == param_4) {
        return param_1 + uVar3;
      }
      uVar3 = uVar3 + 1;
    } while (uVar3 + param_4 <= param_2);
  }
  return 0;
}



int __fastcall FUN_6b86a1fa(int param_1,uint param_2,int param_3,uint param_4)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  
  if ((param_2 != 0) && (param_4 <= param_2)) {
    uVar3 = 0;
    do {
      uVar1 = 0;
      uVar2 = uVar3;
      if (param_4 != 0) {
        do {
          if (param_2 <= uVar2) break;
          if ((*(short *)(param_1 + uVar2 * 2) == 0) && (uVar2 = uVar2 + 1, param_2 <= uVar2)) {
            return 0;
          }
          if (*(short *)(param_1 + uVar2 * 2) != *(short *)(param_3 + uVar1 * 2)) break;
          uVar1 = uVar1 + 1;
          uVar2 = uVar2 + 1;
        } while (uVar1 < param_4);
      }
      if (uVar1 == param_4) {
        return param_1 + uVar3 * 2;
      }
      uVar3 = uVar3 + 1;
    } while (uVar3 + param_4 <= param_2);
  }
  return 0;
}



undefined4 __fastcall FUN_6b86a272(short *param_1)

{
  short sVar1;
  ushort uVar2;
  uint uVar3;
  short *psVar4;
  uint uVar5;
  uint uVar6;
  
  if (param_1 == (short *)0x0) {
    return 0xc000000d;
  }
  if (*param_1 != 0) {
    psVar4 = param_1;
    do {
      sVar1 = *psVar4;
      psVar4 = psVar4 + 1;
    } while (sVar1 != 0);
    uVar3 = 0;
    uVar5 = (int)psVar4 - (int)(param_1 + 1) >> 1;
    if (uVar5 != 0) {
      do {
        uVar2 = param_1[uVar3];
        uVar6 = 0;
        do {
          if ((*(ushort *)((int)&DAT_6b88d760 + uVar6) <= uVar2) &&
             (uVar2 < *(ushort *)((int)&DAT_6b88d762 + uVar6) ||
              uVar2 == *(ushort *)((int)&DAT_6b88d762 + uVar6))) goto LAB_6b86a2c5;
          uVar6 = uVar6 + 4;
        } while (uVar6 < 0x14);
        param_1[uVar3] = 0x40;
LAB_6b86a2c5:
        uVar3 = uVar3 + 1;
      } while (uVar3 < uVar5);
    }
  }
  return 0;
}



void __fastcall FUN_6b86a2d0(undefined4 *param_1)

{
  int in_FS_OFFSET;
  
  if (param_1 != (undefined4 *)0x0) {
    if (param_1[1] != 0) {
      memset((void *)param_1[1],0x42,(uint)*(ushort *)((int)param_1 + 2));
      if (param_1[1] != 0) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1[1]);
      }
    }
    *param_1 = 0;
    param_1[1] = 0;
  }
  return;
}



int __fastcall
FUN_6b86a314(short *param_1,wchar_t *param_2,wchar_t *param_3,uint param_4,int *param_5,
            short param_6,short param_7)

{
  uint uVar1;
  wchar_t wVar2;
  int iVar3;
  wchar_t *pwVar4;
  wchar_t *pwVar5;
  wchar_t *pwVar6;
  int in_FS_OFFSET;
  undefined4 uVar7;
  char *pcVar8;
  uint local_8;
  
  local_8 = 0;
  pwVar4 = param_2;
  do {
    wVar2 = *pwVar4;
    pwVar4 = pwVar4 + 1;
  } while (wVar2 != L'\0');
  uVar1 = ((int)pwVar4 - (int)(param_2 + 1) >> 1) + 1;
  if (param_3 != (wchar_t *)0x0) {
    *param_3 = L'\0';
  }
  if (param_5 != (int *)0x0) {
    *param_5 = 0;
  }
  iVar3 = FUN_6b86ab39(param_2,uVar1,(short *)0x0,0,param_6,param_7,&local_8);
  if (iVar3 != -0x3fffffdd) {
    pcVar8 = "AslpEnvResolveVars failed to fail properly for null buffer";
    iVar3 = -0x3fffff1b;
    uVar7 = 0x307;
LAB_6b86a38a:
    FUN_6b8671a2(1,"AslEnvExpandStrings2",uVar7,pcVar8);
    return iVar3;
  }
  pwVar4 = param_2;
  pwVar6 = (wchar_t *)0x0;
  if (uVar1 == local_8) {
LAB_6b86a415:
    pwVar5 = pwVar4;
    do {
      wVar2 = *pwVar5;
      pwVar5 = pwVar5 + 1;
    } while (wVar2 != L'\0');
    iVar3 = FUN_6b86a484(param_1,pwVar4,(int)pwVar5 - (int)(pwVar4 + 1) >> 1,param_3,param_4,param_5
                        );
    if ((-1 < iVar3) || (iVar3 == -0x3fffffdd)) goto LAB_6b86a464;
    pcVar8 = "AslEnvExpandStrings failed [%x]";
    uVar7 = 0x32a;
  }
  else {
    pwVar4 = (wchar_t *)
             RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,local_8 * 2);
    if (pwVar4 == (wchar_t *)0x0) {
      pcVar8 = "Out of memory";
      iVar3 = -0x3fffffe9;
      uVar7 = 0x30f;
      goto LAB_6b86a38a;
    }
    pwVar6 = param_2;
    do {
      wVar2 = *pwVar6;
      pwVar6 = pwVar6 + 1;
    } while (wVar2 != L'\0');
    iVar3 = FUN_6b86ab39(param_2,((int)pwVar6 - (int)(param_2 + 1) >> 1) + 1,pwVar4,local_8,param_6,
                         param_7,&local_8);
    pwVar6 = pwVar4;
    if (-1 < iVar3) goto LAB_6b86a415;
    pcVar8 = "AslpEnvResolveVars failed [%x]";
    uVar7 = 0x31b;
  }
  FUN_6b8671a2(1,"AslEnvExpandStrings2",uVar7,pcVar8);
LAB_6b86a464:
  if (pwVar6 == (wchar_t *)0x0) {
    return iVar3;
  }
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pwVar6);
  return iVar3;
}



int __fastcall
FUN_6b86a484(short *param_1,wchar_t *param_2,uint param_3,wchar_t *param_4,uint param_5,int *param_6
            )

{
  int iVar1;
  int iVar2;
  wchar_t *pwVar3;
  uint local_20;
  uint local_1c;
  wchar_t *local_18;
  int local_14;
  uint local_10;
  int local_c;
  wchar_t *local_8;
  
  local_14 = 0;
  local_c = 0;
  iVar1 = 0;
  iVar2 = 0;
  if (param_3 != 0) {
    local_8 = param_4;
    local_18 = param_2;
    do {
      if (*local_18 == L'%') {
        local_10 = 0;
        local_1c = param_3 - 1;
        pwVar3 = local_18 + 1;
        if (local_1c == 0) goto LAB_6b86a5b8;
        do {
          if (*pwVar3 == L'%') break;
          pwVar3 = pwVar3 + 1;
          local_10 = local_10 + 1;
        } while (local_10 < local_1c);
        if ((local_10 == 0) || (local_1c <= local_10)) goto LAB_6b86a5b8;
        iVar1 = FUN_6b86a8ea(param_1,local_18 + 1,local_10,local_8,param_5,&local_20);
        if (iVar1 == -0x3fffffdd) {
          local_c = local_c + (local_20 - 1);
          local_14 = -0x3fffffdd;
          local_1c = param_3 + (-2 - local_10);
          local_18 = pwVar3;
        }
        else if (iVar1 < 0) {
          if (iVar1 != -0x3fffff00) {
            FUN_6b8671a2(1,"AslEnvExpandStrings",0x27f,"AslEnvVarQuery failed [%x]");
          }
          local_c = local_c + 1;
        }
        else {
          local_c = local_c + local_20;
          local_1c = param_3 + (-2 - local_10);
          if (local_20 < param_5) {
            param_5 = param_5 - local_20;
            local_8 = local_8 + local_20;
            local_18 = pwVar3;
          }
          else {
            local_14 = -0x3fffffdd;
            local_18 = pwVar3;
          }
        }
      }
      else {
LAB_6b86a5b8:
        if (local_14 != -0x3fffffdd) {
          if (param_5 < 2) {
            local_14 = -0x3fffffdd;
          }
          else {
            param_5 = param_5 - 1;
            *local_8 = *local_18;
            local_8 = local_8 + 1;
          }
        }
        local_c = local_c + 1;
        local_1c = param_3 - 1;
      }
      local_18 = local_18 + 1;
      param_3 = local_1c;
    } while (local_1c != 0);
    iVar1 = local_14;
    iVar2 = local_c;
    param_4 = local_8;
    if (local_14 == -0x3fffffdd) goto LAB_6b86a608;
  }
  if (param_5 == 0) {
    iVar1 = -0x3fffffdd;
  }
  else {
    *param_4 = L'\0';
  }
LAB_6b86a608:
  if (param_6 != (int *)0x0) {
    *param_6 = iVar2 + 1;
  }
  return iVar1;
}



// WARNING: Could not reconcile some variable overlaps

void __fastcall FUN_6b86a619(undefined2 *param_1,undefined2 *param_2)

{
  undefined2 *extraout_EDX;
  undefined2 *puVar1;
  undefined8 uVar2;
  undefined4 uVar3;
  char *pcVar4;
  undefined4 local_20;
  undefined4 uStack28;
  undefined4 uStack24;
  undefined4 local_14;
  undefined4 uStack16;
  undefined4 uStack12;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_14 = 0;
  uStack16 = 0;
  uStack12 = 0;
  local_20 = 0;
  uStack28 = 0;
  uStack24 = 0;
  puVar1 = param_2;
  if (param_1 == (undefined2 *)0x0) {
LAB_6b86a684:
    if (param_2 == (undefined2 *)0x0) goto LAB_6b86a6b3;
    uVar2 = ZwQuerySystemInformation(1,&local_20,0xc,0);
    puVar1 = (undefined2 *)((ulonglong)uVar2 >> 0x20);
    if (-1 < (int)uVar2) {
      *param_2 = (undefined2)local_20;
      goto LAB_6b86a6b3;
    }
    pcVar4 = "ZwQuerySystemInformation failed [%x]";
    uVar3 = 0x722;
  }
  else {
    uVar2 = RtlGetNativeSystemInformation(1,&local_14,0xc,0);
    puVar1 = (undefined2 *)((ulonglong)uVar2 >> 0x20);
    if (-1 < (int)uVar2) {
      *param_1 = (undefined2)local_14;
      goto LAB_6b86a684;
    }
    pcVar4 = "RtlGetNativeSystemInformation failed [%x]";
    uVar3 = 0x700;
  }
  FUN_6b8671a2(1,"AslEnvGetProcessWowInfo",uVar3,pcVar4);
  puVar1 = extraout_EDX;
LAB_6b86a6b3:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,puVar1);
  return;
}



void __fastcall
FUN_6b86a6c6(short *param_1,uint param_2,short *param_3,short param_4,short *param_5)

{
  int iVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined8 uVar2;
  undefined4 uVar3;
  char *pcVar4;
  short local_88 [64];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  memset(local_88,0,0x80);
  *param_1 = 0;
  if ((param_5 == (short *)0x0) || (*param_5 == param_4)) {
    FUN_6b86a7cb(param_1,param_2,param_3,param_4,param_5);
    uVar3 = extraout_EDX_01;
    goto LAB_6b86a7ba;
  }
  iVar1 = FUN_6b86848c(local_88,0x40,(int)L"\\SysNative");
  if (iVar1 < 0) {
    pcVar4 = "AslPathToSystemPathBuf failed [%x]";
    uVar3 = 0x696;
  }
  else if ((param_3 == (short *)0x0) || (*param_3 == 0)) {
    uVar2 = FUN_6b8147b5(param_1,param_2,(int)local_88);
    uVar3 = (undefined4)((ulonglong)uVar2 >> 0x20);
    if (-1 < (int)uVar2) goto LAB_6b86a7ba;
    pcVar4 = "RtlStringCchCopyW failed [%x]";
    uVar3 = 0x6a8;
  }
  else {
    iVar1 = FUN_6b868380(local_88,param_3,param_1,param_2);
    uVar3 = extraout_EDX;
    if (-1 < iVar1) goto LAB_6b86a7ba;
    pcVar4 = "AslPathCombine failed [%x]";
    uVar3 = 0x6a0;
  }
  FUN_6b8671a2(1,"AslEnvGetSysNativeDirPathForGuestBuf",uVar3,pcVar4);
  uVar3 = extraout_EDX_00;
LAB_6b86a7ba:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar3);
  return;
}



void __fastcall
FUN_6b86a7cb(short *param_1,uint param_2,short *param_3,short param_4,short *param_5)

{
  uint uVar1;
  int iVar2;
  short sVar3;
  undefined2 extraout_var;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined8 uVar4;
  undefined4 uVar5;
  char *pcVar6;
  short local_88 [64];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  memset(local_88,0,0x80);
  uVar5 = CONCAT22(extraout_var,param_4);
  *param_1 = 0;
  sVar3 = param_4;
  if (param_5 != (short *)0x0) {
    sVar3 = *param_5;
  }
  uVar1 = 0;
  while (((&DAT_6b8b0090)[uVar1 * 4] != param_4 || ((&DAT_6b8b0092)[uVar1 * 4] != sVar3))) {
    uVar1 = uVar1 + 1;
    if (6 < uVar1) {
LAB_6b86a83e:
      FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar5);
      return;
    }
  }
  iVar2 = FUN_6b86848c(local_88,0x40,(int)(&PTR_u__System32_6b8b0094)[uVar1 * 2]);
  if (iVar2 < 0) {
    pcVar6 = "AslPathToSystemPathBuf failed [%x]";
    uVar5 = 0x586;
  }
  else if ((param_3 == (short *)0x0) || (*param_3 == 0)) {
    uVar4 = FUN_6b8147b5(param_1,param_2,(int)local_88);
    uVar5 = (undefined4)((ulonglong)uVar4 >> 0x20);
    if (-1 < (int)uVar4) goto LAB_6b86a83e;
    pcVar6 = "RtlStringCchCopyW failed [%x]";
    uVar5 = 0x598;
  }
  else {
    iVar2 = FUN_6b868380(local_88,param_3,param_1,param_2);
    uVar5 = extraout_EDX_00;
    if (-1 < iVar2) goto LAB_6b86a83e;
    pcVar6 = "AslPathCombine failed [%x]";
    uVar5 = 0x590;
  }
  FUN_6b8671a2(1,"AslEnvGetSystem32DirPathBuf",uVar5,pcVar6);
  uVar5 = extraout_EDX;
  goto LAB_6b86a83e;
}



undefined4 __fastcall
FUN_6b86a8ea(short *param_1,wchar_t *param_2,uint param_3,undefined2 *param_4,uint param_5,
            uint *param_6)

{
  wchar_t *pwVar1;
  bool bVar2;
  short sVar3;
  short sVar4;
  int iVar5;
  short *psVar6;
  undefined4 uVar7;
  wchar_t *pwVar8;
  short *psVar9;
  uint uVar10;
  
  pwVar1 = param_2 + param_3;
  if ((param_3 < 10) || (iVar5 = _wcsnicmp(param_2,L"systemroot",10), iVar5 != 0)) {
    if (param_1 != (short *)0x0) {
      sVar3 = *param_1;
      while (sVar3 != 0) {
        pwVar8 = param_2;
        psVar9 = param_1;
        if (param_2 < pwVar1) {
          do {
            if (*psVar9 == 0) break;
            sVar3 = RtlUpcaseUnicodeChar(*psVar9);
            sVar4 = RtlUpcaseUnicodeChar(*pwVar8);
            if (sVar3 != sVar4) break;
            pwVar8 = pwVar8 + 1;
            psVar9 = psVar9 + 1;
          } while (pwVar8 < pwVar1);
        }
        if ((pwVar8 == pwVar1) && (*psVar9 == 0x3d)) {
          bVar2 = true;
LAB_6b86aa23:
          psVar6 = psVar9;
          if (*psVar9 != 0) {
            iVar5 = 0;
            do {
              if (0xfffd < iVar5) break;
              psVar6 = psVar6 + 1;
              iVar5 = iVar5 + 2;
            } while (*psVar6 != 0);
          }
          if (bVar2) {
            uVar10 = (int)psVar6 - (int)(psVar9 + 1) >> 1;
            if (uVar10 < param_5) {
              memcpy(param_4,psVar9 + 1,uVar10 * 2);
              uVar7 = 0;
              param_4[uVar10] = 0;
            }
            else {
              if ((param_4 != (undefined2 *)0x0) && (param_5 != 0)) {
                *param_4 = 0;
              }
              uVar7 = 0xc0000023;
              uVar10 = uVar10 + 1;
            }
            *param_6 = uVar10;
            return uVar7;
          }
        }
        else {
          bVar2 = false;
          sVar3 = *psVar9;
          while (psVar6 = psVar9, sVar3 != 0) {
            if ((sVar3 == 0x3d) && (psVar9 != param_1)) goto LAB_6b86aa23;
            psVar9 = psVar9 + 1;
            sVar3 = *psVar9;
          }
        }
        param_1 = psVar6 + 1;
        sVar3 = *param_1;
      }
    }
    uVar7 = 0xc0000100;
  }
  else {
    psVar6 = (short *)FUN_6b817e77();
    psVar9 = psVar6;
    do {
      sVar3 = *psVar9;
      psVar9 = psVar9 + 1;
    } while (sVar3 != 0);
    uVar10 = (int)psVar9 - (int)(psVar6 + 1) >> 1;
    if (uVar10 < param_5) {
      *param_6 = uVar10;
      memcpy(param_4,psVar6,uVar10 * 2);
      uVar7 = 0;
      param_4[uVar10] = 0;
    }
    else {
      if ((param_4 != (undefined2 *)0x0) && (param_5 != 0)) {
        *param_4 = 0;
      }
      *param_6 = uVar10 + 1;
      uVar7 = 0xc0000023;
    }
  }
  return uVar7;
}



// WARNING: Could not reconcile some variable overlaps

int __fastcall FUN_6b86aaa8(short *param_1,short param_2)

{
  int iVar1;
  uint uVar2;
  short *local_8;
  
  if (param_1 == (short *)0x0) {
    local_8 = param_1;
    iVar1 = FUN_6b86a619((undefined2 *)&local_8,(undefined2 *)0x0);
    if (iVar1 < 0) {
      FUN_6b8671a2(1,"AslEnvVerifyGuestProcessorSupport",0x74b,"AslEnvGetProcessWowInfo failed [%x]"
                  );
      return iVar1;
    }
  }
  else {
    local_8._0_2_ = *param_1;
  }
  uVar2 = 0;
  while ((*(short *)((int)&DAT_6b8b0090 + uVar2) != (short)local_8 ||
         (*(short *)((int)&DAT_6b8b0092 + uVar2) != param_2))) {
    uVar2 = uVar2 + 8;
    if (0x37 < uVar2) {
      return -0x3fffff45;
    }
  }
  return 0;
}



uint __fastcall FUN_6b86ab18(short param_1)

{
  uint uVar1;
  
  uVar1 = 0;
  do {
    if ((&DAT_6b8b0252)[uVar1 * 2] == param_1) {
      return uVar1 & 0xffff0000 | (uint)(ushort)(&DAT_6b8b0250)[uVar1 * 2];
    }
    uVar1 = uVar1 + 1;
  } while (uVar1 < 4);
  return 0xffff;
}



int __fastcall
FUN_6b86ab39(wchar_t *param_1,uint param_2,short *param_3,uint param_4,short param_5,short param_6,
            uint *param_7)

{
  bool bVar1;
  bool bVar2;
  bool bVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  undefined4 uVar7;
  char *pcVar8;
  uint local_14;
  
  bVar1 = false;
  bVar2 = false;
  uVar6 = 0;
  bVar3 = false;
  local_14 = 0;
  do {
    if (bVar1) goto LAB_6b86ad64;
    if (((uint)(&DAT_6b8b00d8)[local_14 * 4] < param_2) &&
       (uVar4 = _wcsnicmp(param_1,(wchar_t *)(&_Str2_6b8b00d0)[local_14 * 4],
                          (&DAT_6b8b00d8)[local_14 * 4]), bVar1 = bVar2, uVar4 == 0)) {
      uVar6 = ((&DAT_6b8b00dc)[local_14 * 4] - (&DAT_6b8b00d8)[local_14 * 4]) + param_2;
      if (param_4 < uVar6) {
        iVar5 = -0x3fffffdd;
        goto LAB_6b86ad66;
      }
      if (local_14 == 0) {
        do {
          if ((*(short *)((int)&DAT_6b8b0090 + uVar4) == param_5) &&
             (*(short *)((int)&DAT_6b8b0092 + uVar4) == param_6)) {
            iVar5 = FUN_6b8147b5(param_3,param_4,(int)L"%systemroot%");
            if (iVar5 < 0) {
              pcVar8 = "RtlStringCchCopyW failed [%x]";
              uVar7 = 0x3ac;
              goto LAB_6b86ad11;
            }
            iVar5 = FUN_6b83282b(param_3,param_4,*(int *)((int)&PTR_u__System32_6b8b0094 + uVar4));
            if (iVar5 < 0) {
              pcVar8 = "RtlStringCchCatW failed [%x]";
              uVar7 = 0x3b2;
              goto LAB_6b86ad11;
            }
            iVar5 = FUN_6b83282b(param_3,param_4,(int)(param_1 + DAT_6b8b00d8));
            if (iVar5 < 0) {
              pcVar8 = "RtlStringCchCatW failed [%x]";
              uVar7 = 0x3b8;
              goto LAB_6b86ad11;
            }
            bVar3 = true;
          }
          uVar4 = uVar4 + 8;
        } while (uVar4 < 0x38);
        if (!bVar3) {
          FUN_6b8671a2(1,"AslpEnvResolveVars",0x3c3,
                       "Invalid combination of Host/Current processor architectures passed to AslpEnvResolveVars Host: %x4 Current: %x4"
                      );
          goto LAB_6b86ac74;
        }
      }
      else {
LAB_6b86ac74:
        if (!bVar3) {
          iVar5 = FUN_6b8147b5(param_3,param_4,
                               (int)(&PTR_u__systemroot__system32_6b8b00d4)[local_14 * 4]);
          if (iVar5 < 0) {
            pcVar8 = "RtlStringCchCopyW failed [%x]";
            uVar7 = 0x3d4;
            goto LAB_6b86ad11;
          }
          iVar5 = FUN_6b83282b(param_3,param_4,(int)(param_1 + (&DAT_6b8b00d8)[local_14 * 4]));
          if (iVar5 < 0) {
            pcVar8 = "RtlStringCchCatW failed [%x]";
            uVar7 = 0x3da;
            goto LAB_6b86ad11;
          }
        }
      }
      bVar2 = true;
      bVar1 = true;
    }
    local_14 = local_14 + 1;
  } while (local_14 < 4);
  if (!bVar1) {
    if (param_4 < param_2) {
      *param_7 = param_2;
      return -0x3fffffdd;
    }
    iVar5 = FUN_6b8147b5(param_3,param_4,(int)param_1);
    uVar6 = param_2;
    if (iVar5 < 0) {
      pcVar8 = "RtlStringCchCopyW failed [%x]";
      uVar7 = 0x3fa;
LAB_6b86ad11:
      FUN_6b8671a2(1,"AslpEnvResolveVars",uVar7,pcVar8);
      return iVar5;
    }
  }
LAB_6b86ad64:
  iVar5 = 0;
LAB_6b86ad66:
  *param_7 = uVar6;
  return iVar5;
}



void __fastcall FUN_6b86ad74(undefined4 *param_1,wchar_t *param_2)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  short *psVar4;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 extraout_EDX_04;
  short **ppsVar5;
  int in_FS_OFFSET;
  undefined8 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  char *pcVar9;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 *local_3c;
  short **local_38;
  undefined local_34 [4];
  wchar_t *local_30;
  short **local_2c;
  short *local_28 [7];
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_3c = param_1;
  uVar6 = CONCAT44(param_2,local_2c);
  if (((param_2 == (wchar_t *)0x0) || (uVar6 = CONCAT44(param_2,local_2c), *param_2 == L'\0')) ||
     (uVar6 = CONCAT44(param_2,local_2c), param_1 == (undefined4 *)0x0)) goto LAB_6b86af55;
  *param_1 = 0;
  RtlInitUnicodeString(local_34,param_2);
  uVar6 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,0x38);
  ppsVar5 = (short **)uVar6;
  if (ppsVar5 != (short **)0x0) {
    local_2c = ppsVar5;
    uVar1 = FUN_6b81464d(ppsVar5,param_2);
    if ((int)uVar1 < 0) {
      FUN_6b8671a2(1,"AslFileMappingCreate",0x79,"AslStringDuplicate failed [%x]");
      uVar8 = extraout_EDX;
    }
    else {
      iVar2 = _wcsnicmp(param_2,L"\\SystemRoot\\",0xc);
      if ((iVar2 == 0) ||
         (iVar2 = RtlDosPathNameToNtPathName_U_WithStatus(param_2,local_34,0,0), -1 < iVar2)) {
        local_38 = ppsVar5 + 2;
        iVar2 = FUN_6b86b57f((int *)local_38,local_34);
        if (iVar2 < 0) {
          iVar3 = FUN_6b86737b(iVar2);
          uVar8 = extraout_EDX_01;
          if (iVar3 == 0) {
            if (((iVar2 != -0x3fffffde) && (iVar2 != -0x3fffffbd)) &&
               ((iVar2 != -0x3fffffed && (iVar2 != -0x3fffff46)))) {
              pcVar9 = "RtlFileMapInitializeByFilePath failed %S [%x]";
              uVar8 = 0x9f;
              goto LAB_6b86ae3f;
            }
            pcVar9 = "RtlFileMapInitializeByFilePath failed %S [%x]";
            uVar8 = 0xa1;
            uVar7 = 3;
            goto LAB_6b86ae46;
          }
        }
        else {
          local_44 = 0;
          local_40 = 0;
          ppsVar5 = local_28;
          for (iVar2 = 6; iVar2 != 0; iVar2 = iVar2 + -1) {
            *ppsVar5 = (short *)0x0;
            ppsVar5 = ppsVar5 + 1;
          }
          uVar6 = ZwQueryInformationFile(*local_38,&local_44,local_28,0x18,5);
          uVar8 = (undefined4)((ulonglong)uVar6 >> 0x20);
          if ((int)uVar6 < 0) {
            FUN_6b8671a2(1,"AslFileMappingCreate",0xb5,"NtQueryInformationFile failed [%x]");
            uVar8 = extraout_EDX_02;
            ppsVar5 = local_2c;
          }
          else {
            local_2c[4] = local_28[2];
            local_2c[5] = local_28[3];
            if (((uint)local_28[2] | (uint)local_28[3]) == 0) {
              psVar4 = (short *)&DAT_00000001;
            }
            else {
              psVar4 = (short *)0x2;
            }
            local_2c[10] = psVar4;
            ppsVar5 = (short **)0x0;
            *local_3c = local_2c;
          }
        }
      }
      else {
        pcVar9 = "RtlDosPathNameToNtPathName_U_WithStatus failed for %S [%x]";
        uVar8 = 0x92;
LAB_6b86ae3f:
        uVar7 = 1;
LAB_6b86ae46:
        FUN_6b8671a2(uVar7,"AslFileMappingCreate",uVar8,pcVar9);
        uVar8 = extraout_EDX_00;
      }
    }
    uVar6 = CONCAT44(uVar8,local_2c);
    if (ppsVar5 != (short **)0x0) {
      FUN_6b86af66((int *)ppsVar5);
      uVar6 = CONCAT44(extraout_EDX_03,local_2c);
    }
  }
  local_2c = (short **)uVar6;
  if (local_30 != param_2) {
    RtlFreeUnicodeString(local_34);
    uVar6 = CONCAT44(extraout_EDX_04,local_2c);
  }
LAB_6b86af55:
  local_2c = (short **)uVar6;
  FUN_6b8224af(local_c ^ (uint)&stack0xfffffffc,(int)((ulonglong)uVar6 >> 0x20));
  return;
}



void __fastcall FUN_6b86af66(int *param_1)

{
  int in_FS_OFFSET;
  
  if (param_1 != (int *)0x0) {
    FUN_6b86b52e(param_1 + 2);
    if (param_1[0xb] != 0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1[0xb]);
      param_1[0xb] = 0;
    }
    if (*param_1 != 0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,*param_1);
      *param_1 = 0;
    }
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1);
  }
  return;
}



int __fastcall FUN_6b86afc1(int param_1,uint param_2)

{
  int *piVar1;
  int iVar2;
  
  if (*(int *)(param_1 + 0x30) == 0) {
    if (*(int *)(param_1 + 0x18) != 0) {
      return 0;
    }
    piVar1 = (int *)(param_1 + 0x28);
    if (*piVar1 != 1) {
      iVar2 = FUN_6b86b601((undefined4 *)(param_1 + 8),param_2 & 0xffffff00);
      if (iVar2 < 0) {
        return iVar2;
      }
      if (*(char *)(param_1 + 0x23) != '\0') {
        *piVar1 = 6;
        return iVar2;
      }
      iVar2 = FUN_6b86b3ef(param_1 + 8,piVar1);
      if (-1 < iVar2) {
        return iVar2;
      }
      FUN_6b8671a2(1,"AslFileMappingEnsure",0x24f,"AslpFileMappingGetFileKind failed %S [%x]");
      *piVar1 = 3;
      return iVar2;
    }
  }
  else if (*(int *)(param_1 + 0x28) != 1) {
    return (-(uint)(*(int *)(param_1 + 0x18) != 0) & 0x3ffffb93) + 0xc000046d;
  }
  return -0x3ffffee2;
}



int __fastcall FUN_6b86b052(int param_1,uint param_2)

{
  int *piVar1;
  int iVar2;
  
  piVar1 = (int *)(param_1 + 0x28);
  if (*(int *)(param_1 + 0x30) == 0) {
    if (*piVar1 != 1) {
      iVar2 = FUN_6b86b601((undefined4 *)(param_1 + 8),param_2 & 0xffffff00);
      if (-1 < iVar2) {
        if (*(char *)(param_1 + 0x23) != '\0') {
          *piVar1 = 6;
          return iVar2;
        }
        iVar2 = FUN_6b86b3ef(param_1 + 8,piVar1);
        if (-1 < iVar2) {
          return iVar2;
        }
        FUN_6b8671a2(1,"AslFileMappingEnsureMappedAs",0x1f7,
                     "AslpFileMappingGetFileKind failed %S [%x]");
        *piVar1 = 3;
        return iVar2;
      }
      if (iVar2 != -0x3ffffef2) {
        return iVar2;
      }
      if (*(char *)(param_1 + 0x23) != '\0') {
        return -0x3ffffef2;
      }
      return 0;
    }
  }
  else if (*piVar1 != 1) {
    return -0x3ffffb93;
  }
  return -0x3ffffee2;
}



int __fastcall FUN_6b86b0e4(int *param_1,int param_2)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  char *pcVar4;
  uint local_14;
  uint local_10;
  short local_c [2];
  short local_8 [2];
  
  local_14 = 0;
  local_10 = 0;
  local_c[0] = 0;
  local_8[0] = 0;
  if (*(int *)(param_2 + 0x28) == 1) {
    iVar1 = 1;
  }
  else {
    iVar2 = FUN_6b86afc1(param_2,param_2);
    if (iVar2 < 0) {
      pcVar4 = "AslFileMappingEnsure failed [%x]";
      uVar3 = 0x550;
      goto LAB_6b86b12a;
    }
    iVar1 = *(int *)(param_2 + 0x28);
    if (iVar1 == 3) {
      iVar1 = 2;
    }
    else if (iVar1 == 4) {
      iVar1 = 3;
    }
    else {
      if (iVar1 != 5) {
        if (iVar1 == 6) {
          iVar2 = FUN_6b86b243(local_c,local_8,&local_10,&local_14,param_2);
          if (-1 < iVar2) {
            if (local_10 == 0) {
              if (local_8[0] == 0x20b) {
                if (local_c[0] == 0x200) {
                  iVar1 = 0xb;
                }
                else if (local_c[0] == -0x799c) {
                  iVar1 = 9;
                }
                else {
                  iVar1 = (uint)(local_c[0] == -0x559c) * 2 + 8;
                }
              }
              else if (local_c[0] == 0x14c) {
                iVar1 = 6;
              }
              else if ((local_c[0] == 0x1c0) || (local_c[0] == 0x1c4)) {
                iVar1 = 7;
              }
              else {
                iVar1 = 5;
              }
            }
            else if (local_8[0] == 0x20b) {
              iVar1 = 0xf;
            }
            else if ((local_14 & 0x20002) == 0x20002) {
              iVar1 = 0xe;
            }
            else {
              iVar1 = 0xd - (uint)((local_14 & 0x20003) != 1);
            }
            goto LAB_6b86b231;
          }
          pcVar4 = "AslFileMappingGetImageTypeEx failed [%x]";
          uVar3 = 0x57d;
        }
        else {
          pcVar4 = "Unhandled ASL_FILE_KIND: %d";
          iVar2 = -0x3fffffff;
          uVar3 = 0x573;
        }
LAB_6b86b12a:
        iVar1 = 0;
        FUN_6b8671a2(1,"AslFileMappingGetFileKindDetail",uVar3,pcVar4);
        goto LAB_6b86b233;
      }
      iVar1 = 4;
    }
  }
LAB_6b86b231:
  iVar2 = 0;
LAB_6b86b233:
  if (param_1 != (int *)0x0) {
    *param_1 = iVar1;
  }
  return iVar2;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

int __fastcall
FUN_6b86b243(undefined2 *param_1,short *param_2,uint *param_3,undefined4 *param_4,int param_5)

{
  undefined2 uVar1;
  short sVar2;
  uint uVar3;
  int iVar4;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar5;
  char *pcVar6;
  undefined4 local_34;
  uint local_30;
  int local_24;
  int local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b892880;
  uStack12 = 0x6b86b24f;
  local_24 = 0;
  uVar3 = 0;
  uVar1 = 0;
  sVar2 = 0;
  local_30 = 0;
  local_34 = 0;
  if (*(int *)(param_5 + 0x28) == 1) {
LAB_6b86b271:
    iVar4 = -0x3fffff85;
  }
  else {
    iVar4 = FUN_6b86afc1(param_5,(uint)param_2);
    if (iVar4 < 0) {
      pcVar6 = "AslFileMappingEnsure failed [%x]";
      uVar5 = 0x44e;
    }
    else {
      if (*(int *)(param_5 + 0x28) != 6) goto LAB_6b86b271;
      iVar4 = FUN_6b86c7fe(&local_24,param_5);
      local_20 = iVar4;
      if (-1 < iVar4) {
        uVar1 = *(undefined2 *)(local_24 + 4);
        sVar2 = *(short *)(local_24 + 0x18);
        if ((*(int *)(param_5 + 0x30) == 0) &&
           ((param_3 != (uint *)0x0 || (param_4 != (undefined4 *)0x0)))) {
          if (sVar2 == 0x10b) {
            uVar3 = *(uint *)(local_24 + 0xe8);
          }
          else if (sVar2 == 0x20b) {
            uVar3 = *(uint *)(local_24 + 0xf8);
          }
          if (uVar3 != 0) {
            local_8 = (undefined *)0x0;
            iVar4 = FUN_6b86e02c(local_24,param_5 + 8,uVar3);
            if (iVar4 != 0) {
              local_34 = *(undefined4 *)(iVar4 + 0x10);
            }
            else {
              FUN_6b8671a2(2,"AslFileMappingGetImageTypeEx",0x498,"Failed to find the Cor20Header");
            }
            local_30 = (uint)(iVar4 != 0);
            iVar4 = 0;
            goto LAB_6b86b3a7;
          }
        }
        iVar4 = 0;
        goto LAB_6b86b3a7;
      }
      pcVar6 = "AslpFileGetImageNtHeader failed [%x]";
      uVar5 = 0x462;
    }
    FUN_6b8671a2(1,"AslFileMappingGetImageTypeEx",uVar5,pcVar6);
  }
LAB_6b86b3a7:
  if (param_1 != (undefined2 *)0x0) {
    *param_1 = uVar1;
  }
  if (param_2 != (short *)0x0) {
    *param_2 = sVar2;
  }
  if (param_3 != (uint *)0x0) {
    *param_3 = local_30;
  }
  if (param_4 != (undefined4 *)0x0) {
    *param_4 = local_34;
  }
  *in_FS_OFFSET = local_14;
  return iVar4;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 __fastcall FUN_6b86b3ef(int param_1,undefined4 *param_2)

{
  short *psVar1;
  int *piVar2;
  undefined4 uVar3;
  undefined4 *in_FS_OFFSET;
  undefined4 local_20;
  undefined4 local_14;
  
  if (((*(uint *)(param_1 + 8) | *(uint *)(param_1 + 0xc)) == 0) ||
     (uVar3 = 0, *(int *)(param_1 + 0x14) == 0)) {
    *param_2 = 1;
  }
  else {
    if ((*(int *)(param_1 + 0xc) != 0) || (0x3f < *(uint *)(param_1 + 8))) {
      psVar1 = *(short **)(param_1 + 0x10);
      local_20 = 3;
      if ((psVar1 == (short *)0x0) || (psVar1 == (short *)0xffffffff)) {
        uVar3 = 0xc000000d;
        FUN_6b8671a2(1,"AslpFileMappingGetFileKind",0x4e8,"File mapping invalid [%x]");
      }
      else if (*psVar1 == 0x5a4d) {
        local_20 = 4;
        if ((*(int *)(param_1 + 0xc) != 0) ||
           (*(int *)(psVar1 + 0x1e) + 4U <= *(uint *)(param_1 + 8))) {
          piVar2 = (int *)((int)psVar1 + *(int *)(psVar1 + 0x1e));
          if (*piVar2 == 0x4550) {
            local_20 = 6;
          }
          else if (*(short *)piVar2 == 0x454e) {
            local_20 = 5;
          }
        }
      }
      *param_2 = local_20;
      goto LAB_6b86b51e;
    }
    *param_2 = 3;
  }
  uVar3 = 0;
LAB_6b86b51e:
  *in_FS_OFFSET = local_14;
  return uVar3;
}



void __fastcall FUN_6b86b52e(int *param_1)

{
  int iVar1;
  
  if (param_1 != (int *)0x0) {
    if ((*(char *)(param_1 + 6) != '\0') && (*param_1 != 0)) {
      ZwClose(*param_1);
    }
    if ((*(char *)((int)param_1 + 0x19) != '\0') && (param_1[1] != 0)) {
      ZwClose(param_1[1]);
    }
    if ((*(char *)((int)param_1 + 0x1a) != '\0') && (param_1[4] != 0)) {
      ZwUnmapViewOfSection(0xffffffff,param_1[4]);
    }
    for (iVar1 = 8; iVar1 != 0; iVar1 = iVar1 + -1) {
      *param_1 = 0;
      param_1 = param_1 + 1;
    }
  }
  return;
}



int __fastcall FUN_6b86b57f(int *param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  int local_8;
  
  local_28 = 0x18;
  local_10 = 0;
  local_c = 0;
  local_8 = 0;
  local_24 = 0;
  local_1c = 0x40;
  local_18 = 0;
  local_14 = 0;
  local_20 = param_2;
  iVar1 = ZwCreateFile(&local_8,0x80100080,&local_28,&local_10,0,0x80,5,1,0x60,0,0);
  if (-1 < iVar1) {
    iVar1 = 0;
    *(undefined *)(param_1 + 6) = 1;
    *param_1 = local_8;
    local_8 = 0;
  }
  if (local_8 != 0) {
    ZwClose(local_8);
  }
  return iVar1;
}



void __fastcall FUN_6b86b601(undefined4 *param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 *puVar2;
  undefined8 uVar3;
  undefined4 local_54 [4];
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  int local_30;
  int local_2c;
  char local_25;
  undefined4 local_24 [7];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_25 = (char)param_2;
  puVar2 = local_54;
  for (iVar1 = 6; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  local_3c = 0;
  local_38 = 0;
  puVar2 = local_24;
  for (iVar1 = 6; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  local_2c = 0;
  local_30 = 0;
  local_34 = 0;
  if (param_1[4] == 0) {
    uVar3 = ZwQueryInformationFile(*param_1,&local_3c,local_24,0x18,5);
    param_2 = (undefined4)((ulonglong)uVar3 >> 0x20);
    if (-1 < (int)uVar3) {
      local_54[0] = 0x18;
      local_54[1] = 0;
      local_54[3] = 0;
      local_54[2] = 0;
      local_44 = 0;
      local_40 = 0;
      uVar3 = ZwCreateSection(&local_2c,0xf0005,local_54,0,2,
                              ((local_25 != '\0') - 1 & 0xf7000000) + 0x11000000,*param_1);
      param_2 = (undefined4)((ulonglong)uVar3 >> 0x20);
      if (-1 < (int)uVar3) {
        uVar3 = ZwMapViewOfSection(local_2c,0xffffffff,&local_30,0,0,0,&local_34,2,0x500000,2);
        param_2 = (undefined4)((ulonglong)uVar3 >> 0x20);
        if (-1 < (int)uVar3) {
          param_1[1] = local_2c;
          param_1[4] = local_30;
          param_1[5] = local_34;
          param_1[2] = local_24[2];
          param_1[3] = local_24[3];
          *(char *)((int)param_1 + 0x1b) = local_25;
          *(undefined2 *)((int)param_1 + 0x19) = 0x101;
          local_2c = 0;
          local_30 = 0;
        }
      }
    }
    if (local_2c != 0) {
      ZwClose(local_2c);
      param_2 = extraout_EDX;
    }
    if (local_30 != 0) {
      ZwUnmapViewOfSection(0xffffffff,local_30);
      param_2 = extraout_EDX_00;
    }
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



int __fastcall FUN_6b86b740(undefined4 *param_1,int *param_2,uint param_3,uint param_4)

{
  uint uVar1;
  int iVar2;
  uint *puVar3;
  undefined4 uVar4;
  char *pcVar5;
  undefined4 local_10;
  int local_c;
  int *local_8;
  
  if ((param_3 | param_4) == 0) {
    return 0;
  }
  if (param_2[10] == 1) {
    iVar2 = 0;
    do {
      if (iVar2 == 0) {
        param_1[4] = param_1[4] | 1;
        param_1[2] = 0;
        param_1[3] = 0;
LAB_6b86b7c0:
        param_1[iVar2 * 6 + 1] = 4;
        param_1[iVar2 * 6] = 2;
      }
      else {
        if (iVar2 == 0x11) {
          param_1[0x6a] = param_1[0x6a] | 1;
          param_1[0x68] = 0;
          param_1[0x69] = 0;
          goto LAB_6b86b7c0;
        }
        if (iVar2 == 0x1c) {
          param_1[0xa8] = 2;
          param_1[0xa9] = 4;
          param_1[0xab] = 0;
          param_1[0xac] = param_1[0xac] | 1;
          param_1[0xaa] = 1;
        }
        else {
          param_1[iVar2 * 6 + 4] = param_1[iVar2 * 6 + 4] | 2;
        }
      }
      iVar2 = iVar2 + 1;
    } while (iVar2 < 0x21);
LAB_6b86b7cd:
    iVar2 = 0;
  }
  else {
    if (param_2[0xc] != 0) {
      iVar2 = 0;
      puVar3 = param_1 + 4;
      do {
        if ((iVar2 != 1) &&
           ((iVar2 < 0x11 ||
            (((0x13 < iVar2 && (iVar2 != 0x16)) && ((iVar2 < 0x1c || (0x1f < iVar2)))))))) {
          *puVar3 = *puVar3 | 2;
        }
        iVar2 = iVar2 + 1;
        puVar3 = puVar3 + 6;
      } while (iVar2 < 0x21);
    }
    local_8 = param_2;
    iVar2 = FUN_6b86afc1((int)param_2,(uint)param_2);
    if (iVar2 == -0x3fffffe9) {
      if (local_8[0xc] != 0) goto LAB_6b86b857;
      iVar2 = FUN_6b86e10d((int)param_1,(int)local_8);
      if (-1 < iVar2) goto LAB_6b86b864;
      pcVar5 = "AslpFileLargeEnsureLargeFileMapping failed [%x]";
      uVar4 = 0x1eb;
    }
    else {
      if (-1 < iVar2) {
LAB_6b86b864:
        local_c = 0;
        do {
          iVar2 = local_c;
          uVar1 = _aullshr();
          if (((uVar1 & 1) != 0) && ((*(byte *)(param_1 + iVar2 * 6 + 4) & 3) == 0)) {
            switch(iVar2) {
            case 0:
            case 0x20:
              iVar2 = FUN_6b86cb34(param_1,(int)(local_8 + 2));
              if (iVar2 < 0) {
                pcVar5 = "AslpFileGetSizeAttributes failed [%x]";
                uVar4 = 0x216;
                goto LAB_6b86b83f;
              }
              break;
            case 1:
            case 0x12:
            case 0x13:
            case 0x16:
            case 0x1d:
            case 0x1e:
            case 0x1f:
              iVar2 = FUN_6b86c62e((int)param_1,(int)local_8);
              if (iVar2 < 0) {
                pcVar5 = "AslpFileGetHeaderAttributesPE failed [%x]";
                uVar4 = 0x259;
                goto LAB_6b86b83f;
              }
              break;
            case 2:
            case 0x1a:
              iVar2 = FUN_6b86bd0a((int)param_1,local_8);
              if (iVar2 < 0) {
                pcVar5 = "AslpFileGetChecksumAttributes failed [%x]";
                uVar4 = 0x280;
                goto LAB_6b86b83f;
              }
              break;
            case 3:
            case 4:
            case 5:
            case 6:
            case 7:
            case 8:
            case 9:
            case 10:
            case 0xb:
            case 0xc:
            case 0xd:
            case 0xe:
            case 0xf:
            case 0x10:
            case 0x18:
              uVar1 = FUN_6b86cb7e((int)param_1,(uint)local_8);
              if (((int)uVar1 < 0) && (iVar2 = FUN_6b86754b(uVar1), iVar2 == 0)) {
                FUN_6b8671a2(1,"AslFileAllocAndGetAttributes",0x22e,
                             "AslpFileGetVersionAttributes failed [%x]");
              }
              break;
            case 0x11:
              iVar2 = FUN_6b86c8d3(&local_10,(int)local_8);
              if (iVar2 < 0) {
                pcVar5 = "AslpFileGetModuleType failed [%x]";
                uVar4 = 0x23b;
                goto LAB_6b86b83f;
              }
              param_1[0x6a] = param_1[0x6a] | 1;
              param_1[0x66] = 2;
              param_1[0x67] = 4;
              param_1[0x68] = local_10;
              param_1[0x69] = 0;
              break;
            case 0x14:
            case 0x15:
              iVar2 = FUN_6b86c4ac((int)param_1,(int)local_8);
              if (iVar2 < 0) {
                pcVar5 = "AslpFileGetHeaderAttributesNE failed [%x]";
                uVar4 = 0x276;
                goto LAB_6b86b83f;
              }
              break;
            case 0x17:
            case 0x19:
              iVar2 = FUN_6b86ca1b((int)param_1,(int)local_8);
              if (iVar2 < 0) {
                pcVar5 = "AslpFileGetPeExportNameExeWrapper failed [%x]";
                uVar4 = 0x263;
                goto LAB_6b86b83f;
              }
              break;
            case 0x1b:
              iVar2 = FUN_6b86c015((int)param_1,(int)local_8);
              if (iVar2 < 0) {
                pcVar5 = "AslpFileGetClrVersionAttribute failed [%x]";
                uVar4 = 0x26c;
                goto LAB_6b86b83f;
              }
              break;
            case 0x1c:
              iVar2 = FUN_6b86c440((int)param_1,(int)local_8);
              if (iVar2 < 0) {
                pcVar5 = "AslpFileGetFileKindDetailAttribute failed [%x]";
                uVar4 = 0x24a;
                goto LAB_6b86b83f;
              }
              break;
            default:
              return -0x3fffff1b;
            }
          }
          local_c = local_c + 1;
        } while (local_c < 0x21);
        goto LAB_6b86b7cd;
      }
LAB_6b86b857:
      pcVar5 = "AslFileMappingEnsure failed [%x]";
      uVar4 = 0x1ef;
    }
LAB_6b86b83f:
    FUN_6b8671a2(1,"AslFileAllocAndGetAttributes",uVar4,pcVar5);
  }
  return iVar2;
}



void __fastcall FUN_6b86ba91(void *param_1)

{
  int iVar1;
  int *piVar2;
  int in_FS_OFFSET;
  
  if (param_1 != (void *)0x0) {
    piVar2 = (int *)((int)param_1 + 8);
    iVar1 = 0x21;
    do {
      if (((((*(byte *)(piVar2 + 2) & 1) != 0) && (piVar2[-2] == 4)) &&
          ((*(byte *)(piVar2 + 2) & 4) != 0)) && (*piVar2 != 0)) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,*piVar2);
      }
      piVar2 = piVar2 + 6;
      iVar1 = iVar1 + -1;
    } while (iVar1 != 0);
    memset(param_1,0,0x318);
  }
  return;
}



void __fastcall FUN_6b86bae7(int *param_1,int param_2)

{
  int iVar1;
  int extraout_EDX;
  int extraout_EDX_00;
  undefined4 uVar2;
  char *pcVar3;
  undefined local_108 [256];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  if (*(int *)(param_2 + 0x28) == 5) {
    memset(local_108,0,0x100);
    iVar1 = FUN_6b86d611(local_108,param_2);
    if (iVar1 < 0) {
      pcVar3 = "AslpFileQuery16BitDescription failed [%x]";
      uVar2 = 0xd15;
    }
    else {
      iVar1 = FUN_6b869fa2(param_1,local_108);
      param_2 = extraout_EDX;
      if (-1 < iVar1) goto LAB_6b86bb77;
      pcVar3 = "AslStringAnsiToUnicode failed [%x]";
      uVar2 = 0xd1b;
    }
    FUN_6b8671a2(1,"AslpFileGet16BitDescription",uVar2,pcVar3);
    param_2 = extraout_EDX_00;
  }
  else {
    *param_1 = 0;
  }
LAB_6b86bb77:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



void __fastcall FUN_6b86bb85(int *param_1,int param_2)

{
  int iVar1;
  int extraout_EDX;
  int extraout_EDX_00;
  undefined4 uVar2;
  char *pcVar3;
  undefined local_108 [256];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  if (*(int *)(param_2 + 0x28) == 5) {
    memset(local_108,0,0x100);
    iVar1 = FUN_6b86d746(local_108,param_2);
    if (iVar1 < 0) {
      pcVar3 = "AslpFileQuery16BitModuleName failed [%x]";
      uVar2 = 0xd43;
    }
    else {
      iVar1 = FUN_6b869fa2(param_1,local_108);
      param_2 = extraout_EDX;
      if (-1 < iVar1) goto LAB_6b86bc15;
      pcVar3 = "AslStringAnsiToUnicode failed [%x]";
      uVar2 = 0xd49;
    }
    FUN_6b8671a2(1,"AslpFileGet16BitModuleName",uVar2,pcVar3);
    param_2 = extraout_EDX_00;
  }
  else {
    *param_1 = 0;
  }
LAB_6b86bc15:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 __fastcall FUN_6b86bc23(uint *param_1,int param_2)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  undefined4 *in_FS_OFFSET;
  undefined4 local_14;
  
  uVar4 = 0x1000;
  iVar2 = 0x200;
  uVar5 = 0;
  uVar3 = *(uint *)(param_2 + 8);
  if (uVar3 < 0x1000) {
    iVar2 = 0;
    uVar4 = uVar3;
  }
  else if (uVar3 < 0x1200) {
    iVar2 = uVar3 - 0x1000;
  }
  if (3 < uVar4) {
    piVar1 = (int *)(*(int *)(param_2 + 0x10) + iVar2);
    for (uVar3 = 0; uVar3 < uVar4 >> 2; uVar3 = uVar3 + 1) {
      uVar6 = uVar5 + *piVar1;
      piVar1 = piVar1 + 1;
      uVar5 = uVar6 >> 1;
      if ((uVar6 & 1) != 0) {
        uVar5 = uVar5 | 0x80000000;
      }
    }
  }
  *param_1 = uVar5;
  *in_FS_OFFSET = local_14;
  return 0;
}



int __fastcall FUN_6b86bd0a(int param_1,int *param_2)

{
  uint uVar1;
  int iVar2;
  uint extraout_EDX;
  int *piVar3;
  undefined4 uVar4;
  char *pcVar5;
  int local_2c [8];
  int *local_c;
  uint local_8;
  
  piVar3 = local_2c;
  local_c = param_2;
  for (iVar2 = 8; iVar2 != 0; iVar2 = iVar2 + -1) {
    *piVar3 = 0;
    piVar3 = piVar3 + 1;
  }
  if (param_2[0xd] != 0) {
    FUN_6b8671a2(1,"AslpFileGetChecksumAttributes",0xe01,
                 "AslpFileGetChecksumAttributes called with a partial view which is not supported");
    iVar2 = -0x3fffffff;
    *(uint *)(param_1 + 0x40) = *(uint *)(param_1 + 0x40) | 2;
    *(uint *)(param_1 + 0x280) = *(uint *)(param_1 + 0x280) | 2;
    goto LAB_6b86be4c;
  }
  iVar2 = FUN_6b86b052((int)param_2,(uint)param_2);
  if ((iVar2 < 0) && (iVar2 != -0x3ffffef2)) {
    pcVar5 = "AslFileMappingEnsureMappedAs failed [%x]";
    uVar4 = 0xe0f;
  }
  else {
    local_c = local_c + 2;
    if (iVar2 == -0x3ffffef2) {
      local_2c[0] = *local_c;
      iVar2 = FUN_6b86b601(local_2c,extraout_EDX & 0xffffff00);
      if (iVar2 < 0) {
        pcVar5 = "RtlFileMapMapView failed [%x]";
        uVar4 = 0xe21;
        goto LAB_6b86bd79;
      }
      local_c = local_2c;
    }
    local_8 = 0;
    iVar2 = FUN_6b86bc23(&local_8,(int)local_c);
    uVar1 = local_8;
    if (iVar2 < 0) {
      pcVar5 = "AslpFileGetChecksum failed [%x]";
      uVar4 = 0xe31;
    }
    else {
      *(undefined4 *)(param_1 + 0x3c) = 0;
      *(uint *)(param_1 + 0x40) = *(uint *)(param_1 + 0x40) | 1;
      local_8 = 0;
      *(undefined4 *)(param_1 + 0x30) = 2;
      *(undefined4 *)(param_1 + 0x34) = 4;
      *(uint *)(param_1 + 0x38) = uVar1;
      iVar2 = FUN_6b86c18d(&local_8,(int)local_c);
      if (-1 < iVar2) {
        *(undefined4 *)(param_1 + 0x27c) = 0;
        *(uint *)(param_1 + 0x280) = *(uint *)(param_1 + 0x280) | 1;
        iVar2 = 0;
        *(undefined4 *)(param_1 + 0x270) = 2;
        *(undefined4 *)(param_1 + 0x274) = 4;
        *(uint *)(param_1 + 0x278) = local_8;
        goto LAB_6b86be4c;
      }
      pcVar5 = "AslpFileGetCrcChecksum failed [%x]";
      uVar4 = 0xe42;
    }
  }
LAB_6b86bd79:
  FUN_6b8671a2(1,"AslpFileGetChecksumAttributes",uVar4,pcVar5);
LAB_6b86be4c:
  FUN_6b86b52e(local_2c);
  return iVar2;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

int __fastcall FUN_6b86be5b(undefined *param_1,int param_2)

{
  size_t _Size;
  int iVar1;
  int iVar2;
  int *piVar3;
  uint *puVar4;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar5;
  char *pcVar6;
  int local_24;
  int local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b8928a0;
  uStack12 = 0x6b86be67;
  local_24 = 0;
  puVar4 = (uint *)0x0;
  *param_1 = 0;
  iVar2 = FUN_6b86c7fe(&local_24,param_2);
  iVar1 = local_24;
  local_20 = iVar2;
  if (iVar2 < 0) {
    FUN_6b8671a2(1,"AslpFileGetClrVersion",0x1033,"AslpFileGetImageNtHeader failed [%x]");
    goto LAB_6b86c003;
  }
  local_8 = (undefined *)0x0;
  if (*(short *)(local_24 + 0x18) == 0x10b) {
    puVar4 = (uint *)(local_24 + 0xe8);
  }
  else if (*(short *)(local_24 + 0x18) == 0x20b) {
    puVar4 = (uint *)(local_24 + 0xf8);
  }
  if (((puVar4 == (uint *)0x0) || (*puVar4 == 0)) || (puVar4[1] < 0x48)) {
    iVar2 = -0x3fffff85;
    goto LAB_6b86c003;
  }
  iVar2 = FUN_6b86e02c(local_24,param_2 + 8,*puVar4);
  if (iVar2 == 0) {
    pcVar6 = "Invalid COM Descriptor virtual address encountered";
    uVar5 = 0x1050;
    goto LAB_6b86bf14;
  }
  if (*(short *)(iVar2 + 4) != 2) {
    iVar2 = -0x3fffff45;
    goto LAB_6b86c003;
  }
  piVar3 = (int *)FUN_6b86e02c(iVar1,param_2 + 8,*(uint *)(iVar2 + 8));
  if (piVar3 == (int *)0x0) {
    pcVar6 = "Invalid COR20 Metadata virtual address encountered";
    uVar5 = 0x1064;
LAB_6b86bf14:
    iVar2 = -0x3fffff85;
  }
  else {
    if (*piVar3 == 0x424a5342) {
      _Size = piVar3[3];
      if (_Size - 1 < 0xff) {
        memcpy(param_1,piVar3 + 4,_Size);
        param_1[_Size] = 0;
        iVar2 = 0;
        goto LAB_6b86c003;
      }
      pcVar6 = "CLR version string null or too long";
      uVar5 = 0x107a;
      goto LAB_6b86bf14;
    }
    iVar2 = -0x3fffff45;
    pcVar6 = "Invalid COR20 Metadata signature encountered";
    uVar5 = 0x106e;
  }
  local_20 = iVar2;
  FUN_6b8671a2(1,"AslpFileGetClrVersion",uVar5,pcVar6);
LAB_6b86c003:
  *in_FS_OFFSET = local_14;
  return iVar2;
}



void __fastcall FUN_6b86c015(int param_1,int param_2)

{
  short sVar1;
  int iVar2;
  int iVar3;
  uint extraout_EDX;
  int extraout_EDX_00;
  int extraout_EDX_01;
  int extraout_EDX_02;
  short *psVar4;
  undefined4 uVar5;
  char *pcVar6;
  short *local_110;
  undefined local_10c [260];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  memset(local_10c,0,0x100);
  local_110 = (short *)0x0;
  iVar2 = FUN_6b86afc1(param_2,extraout_EDX);
  if (iVar2 < 0) {
    pcVar6 = "AslFileMappingEnsure failed [%x]";
    uVar5 = 0xfd5;
LAB_6b86c066:
    FUN_6b8671a2(1,"AslpFileGetClrVersionAttribute",uVar5,pcVar6);
    iVar2 = extraout_EDX_01;
  }
  else {
    iVar2 = extraout_EDX_00;
    if (*(int *)(param_2 + 0x28) == 6) {
      if ((*(byte *)(param_1 + 0x2b0) & 1) == 0) {
        iVar3 = FUN_6b86c440(param_1,param_2);
        iVar2 = extraout_EDX_02;
        if (iVar3 < 0) {
          pcVar6 = "AslpFileGetFileKindDetailAttribute failed [%x]";
          uVar5 = 0xfe6;
          goto LAB_6b86c066;
        }
      }
      iVar3 = *(int *)(param_1 + 0x2a8);
      if ((((iVar3 == 0xc) || (iVar3 == 0xd)) || (iVar3 == 0xe)) || (iVar3 == 0xf)) {
        iVar2 = FUN_6b86be5b(local_10c,param_2);
        if (iVar2 < 0) {
          pcVar6 = "AslpFileGetClrVersion failed [%x]";
          uVar5 = 0xff9;
        }
        else {
          iVar2 = FUN_6b869fa2((int *)&local_110,local_10c);
          if (iVar2 < 0) {
            pcVar6 = "AslStringAnsiToUnicode failed [%x]";
            uVar5 = 0xfff;
          }
          else {
            iVar2 = FUN_6b86a272(local_110);
            if (-1 < iVar2) {
              *(undefined4 *)(param_1 + 0x288) = 4;
              psVar4 = local_110;
              do {
                sVar1 = *psVar4;
                psVar4 = psVar4 + 1;
              } while (sVar1 != 0);
              *(uint *)(param_1 + 0x298) = *(uint *)(param_1 + 0x298) | 5;
              *(int *)(param_1 + 0x28c) = (int)psVar4 - (int)(local_110 + 1) >> 1;
              iVar2 = (int)local_110 >> 0x1f;
              *(short **)(param_1 + 0x290) = local_110;
              *(int *)(param_1 + 0x294) = iVar2;
              goto LAB_6b86c17c;
            }
            pcVar6 = "AslStringXmlSanitize failed [%x]";
            uVar5 = 0x1005;
          }
        }
        goto LAB_6b86c066;
      }
    }
    *(uint *)(param_1 + 0x298) = *(uint *)(param_1 + 0x298) | 2;
  }
LAB_6b86c17c:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,iVar2);
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 __fastcall FUN_6b86c18d(uint *param_1,int param_2)

{
  uint uVar1;
  uint uVar2;
  int extraout_EDX;
  int iVar3;
  undefined4 *in_FS_OFFSET;
  undefined4 local_14;
  
  if ((*(int *)(param_2 + 0xc) == 0) && (*(uint *)(param_2 + 8) < 0x2000)) {
    uVar1 = *(uint *)(param_2 + 0x14);
    iVar3 = *(int *)(param_2 + 0x10);
    uVar2 = 0;
  }
  else {
    uVar1 = 0x1000;
    iVar3 = *(int *)(param_2 + 8);
    uVar2 = FUN_6b8671cf(0,*(int *)(param_2 + 0x10),0x1000);
    iVar3 = extraout_EDX + -0x1000 + iVar3;
  }
  uVar1 = FUN_6b8671cf(uVar2,iVar3,uVar1);
  *param_1 = uVar1;
  *in_FS_OFFSET = local_14;
  return 0;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

int __fastcall FUN_6b86c243(undefined4 *param_1,int param_2)

{
  int iVar1;
  undefined4 *in_FS_OFFSET;
  int local_28;
  int local_24;
  int *local_20 [3];
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b892980;
  uStack12 = 0x6b86c24f;
  *param_1 = 0;
  local_20[0] = (int *)0x0;
  if (*(int *)(param_2 + 0x14) == 0) {
    iVar1 = FUN_6b86c7fe((int *)local_20,param_2);
    local_24 = iVar1;
    if (iVar1 < 0) {
      FUN_6b8671a2(1,"AslpFileGetExeWrapper",0xb4b,"AslpFileGetImageNtHeader failed [%x]");
    }
    else {
      local_8 = (undefined *)0x0;
      iVar1 = FUN_6b86d2dc((int)local_20[0]);
      if (iVar1 == 0) {
        iVar1 = FUN_6b86d133(&local_28,(int)local_20[0],param_2);
        local_24 = iVar1;
        if (iVar1 < 0) {
          if (iVar1 == -0x3ffffddb) {
            FUN_6b8671a2(2,"AslpFileGetExeWrapper",0xb64,
                         "AslpFileHasActiveMarkWrapper failed (FileSize: %I64u) [%x]");
          }
          else {
            FUN_6b8671a2(1,"AslpFileGetExeWrapper",0xb66,"AslpFileHasActiveMarkWrapper failed [%x]")
            ;
          }
          goto LAB_6b86c38e;
        }
        if (local_28 == 0) {
          iVar1 = FUN_6b86d2c1(local_20[0]);
          if (iVar1 == 0) {
            iVar1 = FUN_6b86df97((int)local_20[0]);
            if (iVar1 != 0) {
              *param_1 = 4;
            }
          }
          else {
            *param_1 = 3;
          }
        }
        else {
          *param_1 = 2;
        }
      }
      else {
        *param_1 = 1;
      }
      iVar1 = 0;
    }
  }
  else {
    iVar1 = 0;
  }
LAB_6b86c38e:
  *in_FS_OFFSET = local_14;
  return iVar1;
}



void __fastcall FUN_6b86c39e(int *param_1,int param_2)

{
  int iVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 uVar2;
  char *pcVar3;
  char local_108 [256];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  memset(local_108,0,0x100);
  iVar1 = FUN_6b86d869(local_108,param_2);
  if (iVar1 < 0) {
    uVar2 = extraout_EDX;
    if ((iVar1 == -0x3ffffddb) || (iVar1 == -0x3fffff85)) goto LAB_6b86c430;
    pcVar3 = "AslpFileQueryExportName failed [%x]";
    uVar2 = 0xc81;
  }
  else {
    iVar1 = FUN_6b869fa2(param_1,local_108);
    uVar2 = extraout_EDX_01;
    if (-1 < iVar1) goto LAB_6b86c430;
    pcVar3 = "AslStringAnsiToUnicode failed [%x]";
    uVar2 = 0xc88;
  }
  FUN_6b8671a2(1,"AslpFileGetExportName",uVar2,pcVar3);
  uVar2 = extraout_EDX_00;
LAB_6b86c430:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



int __fastcall FUN_6b86c440(int param_1,int param_2)

{
  int iVar1;
  int local_8;
  
  local_8 = 0;
  iVar1 = FUN_6b86b0e4(&local_8,param_2);
  if (iVar1 < 0) {
    FUN_6b8671a2(1,"AslpFileGetFileKindDetailAttribute",0x10b4,
                 "AslFileMappingGetFileKindDetails failed [%x]");
  }
  else {
    *(uint *)(param_1 + 0x2b0) = *(uint *)(param_1 + 0x2b0) | 1;
    iVar1 = 0;
    *(undefined4 *)(param_1 + 0x2a0) = 2;
    *(undefined4 *)(param_1 + 0x2a4) = 4;
    *(int *)(param_1 + 0x2a8) = local_8;
    *(int *)(param_1 + 0x2ac) = local_8 >> 0x1f;
  }
  return iVar1;
}



int __fastcall FUN_6b86c4ac(int param_1,int param_2)

{
  short sVar1;
  int iVar2;
  short *psVar3;
  undefined4 uVar4;
  char *pcVar5;
  short *local_c;
  short *local_8;
  
  local_8 = (short *)0x0;
  local_c = (short *)0x0;
  iVar2 = FUN_6b86afc1(param_2,param_2);
  if (iVar2 < 0) {
    pcVar5 = "AslFileMappingEnsure failed [%x]";
    uVar4 = 0xa22;
  }
  else {
    if (*(int *)(param_2 + 0x28) != 5) {
      *(uint *)(param_1 + 0x1f0) = *(uint *)(param_1 + 0x1f0) | 2;
      *(uint *)(param_1 + 0x208) = *(uint *)(param_1 + 0x208) | 2;
      return 0;
    }
    *(uint *)(param_1 + 0x1c0) = *(uint *)(param_1 + 0x1c0) | 2;
    *(uint *)(param_1 + 0x1d8) = *(uint *)(param_1 + 0x1d8) | 2;
    *(uint *)(param_1 + 0x220) = *(uint *)(param_1 + 0x220) | 2;
    *(uint *)(param_1 + 0x28) = *(uint *)(param_1 + 0x28) | 2;
    *(uint *)(param_1 + 0x268) = *(uint *)(param_1 + 0x268) | 2;
    *(uint *)(param_1 + 0x238) = *(uint *)(param_1 + 0x238) | 2;
    *(uint *)(param_1 + 0x2c8) = *(uint *)(param_1 + 0x2c8) | 2;
    *(uint *)(param_1 + 0x2e0) = *(uint *)(param_1 + 0x2e0) | 2;
    *(uint *)(param_1 + 0x2f8) = *(uint *)(param_1 + 0x2f8) | 2;
    iVar2 = FUN_6b86bae7((int *)&local_8,param_2);
    if (iVar2 < 0) {
      *(uint *)(param_1 + 0x1f0) = *(uint *)(param_1 + 0x1f0) | 2;
    }
    else {
      iVar2 = FUN_6b86a272(local_8);
      if (iVar2 < 0) {
        pcVar5 = "AslStringXmlSanitize failed [%x]";
        uVar4 = 0xa45;
        goto LAB_6b86c4de;
      }
      *(undefined4 *)(param_1 + 0x1e0) = 4;
      psVar3 = local_8;
      do {
        sVar1 = *psVar3;
        psVar3 = psVar3 + 1;
      } while (sVar1 != 0);
      *(uint *)(param_1 + 0x1f0) = *(uint *)(param_1 + 0x1f0) | 5;
      *(int *)(param_1 + 0x1e4) = (int)psVar3 - (int)(local_8 + 1) >> 1;
      *(short **)(param_1 + 0x1e8) = local_8;
      *(int *)(param_1 + 0x1ec) = (int)local_8 >> 0x1f;
    }
    iVar2 = FUN_6b86bb85((int *)&local_c,param_2);
    if (iVar2 < 0) {
      *(uint *)(param_1 + 0x208) = *(uint *)(param_1 + 0x208) | 2;
      return 0;
    }
    iVar2 = FUN_6b86a272(local_c);
    if (-1 < iVar2) {
      *(undefined4 *)(param_1 + 0x1f8) = 4;
      psVar3 = local_c;
      do {
        sVar1 = *psVar3;
        psVar3 = psVar3 + 1;
      } while (sVar1 != 0);
      *(uint *)(param_1 + 0x208) = *(uint *)(param_1 + 0x208) | 5;
      *(int *)(param_1 + 0x1fc) = (int)psVar3 - (int)(local_c + 1) >> 1;
      *(short **)(param_1 + 0x200) = local_c;
      *(int *)(param_1 + 0x204) = (int)local_c >> 0x1f;
      return 0;
    }
    pcVar5 = "AslStringXmlSanitize failed [%x]";
    uVar4 = 0xa5a;
  }
LAB_6b86c4de:
  FUN_6b8671a2(1,"AslpFileGetHeaderAttributesNE",uVar4,pcVar5);
  return iVar2;
}



int __fastcall FUN_6b86c62e(int param_1,int param_2)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  undefined4 local_20;
  undefined4 local_1c;
  int local_18;
  undefined4 local_14;
  ushort local_10 [2];
  ushort local_c [2];
  ushort local_8 [2];
  
  local_14 = 0;
  local_18 = 0;
  local_1c = 0;
  local_20 = 0;
  iVar1 = FUN_6b86afc1(param_2,param_2);
  if (iVar1 < 0) {
    FUN_6b8671a2(1,"AslpFileGetHeaderAttributesPE",0x9aa,"AslFileMappingEnsure failed [%x]");
  }
  else {
    uVar3 = 2;
    if (*(int *)(param_2 + 0x28) == 6) {
      *(uint *)(param_1 + 0x1f0) = *(uint *)(param_1 + 0x1f0) | 2;
      *(uint *)(param_1 + 0x208) = *(uint *)(param_1 + 0x208) | 2;
      iVar1 = FUN_6b86c903(&local_14,&local_18,&local_1c,&local_20,local_8,local_c,(short *)local_10
                           ,param_2);
      uVar2 = *(uint *)(param_1 + 0x2f8);
      if (iVar1 < 0) {
        *(uint *)(param_1 + 0x1c0) = *(uint *)(param_1 + 0x1c0) | 2;
        *(uint *)(param_1 + 0x1d8) = *(uint *)(param_1 + 0x1d8) | 2;
        *(uint *)(param_1 + 0x220) = *(uint *)(param_1 + 0x220) | 2;
        *(uint *)(param_1 + 0x28) = *(uint *)(param_1 + 0x28) | 2;
        *(uint *)(param_1 + 0x2c8) = *(uint *)(param_1 + 0x2c8) | 2;
      }
      else {
        *(undefined4 *)(param_1 + 0x1bc) = 0;
        uVar3 = 1;
        *(uint *)(param_1 + 0x1c0) = *(uint *)(param_1 + 0x1c0) | 1;
        *(undefined4 *)(param_1 + 0x1d4) = 0;
        *(uint *)(param_1 + 0x1d8) = *(uint *)(param_1 + 0x1d8) | 1;
        *(undefined4 *)(param_1 + 0x21c) = 0;
        *(uint *)(param_1 + 0x220) = *(uint *)(param_1 + 0x220) | 1;
        *(undefined4 *)(param_1 + 0x24) = 0;
        *(uint *)(param_1 + 0x28) = *(uint *)(param_1 + 0x28) | 1;
        *(uint *)(param_1 + 0x2c8) = *(uint *)(param_1 + 0x2c8) | 1;
        *(undefined4 *)(param_1 + 0x1b8) = local_14;
        *(int *)(param_1 + 0x1d0) = local_18;
        *(undefined4 *)(param_1 + 0x218) = local_1c;
        *(undefined4 *)(param_1 + 0x20) = local_20;
        *(undefined4 *)(param_1 + 0x1b4) = 4;
        *(undefined4 *)(param_1 + 0x1cc) = 4;
        *(undefined4 *)(param_1 + 0x214) = 4;
        *(undefined4 *)(param_1 + 0x1c) = 4;
        *(uint *)(param_1 + 0x2c0) = (uint)local_8[0];
        *(undefined4 *)(param_1 + 0x2c4) = 0;
        *(uint *)(param_1 + 0x2d8) = (uint)local_c[0];
        *(undefined4 *)(param_1 + 0x2dc) = 0;
        *(undefined4 *)(param_1 + 0x2f4) = 0;
        uVar2 = *(uint *)(param_1 + 0x2f8);
        *(undefined4 *)(param_1 + 0x1b0) = 2;
        *(undefined4 *)(param_1 + 0x1c8) = 2;
        *(undefined4 *)(param_1 + 0x210) = 2;
        *(undefined4 *)(param_1 + 0x18) = 2;
        *(undefined4 *)(param_1 + 0x2b8) = 1;
        *(undefined4 *)(param_1 + 700) = 2;
        *(undefined4 *)(param_1 + 0x2d0) = 1;
        *(undefined4 *)(param_1 + 0x2d4) = 2;
        *(undefined4 *)(param_1 + 0x2e8) = 1;
        *(undefined4 *)(param_1 + 0x2ec) = 2;
        *(uint *)(param_1 + 0x2f0) = (uint)local_10[0];
      }
      *(uint *)(param_1 + 0x2e0) = *(uint *)(param_1 + 0x2e0) | uVar3;
      *(uint *)(param_1 + 0x2f8) = uVar2 | uVar3;
    }
    else {
      *(uint *)(param_1 + 0x1c0) = *(uint *)(param_1 + 0x1c0) | 2;
      *(uint *)(param_1 + 0x1d8) = *(uint *)(param_1 + 0x1d8) | 2;
      *(uint *)(param_1 + 0x220) = *(uint *)(param_1 + 0x220) | 2;
      *(uint *)(param_1 + 0x28) = *(uint *)(param_1 + 0x28) | 2;
      *(uint *)(param_1 + 0x2f8) = *(uint *)(param_1 + 0x2f8) | 2;
      *(uint *)(param_1 + 0x2c8) = *(uint *)(param_1 + 0x2c8) | 2;
      *(uint *)(param_1 + 0x2e0) = *(uint *)(param_1 + 0x2e0) | 2;
    }
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 __fastcall FUN_6b86c7fe(int *param_1,int param_2)

{
  int iVar1;
  uint uVar2;
  undefined4 uVar3;
  undefined4 *in_FS_OFFSET;
  undefined4 local_14;
  
  if (*(int *)(param_2 + 0x28) == 6) {
    uVar3 = 0;
    iVar1 = *(int *)(*(int *)(param_2 + 0x18) + 0x3c);
    uVar2 = iVar1 + 0xf8;
    if (((*(int *)(param_2 + 0x14) == 0) && (*(uint *)(param_2 + 0x10) < uVar2)) ||
       (*(uint *)(param_2 + 0x1c) < uVar2)) {
      uVar3 = 0xc000007b;
      FUN_6b8671a2(1,"AslpFileGetImageNtHeader",0xb17,"File mapping invalid [%x]");
    }
    else {
      *param_1 = *(int *)(param_2 + 0x18) + iVar1;
    }
  }
  else {
    uVar3 = 0xc00000bb;
    FUN_6b8671a2(1,"AslpFileGetImageNtHeader",0xb0b,"File mapping not a PE [%x]");
  }
  *in_FS_OFFSET = local_14;
  return uVar3;
}



undefined4 __fastcall FUN_6b86c8d3(undefined4 *param_1,int param_2)

{
  int iVar1;
  
  iVar1 = *(int *)(param_2 + 0x28);
  if (iVar1 == 4) {
    *param_1 = 1;
  }
  else if (iVar1 == 5) {
    *param_1 = 2;
  }
  else if (iVar1 == 6) {
    *param_1 = 3;
  }
  else {
    *param_1 = 0;
  }
  return 0;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

int __fastcall
FUN_6b86c903(undefined4 *param_1,int *param_2,undefined4 *param_3,undefined4 *param_4,
            undefined2 *param_5,undefined2 *param_6,short *param_7,int param_8)

{
  short sVar1;
  int iVar2;
  undefined2 uVar3;
  undefined4 *in_FS_OFFSET;
  int local_24;
  int local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b8929a0;
  uStack12 = 0x6b86c90f;
  iVar2 = FUN_6b86c7fe(&local_24,param_8);
  if (iVar2 < 0) {
    local_20 = iVar2;
    FUN_6b8671a2(1,"AslpFileGetNtHeaderAttributes",0xaa5,"AslpFileGetImageNtHeader failed [%x]");
  }
  else {
    iVar2 = 0;
    *param_2 = (uint)(byte)*(undefined2 *)(local_24 + 0x44) * 0x10000 +
               (uint)(byte)*(undefined2 *)(local_24 + 0x46);
    *param_3 = *(undefined4 *)(local_24 + 8);
    sVar1 = *(short *)(local_24 + 0x18);
    *param_7 = sVar1;
    *param_5 = *(undefined2 *)(local_24 + 4);
    if ((sVar1 == 0x10b) || (sVar1 == 0x20b)) {
      *param_1 = *(undefined4 *)(local_24 + 0x58);
      *param_4 = *(undefined4 *)(local_24 + 0x50);
      uVar3 = *(undefined2 *)(local_24 + 0x5c);
    }
    else {
      *param_1 = 0;
      *param_4 = 0;
      uVar3 = 0;
      iVar2 = -0x3fffff45;
    }
    *param_6 = uVar3;
  }
  *in_FS_OFFSET = local_14;
  return iVar2;
}



int __fastcall FUN_6b86ca1b(int param_1,int param_2)

{
  short sVar1;
  int iVar2;
  uint uVar3;
  short *psVar4;
  undefined4 uVar5;
  char *pcVar6;
  undefined4 local_c;
  short *local_8;
  
  local_c = 0;
  local_8 = (short *)0x0;
  iVar2 = FUN_6b86afc1(param_2,param_2);
  if (iVar2 < 0) {
    pcVar6 = "AslFileMappingEnsure failed [%x]";
    uVar5 = 0x94e;
  }
  else {
    if (*(int *)(param_2 + 0x28) != 6) {
      *(uint *)(param_1 + 0x268) = *(uint *)(param_1 + 0x268) | 2;
      *(uint *)(param_1 + 0x238) = *(uint *)(param_1 + 0x238) | 2;
      return 0;
    }
    iVar2 = FUN_6b86c243(&local_c,param_2);
    if (iVar2 < 0) {
      uVar3 = 2;
    }
    else {
      *(undefined4 *)(param_1 + 0x260) = local_c;
      *(undefined4 *)(param_1 + 600) = 2;
      uVar3 = 1;
      *(undefined4 *)(param_1 + 0x25c) = 4;
      *(undefined4 *)(param_1 + 0x264) = 0;
    }
    *(uint *)(param_1 + 0x268) = *(uint *)(param_1 + 0x268) | uVar3;
    iVar2 = FUN_6b86c39e((int *)&local_8,param_2);
    if (iVar2 < 0) {
      *(uint *)(param_1 + 0x238) = *(uint *)(param_1 + 0x238) | 2;
      return 0;
    }
    iVar2 = FUN_6b86a272(local_8);
    if (-1 < iVar2) {
      *(undefined4 *)(param_1 + 0x228) = 4;
      psVar4 = local_8;
      do {
        sVar1 = *psVar4;
        psVar4 = psVar4 + 1;
      } while (sVar1 != 0);
      *(uint *)(param_1 + 0x238) = *(uint *)(param_1 + 0x238) | 5;
      *(int *)(param_1 + 0x22c) = (int)psVar4 - (int)(local_8 + 1) >> 1;
      *(short **)(param_1 + 0x230) = local_8;
      *(int *)(param_1 + 0x234) = (int)local_8 >> 0x1f;
      return 0;
    }
    pcVar6 = "AslStringXmlSanitize failed [%x]";
    uVar5 = 0x971;
  }
  FUN_6b8671a2(1,"AslpFileGetPeExportNameExeWrapper",uVar5,pcVar6);
  return iVar2;
}



undefined4 __fastcall FUN_6b86cb34(undefined4 *param_1,int param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  uVar1 = *(undefined4 *)(param_2 + 0xc);
  uVar2 = *(undefined4 *)(param_2 + 8);
  param_1[0xc4] = param_1[0xc4] | 1;
  param_1[3] = 0;
  param_1[4] = param_1[4] | 1;
  param_1[0xc2] = uVar2;
  param_1[0xc3] = uVar1;
  param_1[2] = uVar2;
  param_1[0xc0] = 3;
  param_1[0xc1] = 8;
  *param_1 = 2;
  param_1[1] = 4;
  return 0;
}



uint __fastcall FUN_6b86cb7e(int param_1,uint param_2)

{
  int iVar1;
  uint uVar2;
  ushort *puVar3;
  ushort *puVar4;
  ushort *local_c;
  ushort *local_8;
  
  local_8 = (ushort *)0x0;
  local_c = (ushort *)0x0;
  iVar1 = FUN_6b86cc0c(&local_8,&local_c,param_2);
  puVar3 = local_c;
  puVar4 = local_8;
  if (iVar1 < 0) {
    iVar1 = FUN_6b86754b(iVar1);
    if (iVar1 == 0) {
      FUN_6b8671a2(3,"AslpFileGetVersionAttributes",0x4cb,"AslpFileGetVersionBlock failed [%x]");
    }
    puVar3 = (ushort *)0x0;
    puVar4 = (ushort *)0x0;
  }
  FUN_6b86d337(param_1,(int)puVar3);
  uVar2 = FUN_6b86d42b(param_1,puVar4);
  if ((int)uVar2 < 0) {
    FUN_6b8671a2(1,"AslpFileGetVersionAttributes",0x4e2,
                 "AslpFileMakeStringVersionAttributes failed [%x]");
  }
  else {
    uVar2 = 0;
  }
  return uVar2;
}



// WARNING: Function: __SEH_prolog4_GS replaced with injection: SEH_prolog4

int __fastcall FUN_6b86cc0c(undefined4 *param_1,ushort **param_2,uint param_3)

{
  uint uVar1;
  void *pvVar2;
  int iVar3;
  ushort *_Dst;
  int iVar4;
  undefined4 uVar5;
  int *piVar6;
  undefined4 *in_FS_OFFSET;
  undefined8 uVar7;
  char *pcVar8;
  int local_1a8 [4];
  void *local_198;
  int local_194;
  undefined local_190;
  uint local_188;
  undefined4 *local_17c;
  int local_178;
  void *local_174;
  ushort **local_170;
  int local_16c;
  void *local_168;
  uint local_164;
  ushort *local_160;
  void *local_15c;
  uint local_158;
  uint local_154;
  undefined4 local_150;
  undefined4 local_14c;
  undefined4 local_148;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b8929c0;
  uStack12 = 0x6b86cc1b;
  local_164 = param_3;
  local_188 = param_3;
  local_15c = (void *)0x0;
  local_160 = (ushort *)0x0;
  local_158 = 0;
  piVar6 = local_1a8;
  local_17c = param_1;
  local_170 = param_2;
  for (iVar4 = 8; uVar1 = local_164, iVar4 != 0; iVar4 = iVar4 + -1) {
    *piVar6 = 0;
    piVar6 = piVar6 + 1;
  }
  iVar4 = *(int *)(local_164 + 0x2c);
  if (iVar4 != 0) {
    *param_2 = (ushort *)(~-(uint)(*(ushort *)(iVar4 + 2) < 0x34) & iVar4 + 0x28U);
    *param_1 = *(undefined4 *)(local_164 + 0x2c);
    iVar4 = 0;
    local_154 = iVar4;
    goto LAB_6b86d0ef;
  }
  iVar4 = FUN_6b86afc1(local_164,(uint)param_2);
  local_154 = iVar4;
  if (iVar4 < 0) {
    FUN_6b8671a2(1,"AslpFileGetVersionBlock",0x530,"AslFileMappingEnsure failed [%x]");
    goto LAB_6b86d0ef;
  }
  if (*(int *)(uVar1 + 0x28) != 6) {
    iVar4 = -0x3fffff77;
    local_154 = iVar4;
    goto LAB_6b86d0ef;
  }
  local_8 = (undefined *)0x0;
  local_30 = 0x10;
  local_2c = 1;
  local_28 = 0;
  local_174 = *(void **)(uVar1 + 0x18);
  local_178 = *(int *)(uVar1 + 0x1c);
  uVar5 = 0;
  if (*(char *)(uVar1 + 0x23) == '\0') {
    uVar5 = 0x200;
  }
  local_16c = local_178;
  local_168 = local_174;
  iVar4 = LdrResSearchResource(local_174,&local_30,3,uVar5,&local_15c,&local_158,0,0);
  local_154 = iVar4;
  if (iVar4 < 0) {
    iVar3 = FUN_6b86754b(iVar4);
    if (iVar3 == 0) {
      if (((iVar4 == -0x3fffff85) && (*(char *)(uVar1 + 0x23) == '\0')) &&
         (*(int *)(uVar1 + 0x34) == 0)) {
        memset(&local_150,0,0x11c);
        local_150 = 0x11c;
        local_14c = 6;
        local_148 = 2;
        uVar7 = VerSetConditionMask(0,0,2,3);
        uVar7 = VerSetConditionMask(uVar7,1,3);
        uVar7 = RtlVerifyVersionInfo(&local_150,3,uVar7);
        if ((int)uVar7 < 0) goto LAB_6b86cdc2;
        local_1a8[0] = *(int *)(uVar1 + 8);
        local_190 = 0;
        local_154 = 0;
        iVar4 = FUN_6b86b601(local_1a8,CONCAT31((int3)((ulonglong)uVar7 >> 0x28),1));
        local_154 = iVar4;
        if (iVar4 < 0) {
          pcVar8 = "RtlFileMapMapView failed [%x]";
          uVar5 = 0x58c;
        }
        else {
          FUN_6b8671a2(3,"AslpFileGetVersionBlock",0x595,
                       "Re-mapped file as image to get version block: %ls");
          local_168 = local_198;
          iVar4 = LdrResSearchResource(local_198,&local_30,3,0,&local_15c,&local_158,0,0);
          local_154 = iVar4;
          FUN_6b8671a2(2,"AslpFileGetVersionBlock",0x5a2,
                       "%ls version block after re-mapping as image [%x]");
          if (-1 < iVar4) {
            local_174 = local_168;
            local_16c = local_194;
            local_178 = local_194;
            goto LAB_6b86cec7;
          }
          pcVar8 = "LdrResFindResource failed [%x]";
          uVar5 = 0x5a5;
        }
        FUN_6b8671a2(1,"AslpFileGetVersionBlock",uVar5,pcVar8);
      }
      else {
        FUN_6b8671a2(1,"AslpFileGetVersionBlock",0x5ad,"LdrResFindResource failed %ls [%x]");
      }
    }
  }
  else {
LAB_6b86cec7:
    pvVar2 = local_15c;
    if (local_15c == (void *)0x0) {
      FUN_6b8671a2(1,"AslpFileGetVersionBlock",0x5b4,
                   "LdrResFindResource returned null version block with status: [%x]");
LAB_6b86cdc2:
      iVar4 = -0x3fffff77;
      local_154 = -0x3fffff77;
    }
    else {
      local_154 = FUN_6b867d76((uint)local_15c,local_158,&local_164);
      if ((int)local_154 < 0) {
        pcVar8 = "Version block has bad size";
        uVar5 = 0x5c2;
LAB_6b86d06b:
        iVar4 = -0x3fffff77;
      }
      else {
        if ((pvVar2 < local_168) || ((uint)(local_16c + (int)local_168) < local_164)) {
          pcVar8 = "Version block out of range";
          uVar5 = 0x5ce;
          goto LAB_6b86d06b;
        }
        if (((*(char *)(uVar1 + 0x23) == '\0') && (local_1a8[1] == 0)) &&
           ((*(int *)(uVar1 + 0x14) + (uint)CARRY4((uint)local_168,*(uint *)(uVar1 + 0x10)) == 0 &&
            ((int)local_168 + *(uint *)(uVar1 + 0x10) < local_164)))) {
          pcVar8 = "Version block out of range";
          uVar5 = 0x5e0;
          goto LAB_6b86d06b;
        }
        if ((local_158 < 0x26) ||
           (iVar4 = _wcsicmp((wchar_t *)((int)pvVar2 + 6),L"VS_VERSION_INFO"), iVar4 != 0)) {
          iVar4 = -0x3fffff1b;
          pcVar8 = "Version block invalid";
          uVar5 = 0x5eb;
        }
        else {
          local_16c = *(int *)(in_FS_OFFSET[0xc] + 0x18);
          _Dst = (ushort *)RtlAllocateHeap(local_16c,8,local_158);
          local_160 = _Dst;
          if (_Dst != (ushort *)0x0) {
            memmove(_Dst,local_15c,local_158);
            if (local_158 < *_Dst) {
              *_Dst = (ushort)local_158;
            }
            *(ushort **)(uVar1 + 0x2c) = _Dst;
            local_160 = (ushort *)0x0;
            if (_Dst[1] < 0x34) {
              *local_170 = (ushort *)0x0;
            }
            else {
              *local_170 = _Dst + 0x14;
            }
            *local_17c = *(undefined4 *)(uVar1 + 0x2c);
            iVar4 = 0;
            local_154 = 0;
            goto LAB_6b86d085;
          }
          iVar4 = -0x3fffffe9;
          pcVar8 = "Out of memory";
          uVar5 = 0x5f6;
        }
      }
      local_154 = iVar4;
      FUN_6b8671a2(1,"AslpFileGetVersionBlock",uVar5,pcVar8);
    }
  }
LAB_6b86d085:
  local_8 = (undefined *)0xfffffffe;
LAB_6b86d0ef:
  if (local_160 != (ushort *)0x0) {
    RtlFreeHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),0,local_160);
    iVar4 = local_154;
  }
  FUN_6b86b52e(local_1a8);
  *in_FS_OFFSET = local_14;
  return iVar4;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 __fastcall FUN_6b86d133(undefined4 *param_1,int param_2,int param_3)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  void *pvVar4;
  undefined4 uVar5;
  void *_Buf1;
  undefined4 *in_FS_OFFSET;
  undefined4 local_14;
  
  uVar5 = 0;
  iVar1 = 0;
  *param_1 = 0;
  uVar2 = *(uint *)(param_3 + 0x10);
  uVar3 = *(uint *)(param_3 + 0x14);
  if ((uVar3 != 0) || (*(uint *)(param_3 + 0x1c) <= uVar2)) {
    uVar2 = *(uint *)(param_3 + 0x1c);
    uVar3 = 0;
  }
  if ((((uVar3 == 0) && (uVar2 < 0x401)) || (1 < uVar3)) ||
     (((uVar3 != 0 || (*(int *)(param_3 + 0x34) != 0)) || (*(int *)(param_3 + 0x30) != 0)))) {
    uVar5 = 0xc0000225;
  }
  else {
    if (*(short *)(param_2 + 0x18) == 0x10b) {
      iVar1 = param_2 + 0x98;
    }
    else if (*(short *)(param_2 + 0x18) == 0x20b) {
      iVar1 = param_2 + 0xa8;
    }
    if ((iVar1 == 0) || (uVar2 <= *(int *)(iVar1 + 4) + 0x400U)) {
      uVar5 = 0xc0000225;
    }
    else {
      pvVar4 = (void *)((uVar2 - 0x400) + (*(int *)(param_3 + 0x18) - *(int *)(iVar1 + 4)));
      for (_Buf1 = (void *)((int)pvVar4 + 0x3e6); pvVar4 <= _Buf1; _Buf1 = (void *)((int)_Buf1 + -1)
          ) {
        iVar1 = memcmp(_Buf1,"TMSAMVOF",8);
        if ((((iVar1 == 0) && (*(short *)((int)_Buf1 + 8) == 1)) &&
            (uVar2 = *(uint *)((int)_Buf1 + 0x12) + *(uint *)((int)_Buf1 + 0xe),
            uVar3 = uVar2 + *(uint *)((int)_Buf1 + 10), uVar3 + 0x26e == *(int *)((int)_Buf1 + 0x16)
            )) && ((char)(CARRY4(*(uint *)((int)_Buf1 + 0x12),*(uint *)((int)_Buf1 + 0xe)) +
                          CARRY4(uVar2,*(uint *)((int)_Buf1 + 10)) + (0xfffffd91 < uVar3)) == '\0'))
        {
          *param_1 = 1;
          break;
        }
      }
    }
  }
  *in_FS_OFFSET = local_14;
  return uVar5;
}



undefined4 __fastcall FUN_6b86d2c1(int *param_1)

{
  if (((*param_1 == 0x4550) && (*(char *)((int)param_1 + 0x1a) == 'S')) &&
     (*(char *)((int)param_1 + 0x1b) == 'R')) {
    return 1;
  }
  return 0;
}



undefined4 __fastcall FUN_6b86d2dc(int param_1)

{
  int iVar1;
  uint uVar2;
  char *_Str1;
  
  _Str1 = (char *)(param_1 + 0x18 + (uint)*(ushort *)(param_1 + 0x14));
  uVar2 = 0;
  if (*(short *)(param_1 + 6) != 0) {
    do {
      if (((*(int *)(_Str1 + 0xc) != 0) && (*(int *)(_Str1 + 8) != 0)) &&
         (iVar1 = strncmp(_Str1,".securom",8), iVar1 == 0)) {
        return 1;
      }
      uVar2 = uVar2 + 1;
      _Str1 = _Str1 + 0x28;
    } while (uVar2 < *(ushort *)(param_1 + 6));
  }
  return 0;
}



void __fastcall FUN_6b86d337(int param_1,int param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  if (param_2 == 0) {
    *(uint *)(param_1 + 0x148) = *(uint *)(param_1 + 0x148) | 2;
    *(uint *)(param_1 + 0x160) = *(uint *)(param_1 + 0x160) | 2;
    *(uint *)(param_1 + 0x178) = *(uint *)(param_1 + 0x178) | 2;
    *(uint *)(param_1 + 400) = *(uint *)(param_1 + 400) | 2;
    *(uint *)(param_1 + 0x70) = *(uint *)(param_1 + 0x70) | 2;
    *(uint *)(param_1 + 0x58) = *(uint *)(param_1 + 0x58) | 2;
    return;
  }
  *(undefined4 *)(param_1 + 0x13c) = 4;
  *(undefined4 *)(param_1 + 0x138) = 2;
  uVar1 = *(undefined4 *)(param_2 + 0x2c);
  *(uint *)(param_1 + 0x148) = *(uint *)(param_1 + 0x148) | 1;
  *(undefined4 *)(param_1 + 0x144) = 0;
  *(undefined4 *)(param_1 + 0x154) = 4;
  *(undefined4 *)(param_1 + 0x140) = uVar1;
  *(undefined4 *)(param_1 + 0x150) = 2;
  uVar1 = *(undefined4 *)(param_2 + 0x30);
  *(uint *)(param_1 + 0x160) = *(uint *)(param_1 + 0x160) | 1;
  *(undefined4 *)(param_1 + 0x15c) = 0;
  *(undefined4 *)(param_1 + 0x16c) = 4;
  *(undefined4 *)(param_1 + 0x158) = uVar1;
  *(undefined4 *)(param_1 + 0x168) = 2;
  uVar1 = *(undefined4 *)(param_2 + 0x20);
  *(uint *)(param_1 + 0x178) = *(uint *)(param_1 + 0x178) | 1;
  *(undefined4 *)(param_1 + 0x184) = 4;
  *(undefined4 *)(param_1 + 0x174) = 0;
  *(undefined4 *)(param_1 + 0x170) = uVar1;
  *(undefined4 *)(param_1 + 0x180) = 2;
  uVar1 = *(undefined4 *)(param_2 + 0x24);
  *(uint *)(param_1 + 400) = *(uint *)(param_1 + 400) | 1;
  *(undefined4 *)(param_1 + 0x18c) = 0;
  *(undefined4 *)(param_1 + 0x188) = uVar1;
  uVar1 = *(undefined4 *)(param_2 + 0x14);
  uVar2 = *(undefined4 *)(param_2 + 0x10);
  *(uint *)(param_1 + 0x70) = *(uint *)(param_1 + 0x70) | 1;
  *(undefined4 *)(param_1 + 0x60) = 3;
  *(undefined4 *)(param_1 + 100) = 8;
  *(undefined4 *)(param_1 + 0x68) = uVar1;
  *(undefined4 *)(param_1 + 0x6c) = uVar2;
  uVar1 = *(undefined4 *)(param_2 + 0xc);
  uVar2 = *(undefined4 *)(param_2 + 8);
  *(uint *)(param_1 + 0x58) = *(uint *)(param_1 + 0x58) | 1;
  *(undefined4 *)(param_1 + 0x4c) = 8;
  *(undefined4 *)(param_1 + 0x48) = 3;
  *(undefined4 *)(param_1 + 0x50) = uVar1;
  *(undefined4 *)(param_1 + 0x54) = uVar2;
  return;
}



uint __fastcall FUN_6b86d42b(int param_1,ushort *param_2)

{
  uint *puVar1;
  short sVar2;
  ushort uVar3;
  uint uVar4;
  ushort *puVar5;
  short *psVar6;
  uint uVar7;
  int iVar8;
  undefined4 uVar9;
  char *pcVar10;
  uint local_20;
  ushort *local_1c;
  uint local_18;
  ushort *local_14;
  short *local_10;
  uint local_c;
  ushort *local_8;
  
  local_10 = (short *)0x0;
  local_20 = 0;
  local_14 = (ushort *)0x0;
  local_c = 0;
  local_18 = 0;
  if (param_2 == (ushort *)0x0) {
    *(uint *)(param_1 + 0x88) = *(uint *)(param_1 + 0x88) | 2;
    *(uint *)(param_1 + 0xa0) = *(uint *)(param_1 + 0xa0) | 2;
    *(uint *)(param_1 + 0xb8) = *(uint *)(param_1 + 0xb8) | 2;
    *(uint *)(param_1 + 0xd0) = *(uint *)(param_1 + 0xd0) | 2;
    *(uint *)(param_1 + 0xe8) = *(uint *)(param_1 + 0xe8) | 2;
    *(uint *)(param_1 + 0x100) = *(uint *)(param_1 + 0x100) | 2;
    *(uint *)(param_1 + 0x118) = *(uint *)(param_1 + 0x118) | 2;
    *(uint *)(param_1 + 0x130) = *(uint *)(param_1 + 0x130) | 2;
  }
  else {
    local_1c = param_2;
    uVar4 = FUN_6b86dd6e(param_2,L"\\VarFileInfo\\Translation",&local_14,(int *)&local_c);
    puVar5 = local_14;
    if (uVar4 == 0xc0000225) {
      puVar5 = (ushort *)0x0;
      uVar7 = 0;
      local_8 = (ushort *)0x0;
    }
    else {
      if ((int)uVar4 < 0) {
        pcVar10 = "AslpFileVerQueryBlock failed [%x]";
        uVar9 = 0x6b9;
LAB_6b86d5fb:
        FUN_6b8671a2(1,"AslpFileMakeStringVersionAttributes",uVar9,pcVar10);
        return uVar4;
      }
      local_8 = (ushort *)0x0;
      uVar7 = 0;
      uVar4 = FUN_6b86dd12(&local_18,(int)local_14,local_c);
      if (((int)uVar4 < 0) || (local_c <= local_18)) {
        puVar5 = (ushort *)0x0;
      }
      else {
        puVar5 = (ushort *)(local_18 + (int)puVar5);
        uVar7 = local_c - local_18;
        local_8 = puVar5;
      }
    }
    local_c = uVar7 >> 2;
    local_14 = (ushort *)0x0;
    do {
      local_18 = *(uint *)(local_14 + 0x35c40198);
      uVar4 = FUN_6b86d9f3(&local_10,&local_20,local_1c,(int)puVar5,local_c,
                           *(int *)(local_14 + 0x35c4019a));
      if ((int)uVar4 < 0) {
        if (uVar4 != 0xc0000225) {
          pcVar10 = "AslpFileQueryVersionString failed [%x]";
          uVar9 = 0x6f0;
          goto LAB_6b86d5fb;
        }
        puVar1 = (uint *)(local_18 * 0x18 + 0x10 + param_1);
        *puVar1 = *puVar1 | 2;
      }
      else {
        uVar4 = FUN_6b86a272(local_10);
        if ((int)uVar4 < 0) {
          pcVar10 = "AslStringXmlSanitize failed [%x]";
          uVar9 = 0x6e3;
          goto LAB_6b86d5fb;
        }
        iVar8 = local_18 * 0x18;
        *(undefined4 *)(iVar8 + param_1) = 4;
        psVar6 = local_10;
        do {
          sVar2 = *psVar6;
          psVar6 = psVar6 + 1;
        } while (sVar2 != 0);
        puVar1 = (uint *)(iVar8 + 0x10 + param_1);
        *puVar1 = *puVar1 | 1;
        *(int *)(iVar8 + 4 + param_1) = (int)psVar6 - (int)(local_10 + 1) >> 1;
        *(short **)(iVar8 + 8 + param_1) = local_10;
        *(int *)(iVar8 + 0xc + param_1) = (int)local_10 >> 0x1f;
      }
      local_14 = local_14 + 4;
      puVar5 = local_8;
    } while (local_14 < (ushort *)0x40);
    if ((local_8 != (ushort *)0x0) && (local_c == 1)) {
      *(undefined4 *)(param_1 + 0x240) = 2;
      *(undefined4 *)(param_1 + 0x244) = 4;
      uVar3 = *local_8;
      *(uint *)(param_1 + 0x250) = *(uint *)(param_1 + 0x250) | 1;
      *(uint *)(param_1 + 0x248) = (uint)uVar3;
      *(undefined4 *)(param_1 + 0x24c) = 0;
      return 0;
    }
  }
  *(uint *)(param_1 + 0x250) = *(uint *)(param_1 + 0x250) | 2;
  return 0;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 __fastcall FUN_6b86d611(undefined *param_1,int param_2)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  uint _Size;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar6;
  undefined4 local_14;
  
  uVar5 = 0;
  *param_1 = 0;
  if (*(int *)(param_2 + 0x28) != 5) {
    uVar5 = 0xc00000bb;
    goto LAB_6b86d734;
  }
  iVar1 = *(int *)(param_2 + 0x18);
  uVar2 = *(uint *)(param_2 + 0x10);
  iVar3 = *(int *)(param_2 + 0x14);
  if ((iVar3 == 0) && (uVar2 < *(int *)(iVar1 + 0x3c) + 0x40U)) {
LAB_6b86d6c9:
    uVar6 = 0xd79;
  }
  else {
    iVar4 = *(int *)(*(int *)(iVar1 + 0x3c) + 0x2c + iVar1);
    if ((iVar3 == 0) && (uVar2 < iVar4 + 1U)) goto LAB_6b86d6c9;
    _Size = (uint)*(byte *)(iVar4 + iVar1);
    if ((_Size == 0) || (0x100 < _Size + 1)) {
      uVar6 = 0xd82;
    }
    else {
      if ((iVar3 != 0) || (iVar4 + 1 + _Size <= uVar2)) {
        memcpy(param_1,(byte *)(iVar4 + iVar1) + 1,_Size);
        param_1[_Size] = 0;
        goto LAB_6b86d734;
      }
      uVar6 = 0xd88;
    }
  }
  uVar5 = 0xc000007b;
  FUN_6b8671a2(1,"AslpFileQuery16BitDescription",uVar6,"File mapping invalid");
LAB_6b86d734:
  *in_FS_OFFSET = local_14;
  return uVar5;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 __fastcall FUN_6b86d746(undefined *param_1,int param_2)

{
  byte *pbVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  undefined4 uVar5;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar6;
  undefined4 local_14;
  
  uVar5 = 0;
  *param_1 = 0;
  if (*(int *)(param_2 + 0x28) != 5) {
    uVar5 = 0xc00000bb;
    goto LAB_6b86d857;
  }
  iVar2 = *(int *)(param_2 + 0x18);
  if ((*(int *)(param_2 + 0x14) == 0) &&
     (*(uint *)(param_2 + 0x10) < *(int *)(iVar2 + 0x3c) + 0x40U)) {
LAB_6b86d7ec:
    uVar6 = 0xdc6;
  }
  else {
    uVar3 = (uint)*(ushort *)(*(int *)(iVar2 + 0x3c) + iVar2 + 0x26);
    if ((*(int *)(param_2 + 0x14) == 0) && (*(uint *)(param_2 + 0x10) < uVar3 + 1))
    goto LAB_6b86d7ec;
    iVar4 = *(int *)(iVar2 + 0x3c) + uVar3;
    pbVar1 = (byte *)(iVar4 + iVar2);
    uVar3 = (uint)*pbVar1;
    if (uVar3 == 0) {
      uVar6 = 0xdcf;
    }
    else {
      if ((*(int *)(param_2 + 0x14) != 0) || (iVar4 + 1 + uVar3 <= *(uint *)(param_2 + 0x10))) {
        memcpy(param_1,pbVar1 + 1,uVar3);
        param_1[uVar3] = 0;
        goto LAB_6b86d857;
      }
      uVar6 = 0xdd6;
    }
  }
  uVar5 = 0xc000007b;
  FUN_6b8671a2(1,"AslpFileQuery16BitModuleName",uVar6,"File mapping invalid");
LAB_6b86d857:
  *in_FS_OFFSET = local_14;
  return uVar5;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

int __fastcall FUN_6b86d869(char *param_1,int param_2)

{
  int iVar1;
  uint uVar2;
  char *pcVar3;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar4;
  char *pcVar5;
  int local_28;
  uint local_24;
  int local_20;
  undefined4 local_14;
  undefined4 uStack12;
  undefined4 local_8;
  
  uStack12 = 0x6b86d875;
  local_24 = 0;
  local_28 = 0;
  *param_1 = '\0';
  local_8 = 0;
  iVar1 = FUN_6b86c7fe(&local_28,param_2);
  if (iVar1 < 0) {
    pcVar5 = "AslpFileGetImageNtHeader failed [%x]";
    uVar4 = 0xcb6;
LAB_6b86d9cb:
    local_20 = iVar1;
    FUN_6b8671a2(1,"AslpFileQueryExportName",uVar4,pcVar5);
  }
  else {
    local_20 = iVar1;
    uVar2 = RtlImageDirectoryEntryToData
                      (*(undefined4 *)(param_2 + 0x18),*(undefined *)(param_2 + 0x23),0,&local_24);
    if ((uVar2 == 0) || (local_24 < 0x28)) {
      iVar1 = -0x3ffffddb;
      local_20 = 0xc0000225;
      if (uVar2 == 0) goto LAB_6b86d9da;
      pcVar5 = "RtlImageDirectoryEntryToData returned ExportDirectory that was too small";
      uVar4 = 0xcc7;
    }
    else if ((uVar2 < *(uint *)(param_2 + 0x18)) ||
            ((uint)(*(int *)(param_2 + 0x10) + *(int *)(param_2 + 0x18)) < uVar2 + 0x28)) {
      iVar1 = -0x3fffff85;
      local_20 = 0xc000007b;
      pcVar5 = 
      "Export directory pointer invalid (points to location outside file), invalid image format";
      uVar4 = 0xcd5;
    }
    else {
      pcVar5 = (char *)FUN_6b86e02c(local_28,param_2 + 8,*(uint *)(uVar2 + 0xc));
      if (((pcVar5 != (char *)0x0) &&
          (pcVar3 = (char *)(*(int *)(param_2 + 0x10) + *(int *)(param_2 + 0x18)), pcVar5 < pcVar3))
         && (*pcVar5 != '\0')) {
        uVar2 = (int)pcVar3 - (int)pcVar5;
        if (0x100 < uVar2) {
          uVar2 = 0x100;
        }
        iVar1 = FUN_6b835c38(param_1,uVar2,(int)pcVar5);
        if (-1 < iVar1) {
          iVar1 = 0;
          goto LAB_6b86d9da;
        }
        pcVar5 = "RtlStringCchCopyA failed [%x]";
        uVar4 = 0xcea;
        goto LAB_6b86d9cb;
      }
      iVar1 = -0x3fffff85;
      local_20 = 0xc000007b;
      pcVar5 = "Export directory invalid or invalid image format";
      uVar4 = 0xcde;
    }
    FUN_6b8671a2(2,"AslpFileQueryExportName",uVar4,pcVar5);
  }
LAB_6b86d9da:
  *in_FS_OFFSET = local_14;
  return iVar1;
}



void __fastcall
FUN_6b86d9f3(short **param_1,uint *param_2,ushort *param_3,int param_4,uint param_5,int param_6)

{
  int iVar1;
  uint uVar2;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  uint uVar3;
  uint uVar4;
  undefined4 uVar5;
  char *pcVar6;
  short *local_118;
  uint local_114;
  ushort *local_110;
  uint local_10c;
  wchar_t local_108 [128];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  uVar4 = 0;
  *param_1 = (short *)0x0;
  uVar3 = 0;
  local_108[0] = L'\0';
  local_118 = (short *)0x0;
  local_114 = 0;
  local_110 = (ushort *)0x0;
  local_10c = 0;
  *param_2 = 0;
  do {
    iVar1 = FUN_6b8147b5(local_108,0x80,
                         *(int *)((int)&PTR_u__StringFileInfo_000004B0__6b880b30 + uVar3));
    if (iVar1 < 0) {
      pcVar6 = "RtlStringCchCopyW failed [%x]";
      uVar5 = 0x8d8;
      goto LAB_6b86dbfb;
    }
    iVar1 = FUN_6b83282b(local_108,0x80,param_6);
    if (iVar1 < 0) {
      pcVar6 = "RtlStringCchCatW failed [%x]";
      uVar5 = 0x8de;
      goto LAB_6b86dbfb;
    }
    uVar2 = FUN_6b86dd6e(param_3,local_108,&local_110,(int *)&local_10c);
    if (-1 < (int)uVar2) {
      uVar3 = FUN_6b86df0e(&local_118,&local_114,(int)local_110,local_10c);
      uVar5 = extraout_EDX_00;
      if (-1 < (int)uVar3) goto LAB_6b86dbb6;
      break;
    }
    if (uVar2 != 0xc0000225) {
      pcVar6 = "AslpFileVerQueryBlock failed [%x]";
      uVar5 = 0x8fc;
      goto LAB_6b86dbfb;
    }
    uVar3 = uVar3 + 4;
    uVar5 = extraout_EDX;
  } while (uVar3 < 0x10);
  if ((param_4 != 0) && (param_5 != 0)) {
LAB_6b86db16:
    iVar1 = FUN_6b832879(local_108,0x80,L"\\StringFileInfo\\%04X%04X\\%s");
    if (iVar1 < 0) {
      pcVar6 = "RtlStringCchPrintfW failed [%x]";
      uVar5 = 0x90e;
      goto LAB_6b86dbfb;
    }
    uVar3 = FUN_6b86dd6e(param_3,local_108,&local_110,(int *)&local_10c);
    if (-1 < (int)uVar3) {
      uVar3 = FUN_6b86df0e(&local_118,&local_114,(int)local_110,local_10c);
      uVar5 = extraout_EDX_02;
      if (-1 < (int)uVar3) {
LAB_6b86dbb6:
        *param_2 = local_114;
        *param_1 = local_118;
      }
      goto LAB_6b86dc0c;
    }
    if (uVar3 == 0xc0000225) {
      uVar4 = uVar4 + 1;
      uVar5 = extraout_EDX_01;
      if (param_5 <= uVar4) goto LAB_6b86dc0c;
      goto LAB_6b86db16;
    }
    pcVar6 = "AslpFileVerQueryBlock failed [%x]";
    uVar5 = 0x92c;
LAB_6b86dbfb:
    FUN_6b8671a2(1,"AslpFileQueryVersionString",uVar5,pcVar6);
    uVar5 = extraout_EDX_03;
  }
LAB_6b86dc0c:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar5);
  return;
}



uint __thiscall FUN_6b86dc1d(void *this,short **param_1)

{
  short sVar1;
  short sVar2;
  uint uVar3;
  short *psVar4;
  short *psVar5;
  
  if ((param_1 == (short **)0x0) ||
     ((this == (void *)0x0 && (this = *param_1, (short *)this == (short *)0x0)))) {
    uVar3 = 0;
  }
  else {
                    // WARNING: Load size is inaccurate
    sVar2 = *this;
    while (sVar2 != 0) {
      psVar4 = &DAT_6b88423c;
      sVar1 = 0x5c;
      do {
        if (sVar1 == sVar2) break;
        psVar4 = psVar4 + 1;
        sVar1 = *psVar4;
      } while (sVar1 != 0);
      if (sVar1 == 0) break;
      this = (void *)((int)this + 2);
                    // WARNING: Load size is inaccurate
      sVar2 = *this;
    }
                    // WARNING: Load size is inaccurate
    sVar2 = *this;
    psVar4 = (short *)this;
    while (sVar2 != 0) {
      psVar5 = &DAT_6b88423c;
      sVar2 = 0x5c;
      do {
        if (sVar2 == *psVar4) break;
        psVar5 = psVar5 + 1;
        sVar2 = *psVar5;
      } while (sVar2 != 0);
      if (sVar2 != 0) {
        *psVar4 = 0;
        psVar4 = psVar4 + 1;
        break;
      }
      psVar4 = psVar4 + 1;
      sVar2 = *psVar4;
    }
    *param_1 = psVar4;
    uVar3 = -(uint)(psVar4 != (short *)this) & (uint)this;
  }
  return uVar3;
}



uint __fastcall FUN_6b86dd12(uint *param_1,int param_2,int param_3)

{
  uint uVar1;
  uint *local_8;
  
  *param_1 = 0;
  if (param_3 - 8U < 0x7ff8) {
    local_8 = param_1;
    uVar1 = FUN_6b86e073((short *)(param_2 + 6),param_3 - 6,(int *)&local_8);
    if (-1 < (int)uVar1) {
      uVar1 = FUN_6b867d76((uint)local_8,8,(uint *)&local_8);
      if (-1 < (int)uVar1) {
        *param_1 = (int)local_8 + 3U & 0xfffffffc;
        uVar1 = 0;
      }
    }
  }
  else {
    uVar1 = 0xc000000d;
  }
  return uVar1;
}



uint __fastcall FUN_6b86dd6e(ushort *param_1,void *param_2,ushort **param_3,int *param_4)

{
  ushort *puVar1;
  ushort uVar2;
  uint uVar3;
  int iVar4;
  wchar_t *_Str1;
  short *this;
  uint uVar5;
  ushort *puVar6;
  int in_FS_OFFSET;
  undefined4 uVar7;
  char *pcVar8;
  short *local_10;
  uint local_c;
  short *local_8;
  
  local_8 = (short *)0x0;
  local_10 = (short *)0x0;
  local_c = 0;
  *param_4 = 0;
  if (param_1[2] != 0) {
    FUN_6b8671a2(1,"AslpFileVerQueryBlock",0x79b,"Version block invalid");
    return 0xc000000d;
  }
  uVar3 = FUN_6b81464d(&local_8,param_2);
  if ((int)uVar3 < 0) {
    FUN_6b8671a2(1,"AslpFileVerQueryBlock",0x7a1,"AslStringDuplicate failed [%x]");
  }
  else {
    uVar2 = *param_1;
    if (uVar2 < 0x8000) {
      if (7 < uVar2) {
        puVar1 = (ushort *)((int)param_1 + (uint)uVar2);
        uVar2 = puVar1[-1];
        puVar1[-1] = 0;
        this = local_8;
        puVar6 = puVar1;
        while (_Str1 = (wchar_t *)FUN_6b86dc1d(this,&local_10), _Str1 != (wchar_t *)0x0) {
          uVar3 = (int)puVar1 - (int)param_1;
          if ((((uVar3 < 8) || (uVar5 = (uint)*param_1, uVar3 < uVar5)) ||
              (uVar3 = FUN_6b86dd12(&local_c,(int)param_1,uVar3), (int)uVar3 < 0)) ||
             (uVar3 = local_c + (param_1[1] + 3 & 0xfffffffc), local_c = uVar3, uVar5 < uVar3)) {
LAB_6b86deaf:
            uVar3 = 0xc0000225;
            puVar1[-1] = uVar2;
            goto LAB_6b86deec;
          }
          puVar6 = (ushort *)(uVar5 + (int)param_1);
          while( true ) {
            param_1 = (ushort *)((int)param_1 + uVar3);
            if (((puVar6 <= param_1) || (*param_1 < 9)) ||
               ((uint)((int)puVar6 - (int)param_1) < (uint)*param_1)) goto LAB_6b86deaf;
            iVar4 = _wcsicmp(_Str1,(wchar_t *)(param_1 + 3));
            if (iVar4 == 0) break;
            uVar3 = *param_1 + 3 & 0xfffffffc;
          }
          this = (short *)0x0;
        }
        *param_4 = (int)puVar6 - (int)param_1;
        *param_3 = param_1;
        puVar1[-1] = uVar2;
        uVar3 = 0;
        goto LAB_6b86deec;
      }
      pcVar8 = "VersionBlock not long enough";
      uVar7 = 0x7b2;
    }
    else {
      pcVar8 = "VersionBlock is too long";
      uVar7 = 0x7ad;
    }
    uVar3 = 0xc000000d;
    FUN_6b8671a2(1,"AslpFileVerQueryBlock",uVar7,pcVar8);
  }
LAB_6b86deec:
  if (local_8 != (short *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_8);
  }
  return uVar3;
}



uint __fastcall FUN_6b86df0e(short **param_1,uint *param_2,int param_3,uint param_4)

{
  uint uVar1;
  int iVar2;
  short *psVar3;
  uint local_c;
  uint local_8;
  
  *param_1 = (short *)0x0;
  local_8 = 0;
  *param_2 = 0;
  local_c = 0;
  uVar1 = FUN_6b86dd12(&local_8,param_3,param_4);
  if (-1 < (int)uVar1) {
    if (param_4 < local_8) {
      uVar1 = 0xc000000d;
    }
    else {
      if (local_8 == param_4) {
        psVar3 = (short *)(param_3 + -2 + local_8);
        local_c = 0;
      }
      else {
        psVar3 = (short *)(param_3 + local_8);
        uVar1 = param_4 - local_8;
        iVar2 = FUN_6b86e073(psVar3,uVar1,(int *)&local_c);
        if (iVar2 < 0) {
          local_c = uVar1 - 2;
          *(undefined2 *)((int)psVar3 + (local_c & 0xfffffffe)) = 0;
        }
      }
      uVar1 = 0;
      *param_2 = local_c >> 1;
      *param_1 = psVar3;
    }
  }
  return uVar1;
}



undefined4 __fastcall FUN_6b86df97(int param_1)

{
  int iVar1;
  uint uVar2;
  char *_Str1;
  
  _Str1 = (char *)(param_1 + 0x18 + (uint)*(ushort *)(param_1 + 0x14));
  uVar2 = 0;
  if (*(short *)(param_1 + 6) != 0) {
    do {
      if (((*(int *)(_Str1 + 0xc) != 0) && (*(int *)(_Str1 + 8) != 0)) &&
         (iVar1 = strncmp(_Str1,(char *)&_Str2_6b88e428,8), iVar1 == 0)) {
        return 1;
      }
      uVar2 = uVar2 + 1;
      _Str1 = _Str1 + 0x28;
    } while (uVar2 < *(ushort *)(param_1 + 6));
  }
  return 0;
}



int __fastcall FUN_6b86dff2(int param_1,uint param_2)

{
  uint uVar1;
  int iVar2;
  
  iVar2 = param_1 + 0x18 + (uint)*(ushort *)(param_1 + 0x14);
  uVar1 = 0;
  if (*(ushort *)(param_1 + 6) != 0) {
    do {
      if ((*(uint *)(iVar2 + 0xc) <= param_2) &&
         (param_2 < (uint)(*(int *)(iVar2 + 0x10) + *(int *)(iVar2 + 0xc)))) {
        return iVar2;
      }
      iVar2 = iVar2 + 0x28;
      uVar1 = uVar1 + 1;
    } while (uVar1 < *(ushort *)(param_1 + 6));
  }
  return 0;
}



int __fastcall FUN_6b86e02c(int param_1,int param_2,uint param_3)

{
  int iVar1;
  bool bVar2;
  
  if (*(char *)(param_2 + 0x1b) == '\0') {
    iVar1 = FUN_6b86dff2(param_1,param_3);
    if (iVar1 == 0) {
      return 0;
    }
    param_3 = (*(int *)(iVar1 + 0x14) - *(int *)(iVar1 + 0xc)) + param_3;
    if (*(int *)(param_2 + 0xc) != 0) goto LAB_6b86e042;
    bVar2 = param_3 < *(uint *)(param_2 + 8);
  }
  else {
    bVar2 = param_3 < *(uint *)(param_2 + 0x14);
  }
  if (!bVar2) {
    return 0;
  }
LAB_6b86e042:
  return *(int *)(param_2 + 0x10) + param_3;
}



int __fastcall FUN_6b86e073(short *param_1,uint param_2,int *param_3)

{
  int iVar1;
  int iVar2;
  int local_8;
  
  iVar1 = 0;
  local_8 = 0;
  if (param_1 == (short *)0x0) {
    iVar2 = -0x3ffffff3;
  }
  else {
    iVar2 = FUN_6b83290d(param_1,param_2 >> 1,&local_8);
    iVar1 = local_8;
  }
  if (param_3 != (int *)0x0) {
    if (iVar2 < 0) {
      *param_3 = 0;
    }
    else {
      *param_3 = iVar1 * 2;
    }
  }
  return iVar2;
}



undefined4 __fastcall FUN_6b86e0b3(int param_1,int *param_2)

{
  int iVar1;
  undefined4 uVar2;
  
  if ((param_2 != (int *)0x0) && (iVar1 = *param_2, iVar1 != 0)) {
    *(undefined4 *)(param_1 + 0xc) = *(undefined4 *)(iVar1 + 4);
    *(undefined *)(param_1 + 0x21) = 1;
    *(undefined4 *)(iVar1 + 4) = 0;
    *(undefined4 *)(param_1 + 0x18) = *(undefined4 *)(iVar1 + 8);
    *(undefined4 *)(param_1 + 0x1c) = *(undefined4 *)(iVar1 + 0xc);
    *(undefined2 *)(param_1 + 0x22) = 1;
    *(undefined4 *)(param_1 + 0x34) = 1;
    *(undefined4 *)(iVar1 + 8) = 0;
    *(undefined4 *)(iVar1 + 0xc) = 0;
    FUN_6b86e6b8(param_2);
    uVar2 = FUN_6b86b3ef(param_1 + 8,(undefined4 *)(param_1 + 0x28));
    return uVar2;
  }
  return 0xc00000f0;
}



int __fastcall FUN_6b86e10d(int param_1,int param_2)

{
  uint *puVar1;
  int iVar2;
  int *local_8;
  
  iVar2 = 0;
  if ((*(int *)(param_2 + 0x14) == 0) && (*(uint *)(param_2 + 0x10) < 0x100000)) {
    iVar2 = -0x3fffff10;
  }
  else {
    local_8 = (int *)0x0;
    puVar1 = (uint *)(param_1 + 0x10);
    do {
      if ((iVar2 < 0) ||
         ((((0x13 < iVar2 && (iVar2 != 0x16)) && (iVar2 != 0x18)) && (5 < iVar2 - 0x1aU)))) {
        *puVar1 = *puVar1 | 2;
      }
      iVar2 = iVar2 + 1;
      puVar1 = puVar1 + 6;
    } while (iVar2 < 0x21);
    iVar2 = FUN_6b86e54f(&local_8,(undefined4 *)(param_2 + 8));
    if (-1 < iVar2) {
      iVar2 = FUN_6b86e2aa(param_1,local_8);
      if (iVar2 < 0) {
        FUN_6b8671a2(1,"AslpFileLargeEnsureLargeFileMapping",0xf8,
                     "AslpFileLargeGetChecksumAttributes failed to get checksum attributes [%x]");
      }
      iVar2 = FUN_6b86e0b3(param_2,(int *)&local_8);
    }
    FUN_6b86e6b8((int *)&local_8);
  }
  return iVar2;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 __fastcall FUN_6b86e1b4(uint *param_1,int *param_2)

{
  undefined4 uVar1;
  int *piVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  undefined4 *in_FS_OFFSET;
  undefined4 local_14;
  
  uVar4 = 0;
  if ((((*(int *)(*param_2 + 0xc) == 0) && (*(uint *)(*param_2 + 8) < 0x100000)) ||
      (param_2[2] == 0)) || (((uint)param_2[3] < 0x1200 || ((param_2[4] | param_2[5]) != 0)))) {
    uVar1 = 0xc000000d;
  }
  else {
    piVar2 = (int *)(param_2[2] + 0x200);
    for (uVar3 = 0; uVar3 < 0x400; uVar3 = uVar3 + 1) {
      uVar5 = uVar4 + *piVar2;
      piVar2 = piVar2 + 1;
      uVar4 = uVar5 >> 1;
      if ((uVar5 & 1) != 0) {
        uVar4 = uVar4 | 0x80000000;
      }
    }
    *param_1 = uVar4;
    uVar1 = 0;
  }
  *in_FS_OFFSET = local_14;
  return uVar1;
}



int __fastcall FUN_6b86e2aa(int param_1,int *param_2)

{
  uint uVar1;
  int iVar2;
  uint local_8;
  
  local_8 = 0;
  iVar2 = FUN_6b86e1b4(&local_8,param_2);
  uVar1 = local_8;
  if (iVar2 < 0) {
    FUN_6b8671a2(1,"AslpFileLargeGetChecksumAttributes",0x2a1,"AslpFileLargeGetChecksum failed [%x]"
                );
    *(uint *)(param_1 + 0x40) = *(uint *)(param_1 + 0x40) | 2;
  }
  else {
    *(undefined4 *)(param_1 + 0x3c) = 0;
    *(uint *)(param_1 + 0x40) = *(uint *)(param_1 + 0x40) | 1;
    local_8 = 0;
    *(undefined4 *)(param_1 + 0x30) = 2;
    *(undefined4 *)(param_1 + 0x34) = 4;
    *(uint *)(param_1 + 0x38) = uVar1;
    iVar2 = FUN_6b86e371(&local_8,param_2);
    if (-1 < iVar2) {
      *(undefined4 *)(param_1 + 0x27c) = 0;
      *(uint *)(param_1 + 0x280) = *(uint *)(param_1 + 0x280) | 1;
      *(undefined4 *)(param_1 + 0x270) = 2;
      *(undefined4 *)(param_1 + 0x274) = 4;
      *(uint *)(param_1 + 0x278) = local_8;
      return 0;
    }
    FUN_6b8671a2(1,"AslpFileLargeGetChecksumAttributes",0x2b6,"AslpFileGetCrcChecksum failed [%x]");
  }
  *(uint *)(param_1 + 0x280) = *(uint *)(param_1 + 0x280) | 2;
  return iVar2;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

undefined4 __fastcall FUN_6b86e371(uint *param_1,int *param_2)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  uint uVar4;
  uint uVar5;
  undefined4 *in_FS_OFFSET;
  uint uVar6;
  undefined4 local_14;
  
  *param_1 = 0;
  uVar4 = *(uint *)(*param_2 + 8);
  iVar1 = *(int *)(*param_2 + 0xc);
  if (((((iVar1 == 0) && (uVar4 < 0x100000)) || (iVar2 = param_2[6], iVar2 == 0)) ||
      (((uint)param_2[7] < 0x1000 || (param_2[2] == 0)))) ||
     (((uint)param_2[3] < 0x1000 || ((param_2[4] | param_2[5]) != 0)))) {
    uVar3 = 0xc000000d;
  }
  else {
    uVar5 = uVar4 - param_2[8];
    if ((((iVar1 - param_2[9]) - (uint)(uVar4 < (uint)param_2[8])) + -1 + (uint)(0xfff < uVar5) +
         (uint)(0xffffefff < uVar5 - 0x1000) == 0) &&
       (uVar5 < (uint)param_2[7] || uVar5 == param_2[7])) {
      uVar6 = 0x1000;
      uVar4 = FUN_6b8671cf(0,param_2[2],0x1000);
      uVar4 = FUN_6b8671cf(uVar4,iVar2 + (uVar5 - 0x1000),uVar6);
      *param_1 = uVar4;
      uVar3 = 0;
    }
    else {
      FUN_6b8671a2(0,"AslpFileLargeGetCrcChecksum",0x376,"FileSize      : %I64u");
      FUN_6b8671a2(0,"AslpFileLargeGetCrcChecksum",0x377,"CrcFileStart  : %I64u");
      FUN_6b8671a2(0,"AslpFileLargeGetCrcChecksum",0x378,"ViewFileOffset: %I64u");
      FUN_6b8671a2(0,"AslpFileLargeGetCrcChecksum",0x379,"ViewFileSize  : %u");
      FUN_6b8671a2(0,"AslpFileLargeGetCrcChecksum",0x37a,"CrcViewOffset : %I64u");
      FUN_6b8671a2(1,"AslpFileLargeGetCrcChecksum",0x37e,
                   "Alignment error in the end of file view for CRC checksum");
      uVar3 = 0xc0000220;
    }
  }
  *in_FS_OFFSET = local_14;
  return uVar3;
}



int __fastcall FUN_6b86e54f(int *param_1,undefined4 *param_2)

{
  undefined4 *puVar1;
  int iVar2;
  uint uVar3;
  int in_FS_OFFSET;
  undefined4 uVar4;
  char *pcVar5;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  int *local_10;
  undefined4 *local_c;
  undefined4 *local_8;
  
  local_10 = param_1;
  local_c = param_2;
  puVar1 = (undefined4 *)
           RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,0x28);
  if (puVar1 == (undefined4 *)0x0) {
    return -0x3fffffe9;
  }
  local_28 = 0x18;
  local_24 = 0;
  local_1c = 0;
  local_20 = 0;
  local_18 = 0;
  local_14 = 0;
  local_8 = puVar1;
  iVar2 = ZwCreateSection(puVar1 + 1,0xf0005,&local_28,0,2,0x8000000,*param_2);
  if (iVar2 < 0) {
    pcVar5 = "ZwCreateSection failed [%x]";
    uVar4 = 0x159;
  }
  else {
    uVar3 = param_2[2];
    iVar2 = param_2[3];
    puVar1[8] = uVar3 - 0x1000 & 0xffff0000;
    puVar1[9] = iVar2 - (uint)(uVar3 < 0x1000);
    iVar2 = ZwMapViewOfSection(puVar1[1],0xffffffff,puVar1 + 6,0,0,puVar1 + 8,puVar1 + 7,2,0x500000,
                               2);
    if (iVar2 < 0) {
      pcVar5 = "ZwMapViewOfSection failed to map the end of the file [%x]";
      uVar4 = 0x175;
    }
    else {
      uVar3 = 0x20000000;
      do {
        puVar1[3] = uVar3;
        puVar1[4] = 0;
        puVar1[5] = 0;
        iVar2 = ZwMapViewOfSection(puVar1[1],0xffffffff,puVar1 + 2,0,0,puVar1 + 4,puVar1 + 3,2,
                                   0x500000,2);
        uVar3 = uVar3 >> 1;
        if (iVar2 != -0x3fffffe9) break;
      } while (0xfffff < uVar3);
      if (-1 < iVar2) {
        *puVar1 = local_c;
        *local_10 = (int)puVar1;
        puVar1 = (undefined4 *)0x0;
        local_8 = (undefined4 *)0x0;
        iVar2 = 0;
        goto LAB_6b86e6a5;
      }
      pcVar5 = "ZwMapViewOfSection failed to map the start of the file [%x]";
      uVar4 = 0x19f;
    }
  }
  FUN_6b8671a2(1,"AslpFileLargeMapCreate",uVar4,pcVar5);
LAB_6b86e6a5:
  if (puVar1 != (undefined4 *)0x0) {
    FUN_6b86e6b8((int *)&local_8);
  }
  return iVar2;
}



void __fastcall FUN_6b86e6b8(int *param_1)

{
  int iVar1;
  int in_FS_OFFSET;
  
  if ((param_1 != (int *)0x0) && (iVar1 = *param_1, iVar1 != 0)) {
    FUN_6b86e6ff((int *)(iVar1 + 0x18));
    FUN_6b86e6ff((int *)(iVar1 + 8));
    if (*(int *)(iVar1 + 4) != 0) {
      ZwClose(*(undefined4 *)(iVar1 + 4));
    }
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iVar1);
    *param_1 = 0;
  }
  return;
}



void __fastcall FUN_6b86e6ff(int *param_1)

{
  if ((param_1 != (int *)0x0) && (*param_1 != 0)) {
    ZwUnmapViewOfSection(0xffffffff,*param_1);
    *param_1 = 0;
    param_1[1] = 0;
    param_1[2] = 0;
    param_1[3] = 0;
  }
  return;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

uint __fastcall FUN_6b86e726(int param_1,uint param_2)

{
  bool bVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  undefined3 extraout_var;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  undefined4 *in_FS_OFFSET;
  undefined4 uVar8;
  char *pcVar9;
  wchar_t *local_34;
  uint local_30;
  uint local_2c;
  uint local_28;
  int local_24;
  uint local_20 [3];
  undefined4 local_14;
  undefined4 uStack12;
  undefined4 local_8;
  
  uStack12 = 0x6b86e732;
  uVar6 = 0;
  local_28 = 0;
  local_20[0] = 0;
  local_30 = 0;
  uVar5 = 0;
  local_34 = (wchar_t *)0x0;
  local_8 = 0;
  local_24 = param_1;
  iVar2 = FUN_6b872c58(param_1,param_2,(int *)local_20,&local_28);
  uVar7 = local_20[0];
  if (iVar2 == 0) {
    FUN_6b8671a2(1,"SdbGetItemFromItemRef",0x4bd,"Can\'t convert tag ref");
    uVar7 = local_20[0];
  }
  else {
    uVar3 = FUN_6b86f000(local_20[0],local_28,0x404c);
    if ((uVar3 == 0) || (uVar5 = FUN_6b86f4a0(uVar7,uVar3,0), local_2c = uVar5, uVar5 == 0)) {
      if (uVar7 != *(uint *)(local_24 + 4)) {
        uVar3 = FUN_6b86f000(uVar7,0,0x7001);
        if (uVar3 == 0) {
          FUN_6b8671a2(1,"SdbGetItemFromItemRef",0x4da,"Can\'t find DATABASE tag in db");
        }
        else {
          uVar3 = FUN_6b86f000(uVar7,uVar3,0x7002);
          if ((uVar3 != 0) &&
             (((uVar4 = FUN_6b86f000(uVar7,local_28,0x6001), uVar4 == 0 ||
               (local_34 = (wchar_t *)FUN_6b86f2d7(uVar7,uVar4), local_34 == (wchar_t *)0x0)) ||
              (uVar5 = FUN_6b86ef6c(uVar7,uVar3,extraout_ECX,extraout_ECX,local_34),
              local_2c = uVar5, uVar5 != 0)))) goto LAB_6b86e900;
        }
      }
      uVar3 = FUN_6b86f000(*(uint *)(local_24 + 4),0,0x7001);
      if (uVar3 == 0) {
        pcVar9 = "Can\'t find DATABASE tag in main db";
        uVar8 = 0x502;
      }
      else {
        uVar3 = FUN_6b86f000(*(uint *)(local_24 + 4),uVar3,0x7002);
        if (uVar3 != 0) {
          uVar8 = extraout_ECX_00;
          if ((local_34 != (wchar_t *)0x0) ||
             ((uVar4 = FUN_6b86f000(uVar7,local_28,0x6001), uVar4 != 0 &&
              (local_34 = (wchar_t *)FUN_6b86f2d7(uVar7,uVar4), uVar8 = extraout_ECX_01,
              local_34 != (wchar_t *)0x0)))) {
            iVar2 = local_24;
            uVar5 = FUN_6b86ef6c(*(uint *)(local_24 + 4),uVar3,uVar8,uVar8,local_34);
            uVar7 = *(uint *)(iVar2 + 4);
            local_2c = uVar5;
            local_20[0] = uVar7;
          }
          goto LAB_6b86e900;
        }
        pcVar9 = "Can\'t find LIBRARY tag in main db";
        uVar8 = 0x508;
      }
      FUN_6b8671a2(1,"SdbGetItemFromItemRef",uVar8,pcVar9);
    }
  }
LAB_6b86e900:
  local_8 = 0xfffffffe;
  if (uVar5 != 0) {
    bVar1 = FUN_6b872c08(local_24,uVar7,uVar5,&local_30);
    uVar6 = -(uint)(CONCAT31(extraout_var,bVar1) != 0) & local_30;
  }
  if (uVar6 == 0) {
    FUN_6b8671a2(3,"SdbGetItemFromItemRef",0x536,"Can\'t find tag for tag ref 0x%x");
  }
  *in_FS_OFFSET = local_14;
  return uVar6;
}



// WARNING: Could not reconcile some variable overlaps

undefined4 __fastcall FUN_6b86e950(uint param_1,ushort *param_2)

{
  int iVar1;
  uint uVar2;
  ushort *puVar3;
  undefined4 local_8;
  
  if ((ushort)param_1 == 0xffff) {
    return 0;
  }
  local_8 = CONCAT22((short)(param_1 >> 0x10),0xffff);
  if (param_2 != (ushort *)0x0) {
    local_8._0_2_ = *param_2;
    local_8 = param_1 & 0xffff0000 | (uint)(ushort)local_8;
    if ((ushort)local_8 != 0xffff) goto LAB_6b86e9ac;
  }
  iVar1 = FUN_6b86a619((undefined2 *)&local_8,(undefined2 *)0x0);
  if (iVar1 < 0) {
    FUN_6b8671a2(1,"SdbGuestHostArchsToRuntimePlatformFlag",0xf9,
                 "AslEnvGetProcessWowInfo failed to determine processor info [%x]");
    return 0;
  }
LAB_6b86e9ac:
  uVar2 = 0;
  puVar3 = &DAT_6b88eeb6;
  while (((ushort)param_1 != puVar3[-1] || ((ushort)local_8 != *puVar3))) {
    uVar2 = uVar2 + 1;
    puVar3 = puVar3 + 8;
    if (6 < uVar2) {
      return 0;
    }
  }
  return (&DAT_6b88eeb8)[uVar2 * 4];
}



uint FUN_6b86e9d4(void)

{
  int iVar1;
  uint uVar2;
  undefined2 extraout_var;
  uint uVar3;
  uint uVar4;
  ushort local_8 [2];
  
  uVar4 = 0;
  iVar1 = FUN_6b86a619(local_8,(undefined2 *)0x0);
  if (iVar1 < 0) {
    FUN_6b8671a2(1,"SdbGuestTargetPlatformFlagsToRuntimePlatformFlags",0x146,
                 "AslEnvGetProcessWowInfo failed to determine processor info [%x]");
  }
  else {
    uVar3 = 0;
    do {
      if ((((&DAT_6b88ee78)[uVar3] & 0x1f) != 0) &&
         (iVar1 = FUN_6b86aaa8((short *)local_8,*(short *)((int)&DAT_6b88ee74 + uVar3)), -1 < iVar1)
         ) {
        uVar2 = FUN_6b86e950(CONCAT22(extraout_var,*(undefined2 *)((int)&DAT_6b88ee74 + uVar3)),
                             local_8);
        uVar4 = uVar4 | uVar2;
      }
      uVar3 = uVar3 + 0xc;
    } while (uVar3 < 0x3c);
  }
  return uVar4;
}



// WARNING: Function: __SEH_prolog4_GS replaced with injection: SEH_prolog4

int FUN_6b86ea48(uint param_1)

{
  int iVar1;
  int iVar2;
  int **ppiVar3;
  undefined extraout_CL;
  undefined4 uVar4;
  undefined extraout_DL;
  char *pcVar5;
  undefined4 *in_FS_OFFSET;
  wchar_t local_228 [266];
  undefined4 local_14;
  undefined4 uStack12;
  undefined *local_8;
  
  local_8 = &DAT_6b892a40;
  uStack12 = 0x6b86ea57;
  memset(local_228,0,0x208);
  FUN_6b8671a2(3,"SdbInitDatabaseEx",0x20f,"Flags:%d; DatabasePath:%ws");
  iVar1 = RtlAllocateHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),8,0x280);
  if (iVar1 == 0) {
    FUN_6b8671a2(1,"SdbInitDatabaseEx",0x217,"Failed to allocate sdb context");
  }
  else {
    *(short *)(iVar1 + 0x1a8) = (short)param_1;
    iVar2 = FUN_6b86ef32(local_228,extraout_DL,extraout_CL,extraout_CL,(char)param_1);
    if (iVar2 < 0) {
      uVar4 = 0x226;
      pcVar5 = "SdbpResolveInitSdbPath failed to resolve the sdb path [%x]";
    }
    else {
      local_8 = (undefined *)0x0;
      ppiVar3 = FUN_6b86fbb6(local_228);
      *(int ***)(iVar1 + 4) = ppiVar3;
      local_8 = (undefined *)0xfffffffe;
      iVar2 = *(int *)(iVar1 + 4);
      if (iVar2 != 0) {
        *(int *)(iVar1 + 0x24) = iVar2;
        *(undefined4 *)(iVar1 + 0x28) = 3;
        *(undefined4 *)(iVar1 + 0x14) = *(undefined4 *)(iVar2 + 0x14);
        *(undefined4 *)(iVar1 + 0x18) = *(undefined4 *)(iVar2 + 0x18);
        *(undefined4 *)(iVar1 + 0x1c) = *(undefined4 *)(iVar2 + 0x1c);
        *(undefined4 *)(iVar1 + 0x20) = *(undefined4 *)(iVar2 + 0x20);
        *(uint *)(iVar1 + 0x10) = *(uint *)(iVar1 + 0x10) | 1;
        FUN_6b8726dc(iVar1);
        uVar4 = FUN_6b86ecb1(param_1);
        *(undefined4 *)(iVar1 + 0x194) = uVar4;
        FUN_6b86ed28((int *)(iVar1 + 0x1a0));
        goto LAB_6b86ebb2;
      }
      uVar4 = 0x239;
      pcVar5 = "Unable to open main database %S";
    }
    FUN_6b8671a2(1,"SdbInitDatabaseEx",uVar4,pcVar5);
    if (*(int ***)(iVar1 + 4) != (int **)0x0) {
      FUN_6b86f964(*(int ***)(iVar1 + 4));
    }
    RtlFreeHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),0,iVar1);
  }
  iVar1 = 0;
LAB_6b86ebb2:
  *in_FS_OFFSET = local_14;
  return iVar1;
}



undefined4 __fastcall FUN_6b86ebc4(int param_1)

{
  uint uVar1;
  
  if ((*(uint *)(param_1 + 0x10) & 0xfff8) != 0) {
    uVar1 = 3;
    do {
      if ((*(uint *)(param_1 + 0x10) & 1 << ((byte)uVar1 & 0x1f)) != 0) {
        FUN_6b86ec05(param_1,uVar1);
      }
      uVar1 = uVar1 + 1;
    } while (uVar1 < 0x10);
  }
  if (*(int *)(param_1 + 8) != 0) {
    FUN_6b86ec05(param_1,1);
  }
  return 1;
}



undefined4 __thiscall FUN_6b86ec05(int this,uint param_2)

{
  undefined4 uVar1;
  int iVar2;
  undefined4 *puVar3;
  
  if ((param_2 < 0x10) && ((*(uint *)(this + 0x10) & 1 << ((byte)param_2 & 0x1f)) != 0)) {
    puVar3 = (undefined4 *)(this + 0x14 + param_2 * 0x18);
    if (((*(byte *)(puVar3 + 5) & 2) != 0) && ((int **)puVar3[4] != (int **)0x0)) {
      FUN_6b86f964((int **)puVar3[4]);
    }
    for (iVar2 = 6; iVar2 != 0; iVar2 = iVar2 + -1) {
      *puVar3 = 0;
      puVar3 = puVar3 + 1;
    }
    *(uint *)(this + 0x10) = *(uint *)(this + 0x10) & ~(1 << (param_2 & 0x1f));
    if (param_2 == 1) {
      *(undefined4 *)(this + 8) = 0;
    }
    uVar1 = 1;
  }
  else {
    uVar1 = 0;
  }
  return uVar1;
}



undefined4 __fastcall FUN_6b86ec63(int param_1,int param_2,undefined4 param_3,uint *param_4)

{
  uint uVar1;
  int *piVar2;
  
  uVar1 = 0;
  piVar2 = (int *)(param_1 + 0x24);
  while ((((*(uint *)(param_1 + 0x10) & 1 << ((byte)uVar1 & 0x1f)) == 0 ||
          ((*(byte *)(piVar2 + 1) & 2) == 0)) || (param_2 != *piVar2))) {
    uVar1 = uVar1 + 1;
    piVar2 = piVar2 + 6;
    if (0xf < uVar1) {
      return 0;
    }
  }
  if (param_4 == (uint *)0x0) {
    return 1;
  }
  *param_4 = uVar1;
  return 1;
}



undefined4 __fastcall FUN_6b86ecb1(uint param_1)

{
  uint uVar1;
  int iVar2;
  undefined4 uVar3;
  ushort extraout_var;
  uint uVar4;
  ushort extraout_var_00;
  uint *extraout_EDX;
  uint *puVar5;
  uint local_c;
  undefined4 local_8;
  
  local_c = param_1;
  if ((short)param_1 == 0x7fff) {
    local_8 = CONCAT22((short)(param_1 >> 0x10),0xffff);
  }
  else {
    local_8 = param_1;
    uVar1 = FUN_6b86ab18((short)param_1);
    uVar4 = uVar1 & 0xffff | (uint)extraout_var << 0x10;
    local_8 = local_8 & 0xffff0000 | uVar1 & 0xffff;
    puVar5 = extraout_EDX;
    if ((short)uVar1 != -1) goto LAB_6b86ed21;
  }
  iVar2 = FUN_6b86a619((undefined2 *)&local_c,(undefined2 *)&local_8);
  if (iVar2 < 0) {
    FUN_6b8671a2(1,"SdbpGetBinaryRuntimePlatform",0xd7,
                 "AslEnvGetProcessWowInfo failed to determine processor info [%x]");
    return 0;
  }
  uVar4 = local_8 & 0xffff | (uint)extraout_var_00 << 0x10;
  puVar5 = &local_c;
LAB_6b86ed21:
  uVar3 = FUN_6b86e950(uVar4,(ushort *)puVar5);
  return uVar3;
}



void __fastcall FUN_6b86ed28(int *param_1)

{
  undefined4 extraout_EDX;
  undefined4 local_124;
  undefined local_120 [278];
  char local_a;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  memset(local_120,0,0x118);
  local_124 = 0x11c;
  RtlGetVersion(&local_124);
  *param_1 = (local_a != '\x01') + 1;
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,extraout_EDX);
  return;
}



void __fastcall
FUN_6b86ed86(int param_1,undefined4 *param_2,undefined4 param_3,undefined4 *param_4,uint *param_5)

{
  uint *puVar1;
  uint uVar2;
  int **ppiVar3;
  int **extraout_EDX;
  int **extraout_EDX_00;
  uint uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  char *pcVar7;
  uint local_220;
  undefined4 *local_21c;
  wchar_t local_218 [262];
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  uVar4 = *param_5;
  local_220 = 0;
  local_21c = (undefined4 *)0x0;
  if ((uVar4 & 0xf0000000) != 0) {
    uVar4 = uVar4 >> 0x1c;
  }
  if (uVar4 < 0x10) {
    FUN_6b86ec05(param_1,uVar4);
    uVar2 = FUN_6b870232(param_1,param_2,&local_220,(uint *)&local_21c,local_218);
    if ((uVar2 == 0) || (0x103 < uVar2)) {
      pcVar7 = "Cannot resolve database, the path length is 0x%lx";
      uVar6 = 0x41d;
      goto LAB_6b86ef0e;
    }
    if ((*(short *)(param_1 + 0x1a8) == 0x7fff) ||
       (((uint)local_21c & *(uint *)(param_1 + 0x194)) != 0)) {
      ppiVar3 = FUN_6b86fbb6(local_218);
      if (ppiVar3 == (int **)0x0) {
        FUN_6b8671a2(1,"SdbpOpenLocalDatabaseEx",0x442,"Failed to open database");
        ppiVar3 = extraout_EDX;
      }
      else {
        local_220 = uVar4 * 0x18;
        *(int ***)(local_220 + 0x24 + param_1) = ppiVar3;
        *(undefined4 *)(local_220 + 0x28 + param_1) = 2;
        *(uint *)(param_1 + 0x10) = *(uint *)(param_1 + 0x10) | 1 << (uVar4 & 0x1f);
        local_21c = (undefined4 *)(param_1 + 0x14 + local_220);
        if (param_2 == (undefined4 *)0x0) {
          *local_21c = 0;
          local_21c[1] = 0;
          local_21c[2] = 0;
          local_21c[3] = 0;
        }
        else {
          *local_21c = *param_2;
          local_21c[1] = param_2[1];
          local_21c[2] = param_2[2];
          local_21c[3] = param_2[3];
          puVar1 = (uint *)(local_220 + 0x28 + param_1);
          *puVar1 = *puVar1 | 1;
        }
        if (uVar4 == 1) {
          *(int ***)(param_1 + 8) = ppiVar3;
        }
        *param_5 = uVar4 << 0x1c;
        if (param_4 != (undefined4 *)0x0) {
          *param_4 = ppiVar3;
        }
      }
      goto LAB_6b86ef1f;
    }
    pcVar7 = "Database \"%ws\" is not of the same type as the main EXE";
    uVar6 = 0x432;
    uVar5 = 3;
  }
  else {
    pcVar7 = "Bad index 0x%lx";
    uVar6 = 0x3fb;
LAB_6b86ef0e:
    uVar5 = 1;
  }
  FUN_6b8671a2(uVar5,"SdbpOpenLocalDatabaseEx",uVar6,pcVar7);
  ppiVar3 = extraout_EDX_00;
LAB_6b86ef1f:
  FUN_6b8224af(local_c ^ (uint)&stack0xfffffffc,ppiVar3);
  return;
}



undefined4 __fastcall
FUN_6b86ef32(void *param_1,undefined param_2,undefined param_3,undefined param_4,undefined param_5)

{
  bool bVar1;
  undefined3 extraout_var;
  undefined4 uVar2;
  
  bVar1 = FUN_6b870212(param_1,1,&param_5);
  if (CONCAT31(extraout_var,bVar1) == 0) {
    FUN_6b8671a2(1,"SdbpResolveInitSdbPath",0x1d2,
                 "SdbGetPathSystemSdb failed to get file path for SDB_SYSTEM");
    uVar2 = 0xc0000001;
  }
  else {
    uVar2 = 0;
  }
  return uVar2;
}



uint __fastcall
FUN_6b86ef6c(uint param_1,int param_2,undefined4 param_3,undefined4 param_4,wchar_t *param_5)

{
  uint uVar1;
  uint uVar2;
  wchar_t *_Str2;
  int iVar3;
  
  uVar1 = FUN_6b86facb(param_1,param_2);
  do {
    if (uVar1 == 0) {
      return 0;
    }
    uVar2 = FUN_6b86fb78(param_1,uVar1);
    if (((short)uVar2 == 0x702b) && (uVar2 = FUN_6b86f000(param_1,uVar1,0x6001), uVar2 != 0)) {
      _Str2 = (wchar_t *)FUN_6b86f2d7(param_1,uVar2);
      if (_Str2 == (wchar_t *)0x0) {
        FUN_6b8671a2(1,"SdbFindFirstNamedTag",0x98,"Can\'t get the name string");
        return 0;
      }
      iVar3 = _wcsicmp(param_5,_Str2);
      if (iVar3 == 0) {
        return uVar1;
      }
    }
    uVar1 = FUN_6b86fb0f(param_1,param_2,uVar1);
  } while( true );
}



uint __fastcall FUN_6b86f000(uint param_1,int param_2,short param_3)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  
  uVar1 = FUN_6b86facb(param_1,param_2);
  while ((uVar3 = 0, uVar1 != 0 &&
         (uVar2 = FUN_6b86fb78(param_1,uVar1), uVar3 = uVar1, (short)uVar2 != param_3))) {
    uVar1 = FUN_6b86fb0f(param_1,param_2,uVar1);
  }
  return uVar3;
}



undefined4 __fastcall FUN_6b86f046(int param_1,uint param_2,short param_3)

{
  bool bVar1;
  int iVar2;
  uint uVar3;
  undefined3 extraout_var;
  undefined4 uVar4;
  char *pcVar5;
  uint local_10;
  uint local_c;
  uint local_8;
  
  local_8 = 0;
  local_c = 0;
  local_10 = 0;
  iVar2 = FUN_6b872c58(param_1,param_2,(int *)&local_8,&local_c);
  if (iVar2 == 0) {
    pcVar5 = "Can\'t convert tag ref";
    uVar4 = 0x1bc;
  }
  else {
    uVar3 = FUN_6b86f000(local_8,local_c,param_3);
    if (uVar3 == 0) {
      return 0;
    }
    bVar1 = FUN_6b872c08(param_1,local_8,uVar3,&local_10);
    if (CONCAT31(extraout_var,bVar1) != 0) {
      return local_10;
    }
    pcVar5 = "Can\'t convert TAGID";
    uVar4 = 0x1c9;
  }
  FUN_6b8671a2(1,"SdbFindFirstTagRef",uVar4,pcVar5);
  return 0;
}



uint __fastcall FUN_6b86f0c5(uint param_1,int param_2,uint param_3)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = FUN_6b86fb78(param_1,param_3);
  if ((short)uVar1 == 0) {
    FUN_6b8671a2(1,"SdbFindNextTag",0x5e,"Invalid tagid 0x%lx");
    param_3 = 0;
  }
  else {
    do {
      param_3 = FUN_6b86fb0f(param_1,param_2,param_3);
      if (param_3 == 0) {
        return 0;
      }
      uVar2 = FUN_6b86fb78(param_1,param_3);
    } while ((short)uVar2 != (short)uVar1);
  }
  return param_3;
}



undefined4 __fastcall FUN_6b86f139(int param_1,uint param_2,uint param_3)

{
  bool bVar1;
  int iVar2;
  uint uVar3;
  undefined3 extraout_var;
  undefined4 uVar4;
  char *pcVar5;
  uint local_18;
  uint local_14;
  uint local_10;
  uint local_c [2];
  
  local_18 = 0;
  local_10 = 0;
  local_14 = 0;
  local_c[0] = 0;
  iVar2 = FUN_6b872c58(param_1,param_2,(int *)&local_18,&local_10);
  if (iVar2 == 0) {
    pcVar5 = "Can\'t convert tag ref trParent";
    uVar4 = 0x1ee;
  }
  else {
    iVar2 = FUN_6b872c58(param_1,param_3,(int *)&local_18,&local_14);
    if (iVar2 == 0) {
      pcVar5 = "Can\'t convert tag ref trPrev";
      uVar4 = 499;
    }
    else {
      uVar3 = FUN_6b86f0c5(local_18,local_10,local_14);
      if (uVar3 == 0) {
        return 0;
      }
      bVar1 = FUN_6b872c08(param_1,local_18,uVar3,local_c);
      if (CONCAT31(extraout_var,bVar1) != 0) {
        return local_c[0];
      }
      pcVar5 = "Can\'t convert TAGID";
      uVar4 = 0x200;
    }
  }
  FUN_6b8671a2(1,"SdbFindNextTagRef",uVar4,pcVar5);
  return 0;
}



bool FUN_6b86f1f0(undefined4 param_1,uint param_2,uint **param_3)

{
  uint uVar1;
  bool bVar2;
  
  if (param_2 == 0) {
    FUN_6b8671a2(1,"InitOnceGetStringTableOffset",0x2b2,
                 "PDB was not supplied for InitOnceGetStringTableOffset");
    bVar2 = false;
  }
  else if (param_3 == (uint **)0x0) {
    FUN_6b8671a2(1,"InitOnceGetStringTableOffset",0x2b8,
                 "No return context was supplied for InitOnceGetStringTableOffset");
    bVar2 = false;
  }
  else {
    uVar1 = FUN_6b86f000(param_2,0,0x7801);
    *(uint *)(param_2 + 0x534) = uVar1;
    bVar2 = uVar1 != 0;
    if (bVar2) {
      *param_3 = (uint *)(param_2 + 0x534);
    }
    else {
      FUN_6b8671a2(1,"InitOnceGetStringTableOffset",0x2c2,"No stringtable in DB");
    }
  }
  return bVar2;
}



int __fastcall FUN_6b86f285(uint param_1,int param_2)

{
  uint uVar1;
  int iVar2;
  
  uVar1 = FUN_6b86fb78(param_1,param_2);
  if (((ushort)uVar1 & 0xf000) != 0x9000) {
    FUN_6b86fb78(param_1,param_2);
    FUN_6b8671a2(1,"SdbGetBinaryTagData",0x3b4,"TagID 0x%08X, Tag %04X not BINARY type");
    return 0;
  }
  iVar2 = FUN_6b86f6a9(param_1,param_2);
  return iVar2;
}



int __fastcall FUN_6b86f2d7(uint param_1,int param_2)

{
  ushort uVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  char *pcVar5;
  
  if (param_1 == 0) {
    pcVar5 = "Invalid pdb";
    uVar4 = 0x27b;
  }
  else {
    uVar2 = FUN_6b86fb78(param_1,param_2);
    uVar1 = (ushort)uVar2 & 0xf000;
    if (uVar1 == 0x8000) {
      iVar3 = FUN_6b86f6a9(param_1,param_2);
      return iVar3;
    }
    if (uVar1 != 0x6000) {
      return 0;
    }
    iVar3 = FUN_6b86f868(param_1,param_2);
    if (iVar3 != 0) {
      iVar3 = FUN_6b86f657(param_1,iVar3);
      return iVar3;
    }
    pcVar5 = "Error getting StringRef";
    uVar4 = 0x28f;
  }
  FUN_6b8671a2(1,"SdbGetStringTagPtr",uVar4,pcVar5);
  return 0;
}



uint __fastcall FUN_6b86f359(uint param_1,int param_2)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  uint local_8;
  
  local_8 = param_1;
  uVar1 = FUN_6b86fb78(param_1,param_2);
  uVar1 = uVar1 & 0xf000;
  if (uVar1 == 0x1000) {
    uVar1 = 0;
  }
  else if (uVar1 == 0x2000) {
    uVar1 = 1;
  }
  else if (uVar1 == 0x3000) {
    uVar1 = 2;
  }
  else {
    if (uVar1 != 0x4000) {
      if (uVar1 == 0x5000) {
        uVar1 = 8;
        goto LAB_6b86f3e4;
      }
      if (uVar1 != 0x6000) {
        local_8 = 0;
        iVar2 = FUN_6b87008d(param_1,param_2 + 2,&local_8,4);
        uVar1 = local_8;
        if (iVar2 == 0) {
          FUN_6b8671a2(1,"SdbGetTagDataSize",0x116,"Error reading size data");
          uVar1 = local_8;
        }
        goto LAB_6b86f3e4;
      }
    }
    uVar1 = 4;
  }
LAB_6b86f3e4:
  uVar3 = FUN_6b867d76(uVar1,param_2,&local_8);
  if (((int)uVar3 < 0) ||
     (*(uint *)(param_1 + 0xc) <= local_8 && local_8 != *(uint *)(param_1 + 0xc))) {
    FUN_6b8671a2(1,"SdbGetTagDataSize",0x121,"Error reading size data");
    uVar1 = 0xffffffff;
  }
  return uVar1;
}



undefined4 __fastcall FUN_6b86f420(uint param_1,int param_2,void *param_3,uint param_4)

{
  uint uVar1;
  int iVar2;
  
  uVar1 = FUN_6b86fb78(param_1,param_2);
  if (((ushort)uVar1 & 0xf000) == 0x9000) {
    iVar2 = FUN_6b86f8eb(param_1,param_2,param_3,param_4);
    if (iVar2 != 0) {
      return 1;
    }
    FUN_6b8671a2(1,"SdbReadBinaryTag",0x39b,"Error reading buffer");
  }
  else {
    FUN_6b86fb78(param_1,param_2);
    FUN_6b8671a2(1,"SdbReadBinaryTag",0x396,"TagID 0x%08X, Tag %04X not BINARY type");
  }
  return 0;
}



undefined4 __fastcall FUN_6b86f4a0(uint param_1,int param_2,undefined4 param_3)

{
  uint uVar1;
  int iVar2;
  undefined4 local_8;
  
  local_8 = param_3;
  uVar1 = FUN_6b86fb78(param_1,param_2);
  if (((ushort)uVar1 & 0xf000) == 0x4000) {
    iVar2 = FUN_6b86f8eb(param_1,param_2,&local_8,4);
    if (iVar2 != 0) {
      param_3 = local_8;
    }
  }
  else {
    FUN_6b86fb78(param_1,param_2);
    FUN_6b8671a2(1,"SdbReadDWORDTag",0x96,"TagID 0x%X, Tag 0x%X not of the expected type");
  }
  return param_3;
}



undefined8 __fastcall FUN_6b86f510(uint param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  uint uVar1;
  int iVar2;
  undefined4 local_10;
  undefined4 local_c;
  uint local_8;
  
  local_10 = param_3;
  local_c = param_4;
  local_8 = param_1;
  uVar1 = FUN_6b86fb78(param_1,param_2);
  if (((ushort)uVar1 & 0xf000) == 0x5000) {
    iVar2 = FUN_6b86f8eb(local_8,param_2,&local_10,8);
    if (iVar2 != 0) goto LAB_6b86f588;
  }
  else {
    FUN_6b86fb78(local_8,param_2);
    FUN_6b8671a2(1,"SdbReadQWORDTag",0x9d,"TagID 0x%X, Tag 0x%X not of the expected type");
  }
  local_10 = param_3;
  local_c = param_4;
LAB_6b86f588:
  return CONCAT44(local_c,local_10);
}



uint __fastcall FUN_6b86f58f(uint param_1,int param_2)

{
  uint uVar1;
  undefined2 extraout_var;
  uint uVar2;
  undefined4 local_8;
  
  local_8 = CONCAT22((short)(param_1 >> 0x10),0xffff);
  uVar1 = FUN_6b86fb78(param_1,param_2);
  if (((ushort)uVar1 & 0xf000) == 0x3000) {
    uVar1 = FUN_6b86f8eb(param_1,param_2,&local_8,2);
    uVar2 = uVar1 & 0xffff0000 | 0xffff;
    if (uVar1 != 0) {
      uVar2 = uVar1 & 0xffff0000 | local_8 & 0xffff;
    }
  }
  else {
    FUN_6b86fb78(param_1,param_2);
    FUN_6b8671a2(1,"SdbReadWORDTag",0x8f,"TagID 0x%X, Tag 0x%X not of the expected type");
    uVar2 = CONCAT22(extraout_var,0xffff);
  }
  return uVar2;
}



uint __fastcall FUN_6b86f607(int param_1,uint param_2)

{
  int iVar1;
  uint uVar2;
  uint local_c;
  uint local_8;
  
  local_c = 0;
  local_8 = 0;
  iVar1 = FUN_6b872c58(param_1,param_2,(int *)&local_c,&local_8);
  if (iVar1 == 0) {
    FUN_6b8671a2(1,"SdbReadWORDTagRef",0xcb,"Can\'t convert tag ref");
    uVar2 = 0xffff;
  }
  else {
    uVar2 = FUN_6b86f58f(local_c,local_8);
  }
  return uVar2;
}



int __fastcall FUN_6b86f657(uint param_1,int param_2)

{
  uint uVar1;
  int iVar2;
  uint local_c;
  int local_8;
  
  local_8 = 0;
  local_c = 0;
  uVar1 = FUN_6b86f703(param_1,param_2,&local_8,&local_c);
  if (((uVar1 != 0) && (local_8 != 0)) && (local_c != 0)) {
    iVar2 = FUN_6b86f6a9(local_c,local_8);
    return iVar2;
  }
  FUN_6b8671a2(1,"SdbpGetMappedStringFromTable",0x37a,
               "SdbpGetStringTableItemFromStringRef failed to get tagid for string ref");
  return 0;
}



int __fastcall FUN_6b86f6a9(uint param_1,int param_2)

{
  int iVar1;
  
  iVar1 = FUN_6b86f81b(param_1,param_2);
  if ((uint)(iVar1 + param_2) < *(uint *)(param_1 + 0xc)) {
    iVar1 = *(int *)(param_1 + 4) + iVar1 + param_2;
    if (iVar1 != 0) {
      return iVar1;
    }
  }
  else {
    FUN_6b8671a2(1,"SdbpGetMappedData",0x2ea,
                 "Trying to read mapped data past the end of the database offset 0x%x size 0x%x");
    iVar1 = 0;
  }
  FUN_6b8671a2(1,"SdbpGetMappedTagData",0x1cf,"Error getting ptr to tag data");
  return iVar1;
}



uint __fastcall FUN_6b86f703(uint param_1,int param_2,int *param_3,uint *param_4)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  int *local_c;
  int local_8;
  
  local_8 = 0;
  uVar3 = 0;
  local_c = (int *)0x0;
  if (*(int *)(param_1 + 8) == 0) {
    uVar2 = RtlRunOnceExecuteOnce(param_1 + 0x530,FUN_6b86f1f0,param_1,&local_c);
    if ((int)uVar2 < 0) {
      FUN_6b8671a2(1,"SdbpGetStringTableItemFromStringRef",0x303,
                   "RtlRunOnceExecuteOnce failed for InitOnceGetStringTableOffset [%x]");
    }
    else {
      if ((local_c != (int *)0x0) && (iVar1 = *local_c, iVar1 != 0)) goto LAB_6b86f79b;
      FUN_6b8671a2(1,"SdbpGetStringTableItemFromStringRef",0x313,
                   "InitOnceGetStringTableOffset succeeded but failed to find string table");
      uVar2 = 0xc0000229;
    }
    if (-1 < (int)uVar2) goto LAB_6b86f800;
  }
  else {
    param_1 = *(uint *)(param_1 + 0x53c);
    if (param_1 == 0) {
      FUN_6b8671a2(1,"SdbpGetStringTableItemFromStringRef",0x2ef,"No stringtable in DB");
      uVar2 = 0xc0000225;
    }
    else {
      iVar1 = 6;
LAB_6b86f79b:
      local_8 = iVar1 + param_2;
      uVar3 = FUN_6b86fb78(param_1,local_8);
      if ((short)uVar3 == -0x77ff) {
        uVar2 = 0;
        uVar3 = param_1;
        goto LAB_6b86f800;
      }
      FUN_6b8671a2(1,"SdbpGetStringTableItemFromStringRef",0x321,"Pulled out a non-stringtable item"
                  );
      uVar2 = 0xc0000024;
    }
  }
  local_8 = 0;
  uVar3 = 0;
LAB_6b86f800:
  *param_3 = local_8;
  *param_4 = uVar3;
  return ~uVar2 >> 0x1f;
}



// WARNING: Could not reconcile some variable overlaps

int __fastcall FUN_6b86f81b(uint param_1,int param_2)

{
  int iVar1;
  uint local_8;
  
  local_8 = param_1;
  iVar1 = FUN_6b87008d(param_1,param_2,&local_8,2);
  if (iVar1 == 0) {
    FUN_6b8671a2(1,"SdbpGetTagHeadSize",0x5e,"Error reading tag");
    return 0;
  }
  return (-(uint)(((ushort)local_8 & 0xf000) < 0x7000) & 0xfffffffc) + 6;
}



undefined4 __fastcall FUN_6b86f868(uint param_1,int param_2)

{
  uint uVar1;
  int iVar2;
  undefined4 local_8;
  
  local_8 = 0;
  uVar1 = FUN_6b86fb78(param_1,param_2);
  if (((ushort)uVar1 & 0xf000) == 0x6000) {
    iVar2 = FUN_6b86f8eb(param_1,param_2,&local_8,4);
    if (iVar2 != 0) {
      return local_8;
    }
    FUN_6b8671a2(1,"SdbpReadStringRef",0x228,"Error reading data");
  }
  else {
    FUN_6b86fb78(param_1,param_2);
    FUN_6b8671a2(1,"SdbpReadStringRef",0x223,"TagID 0x%08X, Tag %04X not STRINGREF type");
  }
  return 0;
}



undefined4 __fastcall FUN_6b86f8eb(uint param_1,int param_2,void *param_3,uint param_4)

{
  uint uVar1;
  int iVar2;
  
  uVar1 = FUN_6b86f359(param_1,param_2);
  if (param_4 < uVar1) {
    FUN_6b8671a2(1,"SdbpReadTagData",0x160,"Buffer too small. Avail: %d, Need: %d");
  }
  else {
    iVar2 = FUN_6b86f81b(param_1,param_2);
    iVar2 = FUN_6b87008d(param_1,param_2 + iVar2,param_3,uVar1);
    if (iVar2 != 0) {
      return 1;
    }
    FUN_6b8671a2(1,"SdbpReadTagData",0x167,"Error reading tag data");
  }
  return 0;
}



void __fastcall FUN_6b86f964(int **param_1)

{
  int *piVar1;
  int in_FS_OFFSET;
  
  piVar1 = param_1[0x14f];
  if ((piVar1 != (int *)0x0) && (piVar1[2] == 1)) {
    if (piVar1[1] != 0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,piVar1[1]);
      piVar1 = param_1[0x14f];
    }
    if (piVar1 != (int *)0x0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,piVar1);
    }
    param_1[0x14f] = (int *)0x0;
    if (param_1[0x150] != (int *)0x0) {
      FUN_6b8740de(param_1[0x150]);
      param_1[0x150] = (int *)0x0;
    }
  }
  if ((((*(byte *)(param_1 + 4) & 8) != 0) && ((*(byte *)(param_1 + 4) & 1) != 0)) &&
     (param_1[1] != (int *)0x0)) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1[1]);
    param_1[1] = (int *)0x0;
    param_1[3] = (int *)0x0;
  }
  FUN_6b86af66(*param_1);
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1);
  return;
}



undefined4 __fastcall FUN_6b86fa0f(uint param_1,void *param_2)

{
  uint uVar1;
  int iVar2;
  undefined4 uVar3;
  char *pcVar4;
  
  uVar1 = *(uint *)(param_1 + 0x10);
  if ((uVar1 & 2) == 0) {
    uVar1 = FUN_6b86f000(param_1,0,0x7001);
    if (uVar1 == 0) {
      pcVar4 = "Failed to get root tag";
      uVar3 = 0x1b8;
    }
    else {
      uVar1 = FUN_6b86f000(param_1,uVar1,-0x6ff9);
      if (uVar1 != 0) {
        iVar2 = FUN_6b86f420(param_1,uVar1,(void *)(param_1 + 0x14),0x10);
        if (iVar2 == 0) {
          FUN_6b8671a2(1,"SdbGetDatabaseID",0x1c3,"Failed to read database id 0x%lx");
          return 0;
        }
        *(uint *)(param_1 + 0x10) = *(uint *)(param_1 + 0x10) | 2;
        uVar1 = *(uint *)(param_1 + 0x10);
        goto LAB_6b86fab6;
      }
      pcVar4 = "Failed to get the database id";
      uVar3 = 0x1be;
    }
    FUN_6b8671a2(1,"SdbGetDatabaseID",uVar3,pcVar4);
  }
  else {
LAB_6b86fab6:
    if ((uVar1 & 2) != 0) {
      memmove(param_2,(void *)(param_1 + 0x14),0x10);
      return 1;
    }
  }
  return 0;
}



uint __fastcall FUN_6b86facb(uint param_1,int param_2)

{
  uint uVar1;
  uint uVar2;
  
  if (param_2 == 0) {
    uVar2 = *(uint *)(param_1 + 0xc);
    uVar1 = 0xc;
  }
  else {
    uVar1 = FUN_6b86fb78(param_1,param_2);
    if (((ushort)uVar1 & 0xf000) != 0x7000) {
      return 0;
    }
    uVar2 = FUN_6b86ff5c(param_1,param_2);
    uVar1 = param_2 + 6;
  }
  return -(uint)(uVar1 < uVar2) & uVar1;
}



uint __fastcall FUN_6b86fb0f(uint param_1,int param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  
  if (param_2 == 0) {
    uVar1 = *(uint *)(param_1 + 0xc);
  }
  else {
    uVar1 = FUN_6b86fb78(param_1,param_2);
    if (((ushort)uVar1 & 0xf000) != 0x7000) {
      FUN_6b8671a2(1,"SdbGetNextChild",0x53c,"Trying to operate on non-list, non-root tag");
      return 0;
    }
    uVar1 = FUN_6b86ff5c(param_1,param_2);
  }
  uVar2 = FUN_6b86ff5c(param_1,param_3);
  return uVar2 & -(uint)(uVar2 < uVar1);
}



uint __fastcall FUN_6b86fb78(uint param_1,int param_2)

{
  uint uVar1;
  uint local_8;
  
  local_8 = param_1 & 0xffff0000;
  uVar1 = FUN_6b87008d(param_1,param_2,&local_8,2);
  if (uVar1 == 0) {
    FUN_6b8671a2(1,"SdbGetTagFromTagID",0x4bb,"Error reading data");
    return 0;
  }
  return uVar1 & 0xffff0000 | local_8 & 0xffff;
}



int ** __fastcall FUN_6b86fbb6(wchar_t *param_1)

{
  int *piVar1;
  int **_Dst;
  int iVar2;
  int *piVar3;
  int in_FS_OFFSET;
  undefined8 uVar4;
  undefined4 uVar5;
  char *pcVar6;
  int local_14 [2];
  int local_c;
  int **local_8;
  
  FUN_6b8671a2(3,"SdbOpenDatabaseEx",0x382,"Flags:%d; DatabasePath:%ws");
  _Dst = (int **)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,0x558);
  local_8 = _Dst;
  if (_Dst == (int **)0x0) {
    FUN_6b8671a2(1,"SdbOpenDatabaseEx",0x38a,"Failed to allocate DB structure");
    return (int **)0x0;
  }
  memset(_Dst,0,0x558);
  uVar4 = FUN_6b86ad74(_Dst,param_1);
  if ((int)uVar4 < 0) {
    pcVar6 = "Failed to create file mapping [%x]";
    uVar5 = 0x395;
  }
  else {
    piVar3 = *_Dst;
    piVar1 = (int *)piVar3[4];
    if (((piVar3[5] != 0) || ((int *)0x7fffffff < piVar1)) || (piVar1 < (int *)0x2a)) {
      pcVar6 = "Failed to open SDB - File size too large or small.";
      uVar5 = 0x39e;
LAB_6b86fd36:
      FUN_6b8671a2(1,"SdbOpenDatabaseEx",uVar5,pcVar6);
      goto LAB_6b86fd41;
    }
    iVar2 = FUN_6b86b052((int)piVar3,(uint)((ulonglong)uVar4 >> 0x20));
    if (iVar2 < 0) {
      pcVar6 = "Failed to map SDB [%x]";
      uVar5 = 0x3a4;
    }
    else {
      _Dst[2] = (int *)0x0;
      _Dst[3] = piVar1;
      piVar3 = *_Dst;
      if (piVar3 != (int *)0x0) {
        piVar3 = (int *)piVar3[6];
      }
      _Dst[1] = piVar3;
      iVar2 = FUN_6b87008d((uint)_Dst,0,local_14,0xc);
      if (iVar2 == 0) {
        pcVar6 = "Failed to read database header";
        uVar5 = 0x3b1;
        goto LAB_6b86fd36;
      }
      if (local_c == 0x66626473) {
        iVar2 = FUN_6b87010b((uint)_Dst,local_14);
        if (iVar2 != 0) {
          return _Dst;
        }
        goto LAB_6b86fd41;
      }
      if (local_c == 0x6662647a) {
        iVar2 = FUN_6b872e58((int *)&local_8);
        if (iVar2 != 0) {
          return local_8;
        }
        FUN_6b8671a2(1,"SdbOpenDatabaseEx",0x3c4,
                     "SdbpOpenCompressedDatabase failed to open compressed database.");
        _Dst = local_8;
        goto LAB_6b86fd41;
      }
      pcVar6 = "Magic does not match a valid value: 0x%lx";
      uVar5 = 0x3be;
    }
  }
  FUN_6b8671a2(1,"SdbOpenDatabaseEx",uVar5,pcVar6);
LAB_6b86fd41:
  if (_Dst != (int **)0x0) {
    FUN_6b86af66(*_Dst);
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,_Dst);
  }
  return (int **)0x0;
}



// WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4

void __fastcall FUN_6b86fd67(int param_1)

{
  int iVar1;
  int *piVar2;
  undefined4 *in_FS_OFFSET;
  undefined4 local_14;
  
  FUN_6b8671a2(3,"SdbReleaseDatabase",0x53,"Enter.");
  if (*(int *)(param_1 + 0x278) == 0) {
    if (0 < *(int *)(param_1 + 0x27c)) {
      FUN_6b8671a2(1,"SdbReleaseDatabase",0x72,
                   "Attempt to release SDB handle that still has unreleased duplicates.");
      goto LAB_6b86fe32;
    }
    FUN_6b86ebc4(param_1);
    if ((*(byte *)(param_1 + 0x58) & 2) != 0) {
      FUN_6b86f964(*(int ***)(param_1 + 0x54));
    }
    if (*(int ***)(param_1 + 4) != (int **)0x0) {
      FUN_6b86f964(*(int ***)(param_1 + 4));
    }
    FUN_6b870541(param_1);
  }
  else {
    LOCK();
    piVar2 = (int *)(*(int *)(param_1 + 0x27c) + 0x27c);
    iVar1 = *piVar2;
    *piVar2 = *piVar2 + -1;
    if (iVar1 + -1 < 0) {
      piVar2 = (int *)(*(int *)(param_1 + 0x27c) + 0x27c);
      LOCK();
      *piVar2 = *piVar2 + 1;
      FUN_6b8671a2(1,"SdbReleaseDatabase",100,"SDB Handle count was decremented after zero.");
    }
  }
  RtlFreeHeap(*(undefined4 *)(in_FS_OFFSET[0xc] + 0x18),0,param_1);
LAB_6b86fe32:
  *in_FS_OFFSET = local_14;
  return;
}



undefined4 __fastcall FUN_6b86fe49(wchar_t *param_1,uint **param_2)

{
  wchar_t wVar1;
  undefined4 uVar2;
  wchar_t *pwVar3;
  uint *puVar4;
  uint *puVar5;
  uint uVar6;
  wchar_t *pwVar7;
  wchar_t *pwVar8;
  int in_FS_OFFSET;
  
  if (param_1 == (wchar_t *)0x0) {
    FUN_6b8671a2(1,"SdbpCreateSearchPathPartsFromPath",0x56c,"Invalid argument");
    uVar2 = 0;
  }
  else {
    uVar6 = (uint)(*param_1 != L'\0');
    pwVar3 = param_1;
    while (pwVar3 = wcschr(pwVar3,L';'), pwVar3 != (wchar_t *)0x0) {
      uVar6 = uVar6 + 1;
      pwVar3 = pwVar3 + 1;
    }
    puVar4 = (uint *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                     (uVar6 - 1) * 0x18 + 0x1c);
    if (puVar4 == (uint *)0x0) {
      FUN_6b8671a2(1,"SdbpCreateSearchPathPartsFromPath",0x589,
                   "Failed to allocate search path parts");
      uVar2 = 0;
    }
    else {
      *puVar4 = uVar6;
      pwVar3 = param_1;
      do {
        wVar1 = *pwVar3;
        pwVar3 = pwVar3 + 1;
      } while (wVar1 != L'\0');
      pwVar3 = param_1 + ((int)pwVar3 - (int)(param_1 + 1) >> 1);
      if (param_1 <= pwVar3) {
        puVar5 = puVar4 + 2;
        pwVar7 = (wchar_t *)0x0;
        do {
          wVar1 = *pwVar3;
          pwVar8 = pwVar7;
          if (((((wVar1 != L'\\') || (pwVar8 = pwVar3, pwVar7 == (wchar_t *)0x0)) &&
               (pwVar7 = pwVar8, wVar1 == L';')) || (pwVar8 = pwVar7, param_1 == pwVar3)) &&
             (pwVar8 != (wchar_t *)0x0)) {
            if (wVar1 == L';') {
              pwVar3 = pwVar3 + 1;
            }
            puVar5[-1] = (uint)pwVar3;
            *puVar5 = ((int)pwVar8 - (int)pwVar3 >> 1) + 1;
            puVar5 = puVar5 + 6;
            pwVar8 = (wchar_t *)0x0;
          }
          pwVar3 = pwVar3 + -1;
          pwVar7 = pwVar8;
        } while (param_1 <= pwVar3);
      }
      *param_2 = puVar4;
      uVar2 = 1;
    }
  }
  return uVar2;
}



int __fastcall FUN_6b86ff5c(uint param_1,int param_2)

{
  uint uVar1;
  int iVar2;
  
  uVar1 = FUN_6b86fb78(param_1,param_2);
  if ((((ushort)uVar1 & 0xf000) == 0x7000) &&
     (uVar1 = FUN_6b86f359(param_1,param_2), uVar1 == 0xffffffff)) {
    FUN_6b8671a2(1,"SdbpGetNextTagId",0x4dd,"Reading from unfinished list");
    iVar2 = *(int *)(param_1 + 0xc);
  }
  else {
    iVar2 = FUN_6b86f81b(param_1,param_2);
    if (iVar2 == 0) {
      iVar2 = *(int *)(param_1 + 0xc);
    }
    else {
      uVar1 = FUN_6b86f359(param_1,param_2);
      if ((*(byte *)(param_1 + 0x528) & 1) == 0) {
        uVar1 = uVar1 + 1 & 0xfffffffe;
      }
      iVar2 = uVar1 + iVar2 + param_2;
    }
  }
  return iVar2;
}



undefined4 * __fastcall FUN_6b86ffda(undefined4 param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  int iVar2;
  int in_FS_OFFSET;
  int local_10 [3];
  
  puVar1 = (undefined4 *)
           RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,0x558);
  if (puVar1 == (undefined4 *)0x0) {
    FUN_6b8671a2(1,"SdbpOpenDatabaseInMemory",0x44d,"Failed to allocate DB structure");
  }
  else {
    puVar1[2] = 0;
    puVar1[4] = puVar1[4] | 1;
    *puVar1 = 0;
    puVar1[1] = param_1;
    puVar1[3] = param_2;
    iVar2 = FUN_6b87008d((uint)puVar1,0,local_10,0xc);
    if (iVar2 == 0) {
      FUN_6b8671a2(1,"SdbpOpenDatabaseInMemory",0x458,"Can\'t read database header");
    }
    else {
      iVar2 = FUN_6b87010b((uint)puVar1,local_10);
      if (iVar2 != 0) {
        return puVar1;
      }
    }
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar1);
  }
  return (undefined4 *)0x0;
}



undefined4 __fastcall FUN_6b87008d(uint param_1,int param_2,void *param_3,uint param_4)

{
  uint uVar1;
  uint local_8;
  
  local_8 = param_1;
  uVar1 = FUN_6b867d76(param_4,param_2,&local_8);
  if ((int)uVar1 < 0) {
    FUN_6b8671a2(1,"SdbpReadMappedData",0x2c8,
                 "Offset and region size add up to cause an integer overflow or underflow");
  }
  else {
    if (local_8 <= *(uint *)(param_1 + 0xc)) {
      memcpy(param_3,(void *)(*(int *)(param_1 + 4) + param_2),param_4);
      return 1;
    }
    FUN_6b8671a2(1,"SdbpReadMappedData",0x2cd,
                 "Attempt to read past the end of the database offset 0x%lx size 0x%lx (0x%lx)");
  }
  return 0;
}



undefined4 __fastcall FUN_6b87010b(uint param_1,int *param_2)

{
  int iVar1;
  
  iVar1 = *param_2;
  if (iVar1 == 1) {
    *(uint *)(param_1 + 0x528) = *(uint *)(param_1 + 0x528) | 1;
  }
  else if (iVar1 != 2) {
    if (iVar1 != 3) {
      FUN_6b8671a2(1,"SdbpValidateAndApplyCompatFlags",0x32a,
                   "MajorVersion mismatch, MajorVersion 0x%lx Expected 0x%lx");
      return 0;
    }
    goto LAB_6b87014c;
  }
  *(uint *)(param_1 + 0x528) = *(uint *)(param_1 + 0x528) | 2;
LAB_6b87014c:
  iVar1 = FUN_6b86fa0f(param_1,(void *)(param_1 + 0x14));
  if (iVar1 == 0) {
    FUN_6b8671a2(1,"SdbpValidateAndApplyCompatFlags",0x334,"Failed to get the database ID");
  }
  return 1;
}



void __thiscall FUN_6b87017a(void *this,int param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined extraout_DL;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar2;
  char *pcVar3;
  wchar_t local_60 [44];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  memset(local_60,0,0x56);
  uVar2 = extraout_ECX;
  if ((param_1 == 0) ||
     (iVar1 = FUN_6b870561(local_60,extraout_DL,param_1), uVar2 = extraout_ECX_00, -1 < iVar1)) {
    iVar1 = FUN_6b870bb5(this,7,uVar2,(int)local_60,param_2);
    uVar2 = extraout_EDX_00;
    if (-1 < iVar1) goto LAB_6b8701fa;
    pcVar3 = "SdbpGetSystemSdbFilePath failed [%x]";
    uVar2 = 0x604;
  }
  else {
    pcVar3 = "SdbpGetCustomSdbFileName failed [%x]";
    uVar2 = 0x5f8;
  }
  FUN_6b8671a2(1,"SdbGetPathCustomSdb",uVar2,pcVar3);
  uVar2 = extraout_EDX;
LAB_6b8701fa:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



bool __thiscall FUN_6b870212(void *this,int param_1,undefined4 param_2)

{
  int iVar1;
  
  iVar1 = FUN_6b870bb5(this,param_1,this,0,param_2);
  return -1 < iVar1;
}



int __fastcall FUN_6b870232(int param_1,void *param_2,uint *param_3,uint *param_4,short *param_5)

{
  short *psVar1;
  short sVar2;
  bool bVar3;
  int iVar4;
  undefined3 extraout_var;
  uint uVar5;
  int iVar6;
  int iVar7;
  int in_FS_OFFSET;
  undefined4 uVar8;
  char *pcVar9;
  undefined4 local_4c;
  undefined4 local_48;
  int *local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  uint local_34;
  int local_30;
  int local_2c;
  int local_28;
  int local_24;
  int local_20;
  uint local_1c;
  undefined **local_18;
  void *local_14;
  undefined **local_10;
  uint local_c;
  int local_8;
  
  iVar6 = 0;
  local_10 = (undefined **)0x0;
  local_1c = 0;
  local_24 = 0;
  local_8 = 0;
  local_2c = 0;
  local_28 = 0;
  local_34 = 0;
  local_30 = 0;
  iVar7 = 0;
  if (param_5 == (short *)0x0) {
    return 0;
  }
  local_c = 0;
  *param_5 = 0;
  local_18 = &_Buf1_6b8b0110;
  local_20 = param_1;
  local_14 = param_2;
  do {
    iVar4 = memcmp(*local_18,local_14,0x10);
    if (iVar4 == 0) {
      iVar4 = local_c * 0x10;
      local_18 = *(undefined ***)(&DAT_6b8b0114 + iVar4);
      local_c = *(uint *)(&DAT_6b8b0118 + iVar4);
      local_10 = local_18;
      if (*(int *)(&DAT_6b8b011c + iVar4) != 0) {
        bVar3 = FUN_6b870212(param_5,*(int *)(&DAT_6b8b011c + iVar4),local_20 + 0x1a8);
        if (CONCAT31(extraout_var,bVar3) == 0) {
          FUN_6b8671a2(1,"SdbResolveDatabaseEx",0x7bd,"SdbGetPathSystemSdb failed.");
        }
        else {
          psVar1 = param_5 + 1;
          do {
            sVar2 = *param_5;
            param_5 = param_5 + 1;
          } while (sVar2 != 0);
          iVar6 = (int)param_5 - (int)psVar1 >> 1;
        }
        if (param_3 != (uint *)0x0) {
          *param_3 = (uint)local_18;
        }
        if (param_4 == (uint *)0x0) {
          return iVar6;
        }
        uVar5 = FUN_6b86e9d4();
        *param_4 = uVar5;
        if (local_c == 0) {
          return iVar6;
        }
        *param_4 = uVar5 & 0x1b;
        return iVar6;
      }
      break;
    }
    local_c = local_c + 1;
    local_18 = local_18 + 4;
  } while (local_c < 3);
  iVar6 = FUN_6b869ec3((undefined2 *)&local_34);
  if (iVar6 < 0) {
    pcVar9 = "Failed to convert guid to string [%x]";
    uVar8 = 0x7d4;
  }
  else {
    local_18 = (undefined **)((local_34 & 0xffff) + 0xb8);
    local_24 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,local_18);
    if (local_24 != 0) {
      local_2c = (int)local_18 << 0x10;
      local_28 = local_24;
      RtlAppendUnicodeToString
                (&local_2c,
                 L"\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\InstalledSDB"
                );
      RtlAppendUnicodeToString(&local_2c,&DAT_6b88423c);
      RtlAppendUnicodeStringToString(&local_2c,&local_34);
      local_44 = &local_2c;
      local_4c = 0x18;
      local_48 = 0;
      local_40 = 0x40;
      local_3c = 0;
      local_38 = 0;
      iVar6 = ZwOpenKey(&local_8,0x80000100,&local_4c);
      if (iVar6 < 0) {
        FUN_6b8671a2(1,"SdbResolveDatabaseEx",0x7f9,"Failed to open Key \"%ws\" [%x]");
        goto LAB_6b870501;
      }
      if (param_3 == (uint *)0x0) {
LAB_6b87047e:
        if (param_4 != (uint *)0x0) {
          iVar6 = FUN_6b86777b(&local_1c,local_8,&DAT_6b880b40);
          if (iVar6 < 0) {
            FUN_6b8671a2(1,"SdbResolveDatabaseEx",0x815,"Failed to get runtime platform [%x]");
            param_3 = param_4;
            goto LAB_6b870467;
          }
          *param_4 = local_1c;
        }
        iVar6 = FUN_6b87017a(param_5,(int)local_14,local_20 + 0x1a8);
        if (iVar6 == 0) {
          FUN_6b8671a2(1,"SdbResolveDatabaseEx",0x81e,
                       "SdbGetPathCustomSdb failed to get the database path.");
        }
        else {
          psVar1 = param_5 + 1;
          do {
            sVar2 = *param_5;
            param_5 = param_5 + 1;
          } while (sVar2 != 0);
          iVar7 = (int)param_5 - (int)psVar1 >> 1;
        }
      }
      else {
        iVar6 = FUN_6b86777b(&local_10,local_8,&DAT_6b880b48);
        if (-1 < iVar6) {
          *param_3 = (uint)local_10 & 0x7fffffff;
          goto LAB_6b87047e;
        }
        FUN_6b8671a2(1,"SdbResolveDatabaseEx",0x805,"Failed to get database type [%x]");
LAB_6b870467:
        *param_3 = 0;
      }
      goto LAB_6b870501;
    }
    pcVar9 = "Failed to allocate %ld bytes for key path";
    uVar8 = 0x7e9;
  }
  FUN_6b8671a2(1,"SdbResolveDatabaseEx",uVar8,pcVar9);
LAB_6b870501:
  if (local_8 != 0) {
    ZwClose(local_8);
  }
  if (local_24 != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_24);
  }
  if (local_30 != 0) {
    FUN_6b86a2d0(&local_34);
  }
  return iVar7;
}



void __fastcall FUN_6b870541(int param_1)

{
  if (param_1 != 0) {
    while (*(int **)(param_1 + 0x1a4) != (int *)0x0) {
      FUN_6b870c92(param_1,*(int **)(param_1 + 0x1a4));
    }
  }
  return;
}



int __fastcall FUN_6b870561(wchar_t *param_1,undefined param_2,undefined4 param_3)

{
  int iVar1;
  undefined4 uVar2;
  char *pcVar3;
  
  *param_1 = L'\0';
  iVar1 = FUN_6b869e4b(param_1,param_2,param_3);
  if (iVar1 < 0) {
    pcVar3 = "AslGuidToString failed [%x]";
    uVar2 = 0x32b;
  }
  else {
    iVar1 = FUN_6b83282b(param_1,0x2b,(int)L".sdb");
    if (-1 < iVar1) {
      return 0;
    }
    pcVar3 = "RtlStringCchCatW failed [%x]";
    uVar2 = 0x331;
  }
  FUN_6b8671a2(1,"SdbpGetCustomSdbFileName",uVar2,pcVar3);
  return iVar1;
}



void FUN_6b8705d0(short *param_1,uint param_2,short *param_3)

{
  int iVar1;
  short *extraout_EDX;
  short *extraout_EDX_00;
  undefined4 *puVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  char *pcVar5;
  short local_224 [260];
  undefined4 local_1c [5];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  puVar2 = (undefined4 *)L"\\AppPatch";
  puVar3 = local_1c;
  for (iVar1 = 5; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar3 = *puVar2;
    puVar2 = puVar2 + 1;
    puVar3 = puVar3 + 1;
  }
  if (9 < param_2) {
    local_224[0] = 0;
    *param_1 = 0;
    if (param_3 == (short *)0x0) {
      param_3 = &DAT_6b884240;
    }
    iVar1 = FUN_6b868380((short *)local_1c,param_3,local_224,0x104);
    if (iVar1 < 0) {
      pcVar5 = "AslPathCombine failed [%x]";
      uVar4 = 0x3ab;
    }
    else {
      iVar1 = FUN_6b86848c(param_1,param_2,(int)local_224);
      param_3 = extraout_EDX;
      if (-1 < iVar1) goto LAB_6b870677;
      pcVar5 = "AslPathToSystemPathBuf failed [%x]";
      uVar4 = 0x3b1;
    }
    FUN_6b8671a2(1,"SdbpGetPathAppPatch",uVar4,pcVar5);
    param_3 = extraout_EDX_00;
  }
LAB_6b870677:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,param_3);
  return;
}



void __fastcall
FUN_6b870690(undefined4 param_1,undefined4 param_2,short *param_3,uint param_4,short *param_5,
            short *param_6)

{
  int iVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 *puVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  char *pcVar5;
  undefined2 local_230 [2];
  short local_22c [2];
  short local_228 [260];
  undefined4 local_20 [6];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  puVar2 = (undefined4 *)L"AppPatch64";
  puVar3 = local_20;
  for (iVar1 = 5; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar3 = *puVar2;
    puVar2 = puVar2 + 1;
    puVar3 = puVar3 + 1;
  }
  *(undefined2 *)puVar3 = *(undefined2 *)puVar2;
  if (param_4 < 0xb) goto LAB_6b8707c4;
  local_228[0] = 0;
  local_230[0] = 0xffff;
  local_22c[0] = -1;
  iVar1 = FUN_6b870b35(local_230,local_22c,param_6);
  if (iVar1 < 0) {
    pcVar5 = "SdbpGetProcessHostGuestArchitectures failed [%x]";
    uVar4 = 0x3e0;
  }
  else if ((local_22c[0] == 9) || (local_22c[0] == 0xc)) {
    if (param_5 == (short *)0x0) {
      param_5 = &DAT_6b884240;
    }
    iVar1 = FUN_6b868380((short *)local_20,param_5,local_228,0x104);
    if (-1 < iVar1) goto LAB_6b8707a5;
    pcVar5 = "AslPathCombine failed [%x]";
    uVar4 = 0x3ec;
  }
  else {
    if (param_5 == (short *)0x0) {
      param_5 = &DAT_6b884240;
    }
    iVar1 = FUN_6b8147b5(local_228,0x104,(int)param_5);
    if (-1 < iVar1) {
LAB_6b8707a5:
      FUN_6b8705d0(param_3,param_4,local_228);
      param_2 = extraout_EDX_00;
      goto LAB_6b8707c4;
    }
    pcVar5 = "RtlStringCchCopyW failed to copy FileName [%x]";
    uVar4 = 0x3f2;
  }
  FUN_6b8671a2(1,"SdbpGetPathAppPatchPreRS3",uVar4,pcVar5);
  param_2 = extraout_EDX;
LAB_6b8707c4:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,param_2);
  return;
}



void FUN_6b8707e0(short *param_1,uint param_2,short *param_3,short *param_4)

{
  int iVar1;
  short *extraout_EDX;
  short *extraout_EDX_00;
  undefined4 *puVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  char *pcVar5;
  undefined4 local_230;
  short local_22c [2];
  short local_228 [260];
  undefined4 local_20 [6];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  puVar2 = (undefined4 *)L"\\appraiser";
  puVar3 = local_20;
  for (iVar1 = 5; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar3 = *puVar2;
    puVar2 = puVar2 + 1;
    puVar3 = puVar3 + 1;
  }
  *(undefined2 *)puVar3 = *(undefined2 *)puVar2;
  if (10 < param_2) {
    *param_1 = 0;
    local_228[0] = 0;
    local_230 = CONCAT22(local_230._2_2_,0xffff);
    local_22c[0] = -1;
    if (param_3 == (short *)0x0) {
      param_3 = &DAT_6b884240;
    }
    iVar1 = FUN_6b868380((short *)local_20,param_3,local_228,0x104);
    if (iVar1 < 0) {
      pcVar5 = "AslPathCombine failed [%x]";
      uVar4 = 0x4bb;
    }
    else {
      iVar1 = FUN_6b870b35((undefined2 *)&local_230,local_22c,param_4);
      if (-1 < iVar1) {
        FUN_6b86a6c6(param_1,param_2,local_228,(short)local_230,local_22c);
        param_3 = extraout_EDX_00;
        goto LAB_6b8708d0;
      }
      pcVar5 = "SdbpGetProcessHostGuestArchitectures failed [%x]";
      uVar4 = 0x4c1;
    }
    FUN_6b8671a2(1,"SdbpGetPathAppraiser",uVar4,pcVar5);
    param_3 = extraout_EDX;
  }
LAB_6b8708d0:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,param_3);
  return;
}



void FUN_6b8708f0(short *param_1,uint param_2,short *param_3)

{
  int iVar1;
  short *extraout_EDX;
  short *extraout_EDX_00;
  undefined4 *puVar2;
  undefined4 *puVar3;
  short local_228 [260];
  undefined4 local_20 [6];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  puVar2 = (undefined4 *)L"\\CustomSDB";
  puVar3 = local_20;
  for (iVar1 = 5; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar3 = *puVar2;
    puVar2 = puVar2 + 1;
    puVar3 = puVar3 + 1;
  }
  *(undefined2 *)puVar3 = *(undefined2 *)puVar2;
  if (10 < param_2) {
    local_228[0] = 0;
    *param_1 = 0;
    if (param_3 == (short *)0x0) {
      param_3 = &DAT_6b884240;
    }
    iVar1 = FUN_6b868380((short *)local_20,param_3,local_228,0x104);
    if (iVar1 < 0) {
      FUN_6b8671a2(1,"SdbpGetPathCustomSdb",0x44a,"AslPathCombine failed [%x]");
      param_3 = extraout_EDX;
    }
    else {
      FUN_6b8705d0(param_1,param_2,local_228);
      param_3 = extraout_EDX_00;
    }
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,param_3);
  return;
}



void FUN_6b8709a0(short *param_1,uint param_2,short *param_3,short *param_4)

{
  int iVar1;
  short *extraout_EDX;
  short *extraout_EDX_00;
  undefined4 *puVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  char *pcVar5;
  undefined2 local_248 [2];
  short local_244 [2];
  short local_240 [260];
  undefined4 local_38 [8];
  undefined4 local_18;
  undefined4 uStack20;
  undefined4 uStack16;
  wchar_t wStack12;
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_18 = 0x750043;
  uStack20 = 0x740073;
  uStack16 = 0x6d006f;
  wStack12 = L'\0';
  puVar2 = (undefined4 *)L"Custom\\Custom64";
  puVar3 = local_38;
  for (iVar1 = 8; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar3 = *puVar2;
    puVar2 = puVar2 + 1;
    puVar3 = puVar3 + 1;
  }
  if (6 < param_2) {
    puVar2 = &local_18;
    *param_1 = 0;
    local_240[0] = 0;
    local_248[0] = 0xffff;
    local_244[0] = -1;
    iVar1 = FUN_6b870b35(local_248,local_244,param_4);
    if (iVar1 < 0) {
      pcVar5 = "SdbpGetProcessHostGuestArchitectures failed [%x]";
      uVar4 = 0x47b;
    }
    else {
      if ((local_244[0] == 9) || (local_244[0] == 0xc)) {
        puVar2 = local_38;
      }
      if (param_3 == (short *)0x0) {
        param_3 = &DAT_6b884240;
      }
      iVar1 = FUN_6b868380((short *)puVar2,param_3,local_240,0x104);
      if (-1 < iVar1) {
        FUN_6b8705d0(param_1,param_2,local_240);
        param_4 = extraout_EDX_00;
        goto LAB_6b870ab4;
      }
      pcVar5 = "AslPathCombine failed [%x]";
      uVar4 = 0x489;
    }
    FUN_6b8671a2(1,"SdbpGetPathCustomSdbPreRS3",uVar4,pcVar5);
    param_4 = extraout_EDX;
  }
LAB_6b870ab4:
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,param_4);
  return;
}



int FUN_6b870ad0(short *param_1,uint param_2,short *param_3,short *param_4)

{
  int iVar1;
  undefined4 uVar2;
  char *pcVar3;
  short local_c [2];
  short local_8 [2];
  
  iVar1 = FUN_6b870b35(local_c,local_8,param_4);
  if (iVar1 < 0) {
    pcVar3 = "SdbpGetProcessHostGuestArchitectures failed [%x]";
    uVar2 = 0x410;
  }
  else {
    iVar1 = FUN_6b86a7cb(param_1,param_2,param_3,local_c[0],local_8);
    if (-1 < iVar1) {
      return iVar1;
    }
    pcVar3 = "AslEnvGetSystem32DirPathBuf failed [%x]";
    uVar2 = 0x416;
  }
  FUN_6b8671a2(1,"SdbpGetPathSystem",uVar2,pcVar3);
  return iVar1;
}



// WARNING: Could not reconcile some variable overlaps

int __fastcall FUN_6b870b35(undefined2 *param_1,short *param_2,short *param_3)

{
  int iVar1;
  uint uVar2;
  undefined4 local_c;
  undefined4 local_8;
  
  local_8._2_2_ = (undefined2)((uint)param_1 >> 0x10);
  local_8 = CONCAT22(local_8._2_2_,0xffff);
  local_c = CONCAT22(local_8._2_2_,0xffff);
  iVar1 = FUN_6b86a619((undefined2 *)&local_c,(undefined2 *)&local_8);
  if (iVar1 < 0) {
    FUN_6b8671a2(1,"SdbpGetProcessHostGuestArchitectures",0x369,
                 "AslEnvGetProcessWowInfo failed [%x]");
    return iVar1;
  }
  if (param_3 != (short *)0x0) {
    uVar2 = FUN_6b86ab18(*param_3);
    local_8._0_2_ = (short)uVar2;
    if ((short)local_8 != -1) goto LAB_6b870ba0;
  }
LAB_6b870ba0:
  *param_1 = (undefined2)local_c;
  *param_2 = (short)local_8;
  return 0;
}



int __thiscall
FUN_6b870bb5(void *this,int param_1,undefined4 param_2,int param_3,undefined4 param_4)

{
  code *pcVar1;
  uint uVar2;
  int *piVar3;
  int iVar4;
  undefined4 uVar5;
  
  *(undefined2 *)this = 0;
  if ((param_1 == 0) || (9 < param_1)) {
    iVar4 = -0x3fffff0f;
  }
  else {
    uVar2 = 1;
    piVar3 = &DAT_6b880650;
    do {
      if (*piVar3 == param_1) {
        iVar4 = uVar2 * 0x10;
        if (iVar4 != -0x6b880640) {
          pcVar1 = *(code **)(&UNK_6b880648 + iVar4);
          if (pcVar1 == (code *)0x0) {
            FUN_6b8671a2(1,"SdbpGetSystemSdbFilePath",0x50f,
                         "SdbFileDetails missing function pointer for path.");
            return -0x3fffff1b;
          }
          if (param_3 == 0) {
            param_3 = *(int *)(&UNK_6b880644 + iVar4);
          }
          uVar5 = 0x104;
          _guard_check_icall();
          iVar4 = (*pcVar1)(this,uVar5,param_3,param_4);
          if (iVar4 < 0) {
            FUN_6b8671a2(1,"SdbpGetSystemSdbFilePath",0x519,
                         "GetPathFunction (for SdbFileType %d, IsLtRs3: %d) failed [%x]");
            return iVar4;
          }
          return 0;
        }
        break;
      }
      uVar2 = uVar2 + 1;
      piVar3 = piVar3 + 4;
    } while (uVar2 < 10);
    FUN_6b8671a2(1,"SdbpGetSystemSdbFilePath",0x501,
                 "SdbFileDetails missing array item for SdbFileType: %d");
    iVar4 = -0x3ffffddb;
  }
  return iVar4;
}



void __fastcall FUN_6b870c92(int param_1,int *param_2)

{
  int *piVar1;
  int in_FS_OFFSET;
  
  piVar1 = (int *)param_2[1];
  if (piVar1 == param_2) {
    *(undefined4 *)(param_1 + 0x1a4) = 0;
  }
  else {
    if (*(int **)(param_1 + 0x1a4) == param_2) {
      *(int *)(param_1 + 0x1a4) = *param_2;
      piVar1 = (int *)param_2[1];
    }
    *piVar1 = *param_2;
    *(int *)(*param_2 + 4) = param_2[1];
  }
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_2);
  return;
}



undefined4
FUN_6b870ce0(undefined4 *param_1,int param_2,uint param_3,undefined4 param_4,int param_5,int param_6
            )

{
  code *pcVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  char *pcVar5;
  
  pcVar1 = *(code **)(param_2 + 0x26c);
  *param_1 = 0;
  if (pcVar1 == (code *)0x0) {
    pcVar5 = "No device query callback specified";
    uVar4 = 0x7ee;
  }
  else {
    uVar2 = FUN_6b86f000(param_3,param_5,0x6001);
    if (uVar2 == 0) {
      pcVar5 = "Failed to read HWID attribute";
      uVar4 = 0x7f4;
    }
    else {
      iVar3 = FUN_6b86f2d7(param_3,uVar2);
      if (iVar3 != 0) {
        _guard_check_icall();
        uVar4 = (*pcVar1)(iVar3);
        *param_1 = uVar4;
        if (param_6 == 0) {
          return 1;
        }
        *(undefined4 *)(param_6 + 0x28) = 1;
        return 1;
      }
      pcVar5 = "Failed to get HWID";
      uVar4 = 0x7fa;
    }
  }
  FUN_6b8671a2(1,"SdbpCheckMatchingDevice",uVar4,pcVar5);
  return 0;
}



int FUN_6b870d80(int *param_1,int param_2,uint param_3,undefined4 param_4,int param_5,uint *param_6)

{
  wchar_t *pwVar1;
  wchar_t wVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  wchar_t *pwVar6;
  int in_FS_OFFSET;
  undefined4 uVar7;
  char *pcVar8;
  wchar_t *local_1c;
  wchar_t *local_18;
  int local_14;
  void **local_10;
  int *local_c;
  
  iVar5 = 0;
  local_14 = 0;
  uVar3 = FUN_6b86f000(param_3,param_5,0x6001);
  if (uVar3 != 0) {
    local_18 = (wchar_t *)FUN_6b86f2d7(param_3,uVar3);
    if (local_18 == (wchar_t *)0x0) {
      pcVar8 = "Failed to get the string from the database";
      uVar7 = 0x8f7;
    }
    else {
      pwVar1 = local_18 + 1;
      pwVar6 = local_18;
      do {
        wVar2 = *pwVar6;
        pwVar6 = pwVar6 + 1;
      } while (wVar2 != L'\0');
      if (((*(byte *)param_6 & 1) != 0) || (iVar4 = FUN_6b87270d(param_6), iVar4 != 0)) {
        local_c = (int *)param_6[9];
        if (0 < *local_c) {
          local_10 = (void **)(local_c + 1);
          do {
            local_1c = (wchar_t *)0x0;
            iVar4 = FUN_6b8728ef(param_2,(int)param_6,local_18,(int)pwVar6 - (int)pwVar1 >> 1,
                                 local_10,&local_1c);
            if (iVar4 == 0) {
              pcVar8 = "Failed to resolve matching dir";
              uVar7 = 0x91c;
              goto LAB_6b870dca;
            }
            local_14 = FUN_6b867200(local_1c);
            if (local_1c != (wchar_t *)0x0) {
              RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_1c);
            }
            if (local_14 != 0) {
              if (0 < iVar5) {
                param_6[10] = 1;
              }
              break;
            }
            iVar5 = iVar5 + 1;
            local_10 = local_10 + 6;
          } while (iVar5 < *local_c);
        }
        wVar2 = *local_18;
        if (((wVar2 == L'%') || (wVar2 == L'\\')) || (wVar2 == L'.')) {
          param_6[10] = 1;
        }
        goto LAB_6b870ead;
      }
      pcVar8 = "Failed to initialize SEARCHDBCONTEXT";
      uVar7 = 0x904;
    }
LAB_6b870dca:
    FUN_6b8671a2(1,"SdbpCheckMatchingDir",uVar7,pcVar8);
  }
LAB_6b870ead:
  *param_1 = local_14;
  return local_14;
}



// WARNING: Could not reconcile some variable overlaps

undefined4
FUN_6b870ee0(int *param_1,int param_2,uint param_3,undefined4 param_4,int param_5,uint *param_6)

{
  wchar_t wVar1;
  int *piVar2;
  uint uVar3;
  int iVar4;
  int extraout_ECX;
  wchar_t *pwVar5;
  undefined4 uVar6;
  wchar_t *pwVar7;
  int in_FS_OFFSET;
  int *local_30;
  int *local_2c;
  undefined4 local_28;
  wchar_t *local_24;
  int local_20;
  void **local_1c;
  int local_18;
  wchar_t *local_14;
  int *local_10;
  int local_c;
  
  pwVar7 = (wchar_t *)0x0;
  local_c = 0;
  local_28 = 0;
  local_20 = 0;
  local_24 = (wchar_t *)0x0;
  local_30 = (int *)0x0;
  if (param_6[0xb] == 0) {
    uVar3 = FUN_6b86f000(param_3,param_5,0x6001);
    if (uVar3 != 0) {
      local_14 = (wchar_t *)FUN_6b86f2d7(param_3,uVar3);
      if (local_14 == (wchar_t *)0x0) {
        FUN_6b8671a2(1,"SdbpCheckMatchingFiles",0x984,"Failed to get the string from the database");
      }
      else if (((int *)param_6[1] == (int *)0x0) || (*local_14 != L'*')) {
        pwVar5 = local_14;
        do {
          wVar1 = *pwVar5;
          pwVar5 = pwVar5 + 1;
        } while (wVar1 != (wchar_t)local_c);
        local_c = (int)pwVar5 - (int)(local_14 + 1) >> 1;
        if (((*(byte *)param_6 & 1) != 0) || (iVar4 = FUN_6b87270d(param_6), iVar4 != 0)) {
          local_10 = (int *)param_6[9];
          local_18 = 0;
          if (0 < *local_10) {
            local_1c = (void **)(local_10 + 1);
            do {
              iVar4 = FUN_6b8728ef(param_2,(int)param_6,local_14,local_c,local_1c,&local_24);
              pwVar7 = local_24;
              if (iVar4 == 0) {
                FUN_6b8671a2(1,"SdbpCheckMatchingFiles",0x9cf,"Failed to resolve matching file");
                uVar6 = local_28;
                pwVar7 = local_24;
                goto LAB_6b870f5c;
              }
              local_2c = (int *)0x0;
              iVar4 = FUN_6b86ad74(&local_2c,local_24);
              piVar2 = local_2c;
              if (-1 < iVar4) {
                local_30 = local_2c;
                iVar4 = FUN_6b872fe1(&local_20,param_2,param_3,param_5,local_2c);
                if (-1 < iVar4) {
                  if (0 < local_18) {
                    param_6[10] = 1;
                  }
                  break;
                }
                FUN_6b86af66(piVar2);
                local_2c = (int *)0x0;
              }
              if (pwVar7 != (wchar_t *)0x0) {
                RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pwVar7);
              }
              local_1c = local_1c + 6;
              pwVar7 = (wchar_t *)0x0;
              local_18 = local_18 + 1;
              local_24 = (wchar_t *)0x0;
              local_30 = local_2c;
            } while (local_18 < *local_10);
          }
          wVar1 = *local_14;
          if (((wVar1 == L'%') || (wVar1 == L'\\')) || (wVar1 == L'.')) {
            param_6[10] = 1;
          }
          goto LAB_6b870f13;
        }
        FUN_6b8671a2(1,"SdbpCheckMatchingFiles",0x9b7,"Failed to initialize SEARCHDBCONTEXT");
      }
      else {
        iVar4 = FUN_6b872fe1(&local_20,param_2,param_3,param_5,(int *)param_6[1]);
        iVar4 = FUN_6b86737b(iVar4);
        if ((iVar4 != 0) || (-1 < extraout_ECX)) {
          uVar6 = 1;
          goto LAB_6b870f5c;
        }
        FUN_6b8671a2(1,"SdbpCheckMatchingFiles",0x99d,"Failed to check file attributes [%x]");
      }
    }
    uVar6 = 0;
  }
  else {
    local_20 = 1;
LAB_6b870f13:
    uVar6 = 1;
  }
LAB_6b870f5c:
  FUN_6b86af66(local_30);
  if (pwVar7 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pwVar7);
  }
  *param_1 = local_20;
  return uVar6;
}



undefined4
FUN_6b871170(undefined4 *param_1,undefined4 param_2,uint param_3,undefined4 param_4,int param_5,
            int param_6)

{
  int iVar1;
  undefined4 uVar2;
  char *pcVar3;
  int local_2c;
  int local_28;
  undefined4 local_24;
  short *local_20;
  wchar_t *local_1c;
  uint local_18;
  short *local_14;
  int local_10;
  void *local_c;
  size_t local_8;
  
  local_24 = 0;
  local_20 = (short *)0x0;
  local_1c = (wchar_t *)0x0;
  local_18 = 0;
  local_14 = (short *)0x0;
  local_10 = 0;
  local_2c = 0;
  local_28 = 0;
  local_c = (void *)0x0;
  local_8 = 0;
  *param_1 = 0;
  iVar1 = FUN_6b87243a(param_3,param_5,&local_20,(int *)&local_1c,&local_18,(int *)&local_14,
                       &local_10,&local_2c,(int *)&local_c,&local_8);
  if (iVar1 == 0) {
    pcVar3 = "Failed to read MATCHING_REG entry";
    uVar2 = 0x5cb;
  }
  else {
    iVar1 = FUN_6b871233(local_20,local_1c,local_18,local_14,local_10,local_2c,local_28,local_c,
                         local_8,&local_24);
    if (iVar1 != 0) {
      *(undefined4 *)(param_6 + 0x28) = 1;
      *param_1 = local_24;
      return 1;
    }
    pcVar3 = "Failed to check MATCHING_REG entry";
    uVar2 = 0x5dc;
  }
  FUN_6b8671a2(1,"SdbpCheckMatchingRegistry",uVar2,pcVar3);
  return 0;
}



// WARNING: Could not reconcile some variable overlaps

void __fastcall
FUN_6b871233(undefined4 param_1,wchar_t *param_2,uint param_3,short *param_4,int param_5,int param_6
            ,int param_7,void *param_8,size_t param_9,undefined4 *param_10)

{
  int iVar1;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 uVar2;
  undefined4 extraout_EDX_02;
  undefined4 **ppuVar3;
  undefined8 uVar4;
  undefined4 *local_248 [4];
  undefined4 local_238;
  undefined4 local_234;
  undefined4 local_230;
  undefined4 local_22c;
  wchar_t *local_228;
  short *local_224;
  int *local_220;
  undefined4 local_21c;
  undefined4 uStack536;
  undefined4 uStack532;
  wchar_t local_210 [260];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_224 = param_4;
  local_210[0] = L'\0';
  ppuVar3 = local_248;
  local_228 = param_2;
  for (iVar1 = 6; iVar1 != 0; iVar1 = iVar1 + -1) {
    *ppuVar3 = (undefined4 *)0x0;
    ppuVar3 = ppuVar3 + 1;
  }
  local_21c = 0;
  uStack536 = 0;
  *param_10 = 0;
  local_230 = 0;
  local_22c = 0;
  uStack532 = 0;
  local_220 = (int *)0x0;
  iVar1 = FUN_6b832879(local_210,0x104,L"\\REGISTRY\\MACHINE\\%s");
  if (iVar1 < 0) {
    FUN_6b8671a2(1,"SdbpCheckMatchingRegistryEntry",0x4e4,"Failed to construct full key path");
    uVar2 = extraout_EDX;
    goto LAB_6b8713bb;
  }
  RtlInitUnicodeString(&local_230,local_210);
  local_248[2] = &local_230;
  local_248[0] = (undefined4 *)0x18;
  local_248[1] = (undefined4 *)0x0;
  local_248[3] = (undefined4 *)0x40;
  local_238 = 0;
  local_234 = 0;
  iVar1 = ZwOpenKey(&local_220,0x20019,local_248);
  if (iVar1 < 0) {
    uVar4 = ZwQuerySystemInformation(1,&local_21c,0xc,0);
    uVar2 = (undefined4)((ulonglong)uVar4 >> 0x20);
    if ((int)uVar4 < 0) {
      FUN_6b8671a2(1,"SdbpCheckMatchingRegistryEntry",0x507,
                   "Failed to get processor architecture [%x]");
      uVar2 = extraout_EDX_00;
      goto LAB_6b8713bb;
    }
    if ((short)local_21c != 9) goto LAB_6b8713bb;
    uVar4 = ZwOpenKey(&local_220,0x20119,local_248);
    uVar2 = (undefined4)((ulonglong)uVar4 >> 0x20);
    if ((int)uVar4 < 0) goto LAB_6b8713bb;
  }
  FUN_6b8713e3(local_220,local_228,param_3,local_224,param_5,param_6,param_7,param_8,param_9,
               param_10);
  uVar2 = extraout_EDX_01;
LAB_6b8713bb:
  if (local_220 != (int *)0x0) {
    ZwClose(local_220);
    uVar2 = extraout_EDX_02;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



undefined4 __fastcall
FUN_6b8713e3(int *param_1,wchar_t *param_2,uint param_3,short *param_4,int param_5,int param_6,
            int param_7,void *param_8,size_t param_9,undefined4 *param_10)

{
  uint uVar1;
  int iVar2;
  short *psVar3;
  short *_Dst;
  undefined4 uVar4;
  int iVar5;
  int in_FS_OFFSET;
  bool bVar6;
  undefined4 uVar7;
  char *pcVar8;
  undefined local_1c [8];
  wchar_t *local_14;
  int *local_10;
  short *local_c;
  undefined4 local_8;
  
  local_c = (short *)0x0;
  _Dst = (short *)0x0;
  local_8 = 0;
  uVar4 = 0;
  iVar5 = 0;
  local_14 = param_2;
  local_10 = param_1;
  if ((param_2 == (wchar_t *)0x0) || (*param_2 == L'\0')) {
LAB_6b871552:
    *param_10 = 1;
    goto LAB_6b87155b;
  }
  iVar5 = _wcsicmp(param_2,L"dbRegistryDefaultName");
  if (iVar5 == 0) {
    RtlInitUnicodeString(local_1c,0);
  }
  else {
    uVar1 = FUN_6b81464d(&local_c,local_14);
    if ((int)uVar1 < 0) goto LAB_6b8716aa;
    RtlInitUnicodeString(local_1c,local_c);
  }
  iVar5 = ZwQueryValueKey(local_10,local_1c,1,0,0,&local_8);
  if (((iVar5 < 0) && (iVar5 != -0x7ffffffb)) && (iVar5 != -0x3fffffdd)) {
    uVar4 = 1;
    goto LAB_6b8716aa;
  }
  iVar5 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,local_8);
  if (iVar5 == 0) {
    FUN_6b8671a2(1,"SdbpCheckMatchingRegistryValue",0x3c8,"Failed to allocate memory");
    goto LAB_6b8716aa;
  }
  iVar2 = ZwQueryValueKey(local_10,local_1c,1,iVar5,local_8,&local_8);
  if (iVar2 < 0) {
    pcVar8 = "Failed to read value";
    uVar7 = 0x3d3;
    goto LAB_6b8714e0;
  }
  uVar1 = *(uint *)(iVar5 + 4);
  if (param_3 == 0) {
    uVar4 = 1;
    *param_10 = 1;
  }
  else {
    if (uVar1 == param_3) {
      local_10 = (int *)(*(int *)(iVar5 + 8) + iVar5);
      if (uVar1 == 0) {
LAB_6b871684:
        pcVar8 = "Unknown registry value data type";
        uVar7 = 0x45a;
LAB_6b8714e0:
        FUN_6b8671a2(1,"SdbpCheckMatchingRegistryValue",uVar7,pcVar8);
        goto LAB_6b87155e;
      }
      if (uVar1 < 3) {
        _Dst = (short *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                        *(int *)(iVar5 + 0xc) + 2);
        if (_Dst == (short *)0x0) {
          pcVar8 = "Failed to allocate memory";
          uVar7 = 0x3f8;
          goto LAB_6b8714e0;
        }
        memmove(_Dst,local_10,*(size_t *)(iVar5 + 0xc));
        *(undefined2 *)((int)_Dst + (*(uint *)(iVar5 + 0xc) & 0xfffffffe)) = 0;
LAB_6b8715f6:
        iVar2 = FUN_6b86a0be(param_4,_Dst);
        if (iVar2 != 0) goto LAB_6b871552;
      }
      else {
        if (uVar1 == 3) {
          if (param_9 != *(size_t *)(iVar5 + 0xc)) goto LAB_6b87155b;
          iVar2 = memcmp(param_8,local_10,param_9);
          bVar6 = iVar2 == 0;
        }
        else if (uVar1 == 4) {
          bVar6 = param_5 == *local_10;
        }
        else {
          if (uVar1 == 7) {
            _Dst = (short *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                            *(int *)(iVar5 + 0xc) + 2);
            if (_Dst != (short *)0x0) {
              memmove(_Dst,local_10,*(size_t *)(iVar5 + 0xc));
              *(undefined2 *)((int)_Dst + (*(uint *)(iVar5 + 0xc) & 0xfffffffe)) = 0;
              psVar3 = _Dst;
              if (_Dst < (short *)((*(uint *)(iVar5 + 0xc) & 0xfffffffe) + (int)_Dst)) {
                do {
                  if (*psVar3 == 0) {
                    if (psVar3[1] == 0) break;
                    *psVar3 = 0x3b;
                  }
                  psVar3 = psVar3 + 1;
                } while (psVar3 < (short *)((*(uint *)(iVar5 + 0xc) & 0xfffffffe) + (int)_Dst));
              }
              goto LAB_6b8715f6;
            }
            pcVar8 = "Failed to allocate memory";
            uVar7 = 0x40f;
            goto LAB_6b8714e0;
          }
          if (uVar1 != 0xb) goto LAB_6b871684;
          if (param_6 != *local_10) goto LAB_6b87155b;
          bVar6 = param_7 == local_10[1];
        }
        if (bVar6) goto LAB_6b871552;
      }
    }
LAB_6b87155b:
    uVar4 = 1;
  }
LAB_6b87155e:
  if (iVar5 != 0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iVar5);
  }
  if (_Dst != (short *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,_Dst);
  }
LAB_6b8716aa:
  if (local_c != (short *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_c);
  }
  return uVar4;
}



bool FUN_6b8716d0(undefined4 *param_1,int param_2,uint param_3,undefined4 param_4,int param_5,
                 uint *param_6)

{
  int iVar1;
  int in_FS_OFFSET;
  bool bVar2;
  undefined4 local_20;
  uint local_1c;
  wchar_t *local_18;
  uint local_14;
  uint local_10;
  uint local_c;
  void *local_8;
  
  local_c = 0x2000;
  *param_1 = 0;
  bVar2 = false;
  local_20 = 0;
  local_1c = 0;
  local_18 = (wchar_t *)0x0;
  local_8 = (void *)0x0;
  local_14 = 0;
  local_10 = 0;
  iVar1 = FUN_6b87226f(param_3,param_5,&local_18,&local_8,&local_14,(int *)&local_10,&local_c);
  if (iVar1 == 0) {
    FUN_6b8671a2(1,"SdbpCheckMatchingText",0x799,"Failed to read MATCHING_TEXT entry");
  }
  else {
    iVar1 = FUN_6b8717b2(param_2,param_6,local_18,(int)local_8,local_14,local_10,local_c,&local_20,
                         &local_1c);
    bVar2 = iVar1 != 0;
    if (bVar2) {
      param_6[10] = param_6[10] | local_1c;
      *param_1 = local_20;
    }
    else {
      FUN_6b8671a2(1,"SdbpCheckMatchingText",0x7aa,"Failed to check MATCHING_TEXT entry");
    }
  }
  if (local_8 != (void *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_8);
  }
  return bVar2;
}



// WARNING: Could not reconcile some variable overlaps

undefined4 __fastcall
FUN_6b8717b2(int param_1,uint *param_2,wchar_t *param_3,int param_4,uint param_5,uint param_6,
            uint param_7,undefined4 *param_8,undefined4 *param_9)

{
  byte bVar1;
  wchar_t wVar2;
  int iVar3;
  int iVar4;
  wchar_t *pwVar5;
  int extraout_ECX;
  uint uVar6;
  int *piVar7;
  uint _Size;
  undefined4 uVar8;
  int in_FS_OFFSET;
  undefined8 uVar9;
  char *pcVar10;
  int *local_30;
  undefined4 local_2c;
  wchar_t *local_28;
  void **local_24;
  undefined4 local_20;
  uint *local_1c;
  undefined4 local_18;
  wchar_t *local_14;
  int local_10;
  int *local_c;
  
  bVar1 = *(byte *)param_2;
  *param_8 = 0;
  piVar7 = (int *)0x0;
  local_18 = 0;
  local_2c = 0;
  local_20 = 0;
  local_28 = (wchar_t *)0x0;
  local_30 = (int *)0x0;
  *param_9 = 0;
  local_1c = param_2;
  local_10 = param_1;
  if (((bVar1 & 1) == 0) && (iVar3 = FUN_6b87270d(param_2), iVar3 == 0)) {
    FUN_6b8671a2(1,"SdbpCheckMatchingTextEntry",0x694,"Failed to initialize SEARCHDBCONTEXT");
    uVar8 = 0;
  }
  else {
    local_c = (int *)local_1c[9];
    uVar8 = 1;
    iVar3 = 0;
    if (0 < *local_c) {
      local_24 = (void **)(local_c + 1);
      do {
        local_14 = param_3 + 1;
        pwVar5 = param_3;
        do {
          wVar2 = *pwVar5;
          pwVar5 = pwVar5 + 1;
        } while (wVar2 != (wchar_t)local_18);
        iVar4 = FUN_6b8728ef(local_10,(int)local_1c,param_3,(int)pwVar5 - (int)local_14 >> 1,
                             local_24,&local_28);
        if (iVar4 == 0) {
          FUN_6b8671a2(1,"SdbpCheckMatchingTextEntry",0x6ac,"Failed to resolve matching text file");
          uVar8 = local_2c;
          goto LAB_6b871a9e;
        }
        uVar9 = FUN_6b86ad74(&local_30,local_28);
        piVar7 = local_30;
        iVar4 = (int)uVar9;
        if (-1 < iVar4) {
          iVar4 = FUN_6b86b052((int)local_30,(uint)((ulonglong)uVar9 >> 0x20));
        }
        iVar4 = FUN_6b86737b(iVar4);
        if (iVar4 == 0) {
          if (extraout_ECX < 0) {
            FUN_6b8671a2(1,"SdbpCheckMatchingTextEntry",0x6cc,"Failed to map file [%x]");
            uVar8 = local_2c;
            goto LAB_6b871a9e;
          }
          if (0 < iVar3) {
            *param_9 = 1;
          }
          if (piVar7 != (int *)0x0) {
            local_c = (int *)piVar7[6];
            uVar6 = 0;
            if ((piVar7[5] == 0) && ((uint)piVar7[4] <= param_7)) {
              param_7 = piVar7[4];
            }
            if (param_5 <= param_7) {
              local_10 = (param_6 == 3) + 1;
              if (param_7 != 0) goto LAB_6b87196d;
              goto LAB_6b871a31;
            }
          }
          break;
        }
        FUN_6b86af66(piVar7);
        local_30 = (int *)0x0;
        if (local_28 != (wchar_t *)0x0) {
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_28);
        }
        iVar3 = iVar3 + 1;
        local_24 = local_24 + 6;
        local_28 = (wchar_t *)0x0;
        piVar7 = local_30;
      } while (iVar3 < *local_c);
    }
    *param_8 = 0;
  }
  goto LAB_6b871a9e;
LAB_6b87196d:
  do {
    if (param_5 < uVar6) {
      uVar6 = uVar6 + (local_10 - param_5);
    }
    _Size = param_7 - uVar6;
    if (0x1000 < _Size) {
      _Size = 0x1000;
    }
    local_24 = (void **)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                        _Size + 2);
    if (local_24 == (void **)0x0) {
      pcVar10 = "Failed to allocate temp buffer";
      uVar8 = 0x713;
LAB_6b871a48:
      FUN_6b8671a2(1,"SdbpCheckMatchingTextEntry",uVar8,pcVar10);
      uVar8 = local_2c;
      piVar7 = local_30;
      goto LAB_6b871a9e;
    }
    if ((int *)(uVar6 + (int)local_c) < local_c) {
      pcVar10 = "Overflow doing pointer addition";
      uVar8 = 0x71a;
      goto LAB_6b871a48;
    }
    memcpy(local_24,(int *)(uVar6 + (int)local_c),_Size);
    if (param_6 == 0) {
LAB_6b871a3e:
      pcVar10 = "Unknown file encoding";
      uVar8 = 0x73c;
      goto LAB_6b871a48;
    }
    if (param_6 < 3) {
      iVar3 = FUN_6b86a185((int)local_24,_Size,param_4,param_5);
    }
    else {
      if (param_6 != 3) goto LAB_6b871a3e;
      iVar3 = FUN_6b86a1fa((int)local_24,_Size >> 1,param_4,param_5 >> 1);
    }
    if (iVar3 != 0) {
      local_20 = 1;
    }
    uVar6 = uVar6 + _Size;
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_24);
    piVar7 = local_30;
  } while (uVar6 < param_7);
LAB_6b871a31:
  *param_8 = local_20;
LAB_6b871a9e:
  wVar2 = *param_3;
  if (((wVar2 == L'%') || (wVar2 == L'\\')) || (wVar2 == L'.')) {
    *param_9 = 1;
  }
  if (local_28 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_28);
    piVar7 = local_30;
  }
  if (piVar7 != (int *)0x0) {
    FUN_6b86af66(piVar7);
  }
  return uVar8;
}



void FUN_6b871af0(int *param_1,int param_2,uint param_3,undefined4 param_4,int param_5,uint *param_6
                 )

{
  wchar_t *pwVar1;
  wchar_t wVar2;
  uint uVar3;
  int iVar4;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  wchar_t *pwVar5;
  wchar_t *pwVar6;
  int in_FS_OFFSET;
  undefined4 uVar7;
  char *pcVar8;
  undefined auStack588 [4];
  uint *local_248;
  int *local_244;
  wchar_t *local_240;
  uint *local_23c;
  int local_238;
  int local_234;
  int local_230;
  void **local_22c;
  wchar_t *local_228;
  uint local_224;
  int *local_220;
  int *local_21c;
  wchar_t local_218 [262];
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)auStack588;
  local_21c = param_1;
  local_234 = param_2;
  pwVar6 = (wchar_t *)0x0;
  local_224 = param_3;
  local_248 = param_6;
  local_238 = 0;
  local_240 = (wchar_t *)0x0;
  local_244 = (int *)0x0;
  local_23c = (uint *)0x0;
  if (param_6[0xb] == 0) {
    uVar3 = FUN_6b86f000(param_3,param_5,0x6001);
    if (uVar3 != 0) {
      local_228 = (wchar_t *)FUN_6b86f2d7(param_3,uVar3);
      if (local_228 == (wchar_t *)0x0) {
        pcVar8 = "Failed to get the string from the database";
        uVar7 = 0xa53;
      }
      else {
        pwVar1 = local_228 + 1;
        pwVar5 = local_228;
        do {
          wVar2 = *pwVar5;
          pwVar5 = pwVar5 + 1;
        } while (wVar2 != L'\0');
        if (((*(byte *)local_248 & 1) != 0) || (iVar4 = FUN_6b87270d(local_248), iVar4 != 0)) {
          local_220 = (int *)local_248[9];
          local_230 = 0;
          if (0 < *local_220) {
            local_22c = (void **)(local_220 + 1);
            do {
              iVar4 = FUN_6b8728ef(local_234,(int)local_248,local_228,(int)pwVar5 - (int)pwVar1 >> 1
                                   ,local_22c,&local_240);
              if (iVar4 == 0) {
                FUN_6b8671a2(1,"SdbpCheckMatchingWildcardFiles",0xa79,
                             "Failed to resolve matching file");
                pwVar6 = local_240;
                goto LAB_6b871d00;
              }
              FUN_6b86850f((int *)&local_23c);
              memset(local_218,0,0x208);
              pwVar6 = local_240;
              uVar3 = FUN_6b868538(local_218,local_240,&local_23c);
              while (-1 < (int)uVar3) {
                if (local_244 != (int *)0x0) {
                  FUN_6b86af66(local_244);
                  local_244 = (int *)0x0;
                }
                uVar3 = FUN_6b86ad74(&local_244,local_218);
                if ((int)uVar3 < 0) break;
                iVar4 = FUN_6b872fe1(&local_238,local_234,local_224,param_5,local_244);
                if (-1 < iVar4) goto LAB_6b871cfa;
                uVar3 = FUN_6b868a01(local_218,0x104,(int *)local_23c);
              }
              if (uVar3 != 0x80000006) {
                FUN_6b8671a2(3,"SdbpCheckMatchingWildcardFiles",0xaaf,
                             "AslPathWildcardFindFirst/Next failed to find a file [%x]");
              }
              if (pwVar6 != (wchar_t *)0x0) {
                RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pwVar6);
                pwVar6 = (wchar_t *)0x0;
                local_240 = (wchar_t *)0x0;
              }
              local_230 = local_230 + 1;
              local_22c = local_22c + 6;
            } while (local_230 < *local_220);
          }
LAB_6b871cfa:
          local_248[10] = 1;
          goto LAB_6b871d00;
        }
        pcVar8 = "Failed to initialize SEARCHDBCONTEXT";
        uVar7 = 0xa61;
      }
      FUN_6b8671a2(1,"SdbpCheckMatchingWildcardFiles",uVar7,pcVar8);
    }
  }
  else {
    local_238 = 1;
  }
LAB_6b871d00:
  FUN_6b86850f((int *)&local_23c);
  FUN_6b86af66(local_244);
  uVar7 = extraout_EDX;
  if (pwVar6 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pwVar6);
    uVar7 = extraout_EDX_00;
  }
  *local_21c = local_238;
  FUN_6b8224af(local_c ^ (uint)auStack588,uVar7);
  return;
}



undefined4
FUN_6b871d80(int *param_1,undefined4 param_2,uint param_3,undefined4 param_4,int param_5,int param_6
            )

{
  int iVar1;
  undefined4 uVar2;
  char *pcVar3;
  int local_2c;
  int local_28;
  int local_24;
  short *local_20;
  wchar_t *local_1c;
  uint local_18;
  short *local_14;
  int local_10;
  void *local_c;
  size_t local_8;
  
  local_24 = 0;
  local_20 = (short *)0x0;
  local_1c = (wchar_t *)0x0;
  local_18 = 0;
  local_14 = (short *)0x0;
  local_10 = 0;
  local_2c = 0;
  local_28 = 0;
  local_c = (void *)0x0;
  local_8 = 0;
  *param_1 = 0;
  iVar1 = FUN_6b87243a(param_3,param_5,&local_20,(int *)&local_1c,&local_18,(int *)&local_14,
                       &local_10,&local_2c,(int *)&local_c,&local_8);
  if (iVar1 == 0) {
    pcVar3 = "Failed to read MATCHING_WILDCARD_REGISTRY entry";
    uVar2 = 0x574;
  }
  else {
    iVar1 = FUN_6b871e43(local_20,local_1c,local_18,local_14,local_10,local_2c,local_28,local_c,
                         local_8,&local_24);
    if (iVar1 != 0) {
      *(undefined4 *)(param_6 + 0x28) = 1;
      *param_1 = local_24;
      return 1;
    }
    pcVar3 = "Failed to check MATCHING_WILDCARD_REGISTRY entry";
    uVar2 = 0x585;
  }
  FUN_6b8671a2(1,"SdbpCheckMatchingWildcardRegistry",uVar2,pcVar3);
  return 0;
}



undefined4 __fastcall
FUN_6b871e43(void *param_1,wchar_t *param_2,uint param_3,short *param_4,int param_5,int param_6,
            int param_7,void *param_8,size_t param_9,int *param_10)

{
  uint uVar1;
  int iVar2;
  int *local_10;
  int *local_c [2];
  
  local_c[0] = (int *)0x0;
  local_10 = (int *)0x0;
  *param_10 = 0;
  uVar1 = FUN_6b869427((int *)&local_10,local_c,param_1);
  while (-1 < (int)uVar1) {
    iVar2 = FUN_6b8713e3(local_10,param_2,param_3,param_4,param_5,param_6,param_7,param_8,param_9,
                         param_10);
    if ((iVar2 != 0) && (*param_10 != 0)) break;
    uVar1 = FUN_6b8694b3((int *)&local_10,local_c[0]);
  }
  FUN_6b8693b9(local_c[0]);
  return 1;
}



undefined4 FUN_6b871ed0(uint *param_1,int param_2,uint param_3,undefined4 param_4,int param_5)

{
  uint uVar1;
  
  uVar1 = FUN_6b86f4a0(param_3,param_5,0);
  *param_1 = (uint)((*(uint *)(param_2 + 0x1a0) & uVar1) != 0);
  return 1;
}



undefined4
FUN_6b871f00(int *param_1,int param_2,undefined4 param_3,undefined4 param_4,int param_5,int param_6)

{
  ushort uVar1;
  bool bVar2;
  int iVar3;
  undefined3 extraout_var;
  short *psVar4;
  undefined3 extraout_var_00;
  int iVar5;
  uint uVar6;
  uint uVar7;
  short *psVar8;
  longlong lVar9;
  int local_1c;
  int local_18;
  uint local_14;
  uint local_10;
  int local_c;
  uint local_8;
  
  local_c = *(int *)(param_6 + 0x2c);
  iVar5 = 1;
  local_18 = 1;
  *param_1 = 0;
  local_10 = 0;
  do {
    local_8 = FUN_6b86f000(*(uint *)(param_2 + 4),param_5,*(short *)((int)&DAT_6b8b0260 + local_10))
    ;
    if (local_8 != 0) {
      uVar6 = 0;
      if (*(int *)(local_c + 8) == 0) {
LAB_6b872109:
        FUN_6b8671a2(1,"SdbpCheckPackageAttributes",0xf88,
                     "Failed to find Attribute to use for sdb tag");
        return 0;
      }
      uVar7 = (uint)*(ushort *)(&DAT_6b8b0262 + local_10);
      iVar5 = local_c;
      local_14 = uVar7;
      do {
        psVar8 = (short *)0x0;
        if ((uVar6 < *(uint *)(iVar5 + 8)) &&
           ((lVar9 = (ulonglong)*(uint *)(iVar5 + 4) * (ulonglong)uVar6,
            iVar3 = FUN_6b850b02(&local_1c,(int)lVar9,(int)((ulonglong)lVar9 >> 0x20)),
            uVar7 = local_14, iVar5 = local_c, iVar3 < 0 ||
            (psVar8 = (short *)(local_1c + (int)*(short **)(local_c + 0x14)),
            psVar8 < *(short **)(local_c + 0x14))))) {
          psVar8 = (short *)0x0;
        }
        if (*psVar8 == (short)uVar7) break;
        uVar6 = uVar6 + 1;
        psVar8 = (short *)0x0;
      } while (uVar6 < *(uint *)(iVar5 + 8));
      if (psVar8 == (short *)0x0) goto LAB_6b872109;
      uVar1 = *(ushort *)((int)&DAT_6b8b0260 + local_10);
      if (uVar1 < 0x5018) {
        if (uVar1 != 0x5017) {
          if (uVar1 == 0x4045) {
            iVar5 = FUN_6b86f4a0(*(uint *)(param_2 + 4),local_8,0xffffffff);
            if (iVar5 == -1) {
              return 0;
            }
            uVar6 = (uint)(iVar5 == *(int *)(psVar8 + 4));
            goto LAB_6b8720d0;
          }
          if (uVar1 != 0x5014) {
            if (uVar1 != 0x5015) {
              if (uVar1 != 0x5016) {
                return 0;
              }
              goto LAB_6b871fe3;
            }
            goto LAB_6b8720a8;
          }
        }
        lVar9 = FUN_6b86f510(*(uint *)(param_2 + 4),local_8,0xffffffff,0xffffffff);
        if (lVar9 == -1) {
          return 0;
        }
        uVar6 = FUN_6b8734ae((int)lVar9,(int)((ulonglong)lVar9 >> 0x20),*(undefined4 *)(psVar8 + 4),
                             *(undefined4 *)(psVar8 + 6));
      }
      else if (uVar1 == 0x5018) {
LAB_6b8720a8:
        lVar9 = FUN_6b86f510(*(uint *)(param_2 + 4),local_8,0xffffffff,0xffffffff);
        if (lVar9 == -1) {
          return 0;
        }
        bVar2 = FUN_6b873406((int)lVar9,(int)((ulonglong)lVar9 >> 0x20),*(undefined4 *)(psVar8 + 4),
                             *(undefined4 *)(psVar8 + 6));
        uVar6 = CONCAT31(extraout_var_00,bVar2);
      }
      else if (uVar1 == 0x5019) {
LAB_6b871fe3:
        lVar9 = FUN_6b86f510(*(uint *)(param_2 + 4),local_8,0xffffffff,0xffffffff);
        if (lVar9 == -1) {
          return 0;
        }
        bVar2 = FUN_6b87345a((int)lVar9,(int)((ulonglong)lVar9 >> 0x20),*(undefined4 *)(psVar8 + 4),
                             *(undefined4 *)(psVar8 + 6));
        uVar6 = CONCAT31(extraout_var,bVar2);
      }
      else {
        if (uVar1 < 0x6029) {
          return 0;
        }
        if (0x602b < uVar1) {
          return 0;
        }
        psVar4 = (short *)FUN_6b86f2d7(*(uint *)(param_2 + 4),local_8);
        if (psVar4 == (short *)0x0) {
          return 0;
        }
        uVar6 = FUN_6b86a0be(psVar4,*(short **)(psVar8 + 4));
      }
LAB_6b8720d0:
      if ((local_18 == 0) || (uVar6 == 0)) {
        iVar5 = 0;
        local_18 = iVar5;
      }
      else {
        iVar5 = 1;
        local_18 = iVar5;
      }
    }
    local_10 = local_10 + 4;
    if (0x27 < local_10) {
      *param_1 = iVar5;
      return 1;
    }
  } while( true );
}



void FUN_6b872130(uint *param_1,int param_2,uint param_3,undefined4 param_4,int param_5)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = *(uint *)(param_2 + 0x194);
  uVar2 = FUN_6b86f4a0(param_3,param_5,0x7f);
  FUN_6b872165(param_1,*(uint *)(param_3 + 0x528),uVar1,uVar2);
  return;
}



undefined4 __fastcall FUN_6b872165(uint *param_1,uint param_2,uint param_3,uint param_4)

{
  undefined4 uVar1;
  
  if ((param_2 & 2) == 0) {
    *param_1 = (uint)((param_3 & param_4) != 0);
    uVar1 = 1;
  }
  else {
    uVar1 = FUN_6b872191(param_1,param_3,param_4);
  }
  return uVar1;
}



undefined4 __fastcall FUN_6b872191(uint *param_1,uint param_2,uint param_3)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  
  uVar1 = 0;
  if (param_3 == 0xc0000000) {
LAB_6b8721ab:
    uVar1 = 1;
  }
  else {
    iVar2 = 0;
    do {
      if (uVar1 != 0) break;
      uVar3 = param_3 >> ((byte)iVar2 & 0x1f);
      if ((uVar3 & 0x40) != 0) {
        uVar3 = uVar3 & 0x3f;
        if (uVar3 == 0) {
          if ((param_2 & 1) != 0) goto LAB_6b8721ab;
LAB_6b872205:
          uVar1 = 0;
        }
        else {
          if (uVar3 == 5) {
            uVar1 = param_2 >> 3;
          }
          else {
            if (uVar3 != 9) {
              if ((uVar3 == 0xb) || (uVar3 == 0xc)) {
                uVar1 = param_2 >> 2;
                goto LAB_6b8721ee;
              }
              if (uVar3 != 0xd) goto LAB_6b872205;
            }
            uVar1 = param_2 >> 1;
          }
LAB_6b8721ee:
          uVar1 = uVar1 & 1;
        }
        if (uVar1 != 0) break;
      }
      iVar2 = iVar2 + 8;
    } while (iVar2 < 0x18);
  }
  *param_1 = uVar1;
  return 1;
}



undefined4 __fastcall FUN_6b872215(undefined4 *param_1,int param_2,uint param_3,int param_4)

{
  uint uVar1;
  ushort uVar2;
  uint uVar3;
  
  uVar1 = FUN_6b86fb78(param_3,param_4);
  if (param_4 != 0) {
    uVar2 = 0;
    do {
      uVar3 = (uint)uVar2;
      if ((uVar1 & 0xffff) == *(uint *)(uVar3 * 0xc + 0x1ac + param_2)) {
        *param_1 = *(undefined4 *)(uVar3 * 0xc + 0x1b4 + param_2);
        return *(undefined4 *)((uVar3 + 0x24) * 0xc + param_2);
      }
      uVar2 = uVar2 + 1;
    } while (uVar2 < 0x10);
  }
  return 0;
}



undefined4 __fastcall
FUN_6b87226f(uint param_1,int param_2,short **param_3,void **param_4,uint *param_5,int *param_6,
            undefined4 *param_7)

{
  uint uVar1;
  short *psVar2;
  uint uVar3;
  int iVar4;
  void *pvVar5;
  int in_FS_OFFSET;
  undefined4 uVar6;
  char *pcVar7;
  
  pvVar5 = (void *)0x0;
  *param_3 = (short *)0x0;
  *param_4 = (void *)0x0;
  *param_5 = 0;
  *param_6 = 0;
  *param_7 = 0x2000;
  uVar1 = FUN_6b86f000(param_1,param_2,0x6001);
  if (uVar1 == 0) {
    pcVar7 = "Failed to get MATCHING_TEXT file path";
    uVar6 = 0x61a;
  }
  else {
    psVar2 = (short *)FUN_6b86f2d7(param_1,uVar1);
    if ((psVar2 == (short *)0x0) || (*psVar2 == 0)) {
      uVar6 = 0x620;
      pcVar7 = "Failed to read MATCHING_TEXT file path";
LAB_6b87240a:
      FUN_6b8671a2(1,"SdbpGetMatchingTextAttributes",uVar6,pcVar7);
      if (pvVar5 == (void *)0x0) {
        return 0;
      }
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pvVar5);
      return 0;
    }
    uVar1 = FUN_6b86f000(param_1,param_2,-0x6fed);
    if (uVar1 == 0) {
      pcVar7 = "Failed to read text to match";
      uVar6 = 0x629;
    }
    else {
      uVar3 = FUN_6b86f359(param_1,uVar1);
      if (uVar3 == 0) {
        pcVar7 = "Failed to get text to match blob";
        uVar6 = 0x62f;
      }
      else {
        pvVar5 = (void *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,
                                         uVar3 + 2);
        if (pvVar5 != (void *)0x0) {
          iVar4 = FUN_6b86f420(param_1,uVar1,pvVar5,uVar3);
          if (iVar4 == 0) {
            uVar6 = 0x63a;
            pcVar7 = "Failed to read matching text blob";
          }
          else {
            uVar1 = FUN_6b86f000(param_1,param_2,0x4053);
            if (uVar1 == 0) {
              uVar6 = 0x643;
              pcVar7 = "Failed to read text encoding";
            }
            else {
              iVar4 = FUN_6b86f4a0(param_1,uVar1,0);
              if (iVar4 != 0) {
                uVar1 = FUN_6b86f000(param_1,param_2,0x4001);
                uVar6 = 0x2000;
                if (uVar1 != 0) {
                  uVar6 = FUN_6b86f4a0(param_1,uVar1,0x2000);
                }
                *param_3 = psVar2;
                *param_4 = pvVar5;
                *param_5 = uVar3;
                *param_6 = iVar4;
                *param_7 = uVar6;
                return 1;
              }
              uVar6 = 0x649;
              pcVar7 = "Failed to read encoding type";
            }
          }
          goto LAB_6b87240a;
        }
        pcVar7 = "Failed to allocate memory for text blob";
        uVar6 = 0x635;
      }
    }
  }
  FUN_6b8671a2(1,"SdbpGetMatchingTextAttributes",uVar6,pcVar7);
  return 0;
}



undefined4 __fastcall
FUN_6b87243a(uint param_1,int param_2,short **param_3,int *param_4,uint *param_5,int *param_6,
            undefined4 *param_7,undefined4 *param_8,int *param_9,uint *param_10)

{
  uint uVar1;
  short *psVar2;
  uint uVar3;
  int iVar4;
  undefined8 uVar5;
  undefined4 uVar6;
  char *pcVar7;
  uint local_24;
  int local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  int local_10;
  
  iVar4 = 0;
  uVar3 = 0;
  local_10 = 0;
  local_14 = 0;
  *param_3 = (short *)0x0;
  local_20 = 0;
  *param_4 = 0;
  local_24 = 0;
  *param_5 = 0;
  *param_6 = 0;
  *param_7 = 0;
  *param_8 = 0;
  param_8[1] = 0;
  *param_9 = 0;
  *param_10 = 0;
  uVar1 = FUN_6b86f000(param_1,param_2,0x6001);
  if (uVar1 == 0) {
    pcVar7 = "Failed to get key path tag";
    uVar6 = 0x318;
LAB_6b8726c4:
    FUN_6b8671a2(1,"SdbpGetRegistryMatchingAttributes",uVar6,pcVar7);
    return 0;
  }
  psVar2 = (short *)FUN_6b86f2d7(param_1,uVar1);
  if ((psVar2 == (short *)0x0) || (*psVar2 == 0)) {
    pcVar7 = "Failed to read key path";
    uVar6 = 0x31e;
    goto LAB_6b8726c4;
  }
  uVar1 = FUN_6b86f000(param_1,param_2,0x6030);
  if (uVar1 != 0) {
    local_10 = FUN_6b86f2d7(param_1,uVar1);
  }
  uVar1 = FUN_6b86f000(param_1,param_2,0x4051);
  uVar5 = 0;
  if (uVar1 == 0) goto LAB_6b87258c;
  uVar3 = FUN_6b86f4a0(param_1,uVar1,0);
  if (uVar3 == 0) {
    pcVar7 = "Failed to read value type";
    uVar6 = 0x331;
  }
  else {
    if (2 < uVar3) {
      if (uVar3 == 3) {
        uVar1 = FUN_6b86f000(param_1,param_2,-0x6fee);
        if (uVar1 == 0) {
          pcVar7 = "Failed to get TAG_REG_VALUE_DATA_BINARY";
          uVar6 = 0x360;
        }
        else {
          local_20 = FUN_6b86f285(param_1,uVar1);
          if (local_20 != 0) {
            local_24 = FUN_6b86f359(param_1,uVar1);
            uVar5 = 0;
            goto LAB_6b87258c;
          }
          pcVar7 = "Failed to read value data";
          uVar6 = 0x366;
        }
        goto LAB_6b87251c;
      }
      if (uVar3 == 4) {
        uVar1 = FUN_6b86f000(param_1,param_2,0x4052);
        if (uVar1 == 0) {
          pcVar7 = "Failed to get TAG_REG_VALUE_DATA_DWORD";
          uVar6 = 0x34c;
          goto LAB_6b87251c;
        }
        local_14 = FUN_6b86f4a0(param_1,uVar1,0);
        uVar5 = 0;
        goto LAB_6b87258c;
      }
      if (uVar3 != 7) {
        if (uVar3 == 0xb) {
          uVar1 = FUN_6b86f000(param_1,param_2,0x501b);
          if (uVar1 != 0) {
            uVar5 = FUN_6b86f510(param_1,uVar1,0,0);
            goto LAB_6b87258c;
          }
          pcVar7 = "Failed to get TAG_REG_VALUE_DATA_QWORD";
          uVar6 = 0x356;
        }
        else {
          pcVar7 = "Unknown registry value type";
          uVar6 = 0x36d;
        }
        goto LAB_6b87251c;
      }
    }
    uVar1 = FUN_6b86f000(param_1,param_2,0x6031);
    if (uVar1 != 0) {
      iVar4 = FUN_6b86f2d7(param_1,uVar1);
      uVar5 = 0;
      if (iVar4 == 0) {
        FUN_6b8671a2(1,"SdbpGetRegistryMatchingAttributes",0x344,"Failed to read value data");
        return 0;
      }
LAB_6b87258c:
      local_1c = (undefined4)((ulonglong)uVar5 >> 0x20);
      local_18 = (undefined4)uVar5;
      *param_3 = psVar2;
      *param_4 = local_10;
      *param_5 = uVar3;
      *param_6 = iVar4;
      *param_7 = local_14;
      *param_8 = local_18;
      param_8[1] = local_1c;
      *param_9 = local_20;
      *param_10 = local_24;
      return 1;
    }
    pcVar7 = "Failed to get TAG_REG_VALUE_DATA_SZ";
    uVar6 = 0x33e;
  }
LAB_6b87251c:
  FUN_6b8671a2(1,"SdbpGetRegistryMatchingAttributes",uVar6,pcVar7);
  return 0;
}



void __fastcall FUN_6b8726dc(int param_1)

{
  undefined4 *puVar1;
  uint uVar2;
  undefined4 *puVar3;
  
  uVar2 = 0;
  puVar3 = (undefined4 *)(param_1 + 0x1b0);
  do {
    puVar3[-1] = *(undefined4 *)((int)&DAT_6b8806e0 + uVar2);
    *puVar3 = *(undefined4 *)((int)&PTR_FUN_6b8806e4 + uVar2);
    puVar1 = (undefined4 *)((int)&DAT_6b8806e8 + uVar2);
    uVar2 = uVar2 + 0xc;
    puVar3[1] = *puVar1;
    puVar3 = puVar3 + 3;
  } while (uVar2 < 0x84);
  return;
}



int __fastcall FUN_6b87270d(uint *param_1)

{
  short *psVar1;
  int iVar2;
  short sVar3;
  wchar_t *_Dst;
  int iVar4;
  short *psVar5;
  int iVar6;
  short *psVar7;
  int in_FS_OFFSET;
  undefined4 uVar8;
  char *pcVar9;
  
  if (param_1[9] != 0) {
    return 1;
  }
  _Dst = (wchar_t *)param_1[8];
  if (_Dst == (wchar_t *)0x0) {
    if (((*(byte *)param_1 & 2) == 0) && ((short *)param_1[7] != (short *)0x0)) {
      _Dst = FUN_6b872d2a((short *)param_1[7],(short *)param_1[4],(short *)param_1[5]);
      if (_Dst != (wchar_t *)0x0) goto LAB_6b8727fa;
      pcVar9 = "Failed to retrieve process history";
      uVar8 = 0x161;
    }
    else {
      psVar7 = (short *)param_1[4];
      psVar1 = psVar7 + 1;
      do {
        sVar3 = *psVar7;
        psVar7 = psVar7 + 1;
      } while (sVar3 != 0);
      psVar5 = (short *)param_1[5];
      iVar4 = (int)psVar7 - (int)psVar1 >> 1;
      psVar1 = psVar5 + 1;
      do {
        sVar3 = *psVar5;
        psVar5 = psVar5 + 1;
      } while (sVar3 != 0);
      iVar6 = (int)psVar5 - (int)psVar1 >> 1;
      iVar2 = iVar6 + iVar4;
      _Dst = (wchar_t *)
             RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,iVar2 * 2 + 2);
      if (_Dst != (wchar_t *)0x0) {
        memmove(_Dst,(void *)param_1[4],iVar4 * 2);
        memmove(_Dst + iVar4,(void *)param_1[5],iVar6 * 2);
        _Dst[iVar2] = L'\0';
        goto LAB_6b8727fa;
      }
      pcVar9 = "Failed to allocate process history buffer";
      uVar8 = 0x152;
    }
    FUN_6b8671a2(1,"SdbpInitializeSearchDBContext",uVar8,pcVar9);
    iVar4 = 0;
  }
  else {
LAB_6b8727fa:
    param_1[8] = (uint)_Dst;
    iVar4 = FUN_6b86fe49(_Dst,(uint **)(param_1 + 9));
    if (iVar4 != 0) {
      *param_1 = *param_1 | 1;
    }
  }
  return iVar4;
}



undefined4 __fastcall
FUN_6b872813(int *param_1,int param_2,uint param_3,int param_4,undefined4 param_5)

{
  uint uVar1;
  code *pcVar2;
  int iVar3;
  uint uVar4;
  int *piVar5;
  int iVar6;
  uint uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 local_10;
  int local_c;
  int local_8;
  
  local_8 = 1;
  local_c = param_2;
  uVar1 = FUN_6b86facb(param_3,param_4);
  do {
    if (uVar1 == 0) {
LAB_6b8728b4:
      *param_1 = local_8;
      return 1;
    }
    pcVar2 = (code *)FUN_6b872215(&local_10,param_2,param_3,uVar1);
    if (pcVar2 != (code *)0x0) {
      piVar5 = &local_8;
      iVar3 = local_c;
      uVar4 = param_3;
      iVar6 = param_4;
      uVar7 = uVar1;
      uVar8 = param_5;
      uVar9 = local_10;
      _guard_check_icall();
      iVar3 = (*pcVar2)(piVar5,iVar3,uVar4,iVar6,uVar7,uVar8,uVar9);
      if (iVar3 == 0) {
        return 0;
      }
      uVar4 = FUN_6b86f000(param_3,uVar1,0x1003);
      if (uVar4 != 0) {
        if (local_8 == 0) {
          local_8 = 1;
          goto LAB_6b8728b4;
        }
        local_8 = 0;
      }
      if (local_8 == 1) goto LAB_6b8728b4;
    }
    uVar1 = FUN_6b86fb0f(param_3,param_4,uVar1);
    param_2 = local_c;
  } while( true );
}



void FUN_6b8728d0(int *param_1,int param_2,uint param_3,undefined4 param_4,int param_5,
                 undefined4 param_6)

{
  FUN_6b872813(param_1,param_2,param_3,param_5,param_6);
  return;
}



undefined4 __fastcall
FUN_6b8728ef(int param_1,int param_2,wchar_t *param_3,int param_4,void **param_5,wchar_t **param_6)

{
  short sVar1;
  int iVar2;
  uint uVar3;
  wchar_t *_Dst;
  uint uVar4;
  int in_FS_OFFSET;
  undefined4 uVar5;
  char *pcVar6;
  undefined4 local_14;
  undefined4 local_10;
  uint local_c;
  short local_8 [2];
  
  *param_6 = (wchar_t *)0x0;
  local_8[0] = -1;
  local_10 = CONCAT22(local_10._2_2_,0xffff);
  local_14 = 0;
  local_c = 0;
  if (param_4 == 0) {
    FUN_6b8671a2(1,"SdbpResolveMatchingFile",0x231,"Invalid match file length");
    return 0;
  }
  if (*param_3 == L'%') {
    iVar2 = FUN_6b86a619((undefined2 *)&local_10,local_8);
    if (iVar2 < 0) {
      pcVar6 = "AslEnvGetProcessWowInfo failed [%x]";
      uVar5 = 0x246;
LAB_6b8729ba:
      FUN_6b8671a2(1,"SdbpResolveMatchingFile",uVar5,pcVar6);
      return 0;
    }
    uVar3 = FUN_6b86ab18(*(short *)(param_1 + 0x1a8));
    sVar1 = (short)uVar3;
    if ((short)uVar3 == -1) {
      sVar1 = local_8[0];
    }
    iVar2 = FUN_6b86a314(*(short **)(param_2 + 0x1c),param_3,(wchar_t *)0x0,0,(int *)&local_c,
                         (short)local_10,sVar1);
    if ((iVar2 < 0) && (iVar2 != -0x3fffffdd)) {
      pcVar6 = "AslEnvExpandStrings2 failed [%x]";
      uVar5 = 599;
      goto LAB_6b8729ba;
    }
    local_c = local_c * 2;
  }
  else {
    uVar3 = FUN_6b814837((uint)param_5[1],param_4,&local_c);
    if ((int)uVar3 < 0) {
      pcVar6 = "Invalid path size";
      uVar5 = 0x264;
      goto LAB_6b872ba7;
    }
    uVar3 = FUN_6b814837(local_c,1,&local_c);
    if ((int)uVar3 < 0) {
      pcVar6 = "Invalid path size";
      uVar5 = 0x269;
      goto LAB_6b872ba7;
    }
  }
  uVar3 = FUN_6b814837(local_c,0x14,&local_c);
  if ((int)uVar3 < 0) {
    pcVar6 = "Invalid path size";
    uVar5 = 0x26f;
LAB_6b872ba7:
    FUN_6b8671a2(1,"SdbpResolveMatchingFile",uVar5,pcVar6);
    return 0;
  }
  uVar3 = (uint)((ulonglong)local_c * 2);
  if ((int)((ulonglong)local_c * 2 >> 0x20) != 0) {
    pcVar6 = "Invalid buffer size";
    uVar5 = 0x274;
    goto LAB_6b872ba7;
  }
  uVar4 = 0x208;
  if (0x207 < uVar3) {
    uVar4 = uVar3;
  }
  local_c = uVar3;
  _Dst = (wchar_t *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,uVar4);
  if (_Dst == (wchar_t *)0x0) {
    pcVar6 = "Out of memory";
    uVar5 = 0x27c;
    goto LAB_6b872ba7;
  }
  if (*param_3 == L'%') {
    iVar2 = FUN_6b86a619((undefined2 *)&local_10,local_8);
    if (-1 < iVar2) {
      uVar3 = FUN_6b86ab18(*(short *)(param_1 + 0x1a8));
      sVar1 = (short)uVar3;
      if ((short)uVar3 == -1) {
        sVar1 = local_8[0];
      }
      iVar2 = FUN_6b86a314(*(short **)(param_2 + 0x1c),param_3,_Dst,uVar4 >> 1,(int *)&local_c,
                           (short)local_10,sVar1);
      if (iVar2 < 0) {
        FUN_6b8671a2(1,"SdbpResolveMatchingFile",0x299,
                     "AslEnvExpandStrings2 failed to expand strings for %ws [%x]");
        goto LAB_6b872b85;
      }
      goto LAB_6b872b59;
    }
    pcVar6 = "AslEnvGetProcessWowInfo failed [%x]";
    uVar5 = 0x288;
  }
  else {
    memmove(_Dst,*param_5,(int)param_5[1] * 2);
    memmove(_Dst + (int)param_5[1],param_3,param_4 * 2 + 2);
LAB_6b872b59:
    iVar2 = FUN_6b867e87(_Dst,_Dst,uVar4 >> 1);
    if (-1 < iVar2) {
      local_14 = 1;
      *param_6 = _Dst;
      _Dst = (wchar_t *)0x0;
      goto LAB_6b872b85;
    }
    pcVar6 = "AslPathClean failed [%x]";
    uVar5 = 0x2b2;
  }
  FUN_6b8671a2(1,"SdbpResolveMatchingFile",uVar5,pcVar6);
LAB_6b872b85:
  if (_Dst == (wchar_t *)0x0) {
    return local_14;
  }
  RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,_Dst);
  return local_14;
}



bool __fastcall FUN_6b872c08(int param_1,int param_2,uint param_3,uint *param_4)

{
  int iVar1;
  uint uVar2;
  uint local_8;
  
  local_8 = 0xffffffff;
  iVar1 = FUN_6b86ec63(param_1,param_2,param_1,&local_8);
  if (iVar1 == 0) {
    FUN_6b8671a2(1,"SdbTagIDToTagRef",0xf6,"Bad PDB");
    uVar2 = 0;
  }
  else {
    uVar2 = local_8 << 0x1c | param_3;
  }
  *param_4 = uVar2;
  return iVar1 != 0;
}



void __fastcall FUN_6b872c58(int param_1,uint param_2,int *param_3,uint *param_4)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  int local_34;
  uint local_30;
  int local_2c;
  uint local_28;
  int *local_24;
  uint *local_20;
  undefined4 local_1c;
  undefined4 uStack24;
  undefined4 uStack20;
  undefined4 uStack16;
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)&local_34;
  local_24 = param_3;
  local_20 = param_4;
  local_28 = param_2 & 0xfffffff;
  local_30 = param_2 >> 0x1c;
  iVar4 = 1;
  iVar3 = 0;
  iVar1 = local_30 * 0x18 + param_1;
  local_34 = 0;
  local_2c = param_1;
  if ((*(byte *)(iVar1 + 0x28) & 2) == 0) {
    if ((*(byte *)(iVar1 + 0x28) & 1) != 0) {
      *(undefined4 *)(iVar1 + 0x28) = 0;
      local_1c = *(undefined4 *)(iVar1 + 0x14);
      uStack24 = *(undefined4 *)(iVar1 + 0x18);
      uStack20 = *(undefined4 *)(iVar1 + 0x1c);
      uStack16 = *(undefined4 *)(iVar1 + 0x20);
      iVar4 = FUN_6b86ed86(param_1,&local_1c,0,&local_34,&local_30);
      iVar3 = local_34;
      goto LAB_6b872cec;
    }
  }
  else {
    iVar3 = *(int *)(iVar1 + 0x24);
    *(undefined4 *)(iVar3 + 0x14) = *(undefined4 *)(iVar1 + 0x14);
    *(undefined4 *)(iVar3 + 0x18) = *(undefined4 *)(iVar1 + 0x18);
    *(undefined4 *)(iVar3 + 0x1c) = *(undefined4 *)(iVar1 + 0x1c);
    *(undefined4 *)(iVar3 + 0x20) = *(undefined4 *)(iVar1 + 0x20);
LAB_6b872cec:
    if (iVar3 != 0) goto LAB_6b872cf2;
  }
  iVar4 = 0;
LAB_6b872cf2:
  uVar2 = local_28;
  if (iVar4 == 0) {
    iVar3 = 0;
    uVar2 = 0;
  }
  if (local_24 != (int *)0x0) {
    *local_24 = iVar3;
  }
  if (local_20 != (uint *)0x0) {
    *local_20 = uVar2;
  }
  FUN_6b8224af(local_c ^ (uint)&local_34,local_24);
  return;
}



short * __fastcall FUN_6b872d2a(short *param_1,short *param_2,short *param_3)

{
  short *psVar1;
  short sVar2;
  int iVar3;
  short *psVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  short *psVar8;
  int in_FS_OFFSET;
  uint local_8;
  
  local_8 = 0;
  psVar4 = param_2;
  do {
    sVar2 = *psVar4;
    psVar4 = psVar4 + 1;
  } while (sVar2 != 0);
  iVar7 = (int)psVar4 - (int)(param_2 + 1) >> 1;
  psVar4 = param_3;
  do {
    sVar2 = *psVar4;
    psVar4 = psVar4 + 1;
  } while (sVar2 != 0);
  iVar6 = (int)psVar4 - (int)(param_3 + 1) >> 1;
  iVar3 = FUN_6b86a8ea(param_1,L"__PROCESS_HISTORY",0x11,(undefined2 *)0x0,0,&local_8);
  if (iVar3 == -0x3fffffdd) {
    uVar5 = (local_8 + iVar6 + iVar7) * 2 + 4;
  }
  else {
    uVar5 = (iVar6 + iVar7) * 2 + 2;
  }
  psVar4 = (short *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,uVar5);
  if (psVar4 == (short *)0x0) {
    FUN_6b8671a2(1,"SdbpGetProcessHistory",0x8bd,"Unable to allocate process history buffer");
    psVar4 = (short *)0x0;
  }
  else {
    *psVar4 = 0;
    psVar8 = psVar4;
    if (iVar3 == -0x3fffffdd) {
      local_8 = uVar5;
      iVar3 = FUN_6b86a8ea(param_1,L"__PROCESS_HISTORY",0x11,psVar4,uVar5 >> 1,&local_8);
      if (-1 < iVar3) {
        psVar1 = psVar4 + local_8;
        psVar8 = psVar1 + -1;
        if (psVar1[-1] != 0x3b) {
          *psVar1 = 0x3b;
          psVar8 = psVar1;
        }
        psVar8 = psVar8 + 1;
      }
    }
    memmove(psVar8,param_2,iVar7 * 2);
    memmove(psVar8 + iVar7,param_3,iVar6 * 2);
    (psVar8 + iVar7)[iVar6] = 0;
  }
  return psVar4;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int __fastcall FUN_6b872e58(int *param_1)

{
  code *pcVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int **ppiVar6;
  int *piVar7;
  int *piVar8;
  int in_FS_OFFSET;
  uint *puVar9;
  undefined4 uVar10;
  char *pcVar11;
  int local_28 [4];
  uint local_18;
  int *local_14;
  int local_10;
  uint local_c;
  int local_8;
  
  local_8 = 0;
  local_c = 0;
  ppiVar6 = (int **)0x0;
  local_10 = *param_1;
  local_14 = param_1;
  if (DAT_6b8b06d4 == (code *)0x0) {
    pcVar11 = "No expand callback method set. Cannot expand ZDB file.";
    uVar10 = 0x93;
  }
  else if (*(uint *)(local_10 + 0xc) < 0x14) {
    pcVar11 = "SDB file too small to be valid";
    uVar10 = 0x98;
  }
  else {
    piVar7 = *(int **)(local_10 + 4);
    piVar8 = local_28;
    for (iVar4 = 5; iVar4 != 0; iVar4 = iVar4 + -1) {
      *piVar8 = *piVar7;
      piVar7 = piVar7 + 1;
      piVar8 = piVar8 + 1;
    }
    if (local_28[2] == 0x6662647a) {
      if (local_28[3] == _DAT_6b8b06d8) {
        local_c = local_18;
        if ((local_18 < 0x80000000) || (0x29 < local_18)) {
          iVar4 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,local_18);
          pcVar1 = DAT_6b8b06d4;
          if (iVar4 != 0) {
            iVar5 = *(int *)(local_10 + 4) + 0x14;
            iVar2 = *(int *)(local_10 + 0xc) + -0x14;
            puVar9 = &local_c;
            iVar3 = iVar4;
            _guard_check_icall();
            iVar3 = (*pcVar1)(iVar3,puVar9,iVar5,iVar2);
            if (iVar3 == 0) {
              FUN_6b8671a2(1,"SdbpOpenCompressedDatabase",0xc1,
                           "Expand callback failed to expand SDB");
            }
            else {
              ppiVar6 = (int **)FUN_6b86ffda(iVar4,local_c);
              if (ppiVar6 != (int **)0x0) {
                ppiVar6[4] = (int *)((uint)ppiVar6[4] | 0xc);
                iVar4 = 0;
                local_c = 0;
                local_8 = 1;
              }
            }
            if (iVar4 != 0) {
              RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iVar4);
              local_c = 0;
              if (ppiVar6 != (int **)0x0) {
                ppiVar6[1] = (int *)0x0;
              }
            }
            iVar4 = local_8;
            if ((local_8 == 0) && (ppiVar6 != (int **)0x0)) {
              FUN_6b86f964(ppiVar6);
              ppiVar6 = (int **)0x0;
            }
            goto LAB_6b872fcc;
          }
          pcVar11 = "SdbpOpenCompressedDatabase failed to allocate expanded buffer - out of memory";
          uVar10 = 0xb7;
        }
        else {
          pcVar11 = "Expanded SDB file too small or too large to be valid.";
          uVar10 = 0xad;
        }
      }
      else {
        pcVar11 = "SDB compression algorithm does not match callback algorithm.";
        uVar10 = 0xa4;
      }
    }
    else {
      pcVar11 = "SDB is not compressed";
      uVar10 = 0x9f;
    }
  }
  FUN_6b8671a2(1,"SdbpOpenCompressedDatabase",uVar10,pcVar11);
  iVar4 = local_8;
LAB_6b872fcc:
  piVar7 = local_14;
  FUN_6b86f964((int **)*local_14);
  *piVar7 = (int)ppiVar6;
  return iVar4;
}



// WARNING: Could not reconcile some variable overlaps

int __fastcall FUN_6b872fe1(int *param_1,int param_2,uint param_3,int param_4,int *param_5)

{
  short sVar1;
  undefined4 *puVar2;
  uint uVar3;
  uint uVar4;
  undefined8 *puVar5;
  int iVar6;
  int iVar7;
  int in_FS_OFFSET;
  bool bVar8;
  undefined8 uVar9;
  undefined8 local_3c;
  int *local_30;
  code *local_2c;
  int local_28;
  undefined4 local_24;
  undefined4 *local_20;
  uint local_1c;
  uint local_18;
  int local_14;
  int *local_10;
  uint local_c;
  undefined8 *local_8;
  
  *param_1 = 0;
  local_14 = 1;
  if (param_5 == (int *)0x0) {
LAB_6b873207:
    iVar6 = 0;
  }
  else {
    if (param_5[0xc] == 0) {
      if (param_5[2] == 0) {
        bVar8 = false;
        goto LAB_6b873020;
      }
    }
    else {
      bVar8 = param_5[6] != 0;
LAB_6b873020:
      if (!bVar8) goto LAB_6b873207;
    }
    local_30 = param_1;
    local_28 = param_2;
    puVar2 = (undefined4 *)
             RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),8,0x318);
    if (puVar2 == (undefined4 *)0x0) {
      iVar6 = -0x3fffffe9;
    }
    else {
      local_1c = 0;
      local_10 = &DAT_6b8b0294;
      iVar7 = local_14;
      local_20 = puVar2;
      do {
        local_18 = (uint)*(ushort *)(local_10 + -1);
        uVar3 = FUN_6b86f000(param_3,param_4,*(ushort *)(local_10 + -1));
        if (uVar3 != 0) {
          uVar4 = local_18 & 0xf000;
          local_8 = (undefined8 *)0x0;
          local_c = 0;
          if (uVar4 == 0x4000) {
            local_24 = FUN_6b86f4a0(param_3,uVar3,0);
            local_8 = (undefined8 *)&local_24;
            local_c = 4;
          }
          else if (uVar4 == 0x5000) {
            uVar9 = FUN_6b86f510(param_3,uVar3,0,0);
            local_8 = &local_3c;
            local_c = 8;
            local_3c = uVar9;
          }
          else if (uVar4 == 0x6000) {
            local_8 = (undefined8 *)FUN_6b86f2d7(param_3,uVar3);
            puVar5 = local_8;
            do {
              sVar1 = *(short *)puVar5;
              puVar5 = (undefined8 *)((int)puVar5 + 2);
            } while (sVar1 != 0);
            local_c = ((int)puVar5 - (int)((int)local_8 + 2) >> 1) * 2 + 2;
          }
          uVar3 = local_c;
          uVar9 = _allshl();
          iVar6 = FUN_6b86b740(puVar2,param_5,(uint)uVar9,(uint)((ulonglong)uVar9 >> 0x20));
          puVar2 = local_20;
          if (iVar6 < 0) {
            FUN_6b8671a2(1,"SdbpCheckAllAttributes",0x2e8,"Failed to get attribute %d [%x]");
            goto LAB_6b8731a4;
          }
          if ((*(byte *)(local_20 + *local_10 * 6 + 4) & 1) == 0) {
            iVar6 = 0;
            goto LAB_6b8731a4;
          }
          iVar6 = FUN_6b873212(&local_14,(ushort)local_18,(uint *)local_8,uVar3,
                               (int)(local_20 + *local_10 * 6));
          iVar7 = local_14;
          if (iVar6 == 0) {
            iVar6 = -0x3fffff1b;
            FUN_6b8671a2(1,"SdbpCheckAllAttributes",0x2ff,"SdbpCheckAttribute failed [%x]");
            goto LAB_6b8731a4;
          }
          local_2c = *(code **)(local_28 + 0x270);
          if (local_2c != (code *)0x0) {
            uVar3 = local_18;
            puVar5 = local_8;
            uVar4 = local_c;
            iVar6 = local_14;
            _guard_check_icall();
            (*local_2c)(uVar3,puVar5,uVar4,iVar6);
          }
          if (iVar7 == 0) break;
        }
        local_1c = local_1c + 8;
        local_10 = local_10 + 2;
      } while (local_1c < 0x110);
      iVar6 = 0;
      *local_30 = iVar7;
LAB_6b8731a4:
      puVar2 = local_20;
      FUN_6b86ba91(local_20);
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,puVar2);
    }
  }
  return iVar6;
}



undefined4 __fastcall
FUN_6b873212(int *param_1,ushort param_2,uint *param_3,uint param_4,int param_5)

{
  undefined3 extraout_var;
  undefined3 extraout_var_00;
  uint uVar1;
  int iVar2;
  bool bVar3;
  undefined4 uVar4;
  
  iVar2 = 0;
  uVar1 = (uint)param_2;
  *param_1 = 0;
  if (uVar1 < 0x5007) {
    if (uVar1 != 0x5006) {
      if (uVar1 == 0x401e) {
        if (param_4 < 4) {
          uVar4 = 0x23c;
          goto LAB_6b87326d;
        }
        bVar3 = *param_3 < *(uint *)(param_5 + 8);
      }
      else {
        if (uVar1 != 0x4033) {
          if (uVar1 - 0x5002 < 2) {
            if (7 < param_4) {
              iVar2 = FUN_6b8734ae(*param_3,param_3[1],*(undefined4 *)(param_5 + 8),
                                   *(undefined4 *)(param_5 + 0xc));
              goto LAB_6b8733fb;
            }
            uVar4 = 0x206;
            goto LAB_6b87326d;
          }
          goto LAB_6b87332f;
        }
        if (param_4 < 4) {
          uVar4 = 0x22f;
          goto LAB_6b87326d;
        }
        bVar3 = *(uint *)(param_5 + 8) < *param_3;
      }
LAB_6b8733cb:
      iVar2 = 1 - (uint)bVar3;
      goto LAB_6b8733fb;
    }
  }
  else if (uVar1 != 0x500d) {
    if ((0x5011 < uVar1) && (param_2 < 0x5014)) {
      if (param_4 < 8) {
        uVar4 = 0x214;
        goto LAB_6b87326d;
      }
      bVar3 = FUN_6b873406(*param_3,param_3[1],*(undefined4 *)(param_5 + 8),
                           *(undefined4 *)(param_5 + 0xc));
      iVar2 = CONCAT31(extraout_var,bVar3);
      goto LAB_6b8733fb;
    }
LAB_6b87332f:
    uVar1 = uVar1 & 0xf000;
    if (uVar1 != 0x4000) {
      if (uVar1 == 0x5000) {
        if (param_4 < 8) {
          uVar4 = 0x26a;
          goto LAB_6b87326d;
        }
        if ((*param_3 == *(uint *)(param_5 + 8)) && (param_3[1] == *(uint *)(param_5 + 0xc))) {
          iVar2 = 1;
        }
      }
      else if (uVar1 == 0x6000) {
        if (param_4 < 2) {
          uVar4 = 0x25c;
          goto LAB_6b87326d;
        }
        iVar2 = FUN_6b86a0be((short *)param_3,*(short **)(param_5 + 8));
      }
      goto LAB_6b8733fb;
    }
    if (param_4 < 4) {
      uVar4 = 0x24c;
      goto LAB_6b87326d;
    }
    bVar3 = *param_3 != *(uint *)(param_5 + 8);
    goto LAB_6b8733cb;
  }
  if (param_4 < 8) {
    uVar4 = 0x222;
LAB_6b87326d:
    FUN_6b8671a2(1,"SdbpCheckAttribute",uVar4,"Attribute size doesn\'t match");
    return 0;
  }
  bVar3 = FUN_6b87345a(*param_3,param_3[1],*(undefined4 *)(param_5 + 8),
                       *(undefined4 *)(param_5 + 0xc));
  iVar2 = CONCAT31(extraout_var_00,bVar3);
LAB_6b8733fb:
  *param_1 = iVar2;
  return 1;
}



bool FUN_6b873406(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  ushort uVar1;
  ushort uVar2;
  int iVar3;
  
  iVar3 = 0x30;
  while( true ) {
    uVar1 = _aullshr();
    uVar2 = _aullshr();
    if ((uVar1 != uVar2) && (uVar1 != 0xffff)) break;
    iVar3 = iVar3 + -0x10;
    if (iVar3 < 0) {
      return true;
    }
  }
  return uVar1 < uVar2;
}



bool FUN_6b87345a(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  ushort uVar1;
  ushort uVar2;
  int iVar3;
  
  iVar3 = 0x30;
  while( true ) {
    uVar1 = _aullshr();
    uVar2 = _aullshr();
    if ((uVar1 != uVar2) && (uVar1 != 0xffff)) break;
    iVar3 = iVar3 + -0x10;
    if (iVar3 < 0) {
      return true;
    }
  }
  return uVar2 < uVar1;
}



undefined4 FUN_6b8734ae(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  short sVar1;
  short sVar2;
  int iVar3;
  
  iVar3 = 0x30;
  while( true ) {
    sVar1 = _aullshr();
    sVar2 = _aullshr();
    if ((sVar1 != sVar2) && (sVar1 != -1)) break;
    iVar3 = iVar3 + -0x10;
    if (iVar3 < 0) {
      return 1;
    }
  }
  return 0;
}



void FUN_6b8734f6(undefined4 param_1,undefined4 param_2)

{
  ResolveDelayLoadedAPI(&IMAGE_DOS_HEADER_6b800000,param_1,0,DelayLoadFailureHook_exref,param_2,0);
  return;
}



int __fastcall FUN_6b873522(short *param_1,uint *param_2)

{
  short sVar1;
  int iVar2;
  short *psVar3;
  undefined4 local_3c;
  undefined4 local_38;
  undefined *local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined local_24 [8];
  undefined local_1c [8];
  undefined local_14 [8];
  int local_c;
  int local_8;
  
  local_8 = 0;
  RtlInitUnicodeString(local_1c,L"Network ComputerName");
  RtlInitUnicodeString
            (local_14,
             L"\\Registry\\Machine\\System\\CurrentControlSet\\Control\\ComputerName\\ActiveComputerName"
            );
  local_34 = local_14;
  local_3c = 0x18;
  local_38 = 0;
  local_30 = 0x40;
  local_2c = 0;
  local_28 = 0;
  iVar2 = NtCreateKey(&local_8,0x2001f,&local_3c,0,local_1c,1,&local_c);
  if (-1 < iVar2) {
    if (local_c == 2) {
      iVar2 = FUN_6b873779(0,(undefined *)
                             L"\\Registry\\Machine\\System\\CurrentControlSet\\Control\\ComputerName\\ActiveComputerName"
                           ,L"ComputerName",param_1,param_2);
      if (iVar2 == -0x3fffffcc) {
        iVar2 = -0x3fffffff;
        goto LAB_6b8735f7;
      }
    }
    RtlInitUnicodeString(local_24,L"ComputerName");
    psVar3 = param_1;
    do {
      sVar1 = *psVar3;
      psVar3 = psVar3 + 1;
    } while (sVar1 != 0);
    iVar2 = NtSetValueKey(local_8,local_24,0,1,param_1,
                          ((int)psVar3 - (int)(param_1 + 1) >> 1) * 2 + 2);
  }
LAB_6b8735f7:
  if (local_8 != 0) {
    NtClose(local_8);
  }
  return iVar2;
}



undefined4 FUN_6b87360d(void)

{
  HMODULE hModule;
  FARPROC pFVar1;
  int iVar2;
  undefined4 uVar3;
  
  hModule = LoadLibraryExW(L"DNSAPI.DLL",(HANDLE)0x0,0);
  if (hModule == (HMODULE)0x0) {
    RtlSetLastWin32Error(0x485);
  }
  else {
    pFVar1 = GetProcAddress(hModule,"DnsValidateName_W");
    if (pFVar1 == (FARPROC)0x0) {
      FreeLibrary(hModule);
      uVar3 = 0x482;
    }
    else {
      _guard_check_icall();
      iVar2 = (*pFVar1)();
      FreeLibrary(hModule);
      if ((iVar2 == 0) || (iVar2 == 0x2554)) {
        return 1;
      }
      uVar3 = 0x57;
    }
    RtlSetLastWin32Error(uVar3);
  }
  return 0;
}



undefined4 __fastcall FUN_6b87368d(wchar_t *param_1)

{
  wchar_t wVar1;
  int iVar2;
  size_t sVar3;
  wchar_t *pwVar4;
  uint uVar5;
  wchar_t *local_8;
  
  pwVar4 = param_1;
  do {
    wVar1 = *pwVar4;
    pwVar4 = pwVar4 + 1;
  } while (wVar1 != L'\0');
  uVar5 = (int)pwVar4 - (int)(param_1 + 1) >> 1;
  local_8 = param_1;
  iVar2 = RtlUnicodeToMultiByteSize(&local_8,param_1,uVar5 * 2);
  if ((((-1 < iVar2) && (local_8 != (wchar_t *)0x0)) && (local_8 < &DAT_00000010)) &&
     (((sVar3 = wcscspn(param_1,(wchar_t *)&_Control_6b890d30), uVar5 <= sVar3 && (*param_1 != L' ')
       ) && (param_1[uVar5 - 1] != L' ')))) {
    return 1;
  }
  RtlSetLastWin32Error(0x57);
  return 0;
}



LPWSTR __fastcall FUN_6b873700(COMPUTER_NAME_FORMAT param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  undefined4 *puVar3;
  LPWSTR lpBuffer;
  int in_FS_OFFSET;
  DWORD local_8;
  
  lpBuffer = (LPWSTR)0x0;
  local_8 = 0;
  BVar1 = GetComputerNameExW(param_1,(LPWSTR)0x0,&local_8);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
    if (DVar2 == 0xea) {
      puVar3 = (undefined4 *)KernelBaseGetGlobalData();
      lpBuffer = (LPWSTR)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),
                                         *puVar3,local_8 * 2);
      if (lpBuffer != (LPWSTR)0x0) {
        BVar1 = GetComputerNameExW(param_1,lpBuffer,&local_8);
        if (BVar1 == 0) {
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,lpBuffer);
          lpBuffer = (LPWSTR)0x0;
        }
      }
    }
  }
  return lpBuffer;
}



int __fastcall
FUN_6b873779(int param_1,undefined *param_2,undefined4 param_3,void *param_4,uint *param_5)

{
  int iVar1;
  uint uVar2;
  uint local_8;
  
  local_8 = *param_5 * 2;
  iVar1 = FUN_6b873a59(param_1,param_2,param_3,param_4,&local_8);
  if (iVar1 == -0x3fffffcc) {
    local_8 = *param_5 * 2;
    iVar1 = FUN_6b873a59(0,param_2,param_3,param_4,&local_8);
  }
  uVar2 = local_8 >> 1;
  *param_5 = uVar2;
  if (-1 < iVar1) {
    if ((uVar2 == 0) || (*(short *)((int)param_4 + ((local_8 & 0xfffffffe) - 2)) != 0)) {
      iVar1 = -0x3fffff1b;
    }
    else {
      *param_5 = uVar2 - 1;
    }
  }
  return iVar1;
}



wchar_t * __fastcall FUN_6b8737ed(int param_1)

{
  wchar_t wVar1;
  wchar_t *_Src;
  undefined4 *puVar2;
  wchar_t *pwVar3;
  wchar_t *pwVar4;
  int iVar5;
  int iVar6;
  rsize_t _SizeInWords;
  int in_FS_OFFSET;
  LPWSTR local_c;
  
  iVar6 = 0;
  if (param_1 < 0) {
    return (wchar_t *)0x0;
  }
  if (param_1 < 3) {
LAB_6b873973:
    pwVar3 = (wchar_t *)FUN_6b873983(param_1);
  }
  else {
    if (param_1 != 3) {
      if (param_1 < 4) {
        return (wchar_t *)0x0;
      }
      if (param_1 < 7) goto LAB_6b873973;
      if (param_1 != 7) {
        return (wchar_t *)0x0;
      }
    }
    local_c = FUN_6b8737ed(1);
    _Src = FUN_6b8737ed(2);
    if (local_c == (wchar_t *)0x0) {
      if (_Src == (wchar_t *)0x0) {
        return (wchar_t *)0x0;
      }
      local_c = FUN_6b873700(ComputerNameDnsHostname);
    }
    else if (_Src == (wchar_t *)0x0) {
      _Src = FUN_6b873700(ComputerNameDnsDomain);
    }
    if (local_c != (wchar_t *)0x0) {
      pwVar3 = local_c;
      do {
        wVar1 = *pwVar3;
        pwVar3 = pwVar3 + 1;
      } while (wVar1 != L'\0');
      iVar6 = (int)pwVar3 - (int)(local_c + 1) >> 1;
    }
    pwVar3 = local_c;
    if (_Src != (wchar_t *)0x0) {
      pwVar4 = _Src;
      do {
        wVar1 = *pwVar4;
        pwVar4 = pwVar4 + 1;
      } while (wVar1 != L'\0');
      iVar5 = (int)pwVar4 - (int)(_Src + 1) >> 1;
      if ((iVar5 != 0) && (iVar6 != 0)) {
        if ((iVar5 == 1) && (*_Src == L'.')) {
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,_Src);
          _Src = (wchar_t *)0x0;
          iVar5 = 0;
        }
        _SizeInWords = iVar6 + iVar5 + 2;
        puVar2 = (undefined4 *)KernelBaseGetGlobalData();
        pwVar3 = (wchar_t *)
                 RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar2,
                                 _SizeInWords * 2);
        if (pwVar3 != (wchar_t *)0x0) {
          wcscpy_s(pwVar3,_SizeInWords,local_c);
          wcscat_s(pwVar3,_SizeInWords,(wchar_t *)&_Src_6b886d1c);
          if (_Src != (wchar_t *)0x0) {
            wcscat_s(pwVar3,_SizeInWords,_Src);
          }
        }
        if (local_c != (wchar_t *)0x0) {
          RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_c);
        }
      }
    }
    if (_Src != (wchar_t *)0x0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,_Src);
    }
  }
  return pwVar3;
}



void * __fastcall FUN_6b873983(int param_1)

{
  wchar_t *pwVar1;
  int iVar2;
  undefined4 *puVar3;
  wchar_t *pwVar4;
  void *pvVar5;
  wchar_t *pwVar6;
  int in_FS_OFFSET;
  uint local_8;
  
  local_8 = 0;
  pvVar5 = (void *)0x0;
  if (param_1 == 0) {
LAB_6b8739dc:
    pwVar6 = (wchar_t *)0x0;
    pwVar4 = L"\\Registry\\Machine\\System\\CurrentControlSet\\Control\\ComputerName\\ComputerName";
    pwVar1 = L"ComputerName";
  }
  else {
    if (param_1 == 1) {
LAB_6b8739cb:
      pwVar6 = L"DnscacheTcpipParameters";
      pwVar4 = L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters";
      pwVar1 = L"NV Hostname";
      goto LAB_6b8739e8;
    }
    if (param_1 != 2) {
      if (param_1 == 4) goto LAB_6b8739dc;
      if (param_1 == 5) goto LAB_6b8739cb;
      if (param_1 != 6) {
        return (void *)0x0;
      }
    }
    pwVar6 = L"DnscacheTcpipParameters";
    pwVar4 = L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters";
    pwVar1 = L"NV Domain";
  }
LAB_6b8739e8:
  iVar2 = FUN_6b873779((int)pwVar6,(undefined *)pwVar4,pwVar1,(void *)0x0,&local_8);
  if (iVar2 == -0x7ffffffb) {
    puVar3 = (undefined4 *)KernelBaseGetGlobalData();
    pvVar5 = (void *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar3,
                                     local_8 * 2);
    if (pvVar5 == (void *)0x0) {
      return (void *)0x0;
    }
    iVar2 = FUN_6b873779((int)pwVar6,(undefined *)pwVar4,pwVar1,pvVar5,&local_8);
  }
  if (iVar2 < 0) {
    if (pvVar5 != (void *)0x0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,pvVar5);
    }
    return (void *)0x0;
  }
  return pvVar5;
}



void __fastcall
FUN_6b873a59(int param_1,undefined *param_2,undefined4 param_3,void *param_4,uint *param_5)

{
  uint uVar1;
  size_t _Size;
  undefined4 extraout_EDX;
  int extraout_EDX_00;
  undefined4 uVar2;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined *puVar3;
  int iVar4;
  int in_FS_OFFSET;
  ulonglong uVar5;
  ulonglong uVar6;
  undefined4 local_2d4;
  undefined4 local_2d0;
  undefined *local_2cc;
  undefined4 local_2c8;
  undefined4 local_2c4;
  undefined4 local_2c0;
  undefined local_2bc [8];
  undefined local_2b4 [8];
  undefined4 local_2ac;
  undefined4 local_2a8;
  void *local_2a4;
  int local_2a0;
  char local_299;
  undefined local_298 [520];
  undefined local_90 [132];
  uint local_c;
  
  local_c = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_2ac = param_3;
  local_2a4 = param_4;
  puVar3 = local_90;
  local_2a0 = 0;
  local_299 = '\0';
  iVar4 = 0;
  if (param_1 != 0) {
    iVar4 = RtlGetPersistedStateLocation(param_1,L"TargetNtPath",param_2,0,local_298,0x208,0);
    param_2 = local_298;
  }
  RtlInitUnicodeString(local_2b4,param_2);
  uVar6 = CONCAT44(extraout_EDX,puVar3);
  if (iVar4 < 0) goto LAB_6b873c88;
  local_2cc = local_2b4;
  local_2d4 = 0x18;
  local_2d0 = 0;
  local_2c8 = 0x40;
  local_2c4 = 0;
  local_2c0 = 0;
  uVar5 = NtOpenKey(&local_2a0,0x20019,&local_2d4);
  uVar6 = uVar5 & 0xffffffff00000000 | ZEXT48(puVar3);
  if ((int)uVar5 < 0) goto LAB_6b873c88;
  RtlInitUnicodeString(local_2bc,local_2ac);
  uVar5 = NtQueryValueKey(local_2a0,local_2bc,1,local_90,0x80,&local_2a8);
  if ((int)uVar5 == -0x7ffffffb) {
    uVar6 = RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,local_2a8);
    puVar3 = (undefined *)uVar6;
    if (puVar3 == (undefined *)0x0) goto LAB_6b873c88;
    local_299 = '\x01';
    uVar5 = NtQueryValueKey(local_2a0,local_2bc,1,puVar3,local_2a8,&local_2a8);
  }
  iVar4 = (int)(uVar5 >> 0x20);
  uVar6 = uVar5 & 0xffffffff00000000 | ZEXT48(puVar3);
  if (((int)uVar5 < 0) ||
     (uVar1 = *(uint *)(puVar3 + 4), uVar6 = uVar5 & 0xffffffff00000000 | ZEXT48(puVar3), uVar1 == 0
     )) goto LAB_6b873c88;
  if (uVar1 < 3) {
LAB_6b873c1d:
    uVar6 = uVar5 & 0xffffffff00000000 | ZEXT48(puVar3);
    if (*(uint *)(puVar3 + 0xc) < 2) goto LAB_6b873c88;
    _Size = *(uint *)(puVar3 + 0xc) & 0xfffffffe;
    *(size_t *)(puVar3 + 0xc) = _Size;
    if (*(short *)(puVar3 + *(int *)(puVar3 + 8) + _Size + -2) == 0) {
      _Size = _Size - 2;
      *(size_t *)(puVar3 + 0xc) = _Size;
    }
    iVar4 = *(int *)(puVar3 + 8);
    uVar1 = _Size + 2;
    if ((uVar1 <= *param_5) && (local_2a4 != (void *)0x0)) {
      memcpy(local_2a4,puVar3 + iVar4,_Size);
      iVar4 = 0;
      *(undefined2 *)((int)local_2a4 + *(int *)(puVar3 + 0xc)) = 0;
      uVar1 = *(int *)(puVar3 + 0xc) + 2;
    }
  }
  else {
    if (4 < uVar1) {
      if (uVar1 == 7) goto LAB_6b873c1d;
      uVar6 = uVar5 & 0xffffffff00000000 | ZEXT48(puVar3);
      if (uVar1 != 0xb) goto LAB_6b873c88;
    }
    uVar1 = *(uint *)(puVar3 + 0xc);
    if (uVar1 <= *param_5) {
      memcpy(local_2a4,puVar3 + *(int *)(puVar3 + 8),uVar1);
      uVar1 = *(uint *)(puVar3 + 0xc);
      iVar4 = extraout_EDX_00;
    }
  }
  *param_5 = uVar1;
  uVar6 = CONCAT44(iVar4,puVar3);
LAB_6b873c88:
  uVar2 = (undefined4)(uVar6 >> 0x20);
  if (local_2a0 != 0) {
    NtClose(local_2a0);
    local_2a0 = 0;
    uVar2 = extraout_EDX_01;
  }
  if (local_299 != '\0') {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,(int)uVar6);
    uVar2 = extraout_EDX_02;
  }
  FUN_6b8224af(local_c ^ (uint)&stack0xfffffffc,uVar2);
  return;
}



int * __fastcall FUN_6b873cd6(HANDLE param_1)

{
  undefined4 *puVar1;
  int *_Dst;
  BOOL BVar2;
  DWORD DVar3;
  int in_FS_OFFSET;
  size_t local_8;
  
  local_8 = 0x20;
  puVar1 = (undefined4 *)KernelBaseGetGlobalData();
  _Dst = (int *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar1,
                                local_8);
  while (_Dst != (int *)0x0) {
    memset(_Dst,0,local_8);
    BVar2 = DeviceIoControl(param_1,0x560000,(LPVOID)0x0,0,_Dst,local_8,&local_8,(LPOVERLAPPED)0x0);
    if (BVar2 == 1) {
      return _Dst;
    }
    DVar3 = GetLastError();
    if (DVar3 != 0xea) goto LAB_6b873d7e;
    local_8 = *_Dst * 0x18 + 8;
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,_Dst);
    puVar1 = (undefined4 *)KernelBaseGetGlobalData();
    _Dst = (int *)RtlAllocateHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),*puVar1,
                                  local_8);
  }
  DVar3 = 8;
LAB_6b873d7e:
  if (DVar3 != 0) {
    if (_Dst != (int *)0x0) {
      RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,_Dst);
      _Dst = (int *)0x0;
    }
    RtlSetLastWin32Error(DVar3);
  }
  return _Dst;
}



void FUN_6b873da8(void)

{
  uint uVar1;
  BOOL BVar2;
  int iVar3;
  undefined4 extraout_EDX;
  undefined4 uVar4;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  DWORD DVar5;
  HANDLE hDevice;
  uint *puVar6;
  DWORD local_6c;
  uint local_68 [8];
  wchar_t local_48 [32];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_6c = 0;
  DVar5 = 0;
  hDevice = (HANDLE)0xffffffff;
  uVar1 = FUN_6b81fb19(local_48,0x40,L"\\\\.\\PhysicalDrive%lu");
  if ((int)uVar1 < 0) {
    DVar5 = uVar1 & 0xffff;
    uVar4 = extraout_EDX;
  }
  else {
    hDevice = CreateFileW(local_48,0x80000000,3,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0xffffffff
                         );
    if (hDevice != (HANDLE)0xffffffff) {
      puVar6 = local_68;
      for (iVar3 = 8; iVar3 != 0; iVar3 = iVar3 + -1) {
        *puVar6 = 0;
        puVar6 = puVar6 + 1;
      }
      BVar2 = DeviceIoControl(hDevice,0x70214,(LPVOID)0x0,0,local_68,0x20,&local_6c,
                              (LPOVERLAPPED)0x0);
      if (BVar2 != 0) {
        uVar4 = extraout_EDX_03;
        if ((local_68[2] & 2) != 0) goto LAB_6b873ded;
        goto LAB_6b873de2;
      }
    }
    DVar5 = GetLastError();
    uVar4 = extraout_EDX_02;
  }
LAB_6b873de2:
  if (DVar5 != 0) {
    RtlSetLastWin32Error(DVar5);
    uVar4 = extraout_EDX_00;
  }
LAB_6b873ded:
  if (hDevice != (HANDLE)0xffffffff) {
    CloseHandle(hDevice);
    uVar4 = extraout_EDX_01;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar4);
  return;
}



void FUN_6b873e81(void)

{
  uint uVar1;
  BOOL BVar2;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 uVar3;
  DWORD DVar4;
  HANDLE hDevice;
  DWORD local_50;
  char local_49;
  wchar_t local_48 [32];
  uint local_8;
  
  local_8 = DAT_6b8b0140 ^ (uint)&stack0xfffffffc;
  local_50 = 0;
  DVar4 = 0;
  local_49 = '\0';
  hDevice = (HANDLE)0xffffffff;
  uVar1 = FUN_6b81fb19(local_48,0x40,L"\\\\.\\PhysicalDrive%lu");
  if ((int)uVar1 < 0) {
    DVar4 = uVar1 & 0xffff;
    uVar3 = extraout_EDX;
  }
  else {
    hDevice = CreateFileW(local_48,0,3,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0xffffffff);
    if (hDevice != (HANDLE)0xffffffff) {
      BVar2 = DeviceIoControl(hDevice,0x700f8,(LPVOID)0x0,0,&local_49,1,&local_50,(LPOVERLAPPED)0x0)
      ;
      if (BVar2 != 0) {
        uVar3 = extraout_EDX_01;
        if (local_49 != '\0') goto LAB_6b873f1f;
        goto LAB_6b873f12;
      }
    }
    DVar4 = GetLastError();
    uVar3 = extraout_EDX_00;
  }
LAB_6b873f12:
  if (DVar4 != 0) {
    RtlSetLastWin32Error(DVar4);
    uVar3 = extraout_EDX_02;
  }
LAB_6b873f1f:
  if (hDevice != (HANDLE)0xffffffff) {
    CloseHandle(hDevice);
    uVar3 = extraout_EDX_03;
  }
  FUN_6b8224af(local_8 ^ (uint)&stack0xfffffffc,uVar3);
  return;
}



uint __fastcall FUN_6b873f44(LPCWSTR param_1,int param_2)

{
  WCHAR WVar1;
  HANDLE hObject;
  DWORD DVar2;
  int *piVar3;
  int in_FS_OFFSET;
  uint local_c;
  
  DVar2 = 0;
  piVar3 = (int *)0x0;
  local_c = 0;
  WVar1 = param_1[param_2 + -1];
  if (WVar1 == L'\\') {
    param_1[param_2 + -1] = L'\0';
  }
  hObject = CreateFileW(param_1,0,3,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0xffffffff);
  if (WVar1 == L'\\') {
    param_1[param_2 + -1] = L'\\';
  }
  if (hObject == (HANDLE)0xffffffff) {
LAB_6b873fa9:
    DVar2 = GetLastError();
LAB_6b873fd4:
    if (DVar2 == 0) goto LAB_6b873fdf;
  }
  else {
    piVar3 = FUN_6b873cd6(hObject);
    if (piVar3 == (int *)0x0) goto LAB_6b873fa9;
    if (*piVar3 != 0) {
      local_c = FUN_6b873da8();
      goto LAB_6b873fd4;
    }
    DVar2 = 0x57;
  }
  RtlSetLastWin32Error(DVar2);
LAB_6b873fdf:
  if (hObject != (HANDLE)0xffffffff) {
    CloseHandle(hObject);
  }
  if (piVar3 != (int *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,piVar3);
  }
  return ~-(uint)(DVar2 != 0) & local_c;
}



uint __fastcall FUN_6b874011(LPCWSTR param_1,int param_2)

{
  WCHAR WVar1;
  HANDLE hObject;
  DWORD DVar2;
  int *piVar3;
  int in_FS_OFFSET;
  uint local_c;
  
  DVar2 = 0;
  piVar3 = (int *)0x0;
  local_c = 0;
  WVar1 = param_1[param_2 + -1];
  if (WVar1 == L'\\') {
    param_1[param_2 + -1] = L'\0';
  }
  hObject = CreateFileW(param_1,0,3,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0xffffffff);
  if (WVar1 == L'\\') {
    param_1[param_2 + -1] = L'\\';
  }
  if (hObject == (HANDLE)0xffffffff) {
LAB_6b874076:
    DVar2 = GetLastError();
LAB_6b8740a1:
    if (DVar2 == 0) goto LAB_6b8740ac;
  }
  else {
    piVar3 = FUN_6b873cd6(hObject);
    if (piVar3 == (int *)0x0) goto LAB_6b874076;
    if (*piVar3 != 0) {
      local_c = FUN_6b873e81();
      goto LAB_6b8740a1;
    }
    DVar2 = 0x57;
  }
  RtlSetLastWin32Error(DVar2);
LAB_6b8740ac:
  if (hObject != (HANDLE)0xffffffff) {
    CloseHandle(hObject);
  }
  if (piVar3 != (int *)0x0) {
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,piVar3);
  }
  return ~-(uint)(DVar2 != 0) & local_c;
}



void __fastcall FUN_6b8740de(int *param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int in_FS_OFFSET;
  
  if (param_1 != (int *)0x0) {
    iVar1 = param_1[1];
    if (iVar1 != 0) {
      iVar3 = 0;
      if (0 < *param_1) {
        do {
          iVar2 = *(int *)(iVar1 + iVar3 * 4);
          if (iVar2 != 0) {
            do {
              iVar1 = *(int *)(iVar2 + 8);
              RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iVar2);
              iVar2 = iVar1;
            } while (iVar1 != 0);
            iVar1 = param_1[1];
          }
          iVar3 = iVar3 + 1;
        } while (iVar3 < *param_1);
      }
      if (iVar1 != 0) {
        RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,iVar1);
      }
    }
    RtlFreeHeap(*(undefined4 *)(*(int *)(in_FS_OFFSET + 0x30) + 0x18),0,param_1);
  }
  return;
}



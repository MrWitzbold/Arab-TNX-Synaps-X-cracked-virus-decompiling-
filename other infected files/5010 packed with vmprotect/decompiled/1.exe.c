typedef unsigned char   undefined;

typedef unsigned long long    GUID;
typedef unsigned int    ImageBaseOffset32;
typedef unsigned long long    ImageBaseOffset64;
typedef unsigned char    bool;
typedef unsigned char    byte;
typedef unsigned int    dword;
typedef long long    longlong;
typedef unsigned long long    qword;
typedef unsigned char    uchar;
typedef unsigned int    uint;
typedef unsigned long    ulong;
typedef unsigned long long    ulonglong;
typedef unsigned char    undefined1;
typedef unsigned short    undefined2;
typedef unsigned int    undefined4;
typedef unsigned long long    undefined8;
typedef unsigned short    ushort;
typedef short    wchar_t;
typedef unsigned short    word;
typedef unsigned short    wchar16;
typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion;

typedef struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct;

struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct {
    dword OffsetToDirectory;
    dword DataIsDirectory;
};

union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion {
    dword OffsetToData;
    struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct;
};

typedef struct _IMAGE_RUNTIME_FUNCTION_ENTRY _IMAGE_RUNTIME_FUNCTION_ENTRY, *P_IMAGE_RUNTIME_FUNCTION_ENTRY;

struct _IMAGE_RUNTIME_FUNCTION_ENTRY {
    ImageBaseOffset32 BeginAddress;
    ImageBaseOffset32 EndAddress;
    ImageBaseOffset32 UnwindInfoAddressOrData;
};

typedef struct _cpinfo _cpinfo, *P_cpinfo;

typedef uint UINT;

typedef uchar BYTE;

struct _cpinfo {
    UINT MaxCharSize;
    BYTE DefaultChar[2];
    BYTE LeadByte[12];
};

typedef int BOOL;

typedef char CHAR;

typedef CHAR * LPSTR;

typedef BOOL (* CALINFO_ENUMPROCA)(LPSTR);

typedef long LONG;

typedef LONG GEOID;

typedef struct _nlsversioninfoex _nlsversioninfoex, *P_nlsversioninfoex;

typedef ulong DWORD;


// WARNING! conflicting data type names: /guiddef.h/GUID - /GUID

struct _nlsversioninfoex {
    DWORD dwNLSVersionInfoSize;
    DWORD dwNLSVersion;
    DWORD dwDefinedVersion;
    DWORD dwEffectiveId;
    GUID guidCustomVersion;
};

typedef DWORD CALID;

typedef BOOL (* CALINFO_ENUMPROCEXA)(LPSTR, CALID);

typedef struct _currencyfmtW _currencyfmtW, *P_currencyfmtW;

typedef struct _currencyfmtW CURRENCYFMTW;

typedef wchar_t WCHAR;

typedef WCHAR * LPWSTR;

struct _currencyfmtW {
    UINT NumDigits;
    UINT LeadingZero;
    UINT Grouping;
    LPWSTR lpDecimalSep;
    LPWSTR lpThousandSep;
    UINT NegativeOrder;
    UINT PositiveOrder;
    LPWSTR lpCurrencySymbol;
};

typedef struct _numberfmtW _numberfmtW, *P_numberfmtW;

typedef struct _numberfmtW NUMBERFMTW;

struct _numberfmtW {
    UINT NumDigits;
    UINT LeadingZero;
    UINT Grouping;
    LPWSTR lpDecimalSep;
    LPWSTR lpThousandSep;
    UINT NegativeOrder;
};

typedef struct _nlsversioninfo _nlsversioninfo, *P_nlsversioninfo;

typedef struct _nlsversioninfo * LPNLSVERSIONINFO;

struct _nlsversioninfo {
    DWORD dwNLSVersionInfoSize;
    DWORD dwNLSVersion;
    DWORD dwDefinedVersion;
};

typedef struct _numberfmtA _numberfmtA, *P_numberfmtA;

typedef struct _numberfmtA NUMBERFMTA;

struct _numberfmtA {
    UINT NumDigits;
    UINT LeadingZero;
    UINT Grouping;
    LPSTR lpDecimalSep;
    LPSTR lpThousandSep;
    UINT NegativeOrder;
};

typedef struct _nlsversioninfoex * LPNLSVERSIONINFOEX;

typedef struct _currencyfmtA _currencyfmtA, *P_currencyfmtA;

typedef struct _currencyfmtA CURRENCYFMTA;

struct _currencyfmtA {
    UINT NumDigits;
    UINT LeadingZero;
    UINT Grouping;
    LPSTR lpDecimalSep;
    LPSTR lpThousandSep;
    UINT NegativeOrder;
    UINT PositiveOrder;
    LPSTR lpCurrencySymbol;
};

typedef DWORD LGRPID;

typedef longlong LONG_PTR;

typedef BOOL (* LANGUAGEGROUP_ENUMPROCW)(LGRPID, LPWSTR, LPWSTR, DWORD, LONG_PTR);

typedef BOOL (* GEO_ENUMPROC)(GEOID);

typedef BOOL (* CALINFO_ENUMPROCW)(LPWSTR);

typedef BOOL (* LANGUAGEGROUP_ENUMPROCA)(LGRPID, LPSTR, LPSTR, DWORD, LONG_PTR);

typedef LONG_PTR LPARAM;

typedef BOOL (* CALINFO_ENUMPROCEXEX)(LPWSTR, CALID, LPWSTR, LPARAM);

typedef BOOL (* UILANGUAGE_ENUMPROCA)(LPSTR, LONG_PTR);

typedef struct _cpinfoexW _cpinfoexW, *P_cpinfoexW;

struct _cpinfoexW {
    UINT MaxCharSize;
    BYTE DefaultChar[2];
    BYTE LeadByte[12];
    WCHAR UnicodeDefaultChar;
    UINT CodePage;
    WCHAR CodePageName[260];
};

typedef DWORD NLS_FUNCTION;

typedef struct _cpinfoexA _cpinfoexA, *P_cpinfoexA;

typedef struct _cpinfoexA * LPCPINFOEXA;

struct _cpinfoexA {
    UINT MaxCharSize;
    BYTE DefaultChar[2];
    BYTE LeadByte[12];
    WCHAR UnicodeDefaultChar;
    UINT CodePage;
    CHAR CodePageName[260];
};

typedef enum _NORM_FORM {
    NormalizationOther=0,
    NormalizationC=1,
    NormalizationD=2,
    NormalizationKC=5,
    NormalizationKD=6
} _NORM_FORM;

typedef enum _NORM_FORM NORM_FORM;

typedef BOOL (* TIMEFMT_ENUMPROCEX)(LPWSTR, LPARAM);

typedef struct _cpinfo * LPCPINFO;

typedef DWORD LCTYPE;

typedef BOOL (* CALINFO_ENUMPROCEXW)(LPWSTR, CALID);

typedef BOOL (* DATEFMT_ENUMPROCEXA)(LPSTR, CALID);

typedef BOOL (* DATEFMT_ENUMPROCEXW)(LPWSTR, CALID);

typedef BOOL (* LOCALE_ENUMPROCA)(LPSTR);

typedef BOOL (* DATEFMT_ENUMPROCW)(LPWSTR);

typedef BOOL (* DATEFMT_ENUMPROCEXEX)(LPWSTR, CALID, LPARAM);

typedef struct _FILEMUIINFO _FILEMUIINFO, *P_FILEMUIINFO;

struct _FILEMUIINFO {
    DWORD dwSize;
    DWORD dwVersion;
    DWORD dwFileType;
    BYTE pChecksum[16];
    BYTE pServiceChecksum[16];
    DWORD dwLanguageNameOffset;
    DWORD dwTypeIDMainSize;
    DWORD dwTypeIDMainOffset;
    DWORD dwTypeNameMainOffset;
    DWORD dwTypeIDMUISize;
    DWORD dwTypeIDMUIOffset;
    DWORD dwTypeNameMUIOffset;
    BYTE abBuffer[8];
};

typedef BOOL (* TIMEFMT_ENUMPROCA)(LPSTR);

typedef BOOL (* LOCALE_ENUMPROCW)(LPWSTR);

typedef DWORD LCID;

typedef BOOL (* LANGGROUPLOCALE_ENUMPROCW)(LGRPID, LCID, LPWSTR, LONG_PTR);

typedef struct _cpinfoexW * LPCPINFOEXW;

typedef BOOL (* UILANGUAGE_ENUMPROCW)(LPWSTR, LONG_PTR);

typedef BOOL (* LANGGROUPLOCALE_ENUMPROCA)(LGRPID, LCID, LPSTR, LONG_PTR);

typedef DWORD GEOCLASS;

typedef BOOL (* DATEFMT_ENUMPROCA)(LPSTR);

typedef BOOL (* LOCALE_ENUMPROCEX)(LPWSTR, DWORD, LPARAM);

typedef BOOL (* CODEPAGE_ENUMPROCA)(LPSTR);

typedef DWORD CALTYPE;

typedef BOOL (* CODEPAGE_ENUMPROCW)(LPWSTR);

typedef struct _FILEMUIINFO * PFILEMUIINFO;

typedef DWORD GEOTYPE;

typedef BOOL (* TIMEFMT_ENUMPROCW)(LPWSTR);

typedef struct _RPC_MESSAGE _RPC_MESSAGE, *P_RPC_MESSAGE;

typedef struct _RPC_MESSAGE * PRPC_MESSAGE;

typedef void (* RPC_DISPATCH_FUNCTION)(PRPC_MESSAGE);

typedef void * I_RPC_HANDLE;

typedef I_RPC_HANDLE RPC_BINDING_HANDLE;

typedef struct _RPC_SYNTAX_IDENTIFIER _RPC_SYNTAX_IDENTIFIER, *P_RPC_SYNTAX_IDENTIFIER;

typedef struct _RPC_SYNTAX_IDENTIFIER * PRPC_SYNTAX_IDENTIFIER;

typedef struct _RPC_VERSION _RPC_VERSION, *P_RPC_VERSION;

typedef struct _RPC_VERSION RPC_VERSION;

struct _RPC_VERSION {
    ushort MajorVersion;
    ushort MinorVersion;
};

struct _RPC_SYNTAX_IDENTIFIER {
    GUID SyntaxGUID;
    RPC_VERSION SyntaxVersion;
};

struct _RPC_MESSAGE {
    RPC_BINDING_HANDLE Handle;
    ulong DataRepresentation;
    void * Buffer;
    uint BufferLength;
    uint ProcNum;
    PRPC_SYNTAX_IDENTIFIER TransferSyntax;
    void * RpcInterfaceInformation;
    void * ReservedForRuntime;
    void * ManagerEpv;
    void * ImportContext;
    ulong RpcFlags;
};

typedef struct RPC_DISPATCH_TABLE RPC_DISPATCH_TABLE, *PRPC_DISPATCH_TABLE;

struct RPC_DISPATCH_TABLE {
    uint DispatchTableCount;
    RPC_DISPATCH_FUNCTION * DispatchTable;
    LONG_PTR Reserved;
};

typedef struct _RPC_SYNTAX_IDENTIFIER RPC_SYNTAX_IDENTIFIER;

typedef struct GuardCfgTableEntry GuardCfgTableEntry, *PGuardCfgTableEntry;

struct GuardCfgTableEntry {
    ImageBaseOffset32 Offset;
    byte Pad[1];
};

typedef struct _COMMPROP _COMMPROP, *P_COMMPROP;

typedef struct _COMMPROP * LPCOMMPROP;

typedef ushort WORD;

struct _COMMPROP {
    WORD wPacketLength;
    WORD wPacketVersion;
    DWORD dwServiceMask;
    DWORD dwReserved1;
    DWORD dwMaxTxQueue;
    DWORD dwMaxRxQueue;
    DWORD dwMaxBaud;
    DWORD dwProvSubType;
    DWORD dwProvCapabilities;
    DWORD dwSettableParams;
    DWORD dwSettableBaud;
    WORD wSettableData;
    WORD wSettableStopParity;
    DWORD dwCurrentTxQueue;
    DWORD dwCurrentRxQueue;
    DWORD dwProvSpec1;
    DWORD dwProvSpec2;
    WCHAR wcProvChar[1];
};

typedef struct _TIME_DYNAMIC_ZONE_INFORMATION _TIME_DYNAMIC_ZONE_INFORMATION, *P_TIME_DYNAMIC_ZONE_INFORMATION;

typedef struct _TIME_DYNAMIC_ZONE_INFORMATION * PDYNAMIC_TIME_ZONE_INFORMATION;

typedef struct _SYSTEMTIME _SYSTEMTIME, *P_SYSTEMTIME;

typedef struct _SYSTEMTIME SYSTEMTIME;

typedef BYTE BOOLEAN;

struct _SYSTEMTIME {
    WORD wYear;
    WORD wMonth;
    WORD wDayOfWeek;
    WORD wDay;
    WORD wHour;
    WORD wMinute;
    WORD wSecond;
    WORD wMilliseconds;
};

struct _TIME_DYNAMIC_ZONE_INFORMATION {
    LONG Bias;
    WCHAR StandardName[32];
    SYSTEMTIME StandardDate;
    LONG StandardBias;
    WCHAR DaylightName[32];
    SYSTEMTIME DaylightDate;
    LONG DaylightBias;
    WCHAR TimeZoneKeyName[128];
    BOOLEAN DynamicDaylightTimeDisabled;
};

typedef struct FILE_ID_DESCRIPTOR FILE_ID_DESCRIPTOR, *PFILE_ID_DESCRIPTOR;

typedef struct FILE_ID_DESCRIPTOR * LPFILE_ID_DESCRIPTOR;

typedef enum _FILE_ID_TYPE {
    FileIdType=0,
    ObjectIdType=1,
    MaximumFileIdType=2
} _FILE_ID_TYPE;

typedef enum _FILE_ID_TYPE FILE_ID_TYPE;

typedef union _union_620 _union_620, *P_union_620;

typedef union _LARGE_INTEGER _LARGE_INTEGER, *P_LARGE_INTEGER;

typedef union _LARGE_INTEGER LARGE_INTEGER;

typedef struct _struct_19 _struct_19, *P_struct_19;

typedef struct _struct_20 _struct_20, *P_struct_20;

typedef longlong LONGLONG;

struct _struct_20 {
    DWORD LowPart;
    LONG HighPart;
};

struct _struct_19 {
    DWORD LowPart;
    LONG HighPart;
};

union _LARGE_INTEGER {
    struct _struct_19 s;
    struct _struct_20 u;
    LONGLONG QuadPart;
};

union _union_620 {
    LARGE_INTEGER FileId;
    GUID ObjectId;
};

struct FILE_ID_DESCRIPTOR {
    DWORD dwSize;
    FILE_ID_TYPE Type;
    union _union_620 u;
};

typedef struct tagACTCTXA tagACTCTXA, *PtagACTCTXA;

typedef struct tagACTCTXA ACTCTXA;

typedef ulong ULONG;

typedef CHAR * LPCSTR;

typedef ushort USHORT;

typedef WORD LANGID;

typedef struct HINSTANCE__ HINSTANCE__, *PHINSTANCE__;

typedef struct HINSTANCE__ * HINSTANCE;

typedef HINSTANCE HMODULE;

struct tagACTCTXA {
    ULONG cbSize;
    DWORD dwFlags;
    LPCSTR lpSource;
    USHORT wProcessorArchitecture;
    LANGID wLangId;
    LPCSTR lpAssemblyDirectory;
    LPCSTR lpResourceName;
    LPCSTR lpApplicationName;
    HMODULE hModule;
};

struct HINSTANCE__ {
    int unused;
};

typedef struct _SECURITY_ATTRIBUTES _SECURITY_ATTRIBUTES, *P_SECURITY_ATTRIBUTES;

typedef struct _SECURITY_ATTRIBUTES SECURITY_ATTRIBUTES;

typedef void * LPVOID;

struct _SECURITY_ATTRIBUTES {
    DWORD nLength;
    LPVOID lpSecurityDescriptor;
    BOOL bInheritHandle;
};

typedef struct _SYSTEM_POWER_STATUS _SYSTEM_POWER_STATUS, *P_SYSTEM_POWER_STATUS;

struct _SYSTEM_POWER_STATUS {
    BYTE ACLineStatus;
    BYTE BatteryFlag;
    BYTE BatteryLifePercent;
    BYTE Reserved1;
    DWORD BatteryLifeTime;
    DWORD BatteryFullLifeTime;
};

typedef struct _OVERLAPPED _OVERLAPPED, *P_OVERLAPPED;

typedef ulonglong ULONG_PTR;

typedef union _union_540 _union_540, *P_union_540;

typedef void * HANDLE;

typedef struct _struct_541 _struct_541, *P_struct_541;

typedef void * PVOID;

struct _struct_541 {
    DWORD Offset;
    DWORD OffsetHigh;
};

union _union_540 {
    struct _struct_541 s;
    PVOID Pointer;
};

struct _OVERLAPPED {
    ULONG_PTR Internal;
    ULONG_PTR InternalHigh;
    union _union_540 u;
    HANDLE hEvent;
};

typedef struct _PROCESS_HEAP_ENTRY _PROCESS_HEAP_ENTRY, *P_PROCESS_HEAP_ENTRY;

typedef struct _PROCESS_HEAP_ENTRY * LPPROCESS_HEAP_ENTRY;

typedef union _union_570 _union_570, *P_union_570;

typedef struct _struct_571 _struct_571, *P_struct_571;

typedef struct _struct_572 _struct_572, *P_struct_572;

struct _struct_571 {
    HANDLE hMem;
    DWORD dwReserved[3];
};

struct _struct_572 {
    DWORD dwCommittedSize;
    DWORD dwUnCommittedSize;
    LPVOID lpFirstBlock;
    LPVOID lpLastBlock;
};

union _union_570 {
    struct _struct_571 Block;
    struct _struct_572 Region;
};

struct _PROCESS_HEAP_ENTRY {
    PVOID lpData;
    DWORD cbData;
    BYTE cbOverhead;
    BYTE iRegionIndex;
    WORD wFlags;
    union _union_570 u;
};

typedef struct _EXCEPTION_DEBUG_INFO _EXCEPTION_DEBUG_INFO, *P_EXCEPTION_DEBUG_INFO;

typedef struct _EXCEPTION_RECORD _EXCEPTION_RECORD, *P_EXCEPTION_RECORD;

typedef struct _EXCEPTION_RECORD EXCEPTION_RECORD;

struct _EXCEPTION_RECORD {
    DWORD ExceptionCode;
    DWORD ExceptionFlags;
    struct _EXCEPTION_RECORD * ExceptionRecord;
    PVOID ExceptionAddress;
    DWORD NumberParameters;
    ULONG_PTR ExceptionInformation[15];
};

struct _EXCEPTION_DEBUG_INFO {
    EXCEPTION_RECORD ExceptionRecord;
    DWORD dwFirstChance;
};

typedef struct _CREATE_THREAD_DEBUG_INFO _CREATE_THREAD_DEBUG_INFO, *P_CREATE_THREAD_DEBUG_INFO;

typedef DWORD (* PTHREAD_START_ROUTINE)(LPVOID);

typedef PTHREAD_START_ROUTINE LPTHREAD_START_ROUTINE;

struct _CREATE_THREAD_DEBUG_INFO {
    HANDLE hThread;
    LPVOID lpThreadLocalBase;
    LPTHREAD_START_ROUTINE lpStartAddress;
};

typedef struct _OUTPUT_DEBUG_STRING_INFO _OUTPUT_DEBUG_STRING_INFO, *P_OUTPUT_DEBUG_STRING_INFO;

typedef struct _OUTPUT_DEBUG_STRING_INFO OUTPUT_DEBUG_STRING_INFO;

struct _OUTPUT_DEBUG_STRING_INFO {
    LPSTR lpDebugStringData;
    WORD fUnicode;
    WORD nDebugStringLength;
};

typedef enum _RTL_UMS_THREAD_INFO_CLASS {
    UmsThreadInvalidInfoClass=0,
    UmsThreadUserContext=1,
    UmsThreadPriority=2,
    UmsThreadAffinity=3,
    UmsThreadTeb=4,
    UmsThreadIsSuspended=5,
    UmsThreadIsTerminated=6,
    UmsThreadMaxInfoClass=7
} _RTL_UMS_THREAD_INFO_CLASS;

typedef enum _RTL_UMS_THREAD_INFO_CLASS UMS_THREAD_INFO_CLASS;

typedef struct _COMSTAT _COMSTAT, *P_COMSTAT;

typedef struct _COMSTAT * LPCOMSTAT;

struct _COMSTAT {
    DWORD fCtsHold:1;
    DWORD fDsrHold:1;
    DWORD fRlsdHold:1;
    DWORD fXoffHold:1;
    DWORD fXoffSent:1;
    DWORD fEof:1;
    DWORD fTxim:1;
    DWORD fReserved:25;
    DWORD cbInQue;
    DWORD cbOutQue;
};

typedef struct _struct_553 _struct_553, *P_struct_553;

struct _struct_553 {
    WORD wProcessorArchitecture;
    WORD wReserved;
};

typedef struct _WIN32_FIND_DATAW _WIN32_FIND_DATAW, *P_WIN32_FIND_DATAW;

typedef struct _WIN32_FIND_DATAW * LPWIN32_FIND_DATAW;

typedef struct _FILETIME _FILETIME, *P_FILETIME;

typedef struct _FILETIME FILETIME;

struct _FILETIME {
    DWORD dwLowDateTime;
    DWORD dwHighDateTime;
};

struct _WIN32_FIND_DATAW {
    DWORD dwFileAttributes;
    FILETIME ftCreationTime;
    FILETIME ftLastAccessTime;
    FILETIME ftLastWriteTime;
    DWORD nFileSizeHigh;
    DWORD nFileSizeLow;
    DWORD dwReserved0;
    DWORD dwReserved1;
    WCHAR cFileName[260];
    WCHAR cAlternateFileName[14];
};

typedef struct _DCB _DCB, *P_DCB;

struct _DCB {
    DWORD DCBlength;
    DWORD BaudRate;
    DWORD fBinary:1;
    DWORD fParity:1;
    DWORD fOutxCtsFlow:1;
    DWORD fOutxDsrFlow:1;
    DWORD fDtrControl:2;
    DWORD fDsrSensitivity:1;
    DWORD fTXContinueOnXoff:1;
    DWORD fOutX:1;
    DWORD fInX:1;
    DWORD fErrorChar:1;
    DWORD fNull:1;
    DWORD fRtsControl:2;
    DWORD fAbortOnError:1;
    DWORD fDummy2:17;
    WORD wReserved;
    WORD XonLim;
    WORD XoffLim;
    BYTE ByteSize;
    BYTE Parity;
    BYTE StopBits;
    char XonChar;
    char XoffChar;
    char ErrorChar;
    char EofChar;
    char EvtChar;
    WORD wReserved1;
};

typedef struct _WIN32_FIND_DATAA _WIN32_FIND_DATAA, *P_WIN32_FIND_DATAA;

struct _WIN32_FIND_DATAA {
    DWORD dwFileAttributes;
    FILETIME ftCreationTime;
    FILETIME ftLastAccessTime;
    FILETIME ftLastWriteTime;
    DWORD nFileSizeHigh;
    DWORD nFileSizeLow;
    DWORD dwReserved0;
    DWORD dwReserved1;
    CHAR cFileName[260];
    CHAR cAlternateFileName[14];
};

typedef struct _LOAD_DLL_DEBUG_INFO _LOAD_DLL_DEBUG_INFO, *P_LOAD_DLL_DEBUG_INFO;

struct _LOAD_DLL_DEBUG_INFO {
    HANDLE hFile;
    LPVOID lpBaseOfDll;
    DWORD dwDebugInfoFileOffset;
    DWORD nDebugInfoSize;
    LPVOID lpImageName;
    WORD fUnicode;
};

typedef union _RTL_RUN_ONCE _RTL_RUN_ONCE, *P_RTL_RUN_ONCE;

typedef union _RTL_RUN_ONCE * PRTL_RUN_ONCE;

typedef PRTL_RUN_ONCE LPINIT_ONCE;

union _RTL_RUN_ONCE {
    PVOID Ptr;
};

typedef void (* PFIBER_START_ROUTINE)(LPVOID);

typedef struct _SECURITY_ATTRIBUTES * LPSECURITY_ATTRIBUTES;

typedef enum _DEP_SYSTEM_POLICY_TYPE {
    DEPPolicyAlwaysOff=0,
    DEPPolicyAlwaysOn=1,
    DEPPolicyOptIn=2,
    DEPPolicyOptOut=3,
    DEPTotalPolicyCount=4
} _DEP_SYSTEM_POLICY_TYPE;

typedef enum _DEP_SYSTEM_POLICY_TYPE DEP_SYSTEM_POLICY_TYPE;

typedef struct _COMMTIMEOUTS _COMMTIMEOUTS, *P_COMMTIMEOUTS;

struct _COMMTIMEOUTS {
    DWORD ReadIntervalTimeout;
    DWORD ReadTotalTimeoutMultiplier;
    DWORD ReadTotalTimeoutConstant;
    DWORD WriteTotalTimeoutMultiplier;
    DWORD WriteTotalTimeoutConstant;
};

typedef struct _STARTUPINFOA _STARTUPINFOA, *P_STARTUPINFOA;

typedef BYTE * LPBYTE;

struct _STARTUPINFOA {
    DWORD cb;
    LPSTR lpReserved;
    LPSTR lpDesktop;
    LPSTR lpTitle;
    DWORD dwX;
    DWORD dwY;
    DWORD dwXSize;
    DWORD dwYSize;
    DWORD dwXCountChars;
    DWORD dwYCountChars;
    DWORD dwFillAttribute;
    DWORD dwFlags;
    WORD wShowWindow;
    WORD cbReserved2;
    LPBYTE lpReserved2;
    HANDLE hStdInput;
    HANDLE hStdOutput;
    HANDLE hStdError;
};

typedef struct _DEBUG_EVENT _DEBUG_EVENT, *P_DEBUG_EVENT;

typedef struct _DEBUG_EVENT * LPDEBUG_EVENT;

typedef union _union_565 _union_565, *P_union_565;

typedef struct _EXCEPTION_DEBUG_INFO EXCEPTION_DEBUG_INFO;

typedef struct _CREATE_THREAD_DEBUG_INFO CREATE_THREAD_DEBUG_INFO;

typedef struct _CREATE_PROCESS_DEBUG_INFO _CREATE_PROCESS_DEBUG_INFO, *P_CREATE_PROCESS_DEBUG_INFO;

typedef struct _CREATE_PROCESS_DEBUG_INFO CREATE_PROCESS_DEBUG_INFO;

typedef struct _EXIT_THREAD_DEBUG_INFO _EXIT_THREAD_DEBUG_INFO, *P_EXIT_THREAD_DEBUG_INFO;

typedef struct _EXIT_THREAD_DEBUG_INFO EXIT_THREAD_DEBUG_INFO;

typedef struct _EXIT_PROCESS_DEBUG_INFO _EXIT_PROCESS_DEBUG_INFO, *P_EXIT_PROCESS_DEBUG_INFO;

typedef struct _EXIT_PROCESS_DEBUG_INFO EXIT_PROCESS_DEBUG_INFO;

typedef struct _LOAD_DLL_DEBUG_INFO LOAD_DLL_DEBUG_INFO;

typedef struct _UNLOAD_DLL_DEBUG_INFO _UNLOAD_DLL_DEBUG_INFO, *P_UNLOAD_DLL_DEBUG_INFO;

typedef struct _UNLOAD_DLL_DEBUG_INFO UNLOAD_DLL_DEBUG_INFO;

typedef struct _RIP_INFO _RIP_INFO, *P_RIP_INFO;

typedef struct _RIP_INFO RIP_INFO;

struct _EXIT_PROCESS_DEBUG_INFO {
    DWORD dwExitCode;
};

struct _EXIT_THREAD_DEBUG_INFO {
    DWORD dwExitCode;
};

struct _UNLOAD_DLL_DEBUG_INFO {
    LPVOID lpBaseOfDll;
};

struct _RIP_INFO {
    DWORD dwError;
    DWORD dwType;
};

struct _CREATE_PROCESS_DEBUG_INFO {
    HANDLE hFile;
    HANDLE hProcess;
    HANDLE hThread;
    LPVOID lpBaseOfImage;
    DWORD dwDebugInfoFileOffset;
    DWORD nDebugInfoSize;
    LPVOID lpThreadLocalBase;
    LPTHREAD_START_ROUTINE lpStartAddress;
    LPVOID lpImageName;
    WORD fUnicode;
};

union _union_565 {
    EXCEPTION_DEBUG_INFO Exception;
    CREATE_THREAD_DEBUG_INFO CreateThread;
    CREATE_PROCESS_DEBUG_INFO CreateProcessInfo;
    EXIT_THREAD_DEBUG_INFO ExitThread;
    EXIT_PROCESS_DEBUG_INFO ExitProcess;
    LOAD_DLL_DEBUG_INFO LoadDll;
    UNLOAD_DLL_DEBUG_INFO UnloadDll;
    OUTPUT_DEBUG_STRING_INFO DebugString;
    RIP_INFO RipInfo;
};

struct _DEBUG_EVENT {
    DWORD dwDebugEventCode;
    DWORD dwProcessId;
    DWORD dwThreadId;
    union _union_565 u;
};

typedef BOOL (* ENUMRESNAMEPROCA)(HMODULE, LPCSTR, LPSTR, LONG_PTR);

typedef enum _STREAM_INFO_LEVELS {
    FindStreamInfoStandard=0,
    FindStreamInfoMaxInfoLevel=1
} _STREAM_INFO_LEVELS;

typedef struct _TIME_ZONE_INFORMATION _TIME_ZONE_INFORMATION, *P_TIME_ZONE_INFORMATION;

struct _TIME_ZONE_INFORMATION {
    LONG Bias;
    WCHAR StandardName[32];
    SYSTEMTIME StandardDate;
    LONG StandardBias;
    WCHAR DaylightName[32];
    SYSTEMTIME DaylightDate;
    LONG DaylightBias;
};

typedef enum _FINDEX_INFO_LEVELS {
    FindExInfoStandard=0,
    FindExInfoBasic=1,
    FindExInfoMaxInfoLevel=2
} _FINDEX_INFO_LEVELS;

typedef enum _FINDEX_INFO_LEVELS FINDEX_INFO_LEVELS;

typedef void * PUMS_COMPLETION_LIST;

typedef struct _REASON_CONTEXT _REASON_CONTEXT, *P_REASON_CONTEXT;

typedef struct _REASON_CONTEXT * PREASON_CONTEXT;

typedef union _union_578 _union_578, *P_union_578;

typedef struct _struct_579 _struct_579, *P_struct_579;

struct _struct_579 {
    HMODULE LocalizedReasonModule;
    ULONG LocalizedReasonId;
    ULONG ReasonStringCount;
    LPWSTR * ReasonStrings;
};

union _union_578 {
    struct _struct_579 Detailed;
    LPWSTR SimpleReasonString;
};

struct _REASON_CONTEXT {
    ULONG Version;
    DWORD Flags;
    union _union_578 Reason;
};

typedef struct _MEMORYSTATUS _MEMORYSTATUS, *P_MEMORYSTATUS;

typedef struct _MEMORYSTATUS * LPMEMORYSTATUS;

typedef ULONG_PTR SIZE_T;

struct _MEMORYSTATUS {
    DWORD dwLength;
    DWORD dwMemoryLoad;
    SIZE_T dwTotalPhys;
    SIZE_T dwAvailPhys;
    SIZE_T dwTotalPageFile;
    SIZE_T dwAvailPageFile;
    SIZE_T dwTotalVirtual;
    SIZE_T dwAvailVirtual;
};

typedef struct _PROC_THREAD_ATTRIBUTE_LIST _PROC_THREAD_ATTRIBUTE_LIST, *P_PROC_THREAD_ATTRIBUTE_LIST;

struct _PROC_THREAD_ATTRIBUTE_LIST {
};

typedef struct tagACTCTXW tagACTCTXW, *PtagACTCTXW;

typedef struct tagACTCTXW ACTCTXW;

typedef WCHAR * LPCWSTR;

struct tagACTCTXW {
    ULONG cbSize;
    DWORD dwFlags;
    LPCWSTR lpSource;
    USHORT wProcessorArchitecture;
    LANGID wLangId;
    LPCWSTR lpAssemblyDirectory;
    LPCWSTR lpResourceName;
    LPCWSTR lpApplicationName;
    HMODULE hModule;
};

typedef struct _SYSTEM_INFO _SYSTEM_INFO, *P_SYSTEM_INFO;

typedef union _union_552 _union_552, *P_union_552;

typedef ULONG_PTR DWORD_PTR;

union _union_552 {
    DWORD dwOemId;
    struct _struct_553 s;
};

struct _SYSTEM_INFO {
    union _union_552 u;
    DWORD dwPageSize;
    LPVOID lpMinimumApplicationAddress;
    LPVOID lpMaximumApplicationAddress;
    DWORD_PTR dwActiveProcessorMask;
    DWORD dwNumberOfProcessors;
    DWORD dwProcessorType;
    DWORD dwAllocationGranularity;
    WORD wProcessorLevel;
    WORD wProcessorRevision;
};

typedef struct _PROC_THREAD_ATTRIBUTE_LIST * LPPROC_THREAD_ATTRIBUTE_LIST;

typedef enum _RTL_UMS_SCHEDULER_REASON {
    UmsSchedulerStartup=0,
    UmsSchedulerThreadBlocked=1,
    UmsSchedulerThreadYield=2
} _RTL_UMS_SCHEDULER_REASON;

typedef enum _RTL_UMS_SCHEDULER_REASON RTL_UMS_SCHEDULER_REASON;

typedef void (RTL_UMS_SCHEDULER_ENTRY_POINT)(RTL_UMS_SCHEDULER_REASON, ULONG_PTR, PVOID);

typedef RTL_UMS_SCHEDULER_ENTRY_POINT * PRTL_UMS_SCHEDULER_ENTRY_POINT;

typedef PRTL_UMS_SCHEDULER_ENTRY_POINT PUMS_SCHEDULER_ENTRY_POINT;

typedef enum _FILE_INFO_BY_HANDLE_CLASS {
    FileBasicInfo=0,
    FileStandardInfo=1,
    FileNameInfo=2,
    FileRenameInfo=3,
    FileDispositionInfo=4,
    FileAllocationInfo=5,
    FileEndOfFileInfo=6,
    FileStreamInfo=7,
    FileCompressionInfo=8,
    FileAttributeTagInfo=9,
    FileIdBothDirectoryInfo=10,
    FileIdBothDirectoryRestartInfo=11,
    FileIoPriorityHintInfo=12,
    FileRemoteProtocolInfo=13,
    MaximumFileInfoByHandleClass=14
} _FILE_INFO_BY_HANDLE_CLASS;

typedef BOOL (* ENUMRESNAMEPROCW)(HMODULE, LPCWSTR, LPWSTR, LONG_PTR);

typedef enum _FINDEX_SEARCH_OPS {
    FindExSearchNameMatch=0,
    FindExSearchLimitToDirectories=1,
    FindExSearchLimitToDevices=2,
    FindExSearchMaxSearchOp=3
} _FINDEX_SEARCH_OPS;

typedef struct _UMS_SCHEDULER_STARTUP_INFO _UMS_SCHEDULER_STARTUP_INFO, *P_UMS_SCHEDULER_STARTUP_INFO;

struct _UMS_SCHEDULER_STARTUP_INFO {
    ULONG UmsVersion;
    PUMS_COMPLETION_LIST CompletionList;
    PUMS_SCHEDULER_ENTRY_POINT SchedulerProc;
    PVOID SchedulerParam;
};

typedef struct tagACTCTX_SECTION_KEYED_DATA tagACTCTX_SECTION_KEYED_DATA, *PtagACTCTX_SECTION_KEYED_DATA;

typedef struct tagACTCTX_SECTION_KEYED_DATA * PACTCTX_SECTION_KEYED_DATA;

typedef struct tagACTCTX_SECTION_KEYED_DATA_ASSEMBLY_METADATA tagACTCTX_SECTION_KEYED_DATA_ASSEMBLY_METADATA, *PtagACTCTX_SECTION_KEYED_DATA_ASSEMBLY_METADATA;

typedef struct tagACTCTX_SECTION_KEYED_DATA_ASSEMBLY_METADATA ACTCTX_SECTION_KEYED_DATA_ASSEMBLY_METADATA;

struct tagACTCTX_SECTION_KEYED_DATA_ASSEMBLY_METADATA {
    PVOID lpInformation;
    PVOID lpSectionBase;
    ULONG ulSectionLength;
    PVOID lpSectionGlobalDataBase;
    ULONG ulSectionGlobalDataLength;
};

struct tagACTCTX_SECTION_KEYED_DATA {
    ULONG cbSize;
    ULONG ulDataFormatVersion;
    PVOID lpData;
    ULONG ulLength;
    PVOID lpSectionGlobalData;
    ULONG ulSectionGlobalDataLength;
    PVOID lpSectionBase;
    ULONG ulSectionTotalLength;
    HANDLE hActCtx;
    ULONG ulAssemblyRosterIndex;
    ULONG ulFlags;
    ACTCTX_SECTION_KEYED_DATA_ASSEMBLY_METADATA AssemblyMetadata;
};

typedef BOOL (* ENUMRESTYPEPROCA)(HMODULE, LPSTR, LONG_PTR);

typedef struct _MEMORYSTATUSEX _MEMORYSTATUSEX, *P_MEMORYSTATUSEX;

typedef ulonglong ULONGLONG;

typedef ULONGLONG DWORDLONG;

struct _MEMORYSTATUSEX {
    DWORD dwLength;
    DWORD dwMemoryLoad;
    DWORDLONG ullTotalPhys;
    DWORDLONG ullAvailPhys;
    DWORDLONG ullTotalPageFile;
    DWORDLONG ullAvailPageFile;
    DWORDLONG ullTotalVirtual;
    DWORDLONG ullAvailVirtual;
    DWORDLONG ullAvailExtendedVirtual;
};

typedef struct _SYSTEM_INFO * LPSYSTEM_INFO;

typedef struct _TIME_ZONE_INFORMATION TIME_ZONE_INFORMATION;

typedef enum enum_592 {
    PipeAttribute=0,
    PipeConnectionAttribute=1,
    PipeHandleAttribute=2
} enum_592;

typedef enum enum_592 PIPE_ATTRIBUTE_TYPE;

typedef BOOL (* ENUMRESTYPEPROCW)(HMODULE, LPWSTR, LONG_PTR);

typedef struct _STARTUPINFOW _STARTUPINFOW, *P_STARTUPINFOW;

typedef struct _STARTUPINFOW * LPSTARTUPINFOW;

struct _STARTUPINFOW {
    DWORD cb;
    LPWSTR lpReserved;
    LPWSTR lpDesktop;
    LPWSTR lpTitle;
    DWORD dwX;
    DWORD dwY;
    DWORD dwXSize;
    DWORD dwYSize;
    DWORD dwXCountChars;
    DWORD dwYCountChars;
    DWORD dwFillAttribute;
    DWORD dwFlags;
    WORD wShowWindow;
    WORD cbReserved2;
    LPBYTE lpReserved2;
    HANDLE hStdInput;
    HANDLE hStdOutput;
    HANDLE hStdError;
};

typedef struct _SYSTEM_POWER_STATUS * LPSYSTEM_POWER_STATUS;

typedef PRTL_RUN_ONCE PINIT_ONCE;

typedef BOOL (* PINIT_ONCE_FN)(PINIT_ONCE, PVOID, PVOID *);

typedef struct _TIME_DYNAMIC_ZONE_INFORMATION DYNAMIC_TIME_ZONE_INFORMATION;

typedef enum _COMPUTER_NAME_FORMAT {
    ComputerNameNetBIOS=0,
    ComputerNameDnsHostname=1,
    ComputerNameDnsDomain=2,
    ComputerNameDnsFullyQualified=3,
    ComputerNamePhysicalNetBIOS=4,
    ComputerNamePhysicalDnsHostname=5,
    ComputerNamePhysicalDnsDomain=6,
    ComputerNamePhysicalDnsFullyQualified=7,
    ComputerNameMax=8
} _COMPUTER_NAME_FORMAT;

typedef struct _OVERLAPPED * LPOVERLAPPED;

typedef enum _MEMORY_RESOURCE_NOTIFICATION_TYPE {
    LowMemoryResourceNotification=0,
    HighMemoryResourceNotification=1
} _MEMORY_RESOURCE_NOTIFICATION_TYPE;

typedef struct _STARTUPINFOA * LPSTARTUPINFOA;

typedef struct _RTL_CONDITION_VARIABLE _RTL_CONDITION_VARIABLE, *P_RTL_CONDITION_VARIABLE;

typedef struct _RTL_CONDITION_VARIABLE RTL_CONDITION_VARIABLE;

typedef RTL_CONDITION_VARIABLE * PCONDITION_VARIABLE;

struct _RTL_CONDITION_VARIABLE {
    PVOID Ptr;
};

typedef struct _RTL_SRWLOCK _RTL_SRWLOCK, *P_RTL_SRWLOCK;

typedef struct _RTL_SRWLOCK RTL_SRWLOCK;

typedef RTL_SRWLOCK * PSRWLOCK;

struct _RTL_SRWLOCK {
    PVOID Ptr;
};

typedef void * PUMS_CONTEXT;

typedef BOOL (* ENUMRESLANGPROCW)(HMODULE, LPCWSTR, LPCWSTR, WORD, LONG_PTR);

typedef void (* LPOVERLAPPED_COMPLETION_ROUTINE)(DWORD, DWORD, LPOVERLAPPED);

typedef void (* PTIMERAPCROUTINE)(LPVOID, DWORD, DWORD);

typedef struct _SYSTEMTIME * LPSYSTEMTIME;

typedef struct _RTL_CRITICAL_SECTION _RTL_CRITICAL_SECTION, *P_RTL_CRITICAL_SECTION;

typedef struct _RTL_CRITICAL_SECTION * PRTL_CRITICAL_SECTION;

typedef PRTL_CRITICAL_SECTION PCRITICAL_SECTION;

typedef struct _RTL_CRITICAL_SECTION_DEBUG _RTL_CRITICAL_SECTION_DEBUG, *P_RTL_CRITICAL_SECTION_DEBUG;

typedef struct _RTL_CRITICAL_SECTION_DEBUG * PRTL_CRITICAL_SECTION_DEBUG;

typedef struct _LIST_ENTRY _LIST_ENTRY, *P_LIST_ENTRY;

typedef struct _LIST_ENTRY LIST_ENTRY;

struct _RTL_CRITICAL_SECTION {
    PRTL_CRITICAL_SECTION_DEBUG DebugInfo;
    LONG LockCount;
    LONG RecursionCount;
    HANDLE OwningThread;
    HANDLE LockSemaphore;
    ULONG_PTR SpinCount;
};

struct _LIST_ENTRY {
    struct _LIST_ENTRY * Flink;
    struct _LIST_ENTRY * Blink;
};

struct _RTL_CRITICAL_SECTION_DEBUG {
    WORD Type;
    WORD CreatorBackTraceIndex;
    struct _RTL_CRITICAL_SECTION * CriticalSection;
    LIST_ENTRY ProcessLocksList;
    DWORD EntryCount;
    DWORD ContentionCount;
    DWORD Flags;
    WORD CreatorBackTraceIndexHigh;
    WORD SpareWORD;
};

typedef struct _COMMCONFIG _COMMCONFIG, *P_COMMCONFIG;

typedef struct _COMMCONFIG * LPCOMMCONFIG;

typedef struct _DCB DCB;

struct _COMMCONFIG {
    DWORD dwSize;
    WORD wVersion;
    WORD wReserved;
    DCB dcb;
    DWORD dwProviderSubType;
    DWORD dwProviderOffset;
    DWORD dwProviderSize;
    WCHAR wcProviderData[1];
};

typedef enum _STREAM_INFO_LEVELS STREAM_INFO_LEVELS;

typedef DWORD (* LPPROGRESS_ROUTINE)(LARGE_INTEGER, LARGE_INTEGER, LARGE_INTEGER, LARGE_INTEGER, DWORD, DWORD, HANDLE, HANDLE, LPVOID);

typedef BOOL (* ENUMRESLANGPROCA)(HMODULE, LPCSTR, LPCSTR, WORD, LONG_PTR);

typedef struct _OFSTRUCT _OFSTRUCT, *P_OFSTRUCT;

struct _OFSTRUCT {
    BYTE cBytes;
    BYTE fFixedDisk;
    WORD nErrCode;
    WORD Reserved1;
    WORD Reserved2;
    CHAR szPathName[128];
};

typedef ACTCTXW * PCACTCTXW;

typedef struct _OVERLAPPED_ENTRY _OVERLAPPED_ENTRY, *P_OVERLAPPED_ENTRY;

struct _OVERLAPPED_ENTRY {
    ULONG_PTR lpCompletionKey;
    LPOVERLAPPED lpOverlapped;
    ULONG_PTR Internal;
    DWORD dwNumberOfBytesTransferred;
};

typedef struct _BY_HANDLE_FILE_INFORMATION _BY_HANDLE_FILE_INFORMATION, *P_BY_HANDLE_FILE_INFORMATION;

struct _BY_HANDLE_FILE_INFORMATION {
    DWORD dwFileAttributes;
    FILETIME ftCreationTime;
    FILETIME ftLastAccessTime;
    FILETIME ftLastWriteTime;
    DWORD dwVolumeSerialNumber;
    DWORD nFileSizeHigh;
    DWORD nFileSizeLow;
    DWORD nNumberOfLinks;
    DWORD nFileIndexHigh;
    DWORD nFileIndexLow;
};

typedef struct _UMS_SCHEDULER_STARTUP_INFO * PUMS_SCHEDULER_STARTUP_INFO;

typedef DWORD (* APPLICATION_RECOVERY_CALLBACK)(PVOID);

typedef enum _GET_FILEEX_INFO_LEVELS {
    GetFileExInfoStandard=0,
    GetFileExMaxInfoLevel=1
} _GET_FILEEX_INFO_LEVELS;

typedef struct _COMMTIMEOUTS * LPCOMMTIMEOUTS;

typedef enum _GET_FILEEX_INFO_LEVELS GET_FILEEX_INFO_LEVELS;

typedef struct _PROCESS_INFORMATION _PROCESS_INFORMATION, *P_PROCESS_INFORMATION;

typedef struct _PROCESS_INFORMATION * LPPROCESS_INFORMATION;

struct _PROCESS_INFORMATION {
    HANDLE hProcess;
    HANDLE hThread;
    DWORD dwProcessId;
    DWORD dwThreadId;
};

typedef LPVOID LPLDT_ENTRY;

typedef struct _CONTEXT _CONTEXT, *P_CONTEXT;

typedef struct _CONTEXT * PCONTEXT;

typedef PCONTEXT LPCONTEXT;

typedef ulonglong DWORD64;

typedef union _union_54 _union_54, *P_union_54;

typedef struct _M128A _M128A, *P_M128A;

typedef struct _M128A M128A;

typedef struct _XSAVE_FORMAT _XSAVE_FORMAT, *P_XSAVE_FORMAT;

typedef struct _XSAVE_FORMAT XSAVE_FORMAT;

typedef XSAVE_FORMAT XMM_SAVE_AREA32;

typedef struct _struct_55 _struct_55, *P_struct_55;

struct _M128A {
    ULONGLONG Low;
    LONGLONG High;
};

struct _XSAVE_FORMAT {
    WORD ControlWord;
    WORD StatusWord;
    BYTE TagWord;
    BYTE Reserved1;
    WORD ErrorOpcode;
    DWORD ErrorOffset;
    WORD ErrorSelector;
    WORD Reserved2;
    DWORD DataOffset;
    WORD DataSelector;
    WORD Reserved3;
    DWORD MxCsr;
    DWORD MxCsr_Mask;
    M128A FloatRegisters[8];
    M128A XmmRegisters[16];
    BYTE Reserved4[96];
};

struct _struct_55 {
    M128A Header[2];
    M128A Legacy[8];
    M128A Xmm0;
    M128A Xmm1;
    M128A Xmm2;
    M128A Xmm3;
    M128A Xmm4;
    M128A Xmm5;
    M128A Xmm6;
    M128A Xmm7;
    M128A Xmm8;
    M128A Xmm9;
    M128A Xmm10;
    M128A Xmm11;
    M128A Xmm12;
    M128A Xmm13;
    M128A Xmm14;
    M128A Xmm15;
};

union _union_54 {
    XMM_SAVE_AREA32 FltSave;
    struct _struct_55 s;
};

struct _CONTEXT {
    DWORD64 P1Home;
    DWORD64 P2Home;
    DWORD64 P3Home;
    DWORD64 P4Home;
    DWORD64 P5Home;
    DWORD64 P6Home;
    DWORD ContextFlags;
    DWORD MxCsr;
    WORD SegCs;
    WORD SegDs;
    WORD SegEs;
    WORD SegFs;
    WORD SegGs;
    WORD SegSs;
    DWORD EFlags;
    DWORD64 Dr0;
    DWORD64 Dr1;
    DWORD64 Dr2;
    DWORD64 Dr3;
    DWORD64 Dr6;
    DWORD64 Dr7;
    DWORD64 Rax;
    DWORD64 Rcx;
    DWORD64 Rdx;
    DWORD64 Rbx;
    DWORD64 Rsp;
    DWORD64 Rbp;
    DWORD64 Rsi;
    DWORD64 Rdi;
    DWORD64 R8;
    DWORD64 R9;
    DWORD64 R10;
    DWORD64 R11;
    DWORD64 R12;
    DWORD64 R13;
    DWORD64 R14;
    DWORD64 R15;
    DWORD64 Rip;
    union _union_54 u;
    M128A VectorRegister[26];
    DWORD64 VectorControl;
    DWORD64 DebugControl;
    DWORD64 LastBranchToRip;
    DWORD64 LastBranchFromRip;
    DWORD64 LastExceptionToRip;
    DWORD64 LastExceptionFromRip;
};

typedef struct _EXCEPTION_POINTERS _EXCEPTION_POINTERS, *P_EXCEPTION_POINTERS;

typedef LONG (* PTOP_LEVEL_EXCEPTION_FILTER)(struct _EXCEPTION_POINTERS *);

typedef PTOP_LEVEL_EXCEPTION_FILTER LPTOP_LEVEL_EXCEPTION_FILTER;

typedef EXCEPTION_RECORD * PEXCEPTION_RECORD;

struct _EXCEPTION_POINTERS {
    PEXCEPTION_RECORD ExceptionRecord;
    PCONTEXT ContextRecord;
};

typedef struct _TIME_ZONE_INFORMATION * LPTIME_ZONE_INFORMATION;

typedef struct _DCB * LPDCB;

typedef PFIBER_START_ROUTINE LPFIBER_START_ROUTINE;

typedef enum _FILE_INFO_BY_HANDLE_CLASS FILE_INFO_BY_HANDLE_CLASS;

typedef struct _OVERLAPPED_ENTRY * LPOVERLAPPED_ENTRY;

typedef void (* WAITORTIMERCALLBACKFUNC)(PVOID, BOOLEAN);

typedef WAITORTIMERCALLBACKFUNC WAITORTIMERCALLBACK;

typedef struct _MEMORYSTATUSEX * LPMEMORYSTATUSEX;

typedef enum _FINDEX_SEARCH_OPS FINDEX_SEARCH_OPS;

typedef ACTCTXA * PCACTCTXA;

typedef struct _WIN32_FIND_DATAA * LPWIN32_FIND_DATAA;

typedef enum _MEMORY_RESOURCE_NOTIFICATION_TYPE MEMORY_RESOURCE_NOTIFICATION_TYPE;

typedef struct _BY_HANDLE_FILE_INFORMATION * LPBY_HANDLE_FILE_INFORMATION;

typedef PRTL_CRITICAL_SECTION LPCRITICAL_SECTION;

typedef struct _OFSTRUCT * LPOFSTRUCT;

typedef enum _COMPUTER_NAME_FORMAT COMPUTER_NAME_FORMAT;

typedef struct IRpcChannelBufferVtbl IRpcChannelBufferVtbl, *PIRpcChannelBufferVtbl;

typedef long HRESULT;

typedef struct IRpcChannelBuffer IRpcChannelBuffer, *PIRpcChannelBuffer;

typedef GUID IID;


// WARNING! conflicting data type names: /wtypes.h/ULONG - /WinDef.h/ULONG

typedef struct tagRPCOLEMESSAGE tagRPCOLEMESSAGE, *PtagRPCOLEMESSAGE;

typedef struct tagRPCOLEMESSAGE RPCOLEMESSAGE;

typedef ulong RPCOLEDATAREP;

struct tagRPCOLEMESSAGE {
    void * reserved1;
    RPCOLEDATAREP dataRepresentation;
    void * Buffer;
    ULONG cbBuffer;
    ULONG iMethod;
    void * reserved2[5];
    ULONG rpcFlags;
};

struct IRpcChannelBufferVtbl {
    HRESULT (* QueryInterface)(struct IRpcChannelBuffer *, IID *, void * *);
    ULONG (* AddRef)(struct IRpcChannelBuffer *);
    ULONG (* Release)(struct IRpcChannelBuffer *);
    HRESULT (* GetBuffer)(struct IRpcChannelBuffer *, RPCOLEMESSAGE *, IID *);
    HRESULT (* SendReceive)(struct IRpcChannelBuffer *, RPCOLEMESSAGE *, ULONG *);
    HRESULT (* FreeBuffer)(struct IRpcChannelBuffer *, RPCOLEMESSAGE *);
    HRESULT (* GetDestCtx)(struct IRpcChannelBuffer *, DWORD *, void * *);
    HRESULT (* IsConnected)(struct IRpcChannelBuffer *);
};

struct IRpcChannelBuffer {
    struct IRpcChannelBufferVtbl * lpVtbl;
};

typedef struct _DISPATCHER_CONTEXT _DISPATCHER_CONTEXT, *P_DISPATCHER_CONTEXT;

struct _DISPATCHER_CONTEXT {
};

typedef enum _EXCEPTION_DISPOSITION {
    ExceptionContinueExecution=0,
    ExceptionContinueSearch=1,
    ExceptionNestedException=2,
    ExceptionCollidedUnwind=3
} _EXCEPTION_DISPOSITION;

typedef enum _EXCEPTION_DISPOSITION EXCEPTION_DISPOSITION;

typedef struct DotNetPdbInfo DotNetPdbInfo, *PDotNetPdbInfo;

struct DotNetPdbInfo {
    char signature[4];
    GUID guid;
    dword age;
    char pdbname[12];
};

typedef BYTE UCHAR;

typedef struct _COORD _COORD, *P_COORD;

typedef struct _COORD COORD;

typedef short SHORT;

struct _COORD {
    SHORT X;
    SHORT Y;
};

typedef struct _SMALL_RECT _SMALL_RECT, *P_SMALL_RECT;

struct _SMALL_RECT {
    SHORT Left;
    SHORT Top;
    SHORT Right;
    SHORT Bottom;
};

typedef struct _CONSOLE_FONT_INFOEX _CONSOLE_FONT_INFOEX, *P_CONSOLE_FONT_INFOEX;

struct _CONSOLE_FONT_INFOEX {
    ULONG cbSize;
    DWORD nFont;
    COORD dwFontSize;
    UINT FontFamily;
    UINT FontWeight;
    WCHAR FaceName[32];
};

typedef struct _CONSOLE_SCREEN_BUFFER_INFOEX _CONSOLE_SCREEN_BUFFER_INFOEX, *P_CONSOLE_SCREEN_BUFFER_INFOEX;

typedef struct _CONSOLE_SCREEN_BUFFER_INFOEX * PCONSOLE_SCREEN_BUFFER_INFOEX;

typedef struct _SMALL_RECT SMALL_RECT;

typedef DWORD COLORREF;

struct _CONSOLE_SCREEN_BUFFER_INFOEX {
    ULONG cbSize;
    COORD dwSize;
    COORD dwCursorPosition;
    WORD wAttributes;
    SMALL_RECT srWindow;
    COORD dwMaximumWindowSize;
    WORD wPopupAttributes;
    BOOL bFullscreenSupported;
    COLORREF ColorTable[16];
};

typedef struct _CONSOLE_SELECTION_INFO _CONSOLE_SELECTION_INFO, *P_CONSOLE_SELECTION_INFO;

typedef struct _CONSOLE_SELECTION_INFO * PCONSOLE_SELECTION_INFO;

struct _CONSOLE_SELECTION_INFO {
    DWORD dwFlags;
    COORD dwSelectionAnchor;
    SMALL_RECT srSelection;
};

typedef struct _CHAR_INFO _CHAR_INFO, *P_CHAR_INFO;

typedef struct _CHAR_INFO CHAR_INFO;

typedef union _union_985 _union_985, *P_union_985;

union _union_985 {
    WCHAR UnicodeChar;
    CHAR AsciiChar;
};

struct _CHAR_INFO {
    union _union_985 Char;
    WORD Attributes;
};

typedef struct _CONSOLE_SCREEN_BUFFER_INFO _CONSOLE_SCREEN_BUFFER_INFO, *P_CONSOLE_SCREEN_BUFFER_INFO;

struct _CONSOLE_SCREEN_BUFFER_INFO {
    COORD dwSize;
    COORD dwCursorPosition;
    WORD wAttributes;
    SMALL_RECT srWindow;
    COORD dwMaximumWindowSize;
};

typedef struct _INPUT_RECORD _INPUT_RECORD, *P_INPUT_RECORD;

typedef struct _INPUT_RECORD INPUT_RECORD;

typedef union _union_983 _union_983, *P_union_983;

typedef struct _KEY_EVENT_RECORD _KEY_EVENT_RECORD, *P_KEY_EVENT_RECORD;

typedef struct _KEY_EVENT_RECORD KEY_EVENT_RECORD;

typedef struct _MOUSE_EVENT_RECORD _MOUSE_EVENT_RECORD, *P_MOUSE_EVENT_RECORD;

typedef struct _MOUSE_EVENT_RECORD MOUSE_EVENT_RECORD;

typedef struct _WINDOW_BUFFER_SIZE_RECORD _WINDOW_BUFFER_SIZE_RECORD, *P_WINDOW_BUFFER_SIZE_RECORD;

typedef struct _WINDOW_BUFFER_SIZE_RECORD WINDOW_BUFFER_SIZE_RECORD;

typedef struct _MENU_EVENT_RECORD _MENU_EVENT_RECORD, *P_MENU_EVENT_RECORD;

typedef struct _MENU_EVENT_RECORD MENU_EVENT_RECORD;

typedef struct _FOCUS_EVENT_RECORD _FOCUS_EVENT_RECORD, *P_FOCUS_EVENT_RECORD;

typedef struct _FOCUS_EVENT_RECORD FOCUS_EVENT_RECORD;

typedef union _union_977 _union_977, *P_union_977;

union _union_977 {
    WCHAR UnicodeChar;
    CHAR AsciiChar;
};

struct _WINDOW_BUFFER_SIZE_RECORD {
    COORD dwSize;
};

struct _FOCUS_EVENT_RECORD {
    BOOL bSetFocus;
};

struct _MENU_EVENT_RECORD {
    UINT dwCommandId;
};

struct _MOUSE_EVENT_RECORD {
    COORD dwMousePosition;
    DWORD dwButtonState;
    DWORD dwControlKeyState;
    DWORD dwEventFlags;
};

struct _KEY_EVENT_RECORD {
    BOOL bKeyDown;
    WORD wRepeatCount;
    WORD wVirtualKeyCode;
    WORD wVirtualScanCode;
    union _union_977 uChar;
    DWORD dwControlKeyState;
};

union _union_983 {
    KEY_EVENT_RECORD KeyEvent;
    MOUSE_EVENT_RECORD MouseEvent;
    WINDOW_BUFFER_SIZE_RECORD WindowBufferSizeEvent;
    MENU_EVENT_RECORD MenuEvent;
    FOCUS_EVENT_RECORD FocusEvent;
};

struct _INPUT_RECORD {
    WORD EventType;
    union _union_983 Event;
};

typedef struct _CONSOLE_HISTORY_INFO _CONSOLE_HISTORY_INFO, *P_CONSOLE_HISTORY_INFO;

struct _CONSOLE_HISTORY_INFO {
    UINT cbSize;
    UINT HistoryBufferSize;
    UINT NumberOfHistoryBuffers;
    DWORD dwFlags;
};

typedef struct _CONSOLE_CURSOR_INFO _CONSOLE_CURSOR_INFO, *P_CONSOLE_CURSOR_INFO;

typedef struct _CONSOLE_CURSOR_INFO * PCONSOLE_CURSOR_INFO;

struct _CONSOLE_CURSOR_INFO {
    DWORD dwSize;
    BOOL bVisible;
};

typedef struct _CONSOLE_FONT_INFOEX * PCONSOLE_FONT_INFOEX;

typedef struct _CONSOLE_CURSOR_INFO CONSOLE_CURSOR_INFO;

typedef struct _CONSOLE_READCONSOLE_CONTROL _CONSOLE_READCONSOLE_CONTROL, *P_CONSOLE_READCONSOLE_CONTROL;

typedef struct _CONSOLE_READCONSOLE_CONTROL * PCONSOLE_READCONSOLE_CONTROL;

struct _CONSOLE_READCONSOLE_CONTROL {
    ULONG nLength;
    ULONG nInitialChars;
    ULONG dwCtrlWakeupMask;
    ULONG dwControlKeyState;
};

typedef struct _CONSOLE_FONT_INFO _CONSOLE_FONT_INFO, *P_CONSOLE_FONT_INFO;

typedef struct _CONSOLE_FONT_INFO * PCONSOLE_FONT_INFO;

struct _CONSOLE_FONT_INFO {
    DWORD nFont;
    COORD dwFontSize;
};

typedef struct _CONSOLE_SCREEN_BUFFER_INFO * PCONSOLE_SCREEN_BUFFER_INFO;

typedef struct _CONSOLE_HISTORY_INFO * PCONSOLE_HISTORY_INFO;

typedef struct _CHAR_INFO * PCHAR_INFO;

typedef struct _COORD * PCOORD;

typedef struct _INPUT_RECORD * PINPUT_RECORD;

typedef struct _SMALL_RECT * PSMALL_RECT;

typedef BOOL (* PHANDLER_ROUTINE)(DWORD);

typedef char * va_list;

typedef ulonglong uintptr_t;

typedef struct _GENERIC_BINDING_ROUTINE_PAIR _GENERIC_BINDING_ROUTINE_PAIR, *P_GENERIC_BINDING_ROUTINE_PAIR;

typedef struct _GENERIC_BINDING_ROUTINE_PAIR GENERIC_BINDING_ROUTINE_PAIR;

typedef void * (* GENERIC_BINDING_ROUTINE)(void *);

typedef void (* GENERIC_UNBIND_ROUTINE)(void *, uchar *);

struct _GENERIC_BINDING_ROUTINE_PAIR {
    GENERIC_BINDING_ROUTINE pfnBind;
    GENERIC_UNBIND_ROUTINE pfnUnbind;
};

typedef struct _NDR_ASYNC_MESSAGE _NDR_ASYNC_MESSAGE, *P_NDR_ASYNC_MESSAGE;

struct _NDR_ASYNC_MESSAGE {
};

typedef struct _MIDL_STUB_MESSAGE _MIDL_STUB_MESSAGE, *P_MIDL_STUB_MESSAGE;

typedef ulonglong size_t;

typedef struct NDR_ALLOC_ALL_NODES_CONTEXT NDR_ALLOC_ALL_NODES_CONTEXT, *PNDR_ALLOC_ALL_NODES_CONTEXT;

typedef struct NDR_POINTER_QUEUE_STATE NDR_POINTER_QUEUE_STATE, *PNDR_POINTER_QUEUE_STATE;

typedef RPC_BINDING_HANDLE handle_t;

typedef struct _MIDL_STUB_DESC _MIDL_STUB_DESC, *P_MIDL_STUB_DESC;

typedef struct _FULL_PTR_XLAT_TABLES _FULL_PTR_XLAT_TABLES, *P_FULL_PTR_XLAT_TABLES;

typedef struct _struct_1622 _struct_1622, *P_struct_1622;

typedef struct _struct_1622 * NDR_SCONTEXT;

typedef struct ARRAY_INFO ARRAY_INFO, *PARRAY_INFO;

typedef struct _NDR_ASYNC_MESSAGE * PNDR_ASYNC_MESSAGE;

typedef struct _NDR_CORRELATION_INFO _NDR_CORRELATION_INFO, *P_NDR_CORRELATION_INFO;

typedef struct _NDR_CORRELATION_INFO * PNDR_CORRELATION_INFO;

typedef union _union_1653 _union_1653, *P_union_1653;

typedef void (* NDR_RUNDOWN)(void *);

typedef void (* EXPR_EVAL)(struct _MIDL_STUB_MESSAGE *);

typedef struct _XMIT_ROUTINE_QUINTUPLE _XMIT_ROUTINE_QUINTUPLE, *P_XMIT_ROUTINE_QUINTUPLE;

typedef struct _XMIT_ROUTINE_QUINTUPLE XMIT_ROUTINE_QUINTUPLE;

typedef struct _MALLOC_FREE_STRUCT _MALLOC_FREE_STRUCT, *P_MALLOC_FREE_STRUCT;

typedef struct _MALLOC_FREE_STRUCT MALLOC_FREE_STRUCT;

typedef struct _COMM_FAULT_OFFSETS _COMM_FAULT_OFFSETS, *P_COMM_FAULT_OFFSETS;

typedef struct _COMM_FAULT_OFFSETS COMM_FAULT_OFFSETS;

typedef struct _USER_MARSHAL_ROUTINE_QUADRUPLE _USER_MARSHAL_ROUTINE_QUADRUPLE, *P_USER_MARSHAL_ROUTINE_QUADRUPLE;

typedef struct _USER_MARSHAL_ROUTINE_QUADRUPLE USER_MARSHAL_ROUTINE_QUADRUPLE;

typedef void (* NDR_NOTIFY_ROUTINE)(void);

typedef struct _NDR_CS_ROUTINES _NDR_CS_ROUTINES, *P_NDR_CS_ROUTINES;

typedef struct _NDR_CS_ROUTINES NDR_CS_ROUTINES;

typedef struct _NDR_EXPR_DESC _NDR_EXPR_DESC, *P_NDR_EXPR_DESC;

typedef struct _NDR_EXPR_DESC NDR_EXPR_DESC;

typedef enum enum_1658 {
    XLAT_SERVER=1,
    XLAT_CLIENT=2
} enum_1658;

typedef enum enum_1658 XLAT_SIDE;

typedef struct __GENERIC_BINDING_INFO __GENERIC_BINDING_INFO, *P__GENERIC_BINDING_INFO;

typedef struct __GENERIC_BINDING_INFO * PGENERIC_BINDING_INFO;

typedef struct _MIDL_STUB_MESSAGE * PMIDL_STUB_MESSAGE;

typedef void (* XMIT_HELPER_ROUTINE)(PMIDL_STUB_MESSAGE);

typedef ulong (* USER_MARSHAL_SIZING_ROUTINE)(ulong *, ulong, void *);

typedef uchar * (* USER_MARSHAL_MARSHALLING_ROUTINE)(ulong *, uchar *, void *);

typedef uchar * (* USER_MARSHAL_UNMARSHALLING_ROUTINE)(ulong *, uchar *, void *);

typedef void (* USER_MARSHAL_FREEING_ROUTINE)(ulong *, void *);

typedef struct _NDR_CS_SIZE_CONVERT_ROUTINES _NDR_CS_SIZE_CONVERT_ROUTINES, *P_NDR_CS_SIZE_CONVERT_ROUTINES;

typedef struct _NDR_CS_SIZE_CONVERT_ROUTINES NDR_CS_SIZE_CONVERT_ROUTINES;

typedef ulong error_status_t;

typedef void (* CS_TAG_GETTING_ROUTINE)(RPC_BINDING_HANDLE, int, ulong *, ulong *, ulong *, error_status_t *);

typedef uchar * PFORMAT_STRING;

typedef enum _IDL_CS_CONVERT {
    IDL_CS_NO_CONVERT=0,
    IDL_CS_IN_PLACE_CONVERT=1,
    IDL_CS_NEW_BUFFER_CONVERT=2
} _IDL_CS_CONVERT;

typedef enum _IDL_CS_CONVERT IDL_CS_CONVERT;

typedef void (* CS_TYPE_NET_SIZE_ROUTINE)(RPC_BINDING_HANDLE, ulong, ulong, IDL_CS_CONVERT *, ulong *, error_status_t *);


// WARNING! conflicting data type names: /rpcndr.h/byte - /byte

typedef void (* CS_TYPE_TO_NETCS_ROUTINE)(RPC_BINDING_HANDLE, ulong, void *, ulong, byte *, ulong *, error_status_t *);

typedef void (* CS_TYPE_LOCAL_SIZE_ROUTINE)(RPC_BINDING_HANDLE, ulong, ulong, IDL_CS_CONVERT *, ulong *, error_status_t *);

typedef void (* CS_TYPE_FROM_NETCS_ROUTINE)(RPC_BINDING_HANDLE, ulong, byte *, ulong, ulong, void *, ulong *, error_status_t *);

struct _FULL_PTR_XLAT_TABLES {
    void * RefIdToPointer;
    void * PointerToRefId;
    ulong NextRefId;
    XLAT_SIDE XlatSide;
};

struct _NDR_EXPR_DESC {
    ushort * pOffset;
    PFORMAT_STRING pFormatExpr;
};

struct __GENERIC_BINDING_INFO {
    void * pObj;
    uint Size;
    GENERIC_BINDING_ROUTINE pfnBind;
    GENERIC_UNBIND_ROUTINE pfnUnbind;
};

struct _NDR_CS_ROUTINES {
    NDR_CS_SIZE_CONVERT_ROUTINES * pSizeConvertRoutines;
    CS_TAG_GETTING_ROUTINE * pTagGettingRoutines;
};

struct NDR_POINTER_QUEUE_STATE {
};

struct _struct_1622 {
    void * pad[2];
    void * userContext;
};

struct _MALLOC_FREE_STRUCT {
    void * (* pfnAllocate)(size_t);
    void (* pfnFree)(void *);
};

struct _MIDL_STUB_MESSAGE {
    PRPC_MESSAGE RpcMsg;
    uchar * Buffer;
    uchar * BufferStart;
    uchar * BufferEnd;
    uchar * BufferMark;
    ulong BufferLength;
    ulong MemorySize;
    uchar * Memory;
    uchar IsClient;
    uchar Pad;
    ushort uFlags2;
    int ReuseBuffer;
    struct NDR_ALLOC_ALL_NODES_CONTEXT * pAllocAllNodesContext;
    struct NDR_POINTER_QUEUE_STATE * pPointerQueueState;
    int IgnoreEmbeddedPointers;
    uchar * PointerBufferMark;
    uchar CorrDespIncrement;
    uchar uFlags;
    ushort UniquePtrCount;
    ULONG_PTR MaxCount;
    ulong Offset;
    ulong ActualCount;
    void * (* pfnAllocate)(size_t);
    void (* pfnFree)(void *);
    uchar * StackTop;
    uchar * pPresentedType;
    uchar * pTransmitType;
    handle_t SavedHandle;
    struct _MIDL_STUB_DESC * StubDesc;
    struct _FULL_PTR_XLAT_TABLES * FullPtrXlatTables;
    ulong FullPtrRefId;
    ulong PointerLength;
    int fInDontFree:1;
    int fDontCallFreeInst:1;
    int fInOnlyParam:1;
    int fHasReturn:1;
    int fHasExtensions:1;
    int fHasNewCorrDesc:1;
    int fIsIn:1;
    int fIsOut:1;
    int fIsOicf:1;
    int fBufferValid:1;
    int fHasMemoryValidateCallback:1;
    int fInFree:1;
    int fNeedMCCP:1;
    int fUnused:3;
    int fUnused2:16;
    ulong dwDestContext;
    void * pvDestContext;
    NDR_SCONTEXT * SavedContextHandles;
    long ParamNumber;
    struct IRpcChannelBuffer * pRpcChannelBuffer;
    PARRAY_INFO pArrayInfo;
    ulong * SizePtrCountArray;
    ulong * SizePtrOffsetArray;
    ulong * SizePtrLengthArray;
    void * pArgQueue;
    ulong dwStubPhase;
    void * LowStackMark;
    PNDR_ASYNC_MESSAGE pAsyncMsg;
    PNDR_CORRELATION_INFO pCorrInfo;
    uchar * pCorrMemory;
    void * pMemoryList;
};

struct _XMIT_ROUTINE_QUINTUPLE {
    XMIT_HELPER_ROUTINE pfnTranslateToXmit;
    XMIT_HELPER_ROUTINE pfnTranslateFromXmit;
    XMIT_HELPER_ROUTINE pfnFreeXmit;
    XMIT_HELPER_ROUTINE pfnFreeInst;
};

struct NDR_ALLOC_ALL_NODES_CONTEXT {
};

union _union_1653 {
    handle_t * pAutoHandle;
    handle_t * pPrimitiveHandle;
    PGENERIC_BINDING_INFO pGenericBindingInfo;
};

struct _MIDL_STUB_DESC {
    void * RpcInterfaceInformation;
    void * (* pfnAllocate)(size_t);
    void (* pfnFree)(void *);
    union _union_1653 IMPLICIT_HANDLE_INFO;
    NDR_RUNDOWN * apfnNdrRundownRoutines;
    GENERIC_BINDING_ROUTINE_PAIR * aGenericBindingRoutinePairs;
    EXPR_EVAL * apfnExprEval;
    XMIT_ROUTINE_QUINTUPLE * aXmitQuintuple;
    uchar * pFormatTypes;
    int fCheckBounds;
    ulong Version;
    MALLOC_FREE_STRUCT * pMallocFreeStruct;
    long MIDLVersion;
    COMM_FAULT_OFFSETS * CommFaultOffsets;
    USER_MARSHAL_ROUTINE_QUADRUPLE * aUserMarshalQuadruple;
    NDR_NOTIFY_ROUTINE * NotifyRoutineTable;
    ULONG_PTR mFlags;
    NDR_CS_ROUTINES * CsRoutineTables;
    void * ProxyServerInfo;
    NDR_EXPR_DESC * pExprInfo;
};

struct _NDR_CS_SIZE_CONVERT_ROUTINES {
    CS_TYPE_NET_SIZE_ROUTINE pfnNetSize;
    CS_TYPE_TO_NETCS_ROUTINE pfnToNetCs;
    CS_TYPE_LOCAL_SIZE_ROUTINE pfnLocalSize;
    CS_TYPE_FROM_NETCS_ROUTINE pfnFromNetCs;
};

struct ARRAY_INFO {
    long Dimension;
    ulong * BufferConformanceMark;
    ulong * BufferVarianceMark;
    ulong * MaxCountArray;
    ulong * OffsetArray;
    ulong * ActualCountArray;
};

struct _USER_MARSHAL_ROUTINE_QUADRUPLE {
    USER_MARSHAL_SIZING_ROUTINE pfnBufferSize;
    USER_MARSHAL_MARSHALLING_ROUTINE pfnMarshall;
    USER_MARSHAL_UNMARSHALLING_ROUTINE pfnUnmarshall;
    USER_MARSHAL_FREEING_ROUTINE pfnFree;
};

struct _NDR_CORRELATION_INFO {
};

struct _COMM_FAULT_OFFSETS {
    short CommOffset;
    short FaultOffset;
};

typedef struct _MIDL_STUBLESS_PROXY_INFO _MIDL_STUBLESS_PROXY_INFO, *P_MIDL_STUBLESS_PROXY_INFO;

typedef struct _MIDL_STUB_DESC MIDL_STUB_DESC;

typedef MIDL_STUB_DESC * PMIDL_STUB_DESC;

typedef struct _MIDL_SYNTAX_INFO _MIDL_SYNTAX_INFO, *P_MIDL_SYNTAX_INFO;

typedef struct _MIDL_SYNTAX_INFO * PMIDL_SYNTAX_INFO;

struct _MIDL_STUBLESS_PROXY_INFO {
    PMIDL_STUB_DESC pStubDesc;
    PFORMAT_STRING ProcFormatString;
    ushort * FormatStringOffset;
    PRPC_SYNTAX_IDENTIFIER pTransferSyntax;
    ULONG_PTR nCount;
    PMIDL_SYNTAX_INFO pSyntaxInfo;
};

struct _MIDL_SYNTAX_INFO {
    RPC_SYNTAX_IDENTIFIER TransferSyntax;
    struct RPC_DISPATCH_TABLE * DispatchTable;
    PFORMAT_STRING ProcString;
    ushort * FmtStringOffset;
    PFORMAT_STRING TypeString;
    void * aUserMarshalQuadruple;
    ULONG_PTR pReserved1;
    ULONG_PTR pReserved2;
};

typedef struct _MIDL_STUBLESS_PROXY_INFO MIDL_STUBLESS_PROXY_INFO;

typedef union _CLIENT_CALL_RETURN _CLIENT_CALL_RETURN, *P_CLIENT_CALL_RETURN;

union _CLIENT_CALL_RETURN {
    void * Pointer;
    LONG_PTR Simple;
};

typedef union _CLIENT_CALL_RETURN CLIENT_CALL_RETURN;

typedef ushort wint_t;

typedef int errno_t;

typedef size_t rsize_t;

typedef struct _GUID _GUID, *P_GUID;

struct _GUID {
    ulong Data1;
    ushort Data2;
    ushort Data3;
    uchar Data4[8];
};

typedef GUID * LPCGUID;

typedef void * RPC_AUTH_IDENTITY_HANDLE;

typedef struct _RPC_SECURITY_QOS _RPC_SECURITY_QOS, *P_RPC_SECURITY_QOS;

struct _RPC_SECURITY_QOS {
    ulong Version;
    ulong Capabilities;
    ulong IdentityTracking;
    ulong ImpersonationType;
};

typedef struct _RPC_SECURITY_QOS RPC_SECURITY_QOS;

typedef ushort * RPC_WSTR;

typedef long RPC_STATUS;

typedef enum _WER_REGISTER_FILE_TYPE {
    WerRegFileTypeUserDocument=1,
    WerRegFileTypeOther=2,
    WerRegFileTypeMax=3
} _WER_REGISTER_FILE_TYPE;

typedef enum _WER_REGISTER_FILE_TYPE WER_REGISTER_FILE_TYPE;

typedef struct _ACTIVATION_CONTEXT _ACTIVATION_CONTEXT, *P_ACTIVATION_CONTEXT;

struct _ACTIVATION_CONTEXT {
};

typedef struct _RUNTIME_FUNCTION _RUNTIME_FUNCTION, *P_RUNTIME_FUNCTION;

typedef struct _RUNTIME_FUNCTION * PRUNTIME_FUNCTION;

typedef PRUNTIME_FUNCTION (GET_RUNTIME_FUNCTION_CALLBACK)(DWORD64, PVOID);

struct _RUNTIME_FUNCTION {
    DWORD BeginAddress;
    DWORD EndAddress;
    DWORD UnwindData;
};

typedef struct _PROCESSOR_NUMBER _PROCESSOR_NUMBER, *P_PROCESSOR_NUMBER;

struct _PROCESSOR_NUMBER {
    WORD Group;
    BYTE Number;
    BYTE Reserved;
};

typedef struct _SYSTEM_LOGICAL_PROCESSOR_INFORMATION _SYSTEM_LOGICAL_PROCESSOR_INFORMATION, *P_SYSTEM_LOGICAL_PROCESSOR_INFORMATION;

typedef struct _SYSTEM_LOGICAL_PROCESSOR_INFORMATION * PSYSTEM_LOGICAL_PROCESSOR_INFORMATION;

typedef enum _LOGICAL_PROCESSOR_RELATIONSHIP {
    RelationProcessorCore=0,
    RelationNumaNode=1,
    RelationCache=2,
    RelationProcessorPackage=3,
    RelationGroup=4,
    RelationAll=65535
} _LOGICAL_PROCESSOR_RELATIONSHIP;

typedef enum _LOGICAL_PROCESSOR_RELATIONSHIP LOGICAL_PROCESSOR_RELATIONSHIP;

typedef union _union_160 _union_160, *P_union_160;

typedef struct _struct_161 _struct_161, *P_struct_161;

typedef struct _struct_162 _struct_162, *P_struct_162;

typedef struct _CACHE_DESCRIPTOR _CACHE_DESCRIPTOR, *P_CACHE_DESCRIPTOR;

typedef struct _CACHE_DESCRIPTOR CACHE_DESCRIPTOR;

typedef enum _PROCESSOR_CACHE_TYPE {
    CacheUnified=0,
    CacheInstruction=1,
    CacheData=2,
    CacheTrace=3
} _PROCESSOR_CACHE_TYPE;

typedef enum _PROCESSOR_CACHE_TYPE PROCESSOR_CACHE_TYPE;

struct _CACHE_DESCRIPTOR {
    BYTE Level;
    BYTE Associativity;
    WORD LineSize;
    DWORD Size;
    PROCESSOR_CACHE_TYPE Type;
};

struct _struct_162 {
    DWORD NodeNumber;
};

struct _struct_161 {
    BYTE Flags;
};

union _union_160 {
    struct _struct_161 ProcessorCore;
    struct _struct_162 NumaNode;
    CACHE_DESCRIPTOR Cache;
    ULONGLONG Reserved[2];
};

struct _SYSTEM_LOGICAL_PROCESSOR_INFORMATION {
    ULONG_PTR ProcessorMask;
    LOGICAL_PROCESSOR_RELATIONSHIP Relationship;
    union _union_160 u;
};

typedef struct _PROCESSOR_RELATIONSHIP _PROCESSOR_RELATIONSHIP, *P_PROCESSOR_RELATIONSHIP;

typedef struct _PROCESSOR_RELATIONSHIP PROCESSOR_RELATIONSHIP;

typedef struct _GROUP_AFFINITY _GROUP_AFFINITY, *P_GROUP_AFFINITY;

typedef struct _GROUP_AFFINITY GROUP_AFFINITY;

typedef ULONG_PTR KAFFINITY;

struct _GROUP_AFFINITY {
    KAFFINITY Mask;
    WORD Group;
    WORD Reserved[3];
};

struct _PROCESSOR_RELATIONSHIP {
    BYTE Flags;
    BYTE Reserved[21];
    WORD GroupCount;
    GROUP_AFFINITY GroupMask[1];
};

typedef struct _CONTEXT CONTEXT;

typedef union _ULARGE_INTEGER _ULARGE_INTEGER, *P_ULARGE_INTEGER;

typedef union _ULARGE_INTEGER ULARGE_INTEGER;

typedef struct _struct_22 _struct_22, *P_struct_22;

typedef struct _struct_23 _struct_23, *P_struct_23;

struct _struct_23 {
    DWORD LowPart;
    DWORD HighPart;
};

struct _struct_22 {
    DWORD LowPart;
    DWORD HighPart;
};

union _ULARGE_INTEGER {
    struct _struct_22 s;
    struct _struct_23 u;
    ULONGLONG QuadPart;
};

typedef PVOID PSECURITY_DESCRIPTOR;

typedef struct _TP_WORK _TP_WORK, *P_TP_WORK;

struct _TP_WORK {
};

typedef struct _struct_314 _struct_314, *P_struct_314;

struct _struct_314 {
    ULONGLONG Alignment;
    ULONGLONG Region;
};

typedef struct _TP_CLEANUP_GROUP _TP_CLEANUP_GROUP, *P_TP_CLEANUP_GROUP;

struct _TP_CLEANUP_GROUP {
};

typedef union _union_72 _union_72, *P_union_72;

typedef struct _struct_73 _struct_73, *P_struct_73;

typedef struct _struct_74 _struct_74, *P_struct_74;

struct _struct_73 {
    BYTE BaseMid;
    BYTE Flags1;
    BYTE Flags2;
    BYTE BaseHi;
};

struct _struct_74 {
    DWORD BaseMid:8;
    DWORD Type:5;
    DWORD Dpl:2;
    DWORD Pres:1;
    DWORD LimitHi:4;
    DWORD Sys:1;
    DWORD Reserved_0:1;
    DWORD Default_Big:1;
    DWORD Granularity:1;
    DWORD BaseHi:8;
};

union _union_72 {
    struct _struct_73 Bytes;
    struct _struct_74 Bits;
};

typedef struct _LUID_AND_ATTRIBUTES _LUID_AND_ATTRIBUTES, *P_LUID_AND_ATTRIBUTES;

typedef struct _LUID_AND_ATTRIBUTES LUID_AND_ATTRIBUTES;

typedef struct _LUID _LUID, *P_LUID;

typedef struct _LUID LUID;

struct _LUID {
    DWORD LowPart;
    LONG HighPart;
};

struct _LUID_AND_ATTRIBUTES {
    LUID Luid;
    DWORD Attributes;
};

typedef struct _GENERIC_MAPPING _GENERIC_MAPPING, *P_GENERIC_MAPPING;

typedef DWORD ACCESS_MASK;

struct _GENERIC_MAPPING {
    ACCESS_MASK GenericRead;
    ACCESS_MASK GenericWrite;
    ACCESS_MASK GenericExecute;
    ACCESS_MASK GenericAll;
};

typedef struct _struct_317 _struct_317, *P_struct_317;

struct _struct_317 {
    ULONGLONG Depth:16;
    ULONGLONG Sequence:48;
    ULONGLONG HeaderType:1;
    ULONGLONG Reserved:3;
    ULONGLONG NextEntry:60;
};

typedef struct _struct_316 _struct_316, *P_struct_316;

struct _struct_316 {
    ULONGLONG Depth:16;
    ULONGLONG Sequence:48;
    ULONGLONG HeaderType:1;
    ULONGLONG Init:1;
    ULONGLONG Reserved:2;
    ULONGLONG NextEntry:60;
};

typedef struct _struct_315 _struct_315, *P_struct_315;

struct _struct_315 {
    ULONGLONG Depth:16;
    ULONGLONG Sequence:9;
    ULONGLONG NextEntry:39;
    ULONGLONG HeaderType:1;
    ULONGLONG Init:1;
    ULONGLONG Reserved:59;
    ULONGLONG Region:3;
};

typedef struct _WOW64_CONTEXT _WOW64_CONTEXT, *P_WOW64_CONTEXT;

typedef struct _WOW64_FLOATING_SAVE_AREA _WOW64_FLOATING_SAVE_AREA, *P_WOW64_FLOATING_SAVE_AREA;

typedef struct _WOW64_FLOATING_SAVE_AREA WOW64_FLOATING_SAVE_AREA;

struct _WOW64_FLOATING_SAVE_AREA {
    DWORD ControlWord;
    DWORD StatusWord;
    DWORD TagWord;
    DWORD ErrorOffset;
    DWORD ErrorSelector;
    DWORD DataOffset;
    DWORD DataSelector;
    BYTE RegisterArea[80];
    DWORD Cr0NpxState;
};

struct _WOW64_CONTEXT {
    DWORD ContextFlags;
    DWORD Dr0;
    DWORD Dr1;
    DWORD Dr2;
    DWORD Dr3;
    DWORD Dr6;
    DWORD Dr7;
    WOW64_FLOATING_SAVE_AREA FloatSave;
    DWORD SegGs;
    DWORD SegFs;
    DWORD SegEs;
    DWORD SegDs;
    DWORD Edi;
    DWORD Esi;
    DWORD Ebx;
    DWORD Edx;
    DWORD Ecx;
    DWORD Eax;
    DWORD Ebp;
    DWORD Eip;
    DWORD SegCs;
    DWORD EFlags;
    DWORD Esp;
    DWORD SegSs;
    BYTE ExtendedRegisters[512];
};

typedef struct _TP_WAIT _TP_WAIT, *P_TP_WAIT;

struct _TP_WAIT {
};

typedef WCHAR * PCZZWSTR;

typedef struct _NUMA_NODE_RELATIONSHIP _NUMA_NODE_RELATIONSHIP, *P_NUMA_NODE_RELATIONSHIP;

typedef struct _NUMA_NODE_RELATIONSHIP NUMA_NODE_RELATIONSHIP;

struct _NUMA_NODE_RELATIONSHIP {
    DWORD NodeNumber;
    BYTE Reserved[20];
    GROUP_AFFINITY GroupMask;
};

typedef struct _WOW64_LDT_ENTRY _WOW64_LDT_ENTRY, *P_WOW64_LDT_ENTRY;

struct _WOW64_LDT_ENTRY {
    WORD LimitLow;
    WORD BaseLow;
    union _union_72 HighWord;
};

typedef struct _PROCESSOR_NUMBER * PPROCESSOR_NUMBER;

typedef BOOLEAN (* PSECURE_MEMORY_CACHE_CALLBACK)(PVOID, SIZE_T);

typedef struct _HARDWARE_COUNTER_DATA _HARDWARE_COUNTER_DATA, *P_HARDWARE_COUNTER_DATA;

typedef enum _HARDWARE_COUNTER_TYPE {
    PMCCounter=0,
    MaxHardwareCounterType=1
} _HARDWARE_COUNTER_TYPE;

typedef enum _HARDWARE_COUNTER_TYPE HARDWARE_COUNTER_TYPE;

struct _HARDWARE_COUNTER_DATA {
    HARDWARE_COUNTER_TYPE Type;
    DWORD Reserved;
    DWORD64 Value;
};

typedef struct _SID_IDENTIFIER_AUTHORITY _SID_IDENTIFIER_AUTHORITY, *P_SID_IDENTIFIER_AUTHORITY;

typedef struct _SID_IDENTIFIER_AUTHORITY * PSID_IDENTIFIER_AUTHORITY;

struct _SID_IDENTIFIER_AUTHORITY {
    BYTE Value[6];
};

typedef struct _TP_CALLBACK_INSTANCE _TP_CALLBACK_INSTANCE, *P_TP_CALLBACK_INSTANCE;

struct _TP_CALLBACK_INSTANCE {
};

typedef struct _UNWIND_HISTORY_TABLE_ENTRY _UNWIND_HISTORY_TABLE_ENTRY, *P_UNWIND_HISTORY_TABLE_ENTRY;

typedef struct _UNWIND_HISTORY_TABLE_ENTRY UNWIND_HISTORY_TABLE_ENTRY;

struct _UNWIND_HISTORY_TABLE_ENTRY {
    DWORD64 ImageBase;
    PRUNTIME_FUNCTION FunctionEntry;
};

typedef union _union_61 _union_61, *P_union_61;

typedef struct _M128A * PM128A;

typedef struct _struct_62 _struct_62, *P_struct_62;

struct _struct_62 {
    PM128A Xmm0;
    PM128A Xmm1;
    PM128A Xmm2;
    PM128A Xmm3;
    PM128A Xmm4;
    PM128A Xmm5;
    PM128A Xmm6;
    PM128A Xmm7;
    PM128A Xmm8;
    PM128A Xmm9;
    PM128A Xmm10;
    PM128A Xmm11;
    PM128A Xmm12;
    PM128A Xmm13;
    PM128A Xmm14;
    PM128A Xmm15;
};

union _union_61 {
    PM128A FloatingContext[16];
    struct _struct_62 s;
};

typedef union _union_63 _union_63, *P_union_63;

typedef ulonglong * PDWORD64;

typedef struct _struct_64 _struct_64, *P_struct_64;

struct _struct_64 {
    PDWORD64 Rax;
    PDWORD64 Rcx;
    PDWORD64 Rdx;
    PDWORD64 Rbx;
    PDWORD64 Rsp;
    PDWORD64 Rbp;
    PDWORD64 Rsi;
    PDWORD64 Rdi;
    PDWORD64 R8;
    PDWORD64 R9;
    PDWORD64 R10;
    PDWORD64 R11;
    PDWORD64 R12;
    PDWORD64 R13;
    PDWORD64 R14;
    PDWORD64 R15;
};

union _union_63 {
    PDWORD64 IntegerContext[16];
    struct _struct_64 s;
};

typedef EXCEPTION_DISPOSITION (EXCEPTION_ROUTINE)(struct _EXCEPTION_RECORD *, PVOID, struct _CONTEXT *, PVOID);

typedef struct _TP_CALLBACK_INSTANCE * PTP_CALLBACK_INSTANCE;

typedef struct _TP_WORK * PTP_WORK;

typedef void (* PTP_WORK_CALLBACK)(PTP_CALLBACK_INSTANCE, PVOID, PTP_WORK);

typedef DWORD TP_VERSION;

typedef WCHAR * PWSTR;

typedef struct _OSVERSIONINFOEXA _OSVERSIONINFOEXA, *P_OSVERSIONINFOEXA;

struct _OSVERSIONINFOEXA {
    DWORD dwOSVersionInfoSize;
    DWORD dwMajorVersion;
    DWORD dwMinorVersion;
    DWORD dwBuildNumber;
    DWORD dwPlatformId;
    CHAR szCSDVersion[128];
    WORD wServicePackMajor;
    WORD wServicePackMinor;
    WORD wSuiteMask;
    BYTE wProductType;
    BYTE wReserved;
};

typedef enum _HEAP_INFORMATION_CLASS {
    HeapCompatibilityInformation=0,
    HeapEnableTerminationOnCorruption=1
} _HEAP_INFORMATION_CLASS;

typedef struct _OSVERSIONINFOW _OSVERSIONINFOW, *P_OSVERSIONINFOW;

typedef struct _OSVERSIONINFOW * LPOSVERSIONINFOW;

struct _OSVERSIONINFOW {
    DWORD dwOSVersionInfoSize;
    DWORD dwMajorVersion;
    DWORD dwMinorVersion;
    DWORD dwBuildNumber;
    DWORD dwPlatformId;
    WCHAR szCSDVersion[128];
};

typedef enum _SECURITY_IMPERSONATION_LEVEL {
    SecurityAnonymous=0,
    SecurityIdentification=1,
    SecurityImpersonation=2,
    SecurityDelegation=3
} _SECURITY_IMPERSONATION_LEVEL;

typedef enum _SECURITY_IMPERSONATION_LEVEL SECURITY_IMPERSONATION_LEVEL;

typedef LONG * PLONG;

typedef ULARGE_INTEGER * PULARGE_INTEGER;

typedef struct _TP_POOL _TP_POOL, *P_TP_POOL;

struct _TP_POOL {
};

typedef struct _OSVERSIONINFOA _OSVERSIONINFOA, *P_OSVERSIONINFOA;

typedef struct _OSVERSIONINFOA * LPOSVERSIONINFOA;

struct _OSVERSIONINFOA {
    DWORD dwOSVersionInfoSize;
    DWORD dwMajorVersion;
    DWORD dwMinorVersion;
    DWORD dwBuildNumber;
    DWORD dwPlatformId;
    CHAR szCSDVersion[128];
};

typedef DWORD EXECUTION_STATE;

typedef struct _TP_POOL * PTP_POOL;

typedef struct _TP_CALLBACK_ENVIRON_V3 _TP_CALLBACK_ENVIRON_V3, *P_TP_CALLBACK_ENVIRON_V3;

typedef struct _TP_CALLBACK_ENVIRON_V3 TP_CALLBACK_ENVIRON_V3;

typedef struct _TP_CLEANUP_GROUP * PTP_CLEANUP_GROUP;

typedef void (* PTP_CLEANUP_GROUP_CANCEL_CALLBACK)(PVOID, PVOID);

typedef void (* PTP_SIMPLE_CALLBACK)(PTP_CALLBACK_INSTANCE, PVOID);

typedef union _union_401 _union_401, *P_union_401;

typedef enum _TP_CALLBACK_PRIORITY {
    TP_CALLBACK_PRIORITY_HIGH=0,
    TP_CALLBACK_PRIORITY_NORMAL=1,
    TP_CALLBACK_PRIORITY_LOW=2,
    TP_CALLBACK_PRIORITY_INVALID=3
} _TP_CALLBACK_PRIORITY;

typedef enum _TP_CALLBACK_PRIORITY TP_CALLBACK_PRIORITY;

typedef struct _struct_402 _struct_402, *P_struct_402;

struct _struct_402 {
    DWORD LongFunction:1;
    DWORD Persistent:1;
    DWORD Private:30;
};

union _union_401 {
    DWORD Flags;
    struct _struct_402 s;
};

struct _TP_CALLBACK_ENVIRON_V3 {
    TP_VERSION Version;
    PTP_POOL Pool;
    PTP_CLEANUP_GROUP CleanupGroup;
    PTP_CLEANUP_GROUP_CANCEL_CALLBACK CleanupGroupCancelCallback;
    PVOID RaceDll;
    struct _ACTIVATION_CONTEXT * ActivationContext;
    PTP_SIMPLE_CALLBACK FinalizationCallback;
    union _union_401 u;
    TP_CALLBACK_PRIORITY CallbackPriority;
    DWORD Size;
};

typedef PVOID PSID;

typedef struct _OSVERSIONINFOEXW _OSVERSIONINFOEXW, *P_OSVERSIONINFOEXW;

struct _OSVERSIONINFOEXW {
    DWORD dwOSVersionInfoSize;
    DWORD dwMajorVersion;
    DWORD dwMinorVersion;
    DWORD dwBuildNumber;
    DWORD dwPlatformId;
    WCHAR szCSDVersion[128];
    WORD wServicePackMajor;
    WORD wServicePackMinor;
    WORD wSuiteMask;
    BYTE wProductType;
    BYTE wReserved;
};

typedef WCHAR * PUWSTR;

typedef void * PVOID64;

typedef WCHAR * PCWSTR;

typedef union _FILE_SEGMENT_ELEMENT _FILE_SEGMENT_ELEMENT, *P_FILE_SEGMENT_ELEMENT;

typedef union _FILE_SEGMENT_ELEMENT FILE_SEGMENT_ELEMENT;

union _FILE_SEGMENT_ELEMENT {
    PVOID64 Buffer;
    ULONGLONG Alignment;
};

typedef union _union_169 _union_169, *P_union_169;

typedef struct _CACHE_RELATIONSHIP _CACHE_RELATIONSHIP, *P_CACHE_RELATIONSHIP;

typedef struct _CACHE_RELATIONSHIP CACHE_RELATIONSHIP;

typedef struct _GROUP_RELATIONSHIP _GROUP_RELATIONSHIP, *P_GROUP_RELATIONSHIP;

typedef struct _GROUP_RELATIONSHIP GROUP_RELATIONSHIP;

typedef struct _PROCESSOR_GROUP_INFO _PROCESSOR_GROUP_INFO, *P_PROCESSOR_GROUP_INFO;

typedef struct _PROCESSOR_GROUP_INFO PROCESSOR_GROUP_INFO;

struct _CACHE_RELATIONSHIP {
    BYTE Level;
    BYTE Associativity;
    WORD LineSize;
    DWORD CacheSize;
    PROCESSOR_CACHE_TYPE Type;
    BYTE Reserved[20];
    GROUP_AFFINITY GroupMask;
};

struct _PROCESSOR_GROUP_INFO {
    BYTE MaximumProcessorCount;
    BYTE ActiveProcessorCount;
    BYTE Reserved[38];
    KAFFINITY ActiveProcessorMask;
};

struct _GROUP_RELATIONSHIP {
    WORD MaximumGroupCount;
    WORD ActiveGroupCount;
    BYTE Reserved[20];
    PROCESSOR_GROUP_INFO GroupInfo[1];
};

union _union_169 {
    PROCESSOR_RELATIONSHIP Processor;
    NUMA_NODE_RELATIONSHIP NumaNode;
    CACHE_RELATIONSHIP Cache;
    GROUP_RELATIONSHIP Group;
};

typedef DWORD SECURITY_INFORMATION;

typedef union _SLIST_HEADER _SLIST_HEADER, *P_SLIST_HEADER;

union _SLIST_HEADER {
    struct _struct_314 s;
    struct _struct_315 Header8;
    struct _struct_316 Header16;
    struct _struct_317 HeaderX64;
};

typedef struct _SYSTEM_PROCESSOR_CYCLE_TIME_INFORMATION _SYSTEM_PROCESSOR_CYCLE_TIME_INFORMATION, *P_SYSTEM_PROCESSOR_CYCLE_TIME_INFORMATION;

struct _SYSTEM_PROCESSOR_CYCLE_TIME_INFORMATION {
    DWORD64 CycleTime;
};

typedef struct _WOW64_CONTEXT WOW64_CONTEXT;

typedef WOW64_CONTEXT * PWOW64_CONTEXT;

typedef WCHAR * LPWCH;

typedef WCHAR * PWCHAR;

typedef struct _GROUP_AFFINITY * PGROUP_AFFINITY;

typedef BOOLEAN * PBOOLEAN;

typedef CHAR * LPCH;

typedef struct _HARDWARE_COUNTER_DATA HARDWARE_COUNTER_DATA;

typedef enum _TOKEN_INFORMATION_CLASS {
    TokenUser=1,
    TokenGroups=2,
    TokenPrivileges=3,
    TokenOwner=4,
    TokenPrimaryGroup=5,
    TokenDefaultDacl=6,
    TokenSource=7,
    TokenType=8,
    TokenImpersonationLevel=9,
    TokenStatistics=10,
    TokenRestrictedSids=11,
    TokenSessionId=12,
    TokenGroupsAndPrivileges=13,
    TokenSessionReference=14,
    TokenSandBoxInert=15,
    TokenAuditPolicy=16,
    TokenOrigin=17,
    TokenElevationType=18,
    TokenLinkedToken=19,
    TokenElevation=20,
    TokenHasRestrictions=21,
    TokenAccessInformation=22,
    TokenVirtualizationAllowed=23,
    TokenVirtualizationEnabled=24,
    TokenIntegrityLevel=25,
    TokenUIAccess=26,
    TokenMandatoryPolicy=27,
    TokenLogonSid=28,
    MaxTokenInfoClass=29
} _TOKEN_INFORMATION_CLASS;

typedef enum _JOBOBJECTINFOCLASS {
    JobObjectBasicAccountingInformation=1,
    JobObjectBasicLimitInformation=2,
    JobObjectBasicProcessIdList=3,
    JobObjectBasicUIRestrictions=4,
    JobObjectSecurityLimitInformation=5,
    JobObjectEndOfJobTimeInformation=6,
    JobObjectAssociateCompletionPortInformation=7,
    JobObjectBasicAndIoAccountingInformation=8,
    JobObjectExtendedLimitInformation=9,
    JobObjectJobSetInformation=10,
    JobObjectGroupInformation=11,
    MaxJobObjectInfoClass=12
} _JOBOBJECTINFOCLASS;

typedef struct _TP_WAIT * PTP_WAIT;

typedef struct _PERFORMANCE_DATA _PERFORMANCE_DATA, *P_PERFORMANCE_DATA;

typedef struct _PERFORMANCE_DATA * PPERFORMANCE_DATA;

struct _PERFORMANCE_DATA {
    WORD Size;
    BYTE Version;
    BYTE HwCountersCount;
    DWORD ContextSwitchCount;
    DWORD64 WaitReasonBitMap;
    DWORD64 CycleTime;
    DWORD RetryCount;
    DWORD Reserved;
    HARDWARE_COUNTER_DATA HwCounters[16];
};

typedef EXCEPTION_ROUTINE * PEXCEPTION_ROUTINE;

typedef enum _POWER_REQUEST_TYPE {
    PowerRequestDisplayRequired=0,
    PowerRequestSystemRequired=1,
    PowerRequestAwayModeRequired=2
} _POWER_REQUEST_TYPE;

typedef struct _SYSTEM_PROCESSOR_CYCLE_TIME_INFORMATION * PSYSTEM_PROCESSOR_CYCLE_TIME_INFORMATION;

typedef struct _GENERIC_MAPPING GENERIC_MAPPING;

typedef HANDLE * PHANDLE;

typedef struct _PRIVILEGE_SET _PRIVILEGE_SET, *P_PRIVILEGE_SET;

struct _PRIVILEGE_SET {
    DWORD PrivilegeCount;
    DWORD Control;
    LUID_AND_ATTRIBUTES Privilege[1];
};

typedef WCHAR * PCUWSTR;

typedef DWORD TP_WAIT_RESULT;

typedef void (* PTP_WAIT_CALLBACK)(PTP_CALLBACK_INSTANCE, PVOID, PTP_WAIT, TP_WAIT_RESULT);

typedef struct _TP_TIMER _TP_TIMER, *P_TP_TIMER;

struct _TP_TIMER {
};

typedef struct _SYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX _SYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX, *P_SYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX;

struct _SYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX {
    LOGICAL_PROCESSOR_RELATIONSHIP Relationship;
    DWORD Size;
    union _union_169 u;
};

typedef struct _SLIST_ENTRY _SLIST_ENTRY, *P_SLIST_ENTRY;

typedef struct _SLIST_ENTRY * PSLIST_ENTRY;

struct _SLIST_ENTRY {
    PSLIST_ENTRY Next;
};

typedef WCHAR * PCNZWCH;

typedef struct _TP_TIMER * PTP_TIMER;

typedef void (* PTP_TIMER_CALLBACK)(PTP_CALLBACK_INSTANCE, PVOID, PTP_TIMER);

typedef struct _SYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX * PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX;

typedef struct _UNWIND_HISTORY_TABLE _UNWIND_HISTORY_TABLE, *P_UNWIND_HISTORY_TABLE;

struct _UNWIND_HISTORY_TABLE {
    DWORD Count;
    BYTE LocalHint;
    BYTE GlobalHint;
    BYTE Search;
    BYTE Once;
    DWORD64 LowAddress;
    DWORD64 HighAddress;
    UNWIND_HISTORY_TABLE_ENTRY Entry[12];
};

typedef void (* PAPCFUNC)(ULONG_PTR);

typedef struct _TP_POOL_STACK_INFORMATION _TP_POOL_STACK_INFORMATION, *P_TP_POOL_STACK_INFORMATION;

struct _TP_POOL_STACK_INFORMATION {
    SIZE_T StackReserve;
    SIZE_T StackCommit;
};

typedef ULONGLONG * PULONGLONG;

typedef struct _MEMORY_BASIC_INFORMATION _MEMORY_BASIC_INFORMATION, *P_MEMORY_BASIC_INFORMATION;

typedef struct _MEMORY_BASIC_INFORMATION * PMEMORY_BASIC_INFORMATION;

struct _MEMORY_BASIC_INFORMATION {
    PVOID BaseAddress;
    PVOID AllocationBase;
    DWORD AllocationProtect;
    SIZE_T RegionSize;
    DWORD State;
    DWORD Protect;
    DWORD Type;
};

typedef WCHAR * PZZWSTR;

typedef struct _IO_COUNTERS _IO_COUNTERS, *P_IO_COUNTERS;

typedef struct _IO_COUNTERS IO_COUNTERS;

struct _IO_COUNTERS {
    ULONGLONG ReadOperationCount;
    ULONGLONG WriteOperationCount;
    ULONGLONG OtherOperationCount;
    ULONGLONG ReadTransferCount;
    ULONGLONG WriteTransferCount;
    ULONGLONG OtherTransferCount;
};

typedef enum _JOBOBJECTINFOCLASS JOBOBJECTINFOCLASS;

typedef TP_CALLBACK_ENVIRON_V3 * PTP_CALLBACK_ENVIRON;

typedef struct _KNONVOLATILE_CONTEXT_POINTERS _KNONVOLATILE_CONTEXT_POINTERS, *P_KNONVOLATILE_CONTEXT_POINTERS;

struct _KNONVOLATILE_CONTEXT_POINTERS {
    union _union_61 u;
    union _union_63 u2;
};

typedef enum _TOKEN_INFORMATION_CLASS TOKEN_INFORMATION_CLASS;

typedef struct _JOB_SET_ARRAY _JOB_SET_ARRAY, *P_JOB_SET_ARRAY;

struct _JOB_SET_ARRAY {
    HANDLE JobHandle;
    DWORD MemberLevel;
    DWORD Flags;
};

typedef struct _OSVERSIONINFOEXW * LPOSVERSIONINFOEXW;

typedef struct _WOW64_LDT_ENTRY * PWOW64_LDT_ENTRY;

typedef enum _HEAP_INFORMATION_CLASS HEAP_INFORMATION_CLASS;

typedef WCHAR * LPCUWSTR;

typedef CHAR * LPCCH;

typedef GENERIC_MAPPING * PGENERIC_MAPPING;

typedef struct _UNWIND_HISTORY_TABLE * PUNWIND_HISTORY_TABLE;

typedef union _SLIST_HEADER * PSLIST_HEADER;

typedef void (* PFLS_CALLBACK_FUNCTION)(PVOID);

typedef struct _PRIVILEGE_SET * PPRIVILEGE_SET;

typedef enum enum_87 {
    WinNullSid=0,
    WinWorldSid=1,
    WinLocalSid=2,
    WinCreatorOwnerSid=3,
    WinCreatorGroupSid=4,
    WinCreatorOwnerServerSid=5,
    WinCreatorGroupServerSid=6,
    WinNtAuthoritySid=7,
    WinDialupSid=8,
    WinNetworkSid=9,
    WinBatchSid=10,
    WinInteractiveSid=11,
    WinServiceSid=12,
    WinAnonymousSid=13,
    WinProxySid=14,
    WinEnterpriseControllersSid=15,
    WinSelfSid=16,
    WinAuthenticatedUserSid=17,
    WinRestrictedCodeSid=18,
    WinTerminalServerSid=19,
    WinRemoteLogonIdSid=20,
    WinLogonIdsSid=21,
    WinLocalSystemSid=22,
    WinLocalServiceSid=23,
    WinNetworkServiceSid=24,
    WinBuiltinDomainSid=25,
    WinBuiltinAdministratorsSid=26,
    WinBuiltinUsersSid=27,
    WinBuiltinGuestsSid=28,
    WinBuiltinPowerUsersSid=29,
    WinBuiltinAccountOperatorsSid=30,
    WinBuiltinSystemOperatorsSid=31,
    WinBuiltinPrintOperatorsSid=32,
    WinBuiltinBackupOperatorsSid=33,
    WinBuiltinReplicatorSid=34,
    WinBuiltinPreWindows2000CompatibleAccessSid=35,
    WinBuiltinRemoteDesktopUsersSid=36,
    WinBuiltinNetworkConfigurationOperatorsSid=37,
    WinAccountAdministratorSid=38,
    WinAccountGuestSid=39,
    WinAccountKrbtgtSid=40,
    WinAccountDomainAdminsSid=41,
    WinAccountDomainUsersSid=42,
    WinAccountDomainGuestsSid=43,
    WinAccountComputersSid=44,
    WinAccountControllersSid=45,
    WinAccountCertAdminsSid=46,
    WinAccountSchemaAdminsSid=47,
    WinAccountEnterpriseAdminsSid=48,
    WinAccountPolicyAdminsSid=49,
    WinAccountRasAndIasServersSid=50,
    WinNTLMAuthenticationSid=51,
    WinDigestAuthenticationSid=52,
    WinSChannelAuthenticationSid=53,
    WinThisOrganizationSid=54,
    WinOtherOrganizationSid=55,
    WinBuiltinIncomingForestTrustBuildersSid=56,
    WinBuiltinPerfMonitoringUsersSid=57,
    WinBuiltinPerfLoggingUsersSid=58,
    WinBuiltinAuthorizationAccessSid=59,
    WinBuiltinTerminalServerLicenseServersSid=60,
    WinBuiltinDCOMUsersSid=61,
    WinBuiltinIUsersSid=62,
    WinIUserSid=63,
    WinBuiltinCryptoOperatorsSid=64,
    WinUntrustedLabelSid=65,
    WinLowLabelSid=66,
    WinMediumLabelSid=67,
    WinHighLabelSid=68,
    WinSystemLabelSid=69,
    WinWriteRestrictedCodeSid=70,
    WinCreatorOwnerRightsSid=71,
    WinCacheablePrincipalsGroupSid=72,
    WinNonCacheablePrincipalsGroupSid=73,
    WinEnterpriseReadonlyControllersSid=74,
    WinAccountReadonlyControllersSid=75,
    WinBuiltinEventLogReadersGroup=76,
    WinNewEnterpriseReadonlyControllersSid=77,
    WinBuiltinCertSvcDComAccessGroup=78,
    WinMediumPlusLabelSid=79,
    WinLocalLogonSid=80,
    WinConsoleLogonSid=81,
    WinThisOrganizationCertificateSid=82
} enum_87;

typedef enum _POWER_REQUEST_TYPE POWER_REQUEST_TYPE;

typedef LARGE_INTEGER * PLARGE_INTEGER;

typedef struct _TP_POOL_STACK_INFORMATION * PTP_POOL_STACK_INFORMATION;

typedef GET_RUNTIME_FUNCTION_CALLBACK * PGET_RUNTIME_FUNCTION_CALLBACK;

typedef IO_COUNTERS * PIO_COUNTERS;

typedef struct _KNONVOLATILE_CONTEXT_POINTERS * PKNONVOLATILE_CONTEXT_POINTERS;

typedef CHAR * PSTR;

typedef struct _OSVERSIONINFOEXA * LPOSVERSIONINFOEXA;

typedef struct _JOB_SET_ARRAY * PJOB_SET_ARRAY;

typedef enum enum_87 WELL_KNOWN_SID_TYPE;

typedef CHAR * PCNZCH;

typedef struct _EVENT_DESCRIPTOR _EVENT_DESCRIPTOR, *P_EVENT_DESCRIPTOR;

typedef struct _EVENT_DESCRIPTOR EVENT_DESCRIPTOR;

struct _EVENT_DESCRIPTOR {
    USHORT Id;
    UCHAR Version;
    UCHAR Channel;
    UCHAR Level;
    UCHAR Opcode;
    USHORT Task;
    ULONGLONG Keyword;
};

typedef struct _EVENT_DATA_DESCRIPTOR _EVENT_DATA_DESCRIPTOR, *P_EVENT_DATA_DESCRIPTOR;

struct _EVENT_DATA_DESCRIPTOR {
    ULONGLONG Ptr;
    ULONG Size;
    ULONG Reserved;
};

typedef struct _EVENT_FILTER_DESCRIPTOR _EVENT_FILTER_DESCRIPTOR, *P_EVENT_FILTER_DESCRIPTOR;

struct _EVENT_FILTER_DESCRIPTOR {
    ULONGLONG Ptr;
    ULONG Size;
    ULONG Type;
};

typedef struct _EVENT_FILTER_DESCRIPTOR * PEVENT_FILTER_DESCRIPTOR;

typedef void (* PENABLECALLBACK)(LPCGUID, ULONG, UCHAR, ULONGLONG, ULONGLONG, PEVENT_FILTER_DESCRIPTOR, PVOID);

typedef ULONGLONG REGHANDLE;

typedef struct _EVENT_DATA_DESCRIPTOR * PEVENT_DATA_DESCRIPTOR;

typedef ULONGLONG * PREGHANDLE;

typedef EVENT_DESCRIPTOR * PCEVENT_DESCRIPTOR;

typedef struct IMAGE_DOS_HEADER IMAGE_DOS_HEADER, *PIMAGE_DOS_HEADER;

struct IMAGE_DOS_HEADER {
    char e_magic[2]; // Magic number
    word e_cblp; // Bytes of last page
    word e_cp; // Pages in file
    word e_crlc; // Relocations
    word e_cparhdr; // Size of header in paragraphs
    word e_minalloc; // Minimum extra paragraphs needed
    word e_maxalloc; // Maximum extra paragraphs needed
    word e_ss; // Initial (relative) SS value
    word e_sp; // Initial SP value
    word e_csum; // Checksum
    word e_ip; // Initial IP value
    word e_cs; // Initial (relative) CS value
    word e_lfarlc; // File address of relocation table
    word e_ovno; // Overlay number
    word e_res[4][4]; // Reserved words
    word e_oemid; // OEM identifier (for e_oeminfo)
    word e_oeminfo; // OEM information; e_oemid specific
    word e_res2[10][10]; // Reserved words
    dword e_lfanew; // File address of new exe header
    byte e_program[64]; // Actual DOS program
};

typedef ulonglong * PULONG64;

typedef ULONG_PTR * PSIZE_T;

typedef ULONG_PTR * PDWORD_PTR;

typedef ulonglong * PULONG_PTR;

typedef longlong INT_PTR;

typedef ulonglong UINT_PTR;

typedef struct HKEY__ HKEY__, *PHKEY__;

struct HKEY__ {
    int unused;
};


// WARNING! conflicting data type names: /WinDef.h/UCHAR - /winsmcrd.h/UCHAR

typedef UCHAR * PUCHAR;

typedef DWORD * LPDWORD;

typedef DWORD * PDWORD;

typedef int * LPINT;

typedef struct _FILETIME * PFILETIME;

typedef struct HWND__ HWND__, *PHWND__;

typedef struct HWND__ * HWND;

struct HWND__ {
    int unused;
};

typedef struct HRSRC__ HRSRC__, *PHRSRC__;

struct HRSRC__ {
    int unused;
};

typedef HANDLE HGLOBAL;

typedef void * LPCVOID;

typedef HANDLE HLOCAL;

typedef long * LPLONG;

typedef BOOL * PBOOL;

typedef struct _FILETIME * LPFILETIME;

typedef INT_PTR (* FARPROC)(void);

typedef USHORT * PUSHORT;

typedef HANDLE * LPHANDLE;

typedef int INT;

typedef WORD * LPWORD;

typedef struct HKEY__ * HKEY;

typedef HKEY * PHKEY;

typedef WORD ATOM;

typedef int HFILE;

typedef ULONG * PULONG;

typedef BOOL * LPBOOL;

typedef struct HRSRC__ * HRSRC;

typedef struct Var Var, *PVar;

struct Var {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct;

struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct {
    dword NameOffset;
    dword NameIsString;
};

typedef struct IMAGE_LOAD_CONFIG_CODE_INTEGRITY IMAGE_LOAD_CONFIG_CODE_INTEGRITY, *PIMAGE_LOAD_CONFIG_CODE_INTEGRITY;

struct IMAGE_LOAD_CONFIG_CODE_INTEGRITY {
    word Flags;
    word Catalog;
    dword CatalogOffset;
    dword Reserved;
};

typedef struct IMAGE_DEBUG_DIRECTORY IMAGE_DEBUG_DIRECTORY, *PIMAGE_DEBUG_DIRECTORY;

struct IMAGE_DEBUG_DIRECTORY {
    dword Characteristics;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    dword Type;
    dword SizeOfData;
    dword AddressOfRawData;
    dword PointerToRawData;
};

typedef struct IMAGE_IMPORT_BY_NAME_15 IMAGE_IMPORT_BY_NAME_15, *PIMAGE_IMPORT_BY_NAME_15;

struct IMAGE_IMPORT_BY_NAME_15 {
    word Hint;
    char Name[15];
};

typedef struct IMAGE_IMPORT_BY_NAME_17 IMAGE_IMPORT_BY_NAME_17, *PIMAGE_IMPORT_BY_NAME_17;

struct IMAGE_IMPORT_BY_NAME_17 {
    word Hint;
    char Name[17];
};

typedef struct IMAGE_IMPORT_BY_NAME_19 IMAGE_IMPORT_BY_NAME_19, *PIMAGE_IMPORT_BY_NAME_19;

struct IMAGE_IMPORT_BY_NAME_19 {
    word Hint;
    char Name[19];
};

typedef struct StringTable StringTable, *PStringTable;

struct StringTable {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct IMAGE_SECTION_HEADER IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;

typedef union Misc Misc, *PMisc;

typedef enum SectionFlags {
    IMAGE_SCN_TYPE_NO_PAD=8,
    IMAGE_SCN_RESERVED_0001=16,
    IMAGE_SCN_CNT_CODE=32,
    IMAGE_SCN_CNT_INITIALIZED_DATA=64,
    IMAGE_SCN_CNT_UNINITIALIZED_DATA=128,
    IMAGE_SCN_LNK_OTHER=256,
    IMAGE_SCN_LNK_INFO=512,
    IMAGE_SCN_RESERVED_0040=1024,
    IMAGE_SCN_LNK_REMOVE=2048,
    IMAGE_SCN_LNK_COMDAT=4096,
    IMAGE_SCN_GPREL=32768,
    IMAGE_SCN_MEM_16BIT=131072,
    IMAGE_SCN_MEM_PURGEABLE=131072,
    IMAGE_SCN_MEM_LOCKED=262144,
    IMAGE_SCN_MEM_PRELOAD=524288,
    IMAGE_SCN_ALIGN_1BYTES=1048576,
    IMAGE_SCN_ALIGN_2BYTES=2097152,
    IMAGE_SCN_ALIGN_4BYTES=3145728,
    IMAGE_SCN_ALIGN_8BYTES=4194304,
    IMAGE_SCN_ALIGN_16BYTES=5242880,
    IMAGE_SCN_ALIGN_32BYTES=6291456,
    IMAGE_SCN_ALIGN_64BYTES=7340032,
    IMAGE_SCN_ALIGN_128BYTES=8388608,
    IMAGE_SCN_ALIGN_256BYTES=9437184,
    IMAGE_SCN_ALIGN_512BYTES=10485760,
    IMAGE_SCN_ALIGN_1024BYTES=11534336,
    IMAGE_SCN_ALIGN_2048BYTES=12582912,
    IMAGE_SCN_ALIGN_4096BYTES=13631488,
    IMAGE_SCN_ALIGN_8192BYTES=14680064,
    IMAGE_SCN_LNK_NRELOC_OVFL=16777216,
    IMAGE_SCN_MEM_DISCARDABLE=33554432,
    IMAGE_SCN_MEM_NOT_CACHED=67108864,
    IMAGE_SCN_MEM_NOT_PAGED=134217728,
    IMAGE_SCN_MEM_SHARED=268435456,
    IMAGE_SCN_MEM_EXECUTE=536870912,
    IMAGE_SCN_MEM_READ=1073741824,
    IMAGE_SCN_MEM_WRITE=2147483648
} SectionFlags;

union Misc {
    dword PhysicalAddress;
    dword VirtualSize;
};

struct IMAGE_SECTION_HEADER {
    char Name[8];
    union Misc Misc;
    ImageBaseOffset32 VirtualAddress;
    dword SizeOfRawData;
    dword PointerToRawData;
    dword PointerToRelocations;
    dword PointerToLinenumbers;
    word NumberOfRelocations;
    word NumberOfLinenumbers;
    enum SectionFlags Characteristics;
};

typedef struct IMAGE_NT_HEADERS64 IMAGE_NT_HEADERS64, *PIMAGE_NT_HEADERS64;

typedef struct IMAGE_FILE_HEADER IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER;

typedef struct IMAGE_OPTIONAL_HEADER64 IMAGE_OPTIONAL_HEADER64, *PIMAGE_OPTIONAL_HEADER64;

typedef struct IMAGE_DATA_DIRECTORY IMAGE_DATA_DIRECTORY, *PIMAGE_DATA_DIRECTORY;

struct IMAGE_DATA_DIRECTORY {
    ImageBaseOffset32 VirtualAddress;
    dword Size;
};

struct IMAGE_OPTIONAL_HEADER64 {
    word Magic;
    byte MajorLinkerVersion;
    byte MinorLinkerVersion;
    dword SizeOfCode;
    dword SizeOfInitializedData;
    dword SizeOfUninitializedData;
    ImageBaseOffset32 AddressOfEntryPoint;
    ImageBaseOffset32 BaseOfCode;
    pointer64 ImageBase;
    dword SectionAlignment;
    dword FileAlignment;
    word MajorOperatingSystemVersion;
    word MinorOperatingSystemVersion;
    word MajorImageVersion;
    word MinorImageVersion;
    word MajorSubsystemVersion;
    word MinorSubsystemVersion;
    dword Win32VersionValue;
    dword SizeOfImage;
    dword SizeOfHeaders;
    dword CheckSum;
    word Subsystem;
    word DllCharacteristics;
    qword SizeOfStackReserve;
    qword SizeOfStackCommit;
    qword SizeOfHeapReserve;
    qword SizeOfHeapCommit;
    dword LoaderFlags;
    dword NumberOfRvaAndSizes;
    struct IMAGE_DATA_DIRECTORY DataDirectory[16];
};

struct IMAGE_FILE_HEADER {
    word Machine; // 34404
    word NumberOfSections;
    dword TimeDateStamp;
    dword PointerToSymbolTable;
    dword NumberOfSymbols;
    word SizeOfOptionalHeader;
    word Characteristics;
};

struct IMAGE_NT_HEADERS64 {
    char Signature[4];
    struct IMAGE_FILE_HEADER FileHeader;
    struct IMAGE_OPTIONAL_HEADER64 OptionalHeader;
};

typedef struct IMAGE_RESOURCE_DIR_STRING_U_6 IMAGE_RESOURCE_DIR_STRING_U_6, *PIMAGE_RESOURCE_DIR_STRING_U_6;

struct IMAGE_RESOURCE_DIR_STRING_U_6 {
    word Length;
    wchar16 NameString[3];
};

typedef struct IMAGE_RESOURCE_DATA_ENTRY IMAGE_RESOURCE_DATA_ENTRY, *PIMAGE_RESOURCE_DATA_ENTRY;

struct IMAGE_RESOURCE_DATA_ENTRY {
    dword OffsetToData;
    dword Size;
    dword CodePage;
    dword Reserved;
};

typedef struct IMAGE_IMPORT_BY_NAME_21 IMAGE_IMPORT_BY_NAME_21, *PIMAGE_IMPORT_BY_NAME_21;

struct IMAGE_IMPORT_BY_NAME_21 {
    word Hint;
    char Name[21];
};

typedef struct IMAGE_RESOURCE_DIRECTORY IMAGE_RESOURCE_DIRECTORY, *PIMAGE_RESOURCE_DIRECTORY;

struct IMAGE_RESOURCE_DIRECTORY {
    dword Characteristics;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    word NumberOfNamedEntries;
    word NumberOfIdEntries;
};

typedef struct IMAGE_DIRECTORY_ENTRY_EXPORT IMAGE_DIRECTORY_ENTRY_EXPORT, *PIMAGE_DIRECTORY_ENTRY_EXPORT;

struct IMAGE_DIRECTORY_ENTRY_EXPORT {
    dword Characteristics;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    dword Name;
    dword Base;
    dword NumberOfFunctions;
    dword NumberOfNames;
    dword AddressOfFunctions;
    dword AddressOfNames;
    dword AddressOfNameOrdinals;
};

typedef struct IMAGE_IMPORT_BY_NAME_25 IMAGE_IMPORT_BY_NAME_25, *PIMAGE_IMPORT_BY_NAME_25;

struct IMAGE_IMPORT_BY_NAME_25 {
    word Hint;
    char Name[25];
};

typedef struct IMAGE_IMPORT_BY_NAME_29 IMAGE_IMPORT_BY_NAME_29, *PIMAGE_IMPORT_BY_NAME_29;

struct IMAGE_IMPORT_BY_NAME_29 {
    word Hint;
    char Name[29];
};

typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion;

union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion {
    struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct;
    dword Name;
    word Id;
};

typedef struct IMAGE_LOAD_CONFIG_DIRECTORY64 IMAGE_LOAD_CONFIG_DIRECTORY64, *PIMAGE_LOAD_CONFIG_DIRECTORY64;

typedef enum IMAGE_GUARD_FLAGS {
    IMAGE_GUARD_CF_INSTRUMENTED=256,
    IMAGE_GUARD_CFW_INSTRUMENTED=512,
    IMAGE_GUARD_CF_FUNCTION_TABLE_PRESENT=1024,
    IMAGE_GUARD_SECURITY_COOKIE_UNUSED=2048,
    IMAGE_GUARD_PROTECT_DELAYLOAD_IAT=4096,
    IMAGE_GUARD_DELAYLOAD_IAT_IN_ITS_OWN_SECTION=8192,
    IMAGE_GUARD_CF_EXPORT_SUPPRESSION_INFO_PRESENT=16384,
    IMAGE_GUARD_CF_ENABLE_EXPORT_SUPPRESSION=32768,
    IMAGE_GUARD_CF_LONGJUMP_TABLE_PRESENT=65536,
    IMAGE_GUARD_RF_INSTRUMENTED=131072,
    IMAGE_GUARD_RF_ENABLE=262144,
    IMAGE_GUARD_RF_STRICT=524288,
    IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK_1=268435456,
    IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK_2=536870912,
    IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK_4=1073741824,
    IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK_8=2147483648
} IMAGE_GUARD_FLAGS;

struct IMAGE_LOAD_CONFIG_DIRECTORY64 {
    dword Size;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    dword GlobalFlagsClear;
    dword GlobalFlagsSet;
    dword CriticalSectionDefaultTimeout;
    qword DeCommitFreeBlockThreshold;
    qword DeCommitTotalFreeThreshold;
    pointer64 LockPrefixTable;
    qword MaximumAllocationSize;
    qword VirtualMemoryThreshold;
    qword ProcessAffinityMask;
    dword ProcessHeapFlags;
    word CsdVersion;
    word DependentLoadFlags;
    pointer64 EditList;
    pointer64 SecurityCookie;
    pointer64 SEHandlerTable;
    qword SEHandlerCount;
    pointer64 GuardCFCCheckFunctionPointer;
    pointer64 GuardCFDispatchFunctionPointer;
    pointer64 GuardCFFunctionTable;
    qword GuardCFFunctionCount;
    enum IMAGE_GUARD_FLAGS GuardFlags;
    struct IMAGE_LOAD_CONFIG_CODE_INTEGRITY CodeIntegrity;
    pointer64 GuardAddressTakenIatEntryTable;
    qword GuardAddressTakenIatEntryCount;
    pointer64 GuardLongJumpTargetTable;
    qword GuardLongJumpTargetCount;
    pointer64 DynamicValueRelocTable;
    pointer64 CHPEMetadataPointer;
    pointer64 GuardRFFailureRoutine;
    pointer64 GuardRFFailureRoutineFunctionPointer;
    dword DynamicValueRelocTableOffset;
    word DynamicValueRelocTableSection;
    word Reserved1;
    pointer64 GuardRFVerifyStackPointerFunctionPointer;
    dword HotPatchTableOffset;
    dword Reserved2;
    qword Reserved3;
};

typedef struct StringFileInfo StringFileInfo, *PStringFileInfo;

struct StringFileInfo {
    word wLength;
    word wValueLength;
    word wType;
};

typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY IMAGE_RESOURCE_DIRECTORY_ENTRY, *PIMAGE_RESOURCE_DIRECTORY_ENTRY;

union IMAGE_RESOURCE_DIRECTORY_ENTRY {
    union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion NameUnion;
    union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion DirectoryUnion;
};

typedef struct ImgDelayDescr ImgDelayDescr, *PImgDelayDescr;

struct ImgDelayDescr {
    dword grAttrs;
    ImageBaseOffset32 szName;
    ImageBaseOffset32 phmod;
    ImageBaseOffset32 pIAT;
    ImageBaseOffset32 pINT;
    ImageBaseOffset32 pBoundIAT;
    ImageBaseOffset32 pUnloadIAT;
    dword dwTimeStamp;
};

typedef struct VS_VERSION_INFO VS_VERSION_INFO, *PVS_VERSION_INFO;

struct VS_VERSION_INFO {
    word StructLength;
    word ValueLength;
    word StructType;
    wchar16 Info[16];
    byte Padding[2];
    dword Signature;
    word StructVersion[2];
    word FileVersion[4];
    word ProductVersion[4];
    dword FileFlagsMask[2];
    dword FileFlags;
    dword FileOS;
    dword FileType;
    dword FileSubtype;
    dword FileTimestamp;
};

typedef struct VarFileInfo VarFileInfo, *PVarFileInfo;

struct VarFileInfo {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct StringInfo StringInfo, *PStringInfo;

struct StringInfo {
    word wLength;
    word wValueLength;
    word wType;
};

typedef LONG LSTATUS;

typedef ACCESS_MASK REGSAM;

typedef union _union_1042 _union_1042, *P_union_1042;

typedef struct _struct_1043 _struct_1043, *P_struct_1043;

typedef struct _struct_1044 _struct_1044, *P_struct_1044;

struct _struct_1043 {
    BYTE hour;
    BYTE min;
    BYTE sec;
    BYTE frame;
    BYTE fps;
    BYTE dummy;
    BYTE pad[2];
};

struct _struct_1044 {
    DWORD songptrpos;
};

union _union_1042 {
    DWORD ms;
    DWORD sample;
    DWORD cb;
    DWORD ticks;
    struct _struct_1043 smpte;
    struct _struct_1044 midi;
};

typedef struct mmtime_tag mmtime_tag, *Pmmtime_tag;

struct mmtime_tag {
    UINT wType;
    union _union_1042 u;
};

typedef struct mmtime_tag * LPMMTIME;

typedef UINT MMRESULT;

typedef struct timecaps_tag timecaps_tag, *Ptimecaps_tag;

typedef struct timecaps_tag * LPTIMECAPS;

struct timecaps_tag {
    UINT wPeriodMin;
    UINT wPeriodMax;
};

typedef enum _RPC_NOTIFICATION_TYPES {
    RpcNotificationTypeNone=0,
    RpcNotificationTypeEvent=1,
    RpcNotificationTypeApc=2,
    RpcNotificationTypeIoc=3,
    RpcNotificationTypeHwnd=4,
    RpcNotificationTypeCallback=5
} _RPC_NOTIFICATION_TYPES;

typedef enum _RPC_NOTIFICATION_TYPES RPC_NOTIFICATION_TYPES;

typedef union _RPC_ASYNC_NOTIFICATION_INFO _RPC_ASYNC_NOTIFICATION_INFO, *P_RPC_ASYNC_NOTIFICATION_INFO;

typedef struct _struct_1214 _struct_1214, *P_struct_1214;

typedef struct _struct_1215 _struct_1215, *P_struct_1215;

typedef struct _struct_1216 _struct_1216, *P_struct_1216;

typedef struct _RPC_ASYNC_STATE _RPC_ASYNC_STATE, *P_RPC_ASYNC_STATE;

typedef enum _RPC_ASYNC_EVENT {
    RpcCallComplete=0,
    RpcSendComplete=1,
    RpcReceiveComplete=2,
    RpcClientDisconnect=3
} _RPC_ASYNC_EVENT;

typedef enum _RPC_ASYNC_EVENT RPC_ASYNC_EVENT;

typedef void (RPCNOTIFICATION_ROUTINE)(struct _RPC_ASYNC_STATE *, void *, RPC_ASYNC_EVENT);

typedef RPCNOTIFICATION_ROUTINE * PFN_RPCNOTIFICATION_ROUTINE;

typedef union _RPC_ASYNC_NOTIFICATION_INFO RPC_ASYNC_NOTIFICATION_INFO;

struct _struct_1214 {
    PFN_RPCNOTIFICATION_ROUTINE NotificationRoutine;
    HANDLE hThread;
};

struct _struct_1216 {
    HWND hWnd;
    UINT Msg;
};

struct _struct_1215 {
    HANDLE hIOPort;
    DWORD dwNumberOfBytesTransferred;
    DWORD_PTR dwCompletionKey;
    LPOVERLAPPED lpOverlapped;
};

union _RPC_ASYNC_NOTIFICATION_INFO {
    struct _struct_1214 APC;
    struct _struct_1215 IOC;
    struct _struct_1216 HWND;
    HANDLE hEvent;
    PFN_RPCNOTIFICATION_ROUTINE NotificationRoutine;
};

struct _RPC_ASYNC_STATE {
    uint Size;
    ulong Signature;
    long Lock;
    ulong Flags;
    void * StubInfo;
    void * UserInfo;
    void * RuntimeInfo;
    RPC_ASYNC_EVENT Event;
    RPC_NOTIFICATION_TYPES NotificationType;
    RPC_ASYNC_NOTIFICATION_INFO u;
    LONG_PTR Reserved[4];
};

typedef struct _RPC_ASYNC_STATE * PRPC_ASYNC_STATE;




PEXCEPTION_ROUTINE
RtlVirtualUnwind(DWORD HandlerType,DWORD64 ImageBase,DWORD64 ControlPc,
                PRUNTIME_FUNCTION FunctionEntry,PCONTEXT ContextRecord,PVOID *HandlerData,
                PDWORD64 EstablisherFrame,PKNONVOLATILE_CONTEXT_POINTERS ContextPointers)

{
  PEXCEPTION_ROUTINE puVar1;
  
                    // 0x1010  1252  RtlVirtualUnwind
  puVar1 = RtlVirtualUnwind(HandlerType,ImageBase,ControlPc,FunctionEntry,ContextRecord,HandlerData,
                            EstablisherFrame,ContextPointers);
  return puVar1;
}



int GetNumberFormatW(undefined8 param_1,DWORD param_2,LPCWSTR param_3,NUMBERFMTW *param_4,
                    LPWSTR param_5,int param_6)

{
  int iVar1;
  LPCWSTR lpLocaleName;
  
                    // 0x1060  670  GetNumberFormatW
  lpLocaleName = (LPCWSTR)InternalLcidToName(param_1,0);
  if (lpLocaleName == (LPCWSTR)0x0) {
    SetLastError(0x57);
    iVar1 = 0;
  }
  else {
    iVar1 = GetNumberFormatEx(lpLocaleName,param_2,param_3,param_4,param_5,param_6);
  }
  return iVar1;
}



BOOL GetTimeZoneInformationForYear
               (USHORT wYear,PDYNAMIC_TIME_ZONE_INFORMATION pdtzi,LPTIME_ZONE_INFORMATION ptzi)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180001070. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1070  794  GetTimeZoneInformationForYear
  BVar1 = GetTimeZoneInformationForYear(wYear,pdtzi,ptzi);
  return BVar1;
}



int IdnToAscii(DWORD dwFlags,LPCWSTR lpUnicodeCharStr,int cchUnicodeChar,LPWSTR lpASCIICharStr,
              int cchASCIIChar)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180001090. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1090  864  IdnToAscii
  iVar1 = IdnToAscii(dwFlags,lpUnicodeCharStr,cchUnicodeChar,lpASCIICharStr,cchASCIIChar);
  return iVar1;
}



HANDLE CreateWaitableTimerW
                 (LPSECURITY_ATTRIBUTES lpTimerAttributes,BOOL bManualReset,LPCWSTR lpTimerName)

{
  HANDLE pvVar1;
  
                    // 0x10b0  261  CreateWaitableTimerW
                    // WARNING: Could not recover jumptable at 0x0001800010c5. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = CreateWaitableTimerExW(lpTimerAttributes,lpTimerName,(uint)(bManualReset != 0),0x1f0003);
  return pvVar1;
}



BOOL QueryThreadCycleTime(HANDLE ThreadHandle,PULONG64 CycleTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800010e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x10e0  1112  QueryThreadCycleTime
  BVar1 = QueryThreadCycleTime(ThreadHandle,CycleTime);
  return BVar1;
}



int GetSystemDefaultLocaleName(LPWSTR lpLocaleName,int cchLocaleName)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180001100. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1100  744  GetSystemDefaultLocaleName
  iVar1 = GetSystemDefaultLocaleName(lpLocaleName,cchLocaleName);
  return iVar1;
}



undefined8 FUN_180001114(longlong param_1,LPVOID param_2,undefined8 *param_3)

{
  BOOL BVar1;
  undefined8 uVar2;
  DWORD local_res8 [2];
  
  uVar2 = 0xc0000089;
  BVar1 = SetFilePointerEx(*(HANDLE *)(param_1 + 0x38),0xffffffffffffffe0,(PLARGE_INTEGER)0x0,2);
  if (BVar1 != 0) {
    BVar1 = ReadFile(*(HANDLE *)(param_1 + 0x38),param_2,0x20,local_res8,(LPOVERLAPPED)0x0);
    if ((BVar1 != 0) && (local_res8[0] == 0x20)) {
      *param_3 = 0x20;
      uVar2 = 0;
    }
  }
  return uVar2;
}



undefined8 FUN_1800011b0(longlong param_1,LONG param_2,LPVOID param_3,undefined8 *param_4)

{
  DWORD DVar1;
  BOOL BVar2;
  undefined8 uVar3;
  DWORD local_res8 [2];
  
  uVar3 = 0xc0000089;
  DVar1 = SetFilePointer(*(HANDLE *)(param_1 + 0x38),param_2,(PLONG)0x0,0);
  if (DVar1 != 0xffffffff) {
    BVar2 = ReadFile(*(HANDLE *)(param_1 + 0x38),param_3,0x20,local_res8,(LPOVERLAPPED)0x0);
    if ((BVar2 != 0) && (local_res8[0] == 0x20)) {
      *param_4 = 0x20;
      uVar3 = 0;
    }
  }
  return uVar3;
}



BOOL CheckRemoteDebuggerPresent(HANDLE hProcess,PBOOL pbDebuggerPresent)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180001250. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1250  132  CheckRemoteDebuggerPresent
  BVar1 = CheckRemoteDebuggerPresent(hProcess,pbDebuggerPresent);
  return BVar1;
}



BOOL GetPhysicallyInstalledSystemMemory(PULONGLONG TotalMemoryInKilobytes)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180001270. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1270  685  GetPhysicallyInstalledSystemMemory
  BVar1 = GetPhysicallyInstalledSystemMemory(TotalMemoryInKilobytes);
  return BVar1;
}



void FUN_180001290(longlong param_1,uint param_2,ushort *param_3,uint param_4,ushort *param_5,
                  int param_6)

{
  ushort *puVar1;
  undefined2 uVar2;
  ushort uVar3;
  longlong lVar4;
  byte *pbVar5;
  byte bVar6;
  char cVar7;
  uint uVar8;
  int iVar9;
  int iVar10;
  longlong lVar11;
  longlong lVar12;
  ushort uVar13;
  DWORD dwErrCode;
  int iVar14;
  undefined4 uVar15;
  uint uVar16;
  byte *pbVar17;
  uint uVar18;
  uint uVar19;
  byte *pbVar20;
  undefined2 *puVar21;
  int iVar22;
  undefined2 *puVar23;
  undefined2 *puVar24;
  byte bVar25;
  short sVar26;
  ushort *puVar27;
  ushort *puVar28;
  byte bVar29;
  int iVar30;
  byte *pbVar31;
  ushort uVar32;
  ulonglong uVar33;
  longlong lVar34;
  undefined *puVar35;
  ulonglong uVar36;
  longlong in_GS_OFFSET;
  undefined auStackY4008 [32];
  byte local_f68;
  int local_f64;
  ushort *local_f58;
  int local_f50;
  int local_f38;
  byte *local_f30;
  longlong local_f18;
  int local_f10;
  byte local_f0c;
  undefined local_f0b;
  undefined local_f0a;
  uint local_f08;
  ushort *local_f00;
  undefined2 local_ef8 [2];
  int local_ef4;
  uint local_ef0;
  byte *local_ee8;
  byte *local_ee0;
  uint local_ed8;
  uint local_ed4;
  uint local_ed0;
  longlong local_ec8;
  ushort *local_ec0;
  byte *local_eb8;
  byte *local_eb0;
  longlong local_ea8;
  longlong local_ea0;
  ushort *local_e98;
  byte *local_e90;
  undefined2 *local_e50;
  byte *local_e48;
  byte *local_e40;
  byte *local_e30;
  undefined2 *local_e10;
  byte *local_e08;
  byte *local_e00;
  byte *local_df0;
  undefined2 local_dc8 [1728];
  ulonglong local_48;
  
  lVar34 = DAT_1800b2b88;
  local_48 = DAT_1800b2220 ^ (ulonglong)auStackY4008;
  local_e98 = param_5;
  local_ed0 = param_2;
  local_ec0 = param_3;
  if ((((((param_1 == 0) || (param_4 == 0)) || (param_6 < 0)) || (param_3 == (ushort *)0x0)) ||
      ((param_6 != 0 && (param_5 == (ushort *)0x0)))) || (param_3 == param_5)) {
    dwErrCode = 0x57;
  }
  else {
    iVar30 = 0;
    if (((param_2 & 0xfffffff1) - 1 & param_2 & 0x11) == 0 &&
        (((param_2 & 0xffffffe2) - 1 & param_2 & 0x22) == 0 && (param_2 & 0xe7fcefc0) == 0)) {
      if (DAT_1800b2b88 != 0) {
        lVar11 = param_1;
        if ((int)param_4 < 0) {
          iVar30 = 0;
          uVar33 = FUN_180002600((short *)param_3);
          param_4 = (int)uVar33 + 1;
        }
        local_ea8 = 8;
        if ((int)param_4 < 0x41) {
          puVar21 = local_dc8;
          local_f10 = 0xc0;
        }
        else {
          if (0x25ed097 < param_4) {
            SetLastError(0x57);
            goto LAB_180001379;
          }
          local_f10 = param_4 * 3;
          puVar21 = (undefined2 *)
                    RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
          if (puVar21 == (undefined2 *)0x0) {
            local_e50 = puVar21;
            SetLastError(0xe);
            goto LAB_180001379;
          }
          iVar30 = 0;
          lVar11 = param_1;
          lVar34 = DAT_1800b2b88;
        }
        if ((param_2 >> 0x1b & 1) == 0) {
          local_f18 = *(longlong *)(lVar11 + 0x138);
        }
        else {
          local_f18 = *(longlong *)(lVar11 + 0x130);
        }
        puVar1 = param_3 + (int)param_4;
        local_ef4 = iVar30;
        if ((*(byte *)(lVar11 + 0x140) & 1) != 0) {
          local_ef4 = 1;
        }
        local_ea0 = DAT_1800b2b98;
        local_f68 = 0xff;
        uVar8 = param_2 & 0x30001;
        if (uVar8 == 0x30001) {
          local_f68 = 0xc6;
        }
        else if (uVar8 < 0x20001) {
          if (uVar8 == 0x20000) {
            local_f68 = 0xfe;
          }
          else if (uVar8 == 1) {
            local_f68 = 0xe7;
          }
          else if (uVar8 == 0x10000) {
            local_f68 = 0xdf;
          }
          else if (uVar8 == 0x10001) {
            local_f68 = 199;
          }
        }
        else if (uVar8 == 0x20001) {
          local_f68 = 0xe6;
        }
        else if (uVar8 == 0x30000) {
          local_f68 = 0xde;
        }
        pbVar17 = (byte *)((longlong)(local_f10 * 8) + (longlong)puVar21);
        local_f38 = 0;
        pbVar31 = pbVar17 + local_f10;
        local_ee8 = pbVar31 + local_f10;
        local_ed4 = param_2 & 0x1000;
        local_e90 = local_ee8 + local_f10 * 4;
        local_ef0 = param_2 & 4;
        uVar8 = param_2 & 0x20;
        local_ed8 = param_2 & 8;
        local_f08 = param_2 & 0x10;
        local_ee0 = pbVar17;
        local_eb8 = pbVar31;
        local_eb0 = local_ee8;
        local_e50 = puVar21;
        local_e48 = pbVar17;
        local_e40 = pbVar31;
        local_e30 = local_e90;
        local_e10 = puVar21;
        local_df0 = local_e90;
        if (param_3 < puVar1) {
          local_ec8 = 6;
          puVar24 = puVar21;
          local_f58 = param_3;
          local_f30 = pbVar31;
          do {
            uVar13 = *local_f58;
            uVar33 = (ulonglong)uVar13;
            uVar36 = (ulonglong)uVar13;
            if (local_f18 != 0) {
              uVar33 = (ulonglong)
                       (*(int *)(local_f18 + (ulonglong)(uVar13 >> 8) * 4) + (uint)(byte)uVar13);
            }
            puVar23 = (undefined2 *)(lVar34 + uVar33 * 4);
            bVar6 = *(byte *)((longlong)puVar23 + 1);
            if (bVar6 < 0xd) {
              puVar21 = puVar24;
              switch(bVar6) {
              case 0:
                if (((uVar13 == 0xdb40) && (puVar27 = local_f58 + 1, puVar27 < puVar1)) &&
                   ((ushort)(*puVar27 + 0x2300) < 0xf0)) {
                  local_f58 = puVar27;
                }
                break;
              case 1:
                if (local_ee0 < pbVar17) {
                  if (uVar8 == 0) {
                    bVar6 = *(byte *)(puVar23 + 1);
                  }
                  else {
                    bVar6 = 2;
                  }
                  pbVar17[-1] = pbVar17[-1] + bVar6;
                  lVar34 = DAT_1800b2b88;
                }
                else {
                  if (uVar8 == 0) {
                    bVar6 = *(byte *)(puVar23 + 1);
                  }
                  else {
                    bVar6 = 2;
                  }
                  *pbVar17 = bVar6;
                  pbVar17 = pbVar17 + 1;
                  lVar34 = DAT_1800b2b88;
                }
                break;
              case 2:
                while (bVar6 == 2) {
                  uVar13 = *(ushort *)(local_ea0 + (ulonglong)(ushort)puVar23[1] * 4);
                  uVar33 = (ulonglong)uVar13;
                  if (local_f18 != 0) {
                    uVar33 = (ulonglong)
                             (*(int *)(local_f18 + (ulonglong)(uVar13 >> 8) * 4) +
                             (uint)(byte)uVar13);
                  }
                  puVar21 = (undefined2 *)(lVar34 + uVar33 * 4);
                  uVar2 = *puVar21;
                  *(char *)((longlong)puVar24 + 1) = (char)uVar2;
                  *(char *)puVar24 = (char)((ushort)uVar2 >> 8);
                  puVar24 = puVar24 + 1;
                  if ((uVar8 == 0) ||
                     ((0x14 < *(byte *)((longlong)puVar21 + 1) &&
                      (*(byte *)((longlong)puVar21 + 1) != 0x29)))) {
                    bVar6 = *(byte *)(puVar21 + 1);
                  }
                  else {
                    bVar6 = 2;
                  }
                  *pbVar17 = bVar6;
                  if ((local_f08 == 0) ||
                     ((0x14 < *(byte *)((longlong)puVar21 + 1) &&
                      (*(byte *)((longlong)puVar21 + 1) != 0x29)))) {
                    bVar6 = *(byte *)((longlong)puVar21 + 3) & 0x3f;
                  }
                  else {
                    bVar6 = 2;
                  }
                  pbVar17 = pbVar17 + 1;
                  *pbVar31 = bVar6 & local_f68;
                  pbVar31 = pbVar31 + 1;
                  uVar13 = *(ushort *)(local_ea0 + 2 + (ulonglong)(ushort)puVar23[1] * 4);
                  uVar33 = (ulonglong)uVar13;
                  if (local_f18 != 0) {
                    uVar33 = (ulonglong)
                             (*(int *)(local_f18 + (ulonglong)(uVar13 >> 8) * 4) +
                             (uint)(byte)uVar13);
                  }
                  puVar23 = (undefined2 *)(DAT_1800b2b88 + uVar33 * 4);
                  param_3 = local_ec0;
                  lVar34 = DAT_1800b2b88;
                  bVar6 = *(byte *)((longlong)puVar23 + 1);
                }
                uVar2 = *puVar23;
                *(char *)((longlong)puVar24 + 1) = (char)uVar2;
                *(char *)puVar24 = (char)((ushort)uVar2 >> 8);
                if ((uVar8 == 0) ||
                   ((0x14 < *(byte *)((longlong)puVar23 + 1) &&
                    (*(byte *)((longlong)puVar23 + 1) != 0x29)))) {
                  bVar6 = *(byte *)(puVar23 + 1);
                }
                else {
                  bVar6 = 2;
                }
                *pbVar17 = bVar6;
                if ((local_f08 == 0) ||
                   ((0x14 < *(byte *)((longlong)puVar23 + 1) &&
                    (*(byte *)((longlong)puVar23 + 1) != 0x29)))) {
                  bVar6 = *(byte *)((longlong)puVar23 + 3) & 0x3f;
                }
                else {
                  bVar6 = 2;
                }
                pbVar17 = pbVar17 + 1;
                *pbVar31 = bVar6 & local_f68;
                pbVar31 = pbVar31 + 1;
                puVar21 = puVar24 + 1;
                lVar34 = DAT_1800b2b88;
                local_f30 = pbVar31;
                local_e10 = puVar24 + 1;
                break;
              case 3:
                bVar6 = *(byte *)puVar23;
                bVar25 = *(byte *)((longlong)puVar23 + 3) & local_f68;
                puVar27 = local_f58;
                if (bVar6 < 2) {
                  do {
                    while( true ) {
                      puVar27 = puVar27 + -1;
                      uVar13 = 0xffff;
                      if (puVar27 < param_3) goto LAB_180001ecf;
                      uVar32 = *puVar27;
                      if (local_f18 == 0) {
                        uVar15 = *(undefined4 *)(lVar34 + (ulonglong)uVar32 * 4);
                      }
                      else {
                        uVar15 = *(undefined4 *)
                                  (lVar34 + (ulonglong)
                                            (*(int *)(local_f18 + (ulonglong)(uVar32 >> 8) * 4) +
                                            (uint)(byte)uVar32) * 4);
                      }
                      bVar29 = (byte)((uint)uVar15 >> 8);
                      if (bVar29 < 3) break;
                      uVar13 = (ushort)uVar15;
                      pbVar31 = local_f30;
                      if (bVar29 != 3) goto LAB_180001ecf;
                      if (1 < (byte)uVar15) {
                        bVar29 = (byte)((uint)uVar15 >> 0x18) & local_f68;
                        uVar32 = uVar13 & 0xff;
                        *local_ee8 = bVar29 & 0xc6 | 0xc4;
                        local_ee8[local_f10 * 2] = bVar29 & 0xe4 | 0xc4;
                        if (bVar6 == 0) {
                          local_ee8[local_f10] = 4;
                          local_ee8[local_f10 * 3] = bVar29 & 0xc5 | 0xc4;
                        }
                        else {
                          local_ee8[local_f10] = 5;
                          uVar32 = uVar13 & 0x87;
                          local_ee8[local_f10 * 3] = bVar25 & 0xc5 | 0xc4;
                        }
                        local_ee8 = local_ee8 + 1;
                        uVar13 = uVar32 | 0x2200;
                        goto LAB_180001ecf;
                      }
                    }
                    pbVar31 = local_f30;
                  } while (bVar29 != 2);
                }
                else {
                  *local_ee8 = bVar25 & 0xc6 | 0xc4;
                  local_ee8[local_f10] = 3;
                  local_ee8[local_f10 * 2] = bVar25 & 0xe4 | 0xc4;
                  local_ee8[local_f10 * 3] = bVar25 & 0xc5 | 0xc4;
                  local_ee8 = local_ee8 + 1;
                  uVar13 = bVar6 | 0x2200;
                }
LAB_180001ecf:
                if ((uVar8 == 0) ||
                   ((0x14 < *(byte *)((longlong)puVar23 + 1) &&
                    (*(byte *)((longlong)puVar23 + 1) != 0x29)))) {
                  bVar6 = *(byte *)(puVar23 + 1);
                }
                else {
                  bVar6 = 2;
                }
                *pbVar17 = bVar6;
                *pbVar31 = 2;
                cVar7 = (char)(uVar13 >> 8);
                *(char *)puVar24 = cVar7;
                *(char *)((longlong)puVar24 + 1) = (char)uVar13;
                local_e10 = puVar24 + 1;
                if (((byte)(cVar7 + 0x57U) < 7) ||
                   ((local_ef4 != 0 && ((byte)(cVar7 + 0x40U) < 0x30)))) {
                  if (local_f58 + -1 < param_3) {
                    *(undefined *)local_e10 = 0;
                  }
                  else {
                    uVar32 = local_f58[-1];
                    uVar33 = (ulonglong)uVar32;
                    if (local_f18 != 0) {
                      uVar33 = (ulonglong)
                               (*(int *)(local_f18 + (ulonglong)(uVar32 >> 8) * 4) + (uVar32 & 0xff)
                               );
                    }
                    *(undefined *)local_e10 = *(undefined *)(DAT_1800b2b88 + uVar33 * 4 + 2);
                  }
                  local_e10 = (undefined2 *)((longlong)puVar24 + 3);
                }
                puVar21 = local_e10;
                lVar11 = param_1;
                lVar34 = DAT_1800b2b88;
                if (uVar13 != 0xffff) {
LAB_180001f31:
                  pbVar17 = pbVar17 + 1;
                  pbVar31 = pbVar31 + 1;
                  puVar21 = local_e10;
                  lVar11 = param_1;
                  lVar34 = DAT_1800b2b88;
                  local_f30 = pbVar31;
                }
                break;
              case 4:
                uVar33 = FUN_180057c10(local_f18,local_f58,puVar1,local_ef8,&local_f0c);
                if ((int)uVar33 < 1) {
                  bVar6 = *(byte *)puVar23;
                  *(byte *)((longlong)puVar24 + 1) = *(byte *)(puVar23 + 1);
                  *(byte *)puVar24 = bVar6;
                  local_e10 = puVar24 + 1;
                  *pbVar17 = 2;
                  *local_f30 = *(byte *)((longlong)puVar23 + 3) & 0x3f;
                  pbVar31 = local_f30;
                  goto LAB_180001f31;
                }
                *(char *)puVar24 = (char)((ushort)local_ef8[0] >> 8);
                *(char *)((longlong)puVar24 + 1) = (char)local_ef8[0];
                *(undefined *)((longlong)puVar24 + 7) = local_f0a;
                *(byte *)((longlong)puVar24 + 3) = local_f0c;
                *(undefined *)(puVar24 + 1) = 0xff;
                *(undefined *)(puVar24 + 2) = 0xff;
                *(undefined *)(puVar24 + 3) = 0xff;
                *(undefined *)((longlong)puVar24 + 5) = local_f0b;
                *pbVar17 = 2;
                pbVar17 = pbVar17 + 1;
                *local_f30 = 2;
                pbVar31 = local_f30 + 1;
                local_f58 = local_f58 + ((int)uVar33 + -1);
                puVar21 = puVar24 + 4;
                lVar11 = param_1;
                lVar34 = DAT_1800b2b88;
                local_f30 = pbVar31;
                local_e10 = puVar24 + 4;
                break;
              case 5:
                *puVar24 = 0xfffd;
                bVar6 = *(byte *)puVar23;
                *(byte *)((longlong)puVar24 + 3) = *(byte *)(puVar23 + 1);
                *(byte *)(puVar24 + 1) = bVar6;
                *pbVar17 = 2;
                pbVar17 = pbVar17 + 1;
                *pbVar31 = 2;
                pbVar31 = pbVar31 + 1;
                puVar21 = puVar24 + 2;
                lVar34 = DAT_1800b2b88;
                local_f30 = pbVar31;
                local_e10 = puVar24 + 2;
                break;
              case 6:
                if (local_ed4 != 0) goto switchD_1800019e7_caseD_8;
                uVar13 = ~(ushort)((ulonglong)((longlong)puVar24 - (longlong)local_e50) >> 1);
                uVar32 = 2;
                if (uVar13 < 2) {
                  uVar13 = uVar32;
                }
                local_df0[1] = (byte)uVar13;
                *local_df0 = (byte)(uVar13 >> 8);
                if ((uVar8 == 0) ||
                   ((uVar13 = uVar32, 0x14 < *(byte *)((longlong)puVar23 + 1) &&
                    (*(byte *)((longlong)puVar23 + 1) != 0x29)))) {
                  uVar13 = (ushort)*(byte *)(puVar23 + 1);
                }
                if ((local_f08 == 0) ||
                   ((0x14 < *(byte *)((longlong)puVar23 + 1) &&
                    (*(byte *)((longlong)puVar23 + 1) != 0x29)))) {
                  uVar32 = (ushort)(*(byte *)((longlong)puVar23 + 3) & 0x3f);
                }
                sVar26 = (ushort)*(byte *)puVar23 * 0x100 + (local_f68 & uVar32 | uVar13 << 3);
                local_df0[3] = (byte)sVar26;
                local_df0[2] = (byte)((ushort)sVar26 >> 8);
                local_df0 = local_df0 + 4;
                lVar34 = DAT_1800b2b88;
                break;
              case 7:
                break;
              default:
switchD_1800019e7_caseD_8:
                if (local_ef0 == 0) {
                  uVar2 = *puVar23;
                  *(char *)((longlong)puVar24 + 1) = (char)uVar2;
                  *(char *)puVar24 = (char)((ushort)uVar2 >> 8);
                  *pbVar17 = *(byte *)(puVar23 + 1);
                  bVar6 = *(byte *)((longlong)puVar23 + 3) & local_f68 & 0x3f;
                  goto LAB_1800019a5;
                }
              }
            }
            else {
              lVar4 = *(longlong *)(lVar11 + 0x150);
              if (lVar4 != 0) {
                bVar6 = *(byte *)((longlong)puVar23 + 3) & 0xc0;
                local_f38 = 0;
                local_f50 = 0;
                if (0x3f < bVar6) {
                  if (bVar6 != 0x40) {
                    if (bVar6 != 0x80) {
                      if (bVar6 != 0xc0) goto LAB_180001e3e;
                      uVar18 = *(uint *)(lVar11 + 0x140) & 0x20;
                      if (*(short *)(lVar4 + 0x14) != 0) {
                        lVar11 = 0x10;
                        if (uVar18 == 0) {
                          lVar11 = 0xe;
                        }
                        if ((ushort *)(lVar11 + (longlong)local_f58) <= puVar1) {
                          uVar33 = FUN_1800026d4(local_f58,puVar1,8,*(ushort *)(lVar4 + 4),
                                                 *(ushort *)(lVar4 + 6),uVar18,0);
                          local_f50 = (int)uVar33;
                          if (7 < local_f50) {
                            iVar30 = *(ushort *)(lVar4 + 0x14) - 1;
                            local_f64 = 0;
                            lVar11 = 0;
                            if ((uVar18 != 0) && (local_f58 + 8 < puVar1)) {
                              if (local_f18 == 0) {
                                uVar19 = *(uint *)(lVar34 + uVar36 * 4);
                                uVar16 = *(uint *)(lVar34 + (ulonglong)local_f58[1] * 4);
                              }
                              else {
                                uVar19 = *(uint *)(lVar34 + (ulonglong)
                                                            (*(int *)(local_f18 +
                                                                     (ulonglong)(uVar13 >> 8) * 4) +
                                                            (uint)(byte)uVar13) * 4);
                                uVar16 = *(uint *)(lVar34 + (ulonglong)
                                                            (*(int *)(local_f18 +
                                                                     (ulonglong)(local_f58[1] >> 8)
                                                                     * 4) + (uint)(byte)local_f58[1]
                                                            ) * 4);
                              }
                              lVar11 = 0;
                              if (((uVar16 ^ uVar19) & 0xe7ffffff) == 0) {
                                lVar11 = 1;
                              }
                            }
                            if (-1 < iVar30) {
                              puVar27 = local_f58 + lVar11;
                              do {
                                iVar22 = (iVar30 + local_f64) / 2;
                                iVar10 = iVar22 * 10;
                                iVar14 = FUN_1800026a4((longlong)puVar27,
                                                       (ushort *)
                                                       (*(longlong *)(param_1 + 0x188) +
                                                       (longlong)iVar10 * 2),8);
                                if (iVar14 == 0) {
                                  local_f38 = (int)lVar11;
                                  puVar23 = (undefined2 *)
                                            (*(longlong *)(param_1 + 0x188) + -4 +
                                            (longlong)(iVar10 + 10) * 2);
                                  local_f58 = local_f58 + (local_f38 + 7);
                                  goto LAB_180001e3e;
                                }
                                iVar10 = iVar22 + -1;
                                if (-1 < iVar14) {
                                  local_f64 = iVar22 + 1;
                                  iVar10 = iVar30;
                                }
                                iVar30 = iVar10;
                              } while (local_f64 <= iVar30);
                            }
                          }
                        }
                      }
                      uVar32 = *(ushort *)(lVar4 + 0x12);
                      lVar11 = *(longlong *)(param_1 + 0x180);
                      if (uVar32 != 0) {
                        lVar12 = 0xe;
                        if (uVar18 == 0) {
                          lVar12 = 0xc;
                        }
                        if ((ushort *)(lVar12 + (longlong)local_f58) <= puVar1) {
                          if (local_f50 == 0) {
                            uVar33 = FUN_1800026d4(local_f58,puVar1,7,*(ushort *)(lVar4 + 4),
                                                   *(ushort *)(lVar4 + 6),uVar18,0);
                            local_f50 = (int)uVar33;
                          }
                          if (6 < local_f50) {
                            iVar30 = uVar32 - 1;
                            local_f64 = 0;
                            lVar12 = 0;
                            if ((uVar18 != 0) && (local_f58 + 7 < puVar1)) {
                              if (local_f18 == 0) {
                                uVar19 = *(uint *)(lVar34 + uVar36 * 4);
                                uVar16 = *(uint *)(lVar34 + (ulonglong)local_f58[1] * 4);
                              }
                              else {
                                uVar19 = *(uint *)(lVar34 + (ulonglong)
                                                            (*(int *)(local_f18 +
                                                                     (ulonglong)(uVar13 >> 8) * 4) +
                                                            (uint)(byte)*local_f58) * 4);
                                uVar16 = *(uint *)(lVar34 + (ulonglong)
                                                            (*(int *)(local_f18 +
                                                                     (ulonglong)(local_f58[1] >> 8)
                                                                     * 4) + (uint)(byte)local_f58[1]
                                                            ) * 4);
                              }
                              lVar12 = 0;
                              if (((uVar19 ^ uVar16) & 0xe7ffffff) == 0) {
                                lVar12 = 1;
                              }
                            }
                            if (-1 < iVar30) {
                              local_f00 = local_f58 + lVar12;
                              do {
                                iVar22 = (iVar30 + local_f64) / 2;
                                iVar10 = iVar22 * 10;
                                iVar14 = FUN_1800026a4((longlong)local_f00,
                                                       (ushort *)(lVar11 + (longlong)iVar10 * 2),7);
                                if (iVar14 == 0) {
                                  local_f38 = (int)lVar12;
                                  puVar23 = (undefined2 *)
                                            (lVar11 + -4 + (longlong)(iVar10 + 10) * 2);
                                  local_f58 = local_f58 + (local_f38 + 6);
                                  goto LAB_180001e3e;
                                }
                                iVar10 = iVar22 + -1;
                                if (-1 < iVar14) {
                                  local_f64 = iVar22 + 1;
                                  iVar10 = iVar30;
                                }
                                iVar30 = iVar10;
                              } while (local_f64 <= iVar30);
                            }
                          }
                        }
                      }
                      uVar32 = *(ushort *)(lVar4 + 0x10);
                      lVar11 = *(longlong *)(param_1 + 0x178);
                      if (uVar32 != 0) {
                        lVar12 = 0xc;
                        if (uVar18 == 0) {
                          lVar12 = 10;
                        }
                        if ((ushort *)(lVar12 + (longlong)local_f58) <= puVar1) {
                          if (local_f50 == 0) {
                            uVar33 = FUN_1800026d4(local_f58,puVar1,6,*(ushort *)(lVar4 + 4),
                                                   *(ushort *)(lVar4 + 6),uVar18,0);
                            local_f50 = (int)uVar33;
                          }
                          if (5 < local_f50) {
                            iVar30 = uVar32 - 1;
                            local_f64 = 0;
                            lVar12 = 0;
                            if ((uVar18 != 0) && (local_f58 + 6 < puVar1)) {
                              if (local_f18 == 0) {
                                uVar18 = *(uint *)(lVar34 + uVar36 * 4);
                                uVar19 = *(uint *)(lVar34 + (ulonglong)local_f58[1] * 4);
                              }
                              else {
                                uVar18 = *(uint *)(lVar34 + (ulonglong)
                                                            (*(int *)(local_f18 +
                                                                     (ulonglong)(uVar13 >> 8) * 4) +
                                                            (uint)(byte)*local_f58) * 4);
                                uVar19 = *(uint *)(lVar34 + (ulonglong)
                                                            (*(int *)(local_f18 +
                                                                     (ulonglong)(local_f58[1] >> 8)
                                                                     * 4) + (uint)(byte)local_f58[1]
                                                            ) * 4);
                              }
                              lVar12 = 0;
                              if (((uVar19 ^ uVar18) & 0xe7ffffff) == 0) {
                                lVar12 = 1;
                              }
                            }
                            if (-1 < iVar30) {
                              local_f00 = local_f58 + lVar12;
                              do {
                                iVar22 = (iVar30 + local_f64) / 2;
                                iVar10 = iVar22 * 8;
                                iVar14 = FUN_1800026a4((longlong)local_f00,
                                                       (ushort *)(lVar11 + (longlong)iVar10 * 2),6);
                                if (iVar14 == 0) {
                                  local_f38 = (int)lVar12;
                                  puVar23 = (undefined2 *)(lVar11 + -4 + (longlong)(iVar10 + 8) * 2)
                                  ;
                                  local_f58 = local_f58 + (local_f38 + 5);
                                  goto LAB_180001e3e;
                                }
                                iVar10 = iVar22 + -1;
                                if (-1 < iVar14) {
                                  local_f64 = iVar22 + 1;
                                  iVar10 = iVar30;
                                }
                                iVar30 = iVar10;
                              } while (local_f64 <= iVar10);
                            }
                          }
                        }
                      }
                    }
                    uVar32 = *(ushort *)(lVar4 + 0xe);
                    lVar11 = *(longlong *)(param_1 + 0x170);
                    uVar18 = *(uint *)(param_1 + 0x140) & 0x20;
                    if (uVar32 != 0) {
                      lVar12 = 10;
                      if (uVar18 == 0) {
                        lVar12 = local_ea8;
                      }
                      if ((ushort *)(lVar12 + (longlong)local_f58) <= puVar1) {
                        if (local_f50 == 0) {
                          uVar33 = FUN_1800026d4(local_f58,puVar1,5,*(ushort *)(lVar4 + 4),
                                                 *(ushort *)(lVar4 + 6),uVar18,0);
                          local_f50 = (int)uVar33;
                        }
                        if (4 < local_f50) {
                          local_f64 = 0;
                          iVar30 = uVar32 - 1;
                          lVar12 = 0;
                          if ((uVar18 != 0) && (lVar12 = 0, local_f58 + 5 < puVar1)) {
                            if (local_f18 == 0) {
                              uVar19 = *(uint *)(lVar34 + uVar36 * 4);
                              uVar16 = *(uint *)(lVar34 + (ulonglong)local_f58[1] * 4);
                            }
                            else {
                              uVar19 = *(uint *)(lVar34 + (ulonglong)
                                                          (*(int *)(local_f18 +
                                                                   (ulonglong)(uVar13 >> 8) * 4) +
                                                          (uint)(byte)*local_f58) * 4);
                              uVar16 = *(uint *)(lVar34 + (ulonglong)
                                                          (*(int *)(local_f18 +
                                                                   (ulonglong)(local_f58[1] >> 8) *
                                                                   4) + (uint)(byte)local_f58[1]) *
                                                          4);
                            }
                            lVar12 = 0;
                            if (((uVar16 ^ uVar19) & 0xe7ffffff) == 0) {
                              lVar12 = 1;
                            }
                          }
                          if (-1 < iVar30) {
                            local_f00 = local_f58 + lVar12;
                            do {
                              iVar22 = (iVar30 + local_f64) / 2;
                              iVar10 = iVar22 * 8;
                              iVar14 = FUN_1800026a4((longlong)local_f00,
                                                     (ushort *)(lVar11 + (longlong)iVar10 * 2),5);
                              if (iVar14 == 0) {
                                local_f38 = (int)lVar12;
                                puVar23 = (undefined2 *)(lVar11 + -4 + (longlong)(iVar10 + 8) * 2);
                                local_f58 = local_f58 + (local_f38 + 4);
                                goto LAB_180001e3e;
                              }
                              iVar10 = iVar22 + -1;
                              if (-1 < iVar14) {
                                local_f64 = iVar22 + 1;
                                iVar10 = iVar30;
                              }
                              iVar30 = iVar10;
                            } while (local_f64 <= iVar30);
                          }
                        }
                      }
                    }
                    uVar32 = *(ushort *)(lVar4 + 0xc);
                    lVar11 = *(longlong *)(param_1 + 0x168);
                    if (uVar32 != 0) {
                      lVar12 = 8;
                      if (uVar18 == 0) {
                        lVar12 = local_ec8;
                      }
                      if ((ushort *)(lVar12 + (longlong)local_f58) <= puVar1) {
                        if (local_f50 == 0) {
                          uVar33 = FUN_1800026d4(local_f58,puVar1,4,*(ushort *)(lVar4 + 4),
                                                 *(ushort *)(lVar4 + 6),uVar18,0);
                          local_f50 = (int)uVar33;
                        }
                        lVar12 = 0;
                        if (3 < local_f50) {
                          local_f64 = 0;
                          iVar30 = uVar32 - 1;
                          if ((uVar18 != 0) && (local_f58 + 4 < puVar1)) {
                            if (local_f18 == 0) {
                              uVar18 = *(uint *)(lVar34 + uVar36 * 4);
                              uVar19 = *(uint *)(lVar34 + (ulonglong)local_f58[1] * 4);
                            }
                            else {
                              uVar18 = *(uint *)(lVar34 + (ulonglong)
                                                          (*(int *)(local_f18 +
                                                                   (ulonglong)(uVar13 >> 8) * 4) +
                                                          (uint)(byte)*local_f58) * 4);
                              uVar19 = *(uint *)(lVar34 + (ulonglong)
                                                          (*(int *)(local_f18 +
                                                                   (ulonglong)(local_f58[1] >> 8) *
                                                                   4) + (uint)(byte)local_f58[1]) *
                                                          4);
                            }
                            lVar12 = 0;
                            if (((uVar19 ^ uVar18) & 0xe7ffffff) == 0) {
                              lVar12 = 1;
                            }
                          }
                          if (-1 < iVar30) {
                            local_f00 = local_f58 + lVar12;
                            do {
                              iVar22 = (iVar30 + local_f64) / 2;
                              iVar10 = iVar22 * 6;
                              iVar14 = FUN_1800026a4((longlong)local_f00,
                                                     (ushort *)(lVar11 + (longlong)iVar10 * 2),4);
                              if (iVar14 == 0) {
                                local_f38 = (int)lVar12;
                                puVar23 = (undefined2 *)(lVar11 + -4 + (longlong)(iVar10 + 6) * 2);
                                local_f58 = local_f58 + (local_f38 + 3);
                                goto LAB_180001e3e;
                              }
                              iVar10 = iVar22 + -1;
                              if (-1 < iVar14) {
                                local_f64 = iVar22 + 1;
                                iVar10 = iVar30;
                              }
                              iVar30 = iVar10;
                            } while (local_f64 <= iVar30);
                          }
                        }
                      }
                    }
                  }
                  uVar32 = *(ushort *)(lVar4 + 10);
                  lVar11 = *(longlong *)(param_1 + 0x160);
                  uVar18 = *(uint *)(param_1 + 0x140) & 0x20;
                  if (uVar32 != 0) {
                    lVar12 = 4;
                    if (uVar18 != 0) {
                      lVar12 = local_ec8;
                    }
                    if ((ushort *)(lVar12 + (longlong)local_f58) <= puVar1) {
                      if (local_f50 == 0) {
                        uVar33 = FUN_1800026d4(local_f58,puVar1,3,*(ushort *)(lVar4 + 4),
                                               *(ushort *)(lVar4 + 6),uVar18,0);
                        local_f50 = (int)uVar33;
                      }
                      uVar33 = 0;
                      if (2 < local_f50) {
                        local_f64 = 0;
                        iVar30 = uVar32 - 1;
                        if ((uVar18 != 0) && (local_f58 + 3 < puVar1)) {
                          if (local_f18 == 0) {
                            uVar19 = *(uint *)(lVar34 + uVar36 * 4);
                            uVar16 = *(uint *)(lVar34 + (ulonglong)local_f58[1] * 4);
                          }
                          else {
                            uVar19 = *(uint *)(lVar34 + (ulonglong)
                                                        (*(int *)(local_f18 +
                                                                 (ulonglong)(uVar13 >> 8) * 4) +
                                                        (uint)(byte)*local_f58) * 4);
                            uVar16 = *(uint *)(lVar34 + (ulonglong)
                                                        (*(int *)(local_f18 +
                                                                 (ulonglong)(local_f58[1] >> 8) * 4)
                                                        + (uint)(byte)local_f58[1]) * 4);
                          }
                          uVar33 = (ulonglong)(((uVar16 ^ uVar19) & 0xe7ffffff) == 0);
                        }
                        if (-1 < iVar30) {
                          local_f00 = local_f58 + uVar33;
                          do {
                            iVar22 = (iVar30 + local_f64) / 2;
                            iVar10 = iVar22 * 6;
                            iVar14 = FUN_1800026a4((longlong)local_f00,
                                                   (ushort *)(lVar11 + (longlong)iVar10 * 2),3);
                            if (iVar14 == 0) {
                              local_f38 = (int)uVar33;
                              bVar6 = *(byte *)(lVar11 + -3 + (longlong)(iVar10 + 6) * 2);
                              puVar23 = (undefined2 *)(lVar11 + -4 + (longlong)(iVar10 + 6) * 2);
                              local_f58 = local_f58 + (local_f38 + 2);
                              goto LAB_1800015ad;
                            }
                            iVar10 = iVar22 + -1;
                            if (-1 < iVar14) {
                              local_f64 = iVar22 + 1;
                              iVar10 = iVar30;
                            }
                            iVar30 = iVar10;
                          } while (local_f64 <= iVar30);
                        }
                      }
                    }
                  }
                  uVar32 = *(ushort *)(lVar4 + 8);
                  lVar11 = *(longlong *)(param_1 + 0x158);
                  if (uVar32 != 0) {
                    lVar12 = 2;
                    if (uVar18 != 0) {
                      lVar12 = 4;
                    }
                    if ((ushort *)(lVar12 + (longlong)local_f58) <= puVar1) {
                      if (local_f50 == 0) {
                        uVar33 = FUN_1800026d4(local_f58,puVar1,2,*(ushort *)(lVar4 + 4),
                                               *(ushort *)(lVar4 + 6),uVar18,0);
                        local_f50 = (int)uVar33;
                      }
                      if (1 < local_f50) {
                        iVar30 = uVar32 - 1;
                        uVar33 = 0;
                        local_f64 = 0;
                        if ((uVar18 != 0) && (local_f58 + 2 < puVar1)) {
                          if (local_f18 == 0) {
                            uVar18 = *(uint *)(lVar34 + uVar36 * 4);
                            uVar19 = *(uint *)(lVar34 + (ulonglong)local_f58[1] * 4);
                          }
                          else {
                            uVar18 = *(uint *)(lVar34 + (ulonglong)
                                                        (*(int *)(local_f18 +
                                                                 (ulonglong)(uVar13 >> 8) * 4) +
                                                        (uint)(byte)*local_f58) * 4);
                            uVar19 = *(uint *)(lVar34 + (ulonglong)
                                                        (*(int *)(local_f18 +
                                                                 (ulonglong)(local_f58[1] >> 8) * 4)
                                                        + (uint)(byte)local_f58[1]) * 4);
                          }
                          uVar33 = (ulonglong)(((uVar19 ^ uVar18) & 0xe7ffffff) == 0);
                        }
                        if (-1 < iVar30) {
                          puVar27 = local_f58 + uVar33;
                          do {
                            iVar10 = (iVar30 + local_f64) / 2;
                            iVar22 = FUN_1800026a4((longlong)puVar27,
                                                   (ushort *)(lVar11 + (longlong)(iVar10 * 4) * 2),2
                                                  );
                            if (iVar22 == 0) {
                              local_f38 = (int)uVar33;
                              puVar23 = (undefined2 *)(lVar11 + -4 + (longlong)(iVar10 * 4 + 4) * 2)
                              ;
                              local_f58 = local_f58 + (local_f38 + 1);
                              goto LAB_180001e3e;
                            }
                            iVar14 = iVar10 + -1;
                            if (-1 < iVar22) {
                              iVar14 = iVar30;
                            }
                            if (-1 < iVar22) {
                              local_f64 = iVar10 + 1;
                            }
                            iVar30 = iVar14;
                          } while (local_f64 <= iVar14);
                          bVar6 = *(byte *)((longlong)puVar23 + 1);
                          goto LAB_1800015ad;
                        }
                      }
                    }
                  }
                }
LAB_180001e3e:
                bVar6 = *(byte *)((longlong)puVar23 + 1);
              }
LAB_1800015ad:
              lVar34 = DAT_1800b2b88;
              if ((local_ed8 != 0) && (bVar6 == 0xd)) {
                puVar35 = &DAT_180085130;
                uVar32 = 0;
                iVar22 = 0;
                uVar13 = *local_f58;
                iVar30 = 0x37;
                iVar10 = 0;
                if (((ushort)(uVar13 + 0x2400) < 0x400) && (param_3 < local_f58)) {
                  if (local_f58[-1] != 0xd835) goto LAB_1800015bb;
                  puVar35 = &DAT_180086580;
                  iVar30 = 9;
                }
                do {
                  iVar14 = iVar30 + iVar10 >> 1;
                  uVar3 = *(ushort *)(puVar35 + (longlong)iVar14 * 2);
                  if (uVar13 == uVar3) break;
                  iVar9 = iVar14 + -1;
                  if (uVar3 <= uVar13) {
                    iVar9 = iVar30;
                  }
                  if (uVar3 <= uVar13) {
                    iVar10 = iVar14 + 1;
                  }
                  iVar30 = iVar9;
                } while (iVar10 <= iVar9);
                uVar3 = *(ushort *)(puVar35 + ((longlong)iVar14 & 0xfffffffffffffffeU) * 2);
                if (((uVar3 <= uVar13) &&
                    (uVar13 <= *(ushort *)
                                (puVar35 + ((longlong)iVar14 & 0xfffffffffffffffeU) * 2 + 2))) &&
                   (uVar3 != 0)) {
                  if ((0xdbff < uVar3) && (uVar3 < 0xe000)) {
                    uVar32 = 0xd835;
                  }
                  while (*local_f58 == uVar3) {
                    puVar27 = local_f58 + 1;
                    iVar22 = iVar22 + 1;
                    if (uVar32 != 0) {
                      if ((puVar1 <= puVar27) || (*puVar27 != uVar32)) {
                        local_f58 = local_f58 + 2;
                        break;
                      }
                      puVar27 = local_f58 + 2;
                    }
                    local_f58 = puVar27;
                    if ((puVar1 <= puVar27) || (0x12 < iVar22)) break;
                  }
                  uVar18 = 0;
                  if ((local_f58 < puVar1) && (puVar27 = local_f58, iVar30 = iVar22, iVar22 < 0x13))
                  {
                    do {
                      if ((*puVar27 < uVar3) || ((int)(uint)uVar3 < (int)(*puVar27 - 9))) break;
                      uVar18 = uVar18 + 1;
                      iVar30 = iVar30 + 1;
                      puVar28 = puVar27 + 1;
                      if (uVar32 != 0) {
                        if ((puVar1 <= puVar28) || (*puVar28 != uVar32)) break;
                        puVar28 = puVar27 + 2;
                      }
                      if ((puVar1 <= puVar28) || (puVar27 = puVar28, 0x12 < iVar30)) break;
                    } while( true );
                  }
                  *puVar24 = 0x20d;
                  *(char *)(puVar24 + 1) = (char)uVar18 + '\x02';
                  pbVar20 = (byte *)((longlong)puVar24 + 3);
                  *pbVar17 = *(byte *)(puVar23 + 1);
                  pbVar17 = pbVar17 + 1;
                  *local_f30 = *(byte *)((longlong)puVar23 + 3) & local_f68 & 0x3f;
                  pbVar31 = local_f30 + 1;
                  puVar27 = local_f58;
                  if ((uVar18 & 1) != 0) {
                    *pbVar20 = 0x20;
                  }
                  for (; 0 < (int)uVar18; uVar18 = uVar18 - 1) {
                    bVar6 = (*(char *)puVar27 - (char)uVar3) + 2;
                    if ((uVar18 & 1) == 0) {
                      *pbVar20 = bVar6 * '\x10';
                    }
                    else {
                      *pbVar20 = *pbVar20 | bVar6;
                      pbVar20 = pbVar20 + 1;
                    }
                    puVar28 = puVar27 + 1;
                    if (uVar32 != 0) {
                      puVar28 = puVar27 + 2;
                    }
                    puVar27 = puVar28;
                  }
                  *pbVar20 = -(char)iVar22 - 2;
                  local_f58 = puVar27 + -1;
                  puVar21 = (undefined2 *)(pbVar20 + 1);
                  lVar11 = param_1;
                  local_f30 = pbVar31;
                  local_e10 = puVar21;
                  if (uVar32 != 0) {
                    local_f58 = puVar27 + -2;
                  }
                  goto LAB_18000166f;
                }
              }
LAB_1800015bb:
              uVar2 = *puVar23;
              *(undefined *)((longlong)puVar24 + 1) = (char)uVar2;
              *(char *)puVar24 = (char)((ushort)uVar2 >> 8);
              puVar21 = puVar24 + 1;
              if (((byte)(bVar6 + 0x57) < 7) || ((local_ef4 != 0 && ((byte)(bVar6 + 0x40) < 0x30))))
              {
                *(byte *)puVar21 = *(byte *)(puVar23 + 1);
                puVar21 = (undefined2 *)((longlong)puVar24 + 3);
                lVar11 = 2;
              }
              else {
                if ((uVar8 == 0) ||
                   ((0x14 < *(byte *)((longlong)puVar23 + 1) &&
                    (*(byte *)((longlong)puVar23 + 1) != 0x29)))) {
                  bVar6 = *(byte *)(puVar23 + 1);
                }
                else {
                  bVar6 = 2;
                }
                *pbVar17 = bVar6;
                pbVar17 = pbVar17 + 1;
                lVar11 = 1;
              }
              puVar24 = (undefined2 *)((undefined *)((longlong)puVar24 + 1) + lVar11);
              if ((local_f08 == 0) ||
                 ((0x14 < *(byte *)((longlong)puVar23 + 1) &&
                  (*(byte *)((longlong)puVar23 + 1) != 0x29)))) {
                bVar6 = *(byte *)((longlong)puVar23 + 3) & 0x3f;
              }
              else {
                bVar6 = 2;
              }
              *local_f30 = bVar6 & local_f68;
              pbVar31 = local_f30 + 1;
              lVar11 = param_1;
              local_f30 = pbVar31;
              local_e10 = puVar21;
              if (local_f38 == 0) goto LAB_18000166f;
              uVar2 = *puVar23;
              *(char *)puVar24 = (char)((ushort)uVar2 >> 8);
              *(char *)((longlong)puVar24 + 1) = (char)uVar2;
              if ((uVar8 == 0) ||
                 ((0x14 < *(byte *)((longlong)puVar23 + 1) &&
                  (*(byte *)((longlong)puVar23 + 1) != 0x29)))) {
                bVar6 = *(byte *)(puVar23 + 1);
              }
              else {
                bVar6 = 2;
              }
              *pbVar17 = bVar6;
              if ((local_f08 == 0) ||
                 ((0x14 < *(byte *)((longlong)puVar23 + 1) &&
                  (*(byte *)((longlong)puVar23 + 1) != 0x29)))) {
                bVar6 = *(byte *)((longlong)puVar23 + 3) & 0x3f;
              }
              else {
                bVar6 = 2;
              }
              bVar6 = bVar6 & local_f68;
LAB_1800019a5:
              local_e10 = puVar24 + 1;
              pbVar17 = pbVar17 + 1;
              *pbVar31 = bVar6;
              pbVar31 = pbVar31 + 1;
              puVar21 = local_e10;
              lVar34 = DAT_1800b2b88;
              local_f30 = pbVar31;
            }
LAB_18000166f:
            local_f58 = local_f58 + 1;
            param_5 = local_e98;
            puVar24 = puVar21;
            param_2 = local_ed0;
          } while (local_f58 < puVar1);
        }
        if (param_6 == 0) {
          if ((param_2 & 2) == 0) {
            local_e08 = pbVar17 + -1;
            pbVar17 = local_ee0;
            if ((*(byte *)(param_1 + 0x140) & 0x10) == 0) {
              for (; (local_ee0 <= local_e08 && (*local_e08 < 3)); local_e08 = local_e08 + -1) {
              }
            }
            else {
              while ((pbVar17 <= local_e08 && (*pbVar17 < 3))) {
                local_e48 = pbVar17 + 1;
                pbVar17 = local_e48;
              }
            }
          }
          if ((param_2 & 0x20001) != 0x20001) {
            do {
              local_e00 = pbVar31 + -1;
              if (local_e00 < local_eb8) break;
              pbVar31 = local_e00;
            } while (*local_e00 < 3);
          }
          if (local_eb0 < local_ee8) {
            uVar8 = -(uint)((param_2 & 2) != 0) & 2;
            pbVar17 = &DAT_180087600 + uVar8;
            pbVar31 = local_ee8 + -1 + (int)(uVar8 * local_f10);
            uVar33 = (ulonglong)(4 - uVar8);
            do {
              if (pbVar31 + ((longlong)local_eb0 - (longlong)(local_ee8 + -1)) <= pbVar31) {
                pbVar20 = pbVar31;
                do {
                  if (*pbVar20 != *pbVar17) break;
                  pbVar20 = pbVar20 + -1;
                } while (pbVar31 + ((longlong)local_eb0 - (longlong)(local_ee8 + -1)) <= pbVar20);
              }
              pbVar31 = pbVar31 + local_f10;
              pbVar17 = pbVar17 + 1;
              uVar33 = uVar33 - 1;
            } while (uVar33 != 0);
          }
          if ((local_e50 != local_dc8) && (local_e50 != (undefined2 *)0x0)) {
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_e50);
          }
          goto LAB_180001379;
        }
        puVar1 = param_5;
        puVar24 = local_e50;
        if ((longlong)param_6 < (longlong)((longlong)puVar21 + (5 - (longlong)local_e50)))
        goto joined_r0x000180002474;
        for (; puVar24 < puVar21; puVar24 = (undefined2 *)((longlong)puVar24 + 1)) {
          *(undefined *)puVar1 = *(undefined *)puVar24;
          puVar1 = (ushort *)((longlong)puVar1 + 1);
        }
        *(undefined *)puVar1 = 1;
        pbVar20 = (byte *)((longlong)puVar1 + 1);
        if ((param_2 & 2) == 0) {
          pbVar17 = pbVar17 + -1;
          pbVar5 = local_ee0;
          if ((*(byte *)(lVar11 + 0x140) & 0x10) == 0) {
            for (; (local_ee0 <= pbVar17 && (*pbVar17 < 3)); pbVar17 = pbVar17 + -1) {
            }
            if ((longlong)(pbVar17 + (4 - (longlong)local_ee0)) <
                (longlong)((longlong)param_5 + ((longlong)param_6 - (longlong)pbVar20))) {
              for (; pbVar5 <= pbVar17; pbVar5 = pbVar5 + 1) {
                *pbVar20 = *pbVar5;
                pbVar20 = pbVar20 + 1;
              }
              goto LAB_180001713;
            }
          }
          else {
            for (; (pbVar5 <= pbVar17 && (*pbVar5 < 3)); pbVar5 = pbVar5 + 1) {
            }
            if ((longlong)(pbVar17 + (4 - (longlong)pbVar5)) <
                (longlong)((longlong)param_5 + ((longlong)param_6 - (longlong)pbVar20))) {
              for (; pbVar5 <= pbVar17; pbVar17 = pbVar17 + -1) {
                *pbVar20 = *pbVar17;
                pbVar20 = pbVar20 + 1;
              }
              goto LAB_180001713;
            }
          }
joined_r0x000180002474:
          if ((local_e50 != local_dc8) && (local_e50 != (undefined2 *)0x0)) {
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_e50);
          }
          SetLastError(0x7a);
        }
        else {
LAB_180001713:
          *pbVar20 = 1;
          pbVar20 = pbVar20 + 1;
          if ((param_2 & 0x20001) != 0x20001) {
            do {
              pbVar31 = pbVar31 + -1;
              if (pbVar31 < local_eb8) break;
            } while (*pbVar31 < 3);
            pbVar17 = local_eb8;
            if ((longlong)((longlong)param_5 + ((longlong)param_6 - (longlong)pbVar20)) <=
                (longlong)(pbVar31 + (3 - (longlong)local_eb8))) goto joined_r0x000180002474;
            for (; pbVar17 <= pbVar31; pbVar17 = pbVar17 + 1) {
              *pbVar20 = *pbVar17;
              pbVar20 = pbVar20 + 1;
            }
          }
          *pbVar20 = 1;
          puVar21 = (undefined2 *)(pbVar20 + 1);
          if (local_eb0 < local_ee8) {
            if ((param_2 & 2) == 0) {
              uVar8 = 0;
            }
            else {
              if ((longlong)((longlong)param_5 + ((longlong)param_6 - (longlong)puVar21)) < 5)
              goto joined_r0x000180002474;
              *puVar21 = 0x2ff;
              uVar8 = 2;
              puVar21 = (undefined2 *)(pbVar20 + 3);
            }
            uVar33 = (ulonglong)uVar8;
            iVar30 = uVar8 * local_f10;
            do {
              pbVar31 = local_eb0 + iVar30;
              pbVar17 = local_ee8 + (longlong)iVar30 + -1;
              if (pbVar31 <= pbVar17) {
                do {
                  if (*pbVar17 != (&DAT_180087600)[uVar33]) break;
                  pbVar17 = pbVar17 + -1;
                } while (pbVar31 <= pbVar17);
              }
              if ((longlong)((longlong)param_5 + ((longlong)param_6 - (longlong)puVar21)) <=
                  (longlong)(pbVar17 + (3 - (longlong)pbVar31))) goto joined_r0x000180002474;
              for (; pbVar31 <= pbVar17; pbVar31 = pbVar31 + 1) {
                *(byte *)puVar21 = *pbVar31;
                puVar21 = (undefined2 *)((longlong)puVar21 + 1);
              }
              uVar8 = uVar8 + 1;
              iVar30 = iVar30 + local_f10;
              *(undefined *)puVar21 = (&UNK_1800875fc)[uVar33];
              uVar33 = uVar33 + 1;
              puVar21 = (undefined2 *)((longlong)puVar21 + 1);
            } while ((int)uVar8 < 4);
          }
          *(undefined *)puVar21 = 1;
          pbVar31 = (byte *)((longlong)puVar21 + 1);
          if (local_ef0 == 0) {
            pbVar17 = local_e90;
            if ((longlong)((longlong)param_5 + ((longlong)param_6 - (longlong)pbVar31)) <
                (longlong)(local_df0 + (1 - (longlong)local_e90))) goto joined_r0x000180002474;
            for (; pbVar17 < local_df0; pbVar17 = pbVar17 + 1) {
              *pbVar31 = *pbVar17;
              pbVar31 = pbVar31 + 1;
            }
          }
          *pbVar31 = 0;
          if ((local_e50 != local_dc8) && (local_e50 != (undefined2 *)0x0)) {
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_e50);
          }
        }
        goto LAB_180001379;
      }
      dwErrCode = 2;
    }
    else {
      dwErrCode = 0x3ec;
    }
  }
  SetLastError(dwErrCode);
LAB_180001379:
  __security_check_cookie(local_48 ^ (ulonglong)auStackY4008);
  return;
}



ulonglong FUN_180002600(short *param_1)

{
  short *psVar1;
  short *psVar2;
  
  psVar2 = param_1;
  psVar1 = param_1;
  if (*param_1 != 0) {
    while ((((psVar2 = psVar1 + 1, *psVar2 != 0 && (psVar2 = psVar1 + 2, *psVar2 != 0)) &&
            (psVar2 = psVar1 + 3, *psVar2 != 0)) &&
           (((psVar2 = psVar1 + 4, *psVar2 != 0 && (psVar2 = psVar1 + 5, *psVar2 != 0)) &&
            ((psVar2 = psVar1 + 6, *psVar2 != 0 &&
             ((psVar2 = psVar1 + 7, *psVar2 != 0 && (psVar2 = psVar1 + 8, *psVar2 != 0))))))))) {
      psVar2 = psVar1 + 9;
      if ((*psVar2 == 0) ||
         (((((psVar2 = psVar1 + 10, *psVar2 == 0 || (psVar2 = psVar1 + 0xb, *psVar2 == 0)) ||
            (psVar2 = psVar1 + 0xc, *psVar2 == 0)) ||
           ((psVar2 = psVar1 + 0xd, *psVar2 == 0 || (psVar2 = psVar1 + 0xe, *psVar2 == 0)))) ||
          ((psVar2 = psVar1 + 0xf, *psVar2 == 0 ||
           (psVar2 = psVar1 + 0x10, psVar1 = psVar2, *psVar2 == 0)))))) break;
    }
  }
  return (longlong)psVar2 - (longlong)param_1 >> 1 & 0xffffffff;
}



int FUN_1800026a4(longlong param_1,ushort *param_2,int param_3)

{
  longlong lVar1;
  int iVar2;
  
  if (0 < param_3) {
    lVar1 = param_1 - (longlong)param_2;
    do {
      iVar2 = (uint)*(ushort *)(lVar1 + (longlong)param_2) - (uint)*param_2;
      if (iVar2 != 0) {
        return iVar2;
      }
      param_2 = param_2 + 1;
      param_3 = param_3 + -1;
    } while (0 < param_3);
  }
  return 0;
}



ulonglong FUN_1800026d4(ushort *param_1,ushort *param_2,int param_3,ushort param_4,ushort param_5,
                       int param_6,int param_7)

{
  ushort *puVar1;
  int iVar2;
  int iVar3;
  
  iVar2 = param_3 + 1;
  if (param_6 == 0) {
    iVar2 = param_3;
  }
  puVar1 = param_1;
  iVar3 = 1;
  if (param_2 != (ushort *)0x0) {
    iVar3 = param_7;
  }
  for (; (((0 < iVar2 && (puVar1 < param_2)) && ((*puVar1 != 0 || (iVar3 == 0)))) &&
         ((param_4 <= *puVar1 && (*puVar1 < param_5 || *puVar1 == param_5)))); puVar1 = puVar1 + 1)
  {
    iVar2 = iVar2 + -1;
  }
  return (longlong)puVar1 - (longlong)param_1 >> 1 & 0xffffffff;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180002740(longlong param_1,uint param_2,ushort *param_3,int param_4,ushort *param_5,
                  int param_6,int *param_7)

{
  ushort *puVar1;
  short sVar2;
  uint uVar3;
  int iVar4;
  longlong lVar5;
  ushort *puVar6;
  ushort *puVar7;
  byte bVar10;
  ushort uVar8;
  DWORD dwErrCode;
  ulonglong uVar9;
  ushort uVar11;
  ulonglong uVar12;
  int iVar13;
  ulonglong uVar14;
  ulonglong uVar15;
  uint uVar16;
  ushort uVar17;
  uint uVar18;
  ulonglong uVar19;
  ulonglong uVar20;
  uint uVar21;
  uint uVar22;
  bool bVar23;
  undefined auStack456 [32];
  uint local_1a8;
  uint local_1a4;
  uint local_1a0;
  uint local_19c;
  uint local_198;
  int local_194;
  ulonglong local_190;
  uint local_188;
  ushort *local_180;
  ulonglong local_178;
  undefined4 local_170;
  ushort *local_168;
  ushort *local_160;
  longlong local_158;
  ushort *local_150;
  ushort *local_148;
  ushort *local_140;
  ulonglong local_138;
  longlong local_130;
  ushort *local_128;
  ulonglong local_120;
  ushort *local_118;
  int *local_110;
  undefined8 local_108;
  undefined8 local_100;
  longlong local_f8;
  ulonglong local_f0;
  uint local_e8;
  uint local_e4;
  uint local_e0;
  undefined4 local_dc;
  uint local_d8;
  uint local_d4;
  uint local_d0;
  uint local_cc;
  uint local_c8;
  undefined4 local_c4;
  uint local_c0;
  uint local_bc;
  ushort *local_b8;
  ushort *local_b0;
  undefined4 local_a8;
  ushort *local_a0;
  uint local_98;
  uint local_94;
  ushort local_8e;
  uint local_8c;
  ushort *local_88;
  ushort *local_80;
  undefined4 local_78;
  ushort *local_70;
  uint local_68;
  uint local_64;
  ushort local_5e;
  uint local_5c;
  uint local_58;
  ulonglong local_54;
  uint local_4c;
  ulonglong local_48;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStack456;
  local_110 = param_7;
  if ((((param_4 < -1) || (param_3 == (ushort *)0x0)) || (param_6 < -1)) ||
     (param_5 == (ushort *)0x0)) {
    SetLastError(0x57);
    goto LAB_180002ca6;
  }
  if ((param_2 & 0xf00000) == 0) {
    param_2 = param_2 | 0x400000;
  }
  uVar19 = 0;
  if ((((param_2 & 0xffffffe2) - 1 & param_2 & 0x22) != 0 ||
       (((param_2 & 0xfff00000) - 1 & param_2 & 0xf00000) != 0 || (param_2 & 0xf70cffc8) != 0)) ||
     (((param_2 & 0xfffffff1) - 1 & param_2 & 0x11) != 0)) {
LAB_18002a5c5:
    dwErrCode = 0x3ec;
    goto LAB_180002c85;
  }
  if ((param_4 == -1) && (param_6 == -1)) {
    local_c4 = 0;
LAB_180003065:
    uVar20 = 1;
    uVar12 = FUN_180002600((short *)param_3);
    param_4 = (int)uVar12;
  }
  else {
    uVar20 = 1;
    local_c4 = 1;
    if (param_4 == -1) goto LAB_180003065;
  }
  if (param_6 == -1) {
    uVar12 = FUN_180002600((short *)param_5);
    param_6 = (int)uVar12;
  }
  if ((param_2 >> 0x1b & 1) == 0) {
    local_178 = *(ulonglong *)(param_1 + 0x138);
  }
  else {
    local_178 = *(ulonglong *)(param_1 + 0x130);
  }
  uVar18 = (uint)uVar19;
  local_cc = (uint)uVar20;
  local_c0 = local_cc;
  if ((*(byte *)(param_1 + 0x140) & 1) == 0) {
    local_c0 = uVar18;
  }
  local_78 = uVar18;
  local_a0 = param_3;
  if (param_4 < 0) {
    local_b0 = (ushort *)0xffffffffffffffff;
    local_a8 = local_cc;
  }
  else {
    local_b0 = param_3 + param_4;
    local_a8 = uVar18;
  }
  local_88 = param_5;
  local_70 = param_5;
  if (param_6 < 0) {
    local_118 = (ushort *)0xffffffffffffffff;
    local_78 = local_cc;
  }
  else {
    local_118 = param_5 + param_6;
  }
  local_80 = local_118;
  local_98 = uVar18;
  local_68 = uVar18;
  local_188 = uVar18 & 0xffffff00 | (uint)((param_2 & 2) != 0);
  local_54 = uVar19;
  local_8c = uVar18;
  local_5c = uVar18;
  uVar12 = uVar20;
  local_e4 = local_cc;
  if ((param_2 & 4) == 0) {
    uVar12 = uVar19;
    local_e4 = uVar18;
  }
  uVar12 = uVar12 & 0xffffffff;
  uVar3 = 0xc4;
  local_d8 = (param_2 & 0xff) >> 4 & 1;
  local_d4 = (param_2 & 0xff) >> 5 & 1;
  local_170 = 0xe7ffffff;
  local_dc = (undefined4)uVar12;
  local_bc = 0xffffffff;
  if ((param_2 & 1) != 0) {
    local_bc = 0xe7ffffff;
  }
  local_58 = 0xc4;
  if ((param_2 & 2) == 0) {
    uVar3 = 0xf5;
    local_58 = 0xf5;
  }
  else {
    local_bc = local_bc & 0xff00ffff;
  }
  if ((param_2 >> 0x10 & 1) != 0) {
    local_bc = local_bc & 0xdfffffff;
  }
  if (((param_2 >> 0x11 & 1) != 0) && (local_bc = local_bc & 0xfeffffff, (param_2 & 1) != 0)) {
    local_58 = uVar3 & 0xfffffffb;
  }
  uVar14 = uVar19;
  if ((local_178 == uVar19) && ((param_2 & 0xf70cffee) == 0)) {
    uVar14 = uVar20;
  }
  iVar4 = (int)uVar14;
  uVar3 = param_2 & 0xf7fcffc8;
  local_180 = local_b0;
  local_f8 = param_1;
  local_f0 = local_178;
  local_e8 = uVar18;
  local_e0 = local_188;
  local_d0 = uVar18;
  local_c8 = local_cc;
  local_b8 = param_3;
  if (uVar3 != 0x100000) {
    if (uVar3 == 0x400000) {
      puVar7 = local_a0;
      if (iVar4 != 0) {
        do {
          uVar3 = uVar18;
          uVar22 = local_cc;
          if ((param_2 & 0x11) == 0) {
            local_190 = (longlong)local_b0 - (longlong)local_b8 >> 1;
            local_150 = (ushort *)((longlong)local_118 - (longlong)param_5 >> 1);
            iVar4 = (int)local_190;
            local_158 = (longlong)iVar4;
            uVar20 = uVar19;
            uVar21 = uVar18;
            if (0 < iVar4) {
              local_138 = (ulonglong)(int)local_150;
              puVar7 = param_5;
              do {
                if ((longlong)local_138 <= (longlong)uVar20) break;
                uVar17 = *(ushort *)((longlong)puVar7 + ((longlong)local_b8 - (longlong)param_5));
                uVar16 = local_cc;
                if (((0x7e < (ushort)(uVar17 - 1)) || (0x7e < (ushort)(*puVar7 - 1))) ||
                   (uVar16 = uVar18, uVar17 != *puVar7)) goto LAB_180002b2e;
                uVar21 = uVar21 + 1;
                uVar20 = uVar20 + 1;
                puVar7 = puVar7 + 1;
              } while ((longlong)uVar20 < local_158);
            }
            if (((iVar4 <= (int)uVar21) || (local_b8[uVar20] < 0x80)) &&
               (uVar3 = local_cc, uVar22 = uVar18, (int)uVar21 < (int)local_150)) {
              uVar17 = param_5[uVar20];
LAB_180002bd8:
              uVar3 = uVar18;
              uVar22 = local_cc;
              uVar16 = uVar18;
              if ((ushort)(uVar17 - 1) < 0x7f) {
LAB_180002b2e:
                uVar3 = uVar18;
                uVar22 = uVar16;
              }
            }
          }
          else {
            local_190 = (longlong)local_b0 - (longlong)local_b8 >> 1;
            uVar12 = uVar19 & 0xffffffff;
            uVar21 = (uint)uVar12;
            local_150 = (ushort *)((longlong)local_118 - (longlong)param_5 >> 1);
            iVar4 = (int)local_190;
            local_158 = (longlong)iVar4;
            uVar20 = uVar19;
            if (0 < iVar4) {
              local_120 = (ulonglong)(int)local_150;
              local_138 = (longlong)local_b8 - (longlong)param_5;
              puVar7 = param_5;
              do {
                uVar21 = (uint)uVar12;
                if ((longlong)local_120 <= (longlong)uVar20) break;
                uVar17 = *(ushort *)(local_138 + (longlong)puVar7);
                uVar16 = local_cc;
                if ((0x7e < (ushort)(uVar17 - 1)) || (uVar11 = *puVar7, 0x7e < (ushort)(uVar11 - 1))
                   ) goto LAB_180002b2e;
                uVar8 = uVar11 - 0x20;
                if (0x19 < (ushort)(uVar11 - 0x61)) {
                  uVar8 = uVar11;
                }
                uVar11 = uVar17 - 0x20;
                if (0x19 < (ushort)(uVar17 - 0x61)) {
                  uVar11 = uVar17;
                }
                uVar16 = uVar18;
                if (uVar11 != uVar8) goto LAB_180002b2e;
                uVar21 = uVar21 + 1;
                uVar12 = (ulonglong)uVar21;
                uVar20 = uVar20 + 1;
                puVar7 = puVar7 + 1;
              } while ((longlong)uVar20 < local_158);
            }
            if (((iVar4 <= (int)uVar21) || (local_b8[uVar20] < 0x80)) &&
               (uVar3 = local_cc, uVar22 = uVar18, (int)uVar21 < (int)local_150)) {
              uVar17 = param_5[uVar20];
              goto LAB_180002bd8;
            }
          }
          if (uVar3 != 0) {
            if (local_110 != (int *)0x0) {
              *local_110 = (int)((longlong)local_118 - (longlong)param_5 >> 1);
            }
            goto LAB_180002ca6;
          }
          puVar7 = local_b8;
          if (uVar22 == 1) break;
          if ((int)local_190 < 2) goto LAB_180002fe2;
          local_b8 = local_b8 + 1;
        } while( true );
      }
      goto LAB_18002855b;
    }
    if (uVar3 != 0x200000) {
      if (uVar3 == 0x800000) {
        if (iVar4 != 0) {
          local_120 = uVar19;
          if ((param_2 & 0x11) != 0) {
            local_120 = uVar20;
          }
          do {
            uVar3 = uVar18;
            if (local_120 == 0) {
              uVar20 = uVar19 & 0xffffffff;
              uVar22 = (uint)uVar20;
              iVar4 = (int)((longlong)local_b0 - (longlong)param_3 >> 1);
              iVar13 = (int)((longlong)local_118 - (longlong)param_5 >> 1);
              if (0 < iVar4) {
                lVar5 = (longlong)iVar13;
                puVar7 = param_5 + lVar5 + -1;
                local_190 = ((iVar4 - lVar5) * 2 - (longlong)param_5) + (longlong)param_3;
                uVar12 = uVar19;
                do {
                  uVar22 = (uint)uVar20;
                  if (lVar5 <= (longlong)uVar12) break;
                  uVar21 = local_cc;
                  if (((0x7e < (ushort)(*(short *)(local_190 + (longlong)puVar7) - 1U)) ||
                      (0x7e < (ushort)(*puVar7 - 1))) ||
                     (uVar21 = uVar18, *(ushort *)(local_190 + (longlong)puVar7) != *puVar7))
                  goto LAB_180003212;
                  uVar22 = uVar22 + 1;
                  uVar20 = (ulonglong)uVar22;
                  uVar12 = uVar12 + 1;
                  puVar7 = puVar7 + -1;
                } while ((longlong)uVar12 < (longlong)iVar4);
              }
              if ((iVar4 <= (int)uVar22) || (param_3[(longlong)(int)(iVar4 - uVar22) + -1] < 0x80))
              {
                uVar3 = local_cc;
                uVar21 = uVar18;
                if ((int)uVar22 < iVar13) {
                  uVar17 = param_5[(longlong)(int)(iVar13 - uVar22) + -1];
                  goto joined_r0x0001800284f7;
                }
                goto LAB_180003212;
              }
LAB_1800284fd:
              uVar3 = uVar18;
              uVar21 = local_cc;
            }
            else {
              iVar4 = (int)((longlong)local_b0 - (longlong)param_3 >> 1);
              local_158 = (longlong)iVar4;
              iVar13 = (int)((longlong)local_118 - (longlong)param_5 >> 1);
              uVar22 = uVar18;
              if (0 < iVar4) {
                local_138 = (ulonglong)iVar13;
                local_150 = (ushort *)
                            (((local_158 - local_138) * 2 - (longlong)param_5) + (longlong)param_3);
                puVar7 = param_5 + (local_138 - 1);
                uVar20 = uVar19;
                do {
                  if ((longlong)local_138 <= (longlong)uVar20) break;
                  sVar2 = *(short *)((longlong)local_150 + (longlong)puVar7);
                  uVar17 = *puVar7;
                  uVar21 = local_cc;
                  if ((0x7e < (ushort)(sVar2 - 1U)) || (0x7e < (ushort)(uVar17 - 1)))
                  goto LAB_180003212;
                  uVar11 = sVar2 - 0x20;
                  if (0x19 < (ushort)(sVar2 - 0x61U)) {
                    uVar11 = *(ushort *)((longlong)local_150 + (longlong)puVar7);
                  }
                  uVar8 = uVar17 - 0x20;
                  if (0x19 < (ushort)(uVar17 - 0x61)) {
                    uVar8 = *puVar7;
                  }
                  uVar21 = uVar18;
                  if (uVar11 != uVar8) goto LAB_180003212;
                  uVar22 = uVar22 + 1;
                  uVar20 = uVar20 + 1;
                  puVar7 = puVar7 + -1;
                } while ((longlong)uVar20 < local_158);
              }
              if (((int)uVar22 < iVar4) && (0x7f < param_3[(longlong)(int)(iVar4 - uVar22) + -1]))
              goto LAB_1800284fd;
              uVar3 = local_cc;
              uVar21 = uVar18;
              if ((int)uVar22 < iVar13) {
                uVar17 = param_5[(longlong)(int)(iVar13 - uVar22) + -1];
joined_r0x0001800284f7:
                uVar3 = uVar18;
                uVar21 = uVar18;
                if (0x7e < (ushort)(uVar17 - 1)) goto LAB_1800284fd;
              }
            }
LAB_180003212:
            local_180 = local_b0;
            if (uVar3 != 0) {
              if (local_110 != (int *)0x0) {
                *local_110 = (int)((longlong)local_118 - (longlong)param_5 >> 1);
              }
              goto LAB_180002ca6;
            }
            if (uVar21 == 1) break;
            if (iVar4 < 2) goto LAB_180003275;
            local_b0 = local_b0 + -1;
          } while( true );
        }
        goto LAB_18002853d;
      }
      goto LAB_18002a5c5;
    }
    if (iVar4 != 0) {
      local_180 = (ushort *)((longlong)local_b0 - (longlong)param_3 >> 1);
      uVar12 = uVar19 & 0xffffffff;
      uVar3 = (uint)uVar12;
      iVar4 = (int)local_180;
      iVar13 = (int)((longlong)local_118 - (longlong)param_5 >> 1);
      if ((param_2 & 0x11) == 0) {
        if (0 < iVar4) {
          lVar5 = (longlong)iVar13;
          puVar7 = param_5 + lVar5 + -1;
          local_158 = ((iVar4 - lVar5) * 2 - (longlong)param_5) + (longlong)param_3;
          uVar14 = uVar19;
          do {
            uVar3 = (uint)uVar12;
            if (lVar5 <= (longlong)uVar14) break;
            uVar22 = local_cc;
            if (((0x7e < (ushort)(*(ushort *)(local_158 + (longlong)puVar7) - 1)) ||
                (0x7e < (ushort)(*puVar7 - 1))) ||
               (uVar22 = uVar18, *(ushort *)(local_158 + (longlong)puVar7) != *puVar7))
            goto LAB_18000310e;
            uVar3 = uVar3 + 1;
            uVar12 = (ulonglong)uVar3;
            uVar14 = uVar14 + 1;
            puVar7 = puVar7 + -1;
          } while ((longlong)uVar14 < (longlong)iVar4);
        }
        if (iVar4 <= (int)uVar3) goto LAB_180003158;
LAB_180003182:
        if (param_3[(longlong)(int)(iVar4 - uVar3) + -1] < 0x80) goto LAB_180003158;
LAB_1800031ad:
        uVar22 = local_cc;
      }
      else {
        if (0 < iVar4) {
          local_158 = (longlong)iVar13;
          puVar7 = param_5 + local_158 + -1;
          local_138 = ((iVar4 - local_158) * 2 - (longlong)param_5) + (longlong)param_3;
          uVar14 = uVar19;
          do {
            uVar3 = (uint)uVar12;
            if (local_158 <= (longlong)uVar14) break;
            uVar17 = *(ushort *)(local_138 + (longlong)puVar7);
            uVar11 = *puVar7;
            uVar22 = local_cc;
            if ((0x7e < (ushort)(uVar17 - 1)) || (0x7e < (ushort)(uVar11 - 1))) goto LAB_18000310e;
            uVar8 = uVar11 - 0x20;
            if (0x19 < (ushort)(uVar11 - 0x61)) {
              uVar8 = uVar11;
            }
            uVar11 = uVar17 - 0x20;
            if (0x19 < (ushort)(uVar17 - 0x61)) {
              uVar11 = uVar17;
            }
            uVar22 = uVar18;
            if (uVar11 != uVar8) goto LAB_18000310e;
            uVar3 = uVar3 + 1;
            uVar12 = (ulonglong)uVar3;
            uVar14 = uVar14 + 1;
            puVar7 = puVar7 + -1;
          } while ((longlong)uVar14 < (longlong)iVar4);
        }
        if ((int)uVar3 < iVar4) goto LAB_180003182;
LAB_180003158:
        if ((int)uVar3 < iVar13) {
          uVar22 = uVar18;
          if (0x7e < (ushort)(param_5[(longlong)(int)(iVar13 - uVar3) + -1] - 1))
          goto LAB_1800031ad;
        }
        else {
          uVar19 = uVar20 & 0xffffffff;
          uVar22 = uVar18;
        }
      }
LAB_18000310e:
      if ((int)uVar19 != 0) {
        if (local_110 != (int *)0x0) {
          *local_110 = iVar13;
        }
        goto LAB_180002ca6;
      }
      if (uVar22 == 0) goto LAB_180002c83;
    }
    uVar19 = FUN_18002321c(&local_f8,local_cc);
    uVar19 = uVar19 & 0xffffffff;
    uVar18 = local_4c;
    goto LAB_18000302f;
  }
  if (iVar4 != 0) {
    uVar3 = uVar18;
    if ((param_2 & 0x11) == 0) {
      uVar12 = uVar19 & 0xffffffff;
      local_1a0 = (uint)uVar12;
      iVar4 = (int)((longlong)local_118 - (longlong)param_5 >> 1);
      local_190 = (ulonglong)iVar4;
      local_120 = (longlong)local_b0 - (longlong)param_3 >> 1;
      local_158 = (longlong)(int)local_120;
      uVar22 = local_1a0;
      if (0 < local_158) {
        puVar7 = param_5;
        uVar14 = uVar19;
        do {
          local_138 = local_190;
          uVar22 = (uint)uVar12;
          if ((longlong)local_190 <= (longlong)uVar14) break;
          uVar17 = *(ushort *)((longlong)puVar7 + ((longlong)param_3 - (longlong)param_5));
          uVar21 = local_cc;
          if (((0x7e < (ushort)(uVar17 - 1)) || (0x7e < (ushort)(*puVar7 - 1))) ||
             (uVar21 = uVar18, uVar17 != *puVar7)) goto LAB_180002c72;
          uVar14 = uVar14 + 1;
          local_1a0 = local_1a0 + 1;
          uVar12 = (ulonglong)local_1a0;
          puVar7 = puVar7 + 1;
          uVar22 = local_1a0;
        } while ((longlong)uVar14 < local_158);
      }
      if ((((int)local_120 <= (int)uVar22) || (uVar21 = local_cc, param_3[(int)uVar22] < 0x80)) &&
         ((uVar3 = local_cc, uVar21 = uVar18, (int)uVar22 < iVar4 &&
          (uVar3 = uVar18, uVar21 = local_cc, (ushort)(param_5[(int)uVar22] - 1) < 0x7f)))) {
        uVar21 = uVar18;
      }
    }
    else {
      local_190 = (longlong)local_118 - (longlong)param_5 >> 1;
      uVar12 = uVar19 & 0xffffffff;
      uVar22 = (uint)uVar12;
      local_158 = (longlong)local_b0 - (longlong)param_3 >> 1;
      iVar4 = (int)local_158;
      if (0 < iVar4) {
        local_138 = (ulonglong)(int)local_190;
        local_120 = (longlong)param_3 - (longlong)param_5;
        puVar7 = param_5;
        uVar14 = uVar19;
        do {
          uVar22 = (uint)uVar12;
          if ((longlong)local_138 <= (longlong)uVar14) break;
          uVar17 = *(ushort *)(local_120 + (longlong)puVar7);
          uVar21 = local_cc;
          if ((0x7e < (ushort)(uVar17 - 1)) || (uVar11 = *puVar7, 0x7e < (ushort)(uVar11 - 1)))
          goto LAB_180002c72;
          uVar8 = uVar11 - 0x20;
          if (0x19 < (ushort)(uVar11 - 0x61)) {
            uVar8 = uVar11;
          }
          uVar11 = uVar17 - 0x20;
          if (0x19 < (ushort)(uVar17 - 0x61)) {
            uVar11 = uVar17;
          }
          uVar21 = uVar18;
          if (uVar11 != uVar8) goto LAB_180002c72;
          uVar22 = uVar22 + 1;
          uVar12 = (ulonglong)uVar22;
          uVar14 = uVar14 + 1;
          puVar7 = puVar7 + 1;
        } while ((longlong)uVar14 < (longlong)iVar4);
      }
      if ((((iVar4 <= (int)uVar22) || (uVar21 = local_cc, param_3[(int)uVar22] < 0x80)) &&
          (uVar3 = local_cc, uVar21 = uVar18, (int)uVar22 < (int)local_190)) &&
         (uVar3 = uVar18, uVar21 = local_cc, (ushort)(param_5[(int)uVar22] - 1) < 0x7f)) {
        uVar21 = uVar18;
      }
    }
LAB_180002c72:
    if (uVar3 != 0) {
      if (local_110 != (int *)0x0) {
        *local_110 = (int)local_190;
      }
      goto LAB_180002ca6;
    }
    if (uVar21 == 0) goto LAB_180002c83;
    uVar12 = (ulonglong)local_e4;
  }
  local_120 = 8;
  local_100 = 0xc;
  local_108 = 10;
  local_138 = 6;
  local_158 = 4;
  uVar17 = (ushort)uVar19;
  if (param_5 < local_118) {
    uVar14 = uVar19 & 0xffffffff;
    do {
      local_148 = local_70;
      uVar11 = *local_70;
      iVar4 = (int)uVar14;
      if (local_178 == uVar19) {
        bVar10 = (byte)((uint)*(undefined4 *)(DAT_1800b2b88 + (ulonglong)uVar11 * 4) >> 8);
      }
      else {
        bVar10 = (byte)((uint)*(undefined4 *)
                               (DAT_1800b2b88 +
                               (ulonglong)
                               (*(int *)(local_178 + (ulonglong)(uVar11 >> 8) * 4) +
                               (uint)(byte)uVar11) * 4) >> 8);
      }
      if (0xc < bVar10) goto LAB_180002d65;
      if (bVar10 == 0) {
        if (*local_70 == 0) goto LAB_180002d65;
        if (*local_70 != 0xdb40) goto LAB_18002954b;
        uVar14 = (ulonglong)(int)local_68;
        if (0 < (int)local_68) {
          uVar11 = *(ushort *)((longlong)&local_78 + uVar14 * 2 + 2);
LAB_1800295c8:
          if ((ushort)(uVar11 + 0x2300) < 0xf0) {
            uVar14 = (ulonglong)local_68;
            if ((int)local_68 < 1) {
              local_70 = local_70 + 1;
              if (local_70 < local_118) {
                local_5e = *local_70;
              }
              else {
                local_5e = uVar17;
              }
              goto LAB_18002954e;
            }
            local_68 = local_68 - 1;
            local_5e = *(ushort *)((longlong)&local_78 + (longlong)iVar4 * 2 + 2);
          }
          goto LAB_18002954b;
        }
        if (local_70 + 1 < local_118) {
          uVar11 = local_70[1];
          goto LAB_1800295c8;
        }
      }
      else {
        if (bVar10 != 6) {
          if (bVar10 == 1) {
            if ((local_188 != 0) || (local_d4 != 0)) {
              local_140 = local_70;
              if (*(ulonglong *)(param_1 + 0x150) == uVar19) goto LAB_18002954b;
              local_5e = *local_70;
              uVar11 = *local_70;
              if (local_178 == 0) {
                local_64 = *(uint *)(DAT_1800b2b88 + (ulonglong)uVar11 * 4);
              }
              else {
                local_64 = *(uint *)(DAT_1800b2b88 +
                                    (ulonglong)
                                    (*(int *)(local_178 + (ulonglong)(uVar11 >> 8) * 4) +
                                    (uint)(byte)uVar11) * 4);
              }
              local_190 = local_190 & 0xffffffff00000000 | uVar19 & 0xffffffff;
              uVar3 = uVar18;
              if ((char)(local_64 >> 8) != '\x03') {
                uVar3 = 0xc0;
              }
              uVar3 = uVar3 & local_64 >> 0x18;
              puVar7 = local_70;
              uVar22 = uVar18;
              if (uVar3 == 0x40) {
LAB_180029107:
LAB_18002910c:
                local_19c = *(uint *)(param_1 + 0x140) & 0x20;
                uVar11 = *(ushort *)(*(longlong *)(param_1 + 0x150) + 10);
                local_1a8 = local_1a8 & 0xffff0000;
                if (uVar11 != 0) {
                  lVar5 = 6;
                  if (local_19c == uVar18) {
                    lVar5 = 4;
                  }
                  if ((ushort *)(lVar5 + (longlong)local_70) <= local_118) {
                    if ((int)local_190 == 0) {
                      iVar4 = (uVar18 & 0xffffff00 | (uint)(local_19c != uVar18)) + 3;
                      uVar3 = local_78;
                      if (local_118 == (ushort *)0x0) {
                        uVar3 = local_cc;
                      }
                      local_168 = (ushort *)
                                  ((ulonglong)local_168 & 0xffffffff00000000 | (ulonglong)uVar3);
                      puVar6 = local_70;
                      do {
                        if ((local_118 <= puVar6) ||
                           ((((uVar8 = *puVar6, uVar8 == 0 && (uVar3 != uVar18)) ||
                             (puVar1 = (ushort *)(*(longlong *)(param_1 + 0x150) + 6),
                             *puVar1 <= uVar8 && uVar8 != *puVar1)) ||
                            (uVar8 < *(ushort *)(*(longlong *)(param_1 + 0x150) + 4))))) break;
                        puVar6 = puVar6 + 1;
                        iVar4 = iVar4 + -1;
                      } while (0 < iVar4);
                      local_190 = (longlong)puVar6 - (longlong)local_70 >> 1 & 0xffffffff;
                    }
                    if (2 < (int)local_190) {
                      local_1a0 = uVar11 - 1;
                      uVar14 = uVar19 & 0xffffffff;
                      local_198 = (uint)uVar14;
                      if ((local_19c != uVar18) && (3 < (int)local_190)) {
                        uVar11 = *local_70;
                        if (local_178 == 0) {
                          uVar3 = *(uint *)(DAT_1800b2b88 + (ulonglong)uVar11 * 4);
                          uVar21 = *(uint *)(DAT_1800b2b88 + (ulonglong)local_70[1] * 4);
                        }
                        else {
                          uVar3 = *(uint *)(DAT_1800b2b88 +
                                           (ulonglong)
                                           (*(int *)(local_178 + (ulonglong)(uVar11 >> 8) * 4) +
                                           (uint)(byte)uVar11) * 4);
                          uVar12 = (ulonglong)local_e4;
                          uVar21 = *(uint *)(DAT_1800b2b88 +
                                            (ulonglong)
                                            (*(int *)(local_178 + (ulonglong)(local_70[1] >> 8) * 4)
                                            + (uint)(byte)local_70[1]) * 4);
                        }
                        if (((uVar21 ^ uVar3) & 0xe7ffffff) == 0) {
                          uVar14 = uVar20 & 0xffffffff;
                        }
                        local_198 = (uint)uVar14;
                      }
                      uVar15 = uVar19 & 0xffffffff;
                      local_1a8 = uVar18;
                      if (-1 < (int)local_1a0) {
                        local_160 = local_70 + uVar14;
                        do {
                          local_1a4 = 3;
                          local_194 = (int)(local_1a0 + (int)uVar15) / 2;
                          local_130 = (longlong)(local_194 * 6);
                          puVar6 = (ushort *)(*(longlong *)(param_1 + 0x160) + local_130 * 2);
                          local_128 = (ushort *)((longlong)local_160 - (longlong)puVar6);
                          while (iVar4 = (uint)*(ushort *)((longlong)local_128 + (longlong)puVar6) -
                                         (uint)*puVar6,
                                (uint)*(ushort *)((longlong)local_128 + (longlong)puVar6) ==
                                (uint)*puVar6) {
                            puVar6 = puVar6 + 1;
                            local_1a4 = local_1a4 - 1;
                            if ((int)local_1a4 < 1) {
                              local_64 = *(uint *)(*(longlong *)(param_1 + 0x160) + 8 +
                                                  local_130 * 2);
                              uVar22 = local_cc;
                              if (local_198 == uVar18) {
                                puVar7 = local_70 + 2;
                              }
                              goto LAB_18002953a;
                            }
                          }
                          uVar3 = local_194 - 1;
                          if (-1 < iVar4) {
                            uVar3 = local_1a0;
                          }
                          if (-1 < iVar4) {
                            local_1a8 = local_194 + 1;
                          }
                          uVar15 = (ulonglong)local_1a8;
                          local_1a0 = uVar3;
                        } while ((int)local_1a8 <= (int)uVar3);
                      }
                    }
                  }
                }
                uVar11 = *(ushort *)(*(longlong *)(param_1 + 0x150) + 8);
                local_1a8 = local_1a8 & 0xffff0000 | (uint)uVar11;
                if (uVar11 != 0) {
                  lVar5 = 4;
                  if (local_19c == uVar18) {
                    lVar5 = 2;
                  }
                  if ((ushort *)(lVar5 + (longlong)local_70) <= local_118) {
                    if ((int)local_190 == 0) {
                      iVar4 = (uVar18 & 0xffffff00 | (uint)(local_19c != uVar18)) + 2;
                      uVar3 = local_78;
                      if (local_118 == (ushort *)0x0) {
                        uVar3 = local_cc;
                      }
                      local_168 = (ushort *)
                                  ((ulonglong)local_168 & 0xffffffff00000000 | (ulonglong)uVar3);
                      puVar6 = local_70;
                      do {
                        if ((((local_118 <= puVar6) ||
                             ((uVar8 = *puVar6, uVar8 == 0 && (uVar3 != uVar18)))) ||
                            (puVar1 = (ushort *)(*(longlong *)(param_1 + 0x150) + 6),
                            *puVar1 <= uVar8 && uVar8 != *puVar1)) ||
                           (uVar8 < *(ushort *)(*(longlong *)(param_1 + 0x150) + 4))) break;
                        puVar6 = puVar6 + 1;
                        iVar4 = iVar4 + -1;
                      } while (0 < iVar4);
                      uVar12 = (ulonglong)local_e4;
                      local_190 = (longlong)puVar6 - (longlong)local_70 >> 1;
                    }
                    if (1 < (int)local_190) {
                      local_1a0 = uVar11 - 1;
                      uVar14 = uVar19 & 0xffffffff;
                      local_198 = (uint)uVar14;
                      if ((local_19c != uVar18) && (2 < (int)local_190)) {
                        uVar11 = *local_70;
                        if (local_178 == 0) {
                          uVar3 = *(uint *)(DAT_1800b2b88 + (ulonglong)uVar11 * 4);
                          uVar21 = *(uint *)(DAT_1800b2b88 + (ulonglong)local_70[1] * 4);
                        }
                        else {
                          uVar3 = *(uint *)(DAT_1800b2b88 +
                                           (ulonglong)
                                           (*(int *)(local_178 + (ulonglong)(uVar11 >> 8) * 4) +
                                           (uint)(byte)uVar11) * 4);
                          uVar21 = *(uint *)(DAT_1800b2b88 +
                                            (ulonglong)
                                            (*(int *)(local_178 + (ulonglong)(local_70[1] >> 8) * 4)
                                            + (uint)(byte)local_70[1]) * 4);
                        }
                        if (((uVar21 ^ uVar3) & 0xe7ffffff) == 0) {
                          uVar14 = uVar20 & 0xffffffff;
                        }
                        local_198 = (uint)uVar14;
                      }
                      uVar15 = uVar19 & 0xffffffff;
                      local_1a8 = uVar18;
                      if (-1 < (int)local_1a0) {
                        local_160 = local_70 + uVar14;
                        do {
                          local_1a4 = 2;
                          local_194 = (int)(local_1a0 + (int)uVar15) / 2;
                          local_130 = (longlong)(local_194 * 4);
                          puVar6 = (ushort *)(*(longlong *)(param_1 + 0x158) + local_130 * 2);
                          local_128 = (ushort *)((longlong)local_160 - (longlong)puVar6);
                          while (iVar4 = (uint)*(ushort *)((longlong)local_128 + (longlong)puVar6) -
                                         (uint)*puVar6,
                                (uint)*(ushort *)((longlong)local_128 + (longlong)puVar6) ==
                                (uint)*puVar6) {
                            puVar6 = puVar6 + 1;
                            local_1a4 = local_1a4 - 1;
                            if ((int)local_1a4 < 1) {
                              local_64 = *(uint *)(*(longlong *)(param_1 + 0x158) + 4 +
                                                  local_130 * 2);
                              uVar22 = local_cc;
                              if (local_198 == uVar18) {
                                puVar7 = local_70 + 1;
                              }
                              goto LAB_18002953a;
                            }
                          }
                          uVar12 = (ulonglong)local_e4;
                          uVar3 = local_194 - 1;
                          if (-1 < iVar4) {
                            uVar3 = local_1a0;
                          }
                          if (-1 < iVar4) {
                            local_1a8 = local_194 + 1;
                          }
                          uVar15 = (ulonglong)local_1a8;
                          local_1a0 = uVar3;
                        } while ((int)local_1a8 <= (int)uVar3);
                      }
                    }
                  }
                }
              }
              else {
                if (uVar3 == 0x80) {
LAB_180028cda:
LAB_180028cdf:
                  local_19c = *(uint *)(param_1 + 0x140) & 0x20;
                  uVar11 = *(ushort *)(*(longlong *)(param_1 + 0x150) + 0xe);
                  local_1a8 = local_1a8 & 0xffff0000;
                  if (uVar11 != 0) {
                    lVar5 = 10;
                    if (local_19c == uVar18) {
                      lVar5 = 8;
                    }
                    if ((ushort *)(lVar5 + (longlong)local_70) <= local_118) {
                      if ((int)local_190 == 0) {
                        iVar4 = (uVar18 & 0xffffff00 | (uint)(local_19c != uVar18)) + 5;
                        puVar6 = local_70;
                        local_1a4 = local_78;
                        if (local_118 == (ushort *)0x0) {
                          local_1a4 = local_cc;
                        }
                        do {
                          if (((local_118 <= puVar6) ||
                              (((uVar8 = *puVar6, uVar8 == 0 && (local_1a4 != uVar18)) ||
                               (puVar1 = (ushort *)(*(longlong *)(param_1 + 0x150) + 6),
                               *puVar1 <= uVar8 && uVar8 != *puVar1)))) ||
                             (uVar8 < *(ushort *)(*(longlong *)(param_1 + 0x150) + 4))) break;
                          puVar6 = puVar6 + 1;
                          iVar4 = iVar4 + -1;
                        } while (0 < iVar4);
                        uVar12 = (ulonglong)local_e4;
                        local_190 = (longlong)puVar6 - (longlong)local_70 >> 1 & 0xffffffff;
                      }
                      if (4 < (int)local_190) {
                        local_1a0 = uVar11 - 1;
                        uVar14 = uVar19 & 0xffffffff;
                        local_198 = (uint)uVar14;
                        if ((local_19c != uVar18) && (5 < (int)local_190)) {
                          uVar11 = *local_70;
                          if (local_178 == 0) {
                            uVar3 = *(uint *)(DAT_1800b2b88 + (ulonglong)uVar11 * 4);
                            uVar21 = *(uint *)(DAT_1800b2b88 + (ulonglong)local_70[1] * 4);
                          }
                          else {
                            uVar3 = *(uint *)(DAT_1800b2b88 +
                                             (ulonglong)
                                             (*(int *)(local_178 + (ulonglong)(uVar11 >> 8) * 4) +
                                             (uint)(byte)uVar11) * 4);
                            uVar21 = *(uint *)(DAT_1800b2b88 +
                                              (ulonglong)
                                              (*(int *)(local_178 +
                                                       (ulonglong)(local_70[1] >> 8) * 4) +
                                              (uint)(byte)local_70[1]) * 4);
                          }
                          if (((uVar21 ^ uVar3) & 0xe7ffffff) == 0) {
                            uVar14 = uVar20 & 0xffffffff;
                          }
                          local_198 = (uint)uVar14;
                        }
                        local_1a8 = uVar18;
                        if (-1 < (int)local_1a0) {
                          local_128 = local_70 + uVar14;
                          do {
                            local_1a4 = 5;
                            local_194 = (int)(local_1a0 + local_1a8) / 2;
                            local_160 = (ushort *)(longlong)(local_194 * 8);
                            puVar6 = (ushort *)
                                     (*(longlong *)(param_1 + 0x170) + (longlong)local_160 * 2);
                            local_130 = (longlong)local_128 - (longlong)puVar6;
                            while (iVar4 = (uint)*(ushort *)((longlong)puVar6 + local_130) -
                                           (uint)*puVar6,
                                  (uint)*(ushort *)((longlong)puVar6 + local_130) == (uint)*puVar6)
                            {
                              puVar6 = puVar6 + 1;
                              local_1a4 = local_1a4 - 1;
                              if ((int)local_1a4 < 1) {
                                local_64 = *(uint *)(*(longlong *)(param_1 + 0x170) + 0xc +
                                                    (longlong)local_160 * 2);
                                uVar22 = local_cc;
                                if (local_198 == uVar18) {
                                  puVar7 = local_70 + 4;
                                }
                                goto LAB_18002953a;
                              }
                            }
                            uVar12 = (ulonglong)local_e4;
                            uVar3 = local_194 - 1;
                            if (-1 < iVar4) {
                              uVar3 = local_1a0;
                            }
                            if (-1 < iVar4) {
                              local_1a8 = local_194 + 1;
                            }
                            local_1a0 = uVar3;
                          } while ((int)local_1a8 <= (int)uVar3);
                        }
                      }
                    }
                  }
                  uVar11 = *(ushort *)(*(longlong *)(param_1 + 0x150) + 0xc);
                  local_1a8 = local_1a8 & 0xffff0000;
                  if (uVar11 != 0) {
                    lVar5 = 8;
                    if (local_19c == uVar18) {
                      lVar5 = 6;
                    }
                    if ((ushort *)(lVar5 + (longlong)local_70) <= local_118) {
                      if ((int)local_190 == 0) {
                        iVar4 = (uVar18 & 0xffffff00 | (uint)(local_19c != uVar18)) + 4;
                        uVar3 = local_78;
                        if (local_118 == (ushort *)0x0) {
                          uVar3 = local_cc;
                        }
                        local_168 = (ushort *)
                                    ((ulonglong)local_168 & 0xffffffff00000000 | (ulonglong)uVar3);
                        puVar6 = local_70;
                        do {
                          if (((local_118 <= puVar6) ||
                              ((uVar8 = *puVar6, uVar8 == 0 && (uVar3 != uVar18)))) ||
                             ((puVar1 = (ushort *)(*(longlong *)(param_1 + 0x150) + 6),
                              *puVar1 <= uVar8 && uVar8 != *puVar1 ||
                              (uVar8 < *(ushort *)(*(longlong *)(param_1 + 0x150) + 4))))) break;
                          puVar6 = puVar6 + 1;
                          iVar4 = iVar4 + -1;
                        } while (0 < iVar4);
                        local_190 = (longlong)puVar6 - (longlong)local_70 >> 1 & 0xffffffff;
                      }
                      if (3 < (int)local_190) {
                        local_1a0 = uVar11 - 1;
                        uVar14 = uVar19 & 0xffffffff;
                        local_198 = (uint)uVar14;
                        if ((local_19c != uVar18) && (4 < (int)local_190)) {
                          uVar11 = *local_70;
                          if (local_178 == 0) {
                            uVar3 = *(uint *)(DAT_1800b2b88 + (ulonglong)uVar11 * 4);
                            uVar21 = *(uint *)(DAT_1800b2b88 + (ulonglong)local_70[1] * 4);
                          }
                          else {
                            uVar3 = *(uint *)(DAT_1800b2b88 +
                                             (ulonglong)
                                             (*(int *)(local_178 + (ulonglong)(uVar11 >> 8) * 4) +
                                             (uint)(byte)uVar11) * 4);
                            uVar12 = (ulonglong)local_e4;
                            uVar21 = *(uint *)(DAT_1800b2b88 +
                                              (ulonglong)
                                              (*(int *)(local_178 +
                                                       (ulonglong)(local_70[1] >> 8) * 4) +
                                              (uint)(byte)local_70[1]) * 4);
                          }
                          if (((uVar3 ^ uVar21) & 0xe7ffffff) == 0) {
                            uVar14 = uVar20 & 0xffffffff;
                          }
                          local_198 = (uint)uVar14;
                        }
                        uVar15 = uVar19 & 0xffffffff;
                        local_1a8 = uVar18;
                        if (-1 < (int)local_1a0) {
                          local_160 = local_70 + uVar14;
                          do {
                            local_1a4 = 4;
                            local_194 = (int)(local_1a0 + (int)uVar15) / 2;
                            local_130 = (longlong)(local_194 * 6);
                            puVar6 = (ushort *)(*(longlong *)(param_1 + 0x168) + local_130 * 2);
                            local_128 = (ushort *)((longlong)local_160 - (longlong)puVar6);
                            while (iVar4 = (uint)*(ushort *)((longlong)puVar6 + (longlong)local_128)
                                           - (uint)*puVar6,
                                  (uint)*(ushort *)((longlong)puVar6 + (longlong)local_128) ==
                                  (uint)*puVar6) {
                              puVar6 = puVar6 + 1;
                              local_1a4 = local_1a4 - 1;
                              if ((int)local_1a4 < 1) {
                                local_64 = *(uint *)(*(longlong *)(param_1 + 0x168) + 8 +
                                                    local_130 * 2);
                                uVar22 = local_cc;
                                if (local_198 == uVar18) {
                                  puVar7 = local_70 + 3;
                                }
                                goto LAB_18002953a;
                              }
                            }
                            uVar12 = (ulonglong)local_e4;
                            uVar3 = local_194 - 1;
                            if (-1 < iVar4) {
                              uVar3 = local_1a0;
                            }
                            if (-1 < iVar4) {
                              local_1a8 = local_194 + 1;
                            }
                            uVar15 = (ulonglong)local_1a8;
                            local_1a0 = uVar3;
                          } while ((int)local_1a8 <= (int)uVar3);
                        }
                        goto LAB_180029107;
                      }
                    }
                  }
                  goto LAB_18002910c;
                }
                if (uVar3 == 0xc0) {
                  local_19c = *(uint *)(param_1 + 0x140) & 0x20;
                  puVar6 = (ushort *)(*(longlong *)(param_1 + 0x150) + 0x14);
                  if (uVar17 <= *puVar6 && *puVar6 != uVar17) {
                    lVar5 = 0x10;
                    if (local_19c == 0) {
                      lVar5 = 0xe;
                    }
                    if ((ushort *)(lVar5 + (longlong)local_70) <= local_118) {
                      iVar4 = (uVar18 & 0xffffff00 | (uint)(local_19c != 0)) + 8;
                      uVar12 = (ulonglong)local_78;
                      puVar6 = local_70;
                      if (local_118 == (ushort *)0x0) {
                        uVar12 = uVar20 & 0xffffffff;
                      }
                      do {
                        if ((((local_118 <= puVar6) ||
                             ((uVar11 = *puVar6, uVar11 == 0 && ((int)uVar12 != 0)))) ||
                            (puVar1 = (ushort *)(*(longlong *)(param_1 + 0x150) + 6),
                            *puVar1 <= uVar11 && uVar11 != *puVar1)) ||
                           (uVar11 < *(ushort *)(*(longlong *)(param_1 + 0x150) + 4))) break;
                        puVar6 = puVar6 + 1;
                        iVar4 = iVar4 + -1;
                      } while (0 < iVar4);
                      uVar12 = (ulonglong)local_e4;
                      local_190 = (longlong)puVar6 - (longlong)local_70 >> 1;
                      if (7 < (int)local_190) {
                        uVar14 = uVar19 & 0xffffffff;
                        local_1a0 = (uint)uVar14;
                        local_198 = *(ushort *)(*(longlong *)(param_1 + 0x150) + 0x14) - 1;
                        if ((local_19c != uVar18) && (8 < (int)local_190)) {
                          uVar11 = *local_70;
                          if (local_178 == 0) {
                            uVar3 = *(uint *)(DAT_1800b2b88 + (ulonglong)uVar11 * 4);
                            uVar21 = *(uint *)(DAT_1800b2b88 + (ulonglong)local_70[1] * 4);
                          }
                          else {
                            uVar3 = *(uint *)(DAT_1800b2b88 +
                                             (ulonglong)
                                             (*(int *)(local_178 + (ulonglong)(uVar11 >> 8) * 4) +
                                             (uint)(byte)uVar11) * 4);
                            uVar21 = *(uint *)(DAT_1800b2b88 +
                                              (ulonglong)
                                              (*(int *)(local_178 +
                                                       (ulonglong)(local_70[1] >> 8) * 4) +
                                              (uint)(byte)local_70[1]) * 4);
                          }
                          if (((uVar21 ^ uVar3) & 0xe7ffffff) == 0) {
                            uVar14 = uVar20 & 0xffffffff;
                          }
                          local_1a0 = (uint)uVar14;
                        }
                        uVar15 = uVar19 & 0xffffffff;
                        local_1a8 = uVar18;
                        if (-1 < (int)local_198) {
                          local_168 = local_70 + uVar14;
                          do {
                            uVar12 = (ulonglong)local_e4;
                            local_194 = 8;
                            local_1a4 = (int)(local_198 + (int)uVar15) / 2;
                            local_128 = (ushort *)(longlong)(int)(local_1a4 * 10);
                            puVar6 = (ushort *)
                                     (*(longlong *)(param_1 + 0x188) + (longlong)local_128 * 2);
                            local_130 = (longlong)local_168 - (longlong)puVar6;
                            while (iVar4 = (uint)*(ushort *)((longlong)puVar6 + local_130) -
                                           (uint)*puVar6,
                                  (uint)*(ushort *)((longlong)puVar6 + local_130) == (uint)*puVar6)
                            {
                              puVar6 = puVar6 + 1;
                              local_194 = local_194 + -1;
                              if (local_194 < 1) {
                                local_64 = *(uint *)(*(longlong *)(param_1 + 0x188) + 0x10 +
                                                    (longlong)local_128 * 2);
                                uVar22 = local_cc;
                                if (local_1a0 == uVar18) {
                                  puVar7 = local_70 + 7;
                                }
                                goto LAB_18002953a;
                              }
                            }
                            uVar12 = (ulonglong)local_e4;
                            uVar3 = local_1a4 - 1;
                            if (-1 < iVar4) {
                              uVar3 = local_198;
                            }
                            if (-1 < iVar4) {
                              local_1a8 = local_1a4 + 1;
                            }
                            uVar15 = (ulonglong)local_1a8;
                            local_198 = uVar3;
                          } while ((int)local_1a8 <= (int)uVar3);
                        }
                      }
                    }
                  }
                  uVar11 = *(ushort *)(*(longlong *)(param_1 + 0x150) + 0x12);
                  local_1a8 = local_1a8 & 0xffff0000;
                  if (uVar11 != 0) {
                    lVar5 = 0xe;
                    if (local_19c == uVar18) {
                      lVar5 = 0xc;
                    }
                    if ((ushort *)(lVar5 + (longlong)local_70) <= local_118) {
                      if ((int)local_190 == 0) {
                        iVar4 = (uVar18 & 0xffffff00 | (uint)(local_19c != uVar18)) + 7;
                        puVar6 = local_70;
                        local_1a4 = local_78;
                        if (local_118 == (ushort *)0x0) {
                          local_1a4 = local_cc;
                        }
                        do {
                          if (((local_118 <= puVar6) ||
                              (((uVar8 = *puVar6, uVar8 == 0 && (local_1a4 != uVar18)) ||
                               (puVar1 = (ushort *)(*(longlong *)(param_1 + 0x150) + 6),
                               *puVar1 <= uVar8 && uVar8 != *puVar1)))) ||
                             (uVar8 < *(ushort *)(*(longlong *)(param_1 + 0x150) + 4))) break;
                          puVar6 = puVar6 + 1;
                          iVar4 = iVar4 + -1;
                        } while (0 < iVar4);
                        uVar12 = (ulonglong)local_e4;
                        local_190 = (longlong)puVar6 - (longlong)local_70 >> 1 & 0xffffffff;
                      }
                      if (6 < (int)local_190) {
                        local_1a0 = uVar11 - 1;
                        uVar14 = uVar19 & 0xffffffff;
                        local_198 = (uint)uVar14;
                        if ((local_19c != uVar18) && (7 < (int)local_190)) {
                          uVar11 = *local_70;
                          if (local_178 == 0) {
                            uVar3 = *(uint *)(DAT_1800b2b88 + (ulonglong)uVar11 * 4);
                            uVar21 = *(uint *)(DAT_1800b2b88 + (ulonglong)local_70[1] * 4);
                          }
                          else {
                            uVar3 = *(uint *)(DAT_1800b2b88 +
                                             (ulonglong)
                                             (*(int *)(local_178 + (ulonglong)(uVar11 >> 8) * 4) +
                                             (uint)(byte)uVar11) * 4);
                            uVar21 = *(uint *)(DAT_1800b2b88 +
                                              (ulonglong)
                                              (*(int *)(local_178 +
                                                       (ulonglong)(local_70[1] >> 8) * 4) +
                                              (uint)(byte)local_70[1]) * 4);
                          }
                          if (((uVar21 ^ uVar3) & 0xe7ffffff) == 0) {
                            uVar14 = uVar20 & 0xffffffff;
                          }
                          local_198 = (uint)uVar14;
                        }
                        local_1a8 = uVar18;
                        if (-1 < (int)local_1a0) {
                          local_128 = local_70 + uVar14;
                          do {
                            local_1a4 = 7;
                            local_194 = (int)(local_1a0 + local_1a8) / 2;
                            local_168 = (ushort *)(longlong)(local_194 * 10);
                            puVar6 = (ushort *)
                                     (*(longlong *)(param_1 + 0x180) + (longlong)local_168 * 2);
                            local_130 = (longlong)local_128 - (longlong)puVar6;
                            while (iVar4 = (uint)*(ushort *)((longlong)puVar6 + local_130) -
                                           (uint)*puVar6,
                                  (uint)*(ushort *)((longlong)puVar6 + local_130) == (uint)*puVar6)
                            {
                              puVar6 = puVar6 + 1;
                              local_1a4 = local_1a4 - 1;
                              if ((int)local_1a4 < 1) {
                                local_64 = *(uint *)(*(longlong *)(param_1 + 0x180) + 0x10 +
                                                    (longlong)local_168 * 2);
                                uVar22 = local_cc;
                                if (local_198 == uVar18) {
                                  puVar7 = local_70 + 6;
                                }
                                goto LAB_18002953a;
                              }
                            }
                            uVar3 = local_194 - 1;
                            if (-1 < iVar4) {
                              uVar3 = local_1a0;
                            }
                            if (-1 < iVar4) {
                              local_1a8 = local_194 + 1;
                            }
                            local_1a0 = uVar3;
                          } while ((int)local_1a8 <= (int)uVar3);
                        }
                      }
                    }
                  }
                  uVar11 = *(ushort *)(*(longlong *)(param_1 + 0x150) + 0x10);
                  local_1a8 = local_1a8 & 0xffff0000;
                  if (uVar11 != 0) {
                    lVar5 = 0xc;
                    if (local_19c == uVar18) {
                      lVar5 = 10;
                    }
                    if ((ushort *)(lVar5 + (longlong)local_70) <= local_118) {
                      if ((int)local_190 == 0) {
                        iVar4 = (uVar18 & 0xffffff00 | (uint)(local_19c != uVar18)) + 6;
                        puVar6 = local_70;
                        local_1a4 = local_78;
                        if (local_118 == (ushort *)0x0) {
                          local_1a4 = local_cc;
                        }
                        do {
                          if (((local_118 <= puVar6) ||
                              ((uVar8 = *puVar6, uVar8 == 0 && (local_1a4 != uVar18)))) ||
                             ((puVar1 = (ushort *)(*(longlong *)(param_1 + 0x150) + 6),
                              *puVar1 <= uVar8 && uVar8 != *puVar1 ||
                              (uVar8 < *(ushort *)(*(longlong *)(param_1 + 0x150) + 4))))) break;
                          puVar6 = puVar6 + 1;
                          iVar4 = iVar4 + -1;
                        } while (0 < iVar4);
                        uVar12 = (ulonglong)local_e4;
                        local_190 = (longlong)puVar6 - (longlong)local_70 >> 1 & 0xffffffff;
                      }
                      if (5 < (int)local_190) {
                        local_1a0 = uVar11 - 1;
                        uVar14 = uVar19 & 0xffffffff;
                        local_198 = (uint)uVar14;
                        if ((local_19c != uVar18) && (6 < (int)local_190)) {
                          uVar11 = *local_70;
                          if (local_178 == 0) {
                            uVar3 = *(uint *)(DAT_1800b2b88 + (ulonglong)uVar11 * 4);
                            uVar21 = *(uint *)(DAT_1800b2b88 + (ulonglong)local_70[1] * 4);
                          }
                          else {
                            uVar3 = *(uint *)(DAT_1800b2b88 +
                                             (ulonglong)
                                             (*(int *)(local_178 + (ulonglong)(uVar11 >> 8) * 4) +
                                             (uint)(byte)uVar11) * 4);
                            uVar21 = *(uint *)(DAT_1800b2b88 +
                                              (ulonglong)
                                              (*(int *)(local_178 +
                                                       (ulonglong)(local_70[1] >> 8) * 4) +
                                              (uint)(byte)local_70[1]) * 4);
                          }
                          if (((uVar21 ^ uVar3) & 0xe7ffffff) == 0) {
                            uVar14 = uVar20 & 0xffffffff;
                          }
                          local_198 = (uint)uVar14;
                        }
                        local_1a8 = uVar18;
                        if (-1 < (int)local_1a0) {
                          local_128 = local_70 + uVar14;
                          do {
                            local_1a4 = 6;
                            local_194 = (int)(local_1a0 + local_1a8) / 2;
                            local_168 = (ushort *)(longlong)(local_194 * 8);
                            puVar6 = (ushort *)
                                     (*(longlong *)(param_1 + 0x178) + (longlong)local_168 * 2);
                            local_130 = (longlong)local_128 - (longlong)puVar6;
                            while (iVar4 = (uint)*(ushort *)((longlong)puVar6 + local_130) -
                                           (uint)*puVar6,
                                  (uint)*(ushort *)((longlong)puVar6 + local_130) == (uint)*puVar6)
                            {
                              puVar6 = puVar6 + 1;
                              local_1a4 = local_1a4 - 1;
                              if ((int)local_1a4 < 1) {
                                local_64 = *(uint *)(*(longlong *)(param_1 + 0x178) + 0xc +
                                                    (longlong)local_168 * 2);
                                uVar22 = local_cc;
                                if (local_198 == uVar18) {
                                  puVar7 = local_70 + 5;
                                }
                                goto LAB_18002953a;
                              }
                            }
                            uVar3 = local_194 - 1;
                            if (-1 < iVar4) {
                              uVar3 = local_1a0;
                            }
                            if (-1 < iVar4) {
                              local_1a8 = local_194 + 1;
                            }
                            local_1a0 = uVar3;
                          } while ((int)local_1a8 <= (int)uVar3);
                        }
                        goto LAB_180028cda;
                      }
                    }
                  }
                  goto LAB_180028cdf;
                }
              }
LAB_18002953a:
              if (uVar22 == 0) {
                puVar7 = local_70;
              }
              local_150 = local_70;
              if (local_70 == puVar7) goto LAB_18002954b;
            }
            goto LAB_180002d65;
          }
          if (5 < (byte)(bVar10 - 7)) goto LAB_180002d65;
        }
        if ((int)uVar12 == 0) goto LAB_180002d65;
LAB_18002954b:
        uVar14 = (ulonglong)local_68;
      }
LAB_18002954e:
      local_70 = local_70 + 1;
    } while (local_70 < local_118);
  }
  else {
LAB_180002d65:
    if (local_70 < local_118) {
      if (param_3 < local_b0) {
        uVar14 = uVar19 & 0xffffffff;
        local_70 = param_5;
        do {
          uVar11 = *local_a0;
          iVar4 = (int)uVar14;
          if (local_178 == 0) {
            bVar10 = (byte)((uint)*(undefined4 *)(DAT_1800b2b88 + (ulonglong)uVar11 * 4) >> 8);
          }
          else {
            bVar10 = (byte)((uint)*(undefined4 *)
                                   (DAT_1800b2b88 +
                                   (ulonglong)
                                   (*(int *)(local_178 + (ulonglong)(uVar11 >> 8) * 4) +
                                   (uint)(byte)uVar11) * 4) >> 8);
          }
          if (0xc < bVar10) goto LAB_180002daf;
          if (bVar10 == 7) {
LAB_180002f66:
            if ((int)uVar12 == 0) goto LAB_180002daf;
LAB_18002a524:
            uVar14 = (ulonglong)local_98;
          }
          else {
            if (bVar10 != 0) {
              if (bVar10 == 6) goto LAB_180002f66;
              if (bVar10 == 1) {
                if ((local_188 != 0) || (local_d4 != 0)) {
                  if (*(ulonglong *)(param_1 + 0x150) == uVar19) goto LAB_18002a524;
                  local_8e = *local_a0;
                  uVar11 = *local_a0;
                  if (local_178 == 0) {
                    local_94 = *(uint *)(DAT_1800b2b88 + (ulonglong)uVar11 * 4);
                  }
                  else {
                    local_94 = *(uint *)(DAT_1800b2b88 +
                                        (ulonglong)
                                        (*(int *)(local_178 + (ulonglong)(uVar11 >> 8) * 4) +
                                        (uint)(byte)uVar11) * 4);
                  }
                  uVar3 = uVar18;
                  if ((char)(local_94 >> 8) != '\x03') {
                    uVar3 = 0xc0;
                  }
                  uVar3 = uVar3 & local_94 >> 0x18;
                  uVar22 = uVar18;
                  puVar7 = local_a0;
                  uVar14 = uVar19;
                  if (uVar3 == 0x40) {
LAB_18002a0ce:
                    local_198 = *(uint *)(param_1 + 0x140) & 0x20;
                    uVar11 = *(ushort *)(*(longlong *)(param_1 + 0x150) + 10);
                    local_1a8 = local_1a8 & 0xffff0000;
                    if (uVar11 != 0) {
                      lVar5 = 6;
                      if (local_198 == 0) {
                        lVar5 = 4;
                      }
                      if ((ushort *)(lVar5 + (longlong)local_a0) <= local_b0) {
                        if (uVar22 == 0) {
                          iVar4 = (uVar18 & 0xffffff00 | (uint)(local_198 != 0)) + 3;
                          uVar15 = (ulonglong)local_a8;
                          puVar6 = local_a0;
                          if (local_b0 == (ushort *)0x0) {
                            uVar15 = uVar20 & 0xffffffff;
                          }
                          do {
                            if ((((local_b0 <= puVar6) ||
                                 ((uVar8 = *puVar6, uVar8 == 0 && ((int)uVar15 != 0)))) ||
                                (puVar1 = (ushort *)(*(longlong *)(param_1 + 0x150) + 6),
                                *puVar1 <= uVar8 && uVar8 != *puVar1)) ||
                               (uVar8 < *(ushort *)(*(longlong *)(param_1 + 0x150) + 4))) break;
                            puVar6 = puVar6 + 1;
                            iVar4 = iVar4 + -1;
                          } while (0 < iVar4);
                          uVar22 = (uint)((longlong)puVar6 - (longlong)local_a0 >> 1);
                        }
                        if (2 < (int)uVar22) {
                          uVar15 = uVar19 & 0xffffffff;
                          local_1a0 = uVar11 - 1;
                          local_1a8 = (uint)uVar15;
                          if ((local_198 != uVar18) && (3 < (int)uVar22)) {
                            uVar11 = *local_a0;
                            if (local_178 == uVar15) {
                              local_1a4 = *(uint *)(DAT_1800b2b88 + (ulonglong)uVar11 * 4);
                              uVar3 = *(uint *)(DAT_1800b2b88 + (ulonglong)local_a0[1] * 4);
                            }
                            else {
                              local_1a4 = *(uint *)(DAT_1800b2b88 +
                                                   (ulonglong)
                                                   (*(int *)(local_178 +
                                                            (ulonglong)(uVar11 >> 8) * 4) +
                                                   (uint)(byte)uVar11) * 4);
                              uVar12 = (ulonglong)local_e4;
                              uVar3 = *(uint *)(DAT_1800b2b88 +
                                               (ulonglong)
                                               (*(int *)(local_178 +
                                                        (ulonglong)(local_a0[1] >> 8) * 4) +
                                               (uint)(byte)local_a0[1]) * 4);
                            }
                            if (((uVar3 ^ local_1a4) & 0xe7ffffff) == 0) {
                              uVar15 = uVar20 & 0xffffffff;
                            }
                            local_1a8 = (uint)uVar15;
                          }
                          local_19c = uVar18;
                          if (-1 < (int)local_1a0) {
                            local_140 = local_a0 + uVar15;
                            do {
                              local_1a4 = 3;
                              local_194 = (int)(local_1a0 + local_19c) / 2;
                              local_160 = (ushort *)(longlong)(local_194 * 6);
                              puVar6 = (ushort *)
                                       (*(longlong *)(param_1 + 0x160) + (longlong)local_160 * 2);
                              local_148 = (ushort *)((longlong)local_140 - (longlong)puVar6);
                              while (iVar4 = (uint)*(ushort *)
                                                    ((longlong)puVar6 + (longlong)local_148) -
                                             (uint)*puVar6,
                                    (uint)*(ushort *)((longlong)puVar6 + (longlong)local_148) ==
                                    (uint)*puVar6) {
                                puVar6 = puVar6 + 1;
                                local_1a4 = local_1a4 - 1;
                                if ((int)local_1a4 < 1) {
                                  local_94 = *(uint *)(*(longlong *)(param_1 + 0x160) + 8 +
                                                      (longlong)local_160 * 2);
                                  uVar14 = uVar20;
                                  if (local_1a8 == uVar18) {
                                    puVar7 = local_a0 + 2;
                                  }
                                  goto LAB_18002a510;
                                }
                              }
                              uVar3 = local_194 - 1;
                              if (-1 < iVar4) {
                                uVar3 = local_1a0;
                              }
                              if (-1 < iVar4) {
                                local_19c = local_194 + 1;
                              }
                              local_1a0 = uVar3;
                            } while ((int)local_19c <= (int)uVar3);
                          }
                        }
                      }
                    }
                    uVar11 = *(ushort *)(*(longlong *)(param_1 + 0x150) + 8);
                    local_1a8 = local_1a8 & 0xffff0000 | (uint)uVar11;
                    if (uVar11 != 0) {
                      lVar5 = 4;
                      if (local_198 == uVar18) {
                        lVar5 = 2;
                      }
                      if ((ushort *)(lVar5 + (longlong)local_a0) <= local_b0) {
                        if (uVar22 == 0) {
                          iVar4 = (uVar18 & 0xffffff00 | (uint)(local_198 != uVar18)) + 2;
                          uVar12 = (ulonglong)local_a8;
                          puVar6 = local_a0;
                          if (local_b0 == (ushort *)0x0) {
                            uVar12 = uVar20 & 0xffffffff;
                          }
                          do {
                            if (((local_b0 <= puVar6) ||
                                (((uVar8 = *puVar6, uVar8 == 0 && ((int)uVar12 != 0)) ||
                                 (puVar1 = (ushort *)(*(longlong *)(param_1 + 0x150) + 6),
                                 *puVar1 <= uVar8 && uVar8 != *puVar1)))) ||
                               (uVar8 < *(ushort *)(*(longlong *)(param_1 + 0x150) + 4))) break;
                            puVar6 = puVar6 + 1;
                            iVar4 = iVar4 + -1;
                          } while (0 < iVar4);
                          uVar12 = (ulonglong)local_e4;
                          uVar22 = (uint)((longlong)puVar6 - (longlong)local_a0 >> 1);
                        }
                        if (1 < (int)uVar22) {
                          local_1a4 = uVar11 - 1;
                          uVar15 = uVar19 & 0xffffffff;
                          local_19c = (uint)uVar15;
                          if ((local_198 != uVar18) && (2 < (int)uVar22)) {
                            uVar11 = *local_a0;
                            if (local_178 == 0) {
                              uVar3 = *(uint *)(DAT_1800b2b88 + (ulonglong)uVar11 * 4);
                              uVar22 = *(uint *)(DAT_1800b2b88 + (ulonglong)local_a0[1] * 4);
                            }
                            else {
                              uVar3 = *(uint *)(DAT_1800b2b88 +
                                               (ulonglong)
                                               (*(int *)(local_178 + (ulonglong)(uVar11 >> 8) * 4) +
                                               (uint)(byte)uVar11) * 4);
                              uVar22 = *(uint *)(DAT_1800b2b88 +
                                                (ulonglong)
                                                (*(int *)(local_178 +
                                                         (ulonglong)(local_a0[1] >> 8) * 4) +
                                                (uint)(byte)local_a0[1]) * 4);
                            }
                            if (((uVar22 ^ uVar3) & 0xe7ffffff) == 0) {
                              uVar15 = uVar20 & 0xffffffff;
                            }
                            local_19c = (uint)uVar15;
                          }
                          uVar9 = uVar19 & 0xffffffff;
                          local_1a0 = uVar18;
                          if (-1 < (int)local_1a4) {
                            local_148 = local_a0 + uVar15;
                            do {
                              uVar3 = (int)(local_1a4 + (int)uVar9) / 2;
                              local_168 = (ushort *)
                                          ((ulonglong)local_168 & 0xffffffff00000000 |
                                          (ulonglong)uVar3);
                              iVar4 = 2;
                              local_160 = (ushort *)(longlong)(int)(uVar3 * 4);
                              puVar6 = (ushort *)
                                       (*(longlong *)(param_1 + 0x158) + (longlong)local_160 * 2);
                              local_140 = (ushort *)((longlong)local_148 - (longlong)puVar6);
                              while ((uint)*(ushort *)((longlong)puVar6 + (longlong)local_140) ==
                                     (uint)*puVar6) {
                                puVar6 = puVar6 + 1;
                                iVar4 = iVar4 + -1;
                                if (iVar4 < 1) {
                                  local_94 = *(uint *)(*(longlong *)(param_1 + 0x158) + 4 +
                                                      (longlong)local_160 * 2);
                                  uVar14 = uVar20;
                                  if (local_19c == uVar18) {
                                    puVar7 = local_a0 + 1;
                                  }
                                  goto LAB_18002a510;
                                }
                              }
                              bVar23 = -1 < (int)((uint)*(ushort *)
                                                         ((longlong)puVar6 + (longlong)local_140) -
                                                 (uint)*puVar6);
                              uVar22 = uVar3 - 1;
                              if (bVar23) {
                                uVar22 = local_1a4;
                              }
                              local_1a4 = uVar22;
                              if (bVar23) {
                                local_1a0 = uVar3 + 1;
                              }
                              uVar9 = (ulonglong)local_1a0;
                            } while ((int)local_1a0 <= (int)local_1a4);
                          }
                        }
                      }
                    }
                  }
                  else {
                    if (uVar3 == 0x80) {
LAB_180029cac:
                      local_198 = *(uint *)(param_1 + 0x140) & 0x20;
                      uVar11 = *(ushort *)(*(longlong *)(param_1 + 0x150) + 0xe);
                      local_1a8 = local_1a8 & 0xffff0000;
                      if (uVar11 != 0) {
                        lVar5 = 10;
                        if (local_198 == 0) {
                          lVar5 = 8;
                        }
                        if ((ushort *)(lVar5 + (longlong)local_a0) <= local_b0) {
                          if (uVar22 == 0) {
                            iVar4 = (uVar18 & 0xffffff00 | (uint)(local_198 != 0)) + 5;
                            uVar12 = (ulonglong)local_a8;
                            puVar6 = local_a0;
                            if (local_b0 == (ushort *)0x0) {
                              uVar12 = uVar20 & 0xffffffff;
                            }
                            do {
                              if (((local_b0 <= puVar6) ||
                                  ((uVar8 = *puVar6, uVar8 == 0 && ((int)uVar12 != 0)))) ||
                                 ((puVar1 = (ushort *)(*(longlong *)(param_1 + 0x150) + 6),
                                  *puVar1 <= uVar8 && uVar8 != *puVar1 ||
                                  (uVar8 < *(ushort *)(*(longlong *)(param_1 + 0x150) + 4)))))
                              break;
                              puVar6 = puVar6 + 1;
                              iVar4 = iVar4 + -1;
                            } while (0 < iVar4);
                            uVar12 = (ulonglong)local_e4;
                            uVar22 = (uint)((longlong)puVar6 - (longlong)local_a0 >> 1);
                          }
                          if (4 < (int)uVar22) {
                            local_194 = uVar11 - 1;
                            uVar15 = uVar19 & 0xffffffff;
                            local_1a0 = (uint)uVar15;
                            local_19c = (uint)(uVar19 & 0xffffffff);
                            if ((local_198 != uVar18) && (5 < (int)uVar22)) {
                              uVar11 = *local_a0;
                              if (local_178 == (uVar19 & 0xffffffff)) {
                                local_1a4 = *(uint *)(DAT_1800b2b88 + (ulonglong)uVar11 * 4);
                                uVar3 = *(uint *)(DAT_1800b2b88 + (ulonglong)local_a0[1] * 4);
                              }
                              else {
                                local_1a4 = *(uint *)(DAT_1800b2b88 +
                                                     (ulonglong)
                                                     (*(int *)(local_178 +
                                                              (ulonglong)(uVar11 >> 8) * 4) +
                                                     (uint)(byte)uVar11) * 4);
                                uVar3 = *(uint *)(DAT_1800b2b88 +
                                                 (ulonglong)
                                                 (*(int *)(local_178 +
                                                          (ulonglong)(local_a0[1] >> 8) * 4) +
                                                 (uint)(byte)local_a0[1]) * 4);
                              }
                              if (((uVar3 ^ local_1a4) & 0xe7ffffff) == 0) {
                                uVar15 = uVar20 & 0xffffffff;
                              }
                              local_1a0 = (uint)uVar15;
                            }
                            uVar9 = uVar19 & 0xffffffff;
                            if (-1 < local_194) {
                              local_140 = local_a0 + uVar15;
                              do {
                                local_1a4 = 5;
                                local_1a8 = (local_194 + (int)uVar9) / 2;
                                local_160 = (ushort *)(longlong)(int)(local_1a8 * 8);
                                puVar6 = (ushort *)
                                         (*(longlong *)(param_1 + 0x170) + (longlong)local_160 * 2);
                                local_148 = (ushort *)((longlong)local_140 - (longlong)puVar6);
                                while (iVar4 = (uint)*(ushort *)
                                                      ((longlong)puVar6 + (longlong)local_148) -
                                               (uint)*puVar6,
                                      (uint)*(ushort *)((longlong)puVar6 + (longlong)local_148) ==
                                      (uint)*puVar6) {
                                  puVar6 = puVar6 + 1;
                                  local_1a4 = local_1a4 - 1;
                                  if ((int)local_1a4 < 1) {
                                    local_94 = *(uint *)(*(longlong *)(param_1 + 0x170) + 0xc +
                                                        (longlong)local_160 * 2);
                                    uVar14 = uVar20;
                                    if (local_1a0 == uVar18) {
                                      puVar7 = local_a0 + 4;
                                    }
                                    goto LAB_18002a510;
                                  }
                                }
                                uVar12 = (ulonglong)local_e4;
                                iVar13 = local_1a8 - 1;
                                if (-1 < iVar4) {
                                  iVar13 = local_194;
                                }
                                local_194 = iVar13;
                                if (-1 < iVar4) {
                                  local_19c = local_1a8 + 1;
                                }
                                uVar9 = (ulonglong)local_19c;
                              } while ((int)local_19c <= local_194);
                            }
                          }
                        }
                      }
                      uVar11 = *(ushort *)(*(longlong *)(param_1 + 0x150) + 0xc);
                      local_1a8 = local_1a8 & 0xffff0000;
                      if (uVar11 != 0) {
                        lVar5 = 8;
                        if (local_198 == 0) {
                          lVar5 = 6;
                        }
                        if ((ushort *)(lVar5 + (longlong)local_a0) <= local_b0) {
                          if (uVar22 == 0) {
                            iVar4 = (uVar18 & 0xffffff00 | (uint)(local_198 != 0)) + 4;
                            uVar15 = (ulonglong)local_a8;
                            puVar6 = local_a0;
                            if (local_b0 == (ushort *)0x0) {
                              uVar15 = uVar20 & 0xffffffff;
                            }
                            do {
                              if ((local_b0 <= puVar6) ||
                                 ((((uVar8 = *puVar6, uVar8 == 0 && ((int)uVar15 != 0)) ||
                                   (puVar1 = (ushort *)(*(longlong *)(param_1 + 0x150) + 6),
                                   *puVar1 <= uVar8 && uVar8 != *puVar1)) ||
                                  (uVar8 < *(ushort *)(*(longlong *)(param_1 + 0x150) + 4)))))
                              break;
                              puVar6 = puVar6 + 1;
                              iVar4 = iVar4 + -1;
                            } while (0 < iVar4);
                            uVar22 = (uint)((longlong)puVar6 - (longlong)local_a0 >> 1);
                          }
                          if (3 < (int)uVar22) {
                            uVar15 = uVar19 & 0xffffffff;
                            local_1a0 = uVar11 - 1;
                            local_1a8 = (uint)uVar15;
                            if ((local_198 != uVar18) && (4 < (int)uVar22)) {
                              uVar11 = *local_a0;
                              if (local_178 == uVar15) {
                                local_1a4 = *(uint *)(DAT_1800b2b88 + (ulonglong)uVar11 * 4);
                                uVar3 = *(uint *)(DAT_1800b2b88 + (ulonglong)local_a0[1] * 4);
                              }
                              else {
                                local_1a4 = *(uint *)(DAT_1800b2b88 +
                                                     (ulonglong)
                                                     (*(int *)(local_178 +
                                                              (ulonglong)(uVar11 >> 8) * 4) +
                                                     (uint)(byte)uVar11) * 4);
                                uVar12 = (ulonglong)local_e4;
                                uVar3 = *(uint *)(DAT_1800b2b88 +
                                                 (ulonglong)
                                                 (*(int *)(local_178 +
                                                          (ulonglong)(local_a0[1] >> 8) * 4) +
                                                 (uint)(byte)local_a0[1]) * 4);
                              }
                              if (((uVar3 ^ local_1a4) & 0xe7ffffff) == 0) {
                                uVar15 = uVar20 & 0xffffffff;
                              }
                              local_1a8 = (uint)uVar15;
                            }
                            local_19c = uVar18;
                            if (-1 < (int)local_1a0) {
                              local_140 = local_a0 + uVar15;
                              do {
                                local_1a4 = 4;
                                local_194 = (int)(local_1a0 + local_19c) / 2;
                                local_160 = (ushort *)(longlong)(local_194 * 6);
                                puVar6 = (ushort *)
                                         (*(longlong *)(param_1 + 0x168) + (longlong)local_160 * 2);
                                local_148 = (ushort *)((longlong)local_140 - (longlong)puVar6);
                                while (iVar4 = (uint)*(ushort *)
                                                      ((longlong)puVar6 + (longlong)local_148) -
                                               (uint)*puVar6,
                                      (uint)*(ushort *)((longlong)puVar6 + (longlong)local_148) ==
                                      (uint)*puVar6) {
                                  puVar6 = puVar6 + 1;
                                  local_1a4 = local_1a4 - 1;
                                  if ((int)local_1a4 < 1) {
                                    local_94 = *(uint *)(*(longlong *)(param_1 + 0x168) + 8 +
                                                        (longlong)local_160 * 2);
                                    uVar14 = uVar20;
                                    if (local_1a8 == uVar18) {
                                      puVar7 = local_a0 + 3;
                                    }
                                    goto LAB_18002a510;
                                  }
                                }
                                uVar12 = (ulonglong)local_e4;
                                uVar3 = local_194 - 1;
                                if (-1 < iVar4) {
                                  uVar3 = local_1a0;
                                }
                                if (-1 < iVar4) {
                                  local_19c = local_194 + 1;
                                }
                                local_1a0 = uVar3;
                              } while ((int)local_19c <= (int)uVar3);
                            }
                          }
                        }
                      }
                      goto LAB_18002a0ce;
                    }
                    if (uVar3 == 0xc0) {
                      local_19c = *(uint *)(param_1 + 0x140) & 0x20;
                      puVar6 = (ushort *)(*(longlong *)(param_1 + 0x150) + 0x14);
                      if (uVar17 <= *puVar6 && *puVar6 != uVar17) {
                        lVar5 = 0x10;
                        if (local_19c == 0) {
                          lVar5 = 0xe;
                        }
                        if ((ushort *)(lVar5 + (longlong)local_a0) <= local_b0) {
                          iVar4 = (uVar18 & 0xffffff00 | (uint)(local_19c != 0)) + 8;
                          uVar12 = (ulonglong)local_a8;
                          puVar6 = local_a0;
                          if (local_b0 == (ushort *)0x0) {
                            uVar12 = uVar20 & 0xffffffff;
                          }
                          do {
                            if (((local_b0 <= puVar6) ||
                                (((uVar11 = *puVar6, uVar11 == 0 && ((int)uVar12 != 0)) ||
                                 (puVar1 = (ushort *)(*(longlong *)(param_1 + 0x150) + 6),
                                 *puVar1 <= uVar11 && uVar11 != *puVar1)))) ||
                               (uVar11 < *(ushort *)(*(longlong *)(param_1 + 0x150) + 4))) break;
                            puVar6 = puVar6 + 1;
                            iVar4 = iVar4 + -1;
                          } while (0 < iVar4);
                          uVar22 = (uint)((longlong)puVar6 - (longlong)local_a0 >> 1);
                          if (7 < (int)uVar22) {
                            uVar12 = uVar19 & 0xffffffff;
                            local_198 = (uint)uVar12;
                            local_1a0 = *(ushort *)(*(longlong *)(param_1 + 0x150) + 0x14) - 1;
                            if ((local_19c != uVar18) && (8 < (int)uVar22)) {
                              uVar11 = *local_a0;
                              if (local_178 == uVar12) {
                                local_1a4 = *(uint *)(DAT_1800b2b88 + (ulonglong)uVar11 * 4);
                                uVar3 = *(uint *)(DAT_1800b2b88 + (ulonglong)local_a0[1] * 4);
                              }
                              else {
                                local_1a4 = *(uint *)(DAT_1800b2b88 +
                                                     (ulonglong)
                                                     (*(int *)(local_178 +
                                                              (ulonglong)(uVar11 >> 8) * 4) +
                                                     (uint)(byte)uVar11) * 4);
                                uVar3 = *(uint *)(DAT_1800b2b88 +
                                                 (ulonglong)
                                                 (*(int *)(local_178 +
                                                          (ulonglong)(local_a0[1] >> 8) * 4) +
                                                 (uint)(byte)local_a0[1]) * 4);
                              }
                              if (((uVar3 ^ local_1a4) & 0xe7ffffff) == 0) {
                                uVar12 = uVar20 & 0xffffffff;
                              }
                              local_198 = (uint)uVar12;
                            }
                            local_1a8 = uVar18;
                            if (-1 < (int)local_1a0) {
                              local_140 = local_a0 + uVar12;
                              do {
                                uVar12 = (ulonglong)local_e4;
                                local_1a4 = 8;
                                local_194 = (int)(local_1a0 + local_1a8) / 2;
                                local_160 = (ushort *)(longlong)(local_194 * 10);
                                puVar6 = (ushort *)
                                         (*(longlong *)(param_1 + 0x188) + (longlong)local_160 * 2);
                                local_148 = (ushort *)((longlong)local_140 - (longlong)puVar6);
                                while (iVar4 = (uint)*(ushort *)
                                                      ((longlong)puVar6 + (longlong)local_148) -
                                               (uint)*puVar6,
                                      (uint)*(ushort *)((longlong)puVar6 + (longlong)local_148) ==
                                      (uint)*puVar6) {
                                  puVar6 = puVar6 + 1;
                                  local_1a4 = local_1a4 - 1;
                                  if ((int)local_1a4 < 1) {
                                    local_94 = *(uint *)(*(longlong *)(param_1 + 0x188) + 0x10 +
                                                        (longlong)local_160 * 2);
                                    uVar14 = uVar20;
                                    if (local_198 == uVar18) {
                                      puVar7 = local_a0 + 7;
                                    }
                                    goto LAB_18002a510;
                                  }
                                }
                                uVar3 = local_194 - 1;
                                if (-1 < iVar4) {
                                  uVar3 = local_1a0;
                                }
                                if (-1 < iVar4) {
                                  local_1a8 = local_194 + 1;
                                }
                                local_1a0 = uVar3;
                              } while ((int)local_1a8 <= (int)uVar3);
                            }
                          }
                          uVar12 = (ulonglong)local_e4;
                        }
                      }
                      uVar11 = *(ushort *)(*(longlong *)(param_1 + 0x150) + 0x12);
                      local_1a8 = local_1a8 & 0xffff0000;
                      if (uVar11 != 0) {
                        lVar5 = 0xe;
                        if (local_19c == 0) {
                          lVar5 = 0xc;
                        }
                        if ((ushort *)(lVar5 + (longlong)local_a0) <= local_b0) {
                          if (uVar22 == 0) {
                            iVar4 = (uVar18 & 0xffffff00 | (uint)(local_19c != 0)) + 7;
                            uVar12 = (ulonglong)local_a8;
                            puVar6 = local_a0;
                            if (local_b0 == (ushort *)0x0) {
                              uVar12 = uVar20 & 0xffffffff;
                            }
                            do {
                              if (((local_b0 <= puVar6) ||
                                  ((uVar8 = *puVar6, uVar8 == 0 && ((int)uVar12 != 0)))) ||
                                 ((puVar1 = (ushort *)(*(longlong *)(param_1 + 0x150) + 6),
                                  *puVar1 <= uVar8 && uVar8 != *puVar1 ||
                                  (uVar8 < *(ushort *)(*(longlong *)(param_1 + 0x150) + 4)))))
                              break;
                              puVar6 = puVar6 + 1;
                              iVar4 = iVar4 + -1;
                            } while (0 < iVar4);
                            uVar12 = (ulonglong)local_e4;
                            uVar22 = (uint)((longlong)puVar6 - (longlong)local_a0 >> 1);
                          }
                          if (6 < (int)uVar22) {
                            uVar15 = uVar19 & 0xffffffff;
                            local_1a0 = uVar11 - 1;
                            local_198 = (uint)uVar15;
                            if ((local_19c != uVar18) && (7 < (int)uVar22)) {
                              uVar11 = *local_a0;
                              if (local_178 == uVar15) {
                                local_1a4 = *(uint *)(DAT_1800b2b88 + (ulonglong)uVar11 * 4);
                                uVar3 = *(uint *)(DAT_1800b2b88 + (ulonglong)local_a0[1] * 4);
                              }
                              else {
                                local_1a4 = *(uint *)(DAT_1800b2b88 +
                                                     (ulonglong)
                                                     (*(int *)(local_178 +
                                                              (ulonglong)(uVar11 >> 8) * 4) +
                                                     (uint)(byte)uVar11) * 4);
                                uVar3 = *(uint *)(DAT_1800b2b88 +
                                                 (ulonglong)
                                                 (*(int *)(local_178 +
                                                          (ulonglong)(local_a0[1] >> 8) * 4) +
                                                 (uint)(byte)local_a0[1]) * 4);
                              }
                              if (((uVar3 ^ local_1a4) & 0xe7ffffff) == 0) {
                                uVar15 = uVar20 & 0xffffffff;
                              }
                              local_198 = (uint)uVar15;
                            }
                            local_1a8 = uVar18;
                            if (-1 < (int)local_1a0) {
                              local_140 = local_a0 + uVar15;
                              do {
                                local_1a4 = 7;
                                local_194 = (int)(local_1a0 + local_1a8) / 2;
                                local_160 = (ushort *)(longlong)(local_194 * 10);
                                puVar6 = (ushort *)
                                         (*(longlong *)(param_1 + 0x180) + (longlong)local_160 * 2);
                                local_148 = (ushort *)((longlong)local_140 - (longlong)puVar6);
                                while (iVar4 = (uint)*(ushort *)
                                                      ((longlong)puVar6 + (longlong)local_148) -
                                               (uint)*puVar6,
                                      (uint)*(ushort *)((longlong)puVar6 + (longlong)local_148) ==
                                      (uint)*puVar6) {
                                  puVar6 = puVar6 + 1;
                                  local_1a4 = local_1a4 - 1;
                                  if ((int)local_1a4 < 1) {
                                    local_94 = *(uint *)(*(longlong *)(param_1 + 0x180) + 0x10 +
                                                        (longlong)local_160 * 2);
                                    uVar14 = uVar20;
                                    if (local_198 == uVar18) {
                                      puVar7 = local_a0 + 6;
                                    }
                                    goto LAB_18002a510;
                                  }
                                }
                                uVar3 = local_194 - 1;
                                if (-1 < iVar4) {
                                  uVar3 = local_1a0;
                                }
                                if (-1 < iVar4) {
                                  local_1a8 = local_194 + 1;
                                }
                                local_1a0 = uVar3;
                              } while ((int)local_1a8 <= (int)uVar3);
                            }
                          }
                        }
                      }
                      uVar11 = *(ushort *)(*(longlong *)(param_1 + 0x150) + 0x10);
                      local_1a8 = local_1a8 & 0xffff0000;
                      if (uVar11 != 0) {
                        lVar5 = 0xc;
                        if (local_19c == uVar18) {
                          lVar5 = 10;
                        }
                        if ((ushort *)(lVar5 + (longlong)local_a0) <= local_b0) {
                          if (uVar22 == 0) {
                            iVar4 = (uVar18 & 0xffffff00 | (uint)(local_19c != uVar18)) + 6;
                            uVar12 = (ulonglong)local_a8;
                            puVar6 = local_a0;
                            if (local_b0 == (ushort *)0x0) {
                              uVar12 = uVar20 & 0xffffffff;
                            }
                            do {
                              if (((local_b0 <= puVar6) ||
                                  (((uVar8 = *puVar6, uVar8 == 0 && ((int)uVar12 != 0)) ||
                                   (puVar1 = (ushort *)(*(longlong *)(param_1 + 0x150) + 6),
                                   *puVar1 <= uVar8 && uVar8 != *puVar1)))) ||
                                 (uVar8 < *(ushort *)(*(longlong *)(param_1 + 0x150) + 4))) break;
                              puVar6 = puVar6 + 1;
                              iVar4 = iVar4 + -1;
                            } while (0 < iVar4);
                            uVar12 = (ulonglong)local_e4;
                            uVar22 = (uint)((longlong)puVar6 - (longlong)local_a0 >> 1);
                          }
                          if (5 < (int)uVar22) {
                            local_194 = uVar11 - 1;
                            uVar15 = uVar19 & 0xffffffff;
                            local_1a0 = (uint)uVar15;
                            local_1a8 = (uint)(uVar19 & 0xffffffff);
                            if ((local_19c != uVar18) && (6 < (int)uVar22)) {
                              uVar11 = *local_a0;
                              if (local_178 == (uVar19 & 0xffffffff)) {
                                local_1a4 = *(uint *)(DAT_1800b2b88 + (ulonglong)uVar11 * 4);
                                uVar3 = *(uint *)(DAT_1800b2b88 + (ulonglong)local_a0[1] * 4);
                              }
                              else {
                                local_1a4 = *(uint *)(DAT_1800b2b88 +
                                                     (ulonglong)
                                                     (*(int *)(local_178 +
                                                              (ulonglong)(uVar11 >> 8) * 4) +
                                                     (uint)(byte)uVar11) * 4);
                                uVar3 = *(uint *)(DAT_1800b2b88 +
                                                 (ulonglong)
                                                 (*(int *)(local_178 +
                                                          (ulonglong)(local_a0[1] >> 8) * 4) +
                                                 (uint)(byte)local_a0[1]) * 4);
                              }
                              if (((uVar3 ^ local_1a4) & 0xe7ffffff) == 0) {
                                uVar15 = uVar20 & 0xffffffff;
                              }
                              local_1a0 = (uint)uVar15;
                            }
                            uVar9 = uVar19 & 0xffffffff;
                            if (-1 < local_194) {
                              local_140 = local_a0 + uVar15;
                              do {
                                local_1a4 = 6;
                                local_198 = (local_194 + (int)uVar9) / 2;
                                local_160 = (ushort *)(longlong)(int)(local_198 * 8);
                                puVar6 = (ushort *)
                                         (*(longlong *)(param_1 + 0x178) + (longlong)local_160 * 2);
                                local_148 = (ushort *)((longlong)local_140 - (longlong)puVar6);
                                while (iVar4 = (uint)*(ushort *)
                                                      ((longlong)puVar6 + (longlong)local_148) -
                                               (uint)*puVar6,
                                      (uint)*(ushort *)((longlong)puVar6 + (longlong)local_148) ==
                                      (uint)*puVar6) {
                                  puVar6 = puVar6 + 1;
                                  local_1a4 = local_1a4 - 1;
                                  if ((int)local_1a4 < 1) {
                                    local_94 = *(uint *)(*(longlong *)(param_1 + 0x178) + 0xc +
                                                        (longlong)local_160 * 2);
                                    uVar14 = uVar20;
                                    if (local_1a0 == uVar18) {
                                      puVar7 = local_a0 + 5;
                                    }
                                    goto LAB_18002a510;
                                  }
                                }
                                iVar13 = local_198 - 1;
                                if (-1 < iVar4) {
                                  iVar13 = local_194;
                                }
                                local_194 = iVar13;
                                if (-1 < iVar4) {
                                  local_1a8 = local_198 + 1;
                                }
                                uVar9 = (ulonglong)local_1a8;
                              } while ((int)local_1a8 <= local_194);
                            }
                          }
                        }
                      }
                      goto LAB_180029cac;
                    }
                  }
LAB_18002a510:
                  if ((int)uVar14 == 0) {
                    puVar7 = local_a0;
                  }
                  if (local_a0 == puVar7) goto LAB_18002a524;
                }
              }
              else if ((byte)(bVar10 - 8) < 5) goto LAB_180002f66;
LAB_180002daf:
              if ((local_a0 < local_b0) &&
                 (local_b8 = local_a0, iVar4 = FUN_180003c80(&local_f8), iVar4 == 2)) {
                uVar19 = (longlong)local_b8 - (longlong)param_3 >> 1;
                uVar18 = (uint)((longlong)local_a0 - (longlong)param_3 >> 1);
                goto LAB_18000302f;
              }
              break;
            }
            if (*local_a0 == 0) goto LAB_180002daf;
            if (*local_a0 != 0xdb40) goto LAB_18002a524;
            uVar14 = (ulonglong)(int)local_98;
            if ((int)local_98 < 1) {
              if (local_b0 <= local_a0 + 1) goto LAB_18002a52c;
              uVar11 = local_a0[1];
            }
            else {
              uVar11 = *(ushort *)((longlong)&local_a8 + uVar14 * 2 + 2);
            }
            if ((ushort)(uVar11 + 0x2300) < 0xf0) {
              if ((int)local_98 < 1) {
                local_a0 = local_a0 + 1;
                if (local_a0 < local_b0) {
                  local_8e = *local_a0;
                }
                else {
                  local_8e = uVar17;
                }
              }
              else {
                uVar14 = (ulonglong)(local_98 - 1);
                local_98 = local_98 - 1;
                local_8e = *(ushort *)((longlong)&local_a8 + (longlong)iVar4 * 2 + 2);
              }
            }
          }
LAB_18002a52c:
          local_a0 = local_a0 + 1;
        } while (local_a0 < local_b0);
      }
      SetLastError(0);
      goto LAB_180002ca6;
    }
  }
  goto LAB_180003039;
LAB_180002fe2:
  puVar7 = local_b8;
  if (uVar22 == 0) goto LAB_180002c83;
LAB_18002855b:
  local_a0 = puVar7;
  local_b8 = param_3;
  uVar19 = FUN_180053d6c(&local_f8,0);
  uVar19 = uVar19 & 0xffffffff;
  uVar18 = local_4c;
  goto LAB_18000302f;
LAB_180003275:
  if (uVar21 == 0) {
LAB_180002c83:
    dwErrCode = 0;
LAB_180002c85:
    SetLastError(dwErrCode);
    goto LAB_180002ca6;
  }
LAB_18002853d:
  local_180 = local_b0;
  uVar19 = FUN_18002321c(&local_f8,0);
  uVar19 = uVar19 & 0xffffffff;
  uVar18 = local_4c;
LAB_18000302f:
  if ((int)uVar19 != -1) {
LAB_180003039:
    if (local_110 != (int *)0x0) {
      *local_110 = uVar18 - (int)uVar19;
    }
  }
LAB_180002ca6:
  __security_check_cookie(local_48 ^ (ulonglong)auStack456);
  return;
}



void FUN_180003310(longlong param_1,ulonglong param_2,ushort *param_3,uint param_4,ushort *param_5,
                  int param_6)

{
  longlong lVar1;
  char cVar2;
  ushort uVar3;
  byte bVar4;
  uint uVar5;
  ulonglong uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  ushort *puVar10;
  ushort *puVar11;
  ushort *puVar12;
  ushort *puVar13;
  ulonglong uVar14;
  byte bVar15;
  char *pcVar16;
  int iVar17;
  int iVar18;
  bool bVar19;
  undefined auStack344 [32];
  int local_138;
  uint local_134;
  uint local_130;
  ushort *local_128;
  ushort *local_120;
  longlong local_118;
  longlong local_108;
  longlong local_100;
  uint local_f8;
  uint local_f4;
  uint local_f0;
  uint local_ec;
  uint local_e8;
  uint local_e4;
  uint local_e0;
  undefined8 local_dc;
  uint local_d4;
  uint local_d0;
  uint local_cc;
  ushort *local_c8;
  ushort *local_c0;
  uint local_b8;
  ushort *local_b0;
  undefined4 local_a8;
  undefined4 local_9c;
  ushort *local_98;
  ushort *local_90;
  uint local_88;
  ushort *local_80;
  undefined4 local_78;
  undefined4 local_6c;
  uint local_68;
  ulonglong local_64;
  ulonglong local_58;
  
  local_58 = DAT_1800b2220 ^ (ulonglong)auStack344;
  uVar9 = (uint)param_2;
  uVar14 = param_2 & 0xffffffff;
  local_118 = param_1;
  if ((param_3 == (ushort *)0x0) || (param_5 == (ushort *)0x0)) {
    SetLastError(0x57);
    goto LAB_180003524;
  }
  if (((uVar9 & 0xfffffff1) - 1 & uVar9 & 0x11) != 0 ||
      (((uVar9 & 0xffffffe2) - 1 & uVar9 & 0x22) != 0 || (param_2 & 0xa7fcefc0) != 0)) {
    SetLastError(0x3ec);
    goto LAB_180003524;
  }
  if (((uint)uVar14 >> 0x1b & 1) == 0) {
    local_100 = *(longlong *)(param_1 + 0x138);
  }
  else {
    local_100 = *(longlong *)(param_1 + 0x130);
  }
  local_64 = 0;
  uVar9 = 0;
  local_98 = param_5;
  local_80 = param_5;
  local_c8 = param_3;
  local_b0 = param_3;
  if (((uint)uVar14 < 2) && (local_100 == 0)) {
    if ((int)param_4 < 0) {
      uVar6 = FUN_180002600((short *)param_3);
      param_4 = (uint)uVar6;
    }
    if (param_6 < 0) {
      uVar6 = FUN_180002600((short *)param_5);
      param_6 = (int)uVar6;
    }
    uVar5 = 2;
    local_134 = 2;
    local_130 = 2;
    puVar10 = param_5;
    puVar12 = param_3;
    uVar8 = param_4;
    iVar18 = param_6;
LAB_1800035e0:
    do {
      puVar11 = puVar10;
      puVar13 = puVar12;
      uVar7 = uVar8;
      iVar17 = iVar18;
      if ((((uVar8 != 0) && (*puVar12 < 0x80)) && (iVar18 != 0)) &&
         ((*puVar12 == *puVar10 && (*puVar10 < 0x80)))) {
        local_120 = puVar12 + 1;
        local_128 = puVar10 + 1;
        local_138 = iVar18 + -1;
        uVar7 = uVar8 - 1;
        puVar11 = local_128;
        puVar13 = local_120;
        iVar17 = local_138;
        if ((((uVar7 != 0) && ((*local_120 < 0x80 && (local_138 != 0)))) &&
            (*local_120 == *local_128)) && (*local_128 < 0x80)) {
          puVar13 = puVar12 + 2;
          puVar11 = puVar10 + 2;
          iVar17 = iVar18 + -2;
          uVar7 = uVar8 - 2;
          if ((((uVar7 != 0) && (*puVar13 < 0x80)) && (iVar17 != 0)) &&
             ((*puVar13 == *puVar11 && (*puVar11 < 0x80)))) {
            uVar7 = uVar8 - 3;
            local_138 = iVar18 + -3;
            local_120 = puVar12 + 3;
            local_128 = puVar10 + 3;
            puVar11 = local_128;
            puVar13 = local_120;
            iVar17 = local_138;
            if (((uVar7 != 0) && ((*local_120 < 0x80 && (local_138 != 0)))) &&
               ((*local_120 == *local_128 && (*local_128 < 0x80)))) {
              puVar13 = puVar12 + 4;
              uVar7 = uVar8 - 4;
              puVar11 = puVar10 + 4;
              iVar17 = iVar18 + -4;
              if ((((uVar7 != 0) && (*puVar13 < 0x80)) && (iVar17 != 0)) &&
                 ((*puVar13 == *puVar11 && (*puVar11 < 0x80)))) {
                uVar7 = uVar8 - 5;
                local_138 = iVar18 + -5;
                local_120 = puVar12 + 5;
                local_128 = puVar10 + 5;
                puVar11 = local_128;
                puVar13 = local_120;
                iVar17 = local_138;
                if (((uVar7 != 0) && ((*local_120 < 0x80 && (local_138 != 0)))) &&
                   ((*local_120 == *local_128 && (*local_128 < 0x80)))) {
                  puVar13 = puVar12 + 6;
                  uVar7 = uVar8 - 6;
                  puVar11 = puVar10 + 6;
                  iVar17 = iVar18 + -6;
                  if ((((uVar7 != 0) && (*puVar13 < 0x80)) && (iVar17 != 0)) &&
                     ((*puVar13 == *puVar11 && (*puVar11 < 0x80)))) {
                    uVar7 = uVar8 - 7;
                    puVar13 = puVar12 + 7;
                    puVar11 = puVar10 + 7;
                    iVar17 = iVar18 + -7;
                    if ((((uVar7 != 0) && ((*puVar13 < 0x80 && (iVar17 != 0)))) &&
                        (*puVar13 == *puVar11)) && (*puVar11 < 0x80)) {
                      uVar8 = uVar8 - 8;
                      puVar12 = puVar12 + 8;
                      puVar10 = puVar10 + 8;
                      iVar18 = iVar18 + -8;
                      goto LAB_1800035e0;
                    }
                  }
                }
              }
            }
          }
        }
      }
      uVar3 = *puVar13;
      puVar10 = puVar11;
      puVar12 = puVar13;
      if ((0x7f < uVar3) || (0x7f < *puVar11)) {
LAB_180003c53:
        uVar8 = 2;
        goto LAB_1800039f8;
      }
      uVar8 = uVar7;
      iVar18 = iVar17;
      if ((uVar7 == 0) || (iVar17 == 0)) goto LAB_180003990;
      lVar1 = (ulonglong)uVar3 * 2;
      cVar2 = (&DAT_180087fc0)[(ulonglong)uVar3 * 2];
      if (cVar2 == '\0') {
LAB_180003899:
        if (uVar5 == 2) {
          if (cVar2 == '\0') {
            while (uVar5 = local_130, (&DAT_180087fc1)[lVar1] == '\0') {
              puVar13 = puVar13 + 1;
              uVar7 = uVar7 - 1;
              if (((uVar7 == 0) || (uVar3 = *puVar13, 0x7f < uVar3)) ||
                 (lVar1 = (ulonglong)uVar3 * 2, (&DAT_180087fc0)[(ulonglong)uVar3 * 2] != '\0'))
              break;
            }
          }
          pcVar16 = &DAT_180087fc0 + (ulonglong)*puVar11 * 2;
          if (*pcVar16 == '\0') {
            while (pcVar16[1] == '\0') {
              puVar11 = puVar11 + 1;
              iVar17 = iVar17 + -1;
              if (((iVar17 == 0) || (0x7f < *puVar11)) ||
                 (pcVar16 = &DAT_180087fc0 + (ulonglong)*puVar11 * 2, *pcVar16 != '\0')) break;
            }
          }
          puVar10 = puVar11;
          puVar12 = puVar13;
          uVar8 = uVar7;
          iVar18 = iVar17;
          if ((((uVar7 == 0) || (uVar3 = *puVar13, 0x7f < uVar3)) || (iVar17 == 0)) ||
             (0x7f < *puVar11)) goto LAB_18000390d;
          if ((&DAT_180087fc0)[(ulonglong)uVar3 * 2] == '\0') {
            bVar15 = (&DAT_180087fc1)[(ulonglong)uVar3 * 2];
          }
          else {
            bVar15 = 0;
          }
          lVar1 = (ulonglong)*puVar11 * 2;
          if ((&DAT_180087fc0)[lVar1] == '\0') {
            bVar4 = (&DAT_180087fc1)[lVar1];
          }
          else {
            bVar4 = 0;
          }
          if (bVar15 == bVar4) {
            if (*puVar13 == *puVar11) goto LAB_18000390d;
          }
          else {
            local_130 = 3;
            uVar5 = local_130;
            if (bVar15 < bVar4) {
              local_130 = 1;
              uVar5 = local_130;
            }
          }
        }
        while (((uVar7 != 0 && (*puVar13 < 0x80)) &&
               ((&DAT_180087fc0)[(ulonglong)*puVar13 * 2] == '\0'))) {
          puVar13 = puVar13 + 1;
          uVar7 = uVar7 - 1;
        }
        while (((puVar10 = puVar11, puVar12 = puVar13, uVar8 = uVar7, iVar18 = iVar17, iVar17 != 0
                && (*puVar11 < 0x80)) && ((&DAT_180087fc0)[(ulonglong)*puVar11 * 2] == '\0'))) {
          puVar11 = puVar11 + 1;
          iVar17 = iVar17 + -1;
        }
      }
      else {
        local_128 = (ushort *)(&DAT_180087fc0 + (ulonglong)*puVar11 * 2);
        uVar5 = local_130;
        if (*(char *)local_128 == '\0') goto LAB_180003899;
        if (cVar2 != *(char *)local_128) {
          uVar8 = 3;
          if ((byte)(&DAT_180087fc0)[(ulonglong)*puVar13 * 2] <
              (byte)(&DAT_180087fc0)[(ulonglong)*puVar11 * 2]) {
            uVar8 = 1;
          }
          goto LAB_1800039f8;
        }
        if ((((int)uVar14 != 1) && (local_134 == 2)) &&
           (local_134 = 3,
           (byte)(&DAT_180087fc1)[lVar1] < (byte)(&DAT_180087fc1)[(ulonglong)*puVar11 * 2])) {
          local_134 = 1;
        }
        puVar12 = puVar13 + 1;
        uVar8 = uVar7 - 1;
        puVar10 = puVar11 + 1;
        iVar18 = iVar17 + -1;
      }
LAB_18000390d:
      if ((0x7f < *puVar12) || (0x7f < *puVar10)) goto LAB_180003c53;
      if (uVar8 == 0) goto LAB_1800039c0;
      if (iVar18 == 0) goto LAB_180003990;
    } while( true );
  }
  goto LAB_1800033eb;
LAB_180003990:
  while ((((uVar8 != 0 && (uVar3 = *puVar12, uVar3 < 0x80)) &&
          ((&DAT_180087fc0)[(ulonglong)uVar3 * 2] == '\0')) &&
         ((uVar5 != 2 || ((&DAT_180087fc1)[(ulonglong)uVar3 * 2] == '\0'))))) {
    puVar12 = puVar12 + 1;
    uVar8 = uVar8 - 1;
  }
LAB_1800039c0:
  while (((iVar18 != 0 && (uVar3 = *puVar10, uVar3 < 0x80)) &&
         (((&DAT_180087fc0)[(ulonglong)uVar3 * 2] == '\0' &&
          ((uVar5 != 2 || ((&DAT_180087fc1)[(ulonglong)uVar3 * 2] == '\0'))))))) {
    puVar10 = puVar10 + 1;
    iVar18 = iVar18 + -1;
  }
  if (uVar8 == 0) {
    if (iVar18 == 0) {
      uVar8 = local_134;
      if (local_134 == 2) {
        uVar8 = uVar5;
      }
    }
    else {
      uVar8 = 1;
    }
  }
  else {
    uVar8 = 3;
  }
LAB_1800039f8:
  if ((*puVar12 < 0x80) && (*puVar10 < 0x80)) {
    bVar19 = false;
  }
  else {
    bVar19 = true;
    local_b0 = puVar12;
    local_80 = puVar10;
  }
  uVar5 = 0;
  if (!bVar19) {
    uVar5 = uVar8;
  }
  if (uVar5 != 0) goto LAB_180003524;
  if (local_134 != 2) {
    local_64 = local_64 & 0xffffffff00000000 | (ulonglong)local_134;
  }
  if (local_130 != 2) {
    local_64 = local_64 & 0xffffffff | (ulonglong)local_130 << 0x20;
    uVar9 = local_130;
  }
LAB_1800033eb:
  local_d0 = (uint)((*(byte *)(local_118 + 0x140) & 1) != 0);
  uVar8 = (uint)uVar14;
  local_88 = uVar8 & 0x10000000;
  if (-1 < (int)param_4) {
    local_c0 = param_3 + (int)param_4;
    local_b8 = local_88;
  }
  else {
    local_c0 = (ushort *)0xffffffffffffffff;
    local_b8 = 1;
  }
  local_d4 = (uint)(-1 < (int)param_4);
  if (param_6 < 0) {
    local_90 = (ushort *)0xffffffffffffffff;
    local_88 = 1;
  }
  else {
    local_d4 = 1;
    local_90 = param_5 + param_6;
  }
  local_a8 = 0;
  local_78 = 0;
  local_9c = 0;
  local_6c = 0;
  local_f0 = (uint)((uVar14 & 2) != 0);
  bVar19 = (uVar14 & 4) != 0;
  local_ec = (uint)bVar19;
  local_f4 = (uint)bVar19;
  if (uVar9 != 0) {
    local_f4 = 1;
  }
  local_f8 = (uint)((uVar8 >> 0xc & 1) != 0);
  local_e8 = (uint)((uVar14 & 0xff) >> 4) & 1;
  local_e4 = (uint)((uVar14 & 0xff) >> 5) & 1;
  local_e0 = (uint)((uVar14 & 8) != 0);
  local_dc = 0;
  local_cc = 0xffffffff;
  if ((uVar14 & 1) != 0) {
    local_cc = 0xe7ffffff;
  }
  local_68 = 0xc4;
  if ((uVar14 & 2) == 0) {
    local_68 = ((*(byte *)(local_118 + 0x140) & 0x10) != 0) + 0xf5;
  }
  else {
    local_cc = local_cc & 0xff00ffff;
  }
  if ((uVar8 >> 0x10 & 1) != 0) {
    local_cc = local_cc & 0xdfffffff;
  }
  if (((uVar8 >> 0x11 & 1) != 0) && (local_cc = local_cc & 0xfeffffff, (uVar14 & 1) != 0)) {
    local_68 = local_68 & 0xfffffffb;
  }
  local_108 = local_118;
  FUN_180003c80(&local_108);
LAB_180003524:
  __security_check_cookie(local_58 ^ (ulonglong)auStack344);
  return;
}


/*
Unable to decompile 'FUN_180003c80'
Cause: Exception while decompiling 180003c80: process: timeout

*/


int * FUN_180005fac(int param_1)

{
  int iVar1;
  int iVar2;
  longlong lVar3;
  int *piVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  
  lVar3 = KernelBaseGetGlobalData();
  iVar6 = *(int *)(lVar3 + 0x70);
  lVar3 = KernelBaseGetGlobalData();
  iVar7 = 0;
  iVar6 = iVar6 + -1;
  iVar5 = iVar6;
  if (-1 < iVar6) {
    do {
      iVar5 = iVar5 >> 1;
      piVar4 = (int *)((longlong)iVar5 * 0x68 + *(longlong *)(lVar3 + 0x78));
      iVar1 = *piVar4;
      if (param_1 == iVar1) {
        return piVar4;
      }
      iVar2 = iVar5 + -1;
      if (iVar1 <= param_1) {
        iVar2 = iVar6;
      }
      iVar6 = iVar2;
      if (iVar1 <= param_1) {
        iVar7 = iVar5 + 1;
      }
      iVar5 = iVar7 + iVar6;
    } while (iVar7 <= iVar6);
  }
  return (int *)0x0;
}



int GetGeoInfoW(GEOID Location,GEOTYPE GeoType,LPWSTR lpGeoData,int cchData,LANGID LangId)

{
  WCHAR WVar1;
  ushort uVar2;
  int iVar3;
  int extraout_EAX;
  longlong lVar4;
  uint *puVar5;
  WCHAR *pWVar6;
  longlong lVar7;
  WCHAR *pWVar8;
  ulonglong uVar9;
  uint uVar10;
  undefined8 uVar11;
  uint uVar12;
  longlong lVar13;
  undefined auStackY296 [32];
  WCHAR local_e8 [80];
  ulonglong local_48;
  
                    // 0x6020  615  GetGeoInfoW
  local_48 = DAT_1800b2220 ^ (ulonglong)auStackY296;
  memset(local_e8,0,0xa0);
  lVar4 = NlsValidateLocale();
  if ((cchData < 0) || (((lpGeoData == (LPWSTR)0x0 && (0 < cchData)) || (lVar4 == 0)))) {
LAB_1800062d8:
    uVar11 = 0x57;
  }
  else {
    if (Location == -1) goto LAB_1800062eb;
    puVar5 = (uint *)FUN_180005fac(Location);
    if (puVar5 == (uint *)0x0) goto LAB_1800062d8;
    if (GeoType == 1) {
      if (puVar5[0xd] != 0x10) goto LAB_1800062eb;
      uVar10 = *puVar5;
      uVar12 = 0;
LAB_180006282:
      uVar9 = (ulonglong)uVar10;
      uVar11 = 10;
LAB_180006287:
      FUN_180058004(uVar9,uVar11,uVar12,local_e8,0x50);
LAB_18000629a:
      uVar9 = FUN_18000865c(local_e8);
      if (cchData == 0) goto LAB_1800062eb;
      if ((int)uVar9 + 1 <= cchData) {
        FUN_180007094(lpGeoData,(longlong)cchData,(longlong)local_e8,(longlong)(int)uVar9);
        goto LAB_1800062eb;
      }
    }
    else {
      if (GeoType != 6) {
        if (GeoType != 7) {
          if (GeoType != 0xd) {
            FUN_18000631c(puVar5,GeoType,lpGeoData,cchData);
            goto LAB_1800062eb;
          }
          uVar10 = puVar5[0xe];
          uVar12 = 3;
          goto LAB_180006282;
        }
        if (LangId == 0) {
          LangId = GetUserDefaultLangID();
        }
        uVar9 = (ulonglong)LangId;
        uVar10 = (uint)LangId;
        if (LangId < 0x400) {
          uVar10 = uVar10 | 0x400;
          uVar9 = (ulonglong)uVar10;
        }
        if (uVar10 == 0) goto LAB_1800062eb;
        uVar11 = 0x10;
        uVar12 = 8;
        goto LAB_180006287;
      }
      if (LangId == 0) {
        LangId = GetUserDefaultLangID();
      }
      iVar3 = GetLocaleInfoW((uint)LangId,0x59,local_e8,0x50);
      if ((iVar3 == 0) && (uVar2 = LangId & 0x3ff | 0x400, uVar2 != LangId)) {
        GetLocaleInfoW((uint)uVar2,0x59,local_e8,0x50);
      }
      if (local_e8[0] == L'\0') goto LAB_1800062eb;
      lVar4 = 0x50;
      pWVar6 = local_e8;
      do {
        if (*pWVar6 == L'\0') break;
        pWVar6 = pWVar6 + 1;
        lVar4 = lVar4 + -1;
      } while (lVar4 != 0);
      if (lVar4 != 0) {
        lVar7 = -lVar4 + 0x50;
        pWVar6 = local_e8 + lVar7;
        lVar7 = 0x50 - lVar7;
        if (lVar7 != 0) {
          lVar13 = -lVar4 + 0x7ffffffe + lVar7;
          lVar4 = (longlong)&DAT_180086528 - (longlong)pWVar6;
          do {
            if ((lVar13 == 0) || (WVar1 = *(WCHAR *)(lVar4 + (longlong)pWVar6), WVar1 == L'\0'))
            break;
            *pWVar6 = WVar1;
            lVar13 = lVar13 + -1;
            pWVar6 = pWVar6 + 1;
            lVar7 = lVar7 + -1;
          } while (lVar7 != 0);
        }
        pWVar8 = pWVar6 + -1;
        if (lVar7 != 0) {
          pWVar8 = pWVar6;
        }
        *pWVar8 = L'\0';
        if ((lVar7 == 0) ||
           (uVar9 = FUN_18000b638(local_e8,0x50,(longlong)(puVar5 + 0xf)), (int)uVar9 < 0))
        goto LAB_1800062b6;
        _wcslwr(local_e8);
        goto LAB_18000629a;
      }
    }
LAB_1800062b6:
    uVar11 = 0x7a;
  }
  RtlSetLastWin32Error(uVar11);
LAB_1800062eb:
  __security_check_cookie(local_48 ^ (ulonglong)auStackY296);
  return extraout_EAX;
}



void FUN_18000631c(uint *param_1,uint param_2,short *param_3,int param_4)

{
  int iVar1;
  ulonglong uVar2;
  undefined8 uVar3;
  uint uVar4;
  uint *puVar5;
  undefined auStackY264 [32];
  uint local_d8 [40];
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStackY264;
  memset(local_d8,0,0xa0);
  if (param_2 == 0xd) {
    param_1 = (uint *)FUN_180005fac(param_1[0xe]);
    if (param_1 != (uint *)0x0) {
      param_2 = 0x11;
      goto LAB_18000636a;
    }
LAB_18002c7b6:
    if (param_2 == 0xc) {
      FUN_180058004((ulonglong)*(ushort *)(param_1 + 0x13),10,3,(short *)local_d8,0x50);
      puVar5 = local_d8;
LAB_180006390:
      if (puVar5 == (uint *)0x0) goto LAB_1800063c7;
    }
    else if (param_2 == 0xd) {
      puVar5 = (uint *)&DAT_18008a0a8;
    }
    else {
      if (param_2 != 0xe) {
        if (param_2 == 0xf) {
          puVar5 = param_1 + 0x14;
        }
        else if (param_2 == 0x10) {
          puVar5 = param_1 + 0x16;
        }
        else {
          if (param_2 != 0x11) {
            if (param_2 != 0x12) goto LAB_18002c73e;
            uVar2 = (ulonglong)*param_1;
            goto LAB_18002c80c;
          }
          puVar5 = param_1 + 0xf;
          if (((*(short *)puVar5 == 0x58) && (*(short *)((longlong)param_1 + 0x3e) == 0x58)) &&
             (*(short *)(param_1 + 0x13) != 0)) {
            uVar2 = (ulonglong)*(ushort *)(param_1 + 0x13);
            uVar4 = 3;
            goto LAB_18002c81b;
          }
        }
        goto LAB_180006390;
      }
      uVar2 = (ulonglong)*(ushort *)((longlong)param_1 + 0x4e);
LAB_18002c80c:
      uVar4 = 0;
LAB_18002c81b:
      FUN_180058004(uVar2,10,uVar4,(short *)local_d8,0x50);
      puVar5 = local_d8;
    }
LAB_180006395:
    uVar2 = FUN_18000865c((short *)puVar5);
    iVar1 = (int)uVar2;
LAB_18000639f:
    if (param_4 == 0) goto LAB_1800063c7;
    if (iVar1 + 1 <= param_4) {
      FUN_180007094(param_3,(longlong)param_4,(longlong)puVar5,(longlong)iVar1);
      goto LAB_1800063c7;
    }
    uVar3 = 0x7a;
  }
  else {
LAB_18000636a:
    if (0xb < param_2) goto LAB_18002c7b6;
    if (param_2 == 0xb) goto LAB_1800063c7;
    if (param_2 == 2) {
      puVar5 = param_1 + 1;
      goto LAB_180006390;
    }
    if (param_2 == 3) {
      puVar5 = param_1 + 7;
      goto LAB_180006390;
    }
    if (param_2 == 4) {
      puVar5 = param_1 + 0xf;
      goto LAB_180006390;
    }
    if (param_2 == 5) {
      puVar5 = param_1 + 0x11;
      goto LAB_180006390;
    }
    if (param_2 == 8) {
LAB_18002c76a:
      iVar1 = GetStringTableEntry(*param_1,local_d8,0x50);
      if (iVar1 != 0) {
LAB_18002c793:
        puVar5 = local_d8;
        if (iVar1 == 0) goto LAB_180006395;
        goto LAB_18000639f;
      }
      uVar3 = 0x57;
    }
    else {
      if (param_2 == 9) {
        iVar1 = GetStringTableEntry(*param_1,local_d8,0x50);
        if (iVar1 == 0) goto LAB_18002c76a;
        goto LAB_18002c793;
      }
      if (param_2 == 10) goto LAB_1800063c7;
LAB_18002c73e:
      uVar3 = 0x3ec;
    }
  }
  RtlSetLastWin32Error(uVar3);
LAB_1800063c7:
  __security_check_cookie(local_38 ^ (ulonglong)auStackY264);
  return;
}



DWORD GetShortPathNameW(LPCWSTR lpszLongPath,LPWSTR lpszShortPath,DWORD cchBuffer)

{
  WCHAR WVar1;
  LPWSTR pWVar2;
  UINT uMode;
  DWORD DVar3;
  int iVar4;
  DWORD extraout_EAX;
  wchar_t *pwVar5;
  undefined8 uVar6;
  int *piVar7;
  LPCWSTR pWVar8;
  ulonglong uVar9;
  HANDLE hFindFile;
  ulonglong uVar10;
  longlong lVar11;
  uint uVar12;
  longlong lVar13;
  LPCWSTR _Src;
  LPCWSTR _Src_00;
  longlong in_GS_OFFSET;
  undefined auStack776 [32];
  uint local_2e8;
  UINT local_2e4;
  LPCWSTR local_2e0;
  DWORD local_2d8;
  WCHAR *local_2d0;
  LPCWSTR local_2c8;
  LPCWSTR local_2c0;
  LPCWSTR local_2b8;
  ulonglong local_2b0;
  LPCWSTR local_2a8;
  _WIN32_FIND_DATAW local_298;
  ulonglong local_48;
  
                    // 0x6400  728  GetShortPathNameW
  local_48 = DAT_1800b2220 ^ (ulonglong)auStack776;
  local_2c8 = (LPCWSTR)0x0;
  local_2e0 = (LPCWSTR)0x0;
  local_2e8 = 0;
  local_2d8 = cchBuffer;
  if (lpszLongPath == (LPCWSTR)0x0) {
    RtlSetLastWin32Error(0x57);
    goto LAB_180006893;
  }
  uMode = SetErrorMode(0x8001);
  local_2e4 = uMode;
  DVar3 = GetFileAttributesW(lpszLongPath);
  if ((DVar3 == 0xffffffff) &&
     ((*(longlong *)(in_GS_OFFSET + 0x60) == 0 ||
      ((*(byte *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x2c8) & 1) == 0)))) {
    local_2e8 = 0;
  }
  else {
    pwVar5 = FUN_180006ef0(lpszLongPath);
    if ((pwVar5 == (wchar_t *)0x0) ||
       ((*pwVar5 == L'\0' ||
        (uVar6 = FUN_180006d88(pwVar5,&local_2d0,&local_2c0,1), (int)uVar6 == 0)))) {
      lVar13 = -1;
      do {
        lVar11 = lVar13;
        lVar13 = lVar11 + 1;
      } while (lpszLongPath[lVar13] != L'\0');
      uVar12 = (uint)lVar13;
      if ((uVar12 < cchBuffer) && (lpszShortPath != (LPWSTR)0x0)) {
        uMode = local_2e4;
        local_2e8 = uVar12;
        if (lpszShortPath == lpszLongPath) goto LAB_18000684d;
        uVar12 = (int)lVar11 + 2;
LAB_180006722:
        RtlMoveMemory(lpszShortPath,lpszLongPath,(ulonglong)uVar12 * 2);
        uMode = local_2e4;
      }
      else {
LAB_180006842:
        uMode = local_2e4;
        local_2e8 = uVar12 + 1;
      }
    }
    else {
      lVar13 = -1;
      do {
        lVar13 = lVar13 + 1;
      } while (lpszLongPath[lVar13] != L'\0');
      uVar12 = (int)lVar13 + 1;
      piVar7 = (int *)KernelBaseGetGlobalData();
      local_2b0 = (ulonglong)uVar12;
      pWVar8 = (LPCWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                        *piVar7 + 0x200000,(ulonglong)uVar12 * 2);
      local_2e0 = pWVar8;
      if (pWVar8 == (LPCWSTR)0x0) {
        RtlSetLastWin32Error(8);
        uMode = local_2e4;
        goto LAB_18000684d;
      }
      FUN_180007094(pWVar8,(ulonglong)uVar12,(longlong)lpszLongPath,(ulonglong)uVar12);
      local_2d0 = pWVar8 + ((longlong)local_2d0 - (longlong)lpszLongPath >> 1);
      local_2c0 = pWVar8 + ((longlong)local_2c0 - (longlong)lpszLongPath >> 1);
      pWVar2 = lpszShortPath;
      if ((cchBuffer != 0) && (pWVar2 = lpszShortPath, lpszShortPath != (LPWSTR)0x0)) {
        if (lpszShortPath < lpszLongPath) {
LAB_180006745:
          pWVar2 = lpszShortPath;
          if (lpszShortPath + cchBuffer < lpszLongPath) goto LAB_180006586;
        }
        else if (lpszLongPath + local_2b0 <= lpszShortPath) {
          pWVar2 = lpszShortPath;
          if (lpszLongPath <= lpszShortPath) goto LAB_180006586;
          goto LAB_180006745;
        }
        local_2b8 = lpszShortPath;
        KernelBaseGetGlobalData();
        local_2c8 = (LPCWSTR)RtlAllocateHeap(*(undefined8 *)
                                              (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
        pWVar2 = local_2c8;
        if (local_2c8 == (LPCWSTR)0x0) {
          RtlSetLastWin32Error(8);
          uMode = local_2e4;
          goto LAB_18000684d;
        }
      }
LAB_180006586:
      local_2b8 = pWVar2;
      uVar12 = 0;
      local_2a8 = local_2e0;
      local_2e8 = 0;
      pWVar8 = local_2b8;
      _Src = local_2e0;
      while( true ) {
        _Src_00 = local_2c0;
        uVar9 = (longlong)local_2d0 - (longlong)_Src >> 1;
        iVar4 = (int)uVar9;
        if (((iVar4 != 0) && (uVar12 = uVar12 + iVar4, local_2e8 = uVar12, uVar12 < local_2d8)) &&
           (lpszShortPath != (LPWSTR)0x0)) {
          uVar9 = uVar9 & 0xffffffff;
          RtlMoveMemory(pWVar8,_Src,uVar9 * 2);
          pWVar8 = pWVar8 + uVar9;
          local_2b8 = pWVar8;
        }
        WVar1 = *_Src_00;
        *_Src_00 = L'\0';
        hFindFile = FindFirstFileW(local_2e0,&local_298);
        *_Src_00 = WVar1;
        if (hFindFile == (HANDLE)0xffffffffffffffff) break;
        FindClose(hFindFile);
        uVar9 = 0xffffffffffffffff;
        do {
          uVar10 = uVar9 + 1;
          lVar13 = uVar9 + 1;
          uVar9 = uVar10;
        } while (local_298.cAlternateFileName[lVar13] != L'\0');
        if ((int)uVar10 == 0) {
          uVar10 = (longlong)_Src_00 - (longlong)local_2d0 >> 1;
        }
        else {
          local_2d0 = local_298.cAlternateFileName;
        }
        uVar12 = uVar12 + (int)uVar10;
        local_2e8 = uVar12;
        if ((uVar12 < local_2d8) && (lpszShortPath != (LPWSTR)0x0)) {
          RtlMoveMemory(pWVar8,local_2d0,(uVar10 & 0xffffffff) * 2);
          pWVar8 = pWVar8 + (uVar10 & 0xffffffff);
          local_2b8 = pWVar8;
        }
        local_2a8 = _Src_00;
        if ((*_Src_00 == L'\0') ||
           (uVar6 = FUN_180006d88(_Src_00,&local_2d0,&local_2c0,1), _Src = _Src_00, (int)uVar6 == 0)
           ) goto LAB_180006699;
      }
      uVar12 = 0;
      local_2e8 = 0;
      _Src_00 = _Src;
LAB_180006699:
      lVar13 = -1;
      uMode = local_2e4;
      if (uVar12 != 0) {
        do {
          lVar11 = lVar13;
          lVar13 = lVar11 + 1;
        } while (_Src_00[lVar13] != L'\0');
        uVar12 = uVar12 + (int)lVar13;
        if ((local_2d8 <= uVar12) || (lpszShortPath == (LPWSTR)0x0)) goto LAB_180006842;
        local_2e8 = uVar12;
        RtlMoveMemory(pWVar8,_Src_00,(ulonglong)((int)lVar11 + 2) * 2);
        uMode = local_2e4;
        if (local_2c8 != (LPCWSTR)0x0) {
          uVar12 = uVar12 + 1;
          lpszLongPath = local_2c8;
          goto LAB_180006722;
        }
      }
    }
  }
LAB_18000684d:
  if (local_2c8 != (LPCWSTR)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_2c8);
  }
  if (local_2e0 != (LPCWSTR)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_2e0);
  }
  SetErrorMode(uMode);
LAB_180006893:
  __security_check_cookie(local_48 ^ (ulonglong)auStack776);
  return extraout_EAX;
}



DWORD GetLongPathNameW(LPCWSTR lpszShortPath,LPWSTR lpszLongPath,DWORD cchBuffer)

{
  WCHAR WVar1;
  size_t _Size;
  UINT UVar2;
  DWORD DVar3;
  int iVar4;
  DWORD extraout_EAX;
  wchar_t *pwVar5;
  undefined8 uVar6;
  int *piVar7;
  ulonglong uVar8;
  HANDLE hFindFile;
  ulonglong uVar9;
  longlong lVar10;
  uint uVar11;
  longlong lVar12;
  LPWSTR _Dst;
  LPCWSTR pWVar13;
  LPCWSTR pWVar14;
  longlong in_GS_OFFSET;
  undefined auStack760 [32];
  uint local_2d8;
  UINT local_2d4;
  DWORD local_2d0;
  LPCWSTR local_2c8;
  WCHAR *local_2c0;
  LPWSTR local_2b8;
  LPCWSTR local_2b0;
  LPWSTR local_2a8;
  LPCWSTR local_2a0;
  _WIN32_FIND_DATAW local_298;
  ulonglong local_48;
  
                    // 0x68c0  632  GetLongPathNameW
  local_48 = DAT_1800b2220 ^ (ulonglong)auStack760;
  local_2d8 = 0;
  local_2c0 = (WCHAR *)0x0;
  local_2b0 = (LPCWSTR)0x0;
  local_2b8 = (LPWSTR)0x0;
  pWVar13 = (LPCWSTR)0x0;
  local_2c8 = (LPCWSTR)0x0;
  local_2d0 = cchBuffer;
  if (lpszShortPath == (LPCWSTR)0x0) {
    RtlSetLastWin32Error(0x57);
    goto LAB_180006d36;
  }
  UVar2 = SetErrorMode(0x8001);
  local_2d4 = UVar2;
  DVar3 = GetFileAttributesW(lpszShortPath);
  pWVar14 = (LPCWSTR)0x0;
  if (DVar3 != 0xffffffff) {
    pwVar5 = FUN_180006ef0(lpszShortPath);
    if (((pwVar5 == (wchar_t *)0x0) || (*pwVar5 == L'\0')) ||
       (uVar6 = FUN_180006d88(pwVar5,&local_2c0,&local_2b0,0), (int)uVar6 == 0)) {
      lVar12 = -1;
      do {
        lVar10 = lVar12;
        lVar12 = lVar10 + 1;
      } while (lpszShortPath[lVar12] != L'\0');
      local_2d8 = (uint)lVar12;
      pWVar14 = pWVar13;
      UVar2 = local_2d4;
      if ((local_2d8 < cchBuffer) && (lpszLongPath != (LPWSTR)0x0)) {
        if (lpszLongPath != lpszShortPath) {
          RtlMoveMemory(lpszLongPath,lpszShortPath,(ulonglong)((int)lVar10 + 2) * 2);
          UVar2 = local_2d4;
        }
      }
      else {
        local_2d8 = local_2d8 + 1;
      }
    }
    else {
      lVar12 = -1;
      do {
        lVar12 = lVar12 + 1;
      } while (lpszShortPath[lVar12] != L'\0');
      uVar8 = (ulonglong)((int)lVar12 + 1);
      piVar7 = (int *)KernelBaseGetGlobalData();
      _Size = uVar8 * 2;
      pWVar13 = (LPCWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                         *piVar7 + 0x200000,_Size);
      local_2c8 = pWVar13;
      if (pWVar13 == (LPCWSTR)0x0) {
        RtlSetLastWin32Error(8);
        pWVar14 = pWVar13;
        UVar2 = local_2d4;
      }
      else {
        RtlMoveMemory(pWVar13,lpszShortPath,_Size);
        local_2c0 = pWVar13 + ((longlong)local_2c0 - (longlong)lpszShortPath >> 1);
        local_2b0 = pWVar13 + ((longlong)local_2b0 - (longlong)lpszShortPath >> 1);
        uVar9 = (ulonglong)local_2d0;
        _Dst = lpszLongPath;
        local_2a8 = lpszLongPath;
        pWVar14 = pWVar13;
        if ((local_2d0 != 0) && (lpszLongPath != (LPWSTR)0x0)) {
          if (lpszLongPath < lpszShortPath) {
LAB_180006a33:
            if (lpszLongPath + uVar9 < lpszShortPath) goto LAB_180006a4c;
          }
          else if (lpszShortPath + uVar8 <= lpszLongPath) {
            if (lpszShortPath <= lpszLongPath) goto LAB_180006a4c;
            goto LAB_180006a33;
          }
          KernelBaseGetGlobalData();
          local_2b8 = (LPWSTR)RtlAllocateHeap(*(undefined8 *)
                                               (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
          if (local_2b8 == (LPWSTR)0x0) {
            RtlSetLastWin32Error(8);
            pWVar14 = local_2c8;
            UVar2 = local_2d4;
            goto LAB_180006cf6;
          }
          uVar9 = (ulonglong)local_2d0;
          _Dst = local_2b8;
          pWVar13 = local_2c8;
          local_2a8 = local_2b8;
          pWVar14 = local_2c8;
        }
LAB_180006a4c:
        while( true ) {
          local_2a0 = pWVar14;
          pWVar14 = local_2b0;
          uVar8 = (longlong)local_2c0 - (longlong)pWVar13 >> 1;
          iVar4 = (int)uVar8;
          uVar11 = local_2d8 + iVar4;
          local_2d8 = uVar11;
          if ((iVar4 != 0) && (uVar11 < (uint)uVar9)) {
            uVar8 = uVar8 & 0xffffffff;
            RtlMoveMemory(_Dst,pWVar13,uVar8 * 2);
            _Dst = _Dst + uVar8;
            local_2a8 = _Dst;
          }
          WVar1 = *pWVar14;
          *pWVar14 = L'\0';
          hFindFile = FindFirstFileW(local_2c8,&local_298);
          *pWVar14 = WVar1;
          if (hFindFile == (HANDLE)0xffffffffffffffff) break;
          FindClose(hFindFile);
          uVar8 = 0xffffffffffffffff;
          do {
            uVar9 = uVar8 + 1;
            lVar12 = uVar8 + 1;
            uVar8 = uVar9;
          } while (local_298.cFileName[lVar12] != L'\0');
          if ((int)uVar9 == 0) {
            uVar9 = (longlong)pWVar14 - (longlong)local_2c0 >> 1;
          }
          else {
            local_2c0 = local_298.cFileName;
          }
          uVar11 = uVar11 + (int)uVar9;
          local_2d8 = uVar11;
          if ((uVar11 < local_2d0) && (lpszLongPath != (LPWSTR)0x0)) {
            RtlMoveMemory(_Dst,local_2c0,(uVar9 & 0xffffffff) * 2);
            _Dst = _Dst + (uVar9 & 0xffffffff);
            local_2a8 = _Dst;
          }
          pWVar13 = pWVar14;
          local_2a0 = pWVar14;
          if ((*pWVar14 == L'\0') ||
             (uVar6 = FUN_180006d88(pWVar14,&local_2c0,&local_2b0,0), (int)uVar6 == 0))
          goto LAB_180006b58;
          uVar9 = (ulonglong)local_2d0;
          local_2d8 = uVar11;
          pWVar14 = local_2a0;
        }
        uVar11 = 0;
        local_2d8 = 0;
LAB_180006b58:
        lVar12 = -1;
        pWVar14 = local_2c8;
        UVar2 = local_2d4;
        if (uVar11 != 0) {
          do {
            lVar10 = lVar12;
            lVar12 = lVar10 + 1;
          } while (pWVar13[lVar12] != L'\0');
          uVar11 = uVar11 + (int)lVar12;
          if ((uVar11 < local_2d0) && (lpszLongPath != (LPWSTR)0x0)) {
            local_2d8 = uVar11;
            RtlMoveMemory(_Dst,pWVar13,(ulonglong)((int)lVar10 + 2) * 2);
            pWVar14 = local_2c8;
            UVar2 = local_2d4;
            if (local_2b8 != (LPWSTR)0x0) {
              RtlMoveMemory(lpszLongPath,local_2b8,(ulonglong)(uVar11 + 1) * 2);
              pWVar14 = local_2c8;
              UVar2 = local_2d4;
            }
          }
          else {
            local_2d8 = uVar11 + 1;
          }
        }
      }
    }
  }
LAB_180006cf6:
  if (pWVar14 != (LPCWSTR)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_2c8);
  }
  if (local_2b8 != (LPWSTR)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_2b8);
  }
  SetErrorMode(UVar2);
LAB_180006d36:
  __security_check_cookie(local_48 ^ (ulonglong)auStack760);
  return extraout_EAX;
}



undefined8 FUN_180006d88(short *param_1,short **param_2,short **param_3,int param_4)

{
  short *psVar1;
  short sVar2;
  longlong lVar3;
  longlong lVar4;
  short *psVar5;
  int iVar6;
  longlong lVar7;
  
  do {
    sVar2 = *param_1;
    if (sVar2 == 0) {
      return 0;
    }
    do {
      if ((sVar2 != 0x5c) && (sVar2 != 0x2f)) break;
      param_1 = param_1 + 1;
      sVar2 = *param_1;
    } while (sVar2 != 0);
    psVar5 = param_1;
    if (sVar2 == 0) {
      return 0;
    }
    do {
      psVar1 = psVar5;
      psVar5 = psVar1 + 1;
      sVar2 = *psVar5;
      if ((sVar2 == 0) || (sVar2 == 0x5c)) break;
    } while (sVar2 != 0x2f);
    iVar6 = (int)((longlong)psVar5 - (longlong)param_1 >> 1);
    if (param_4 == 0) {
      if (((iVar6 != 0) && (iVar6 < 0xd)) && (*param_1 != 0x2e)) {
        lVar7 = (longlong)iVar6;
        lVar3 = 0;
        lVar4 = 0;
        if (0 < iVar6) {
          do {
            iVar6 = iVar6 + -1;
            if (param_1[lVar3] == 0x2e) {
              if (((int)lVar4 != 0) || (3 < iVar6)) goto LAB_180006ebf;
              lVar4 = 1;
            }
            if ((7 < lVar3) && ((int)lVar4 == 0)) goto LAB_180006ebf;
            lVar3 = lVar3 + 1;
            if (lVar7 <= lVar3) break;
          } while( true );
        }
LAB_180006e5e:
        if (param_2 == (short **)0x0) {
          return 1;
        }
        if (param_3 != (short **)0x0) {
          *param_2 = param_1;
          *param_3 = psVar5;
          return 1;
        }
        return 1;
      }
    }
    else {
      iVar6 = FUN_180006f34(param_1,iVar6);
      if (iVar6 == 0) goto LAB_180006e5e;
    }
LAB_180006ebf:
    if (*psVar5 == 0) {
      return 0;
    }
    param_1 = psVar1 + 2;
  } while( true );
}



wchar_t * FUN_180006ef0(wchar_t *param_1)

{
  int iVar1;
  wchar_t *_Str1;
  int iVar2;
  
  iVar1 = RtlDetermineDosPathNameType_U();
  if (iVar1 != 1) {
    if (iVar1 == 2) {
      return param_1 + 3;
    }
    if (iVar1 == 3) {
      return param_1 + 2;
    }
    if (iVar1 == 4) {
      return param_1 + 1;
    }
    if (iVar1 == 5) {
      return param_1;
    }
    if (iVar1 != 6) {
      return (wchar_t *)0x0;
    }
  }
  iVar2 = 2;
  _Str1 = param_1 + 2;
  iVar1 = _wcsnicmp(_Str1,L"?\\UNC",5);
  if (iVar1 == 0) {
    _Str1 = param_1 + 8;
  }
  do {
    if (*_Str1 == L'\0') {
      return _Str1;
    }
    if ((*_Str1 == L'\\') || (*_Str1 == L'/')) {
      iVar2 = iVar2 + -1;
    }
    _Str1 = _Str1 + 1;
  } while (iVar2 != 0);
  return _Str1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Could not reconcile some variable overlaps

void FUN_180006f34(short *param_1,int param_2)

{
  byte TestChar;
  bool bVar1;
  BOOL BVar2;
  code *pcVar3;
  int iVar4;
  int iVar5;
  longlong lVar6;
  undefined auStack392 [32];
  uint local_168;
  undefined *local_160;
  short local_158;
  short local_156;
  short *local_150;
  undefined local_148 [272];
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack392;
  if (((param_2 < 0xd) && (param_2 != 0)) && (*param_1 != 0x2e)) {
    local_158 = (short)param_2 * 2;
    local_168 = 0x1040000;
    local_160 = local_148;
    local_156 = local_158;
    local_150 = param_1;
    pcVar3 = (code *)GetUnicodeStringToEightBitStringRoutine();
    iVar5 = (*pcVar3)();
    if (-1 < iVar5) {
      bVar1 = false;
      iVar5 = 0;
      if ((short)local_168 != 0) {
        lVar6 = 0;
        iVar4 = param_2 + -1;
        do {
          TestChar = local_160[lVar6];
          BVar2 = IsDBCSLeadByte(TestChar);
          if (BVar2 == 0) {
            if ((0x7f < TestChar) ||
               ((*(uint *)(&DAT_1800869a0 + (ulonglong)(TestChar >> 5) * 4) >> (TestChar & 0x1f) & 1
                ) != 0)) break;
            if (TestChar == 0x2e) {
              if ((bVar1) || (3 < iVar4)) break;
              bVar1 = true;
            }
            if ((7 < lVar6) && (!bVar1)) break;
          }
          else {
            if (((!bVar1) && (6 < lVar6)) || (iVar5 == (local_168 & 0xffff) - 1)) break;
            iVar5 = iVar5 + 1;
            iVar4 = iVar4 + -1;
            lVar6 = lVar6 + 1;
          }
          iVar5 = iVar5 + 1;
          iVar4 = iVar4 + -1;
          lVar6 = lVar6 + 1;
        } while (iVar5 < (int)(local_168 & 0xffff));
      }
    }
  }
  __security_check_cookie(local_38 ^ (ulonglong)auStack392);
  return;
}



uint FUN_180007094(short *param_1,longlong param_2,longlong param_3,ulonglong param_4)

{
  short sVar1;
  short *psVar2;
  longlong lVar3;
  longlong lVar4;
  uint uVar5;
  
  uVar5 = 0;
  if (0x7ffffffe < param_2 - 1U) {
    uVar5 = 0x80070057;
  }
  if ((int)uVar5 < 0) {
    if (param_2 == 0) {
      return uVar5;
    }
  }
  else {
    if (param_4 < 0x7fffffff) {
      if (param_2 != 0) {
        lVar4 = param_4 - param_2;
        lVar3 = param_3 - (longlong)param_1;
        do {
          if ((lVar4 + param_2 == 0) || (sVar1 = *(short *)(lVar3 + (longlong)param_1), sVar1 == 0))
          break;
          *param_1 = sVar1;
          param_1 = param_1 + 1;
          param_2 = param_2 + -1;
        } while (param_2 != 0);
      }
      psVar2 = param_1 + -1;
      if (param_2 != 0) {
        psVar2 = param_1;
      }
      *psVar2 = 0;
      return ~-(uint)(param_2 != 0) & 0x8007007a;
    }
    uVar5 = 0x80070057;
  }
  *param_1 = 0;
  return uVar5;
}



ulonglong GetCalendarSupportedDateRange(uint param_1,uint *param_2,uint *param_3)

{
  uint uVar1;
  undefined8 uVar2;
  uint uVar3;
  ulonglong uVar4;
  
                    // 0x7130  471  GetCalendarSupportedDateRange
  uVar4 = 0;
  if (((param_2 == (uint *)0x0) || (param_3 == (uint *)0x0)) ||
     (uVar2 = FUN_180007490(param_1), (int)uVar2 == 0)) {
    SetLastError(0x57);
    return 0;
  }
  *param_2 = param_1;
  uVar1 = (uint)uVar4;
  uVar3 = uVar1 + 0xc;
  *param_3 = param_1;
  if (param_1 < 9) {
    if (param_1 == 8) {
      param_2[2] = 0x14df;
      param_2[1] = 1;
      param_2[3] = 4;
      param_2[4] = 7;
      *(undefined8 *)(param_2 + 5) = 6;
      *(ulonglong *)(param_2 + 7) = uVar4;
      param_2[9] = uVar1;
      param_3[2] = 5999;
      param_3[3] = 0xd;
      *(undefined8 *)(param_3 + 4) = 0x1d;
      goto LAB_1800071c0;
    }
    if (param_1 == 0) goto LAB_1800071e3;
    if (param_1 < 3) goto LAB_180007183;
    if (5 < param_1) {
      if (param_1 == 6) {
        *(undefined8 *)(param_2 + 5) = 4;
        param_2[1] = 1;
        param_2[2] = 1;
        param_2[3] = 1;
        param_2[4] = 1;
        *(ulonglong *)(param_2 + 7) = uVar4;
        param_2[9] = uVar1;
        param_3[2] = 0x25c2;
        param_3[3] = 4;
        param_3[4] = 3;
        goto LAB_1800071b8;
      }
      if (param_1 != 7) goto LAB_1800071e3;
    }
    uVar2 = FUN_18004e374(param_1,(longlong)param_2,(longlong)param_3);
    uVar1 = (uint)uVar2;
  }
  else {
    if (uVar3 < param_1) {
      if (param_1 == 0x16) {
        uVar2 = FUN_180050d84((longlong)param_2,(longlong)param_3);
        uVar1 = (uint)uVar2;
        goto LAB_1800071e1;
      }
      if (param_1 != 0x17) goto LAB_1800071e3;
      param_2[2] = 0x526;
      param_2[1] = 1;
      param_2[3] = 1;
      param_2[4] = 1;
      *(undefined8 *)(param_2 + 5) = 1;
      *(ulonglong *)(param_2 + 7) = uVar4;
      param_2[9] = uVar1;
      param_3[2] = 0x5dc;
      param_3[3] = uVar3;
      param_3[4] = 0x1e;
      param_3[5] = 2;
    }
    else {
LAB_180007183:
      *(ulonglong *)(param_2 + 7) = uVar4;
      param_2[1] = 1;
      param_2[2] = 1;
      param_2[3] = 1;
      param_2[4] = 1;
      *(undefined8 *)(param_2 + 5) = 1;
      param_2[9] = uVar1;
      param_3[2] = 9999;
      param_3[3] = uVar3;
      param_3[4] = 0x1f;
LAB_1800071b8:
      param_3[5] = 5;
    }
LAB_1800071c0:
    uVar1 = 1;
    param_3[9] = 9999999;
    param_3[8] = 0x3b;
    param_3[7] = 0x3b;
    param_3[6] = 0x17;
    param_3[1] = 1;
  }
LAB_1800071e1:
  uVar4 = (ulonglong)uVar1;
LAB_1800071e3:
  return uVar4 & 0xffffffff;
}



undefined4 AdjustCalendarDate(uint *param_1,int param_2,int param_3)

{
  bool bVar1;
  int iVar2;
  undefined4 uVar3;
  undefined8 uVar4;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  undefined7 extraout_var_02;
  undefined local_res20 [8];
  
                    // 0x7200  21  AdjustCalendarDate
  iVar2 = IsValidCalDateTime(param_1,(longlong)local_res20);
  if (iVar2 == 0) {
    return 0;
  }
  if (param_2 != 1) {
    if (param_2 != 2) {
      if (param_2 == 3) {
        param_3 = param_3 * 7;
      }
      else if (param_2 != 4) {
        return 0;
      }
      if (8 < *param_1) {
        if (*param_1 < 0xd) {
LAB_18002cbd5:
          bVar1 = FUN_18004daac(param_1,param_3);
          return (int)CONCAT71(extraout_var_00,bVar1);
        }
        if (*param_1 == 0x16) {
          bVar1 = FUN_18005074c((longlong)param_1,param_3);
          return (int)CONCAT71(extraout_var,bVar1);
        }
        if (*param_1 == 0x17) {
          uVar4 = FUN_18004ead4(param_1,param_3);
          return (int)uVar4;
        }
LAB_18002cc0c:
        SetLastError(0x57);
        return 0;
      }
      if (*param_1 == 8) {
        uVar4 = FUN_18004f308(param_1,param_3);
        return (int)uVar4;
      }
      if (*param_1 == 0) goto LAB_18002cc0c;
      if (*param_1 < 3) goto LAB_18002cbd5;
      if (5 < *param_1) {
        if (*param_1 == 6) {
          uVar4 = FUN_18005128c(param_1,param_3);
          return (int)uVar4;
        }
        if (*param_1 != 7) goto LAB_18002cc0c;
      }
      iVar2 = 4;
      goto LAB_18002cb88;
    }
    if (8 < *param_1) {
      if (0xc < *param_1) {
        if (*param_1 == 0x16) {
          bVar1 = FUN_1800507b4((longlong)param_1,param_3);
          return (int)CONCAT71(extraout_var_01,bVar1);
        }
        if (*param_1 == 0x17) goto LAB_18002cc64;
        goto LAB_18002cc0c;
      }
      goto LAB_18000725a;
    }
    if (*param_1 == 8) {
      uVar4 = FUN_18004f360(param_1,param_3);
      return (int)uVar4;
    }
    if (*param_1 == 0) goto LAB_18002cc0c;
    if (*param_1 < 3) goto LAB_18000725a;
    if (5 < *param_1) {
      if (*param_1 == 6) goto LAB_18002cc2d;
      if (*param_1 != 7) goto LAB_18002cc0c;
    }
LAB_18002cb83:
    iVar2 = 2;
LAB_18002cb88:
    uVar4 = FUN_18004dfd8(param_1,iVar2,param_3);
    return (int)uVar4;
  }
  if (*param_1 < 9) {
    if (*param_1 == 8) {
      uVar4 = FUN_18004f494(param_1,param_3);
      return (int)uVar4;
    }
    if (*param_1 == 0) goto LAB_18002cc0c;
    if (2 < *param_1) {
      if (5 < *param_1) {
        if (*param_1 == 6) {
          param_3 = param_3 * 0xc;
LAB_18002cc2d:
          uVar4 = FUN_1800512e4((longlong)param_1,param_3);
          return (int)uVar4;
        }
        if (*param_1 != 7) goto LAB_18002cc0c;
      }
      param_3 = param_3 * 0xc;
      goto LAB_18002cb83;
    }
  }
  else if (0xc < *param_1) {
    if (*param_1 == 0x16) {
      bVar1 = FUN_18005081c((longlong)param_1,param_3);
      return (int)CONCAT71(extraout_var_02,bVar1);
    }
    if (*param_1 == 0x17) {
      param_3 = param_3 * 0xc;
LAB_18002cc64:
      uVar4 = FUN_18004eb2c(param_1,param_3);
      return (int)uVar4;
    }
    goto LAB_18002cc0c;
  }
  param_3 = param_3 * 0xc;
LAB_18000725a:
  uVar3 = FUN_180007288(param_1,param_3);
  return uVar3;
}



void FUN_180007288(uint *param_1,int param_2)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  ulonglong uVar5;
  int iVar6;
  uint uVar7;
  undefined auStack136 [32];
  undefined local_68 [8];
  uint local_60;
  uint local_5c;
  uint local_58;
  uint local_54;
  uint local_50;
  uint local_48;
  uint local_44;
  uint local_40;
  uint local_3c;
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack136;
  if (param_1 != (uint *)0x0) {
    iVar6 = param_1[3] + param_2;
    uVar2 = param_1[4];
    iVar4 = iVar6 + -1;
    if (iVar4 < 0) {
      iVar4 = iVar6 + -0xc;
      uVar7 = iVar6 % 0xc + 0xc;
    }
    else {
      uVar7 = iVar4 % 0xc + 1;
    }
    uVar5 = (ulonglong)uVar7;
    uVar1 = param_1[2] + iVar4 / 0xc;
    uVar3 = GetCalendarDaysInMonth(*param_1,uVar7,uVar1,param_1[1]);
    if (uVar3 == 0) {
      SetLastError(0x120);
    }
    else {
      local_50 = uVar2;
      if ((int)uVar3 < (int)uVar2) {
        local_50 = uVar3;
      }
      local_60 = *param_1;
      local_5c = param_1[1];
      local_48 = param_1[6];
      local_44 = param_1[7];
      local_40 = param_1[8];
      local_3c = param_1[9];
      local_58 = uVar1;
      local_54 = uVar7;
      iVar4 = UpdateCalendarDayOfWeek(&local_60,uVar5);
      if ((iVar4 != 0) && (iVar4 = IsValidCalDateTime(&local_60,(longlong)local_68), iVar4 != 0)) {
        FUN_1800075c4(param_1,&local_60);
      }
    }
  }
  __security_check_cookie(local_38 ^ (ulonglong)auStack136);
  return;
}



int GetCalendarDaysInMonth(uint param_1,uint param_2,uint param_3,uint param_4)

{
  int iVar1;
  ulonglong uVar2;
  
                    // 0x73b0  465  GetCalendarDaysInMonth
  if (param_1 < 9) {
    if (param_1 == 8) {
      uVar2 = FUN_18004f73c(param_2,param_3,param_4);
      return (int)uVar2;
    }
    if (param_1 != 0) {
      if (2 < param_1) {
        if (5 < param_1) {
          if (param_1 == 6) {
            uVar2 = FUN_180051744(param_2,param_3,param_4);
            return (int)uVar2;
          }
          if (param_1 != 7) goto LAB_18002cd8e;
        }
        iVar1 = FUN_18004e2ac(param_1,param_2,param_3,param_4);
        return iVar1;
      }
LAB_1800073de:
      iVar1 = FUN_1800073fc(param_2,param_3,param_4);
      return iVar1;
    }
  }
  else {
    if (param_1 < 0xd) goto LAB_1800073de;
    if (param_1 == 0x16) {
      iVar1 = FUN_180050b18(param_2,param_3,param_4);
      return iVar1;
    }
    if (param_1 == 0x17) {
      uVar2 = FUN_18004ed84(param_2,param_3,param_4);
      return (int)uVar2;
    }
  }
LAB_18002cd8e:
  SetLastError(0x57);
  return 0;
}



int FUN_1800073fc(uint param_1,uint param_2,int param_3)

{
  bool bVar1;
  undefined8 uVar2;
  uint uVar3;
  
  uVar2 = FUN_1800084e0(param_2,param_3);
  if ((int)uVar2 != 0) {
    uVar3 = param_1 - 1;
    if (uVar3 < 0xc) {
      if (((param_2 & 3) == 0) &&
         ((param_2 != (param_2 / 100) * 100 || (param_2 == (param_2 / 400) * 400)))) {
        bVar1 = true;
      }
      else {
        bVar1 = false;
      }
      if (!bVar1) {
        return *(int *)(&DAT_1800875c8 + (ulonglong)param_1 * 4) -
               *(int *)(&DAT_1800875c8 + (ulonglong)uVar3 * 4);
      }
      return *(int *)(&DAT_180087590 + (ulonglong)param_1 * 4) -
             *(int *)(&DAT_180087590 + (ulonglong)uVar3 * 4);
    }
    SetLastError(0x57);
  }
  return 0;
}



undefined8 FUN_180007490(uint param_1)

{
  if ((param_1 != 0) && ((param_1 < 0xd || (param_1 - 0x16 < 2)))) {
    return 1;
  }
  return 0;
}



// WARNING: Could not reconcile some variable overlaps

ulonglong ConvertSystemTimeToCalDateTime(ushort *param_1,undefined8 param_2,uint *param_3)

{
  bool bVar1;
  undefined4 uVar2;
  int iVar3;
  undefined8 uVar4;
  undefined4 extraout_var_00;
  ulonglong uVar5;
  undefined7 extraout_var;
  uint uVar6;
  uint *puVar7;
  undefined4 local_38;
  undefined4 uStack52;
  undefined8 uStack48;
  undefined4 local_28;
  undefined4 uStack36;
  undefined4 uStack32;
  undefined4 uStack28;
  undefined8 local_18;
  
                    // 0x74b0  167  ConvertSystemTimeToCalDateTime
  if ((param_3 != (uint *)0x0) && (param_1 != (ushort *)0x0)) {
    uStack48 = 0x1800074cb;
    puVar7 = param_3;
    uVar4 = FUN_180007490((uint)param_2);
    if ((int)uVar4 != 0) {
      uVar6 = (uint)param_2;
      *param_3 = uVar6;
      if (uVar6 < 9) {
        if (uVar6 == 8) {
          uVar5 = FUN_18004f5b4(param_1,puVar7);
          return uVar5;
        }
        if (uVar6 != 0) {
          if (2 < uVar6) {
            if (5 < uVar6) {
              if (uVar6 == 6) {
                uVar5 = FUN_180051470(param_1,puVar7,0);
                return uVar5;
              }
              if (uVar6 != 7) goto LAB_1800074fa;
            }
            iVar3 = FUN_18000751c(param_1,1,&local_38);
            if (iVar3 != 0) {
              uVar6 = *puVar7;
              *(undefined2 *)puVar7 = (undefined2)local_38;
              *(undefined2 *)((longlong)puVar7 + 2) = local_38._2_2_;
              *(undefined2 *)(puVar7 + 1) = (undefined2)uStack52;
              *(undefined2 *)((longlong)puVar7 + 6) = uStack52._2_2_;
              *(ushort *)(puVar7 + 2) = (ushort)uStack48;
              *(undefined2 *)((longlong)puVar7 + 10) = uStack48._2_2_;
              *(ushort *)(puVar7 + 3) = uStack48._4_2_;
              *(undefined2 *)((longlong)puVar7 + 0xe) = uStack48._6_2_;
              *(ushort *)(puVar7 + 4) = (ushort)local_28;
              *(undefined2 *)((longlong)puVar7 + 0x12) = local_28._2_2_;
              *(undefined2 *)(puVar7 + 5) = (undefined2)uStack36;
              *(undefined2 *)((longlong)puVar7 + 0x16) = uStack36._2_2_;
              *(undefined2 *)(puVar7 + 6) = (undefined2)uStack32;
              *(undefined2 *)((longlong)puVar7 + 0x1a) = uStack32._2_2_;
              *(undefined2 *)(puVar7 + 7) = (undefined2)uStack28;
              *(undefined2 *)((longlong)puVar7 + 0x1e) = uStack28._2_2_;
              *(undefined8 *)(puVar7 + 8) = local_18;
              *puVar7 = uVar6;
              bVar1 = FUN_18004e9ac(uVar6,(ushort)uStack48,uStack48._4_2_,(ushort)local_28,
                                    (longlong)puVar7);
              if ((int)CONCAT71(extraout_var,bVar1) != 0) {
                return 1;
              }
            }
            return 0;
          }
LAB_1800074ee:
          uVar2 = FUN_18000751c(param_1,param_2,param_3);
          return CONCAT44(extraout_var_00,uVar2);
        }
      }
      else {
        if (uVar6 < 0xd) goto LAB_1800074ee;
        if (uVar6 == 0x16) {
          uVar5 = FUN_180050990(param_1,(longlong)puVar7);
          return uVar5;
        }
        if (uVar6 == 0x17) {
          iVar3 = FUN_18000751c(param_1,1,&local_38);
          if ((iVar3 != 0) && (uVar4 = FUN_18004ee0c(&local_38), (int)uVar4 != 0)) {
            *puVar7 = local_38;
            puVar7[1] = uStack52;
            puVar7[2] = (uint)uStack48;
            puVar7[3] = uStack48._4_4_;
            puVar7[4] = local_28;
            puVar7[5] = uStack36;
            puVar7[6] = uStack32;
            puVar7[7] = uStack28;
            *(undefined8 *)(puVar7 + 8) = local_18;
            return 1;
          }
          return 0;
        }
      }
    }
  }
LAB_1800074fa:
  uStack48 = 0x180007506;
  SetLastError(0x57);
  return 0;
}



undefined4 FUN_18000751c(ushort *param_1,undefined8 param_2,undefined4 *param_3)

{
  undefined8 uVar1;
  undefined4 uVar2;
  undefined4 local_38;
  undefined4 local_34;
  uint local_30;
  uint local_2c;
  uint local_28;
  uint local_24;
  uint local_20;
  uint local_1c;
  uint local_18;
  int local_14;
  
  local_30 = (uint)*param_1;
  uVar2 = 0;
  local_2c = (uint)param_1[1];
  local_28 = (uint)param_1[3];
  local_20 = (uint)param_1[4];
  local_1c = (uint)param_1[5];
  local_18 = (uint)param_1[6];
  local_14 = (uint)param_1[7] * 10000;
  local_34 = 1;
  local_38 = (undefined4)param_2;
  local_24 = (uint)param_1[2];
  uVar1 = FUN_180008308((longlong)&local_38,param_2,1);
  if ((int)uVar1 == 0) {
    SetLastError(0x57);
  }
  else {
    uVar1 = FUN_1800075c4(param_3,&local_38);
    uVar2 = 0;
    if ((int)uVar1 != 0) {
      uVar2 = 1;
    }
  }
  return uVar2;
}



undefined8 FUN_1800075c4(undefined4 *param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  
  if ((param_1 != (undefined4 *)0x0) && (param_2 != (undefined4 *)0x0)) {
    uVar1 = param_2[1];
    uVar2 = param_2[2];
    uVar3 = param_2[3];
    *param_1 = *param_2;
    param_1[1] = uVar1;
    param_1[2] = uVar2;
    param_1[3] = uVar3;
    uVar1 = param_2[5];
    uVar2 = param_2[6];
    uVar3 = param_2[7];
    param_1[4] = param_2[4];
    param_1[5] = uVar1;
    param_1[6] = uVar2;
    param_1[7] = uVar3;
    *(undefined8 *)(param_1 + 8) = *(undefined8 *)(param_2 + 8);
    return 1;
  }
  return 0;
}



void BasepAppContainerEnvironmentExtension(PSID param_1,undefined8 param_2,longlong *param_3)

{
  wchar_t wVar1;
  wchar_t wVar2;
  int iVar3;
  uint uVar4;
  BOOL BVar5;
  wchar_t *_Str;
  longlong lVar6;
  wchar_t *pwVar7;
  ulonglong uVar8;
  wchar_t *pwVar9;
  wchar_t *pwVar10;
  longlong lVar11;
  longlong lVar12;
  ulonglong uVar13;
  ulonglong uVar14;
  wchar_t *pwVar15;
  wchar_t *pwVar16;
  wchar_t *pwVar17;
  longlong in_GS_OFFSET;
  undefined auStack360 [32];
  undefined4 *puStack328;
  undefined4 **ppuStack320;
  wchar_t *pwStack312;
  wchar_t *pwStack304;
  int aiStack296 [2];
  longlong lStack288;
  undefined4 *puStack280;
  longlong lStack272;
  wchar_t *pwStack264;
  int iStack256;
  undefined4 uStack252;
  int aiStack248 [2];
  longlong lStack240;
  longlong *plStack232;
  undefined auStack224 [16];
  undefined auStack208 [16];
  undefined auStack192 [16];
  undefined auStack176 [24];
  PSID apvStack152 [10];
  ulonglong uStack72;
  
                    // 0x7600  78  BasepAppContainerEnvironmentExtension
  uStack72 = DAT_1800b2220 ^ (ulonglong)auStack360;
  pwVar10 = (wchar_t *)0x0;
  iStack256 = 0;
  lStack272 = 0;
  puStack280 = (undefined4 *)0x0;
  lStack288 = 0;
  pwVar17 = (wchar_t *)0x0;
  pwStack304 = (wchar_t *)0x0;
  pwVar15 = (wchar_t *)0x0;
  pwVar16 = (wchar_t *)0x0;
  plStack232 = param_3;
  memset(apvStack152,0,0x4c);
  *param_3 = 0;
  puStack328 = &uStack252;
  aiStack296[0] = 0;
  aiStack248[0] = 0;
  lStack240 = 0;
  pwStack264 = (wchar_t *)0x0;
  iVar3 = NtQueryInformationToken(&DAT_fffffffffffffffa,0x1d,&iStack256,4);
  if (iVar3 < 0) goto LAB_180007f0b;
  if (iStack256 == 0) {
LAB_180007769:
    iVar3 = AppContainerLookupMoniker(param_1,&lStack272);
    if (iVar3 < 0) goto LAB_180007f0b;
    uVar4 = RtlCreateEnvironmentEx(param_2,&lStack288,0);
    _Str = pwVar15;
    pwVar9 = pwVar16;
    pwVar7 = pwVar17;
    if ((-1 < (int)uVar4) &&
       (uVar4 = RtlGetAppContainerSidType(param_1,aiStack248), -1 < (int)uVar4)) {
      ppuStack320 = &puStack280;
      puStack328 = (undefined4 *)0x0;
      uVar4 = RtlQueryEnvironmentVariable(lStack288,L"LOCALAPPDATA",0xc,0);
      if (uVar4 == 0xc0000023) {
        _Str = (wchar_t *)
               RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                               (longlong)puStack280 * 2);
        pwStack312 = _Str;
        if (_Str == (wchar_t *)0x0) {
          uVar4 = 0xc0000017;
        }
        else {
          memset(_Str,0,(longlong)puStack280 * 2);
          ppuStack320 = &puStack280;
          puStack328 = puStack280;
          uVar4 = RtlQueryEnvironmentVariable(lStack288,L"LOCALAPPDATA",0xc,_Str);
          if (-1 < (int)uVar4) {
            if (aiStack248[0] == 2) {
              lVar12 = -1;
              do {
                lVar12 = lVar12 + 1;
              } while (*(short *)(lStack272 + lVar12 * 2) != 0);
              uVar14 = (lVar12 + (longlong)puStack280) * 2 + 0x20;
              pwVar7 = (wchar_t *)
                       RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                                       uVar14);
              if (pwVar7 == (wchar_t *)0x0) {
                uVar4 = 0xc0000017;
              }
              else {
                uVar4 = FUN_18000760c(pwVar7,uVar14,_Str);
                lVar12 = 0;
                if (-1 < (int)uVar4) {
                  uVar13 = uVar14 >> 1;
                  uVar4 = 0;
                  if (0x7ffffffe < uVar13 - 1) {
                    uVar4 = 0xc000000d;
                  }
                  uVar8 = uVar13;
                  pwVar10 = pwVar7;
                  if (-1 < (int)uVar4) {
                    for (; (uVar8 != 0 && (*pwVar10 != L'\0')); pwVar10 = pwVar10 + 1) {
                      uVar8 = uVar8 - 1;
                    }
                    uVar4 = ~-(uint)(uVar8 != 0) & 0xc000000d;
                    if (uVar8 != 0) {
                      lVar12 = uVar13 - uVar8;
                    }
                  }
                  _Str = pwStack312;
                  if (-1 < (int)uVar4) {
                    pwVar10 = pwVar7 + lVar12;
                    lVar11 = uVar13 - lVar12;
                    if (lVar11 != 0) {
                      lVar12 = (lVar11 - uVar13) + 0x7ffffffe + lVar12;
                      lVar6 = (longlong)L"\\Packages\\" - (longlong)pwVar10;
                      do {
                        if ((lVar12 == 0) ||
                           (wVar1 = *(wchar_t *)(lVar6 + (longlong)pwVar10), wVar1 == L'\0')) break;
                        *pwVar10 = wVar1;
                        lVar12 = lVar12 + -1;
                        pwVar10 = pwVar10 + 1;
                        lVar11 = lVar11 + -1;
                      } while (lVar11 != 0);
                    }
                    pwVar15 = pwVar10 + -1;
                    if (lVar11 != 0) {
                      pwVar15 = pwVar10;
                    }
                    uVar4 = ~-(uint)(lVar11 != 0) & 0x80000005;
                    *pwVar15 = L'\0';
                    if (-1 < (int)uVar4) {
                      uVar8 = FUN_180008148(pwVar7,uVar14,lStack272);
                      lVar12 = 0;
                      uVar4 = (uint)uVar8;
                      _Str = pwStack312;
                      if (-1 < (int)uVar4) {
                        uVar4 = 0;
                        if (0x7ffffffe < uVar13 - 1) {
                          uVar4 = 0xc000000d;
                        }
                        uVar8 = uVar13;
                        pwVar10 = pwVar7;
                        if (-1 < (int)uVar4) {
                          for (; (uVar8 != 0 && (*pwVar10 != L'\0')); pwVar10 = pwVar10 + 1) {
                            uVar8 = uVar8 - 1;
                          }
                          uVar4 = ~-(uint)(uVar8 != 0) & 0xc000000d;
                          if (uVar8 != 0) {
                            lVar12 = uVar13 - uVar8;
                          }
                        }
                        if (-1 < (int)uVar4) {
                          pwVar10 = pwVar7 + lVar12;
                          lVar11 = uVar13 - lVar12;
                          if (lVar11 != 0) {
                            lVar12 = (lVar11 - uVar13) + 0x7ffffffe + lVar12;
                            lVar6 = (longlong)&DAT_1800851e8 - (longlong)pwVar10;
                            do {
                              if ((lVar12 == 0) ||
                                 (wVar1 = *(wchar_t *)(lVar6 + (longlong)pwVar10), wVar1 == L'\0'))
                              break;
                              *pwVar10 = wVar1;
                              lVar12 = lVar12 + -1;
                              pwVar10 = pwVar10 + 1;
                              lVar11 = lVar11 + -1;
                            } while (lVar11 != 0);
                          }
                          pwVar15 = pwVar10 + -1;
                          if (lVar11 != 0) {
                            pwVar15 = pwVar10;
                          }
                          uVar4 = ~-(uint)(lVar11 != 0) & 0x80000005;
                          *pwVar15 = L'\0';
LAB_180007c30:
                          _Str = pwStack312;
                          if (-1 < (int)uVar4) {
                            RtlInitUnicodeString(auStack192,pwVar7);
                            RtlInitUnicodeString(auStack176,L"LOCALAPPDATA");
                            uVar4 = RtlSetEnvironmentVariable(&lStack288,auStack176,auStack192);
                            _Str = pwStack312;
                            if (-1 < (int)uVar4) {
                              uVar14 = uVar14 + 0xe;
                              pwVar9 = (wchar_t *)
                                       RtlAllocateHeap(*(undefined8 *)
                                                        (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                                       0,uVar14);
                              if (pwVar9 == (wchar_t *)0x0) {
                                uVar4 = 0xc0000017;
                                _Str = pwStack312;
                              }
                              else {
                                uVar4 = FUN_18000760c(pwVar9,uVar14,pwVar7);
                                lVar12 = 0;
                                _Str = pwStack312;
                                if (-1 < (int)uVar4) {
                                  uVar14 = uVar14 >> 1;
                                  uVar4 = 0;
                                  if (0x7ffffffe < uVar14 - 1) {
                                    uVar4 = 0xc000000d;
                                  }
                                  uVar13 = uVar14;
                                  pwVar10 = pwVar9;
                                  if (-1 < (int)uVar4) {
                                    for (; (uVar13 != 0 && (*pwVar10 != L'\0'));
                                        pwVar10 = pwVar10 + 1) {
                                      uVar13 = uVar13 - 1;
                                    }
                                    uVar4 = ~-(uint)(uVar13 != 0) & 0xc000000d;
                                    if (uVar13 != 0) {
                                      lVar12 = uVar14 - uVar13;
                                    }
                                  }
                                  if (-1 < (int)uVar4) {
                                    pwVar10 = pwVar9 + lVar12;
                                    lVar11 = uVar14 - lVar12;
                                    if (lVar11 != 0) {
                                      lVar6 = lVar12 + 0x7ffffffe + (lVar11 - uVar14);
                                      lVar12 = (longlong)L"\\Temp" - (longlong)pwVar10;
                                      do {
                                        if ((lVar6 == 0) ||
                                           (wVar1 = *(wchar_t *)((longlong)pwVar10 + lVar12),
                                           wVar1 == L'\0')) break;
                                        *pwVar10 = wVar1;
                                        lVar6 = lVar6 + -1;
                                        pwVar10 = pwVar10 + 1;
                                        lVar11 = lVar11 + -1;
                                      } while (lVar11 != 0);
                                    }
                                    pwVar15 = pwVar10 + -1;
                                    if (lVar11 != 0) {
                                      pwVar15 = pwVar10;
                                    }
                                    uVar4 = ~-(uint)(lVar11 != 0) & 0x80000005;
                                    *pwVar15 = L'\0';
                                    if (-1 < (int)uVar4) {
                                      RtlInitUnicodeString(auStack208,pwVar9);
                                      RtlInitUnicodeString(auStack224,L"TEMP");
                                      uVar4 = RtlSetEnvironmentVariable
                                                        (&lStack288,auStack224,auStack208);
                                      _Str = pwStack312;
                                      if (-1 < (int)uVar4) {
                                        RtlInitUnicodeString(auStack224,&DAT_1800851c0);
                                        uVar4 = RtlSetEnvironmentVariable
                                                          (&lStack288,auStack224,auStack208);
                                        _Str = pwStack312;
                                        if (-1 < (int)uVar4) {
                                          *plStack232 = lStack288;
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                              goto LAB_180007e2b;
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
LAB_18002ced6:
              pwVar9 = (wchar_t *)0x0;
            }
            else {
              uVar4 = RtlGetAppContainerParent(param_1,&lStack240);
              if ((-1 < (int)uVar4) &&
                 (uVar4 = FUN_180009650(param_1,lStack240,&pwStack264), pwVar15 = pwStack264,
                 -1 < (int)uVar4)) {
                pwVar16 = wcsstr(_Str,pwStack264);
                lVar12 = -1;
                if (aiStack296[0] != 2) {
                  if ((aiStack296[0] == 1) && (pwVar16 != (wchar_t *)0x0)) {
                    lVar11 = -1;
                    do {
                      lVar11 = lVar11 + 1;
                    } while (pwStack264[lVar11] != L'\0');
                    pwVar10 = pwVar16 + lVar11;
                    pwVar15 = wcsstr(pwVar10,L"\\AC\\#!");
                    if (pwVar10 == pwVar15) {
                      pwVar10 = pwVar10 + 6;
                      lVar11 = lStack272 - (longlong)pwVar10;
                      do {
                        wVar1 = *pwVar10;
                        wVar2 = *(wchar_t *)((longlong)pwVar10 + lVar11);
                        if (wVar1 != wVar2) break;
                        pwVar10 = pwVar10 + 1;
                      } while (wVar2 != L'\0');
                      if (wVar1 == wVar2) goto LAB_180007f0b;
                    }
                  }
LAB_180007927:
                  lVar11 = (longlong)puStack280 * 2;
                  if (pwVar16 == (wchar_t *)0x0) {
                    lVar6 = -1;
                    do {
                      lVar6 = lVar6 + 1;
                    } while (pwStack264[lVar6] != L'\0');
                    lVar11 = lVar11 + lVar6 * 2 + 0x1e;
                  }
                  do {
                    lVar12 = lVar12 + 1;
                  } while (*(short *)(lStack272 + lVar12 * 2) != 0);
                  uVar14 = lVar11 + 10 + lVar12 * 2;
                  pwVar7 = (wchar_t *)
                           RtlAllocateHeap(*(undefined8 *)
                                            (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,uVar14);
                  if (pwVar7 == (wchar_t *)0x0) {
                    uVar4 = 0xc0000017;
                    _Str = pwStack312;
                  }
                  else {
                    uVar4 = FUN_18000760c(pwVar7,uVar14,pwStack312);
                    lVar12 = 0;
                    _Str = pwStack312;
                    if (-1 < (int)uVar4) {
                      if (pwVar16 != (wchar_t *)0x0) {
LAB_180007b52:
                        lVar11 = 0;
                        uVar13 = uVar14 >> 1;
                        lVar12 = lVar11;
                        if (0x7ffffffe < uVar13 - 1) {
                          lVar12 = 0xc000000d;
                        }
                        uVar4 = (uint)lVar12;
                        uVar8 = uVar13;
                        pwVar10 = pwVar7;
                        if (-1 < (int)uVar4) {
                          for (; (uVar8 != 0 && (*pwVar10 != L'\0')); pwVar10 = pwVar10 + 1) {
                            uVar8 = uVar8 - 1;
                          }
                          uVar4 = ~-(uint)(uVar8 != 0) & 0xc000000d;
                          if (uVar8 != 0) {
                            lVar11 = uVar13 - uVar8;
                          }
                        }
                        _Str = pwStack312;
                        pwVar9 = pwStack304;
                        if (-1 < (int)uVar4) {
                          pwVar10 = pwVar7 + lVar11;
                          lVar12 = uVar13 - lVar11;
                          if (lVar12 != 0) {
                            lVar11 = (lVar12 - uVar13) + 0x7ffffffe + lVar11;
                            lVar6 = (longlong)&DAT_180085208 - (longlong)pwVar10;
                            do {
                              if ((lVar11 == 0) ||
                                 (wVar1 = *(wchar_t *)(lVar6 + (longlong)pwVar10), wVar1 == L'\0'))
                              break;
                              *pwVar10 = wVar1;
                              lVar11 = lVar11 + -1;
                              pwVar10 = pwVar10 + 1;
                              lVar12 = lVar12 + -1;
                            } while (lVar12 != 0);
                          }
                          pwVar15 = pwVar10 + -1;
                          if (lVar12 != 0) {
                            pwVar15 = pwVar10;
                          }
                          uVar4 = ~-(uint)(lVar12 != 0) & 0x80000005;
                          *pwVar15 = L'\0';
                          if (-1 < (int)uVar4) {
                            uVar13 = FUN_180008148(pwVar7,uVar14,lStack272);
                            uVar4 = (uint)uVar13;
                            goto LAB_180007c30;
                          }
                        }
                        goto LAB_180007e2b;
                      }
                      uVar13 = uVar14 >> 1;
                      uVar4 = 0;
                      if (0x7ffffffe < uVar13 - 1) {
                        uVar4 = 0xc000000d;
                      }
                      uVar8 = uVar13;
                      pwVar10 = pwVar7;
                      if (-1 < (int)uVar4) {
                        for (; (uVar8 != 0 && (*pwVar10 != L'\0')); pwVar10 = pwVar10 + 1) {
                          uVar8 = uVar8 - 1;
                        }
                        uVar4 = ~-(uint)(uVar8 != 0) & 0xc000000d;
                        if (uVar8 != 0) {
                          lVar12 = uVar13 - uVar8;
                        }
                      }
                      if (-1 < (int)uVar4) {
                        pwVar10 = pwVar7 + lVar12;
                        lVar11 = uVar13 - lVar12;
                        if (lVar11 != 0) {
                          lVar12 = (lVar11 - uVar13) + 0x7ffffffe + lVar12;
                          lVar6 = (longlong)L"\\Packages\\" - (longlong)pwVar10;
                          do {
                            if ((lVar12 == 0) ||
                               (wVar1 = *(wchar_t *)(lVar6 + (longlong)pwVar10), wVar1 == L'\0'))
                            break;
                            *pwVar10 = wVar1;
                            lVar12 = lVar12 + -1;
                            pwVar10 = pwVar10 + 1;
                            lVar11 = lVar11 + -1;
                          } while (lVar11 != 0);
                        }
                        pwVar15 = pwVar10 + -1;
                        if (lVar11 != 0) {
                          pwVar15 = pwVar10;
                        }
                        uVar4 = ~-(uint)(lVar11 != 0) & 0x80000005;
                        *pwVar15 = L'\0';
                        if (-1 < (int)uVar4) {
                          uVar8 = FUN_180008148(pwVar7,uVar14,pwStack264);
                          lVar12 = 0;
                          uVar4 = (uint)uVar8;
                          _Str = pwStack312;
                          if (-1 < (int)uVar4) {
                            uVar4 = 0;
                            if (0x7ffffffe < uVar13 - 1) {
                              uVar4 = 0xc000000d;
                            }
                            uVar8 = uVar13;
                            pwVar10 = pwVar7;
                            if (-1 < (int)uVar4) {
                              for (; (uVar8 != 0 && (*pwVar10 != L'\0')); pwVar10 = pwVar10 + 1) {
                                uVar8 = uVar8 - 1;
                              }
                              uVar4 = ~-(uint)(uVar8 != 0) & 0xc000000d;
                              if (uVar8 != 0) {
                                lVar12 = uVar13 - uVar8;
                              }
                            }
                            if (-1 < (int)uVar4) {
                              pwVar10 = pwVar7 + lVar12;
                              lVar11 = uVar13 - lVar12;
                              if (lVar11 != 0) {
                                lVar12 = (lVar11 - uVar13) + 0x7ffffffe + lVar12;
                                lVar6 = (longlong)&DAT_1800851e8 - (longlong)pwVar10;
                                do {
                                  if ((lVar12 == 0) ||
                                     (wVar1 = *(wchar_t *)(lVar6 + (longlong)pwVar10),
                                     wVar1 == L'\0')) break;
                                  *pwVar10 = wVar1;
                                  lVar12 = lVar12 + -1;
                                  pwVar10 = pwVar10 + 1;
                                  lVar11 = lVar11 + -1;
                                } while (lVar11 != 0);
                              }
                              pwVar15 = pwVar10 + -1;
                              if (lVar11 != 0) {
                                pwVar15 = pwVar10;
                              }
                              uVar4 = ~-(uint)(lVar11 != 0) & 0x80000005;
                              *pwVar15 = L'\0';
                              if (-1 < (int)uVar4) goto LAB_180007b52;
                            }
                          }
                        }
                      }
                    }
                  }
                  goto LAB_18002ced6;
                }
                if (pwVar16 != (wchar_t *)0x0) {
                  lVar11 = -1;
                  do {
                    lVar11 = lVar11 + 1;
                  } while (pwVar15[lVar11] != L'\0');
                  iVar3 = wcscmp(pwVar16 + lVar11,L"\\AC");
                  if (iVar3 == 0) goto LAB_180007927;
                }
                uVar4 = 0xc000000d;
                _Str = pwStack312;
                pwVar7 = pwVar10;
              }
            }
          }
        }
      }
    }
  }
  else {
    puStack328 = &uStack252;
    uStack252 = 0x4c;
    iVar3 = NtQueryInformationToken(&DAT_fffffffffffffffa,0x1f,apvStack152,0x4c);
    if (iVar3 < 0) goto LAB_180007f0b;
    uVar4 = RtlGetAppContainerSidType(apvStack152[0],aiStack296);
    _Str = pwVar10;
    pwVar9 = pwVar10;
    pwVar7 = pwVar10;
    if (-1 < (int)uVar4) {
      if ((aiStack296[0] == 2) && (BVar5 = EqualSid(apvStack152[0],param_1), BVar5 != 0))
      goto LAB_180007f0b;
      goto LAB_180007769;
    }
  }
LAB_180007e2b:
  if (lStack272 != 0) {
    AppContainerFreeMemory();
  }
  if (_Str != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,_Str);
  }
  if (lStack240 != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lStack240);
  }
  if (pwStack264 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pwStack264);
  }
  if (pwVar7 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pwVar7);
  }
  if (pwVar9 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pwVar9);
  }
  if (((int)uVar4 < 0) && (lStack288 != 0)) {
    RtlDestroyEnvironment();
  }
LAB_180007f0b:
  __security_check_cookie(uStack72 ^ (ulonglong)auStack360);
  return;
}



uint FUN_18000760c(short *param_1,ulonglong param_2,undefined8 param_3)

{
  uint uVar1;
  ulonglong uVar2;
  
  uVar2 = param_2 >> 1;
  uVar1 = 0;
  if (0x7ffffffe < uVar2 - 1) {
    uVar1 = 0xc000000d;
  }
  if ((int)uVar1 < 0) {
    if (uVar2 != 0) {
      *param_1 = 0;
    }
  }
  else {
    uVar1 = FUN_1800081d4(param_1,uVar2,param_3,param_3);
  }
  return uVar1;
}



void FUN_180007650(PSID param_1,undefined8 param_2,longlong *param_3)

{
  wchar_t wVar1;
  wchar_t wVar2;
  int iVar3;
  uint uVar4;
  BOOL BVar5;
  wchar_t *_Str;
  longlong lVar6;
  wchar_t *pwVar7;
  ulonglong uVar8;
  wchar_t *pwVar9;
  wchar_t *pwVar10;
  longlong lVar11;
  longlong lVar12;
  ulonglong uVar13;
  ulonglong uVar14;
  wchar_t *pwVar15;
  wchar_t *pwVar16;
  wchar_t *pwVar17;
  longlong in_GS_OFFSET;
  undefined auStack360 [32];
  undefined4 *local_148;
  undefined4 **local_140;
  wchar_t *local_138;
  wchar_t *local_130;
  int local_128 [2];
  longlong local_120;
  undefined4 *local_118;
  longlong local_110;
  wchar_t *local_108;
  int local_100;
  undefined4 local_fc;
  int local_f8 [2];
  longlong local_f0;
  longlong *local_e8;
  undefined local_e0 [16];
  undefined local_d0 [16];
  undefined local_c0 [16];
  undefined local_b0 [24];
  PSID local_98 [10];
  ulonglong local_48;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStack360;
  pwVar10 = (wchar_t *)0x0;
  local_100 = 0;
  local_110 = 0;
  local_118 = (undefined4 *)0x0;
  local_120 = 0;
  pwVar17 = (wchar_t *)0x0;
  local_130 = (wchar_t *)0x0;
  pwVar15 = (wchar_t *)0x0;
  pwVar16 = (wchar_t *)0x0;
  local_e8 = param_3;
  memset(local_98,0,0x4c);
  *param_3 = 0;
  local_148 = &local_fc;
  local_128[0] = 0;
  local_f8[0] = 0;
  local_f0 = 0;
  local_108 = (wchar_t *)0x0;
  iVar3 = NtQueryInformationToken(&DAT_fffffffffffffffa,0x1d,&local_100,4);
  if (iVar3 < 0) goto LAB_180007f0b;
  if (local_100 == 0) {
LAB_180007769:
    iVar3 = AppContainerLookupMoniker(param_1,&local_110);
    if (iVar3 < 0) goto LAB_180007f0b;
    uVar4 = RtlCreateEnvironmentEx(param_2,&local_120,0);
    _Str = pwVar15;
    pwVar9 = pwVar16;
    pwVar7 = pwVar17;
    if ((-1 < (int)uVar4) && (uVar4 = RtlGetAppContainerSidType(param_1,local_f8), -1 < (int)uVar4))
    {
      local_140 = &local_118;
      local_148 = (undefined4 *)0x0;
      uVar4 = RtlQueryEnvironmentVariable(local_120,L"LOCALAPPDATA",0xc,0);
      if (uVar4 == 0xc0000023) {
        _Str = (wchar_t *)
               RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                               (longlong)local_118 * 2);
        local_138 = _Str;
        if (_Str == (wchar_t *)0x0) {
          uVar4 = 0xc0000017;
        }
        else {
          memset(_Str,0,(longlong)local_118 * 2);
          local_140 = &local_118;
          local_148 = local_118;
          uVar4 = RtlQueryEnvironmentVariable(local_120,L"LOCALAPPDATA",0xc,_Str);
          if (-1 < (int)uVar4) {
            if (local_f8[0] == 2) {
              lVar12 = -1;
              do {
                lVar12 = lVar12 + 1;
              } while (*(short *)(local_110 + lVar12 * 2) != 0);
              uVar14 = (lVar12 + (longlong)local_118) * 2 + 0x20;
              pwVar7 = (wchar_t *)
                       RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                                       uVar14);
              if (pwVar7 == (wchar_t *)0x0) {
                uVar4 = 0xc0000017;
              }
              else {
                uVar4 = FUN_18000760c(pwVar7,uVar14,_Str);
                lVar12 = 0;
                if (-1 < (int)uVar4) {
                  uVar13 = uVar14 >> 1;
                  uVar4 = 0;
                  if (0x7ffffffe < uVar13 - 1) {
                    uVar4 = 0xc000000d;
                  }
                  uVar8 = uVar13;
                  pwVar10 = pwVar7;
                  if (-1 < (int)uVar4) {
                    for (; (uVar8 != 0 && (*pwVar10 != L'\0')); pwVar10 = pwVar10 + 1) {
                      uVar8 = uVar8 - 1;
                    }
                    uVar4 = ~-(uint)(uVar8 != 0) & 0xc000000d;
                    if (uVar8 != 0) {
                      lVar12 = uVar13 - uVar8;
                    }
                  }
                  _Str = local_138;
                  if (-1 < (int)uVar4) {
                    pwVar10 = pwVar7 + lVar12;
                    lVar11 = uVar13 - lVar12;
                    if (lVar11 != 0) {
                      lVar12 = (lVar11 - uVar13) + 0x7ffffffe + lVar12;
                      lVar6 = (longlong)L"\\Packages\\" - (longlong)pwVar10;
                      do {
                        if ((lVar12 == 0) ||
                           (wVar1 = *(wchar_t *)(lVar6 + (longlong)pwVar10), wVar1 == L'\0')) break;
                        *pwVar10 = wVar1;
                        lVar12 = lVar12 + -1;
                        pwVar10 = pwVar10 + 1;
                        lVar11 = lVar11 + -1;
                      } while (lVar11 != 0);
                    }
                    pwVar15 = pwVar10 + -1;
                    if (lVar11 != 0) {
                      pwVar15 = pwVar10;
                    }
                    uVar4 = ~-(uint)(lVar11 != 0) & 0x80000005;
                    *pwVar15 = L'\0';
                    if (-1 < (int)uVar4) {
                      uVar8 = FUN_180008148(pwVar7,uVar14,local_110);
                      lVar12 = 0;
                      uVar4 = (uint)uVar8;
                      _Str = local_138;
                      if (-1 < (int)uVar4) {
                        uVar4 = 0;
                        if (0x7ffffffe < uVar13 - 1) {
                          uVar4 = 0xc000000d;
                        }
                        uVar8 = uVar13;
                        pwVar10 = pwVar7;
                        if (-1 < (int)uVar4) {
                          for (; (uVar8 != 0 && (*pwVar10 != L'\0')); pwVar10 = pwVar10 + 1) {
                            uVar8 = uVar8 - 1;
                          }
                          uVar4 = ~-(uint)(uVar8 != 0) & 0xc000000d;
                          if (uVar8 != 0) {
                            lVar12 = uVar13 - uVar8;
                          }
                        }
                        if (-1 < (int)uVar4) {
                          pwVar10 = pwVar7 + lVar12;
                          lVar11 = uVar13 - lVar12;
                          if (lVar11 != 0) {
                            lVar12 = (lVar11 - uVar13) + 0x7ffffffe + lVar12;
                            lVar6 = (longlong)&DAT_1800851e8 - (longlong)pwVar10;
                            do {
                              if ((lVar12 == 0) ||
                                 (wVar1 = *(wchar_t *)(lVar6 + (longlong)pwVar10), wVar1 == L'\0'))
                              break;
                              *pwVar10 = wVar1;
                              lVar12 = lVar12 + -1;
                              pwVar10 = pwVar10 + 1;
                              lVar11 = lVar11 + -1;
                            } while (lVar11 != 0);
                          }
                          pwVar15 = pwVar10 + -1;
                          if (lVar11 != 0) {
                            pwVar15 = pwVar10;
                          }
                          uVar4 = ~-(uint)(lVar11 != 0) & 0x80000005;
                          *pwVar15 = L'\0';
LAB_180007c30:
                          _Str = local_138;
                          if (-1 < (int)uVar4) {
                            RtlInitUnicodeString(local_c0,pwVar7);
                            RtlInitUnicodeString(local_b0,L"LOCALAPPDATA");
                            uVar4 = RtlSetEnvironmentVariable(&local_120,local_b0,local_c0);
                            _Str = local_138;
                            if (-1 < (int)uVar4) {
                              uVar14 = uVar14 + 0xe;
                              pwVar9 = (wchar_t *)
                                       RtlAllocateHeap(*(undefined8 *)
                                                        (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                                       0,uVar14);
                              if (pwVar9 == (wchar_t *)0x0) {
                                uVar4 = 0xc0000017;
                                _Str = local_138;
                              }
                              else {
                                uVar4 = FUN_18000760c(pwVar9,uVar14,pwVar7);
                                lVar12 = 0;
                                _Str = local_138;
                                if (-1 < (int)uVar4) {
                                  uVar14 = uVar14 >> 1;
                                  uVar4 = 0;
                                  if (0x7ffffffe < uVar14 - 1) {
                                    uVar4 = 0xc000000d;
                                  }
                                  uVar13 = uVar14;
                                  pwVar10 = pwVar9;
                                  if (-1 < (int)uVar4) {
                                    for (; (uVar13 != 0 && (*pwVar10 != L'\0'));
                                        pwVar10 = pwVar10 + 1) {
                                      uVar13 = uVar13 - 1;
                                    }
                                    uVar4 = ~-(uint)(uVar13 != 0) & 0xc000000d;
                                    if (uVar13 != 0) {
                                      lVar12 = uVar14 - uVar13;
                                    }
                                  }
                                  if (-1 < (int)uVar4) {
                                    pwVar10 = pwVar9 + lVar12;
                                    lVar11 = uVar14 - lVar12;
                                    if (lVar11 != 0) {
                                      lVar6 = lVar12 + 0x7ffffffe + (lVar11 - uVar14);
                                      lVar12 = (longlong)L"\\Temp" - (longlong)pwVar10;
                                      do {
                                        if ((lVar6 == 0) ||
                                           (wVar1 = *(wchar_t *)((longlong)pwVar10 + lVar12),
                                           wVar1 == L'\0')) break;
                                        *pwVar10 = wVar1;
                                        lVar6 = lVar6 + -1;
                                        pwVar10 = pwVar10 + 1;
                                        lVar11 = lVar11 + -1;
                                      } while (lVar11 != 0);
                                    }
                                    pwVar15 = pwVar10 + -1;
                                    if (lVar11 != 0) {
                                      pwVar15 = pwVar10;
                                    }
                                    uVar4 = ~-(uint)(lVar11 != 0) & 0x80000005;
                                    *pwVar15 = L'\0';
                                    if (-1 < (int)uVar4) {
                                      RtlInitUnicodeString(local_d0,pwVar9);
                                      RtlInitUnicodeString(local_e0,L"TEMP");
                                      uVar4 = RtlSetEnvironmentVariable
                                                        (&local_120,local_e0,local_d0);
                                      _Str = local_138;
                                      if (-1 < (int)uVar4) {
                                        RtlInitUnicodeString(local_e0,&DAT_1800851c0);
                                        uVar4 = RtlSetEnvironmentVariable
                                                          (&local_120,local_e0,local_d0);
                                        _Str = local_138;
                                        if (-1 < (int)uVar4) {
                                          *local_e8 = local_120;
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                              goto LAB_180007e2b;
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
LAB_18002ced6:
              pwVar9 = (wchar_t *)0x0;
            }
            else {
              uVar4 = RtlGetAppContainerParent(param_1,&local_f0);
              if ((-1 < (int)uVar4) &&
                 (uVar4 = FUN_180009650(param_1,local_f0,&local_108), pwVar15 = local_108,
                 -1 < (int)uVar4)) {
                pwVar16 = wcsstr(_Str,local_108);
                lVar12 = -1;
                if (local_128[0] != 2) {
                  if ((local_128[0] == 1) && (pwVar16 != (wchar_t *)0x0)) {
                    lVar11 = -1;
                    do {
                      lVar11 = lVar11 + 1;
                    } while (local_108[lVar11] != L'\0');
                    pwVar10 = pwVar16 + lVar11;
                    pwVar15 = wcsstr(pwVar10,L"\\AC\\#!");
                    if (pwVar10 == pwVar15) {
                      pwVar10 = pwVar10 + 6;
                      lVar11 = local_110 - (longlong)pwVar10;
                      do {
                        wVar1 = *pwVar10;
                        wVar2 = *(wchar_t *)((longlong)pwVar10 + lVar11);
                        if (wVar1 != wVar2) break;
                        pwVar10 = pwVar10 + 1;
                      } while (wVar2 != L'\0');
                      if (wVar1 == wVar2) goto LAB_180007f0b;
                    }
                  }
LAB_180007927:
                  lVar11 = (longlong)local_118 * 2;
                  if (pwVar16 == (wchar_t *)0x0) {
                    lVar6 = -1;
                    do {
                      lVar6 = lVar6 + 1;
                    } while (local_108[lVar6] != L'\0');
                    lVar11 = lVar11 + lVar6 * 2 + 0x1e;
                  }
                  do {
                    lVar12 = lVar12 + 1;
                  } while (*(short *)(local_110 + lVar12 * 2) != 0);
                  uVar14 = lVar11 + 10 + lVar12 * 2;
                  pwVar7 = (wchar_t *)
                           RtlAllocateHeap(*(undefined8 *)
                                            (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,uVar14);
                  if (pwVar7 == (wchar_t *)0x0) {
                    uVar4 = 0xc0000017;
                    _Str = local_138;
                  }
                  else {
                    uVar4 = FUN_18000760c(pwVar7,uVar14,local_138);
                    lVar12 = 0;
                    _Str = local_138;
                    if (-1 < (int)uVar4) {
                      if (pwVar16 != (wchar_t *)0x0) {
LAB_180007b52:
                        lVar11 = 0;
                        uVar13 = uVar14 >> 1;
                        lVar12 = lVar11;
                        if (0x7ffffffe < uVar13 - 1) {
                          lVar12 = 0xc000000d;
                        }
                        uVar4 = (uint)lVar12;
                        uVar8 = uVar13;
                        pwVar10 = pwVar7;
                        if (-1 < (int)uVar4) {
                          for (; (uVar8 != 0 && (*pwVar10 != L'\0')); pwVar10 = pwVar10 + 1) {
                            uVar8 = uVar8 - 1;
                          }
                          uVar4 = ~-(uint)(uVar8 != 0) & 0xc000000d;
                          if (uVar8 != 0) {
                            lVar11 = uVar13 - uVar8;
                          }
                        }
                        _Str = local_138;
                        pwVar9 = local_130;
                        if (-1 < (int)uVar4) {
                          pwVar10 = pwVar7 + lVar11;
                          lVar12 = uVar13 - lVar11;
                          if (lVar12 != 0) {
                            lVar11 = (lVar12 - uVar13) + 0x7ffffffe + lVar11;
                            lVar6 = (longlong)&DAT_180085208 - (longlong)pwVar10;
                            do {
                              if ((lVar11 == 0) ||
                                 (wVar1 = *(wchar_t *)(lVar6 + (longlong)pwVar10), wVar1 == L'\0'))
                              break;
                              *pwVar10 = wVar1;
                              lVar11 = lVar11 + -1;
                              pwVar10 = pwVar10 + 1;
                              lVar12 = lVar12 + -1;
                            } while (lVar12 != 0);
                          }
                          pwVar15 = pwVar10 + -1;
                          if (lVar12 != 0) {
                            pwVar15 = pwVar10;
                          }
                          uVar4 = ~-(uint)(lVar12 != 0) & 0x80000005;
                          *pwVar15 = L'\0';
                          if (-1 < (int)uVar4) {
                            uVar13 = FUN_180008148(pwVar7,uVar14,local_110);
                            uVar4 = (uint)uVar13;
                            goto LAB_180007c30;
                          }
                        }
                        goto LAB_180007e2b;
                      }
                      uVar13 = uVar14 >> 1;
                      uVar4 = 0;
                      if (0x7ffffffe < uVar13 - 1) {
                        uVar4 = 0xc000000d;
                      }
                      uVar8 = uVar13;
                      pwVar10 = pwVar7;
                      if (-1 < (int)uVar4) {
                        for (; (uVar8 != 0 && (*pwVar10 != L'\0')); pwVar10 = pwVar10 + 1) {
                          uVar8 = uVar8 - 1;
                        }
                        uVar4 = ~-(uint)(uVar8 != 0) & 0xc000000d;
                        if (uVar8 != 0) {
                          lVar12 = uVar13 - uVar8;
                        }
                      }
                      if (-1 < (int)uVar4) {
                        pwVar10 = pwVar7 + lVar12;
                        lVar11 = uVar13 - lVar12;
                        if (lVar11 != 0) {
                          lVar12 = (lVar11 - uVar13) + 0x7ffffffe + lVar12;
                          lVar6 = (longlong)L"\\Packages\\" - (longlong)pwVar10;
                          do {
                            if ((lVar12 == 0) ||
                               (wVar1 = *(wchar_t *)(lVar6 + (longlong)pwVar10), wVar1 == L'\0'))
                            break;
                            *pwVar10 = wVar1;
                            lVar12 = lVar12 + -1;
                            pwVar10 = pwVar10 + 1;
                            lVar11 = lVar11 + -1;
                          } while (lVar11 != 0);
                        }
                        pwVar15 = pwVar10 + -1;
                        if (lVar11 != 0) {
                          pwVar15 = pwVar10;
                        }
                        uVar4 = ~-(uint)(lVar11 != 0) & 0x80000005;
                        *pwVar15 = L'\0';
                        if (-1 < (int)uVar4) {
                          uVar8 = FUN_180008148(pwVar7,uVar14,local_108);
                          lVar12 = 0;
                          uVar4 = (uint)uVar8;
                          _Str = local_138;
                          if (-1 < (int)uVar4) {
                            uVar4 = 0;
                            if (0x7ffffffe < uVar13 - 1) {
                              uVar4 = 0xc000000d;
                            }
                            uVar8 = uVar13;
                            pwVar10 = pwVar7;
                            if (-1 < (int)uVar4) {
                              for (; (uVar8 != 0 && (*pwVar10 != L'\0')); pwVar10 = pwVar10 + 1) {
                                uVar8 = uVar8 - 1;
                              }
                              uVar4 = ~-(uint)(uVar8 != 0) & 0xc000000d;
                              if (uVar8 != 0) {
                                lVar12 = uVar13 - uVar8;
                              }
                            }
                            if (-1 < (int)uVar4) {
                              pwVar10 = pwVar7 + lVar12;
                              lVar11 = uVar13 - lVar12;
                              if (lVar11 != 0) {
                                lVar12 = (lVar11 - uVar13) + 0x7ffffffe + lVar12;
                                lVar6 = (longlong)&DAT_1800851e8 - (longlong)pwVar10;
                                do {
                                  if ((lVar12 == 0) ||
                                     (wVar1 = *(wchar_t *)(lVar6 + (longlong)pwVar10),
                                     wVar1 == L'\0')) break;
                                  *pwVar10 = wVar1;
                                  lVar12 = lVar12 + -1;
                                  pwVar10 = pwVar10 + 1;
                                  lVar11 = lVar11 + -1;
                                } while (lVar11 != 0);
                              }
                              pwVar15 = pwVar10 + -1;
                              if (lVar11 != 0) {
                                pwVar15 = pwVar10;
                              }
                              uVar4 = ~-(uint)(lVar11 != 0) & 0x80000005;
                              *pwVar15 = L'\0';
                              if (-1 < (int)uVar4) goto LAB_180007b52;
                            }
                          }
                        }
                      }
                    }
                  }
                  goto LAB_18002ced6;
                }
                if (pwVar16 != (wchar_t *)0x0) {
                  lVar11 = -1;
                  do {
                    lVar11 = lVar11 + 1;
                  } while (pwVar15[lVar11] != L'\0');
                  iVar3 = wcscmp(pwVar16 + lVar11,L"\\AC");
                  if (iVar3 == 0) goto LAB_180007927;
                }
                uVar4 = 0xc000000d;
                _Str = local_138;
                pwVar7 = pwVar10;
              }
            }
          }
        }
      }
    }
  }
  else {
    local_148 = &local_fc;
    local_fc = 0x4c;
    iVar3 = NtQueryInformationToken(&DAT_fffffffffffffffa,0x1f,local_98,0x4c);
    if (iVar3 < 0) goto LAB_180007f0b;
    uVar4 = RtlGetAppContainerSidType(local_98[0],local_128);
    _Str = pwVar10;
    pwVar9 = pwVar10;
    pwVar7 = pwVar10;
    if (-1 < (int)uVar4) {
      if ((local_128[0] == 2) && (BVar5 = EqualSid(local_98[0],param_1), BVar5 != 0))
      goto LAB_180007f0b;
      goto LAB_180007769;
    }
  }
LAB_180007e2b:
  if (local_110 != 0) {
    AppContainerFreeMemory();
  }
  if (_Str != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,_Str);
  }
  if (local_f0 != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_f0);
  }
  if (local_108 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_108);
  }
  if (pwVar7 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pwVar7);
  }
  if (pwVar9 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pwVar9);
  }
  if (((int)uVar4 < 0) && (local_120 != 0)) {
    RtlDestroyEnvironment();
  }
LAB_180007f0b:
  __security_check_cookie(local_48 ^ (ulonglong)auStack360);
  return;
}



ulonglong FUN_180008148(short *param_1,ulonglong param_2,undefined8 param_3)

{
  ulonglong uVar1;
  short *psVar2;
  uint uVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  
  uVar5 = param_2 >> 1;
  uVar4 = 0;
  uVar6 = uVar4;
  if (0x7ffffffe < uVar5 - 1) {
    uVar6 = 0xc000000d;
  }
  uVar1 = uVar5;
  psVar2 = param_1;
  if (-1 < (int)uVar6) {
    for (; (uVar1 != 0 && (*psVar2 != 0)); psVar2 = psVar2 + 1) {
      uVar1 = uVar1 - 1;
    }
    uVar6 = (ulonglong)(~-(uint)(uVar1 != 0) & 0xc000000d);
    if (uVar1 != 0) {
      uVar4 = uVar5 - uVar1;
    }
  }
  if (-1 < (int)uVar6) {
    uVar3 = FUN_1800081d4(param_1 + uVar4,uVar5 - uVar4,param_3,param_3);
    uVar6 = (ulonglong)uVar3;
  }
  return uVar6;
}



uint FUN_1800081d4(short *param_1,longlong param_2,undefined8 param_3,longlong param_4)

{
  short sVar1;
  longlong lVar2;
  short *psVar3;
  longlong lVar4;
  
  if (param_2 != 0) {
    lVar2 = 0x7ffffffe;
    lVar4 = param_4 - (longlong)param_1;
    do {
      if ((lVar2 == 0) || (sVar1 = *(short *)(lVar4 + (longlong)param_1), sVar1 == 0)) break;
      *param_1 = sVar1;
      lVar2 = lVar2 + -1;
      param_1 = param_1 + 1;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
  }
  psVar3 = param_1 + -1;
  if (param_2 != 0) {
    psVar3 = param_1;
  }
  *psVar3 = 0;
  return ~-(uint)(param_2 != 0) & 0x80000005;
}



undefined4 UpdateCalendarDayOfWeek(uint *param_1,undefined8 param_2)

{
  bool bVar1;
  uint uVar2;
  undefined8 uVar3;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  
                    // 0x8230  1485  UpdateCalendarDayOfWeek
  if (param_1 == (uint *)0x0) {
    SetLastError(0x57);
    return 0;
  }
  if (*param_1 < 9) {
    if (*param_1 == 8) {
      uVar3 = FUN_18004fe78((int *)param_1,param_2);
      return (int)uVar3;
    }
    if (*param_1 != 0) {
      if (2 < *param_1) {
        if (5 < *param_1) {
          if (*param_1 == 6) {
            uVar3 = FUN_180051a48((longlong)param_1,param_2);
            return (int)uVar3;
          }
          if (*param_1 != 7) goto LAB_18002d063;
        }
        bVar1 = FUN_18004e94c(param_1);
        return (int)CONCAT71(extraout_var,bVar1);
      }
LAB_180008264:
      uVar3 = FUN_180008308((longlong)param_1,param_2,0);
      if ((int)uVar3 == 0) {
        return 0;
      }
      uVar2 = FUN_18000850c((longlong)param_1);
      if (uVar2 == 0xffffffff) {
        return 0xffffffff;
      }
      param_1[5] = uVar2;
      return 1;
    }
  }
  else {
    if (*param_1 < 0xd) goto LAB_180008264;
    if (*param_1 == 0x16) {
      bVar1 = FUN_1800510c8((longlong)param_1);
      return (int)CONCAT71(extraout_var_00,bVar1);
    }
    if (*param_1 == 0x17) {
      uVar3 = FUN_18004f25c((int *)param_1,param_2);
      return (int)uVar3;
    }
  }
LAB_18002d063:
  SetLastError(0x57);
  return 0;
}



undefined4 IsValidCalDateTime(uint *param_1,longlong param_2)

{
  undefined4 uVar1;
  undefined8 uVar2;
  
                    // 0x82b0  914  IsValidCalDateTime
  if ((param_1 == (uint *)0x0) || (param_2 == 0)) {
    SetLastError(0x57);
    return 0;
  }
  if (*param_1 < 9) {
    if (*param_1 == 8) {
      uVar2 = FUN_18004fce0((int *)param_1,param_2,1);
      return (int)uVar2;
    }
    if (*param_1 != 0) {
      if (2 < *param_1) {
        if (5 < *param_1) {
          if (*param_1 == 6) {
            uVar2 = FUN_1800518bc((longlong)param_1,param_2,1);
            return (int)uVar2;
          }
          if (*param_1 != 7) goto LAB_18002d0ec;
        }
        uVar1 = FUN_18004e7f8(param_1,param_2,1);
        return uVar1;
      }
LAB_1800082ea:
      uVar2 = FUN_180008308((longlong)param_1,param_2,1);
      return (int)uVar2;
    }
  }
  else {
    if (*param_1 < 0xd) goto LAB_1800082ea;
    if (*param_1 == 0x16) {
      uVar2 = FUN_18005104c((longlong)param_1);
      return (int)uVar2;
    }
    if (*param_1 == 0x17) {
      uVar2 = FUN_18004efbc((int *)param_1,param_2,1);
      return (int)uVar2;
    }
  }
LAB_18002d0ec:
  SetLastError(0x57);
  return 0;
}



undefined8 FUN_180008308(longlong param_1,undefined8 param_2,int param_3)

{
  bool bVar1;
  uint uVar2;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  DWORD dwErrCode;
  
  if (param_1 == 0) {
    return 0;
  }
  if (*(int *)(param_1 + 4) == 1) {
    if (0x270e < *(uint *)(param_1 + 8) - 1) {
      dwErrCode = 0x120;
      goto LAB_18002d12b;
    }
    bVar1 = FUN_1800083dc(*(uint *)(param_1 + 0x10),*(uint *)(param_1 + 0xc),*(uint *)(param_1 + 8))
    ;
    if ((int)CONCAT71(extraout_var,bVar1) == 0) {
      return 0;
    }
    bVar1 = FUN_180008390(param_1);
    if ((int)CONCAT71(extraout_var_00,bVar1) == 0) {
      return 0;
    }
    if (((param_3 == 0) || (*(int *)(param_1 + 0x14) == -1)) ||
       (uVar2 = FUN_18000850c(param_1), *(uint *)(param_1 + 0x14) == uVar2)) {
      return 1;
    }
  }
  dwErrCode = 0x57;
LAB_18002d12b:
  SetLastError(dwErrCode);
  return 0;
}



bool FUN_180008390(longlong param_1)

{
  bool bVar1;
  bool bVar2;
  bool bVar3;
  bool bVar4;
  
  bVar1 = *(uint *)(param_1 + 0x18) < 0x18;
  bVar2 = *(uint *)(param_1 + 0x1c) < 0x3c;
  bVar3 = *(uint *)(param_1 + 0x20) < 0x3c;
  bVar4 = *(uint *)(param_1 + 0x24) < 10000000;
  if (!bVar4 || (!bVar3 || (!bVar2 || !bVar1))) {
    SetLastError(0x57);
  }
  return bVar4 && (bVar3 && (bVar2 && bVar1));
}



bool FUN_1800083dc(uint param_1,uint param_2,uint param_3)

{
  bool bVar1;
  uint uVar2;
  undefined8 uVar3;
  
  uVar2 = param_2 - 1;
  if (uVar2 < 0xc) {
    uVar3 = FUN_18000846c(param_3,1);
    if ((int)uVar3 != 0) {
      bVar1 = param_1 <=
              (uint)(*(int *)(&DAT_180087590 + (ulonglong)param_2 * 4) -
                    *(int *)(&DAT_180087590 + (ulonglong)uVar2 * 4));
      goto LAB_180008457;
    }
    if (param_1 <=
        (uint)(*(int *)(&DAT_1800875c8 + (ulonglong)param_2 * 4) -
              *(int *)(&DAT_1800875c8 + (ulonglong)uVar2 * 4))) {
      return true;
    }
  }
  bVar1 = false;
LAB_180008457:
  if (!bVar1) {
    SetLastError(0x57);
  }
  return bVar1;
}



undefined8 FUN_18000846c(uint param_1,int param_2)

{
  undefined8 uVar1;
  undefined8 uVar2;
  
  uVar1 = FUN_1800084e0(param_1,param_2);
  uVar2 = 0;
  if ((int)uVar1 == 0) {
    uVar2 = 0;
  }
  else {
    SetLastError(0);
    if (((param_1 & 3) == 0) &&
       ((param_1 != (param_1 / 100) * 100 || (param_1 == (param_1 / 400) * 400)))) {
      uVar2 = 1;
    }
  }
  return uVar2;
}



undefined8 FUN_1800084e0(int param_1,int param_2)

{
  DWORD dwErrCode;
  
  if (param_2 == 1) {
    if (param_1 - 1U < 9999) {
      return 1;
    }
    dwErrCode = 0x120;
  }
  else {
    dwErrCode = 0x57;
  }
  SetLastError(dwErrCode);
  return 0;
}



uint FUN_18000850c(longlong param_1)

{
  int iVar1;
  uint uVar2;
  
  if (param_1 == 0) {
    uVar2 = 0xffffffff;
  }
  else {
    iVar1 = FUN_180008558(*(uint *)(param_1 + 8),*(int *)(param_1 + 0xc),*(int *)(param_1 + 0x10));
    uVar2 = (iVar1 + 1U) % 7;
  }
  return uVar2;
}



int FUN_180008558(uint param_1,int param_2,int param_3)

{
  int iVar1;
  
  if (((param_1 & 3) == 0) &&
     ((param_1 != (param_1 / 100) * 100 || (param_1 == (param_1 / 400) * 400)))) {
    iVar1 = param_1 - 1;
    iVar1 = iVar1 / 4 + param_3 +
            ((*(int *)(&DAT_180087590 + (ulonglong)(param_2 - 1) * 4) + iVar1 / 400) - iVar1 / 100);
  }
  else {
    iVar1 = param_1 - 1;
    iVar1 = iVar1 / 4 + param_3 +
            ((*(int *)(&DAT_1800875c8 + (ulonglong)(param_2 - 1) * 4) + iVar1 / 400) - iVar1 / 100);
  }
  return iVar1 + (param_1 - 1) * 0x16d + -1;
}



ulonglong FUN_18000865c(short *param_1)

{
  short *psVar1;
  short *psVar2;
  
  psVar1 = param_1;
  psVar2 = param_1;
  if (*param_1 != 0) {
    while ((((psVar2 = psVar1 + 1, *psVar2 != 0 && (psVar2 = psVar1 + 2, *psVar2 != 0)) &&
            (psVar2 = psVar1 + 3, *psVar2 != 0)) &&
           (((psVar2 = psVar1 + 4, *psVar2 != 0 && (psVar2 = psVar1 + 5, *psVar2 != 0)) &&
            ((psVar2 = psVar1 + 6, *psVar2 != 0 &&
             ((psVar2 = psVar1 + 7, *psVar2 != 0 && (psVar2 = psVar1 + 8, *psVar2 != 0))))))))) {
      psVar2 = psVar1 + 9;
      if ((*psVar2 == 0) ||
         (((((psVar2 = psVar1 + 10, *psVar2 == 0 || (psVar2 = psVar1 + 0xb, *psVar2 == 0)) ||
            (psVar2 = psVar1 + 0xc, *psVar2 == 0)) ||
           ((psVar2 = psVar1 + 0xd, *psVar2 == 0 || (psVar2 = psVar1 + 0xe, *psVar2 == 0)))) ||
          ((psVar2 = psVar1 + 0xf, *psVar2 == 0 ||
           (psVar2 = psVar1 + 0x10, psVar1 = psVar2, *psVar2 == 0)))))) break;
    }
  }
  return (longlong)psVar2 - (longlong)param_1 >> 1 & 0xffffffff;
}



void GetCalendarDateFormatEx
               (undefined8 param_1,uint param_2,uint *param_3,ushort *param_4,short *param_5,
               int param_6)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  ushort *puVar4;
  ulonglong uVar5;
  longlong lVar6;
  longlong lVar7;
  DWORD dwErrCode;
  short *psVar8;
  undefined auStackY872 [32];
  ushort local_318 [2];
  int local_314;
  short *local_310;
  ushort local_308;
  undefined2 local_306;
  undefined2 local_304;
  undefined2 local_302;
  undefined8 local_300;
  ushort local_2f8 [80];
  ushort local_258 [256];
  ulonglong local_58;
  
                    // 0x86b0  464  GetCalendarDateFormatEx
  local_58 = DAT_1800b2220 ^ (ulonglong)auStackY872;
  local_310 = param_5;
  local_314 = 0;
  uVar3 = 0;
  iVar1 = IsValidCalDateTime(param_3,(longlong)local_318);
  if (iVar1 == 0) goto LAB_18000886f;
  if (*param_3 == 8) {
    uVar5 = FUN_18004fc7c(param_3[2],param_3[1]);
    local_314 = (int)uVar5;
  }
  puVar4 = (ushort *)GetNamedLocaleHashNode(param_1);
  if ((((puVar4 == (ushort *)0x0) || (param_6 < 0)) || ((param_5 == (short *)0x0 && (param_6 != 0)))
      ) || (((param_4 != (ushort *)0x0 &&
             (uVar5 = FUN_18000865c((short *)param_4), 0xff < (int)uVar5)) ||
            (uVar2 = FUN_18000b2f4((longlong)puVar4,*param_3), (short)uVar2 == 0)))) {
LAB_18002d228:
    dwErrCode = 0x57;
  }
  else if (((param_2 & 0x3fffffc4) == 0 && ((param_2 & 0xfffffff0) - 1 & param_2 & 0x70) == 0) &&
          ((param_4 == (ushort *)0x0 || ((param_2 & 0x8000000b) == 0)))) {
    lVar6 = GetCalendar();
    if (lVar6 == 0) goto LAB_18002d228;
    if (param_4 == (ushort *)0x0) {
      uVar2 = param_2 & 0xb;
      if (uVar2 < 2) {
        lVar7 = KernelBaseGetGlobalData();
        psVar8 = *(short **)(lVar7 + 0x58);
        if (*(int *)(lVar6 + 4) != 0) {
          psVar8 = psVar8 + *(uint *)(psVar8 + (ulonglong)*(uint *)(lVar6 + 4) + 1);
        }
        uVar2 = 0x1f;
      }
      else if (uVar2 == 2) {
        lVar7 = KernelBaseGetGlobalData();
        psVar8 = *(short **)(lVar7 + 0x58);
        if (*(int *)(lVar6 + 0xc) != 0) {
          psVar8 = psVar8 + *(uint *)(psVar8 + (ulonglong)*(uint *)(lVar6 + 0xc) + 1);
        }
        uVar2 = 0x20;
      }
      else {
        if (uVar2 != 8) goto LAB_18002d365;
        lVar7 = KernelBaseGetGlobalData();
        psVar8 = *(short **)(lVar7 + 0x58);
        if (*(int *)(lVar6 + 8) != 0) {
          psVar8 = psVar8 + *(uint *)(psVar8 + (ulonglong)*(uint *)(lVar6 + 8) + 1);
        }
        uVar2 = 0x1006;
      }
      iVar1 = GetUserOverrideWord(puVar4,0x4d8,0,local_318);
      if (iVar1 != 0) {
        uVar3 = FUN_18000b2f4((longlong)puVar4,(uint)local_318[0]);
        uVar3 = uVar3 & 0xffff;
      }
      if (((int)param_2 < 0) || (*param_3 != uVar3)) {
        if (*psVar8 != 0) {
          param_4 = (ushort *)(psVar8 + 1);
          goto LAB_1800087d9;
        }
        uVar2 = uVar2 | 0x80000000;
      }
      else {
        uVar2 = uVar3 << 0x10 | uVar2;
      }
      GetLocaleInfoHelper(puVar4,uVar2,local_2f8,0x50);
      param_4 = local_2f8;
    }
LAB_1800087d9:
    local_308 = *(ushort *)(param_3 + 2);
    local_300 = 0;
    local_306 = *(undefined2 *)(param_3 + 3);
    local_304 = *(undefined2 *)(param_3 + 5);
    local_302 = *(undefined2 *)(param_3 + 4);
    iVar1 = FUN_18000ab54(puVar4,param_2,&local_308,param_4,local_258,*param_3,lVar6,0,param_3[1],
                          local_314);
    if (param_6 < iVar1) {
      dwErrCode = 0x7a;
    }
    else {
      if (iVar1 == 0) goto LAB_18002d228;
      uVar3 = FUN_18000b370(local_310,(longlong)iVar1,(longlong)local_258);
      if (-1 < (int)uVar3) goto LAB_18000886f;
      dwErrCode = 0xe;
    }
  }
  else {
LAB_18002d365:
    dwErrCode = 0x3ec;
  }
  SetLastError(dwErrCode);
LAB_18000886f:
  __security_check_cookie(local_58 ^ (ulonglong)auStackY872);
  return;
}



longlong * FUN_1800088a0(longlong param_1,undefined8 param_2)

{
  longlong *plVar1;
  char cVar2;
  longlong *plVar3;
  longlong lVar4;
  longlong *plVar5;
  longlong local_18;
  longlong lStack16;
  
  plVar3 = (longlong *)0x0;
  lVar4 = *(longlong *)(param_1 + 0x18);
  while (lVar4 != 0) {
    plVar1 = (longlong *)(DAT_1800b2bf8 + 0x9e8);
    plVar5 = (longlong *)((lVar4 - *plVar1) + DAT_1800b2bf8);
    if (plVar5 == (longlong *)0x0) break;
    local_18 = plVar5[1];
    lVar4 = plVar5[2];
    if (lVar4 == 0) {
      lStack16 = 0;
    }
    else {
      lStack16 = lVar4 + (DAT_1800b2bf8 - *plVar1);
    }
    cVar2 = RtlEqualUnicodeString
                      (lVar4,&local_18,param_2,CONCAT71((int7)((ulonglong)plVar1 >> 8),1));
    if (cVar2 != '\0') {
      return plVar5;
    }
    lVar4 = *plVar5;
  }
  if (*(longlong *)(param_1 + 0x20) != 0) {
    plVar3 = (longlong *)
             ((*(longlong *)(param_1 + 0x20) - *(longlong *)(DAT_1800b2bf8 + 0x9e8)) + DAT_1800b2bf8
             );
  }
  return plVar3;
}



void FUN_180008964(int *param_1,longlong param_2,longlong *param_3,ushort *param_4)

{
  short sVar1;
  bool bVar2;
  undefined4 uVar3;
  int iVar4;
  undefined4 *puVar5;
  undefined *puVar6;
  ulonglong uVar7;
  longlong in_GS_OFFSET;
  undefined auStackY216 [32];
  longlong local_a0;
  ushort *local_98;
  ushort local_90;
  short local_8e;
  short *local_88;
  ushort *local_80;
  ushort local_78 [8];
  undefined local_68 [16];
  ulonglong local_58;
  
  local_58 = DAT_1800b2220 ^ (ulonglong)auStackY216;
  local_98 = param_4;
  if (param_4 == (ushort *)0x0) {
    uVar3 = FUN_18000ff6c((longlong)param_1,(short **)0x0,(short **)&local_98);
    if ((char)uVar3 == '\0') goto LAB_180008a6b;
    bVar2 = false;
    param_4 = local_98;
  }
  else {
    RtlInitUnicodeString(local_78);
    bVar2 = true;
  }
  if ((((param_3 == (longlong *)0x0) &&
       (param_3 = FUN_1800088a0(param_2,param_4), param_3 == (longlong *)0x0)) ||
      (uVar3 = FUN_180011d50((longlong)param_1,(short **)0x0,(short **)&local_80),
      (char)uVar3 == '\0')) ||
     ((iVar4 = FUN_180008bc8((longlong)param_1,(longlong)param_3,local_80,'\0',&local_a0), iVar4 < 0
      || (local_a0 == -1)))) goto LAB_180008a6b;
  iVar4 = NtQueryValueKey();
  if (iVar4 < 0) {
    if (iVar4 == -0x7ffffffb) {
      puVar5 = (undefined4 *)KernelBaseGetGlobalData();
      puVar6 = (undefined *)
               RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),*puVar5);
      param_4 = local_98;
      if (puVar6 != (undefined *)0x0) {
        iVar4 = NtQueryValueKey(local_a0);
        goto LAB_180008af2;
      }
    }
    NtClose(local_a0);
    goto LAB_180008a6b;
  }
  puVar6 = local_68;
LAB_180008af2:
  NtClose();
  if ((-1 < iVar4) && (*(int *)(puVar6 + 4) == 1)) {
    if (bVar2) {
      uVar7 = FUN_18000f720((longlong)param_1,(ushort *)0x0,param_4,'\0');
      if ((int)uVar7 < 0) goto LAB_180008b78;
      uVar7 = FUN_18000f720((longlong)param_1,(ushort *)0x0,local_78,'\0');
      iVar4 = (int)uVar7;
    }
    if (-1 < iVar4) {
      local_88 = (short *)(puVar6 + 0xc);
      local_8e = *(short *)(puVar6 + 8);
      if (*(uint *)(puVar6 + 8) < 2) {
        local_90 = 0;
      }
      else {
        local_90 = local_8e - 2;
      }
      if ((((*param_1 == 1) && (3 < local_90)) &&
          (sVar1 = *local_88,
          sVar1 == *(short *)((longlong)local_88 + ((ulonglong)local_90 - 2 & 0xfffffffffffffffe))))
         && ((sVar1 == 0x22 || (sVar1 == 0x27)))) {
        local_88 = (short *)(puVar6 + 0xe);
        local_90 = local_90 - 4;
        local_8e = local_8e + -4;
      }
      FUN_18000f720((longlong)param_1,(ushort *)0x0,&local_90,'\x01');
    }
  }
LAB_180008b78:
  if (puVar6 != local_68) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar6);
  }
LAB_180008a6b:
  __security_check_cookie(local_58 ^ (ulonglong)auStackY216);
  return;
}



// WARNING: Could not reconcile some variable overlaps

int FUN_180008bc8(longlong param_1,longlong param_2,ushort *param_3,char param_4,undefined8 *param_5
                 )

{
  short sVar1;
  uint uVar2;
  longlong lVar3;
  bool bVar4;
  bool bVar5;
  undefined8 *puVar6;
  int iVar7;
  int iVar8;
  ushort *puVar9;
  longlong lVar10;
  ushort uVar11;
  ushort *puVar12;
  longlong in_GS_OFFSET;
  undefined extraout_XMM0 [16];
  undefined extraout_XMM0_00 [16];
  undefined extraout_XMM0_01 [16];
  undefined extraout_XMM0_02 [16];
  ushort local_128;
  undefined2 uStack294;
  undefined4 uStack292;
  longlong lStack288;
  ushort local_118 [8];
  undefined8 local_108;
  longlong lStack256;
  undefined local_f8 [16];
  undefined local_e8 [8];
  undefined8 local_e0;
  undefined8 local_d8;
  undefined4 local_d0 [2];
  undefined8 local_c8;
  ushort *local_c0;
  undefined4 local_b8;
  undefined local_b0 [16];
  undefined4 local_a0 [2];
  undefined8 local_98;
  ushort *local_90;
  undefined4 local_88;
  undefined local_80 [16];
  undefined4 local_70 [2];
  undefined8 local_68;
  undefined *local_60;
  undefined4 local_58;
  undefined local_50 [16];
  
  puVar6 = param_5;
  lVar10 = DAT_1800b2bf8;
  puVar12 = (ushort *)0x0;
  bVar5 = false;
  *param_5 = 0xffffffffffffffff;
  puVar9 = puVar12;
  if (*(longlong *)(param_2 + 0x20) != 0) {
    puVar9 = (ushort *)((*(longlong *)(param_2 + 0x20) - *(longlong *)(lVar10 + 0x9e8)) + lVar10);
  }
  uVar2 = *(uint *)(param_2 + 0x18);
  if (puVar9 == (ushort *)0x0) {
    return 0;
  }
  local_108 = *(undefined8 *)(puVar9 + 4);
  lVar3 = *(longlong *)(puVar9 + 8);
  if (lVar3 == 0) {
    lStack256 = 0;
  }
  else {
    lStack256 = lVar3 + (lVar10 - *(longlong *)(lVar10 + 0x9e8));
  }
  if ((ushort)local_108 == 0) {
    return 0;
  }
  RtlInitUnicodeString(lVar3,local_118,0);
  if ((int)uVar2 < 0) {
    lVar10 = KernelBaseGetGlobalData();
    if (*(char *)(lVar10 + 4) == '\x01') {
      return -0x3fffffde;
    }
    iVar7 = RtlFormatCurrentUserKeyPath(local_118);
    if (-1 < iVar7) {
      local_90 = local_118;
      local_a0[0] = 0x30;
      local_80 = extraout_XMM0 & (undefined  [16])0x0;
      local_98 = 0;
      local_88 = 0x40;
      iVar7 = NtOpenKey(&local_e0,0x80000000,local_a0);
      if (-1 < iVar7) {
        NtClose(local_e0);
        puVar12 = local_118;
        goto LAB_180008d13;
      }
      RtlFreeUnicodeString(local_118);
      RtlInitUnicodeString(local_118,0);
    }
    puVar12 = (ushort *)&DAT_1800805c8;
LAB_180008d13:
    if (puVar12 == (ushort *)0x0) {
      iVar7 = 2;
      goto LAB_180008d22;
    }
  }
  else {
    if ((uVar2 >> 0x1e & 1) == 0) goto LAB_180008d13;
    puVar12 = &DAT_18007f000;
  }
  iVar7 = *puVar12 + 4;
LAB_180008d22:
  iVar7 = (uint)(ushort)local_108 + iVar7;
  if ((uVar2 & 0x10000000) != 0) {
    iVar7 = iVar7 + *(ushort *)(param_1 + 0x18) + 2;
  }
  bVar4 = false;
  if ((param_3 != (ushort *)0x0) && ((uVar2 >> 0x1d & 1) != 0)) {
    bVar4 = true;
    iVar7 = iVar7 + *param_3 + 2;
  }
  lStack288 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,iVar7 + 2
                             );
  if (lStack288 == 0) {
    if (puVar12 == local_118) {
      RtlFreeUnicodeString(local_118);
    }
    return -0x3fffffe9;
  }
  uStack294 = (undefined2)(iVar7 + 2);
  local_128 = 0;
  if (puVar12 != (ushort *)0x0) {
    RtlAppendUnicodeStringToString(&local_128,puVar12);
    RtlAppendUnicodeToString(&local_128,&DAT_180085358);
    if (puVar12 == local_118) {
      RtlFreeUnicodeString(local_118);
    }
  }
  RtlAppendUnicodeStringToString(&local_128,&local_108);
  local_b0 = extraout_XMM0_00;
  if ((uVar2 & 0x10000000) != 0) {
    RtlAppendUnicodeToString(&local_128,&DAT_180085358);
    RtlAppendUnicodeStringToString(&local_128,param_1 + 0x18);
    local_b0 = extraout_XMM0_01;
  }
  if (bVar4) {
    RtlAppendUnicodeToString(&local_128,&DAT_180085358);
    RtlAppendUnicodeStringToString(&local_128,param_3);
    local_b0 = extraout_XMM0_02;
  }
  local_c0 = &local_128;
  local_b0 = local_b0 & (undefined  [16])0x0;
  local_d0[0] = 0x30;
  local_b8 = 0xc0;
  local_c8 = 0;
  if (param_4 == '\0') {
    iVar7 = NtOpenKey(puVar6,0x80000000);
  }
  else {
    iVar7 = NtCreateKey(puVar6,0x2000f,local_d0,0,0,0,&param_5);
    while ((iVar7 == -0x3fffffcc && (!bVar5))) {
      local_f8 = CONCAT88(lStack288,CONCAT44(uStack292,CONCAT22(uStack294,local_128)));
      sVar1 = *(short *)(lStack288 + (ulonglong)(local_128 >> 1) * 2);
      uVar11 = local_128;
      while (sVar1 != 0x5c) {
        uVar11 = uVar11 - 2;
        local_f8 = CONCAT142(SUB1614(local_f8 >> 0x10,0),uVar11);
        sVar1 = *(short *)(lStack288 + (ulonglong)(uVar11 >> 1) * 2);
      }
      local_60 = local_f8;
      local_70[0] = 0x30;
      local_68 = 0;
      local_50 = ZEXT816(0) << 0x20 & (undefined  [16])0xffffffff;
      local_58 = 0xc0;
      iVar8 = NtCreateKey(&local_d8,0x2000f,local_70,0,0,0,local_e8);
      if (iVar8 < 0) break;
      NtClose(local_d8);
      iVar7 = NtCreateKey(puVar6,0x2000f,local_d0,0,0,0,&param_5);
      bVar5 = true;
    }
  }
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lStack288);
  return iVar7;
}



longlong * FUN_180008eac(longlong param_1,undefined8 param_2)

{
  longlong *plVar1;
  char cVar2;
  longlong *plVar3;
  longlong lVar4;
  longlong *plVar5;
  longlong local_18;
  longlong lStack16;
  
  plVar3 = (longlong *)0x0;
  lVar4 = *(longlong *)(param_1 + 0x18);
  while (lVar4 != 0) {
    plVar1 = (longlong *)(DAT_1800b2bf8 + 0x9e8);
    plVar5 = (longlong *)((lVar4 - *plVar1) + DAT_1800b2bf8);
    if (plVar5 == (longlong *)0x0) break;
    local_18 = plVar5[1];
    lVar4 = plVar5[2];
    if (lVar4 == 0) {
      lStack16 = 0;
    }
    else {
      lStack16 = lVar4 + (DAT_1800b2bf8 - *plVar1);
    }
    cVar2 = RtlEqualUnicodeString
                      (lVar4,&local_18,param_2,CONCAT71((int7)((ulonglong)plVar1 >> 8),1));
    if (cVar2 != '\0') {
      return plVar5;
    }
    lVar4 = *plVar5;
  }
  if (*(longlong *)(param_1 + 0x20) != 0) {
    plVar3 = (longlong *)
             ((*(longlong *)(param_1 + 0x20) - *(longlong *)(DAT_1800b2bf8 + 0x9e8)) + DAT_1800b2bf8
             );
  }
  return plVar3;
}



// WARNING: Could not reconcile some variable overlaps

ulonglong FUN_180008f64(int *param_1)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  ulonglong extraout_RAX;
  longlong *plVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  ulonglong extraout_RAX_00;
  longlong lVar7;
  longlong *plVar8;
  short *local_res8 [2];
  undefined auStackY632 [32];
  longlong local_248;
  ushort *local_240;
  ulonglong uStack568;
  undefined *local_230;
  longlong local_228;
  undefined8 uStack544;
  undefined2 local_20c;
  undefined local_208 [472];
  undefined8 uStack48;
  ulonglong local_28;
  
  if (*param_1 == 0) {
    return 0;
  }
  if (*param_1 == 5) {
    uVar5 = DAT_1800b2220 ^ (ulonglong)auStackY632;
    lVar7 = *(longlong *)(param_1 + 2);
    if (*(longlong *)(lVar7 + 0x18) != 0) {
      plVar4 = (longlong *)(DAT_1800b2bf8 + 0x9e8);
      plVar8 = (longlong *)((*(longlong *)(lVar7 + 0x18) - *plVar4) + DAT_1800b2bf8);
      if (plVar8 != (longlong *)0x0) {
        do {
          local_228 = plVar8[1];
          if (plVar8[2] == 0) {
            uStack544 = 0;
          }
          else {
            uStack544 = plVar8[2] + (DAT_1800b2bf8 - *plVar4);
          }
          uVar6 = FUN_18000f720((longlong)param_1,(ushort *)0x0,(ushort *)&local_228,'\x01');
          if ((int)uVar6 < 0) goto LAB_18005eb45;
          if (*plVar8 == 0) break;
          plVar4 = (longlong *)(DAT_1800b2bf8 + 0x9e8);
          plVar8 = (longlong *)((*plVar8 - *plVar4) + DAT_1800b2bf8);
        } while (plVar8 != (longlong *)0x0);
        lVar7 = *(longlong *)(param_1 + 2);
      }
    }
    if (*(longlong *)(lVar7 + 0x20) != 0) {
      lVar7 = (*(longlong *)(lVar7 + 0x20) - *(longlong *)(DAT_1800b2bf8 + 0x9e8)) + DAT_1800b2bf8;
      if (lVar7 != 0) {
        lVar7 = *(longlong *)(lVar7 + 0x20);
        if (lVar7 != 0) {
          lVar7 = (lVar7 - *(longlong *)(DAT_1800b2bf8 + 0x9e8)) + DAT_1800b2bf8;
        }
        iVar1 = FUN_180008bc8((longlong)param_1,lVar7,(ushort *)0x0,'\0',&local_248);
        if ((-1 < iVar1) && (local_248 != -1)) {
          iVar1 = 0;
          while (iVar2 = NtEnumerateKey(local_248,iVar1,0), iVar2 != -0x7fffffe6) {
            if (iVar2 < 0) {
LAB_18005eb2b:
              NtClose(local_248);
              goto LAB_18005eb45;
            }
            local_230 = local_208;
            uStack568._0_4_ = CONCAT22(local_20c,local_20c);
            uStack568 = uStack568 & 0xffffffff00000000 | (ulonglong)(uint)uStack568;
            iVar2 = FUN_18005e680(local_248,&uStack568);
            if (iVar2 < 0) {
              if (iVar2 != -0x7fffffe6) break;
              iVar2 = 0;
            }
            else {
              uVar6 = FUN_18000f720((longlong)param_1,(ushort *)0x0,(ushort *)&uStack568,'\x01');
              iVar2 = (int)uVar6;
            }
            if (iVar2 < 0) goto LAB_18005eb2b;
            iVar1 = iVar1 + 1;
          }
          NtClose(local_248);
        }
      }
    }
LAB_18005eb45:
    __security_check_cookie(uVar5 ^ (ulonglong)auStackY632);
    return extraout_RAX_00;
  }
  uStack48 = 0x180008f83;
  uVar3 = FUN_180011d50((longlong)param_1,(short **)0x0,local_res8);
  if ((char)uVar3 == '\0') {
    return 0xc000000d;
  }
  uStack48 = 0x180008f95;
  plVar4 = FUN_180008eac(*(longlong *)(param_1 + 2),local_res8[0]);
  if (plVar4 == (longlong *)0x0) {
    return 0xc0000016;
  }
  iVar1 = *param_1;
  if (iVar1 == 1) {
    uStack48 = 0x180008fb2;
    uVar5 = FUN_180008964(param_1,(longlong)plVar4,(longlong *)0x0,(ushort *)0x0);
  }
  else {
    if (iVar1 == 4) {
      local_28 = DAT_1800b2220 ^ (ulonglong)auStackY632;
      lVar7 = plVar4[3];
      while (lVar7 != 0) {
        plVar8 = (longlong *)((lVar7 - *(longlong *)(DAT_1800b2bf8 + 0x9e8)) + DAT_1800b2bf8);
        if (plVar8 == (longlong *)0x0) break;
        local_240 = (ushort *)plVar8[1];
        if (plVar8[2] == 0) {
          uStack568 = 0;
        }
        else {
          uStack568 = plVar8[2] + (DAT_1800b2bf8 - *(longlong *)(DAT_1800b2bf8 + 0x9e8));
        }
        uVar5 = FUN_18000f720((longlong)param_1,(ushort *)0x0,(ushort *)&local_240,'\x01');
        if ((int)uVar5 < 0) goto LAB_180005f78;
        lVar7 = *plVar8;
      }
      if ((((plVar4[4] != 0) &&
           (lVar7 = (plVar4[4] - *(longlong *)(DAT_1800b2bf8 + 0x9e8)) + DAT_1800b2bf8, lVar7 != 0))
          && (uVar3 = FUN_180011d50((longlong)param_1,(short **)0x0,(short **)&local_240),
             (char)uVar3 != '\0')) &&
         ((iVar1 = FUN_180008bc8((longlong)param_1,lVar7,local_240,'\0',&local_248), -1 < iVar1 &&
          (local_248 != -1)))) {
        iVar1 = 0;
        while (iVar2 = NtEnumerateValueKey(local_248,iVar1,0), iVar2 != -0x7fffffe6) {
          if (iVar2 < 0) {
LAB_18002c6ea:
            NtClose(local_248);
            goto LAB_180005f78;
          }
          uStack568 = (longlong)&uStack544 + 4;
          local_240 = (ushort *)
                      ((ulonglong)local_240 & 0xffffffff00000000 |
                      (ulonglong)CONCAT22((undefined2)uStack544,(undefined2)uStack544));
          uVar5 = FUN_18000f720((longlong)param_1,(ushort *)0x0,(ushort *)&local_240,'\x01');
          if ((int)uVar5 < 0) goto LAB_18002c6ea;
          iVar1 = iVar1 + 1;
        }
        NtClose(local_248);
      }
LAB_180005f78:
      __security_check_cookie(local_28 ^ (ulonglong)auStackY632);
      return extraout_RAX;
    }
    if (iVar1 == 6) {
      uStack48 = 0x18002d673;
      uVar5 = FUN_18005eb74(param_1,(longlong)plVar4);
    }
    else if (iVar1 - 2U < 2) {
      uStack48 = 0x18002d6a9;
      uVar5 = FUN_18005f454(param_1,(longlong)plVar4,(longlong *)0x0,(ushort *)0x0);
    }
    else {
      if (1 < iVar1 - 7U) {
        return 0xc000000d;
      }
      uStack48 = 0x18002d695;
      uVar5 = FUN_18005edf0(param_1,(longlong)plVar4);
    }
  }
  return uVar5;
}



uint FUN_180009000(undefined2 *param_1,undefined2 *param_2,uint param_3,ulonglong param_4,
                  uint param_5,uint *param_6)

{
  uint uVar1;
  byte local_res18 [16];
  uint local_18 [2];
  byte *local_10;
  
  local_10 = local_res18;
  local_18[0] = param_3;
  uVar1 = FUN_18000bb90(param_1,param_2,param_4,param_5,local_18,1);
  if (-1 < (int)uVar1) {
    *param_6 = (uint)local_res18[0];
    uVar1 = 0;
  }
  return uVar1;
}



ulonglong QuirkIsEnabledForPackageWorker
                    (undefined2 *param_1,undefined2 *param_2,uint param_3,uint *param_4)

{
  uint uVar1;
  ulonglong uVar2;
  undefined4 local_18 [2];
  ulonglong local_10;
  
                    // 0x9060  1126  QuirkIsEnabledForPackageWorker
  local_10 = 0;
  local_18[0] = 0;
  uVar2 = FUN_180009ca0(&local_10,local_18,0,param_1);
  uVar1 = (uint)uVar2;
  if (uVar1 == 0) {
    uVar1 = FUN_180009000(param_1,param_2,param_3,local_10,1 << ((byte)local_18[0] & 0x3f),param_4);
    uVar2 = (ulonglong)uVar1;
    if (-1 < (int)uVar1) {
      uVar2 = 0;
    }
  }
  else if (0 < (int)uVar1) {
    uVar2 = (ulonglong)(uVar1 & 0xffff | 0x80070000);
  }
  return uVar2;
}



ushort GetSystemWindowsDirectoryW(void *param_1,int param_2)

{
  ushort uVar1;
  longlong lVar2;
  ulonglong _Size;
  
                    // 0x9110  760  GetSystemWindowsDirectoryW
  lVar2 = KernelBaseGetGlobalData();
  _Size = (ulonglong)*(ushort *)(lVar2 + 8);
  uVar1 = *(ushort *)(lVar2 + 8) >> 1;
  if ((ulonglong)(uint)(param_2 * 2) < _Size + 2) {
    uVar1 = uVar1 + 1;
  }
  else {
    lVar2 = KernelBaseGetGlobalData();
    memcpy(param_1,*(void **)(lVar2 + 0x10),_Size);
    *(undefined2 *)((longlong)param_1 + (_Size & 0xfffffffffffffffe)) = 0;
  }
  return uVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint QuirkIsEnabledWorker(uint param_1)

{
  uint uVar1;
  longlong lVar2;
  int iVar3;
  uint uVar4;
  HANDLE pvVar5;
  byte bVar6;
  ulonglong uVar7;
  longlong lVar8;
  longlong in_GS_OFFSET;
  
                    // 0x9120  1128  QuirkIsEnabledWorker
  if ((((DAT_1800b2d98 == 0) && (iVar3 = FUN_1800093c4(), iVar3 < 0)) ||
      (*(ushort *)(DAT_1800b2d98 + 2) <= (ushort)(param_1 >> 0x10))) ||
     (*(ushort *)(DAT_1800b2d98 + 8 + (ulonglong)(param_1 >> 0x10) * 0x10) <= (ushort)param_1)) {
    uVar4 = 0;
  }
  else {
    lVar8 = (ulonglong)(param_1 & 0xffff) * 0x22c +
            *(longlong *)(DAT_1800b2d98 + 0x10 + (ulonglong)(param_1 >> 0x10) * 0x10) +
            DAT_1800b2d98;
    if (lVar8 == 0) {
      uVar4 = 0;
    }
    else {
      lVar2 = *(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x2d8);
      if (((lVar2 == 0) || (lVar2 == -0x7e0)) || (*(int *)(lVar2 + 0x810) == 0)) {
        bVar6 = 0;
      }
      else {
        bVar6 = (byte)*(undefined4 *)(lVar2 + 0x800);
      }
      lVar2 = *(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x2d8);
      if (((lVar2 == 0) || (lVar2 == -0x7e0)) || (*(int *)(lVar2 + 0x810) == 0)) {
        uVar7 = 0;
      }
      else {
        uVar7 = *(ulonglong *)(lVar2 + 0x7f8);
      }
      uVar4 = 1;
      if ((*(ulonglong *)(lVar8 + 0x10c) & 1 << (bVar6 & 0x3f) & 0xffffffffU) == 0) {
        uVar4 = 0;
      }
      else {
        if (DAT_1800b230c == -1) {
          if ((*(uint *)(lVar8 + 0x228) & 1) == 0) {
            if ((*(uint *)(lVar8 + 0x228) & 2) == 0) {
              uVar4 = (uint)(uVar7 < *(ulonglong *)(lVar8 + 0x104));
            }
            else {
              uVar4 = 0;
            }
          }
        }
        else {
          uVar4 = (uint)(DAT_1800b230c != 0);
        }
        if (((uVar4 != 0) && (uVar1 = *(uint *)(lVar8 + 0x228), (uVar1 & 4) != 0)) &&
           ((uVar1 & 8) == 0)) {
          *(uint *)(lVar8 + 0x228) = uVar1 | 8;
        }
      }
      if (_DAT_1800b2cec != 0) {
        pvVar5 = GetCurrentProcess();
        FUN_18000bd38(lVar8,uVar4,pvVar5,(undefined2 *)0x0,(undefined2 *)0x0);
      }
    }
  }
  return uVar4;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Exceeded maximum restarts with more pending

void FUN_180009284(undefined8 param_1)

{
  int iVar1;
  undefined8 local_res8 [4];
  undefined local_188 [360];
  undefined8 *local_20;
  undefined4 local_18;
  
  local_res8[0] = param_1;
  memset(local_188,0,0x178);
  local_20 = local_res8;
  local_res8[0] = 0;
  local_18 = 8;
  iVar1 = NtApphelpCacheControl();
  if (iVar1 < 0) {
    local_res8[0] = 0;
  }
  DAT_1800b2d98 = local_res8[0];
  return;
}



void FUN_180009300(undefined8 param_1)

{
  int iVar1;
  uint uVar2;
  undefined auStack56 [32];
  ushort local_18;
  ushort local_16;
  ulonglong local_10;
  
  local_10 = DAT_1800b2220 ^ (ulonglong)auStack56;
  if (DAT_1800b230c == 0xffffffff) {
    iVar1 = FUN_18000934c(param_1,(undefined8 *)&local_18);
    if (-1 < iVar1) {
      uVar2 = local_18 - 0x30;
      if (uVar2 == 0) {
        uVar2 = (uint)local_16;
      }
      DAT_1800b230c = (uint)(uVar2 != 0);
    }
  }
  __security_check_cookie(local_10 ^ (ulonglong)auStack56);
  return;
}



// WARNING: Removing unreachable block (ram,0x00018002d738)

int FUN_18000934c(undefined8 param_1,undefined8 *param_2)

{
  int iVar1;
  undefined local_18 [16];
  
  *param_2 = 0;
  iVar1 = RtlInitUnicodeStringEx(local_18,L"QUIRKS_FORCE_RESULT");
  if (-1 < iVar1) {
    iVar1 = RtlQueryEnvironmentVariable_U(0,local_18);
  }
  return iVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int FUN_1800093c4(void)

{
  longlong lVar1;
  byte bVar2;
  int iVar3;
  LPCRITICAL_SECTION p_Var4;
  undefined *puVar5;
  longlong in_GS_OFFSET;
  bool bVar6;
  
  if (DAT_1800b2d98 != 0) {
    return 0;
  }
  if (DAT_1800b2d90 == (LPCRITICAL_SECTION)0x0) {
    p_Var4 = (LPCRITICAL_SECTION)
             RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,0x28);
    if (p_Var4 == (LPCRITICAL_SECTION)0x0) {
      return -0x3fffff66;
    }
    InitializeCriticalSection(p_Var4);
    LOCK();
    bVar6 = DAT_1800b2d90 == (LPCRITICAL_SECTION)0x0;
    DAT_1800b2d90 =
         (LPCRITICAL_SECTION)
         ((ulonglong)DAT_1800b2d90 ^
         (ulonglong)bVar6 * ((ulonglong)DAT_1800b2d90 ^ (ulonglong)p_Var4));
    if (!bVar6) {
      DeleteCriticalSection(p_Var4);
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,p_Var4);
    }
  }
  p_Var4 = DAT_1800b2d90;
  EnterCriticalSection(DAT_1800b2d90);
  if (DAT_1800b2d98 == 0) {
    iVar3 = FUN_180009284(p_Var4);
    if (iVar3 < 0) goto LAB_1800094ed;
    if (DAT_1800b2d98 == 0) {
      iVar3 = -0x3fffffff;
      goto LAB_1800094ed;
    }
    lVar1 = *(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x2d8);
    if (lVar1 != 0) {
      *(undefined4 *)(lVar1 + 0x1188) = *(undefined4 *)(DAT_1800b2d98 + 4);
      *(longlong *)(lVar1 + 0x1180) = DAT_1800b2d98;
    }
    puVar5 = &DAT_180085338;
    iVar3 = EtwEventRegister(&DAT_180085338,0,0,&DAT_1800b2d88);
    if (iVar3 < 0) {
      DAT_1800b2d88 = (undefined *)0x0;
      _DAT_1800b2cec = 0;
    }
    else {
      puVar5 = DAT_1800b2d88;
      bVar2 = EtwEventEnabled(DAT_1800b2d88,&DAT_180085458);
      _DAT_1800b2cec = (uint)bVar2;
    }
    FUN_180009540();
    FUN_180009300(puVar5);
  }
  iVar3 = 0;
LAB_1800094ed:
  LeaveCriticalSection(DAT_1800b2d90);
  return iVar3;
}



// WARNING: Could not reconcile some variable overlaps
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180009540(void)

{
  uint *puVar1;
  longlong lVar2;
  char cVar3;
  int iVar4;
  DWORD DVar5;
  LSTATUS LVar6;
  ulonglong uVar7;
  longlong lVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  longlong in_GS_OFFSET;
  undefined auStackY696 [32];
  uint local_278;
  undefined4 local_274;
  undefined local_270 [16];
  undefined local_250 [24];
  WCHAR local_238 [264];
  ulonglong local_28;
  
  lVar2 = DAT_1800b2d98;
  local_28 = DAT_1800b2220 ^ (ulonglong)auStackY696;
  local_250._8_8_ = (int *)0x0;
  local_270 = ZEXT816(0);
  local_250._0_16_ = ZEXT816(0);
  if ((*(char *)(*(longlong *)(in_GS_OFFSET + 0x60) + 2) == '\0') &&
     (cVar3 = EtwEventEnabled(DAT_1800b2d88,&DAT_180085458), cVar3 == '\0')) {
    _DAT_1800b2ce8 = 0;
  }
  else {
    _DAT_1800b2ce8 = 1;
    local_274 = 0x104;
    iVar4 = GetCurrentPackageFullName(&local_274,local_238);
    if ((iVar4 < 0) || (local_238[0] == L'\0')) {
      local_274 = 0x104;
      DVar5 = GetModuleFileNameW((HMODULE)0x0,local_238,0x104);
      if (DVar5 == 0) goto LAB_1800095ca;
    }
    local_278 = 0;
    LVar6 = RegGetValueW((HKEY)0xffffffff80000001,
                         L"Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Quirks",
                         local_238,8,(LPDWORD)0x0,(PVOID)0x0,&local_278);
    if ((LVar6 == 0) && (local_278 != 0)) {
      uVar10 = (ulonglong)local_278;
      local_270._0_8_ = *(HANDLE *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30);
      if (local_270._0_8_ == (HANDLE)0x0) {
        local_270._0_8_ = GetProcessHeap();
      }
      if (uVar10 == 0) {
LAB_18002d87a:
        uVar10 = (ulonglong)local_278;
        LVar6 = RegGetValueW((HKEY)0xffffffff80000001,
                             L"Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Quirks"
                             ,local_238,8,(LPDWORD)0x0,local_250._8_8_,&local_278);
        if ((((LVar6 == 0) && (local_278 == uVar10)) && (uVar9 = 4, 3 < uVar10)) &&
           ((*local_250._8_8_ == 0x736b7271 && (4 < uVar10)))) {
          while ((uVar7 = uVar9 + 4, uVar9 <= uVar7 && (uVar7 <= uVar10))) {
            puVar1 = (uint *)(uVar9 + (longlong)local_250._8_8_);
            uVar9 = uVar9 + 8;
            if ((uVar9 < uVar7) || (uVar10 < uVar9)) break;
            iVar4 = *(int *)(uVar7 + (longlong)local_250._8_8_);
            lVar8 = FUN_18000bde0(lVar2,*puVar1);
            if ((lVar8 == 0) ||
               (*(uint *)(lVar8 + 0x228) = 2 - (iVar4 != 0) | *(uint *)(lVar8 + 0x228) & 0xfffffffc,
               uVar10 <= uVar9)) break;
          }
        }
        goto LAB_1800095d4;
      }
      if (uVar10 <= uVar10 + 0x3ff) {
        uVar10 = uVar10 + 0x3ff & 0xfffffffffffffc00;
        local_250._8_8_ = (int *)HeapAlloc(local_270._0_8_,0,uVar10);
        if (local_250._8_8_ != (int *)0x0) {
          memset(local_250._8_8_,0,uVar10);
          goto LAB_18002d87a;
        }
      }
      local_270 = ZEXT816(0);
      local_250._0_16_ = ZEXT816(0);
    }
  }
LAB_1800095ca:
LAB_1800095d4:
  if (local_250._8_8_ != (int *)0x0) {
    HeapFree(local_270._0_8_,0,local_250._8_8_);
  }
  __security_check_cookie(local_28 ^ (ulonglong)auStackY696);
  return;
}



longlong FUN_180009624(longlong param_1,uint param_2,int param_3)

{
  if (param_2 != 0) {
    return param_1 + ((ulonglong)
                      *(uint *)(param_1 + 2 + ((ulonglong)param_2 + (longlong)param_3 * 2) * 2) + 1)
                     * 2;
  }
  return param_1;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180009650(undefined8 param_1,undefined8 param_2,PVOID *param_3)

{
  WCHAR WVar1;
  int iVar2;
  LSTATUS LVar3;
  ulonglong uVar4;
  longlong lVar5;
  WCHAR *pWVar6;
  WCHAR *pWVar7;
  void *_Dst;
  longlong lVar8;
  uint uVar9;
  longlong lVar10;
  longlong in_GS_OFFSET;
  undefined auStackY1336 [32];
  uint local_4f8 [2];
  undefined local_4f0 [16];
  undefined local_4e0 [16];
  undefined local_4d0 [24];
  undefined8 local_4b8 [12];
  WCHAR local_458 [520];
  ulonglong local_48;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStackY1336;
  local_458[0] = L'\0';
  local_4f0 = ZEXT816(0);
  local_4d0._0_16_ = ZEXT816(0);
  local_4e0 = ZEXT816(0);
  iVar2 = NtQueryInformationToken(&DAT_fffffffffffffffa,1,local_4b8);
  if ((-1 < iVar2) && (iVar2 = RtlConvertSidToUnicodeString(local_4f0,local_4b8[0],1), -1 < iVar2))
  {
    uVar4 = FUN_18000bab4(local_458,0x208,local_4f0._8_8_);
    if (-1 < (int)uVar4) {
      lVar8 = 0x208;
      pWVar6 = local_458;
      do {
        if (*pWVar6 == L'\0') break;
        pWVar6 = pWVar6 + 1;
        lVar8 = lVar8 + -1;
      } while (lVar8 != 0);
      uVar9 = ~-(uint)(lVar8 != 0) & 0xc000000d;
      if (lVar8 != 0) {
        lVar5 = -lVar8 + 0x208;
        pWVar6 = local_458 + lVar5;
        lVar5 = 0x208 - lVar5;
        if (lVar5 != 0) {
          lVar10 = -lVar8 + 0x7ffffffe + lVar5;
          lVar8 = (longlong)
                  L"\\Software\\Classes\\Local Settings\\Software\\Microsoft\\Windows\\CurrentVersion\\AppContainer\\Mappings\\"
                  - (longlong)pWVar6;
          do {
            if ((lVar10 == 0) || (WVar1 = *(WCHAR *)(lVar8 + (longlong)pWVar6), WVar1 == L'\0'))
            break;
            *pWVar6 = WVar1;
            lVar10 = lVar10 + -1;
            pWVar6 = pWVar6 + 1;
            lVar5 = lVar5 + -1;
          } while (lVar5 != 0);
        }
        pWVar7 = pWVar6 + -1;
        if (lVar5 != 0) {
          pWVar7 = pWVar6;
        }
        uVar9 = ~-(uint)(lVar5 != 0) & 0x80000005;
        *pWVar7 = L'\0';
      }
      if ((-1 < (int)uVar9) &&
         (iVar2 = RtlConvertSidToUnicodeString(local_4e0,param_2,1), -1 < iVar2)) {
        uVar4 = FUN_18000bab4(local_458,0x208,local_4e0._8_8_);
        if (-1 < (int)uVar4) {
          lVar8 = 0x208;
          pWVar6 = local_458;
          do {
            if (*pWVar6 == L'\0') break;
            pWVar6 = pWVar6 + 1;
            lVar8 = lVar8 + -1;
          } while (lVar8 != 0);
          uVar9 = ~-(uint)(lVar8 != 0) & 0xc000000d;
          if (lVar8 != 0) {
            lVar5 = -lVar8 + 0x208;
            pWVar6 = local_458 + lVar5;
            lVar5 = 0x208 - lVar5;
            if (lVar5 != 0) {
              lVar10 = -lVar8 + 0x7ffffffe + lVar5;
              lVar8 = (longlong)L"\\Children\\" - (longlong)pWVar6;
              do {
                if ((lVar10 == 0) || (WVar1 = *(WCHAR *)(lVar8 + (longlong)pWVar6), WVar1 == L'\0'))
                break;
                *pWVar6 = WVar1;
                lVar10 = lVar10 + -1;
                pWVar6 = pWVar6 + 1;
                lVar5 = lVar5 + -1;
              } while (lVar5 != 0);
            }
            pWVar7 = pWVar6 + -1;
            if (lVar5 != 0) {
              pWVar7 = pWVar6;
            }
            uVar9 = ~-(uint)(lVar5 != 0) & 0x80000005;
            *pWVar7 = L'\0';
          }
          if ((-1 < (int)uVar9) &&
             (iVar2 = RtlConvertSidToUnicodeString(local_4d0,param_1,1), -1 < iVar2)) {
            uVar4 = FUN_18000bab4(local_458,0x208,local_4d0._8_8_);
            if (-1 < (int)uVar4) {
              local_4f8[0] = 0;
              LVar3 = RegGetValueW((HKEY)0xffffffff80000003,local_458,L"ParentMoniker",2,
                                   (LPDWORD)0x0,(PVOID)0x0,local_4f8);
              if (LVar3 == 0) {
                _Dst = (void *)RtlAllocateHeap(*(undefined8 *)
                                                (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
                *param_3 = _Dst;
                if (_Dst != (void *)0x0) {
                  memset(_Dst,0,(ulonglong)local_4f8[0] * 2);
                  RegGetValueW((HKEY)0xffffffff80000003,local_458,L"ParentMoniker",2,(LPDWORD)0x0,
                               *param_3,local_4f8);
                }
              }
            }
          }
        }
      }
    }
    RtlFreeUnicodeString(local_4f0);
    RtlFreeUnicodeString(local_4e0);
    RtlFreeUnicodeString(local_4d0);
  }
  __security_check_cookie(local_48 ^ (ulonglong)auStackY1336);
  return;
}



uint FUN_1800099f8(short *param_1,longlong param_2,longlong param_3)

{
  uint uVar1;
  longlong lVar2;
  ulonglong uVar3;
  
  memset(param_1,0,param_2 * 2);
  lVar2 = FUN_18001b894();
  uVar1 = FUN_18000ecd4(param_1,param_2,lVar2);
  if ((int)uVar1 < 0) {
    FUN_18001188c(1,0xf8,0xa5,200,(char)uVar1);
  }
  else {
    uVar3 = FUN_18000bab4(param_1,param_2,param_3);
    uVar1 = (uint)uVar3;
    if ((int)uVar1 < 0) {
      FUN_18001188c(1,0xf8,0xb0,0x10,(char)uVar3);
      uVar1 = 0xc000000d;
    }
  }
  return uVar1;
}



void GetTimeFormatWWorker
               (longlong param_1,uint param_2,longlong param_3,ushort *param_4,short *param_5,
               int param_6)

{
  int iVar1;
  uint uVar2;
  undefined8 uVar3;
  longlong lVar4;
  undefined auStackY808 [32];
  _SYSTEMTIME local_2f8;
  ushort local_2e6 [79];
  ushort local_248 [256];
  ulonglong local_48;
  
                    // 0x9a80  792  GetTimeFormatWWorker
  local_48 = DAT_1800b2220 ^ (ulonglong)auStackY808;
  if (param_4 == (ushort *)0x0) {
    NlsIsUserDefaultLocale();
    if ((param_2 & 3) == 0) {
      if ((-1 < (int)param_2) && (iVar1 = GetUserOverrideString(), iVar1 != 0)) goto LAB_180009be8;
      lVar4 = *(longlong *)(param_1 + 0x28);
      if (*(int *)(*(longlong *)(param_1 + 0x20) + 0x58) != 0) {
        uVar2 = *(uint *)(lVar4 + 2 + (ulonglong)*(uint *)(*(longlong *)(param_1 + 0x20) + 0x58) * 2
                         );
        goto LAB_180009c49;
      }
    }
    else {
      if ((-1 < (int)param_2) && (iVar1 = GetUserOverrideString(), iVar1 != 0)) {
LAB_180009be8:
        param_4 = local_2e6;
        goto LAB_180009ac5;
      }
      lVar4 = *(longlong *)(param_1 + 0x28);
      uVar2 = *(uint *)(*(longlong *)(param_1 + 0x20) + 0x118);
      if (uVar2 != 0) {
        uVar2 = *(uint *)(lVar4 + 2 + (ulonglong)uVar2 * 2);
LAB_180009c49:
        lVar4 = lVar4 + (ulonglong)uVar2 * 2;
      }
    }
    param_4 = (ushort *)(lVar4 + 2);
  }
LAB_180009ac5:
  if (param_3 == 0) {
    GetLocalTime(&local_2f8);
LAB_180009b21:
    iVar1 = FUN_180009e5c(param_1,(longlong)&local_2f8,param_4,local_248,param_2);
    if ((param_6 == 0) || (param_5 == (short *)0x0)) goto LAB_180009b75;
    if (param_6 < iVar1) {
      uVar3 = 0x7a;
    }
    else {
      if (iVar1 == 0) goto LAB_18002da59;
      uVar2 = FUN_18000b370(param_5,(longlong)iVar1,(longlong)local_248);
      if (-1 < (int)uVar2) goto LAB_180009b75;
      uVar3 = 0xe;
    }
  }
  else {
    local_2f8.wHour = *(ushort *)(param_3 + 8);
    local_2f8.wMinute = *(ushort *)(param_3 + 10);
    local_2f8.wSecond = *(ushort *)(param_3 + 0xc);
    local_2f8.wMilliseconds = *(ushort *)(param_3 + 0xe);
    if ((((local_2f8.wHour < 0x18) && (local_2f8.wMinute < 0x3c)) && (local_2f8.wSecond < 0x3d)) &&
       (local_2f8.wMilliseconds < 1000)) goto LAB_180009b21;
LAB_18002da59:
    uVar3 = 0x57;
  }
  RtlSetLastWin32Error(uVar3);
LAB_180009b75:
  __security_check_cookie(local_48 ^ (ulonglong)auStackY808);
  return;
}



void QuirkIsEnabledForPackage3Worker
               (undefined8 param_1,undefined2 *param_2,undefined2 *param_3,uint param_4,
               uint *param_5)

{
  ulonglong uVar1;
  byte local_res20 [8];
  uint local_18 [2];
  byte *local_10;
  
                    // 0x9c60  1124  QuirkIsEnabledForPackage3Worker
  local_10 = local_res20;
  local_18[0] = param_4;
  uVar1 = QuirkIsEnabledForPackage4Worker(param_1,param_2,param_3,local_18,1);
  if (-1 < (int)uVar1) {
    *param_5 = (uint)local_res20[0];
  }
  return;
}



ulonglong FUN_180009ca0(ulonglong *param_1,undefined4 *param_2,undefined8 param_3,undefined8 param_4
                       )

{
  uint uVar1;
  int iVar2;
  ulonglong uVar3;
  ulonglong uVar4;
  undefined4 local_38;
  undefined4 local_34;
  ulonglong local_30;
  undefined8 local_28;
  undefined8 local_20;
  
  uVar4 = 0;
  local_20 = 0;
  local_28 = 0;
  local_38 = 0;
  local_34 = 0;
  local_30 = 0;
  uVar1 = OpenPackageInfoByFullNameForUser(param_3,param_4,0,&local_20);
  if (uVar1 != 0) {
    return (ulonglong)uVar1;
  }
  uVar1 = GetTargetPlatformContext(local_20,0,&local_28);
  if (uVar1 == 0) {
    local_38 = 4;
    iVar2 = GetPackageTargetPlatformProperty(local_28,1,&local_38,&local_34);
    if (iVar2 != 0) {
      RtlGetDeviceFamilyInfoEnum(0,&local_34,0);
    }
    local_38 = 8;
    iVar2 = GetPackageTargetPlatformProperty(local_28,3,&local_38,&local_30);
    if (iVar2 != 0) {
      local_30 = 0;
    }
  }
  else {
    uVar3 = (ulonglong)uVar1;
    if (uVar1 != 0x490) goto LAB_180009d8c;
    iVar2 = AppXGetOSMaxVersionTested(param_4,&local_30);
    if (iVar2 < 0) {
      local_30 = uVar4;
    }
    RtlGetDeviceFamilyInfoEnum(0,&local_34,0);
  }
  if (param_1 != (ulonglong *)0x0) {
    *param_1 = local_30;
  }
  uVar3 = uVar4;
  if (param_2 != (undefined4 *)0x0) {
    *param_2 = local_34;
  }
LAB_180009d8c:
  ClosePackageInfo(local_20);
  return uVar3;
}



ulonglong QuirkIsEnabledForPackage4Worker
                    (undefined8 param_1,undefined2 *param_2,undefined2 *param_3,uint *param_4,
                    uint param_5)

{
  uint uVar1;
  ulonglong uVar2;
  undefined4 local_18 [2];
  ulonglong local_10;
  
                    // 0x9dd0  1125  QuirkIsEnabledForPackage4Worker
  local_10 = 0;
  local_18[0] = 0;
  uVar2 = FUN_180009ca0(&local_10,local_18,param_1,param_2);
  uVar1 = (uint)uVar2;
  if (uVar1 == 0) {
    uVar1 = FUN_18000bb90(param_2,param_3,local_10,1 << ((byte)local_18[0] & 0x3f),param_4,param_5);
    uVar2 = (ulonglong)uVar1;
    if (-1 < (int)uVar1) {
      uVar2 = 0;
    }
  }
  else if (0 < (int)uVar1) {
    uVar2 = (ulonglong)(uVar1 & 0xffff | 0x80070000);
  }
  return uVar2;
}



void FUN_180009e5c(undefined8 param_1,longlong param_2,ushort *param_3,ushort *param_4,uint param_5)

{
  ushort *puVar1;
  ulonglong uVar2;
  bool bVar3;
  ushort uVar4;
  int iVar5;
  undefined7 extraout_var;
  uint uVar6;
  ushort *puVar7;
  ushort *puVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  ushort *puVar11;
  ulonglong uVar12;
  int iVar13;
  int iVar14;
  undefined auStackY328 [32];
  ushort *local_118;
  ulonglong local_110;
  longlong local_108;
  undefined8 local_100;
  ushort *local_f8;
  ushort local_e8 [80];
  ulonglong local_48;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStackY328;
  uVar4 = *param_3;
  local_110 = 0x100;
  iVar14 = 0;
  local_118 = param_4;
  local_108 = param_2;
  local_100 = param_1;
  local_f8 = param_4;
  if (uVar4 != 0) {
    uVar12 = 0x100;
    puVar7 = param_4;
    puVar8 = param_3;
    uVar9 = 0x100;
    puVar11 = param_4;
    do {
      iVar13 = 0;
      uVar10 = (ulonglong)uVar4;
      if (uVar4 == 0x27) {
        puVar8 = puVar8 + 1;
        uVar4 = *puVar8;
        while (param_4 = puVar7, uVar10 = uVar9, puVar1 = local_118, uVar2 = local_110, uVar4 != 0)
        {
          if (uVar4 == 0x27) {
            puVar8 = puVar8 + 1;
            if (*puVar8 != 0x27) break;
            if (uVar9 < 2) goto LAB_180009fbd;
            *puVar7 = 0x27;
          }
          else {
            if (uVar9 < 2) goto LAB_180009fbd;
            *puVar7 = uVar4;
          }
          puVar8 = puVar8 + 1;
          uVar9 = uVar9 - 1;
          puVar7 = puVar7 + 1;
          local_118 = puVar7;
          local_110 = uVar9;
          uVar4 = *puVar8;
        }
        goto LAB_180009f9f;
      }
      iVar5 = iVar13;
      if (uVar4 == 0x48) {
        while (puVar8 = puVar8 + 1, *puVar8 == 0x48) {
          iVar5 = iVar5 + 1;
        }
        for (; 0 < iVar14; iVar14 = iVar14 + -1) {
          if (uVar9 < 2) goto LAB_180009fbd;
          *puVar7 = 0x20;
          puVar7 = puVar7 + 1;
          uVar9 = uVar9 - 1;
          local_118 = puVar7;
          local_110 = uVar9;
        }
        uVar12 = (ulonglong)*(ushort *)(param_2 + 8);
LAB_180009f52:
        uVar6 = 2;
        if (iVar5 == 0) {
          uVar6 = 1;
        }
        iVar13 = FUN_18000b018(uVar12,uVar10,uVar6,(short **)&local_118,(longlong *)&local_110);
LAB_180009f74:
        param_4 = local_118;
        uVar10 = local_110;
        param_3 = puVar8;
        param_2 = local_108;
        param_1 = local_100;
        puVar11 = local_118;
        uVar12 = local_110;
        puVar1 = local_118;
        uVar2 = local_110;
        if (iVar13 == 0) goto LAB_180009fbd;
      }
      else {
        if (uVar4 == 0x68) {
          uVar4 = *(ushort *)(param_2 + 8);
          if ((param_5 & 8) == 0) {
            uVar10 = (ulonglong)uVar4 / 0xc;
            uVar4 = uVar4 + (short)uVar10 * -0xc;
            if (uVar4 == 0) {
              uVar4 = 0xc;
            }
          }
          while (puVar8 = puVar8 + 1, *puVar8 == 0x68) {
            iVar5 = iVar5 + 1;
          }
          for (; 0 < iVar14; iVar14 = iVar14 + -1) {
            if (uVar9 < 2) goto LAB_180009fbd;
            *puVar7 = 0x20;
            puVar7 = puVar7 + 1;
            uVar9 = uVar9 - 1;
            local_118 = puVar7;
            local_110 = uVar9;
          }
          uVar12 = (ulonglong)uVar4;
          goto LAB_180009f52;
        }
        if (uVar4 != 0x6d) {
          if (uVar4 == 0x73) {
            while (puVar8 = puVar8 + 1, *puVar8 == 0x73) {
              iVar5 = iVar5 + 1;
            }
            if ((param_5 & 3) == 0) {
              for (; 0 < iVar14; iVar14 = iVar14 + -1) {
                if (uVar9 < 2) goto LAB_180009fbd;
                *puVar7 = 0x20;
                puVar7 = puVar7 + 1;
                uVar9 = uVar9 - 1;
                local_118 = puVar7;
                local_110 = uVar9;
              }
              uVar12 = (ulonglong)*(ushort *)(param_2 + 0xc);
              goto LAB_180009f52;
            }
            bVar3 = false;
            for (; puVar8 != param_3; param_3 = param_3 + 1) {
              if (*param_3 == 0x27) {
                bVar3 = !bVar3;
              }
              else if (bVar3) {
                *puVar11 = *param_3;
                puVar11 = puVar11 + 1;
                uVar12 = uVar12 - 1;
              }
            }
            bVar3 = false;
            iVar14 = iVar13;
            for (; uVar4 = *puVar8, param_4 = puVar11, uVar10 = uVar12, puVar1 = puVar11,
                uVar2 = uVar12, uVar4 != 0; puVar8 = puVar8 + 1) {
              if (*param_3 == 0x27) {
                if (bVar3) {
                  bVar3 = false;
                  goto LAB_18002dbf5;
                }
                bVar3 = true;
              }
              else {
LAB_18002dbf5:
                if (!bVar3) {
                  if (uVar4 == 0x20) {
                    iVar14 = iVar14 + 1;
                  }
                  else if (((ushort)(uVar4 - 0x48) < 0x2d) &&
                          ((0x102100000001U >> ((ulonglong)(ushort)(uVar4 - 0x48) & 0x3f) & 1) != 0)
                          ) break;
                }
              }
            }
            goto LAB_180009f9f;
          }
          if (uVar4 == 0x74) {
            while (puVar8 = puVar8 + 1, *puVar8 == 0x74) {
              iVar13 = iVar13 + 1;
            }
            for (; 0 < iVar14; iVar14 = iVar14 + -1) {
              if (uVar9 < 2) goto LAB_180009fbd;
              *puVar7 = 0x20;
              puVar7 = puVar7 + 1;
              uVar9 = uVar9 - 1;
              local_118 = puVar7;
              local_110 = uVar9;
            }
            param_4 = puVar11;
            uVar10 = uVar12;
            param_3 = puVar8;
            puVar1 = puVar11;
            uVar2 = uVar12;
            if ((param_5 & 4) != 0) {
              while ((*puVar8 != 0 &&
                     ((uVar4 = *puVar8 - 0x48, 0x2b < uVar4 ||
                      ((0x82100000001U >> ((ulonglong)uVar4 & 0x3f) & 1) == 0))))) {
                puVar8 = puVar8 + 1;
              }
              goto LAB_180009f9f;
            }
            if (iVar13 == 2) {
              uVar6 = 0x7f - (*(ushort *)(param_2 + 8) < 0xc);
            }
            else {
              uVar6 = 0x29 - (*(ushort *)(param_2 + 8) < 0xc);
            }
            iVar5 = GetLocaleInfoHelper(param_1,uVar6 | param_5 & 0x80000000,local_e8,0x50);
            if (iVar5 == 0) {
              local_e8[0] = 0;
            }
            param_2 = local_108;
            param_1 = local_100;
            if (local_e8[0] == 0) goto LAB_180009f9f;
            if (iVar13 != 0) {
              bVar3 = FUN_18000b0f4((short **)&local_118,(longlong *)&local_110,(short *)local_e8);
              iVar13 = (int)CONCAT71(extraout_var,bVar3);
              goto LAB_180009f74;
            }
            if (1 < uVar9) {
              uVar10 = uVar9 - 1;
              *puVar7 = local_e8[0];
              param_4 = puVar7 + 1;
              puVar11 = param_4;
              uVar12 = uVar10;
              puVar1 = param_4;
              uVar2 = uVar10;
              goto LAB_180009f9f;
            }
          }
          else if (1 < uVar9) {
            *puVar7 = uVar4;
            param_4 = puVar7 + 1;
            puVar8 = puVar8 + 1;
            uVar10 = uVar9 - 1;
            puVar1 = puVar7 + 1;
            uVar2 = uVar9 - 1;
            goto LAB_180009f9f;
          }
          goto LAB_180009fbd;
        }
        while (puVar8 = puVar8 + 1, *puVar8 == 0x6d) {
          iVar5 = iVar5 + 1;
        }
        if ((param_5 & 1) == 0) {
          for (; 0 < iVar14; iVar14 = iVar14 + -1) {
            if (uVar9 < 2) goto LAB_180009fbd;
            *puVar7 = 0x20;
            puVar7 = puVar7 + 1;
            uVar9 = uVar9 - 1;
            local_118 = puVar7;
            local_110 = uVar9;
          }
          uVar12 = (ulonglong)*(ushort *)(param_2 + 10);
          goto LAB_180009f52;
        }
        bVar3 = false;
        for (; puVar8 != param_3; param_3 = param_3 + 1) {
          if (*param_3 == 0x27) {
            bVar3 = !bVar3;
          }
          else if (bVar3) {
            *puVar11 = *param_3;
            puVar11 = puVar11 + 1;
            uVar12 = uVar12 - 1;
          }
        }
        bVar3 = false;
        iVar14 = iVar13;
        for (; uVar4 = *puVar8, param_4 = puVar11, uVar10 = uVar12, puVar1 = puVar11, uVar2 = uVar12
            , uVar4 != 0; puVar8 = puVar8 + 1) {
          if (*param_3 == 0x27) {
            if (bVar3) {
              bVar3 = false;
              goto LAB_18002dcb6;
            }
            bVar3 = true;
          }
          else {
LAB_18002dcb6:
            if (!bVar3) {
              if (uVar4 == 0x20) {
                iVar14 = iVar14 + 1;
              }
              else if (((ushort)(uVar4 - 0x48) < 0x2d) &&
                      ((0x100100000001U >> ((ulonglong)(ushort)(uVar4 - 0x48) & 0x3f) & 1) != 0))
              break;
            }
          }
        }
      }
LAB_180009f9f:
      local_110 = uVar2;
      local_118 = puVar1;
      uVar4 = *puVar8;
      puVar7 = param_4;
      uVar9 = uVar10;
    } while (uVar4 != 0);
  }
  *param_4 = 0;
LAB_180009fbd:
  __security_check_cookie(local_48 ^ (ulonglong)auStackY328);
  return;
}



undefined4 * SortGetHandle(LPCWSTR param_1,uint *param_2,int param_3,undefined8 param_4)

{
  undefined4 *puVar1;
  uint uVar2;
  
                    // 0xa190  1429  SortGetHandle
  puVar1 = (undefined4 *)FUN_18000a238((longlong *)&DAT_1800b2b60,param_1,param_2,param_4,param_3);
  if (puVar1 != (undefined4 *)0x0) {
    *puVar1 = 2;
    uVar2 = 0x60305;
    if (0x60305 < DAT_1800b2bd8) {
      uVar2 = DAT_1800b2bd8;
    }
    puVar1[0x36] = uVar2;
    *(code **)(puVar1 + 0x3a) = FUN_180015660;
    *(code **)(puVar1 + 0x3c) = FUN_180003310;
    *(code **)(puVar1 + 0x3e) = FUN_180002740;
    *(code **)(puVar1 + 0x38) = FUN_180001290;
    *(code **)(puVar1 + 0x40) = FUN_180057b70;
    *(code **)(puVar1 + 0x42) = FUN_1800560a0;
  }
  return puVar1;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18000a238(longlong *param_1,LPCWSTR param_2,uint *param_3,undefined8 param_4,int param_5)

{
  BOOL BVar1;
  int iVar2;
  undefined (*pauVar3) [16];
  undefined4 *puVar4;
  DWORD dwErrCode;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined auStack104 [32];
  undefined local_48 [16];
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack104;
  if ((param_3 == (uint *)0x0) || (param_3[1] == 0)) {
LAB_18002ddb1:
    dwErrCode = 0x57;
  }
  else {
    pauVar3 = (undefined (*) [16])(param_3 + 4);
    if (*param_3 < 0x20) {
      pauVar3 = (undefined (*) [16])&DAT_1800853e8;
    }
    uVar5 = *(undefined4 *)*pauVar3;
    uVar6 = *(undefined4 *)(*pauVar3 + 4);
    uVar7 = *(undefined4 *)(*pauVar3 + 8);
    uVar8 = *(undefined4 *)(*pauVar3 + 0xc);
    local_48 = *pauVar3;
    local_48._0_8_ = SUB128(*(undefined (*) [12])*pauVar3,0);
    if ((param_2 == (LPCWSTR)0x0) || (BVar1 = IsValidLocaleName(param_2), BVar1 == 0)) {
      local_48._8_8_ = local_48._0_8_;
      if (local_48._0_8_ == 0) {
      }
      if (local_48._8_8_ == 0) goto LAB_18002ddb1;
    }
    if (param_5 == 0) {
      if ((param_1[0xb] == 0) && (iVar2 = FUN_18000b49c(param_1), iVar2 == 0)) goto LAB_18000a337;
      if (((*(uint *)(param_1 + 0xf) ^ param_3[1]) & 0xffffff00) == 0) {
        if (local_48._0_8_ == 0) {
          local_48._0_8_ = local_48._8_8_;
        }
        if (local_48._0_8_ == 0) {
          pauVar3 = (undefined (*) [16])FUN_18000a5f8((undefined (*) [16])local_48,param_2);
          local_48 = *pauVar3;
        }
        else {
          local_48 = CONCAT412(uVar8,CONCAT48(uVar7,CONCAT44(uVar6,uVar5)));
        }
        puVar4 = (undefined4 *)FUN_18000a574((longlong)param_1,(longlong *)local_48);
        if (puVar4 != (undefined4 *)0x0) {
          FUN_18000a36c(param_1,puVar4);
          goto LAB_18000a337;
        }
      }
      goto LAB_18002ddb1;
    }
    dwErrCode = 0x3ec;
  }
  SetLastError(dwErrCode);
LAB_18000a337:
  __security_check_cookie(local_38 ^ (ulonglong)auStack104);
  return;
}



longlong FUN_18000a36c(longlong *param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  longlong lVar4;
  longlong lVar5;
  longlong in_GS_OFFSET;
  
  lVar4 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,400);
  if (lVar4 != 0) {
    uVar1 = param_2[1];
    uVar2 = param_2[2];
    uVar3 = param_2[3];
    *(undefined4 *)(lVar4 + 200) = *param_2;
    *(undefined4 *)(lVar4 + 0xcc) = uVar1;
    *(undefined4 *)(lVar4 + 0xd0) = uVar2;
    *(undefined4 *)(lVar4 + 0xd4) = uVar3;
    if (param_2[6] == 0) {
      lVar5 = 0;
    }
    else {
      lVar5 = param_1[5] + (ulonglong)(uint)param_2[6] * 4;
    }
    *(longlong *)(lVar4 + 0x130) = lVar5;
    if (param_2[7] != 0) {
      lVar5 = param_1[5] + (ulonglong)(uint)param_2[7] * 4;
    }
    *(longlong *)(lVar4 + 0x138) = lVar5;
    FUN_18000a474((longlong)param_1,lVar4,(longlong)param_2);
    lVar5 = *param_1;
    *(longlong *)(lVar4 + 0x110) = lVar5 + 4;
    *(ulonglong *)(lVar4 + 0x118) = lVar5 + (ulonglong)*(ushort *)(lVar5 + 2) * 2 + 4;
    lVar5 = *param_1 + (ulonglong)(uint)param_2[8] * 2;
    *(longlong *)(lVar4 + 0x120) = lVar5 + 4;
    *(ulonglong *)(lVar4 + 0x128) = lVar5 + ((ulonglong)*(ushort *)(lVar5 + 2) + 2) * 2;
  }
  return lVar4;
}



void FUN_18000a474(longlong param_1,longlong param_2,longlong param_3)

{
  uint *puVar1;
  longlong lVar2;
  ushort uVar3;
  ushort uVar4;
  ushort uVar5;
  int iVar6;
  
  *(undefined4 *)(param_2 + 0x140) = *(undefined4 *)(param_3 + 0x10);
  if (*(uint *)(param_3 + 0x14) == 0xffffffff) {
    *(undefined8 *)(param_2 + 0x150) = 0;
  }
  else {
    puVar1 = (uint *)(*(longlong *)(param_1 + 0x40) + (ulonglong)*(uint *)(param_3 + 0x14) * 0x18);
    *(uint **)(param_2 + 0x150) = puVar1;
    uVar3 = *(ushort *)(puVar1 + 2);
    lVar2 = *(longlong *)(param_1 + 0x48);
    if (uVar3 != 0) {
      *(ulonglong *)(param_2 + 0x158) = lVar2 + (ulonglong)*puVar1 * 2;
      uVar3 = *(ushort *)(puVar1 + 2);
    }
    uVar4 = *(ushort *)((longlong)puVar1 + 10);
    if (uVar4 != 0) {
      *(ulonglong *)(param_2 + 0x160) =
           lVar2 + ((ulonglong)*puVar1 + (longlong)(int)((uint)uVar3 * 4)) * 2;
      uVar4 = *(ushort *)((longlong)puVar1 + 10);
    }
    uVar5 = *(ushort *)(puVar1 + 3);
    iVar6 = (uint)uVar3 * 4 + ((uint)uVar4 + (uint)uVar4 * 2) * 2;
    if (uVar5 != 0) {
      *(ulonglong *)(param_2 + 0x168) = lVar2 + ((ulonglong)*puVar1 + (longlong)iVar6) * 2;
      uVar5 = *(ushort *)(puVar1 + 3);
    }
    uVar3 = *(ushort *)((longlong)puVar1 + 0xe);
    iVar6 = iVar6 + ((uint)uVar5 + (uint)uVar5 * 2) * 2;
    if (uVar3 != 0) {
      *(ulonglong *)(param_2 + 0x170) = lVar2 + ((ulonglong)*puVar1 + (longlong)iVar6) * 2;
      uVar3 = *(ushort *)((longlong)puVar1 + 0xe);
    }
    iVar6 = iVar6 + (uint)uVar3 * 8;
    uVar3 = *(ushort *)(puVar1 + 4);
    if (uVar3 != 0) {
      *(ulonglong *)(param_2 + 0x178) = lVar2 + ((ulonglong)*puVar1 + (longlong)iVar6) * 2;
      uVar3 = *(ushort *)(puVar1 + 4);
    }
    iVar6 = iVar6 + (uint)uVar3 * 8;
    if (*(short *)((longlong)puVar1 + 0x12) != 0) {
      *(ulonglong *)(param_2 + 0x180) = lVar2 + ((ulonglong)*puVar1 + (longlong)iVar6) * 2;
    }
    if (*(short *)(puVar1 + 5) != 0) {
      *(ulonglong *)(param_2 + 0x188) =
           lVar2 + ((longlong)
                    (int)(iVar6 + ((uint)*(ushort *)((longlong)puVar1 + 0x12) +
                                  (uint)*(ushort *)((longlong)puVar1 + 0x12) * 4) * 2) +
                   (ulonglong)*puVar1) * 2;
      return;
    }
  }
  return;
}



void FUN_18000a574(longlong param_1,longlong *param_2)

{
  longlong lVar1;
  undefined auStackY88 [32];
  longlong local_28;
  longlong lStack32;
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStackY88;
  local_28 = *param_2;
  lStack32 = param_2[1];
  lVar1 = local_28 + -0x1e5c57ee00000001;
  if (lVar1 == 0) {
    lVar1 = lStack32 + -0x1ee1b10b00d0b400;
  }
  if (lVar1 != 0) {
    bsearch(&local_28,*(void **)(param_1 + 0x30),(ulonglong)*(uint *)(param_1 + 8),0x24,
            FUN_180020550);
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStackY88);
  return;
}



void FUN_18000a5f8(undefined (*param_1) [16],short *param_2)

{
  int iVar1;
  undefined8 uVar2;
  short *psVar3;
  undefined auStackY328 [32];
  short *local_100;
  undefined local_f8 [16];
  undefined local_e8 [16];
  undefined4 local_d8;
  undefined4 uStack212;
  undefined4 uStack208;
  undefined4 uStack204;
  short local_c0 [32];
  undefined local_80 [12];
  undefined local_74 [84];
  ulonglong local_20;
  
  local_20 = DAT_1800b2220 ^ (ulonglong)auStackY328;
  local_100 = (short *)0x0;
  if ((param_2 != (short *)0x0) && (uVar2 = FUN_18000b3f4(), (int)uVar2 != 0)) {
    FUN_18000b120(local_c0,0x20,param_2,&local_100,(longlong *)0x0);
    psVar3 = local_100;
LAB_18000a667:
    if (local_c0 < psVar3) {
      RtlInitUnicodeString(local_f8);
      memset(local_80,0,0x5a);
      iVar1 = NtQueryValueKey(DAT_1800b2d18,local_f8,2,local_80);
      if (iVar1 == 0) {
        RtlInitUnicodeString(local_e8,local_74);
        iVar1 = RtlGUIDFromString(local_e8,&local_d8);
        if (-1 < iVar1) goto LAB_18000a70b;
      }
      psVar3 = psVar3 + -1;
      if (local_c0 < psVar3) {
        do {
          if ((*psVar3 == 0x2d) || (*psVar3 == 0x5f)) {
            *psVar3 = 0;
            break;
          }
          psVar3 = psVar3 + -1;
        } while (local_c0 < psVar3);
      }
      goto LAB_18000a667;
    }
  }
  local_d8 = 1;
  uStack212 = 0x1e5c57ee;
  uStack208 = 0xd0b400;
  uStack204 = 0x1ee1b10b;
LAB_18000a70b:
  *param_1 = CONCAT412(uStack204,CONCAT48(uStack208,CONCAT44(uStack212,local_d8)));
  __security_check_cookie(local_20 ^ (ulonglong)auStackY328);
  return;
}



void GetDateFormatWWorker
               (ushort *param_1,uint param_2,ushort *param_3,ushort *param_4,short *param_5,
               int param_6,uint param_7)

{
  bool bVar1;
  int iVar2;
  uint uVar3;
  longlong lVar4;
  longlong lVar5;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  ulonglong uVar6;
  ulonglong uVar7;
  undefined8 uVar8;
  short *psVar9;
  ushort uVar10;
  uint uVar11;
  ulonglong uVar12;
  ushort uVar13;
  uint uVar14;
  uint uVar15;
  uint uVar16;
  undefined auStackY936 [32];
  uint local_358;
  ushort local_354;
  int local_350;
  int local_34c;
  longlong local_348;
  ushort *local_340;
  short *local_338;
  undefined4 local_330 [2];
  ushort local_328;
  ushort local_324;
  ushort local_320;
  undefined local_308 [16];
  ushort local_2f8 [80];
  ushort local_258 [256];
  ulonglong local_58;
  
                    // 0xa790  557  GetDateFormatWWorker
  local_58 = DAT_1800b2220 ^ (ulonglong)auStackY936;
  uVar14 = param_2 & 4;
  uVar11 = 0;
  local_338 = param_5;
  local_34c = 0;
  local_358 = 0;
  local_350 = 0;
  uVar15 = param_7;
  uVar3 = uVar11;
  uVar16 = uVar11;
  local_340 = param_3;
  if (((int)param_2 < 0) || (iVar2 = NlsIsUserDefaultLocale(), uVar3 = 0, uVar16 = 0, iVar2 == 0)) {
LAB_18000a860:
    param_7 = uVar15;
    if (uVar15 == 0) {
      if (uVar14 != 0) {
        if (*(ushort *)
             (*(longlong *)(param_1 + 0x14) +
             (ulonglong)*(uint *)(*(longlong *)(param_1 + 0x10) + 0x7c) * 2) < 2) {
          uVar10 = 0;
        }
        else {
          uVar10 = *(ushort *)
                    (*(longlong *)(param_1 + 0x14) +
                    (ulonglong)(*(uint *)(*(longlong *)(param_1 + 0x10) + 0x7c) + 2) * 2);
        }
        param_7 = (uint)uVar10;
        if (uVar10 != 0) goto LAB_18000a868;
      }
      param_7 = (uint)*(ushort *)
                       (*(longlong *)(param_1 + 0x14) +
                       (ulonglong)(*(int *)(*(longlong *)(param_1 + 0x10) + 0x7c) + 1) * 2);
      if (uVar16 == 1) {
        uVar3 = param_7;
      }
    }
  }
  else {
    uVar16 = 1;
    iVar2 = GetUserOverrideWord();
    uVar3 = uVar11;
    if (iVar2 == 0) goto LAB_18000a860;
    uVar3 = FUN_18000b2f4((longlong)param_1,(uint)local_354);
    uVar3 = uVar3 & 0xffff;
    if ((uVar14 != 0) || (uVar15 = uVar3, param_7 == 0)) goto LAB_18000a860;
  }
LAB_18000a868:
  uVar15 = 0;
  if (param_7 == uVar3) {
    uVar15 = uVar16;
  }
  lVar4 = GetCalendar();
  local_348 = lVar4;
  if (lVar4 == 0) goto LAB_18002df5c;
  if (param_4 == (ushort *)0x0) {
    uVar3 = param_2 & 0xb;
    if (uVar3 < 2) {
      lVar5 = KernelBaseGetGlobalData();
      psVar9 = *(short **)(lVar5 + 0x58);
      if (*(int *)(lVar4 + 4) != 0) {
        psVar9 = psVar9 + *(uint *)(psVar9 + (ulonglong)*(uint *)(lVar4 + 4) + 1);
      }
      local_358 = 0x1f;
LAB_18000aa5e:
      if ((((uVar14 == 0) || (param_7 == 1)) || (*psVar9 == 0)) ||
         (param_4 = (ushort *)(psVar9 + 1), param_4 == (ushort *)0x0)) {
        if (uVar15 != 0) {
          GetLocaleInfoHelper(param_1,param_7 << 0x10 | local_358,local_2f8,0x50);
          param_4 = local_2f8;
          if (local_2f8[0] != 0) goto LAB_18000a8a3;
        }
        if (*psVar9 == 0) {
          GetLocaleInfoHelper(param_1,local_358 | 0x80000000,local_2f8,0x50);
          param_4 = local_2f8;
        }
        else {
          param_4 = (ushort *)(psVar9 + 1);
        }
      }
      goto LAB_18000a8a3;
    }
    if (uVar3 == 2) {
      lVar5 = KernelBaseGetGlobalData();
      psVar9 = *(short **)(lVar5 + 0x58);
      if (*(int *)(lVar4 + 0xc) != 0) {
        psVar9 = psVar9 + *(uint *)(psVar9 + (ulonglong)*(uint *)(lVar4 + 0xc) + 1);
      }
      local_358 = 0x20;
      goto LAB_18000aa5e;
    }
    if (uVar3 == 8) {
      lVar5 = KernelBaseGetGlobalData();
      psVar9 = *(short **)(lVar5 + 0x58);
      if (*(int *)(lVar4 + 8) != 0) {
        psVar9 = psVar9 + *(uint *)(psVar9 + (ulonglong)*(uint *)(lVar4 + 8) + 1);
      }
      local_358 = 0x1006;
      goto LAB_18000aa5e;
    }
    uVar8 = 0x3ec;
  }
  else {
LAB_18000a8a3:
    lVar4 = local_348;
    uVar6 = 0;
    if (local_340 == (ushort *)0x0) {
      GetLocalTime((LPSYSTEMTIME)local_308);
    }
    else {
      local_308._0_2_ = *local_340;
      local_308._8_8_ = 0;
      local_308._2_2_ = local_340[1];
      local_308._4_2_ = local_340[2];
      local_308._6_2_ = local_340[3];
      iVar2 = FUN_18000b254((undefined2 *)local_308);
      if (iVar2 == 0) goto LAB_18002df5c;
    }
    if (param_7 == 6) {
      uVar8 = FUN_180051470((ushort *)local_308,local_330,param_2);
      if ((int)uVar8 != 0) {
        local_308._0_2_ = local_328;
        local_308._2_2_ = local_324;
        local_308._6_2_ = local_320;
        goto LAB_18000a90a;
      }
    }
    else {
      if (param_7 == 8) {
        bVar1 = FUN_18004b42c((ushort *)local_308,&local_34c);
        iVar2 = (int)CONCAT71(extraout_var,bVar1);
      }
      else if (param_7 == 0x17) {
        uVar8 = FUN_18004b4d4((ushort *)local_308);
        iVar2 = (int)uVar8;
      }
      else {
        if (param_7 != 0x16) goto LAB_18000a90a;
        bVar1 = FUN_18004b48c((undefined2 *)local_308);
        iVar2 = (int)CONCAT71(extraout_var_00,bVar1);
      }
      if (iVar2 != 0) {
LAB_18000a90a:
        uVar15 = param_2;
        if ((param_2 & 0x40) != 0) {
          uVar15 = param_2 | 0x10;
          iVar2 = GetLocaleInfoHelper(param_1,0x20000070,&local_350,2);
          if ((iVar2 != 0) && (local_350 == 1)) {
            if ((*param_1 & 0x3ff) == 0xd) {
              if ((local_358 != 0x1f) || (param_7 == 8)) {
LAB_18002dfa9:
                uVar15 = param_2 | 0x30;
              }
            }
            else if ((param_7 < 0x18) && ((0xc01c42U >> (param_7 & 0x1f) & 1) != 0))
            goto LAB_18002dfa9;
          }
        }
        uVar3 = 0;
        iVar2 = FUN_18000ab54(param_1,uVar15,(ushort *)local_308,param_4,local_258,param_7,lVar4,1,0
                              ,local_34c);
        lVar4 = (longlong)iVar2;
        if (param_6 == 0) goto LAB_18000aa04;
        if (param_6 < iVar2) {
          uVar8 = 0x7a;
          goto LAB_18002df61;
        }
        if (iVar2 == 0) goto LAB_18002df5c;
        if ((uVar15 & 0x40) != 0) {
          if (param_7 != 8) {
            if (param_7 != 1) goto LAB_18000a9e9;
            if ((*param_1 & 0x3ff) != 0xd) {
              uVar16 = uVar3;
              if ((*(uint *)(param_1 + 0x22) & 0x800a) != 0) {
                if (*(int *)(*(longlong *)(param_1 + 0x10) + 0xac) == 0) {
                  param_1 = *(ushort **)(param_1 + 0x30);
                }
                uVar16 = *(uint *)(*(longlong *)(param_1 + 0x14) + 2 +
                                  (ulonglong)*(uint *)(*(longlong *)(param_1 + 0x10) + 0xac) * 2) >>
                         0xb & 1;
              }
              if (uVar16 == 0) goto LAB_18000a9e9;
            }
          }
          uVar7 = uVar6;
          uVar12 = uVar6;
          uVar10 = 0x200f;
          uVar13 = 0x200e;
          if (0 < iVar2) {
            do {
              uVar3 = (uint)uVar12;
              if (local_258[uVar7] - 0x591 < 100) {
                uVar10 = 0x200e;
                uVar13 = 0x200f;
                break;
              }
              uVar3 = uVar3 + 1;
              uVar7 = uVar7 + 1;
              uVar12 = (ulonglong)uVar3;
              uVar10 = 0x200f;
              uVar13 = 0x200e;
            } while ((longlong)uVar7 < lVar4);
          }
          if (((uVar15 & 0x20) != (uint)((int)uVar3 < iVar2)) && (0 < iVar2)) {
            do {
              if (local_258[uVar6] == uVar10) {
                local_258[uVar6] = uVar13;
              }
              uVar6 = uVar6 + 1;
            } while ((longlong)uVar6 < lVar4);
          }
        }
LAB_18000a9e9:
        uVar15 = FUN_18000b370(local_338,lVar4,(longlong)local_258);
        if (-1 < (int)uVar15) goto LAB_18000aa04;
        uVar8 = 0xe;
        goto LAB_18002df61;
      }
    }
LAB_18002df5c:
    uVar8 = 0x57;
  }
LAB_18002df61:
  RtlSetLastWin32Error(uVar8);
LAB_18000aa04:
  __security_check_cookie(local_58 ^ (ulonglong)auStackY936);
  return;
}



void FUN_18000ab54(ushort *param_1,uint param_2,ushort *param_3,ushort *param_4,ushort *param_5,
                  uint param_6,longlong param_7,int param_8,uint param_9,int param_10)

{
  bool bVar1;
  int iVar2;
  undefined8 uVar3;
  undefined7 extraout_var;
  short *psVar4;
  ulonglong uVar5;
  undefined7 extraout_var_00;
  longlong lVar6;
  undefined7 extraout_var_01;
  undefined7 extraout_var_02;
  short *psVar7;
  undefined7 extraout_var_03;
  ushort uVar8;
  longlong *****ppppplVar9;
  ushort *puVar10;
  longlong *****ppppplVar11;
  longlong *****ppppplVar12;
  longlong *****ppppplVar13;
  uint uVar14;
  uint uVar15;
  longlong *****ppppplVar16;
  undefined auStackY216 [32];
  ushort *local_98;
  longlong *****local_90;
  uint local_88;
  ushort local_84;
  longlong *****local_80;
  uint local_78;
  ushort *local_70;
  ushort *local_68;
  ushort *local_60;
  short local_58 [12];
  ulonglong local_40;
  
  local_40 = DAT_1800b2220 ^ (ulonglong)auStackY216;
  ppppplVar11 = (longlong *****)0x0;
  uVar8 = *param_4;
  local_80 = (longlong *****)0x0;
  local_88 = 0;
  local_90 = (longlong *****)0x100;
  local_78 = param_2;
  local_70 = param_3;
  ppppplVar13 = ppppplVar11;
  ppppplVar16 = ppppplVar11;
  ppppplVar9 = ppppplVar11;
  ppppplVar12 = (longlong *****)(ulonglong)param_2;
  local_60 = param_5;
  local_98 = param_5;
  do {
    local_68 = param_1;
    if (uVar8 == 0) {
      *local_98 = 0;
LAB_18000ad35:
      __security_check_cookie(local_40 ^ (ulonglong)auStackY216);
      return;
    }
    if (uVar8 == 0x27) {
      uVar3 = FUN_18000afcc(&local_98,(ulonglong)ppppplVar12,(ulonglong *)&local_90);
      if ((int)uVar3 == 0) goto LAB_18000ad35;
      puVar10 = param_4 + 1;
      uVar8 = *puVar10;
      if (uVar8 == 0x5d1) {
        ppppplVar12 = (longlong *****)0x3ff;
        if (((((*param_1 & 0x3ff) == 0xd) || (param_6 == 8)) && (param_4[2] == 0x27)) &&
           (param_4[3] == 0x4d)) {
          ppppplVar11 = (longlong *****)0x1;
          local_88 = 1;
          goto LAB_18000ad97;
        }
      }
      else {
        ppppplVar11 = (longlong *****)(ulonglong)local_88;
LAB_18000ad97:
        if (uVar8 == 0) goto LAB_18000ad0f;
      }
      do {
        param_4 = puVar10;
        if (uVar8 == 0x27) {
          param_4 = param_4 + 1;
          if (*param_4 != 0x27) break;
          if (local_90 < (longlong *****)0x2) goto LAB_18000ad35;
          *local_98 = 0x27;
        }
        else {
          if (local_90 < (longlong *****)0x2) goto LAB_18000ad35;
          *local_98 = uVar8;
        }
        param_4 = param_4 + 1;
        ppppplVar12 = (longlong *****)((longlong)local_90 + -1);
        local_98 = local_98 + 1;
        uVar8 = *param_4;
        puVar10 = param_4;
        local_90 = ppppplVar12;
      } while (uVar8 != 0);
LAB_18000ad0b:
      ppppplVar11 = (longlong *****)(ulonglong)local_88;
      puVar10 = param_4;
    }
    else {
      if (uVar8 == 100) {
        uVar3 = FUN_18000afcc(&local_98,(ulonglong)ppppplVar12,(ulonglong *)&local_90);
        ppppplVar9 = (longlong *****)0x0;
        if ((int)uVar3 != 0) {
          param_4 = param_4 + 1;
          uVar14 = 0;
          ppppplVar13 = ppppplVar9;
          if (*param_4 == 100) {
            do {
              param_4 = param_4 + 1;
              uVar14 = (int)ppppplVar13 + 1;
              ppppplVar13 = (longlong *****)(ulonglong)uVar14;
            } while (*param_4 == 100);
            if ((int)uVar14 < 0) {
LAB_18000aecb:
              if (*(int *)(param_7 + 0x18) == 0) {
                uVar14 = *(uint *)(*(longlong *)(param_1 + 0x10) + 0xbc);
LAB_18000aee2:
                lVar6 = *(longlong *)(param_1 + 0x14);
              }
              else {
                lVar6 = KernelBaseGetGlobalData();
                uVar14 = *(uint *)(param_7 + 0x18);
                lVar6 = *(longlong *)(lVar6 + 0x58);
              }
            }
            else {
              if ((int)uVar14 < 2) goto LAB_18000acd1;
              if (uVar14 != 2) goto LAB_18000aecb;
              if (*(int *)(param_7 + 0x1c) == 0) {
                uVar14 = *(uint *)(*(longlong *)(param_1 + 0x10) + 0xc0);
                goto LAB_18000aee2;
              }
              lVar6 = KernelBaseGetGlobalData();
              uVar14 = *(uint *)(param_7 + 0x1c);
              lVar6 = *(longlong *)(lVar6 + 0x58);
            }
            psVar7 = (short *)FUN_180009624(lVar6,uVar14,(uint)param_3[2]);
LAB_18000aef3:
            ppppplVar12 = (longlong *****)&local_90;
            bVar1 = FUN_18000b0f4((short **)&local_98,(longlong *)ppppplVar12,psVar7);
            iVar2 = (int)CONCAT71(extraout_var,bVar1);
          }
          else {
LAB_18000acd1:
            ppppplVar9 = (longlong *****)0x1;
            if (param_6 == 8) {
              iVar2 = FUN_18004b5c0((uint)param_3[3],local_58);
              if (iVar2 != 0) {
                psVar7 = local_58;
                goto LAB_18000aef3;
              }
              goto LAB_18000ad35;
            }
            iVar2 = FUN_18000b018((ulonglong)param_3[3],ppppplVar12,uVar14 + 1,(short **)&local_98,
                                  (longlong *)&local_90);
          }
LAB_18000acf7:
          if (iVar2 != 0) goto LAB_18000ad0b;
        }
        goto LAB_18000ad35;
      }
      if (uVar8 == 0x4d) {
        uVar14 = 0;
        while (param_4 = param_4 + 1, *param_4 == 0x4d) {
          uVar14 = uVar14 + 1;
        }
        if ((int)ppppplVar11 == 0) {
          uVar3 = FUN_18000afcc(&local_98,(ulonglong)ppppplVar12,(ulonglong *)&local_90);
          if ((int)uVar3 == 0) goto LAB_18000ad35;
        }
        else {
          if (((int)uVar14 < 3) &&
             (uVar3 = FUN_18000afcc(&local_98,(ulonglong)ppppplVar12,(ulonglong *)&local_90),
             ppppplVar13 = ppppplVar12, (int)uVar3 == 0)) goto LAB_18000ad35;
          local_88 = 0;
          ppppplVar12 = ppppplVar13;
        }
        if (uVar14 < 2) {
          if (param_6 == 8) {
            iVar2 = FUN_18004b5c0((uint)local_70[1],local_58);
            if (iVar2 == 0) goto LAB_18000ad35;
            psVar4 = local_58;
LAB_18000af5e:
            ppppplVar12 = (longlong *****)&local_90;
            bVar1 = FUN_18000b0f4((short **)&local_98,(longlong *)ppppplVar12,psVar4);
            iVar2 = (int)CONCAT71(extraout_var_00,bVar1);
          }
          else {
            iVar2 = FUN_18000b018((ulonglong)local_70[1],ppppplVar12,uVar14 + 1,(short **)&local_98,
                                  (longlong *)&local_90);
          }
        }
        else {
          uVar15 = local_70[1] - 1;
          if (*(int *)(param_7 + 0x20) == 0) {
            lVar6 = *(longlong *)(local_68 + 0x10);
            psVar7 = *(short **)(local_68 + 0x14);
            if (uVar14 == 2) {
              psVar4 = (short *)FUN_180009624((longlong)psVar7,*(uint *)(lVar6 + 200),uVar15);
              uVar5 = (ulonglong)*(uint *)(lVar6 + 0xd0);
              if (*(uint *)(lVar6 + 0xd0) != 0) {
                uVar8 = psVar7[uVar5];
                goto LAB_18002e348;
              }
            }
            else {
              psVar4 = (short *)FUN_180009624((longlong)psVar7,*(uint *)(lVar6 + 0xc4),uVar15);
              uVar5 = (ulonglong)*(uint *)(lVar6 + 0xcc);
              if (*(uint *)(lVar6 + 0xcc) != 0) {
                uVar8 = psVar7[uVar5];
LAB_18002e348:
                if (uVar15 < uVar8) {
                  psVar7 = psVar7 + (ulonglong)*(uint *)(psVar7 + uVar5 + (ulonglong)uVar15 * 2 + 1)
                                    + 1;
                  ppppplVar16 = local_80;
                }
              }
            }
            if ((psVar7 != (short *)0x0) && (*psVar7 != 0)) {
              if ((int)ppppplVar9 == 0) {
                uVar8 = *param_4;
                bVar1 = false;
                if (uVar8 != 0) {
                  puVar10 = param_4;
                  do {
                    if (uVar8 != (ushort)((short)ppppplVar9 + 0x27U)) {
                      if (bVar1) goto LAB_18002e396;
                      if ((uVar8 != 0x67) && (uVar8 != 0x79)) {
                        if (uVar8 != 100) goto LAB_18002e396;
                        uVar14 = 0;
                        do {
                          uVar15 = uVar14;
                          puVar10 = puVar10 + 1;
                          uVar14 = uVar15 + 1;
                        } while (*puVar10 == 100);
                        if (uVar15 < 2) goto LAB_18002e3e2;
                      }
                      break;
                    }
                    bVar1 = !bVar1;
LAB_18002e396:
                    puVar10 = puVar10 + 1;
                    uVar8 = *puVar10;
                  } while (uVar8 != 0);
                }
              }
              else {
LAB_18002e3e2:
                psVar4 = psVar7;
              }
            }
            goto LAB_18000af5e;
          }
          if (((param_6 == 8) && (param_10 == 0)) && (5 < (int)uVar15)) {
            uVar15 = (uint)local_70[1];
          }
          lVar6 = KernelBaseGetGlobalData();
          if (uVar14 == 2) {
            uVar14 = *(uint *)(param_7 + 0x24);
          }
          else {
            uVar14 = *(uint *)(param_7 + 0x20);
          }
          psVar7 = (short *)FUN_180009624(*(longlong *)(lVar6 + 0x58),uVar14,uVar15);
          ppppplVar12 = (longlong *****)&local_90;
          bVar1 = FUN_18000b0f4((short **)&local_98,(longlong *)ppppplVar12,psVar7);
          iVar2 = (int)CONCAT71(extraout_var_03,bVar1);
        }
        if (iVar2 != 0) {
          ppppplVar9 = (longlong *****)0x0;
          param_3 = local_70;
          goto LAB_18000ad0b;
        }
        goto LAB_18000ad35;
      }
      if (uVar8 == 0x79) {
        uVar3 = FUN_18000afcc(&local_98,(ulonglong)ppppplVar12,(ulonglong *)&local_90);
        if ((int)uVar3 != 0) {
          param_4 = param_4 + 1;
          uVar14 = 0;
          uVar8 = *param_4;
          while (uVar8 == 0x79) {
            param_4 = param_4 + 1;
            uVar14 = uVar14 + 1;
            uVar8 = *param_4;
          }
          if (((*(int *)(param_7 + 0x14) == 0) && (param_6 != 3)) || (param_8 == 0)) {
            local_84 = *param_3;
          }
          else if (ppppplVar16 == (longlong *****)0x0) {
            lVar6 = KernelBaseGetGlobalData();
            ppppplVar12 = (longlong *****)0x0;
            local_84 = FUN_18004b2d4((longlong *)&local_80,(short *)0x0,param_6,param_7,
                                     *(longlong *)(lVar6 + 0x58),*param_3,param_3[1],param_3[3]);
            ppppplVar16 = local_80;
          }
          uVar8 = local_84;
          if (param_6 == 8) {
            iVar2 = FUN_18004b5c0((uint)local_84,local_58);
            if (iVar2 == 0) goto LAB_18000ad35;
            ppppplVar12 = (longlong *****)&local_90;
            bVar1 = FUN_18000b0f4((short **)&local_98,(longlong *)ppppplVar12,local_58);
            iVar2 = (int)CONCAT71(extraout_var_01,bVar1);
LAB_18000ac8b:
            if (iVar2 == 0) goto LAB_18000ad35;
          }
          else {
            if ((param_6 != 3) || (local_84 != 1)) {
LAB_18000ac64:
              uVar5 = (ulonglong)uVar8;
              if (uVar14 < 2) {
                uVar14 = uVar14 + 1;
                ppppplVar12 = (longlong *****)(uVar5 / 100);
                uVar5 = (ulonglong)((uint)uVar8 + (int)ppppplVar12 * -100);
              }
              else {
                uVar14 = 2;
              }
              iVar2 = FUN_18000b018(uVar5,ppppplVar12,uVar14,(short **)&local_98,
                                    (longlong *)&local_90);
              goto LAB_18000ac8b;
            }
            iVar2 = FUN_18004b530();
            ppppplVar12 = (longlong *****)0x0;
            if ((iVar2 != 0) ||
               ((*param_4 != 0x5e74 && ((*param_4 != 0x27 || (param_4[1] != 0x5e74))))))
            goto LAB_18000ac64;
            if (local_90 == (longlong *****)0x0) goto LAB_18000ad35;
            local_90 = (longlong *****)((longlong)local_90 + -1);
            *local_98 = 0x5143;
            local_98 = local_98 + 1;
          }
          ppppplVar9 = (longlong *****)0x0;
          goto LAB_18000ad0b;
        }
        goto LAB_18000ad35;
      }
      if (uVar8 == 0x67) {
        uVar3 = FUN_18000afcc(&local_98,(ulonglong)ppppplVar12,(ulonglong *)&local_90);
        ppppplVar9 = (longlong *****)0x0;
        if ((int)uVar3 != 0) {
          do {
            param_4 = param_4 + 1;
          } while (*param_4 == 0x67);
          if (param_6 == 1) {
            lVar6 = *(longlong *)(param_1 + 0x14) +
                    (ulonglong)*(uint *)(*(longlong *)(param_1 + 0x10) + 0x108) * 2;
          }
          else {
            if (((*(int *)(param_7 + 0x14) != 0) || (uVar14 = 1, param_6 == 3)) &&
               (uVar14 = param_9, param_8 != 0)) {
              if (ppppplVar16 == (longlong *****)0x0) {
                lVar6 = KernelBaseGetGlobalData();
                local_84 = FUN_18004b2d4((longlong *)&local_80,(short *)0x0,param_6,param_7,
                                         *(longlong *)(lVar6 + 0x58),*param_3,param_3[1],param_3[3])
                ;
                ppppplVar16 = local_80;
                uVar14 = 1;
                if (local_80 == (longlong *****)0x0) goto LAB_18002e227;
              }
              uVar14 = (uint)*(ushort *)((longlong)ppppplVar16 + 2);
            }
LAB_18002e227:
            lVar6 = GetEraNameCountedString(param_6,param_7,uVar14,4);
          }
          ppppplVar12 = (longlong *****)&local_90;
          bVar1 = FUN_18000b0f4((short **)&local_98,(longlong *)ppppplVar12,(short *)(lVar6 + 2));
          iVar2 = (int)CONCAT71(extraout_var_02,bVar1);
          goto LAB_18000acf7;
        }
        goto LAB_18000ad35;
      }
      if (local_90 < (longlong *****)0x2) goto LAB_18000ad35;
      puVar10 = param_4 + 1;
      local_90 = (longlong *****)((longlong)local_90 + -1);
      *local_98 = uVar8;
      ppppplVar12 = ppppplVar13;
      local_98 = local_98 + 1;
    }
LAB_18000ad0f:
    uVar8 = *puVar10;
    param_1 = local_68;
    param_4 = puVar10;
    ppppplVar13 = ppppplVar12;
    ppppplVar12 = (longlong *****)(ulonglong)local_78;
  } while( true );
}



undefined8 FUN_18000afcc(ushort **param_1,ulonglong param_2,ulonglong *param_3)

{
  ulonglong uVar1;
  ushort *puVar2;
  
  if ((param_2 & 0x30) != 0) {
    uVar1 = *param_3;
    if (uVar1 < 2) {
      return 0;
    }
    puVar2 = *param_1;
    *puVar2 = (ushort)(param_2 >> 5) & 1 | 0x200e;
    *param_1 = puVar2 + 1;
    *param_3 = uVar1 - 1;
  }
  return 1;
}



void FUN_18000b018(undefined8 param_1,undefined8 param_2,uint param_3,short **param_4,
                  longlong *param_5)

{
  int iVar1;
  longlong lVar2;
  uint uVar3;
  undefined auStack200 [32];
  uint local_a8;
  short *local_a0;
  short local_98 [64];
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack200;
  local_a0 = local_98;
  local_a8 = 0x800080;
  iVar1 = RtlIntegerToUnicodeString(param_1,10);
  if (-1 < iVar1) {
    uVar3 = local_a8 >> 1 & 0x7fff;
    if (uVar3 < param_3) {
      lVar2 = *param_5;
      do {
        if (lVar2 == 0) break;
        uVar3 = uVar3 + 1;
        **param_4 = 0x30;
        *param_4 = *param_4 + 1;
        *param_5 = *param_5 + -1;
        lVar2 = *param_5;
      } while (uVar3 < param_3);
    }
    FUN_18000b0f4(param_4,param_5,local_a0);
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack200);
  return;
}



bool FUN_18000b0f4(short **param_1,longlong *param_2,short *param_3)

{
  uint uVar1;
  
  uVar1 = FUN_18000b120(*param_1,*param_2,param_3,param_1,param_2);
  return -1 < (int)uVar1;
}



uint FUN_18000b120(short *param_1,longlong param_2,short *param_3,short **param_4,longlong *param_5)

{
  uint uVar1;
  longlong local_18 [2];
  
  uVar1 = 0;
  if (0x7ffffffe < param_2 - 1U) {
    uVar1 = 0x80070057;
  }
  if ((int)uVar1 < 0) {
    if (param_2 != 0) {
      *param_1 = 0;
    }
  }
  else {
    uVar1 = 0;
    if (param_2 == 0) {
      if (*param_3 != 0) {
        if (param_1 == (short *)0x0) {
          return 0x80070057;
        }
        uVar1 = 0x8007007a;
      }
    }
    else {
      local_18[0] = 0;
      uVar1 = FUN_18000b1d8(param_1,param_2,local_18,(longlong)param_3);
      param_2 = param_2 - local_18[0];
      param_1 = param_1 + local_18[0];
      if (((uVar1 + 0x80000000 & 0x80000000) == 0) && (uVar1 != 0x8007007a)) {
        return uVar1;
      }
    }
    if (param_4 != (short **)0x0) {
      *param_4 = param_1;
    }
    if (param_5 != (longlong *)0x0) {
      *param_5 = param_2;
    }
  }
  return uVar1;
}



uint FUN_18000b1d8(short *param_1,longlong param_2,longlong *param_3,longlong param_4)

{
  short sVar1;
  longlong lVar2;
  short *psVar3;
  longlong lVar4;
  longlong lVar5;
  
  lVar5 = 0;
  if (param_2 != 0) {
    lVar2 = 0x7ffffffe;
    lVar4 = param_4 - (longlong)param_1;
    do {
      if ((lVar2 == 0) || (sVar1 = *(short *)(lVar4 + (longlong)param_1), sVar1 == 0)) break;
      *param_1 = sVar1;
      lVar2 = lVar2 + -1;
      param_1 = param_1 + 1;
      lVar5 = lVar5 + 1;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
  }
  psVar3 = param_1 + -1;
  if (param_2 != 0) {
    psVar3 = param_1;
  }
  *psVar3 = 0;
  if (param_3 != (longlong *)0x0) {
    lVar2 = lVar5 + -1;
    if (param_2 != 0) {
      lVar2 = lVar5;
    }
    *param_3 = lVar2;
  }
  return ~-(uint)(param_2 != 0) & 0x8007007a;
}



void FUN_18000b254(undefined2 *param_1)

{
  char cVar1;
  undefined auStack72 [32];
  undefined local_28 [8];
  undefined2 local_20;
  undefined2 local_1e;
  undefined2 local_1c;
  undefined8 local_1a;
  undefined2 local_12;
  ulonglong local_10;
  
  local_10 = DAT_1800b2220 ^ (ulonglong)auStack72;
  local_20 = *param_1;
  local_1e = param_1[1];
  local_1c = param_1[3];
  local_1a = 0;
  cVar1 = RtlTimeFieldsToTime(&local_20,local_28);
  if (cVar1 != '\0') {
    RtlTimeToTimeFields(local_28,&local_20);
    param_1[2] = local_12;
  }
  __security_check_cookie(local_10 ^ (ulonglong)auStack72);
  return;
}



uint FUN_18000b2f4(longlong param_1,uint param_2)

{
  ushort *puVar1;
  int iVar2;
  ushort *puVar3;
  uint local_res18 [4];
  
  iVar2 = NlsIsUserDefaultLocale();
  if ((((iVar2 != 0) && (param_2 != 0)) &&
      (iVar2 = GetLocaleInfoHelper(param_1,0x20001009,local_res18,2), iVar2 != 0)) &&
     (local_res18[0] == param_2)) {
    return param_2 & 0xffff;
  }
  puVar3 = (ushort *)
           (*(longlong *)(param_1 + 0x28) +
           (ulonglong)*(uint *)(*(longlong *)(param_1 + 0x20) + 0x7c) * 2);
  puVar1 = puVar3 + *puVar3;
  do {
    puVar3 = puVar3 + 1;
    if (puVar1 < puVar3) {
      return 0;
    }
  } while (param_2 != *puVar3);
  return (uint)*puVar3;
}



uint FUN_18000b370(short *param_1,longlong param_2,longlong param_3)

{
  short sVar1;
  short *psVar2;
  longlong lVar3;
  uint uVar4;
  longlong lVar5;
  
  uVar4 = 0;
  if (0x7ffffffe < param_2 - 1U) {
    uVar4 = 0x80070057;
  }
  if ((int)uVar4 < 0) {
    if (param_2 != 0) {
      *param_1 = 0;
    }
  }
  else {
    if (param_2 != 0) {
      lVar5 = 0x7ffffffe - param_2;
      lVar3 = param_3 - (longlong)param_1;
      do {
        if ((lVar5 + param_2 == 0) || (sVar1 = *(short *)(lVar3 + (longlong)param_1), sVar1 == 0))
        break;
        *param_1 = sVar1;
        param_1 = param_1 + 1;
        param_2 = param_2 + -1;
      } while (param_2 != 0);
    }
    psVar2 = param_1 + -1;
    if (param_2 != 0) {
      psVar2 = param_1;
    }
    uVar4 = ~-(uint)(param_2 != 0) & 0x8007007a;
    *psVar2 = 0;
  }
  return uVar4;
}



undefined8 FUN_18000b3f4(void)

{
  int iVar1;
  bool bVar2;
  ulonglong local_res8 [4];
  undefined local_48 [16];
  undefined4 local_38 [2];
  undefined8 local_30;
  undefined *local_28;
  undefined4 local_20;
  undefined local_18 [16];
  
  if (DAT_1800b2d18 == 0) {
    RtlInitUnicodeString
              (local_48,
               L"\\Registry\\Machine\\System\\CurrentControlSet\\Control\\Nls\\Sorting\\Ids");
    local_30 = 0;
    local_28 = local_48;
    local_38[0] = 0x30;
    local_20 = 0x40;
    local_18 = ZEXT816(0);
    iVar1 = NtOpenKey(local_res8,0x20019,local_38);
    if (iVar1 < 0) {
      SetLastError(0x3f1);
      return 0;
    }
    LOCK();
    bVar2 = DAT_1800b2d18 == 0;
    DAT_1800b2d18 = DAT_1800b2d18 ^ (ulonglong)bVar2 * (DAT_1800b2d18 ^ local_res8[0]);
    if (!bVar2) {
      NtClose(local_res8[0]);
    }
  }
  return 1;
}



void FUN_18000b49c(longlong *param_1)

{
  WCHAR WVar1;
  uint uVar2;
  uint *puVar3;
  bool bVar4;
  ushort uVar5;
  undefined6 extraout_var_00;
  longlong lVar6;
  WCHAR *pWVar7;
  ulonglong uVar8;
  undefined7 extraout_var;
  undefined8 uVar9;
  WCHAR *pWVar10;
  longlong lVar11;
  longlong lVar12;
  undefined auStack600 [32];
  uint *local_238 [2];
  WCHAR local_228 [264];
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack600;
  local_238[0] = (uint *)0x0;
  memset(local_228,0,0x208);
  uVar5 = FUN_18000b908(local_228,0x104);
  if ((int)CONCAT62(extraout_var_00,uVar5) - 1U < 0x103) {
    lVar6 = 0x104;
    pWVar10 = local_228;
    do {
      if (*pWVar10 == L'\0') break;
      pWVar10 = pWVar10 + 1;
      lVar6 = lVar6 + -1;
    } while (lVar6 != 0);
    if (lVar6 != 0) {
      lVar11 = -lVar6 + 0x104;
      pWVar10 = local_228 + lVar11;
      lVar11 = 0x104 - lVar11;
      if (lVar11 != 0) {
        lVar6 = -lVar6 + 0x7ffffffe + lVar11;
        lVar12 = (longlong)L"\\Globalization\\Sorting\\" - (longlong)pWVar10;
        do {
          if ((lVar6 == 0) || (WVar1 = *(WCHAR *)(lVar12 + (longlong)pWVar10), WVar1 == L'\0'))
          break;
          *pWVar10 = WVar1;
          lVar6 = lVar6 + -1;
          pWVar10 = pWVar10 + 1;
          lVar11 = lVar11 + -1;
        } while (lVar11 != 0);
      }
      pWVar7 = pWVar10 + -1;
      if (lVar11 != 0) {
        pWVar7 = pWVar10;
      }
      *pWVar7 = L'\0';
      if (((lVar11 != 0) &&
          (uVar8 = FUN_18000b638(local_228,0x104,(longlong)L"sortdefault.nls"), -1 < (int)uVar8)) &&
         (bVar4 = FUN_18000b820(local_228,local_238), puVar3 = local_238[0],
         (int)CONCAT71(extraout_var,bVar4) != 0)) {
        param_1[0x10] = (longlong)local_238[0];
        uVar9 = FUN_18000b714((longlong)param_1,
                              (undefined4 *)((ulonglong)local_238[0][3] + (longlong)local_238[0]));
        if ((int)uVar9 == 0) {
          SetLastError(0x3eb);
        }
        else {
          param_1[5] = (ulonglong)*puVar3 + (longlong)puVar3;
          *param_1 = (ulonglong)puVar3[1] + (longlong)puVar3;
          uVar2 = puVar3[2];
          param_1[10] = (longlong)puVar3 + (ulonglong)uVar2 + 4;
          param_1[0xb] = (longlong)puVar3 +
                         (ulonglong)*(ushort *)((longlong)puVar3 + (ulonglong)uVar2 + 2) +
                         (ulonglong)uVar2 + 2;
        }
      }
    }
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack600);
  return;
}



ulonglong FUN_18000b638(short *param_1,longlong param_2,longlong param_3)

{
  short sVar1;
  short *psVar2;
  short *psVar3;
  longlong lVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  longlong lVar7;
  longlong lVar8;
  
  uVar5 = 0;
  uVar6 = uVar5;
  if (0x7ffffffe < param_2 - 1U) {
    uVar6 = 0x80070057;
  }
  if (-1 < (int)uVar6) {
    psVar2 = param_1;
    lVar4 = param_2;
    if (param_2 != 0) {
      do {
        if (*psVar2 == 0) break;
        psVar2 = psVar2 + 1;
        lVar4 = lVar4 + -1;
      } while (lVar4 != 0);
    }
    uVar6 = (ulonglong)(~-(uint)(lVar4 != 0) & 0x80070057);
    if (lVar4 != 0) {
      uVar5 = param_2 - lVar4;
    }
  }
  if (-1 < (int)uVar6) {
    psVar2 = param_1 + uVar5;
    lVar4 = param_2 - uVar5;
    if (lVar4 != 0) {
      lVar7 = uVar5 + 0x7ffffffe + (lVar4 - param_2);
      lVar8 = param_3 - (longlong)psVar2;
      do {
        if ((lVar7 == 0) || (sVar1 = *(short *)(lVar8 + (longlong)psVar2), sVar1 == 0)) break;
        *psVar2 = sVar1;
        lVar7 = lVar7 + -1;
        psVar2 = psVar2 + 1;
        lVar4 = lVar4 + -1;
      } while (lVar4 != 0);
    }
    psVar3 = psVar2 + -1;
    if (lVar4 != 0) {
      psVar3 = psVar2;
    }
    uVar6 = (ulonglong)(~-(uint)(lVar4 != 0) & 0x8007007a);
    *psVar3 = 0;
  }
  return uVar6;
}



undefined8 FUN_18000b714(longlong param_1,undefined4 *param_2)

{
  uint *puVar1;
  ushort *puVar2;
  ushort uVar3;
  uint uVar4;
  uint uVar5;
  ulonglong uVar6;
  uint *puVar7;
  
  *(undefined4 *)(param_1 + 0x78) = *param_2;
  uVar4 = param_2[1];
  if (uVar4 != 0) {
    *(uint *)(param_1 + 8) = uVar4;
    *(undefined4 **)(param_1 + 0x30) = param_2 + 2;
  }
  uVar5 = param_2[(ulonglong)uVar4 * 9 + 2];
  if (uVar5 != 0) {
    *(uint *)(param_1 + 0xc) = uVar5;
    *(undefined4 **)(param_1 + 0x38) = param_2 + (ulonglong)uVar4 * 9 + 3;
  }
  puVar1 = param_2 + (ulonglong)uVar4 * 9 + (ulonglong)uVar5 + 3;
  uVar4 = *puVar1;
  puVar7 = puVar1 + 1;
  if (uVar4 != 0) {
    *(uint *)(param_1 + 0x10) = uVar4;
    *(uint **)(param_1 + 0x40) = puVar7;
    *(uint **)(param_1 + 0x48) = puVar1 + (ulonglong)uVar4 * 6 + 1;
    uVar6 = (ulonglong)(uVar4 - 1);
    puVar7 = (uint *)((longlong)(puVar1 + (ulonglong)uVar4 * 6 + 1) +
                     (((ulonglong)*(ushort *)(puVar1 + uVar6 * 6 + 6) +
                      (ulonglong)*(ushort *)((longlong)puVar1 + uVar6 * 0x18 + 0x16)) * 10 +
                      ((ulonglong)*(ushort *)(puVar1 + uVar6 * 6 + 3) +
                      ((ulonglong)*(ushort *)(puVar1 + uVar6 * 6 + 5) +
                      (ulonglong)*(ushort *)((longlong)puVar1 + uVar6 * 0x18 + 0x12)) * 2) * 4 +
                      ((ulonglong)*(ushort *)(puVar1 + uVar6 * 6 + 4) +
                      (ulonglong)*(ushort *)((longlong)puVar1 + uVar6 * 0x18 + 0xe)) * 6 +
                     (ulonglong)puVar7[uVar6 * 6]) * 2);
  }
  uVar3 = *(ushort *)puVar7;
  if (uVar3 != 0) {
    *(uint *)(param_1 + 0x18) = (uint)uVar3;
    *(uint **)(param_1 + 0x60) = puVar7 + 1;
  }
  puVar2 = (ushort *)((longlong)puVar7 + ((ulonglong)uVar3 + 2) * 2);
  uVar3 = *puVar2;
  if (uVar3 != 0) {
    *(uint *)(param_1 + 0x1c) = (uint)uVar3;
    *(ushort **)(param_1 + 0x68) = puVar2 + 2;
  }
  if (puVar2[(ulonglong)uVar3 * 4 + 2] != 0) {
    *(uint *)(param_1 + 0x20) = (uint)puVar2[(ulonglong)uVar3 * 4 + 2];
    *(ushort **)(param_1 + 0x70) = puVar2 + ((ulonglong)uVar3 + 1) * 4;
  }
  return 1;
}



bool FUN_18000b820(LPCWSTR param_1,LPVOID *param_2)

{
  HANDLE hFile;
  HANDLE hFileMappingObject;
  LPVOID pvVar1;
  
  hFile = CreateFileW(param_1,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0x0);
  if (hFile != (HANDLE)0xffffffffffffffff) {
    hFileMappingObject = CreateFileMappingW(hFile,(LPSECURITY_ATTRIBUTES)0x0,2,0,0,(LPCWSTR)0x0);
    if (hFileMappingObject != (HANDLE)0x0) {
      pvVar1 = MapViewOfFile(hFileMappingObject,4,0,0,0);
      if (pvVar1 != (LPVOID)0x0) {
        *param_2 = pvVar1;
      }
      CloseHandle(hFileMappingObject);
      CloseHandle(hFile);
      return pvVar1 != (LPVOID)0x0;
    }
    CloseHandle(hFile);
  }
  return false;
}



ushort FUN_18000b908(void *param_1,int param_2)

{
  ushort uVar1;
  longlong lVar2;
  ulonglong _Size;
  
  lVar2 = KernelBaseGetGlobalData();
  _Size = (ulonglong)*(ushort *)(lVar2 + 8);
  uVar1 = *(ushort *)(lVar2 + 8) >> 1;
  if ((ulonglong)(uint)(param_2 * 2) < _Size + 2) {
    uVar1 = uVar1 + 1;
  }
  else {
    lVar2 = KernelBaseGetGlobalData();
    memcpy(param_1,*(void **)(lVar2 + 0x10),_Size);
    *(undefined2 *)((longlong)param_1 + (_Size & 0xfffffffffffffffe)) = 0;
  }
  return uVar1;
}



ulonglong FUN_18000b98c(short *param_1,short *param_2,short *param_3,longlong param_4)

{
  uint uVar1;
  uint uVar2;
  ulonglong uVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  short *psVar6;
  short *psVar7;
  longlong local_res20;
  longlong local_38 [2];
  
  uVar4 = 0;
  local_38[0] = 0;
  local_res20 = 0;
  if (param_4 == 0) {
    return 0xc0000023;
  }
  psVar6 = param_2;
  uVar1 = FUN_18000ed58(param_1,param_2,local_38);
  uVar5 = (ulonglong)uVar1;
  if ((int)uVar1 < 0) goto LAB_18002e565;
  uVar1 = FUN_18000ed58(psVar6,param_2,&local_res20);
  uVar5 = (ulonglong)uVar1;
  if ((int)uVar1 < 0) goto LAB_18002e565;
  if (local_38[0] == 0) {
    param_1 = psVar6;
    if (local_res20 == 0) {
      *param_3 = 0;
      return 0;
    }
LAB_18002e556:
    uVar1 = FUN_18000ecd4(param_3,param_4,(longlong)param_1);
    uVar4 = (ulonglong)uVar1;
  }
  else {
    if (local_res20 == 0) goto LAB_18002e556;
    uVar1 = (param_1[local_38[0] + -1] == 0x5c) + 1;
    if (*psVar6 != 0x5c) {
      uVar1 = (uint)(param_1[local_38[0] + -1] == 0x5c);
    }
    psVar7 = psVar6 + 1;
    if (uVar1 < 2) {
      psVar7 = psVar6;
    }
    uVar2 = FUN_18000ecd4(param_3,param_4,(longlong)param_1);
    uVar5 = (ulonglong)uVar2;
    if ((int)uVar2 < 0) goto LAB_18002e565;
    uVar2 = uVar1 - 1;
    if (uVar1 < 2) {
      uVar2 = uVar1;
    }
    if (uVar2 == 0) {
      uVar3 = FUN_18000bab4(param_3,param_4,(longlong)&DAT_180085358);
      uVar5 = uVar3 & 0xffffffff;
      if ((int)uVar3 < 0) goto LAB_18002e565;
    }
    uVar3 = FUN_18000bab4(param_3,param_4,(longlong)psVar7);
    uVar5 = uVar3 & 0xffffffff;
    if ((int)uVar3 < 0) goto LAB_18002e565;
  }
  uVar5 = uVar4;
  if (-1 < (int)uVar4) {
    return uVar4;
  }
LAB_18002e565:
  FUN_18001188c(1,0xb8,0x6c,0x98,(char)uVar5);
  return uVar5;
}



ulonglong FUN_18000bab4(short *param_1,longlong param_2,longlong param_3)

{
  short sVar1;
  short *psVar2;
  short *psVar3;
  longlong lVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  longlong lVar7;
  longlong lVar8;
  
  uVar5 = 0;
  uVar6 = uVar5;
  if (0x7ffffffe < param_2 - 1U) {
    uVar6 = 0xc000000d;
  }
  if (-1 < (int)uVar6) {
    psVar2 = param_1;
    lVar4 = param_2;
    if (param_2 != 0) {
      do {
        if (*psVar2 == 0) break;
        psVar2 = psVar2 + 1;
        lVar4 = lVar4 + -1;
      } while (lVar4 != 0);
    }
    uVar6 = (ulonglong)(~-(uint)(lVar4 != 0) & 0xc000000d);
    if (lVar4 != 0) {
      uVar5 = param_2 - lVar4;
    }
  }
  if (-1 < (int)uVar6) {
    psVar2 = param_1 + uVar5;
    lVar4 = param_2 - uVar5;
    if (lVar4 != 0) {
      lVar7 = uVar5 + 0x7ffffffe + (lVar4 - param_2);
      lVar8 = param_3 - (longlong)psVar2;
      do {
        if ((lVar7 == 0) || (sVar1 = *(short *)(lVar8 + (longlong)psVar2), sVar1 == 0)) break;
        *psVar2 = sVar1;
        lVar7 = lVar7 + -1;
        psVar2 = psVar2 + 1;
        lVar4 = lVar4 + -1;
      } while (lVar4 != 0);
    }
    psVar3 = psVar2 + -1;
    if (lVar4 != 0) {
      psVar3 = psVar2;
    }
    uVar6 = (ulonglong)(~-(uint)(lVar4 != 0) & 0x80000005);
    *psVar3 = 0;
  }
  return uVar6;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint FUN_18000bb90(undefined2 *param_1,undefined2 *param_2,ulonglong param_3,uint param_4,
                  uint *param_5,uint param_6)

{
  undefined8 *puVar1;
  longlong lVar2;
  longlong lVar3;
  ulonglong uVar4;
  byte **ppbVar5;
  ulonglong uVar6;
  uint *puVar7;
  uint uVar8;
  longlong in_GS_OFFSET;
  bool bVar9;
  uint in_stack_ffffffffffffffc0;
  ushort local_38 [2];
  undefined4 local_34;
  longlong local_30;
  
  local_30 = 0;
  lVar3 = 0;
  if ((DAT_1800b2d98 == 0) && (uVar8 = FUN_1800093c4(), (int)uVar8 < 0)) {
    return uVar8 | 0x10000000;
  }
  uVar6 = (ulonglong)param_6;
  uVar8 = 0;
  if (param_6 != 0) {
    uVar4 = (ulonglong)DAT_1800b230c;
    puVar7 = param_5;
    do {
      lVar3 = FUN_18000bde0(DAT_1800b2d98,*puVar7);
      if (lVar3 == 0) {
        return 0x80070490;
      }
      if ((*(ulonglong *)(lVar3 + 0x10c) & (ulonglong)param_4) == 0) {
        bVar9 = false;
      }
      else if ((int)uVar4 == -1) {
        bVar9 = param_3 < *(ulonglong *)(lVar3 + 0x104);
      }
      else {
        bVar9 = (int)uVar4 != 0;
      }
      puVar1 = (undefined8 *)(puVar7 + 2);
      uVar8 = uVar8 + 1;
      puVar7 = puVar7 + 4;
      *(bool *)*puVar1 = bVar9;
    } while (uVar8 < param_6);
  }
  uVar8 = 0;
  FUN_18000d244(0,0,_DAT_7ffe026a,(short *)local_38);
  uVar4 = FUN_18000d28c(&local_30,&local_34,param_1,param_3,local_38[0],
                        in_stack_ffffffffffffffc0 & uVar8);
  lVar2 = local_30;
  if ((int)(uint)uVar4 < 0) {
    uVar8 = (uint)uVar4 | 0x10000000;
  }
  else if ((local_30 == 0) ||
          (uVar8 = FUN_180010e78(local_30,(ulonglong)local_38[0],(int *)param_5,param_6),
          -1 < (int)uVar8)) {
    if (param_6 != 0) {
      ppbVar5 = (byte **)(param_5 + 2);
      do {
        FUN_18000bd38(lVar3,(uint)**ppbVar5,(HANDLE)0x0,param_1,param_2);
        ppbVar5 = ppbVar5 + 2;
        uVar6 = uVar6 - 1;
      } while (uVar6 != 0);
    }
    uVar8 = 0;
  }
  if (lVar2 != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_30);
  }
  return uVar8;
}



void FUN_18000bd38(longlong param_1,undefined4 param_2,HANDLE param_3,undefined2 *param_4,
                  undefined2 *param_5)

{
  char cVar1;
  int iVar2;
  HANDLE pvVar3;
  longlong lVar4;
  longlong lVar5;
  bool bVar6;
  undefined4 local_res10 [6];
  undefined auStack504 [32];
  undefined2 local_1d8 [2];
  undefined4 local_1d4;
  DWORD local_1d0;
  uint local_1cc;
  DWORD *local_1c8;
  undefined8 local_1c0;
  longlong local_1b8;
  undefined8 local_1b0;
  longlong local_1a8;
  int local_1a0;
  undefined4 local_19c;
  longlong local_198;
  int local_190;
  undefined4 local_18c;
  undefined4 *local_188;
  undefined8 local_180;
  uint *local_178;
  undefined8 local_170;
  undefined2 *local_168;
  int local_160;
  undefined4 local_15c;
  undefined2 *local_158;
  int local_150;
  undefined4 local_14c;
  undefined2 local_148 [128];
  ulonglong local_48;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStack504;
  local_res10[0] = param_2;
  pvVar3 = GetCurrentProcess();
  bVar6 = param_3 == pvVar3;
  if ((DAT_1800b2d88 == 0) ||
     (((bVar6 && ((*(byte *)(param_1 + 0x228) & 0x10) != 0)) ||
      (cVar1 = EtwEventEnabled(), cVar1 == '\0')))) goto LAB_18000bdb8;
  if (param_3 == (HANDLE)0x0) {
LAB_18002e61d:
    if (param_4 == (undefined2 *)0x0) {
LAB_18002e622:
      param_4 = local_1d8;
    }
  }
  else if (param_4 == (undefined2 *)0x0) {
    local_1d4 = 0x80;
    memset(local_148,0,0x100);
    if (bVar6) {
      iVar2 = GetCurrentPackageFullName(&local_1d4,local_148);
    }
    else {
      iVar2 = GetPackageFullName(param_3,&local_1d4,local_148);
    }
    if (iVar2 == 0) {
      param_4 = local_148;
      goto LAB_18002e61d;
    }
    goto LAB_18002e622;
  }
  local_158 = local_1d8;
  if (param_5 != (undefined2 *)0x0) {
    local_158 = param_5;
  }
  if (param_3 == (HANDLE)0x0) {
    local_1d0 = 0;
  }
  else {
    local_1d0 = GetProcessId(param_3);
  }
  local_1d8[0] = 0;
  local_1cc = (uint)((*(byte *)(param_1 + 0x228) & 3) != 0);
  lVar5 = -1;
  local_1c0 = 4;
  local_1c8 = &local_1d0;
  local_1b8 = param_1 + 0x114;
  lVar4 = -1;
  local_1b0 = 4;
  local_1a8 = param_1;
  do {
    lVar4 = lVar4 + 1;
  } while (*(short *)(param_1 + lVar4 * 2) != 0);
  local_19c = 0;
  local_1a0 = (int)lVar4 * 2 + 2;
  lVar4 = -1;
  local_198 = param_1 + 0x128;
  do {
    lVar4 = lVar4 + 1;
  } while (*(short *)(param_1 + 0x128 + lVar4 * 2) != 0);
  local_18c = 0;
  local_190 = (int)lVar4 * 2 + 2;
  local_188 = local_res10;
  local_178 = &local_1cc;
  lVar4 = -1;
  local_180 = 1;
  local_170 = 1;
  local_168 = param_4;
  do {
    lVar4 = lVar4 + 1;
  } while (param_4[lVar4] != 0);
  local_15c = 0;
  local_160 = (int)lVar4 * 2 + 2;
  do {
    lVar5 = lVar5 + 1;
  } while (local_158[lVar5] != 0);
  local_150 = (int)lVar5 * 2 + 2;
  local_14c = 0;
  EtwEventWrite(DAT_1800b2d88,&DAT_180085458,8,&local_1c8);
  if (bVar6) {
    *(uint *)(param_1 + 0x228) = *(uint *)(param_1 + 0x228) | 0x10;
  }
LAB_18000bdb8:
  __security_check_cookie(local_48 ^ (ulonglong)auStack504);
  return;
}



longlong FUN_18000bde0(longlong param_1,uint param_2)

{
  if (((ushort)(param_2 >> 0x10) < *(ushort *)(param_1 + 2)) &&
     ((ushort)param_2 < *(ushort *)(param_1 + 8 + (ulonglong)(param_2 >> 0x10) * 0x10))) {
    return (ulonglong)(param_2 & 0xffff) * 0x22c +
           *(longlong *)(param_1 + 0x10 + (ulonglong)(param_2 >> 0x10) * 0x10) + param_1;
  }
  return 0;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

ulonglong FUN_18000be18(int *param_1,ulonglong param_2)

{
  longlong lVar1;
  short *psVar2;
  uint uVar3;
  int iVar4;
  ulonglong uVar5;
  undefined *puVar6;
  int iVar7;
  ulonglong uVar8;
  int iVar9;
  
  iVar9 = 0;
  if (*(char *)(param_1 + 1) == '\0') {
    iVar9 = param_1[0x24];
  }
  uVar5 = FUN_18000bfc4((longlong)param_1);
  uVar8 = uVar5 & 0xffffffff;
  if (-1 < (int)uVar5) {
    lVar1 = *(longlong *)(param_1 + 4);
    *(ulonglong *)(param_1 + 0x30) =
         (ulonglong)*(uint *)(lVar1 + 0x34) + *(longlong *)(lVar1 + 0x38);
    psVar2 = *(short **)(lVar1 + 0x38);
    *(short **)(param_1 + 0x2c) = psVar2;
    if ((*(char *)(lVar1 + 0x31) != '\0') && ((*psVar2 == -0x101 || (*psVar2 == -2)))) {
      *(short **)(param_1 + 0x2c) = psVar2 + 1;
    }
    iVar7 = *param_1;
    if (iVar7 == 5) {
      uVar5 = BaseDllReadSectionNames((longlong)param_1);
      uVar3 = (uint)uVar5;
LAB_18000beaf:
      uVar8 = (ulonglong)uVar3;
    }
    else {
      if (iVar7 == 1) {
        uVar3 = FUN_180020284((longlong)param_1);
        goto LAB_18000beaf;
      }
      if (iVar7 == 4) {
        uVar5 = BaseDllReadKeywordNames((longlong)param_1);
        uVar3 = (uint)uVar5;
        goto LAB_18000beaf;
      }
      if (iVar7 == 6) {
        puVar6 = FUN_18000f588((longlong)param_1);
        uVar3 = (uint)puVar6;
        goto LAB_18000beaf;
      }
      if (iVar7 - 2U < 2) {
        uVar5 = FUN_180022b0c(param_1,param_2);
        uVar3 = (uint)uVar5;
        goto LAB_18000beaf;
      }
      if (iVar7 - 7U < 2) {
        uVar5 = FUN_1800228d4(param_1);
        uVar3 = (uint)uVar5;
        goto LAB_18000beaf;
      }
      uVar8 = 0xc000000d;
    }
    uVar3 = FUN_18000f1e8((longlong)param_1);
    if (-1 < (int)uVar8) {
      uVar8 = (ulonglong)uVar3;
    }
  }
  uVar5 = RtlGetSuiteMask();
  iVar7 = (int)uVar8;
  if ((uVar5 & 0x10) == 0) goto LAB_18000bf42;
  if (iVar7 < 0) {
    if ((*param_1 - 4U < 3) || (*param_1 == 1)) {
      if (DAT_1800b2ce0 == 0) {
        iVar4 = 0;
      }
      else {
        iVar4 = (*(code *)DAT_1800b2ce0)();
      }
      if (iVar4 != 0) {
        FUN_18000be18(param_1,param_2);
      }
      goto LAB_18000bf42;
    }
    if (iVar7 < 0) goto LAB_18000bf42;
  }
  if ((((*param_1 - 2U < 2) || (*param_1 - 7U < 2)) && (*(char *)(DAT_1800b2bf8 + 0x808) != '\0'))
     && (DAT_1800b2f78 != 0)) {
    (*(code *)DAT_1800b2f78)();
  }
LAB_18000bf42:
  if (((iVar7 == -0x3fffffcc) && (*(char *)(param_1 + 1) == '\0')) && (iVar9 != 0)) {
    uVar8 = 0;
  }
  return uVar8;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

ulonglong FUN_18000bfc4(longlong param_1)

{
  short *psVar1;
  LPCWSTR *ppWVar2;
  ushort **ppuVar3;
  char cVar4;
  DWORD DVar5;
  uint uVar6;
  int iVar7;
  int *piVar8;
  ulonglong uVar9;
  longlong lVar10;
  undefined4 *puVar11;
  size_t sVar12;
  int iVar13;
  ushort *puVar14;
  ulonglong uVar15;
  ulonglong uVar16;
  longlong in_GS_OFFSET;
  undefined8 local_res10;
  undefined8 local_res18;
  LPWSTR local_res20;
  undefined *in_stack_ffffffffffffff28;
  undefined4 uVar18;
  undefined *puVar17;
  undefined8 in_stack_ffffffffffffff30;
  undefined4 uVar20;
  undefined8 *puVar19;
  undefined8 in_stack_ffffffffffffff38;
  undefined4 uVar22;
  undefined8 *puVar21;
  ulonglong in_stack_ffffffffffffff40;
  ulonglong in_stack_ffffffffffffff48;
  ulonglong in_stack_ffffffffffffff50;
  undefined local_98 [8];
  ulonglong local_90;
  undefined local_88 [16];
  undefined4 local_78 [2];
  undefined8 local_70;
  longlong local_68;
  undefined4 local_60;
  undefined local_58 [16];
  
  uVar22 = (undefined4)((ulonglong)in_stack_ffffffffffffff38 >> 0x20);
  uVar20 = (undefined4)((ulonglong)in_stack_ffffffffffffff30 >> 0x20);
  uVar16 = 0;
  psVar1 = (short *)(param_1 + 0x38);
  ppWVar2 = (LPCWSTR *)(param_1 + 0x30);
  *psVar1 = 0;
  if (((*(ushort *)(param_1 + 0x28) < 3) || ((*ppWVar2)[1] != L':')) &&
     ((*(short *)(param_1 + 0x28) == 0 ||
      (sVar12 = wcscspn(*ppWVar2,L"\\/"), sVar12 == *(ushort *)(param_1 + 0x28) >> 1)))) {
    if (DAT_1800b2e40 == 0) {
LAB_18000c499:
      lVar10 = KernelBaseGetGlobalData();
      RtlCopyUnicodeString(psVar1,lVar10 + 8);
      uVar6 = RtlAppendUnicodeToString(psVar1,&DAT_180085358);
      uVar9 = (ulonglong)uVar6;
      if (-1 < (int)uVar6) {
        uVar6 = RtlAppendUnicodeStringToString(psVar1,param_1 + 0x18);
        uVar9 = (ulonglong)uVar6;
      }
    }
    else {
      uVar6 = (*(code *)DAT_1800b2e40)();
      uVar9 = (ulonglong)uVar6;
      if ((int)uVar6 < 0) goto LAB_18000c499;
    }
    if ((int)uVar9 < 0) {
      return uVar9;
    }
  }
  else {
    DVar5 = GetFullPathNameW(*ppWVar2,(uint)(*(ushort *)(param_1 + 0x3a) >> 1),
                             *(LPWSTR *)(param_1 + 0x40),&local_res20);
    if (*(ushort *)(param_1 + 0x3a) >> 1 < DVar5) {
      return 0xc0000023;
    }
    if (DVar5 == 0) {
      return 0xc0000001;
    }
    *psVar1 = (short)DVar5 * 2;
    KernelBaseGetGlobalData();
    if (DAT_1800b2dc8 != 0) {
      (*(code *)DAT_1800b2dc8)();
    }
  }
  cVar4 = RtlDosPathNameToNtPathName_U(*(undefined8 *)(param_1 + 0x40),local_88,&local_res20,0);
  uVar18 = (undefined4)((ulonglong)in_stack_ffffffffffffff28 >> 0x20);
  if (cVar4 == '\0') {
    uVar15 = 0xc000003a;
    uVar9 = uVar16;
  }
  else {
    RtlCopyUnicodeString(psVar1,local_88);
    RtlFreeUnicodeString(local_88);
    piVar8 = (int *)KernelBaseGetGlobalData();
    uVar9 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                            *piVar8 + 0x80000U | 8,(ulonglong)*(ushort *)(param_1 + 0x3a) + 0xa0);
    if (uVar9 == 0) {
      return 0xc0000017;
    }
    local_68 = uVar9 + 0x10;
    *(ulonglong *)(uVar9 + 0x18) = uVar9 + 0xa0;
    *(undefined2 *)(uVar9 + 0x12) = *(undefined2 *)(param_1 + 0x3a);
    RtlCopyUnicodeString(local_68,psVar1);
    *(undefined8 *)(uVar9 + 0x20) = *(undefined8 *)(param_1 + 8);
    *(undefined *)(uVar9 + 0x30) = *(undefined *)(param_1 + 4);
    if (DAT_1800b2e38 != 0) {
      (*(code *)DAT_1800b2e38)();
    }
    local_78[0] = 0x30;
    local_58 = ZEXT816(0);
    local_70 = 0;
    local_60 = 0x40;
    if (*(char *)(uVar9 + 0x30) == '\0') {
      in_stack_ffffffffffffff28 = (undefined *)CONCAT44(uVar18,7);
      uVar6 = NtOpenFile(uVar9 + 0x28,0x80100000,local_78,local_98,in_stack_ffffffffffffff28,
                         CONCAT44(uVar20,0x60));
    }
    else {
      in_stack_ffffffffffffff50 = 0;
      in_stack_ffffffffffffff48 = CONCAT44((int)(in_stack_ffffffffffffff48 >> 0x20),0x60);
      in_stack_ffffffffffffff40 = CONCAT44((int)(in_stack_ffffffffffffff40 >> 0x20),3);
      in_stack_ffffffffffffff28 = (undefined *)0x0;
      uVar6 = NtCreateFile(uVar9 + 0x28,0xc0100000,local_78,local_98,0,CONCAT44(uVar20,0x80),
                           CONCAT44(uVar22,7),in_stack_ffffffffffffff40,in_stack_ffffffffffffff48,0,
                           0);
    }
    uVar15 = (ulonglong)uVar6;
  }
  if ((int)uVar15 < 0) {
LAB_18000c3db:
    if (uVar9 == 0) {
      return uVar15;
    }
    if (*(char *)(uVar9 + 0x32) != '\0') {
      local_res18 = 0;
      local_res10 = 0xffffffffffffffff;
      NtUnlockFile(*(undefined8 *)(uVar9 + 0x28),local_98,&local_res18,&local_res10,
                   (ulonglong)in_stack_ffffffffffffff28 & 0xffffffff00000000 |
                   (ulonglong)DAT_1800b2248);
    }
    lVar10 = *(longlong *)(uVar9 + 0x28);
    if (lVar10 == 0) goto LAB_18000c3f7;
  }
  else {
    *(undefined *)(uVar9 + 0x32) = 0;
    local_res18 = 0;
    local_res10 = 0xffffffffffffffff;
    puVar21 = &local_res10;
    puVar19 = &local_res18;
    in_stack_ffffffffffffff28 = local_98;
    uVar6 = NtLockFile(*(undefined8 *)(uVar9 + 0x28),0,0,0,in_stack_ffffffffffffff28,puVar19,puVar21
                       ,in_stack_ffffffffffffff40 & 0xffffffff00000000 | (ulonglong)DAT_1800b2248,
                       in_stack_ffffffffffffff48 & 0xffffffffffffff00,
                       in_stack_ffffffffffffff50 & 0xffffffffffffff00 |
                       (ulonglong)*(byte *)(uVar9 + 0x30));
    uVar20 = (undefined4)((ulonglong)puVar19 >> 0x20);
    uVar15 = (ulonglong)uVar6;
    if ((int)uVar6 < 0) {
      if (uVar6 == 0xc00000bb) {
        uVar15 = uVar16;
      }
    }
    else {
      *(undefined *)(uVar9 + 0x32) = 1;
    }
    if ((int)uVar15 < 0) goto LAB_18000c3db;
    in_stack_ffffffffffffff28 =
         (undefined *)CONCAT44((int)((ulonglong)in_stack_ffffffffffffff28 >> 0x20),5);
    uVar6 = NtQueryInformationFile
                      (*(undefined8 *)(uVar9 + 0x28),local_98,uVar9 + 0x88,0x18,
                       in_stack_ffffffffffffff28);
    uVar15 = (ulonglong)uVar6;
    if (uVar6 == 0x80000005) {
      uVar15 = uVar16;
    }
    if ((int)uVar15 < 0) goto LAB_18000c3db;
    ppuVar3 = (ushort **)(uVar9 + 0x38);
    *(uint *)(uVar9 + 0x34) = *(uint *)(uVar9 + 0x90);
    puVar17 = (undefined *)CONCAT44((int)((ulonglong)in_stack_ffffffffffffff28 >> 0x20),0x2000);
    lVar10 = (ulonglong)(-(uint)(*(char *)(uVar9 + 0x31) != '\0') & 4) + 4 +
             (ulonglong)*(uint *)(uVar9 + 0x90);
    *(longlong *)(uVar9 + 0x40) = lVar10;
    *(longlong *)(uVar9 + 0x48) = lVar10 + 0x100000;
    uVar6 = NtAllocateVirtualMemory
                      (0xffffffffffffffff,ppuVar3,0,(longlong *)(uVar9 + 0x48),puVar17,
                       CONCAT44(uVar20,4));
    uVar15 = (ulonglong)uVar6;
    if (-1 < (int)uVar6) {
      puVar17 = (undefined *)CONCAT44((int)((ulonglong)puVar17 >> 0x20),0x1000);
      uVar6 = NtAllocateVirtualMemory(0xffffffffffffffff,ppuVar3,0,uVar9 + 0x40,puVar17,4);
      uVar15 = (ulonglong)uVar6;
      if (-1 < (int)uVar6) {
        puVar17 = local_98;
        uVar6 = NtReadFile(*(undefined8 *)(uVar9 + 0x28),0,0,0,puVar17,*ppuVar3,
                           (ulonglong)puVar21 & 0xffffffff00000000 |
                           (ulonglong)*(uint *)(uVar9 + 0x34),0,&DAT_1800b2248);
        uVar15 = (ulonglong)uVar6;
        if (-1 < (int)uVar6) {
          if (local_90 != *(uint *)(uVar9 + 0x34)) {
            uVar15 = 0xc0000011;
          }
          if (-1 < (int)uVar15) {
            *(undefined4 *)(uVar9 + 0x50) = 0xffffffff;
            *(undefined4 *)(uVar9 + 0x54) = 0;
            cVar4 = RtlIsTextUnicode();
            uVar6 = *(uint *)(uVar9 + 0x34);
            *(char *)(uVar9 + 0x31) = cVar4;
            puVar14 = (ushort *)((ulonglong)uVar6 + (longlong)*ppuVar3);
            if (cVar4 == '\0') {
              if (*ppuVar3 <= puVar14 && puVar14 != *ppuVar3) {
                do {
                  puVar14 = (ushort *)((longlong)puVar14 + -1);
                  if (((*(byte *)puVar14 == 10) || (0x20 < *(byte *)puVar14)) ||
                     (*(byte *)puVar14 == 0xd)) break;
                  uVar6 = *(int *)(uVar9 + 0x34) - 1;
                  *(uint *)(uVar9 + 0x34) = uVar6;
                } while (*ppuVar3 <= puVar14 && puVar14 != *ppuVar3);
              }
              puVar14 = (ushort *)((ulonglong)uVar6 + (longlong)*ppuVar3);
              if ((puVar14 < *ppuVar3 || puVar14 == *ppuVar3) ||
                 (*(char *)((longlong)puVar14 + -1) == '\n')) goto LAB_18000c393;
              *puVar14 = 0xa0d;
              iVar7 = *(int *)(uVar9 + 0x34);
              iVar13 = iVar7 + 2;
            }
            else {
              if (*ppuVar3 <= puVar14 && puVar14 != *ppuVar3) {
                do {
                  puVar14 = puVar14 + -1;
                  if (((*puVar14 == 10) || (0x20 < *puVar14)) || (*puVar14 == 0xd)) break;
                  uVar6 = *(int *)(uVar9 + 0x34) - 2;
                  *(uint *)(uVar9 + 0x34) = uVar6;
                } while (*ppuVar3 <= puVar14 && puVar14 != *ppuVar3);
              }
              puVar11 = (undefined4 *)((ulonglong)uVar6 + (longlong)*ppuVar3);
              if ((puVar11 < *ppuVar3 || puVar11 == (undefined4 *)*ppuVar3) ||
                 (*(short *)((longlong)puVar11 + -2) == 10)) goto LAB_18000c393;
              *puVar11 = 0xa000d;
              iVar7 = *(int *)(uVar9 + 0x34);
              iVar13 = iVar7 + 4;
            }
            *(int *)(uVar9 + 0x34) = iVar13;
            *(int *)(uVar9 + 0x54) = iVar13;
            *(int *)(uVar9 + 0x50) = iVar7;
LAB_18000c393:
            *(ulonglong *)(param_1 + 0x10) = uVar9;
            return uVar15;
          }
        }
      }
    }
    if (*(char *)(uVar9 + 0x32) != '\0') {
      local_res18 = 0;
      local_res10 = 0xffffffffffffffff;
      NtUnlockFile(*(undefined8 *)(uVar9 + 0x28),local_98,&local_res18,&local_res10,
                   (ulonglong)puVar17 & 0xffffffff00000000 | (ulonglong)DAT_1800b2248);
    }
    lVar10 = *(longlong *)(uVar9 + 0x28);
  }
  NtClose(lVar10);
LAB_18000c3f7:
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,uVar9);
  return uVar15;
}



void BaseDllReadWriteIniFile
               (char param_1,char param_2,char param_3,LPCWSTR param_4,short *param_5,short *param_6
               ,short *param_7,int *param_8)

{
  int *piVar1;
  int iVar2;
  ulonglong uVar3;
  ulonglong uVar4;
  longlong lVar5;
  short *psVar6;
  undefined8 uVar7;
  char cVar8;
  longlong in_GS_OFFSET;
  undefined auStackY1096 [32];
  int *local_3f8 [2];
  undefined local_3e8 [52];
  int local_3b4;
  ulonglong local_28;
  
                    // 0xc500  50  BaseDllReadWriteIniFile
  local_28 = DAT_1800b2220 ^ (ulonglong)auStackY1096;
  psVar6 = (short *)0x0;
  if (param_3 == '\0') {
    psVar6 = param_6;
  }
  cVar8 = '\0';
  if (param_2 == '\0') {
    if (param_5 == (short *)0x0) {
      if ((param_3 != '\0') || (param_7 == (short *)0x0)) goto LAB_18000c660;
      psVar6 = (short *)0x0;
      uVar3 = 5;
LAB_18000c703:
      cVar8 = '\x01';
    }
    else {
      if (param_7 == (short *)0x0) goto LAB_18000c660;
      if (psVar6 == (short *)0x0) {
        uVar3 = 6;
        cVar8 = '\x01';
        if (param_3 == '\0') {
          uVar3 = 4;
        }
      }
      else {
        uVar3 = 1;
      }
    }
  }
  else if (param_5 == (short *)0x0) {
    uVar3 = (ulonglong)(-(uint)(param_4 != (LPCWSTR)0x0) & 9);
  }
  else if (psVar6 == (short *)0x0) {
    if (param_7 != (short *)0x0) {
      uVar3 = 7;
      goto LAB_18000c703;
    }
    uVar3 = 8;
  }
  else {
    uVar3 = (ulonglong)(3 - (param_7 != (short *)0x0));
  }
  iVar2 = FUN_18000c714(param_1,(int)uVar3,param_2,cVar8,param_4,param_5,psVar6,param_7,param_8,
                        (longlong *)local_3f8);
  piVar1 = local_3f8[0];
  if (iVar2 < 0) goto LAB_18000c660;
  if (*local_3f8[0] == 9) {
    uVar4 = 0;
    if (*(ushort *)(local_3f8[0] + 6) < 0x209) {
      uVar3 = (ulonglong)*(ushort *)((longlong)local_3f8[0] + 0x1a);
      uVar4 = CsrAllocateCaptureBuffer(1);
      if (uVar4 == 0) {
        local_3b4 = -0x3fffffe9;
      }
      else {
        CsrCaptureMessageString
                  (uVar4,*(undefined8 *)(piVar1 + 8),*(undefined2 *)(piVar1 + 6),
                   *(undefined2 *)((longlong)piVar1 + 0x1a));
        uVar3 = uVar4;
        CsrClientCallServer(local_3e8);
      }
    }
    else {
      local_3b4 = -0x3ffffff3;
    }
    CsrFreeCaptureBuffer(uVar4);
  }
  else if (*(longlong *)(local_3f8[0] + 2) == 0) {
    local_3b4 = -0x3fffffea;
  }
  else {
    uVar4 = FUN_180008f64(local_3f8[0]);
    local_3b4 = (int)uVar4;
  }
  if (local_3b4 == -0x3fffffea) {
    uVar3 = FUN_18000be18(piVar1,uVar3);
    local_3b4 = (int)uVar3;
  }
  if (local_3b4 < 0) {
LAB_18000c685:
    if (local_3b4 == -0x7ffffffb) goto LAB_18000c61c;
  }
  else {
    if (*piVar1 - 4U < 3) {
      uVar3 = FUN_18000f76c((longlong)piVar1,(void *)0x0,(void *)0x0,0,'\x01');
      local_3b4 = (int)uVar3;
    }
    if (local_3b4 < 0) goto LAB_18000c685;
LAB_18000c61c:
    if (*(char *)(piVar1 + 1) == '\0') {
      if (param_8 != (int *)0x0) {
        *param_8 = piVar1[0x24];
      }
    }
    else {
      lVar5 = KernelBaseGetGlobalData();
      *(int *)(lVar5 + 0x28) = *(int *)(lVar5 + 0x28) + 1;
    }
  }
  if (*(char *)((longlong)piVar1 + 6) != '\0') {
    if (*(char *)((longlong)piVar1 + 5) == '\0') {
      uVar7 = *(undefined8 *)(local_3f8[0] + 0x24);
    }
    else {
      uVar7 = *(undefined8 *)(local_3f8[0] + 0x28);
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,uVar7);
  }
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_3f8[0]);
LAB_18000c660:
  __security_check_cookie(local_28 ^ (ulonglong)auStackY1096);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

int FUN_18000c714(char param_1,undefined4 param_2,undefined param_3,char param_4,LPCWSTR param_5,
                 short *param_6,short *param_7,short *param_8,undefined4 *param_9,longlong *param_10
                 )

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  longlong lVar3;
  short *psVar4;
  short sVar5;
  DWORD DVar6;
  uint uVar7;
  ulonglong uVar8;
  undefined4 *puVar9;
  code *pcVar10;
  short sVar11;
  short *psVar12;
  short *psVar14;
  longlong lVar15;
  uint uVar16;
  int iVar17;
  int iVar18;
  ulonglong uVar19;
  short *psVar20;
  int iVar21;
  ulonglong uVar22;
  undefined2 *puVar23;
  char cVar24;
  ulonglong uVar25;
  short sVar26;
  longlong in_GS_OFFSET;
  uint local_res8;
  short *psVar13;
  undefined4 uVar27;
  
  uVar19 = 0xffffffffffffffff;
  uVar25 = 0;
  uVar22 = uVar25;
  if (param_5 != (LPCWSTR)0x0) {
    uVar22 = 0xffffffffffffffff;
    if (param_1 == '\0') {
      do {
        uVar22 = uVar22 + 1;
      } while (*(char *)((longlong)param_5 + uVar22) != '\0');
    }
    else {
      do {
        uVar22 = uVar22 + 1;
      } while (param_5[uVar22] != L'\0');
    }
  }
  cVar24 = param_4;
  if (param_6 == (short *)0x0) {
    param_5._0_4_ = 0;
    param_7 = (short *)0x0;
  }
  else {
    uVar8 = FUN_18000ccbc(param_1,&param_6);
    param_5._0_4_ = (uint)uVar8;
  }
  if (param_7 == (short *)0x0) {
    local_res8 = (uint)uVar25;
  }
  else {
    uVar8 = FUN_18000ccbc(param_1,&param_7);
    local_res8 = (uint)uVar8;
  }
  psVar4 = param_8;
  if ((param_8 == (short *)0x0) || (param_9 != (undefined4 *)0x0)) {
    uVar19 = uVar25 & 0xffffffff;
  }
  else if (cVar24 == '\0') {
    if (param_1 == '\0') {
      do {
        uVar19 = uVar19 + 1;
      } while (*(char *)((longlong)param_8 + uVar19) != (char)uVar25);
    }
    else {
      do {
        uVar19 = uVar19 + 1;
      } while (param_8[uVar19] != (short)uVar25);
    }
  }
  else if (param_1 == '\0') {
    cVar24 = *(char *)param_8;
    psVar20 = param_8;
    while (cVar24 != (char)uVar25) {
      do {
        cVar24 = *(char *)psVar20;
        psVar20 = (short *)((longlong)psVar20 + 1);
      } while (cVar24 != '\0');
      cVar24 = *(char *)psVar20;
    }
    uVar19 = (ulonglong)(uint)((int)psVar20 - (int)param_8);
  }
  else {
    sVar26 = *param_8;
    psVar20 = param_8;
    while (sVar26 != (short)uVar25) {
      do {
        sVar26 = *psVar20;
        psVar20 = psVar20 + 1;
      } while (sVar26 != 0);
      sVar26 = *psVar20;
    }
    uVar19 = (longlong)psVar20 - (longlong)param_8 >> 1;
  }
  if (param_5 == (LPCWSTR)0x0) {
LAB_18000c7fe:
    uVar16 = RtlGetLongestNtPathLength();
  }
  else {
    if (param_1 == '\0') {
      DVar6 = GetFullPathNameA((LPCSTR)param_5,0,(LPSTR)0x0,(LPSTR *)0x0);
    }
    else {
      DVar6 = GetFullPathNameW(param_5,0,(LPWSTR)0x0,(LPWSTR *)0x0);
    }
    uVar16 = DVar6 + 5;
    uVar7 = RtlGetLongestNtPathLength();
    if (uVar16 <= uVar7) goto LAB_18000c7fe;
  }
  uVar16 = uVar16 * 2;
  iVar17 = uVar16 + 0x158;
  iVar21 = (int)uVar22;
  if (param_1 == '\0') {
    iVar17 = iVar17 + iVar21 * 2 + 2;
  }
  puVar9 = (undefined4 *)KernelBaseGetGlobalData();
  iVar18 = (int)uVar19;
  puVar9 = (undefined4 *)
           RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),*puVar9,
                           iVar17 + (local_res8 + 3 + iVar18 + (uint)param_5) * 2);
  if (puVar9 == (undefined4 *)0x0) {
    return -0x3fffffe9;
  }
  *puVar9 = param_2;
  *(undefined *)(puVar9 + 1) = param_3;
  *(char *)(puVar9 + 0x22) = param_4;
  *(undefined4 **)(puVar9 + 0x10) = puVar9 + 0x56;
  puVar23 = (undefined2 *)((longlong)(puVar9 + 0x56) + (ulonglong)uVar16);
  *(short *)((longlong)puVar9 + 0x3a) = (short)uVar16;
  puVar1 = puVar9 + 10;
  *(char *)((longlong)puVar9 + 5) = param_1;
  *(undefined8 *)(puVar9 + 4) = 0;
  *(undefined *)((longlong)puVar9 + 6) = 0;
  *(undefined2 *)(puVar9 + 0xe) = 0;
  if (param_5 == (LPCWSTR)0x0) {
    RtlInitUnicodeString(puVar1,L"win.ini");
    lVar3 = DAT_1800b2b30;
    lVar15 = 0;
    puVar9[6] = *puVar1;
    puVar9[7] = puVar9[0xb];
    puVar9[8] = puVar9[0xc];
    puVar9[9] = puVar9[0xd];
    if (*(longlong *)(lVar3 + 0x10) != 0) {
      lVar15 = (*(longlong *)(lVar3 + 0x10) - *(longlong *)(DAT_1800b2bf8 + 0x9e8)) + DAT_1800b2bf8;
    }
    *(longlong *)(puVar9 + 2) = lVar15;
  }
  else {
    sVar26 = (short)uVar22 * 2;
    *(short *)((longlong)puVar9 + 0x2a) = sVar26 + 2;
    if (param_1 == '\0') {
      *(undefined2 **)(puVar9 + 0xc) = puVar23;
      *(short *)puVar1 = 0;
      puVar23 = puVar23 + (iVar21 + 1);
      pcVar10 = (code *)GetEightBitStringToUnicodeStringRoutine();
      iVar17 = (*pcVar10)();
      if (iVar17 < 0) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar9);
        return iVar17;
      }
    }
    else {
      *(short *)puVar1 = sVar26;
      *(LPCWSTR *)(puVar9 + 0xc) = param_5;
    }
    psVar20 = *(short **)(puVar9 + 0xc);
    puVar2 = puVar9 + 6;
    *(short *)puVar2 = 0;
    psVar14 = psVar20 + (uVar22 & 0xffffffff);
    psVar12 = psVar20 + (uVar22 & 0xffffffff);
    if (iVar21 != 0) {
      do {
        psVar13 = psVar12;
        psVar12 = psVar13 + -1;
        psVar14 = psVar12;
        if (psVar12 <= psVar20) break;
      } while ((0x2d < (ushort)(*psVar12 - 0x2fU)) ||
              (psVar14 = psVar13,
              (0x200000000801U >> ((ulonglong)(ushort)(*psVar12 - 0x2fU) & 0x3f) & 1) == 0));
    }
    *(short **)(puVar9 + 8) = psVar14;
    sVar26 = ((short)uVar22 - (short)((longlong)psVar14 - (longlong)psVar20 >> 1)) * 2;
    *(short *)puVar2 = sVar26;
    *(short *)((longlong)puVar9 + 0x1a) = sVar26 + 2;
    FUN_18000cd4c((longlong)puVar1,(longlong)puVar2,(longlong **)(puVar9 + 2));
  }
  sVar26 = 0;
  uVar27 = 0;
  if (param_6 == (short *)0x0) {
    RtlInitAnsiString(puVar9 + 0x12);
    RtlInitUnicodeString(puVar9 + 0x1a,0);
  }
  else {
    uVar22 = (ulonglong)(uint)param_5;
    sVar11 = (short)(uint)param_5 * 2;
    *(short *)((longlong)puVar9 + 0x4a) = sVar11 + 1;
    *(short *)((longlong)puVar9 + 0x6a) = (sVar11 + 1) * 2;
    if (param_1 == '\0') {
      *(undefined2 **)(puVar9 + 0x1c) = puVar23;
      puVar23 = puVar23 + ((uint)param_5 + 1);
      *(short **)(puVar9 + 0x14) = param_6;
      sVar11 = sVar26;
    }
    else {
      *(undefined2 **)(puVar9 + 0x14) = puVar23;
      puVar23 = (undefined2 *)((longlong)puVar23 + uVar22 * 2 + 1);
      *(short **)(puVar9 + 0x1c) = param_6;
      uVar22 = 0;
    }
    *(short *)(puVar9 + 0x12) = (short)uVar22;
    *(short *)(puVar9 + 0x1a) = sVar11;
  }
  if (param_7 == (short *)0x0) {
    RtlInitAnsiString(puVar9 + 0x16);
    RtlInitUnicodeString(puVar9 + 0x1e,0);
  }
  else {
    uVar22 = (ulonglong)local_res8;
    sVar11 = (short)local_res8 * 2;
    sVar5 = sVar11 + 1;
    *(short *)((longlong)puVar9 + 0x5a) = sVar5;
    *(short *)((longlong)puVar9 + 0x7a) = sVar5 * 2;
    if (param_1 == '\0') {
      *(undefined2 **)(puVar9 + 0x20) = puVar23;
      puVar23 = puVar23 + (local_res8 + 1);
      *(short **)(puVar9 + 0x18) = param_7;
    }
    else {
      *(undefined2 **)(puVar9 + 0x18) = puVar23;
      puVar23 = (undefined2 *)((longlong)puVar23 + uVar22 * 2 + 1);
      *(short **)(puVar9 + 0x20) = param_7;
      uVar22 = 0;
      sVar26 = sVar11;
    }
    *(short *)(puVar9 + 0x16) = (short)uVar22;
    *(short *)(puVar9 + 0x1e) = sVar26;
  }
  if (psVar4 == (short *)0x0) {
    *(undefined8 *)(puVar9 + 0x28) = 0;
    if (*(char *)(puVar9 + 1) != '\0') {
      *(undefined8 *)(puVar9 + 0x24) = 0;
      puVar9[0x26] = 0;
      goto LAB_18000cc15;
    }
    *(undefined8 *)(puVar9 + 0x24) = 0;
  }
  else {
    if (*(char *)(puVar9 + 1) != '\0') {
      if (param_1 != '\0') {
        *(short **)(puVar9 + 0x28) = psVar4;
        puVar9[0x2a] = iVar18 * 2;
        *(undefined *)puVar23 = 0;
        *(undefined2 **)(puVar9 + 0x24) = puVar23;
        puVar9[0x26] = 0;
        goto LAB_18000ca6c;
      }
      *(short **)(puVar9 + 0x24) = psVar4;
      puVar9[0x26] = iVar18;
      *puVar23 = 0;
      *(undefined2 **)(puVar9 + 0x28) = puVar23;
LAB_18000cc15:
      puVar9[0x2a] = 0;
      goto LAB_18000ca6c;
    }
    if (param_9 != (undefined4 *)0x0) {
      uVar27 = *param_9;
    }
    puVar9[0x25] = uVar27;
    puVar9[0x24] = 0;
    if (param_1 == '\0') {
      *(short **)(puVar9 + 0x26) = psVar4;
      *(undefined8 *)(puVar9 + 0x28) = 0;
      goto LAB_18000ca6c;
    }
    *(short **)(puVar9 + 0x28) = psVar4;
  }
  *(undefined8 *)(puVar9 + 0x26) = 0;
LAB_18000ca6c:
  *param_10 = (longlong)puVar9;
  return 0;
}



ulonglong FUN_18000ccbc(char param_1,short **param_2)

{
  short *psVar1;
  short *psVar2;
  short *psVar3;
  
  psVar2 = *param_2;
  if (param_1 == '\0') {
    for (; *(char *)psVar2 == ' '; psVar2 = (short *)((longlong)psVar2 + 1)) {
    }
    *param_2 = psVar2;
    psVar3 = psVar2;
    if (*(char *)psVar2 != '\0') {
      do {
        psVar2 = (short *)((longlong)psVar2 + 1);
      } while (*(char *)psVar2 != '\0');
      psVar3 = *param_2;
    }
    psVar1 = psVar2;
    if (psVar3 < psVar2) {
      do {
        psVar2 = psVar1;
        psVar1 = (short *)((longlong)psVar2 + -1);
      } while (*(char *)(short *)((longlong)psVar2 + -1) == ' ');
      psVar3 = *param_2;
    }
    return (ulonglong)(uint)((int)psVar2 - (int)psVar3);
  }
  for (; *psVar2 == 0x20; psVar2 = psVar2 + 1) {
  }
  *param_2 = psVar2;
  psVar3 = psVar2;
  if (*psVar2 != 0) {
    do {
      psVar2 = psVar2 + 1;
    } while (*psVar2 != 0);
    psVar3 = *param_2;
  }
  psVar1 = psVar2;
  if (psVar3 < psVar2) {
    do {
      psVar2 = psVar1;
      psVar1 = psVar2 + -1;
    } while (psVar2[-1] == 0x20);
    psVar3 = *param_2;
  }
  return (longlong)psVar2 - (longlong)psVar3 >> 1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_18000cd4c(longlong param_1,longlong param_2,longlong **param_3)

{
  char cVar1;
  longlong lVar2;
  ulonglong uVar3;
  undefined *puVar4;
  longlong *plVar5;
  undefined auStack664 [32];
  longlong local_278;
  longlong lStack624;
  undefined local_268 [16];
  undefined local_258 [16];
  undefined local_248 [528];
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack664;
  *param_3 = (longlong *)0x0;
  local_278 = 0;
  lStack624 = 0;
  RtlInitUnicodeString(local_258,L"win.ini");
  lVar2 = DAT_1800b2e18;
  if (DAT_1800b2e18 != 0) {
    lVar2 = (*(code *)DAT_1800b2e18)();
  }
  puVar4 = local_248;
  if ((int)lVar2 == 0) {
    puVar4 = &DAT_180085634;
  }
  RtlInitUnicodeString(local_268,puVar4);
  if (*(longlong *)(param_1 + 8) != *(longlong *)(param_2 + 8)) {
    lVar2 = KernelBaseGetGlobalData();
    cVar1 = RtlPrefixUnicodeString(lVar2 + 8,param_1,1);
    if (((cVar1 == '\0') && (cVar1 = RtlEqualUnicodeString(param_2,local_258,1), cVar1 != '\0')) &&
       ((uVar3 = RtlGetSuiteMask(), (uVar3 & 0x10) == 0 ||
        (cVar1 = RtlPrefixUnicodeString(local_268,param_1,1), cVar1 == '\0')))) goto LAB_18000ce92;
  }
  lVar2 = *DAT_1800b2b30;
  while (lVar2 != 0) {
    plVar5 = (longlong *)((lVar2 - *(longlong *)(DAT_1800b2bf8 + 0x9e8)) + DAT_1800b2bf8);
    if (plVar5 == (longlong *)0x0) break;
    local_278 = plVar5[1];
    lVar2 = plVar5[2];
    if (lVar2 == 0) {
      lStack624 = 0;
    }
    else {
      lStack624 = lVar2 + (DAT_1800b2bf8 - *(longlong *)(DAT_1800b2bf8 + 0x9e8));
    }
    cVar1 = RtlEqualUnicodeString(lVar2,param_2,&local_278,1);
    if (cVar1 != '\0') goto LAB_18000ce8f;
    lVar2 = *plVar5;
  }
  plVar5 = (longlong *)DAT_1800b2b30[1];
  if (plVar5 != (longlong *)0x0) {
    plVar5 = (longlong *)((longlong)plVar5 + (DAT_1800b2bf8 - *(longlong *)(DAT_1800b2bf8 + 0x9e8)))
    ;
  }
LAB_18000ce8f:
  *param_3 = plVar5;
LAB_18000ce92:
  __security_check_cookie(local_38 ^ (ulonglong)auStack664);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void BasepQueryAppCompat(longlong param_1,int param_2,short param_3,undefined8 param_4,
                        undefined8 param_5,undefined8 param_6,undefined8 param_7,longlong param_8,
                        longlong *param_9,undefined4 *param_10,void **param_11,int *param_12,
                        undefined4 *param_13,undefined8 *param_14,undefined4 *param_15,
                        short *param_16,ulonglong *param_17,undefined4 *param_18)

{
  short *psVar1;
  int iVar2;
  ulonglong uVar3;
  undefined4 *puVar4;
  uint uVar5;
  uint uVar6;
  longlong in_GS_OFFSET;
  bool bVar7;
  undefined auStackY296 [32];
  int local_b4;
  ulonglong local_b0;
  int local_a8;
  uint local_a0 [2];
  short *local_98;
  undefined4 *local_90;
  undefined4 *local_88;
  undefined8 local_80;
  undefined8 local_78;
  undefined8 local_70;
  undefined8 local_68;
  undefined4 *local_60;
  undefined8 *local_58;
  undefined4 *local_50;
  int *local_48;
  uint *local_40;
  undefined8 local_38;
  ulonglong local_30;
  
                    // 0xcee0  98  BasepQueryAppCompat
  local_30 = DAT_1800b2220 ^ (ulonglong)auStackY296;
  uVar5 = 1;
  local_78 = param_5;
  local_68 = param_6;
  local_80 = param_7;
  local_90 = param_10;
  local_48 = param_12;
  local_50 = param_13;
  local_58 = param_14;
  local_60 = param_15;
  local_98 = param_16;
  local_88 = param_18;
  local_b4 = 0;
  local_b0 = 0;
  local_a8 = param_2;
  local_70 = param_4;
  if (DAT_1800b2da0 == 0) {
    EtwEventRegister(&DAT_180085348,0,0,&local_b0);
    if (local_b0 != 0) {
      LOCK();
      bVar7 = DAT_1800b2da0 == 0;
      DAT_1800b2da0 = DAT_1800b2da0 ^ (ulonglong)bVar7 * (DAT_1800b2da0 ^ local_b0);
      if (!bVar7) {
        EtwEventUnregister(local_b0);
        local_b0 = 0;
      }
      goto LAB_18000d001;
    }
  }
  else {
LAB_18000d001:
    EtwEventWrite();
  }
  uVar6 = uVar5;
  if (param_1 != 0) {
    if ((*(ushort *)(param_1 + 0x26) == _DAT_7ffe026c) &&
       (uVar6 = 1, *(ushort *)(param_1 + 0x24) == _DAT_7ffe0270)) {
      uVar6 = 3;
    }
    if ((*(ushort *)(param_1 + 0x28) == _DAT_7ffe026c) &&
       (*(ushort *)(param_1 + 0x2a) == _DAT_7ffe0270)) {
      uVar6 = uVar6 | 2;
    }
  }
  if ((param_11 != (void **)0x0) && (*param_11 != (void *)0x0)) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
    *param_11 = (void *)0x0;
  }
  if ((param_9 != (longlong *)0x0) && (*param_9 != 0)) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
    *param_9 = 0;
  }
  FUN_18000d244(param_1,local_a8,param_3,local_98);
  if (((param_8 == 0) || (psVar1 = *(short **)(param_8 + 8), psVar1 == (short *)0x0)) ||
     (*psVar1 == 0)) {
LAB_18000d140:
    puVar4 = FUN_18000d618(param_9,local_90,param_11,local_48,local_50,local_58,local_60,local_68,
                           local_70,local_78,local_80,*local_98,uVar6);
    iVar2 = (int)puVar4;
LAB_18000d1a2:
    if (-1 < iVar2) goto LAB_18000d1c9;
    if (iVar2 == -0x3fffffde) {
      RtlSetLastWin32Error(0x4c7);
    }
    else {
      BaseSetLastNTError();
    }
  }
  else {
    iVar2 = CheckIsMSIXPackage(psVar1,&local_b4);
    if ((-1 < iVar2) && (local_b4 != 0)) goto LAB_18000d140;
    uVar3 = FUN_180009ca0(param_17,local_88,0,*(undefined8 *)(param_8 + 8));
    if ((int)uVar3 == 0) {
      uVar3 = FUN_18000d28c(param_9,local_90,*(undefined8 *)(param_8 + 8),*param_17,*local_98,uVar6)
      ;
      iVar2 = (int)uVar3;
      goto LAB_18000d1a2;
    }
  }
  uVar5 = 0;
LAB_18000d1c9:
  local_a0[0] = ~-(uint)(uVar5 != 0) & 0xc0000001;
  if (DAT_1800b2da0 != 0) {
    local_40 = local_a0;
    local_38 = 4;
    EtwEventWrite(DAT_1800b2da0,&DAT_180085478,1,&local_40);
  }
  __security_check_cookie(local_30 ^ (ulonglong)auStackY296);
  return;
}



void FUN_18000d244(longlong param_1,int param_2,short param_3,short *param_4)

{
  short sVar1;
  
  if (param_1 == 0) {
    if (param_3 == 0) {
      *param_4 = 0x14c;
      return;
    }
  }
  else {
    sVar1 = *(short *)(param_1 + 0x30);
    *param_4 = sVar1;
    if (sVar1 != 0x14c) {
      return;
    }
    if (param_2 == 0) {
      return;
    }
  }
  if (param_3 == 9) {
    sVar1 = -0x799c;
  }
  else if (param_3 == 5) {
    sVar1 = 0x1c0;
  }
  else {
    if (param_3 != 0xc) {
      return;
    }
    sVar1 = -0x559c;
  }
  *param_4 = sVar1;
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Could not reconcile some variable overlaps
// WARNING: Exceeded maximum restarts with more pending

ulonglong FUN_18000d28c(undefined8 *param_1,undefined4 *param_2,undefined8 param_3,
                       undefined8 param_4,undefined2 param_5,uint param_6)

{
  ulonglong uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  uint uVar7;
  uint uVar8;
  HANDLE pvVar9;
  ulonglong uVar10;
  longlong lVar11;
  LPVOID pvVar12;
  undefined4 *puVar13;
  ulonglong uVar14;
  undefined4 *puVar15;
  ulonglong uVar16;
  longlong in_GS_OFFSET;
  undefined4 local_208;
  ulonglong local_200;
  wchar_t *local_1f8;
  undefined4 *local_1f0;
  undefined local_1e8 [16];
  undefined local_1d8 [16];
  undefined local_1c8 [16];
  undefined4 local_1b8;
  uint local_1b4;
  undefined2 local_190;
  LPVOID local_50;
  uint local_48;
  
  local_1e8 = ZEXT816(0);
  local_1d8 = ZEXT816(0);
  local_1c8 = ZEXT816(0);
  pvVar9 = GetProcessHeap();
  local_1e8._0_8_ = pvVar9;
  memset(&local_1b8,0,0x178);
  local_1f8 = (wchar_t *)0x0;
  local_1f0 = (undefined4 *)0x0;
  local_208 = 0;
  uVar10 = FUN_18000ef48(&local_1f8,param_3);
  uVar14 = uVar10 & 0xffffffff;
  if ((int)uVar10 < 0) {
LAB_18002ec1d:
  }
  else {
    local_1b8 = 1;
    uVar7 = RtlInitUnicodeStringEx();
    uVar14 = (ulonglong)uVar7;
    if ((int)uVar7 < 0) goto LAB_18000d541;
    local_190 = param_5;
    uVar7 = (param_6 & 1) << 4;
    local_1b4 = uVar7 | 0x20;
    if ((param_6 & 2) == 0) {
      local_1b4 = uVar7;
    }
    local_200 = local_1d8._0_8_;
    uVar10 = local_1e8._8_8_;
    uVar7 = 0x1000;
    do {
      uVar16 = (ulonglong)uVar7;
      if (local_200 < uVar16) {
        if (uVar16 + 0xfff < uVar16) {
          uVar14 = 0x8000000b;
        }
        else {
          uVar14 = uVar16 + 0xfff & 0xfffffffffffff000;
          if (local_1c8._8_8_ == (LPVOID)0x0) {
            pvVar12 = HeapAlloc(pvVar9,0,uVar14);
            if (pvVar12 != (LPVOID)0x0) {
              memset(pvVar12,0,uVar14);
            }
          }
          else {
            pvVar12 = HeapReAlloc(pvVar9,0,local_1c8._8_8_,uVar14);
          }
          if (pvVar12 != (LPVOID)0x0) {
            local_1c8 = CONCAT88(pvVar12,local_1c8._0_8_);
            local_1c8._8_8_ = pvVar12;
            local_200 = uVar14;
            goto LAB_18000d608;
          }
          uVar14 = 0x8007000e;
        }
      }
      else {
LAB_18000d608:
        uVar14 = 0;
        uVar10 = uVar16;
      }
      if ((int)uVar14 < 0) goto LAB_18000d541;
      local_50 = local_1c8._8_8_;
      local_48 = uVar7;
      uVar8 = NtApphelpCacheControl();
      uVar14 = (ulonglong)uVar8;
      uVar7 = local_48;
    } while (uVar8 == 0xc0000023);
    if ((int)uVar8 < 0) goto LAB_18000d541;
    uVar16 = (ulonglong)local_48;
    pvVar12 = local_1c8._8_8_;
    if (local_200 < uVar16) {
      if (uVar16 + 0xfff < uVar16) {
        uVar14 = 0x8000000b;
      }
      else {
        uVar14 = uVar16 + 0xfff & 0xfffffffffffff000;
        if (local_1c8._8_8_ == (LPVOID)0x0) {
          pvVar12 = HeapAlloc(pvVar9,0,uVar14);
          if (pvVar12 != (LPVOID)0x0) {
            memset(pvVar12,0,uVar14);
          }
        }
        else {
          pvVar12 = HeapReAlloc(pvVar9,0,local_1c8._8_8_,uVar14);
        }
        if (pvVar12 != (LPVOID)0x0) {
          local_1c8 = CONCAT88(pvVar12,local_1c8._0_8_);
          goto LAB_18000d3f9;
        }
        uVar14 = 0x8007000e;
      }
    }
    else {
LAB_18000d3f9:
      uVar14 = 0;
      local_1c8._8_8_ = pvVar12;
      uVar10 = uVar16;
    }
    if ((int)uVar14 < 0) goto LAB_18000d541;
    uVar14 = 0;
    do {
      if (((uVar10 < uVar14) || (uVar16 = uVar14 + 8, uVar16 < uVar14)) || (uVar10 < uVar16))
      goto LAB_18000d523;
      uVar1 = *(ulonglong *)(uVar14 + (longlong)local_1c8._8_8_);
      uVar14 = (uVar1 >> 0x20) + uVar16;
      if (((uVar14 < uVar16) || (uVar14 + 3 < uVar14)) ||
         (uVar14 = uVar14 + 3 & 0xfffffffffffffffc, uVar10 < uVar14)) goto LAB_18000d523;
    } while ((int)uVar1 != 1);
    if ((int)(uVar1 >> 0x20) == 0x1c8) {
      local_1f0 = (undefined4 *)
                  RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,0x1c8
                                 );
      pvVar9 = local_1e8._0_8_;
      if (local_1f0 == (undefined4 *)0x0) {
        uVar14 = 0xc0000017;
        goto LAB_18002ec1d;
      }
      lVar11 = 3;
      puVar5 = local_1f0;
      puVar6 = (undefined4 *)(uVar16 + (longlong)local_1c8._8_8_);
      do {
        puVar15 = puVar6;
        puVar13 = puVar5;
        uVar2 = puVar15[1];
        uVar3 = puVar15[2];
        uVar4 = puVar15[3];
        *puVar13 = *puVar15;
        puVar13[1] = uVar2;
        puVar13[2] = uVar3;
        puVar13[3] = uVar4;
        uVar2 = puVar15[5];
        uVar3 = puVar15[6];
        uVar4 = puVar15[7];
        puVar13[4] = puVar15[4];
        puVar13[5] = uVar2;
        puVar13[6] = uVar3;
        puVar13[7] = uVar4;
        uVar2 = puVar15[9];
        uVar3 = puVar15[10];
        uVar4 = puVar15[0xb];
        puVar13[8] = puVar15[8];
        puVar13[9] = uVar2;
        puVar13[10] = uVar3;
        puVar13[0xb] = uVar4;
        uVar2 = puVar15[0xd];
        uVar3 = puVar15[0xe];
        uVar4 = puVar15[0xf];
        puVar13[0xc] = puVar15[0xc];
        puVar13[0xd] = uVar2;
        puVar13[0xe] = uVar3;
        puVar13[0xf] = uVar4;
        uVar2 = puVar15[0x11];
        uVar3 = puVar15[0x12];
        uVar4 = puVar15[0x13];
        puVar13[0x10] = puVar15[0x10];
        puVar13[0x11] = uVar2;
        puVar13[0x12] = uVar3;
        puVar13[0x13] = uVar4;
        uVar2 = puVar15[0x15];
        uVar3 = puVar15[0x16];
        uVar4 = puVar15[0x17];
        puVar13[0x14] = puVar15[0x14];
        puVar13[0x15] = uVar2;
        puVar13[0x16] = uVar3;
        puVar13[0x17] = uVar4;
        uVar2 = puVar15[0x19];
        uVar3 = puVar15[0x1a];
        uVar4 = puVar15[0x1b];
        puVar13[0x18] = puVar15[0x18];
        puVar13[0x19] = uVar2;
        puVar13[0x1a] = uVar3;
        puVar13[0x1b] = uVar4;
        uVar2 = puVar15[0x1d];
        uVar3 = puVar15[0x1e];
        uVar4 = puVar15[0x1f];
        puVar13[0x1c] = puVar15[0x1c];
        puVar13[0x1d] = uVar2;
        puVar13[0x1e] = uVar3;
        puVar13[0x1f] = uVar4;
        lVar11 = lVar11 + -1;
        puVar5 = puVar13 + 0x20;
        puVar6 = puVar15 + 0x20;
      } while (lVar11 != 0);
      uVar2 = puVar15[0x21];
      uVar3 = puVar15[0x22];
      uVar4 = puVar15[0x23];
      puVar13[0x20] = puVar15[0x20];
      puVar13[0x21] = uVar2;
      puVar13[0x22] = uVar3;
      puVar13[0x23] = uVar4;
      local_208 = 0x1c8;
      uVar2 = puVar15[0x25];
      uVar3 = puVar15[0x26];
      uVar4 = puVar15[0x27];
      puVar13[0x24] = puVar15[0x24];
      puVar13[0x25] = uVar2;
      puVar13[0x26] = uVar3;
      puVar13[0x27] = uVar4;
      uVar2 = puVar15[0x29];
      uVar3 = puVar15[0x2a];
      uVar4 = puVar15[0x2b];
      puVar13[0x28] = puVar15[0x28];
      puVar13[0x29] = uVar2;
      puVar13[0x2a] = uVar3;
      puVar13[0x2b] = uVar4;
      uVar2 = puVar15[0x2d];
      uVar3 = puVar15[0x2e];
      uVar4 = puVar15[0x2f];
      puVar13[0x2c] = puVar15[0x2c];
      puVar13[0x2d] = uVar2;
      puVar13[0x2e] = uVar3;
      puVar13[0x2f] = uVar4;
      *(undefined8 *)(puVar13 + 0x30) = *(undefined8 *)(puVar15 + 0x30);
    }
LAB_18000d523:
    uVar14 = 0;
    *param_1 = local_1f0;
    *param_2 = local_208;
  }
LAB_18000d541:
  if (local_1f8 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_1f8);
    pvVar9 = local_1e8._0_8_;
  }
  if (local_1c8._8_8_ != (LPVOID)0x0) {
    HeapFree(pvVar9,0,local_1c8._8_8_);
  }
  return uVar14;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Could not reconcile some variable overlaps
// WARNING: Exceeded maximum restarts with more pending

undefined4 *
FUN_18000d618(undefined8 *param_1,undefined4 *param_2,void **param_3,int *param_4,
             undefined4 *param_5,undefined8 *param_6,undefined4 *param_7,wchar_t *param_8,
             undefined8 param_9,undefined8 param_10,undefined8 param_11,undefined2 param_12,
             uint param_13)

{
  wchar_t *pwVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  LPVOID pvVar5;
  undefined4 *puVar6;
  longlong lVar7;
  void *pvVar8;
  undefined4 *puVar9;
  size_t sVar10;
  undefined4 *puVar11;
  undefined4 *puVar12;
  undefined4 *puVar13;
  ulonglong uVar14;
  undefined4 *puVar15;
  undefined4 *puVar16;
  undefined4 uVar17;
  undefined4 uVar19;
  longlong in_GS_OFFSET;
  int local_230;
  uint local_22c;
  wchar_t *local_228;
  undefined local_220 [16];
  undefined local_210 [16];
  undefined local_200 [16];
  int local_1f0;
  void *local_1e8;
  undefined8 local_1e0;
  undefined8 local_1d8;
  undefined8 local_1d0;
  undefined4 local_1c8;
  uint local_1c4;
  undefined8 local_1b0;
  undefined8 local_1a8;
  undefined2 local_1a0;
  undefined local_198 [16];
  longlong local_188;
  undefined4 local_180;
  LPVOID local_60;
  uint local_58;
  undefined4 uVar18;
  
  local_220 = ZEXT816(0);
  local_210 = ZEXT816(0);
  local_200 = ZEXT816(0);
  local_220._0_8_ = GetProcessHeap();
  pwVar1 = param_8;
  if (param_8 == (wchar_t *)0x0) {
    puVar16 = (undefined4 *)0xc000000d;
    goto LAB_18000da5c;
  }
  memset(&local_1c8,0,0x178);
  local_1b0 = param_9;
  local_1a8 = param_10;
  local_228 = (wchar_t *)0x0;
  local_1e8 = (void *)0x0;
  local_22c = 0;
  local_230 = 0;
  param_8._0_4_ = 0;
  local_1c8 = 0x1f;
  uVar2 = RtlCreateEnvironmentEx(param_11,&local_188,0);
  puVar16 = (undefined4 *)(ulonglong)uVar2;
  if ((int)uVar2 < 0) {
LAB_18000da49:
  }
  else {
    local_180 = RtlSizeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_188);
    uVar2 = (param_13 & 1) << 4;
    local_1a0 = param_12;
    local_1c4 = uVar2 | 0x20;
    if ((param_13 & 2) == 0) {
      local_1c4 = uVar2;
    }
    iVar3 = FUN_18000eb88((uint *)&param_8,pwVar1);
    if ((-1 < iVar3) && ((int)param_8 != 0)) {
      local_1c4 = local_1c4 | 2;
    }
    iVar3 = FUN_18000edb4(&local_230,pwVar1);
    if ((-1 < iVar3) && (local_230 != 0)) {
      local_1c4 = local_1c4 | 4;
    }
    uVar2 = FUN_18000e3d0(&local_228,pwVar1);
    puVar16 = (undefined4 *)(ulonglong)uVar2;
    if ((int)uVar2 < 0) {
LAB_18002ed07:
    }
    else {
      uVar2 = RtlInitUnicodeStringEx(local_198);
      puVar16 = (undefined4 *)(ulonglong)uVar2;
      if ((int)uVar2 < 0) goto LAB_18002ed07;
      iVar3 = FUN_18000e84c(&local_22c,local_228);
      if ((-1 < iVar3) && (local_22c != 0)) {
        local_1c4 = local_1c4 | 8;
      }
      puVar11 = local_220._8_8_;
      uVar2 = 0x1000;
      do {
        puVar15 = (undefined4 *)(ulonglong)uVar2;
        pvVar5 = local_200._8_8_;
        puVar12 = local_210._0_8_;
        if (local_210._0_8_ < puVar15) {
          if ((undefined4 *)((longlong)puVar15 + 0xfffU) < puVar15) {
            puVar16 = (undefined4 *)0x8000000b;
          }
          else {
            puVar12 = (undefined4 *)
                      ((ulonglong)(undefined4 *)((longlong)puVar15 + 0xfffU) & 0xfffffffffffff000);
            if (local_200._8_8_ == (LPVOID)0x0) {
              pvVar5 = HeapAlloc(local_220._0_8_,0,(SIZE_T)puVar12);
              if (pvVar5 != (LPVOID)0x0) {
                memset(pvVar5,0,(size_t)puVar12);
              }
            }
            else {
              pvVar5 = HeapReAlloc(local_220._0_8_,0,local_200._8_8_,(SIZE_T)puVar12);
            }
            if (pvVar5 != (LPVOID)0x0) {
              local_200 = CONCAT88(pvVar5,local_200._0_8_);
              goto LAB_18000d819;
            }
            puVar16 = (undefined4 *)0x8007000e;
          }
        }
        else {
LAB_18000d819:
          puVar16 = (undefined4 *)0x0;
          puVar11 = puVar15;
          local_200._8_8_ = pvVar5;
          local_210._0_8_ = puVar12;
          local_220._8_8_ = puVar15;
        }
        if ((int)puVar16 < 0) goto LAB_18000da22;
        local_60 = local_200._8_8_;
        local_58 = uVar2;
        uVar4 = NtApphelpCacheControl();
        uVar2 = local_58;
      } while (uVar4 == 0xc0000023);
      puVar12 = (undefined4 *)0x0;
      puVar16 = (undefined4 *)(ulonglong)uVar4;
      if (-1 < (int)uVar4) {
        puVar15 = (undefined4 *)(ulonglong)local_58;
        puVar16 = puVar12;
        puVar6 = puVar15;
        if (local_210._0_8_ < puVar15) {
          if ((undefined4 *)((longlong)puVar15 + 0xfffU) < puVar15) {
            puVar16 = (undefined4 *)0x8000000b;
            puVar15 = puVar11;
            puVar6 = local_220._8_8_;
          }
          else {
            uVar14 = (ulonglong)(undefined4 *)((longlong)puVar15 + 0xfffU) & 0xfffffffffffff000;
            if (local_200._8_8_ == (LPVOID)0x0) {
              pvVar5 = HeapAlloc(local_220._0_8_,0,uVar14);
              if (pvVar5 != (LPVOID)0x0) {
                memset(pvVar5,0,uVar14);
              }
            }
            else {
              pvVar5 = HeapReAlloc(local_220._0_8_,0,local_200._8_8_,uVar14);
            }
            if (pvVar5 == (LPVOID)0x0) {
              puVar16 = (undefined4 *)0x8007000e;
              puVar15 = puVar11;
              puVar6 = local_220._8_8_;
            }
            else {
              local_200 = CONCAT88(pvVar5,local_200._0_8_);
              local_200._8_8_ = pvVar5;
            }
          }
        }
        local_220._8_8_ = puVar6;
        if (-1 < (int)puVar16) {
          if (param_5 == (undefined4 *)0x0) {
LAB_18000d8d4:
            if (param_6 != (undefined8 *)0x0) {
              local_1d8 = 0;
              puVar16 = puVar12;
              do {
                if (((puVar15 < puVar16) || (puVar11 = puVar16 + 2, puVar11 < puVar16)) ||
                   (puVar15 < puVar11)) goto LAB_18000d914;
                uVar14 = *(ulonglong *)((longlong)puVar16 + (longlong)local_200._8_8_);
                puVar16 = (undefined4 *)((uVar14 >> 0x20) + (longlong)puVar11);
                if (((puVar16 < puVar11) || ((undefined4 *)((longlong)puVar16 + 3U) < puVar16)) ||
                   (puVar16 = (undefined4 *)
                              ((ulonglong)(undefined4 *)((longlong)puVar16 + 3U) &
                              0xfffffffffffffffc), puVar15 < puVar16)) goto LAB_18000d914;
              } while ((int)uVar14 != 4);
              uVar2 = (uint)(uVar14 >> 0x20);
              if (8 < uVar2) goto LAB_18002ecdf;
              sVar10 = 8;
              if (uVar2 < 8) {
                sVar10 = uVar14 >> 0x20;
              }
              puVar16 = puVar12;
              if ((int)sVar10 != 0) {
                if (((puVar15 < puVar11) || ((undefined4 *)((longlong)puVar11 + sVar10) < puVar11))
                   || (puVar15 < (undefined4 *)((longlong)puVar11 + sVar10))) {
                  puVar16 = (undefined4 *)0x80070057;
                }
                else {
                  memcpy(&local_1d8,(void *)((longlong)puVar11 + (longlong)local_200._8_8_),sVar10);
                }
              }
              if ((int)puVar16 < 0) goto LAB_18000da22;
LAB_18000d914:
              *param_6 = local_1d8;
            }
            puVar11 = puVar12;
            if (param_7 != (undefined4 *)0x0) {
              uVar18 = 0;
              uVar17 = 0;
              local_1d0 = 0;
              puVar16 = puVar12;
              do {
                uVar19 = uVar18;
                if (((puVar15 < puVar16) || (puVar6 = puVar16 + 2, puVar6 < puVar16)) ||
                   (puVar15 < puVar6)) goto LAB_18000d957;
                uVar14 = *(ulonglong *)((longlong)puVar16 + (longlong)local_200._8_8_);
                puVar16 = (undefined4 *)((uVar14 >> 0x20) + (longlong)puVar6);
                uVar19 = uVar17;
                if (((puVar16 < puVar6) || ((undefined4 *)((longlong)puVar16 + 3U) < puVar16)) ||
                   (puVar16 = (undefined4 *)
                              ((ulonglong)(undefined4 *)((longlong)puVar16 + 3U) &
                              0xfffffffffffffffc), puVar15 < puVar16)) goto LAB_18000d957;
              } while ((int)uVar14 != 0x10);
              uVar2 = (uint)(uVar14 >> 0x20);
              if (8 < uVar2) goto LAB_18002ecdf;
              sVar10 = 8;
              if (uVar2 < 8) {
                sVar10 = uVar14 >> 0x20;
              }
              puVar16 = puVar12;
              if ((int)sVar10 != 0) {
                if (((puVar15 < puVar6) || ((undefined4 *)((longlong)puVar6 + sVar10) < puVar6)) ||
                   (puVar15 < (undefined4 *)((longlong)puVar6 + sVar10))) {
                  puVar16 = (undefined4 *)0x80070057;
                }
                else {
                  memcpy(&local_1d0,(void *)((longlong)puVar6 + (longlong)local_200._8_8_),sVar10);
                }
              }
              uVar19 = (undefined4)local_1d0;
              if ((int)puVar16 < 0) goto LAB_18000da22;
LAB_18000d957:
              *param_7 = uVar19;
            }
            do {
              puVar16 = puVar12;
              puVar6 = puVar12;
              if (((puVar15 < puVar11) || (puVar9 = puVar11 + 2, puVar9 < puVar11)) ||
                 (puVar15 < puVar9)) goto LAB_18000d9b7;
              uVar14 = *(ulonglong *)((longlong)puVar11 + (longlong)local_200._8_8_);
              puVar11 = (undefined4 *)((uVar14 >> 0x20) + (longlong)puVar9);
              if (((puVar11 < puVar9) || ((undefined4 *)((longlong)puVar11 + 3U) < puVar11)) ||
                 (puVar11 = (undefined4 *)
                            ((ulonglong)(undefined4 *)((longlong)puVar11 + 3U) & 0xfffffffffffffffc)
                 , puVar15 < puVar11)) goto LAB_18000d9b7;
            } while ((int)uVar14 != 1);
            if ((int)(uVar14 >> 0x20) == 0x1c8) {
              puVar6 = (undefined4 *)
                       RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,
                                       0x1c8);
              if (puVar6 == (undefined4 *)0x0) {
                puVar16 = (undefined4 *)0xc0000017;
                goto LAB_18002ed07;
              }
              lVar7 = 3;
              puVar11 = puVar6;
              puVar15 = (undefined4 *)((longlong)puVar9 + (longlong)local_200._8_8_);
              do {
                puVar13 = puVar15;
                puVar9 = puVar11;
                uVar17 = puVar13[1];
                uVar18 = puVar13[2];
                uVar19 = puVar13[3];
                *puVar9 = *puVar13;
                puVar9[1] = uVar17;
                puVar9[2] = uVar18;
                puVar9[3] = uVar19;
                uVar17 = puVar13[5];
                uVar18 = puVar13[6];
                uVar19 = puVar13[7];
                puVar9[4] = puVar13[4];
                puVar9[5] = uVar17;
                puVar9[6] = uVar18;
                puVar9[7] = uVar19;
                uVar17 = puVar13[9];
                uVar18 = puVar13[10];
                uVar19 = puVar13[0xb];
                puVar9[8] = puVar13[8];
                puVar9[9] = uVar17;
                puVar9[10] = uVar18;
                puVar9[0xb] = uVar19;
                uVar17 = puVar13[0xd];
                uVar18 = puVar13[0xe];
                uVar19 = puVar13[0xf];
                puVar9[0xc] = puVar13[0xc];
                puVar9[0xd] = uVar17;
                puVar9[0xe] = uVar18;
                puVar9[0xf] = uVar19;
                uVar17 = puVar13[0x11];
                uVar18 = puVar13[0x12];
                uVar19 = puVar13[0x13];
                puVar9[0x10] = puVar13[0x10];
                puVar9[0x11] = uVar17;
                puVar9[0x12] = uVar18;
                puVar9[0x13] = uVar19;
                uVar17 = puVar13[0x15];
                uVar18 = puVar13[0x16];
                uVar19 = puVar13[0x17];
                puVar9[0x14] = puVar13[0x14];
                puVar9[0x15] = uVar17;
                puVar9[0x16] = uVar18;
                puVar9[0x17] = uVar19;
                uVar17 = puVar13[0x19];
                uVar18 = puVar13[0x1a];
                uVar19 = puVar13[0x1b];
                puVar9[0x18] = puVar13[0x18];
                puVar9[0x19] = uVar17;
                puVar9[0x1a] = uVar18;
                puVar9[0x1b] = uVar19;
                uVar17 = puVar13[0x1d];
                uVar18 = puVar13[0x1e];
                uVar19 = puVar13[0x1f];
                puVar9[0x1c] = puVar13[0x1c];
                puVar9[0x1d] = uVar17;
                puVar9[0x1e] = uVar18;
                puVar9[0x1f] = uVar19;
                lVar7 = lVar7 + -1;
                puVar11 = puVar9 + 0x20;
                puVar15 = puVar13 + 0x20;
              } while (lVar7 != 0);
              uVar17 = puVar13[0x21];
              uVar18 = puVar13[0x22];
              uVar19 = puVar13[0x23];
              puVar9[0x20] = puVar13[0x20];
              puVar9[0x21] = uVar17;
              puVar9[0x22] = uVar18;
              puVar9[0x23] = uVar19;
              uVar17 = puVar13[0x25];
              uVar18 = puVar13[0x26];
              uVar19 = puVar13[0x27];
              puVar9[0x24] = puVar13[0x24];
              puVar9[0x25] = uVar17;
              puVar9[0x26] = uVar18;
              puVar9[0x27] = uVar19;
              uVar17 = puVar13[0x29];
              uVar18 = puVar13[0x2a];
              uVar19 = puVar13[0x2b];
              puVar9[0x28] = puVar13[0x28];
              puVar9[0x29] = uVar17;
              puVar9[0x2a] = uVar18;
              puVar9[0x2b] = uVar19;
              uVar17 = puVar13[0x2d];
              uVar18 = puVar13[0x2e];
              uVar19 = puVar13[0x2f];
              puVar9[0x2c] = puVar13[0x2c];
              puVar9[0x2d] = uVar17;
              puVar9[0x2e] = uVar18;
              puVar9[0x2f] = uVar19;
              *(undefined8 *)(puVar9 + 0x30) = *(undefined8 *)(puVar13 + 0x30);
              if (param_1 != (undefined8 *)0x0) {
                *param_1 = puVar6;
                puVar6 = puVar12;
              }
              puVar15 = local_220._8_8_;
              if (param_2 != (undefined4 *)0x0) {
                *param_2 = 0x1c8;
              }
            }
LAB_18000d9b7:
            do {
              if (((puVar15 < puVar16) || (puVar11 = puVar16 + 2, puVar11 < puVar16)) ||
                 (puVar15 < puVar11)) goto LAB_18000da10;
              uVar14 = *(ulonglong *)((longlong)puVar16 + (longlong)local_200._8_8_);
              puVar16 = (undefined4 *)((uVar14 >> 0x20) + (longlong)puVar11);
              if (((puVar16 < puVar11) || ((undefined4 *)((longlong)puVar16 + 3U) < puVar16)) ||
                 (puVar16 = (undefined4 *)
                            ((ulonglong)(undefined4 *)((longlong)puVar16 + 3U) & 0xfffffffffffffffc)
                 , puVar15 < puVar16)) goto LAB_18000da10;
            } while ((int)uVar14 != 2);
            local_1f0 = (int)(uVar14 >> 0x20);
            if (local_1f0 != 0) {
              pvVar8 = (void *)RtlAllocateHeap(*(undefined8 *)
                                                (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,
                                               uVar14 >> 0x20);
              local_1e8 = pvVar8;
              if (pvVar8 == (void *)0x0) {
                puVar12 = (undefined4 *)0xc0000017;
              }
              else {
                memcpy(pvVar8,(void *)((longlong)puVar11 + (longlong)local_200._8_8_),uVar14 >> 0x20
                      );
                if (param_3 != (void **)0x0) {
                  *param_3 = pvVar8;
                  local_1e8 = (void *)0x0;
                }
                if (param_4 != (int *)0x0) {
                  *param_4 = local_1f0;
                }
              }
            }
LAB_18000da10:
            pvVar8 = local_1e8;
            if (puVar6 != (undefined4 *)0x0) {
              RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar6);
            }
            puVar16 = puVar12;
            if (pvVar8 != (void *)0x0) {
              RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pvVar8);
              goto LAB_18002ed07;
            }
          }
          else {
            uVar17 = 0;
            uVar18 = 0;
            local_1e0 = 0;
            puVar16 = puVar12;
            do {
              uVar19 = uVar17;
              if (((puVar15 < puVar16) || (puVar11 = puVar16 + 2, puVar11 < puVar16)) ||
                 (puVar15 < puVar11)) goto LAB_18000d8d1;
              uVar14 = *(ulonglong *)((longlong)puVar16 + (longlong)local_200._8_8_);
              puVar16 = (undefined4 *)((uVar14 >> 0x20) + (longlong)puVar11);
              uVar19 = uVar18;
              if (((puVar16 < puVar11) || ((undefined4 *)((longlong)puVar16 + 3U) < puVar16)) ||
                 (puVar16 = (undefined4 *)
                            ((ulonglong)(undefined4 *)((longlong)puVar16 + 3U) & 0xfffffffffffffffc)
                 , puVar15 < puVar16)) goto LAB_18000d8d1;
            } while ((int)uVar14 != 8);
            uVar2 = (uint)(uVar14 >> 0x20);
            if (uVar2 < 9) {
              sVar10 = 8;
              if (uVar2 < 8) {
                sVar10 = uVar14 >> 0x20;
              }
              puVar16 = puVar12;
              if ((int)sVar10 != 0) {
                if (((puVar15 < puVar11) || ((undefined4 *)((longlong)puVar11 + sVar10) < puVar11))
                   || (puVar15 < (undefined4 *)((longlong)puVar11 + sVar10))) {
                  puVar16 = (undefined4 *)0x80070057;
                }
                else {
                  memcpy(&local_1e0,(void *)((longlong)puVar11 + (longlong)local_200._8_8_),sVar10);
                }
              }
              uVar19 = (undefined4)local_1e0;
              if ((int)puVar16 < 0) goto LAB_18000da22;
LAB_18000d8d1:
              *param_5 = uVar19;
              goto LAB_18000d8d4;
            }
LAB_18002ecdf:
            puVar16 = (undefined4 *)0xc0000095;
          }
        }
      }
    }
LAB_18000da22:
    if (local_228 != (wchar_t *)0x0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_228);
      goto LAB_18000da49;
    }
  }
  if (local_188 != 0) {
    RtlDestroyEnvironment();
  }
LAB_18000da5c:
  if (local_200._8_8_ != (LPVOID)0x0) {
    HeapFree(local_220._0_8_,0,local_200._8_8_);
  }
  return puVar16;
}



// WARNING: Could not reconcile some variable overlaps

void BasepConstructSxsCreateProcessMessage
               (uint *param_1,uint *param_2,longlong param_3,undefined8 param_4,undefined8 param_5,
               longlong param_6,int param_7,byte param_8,longlong param_9,uint param_10,int param_11
               ,longlong param_12,longlong param_13,longlong param_14,uint param_15,uint *param_16,
               uint *param_17,longlong *param_18)

{
  short sVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  bool bVar6;
  undefined auVar7 [16];
  int iVar8;
  uint uVar9;
  ulonglong uVar10;
  longlong *plVar11;
  undefined8 uVar12;
  uint *puVar13;
  ulonglong uVar14;
  longlong in_GS_OFFSET;
  bool bVar15;
  undefined auStackY760 [32];
  char local_287 [15];
  undefined8 local_278;
  undefined *puStack624;
  uint local_268;
  undefined local_258 [4];
  undefined auStack596 [4];
  undefined8 uStack592;
  int local_248;
  uint local_244;
  uint *local_240;
  longlong local_238;
  longlong *local_230;
  uint *local_228;
  undefined4 uStack544;
  undefined4 uStack540;
  undefined local_218 [16];
  undefined8 local_208;
  longlong local_200;
  undefined local_1f8 [16];
  undefined8 local_1e8;
  undefined4 local_1e0;
  undefined4 uStack476;
  longlong lStack472;
  undefined4 local_1d0;
  undefined4 uStack460;
  undefined4 uStack456;
  undefined4 uStack452;
  int local_1b8;
  undefined4 uStack436;
  undefined4 uStack432;
  undefined4 uStack428;
  int local_1a8;
  undefined4 uStack420;
  undefined4 uStack416;
  undefined4 uStack412;
  undefined4 local_198;
  undefined4 uStack404;
  undefined4 uStack400;
  undefined4 uStack396;
  uint local_188;
  undefined4 uStack388;
  undefined4 uStack384;
  undefined4 uStack380;
  int *local_178;
  undefined4 *local_170;
  uint *local_168;
  uint *local_160;
  uint **local_158;
  int *local_150;
  undefined local_148 [8];
  undefined4 uStack320;
  undefined4 uStack316;
  longlong local_138;
  undefined8 local_130;
  undefined8 local_128;
  undefined8 local_120;
  uint local_118;
  uint uStack276;
  uint uStack272;
  uint uStack268;
  longlong local_108;
  ulonglong local_100;
  undefined4 local_f8;
  undefined8 local_f0;
  undefined *local_e8;
  undefined4 local_e0;
  undefined local_d8 [16];
  undefined8 local_b8;
  byte local_80;
  uint *local_78;
  uint **local_70;
  int *local_68;
  int *local_60;
  undefined4 *local_58;
  ulonglong local_50;
  
                    // 0xdd40  83  BasepConstructSxsCreateProcessMessage
  local_50 = DAT_1800b2220 ^ (ulonglong)auStackY760;
  local_1e8 = param_5;
  local_238 = param_6;
  local_248 = 0;
  local_244 = 0;
  bVar15 = false;
  local_287[0] = '\0';
  local_120 = 0;
  local_200 = 0;
  local_230 = param_18;
  local_1f8 = ZEXT816(0);
  local_218 = ZEXT816(0);
  _local_258 = ZEXT816(0);
  _local_148 = ZEXT816(0);
  local_240 = param_1;
  local_228 = param_2;
  local_208 = param_4;
  memset(param_17,0,0x1c8);
  memset(param_18,0,0x58);
  param_17[0x27] = 0;
  local_b8 = 0x40;
  iVar8 = NtQueryInformationProcess();
  bVar6 = false;
  if ((-1 < iVar8) && ((local_80 & 1) != 0)) {
    bVar6 = true;
  }
  if (param_12 == 0) {
    iVar8 = FUN_18000e714(&local_248);
    if (iVar8 < 0) goto LAB_18000df8f;
    local_268 = param_15;
    local_238 = param_14;
  }
  else {
    local_278 = local_218;
    puStack624 = local_258;
    uVar10 = 0xffffffffffffffff;
    do {
      uVar14 = uVar10;
      uVar10 = uVar14 + 1;
    } while (*(short *)(param_12 + uVar10 * 2) != 0);
    if (*(short *)(param_12 + (uVar14 & 0xffffffff) * 2) == 0x5c) goto LAB_18000df8f;
    *param_17 = *param_17 | 0x400;
    iVar8 = FUN_18001e0f4(local_238,local_287);
    if (iVar8 < 0) goto LAB_18000df8f;
    if (local_287[0] != '\0') {
      *param_17 = *param_17 | 0x800;
    }
    local_238 = 0;
    local_268 = 0;
    iVar8 = RtlDosPathNameToNtPathName_U_WithStatus(param_12,local_1f8,0,0);
    if (iVar8 < 0) goto LAB_18000df8f;
    _local_258 = _local_258 & (undefined  [16])0xffffffffffff0000;
    auVar7 = _local_258;
    sVar1 = (short)uVar10 * 2;
    uVar12 = 2;
    _local_258 = ZEXT1416(CONCAT122(_auStack596,sVar1 + 0x1a)) << 0x10;
    auStack596 = SUB164(auVar7,4);
    uStack592._0_4_ = SUB164(auVar7,8);
    uStack592._4_4_ = SUB164(auVar7,0xc);
    _local_258 = _local_258 & (undefined  [16])0xffffffffffff0000;
    local_218 = ZEXT1416(CONCAT410(uStack592._4_4_,
                                   CONCAT46((undefined4)uStack592,CONCAT42(auStack596,sVar1 + 0x1a))
                                  )) << 0x10;
    _local_258 = ZEXT1416(CONCAT410(uStack592._4_4_,
                                    CONCAT46((undefined4)uStack592,
                                             CONCAT42(auStack596,local_1f8._0_2_ + 0x1a)))) << 0x10;
    uVar10 = FUN_18001d634(local_230 + 8,2,(longlong)&local_278);
    if ((int)uVar10 < 0) goto LAB_18000df8f;
    local_1e0 = CONCAT22(sVar1,sVar1);
    local_1d0 = 0x1a0018;
    uStack460 = 0;
    uStack456 = 0x80086be0;
    uStack452 = 1;
    lStack472 = param_12;
    uVar12 = FUN_18001db54(local_218,uVar12,(longlong)&local_1e0);
    if ((int)uVar12 < 0) goto LAB_18000df8f;
    *(undefined2 *)(local_218._8_8_ + (ulonglong)(local_218._0_2_ >> 1) * 2) = 0;
    local_1e0 = local_1f8._0_4_;
    uStack476 = local_1f8._4_4_;
    lStack472 = SUB168(local_1f8 >> 0x40,0);
    uVar12 = FUN_18001db54(local_258,0,(longlong)&local_1e0);
    plVar11 = local_230;
    if ((int)uVar12 < 0) goto LAB_18000df8f;
    *(undefined2 *)(uStack592 + (ulonglong)(local_258._0_2_ >> 1) * 2) = 0;
    local_228 = (uint *)local_218;
    local_240 = (uint *)local_258;
    local_f0 = 0;
    local_f8 = 0x30;
    local_e0 = 0x40;
    local_d8 = ZEXT816(0);
    local_e8 = local_1f8;
    iVar8 = NtOpenFile();
    if (iVar8 < 0) goto LAB_18000df8f;
    bVar15 = param_7 == 0;
    param_3 = plVar11[10];
  }
  if (param_11 == 0) {
    if ((bVar6) ||
       ((((local_248 == 0 && (param_7 == 0)) && (uVar9 = FUN_18000e1e0(param_3), uVar9 == 0)) &&
        (DAT_7ffe02ec == '\0')))) {
      if (param_9 != 0) {
        *(ulonglong *)(param_17 + 0xe) = (ulonglong)param_10;
        *(longlong *)(param_17 + 0xc) = param_9;
      }
      uVar9 = local_240[1];
      uVar2 = local_240[2];
      uVar3 = local_240[3];
      param_17[8] = *local_240;
      param_17[9] = uVar9;
      param_17[10] = uVar2;
      param_17[0xb] = uVar3;
      uVar2 = *local_228;
      uVar3 = local_228[1];
      uVar4 = local_228[2];
      uVar5 = local_228[3];
      *(longlong *)(param_17 + 0x14) = local_238;
      param_17[0x16] = local_268;
      uVar9 = *param_17;
      *(longlong *)(param_17 + 2) = param_3;
      *param_17 = uVar9 | 0x40;
      param_17[4] = uVar2;
      param_17[5] = uVar3;
      param_17[6] = uVar4;
      param_17[7] = uVar5;
      if (bVar15) {
        *param_17 = uVar9 | 0x240;
      }
    }
    else {
      puVar13 = local_228;
      sVar1 = *(short *)local_228;
      local_168 = local_228;
      local_160 = local_240;
      local_278._4_4_ = (undefined4)(((ulonglong)local_278 & 0xffffffff00000000) >> 0x20);
      local_278._0_4_ = (int)CONCAT42(local_278._4_4_,sVar1 + 0x10) << 0x10;
      local_1b8 = (uint)local_278;
      local_228 = (uint *)((ulonglong)local_278 & 0xffffffff00000000 |
                          (ulonglong)(ushort)(sVar1 + 0x14) << 0x10);
      uStack544 = 0;
      uStack540 = 0;
      local_278._0_4_ = (int)CONCAT42(local_278._4_4_,sVar1 + 2) << 0x10;
      local_188 = (uint)local_278;
      uStack436 = local_278._4_4_;
      uStack432 = 0;
      uStack428 = 0;
      local_278._0_4_ = (int)CONCAT42(local_278._4_4_,*(short *)local_240 + 0x14) << 0x10;
      local_158 = &local_228;
      local_150 = &local_1a8;
      local_178 = &local_1b8;
      local_170 = &local_198;
      local_78 = &local_188;
      local_70 = &local_228;
      local_68 = &local_1b8;
      uStack388 = local_278._4_4_;
      uStack384 = 0;
      uStack380 = 0;
      plVar11 = local_230 + 8;
      local_60 = &local_1a8;
      local_1a8 = (uint)local_278;
      uStack420 = local_278._4_4_;
      uStack416 = 0;
      uStack412 = 0;
      local_58 = &local_198;
      local_278 = (undefined *)
                  ((ulonglong)CONCAT42(local_278._4_4_,*(short *)local_240 + 0x10) << 0x10);
      puStack624 = (undefined *)0x0;
      local_198 = (uint)local_278;
      uStack404 = local_278._4_4_;
      uStack400 = 0;
      uStack396 = 0;
      if (*plVar11 != 0) {
        local_200 = *plVar11;
        *plVar11 = 0;
      }
      uVar10 = FUN_18001d634(plVar11,5,(longlong)&local_78);
      if ((int)uVar10 < 0) goto LAB_18000df8f;
      local_130 = local_208;
      local_128 = local_1e8;
      if (param_9 != 0) {
        local_118 = *puVar13;
        uStack276 = puVar13[1];
        uStack272 = puVar13[2];
        uStack268 = puVar13[3];
        local_100 = (ulonglong)param_10;
        local_108 = param_9;
      }
      puVar13 = &local_118;
      if (param_9 == 0) {
        puVar13 = (uint *)0x0;
      }
      local_138 = param_3;
      uVar10 = FUN_180042b28((int *)puVar13,(longlong)puVar13,local_238,local_268,
                             (longlong *)&local_158,local_230,(longlong *)&local_168,&local_138,
                             (longlong *)&local_178,local_230 + 4,&local_188,param_13,param_17);
      if ((int)uVar10 < 0) goto LAB_18000df8f;
    }
    puVar13 = local_240;
    if ((param_12 == 0) || (local_287[0] != '\0')) {
      iVar8 = FUN_18000e258((undefined4 *)local_148);
      if (iVar8 < 0) goto LAB_18000df8f;
    }
    else {
      local_148._0_4_ = 0x60004;
      local_148._4_4_ = 0;
      uStack320 = 0x80086bfc;
      uStack316 = 1;
    }
    uVar9 = *param_17;
    *(undefined (*) [16])(param_17 + 0x22) =
         CONCAT412(uStack316,CONCAT48(uStack320,CONCAT44(local_148._4_4_,local_148._0_4_)));
    if (param_7 != 0) {
      uVar9 = uVar9 | 0x80;
      *param_17 = uVar9;
    }
    if ((uVar9 & 1) != 0) {
      *param_16 = *param_16 | 0x2000;
      uVar9 = *param_17;
    }
    if ((param_8 & 1) != 0) {
      uVar9 = uVar9 | 0x10;
      *param_17 = uVar9;
    }
    if ((uVar9 & 0x41) != 0) {
      RtlInitUnicodeString(param_17 + 0x2a);
    }
  }
  else {
    *param_17 = *param_17 | 0x20;
    puVar13 = local_240;
  }
  if (param_7 == 0) {
    if (((*(byte *)param_17 & 0x41) == 0) && (param_12 == 0)) goto LAB_18002f054;
  }
  else {
    *param_16 = *param_16 | 0x8000;
LAB_18002f054:
    if (!bVar15) {
      iVar8 = FUN_18006ab84((ushort *)puVar13,(uint)(param_12 != 0),&local_244);
      if (iVar8 < 0) goto LAB_18000df8f;
      if (local_244 != 0) {
        *param_16 = *param_16 | 0x1000;
      }
    }
  }
  param_17[1] = *param_16;
LAB_18000df8f:
  RtlFreeUnicodeString(local_1f8);
  if (local_200 != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_200);
  }
  __security_check_cookie(local_50 ^ (ulonglong)auStackY760);
  return;
}



uint FUN_18000e1e0(undefined8 param_1)

{
  int iVar1;
  uint local_res18;
  uint uStackX28;
  undefined local_18 [16];
  
  iVar1 = NtQueryVolumeInformationFile(param_1,local_18,&local_res18,8,4);
  if (iVar1 < 0) {
    DbgPrint("BasepIsRemovableMedia: NtQueryVolumeInformationFile failed 0x%lx\n",iVar1);
    uStackX28 = 1;
  }
  else {
    uStackX28 = uStackX28 & 0x11;
    if (uStackX28 == 0) {
      if (local_res18 < 2) {
        return 0;
      }
      if (((3 < local_res18) && (local_res18 != 0x12)) && (local_res18 != 0x14)) {
        return 0;
      }
      uStackX28 = 1;
    }
    DbgPrint("BasepIsRemovableMedia: Host device is removable, Shim cache deactivated\n");
  }
  return uStackX28;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18000e258(undefined4 *param_1)

{
  bool bVar1;
  undefined auVar2 [16];
  int iVar3;
  undefined8 uVar4;
  short sVar5;
  short *psVar6;
  bool bVar7;
  undefined auStack152 [40];
  undefined local_70 [8];
  undefined2 *local_68;
  undefined local_60 [8];
  ulonglong uStack88;
  undefined local_50 [16];
  undefined local_40 [16];
  undefined8 local_30;
  ulonglong local_28;
  
  local_28 = DAT_1800b2220 ^ (ulonglong)auStack152;
  local_30 = 0;
  _local_60 = ZEXT816(0);
  local_50 = ZEXT816(0);
  bVar1 = true;
  local_40 = ZEXT816(0);
  *param_1 = 0x60004;
  param_1[1] = 0;
  param_1[2] = 0x80086bfc;
  param_1[3] = 1;
  if (DAT_1800b2d08 != (short *)0x0) {
LAB_18000e2c7:
    sVar5 = DAT_1800b2cb8;
    if (DAT_1800b2cb8 == 0) {
      bVar7 = false;
      sVar5 = 0;
      psVar6 = DAT_1800b2d08;
      do {
        sVar5 = sVar5 + 1;
        if (*psVar6 == 0) {
          if (bVar7) goto LAB_18002f11e;
          bVar7 = true;
        }
        else {
          bVar7 = false;
        }
        psVar6 = psVar6 + 1;
      } while( true );
    }
    goto LAB_18000e2d0;
  }
  local_40 = CONCAT88(2,2);
  local_50 = CONCAT88(&local_30,&local_30);
  local_30 = 0;
  _local_60 = ZEXT816(&local_30) << 0x40;
  _local_60 = CONCAT124(stack0xffffffffffffffa4,0x20000);
  iVar3 = RtlpEnsureBufferSize(0,local_50,0x82);
  auVar2 = _local_60;
  if (-1 < iVar3) {
    _local_60 = CONCAT88(local_50._0_8_,local_60);
    local_60._0_2_ = SUB162(auVar2,0);
    uVar4 = FUN_180014c50(0x10008,(short *)local_60);
    if (-1 < (int)uVar4) {
      LOCK();
      bVar7 = DAT_1800b2d08 == (short *)0x0;
      DAT_1800b2d08 =
           (short *)((ulonglong)DAT_1800b2d08 ^
                    (ulonglong)bVar7 * ((ulonglong)DAT_1800b2d08 ^ uStack88));
      if (bVar7) {
        DAT_1800b2cb8 = local_60._0_2_;
        bVar1 = false;
      }
      goto LAB_18000e2c7;
    }
  }
  goto LAB_18000e2e0;
LAB_18002f11e:
  sVar5 = sVar5 * 2;
LAB_18000e2d0:
  *(short **)(param_1 + 2) = DAT_1800b2d08;
  *(short *)param_1 = sVar5;
  *(short *)((longlong)param_1 + 2) = sVar5;
  if (!bVar1) goto LAB_18000e2fa;
LAB_18000e2e0:
  if ((local_50._0_8_ != (undefined2 *)0x0) && (local_50._0_8_ != local_50._8_8_)) {
    local_68 = local_50._0_8_;
    RtlFreeUnicodeString(local_70);
  }
  if (local_50._8_8_ != (undefined2 *)0x0) {
    *local_50._8_8_ = 0;
  }
LAB_18000e2fa:
  __security_check_cookie(local_28 ^ (ulonglong)auStack152);
  return;
}



uint FUN_18000e3d0(wchar_t **param_1,LPCWSTR param_2)

{
  uint uVar1;
  DWORD DVar2;
  int iVar3;
  wchar_t *pwVar4;
  wchar_t *pwVar5;
  undefined uVar6;
  undefined uVar7;
  longlong in_GS_OFFSET;
  uint local_res8 [4];
  int local_res18 [2];
  wchar_t *local_res20;
  undefined uVar8;
  wchar_t *local_38 [2];
  
  *param_1 = (wchar_t *)0x0;
  local_res18[0] = 0;
  local_res8[0] = 0;
  local_38[0] = (wchar_t *)0x0;
  local_res20 = (wchar_t *)0x0;
  uVar1 = FUN_18000ea14(local_38,param_2);
  pwVar4 = local_38[0];
  if ((int)uVar1 < 0) {
    FUN_18001188c(1,0xf0,0x65,0xb8,(char)param_2);
    pwVar4 = local_38[0];
    goto LAB_18000e463;
  }
  uVar1 = FUN_18000eb88(local_res8,local_38[0]);
  uVar8 = SUB81(pwVar4,0);
  if ((int)uVar1 < 0) {
    FUN_18001188c(1,0xf0,0x6f,0x10,uVar8);
    goto LAB_18000e463;
  }
  if (local_res8[0] == 0) {
    DVar2 = FUN_18000e480(local_res18,pwVar4);
    iVar3 = local_res18[0];
    if ((int)DVar2 < 0) {
      FUN_18001188c(2,0xf0,0x7d,0x80,uVar8);
      iVar3 = 0;
    }
    pwVar5 = (wchar_t *)0x0;
    if (iVar3 == 0) {
LAB_18000e44f:
      *param_1 = pwVar4;
      pwVar4 = (wchar_t *)0x0;
      local_38[0] = (wchar_t *)0x0;
    }
    else {
      uVar1 = FUN_180071114(&local_res20,pwVar4);
      if ((int)uVar1 < 0) {
        uVar7 = 0xc0;
        uVar6 = 0x89;
        goto LAB_18002f1da;
      }
LAB_18002f23d:
      pwVar5 = local_res20;
      if (local_res20 == (wchar_t *)0x0) goto LAB_18000e44f;
      *param_1 = local_res20;
      pwVar5 = (wchar_t *)0x0;
      local_res20 = (wchar_t *)0x0;
    }
    uVar1 = 0;
  }
  else {
    uVar1 = FUN_180070e60(&local_res20,pwVar4);
    if (-1 < (int)uVar1) goto LAB_18002f23d;
    uVar7 = 0x40;
    uVar6 = 0x76;
LAB_18002f1da:
    FUN_18001188c(1,0xf0,uVar6,uVar7,uVar8);
    pwVar5 = local_res20;
  }
  if (pwVar5 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_res20);
    pwVar4 = local_38[0];
  }
LAB_18000e463:
  if (pwVar4 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_38[0]);
  }
  return uVar1;
}



// WARNING: Could not reconcile some variable overlaps

DWORD FUN_18000e480(undefined4 *param_1,wchar_t *param_2)

{
  DWORD DVar1;
  int iVar2;
  DWORD DVar3;
  longlong lVar4;
  LPWSTR pWVar5;
  ulonglong uVar6;
  LPCWSTR lpSrc;
  undefined uVar7;
  undefined uVar8;
  undefined4 uVar9;
  LPWSTR pWVar10;
  LPCWSTR lpDst;
  longlong in_GS_OFFSET;
  undefined4 local_res18 [2];
  longlong local_res20;
  undefined in_stack_ffffffffffffff68;
  undefined4 uVar11;
  undefined local_88 [8];
  longlong lStack128;
  undefined local_78 [16];
  undefined4 local_68;
  undefined8 local_60;
  undefined *local_58;
  undefined4 local_50;
  undefined local_48 [16];
  
  pWVar10 = (LPWSTR)0x0;
  local_res18[0] = 0;
  _local_88 = CONCAT124(SUB1612(ZEXT816(0) >> 0x20,0),0x2080000);
  local_res20 = 0;
  local_78 = ZEXT816(0);
  lpDst = (LPWSTR)0x0;
  uVar9 = 0;
  lVar4 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,0x208);
  _local_88 = CONCAT88(lVar4,local_88);
  pWVar5 = pWVar10;
  if (lVar4 == 0) {
    DVar1 = 0xc0000017;
    uVar8 = 0x98;
    uVar7 = 0x8c;
    goto LAB_18002f2d3;
  }
  DVar1 = RtlFormatCurrentUserKeyPath(local_78);
  if ((int)DVar1 < 0) {
    uVar8 = 0x88;
    uVar7 = 0x92;
    lpDst = pWVar10;
  }
  else {
    DVar1 = RtlAppendUnicodeStringToString(local_88,local_78);
    if ((int)DVar1 < 0) {
      uVar8 = 8;
      uVar7 = 0x98;
      lpDst = pWVar10;
    }
    else {
      DVar1 = RtlAppendUnicodeToString
                        (local_88,
                         L"\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders")
      ;
      if ((int)DVar1 < 0) {
        uVar8 = 0x48;
        uVar7 = 0x9e;
        lpDst = pWVar10;
      }
      else {
        local_58 = local_88;
        local_68 = 0x30;
        local_60 = 0;
        local_50 = 0x40;
        local_48 = ZEXT816(0);
        DVar1 = ZwOpenKey(&local_res20,1);
        if ((int)DVar1 < 0) {
          pWVar10 = lpDst;
          uVar11 = 0;
          if (DVar1 == 0xc0000034) {
LAB_18000e658:
            uVar9 = uVar11;
            DVar1 = 0;
            goto LAB_18000e65b;
          }
          uVar8 = 0x20;
          uVar7 = 0xad;
        }
        else {
          pWVar5 = (LPWSTR)RtlAllocateHeap(*(undefined8 *)
                                            (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8);
          if (pWVar5 == (LPWSTR)0x0) {
            uVar7 = 0xb7;
LAB_18002f2c5:
            uVar8 = 0x98;
            DVar1 = 0xc0000017;
LAB_18002f2d3:
            FUN_18001188c(1,0xe8,uVar7,uVar8,in_stack_ffffffffffffff68);
            goto LAB_18000e65b;
          }
          in_stack_ffffffffffffff68 = 8;
          DVar1 = NtQueryValueKey(local_res20,&DAT_18007f010,1,pWVar5,0x208,local_res18);
          if (DVar1 == 0xc0000023) {
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
            pWVar5 = (LPWSTR)RtlAllocateHeap(*(undefined8 *)
                                              (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8);
            if (pWVar5 == (LPWSTR)0x0) {
              uVar7 = 199;
              goto LAB_18002f2c5;
            }
            uVar11 = local_res18[0];
            DVar1 = NtQueryValueKey(local_res20,&DAT_18007f010,1,pWVar5,local_res18[0],local_res18);
            in_stack_ffffffffffffff68 = (undefined)uVar11;
          }
          uVar11 = 0;
          if (DVar1 == 0xc0000034) goto LAB_18000e658;
          if ((int)DVar1 < 0) {
            uVar8 = 0x90;
            uVar7 = 0xdb;
          }
          else {
            if (1 < *(int *)(pWVar5 + 2) - 1U) {
              DVar1 = 0xc000014c;
              uVar8 = 0xe0;
              uVar7 = 0xe1;
              goto LAB_18002f2d3;
            }
            lpSrc = (LPCWSTR)((ulonglong)*(uint *)(pWVar5 + 4) + (longlong)pWVar5);
            *(undefined2 *)(((ulonglong)*(uint *)(pWVar5 + 6) - 2) + (longlong)lpSrc) = 0;
            uVar6 = 0xffffffffffffffff;
            do {
              uVar6 = uVar6 + 1;
            } while (lpSrc[uVar6] != L'\0');
            lpDst = lpSrc;
            if (*(int *)(pWVar5 + 2) != 2) {
LAB_18000e644:
              iVar2 = _wcsnicmp(lpDst,param_2,uVar6 & 0xffffffff);
              uVar11 = 0;
              if (iVar2 == 0) {
                uVar11 = 1;
              }
              goto LAB_18000e658;
            }
            DVar1 = ExpandEnvironmentStringsW(lpSrc,(LPWSTR)0x0,0);
            if (DVar1 == 0) {
              DVar1 = GetLastError();
              if ((int)DVar1 < 1) {
                DVar1 = GetLastError();
              }
              else {
                DVar1 = GetLastError();
                DVar1 = DVar1 & 0xffff | 0xc0070000;
              }
              uVar8 = 0x40;
              uVar7 = 0xef;
              lpDst = pWVar10;
            }
            else {
              lpDst = (LPCWSTR)RtlAllocateHeap(*(undefined8 *)
                                                (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8);
              pWVar10 = lpDst;
              if (lpDst == (LPWSTR)0x0) {
                DVar1 = 0xc0000017;
                FUN_18001188c(1,0xe8,0xf6,0x98,in_stack_ffffffffffffff68);
                goto LAB_18000e65b;
              }
              DVar3 = ExpandEnvironmentStringsW(lpSrc,lpDst,DVar1);
              if ((DVar3 != 0) && (DVar3 <= DVar1)) {
                uVar6 = (ulonglong)(DVar3 - 1);
                goto LAB_18000e644;
              }
              DVar1 = GetLastError();
              if ((int)DVar1 < 1) {
                DVar1 = GetLastError();
              }
              else {
                DVar1 = GetLastError();
                DVar1 = DVar1 & 0xffff | 0xc0070000;
              }
              uVar8 = 0x40;
              uVar7 = 0xfd;
            }
          }
        }
      }
    }
  }
  FUN_18001188c(1,0xe8,uVar7,uVar8,(char)DVar1);
  pWVar10 = lpDst;
LAB_18000e65b:
  if (local_78._8_8_ != 0) {
    RtlFreeUnicodeString(local_78);
  }
  if (lStack128 != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lStack128);
  }
  if (pWVar5 != (LPWSTR)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pWVar5);
  }
  if (local_res20 != 0) {
    NtClose();
  }
  if (pWVar10 != (LPWSTR)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pWVar10);
  }
  *param_1 = uVar9;
  return DVar1;
}



void FUN_18000e714(int *param_1)

{
  int iVar1;
  int iVar2;
  undefined auStack168 [32];
  undefined4 local_88;
  undefined *local_80;
  longlong local_78;
  undefined local_70 [8];
  undefined local_68 [16];
  undefined4 local_58 [2];
  undefined8 local_50;
  undefined *local_48;
  undefined4 local_40;
  undefined local_38 [16];
  undefined local_28 [4];
  int local_24;
  int local_20;
  int local_1c;
  ulonglong local_10;
  
  local_10 = DAT_1800b2220 ^ (ulonglong)auStack168;
  *param_1 = 0;
  local_78 = 0;
  iVar1 = DAT_1800b2304;
  if (DAT_1800b2304 == -1) {
    RtlInitUnicodeString
              (local_68,
               L"\\Registry\\MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\SideBySide");
    local_50 = 0;
    local_48 = local_68;
    local_58[0] = 0x30;
    local_40 = 0x40;
    local_38 = ZEXT816(0);
    iVar1 = NtOpenKey(&local_78,0x20019,local_58);
    if (iVar1 < 0) goto LAB_18000e808;
    RtlInitUnicodeString(local_68,L"PreferExternalManifest");
    local_80 = local_70;
    local_88 = 0x14;
    iVar1 = NtQueryValueKey(local_78,local_68,2,local_28);
    if (iVar1 < 0) goto LAB_18000e808;
    if (((local_24 != 4) || (local_20 != 4)) || (local_1c == -1)) {
      local_1c = 1;
    }
    iVar2 = -1;
    LOCK();
    iVar1 = local_1c;
    if (DAT_1800b2304 != -1) {
      iVar2 = DAT_1800b2304;
      iVar1 = DAT_1800b2304;
    }
    DAT_1800b2304 = iVar1;
    iVar1 = local_1c;
    if (iVar2 != -1) {
      iVar1 = iVar2;
    }
  }
  *param_1 = iVar1;
LAB_18000e808:
  if (local_78 != 0) {
    NtClose();
  }
  __security_check_cookie(local_10 ^ (ulonglong)auStack168);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18000e84c(uint *param_1,undefined8 param_2)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  longlong in_GS_OFFSET;
  bool bVar6;
  undefined auStack216 [32];
  undefined4 local_b8;
  undefined *local_b0;
  ulonglong local_a8;
  longlong local_a0;
  undefined local_98 [8];
  undefined local_90 [16];
  undefined local_80 [16];
  undefined4 local_70 [2];
  ulonglong local_68;
  undefined *local_60;
  undefined4 local_58;
  undefined local_50 [16];
  undefined local_40 [16];
  ulonglong local_30;
  uint uVar5;
  
  local_30 = DAT_1800b2220 ^ (ulonglong)auStack216;
  uVar5 = 0;
  uVar4 = 0;
  local_80 = ZEXT816(0);
  iVar2 = *(int *)(*(longlong *)(in_GS_OFFSET + 0x30) + 0x179c);
  local_a0 = 0;
  local_a8 = DAT_1800b2da8;
  if ((iVar2 == 0) && (DAT_1800b2da8 != 0)) {
LAB_18000e8b0:
    iVar2 = RtlInitUnicodeStringEx(local_90,L"AppCompatFlags\\Layers");
    uVar1 = uVar5;
    if (-1 < iVar2) {
      local_68 = local_a8;
      local_60 = local_90;
      local_70[0] = 0x30;
      local_58 = 0x40;
      local_50 = ZEXT816(0);
      iVar2 = NtOpenKey(&local_a0,0x101,local_70);
      if (iVar2 < 0) {
        local_a0 = 0;
      }
      else {
        iVar2 = RtlInitUnicodeStringEx(local_90,param_2);
        if (-1 < iVar2) {
          local_b0 = local_98;
          local_b8 = 0x10;
          iVar2 = NtQueryValueKey(local_a0,local_90,2,local_40);
          uVar1 = (uint)(iVar2 != -0x3fffffcc);
        }
      }
    }
  }
  else {
    iVar3 = FUN_18000f380((undefined2 *)local_80,
                          (longlong)L"\\Software\\Microsoft\\Windows NT\\CurrentVersion");
    uVar1 = 0;
    if (-1 < iVar3) {
      local_68 = 0;
      local_60 = local_80;
      local_70[0] = 0x30;
      local_58 = 0x40;
      local_50 = ZEXT816(0);
      iVar3 = NtOpenKey(&local_a8,8,local_70);
      if (iVar3 < 0) {
        local_a8 = 0;
        goto LAB_18000e922;
      }
      if (iVar2 == 0) {
        LOCK();
        bVar6 = DAT_1800b2da8 == 0;
        DAT_1800b2da8 = DAT_1800b2da8 ^ (ulonglong)bVar6 * (DAT_1800b2da8 ^ local_a8);
        if (!bVar6) {
          NtClose(local_a8);
          local_a8 = DAT_1800b2da8;
        }
      }
      goto LAB_18000e8b0;
    }
  }
  uVar4 = uVar1;
  if ((local_a8 != 0) && (local_a8 != DAT_1800b2da8)) {
    NtClose();
  }
LAB_18000e922:
  if (local_a0 != 0) {
    NtClose();
  }
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_80._8_8_);
  *param_1 = uVar4;
  __security_check_cookie(local_30 ^ (ulonglong)auStack216);
  return;
}



uint FUN_18000ea14(LPWSTR *param_1,LPCWSTR param_2)

{
  bool bVar1;
  uint uVar2;
  DWORD DVar3;
  DWORD DVar4;
  wchar_t *pwVar5;
  LPWSTR lpszLongPath;
  undefined uVar6;
  longlong in_GS_OFFSET;
  undefined4 in_stack_ffffffffffffffd8;
  
  *param_1 = (LPWSTR)0x0;
  bVar1 = false;
  pwVar5 = wcsstr(param_2,L"SIGN.MEDIA=");
  if (pwVar5 == (wchar_t *)0x0) {
    pwVar5 = wcschr(param_2,L'~');
    if (pwVar5 != (wchar_t *)0x0) {
      DVar4 = 0x104;
      do {
        lpszLongPath = (LPWSTR)RtlAllocateHeap(*(undefined8 *)
                                                (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8);
        if (lpszLongPath == (LPWSTR)0x0) {
          return 0xc0000017;
        }
        DVar3 = GetLongPathNameW(param_2,lpszLongPath,DVar4);
        if (DVar3 == 0) {
          uVar2 = 0xc0000001;
          DVar4 = GetLastError();
          FUN_18001188c(1,0xe0,0x6e,0,(char)DVar4);
          goto LAB_18002f70f;
        }
        if (DVar4 < DVar3) {
          if (bVar1) {
            uVar2 = 0xc0000023;
            FUN_18001188c(1,0xe0,0x77,0x28,(char)in_stack_ffffffffffffffd8);
            goto LAB_18002f70f;
          }
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
          lpszLongPath = (LPWSTR)0x0;
          DVar4 = DVar3;
        }
        bVar1 = true;
      } while (DVar4 <= DVar3);
      *param_1 = lpszLongPath;
      lpszLongPath = (LPWSTR)0x0;
      uVar2 = 0;
LAB_18002f70f:
      if (lpszLongPath == (LPWSTR)0x0) {
        return uVar2;
      }
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpszLongPath);
      return uVar2;
    }
    uVar2 = FUN_18000eaac(param_1,param_2);
    if (-1 < (int)uVar2) {
      return uVar2;
    }
    uVar6 = 0x5e;
  }
  else {
    uVar2 = FUN_18000eaac(param_1,param_2);
    if (-1 < (int)uVar2) {
      return uVar2;
    }
    uVar6 = 0x4b;
  }
  FUN_18001188c(1,0xe0,uVar6,0xc0,(char)uVar2);
  return uVar2;
}



uint FUN_18000eaac(short **param_1,short *param_2)

{
  ulonglong uVar1;
  uint uVar2;
  short *psVar3;
  undefined uVar4;
  undefined uVar5;
  longlong in_GS_OFFSET;
  ulonglong local_res8;
  undefined in_stack_ffffffffffffffe8;
  
  *param_1 = (short *)0x0;
  if (param_2 == (short *)0x0) {
    uVar2 = 0;
  }
  else {
    uVar2 = FUN_18000ed58(param_2,param_2,(longlong *)&local_res8);
    if ((int)uVar2 < 0) {
      uVar5 = 0x38;
      uVar4 = 0x35;
    }
    else {
      uVar1 = local_res8 + 1;
      if (uVar1 < local_res8) {
        uVar4 = 0x40;
      }
      else {
        if (SUB168(ZEXT816(2) * ZEXT816(uVar1) >> 0x40,0) == 0) {
          psVar3 = (short *)RtlAllocateHeap(*(undefined8 *)
                                             (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,
                                            SUB168(ZEXT816(2) * ZEXT816(uVar1),0));
          if (psVar3 == (short *)0x0) {
            FUN_18001188c(1,0xe8,0x4d,0x98,in_stack_ffffffffffffffe8);
            return 0xc0000017;
          }
          uVar2 = FUN_18000ecd4(psVar3,uVar1,(longlong)param_2);
          if ((int)uVar2 < 0) {
            FUN_18001188c(1,0xe8,0x57,0x50,(char)uVar2);
          }
          else {
            *param_1 = psVar3;
            psVar3 = (short *)0x0;
            uVar2 = 0;
          }
          if (psVar3 == (short *)0x0) {
            return uVar2;
          }
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,psVar3);
          return uVar2;
        }
        uVar4 = 0x46;
      }
      uVar5 = 200;
      uVar2 = 0xc0000095;
    }
    FUN_18001188c(1,0xe8,uVar4,uVar5,(char)uVar2);
  }
  return uVar2;
}



void FUN_18000eb88(uint *param_1,wchar_t *param_2)

{
  wchar_t wVar1;
  int iVar2;
  UINT UVar3;
  ulonglong uVar4;
  wchar_t *pwVar5;
  wchar_t *pwVar6;
  longlong lVar7;
  size_t _MaxCount;
  uint uVar8;
  undefined uVar9;
  undefined auStackY120 [32];
  wchar_t local_48 [8];
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStackY120;
  _MaxCount = 0xffffffffffffffff;
  uVar4 = 0xffffffffffffffff;
  uVar8 = 0;
  do {
    uVar4 = uVar4 + 1;
  } while (param_2[uVar4] != L'\0');
  if (uVar4 < 8) {
    uVar9 = 7;
  }
  else {
    if (param_2[1] == L':') {
      lVar7 = 5;
      pwVar6 = local_48;
      do {
        if ((lVar7 == -0x7ffffff9) ||
           (wVar1 = *(wchar_t *)(((longlong)&DAT_1800855f0 - (longlong)local_48) + (longlong)pwVar6)
           , wVar1 == L'\0')) break;
        *pwVar6 = wVar1;
        pwVar6 = pwVar6 + 1;
        lVar7 = lVar7 + -1;
      } while (lVar7 != 0);
      pwVar5 = pwVar6 + -1;
      if (lVar7 != 0) {
        pwVar5 = pwVar6;
      }
      *pwVar5 = L'\0';
      if (lVar7 == 0) {
        FUN_18001188c(1,0xa0,0x23,0xc0,~-(lVar7 != 0) & 5);
      }
      else {
        local_48[0] = *param_2;
        pwVar6 = (wchar_t *)FUN_18001b894();
        do {
          _MaxCount = _MaxCount + 1;
        } while (local_48[_MaxCount] != L'\0');
        iVar2 = _wcsnicmp(local_48,pwVar6,_MaxCount);
        if ((iVar2 != 0) && (UVar3 = GetDriveTypeW(local_48), (UVar3 - 2 & 0xfffffffc) == 0)) {
          uVar8 = (uint)(UVar3 != 3);
        }
      }
      goto LAB_18000ec73;
    }
    if (param_2[1] == L'\\') goto LAB_18000ec73;
    uVar9 = 0x12;
  }
  FUN_18001188c(1,0xa0,uVar9,0x70,(char)param_2);
LAB_18000ec73:
  *param_1 = uVar8;
  __security_check_cookie(local_38 ^ (ulonglong)auStackY120);
  return;
}



uint FUN_18000ecd4(short *param_1,longlong param_2,longlong param_3)

{
  short sVar1;
  short *psVar2;
  longlong lVar3;
  uint uVar4;
  longlong lVar5;
  
  uVar4 = 0;
  if (0x7ffffffe < param_2 - 1U) {
    uVar4 = 0xc000000d;
  }
  if ((int)uVar4 < 0) {
    if (param_2 != 0) {
      *param_1 = 0;
    }
  }
  else {
    if (param_2 != 0) {
      lVar5 = 0x7ffffffe - param_2;
      lVar3 = param_3 - (longlong)param_1;
      do {
        if ((lVar5 + param_2 == 0) || (sVar1 = *(short *)(lVar3 + (longlong)param_1), sVar1 == 0))
        break;
        *param_1 = sVar1;
        param_1 = param_1 + 1;
        param_2 = param_2 + -1;
      } while (param_2 != 0);
    }
    psVar2 = param_1 + -1;
    if (param_2 != 0) {
      psVar2 = param_1;
    }
    uVar4 = ~-(uint)(param_2 != 0) & 0x80000005;
    *psVar2 = 0;
  }
  return uVar4;
}



void FUN_18000ed58(short *param_1,undefined8 param_2,longlong *param_3)

{
  uint uVar1;
  longlong lVar2;
  
  if (param_1 == (short *)0x0) {
    uVar1 = 0xc000000d;
  }
  else {
    lVar2 = 0x7fffffff;
    do {
      if (*param_1 == 0) break;
      param_1 = param_1 + 1;
      lVar2 = lVar2 + -1;
    } while (lVar2 != 0);
    uVar1 = ~-(uint)(lVar2 != 0) & 0xc000000d;
    if (param_3 != (longlong *)0x0) {
      if (lVar2 == 0) {
        *param_3 = 0;
      }
      else {
        *param_3 = 0x7fffffff - lVar2;
      }
    }
  }
  if (((int)uVar1 < 0) && (param_3 != (longlong *)0x0)) {
    *param_3 = 0;
    return;
  }
  return;
}



void FUN_18000edb4(undefined4 *param_1,wchar_t *param_2)

{
  DWORD DVar1;
  int iVar2;
  wchar_t *pwVar3;
  undefined4 uVar4;
  size_t _MaxCount;
  size_t sVar5;
  undefined auStackY632 [32];
  WCHAR local_248 [2];
  wchar_t local_244 [258];
  undefined2 local_40;
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStackY632;
  uVar4 = 0;
  DVar1 = GetTempPathW(0x105,local_248);
  if (DVar1 - 1 < 0x104) {
    _MaxCount = 0xffffffffffffffff;
    sVar5 = 0xffffffffffffffff;
    do {
      sVar5 = sVar5 + 1;
    } while (local_248[sVar5] != L'\0');
    iVar2 = _wcsnicmp(param_2,local_248,sVar5);
    if (iVar2 != 0) {
      pwVar3 = (wchar_t *)FUN_18001b894();
      wcscpy_s(local_248,0x105,pwVar3);
      wcscat_s(local_248,0x105,L"\\TEMP\\");
      local_40 = 0;
      sVar5 = 0xffffffffffffffff;
      do {
        sVar5 = sVar5 + 1;
      } while (local_248[sVar5] != L'\0');
      iVar2 = _wcsnicmp(param_2,local_248,sVar5);
      if (iVar2 != 0) {
        pwVar3 = (wchar_t *)FUN_18001b894();
        wcscpy_s(local_248,0x105,pwVar3);
        wcscpy_s(local_244,0x103,L"\\TEMP\\");
        local_40 = 0;
        do {
          _MaxCount = _MaxCount + 1;
        } while (local_248[_MaxCount] != L'\0');
        iVar2 = _wcsnicmp(param_2,local_248,_MaxCount);
        if (iVar2 != 0) goto LAB_18000ef09;
      }
    }
    uVar4 = 1;
  }
  else {
    FUN_18001188c(1,0xc0,0x5c,0x90,0x23);
  }
LAB_18000ef09:
  *param_1 = uVar4;
  __security_check_cookie(local_38 ^ (ulonglong)auStackY632);
  return;
}



undefined8 FUN_18000ef48(wchar_t **param_1,undefined8 param_2)

{
  bool bVar1;
  int iVar2;
  longlong lVar3;
  size_t sVar4;
  wchar_t *pwVar5;
  undefined7 extraout_var;
  undefined8 uVar6;
  undefined8 uVar7;
  undefined8 in_R8;
  undefined2 in_R9W;
  longlong in_GS_OFFSET;
  undefined4 local_28 [4];
  
  local_28[0] = 0x200;
  lVar3 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
  if (lVar3 == 0) {
LAB_18002f8ba:
    uVar7 = 0xc0000017;
  }
  else {
    uVar6 = 0;
    uVar7 = param_2;
    iVar2 = PackageIdFromFullName(param_2,0,local_28,lVar3);
    if (iVar2 == 0x7a) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lVar3);
      lVar3 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,
                              local_28[0]);
      if (lVar3 == 0) goto LAB_18002f8ba;
      uVar6 = 0;
      iVar2 = PackageIdFromFullName(param_2,0,local_28,lVar3);
      uVar7 = param_2;
      if (iVar2 == 0) goto LAB_18000efbe;
      uVar7 = 0xc00000e5;
    }
    else {
LAB_18000efbe:
      sVar4 = FUN_18000f170(uVar7,uVar6,*(longlong *)(lVar3 + 0x10),*(longlong *)(lVar3 + 0x28),
                            *(longlong *)(lVar3 + 0x20));
      pwVar5 = (wchar_t *)
               RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8);
      if (pwVar5 == (wchar_t *)0x0) {
        uVar7 = 0xc0000017;
      }
      else {
        bVar1 = FUN_18000f088(pwVar5,sVar4,*(undefined4 *)(lVar3 + 4),
                              (char)*(undefined8 *)(lVar3 + 8),*(undefined8 *)(lVar3 + 0x10),
                              *(undefined8 *)(lVar3 + 0x28),*(undefined8 *)(lVar3 + 0x20),in_R8,
                              in_R9W);
        if ((int)CONCAT71(extraout_var,bVar1) == 0) {
          uVar7 = 0xc00000e5;
        }
        else {
          uVar7 = 0;
          *param_1 = pwVar5;
          pwVar5 = (wchar_t *)0x0;
        }
        if (pwVar5 != (wchar_t *)0x0) {
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pwVar5);
        }
      }
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lVar3);
  }
  return uVar7;
}



// WARNING: Restarted to delay deadcode elimination for space: register

bool FUN_18000f088(wchar_t *param_1,size_t param_2,undefined4 param_3,undefined param_4,
                  longlong param_5,longlong param_6,longlong param_7,undefined8 param_8,
                  undefined2 param_9)

{
  int iVar1;
  
  memset(param_1,0,param_2);
  iVar1 = swprintf_s(param_1,param_2 >> 1,L"%08I32x\t%016I64x\t%016I64x\t%04hx\t%ls\t%ls\t%ls",
                     param_3);
  return iVar1 != -1;
}



longlong FUN_18000f170(undefined8 param_1,undefined8 param_2,longlong param_3,longlong param_4,
                      longlong param_5)

{
  longlong lVar1;
  longlong lVar2;
  longlong lVar3;
  longlong lVar4;
  
  lVar1 = -1;
  if (param_3 == 0) {
    lVar2 = 0x62;
  }
  else {
    lVar2 = -1;
    do {
      lVar2 = lVar2 + 1;
    } while (*(short *)(param_3 + lVar2 * 2) != 0);
    lVar2 = lVar2 * 2 + 0x62;
  }
  lVar3 = 2;
  if (param_4 == 0) {
    lVar4 = 2;
  }
  else {
    lVar4 = -1;
    do {
      lVar4 = lVar4 + 1;
    } while (*(short *)(param_4 + lVar4 * 2) != 0);
    lVar4 = lVar4 * 2 + 2;
  }
  if (param_5 != 0) {
    do {
      lVar1 = lVar1 + 1;
    } while (*(short *)(param_5 + lVar1 * 2) != 0);
    lVar3 = lVar1 * 2 + 2;
  }
  return lVar3 + lVar4 + lVar2;
}



int FUN_18000f1e8(longlong param_1)

{
  longlong *plVar1;
  longlong lVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  longlong in_GS_OFFSET;
  ulonglong local_res8;
  ulonglong local_res10;
  undefined *in_stack_ffffffffffffffa8;
  undefined local_28 [8];
  ulonglong local_20;
  
  lVar2 = *(longlong *)(param_1 + 0x10);
  iVar6 = 0;
  iVar4 = 0;
  if (lVar2 != 0) {
    plVar1 = (longlong *)(lVar2 + 0x38);
    if (*plVar1 != 0) {
      iVar4 = iVar6;
      if ((*(int *)(lVar2 + 0x50) != -1) && (*(char *)(lVar2 + 0x30) != '\0')) {
        local_res8 = (ulonglong)*(uint *)(lVar2 + 0x50);
        uVar5 = *(int *)(lVar2 + 0x54) - *(uint *)(lVar2 + 0x50);
        in_stack_ffffffffffffffa8 = local_28;
        iVar4 = NtWriteFile(*(undefined8 *)(lVar2 + 0x28),0,0,0,in_stack_ffffffffffffffa8,
                            (ulonglong)*(uint *)(lVar2 + 0x50) + *plVar1,uVar5,&local_res8,
                            &DAT_1800b2248);
        if (-1 < iVar4) {
          if (local_20 == uVar5) {
            local_res10 = (ulonglong)*(uint *)(lVar2 + 0x34);
            in_stack_ffffffffffffffa8 =
                 (undefined *)CONCAT44((int)((ulonglong)in_stack_ffffffffffffffa8 >> 0x20),0x14);
            iVar4 = NtSetInformationFile
                              (*(undefined8 *)(lVar2 + 0x28),local_28,&local_res10,8,
                               in_stack_ffffffffffffffa8);
          }
          else {
            iVar4 = -0x3fffff81;
          }
        }
      }
      NtFreeVirtualMemory(0xffffffffffffffff,plVar1,lVar2 + 0x48,0x8000);
      *plVar1 = 0;
      *(undefined8 *)(lVar2 + 0x40) = 0;
      *(undefined8 *)(lVar2 + 0x48) = 0;
    }
    if (*(char *)(lVar2 + 0x32) != '\0') {
      local_res8 = 0;
      local_res10 = 0xffffffffffffffff;
      NtUnlockFile(*(undefined8 *)(lVar2 + 0x28),local_28,&local_res8,&local_res10,
                   (ulonglong)in_stack_ffffffffffffffa8 & 0xffffffff00000000 |
                   (ulonglong)DAT_1800b2248);
    }
    iVar3 = NtClose(*(undefined8 *)(lVar2 + 0x28));
    iVar6 = iVar4;
    if (-1 < iVar4) {
      iVar6 = iVar3;
    }
    *(undefined8 *)(lVar2 + 0x28) = 0;
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lVar2);
  }
  return iVar6;
}



// WARNING: Could not reconcile some variable overlaps

int FUN_18000f380(undefined2 *param_1,longlong param_2)

{
  int iVar1;
  longlong lVar2;
  longlong in_GS_OFFSET;
  undefined in_stack_ffffffffffffffd8;
  undefined local_18 [16];
  
  local_18 = ZEXT816(0);
  iVar1 = RtlFormatCurrentUserKeyPath(local_18);
  if (iVar1 < 0) {
    FUN_18001188c(1,0xb0,0xc4,0x88,(char)iVar1);
  }
  else {
    *param_1 = 0;
    lVar2 = -1;
    do {
      lVar2 = lVar2 + 1;
    } while (*(short *)(param_2 + lVar2 * 2) != 0);
    param_1[1] = ((short)lVar2 + 1) * 2 + local_18._0_2_;
    lVar2 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8);
    *(longlong *)(param_1 + 4) = lVar2;
    if (lVar2 == 0) {
      iVar1 = -0x3fffffe9;
      FUN_18001188c(1,0xb0,0xd0,0x98,in_stack_ffffffffffffffd8);
    }
    else {
      RtlAppendUnicodeStringToString(param_1,local_18);
      RtlAppendUnicodeToString(param_1,param_2);
      iVar1 = 0;
    }
  }
  RtlFreeUnicodeString(local_18);
  return iVar1;
}



ulonglong FUN_18000f478(longlong param_1)

{
  bool bVar1;
  char cVar2;
  undefined4 uVar3;
  undefined8 uVar4;
  ulonglong uVar5;
  short *psVar6;
  uint uVar7;
  short *local_res10;
  short *local_res18;
  
  local_res10 = (short *)0x0;
  psVar6 = (short *)0x0;
  local_res18 = (short *)0x0;
  uVar4 = FUN_18000fac0(param_1,2);
  do {
    if ((int)uVar4 != 0x105) {
      return 0xc0000034;
    }
    bVar1 = false;
    if (*(longlong *)(param_1 + 0x100) == 0) {
      if (*(char *)(param_1 + 5) != '\0') {
        uVar3 = FUN_18000ff6c(param_1,(short **)0x0,&local_res18);
        cVar2 = (char)uVar3;
        psVar6 = local_res18;
        goto joined_r0x00018000f563;
      }
      uVar3 = FUN_18000ff6c(param_1,&local_res10,(short **)0x0);
      if ((char)uVar3 == '\0') {
        return 0xc000000d;
      }
      *(longlong *)(param_1 + 0x100) = param_1 + 0xd8;
      uVar5 = RtlUnicodeStringToAnsiString(param_1 + 0xd8,*(undefined8 *)(param_1 + 0x148));
      if ((int)uVar5 < 0) {
        return uVar5;
      }
      bVar1 = true;
    }
    else {
      uVar3 = FUN_18000ff6c(param_1,&local_res10,(short **)0x0);
      cVar2 = (char)uVar3;
joined_r0x00018000f563:
      if (cVar2 == '\0') {
        return 0xc000000d;
      }
    }
    if ((*(longlong *)(param_1 + 0x100) == 0) && (*(char *)(param_1 + 5) != '\0')) {
      cVar2 = RtlEqualUnicodeString(psVar6,*(undefined8 *)(param_1 + 0x148));
    }
    else {
      cVar2 = RtlEqualString(local_res10);
    }
    uVar7 = ~-(uint)(cVar2 != '\0') & 0x105;
    if (bVar1) {
      RtlFreeAnsiString(*(undefined8 *)(param_1 + 0x100));
    }
    if (uVar7 != 0x105) {
      return (ulonglong)uVar7;
    }
    uVar4 = FUN_18000fac0(param_1,2);
  } while( true );
}



undefined * FUN_18000f588(longlong param_1)

{
  ushort uVar1;
  uint uVar2;
  undefined *puVar3;
  undefined8 uVar4;
  short *psVar5;
  byte *pbVar6;
  ushort *puVar7;
  
  puVar3 = (undefined *)FUN_18000f960(param_1);
  if (-1 < (int)puVar3) {
    uVar4 = FUN_18000fac0(param_1,3);
    uVar2 = (uint)uVar4;
    while (uVar2 == 0x105) {
      if ((*(ushort **)(param_1 + 0x100) != (ushort *)0x0) || (*(longlong *)(param_1 + 0x148) != 0))
      {
        puVar3 = (undefined *)
                 FUN_18000f720(param_1,*(ushort **)(param_1 + 0x100),*(ushort **)(param_1 + 0x148),
                               '\0');
        if ((int)puVar3 < 0) {
          return puVar3;
        }
        puVar3 = (undefined *)0x0;
        if (*(char *)(param_1 + 5) == '\0') {
          puVar3 = &DAT_18008570c;
        }
        puVar3 = (undefined *)
                 FUN_18000f76c(param_1,puVar3,
                               (void *)(-(ulonglong)(*(char *)(param_1 + 5) != '\0') & 0x180085710),
                               1,'\0');
        if ((int)puVar3 < 0) {
          return puVar3;
        }
      }
      if (*(char *)(*(longlong *)(param_1 + 0x10) + 0x31) == '\0') {
        puVar7 = *(ushort **)(param_1 + 0x108);
        pbVar6 = *(byte **)(puVar7 + 4);
        uVar1 = *puVar7;
        while ((uVar1 != 0 && (*pbVar6 < 0x21))) {
          pbVar6 = pbVar6 + 1;
          *(byte **)(puVar7 + 4) = pbVar6;
          **(short **)(param_1 + 0x108) = **(short **)(param_1 + 0x108) + -1;
          psVar5 = (short *)(*(longlong *)(param_1 + 0x108) + 2);
          *psVar5 = *psVar5 + -1;
          puVar7 = *(ushort **)(param_1 + 0x108);
          uVar1 = *puVar7;
        }
      }
      else {
        psVar5 = *(short **)(param_1 + 0x150);
        puVar7 = *(ushort **)(psVar5 + 4);
        while ((*psVar5 != 0 && (*puVar7 < 0x21))) {
          puVar7 = puVar7 + 1;
          *(ushort **)(*(longlong *)(param_1 + 0x150) + 8) = puVar7;
          **(short **)(param_1 + 0x150) = **(short **)(param_1 + 0x150) + -2;
          psVar5 = (short *)(*(longlong *)(param_1 + 0x150) + 2);
          *psVar5 = *psVar5 + -2;
          psVar5 = *(short **)(param_1 + 0x150);
        }
        puVar7 = *(ushort **)(param_1 + 0x108);
      }
      puVar3 = (undefined *)FUN_18000f720(param_1,puVar7,*(ushort **)(param_1 + 0x150),'\x01');
      if ((int)puVar3 < 0) {
        return puVar3;
      }
      uVar4 = FUN_18000fac0(param_1,3);
      uVar2 = (uint)uVar4;
    }
    puVar3 = (undefined *)0x0;
    if (uVar2 != 0x8000001a) {
      puVar3 = (undefined *)(ulonglong)uVar2;
    }
  }
  return puVar3;
}



ulonglong FUN_18000f720(longlong param_1,ushort *param_2,ushort *param_3,char param_4)

{
  ushort uVar1;
  ulonglong uVar2;
  void *pvVar3;
  
  if (param_2 == (ushort *)0x0) {
    if (param_3 == (ushort *)0x0) {
      return 0xc000000d;
    }
    uVar1 = *param_3;
    param_3 = *(ushort **)(param_3 + 4);
    uVar1 = uVar1 >> 1;
    pvVar3 = (void *)0x0;
  }
  else {
    if (param_3 != (ushort *)0x0) {
      return 0xc000000d;
    }
    uVar1 = *param_2;
    pvVar3 = *(void **)(param_2 + 4);
  }
  uVar2 = FUN_18000f76c(param_1,pvVar3,param_3,(uint)uVar1,param_4);
  return uVar2;
}



ulonglong FUN_18000f76c(longlong param_1,void *param_2,void *param_3,uint param_4,char param_5)

{
  uint uVar1;
  ulonglong uVar2;
  void *_Dst;
  uint uVar3;
  undefined local_res10 [8];
  uint local_res20;
  
  uVar3 = 0;
  local_res20 = param_4;
  if (param_2 == (void *)0x0) {
    if (param_3 == (void *)0x0) goto LAB_18000f803;
    if ((*(char *)(param_1 + 5) == '\0') && (uVar2 = RtlUnicodeToMultiByteSize(), (int)uVar2 < 0)) {
      return uVar2;
    }
    uVar1 = *(uint *)(param_1 + 0x90);
    if (*(uint *)(param_1 + 0x94) <= uVar1 + param_4) {
      uVar3 = 0x80000005;
      local_res20 = *(uint *)(param_1 + 0x94) - uVar1;
      if (local_res20 != 0) {
        local_res20 = local_res20 - 1;
      }
    }
    if (local_res20 == 0) goto LAB_18000f803;
    if (*(char *)(param_1 + 5) != '\0') {
      uVar2 = (ulonglong)local_res20 * 2;
      _Dst = (void *)(*(longlong *)(param_1 + 0xa0) + (ulonglong)uVar1 * 2);
      param_2 = param_3;
      goto LAB_18000f7f5;
    }
    uVar2 = RtlUnicodeToMultiByteN
                      (*(longlong *)(param_1 + 0x98) + (ulonglong)uVar1,local_res20,local_res10,
                       param_3,param_4 * 2);
LAB_18000f92a:
    if ((int)uVar2 < 0) {
      return uVar2;
    }
  }
  else {
    if (param_3 != (void *)0x0) {
      return 0xc000000d;
    }
    uVar2 = (ulonglong)param_4;
    if (*(char *)(param_1 + 5) != '\0') {
      uVar2 = RtlMultiByteToUnicodeSize();
      if ((int)uVar2 < 0) {
        return uVar2;
      }
      local_res20 = param_4 >> 1;
      uVar2 = (ulonglong)local_res20;
    }
    uVar1 = *(uint *)(param_1 + 0x90);
    if (*(uint *)(param_1 + 0x94) <= uVar1 + (int)uVar2) {
      uVar3 = 0x80000005;
      local_res20 = *(uint *)(param_1 + 0x94) - uVar1;
      uVar2 = (ulonglong)local_res20;
      if (local_res20 != 0) {
        local_res20 = local_res20 - 1;
        uVar2 = (ulonglong)local_res20;
      }
    }
    if ((int)uVar2 == 0) goto LAB_18000f803;
    if (*(char *)(param_1 + 5) != '\0') {
      uVar2 = RtlMultiByteToUnicodeN
                        (*(longlong *)(param_1 + 0xa0) + (ulonglong)uVar1 * 2,(int)uVar2 * 2,
                         local_res10,param_2,param_4);
      goto LAB_18000f92a;
    }
    _Dst = (void *)(*(longlong *)(param_1 + 0x98) + (ulonglong)uVar1);
LAB_18000f7f5:
    memcpy(_Dst,param_2,uVar2);
  }
  *(int *)(param_1 + 0x90) = *(int *)(param_1 + 0x90) + local_res20;
LAB_18000f803:
  if (param_5 != '\0') {
    uVar1 = *(uint *)(param_1 + 0x90);
    if (*(uint *)(param_1 + 0x94) <= uVar1 + 1) {
      return 0x80000005;
    }
    if (*(char *)(param_1 + 5) == '\0') {
      *(undefined *)((ulonglong)uVar1 + *(longlong *)(param_1 + 0x98)) = 0;
    }
    else {
      *(undefined2 *)(*(longlong *)(param_1 + 0xa0) + (ulonglong)uVar1 * 2) = 0;
    }
    *(int *)(param_1 + 0x90) = *(int *)(param_1 + 0x90) + 1;
  }
  return (ulonglong)uVar3;
}



ulonglong FUN_18000f960(longlong param_1)

{
  short *psVar1;
  char cVar2;
  undefined4 uVar3;
  int iVar4;
  undefined8 uVar5;
  ulonglong uVar6;
  short *psVar7;
  uint uVar8;
  short *psVar9;
  short *psVar10;
  short *psVar11;
  short *local_res10;
  short *local_res18 [2];
  
  psVar11 = (short *)0x0;
  local_res10 = (short *)0x0;
  local_res18[0] = (short *)0x0;
  uVar5 = FUN_18000fac0(param_1,1);
  iVar4 = (int)uVar5;
  psVar9 = psVar11;
  psVar10 = psVar11;
  do {
    if (iVar4 != 0x105) {
      return 0xc0000034;
    }
    if (*(longlong *)(param_1 + 0xf8) == 0) {
      if (*(char *)(param_1 + 5) == '\0') {
        uVar3 = FUN_180011d50(param_1,&local_res10,(short **)0x0);
        if ((char)uVar3 == '\0') {
          return 0xc000000d;
        }
        *(longlong *)(param_1 + 0xf8) = param_1 + 200;
        uVar6 = RtlUnicodeStringToAnsiString(param_1 + 200,*(undefined8 *)(param_1 + 0x140));
        if ((int)uVar6 < 0) {
          return uVar6;
        }
        psVar7 = (short *)0x1;
        psVar9 = local_res10;
        psVar1 = local_res10;
      }
      else {
        uVar3 = FUN_180011d50(param_1,(short **)0x0,local_res18);
        psVar7 = (short *)0x0;
        psVar10 = local_res18[0];
        psVar1 = local_res10;
        if ((char)uVar3 == '\0') {
          return 0xc000000d;
        }
      }
    }
    else {
      psVar9 = (short *)(param_1 + 0x48);
      psVar7 = psVar11;
      psVar1 = psVar9;
      if ((*(short *)(param_1 + 0x48) == 0) &&
         (iVar4 = RtlUnicodeStringToAnsiString(psVar9,param_1 + 0x68), iVar4 < 0)) {
        return 0xc000000d;
      }
    }
    local_res10 = psVar1;
    if ((*(longlong *)(param_1 + 0xf8) == 0) && (*(char *)(param_1 + 5) != '\0')) {
      cVar2 = RtlEqualUnicodeString(psVar10,*(undefined8 *)(param_1 + 0x140));
      uVar8 = 0x105;
      if (cVar2 != '\0') {
        uVar8 = 0;
      }
    }
    else {
      cVar2 = RtlEqualString(psVar9);
      uVar8 = 0;
      if (cVar2 == '\0') {
        uVar8 = 0x105;
      }
    }
    if ((int)psVar7 != 0) {
      RtlFreeAnsiString(*(undefined8 *)(param_1 + 0xf8));
    }
    if (uVar8 != 0x105) {
      return (ulonglong)uVar8;
    }
    uVar5 = FUN_18000fac0(param_1,1);
    iVar4 = (int)uVar5;
  } while( true );
}



// WARNING: Removing unreachable block (ram,0x00018002fb4a)
// WARNING: Removing unreachable block (ram,0x00018002fb1a)

undefined8 FUN_18000fac0(longlong param_1,int param_2)

{
  ushort *puVar1;
  ushort *puVar2;
  byte bVar3;
  ushort uVar4;
  BOOL BVar5;
  short sVar6;
  ushort *puVar7;
  ushort *puVar8;
  ushort *puVar9;
  ushort *puVar10;
  ushort *puVar11;
  int iVar12;
  
  puVar9 = *(ushort **)(param_1 + 0xb0);
  puVar2 = *(ushort **)(param_1 + 0xc0);
  iVar12 = 2;
  if (param_2 != 3) {
    iVar12 = param_2;
  }
  if (*(char *)(*(longlong *)(param_1 + 0x10) + 0x31) == '\0') {
    if (puVar2 <= puVar9) {
      return 0x8000001a;
    }
    while (puVar11 = puVar9, puVar9 < puVar2) {
      while (*(byte *)puVar11 < 0x21) {
        puVar11 = (ushort *)((longlong)puVar11 + 1);
        if (puVar2 <= puVar11) {
          *(ushort **)(param_1 + 0xb0) = puVar11;
          return 0x8000001a;
        }
      }
      if (puVar2 <= puVar11) break;
      *(ushort **)(param_1 + 0xb8) = puVar11;
      puVar8 = (ushort *)0x0;
      puVar9 = puVar11;
      do {
        if ((puVar8 != (ushort *)0x0) || (*(byte *)puVar9 != 0x3d)) {
          bVar3 = *(byte *)puVar9;
          if (bVar3 == 0xd) {
            bVar3 = *(byte *)((longlong)puVar9 + 1);
            puVar9 = (ushort *)((longlong)puVar9 + 1);
          }
          else if (bVar3 != 10) goto LAB_18000fb57;
          if (bVar3 == 10) {
            puVar9 = (ushort *)((longlong)puVar9 + 1);
          }
          break;
        }
        puVar8 = (ushort *)((longlong)puVar9 + 1);
LAB_18000fb57:
        puVar9 = (ushort *)((longlong)puVar9 + 1);
      } while (puVar9 < puVar2);
      if (*(byte *)puVar11 != 0x3b) {
        if (*(byte *)puVar11 == 0x5b) {
          do {
            puVar11 = (ushort *)((longlong)puVar11 + 1);
            if (puVar9 <= puVar11) break;
          } while (*(byte *)puVar11 < 0x21);
          puVar8 = puVar11;
          puVar10 = puVar11;
          if (puVar11 < puVar9) {
            do {
              if (*(byte *)puVar10 == 0x5d) break;
              BVar5 = IsDBCSLeadByte(*(byte *)puVar10);
              if (BVar5 != 0) {
                puVar10 = (ushort *)((longlong)puVar10 + 1);
              }
              puVar10 = (ushort *)((longlong)puVar10 + 1);
            } while (puVar10 < puVar9);
            do {
              puVar8 = puVar10;
              if (puVar8 <= puVar11) break;
              puVar10 = (ushort *)((longlong)puVar8 + -1);
            } while (*(byte *)((longlong)puVar8 + -1) < 0x21);
          }
          sVar6 = (short)puVar8 - (short)puVar11;
          *(ushort **)(param_1 + 0xd0) = puVar11;
          *(short *)(param_1 + 0xca) = sVar6;
          *(short *)(param_1 + 200) = sVar6;
          *(short **)(param_1 + 0xf8) = (short *)(param_1 + 200);
          *(undefined8 *)(param_1 + 0x140) = 0;
          if (iVar12 == 1) goto LAB_18000fcfb;
          if (iVar12 == 2) {
            return 0x8000001a;
          }
        }
        else {
          puVar10 = puVar8;
          if (param_2 == 3) {
            puVar7 = (ushort *)0x0;
            if (puVar8 != (ushort *)0x0) goto joined_r0x00018000fba7;
          }
          else {
            if (puVar8 == (ushort *)0x0) goto LAB_18000fc30;
joined_r0x00018000fba7:
            do {
              puVar7 = (ushort *)((longlong)puVar10 + -1);
              if (puVar7 <= puVar11) break;
              puVar1 = puVar10 + -1;
              puVar10 = puVar7;
            } while (*(byte *)puVar1 < 0x21);
            uVar4 = (short)puVar7 - (short)puVar11;
            *(ushort **)(param_1 + 0xe0) = puVar11;
            *(ushort *)(param_1 + 0xda) = uVar4;
            *(ushort *)(param_1 + 0xd8) = uVar4;
            puVar11 = puVar8;
            puVar7 = (ushort *)(param_1 + 0xd8);
          }
          *(ushort **)(param_1 + 0x100) = puVar7;
          *(undefined8 *)(param_1 + 0x148) = 0;
          puVar8 = puVar9;
          do {
            puVar10 = puVar8;
            if (puVar10 <= puVar11) break;
            puVar8 = (ushort *)((longlong)puVar10 + -1);
          } while (*(byte *)((longlong)puVar10 + -1) < 0x21);
          sVar6 = (short)puVar10 - (short)puVar11;
          *(ushort **)(param_1 + 0xf0) = puVar11;
          *(short *)(param_1 + 0xea) = sVar6;
          *(short *)(param_1 + 0xe8) = sVar6;
          *(short **)(param_1 + 0x108) = (short *)(param_1 + 0xe8);
          *(undefined8 *)(param_1 + 0x150) = 0;
          if (iVar12 == 2) {
LAB_18000fcfb:
            *(ushort **)(param_1 + 0xb0) = puVar9;
            return 0x105;
          }
        }
      }
LAB_18000fc30:
      if (puVar2 <= puVar9) {
        return 0x8000001a;
      }
    }
  }
  else {
    if (puVar2 <= puVar9) {
      return 0x8000001a;
    }
    puVar11 = puVar9;
    while (puVar11 < puVar2) {
      if (*puVar11 < 0x21) {
        puVar11 = puVar11 + 1;
      }
      else {
        if (puVar2 <= puVar11) break;
        *(ushort **)(param_1 + 0xb8) = puVar11;
        puVar9 = puVar11;
        puVar8 = (ushort *)0x0;
        do {
          if ((puVar8 != (ushort *)0x0) || (*puVar9 != 0x3d)) {
            uVar4 = *puVar9;
            if (uVar4 == 0xd) {
              uVar4 = puVar9[1];
              puVar9 = puVar9 + 1;
            }
            else if (uVar4 != 10) goto LAB_18000fd8c;
            if (uVar4 == 10) {
              puVar9 = puVar9 + 1;
            }
            break;
          }
          puVar8 = puVar9 + 1;
LAB_18000fd8c:
          puVar9 = puVar9 + 1;
        } while (puVar9 < puVar2);
        if (*puVar11 != 0x3b) {
          if (*puVar11 == 0x5b) {
            do {
              puVar11 = puVar11 + 1;
              if (puVar9 <= puVar11) break;
            } while (*puVar11 < 0x21);
            puVar8 = puVar11;
            puVar10 = puVar11;
            if (puVar11 < puVar9) {
              do {
                if (*puVar10 == 0x5d) break;
                puVar10 = puVar10 + 1;
              } while (puVar10 < puVar9);
              do {
                puVar8 = puVar10;
                if (puVar8 <= puVar11) break;
                puVar10 = puVar8 + -1;
              } while (puVar8[-1] < 0x21);
            }
            sVar6 = (short)puVar8 - (short)puVar11;
            *(ushort **)(param_1 + 0x118) = puVar11;
            *(short *)(param_1 + 0x112) = sVar6;
            *(short *)(param_1 + 0x110) = sVar6;
            *(short **)(param_1 + 0x140) = (short *)(param_1 + 0x110);
            *(undefined8 *)(param_1 + 0xf8) = 0;
            if (iVar12 == 1) goto LAB_18000fe71;
            if (iVar12 == 2) {
              return 0x8000001a;
            }
          }
          else {
            puVar10 = puVar8;
            if (param_2 == 3) {
              puVar7 = (ushort *)0x0;
              if (puVar8 != (ushort *)0x0) goto joined_r0x00018000fde6;
            }
            else {
              if (puVar8 == (ushort *)0x0) goto LAB_18000fe7d;
joined_r0x00018000fde6:
              do {
                puVar10 = puVar10 + -1;
                if (puVar10 <= puVar11) break;
              } while (puVar10[-1] < 0x21);
              uVar4 = (short)puVar10 - (short)puVar11;
              *(ushort **)(param_1 + 0x128) = puVar11;
              *(ushort *)(param_1 + 0x122) = uVar4;
              *(ushort *)(param_1 + 0x120) = uVar4;
              puVar11 = puVar8;
              puVar7 = (ushort *)(param_1 + 0x120);
            }
            *(undefined8 *)(param_1 + 0x100) = 0;
            *(ushort **)(param_1 + 0x148) = puVar7;
            puVar8 = puVar9;
            do {
              puVar10 = puVar8;
              if (puVar10 <= puVar11) break;
              puVar8 = puVar10 + -1;
            } while (puVar10[-1] < 0x21);
            sVar6 = (short)puVar10 - (short)puVar11;
            *(ushort **)(param_1 + 0x138) = puVar11;
            *(short *)(param_1 + 0x132) = sVar6;
            *(short *)(param_1 + 0x130) = sVar6;
            *(undefined8 *)(param_1 + 0x108) = 0;
            *(short **)(param_1 + 0x150) = (short *)(param_1 + 0x130);
            if (iVar12 == 2) {
LAB_18000fe71:
              *(ushort **)(param_1 + 0xb0) = puVar9;
              return 0x105;
            }
          }
        }
LAB_18000fe7d:
        puVar11 = puVar9;
        if (puVar2 <= puVar9) {
          return 0x8000001a;
        }
      }
    }
  }
  *(ushort **)(param_1 + 0xb0) = puVar11;
  return 0x8000001a;
}



undefined4 FUN_18000ff6c(longlong param_1,short **param_2,short **param_3)

{
  short *psVar1;
  uint in_EAX;
  
  if (param_2 == (short **)0x0) {
    if ((param_3 == (short **)0x0) ||
       ((psVar1 = (short *)(param_1 + 0x78), *psVar1 == 0 &&
        (in_EAX = RtlAnsiStringToUnicodeString(psVar1,param_1 + 0x58,0), (int)in_EAX < 0)))) {
LAB_18000ffd0:
      return in_EAX & 0xffffff00;
    }
    *param_3 = psVar1;
  }
  else {
    psVar1 = (short *)(param_1 + 0x58);
    if ((*psVar1 == 0) &&
       (in_EAX = RtlUnicodeStringToAnsiString(psVar1,param_1 + 0x78,0), (int)in_EAX < 0))
    goto LAB_18000ffd0;
    *param_2 = psVar1;
  }
  return CONCAT31((int3)(in_EAX >> 8),1);
}



ulonglong FUN_180010004(longlong param_1)

{
  int *piVar1;
  uint uVar2;
  ulonglong uVar3;
  
  piVar1 = (int *)(param_1 + 0x38);
  if (*(int *)(param_1 + 0x48) == 0) {
    if (*piVar1 != 1) {
      uVar2 = FUN_180010174((longlong *)(param_1 + 8),'\0');
      uVar3 = (ulonglong)uVar2;
      if ((int)uVar2 < 0) {
        if (uVar2 != 0xc000010e) {
          return uVar3;
        }
        if (*(char *)(param_1 + 0x33) != '\0') {
          return uVar3;
        }
        return 0;
      }
      if (*(char *)(param_1 + 0x33) != '\0') {
        *piVar1 = 6;
        return uVar3;
      }
      uVar3 = FUN_180010090(param_1 + 8,piVar1);
      if (-1 < (int)uVar3) {
        return uVar3 & 0xffffffff;
      }
      FUN_18001188c(1,0x40,0xf7,0x10,(char)*(undefined8 *)param_1);
      *piVar1 = 3;
      return uVar3 & 0xffffffff;
    }
  }
  else if (*piVar1 != 1) {
    return 0xc000046d;
  }
  return 0xc000011e;
}



undefined8 FUN_180010090(longlong param_1,undefined4 *param_2)

{
  int *piVar1;
  short *psVar2;
  undefined8 uVar3;
  undefined4 uVar4;
  
  uVar3 = 0;
  if ((*(longlong *)(param_1 + 0x10) == 0) || (*(longlong *)(param_1 + 0x20) == 0)) {
    *param_2 = 1;
  }
  else {
    uVar4 = 3;
    if (0x3f < *(ulonglong *)(param_1 + 0x10)) {
      psVar2 = *(short **)(param_1 + 0x18);
      if ((longlong)psVar2 - 1U < 0xfffffffffffffffe) {
        if (*psVar2 == 0x5a4d) {
          uVar4 = 4;
          if ((ulonglong)*(uint *)(psVar2 + 0x1e) + 4 <= *(ulonglong *)(param_1 + 0x10)) {
            piVar1 = (int *)((ulonglong)*(uint *)(psVar2 + 0x1e) + (longlong)psVar2);
            if (*piVar1 == 0x4550) {
              uVar4 = 6;
            }
            else if (*(short *)piVar1 == 0x454e) {
              uVar4 = 5;
            }
          }
        }
      }
      else {
        uVar3 = 0xc000000d;
        FUN_18001188c(1,0x48,0xe8,0x28,0xd);
      }
      *param_2 = uVar4;
      return uVar3;
    }
    *param_2 = 3;
  }
  return 0;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180010174(longlong *param_1,char param_2)

{
  int iVar1;
  undefined auStack216 [32];
  undefined8 local_b8;
  ulonglong local_b0;
  longlong *local_a8;
  undefined4 local_a0;
  undefined4 local_98;
  undefined4 local_90;
  longlong local_88;
  longlong local_80;
  longlong local_78;
  undefined local_70 [16];
  undefined local_60 [16];
  undefined local_50 [16];
  undefined local_40 [16];
  undefined local_30 [16];
  undefined8 local_20;
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack216;
  local_88 = 0;
  local_80 = 0;
  local_78 = 0;
  local_70 = ZEXT816(0);
  local_20 = 0;
  local_60 = ZEXT816(0);
  local_50 = ZEXT816(0);
  local_40 = ZEXT816(0);
  local_30 = ZEXT816(0);
  if (param_1[3] == 0) {
    local_b8 = CONCAT44(local_b8._4_4_,5);
    iVar1 = ZwQueryInformationFile(*param_1,local_40,local_30,0x18);
    if (-1 < iVar1) {
      local_60 = local_60 & (undefined  [16])0xffffffffffffffff;
      local_70 = CONCAT124(SUB1612(local_70 >> 0x20,0) &
                           SUB1612((undefined  [16])0xffffffffffffffff >> 0x20,0),0x30);
      local_a8 = (longlong *)*param_1;
      local_b0 = local_b0 & 0xffffffff00000000 |
                 (ulonglong)((-(uint)(param_2 != '\0') & 0x9000000) + 0x8000000);
      local_50 = ZEXT816(0);
      local_b8 = CONCAT44(local_b8._4_4_,2);
      iVar1 = ZwCreateSection(&local_88,0xf0005,local_70,0);
      if (-1 < iVar1) {
        local_a8 = &local_78;
        local_90 = 2;
        local_98 = 0x500000;
        local_a0 = 2;
        local_b0 = 0;
        local_b8 = 0;
        iVar1 = ZwMapViewOfSection(local_88,0xffffffffffffffff,&local_80,0);
        if (-1 < iVar1) {
          param_1[1] = local_88;
          param_1[3] = local_80;
          param_1[4] = local_78;
          param_1[2] = local_30._8_8_;
          *(undefined2 *)((longlong)param_1 + 0x29) = 0x101;
          *(char *)((longlong)param_1 + 0x2b) = param_2;
          local_88 = 0;
          local_80 = 0;
        }
      }
    }
    if (local_88 != 0) {
      ZwClose();
    }
    if (local_80 != 0) {
      ZwUnmapViewOfSection(0xffffffffffffffff);
    }
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack216);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18001033c(undefined8 *param_1,wchar_t *param_2)

{
  uint uVar1;
  int iVar2;
  short **ppsVar3;
  undefined8 uVar4;
  undefined uVar5;
  undefined uVar6;
  undefined uVar7;
  longlong in_GS_OFFSET;
  undefined auStackY152 [32];
  undefined local_68 [8];
  wchar_t *local_60;
  undefined local_58 [16];
  undefined local_48 [16];
  undefined8 local_38;
  ulonglong local_30;
  
  local_30 = DAT_1800b2220 ^ (ulonglong)auStackY152;
  if (((param_2 == (wchar_t *)0x0) || (*param_2 == L'\0')) || (param_1 == (undefined8 *)0x0))
  goto LAB_1800104b5;
  *param_1 = 0;
  RtlInitUnicodeString(local_68);
  ppsVar3 = (short **)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8);
  if (ppsVar3 != (short **)0x0) {
    uVar1 = FUN_18000eaac(ppsVar3,param_2);
    if ((int)uVar1 < 0) {
      uVar7 = 0xc0;
      uVar6 = 0x79;
LAB_18002fc8e:
      FUN_18001188c(1,200,uVar6,uVar7,(char)uVar1);
    }
    else {
      iVar2 = _wcsnicmp(param_2,L"\\SystemRoot\\",0xc);
      if ((iVar2 == 0) ||
         (iVar2 = RtlDosPathNameToNtPathName_U_WithStatus(param_2,local_68,0,0), -1 < iVar2)) {
        iVar2 = FUN_1800104e4((longlong *)(ppsVar3 + 1),local_68);
        if (iVar2 < 0) {
          uVar4 = FUN_180070740(iVar2);
          if ((int)uVar4 == 0) {
            if (((0x30 < iVar2 + 0x3fffffedU) ||
                ((0x1000000008001U >> ((ulonglong)(iVar2 + 0x3fffffedU) & 0x3f) & 1) == 0)) &&
               (iVar2 != -0x3fffff46)) {
              uVar7 = 0xe0;
              uVar6 = 0x9f;
              goto LAB_18002fccd;
            }
            uVar7 = 0xe0;
            uVar6 = 0xa1;
            uVar5 = 3;
            goto LAB_18002fcea;
          }
        }
        else {
          local_38 = 0;
          local_58 = ZEXT816(0);
          local_48 = ZEXT816(0);
          uVar1 = ZwQueryInformationFile(ppsVar3[1],local_58,local_48,0x18);
          if ((int)uVar1 < 0) {
            uVar7 = 0x38;
            uVar6 = 0xb5;
            goto LAB_18002fc8e;
          }
          ppsVar3[3] = local_48._8_8_;
          *(uint *)(ppsVar3 + 7) = (local_48._8_8_ != (short *)0x0) + 1;
          *param_1 = ppsVar3;
          ppsVar3 = (short **)0x0;
        }
      }
      else {
        uVar7 = 0x78;
        uVar6 = 0x92;
LAB_18002fccd:
        uVar5 = 1;
LAB_18002fcea:
        FUN_18001188c(uVar5,200,uVar6,uVar7,(char)param_2);
      }
    }
    if (ppsVar3 != (short **)0x0) {
      FUN_18001175c((longlong *)ppsVar3);
    }
  }
  if (local_60 != param_2) {
    RtlFreeUnicodeString(local_68);
  }
LAB_1800104b5:
  __security_check_cookie(local_30 ^ (ulonglong)auStackY152);
  return;
}



int FUN_1800104e4(longlong *param_1,undefined8 param_2)

{
  int iVar1;
  longlong local_res10;
  undefined local_48 [16];
  undefined4 local_38;
  undefined4 local_34;
  undefined8 local_30;
  undefined8 local_28;
  undefined4 local_20;
  undefined4 local_1c;
  undefined local_18 [16];
  
  local_34 = 0;
  local_1c = 0;
  local_res10 = 0;
  local_30 = 0;
  local_48 = ZEXT816(0);
  local_38 = 0x30;
  local_20 = 0x40;
  local_18 = ZEXT816(0);
  local_28 = param_2;
  iVar1 = ZwCreateFile(&local_res10,0x80100080,&local_38,local_48,0,0x80,5,1,0x60,0,0);
  if (-1 < iVar1) {
    *param_1 = local_res10;
    iVar1 = 0;
    local_res10 = 0;
    *(undefined *)(param_1 + 5) = 1;
  }
  if (local_res10 != 0) {
    ZwClose();
  }
  return iVar1;
}



void FUN_1800105c0(short *param_1,ulonglong param_2,short *param_3)

{
  uint uVar1;
  ulonglong uVar2;
  short *psVar3;
  undefined uVar4;
  undefined uVar5;
  undefined auStackY648 [32];
  undefined4 local_258;
  undefined4 uStack596;
  undefined4 uStack592;
  undefined4 uStack588;
  undefined4 local_248;
  short local_238 [264];
  ulonglong local_28;
  
  local_28 = DAT_1800b2220 ^ (ulonglong)auStackY648;
  local_248 = 0x68;
  local_258 = 0x41005c;
  uStack596 = 0x700070;
  uStack592 = 0x610050;
  uStack588 = 0x630074;
  if (9 < param_2) {
    *param_1 = 0;
    local_238[0] = 0;
    psVar3 = (short *)&DAT_180085634;
    if (param_3 != (short *)0x0) {
      psVar3 = param_3;
    }
    uVar2 = FUN_18000b98c((short *)&local_258,psVar3,local_238,0x104);
    uVar1 = (uint)uVar2;
    if ((int)uVar1 < 0) {
      uVar5 = 0xd0;
      uVar4 = 0xab;
    }
    else {
      uVar1 = FUN_1800099f8(param_1,param_2,(longlong)local_238);
      if (-1 < (int)uVar1) goto LAB_180010656;
      uVar5 = 0x30;
      uVar4 = 0xb1;
    }
    FUN_18001188c(1,8,uVar4,uVar5,(char)uVar1);
  }
LAB_180010656:
  __security_check_cookie(local_28 ^ (ulonglong)auStackY648);
  return;
}



longlong ** FUN_180010688(wchar_t *param_1,undefined8 param_2,undefined8 param_3,longlong **param_4)

{
  longlong lVar1;
  int iVar2;
  longlong **_Dst;
  ulonglong uVar3;
  longlong *plVar4;
  undefined8 uVar5;
  undefined uVar6;
  undefined uVar7;
  undefined uVar8;
  longlong in_GS_OFFSET;
  longlong **local_res20;
  int local_18 [2];
  int local_10;
  
  uVar6 = 0;
  local_res20 = param_4;
  FUN_18001188c(3,0x38,0x82,0x50,0);
  _Dst = (longlong **)
         RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,0x580);
  local_res20 = _Dst;
  if (_Dst == (longlong **)0x0) {
    FUN_18001188c(1,0x38,0x8a,0x18,uVar6);
    return (longlong **)0x0;
  }
  memset(_Dst,0,0x580);
  iVar2 = FUN_18001033c(_Dst,param_1);
  if (iVar2 < 0) {
    uVar7 = 0x38;
    uVar6 = 0x95;
  }
  else {
    lVar1 = (*_Dst)[3];
    if (0x7fffffd5 < lVar1 - 0x2aU) {
      uVar8 = 0x60;
      uVar7 = 0x9e;
LAB_18002fe4f:
      FUN_18001188c(1,0x38,uVar7,uVar8,uVar6);
      goto LAB_18002fe5c;
    }
    uVar3 = FUN_180010004((longlong)*_Dst);
    iVar2 = (int)uVar3;
    if (iVar2 < 0) {
      uVar7 = 0x98;
      uVar6 = 0xa4;
    }
    else {
      *(undefined4 *)(_Dst + 2) = 0;
      *(int *)((longlong)_Dst + 0x14) = (int)lVar1;
      plVar4 = *_Dst;
      if (plVar4 != (longlong *)0x0) {
        plVar4 = (longlong *)plVar4[4];
      }
      _Dst[1] = plVar4;
      uVar5 = FUN_180011390((longlong)_Dst,0,local_18,0xc);
      if ((int)uVar5 == 0) {
        uVar8 = 0xb0;
        uVar7 = 0xb1;
        goto LAB_18002fe4f;
      }
      if (local_10 == 0x66626473) {
        uVar5 = FUN_1800107cc((longlong)_Dst,local_18);
        if ((int)uVar5 != 0) {
          return _Dst;
        }
        goto LAB_18002fe5c;
      }
      if (local_10 == 0x6662647a) {
        iVar2 = FUN_18007c9e4((longlong *)&local_res20);
        if (iVar2 != 0) {
          return local_res20;
        }
        FUN_18001188c(1,0x38,0xc4,0,uVar6);
        _Dst = local_res20;
        goto LAB_18002fe5c;
      }
      uVar7 = 0xd0;
      uVar6 = 0xbe;
      iVar2 = local_10;
    }
  }
  FUN_18001188c(1,0x38,uVar6,uVar7,(char)iVar2);
LAB_18002fe5c:
  if (_Dst != (longlong **)0x0) {
    FUN_18001175c(*_Dst);
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_res20);
  }
  return (longlong **)0x0;
}



undefined8 FUN_1800107cc(longlong param_1,int *param_2)

{
  int iVar1;
  bool bVar2;
  undefined7 extraout_var;
  undefined in_stack_ffffffffffffffe8;
  
  iVar1 = *param_2;
  if (iVar1 == 1) {
    *(uint *)(param_1 + 0x530) = *(uint *)(param_1 + 0x530) | 1;
  }
  else if (iVar1 != 2) {
    if (iVar1 != 3) {
      FUN_18001188c(1,0xd8,0x2a,0x98,(char)iVar1);
      return 0;
    }
    goto LAB_1800107f1;
  }
  *(uint *)(param_1 + 0x530) = *(uint *)(param_1 + 0x530) | 2;
LAB_1800107f1:
  bVar2 = FUN_180010894(param_1,(void *)(param_1 + 0x1c));
  if ((int)CONCAT71(extraout_var,bVar2) == 0) {
    FUN_18001188c(1,0xd8,0x34,0xf8,in_stack_ffffffffffffffe8);
  }
  return 1;
}



undefined8 FUN_180010820(longlong param_1,uint param_2,void *param_3,uint param_4)

{
  ushort uVar1;
  undefined8 uVar2;
  undefined in_stack_ffffffffffffffe8;
  
  uVar1 = FUN_1800113d4(param_1,param_2);
  if ((uVar1 & 0xf000) == 0x9000) {
    uVar2 = FUN_18001107c(param_1,param_2,param_3,param_4);
    if ((int)uVar2 != 0) {
      return 1;
    }
    FUN_18001188c(1,0xd0,0x9b,0xe8,in_stack_ffffffffffffffe8);
  }
  else {
    FUN_1800113d4(param_1,param_2);
    FUN_18001188c(1,0xd0,0x96,0xa8,(char)param_2);
  }
  return 0;
}



bool FUN_180010894(longlong param_1,void *param_2)

{
  uint uVar1;
  undefined8 uVar2;
  bool bVar3;
  undefined uVar4;
  undefined uVar5;
  undefined in_stack_ffffffffffffffe8;
  
  uVar1 = *(uint *)(param_1 + 0x18);
  bVar3 = false;
  if ((uVar1 & 2) == 0) {
    uVar1 = FUN_1800110fc(param_1,0,0x7001);
    if (uVar1 == 0) {
      uVar5 = 0xb8;
      uVar4 = 0xb8;
    }
    else {
      uVar1 = FUN_1800110fc(param_1,uVar1,-0x6ff9);
      if (uVar1 != 0) {
        uVar2 = FUN_180010820(param_1,uVar1,(void *)(param_1 + 0x1c),0x10);
        if ((int)uVar2 == 0) {
          FUN_18001188c(1,0xd0,0xc3,8,(char)uVar1);
          return false;
        }
        *(uint *)(param_1 + 0x18) = *(uint *)(param_1 + 0x18) | 2;
        uVar1 = *(uint *)(param_1 + 0x18);
        goto LAB_180010913;
      }
      uVar5 = 0xe8;
      uVar4 = 0xbe;
    }
    FUN_18001188c(1,0xd0,uVar4,uVar5,in_stack_ffffffffffffffe8);
  }
  else {
LAB_180010913:
    bVar3 = false;
    if ((uVar1 & 2) != 0) {
      RtlMoveMemory(param_2,(void *)(param_1 + 0x1c),0x10);
      bVar3 = true;
    }
  }
  return bVar3;
}



uint FUN_180010954(longlong param_1,uint param_2)

{
  bool bVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  wchar_t *pwVar7;
  undefined7 extraout_var;
  longlong lVar8;
  uint uVar9;
  undefined8 uVar10;
  char *pcVar11;
  uint local_res18 [2];
  uint local_res20 [2];
  undefined in_stack_ffffffffffffffa8;
  wchar_t *pwVar12;
  longlong local_40;
  
  local_res18[0] = 0;
  local_40 = 0;
  uVar9 = 0;
  local_res20[0] = 0;
  uVar4 = 0;
  pwVar7 = (wchar_t *)0x0;
  pcVar11 = (char *)local_res18;
  iVar2 = FUN_18001146c(param_1,param_2,&local_40,(uint *)pcVar11);
  lVar8 = local_40;
  uVar6 = local_res18[0];
  if (iVar2 == 0) {
    FUN_18001188c(1,0xf0,0xbd,0xd8,in_stack_ffffffffffffffa8);
    lVar8 = local_40;
    uVar4 = 0;
  }
  else {
    uVar3 = FUN_1800110fc(local_40,local_res18[0],0x404c);
    if ((uVar3 == 0) || (uVar4 = FUN_180010c20(lVar8,uVar3,0), uVar4 == 0)) {
      if (lVar8 != *(longlong *)(param_1 + 8)) {
        uVar3 = FUN_1800110fc(lVar8,0,0x7001);
        if (uVar3 == 0) {
          pcVar11 = "Can\'t find DATABASE tag in db";
          FUN_18001188c(1,0xf0,0xda,8,in_stack_ffffffffffffffa8);
        }
        else {
          uVar3 = FUN_1800110fc(lVar8,uVar3,0x7002);
          if (uVar3 != 0) {
            uVar10 = 0x6001;
            uVar5 = FUN_1800110fc(lVar8,uVar6,0x6001);
            if ((uVar5 == 0) ||
               (pwVar7 = (wchar_t *)FUN_180078d74(lVar8,uVar5), pwVar7 == (wchar_t *)0x0))
            goto LAB_180010bd7;
            pwVar12 = pwVar7;
            uVar4 = FUN_180078b90(lVar8,uVar3,uVar10,pcVar11,pwVar7);
            in_stack_ffffffffffffffa8 = SUB81(pwVar12,0);
            if (uVar4 != 0) goto LAB_180010bd7;
          }
        }
      }
      uVar3 = FUN_1800110fc(*(longlong *)(param_1 + 8),0,0x7001);
      if (uVar3 == 0) {
        FUN_18001188c(1,0xf0,2,0x28,in_stack_ffffffffffffffa8);
      }
      else {
        uVar10 = 0x7002;
        uVar3 = FUN_1800110fc(*(longlong *)(param_1 + 8),uVar3,0x7002);
        if (uVar3 == 0) {
          FUN_18001188c(1,0xf0,8,0x50,in_stack_ffffffffffffffa8);
        }
        else {
          if (pwVar7 == (wchar_t *)0x0) {
            uVar10 = 0x6001;
            uVar6 = FUN_1800110fc(lVar8,uVar6,0x6001);
            if ((uVar6 == 0) ||
               (pwVar7 = (wchar_t *)FUN_180078d74(lVar8,uVar6), pwVar7 == (wchar_t *)0x0))
            goto LAB_180010bd7;
          }
          uVar4 = FUN_180078b90(*(longlong *)(param_1 + 8),uVar3,uVar10,pcVar11,pwVar7);
          local_40 = *(longlong *)(param_1 + 8);
          lVar8 = local_40;
        }
      }
    }
  }
LAB_180010bd7:
  if (uVar4 != 0) {
    bVar1 = FUN_180011510(param_1,lVar8,(ulonglong)uVar4,local_res20);
    uVar9 = -(uint)((int)CONCAT71(extraout_var,bVar1) != 0) & local_res20[0];
  }
  if (uVar9 == 0) {
    FUN_18001188c(3,0xf0,0x36,0x78,(char)param_2);
  }
  return uVar9;
}



undefined4 FUN_180010c20(longlong param_1,uint param_2,undefined4 param_3)

{
  ushort uVar1;
  undefined4 uVar2;
  undefined8 uVar3;
  undefined4 local_res18 [4];
  
  local_res18[0] = param_3;
  uVar1 = FUN_1800113d4(param_1,param_2);
  if ((uVar1 & 0xf000) == 0x4000) {
    uVar3 = FUN_18001107c(param_1,param_2,local_res18,4);
    uVar2 = local_res18[0];
    if ((int)uVar3 == 0) {
      uVar2 = param_3;
    }
  }
  else {
    FUN_1800113d4(param_1,param_2);
    FUN_18001188c(1,0x30,0x96,0xf0,(char)param_2);
    uVar2 = param_3;
  }
  return uVar2;
}



uint FUN_180010c90(longlong param_1,uint param_2,uint param_3)

{
  short sVar1;
  short sVar2;
  
  sVar1 = FUN_1800113d4(param_1,param_3);
  if (sVar1 == 0) {
    FUN_18001188c(1,0xf0,0x5e,0xd8,(char)param_3);
    param_3 = 0;
  }
  else {
    do {
      param_3 = FUN_180011170(param_1,param_2,param_3);
      if (param_3 == 0) {
        return 0;
      }
      sVar2 = FUN_1800113d4(param_1,param_3);
    } while (sVar2 != sVar1);
  }
  return param_3;
}



undefined4 FUN_180010d14(longlong param_1,uint param_2,uint param_3)

{
  bool bVar1;
  int iVar2;
  uint uVar3;
  undefined7 extraout_var;
  undefined uVar4;
  undefined uVar5;
  uint local_res20 [2];
  uint uVar6;
  uint local_14;
  longlong local_10;
  
  local_10 = 0;
  uVar6 = 0;
  local_res20[0] = 0;
  local_14 = 0;
  iVar2 = FUN_18001146c(param_1,param_2,&local_10,(uint *)&stack0xffffffffffffffe8);
  if (iVar2 == 0) {
    uVar5 = 0x68;
    uVar4 = 0xee;
  }
  else {
    iVar2 = FUN_18001146c(param_1,param_3,&local_10,local_res20);
    if (iVar2 == 0) {
      uVar5 = 0xa0;
      uVar4 = 0xf3;
    }
    else {
      uVar3 = FUN_180010c90(local_10,uVar6,local_res20[0]);
      if (uVar3 == 0) {
        return 0;
      }
      bVar1 = FUN_180011510(param_1,local_10,(ulonglong)uVar3,&local_14);
      if ((int)CONCAT71(extraout_var,bVar1) != 0) {
        return local_14;
      }
      uVar5 = 0x50;
      uVar4 = 0;
    }
  }
  FUN_18001188c(1,0x88,uVar4,uVar5,(char)uVar6);
  return 0;
}



// WARNING: Could not reconcile some variable overlaps

undefined2 FUN_180010dbc(longlong param_1,uint param_2)

{
  uint uVar1;
  longlong lVar2;
  ushort uVar3;
  int iVar4;
  undefined8 uVar5;
  uint local_res18 [2];
  longlong local_res20;
  undefined in_stack_fffffffffffffff8;
  
  local_res20 = 0;
  local_res18[0] = 0;
  iVar4 = FUN_18001146c(param_1,param_2,&local_res20,local_res18);
  lVar2 = local_res20;
  uVar1 = local_res18[0];
  if (iVar4 != 0) {
    local_res18[0]._0_2_ = 0xffff;
    local_res18[0] = CONCAT22((short)(local_res18[0] >> 0x10),0xffff);
    uVar3 = FUN_1800113d4(local_res20,uVar1);
    if ((uVar3 & 0xf000) == 0x3000) {
      uVar5 = FUN_18001107c(lVar2,uVar1,local_res18,2);
      local_res18[0]._0_2_ = 0xffff;
      if ((int)uVar5 != 0) {
      }
    }
    else {
      FUN_1800113d4(lVar2,uVar1);
      FUN_18001188c(1,0x20,0x8f,0xf0,(char)uVar1);
    }
    return (undefined2)local_res18[0];
  }
  FUN_18001188c(1,0x50,0xcb,0xd8,in_stack_fffffffffffffff8);
  return 0xffff;
}



undefined4 FUN_180010e78(longlong param_1,undefined8 param_2,int *param_3,uint param_4)

{
  undefined2 uVar1;
  undefined2 uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  longlong lVar6;
  undefined4 uVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  int *piVar10;
  
  uVar7 = 0;
  if (*(int *)(param_1 + 0xa8) != 0) {
    lVar6 = FUN_1800118b4(param_1,param_2,(short)param_2);
    if (lVar6 == 0) {
      uVar7 = 0x8007054f;
    }
    else {
      uVar8 = 0;
      if (*(int *)(param_1 + 0xa8) != 0) {
        while( true ) {
          uVar3 = *(uint *)(param_1 + uVar8 * 4);
          uVar7 = 0;
          if (uVar3 == 0) break;
          for (uVar3 = FUN_180010ff4(lVar6,uVar3,0x702c); uVar3 != 0;
              uVar3 = FUN_180010d14(lVar6,*(uint *)(param_1 + uVar8 * 4),uVar3)) {
            uVar4 = FUN_180010954(lVar6,uVar3);
            if ((uVar4 == 0) || (uVar5 = FUN_180010ff4(lVar6,uVar4,0x3002), uVar5 == 0)) {
LAB_1800300e0:
              uVar7 = 0x8007054e;
              goto LAB_180010fac;
            }
            uVar1 = FUN_180010dbc(lVar6,uVar5);
            uVar4 = FUN_180010ff4(lVar6,uVar4,0x3003);
            if (uVar4 == 0) goto LAB_1800300e0;
            uVar2 = FUN_180010dbc(lVar6,uVar4);
            uVar9 = (ulonglong)param_4;
            piVar10 = param_3;
            if (param_4 != 0) {
              do {
                if (*piVar10 == CONCAT22(uVar1,uVar2)) {
                  uVar4 = FUN_180010ff4(lVar6,uVar3,0x100f);
                  *(bool *)*(undefined8 *)(piVar10 + 2) = uVar4 == 0;
                }
                uVar9 = uVar9 - 1;
                piVar10 = piVar10 + 4;
              } while (uVar9 != 0);
            }
          }
          uVar3 = (int)uVar8 + 1;
          uVar8 = (ulonglong)uVar3;
          if (*(uint *)(param_1 + 0xa8) <= uVar3) break;
        }
      }
LAB_180010fac:
      FUN_1800115a4(lVar6);
    }
  }
  return uVar7;
}



uint FUN_180010ff4(longlong param_1,uint param_2,short param_3)

{
  bool bVar1;
  int iVar2;
  uint uVar3;
  undefined7 extraout_var;
  undefined uVar4;
  undefined uVar5;
  uint local_res20 [2];
  uint uVar6;
  longlong local_10;
  
  local_10 = 0;
  local_res20[0] = 0;
  uVar6 = 0;
  iVar2 = FUN_18001146c(param_1,param_2,&local_10,local_res20);
  if (iVar2 == 0) {
    uVar5 = 0xd8;
    uVar4 = 0xbc;
  }
  else {
    uVar3 = FUN_1800110fc(local_10,local_res20[0],param_3);
    if (uVar3 == 0) {
      return 0;
    }
    bVar1 = FUN_180011510(param_1,local_10,(ulonglong)uVar3,(uint *)&stack0xffffffffffffffe8);
    if ((int)CONCAT71(extraout_var,bVar1) != 0) {
      return uVar6;
    }
    uVar5 = 0x50;
    uVar4 = 0xc9;
  }
  FUN_18001188c(1,0x38,uVar4,uVar5,(char)uVar6);
  return 0;
}



undefined8 FUN_18001107c(longlong param_1,uint param_2,void *param_3,uint param_4)

{
  uint uVar1;
  int iVar2;
  undefined8 uVar3;
  undefined in_stack_ffffffffffffffe8;
  
  uVar1 = FUN_1800112b0(param_1,param_2);
  if (param_4 < uVar1) {
    FUN_18001188c(1,0xc0,0x60,0x98,(char)param_4);
  }
  else {
    iVar2 = FUN_1800111e0(param_1,param_2);
    uVar3 = FUN_180011390(param_1,param_2 + iVar2,param_3,uVar1);
    if ((int)uVar3 != 0) {
      return 1;
    }
    FUN_18001188c(1,0xc0,0x67,0xd0,in_stack_ffffffffffffffe8);
  }
  return 0;
}



uint FUN_1800110fc(longlong param_1,uint param_2,short param_3)

{
  short sVar1;
  uint uVar2;
  uint uVar3;
  
  uVar2 = FUN_18001140c(param_1,param_2);
  while ((uVar3 = 0, uVar2 != 0 &&
         (sVar1 = FUN_1800113d4(param_1,uVar2), uVar3 = uVar2, sVar1 != param_3))) {
    uVar2 = FUN_180011170(param_1,param_2,uVar2);
  }
  return uVar3;
}



uint FUN_180011170(longlong param_1,uint param_2,uint param_3)

{
  ushort uVar1;
  uint uVar2;
  uint uVar3;
  undefined unaff_DIL;
  
  if (param_2 == 0) {
    uVar2 = *(uint *)(param_1 + 0x14);
  }
  else {
    uVar1 = FUN_1800113d4(param_1,param_2);
    if ((uVar1 & 0xf000) != 0x7000) {
      FUN_18001188c(1,200,0x3c,0x98,unaff_DIL);
      return 0;
    }
    uVar2 = FUN_180011228(param_1,param_2);
  }
  uVar3 = FUN_180011228(param_1,param_3);
  return uVar3 & -(uint)(uVar3 < uVar2);
}



int FUN_1800111e0(longlong param_1,uint param_2)

{
  int iVar1;
  undefined8 uVar2;
  ushort local_res18 [8];
  undefined in_stack_fffffffffffffff8;
  
  uVar2 = FUN_180011390(param_1,param_2,local_res18,2);
  if ((int)uVar2 == 0) {
    FUN_18001188c(1,0xd8,0x5e,0xc0,in_stack_fffffffffffffff8);
    iVar1 = 0;
  }
  else {
    iVar1 = (-(uint)((local_res18[0] & 0xf000) < 0x7000) & 0xfffffffc) + 6;
  }
  return iVar1;
}



int FUN_180011228(longlong param_1,uint param_2)

{
  ushort uVar1;
  uint uVar2;
  int iVar3;
  undefined unaff_DIL;
  
  uVar1 = FUN_1800113d4(param_1,param_2);
  if (((uVar1 & 0xf000) == 0x7000) && (uVar2 = FUN_1800112b0(param_1,param_2), uVar2 == 0xffffffff))
  {
    FUN_18001188c(1,0x80,0xdd,0x60,unaff_DIL);
  }
  else {
    iVar3 = FUN_1800111e0(param_1,param_2);
    if (iVar3 != 0) {
      uVar2 = FUN_1800112b0(param_1,param_2);
      if ((*(byte *)(param_1 + 0x530) & 1) == 0) {
        uVar2 = uVar2 + 1 & 0xfffffffe;
      }
      return uVar2 + iVar3 + param_2;
    }
  }
  return *(int *)(param_1 + 0x14);
}



uint FUN_1800112b0(longlong param_1,uint param_2)

{
  undefined8 uVar1;
  ushort uVar2;
  uint uVar3;
  uint uVar4;
  uint local_res10 [2];
  undefined in_stack_ffffffffffffffc8;
  
  uVar4 = param_2 + 2;
  if (uVar4 < 2) {
    FUN_18001188c(1,0xa8,200,0x60,in_stack_ffffffffffffffc8);
  }
  else {
    if (uVar4 <= *(uint *)(param_1 + 0x14)) {
      uVar2 = *(ushort *)((ulonglong)param_2 + *(longlong *)(param_1 + 8));
      goto LAB_1800112ee;
    }
    uVar3 = param_2;
    FUN_18001188c(1,0xa8,0xcd,0xc0,(char)param_2);
    in_stack_ffffffffffffffc8 = (undefined)uVar3;
  }
  FUN_18001188c(1,0x10,0xbb,0x48,in_stack_ffffffffffffffc8);
  uVar2 = 0;
LAB_1800112ee:
  uVar2 = uVar2 & 0xf000;
  if ((uVar2 == 0x6000) || (uVar2 == 0x4000)) {
    uVar3 = 4;
  }
  else {
    uVar3 = 2;
    if (uVar2 != 0x3000) {
      if (uVar2 == 0x5000) {
        uVar3 = 8;
      }
      else if (uVar2 == 0x1000) {
        uVar3 = 0;
      }
      else {
        uVar3 = 1;
        if (uVar2 != 0x2000) {
          local_res10[0] = 0;
          uVar1 = FUN_180011390(param_1,uVar4,local_res10,4);
          uVar3 = local_res10[0];
          if ((int)uVar1 == 0) {
            FUN_18001188c(1,0x80,0x16,0x68,in_stack_ffffffffffffffc8);
            uVar3 = local_res10[0];
          }
        }
      }
    }
  }
  uVar4 = uVar3 + param_2;
  if ((uVar4 < uVar3) || (*(uint *)(param_1 + 0x14) <= uVar4 && uVar4 != *(uint *)(param_1 + 0x14)))
  {
    FUN_18001188c(1,0x80,0x21,0x68,in_stack_ffffffffffffffc8);
    uVar3 = 0xffffffff;
  }
  return uVar3;
}



undefined8 FUN_180011390(longlong param_1,uint param_2,void *param_3,uint param_4)

{
  undefined1 in_stack_ffffffffffffffd8;
  
  if (param_2 + param_4 < param_4) {
    FUN_18001188c(1,0xa8,200,0x60,in_stack_ffffffffffffffd8);
  }
  else {
    if (param_2 + param_4 <= *(uint *)(param_1 + 0x14)) {
      memcpy(param_3,(void *)((ulonglong)param_2 + *(longlong *)(param_1 + 8)),(ulonglong)param_4);
      return 1;
    }
    FUN_18001188c(1,0xa8,0xcd,0xc0,(char)param_2);
  }
  return 0;
}



undefined2 FUN_1800113d4(longlong param_1,uint param_2)

{
  undefined in_stack_ffffffffffffffd8;
  
  if (param_2 + 2 < 2) {
    FUN_18001188c(1,0xa8,200,0x60,in_stack_ffffffffffffffd8);
  }
  else {
    if (param_2 + 2 <= *(uint *)(param_1 + 0x14)) {
      return *(undefined2 *)((ulonglong)param_2 + *(longlong *)(param_1 + 8));
    }
    FUN_18001188c(1,0xa8,0xcd,0xc0,(char)param_2);
    in_stack_ffffffffffffffd8 = (undefined)param_2;
  }
  FUN_18001188c(1,0x10,0xbb,0x48,in_stack_ffffffffffffffd8);
  return 0;
}



uint FUN_18001140c(longlong param_1,uint param_2)

{
  ushort uVar1;
  uint uVar2;
  uint uVar3;
  
  if (param_2 == 0) {
    uVar2 = *(uint *)(param_1 + 0x14);
    uVar3 = 0xc;
  }
  else {
    uVar1 = FUN_1800113d4(param_1,param_2);
    if ((uVar1 & 0xf000) != 0x7000) {
      return 0;
    }
    uVar2 = FUN_180011228(param_1,param_2);
    uVar3 = param_2 + 6;
  }
  return -(uint)(uVar3 < uVar2) & uVar3;
}



void FUN_18001146c(longlong param_1,uint param_2,longlong *param_3,uint *param_4)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  int iVar4;
  longlong lVar5;
  uint uVar6;
  undefined4 *puVar7;
  undefined auStackY120 [32];
  uint local_48 [2];
  longlong local_40;
  undefined4 local_38;
  undefined4 uStack52;
  undefined4 uStack48;
  undefined4 uStack44;
  ulonglong local_28;
  
  local_28 = DAT_1800b2220 ^ (ulonglong)auStackY120;
  local_48[0] = param_2 >> 0x1c;
  lVar5 = 0;
  iVar4 = 1;
  local_40 = 0;
  uVar6 = param_2 & 0xfffffff;
  puVar7 = (undefined4 *)(((ulonglong)local_48[0] + 1) * 0x20 + param_1);
  if ((*(byte *)(puVar7 + 6) & 2) == 0) {
    if ((*(byte *)(puVar7 + 6) & 1) != 0) {
      local_38 = *puVar7;
      uStack52 = puVar7[1];
      uStack48 = puVar7[2];
      uStack44 = puVar7[3];
      puVar7[6] = 0;
      iVar4 = FUN_1800789d4(param_1,(longlong *)&local_38,puVar7,&local_40,local_48);
      lVar5 = local_40;
      goto LAB_1800114cd;
    }
  }
  else {
    lVar5 = *(longlong *)(puVar7 + 4);
    uVar1 = puVar7[1];
    uVar2 = puVar7[2];
    uVar3 = puVar7[3];
    *(undefined4 *)(lVar5 + 0x1c) = *puVar7;
    *(undefined4 *)(lVar5 + 0x20) = uVar1;
    *(undefined4 *)(lVar5 + 0x24) = uVar2;
    *(undefined4 *)(lVar5 + 0x28) = uVar3;
LAB_1800114cd:
    if (lVar5 != 0) goto LAB_1800114d2;
  }
  iVar4 = 0;
LAB_1800114d2:
  if (iVar4 == 0) {
    lVar5 = 0;
    uVar6 = 0;
  }
  if (param_3 != (longlong *)0x0) {
    *param_3 = lVar5;
  }
  if (param_4 != (uint *)0x0) {
    *param_4 = uVar6;
  }
  __security_check_cookie(local_28 ^ (ulonglong)auStackY120);
  return;
}



bool FUN_180011510(longlong param_1,longlong param_2,undefined8 param_3,uint *param_4)

{
  uint uVar1;
  undefined8 uVar2;
  uint uVar3;
  bool bVar4;
  uint uVar5;
  
  uVar5 = 0xffffffff;
  uVar3 = (uint)param_3;
  uVar1 = 0;
  uVar2 = FUN_180011560(param_1,param_2,param_3,(uint *)&stack0xffffffffffffffe8);
  bVar4 = (int)uVar2 == 0;
  if (bVar4) {
    FUN_18001188c(1,0x90,0xf6,0x88,(char)uVar5);
  }
  else {
    uVar1 = uVar5 << 0x1c | uVar3;
  }
  *param_4 = uVar1;
  return !bVar4;
}



undefined8 FUN_180011560(longlong param_1,longlong param_2,undefined8 param_3,uint *param_4)

{
  uint uVar1;
  longlong *plVar2;
  
  uVar1 = 0;
  plVar2 = (longlong *)(param_1 + 0x30);
  while ((((*(uint *)(param_1 + 0x1c) >> (uVar1 & 0x1f) & 1) == 0 ||
          ((*(byte *)(plVar2 + 1) & 2) == 0)) || (param_2 != *plVar2))) {
    uVar1 = uVar1 + 1;
    plVar2 = plVar2 + 4;
    if (0xf < uVar1) {
      return 0;
    }
  }
  if (param_4 == (uint *)0x0) {
    return 1;
  }
  *param_4 = uVar1;
  return 1;
}



void FUN_1800115a4(longlong param_1)

{
  int *piVar1;
  int iVar2;
  longlong *plVar3;
  char *pcVar4;
  undefined1 unaff_BL;
  longlong in_GS_OFFSET;
  
  pcVar4 = "SdbReleaseDatabase";
  FUN_18001188c(3,0x70,0x53,0x84,unaff_BL);
  if (*(int *)(param_1 + 0x3e0) == 0) {
    if (0 < *(int *)(param_1 + 1000)) {
      FUN_18001188c(1,0x70,0x72,0x50,unaff_BL);
      return;
    }
    FUN_180011850(param_1,pcVar4);
    if ((*(byte *)(param_1 + 0x78) & 2) != 0) {
      FUN_180011708(*(longlong ***)(param_1 + 0x70));
    }
    if (*(longlong ***)(param_1 + 8) != (longlong **)0x0) {
      FUN_180011708(*(longlong ***)(param_1 + 8));
    }
    while (plVar3 = *(longlong **)(param_1 + 0x238), plVar3 != (longlong *)0x0) {
      if ((longlong *)plVar3[1] == plVar3) {
        *(undefined8 *)(param_1 + 0x238) = 0;
      }
      else {
        *(longlong *)(param_1 + 0x238) = *plVar3;
        *(longlong *)plVar3[1] = *plVar3;
        *(longlong *)(*plVar3 + 8) = plVar3[1];
      }
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
    }
  }
  else {
    LOCK();
    piVar1 = (int *)(*(longlong *)(param_1 + 1000) + 1000);
    iVar2 = *piVar1;
    *piVar1 = *piVar1 + -1;
    if (iVar2 + -1 < 0) {
      LOCK();
      piVar1 = (int *)(*(longlong *)(param_1 + 1000) + 1000);
      *piVar1 = *piVar1 + 1;
      FUN_18001188c(1,0x70,100,0x18,unaff_BL);
    }
  }
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_1);
  return;
}



void FUN_180011708(longlong **param_1)

{
  longlong *plVar1;
  longlong in_GS_OFFSET;
  
  plVar1 = param_1[0xaa];
  if ((plVar1 != (longlong *)0x0) && (*(int *)(plVar1 + 2) == 1)) {
    if (plVar1[1] != 0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,plVar1[1]);
      plVar1 = param_1[0xaa];
    }
    if (plVar1 != (longlong *)0x0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
    }
    param_1[0xaa] = (longlong *)0x0;
    if (param_1[0xab] != (longlong *)0x0) {
      FUN_18007e32c((int *)param_1[0xab]);
      param_1[0xab] = (longlong *)0x0;
    }
  }
  if ((((*(byte *)(param_1 + 3) & 8) != 0) && ((*(byte *)(param_1 + 3) & 1) != 0)) &&
     (param_1[1] != (longlong *)0x0)) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
    param_1[1] = (longlong *)0x0;
    *(undefined4 *)((longlong)param_1 + 0x14) = 0;
  }
  FUN_18001175c(*param_1);
                    // WARNING: Could not recover jumptable at 0x00018001174a. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_1);
  return;
}



void FUN_18001175c(longlong *param_1)

{
  longlong in_GS_OFFSET;
  
  if (param_1 != (longlong *)0x0) {
    FUN_1800117d4((undefined (*) [16])(param_1 + 1));
    if (param_1[8] != 0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
      param_1[8] = 0;
    }
    if (*param_1 != 0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
      *param_1 = 0;
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_1);
  }
  return;
}



void FUN_1800117d4(undefined (*param_1) [16])

{
  if (param_1 != (undefined (*) [16])0x0) {
    if ((param_1[2][8] != '\0') && (*(longlong *)*param_1 != 0)) {
      ZwClose();
    }
    if ((param_1[2][9] != '\0') && (*(longlong *)(*param_1 + 8) != 0)) {
      ZwClose();
    }
    if ((param_1[2][10] != '\0') && (*(longlong *)(param_1[1] + 8) != 0)) {
      ZwUnmapViewOfSection(0xffffffffffffffff);
    }
    *param_1 = ZEXT816(0);
    param_1[1] = ZEXT816(0);
    param_1[2] = ZEXT816(0);
  }
  return;
}



undefined8 FUN_180011850(longlong param_1,undefined8 param_2)

{
  uint uVar1;
  
  if ((*(uint *)(param_1 + 0x1c) & 0xfff8) != 0) {
    uVar1 = 3;
    do {
      if ((*(uint *)(param_1 + 0x1c) >> (uVar1 & 0x1f) & 1) != 0) {
        FUN_180078948(param_1,param_2,uVar1);
      }
      uVar1 = uVar1 + 1;
    } while (uVar1 < 0x10);
  }
  if (*(longlong *)(param_1 + 0x10) != 0) {
    FUN_180078948(param_1,param_2,1);
  }
  return 1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_18001188c(undefined param_1,undefined param_2,undefined param_3,undefined param_4,
                  undefined1 param_5)

{
  if (DAT_1800b2a10 != 0) {
    (*(code *)DAT_1800b2a10)();
  }
  return;
}



void FUN_1800118b4(undefined8 param_1,undefined8 param_2,short param_3)

{
  longlong lVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  bool bVar4;
  undefined4 uVar5;
  longlong lVar6;
  undefined7 extraout_var;
  longlong **pplVar7;
  undefined8 uVar8;
  undefined uVar9;
  undefined8 uVar10;
  undefined uVar11;
  longlong in_GS_OFFSET;
  undefined auStackY632 [32];
  undefined uVar12;
  short local_248;
  short local_240;
  longlong local_238;
  wchar_t local_228 [264];
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStackY632;
  local_240 = param_3;
  memset(local_228,0,0x208);
  FUN_18001188c(3,0x90,0xf,0x50,0);
  uVar8 = 8;
  lVar6 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,0x3f0);
  local_238 = lVar6;
  if (lVar6 == 0) {
    FUN_18001188c(1,0x90,0x17,0xa8,0);
  }
  else {
    *(short *)(lVar6 + 0x240) = param_3;
    pplVar7 = (longlong **)&local_248;
    uVar10 = 1;
    local_248 = param_3;
    bVar4 = FUN_180011c80(local_228,uVar8,1);
    if ((int)CONCAT71(extraout_var,bVar4) == 0) {
      FUN_18001188c(1,0x50,0xd2,0x68,0);
      uVar12 = 1;
      uVar11 = 200;
      uVar9 = 0x26;
    }
    else {
      pplVar7 = FUN_180010688(local_228,uVar8,uVar10,pplVar7);
      *(longlong ***)(lVar6 + 8) = pplVar7;
      if (pplVar7 != (longlong **)0x0) {
        *(longlong ***)(lVar6 + 0x30) = pplVar7;
        *(undefined4 *)(lVar6 + 0x38) = 3;
        lVar1 = *(longlong *)(lVar6 + 8);
        uVar5 = *(undefined4 *)(lVar1 + 0x20);
        uVar2 = *(undefined4 *)(lVar1 + 0x24);
        uVar3 = *(undefined4 *)(lVar1 + 0x28);
        *(undefined4 *)(lVar6 + 0x20) = *(undefined4 *)(lVar1 + 0x1c);
        *(undefined4 *)(lVar6 + 0x24) = uVar5;
        *(undefined4 *)(lVar6 + 0x28) = uVar2;
        *(undefined4 *)(lVar6 + 0x2c) = uVar3;
        *(uint *)(lVar6 + 0x1c) = *(uint *)(lVar6 + 0x1c) | 1;
        FUN_180011c20(lVar6);
        uVar5 = FUN_180011a8c(param_3);
        *(undefined4 *)(lVar6 + 0x220) = uVar5;
        FUN_180011a10((int *)(lVar6 + 0x230));
        goto LAB_1800119e7;
      }
      uVar12 = SUB81(local_228,0);
      uVar11 = 8;
      uVar9 = 0x39;
    }
    FUN_18001188c(1,0x90,uVar9,uVar11,uVar12);
    if (*(longlong ***)(lVar6 + 8) != (longlong **)0x0) {
      FUN_180011708(*(longlong ***)(lVar6 + 8));
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lVar6);
  }
LAB_1800119e7:
  __security_check_cookie(local_18 ^ (ulonglong)auStackY632);
  return;
}



void FUN_180011a10(int *param_1)

{
  undefined auStack344 [32];
  undefined4 local_138;
  undefined local_134 [278];
  char local_1e;
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack344;
  memset(local_134,0,0x118);
  local_138 = 0x11c;
  RtlGetVersion(&local_138);
  *param_1 = (local_1e != '\x01') + 1;
  __security_check_cookie(local_18 ^ (ulonglong)auStack344);
  return;
}



undefined4 FUN_180011a8c(short param_1)

{
  undefined4 uVar1;
  int iVar2;
  short *psVar3;
  short local_res8 [4];
  short local_res10 [12];
  
  psVar3 = (short *)0x0;
  if (param_1 == 0x7fff) {
    local_res8[0] = -1;
  }
  else {
    local_res8[0] = FUN_180011bf4(param_1);
    if (local_res8[0] != -1) goto LAB_180011aba;
  }
  iVar2 = FUN_180011b58(local_res10,local_res8);
  if (iVar2 < 0) {
    FUN_18001188c(1,0xd0,0xd7,0x90,(char)iVar2);
    return 0;
  }
  psVar3 = local_res10;
LAB_180011aba:
  uVar1 = FUN_180011ad4(local_res8[0],psVar3);
  return uVar1;
}



undefined4 FUN_180011ad4(short param_1,short *param_2)

{
  int iVar1;
  short *psVar2;
  ulonglong uVar3;
  short local_res8 [4];
  
  if (param_1 != -1) {
    uVar3 = 0;
    local_res8[0] = -1;
    if (((param_2 == (short *)0x0) || (local_res8[0] = *param_2, local_res8[0] == -1)) &&
       (iVar1 = FUN_180011b58(local_res8,(undefined2 *)0x0), iVar1 < 0)) {
      FUN_18001188c(1,0xf0,0xf9,0x90,(char)iVar1);
    }
    else {
      psVar2 = &DAT_1800869d6;
      do {
        if ((param_1 == psVar2[-1]) && (local_res8[0] == *psVar2)) {
          return (&DAT_1800869d8)[uVar3 * 4];
        }
        uVar3 = uVar3 + 1;
        psVar2 = psVar2 + 8;
      } while (uVar3 < 7);
    }
  }
  return 0;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180011b58(undefined2 *param_1,undefined2 *param_2)

{
  int iVar1;
  undefined uVar2;
  undefined uVar3;
  undefined auStackY104 [32];
  undefined8 local_38;
  undefined4 local_30;
  undefined8 local_28;
  undefined4 local_20;
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStackY104;
  local_38 = 0;
  local_28 = 0;
  local_30 = 0;
  local_20 = 0;
  if (param_1 == (undefined2 *)0x0) {
LAB_180011bc0:
    if (param_2 == (undefined2 *)0x0) goto LAB_180011bcb;
    iVar1 = ZwQuerySystemInformation(1,&local_28,0xc);
    if (-1 < iVar1) {
      *param_2 = (undefined2)local_28;
      goto LAB_180011bcb;
    }
    uVar3 = 0xa0;
    uVar2 = 0x22;
  }
  else {
    iVar1 = RtlGetNativeSystemInformation(1,&local_38,0xc,0);
    if (-1 < iVar1) {
      *param_1 = (undefined2)local_38;
      goto LAB_180011bc0;
    }
    uVar3 = 0x58;
    uVar2 = 0;
  }
  FUN_18001188c(1,0x88,uVar2,uVar3,(char)iVar1);
LAB_180011bcb:
  __security_check_cookie(local_18 ^ (ulonglong)auStackY104);
  return;
}



undefined2 FUN_180011bf4(short param_1)

{
  ulonglong uVar1;
  
  uVar1 = 0;
  do {
    if ((&DAT_1800b2312)[uVar1 * 2] == param_1) {
      return (&DAT_1800b2310)[uVar1 * 2];
    }
    uVar1 = uVar1 + 1;
  } while (uVar1 < 4);
  return 0xffff;
}



void FUN_180011c20(longlong param_1)

{
  longlong lVar1;
  undefined8 *puVar2;
  
  puVar2 = (undefined8 *)(param_1 + 0x250);
  lVar1 = 0xb;
  do {
    *(undefined4 *)(puVar2 + -1) =
         *(undefined4 *)(((longlong)&PTR_FUN_18007f6e0 - param_1) + (longlong)puVar2);
    *puVar2 = *(undefined8 *)
               (((longlong)&PTR_BaseCleanupAppcompatCacheSupportWorker_18007f6e8 - param_1) +
               (longlong)puVar2);
    puVar2[1] = *(undefined8 *)(((longlong)&PTR_FUN_18007f6f0 - param_1) + (longlong)puVar2);
    puVar2 = puVar2 + 3;
    lVar1 = lVar1 + -1;
  } while (lVar1 != 0);
  return;
}



bool FUN_180011c80(undefined2 *param_1,undefined8 param_2,int param_3)

{
  int iVar1;
  undefined in_R9B;
  undefined7 in_register_00000089;
  
  iVar1 = FUN_180011cac(param_1,param_2,param_3,in_R9B,0,CONCAT71(in_register_00000089,in_R9B));
  return -1 < iVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

int FUN_180011cac(undefined2 *param_1,undefined8 param_2,int param_3,undefined param_4,
                 longlong param_5,undefined8 param_6)

{
  int iVar1;
  ulonglong uVar2;
  int *piVar3;
  undefined1 in_stack_ffffffffffffffd8;
  
  *param_1 = 0;
  if ((param_3 == 0) || (9 < param_3)) {
    iVar1 = -0x3fffff0f;
  }
  else {
    uVar2 = 1;
    piVar3 = &DAT_18007f040;
    do {
      if (*piVar3 == param_3) {
        if (uVar2 * 0x20 != -0x18007f020) {
          if (*(code **)(&UNK_18007f030 + uVar2 * 0x20) == (code *)0x0) {
            FUN_18001188c(1,0xc0,0xf,0xe0,in_stack_ffffffffffffffd8);
            return -0x3fffff1b;
          }
          iVar1 = (**(code **)(&UNK_18007f030 + uVar2 * 0x20))();
          if (-1 < iVar1) {
            return 0;
          }
          FUN_18001188c(1,0xc0,0x19,0x18,(char)param_3);
          return iVar1;
        }
        break;
      }
      uVar2 = uVar2 + 1;
      piVar3 = piVar3 + 8;
    } while (uVar2 < 10);
    FUN_18001188c(1,0xc0,1,0x88,(char)param_3);
    iVar1 = -0x3ffffddb;
  }
  return iVar1;
}



undefined4 FUN_180011d50(longlong param_1,short **param_2,short **param_3)

{
  short *psVar1;
  uint in_EAX;
  
  if (param_2 == (short **)0x0) {
    if ((param_3 == (short **)0x0) ||
       ((psVar1 = (short *)(param_1 + 0x68), *psVar1 == 0 &&
        (in_EAX = RtlAnsiStringToUnicodeString(psVar1,param_1 + 0x48,0), (int)in_EAX < 0)))) {
LAB_180011db4:
      return in_EAX & 0xffffff00;
    }
    *param_3 = psVar1;
  }
  else {
    psVar1 = (short *)(param_1 + 0x48);
    if ((*psVar1 == 0) &&
       (in_EAX = RtlUnicodeStringToAnsiString(psVar1,param_1 + 0x68,0), (int)in_EAX < 0))
    goto LAB_180011db4;
    *param_2 = psVar1;
  }
  return CONCAT31((int3)(in_EAX >> 8),1);
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Could not reconcile some variable overlaps

void BasepCheckWinSaferRestrictions(void *param_1,short *param_2,undefined8 param_3,ushort *param_4)

{
  char cVar1;
  int iVar2;
  int iVar3;
  DWORD DVar4;
  undefined4 *puVar5;
  void *_Dst;
  undefined8 *puVar6;
  void *pvVar7;
  void *pvVar8;
  longlong in_GS_OFFSET;
  bool bVar9;
  undefined auStack920 [32];
  undefined8 local_378;
  undefined *local_370;
  longlong local_368;
  ulonglong local_360;
  void *local_358;
  undefined local_350 [8];
  undefined8 local_348 [2];
  undefined4 local_338 [2];
  longlong local_330;
  undefined2 local_328;
  short local_326;
  longlong local_320;
  undefined8 local_318;
  undefined local_310 [4];
  undefined local_30c [4];
  undefined8 local_308;
  short local_300 [8];
  undefined4 local_2f0 [2];
  undefined8 local_2e8;
  undefined2 *local_2e0;
  undefined4 local_2d8;
  undefined local_2d0 [16];
  undefined4 local_2b8;
  uint local_2b4;
  short *local_2b0;
  undefined8 local_2a8;
  undefined4 local_238;
  void *local_230;
  undefined local_208 [4];
  int local_204;
  int local_200;
  int local_1fc;
  undefined local_1b8 [128];
  undefined local_138 [4];
  int local_134;
  int local_130;
  int local_12c;
  undefined8 local_e8 [18];
  ulonglong local_58;
  
                    // 0x11df0  82  BasepCheckWinSaferRestrictions
  local_58 = DAT_1800b2220 ^ (ulonglong)auStack920;
  _Dst = (void *)0x0;
  local_358 = (void *)0x0;
  local_368 = 0;
  pvVar7 = (void *)0x0;
  bVar9 = false;
  if ((param_2 == (short *)0x0) || (*param_2 == 0)) goto LAB_180011e72;
  if ((param_4 != (ushort *)0x0) && (*param_4 != 0)) {
    bVar9 = *(int *)(*(longlong *)(in_GS_OFFSET + 0x30) + 0x179c) != 0;
  }
  if ((DAT_1800b2230 == 0xfffffffffffffffe) && (!bVar9)) goto LAB_180011e72;
  RtlAcquireSRWLockExclusive(&DAT_1800b2d00);
  if ((DAT_1800b2230 == 0) || ((DAT_1800b2230 == 0xfffffffffffffffe && (!bVar9))))
  goto LAB_1800122af;
  if (param_1 == (void *)0x0) {
    if (*(int *)(*(longlong *)(in_GS_OFFSET + 0x30) + 0x179c) == 0) {
      iVar2 = -0x3fffff84;
    }
    else {
      iVar2 = NtOpenThreadToken(0xfffffffffffffffe,0x2000000,1,&local_368);
    }
    if (iVar2 == -0x3fffff84) {
      local_368 = 0;
LAB_180011ef7:
      iVar2 = NtOpenProcessToken(0xffffffffffffffff);
      if (iVar2 == -0x3fffffde) {
        iVar2 = NtOpenProcessToken(0xffffffffffffffff);
      }
      if (iVar2 < 0) {
        local_358 = _Dst;
      }
      if (local_368 != 0) {
        iVar3 = NtSetInformationThread(0xfffffffffffffffe);
        NtClose(local_368);
        local_368 = 0;
        pvVar8 = pvVar7;
        if (-1 < iVar3) goto LAB_180011f3c;
        goto LAB_180012290;
      }
LAB_180011f3c:
      param_1 = local_358;
      if (-1 < iVar2) goto LAB_180011f4b;
      if (DAT_1800b2230 == 0xffffffffffffffff) {
        DAT_1800b2230 = 0xfffffffffffffffe;
      }
    }
    else if (-1 < iVar2) {
      local_308 = 0;
      iVar2 = NtSetInformationThread(0xfffffffffffffffe,5,&local_308,8);
      if (-1 < iVar2) goto LAB_180011ef7;
      NtClose(local_368);
      local_368 = 0;
    }
  }
  else {
LAB_180011f4b:
    if (DAT_1800b2230 < 0xfffffffffffffffe) {
LAB_180030a93:
      memset(&local_2b8,0,0xb0);
      local_2b8 = 0xb0;
      local_238 = 2;
      local_2b0 = param_2;
      if ((param_4 == (ushort *)0x0) || (*param_4 == 0)) {
        local_2b4 = DAT_1800b2e70 | 5;
        local_2a8 = param_3;
      }
      else {
        _Dst = (void *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0)
        ;
        pvVar8 = _Dst;
        if (_Dst == (void *)0x0) goto LAB_180012290;
        memcpy(_Dst,*(void **)(param_4 + 4),(ulonglong)*param_4);
        *(undefined2 *)((longlong)_Dst + (ulonglong)(*param_4 >> 1) * 2) = 0;
        local_2b4 = 0x21;
        local_2a8 = 0;
        local_230 = _Dst;
      }
      iVar2 = (*(code *)DAT_1800b2fd8)();
      pvVar8 = _Dst;
      if (iVar2 != 0) {
        local_330 = 0;
        local_378 = (undefined *)0x0;
        iVar2 = (*(code *)DAT_1800b2fe8)();
        if (iVar2 == 0) {
          DVar4 = GetLastError();
          if ((DVar4 == 0x4ec) || (DVar4 == 0x312)) {
            (*(code *)DAT_1800b2ff0)();
          }
        }
        else if (local_330 != 0) {
          (*(code *)DAT_1800b2ff0)();
          NtClose(local_330);
        }
        (*(code *)DAT_1800b2fe0)();
      }
    }
    else {
      local_378 = local_310;
      puVar6 = local_e8;
      iVar2 = NtQueryInformationToken(param_1,1,puVar6,0x90);
      pvVar8 = _Dst;
      if (iVar2 < 0) {
LAB_18001205d:
        iVar2 = NtOpenKey(&local_318,3,&DAT_18007f1b0);
        if (iVar2 < 0) {
LAB_180012081:
          bVar9 = false;
          iVar2 = NtOpenKey(local_348,1,&DAT_18007f180);
          if (-1 < iVar2) {
            local_370 = local_350;
            local_378._0_4_ = 0x50;
            iVar2 = NtQueryValueKey(local_348[0],&DAT_18007f170,2,local_208);
            if (((-1 < iVar2) && (local_204 == 4)) && (local_200 == 4)) {
              bVar9 = local_1fc != 0;
            }
            local_370 = local_350;
            local_378 = (undefined *)CONCAT44(local_378._4_4_,0x50);
            iVar2 = NtQueryValueKey(local_348[0],&DAT_18007f160,2,local_208);
            if (((-1 < iVar2) && (local_204 == 4)) && ((local_200 == 4 && (local_1fc != 0)))) {
              DAT_1800b2e70 = 8;
            }
            NtClose(local_348[0]);
            if (!bVar9) goto LAB_18001216a;
LAB_180030977:
            local_338[0] = 0x1000;
            iVar2 = LdrLoadDll(0,local_338,&DAT_1800805a8,&local_360);
            if (iVar2 < 0) {
              DAT_1800b2230 = 0;
              pvVar8 = pvVar7;
            }
            else {
              iVar2 = LdrGetProcedureAddress(local_360,&DAT_180080598,0,&DAT_1800b2fd8);
              if (((((-1 < iVar2) && (DAT_1800b2fd8 != 0)) &&
                   ((iVar2 = LdrGetProcedureAddress(local_360,&DAT_180080588,0,&DAT_1800b2fe0),
                    -1 < iVar2 &&
                    ((DAT_1800b2fe0 != 0 &&
                     (iVar2 = LdrGetProcedureAddress(local_360,&DAT_180080578,0,&DAT_1800b2fe8),
                     -1 < iVar2)))))) && (DAT_1800b2fe8 != 0)) &&
                 ((iVar2 = LdrGetProcedureAddress(local_360,&DAT_180080568,0,&DAT_1800b2ff0),
                  -1 < iVar2 && (DAT_1800b2ff0 != 0)))) {
                DAT_1800b2230 = local_360;
                goto LAB_180030a93;
              }
              LdrUnloadDll(local_360);
              DAT_1800b2230 = 0;
              pvVar8 = pvVar7;
            }
            goto LAB_180012290;
          }
LAB_18001216a:
          iVar2 = RtlFormatCurrentUserKeyPath(local_300);
          if (-1 < iVar2) {
            local_326 = local_300[0] + 0x78;
            local_328 = 0;
            puVar5 = (undefined4 *)KernelBaseGetGlobalData();
            local_320 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                        *puVar5,local_326);
            if (local_320 != 0) {
              iVar2 = RtlAppendUnicodeStringToString(&local_328,local_300);
              if ((-1 < iVar2) &&
                 (iVar2 = RtlAppendUnicodeToString
                                    (&local_328,
                                     L"\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers"
                                    ), -1 < iVar2)) {
                local_2e0 = &local_328;
                local_2f0[0] = 0x30;
                local_2e8 = 0;
                local_2d8 = 0x40;
                local_2d0 = ZEXT816(0);
                iVar2 = NtOpenKey(local_348,1,local_2f0);
                if (-1 < iVar2) {
                  local_370 = local_350;
                  local_378 = (undefined *)CONCAT44(local_378._4_4_,0x50);
                  iVar2 = NtQueryValueKey(local_348[0],&DAT_18007f170,2,local_208);
                  if ((((-1 < iVar2) && (local_204 == 4)) && (local_200 == 4)) && (local_1fc != 0))
                  {
                    bVar9 = true;
                  }
                }
              }
              RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_320);
            }
            RtlFreeUnicodeString(local_300);
            if (bVar9) goto LAB_180030977;
          }
        }
        else {
          local_370 = local_30c;
          local_378 = (undefined *)CONCAT44(local_378._4_4_,0x50);
          iVar2 = NtQueryValueKey(local_318,&DAT_1800805b8,2,local_138);
          NtClose(local_318);
          if ((((iVar2 < 0) || (local_134 != 4)) || (local_130 != 4)) || (local_12c == 0))
          goto LAB_180012081;
        }
        DAT_1800b2230 = 0xfffffffffffffffe;
      }
      else {
        RtlInitializeSid(local_1b8,&DAT_1800857a4,(ulonglong)puVar6 & 0xffffffffffffff00 | 1);
        puVar5 = (undefined4 *)RtlSubAuthoritySid(local_1b8,0);
        *puVar5 = 0x12;
        cVar1 = RtlEqualSid(local_e8[0],local_1b8);
        if (cVar1 == '\0') {
          puVar5 = (undefined4 *)RtlSubAuthoritySid(local_1b8,0);
          *puVar5 = 0x13;
          cVar1 = RtlEqualSid(local_e8[0],local_1b8);
          if (cVar1 == '\0') {
            puVar5 = (undefined4 *)RtlSubAuthoritySid(local_1b8,0);
            *puVar5 = 0x14;
            cVar1 = RtlEqualSid(local_e8[0],local_1b8);
            if (cVar1 == '\0') goto LAB_18001205d;
          }
        }
      }
    }
LAB_180012290:
    if (local_358 != (void *)0x0) {
      NtClose();
    }
    if (pvVar8 != (void *)0x0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pvVar8);
    }
  }
LAB_1800122af:
  RtlReleaseSRWLockExclusive(&DAT_1800b2d00);
LAB_180011e72:
  __security_check_cookie(local_58 ^ (ulonglong)auStack920);
  return;
}



// Library Function - Single Match
//  BaseDllReadKeywordNames
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

ulonglong BaseDllReadKeywordNames(longlong param_1)

{
  ulonglong uVar1;
  
  uVar1 = FUN_18000f960(param_1);
  while( true ) {
    if ((int)uVar1 < 0) {
      return uVar1;
    }
    uVar1 = FUN_18000fac0(param_1,2);
    if ((int)uVar1 != 0x105) break;
    uVar1 = FUN_18000f720(param_1,*(ushort **)(param_1 + 0x100),*(ushort **)(param_1 + 0x148),'\x01'
                         );
  }
  if ((int)uVar1 != -0x7fffffe6) {
    return uVar1 & 0xffffffff;
  }
  return 0;
}



DWORD GetPrivateProfileStringW
                (LPCWSTR lpAppName,LPCWSTR lpKeyName,LPCWSTR lpDefault,LPWSTR lpReturnedString,
                DWORD nSize,LPCWSTR lpFileName)

{
  DWORD DVar1;
  int iVar2;
  uint uVar3;
  ulonglong uVar4;
  ulonglong _SizeInWords;
  DWORD DVar5;
  ulonglong _MaxCount;
  wchar_t *_Src;
  
                    // 0x12360  694  GetPrivateProfileStringW
  DVar1 = nSize;
  _SizeInWords = (ulonglong)nSize;
  uVar3 = 0;
  _Src = L"";
  if (lpDefault != (LPCWSTR)0x0) {
    _Src = lpDefault;
  }
  iVar2 = BaseDllReadWriteIniFile
                    ('\x01','\0','\0',lpFileName,lpAppName,lpKeyName,lpReturnedString,(int *)&nSize)
  ;
  if (iVar2 < 0) {
    if (iVar2 == -0x7ffffffb) {
      DVar5 = uVar3;
      if ((lpAppName == (LPCWSTR)0x0) || (lpKeyName == (LPCWSTR)0x0)) {
        if (1 < DVar1) {
          uVar3 = DVar1 - 2;
          lpReturnedString[DVar1 - 1] = L'\0';
          DVar5 = uVar3;
        }
      }
      else if (DVar1 != 0) {
        uVar3 = DVar1 - 1;
        DVar5 = uVar3;
      }
    }
    else {
      uVar4 = 0xffffffffffffffff;
      do {
        uVar4 = uVar4 + 1;
      } while (_Src[uVar4] != L'\0');
      uVar3 = (uint)uVar4;
      _MaxCount = uVar4 & 0xffffffff;
      while ((DVar5 = (DWORD)uVar4, uVar3 != 0 && (uVar3 = DVar5 - 1, _Src[uVar3] == L' '))) {
        _MaxCount = (ulonglong)uVar3;
        uVar4 = (ulonglong)uVar3;
      }
      if (DVar1 == 0) {
        BaseSetLastNTError();
        return 0;
      }
      if (DVar1 <= (uint)_MaxCount) {
        DVar5 = DVar1 - 1;
        _MaxCount = (ulonglong)DVar5;
      }
      uVar3 = (uint)_MaxCount;
      wcsncpy_s(lpReturnedString,_SizeInWords,_Src,_MaxCount);
    }
  }
  else {
    RtlSetLastWin32Error(0);
    uVar3 = nSize - 1;
    DVar5 = uVar3;
  }
  if (DVar1 <= uVar3) {
    if (DVar1 == 0) goto LAB_18001242e;
    uVar3 = DVar1 - 1;
  }
  lpReturnedString[uVar3] = L'\0';
LAB_18001242e:
  if (iVar2 < 0) {
    BaseSetLastNTError();
  }
  else {
    RtlSetLastWin32Error(0);
  }
  return DVar5;
}



undefined4
QueryActCtxWWorker(uint param_1,undefined8 param_2,longlong param_3,uint param_4,longlong param_5,
                  longlong param_6,undefined8 *param_7)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  
                    // 0x124d0  1096  QueryActCtxWWorker
  uVar3 = 0;
  if (param_7 != (undefined8 *)0x0) {
    *param_7 = 0;
  }
  uVar1 = param_1 & 3;
  if (uVar1 == 1) {
    param_1 = param_1 | 4;
  }
  else if (uVar1 == 2) {
    param_1 = param_1 | 8;
  }
  else if (uVar1 == 3) {
    param_1 = param_1 | 0x10;
  }
  if (((param_1 & 0x7fffffe0) != 0) || (param_4 == 0)) goto LAB_1800125b1;
  if (2 < param_4) {
    if (param_4 < 5) {
      if (param_3 == 0) goto LAB_1800125b1;
    }
    else if ((6 < param_4) || (param_3 != 0)) goto LAB_1800125b1;
  }
  if ((param_5 != 0) || ((param_6 == 0 && (param_7 != (undefined8 *)0x0)))) {
    uVar1 = param_1 & 0x1c;
    if (uVar1 != 0) {
      if (uVar1 == 4) {
        uVar3 = 1;
      }
      else if (uVar1 == 8) {
        uVar3 = 2;
      }
      else {
        if (uVar1 != 0x10) goto LAB_1800125b1;
        uVar3 = 4;
      }
    }
    uVar1 = uVar3 | 0x80000000;
    if (-1 < (int)param_1) {
      uVar1 = uVar3;
    }
    iVar2 = RtlQueryInformationActivationContext
                      (uVar1,param_2,param_3,param_4,param_5,param_6,param_7);
    if (-1 < iVar2) {
      return 1;
    }
  }
LAB_1800125b1:
  BaseSetLastNTError();
  return 0;
}



UINT GetAtomNameW(ATOM nAtom,LPWSTR lpBuffer,int nSize)

{
  void *pvVar1;
  
                    // 0x12630  455  GetAtomNameW
  pvVar1 = FUN_1800126a8('\x01','\x01',nAtom,lpBuffer,nSize);
  return (UINT)pvVar1;
}



// WARNING: Removing unreachable block (ram,0x000180012963)
// WARNING: Removing unreachable block (ram,0x000180012a28)
// WARNING: Removing unreachable block (ram,0x000180012a36)

ATOM GlobalAddAtomA(LPCSTR lpString)

{
  int iVar1;
  ushort auStackX24 [4];
  undefined4 uStackX32;
  undefined2 *puVar2;
  undefined2 auStack80 [4];
  undefined8 uStack72;
  undefined auStack64 [24];
  
                    // 0x12660  822  GlobalAddAtomA
  uStackX32 = 0;
  if (lpString < (LPCSTR)0x10000) {
    auStackX24[0] = (ushort)lpString;
    if (auStackX24[0] < 0xc000) {
      return auStackX24[0];
    }
  }
  else {
    RtlInitAnsiString(auStack64,lpString);
    puVar2 = auStack80;
    iVar1 = RtlAnsiStringToUnicodeString(auStack80,auStack64,1);
    if (-1 < iVar1) {
      auStackX24[0] = 0;
      iVar1 = NtAddAtomEx(uStack72,auStack80[0],auStackX24,0,iVar1,puVar2);
      if (iVar1 < 0) {
        BaseSetLastNTError();
        auStackX24[0] = 0;
      }
      RtlFreeUnicodeString(auStack80);
      return auStackX24[0];
    }
  }
  BaseSetLastNTError();
  return 0;
}



UINT GlobalGetAtomNameW(ATOM nAtom,LPWSTR lpBuffer,int nSize)

{
  void *pvVar1;
  
                    // 0x12680  835  GlobalGetAtomNameW
  pvVar1 = FUN_1800126a8('\0','\x01',nAtom,lpBuffer,nSize);
  return (UINT)pvVar1;
}



void * FUN_1800126a8(char param_1,char param_2,undefined2 param_3,void *param_4,uint param_5)

{
  int iVar1;
  undefined4 *puVar2;
  void *pvVar3;
  undefined8 uVar4;
  void *pvVar5;
  uint uVar6;
  void *pvVar7;
  longlong in_GS_OFFSET;
  int local_res10 [2];
  undefined2 local_res18;
  uint local_68 [2];
  ulonglong local_60;
  ushort local_58;
  undefined2 local_56;
  void *local_50;
  short local_48;
  short local_46;
  void *local_40;
  void *pvVar8;
  
  pvVar5 = (void *)0x0;
  local_res10[0] = 0;
  local_68[0] = 0;
  pvVar7 = (void *)0x0;
  if ((param_2 == '\0') && (0x7000 < param_5)) {
    param_5 = 0x7000;
  }
  local_res18 = param_3;
  if (param_5 == 0) goto LAB_1800127e1;
  if (param_1 == '\0') {
    local_res10[0] = param_5 * 2 + 8;
    puVar2 = (undefined4 *)KernelBaseGetGlobalData();
    pvVar3 = (void *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                     *puVar2,local_res10[0]);
    if (pvVar3 == (void *)0x0) goto LAB_1800127e1;
    iVar1 = NtQueryInformationAtom(param_3,0,pvVar3,local_res10[0],local_res10);
    pvVar8 = pvVar5;
    pvVar5 = pvVar3;
    if (-1 < iVar1) {
      pvVar3 = (void *)((longlong)pvVar3 + 6);
      local_68[0] = (uint)*(ushort *)((longlong)pvVar3 + 4);
      goto LAB_18001276e;
    }
  }
  else {
    pvVar3 = param_4;
    if (param_2 == '\0') {
      puVar2 = (undefined4 *)KernelBaseGetGlobalData();
      pvVar5 = (void *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                       *puVar2);
      pvVar3 = pvVar5;
      if (pvVar5 == (void *)0x0) goto LAB_1800127e1;
    }
    local_68[0] = param_5 * 2;
    uVar4 = FUN_180013114(&local_60);
    iVar1 = (int)uVar4;
    pvVar8 = pvVar7;
    if (-1 < iVar1) {
      iVar1 = RtlQueryAtomInAtomTable(local_60,local_res18,0,0,pvVar3,local_68);
LAB_18001276e:
      pvVar8 = pvVar7;
      if (-1 < iVar1) {
        if (param_2 == '\0') {
          local_48 = (short)local_68[0];
          local_46 = local_48 + 2;
          local_58 = 0;
          local_56 = (undefined2)param_5;
          local_50 = param_4;
          local_40 = pvVar3;
          iVar1 = RtlUnicodeStringToAnsiString(&local_58,&local_48,0);
          if (-1 < iVar1) {
            pvVar8 = (void *)(ulonglong)local_58;
          }
        }
        else {
          uVar6 = local_68[0] >> 1;
          pvVar8 = (void *)(ulonglong)uVar6;
          if (pvVar3 != param_4) {
            RtlMoveMemory(param_4,pvVar3,(ulonglong)local_68[0]);
          }
          if (uVar6 < param_5) {
            *(undefined2 *)((longlong)param_4 + (longlong)pvVar8 * 2) = 0;
          }
        }
      }
    }
  }
  if (pvVar5 != (void *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pvVar5);
  }
  if (-1 < iVar1) {
    return pvVar8;
  }
LAB_1800127e1:
  BaseSetLastNTError();
  return (void *)0x0;
}



// WARNING: Removing unreachable block (ram,0x0001800128af)
// WARNING: Removing unreachable block (ram,0x0001800128bd)

ATOM GlobalDeleteAtom(ATOM nAtom)

{
  int iVar1;
  
                    // 0x12850  828  GlobalDeleteAtom
  if ((0xbfff < nAtom) && (iVar1 = NtDeleteAtom(nAtom), iVar1 < 0)) {
    BaseSetLastNTError();
  }
  return 0;
}



// WARNING: Removing unreachable block (ram,0x00018001288d)

ATOM DeleteAtom(ATOM nAtom)

{
  int iVar1;
  undefined8 uVar2;
  ulonglong auStackX24 [2];
  
                    // 0x12860  275  DeleteAtom
  if ((0xbfff < nAtom) &&
     ((uVar2 = FUN_180013114(auStackX24), (int)uVar2 < 0 ||
      (iVar1 = RtlDeleteAtomFromAtomTable(auStackX24[0],nAtom), iVar1 < 0)))) {
    BaseSetLastNTError();
  }
  return 0;
}



// WARNING: Removing unreachable block (ram,0x000180012983)
// WARNING: Removing unreachable block (ram,0x0001800129f5)
// WARNING: Removing unreachable block (ram,0x000180012a6f)
// WARNING: Removing unreachable block (ram,0x000180012a79)
// WARNING: Removing unreachable block (ram,0x000180030dcf)

ATOM AddAtomW(LPCWSTR lpString)

{
  int iVar1;
  undefined8 uVar2;
  ATOM local_res18 [4];
  undefined4 local_res20;
  ulonglong local_58;
  undefined local_50 [8];
  undefined8 local_48;
  
                    // 0x128f0  6  AddAtomW
  local_res20 = 0;
  if (lpString < (LPCWSTR)0x10000) {
    local_res18[0] = (ATOM)lpString;
    if (0xbfff < local_res18[0]) {
      BaseSetLastNTError();
      local_res18[0] = 0;
    }
  }
  else {
    RtlInitUnicodeString(local_50);
    local_res18[0] = 0;
    uVar2 = FUN_180013114(&local_58);
    if (((int)uVar2 < 0) ||
       (iVar1 = RtlAddAtomToAtomTable(local_58,local_48,local_res18), iVar1 < 0)) {
      BaseSetLastNTError();
      local_res18[0] = 0;
    }
  }
  return local_res18[0];
}



// WARNING: Removing unreachable block (ram,0x000180012983)
// WARNING: Removing unreachable block (ram,0x000180012a28)
// WARNING: Removing unreachable block (ram,0x000180012a36)
// WARNING: Removing unreachable block (ram,0x000180012a6f)
// WARNING: Removing unreachable block (ram,0x000180012a79)
// WARNING: Removing unreachable block (ram,0x000180030dcf)

ATOM GlobalAddAtomW(LPCWSTR lpString)

{
  int iVar1;
  ATOM aAStackX24 [4];
  undefined4 uStackX32;
  undefined2 *puVar2;
  undefined2 auStack80 [4];
  undefined8 uStack72;
  
                    // 0x12910  825  GlobalAddAtomW
  uStackX32 = 0;
  if (lpString < (LPCWSTR)0x10000) {
    aAStackX24[0] = (ATOM)lpString;
    if (0xbfff < aAStackX24[0]) {
      BaseSetLastNTError();
      aAStackX24[0] = 0;
    }
  }
  else {
    puVar2 = auStack80;
    RtlInitUnicodeString(auStack80);
    aAStackX24[0] = 0;
    iVar1 = NtAddAtomEx(uStack72,auStack80[0],aAStackX24,0,0,puVar2);
    if (iVar1 < 0) {
      BaseSetLastNTError();
      aAStackX24[0] = 0;
    }
  }
  return aAStackX24[0];
}



BOOL DosDateTimeToFileTime(WORD wFatDate,WORD wFatTime,LPFILETIME lpFileTime)

{
  char cVar1;
  BOOL extraout_EAX;
  undefined auStack72 [32];
  DWORD local_28;
  DWORD local_24;
  short local_20;
  ushort local_1e;
  ushort local_1c;
  ushort local_1a;
  ushort local_18;
  short local_16;
  undefined2 local_14;
  ulonglong local_10;
  
                    // 0x12a90  302  DosDateTimeToFileTime
  local_10 = DAT_1800b2220 ^ (ulonglong)auStack72;
  local_20 = (wFatDate >> 9) + 0x7bc;
  local_1c = wFatDate & 0x1f;
  local_1e = wFatDate >> 5 & 0xf;
  local_14 = 0;
  local_1a = wFatTime >> 0xb;
  local_16 = (wFatTime & 0x1f) * 2;
  local_18 = wFatTime >> 5 & 0x3f;
  cVar1 = RtlTimeFieldsToTime(&local_20,&local_28);
  if (cVar1 == '\0') {
    BaseSetLastNTError();
  }
  else {
    lpFileTime->dwLowDateTime = local_28;
    lpFileTime->dwHighDateTime = local_24;
  }
  __security_check_cookie(local_10 ^ (ulonglong)auStack72);
  return extraout_EAX;
}



void QueryActCtxSettingsWWorker
               (int param_1,undefined8 param_2,longlong param_3,longlong param_4,longlong param_5,
               longlong param_6,undefined8 *param_7)

{
  int iVar1;
  uint uVar2;
  wchar_t **ppwVar3;
  undefined auStack248 [32];
  longlong local_d8;
  longlong local_d0;
  undefined8 *local_c8;
  longlong local_b8;
  undefined8 local_b0;
  undefined local_a8 [16];
  undefined local_98 [16];
  wchar_t *local_88 [4];
  wchar_t *local_68;
  wchar_t *local_60;
  wchar_t *local_58;
  wchar_t *local_50;
  ulonglong local_48;
  
                    // 0x12b70  1094  QueryActCtxSettingsWWorker
  local_48 = DAT_1800b2220 ^ (ulonglong)auStack248;
  uVar2 = 0;
  local_b8 = param_5;
  if (param_7 != (undefined8 *)0x0) {
    *param_7 = 0;
  }
  local_b0 = param_2;
  if (((param_1 == 0) && (param_4 != 0)) && ((param_6 == 0 || (param_5 != 0)))) {
    if (param_3 == 0) {
LAB_180012c9c:
      local_c8 = param_7;
      local_d0 = param_6;
      local_d8 = local_b8;
      iVar1 = RtlQueryActivationContextApplicationSettings(0,local_b0,param_3,param_4);
      if (-1 < iVar1) goto LAB_180012cce;
    }
    else {
      local_88[0] = L"http://schemas.microsoft.com/SMI/2005/WindowsSettings";
      local_88[1] = L"http://schemas.microsoft.com/SMI/2011/WindowsSettings";
      local_88[2] = L"http://schemas.microsoft.com/SMI/2013/WindowsSettings";
      local_88[3] = L"http://schemas.microsoft.com/SMI/2014/WindowsSettings";
      local_68 = L"http://schemas.microsoft.com/SMI/2016/WindowsSettings";
      local_60 = L"http://schemas.microsoft.com/SMI/2017/WindowsSettings";
      local_58 = L"http://schemas.microsoft.com/SMI/2019/WindowsSettings";
      local_50 = L"http://schemas.microsoft.com/SMI/2020/WindowsSettings";
      RtlInitUnicodeString(local_98,param_3);
      ppwVar3 = local_88;
      do {
        RtlInitUnicodeString(local_a8,*ppwVar3);
        iVar1 = RtlCompareUnicodeString(local_98,local_a8,0);
        if (iVar1 == 0) goto LAB_180012c9c;
        uVar2 = uVar2 + 1;
        ppwVar3 = ppwVar3 + 1;
      } while (uVar2 < 8);
    }
  }
  BaseSetLastNTError();
LAB_180012cce:
  __security_check_cookie(local_48 ^ (ulonglong)auStack248);
  return;
}



// WARNING: Removing unreachable block (ram,0x000180012e66)
// WARNING: Removing unreachable block (ram,0x000180012ed0)
// WARNING: Removing unreachable block (ram,0x000180012f38)
// WARNING: Removing unreachable block (ram,0x000180012ed5)
// WARNING: Removing unreachable block (ram,0x000180012f62)
// WARNING: Removing unreachable block (ram,0x000180012f6c)
// WARNING: Removing unreachable block (ram,0x000180030e39)

ATOM FindAtomW(LPCWSTR lpString)

{
  int iVar1;
  undefined8 uVar2;
  undefined8 in_R9;
  ATOM aAStackX24 [4];
  ulonglong uStackX32;
  undefined4 uVar3;
  undefined *puVar4;
  undefined auStack72 [8];
  undefined8 uStack64;
  
                    // 0x12d10  382  FindAtomW
  if (lpString < (LPCWSTR)0x10000) {
    aAStackX24[0] = (ATOM)lpString;
    if (0xbfff < aAStackX24[0]) {
      BaseSetLastNTError();
      aAStackX24[0] = 0;
    }
  }
  else {
    puVar4 = auStack72;
    RtlInitUnicodeString(auStack72);
    uVar3 = 0;
    aAStackX24[0] = 0;
    uVar2 = FUN_180013114(&uStackX32);
    if (((int)uVar2 < 0) ||
       (iVar1 = RtlLookupAtomInAtomTable(uStackX32,uStack64,aAStackX24,in_R9,uVar3,puVar4),
       iVar1 < 0)) {
      BaseSetLastNTError();
      aAStackX24[0] = 0;
    }
  }
  return aAStackX24[0];
}



BOOL FileTimeToDosDateTime(FILETIME *lpFileTime,LPWORD lpFatDate,LPWORD lpFatTime)

{
  BOOL extraout_EAX;
  undefined auStack88 [32];
  longlong local_38;
  short local_30;
  ushort local_2e;
  ushort local_2c;
  short local_2a;
  ushort local_28;
  ushort local_26;
  ulonglong local_20;
  
                    // 0x12d30  370  FileTimeToDosDateTime
  local_20 = DAT_1800b2220 ^ (ulonglong)auStack88;
  local_38 = (longlong)*lpFileTime + 19999999;
  if (local_38 < 0) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    RtlTimeToTimeFields(&local_38,&local_30);
    if ((ushort)(local_30 - 0x7bcU) < 0x80) {
      *lpFatDate = ((local_30 + -0x3c) * 0x10 | local_2e) << 5 | local_2c;
      *lpFatTime = (local_2a << 6 | local_28) << 5 | local_26 >> 1;
    }
    else {
      BaseSetLastNTError();
    }
  }
  __security_check_cookie(local_20 ^ (ulonglong)auStack88);
  return extraout_EAX;
}



// WARNING: Removing unreachable block (ram,0x000180012e66)
// WARNING: Removing unreachable block (ram,0x000180012f05)
// WARNING: Removing unreachable block (ram,0x000180012f16)
// WARNING: Removing unreachable block (ram,0x000180012f62)
// WARNING: Removing unreachable block (ram,0x000180012f6c)
// WARNING: Removing unreachable block (ram,0x000180030e39)

ATOM GlobalFindAtomW(LPCWSTR lpString)

{
  int iVar1;
  undefined8 in_R9;
  ATOM aAStackX24 [8];
  short *psVar2;
  short asStack72 [4];
  undefined8 uStack64;
  
                    // 0x12e00  830  GlobalFindAtomW
  if (lpString < (LPCWSTR)0x10000) {
    aAStackX24[0] = (ATOM)lpString;
    if (0xbfff < aAStackX24[0]) {
      BaseSetLastNTError();
      aAStackX24[0] = 0;
    }
  }
  else {
    psVar2 = asStack72;
    RtlInitUnicodeString(asStack72);
    aAStackX24[0] = 0;
    if (asStack72[0] == 0) {
      RtlSetLastWin32Error(0x7b);
    }
    else {
      iVar1 = NtFindAtom(uStack64,asStack72[0],aAStackX24,in_R9,0,psVar2);
      if (iVar1 < 0) {
        BaseSetLastNTError();
        aAStackX24[0] = 0;
      }
    }
  }
  return aAStackX24[0];
}



undefined4
FindActCtxSectionGuidWorker
          (uint param_1,undefined8 param_2,undefined4 param_3,undefined8 param_4,uint *param_5)

{
  uint *puVar1;
  int iVar2;
  undefined8 uVar3;
  uint uVar4;
  uint uVar5;
  undefined4 local_88;
  undefined local_84 [108];
  
                    // 0x12f90  377  FindActCtxSectionGuidWorker
  uVar4 = 0;
  uVar5 = 0;
  if (param_5 != (uint *)0x0) {
    uVar5 = *param_5;
    if ((0x3f < uVar5) && ((param_1 & 0xfffffff8) == 0)) {
      if ((param_1 & 1) != 0) {
        if ((uint *)((ulonglong)uVar5 + (longlong)param_5) < param_5 + 0x10) goto LAB_180030e52;
        uVar4 = 1;
      }
      puVar1 = (uint *)((longlong)param_5 + (ulonglong)uVar5);
      if ((param_1 & 2) != 0) {
        if (puVar1 < param_5 + 0x12) goto LAB_180030e52;
        uVar4 = uVar4 | 2;
      }
      if ((param_1 & 4) != 0) {
        if (puVar1 < param_5 + 0x1c) goto LAB_180030e52;
        uVar4 = uVar4 | 4;
      }
      memset(local_84,0,0x6c);
      local_88 = 0x70;
      iVar2 = RtlFindActivationContextSectionGuid(uVar4,param_2,param_3,param_4,&local_88);
      if (iVar2 < 0) {
        BaseSetLastNTError();
        return 0;
      }
      uVar3 = FUN_18001349c((byte)param_1,param_5,(longlong)&local_88);
      if ((int)uVar3 == 0) {
        return 0;
      }
      return 1;
    }
  }
LAB_180030e52:
  if (param_5 == (uint *)0x0) {
    uVar5 = 0;
  }
  DbgPrintEx(0x33,0,
             "SXS: Invalid parameter(s) passed to FindActCtxSection*()\n   dwFlags = 0x%08lx\n   ReturnedData = %p\n      ->cbSize = %u\n"
             ,param_1,param_5,uVar5);
  RtlSetLastWin32Error(0x57);
  return 0;
}



undefined4 BaseSetLastNTError(void)

{
  undefined4 uVar1;
  
                    // 0x130e0  68  BaseSetLastNTError
  uVar1 = RtlNtStatusToDosError();
  RtlSetLastWin32Error(uVar1);
  return uVar1;
}



undefined8 FUN_180013114(ulonglong *param_1)

{
  ulonglong uVar1;
  undefined8 uVar2;
  bool bVar3;
  ulonglong local_res10 [3];
  
  local_res10[0] = DAT_1800b2b38;
  if (DAT_1800b2b38 == 0) {
    uVar2 = RtlCreateAtomTable(0,local_res10);
    if ((int)uVar2 < 0) {
      return uVar2;
    }
    LOCK();
    bVar3 = DAT_1800b2b38 == 0;
    DAT_1800b2b38 = DAT_1800b2b38 ^ (ulonglong)bVar3 * (DAT_1800b2b38 ^ local_res10[0]);
    uVar1 = !bVar3 * DAT_1800b2b38;
    if (!bVar3) {
      RtlDestroyAtomTable(local_res10[0]);
      local_res10[0] = uVar1;
    }
  }
  *param_1 = local_res10[0];
  return 0;
}



// WARNING: Removing unreachable block (ram,0x000180012983)
// WARNING: Removing unreachable block (ram,0x000180012a28)
// WARNING: Removing unreachable block (ram,0x000180012a36)
// WARNING: Removing unreachable block (ram,0x000180012a6f)
// WARNING: Removing unreachable block (ram,0x000180012a79)
// WARNING: Removing unreachable block (ram,0x000180030dcf)

ulonglong GlobalAddAtomExW(ulonglong param_1,undefined4 param_2)

{
  int iVar1;
  ulonglong uVar2;
  ushort auStackX24 [4];
  undefined4 uStackX32;
  undefined2 *puVar3;
  undefined2 auStack80 [4];
  undefined8 uStack72;
  
                    // 0x13190  824  GlobalAddAtomExW
  uStackX32 = param_2;
  if (param_1 < 0x10000) {
    auStackX24[0] = (ushort)param_1;
    if (auStackX24[0] < 0xc000) {
      uVar2 = param_1 & 0xffff;
    }
    else {
      BaseSetLastNTError();
      uVar2 = 0;
    }
  }
  else {
    puVar3 = auStack80;
    RtlInitUnicodeString(auStack80);
    auStackX24[0] = 0;
    iVar1 = NtAddAtomEx(uStack72,auStack80[0],auStackX24,param_2,0,puVar3);
    if (iVar1 < 0) {
      BaseSetLastNTError();
      auStackX24[0] = 0;
    }
    uVar2 = (ulonglong)auStackX24[0];
  }
  return uVar2;
}



UINT GetPrivateProfileIntW(LPCWSTR lpAppName,LPCWSTR lpKeyName,INT nDefault,LPCWSTR lpFileName)

{
  DWORD DVar1;
  UINT extraout_EAX;
  int iVar2;
  undefined auStackY648 [32];
  undefined4 local_258 [2];
  short local_250;
  short local_24e;
  WCHAR *local_248;
  undefined local_240 [8];
  undefined8 local_238;
  WCHAR local_228 [256];
  ulonglong local_28;
  
                    // 0x131b0  688  GetPrivateProfileIntW
  local_28 = DAT_1800b2220 ^ (ulonglong)auStackY648;
  local_258[0] = 0;
  DVar1 = GetPrivateProfileStringW(lpAppName,lpKeyName,(LPCWSTR)0x0,local_228,0x100,lpFileName);
  if (DVar1 != 0) {
    local_250 = (short)DVar1 * 2;
    local_248 = local_228;
    local_24e = local_250 + 2;
    iVar2 = RtlUnicodeStringToAnsiString(local_240,&local_250,1);
    if (-1 < iVar2) {
      iVar2 = RtlCharToInteger(local_238,0,local_258);
      RtlFreeAnsiString(local_240);
      if (-1 < iVar2) {
        RtlSetLastWin32Error(0);
        goto LAB_1800131f9;
      }
    }
    BaseSetLastNTError();
  }
LAB_1800131f9:
  __security_check_cookie(local_28 ^ (ulonglong)auStackY648);
  return extraout_EAX;
}



bool FindActCtxSectionStringWWorker
               (uint param_1,undefined8 param_2,undefined4 param_3,longlong param_4,uint *param_5)

{
  bool bVar1;
  undefined *puVar2;
  undefined7 extraout_var;
  undefined local_18 [16];
  
                    // 0x132b0  380  FindActCtxSectionStringWWorker
  puVar2 = (undefined *)0x0;
  if (param_4 != 0) {
    RtlInitUnicodeString(local_18,param_4);
    puVar2 = local_18;
  }
  bVar1 = FUN_180013330(param_1,param_2,param_3,puVar2,param_5);
  return (int)CONCAT71(extraout_var,bVar1) != 0;
}



bool FUN_180013330(uint param_1,undefined8 param_2,undefined4 param_3,undefined8 param_4,
                  uint *param_5)

{
  int iVar1;
  undefined8 uVar2;
  bool bVar3;
  uint local_88 [4];
  undefined4 local_78;
  undefined local_74 [108];
  
  local_88[0] = 0;
  iVar1 = FUN_180013400(param_1,param_5,local_88);
  bVar3 = false;
  if (iVar1 != 0) {
    memset(local_74,0,0x6c);
    local_78 = 0x70;
    iVar1 = RtlFindActivationContextSectionString(local_88[0],param_2,param_3,param_4,&local_78);
    if (iVar1 < 0) {
      BaseSetLastNTError();
      bVar3 = false;
    }
    else {
      uVar2 = FUN_18001349c((byte)param_1,param_5,(longlong)&local_78);
      bVar3 = (int)uVar2 != 0;
    }
  }
  return bVar3;
}



undefined4 FUN_180013400(uint param_1,uint *param_2,uint *param_3)

{
  uint *puVar1;
  uint uVar2;
  uint uVar3;
  
  uVar3 = 0;
  uVar2 = 0;
  if (param_3 != (uint *)0x0) {
    *param_3 = 0;
  }
  if ((param_2 != (uint *)0x0) && (param_3 != (uint *)0x0)) {
    uVar3 = *param_2;
    if ((0x3f < uVar3) && ((param_1 & 0xfffffff8) == 0)) {
      if ((param_1 & 1) != 0) {
        if ((uint *)((ulonglong)uVar3 + (longlong)param_2) < param_2 + 0x10) goto LAB_180030ecc;
        uVar2 = 1;
      }
      puVar1 = (uint *)((longlong)param_2 + (ulonglong)uVar3);
      if ((param_1 & 2) != 0) {
        if (puVar1 < param_2 + 0x12) goto LAB_180030ecc;
        uVar2 = uVar2 | 2;
      }
      if ((param_1 & 4) != 0) {
        if (puVar1 < param_2 + 0x1c) goto LAB_180030ecc;
        uVar2 = uVar2 | 4;
      }
      *param_3 = uVar2;
      return 1;
    }
  }
LAB_180030ecc:
  DbgPrintEx(0x33,0,
             "SXS: Invalid parameter(s) passed to FindActCtxSection*()\n   dwFlags = 0x%08lx\n   ReturnedData = %p\n      ->cbSize = %u\n"
             ,param_1,param_2,-(uint)(param_2 != (uint *)0x0) & uVar3);
  RtlSetLastWin32Error(0x57);
  return 0;
}



undefined8 FUN_18001349c(byte param_1,uint *param_2,longlong param_3)

{
  param_2[1] = *(uint *)(param_3 + 4);
  *(undefined8 *)(param_2 + 2) = *(undefined8 *)(param_3 + 8);
  param_2[4] = *(uint *)(param_3 + 0x10);
  *(undefined8 *)(param_2 + 6) = *(undefined8 *)(param_3 + 0x18);
  param_2[8] = *(uint *)(param_3 + 0x20);
  *(undefined8 *)(param_2 + 10) = *(undefined8 *)(param_3 + 0x28);
  param_2[0xc] = *(uint *)(param_3 + 0x30);
  *(undefined8 *)(param_2 + 0xe) = *(undefined8 *)(param_3 + 0x38);
  if (param_2 + 0x11 <= (uint *)((ulonglong)*param_2 + (longlong)param_2)) {
    param_2[0x10] = *(uint *)(param_3 + 0x40);
  }
  if ((param_1 & 2) != 0) {
    param_2[0x11] = *(uint *)(param_3 + 0x44);
  }
  if ((param_1 & 4) != 0) {
    *(undefined8 *)(param_2 + 0x12) = *(undefined8 *)(param_3 + 0x48);
    *(undefined8 *)(param_2 + 0x14) = *(undefined8 *)(param_3 + 0x50);
    param_2[0x16] = *(uint *)(param_3 + 0x58);
    *(undefined8 *)(param_2 + 0x18) = *(undefined8 *)(param_3 + 0x60);
    param_2[0x1a] = *(uint *)(param_3 + 0x68);
  }
  return 1;
}



UINT GetProfileIntW(LPCWSTR lpAppName,LPCWSTR lpKeyName,INT nDefault)

{
  UINT UVar1;
  
                    // 0x13520  720  GetProfileIntW
  UVar1 = GetPrivateProfileIntW(lpAppName,lpKeyName,nDefault,(LPCWSTR)0x0);
  return UVar1;
}



HRSRC FindResourceA(HMODULE hModule,LPCSTR lpName,LPCSTR lpType)

{
  HRSRC pHVar1;
  
                    // 0x13530  413  FindResourceA
  pHVar1 = FindResourceExA(hModule,lpType,lpName,0);
  return pHVar1;
}



// WARNING: Could not reconcile some variable overlaps

HRSRC FindResourceExA(HMODULE hModule,LPCSTR lpType,LPCSTR lpName,WORD wLanguage)

{
  int iVar1;
  short *psVar2;
  ulonglong uVar3;
  HRSRC extraout_RAX;
  undefined auStack104 [32];
  int local_48;
  undefined8 local_40;
  undefined local_38 [16];
  ulonglong local_28;
  ulonglong local_20;
  
                    // 0x13550  414  FindResourceExA
  local_20 = DAT_1800b2220 ^ (ulonglong)auStack104;
  local_40 = 0;
  local_38 = ZEXT816(0);
  psVar2 = FUN_180013640((short *)lpType);
  local_38 = CONCAT88(local_38._8_8_,psVar2);
  if (psVar2 != (short *)0xffffffffffffffff) {
    psVar2 = FUN_180013640((short *)lpName);
    local_38 = CONCAT88(psVar2,local_38._0_8_);
    if (psVar2 != (short *)0xffffffffffffffff) {
      local_40 = 0;
      local_28 = (ulonglong)wLanguage;
      uVar3 = BasepMapModuleHandle((ulonglong)hModule,'\x01');
      local_48 = LdrFindResource_U(uVar3,local_38,3,&local_40);
      goto LAB_1800135ea;
    }
  }
  local_48 = -0x3ffffff3;
LAB_1800135ea:
  iVar1 = local_48;
  BaseDllFreeResourceId(local_38._0_8_);
  BaseDllFreeResourceId(local_38._8_8_);
  if (iVar1 < 0) {
    BaseSetLastNTError();
  }
  __security_check_cookie(local_20 ^ (ulonglong)auStack104);
  return extraout_RAX;
}



short * FUN_180013640(short *param_1)

{
  short sVar1;
  int iVar2;
  short *psVar3;
  uint local_res10 [6];
  undefined local_28 [8];
  short *local_20;
  undefined local_18 [16];
  
  if ((short *)0xffff < param_1) {
    if (*(char *)param_1 == '#') {
      iVar2 = RtlCharToInteger((longlong)param_1 + 1,10,local_res10);
      if ((-1 < iVar2) && ((local_res10[0] & 0xffff0000) == 0)) {
        return (short *)(ulonglong)local_res10[0];
      }
    }
    else {
      RtlInitAnsiString(local_18,param_1);
      iVar2 = RtlAnsiStringToUnicodeString(local_28,local_18,1);
      psVar3 = local_20;
      if (-1 < iVar2) {
        for (; *psVar3 != 0; psVar3 = psVar3 + 1) {
          sVar1 = RtlUpcaseUnicodeChar(*psVar3);
          *psVar3 = sVar1;
        }
        return local_20;
      }
    }
    BaseSetLastNTError();
    param_1 = (short *)0xffffffffffffffff;
  }
  return param_1;
}



ulonglong BasepMapModuleHandle(ulonglong param_1,char param_2)

{
  longlong in_GS_OFFSET;
  
                    // 0x13740  94  BasepMapModuleHandle
  if (param_1 == 0) {
    return *(ulonglong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x10);
  }
  if (((param_1 & 3) != 0) && (param_2 == '\0')) {
    return 0;
  }
  return param_1;
}



BOOL UnregisterWait(HANDLE WaitHandle)

{
  int iVar1;
  
                    // 0x13770  1482  UnregisterWait
  if (WaitHandle == (HANDLE)0x0) {
    RtlSetLastWin32Error(6);
  }
  else {
    iVar1 = RtlDeregisterWait();
    if ((-1 < iVar1) && (iVar1 != 0x103)) {
      return 1;
    }
    BaseSetLastNTError();
  }
  return 0;
}



// WARNING: Could not reconcile some variable overlaps

void CreateActCtxWWorker(uint *param_1)

{
  uint *puVar1;
  ulonglong *puVar2;
  uint *puVar3;
  code *pcVar4;
  undefined auVar5 [16];
  bool bVar6;
  char cVar7;
  uint uVar8;
  int iVar9;
  DWORD DVar10;
  undefined7 extraout_var;
  undefined4 *puVar11;
  longlong lVar12;
  longlong lVar13;
  ushort uVar14;
  HMODULE hModule;
  undefined8 uVar15;
  ulonglong uVar16;
  char *pcVar17;
  ulonglong uVar18;
  size_t sVar19;
  void *pvVar20;
  void *_Dst;
  void *pvVar21;
  undefined2 *_Dst_00;
  ulonglong uVar22;
  longlong in_GS_OFFSET;
  bool bVar23;
  undefined auStack1096 [32];
  uint *local_428;
  undefined8 *local_420;
  short local_418;
  ulonglong local_410;
  undefined8 local_408;
  undefined4 local_400;
  undefined local_3fc [4];
  undefined auStack1016 [10];
  undefined2 uStack1006;
  undefined4 local_3ec;
  uint *puStack1000;
  undefined4 uStack992;
  undefined4 uStack988;
  uint *puStack984;
  undefined4 uStack976;
  undefined4 local_3cc;
  longlong local_3c0;
  longlong local_3b8;
  ushort local_3b0 [4];
  void *local_3a8;
  void *local_3a0;
  undefined local_398 [8];
  undefined2 *local_390;
  undefined local_388 [8];
  undefined2 *local_380;
  undefined local_378 [8];
  undefined2 *local_370;
  undefined local_368 [4];
  undefined auStack868 [12];
  undefined local_358 [16];
  undefined local_348 [8];
  undefined8 uStack832;
  undefined8 local_338;
  undefined local_330 [4];
  undefined auStack812 [12];
  undefined local_320 [16];
  undefined local_310 [8];
  undefined8 uStack776;
  undefined8 local_300;
  undefined local_2f8 [8];
  uint *puStack752;
  undefined local_2e8 [16];
  undefined local_2d8 [8];
  undefined8 uStack720;
  undefined8 local_2c8;
  WCHAR local_2b8 [128];
  undefined2 local_1b8 [64];
  undefined2 local_138 [128];
  ulonglong local_38;
  
                    // 0x137b0  181  CreateActCtxWWorker
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack1096;
  local_408 = 0xffffffffffffffff;
  pvVar20 = (void *)0x0;
  local_400 = 0x38;
  local_3b8 = 0;
  local_3cc = 0;
  local_410 = 0;
  local_3c0 = 0;
  _Dst = (void *)0x0;
  local_338 = 0;
  local_300 = 0;
  bVar23 = false;
  local_2c8 = 0;
  _local_3fc = ZEXT816(0);
  local_3ec = 0;
  puStack1000 = SUB168(ZEXT816(0) >> 0x20,0);
  uStack992 = 0;
  uStack988 = 0;
  puStack984 = SUB168(ZEXT816(0) >> 0x20,0);
  uStack976 = 0;
  _local_368 = ZEXT816(0);
  local_358 = ZEXT816(0);
  _local_348 = ZEXT816(0);
  _local_330 = ZEXT816(0);
  local_320 = ZEXT816(0);
  _local_310 = ZEXT816(0);
  _local_2f8 = ZEXT816(0);
  local_2e8 = ZEXT816(0);
  _local_2d8 = ZEXT816(0);
  if (param_1 == (uint *)0x0) {
LAB_18003179b:
    pcVar17 = "SXS: %s() Null %p or size 0x%lx too small\n";
    local_420 = (undefined8 *)((ulonglong)local_420 & 0xffffffff00000000 | (ulonglong)*param_1);
    local_428 = param_1;
LAB_1800317ad:
    DbgPrintEx(0x33,0,pcVar17,"CreateActCtxWWorker");
    pvVar20 = _Dst;
LAB_1800317c5:
    _Dst = pvVar20;
    iVar9 = -0x3ffffff3;
  }
  else {
    uVar8 = *param_1;
    puVar1 = param_1 + 4;
    puVar3 = (uint *)((longlong)param_1 + (ulonglong)uVar8);
    if (puVar3 < puVar1) goto LAB_18003179b;
    local_3fc = param_1[1];
    _auStack1016 = SUB1612(_local_3fc >> 0x20,0);
    if (((((local_3fc & 0xffffff00) != 0) ||
         (((local_3fc & 1) != 0 && (puVar3 < (uint *)((longlong)param_1 + 0x12U))))) ||
        ((((local_3fc & 2) != 0 && (puVar3 < param_1 + 5)) ||
         (((((local_3fc & 4) != 0 && (puVar3 < param_1 + 8)) ||
           (((local_3fc & 8) != 0 && (puVar3 < param_1 + 10)))) ||
          (((local_3fc & 0x20) != 0 && (puVar3 < param_1 + 0xc)))))))) ||
       (((puVar3 = (uint *)((ulonglong)uVar8 + (longlong)param_1), (local_3fc & 0x80) != 0 &&
         (puVar3 < param_1 + 0xe)) || (((local_3fc & 0x40) != 0 && (puVar3 < puVar1)))))) {
      local_420 = (undefined8 *)((ulonglong)local_420 & 0xffffffff00000000 | (ulonglong)uVar8);
      pcVar17 = "SXS: %s() Bad flags/size 0x%lx/0x%lx\n";
      local_428 = (uint *)((ulonglong)local_428 & 0xffffffff00000000 | (ulonglong)local_3fc);
      goto LAB_1800317ad;
    }
    if (((local_3fc & 0x40) != 0) && (pvVar21 = _Dst, (local_3fc & 0x88) != 0)) {
LAB_180030fc5:
      iVar9 = -0x3ffffff3;
      pvVar20 = pvVar21;
      goto LAB_180013bb3;
    }
    if (((local_3fc & 0x10) != 0) &&
       (local_3c0 = *(longlong *)(in_GS_OFFSET + 0x60), *(longlong *)(local_3c0 + 0x2f8) != 0)) {
      iVar9 = -0x3feafff2;
      goto LAB_180013bb3;
    }
    auStack1016._0_8_ = *(uint **)(param_1 + 2);
    _local_3fc = ZEXT1216(_local_3fc);
    if ((auStack1016._0_8_ == (uint *)0x0) && (pvVar21 = pvVar20, (local_3fc & 0x84) == 0))
    goto LAB_180030fc5;
    if ((local_3fc & 0x10) == 0) {
      bVar6 = FUN_180014f64();
      if ((int)CONCAT71(extraout_var,bVar6) != 0) {
        goto LAB_180013936;
      }
      local_408 = 0xfffffffffffffffd;
LAB_180013db0:
      iVar9 = 0;
      goto LAB_180013db3;
    }
LAB_180013936:
    if ((local_3fc & 1) != 0) {
      uVar14 = *(ushort *)puVar1;
      if ((uVar14 == 0xffff) || (uVar14 == 9)) {
        _local_3fc = CONCAT212(uVar14,_local_3fc);
        goto LAB_180013950;
      }
      local_428 = (uint *)((ulonglong)local_428 & 0xffffffff00000000 | (ulonglong)uVar14);
      pcVar17 = "SXS: %s() bad wProcessorArchitecture 0x%x\n";
      goto LAB_180031009;
    }
    _local_3fc = CONCAT212(9,_local_3fc);
    _local_3fc = CONCAT124(_auStack1016,local_3fc) | (undefined  [16])0x1;
LAB_180013950:
    if ((local_3fc & 2) != 0) {
      _local_3fc = CONCAT214(*(undefined2 *)((longlong)param_1 + 0x12),_local_3fc);
    }
    if ((local_3fc & 0x80) == 0) {
      hModule = (HMODULE)CONCAT44(local_3cc,uStack976);
    }
    else {
      hModule = *(HMODULE *)(param_1 + 0xc);
      uStack976 = SUB84(hModule,0);
      local_3cc = (undefined4)((ulonglong)hModule >> 0x20);
    }
    if ((local_3fc & 0x20) != 0) {
      puStack984 = *(uint **)(param_1 + 10);
    }
    if ((auStack1016._0_8_ == (uint *)0x0) && ((local_3fc & 0x80) != 0)) {
      local_320._0_8_ = local_2b8;
      _local_310 = CONCAT88(0x100,0x100);
      local_320 = CONCAT88(local_2b8,local_2b8);
      DVar10 = 0x80;
      local_2b8[0] = L'\0';
      _local_330 = CONCAT88(local_2b8,_local_330);
      _local_330 = CONCAT124(auStack812,0x1000000);
      while( true ) {
        DVar10 = GetModuleFileNameW(hModule,local_320._0_8_,DVar10);
        if (DVar10 == 0) break;
        if ((ulonglong)DVar10 < local_310 >> 1) {
          local_330._0_2_ = (short)DVar10 * 2;
          bVar23 = true;
          _local_3fc = CONCAT84(auStack812._4_8_,local_3fc);
          auStack1016._0_8_ = (uint *)auStack812._4_8_;
          goto LAB_180013988;
        }
        uVar16 = (ulonglong)DVar10 * 4 + 2;
        _local_330 = CONCAT142(stack0xfffffffffffffcd2,local_310._0_2_ + -2);
        if (0xfffe < uVar16) goto LAB_18003131e;
        if (local_310 < uVar16) {
          iVar9 = RtlpEnsureBufferSize(0,local_320);
          if (iVar9 < 0) goto LAB_180031328;
        }
        local_330 = CONCAT22(local_310._0_2_,local_330._0_2_);
        hModule = (HMODULE)CONCAT44(local_3cc,uStack976);
        _local_330 = CONCAT88(local_320._0_8_,_local_330);
        DVar10 = local_310._0_4_ >> 1;
      }
      goto LAB_180013db0;
    }
LAB_180013988:
    uVar16 = (ulonglong)local_330._0_2_;
    if ((local_3fc & 4) != 0) {
      puStack1000 = *(uint **)(param_1 + 6);
    }
    if ((local_3fc & 0x40) == 0) {
      if ((local_3fc & 4) == 0) {
        if (bVar23) {
LAB_180013a25:
          local_330._0_2_ = (ushort)uVar16;
          local_358._0_8_ = local_138;
          uVar16 = (uVar16 & 0xffff) + 2;
          local_358 = CONCAT88(local_138,local_358._0_8_);
          _local_368 = CONCAT88(local_138,_local_368);
          uVar18 = 0;
          _local_348 = CONCAT88(0x100,0x100);
          local_138[0] = 0;
          _local_368 = CONCAT124(auStack868,0x1000000);
          if (0xfffe < uVar16) goto LAB_18003131e;
          if (0x100 < uVar16) {
            iVar9 = RtlpEnsureBufferSize(0);
            if (iVar9 < 0) goto LAB_180031328;
            uVar18 = (ulonglong)local_368._0_2_;
          }
          _local_368 = CONCAT88(local_358._0_8_,_local_368);
          RtlMoveMemory((void *)((longlong)local_358._0_8_ + (uVar18 & 0xfffffffffffffffe)),
                        auStack812._4_8_,(ulonglong)local_330._0_2_);
          auVar5 = _local_368;
          pcVar4 = RtlGetLengthWithoutLastFullDosOrNtPathElement_exref;
          local_368._0_2_ = local_368._0_2_ + local_330._0_2_;
          local_368 = CONCAT22(local_368._0_2_ + 2,local_368._0_2_);
          auStack868._4_8_ = SUB168(auVar5,8);
          *(undefined2 *)((longlong)auStack868._4_8_ + (ulonglong)(local_368._0_2_ >> 1) * 2) = 0;
          iVar9 = RtlpApplyLengthFunction(0,0x38,local_368,pcVar4);
          _Dst = pvVar20;
          if (-1 < iVar9) {
            *(short *)((longlong)auStack868._4_8_ + (ulonglong)(local_368._0_2_ >> 1) * 2) = 0;
            _local_3fc = _local_3fc | (undefined  [16])0x4;
            puStack1000 = auStack868._4_8_;
            goto LAB_180013b0e;
          }
        }
        else {
          _local_310 = CONCAT88(0x100,0x100);
          local_320 = CONCAT88(local_2b8,local_2b8);
          local_2b8[0] = L'\0';
          _local_330 = CONCAT88(local_2b8,_local_330);
          _local_330 = CONCAT124(auStack812,0x1000000);
          while( true ) {
            uVar8 = RtlGetFullPathName_U(auStack1016._0_8_);
            uVar16 = (ulonglong)uVar8;
            if (uVar8 == 0) break;
            if (uVar16 <= local_310) {
              _local_3fc = CONCAT84(auStack812._4_8_,local_3fc);
              _local_330 = CONCAT142(stack0xfffffffffffffcd2,(short)uVar8);
              goto LAB_180013a25;
            }
            if (0xfffe < uVar16 + 2) goto LAB_18003131e;
            if (local_310 < uVar16 + 2) {
              iVar9 = RtlpEnsureBufferSize(0);
              if (iVar9 < 0) break;
            }
            _local_330 = CONCAT88(local_320._0_8_,_local_330);
            local_330 = CONCAT22(local_310._0_2_,local_330._0_2_);
          }
LAB_180031328:
          iVar9 = -0x3fffffe9;
        }
        goto LAB_180013db3;
      }
      if ((puStack1000 == (uint *)0x0) || (*(short *)puStack1000 == 0)) {
        pcVar17 = "SXS: %s() Bad lpAssemblyDirectory %ls\n";
        local_428 = puStack1000;
LAB_180031009:
        DbgPrintEx(0x33,0,pcVar17,"CreateActCtxWWorker");
        pvVar20 = _Dst;
      }
      else {
        iVar9 = RtlDetermineDosPathNameType_U();
        if (((iVar9 - 1U & 0xfffffffa) == 0) && (pvVar20 = _Dst, iVar9 != 5)) {
          if (auStack1016._0_8_ == (uint *)0x0) {
            if ((_local_3fc & (undefined  [16])0x20) != (undefined  [16])0x0) {
              if ((puStack984 != (uint *)0x0) && (*(short *)puStack984 != 0)) {
                RtlInitUnicodeString(local_3b0);
                sVar19 = (size_t)local_3b0[0];
                local_2e8._0_8_ = local_1b8;
                _local_2d8 = CONCAT88(0x80,0x80);
                local_2e8 = CONCAT88(local_1b8,local_2e8._0_8_);
                local_1b8[0] = 0;
                _local_2f8 = CONCAT88(local_1b8,local_2f8);
                uVar16 = 0;
                _local_2f8 = CONCAT124(stack0xfffffffffffffd0c,0x800000);
                _local_2f8 = _local_2f8 & (undefined  [16])0xffffffffffff0000;
                if (sVar19 + 2 < 0xffff) {
                  if (0x80 < sVar19 + 2) {
                    iVar9 = RtlpEnsureBufferSize(0);
                    if (iVar9 < 0) goto LAB_180031328;
                    uVar16 = (ulonglong)local_2f8._0_2_;
                    sVar19 = (size_t)local_3b0[0];
                  }
                  _local_2f8 = CONCAT88(local_2e8._0_8_,local_2f8);
                  RtlMoveMemory((void *)((longlong)local_2e8._0_8_ + (uVar16 & 0xfffffffffffffffe)),
                                local_3a8,sVar19);
                  auVar5 = _local_2f8;
                  local_2f8._0_2_ = local_3b0[0] + local_2f8._0_2_;
                  local_2f8._0_4_ = CONCAT22(local_2f8._0_2_ + 2,local_2f8._0_2_);
                  puStack752 = SUB168(auVar5,8);
                  *(undefined2 *)((longlong)puStack752 + (ulonglong)(local_2f8._0_2_ >> 1) * 2) = 0;
                  uVar16 = (ulonglong)(local_2f8._0_2_ + 0x12) + 2;
                  if (uVar16 < 0xffff) {
                    if (local_2d8 < uVar16) {
                      iVar9 = RtlpEnsureBufferSize(0);
                      if (iVar9 < 0) goto LAB_180031328;
                    }
                    _local_2f8 = CONCAT88(local_2e8._0_8_,local_2f8);
                    RtlMoveMemory((void *)((longlong)local_2e8._0_8_ +
                                          ((ulonglong)local_2f8._0_2_ & 0xfffffffffffffffe)),
                                  L".Manifest",0x12);
                    auVar5 = _local_2f8;
                    uVar14 = local_2f8._0_2_ + 0x12;
                    local_2f8._0_4_ = CONCAT22(local_2f8._0_2_ + 0x14,uVar14);
                    puStack752 = SUB168(auVar5,8);
                    *(undefined2 *)((longlong)puStack752 + (ulonglong)(uVar14 >> 1) * 2) = 0;
                    uVar16 = (ulonglong)uVar14;
                    if (uVar16 + 4 < 0xffff) {
                      if (local_2d8 < uVar16 + 4) {
                        iVar9 = RtlpEnsureBufferSize(0);
                        if (iVar9 < 0) goto LAB_180031328;
                        uVar16 = (ulonglong)local_2f8._0_2_;
                      }
                      local_2f8._0_4_ = CONCAT22(local_2d8._0_2_,local_2f8._0_2_);
                      _local_2f8 = CONCAT88(local_2e8._0_8_,local_2f8);
                      *(undefined2 *)((longlong)local_2e8._0_8_ + (uVar16 & 0xfffffffffffffffe)) = 0
                      ;
                      goto LAB_18003134a;
                    }
                  }
                }
                goto LAB_18003131e;
              }
              pcVar17 = "SXS: %s() Bad lpApplication name \'%ls\'\n";
              local_428 = puStack984;
              goto LAB_180031009;
            }
            local_2e8._0_8_ = L"Application.Manifest";
          }
          else {
            uVar8 = RtlDetermineDosPathNameType_U();
            local_2e8._0_8_ = (wchar_t *)auStack1016._0_8_;
            if ((uVar8 - 1 & 0xfffffffa) == 0) {
              if (uVar8 != 5) {
                goto LAB_180013b0e;
              }
            }
            else if (uVar8 != 5) {
              pcVar17 = "SXS: %s() Bad lpSource PathType %ls, 0x%lx\n";
              local_420 = (undefined8 *)
                          ((ulonglong)local_420 & 0xffffffff00000000 | (ulonglong)uVar8);
              local_428 = auStack1016._0_8_;
              goto LAB_1800317ad;
            }
          }
LAB_18003134a:
          uVar16 = 0xffffffffffffffff;
          do {
            uVar18 = uVar16;
            uVar16 = uVar18 + 1;
          } while (*(short *)((longlong)puStack1000 + uVar16 * 2) != 0);
          uVar22 = 0xffffffffffffffff;
          local_418 = *(short *)((longlong)puStack1000 + (uVar18 & 0xffffffff) * 2);
          do {
            uVar22 = uVar22 + 1;
          } while (*(short *)((longlong)local_2e8._0_8_ + uVar22 * 2) != 0);
          bVar23 = local_418 != 0x5c;
          while( true ) {
            puVar11 = (undefined4 *)KernelBaseGetGlobalData();
            _Dst = (void *)RtlAllocateHeap(*(undefined8 *)
                                            (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),*puVar11,
                                           (ulonglong)(bVar23 + 1 + (int)uVar16 + (int)uVar22) * 2);
            local_3a0 = _Dst;
            if (_Dst == (void *)0x0) break;
            sVar19 = (uVar16 & 0xffffffff) * 2;
            memcpy(_Dst,puStack1000,sVar19);
            _Dst_00 = (undefined2 *)((longlong)_Dst + sVar19);
            if (local_418 != 0x5c) {
              *_Dst_00 = 0x5c;
              _Dst_00 = _Dst_00 + 1;
            }
            memcpy(_Dst_00,local_2e8._0_8_,(uVar22 & 0xffffffff) * 2);
            _Dst = local_3a0;
            _Dst_00[uVar22 & 0xffffffff] = 0;
            cVar7 = RtlDoesFileExists_U();
            if ((cVar7 != '\0') || ((uint *)local_2e8._0_8_ != puStack752)) {
              _local_3fc = CONCAT84(_Dst,local_3fc);
              goto LAB_180013b0e;
            }
            local_2e8._0_8_ = L"Application.Manifest";
            uVar22 = 0x14;
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
          }
          iVar9 = -0x3fffffe9;
          goto LAB_180013db3;
        }
      }
      goto LAB_1800317c5;
    }
    if (puStack1000 == (uint *)0x0) {
      local_358 = CONCAT88(local_138,local_138);
      _local_368 = CONCAT88(local_138,_local_368);
      _local_348 = CONCAT88(0x100,0x100);
      local_138[0] = 0;
      _local_368 = CONCAT124(auStack868,0x1000000);
      lVar12 = KernelBaseGetGlobalData();
      if ((uint)*(ushort *)(lVar12 + 8) + (uint)local_368._0_2_ + 2 < 0xffff) {
        lVar12 = KernelBaseGetGlobalData();
        if (local_348 < (ulonglong)((uint)local_368._0_2_ + (uint)*(ushort *)(lVar12 + 8)) + 2) {
          KernelBaseGetGlobalData();
          iVar9 = RtlpEnsureBufferSize(0,local_358);
          if (iVar9 < 0) goto LAB_180031328;
        }
        _local_368 = CONCAT88(local_358._0_8_,_local_368);
        lVar12 = KernelBaseGetGlobalData();
        lVar13 = KernelBaseGetGlobalData();
        RtlMoveMemory((void *)((longlong)auStack868._4_8_ + (ulonglong)(local_368._0_2_ >> 1) * 2),
                      *(void **)(lVar13 + 0x10),(ulonglong)*(ushort *)(lVar12 + 8));
        lVar12 = KernelBaseGetGlobalData();
        local_368 = CONCAT22(*(short *)(lVar12 + 8) + local_368._0_2_ + 2,local_368._0_2_);
        lVar12 = KernelBaseGetGlobalData();
        local_368._0_2_ = local_368._0_2_ + *(short *)(lVar12 + 8);
        *(undefined2 *)((longlong)auStack868._4_8_ + (ulonglong)(local_368._0_2_ >> 1) * 2) = 0;
        uVar16 = (ulonglong)(local_368._0_2_ + 0xe) + 2;
        if (uVar16 < 0xffff) {
          if (local_348 < uVar16) {
            iVar9 = RtlpEnsureBufferSize(0);
            if (iVar9 < 0) goto LAB_180031328;
          }
          _local_368 = CONCAT88(local_358._0_8_,_local_368);
          RtlMoveMemory((void *)((longlong)local_358._0_8_ +
                                ((ulonglong)local_368._0_2_ & 0xfffffffffffffffe)),L"\\WinSxs",0xe);
          auVar5 = _local_368;
          local_368 = CONCAT22(local_368._0_2_ + 0x10,local_368._0_2_ + 0xe);
          auStack868._4_8_ = SUB168(auVar5,8);
          *(short *)((longlong)auStack868._4_8_ +
                    (ulonglong)((ushort)(local_368._0_2_ + 0xe) >> 1) * 2) = 0;
          puStack1000 = auStack868._4_8_;
          _local_3fc = _local_3fc | (undefined  [16])0x4;
          _Dst = pvVar20;
          goto LAB_180013b0e;
        }
      }
LAB_18003131e:
      iVar9 = -0x3ffffefa;
    }
    else {
LAB_180013b0e:
      uVar8 = 0;
      uVar15 = 2;
      pvVar20 = _Dst;
      if ((local_3fc & 8) == 0) {
        uVar8 = 1;
      }
      else {
        if (*(longlong *)(param_1 + 8) == 0) {
          DbgPrintEx(0x33,0,
                     "SXS: %s() ACTCTX_FLAG_RESOURCE_NAME_VALID set but lpResourceName == 0\n",
                     "CreateActCtxWWorker");
          goto LAB_1800317c5;
        }
        local_3b8 = BaseDllMapResourceIdW();
        if (local_3b8 == -1) {
          DbgPrintEx(0x33,0,"SXS: %s() BaseDllMapResourceIdW failed\n","CreateActCtxWWorker");
          iVar9 = *(int *)(*(longlong *)(in_GS_OFFSET + 0x30) + 0x1250);
          goto LAB_180013db3;
        }
        uStack992 = (undefined4)local_3b8;
        uStack988 = (undefined4)((ulonglong)local_3b8 >> 0x20);
      }
      iVar9 = FUN_180013dec(uVar8,(longlong)&local_400,&local_410);
      if (-1 < iVar9) {
        pvVar21 = _Dst;
        if (local_410 == 0) goto LAB_180030fc5;
        if ((_local_3fc & (undefined  [16])0x10) == (undefined  [16])0x0) {
          local_420 = &local_408;
          local_428 = (uint *)0x0;
          iVar9 = RtlCreateActivationContext(0,local_410,0,FUN_18001fb70);
          if (-1 < iVar9) {
LAB_180013bab:
            local_410 = 0;
            iVar9 = 0;
            goto LAB_180013bb3;
          }
          if ((((iVar9 != -0x3feafffe) && (iVar9 != -0x3ffffdfc)) && (2 < iVar9 + 0x3fffff77U)) &&
             (((iVar9 != -0x3fffffcc && (iVar9 != -0x3ffffff1)) && (iVar9 != -0x3feafffc)))) {
            uVar15 = 0;
          }
          DbgPrintEx(0x33,uVar15,"SXS: RtlCreateActivationContext() failed 0x%08lx\n",iVar9);
          local_408 = 0xffffffffffffffff;
        }
        else {
          if (*(longlong *)(local_3c0 + 0x2f8) == 0) {
            LOCK();
            puVar2 = (ulonglong *)(local_3c0 + 0x2f8);
            uVar16 = *puVar2;
            *puVar2 = *puVar2 ^ (ulonglong)(uVar16 == 0) * (*puVar2 ^ local_410);
            if (uVar16 == 0) {
              local_408 = 0;
              goto LAB_180013bab;
            }
          }
          iVar9 = -0x3feafff2;
        }
      }
    }
  }
LAB_180013db3:
  pvVar20 = _Dst;
  if (local_410 != 0) {
    NtUnmapViewOfSection(0xffffffffffffffff);
  }
LAB_180013bb3:
  BaseDllFreeResourceId(local_3b8);
  if (iVar9 < 0) {
    BaseSetLastNTError();
    local_408 = 0xffffffffffffffff;
  }
  if (local_358._0_8_ != (undefined2 *)0x0) {
    if (local_358._0_8_ != local_358._8_8_) {
      local_390 = local_358._0_8_;
      RtlFreeUnicodeString(local_398);
    }
    _local_348 = CONCAT88(uStack832,uStack832);
    local_358 = CONCAT88(local_358._8_8_,local_358._8_8_);
  }
  _local_368 = CONCAT88(local_358._8_8_,_local_368);
  if (local_358._8_8_ != (undefined2 *)0x0) {
    *local_358._8_8_ = 0;
  }
  _local_368 = ZEXT1416(CONCAT122(auStack868,(undefined2)uStack832)) << 0x10;
  if (local_320._0_8_ != (undefined2 *)0x0) {
    if (local_320._0_8_ != local_320._8_8_) {
      local_380 = local_320._0_8_;
      RtlFreeUnicodeString(local_388);
    }
    _local_310 = CONCAT88(uStack776,uStack776);
    local_320 = CONCAT88(local_320._8_8_,local_320._8_8_);
  }
  _local_330 = CONCAT88(local_320._8_8_,_local_330);
  if (local_320._8_8_ != (undefined2 *)0x0) {
    *local_320._8_8_ = 0;
  }
  _local_330 = ZEXT1416(CONCAT122(auStack812,(undefined2)uStack776)) << 0x10;
  if (local_2e8._0_8_ != (undefined2 *)0x0) {
    if (local_2e8._0_8_ != local_2e8._8_8_) {
      local_370 = local_2e8._0_8_;
      RtlFreeUnicodeString(local_378);
    }
    _local_2d8 = CONCAT88(uStack720,uStack720);
    local_2e8 = CONCAT88(local_2e8._8_8_,local_2e8._8_8_);
  }
  _local_2f8 = CONCAT88(local_2e8._8_8_,local_2f8);
  if (local_2e8._8_8_ != (undefined2 *)0x0) {
    *local_2e8._8_8_ = 0;
  }
  _local_2f8 = ZEXT1416(CONCAT122(stack0xfffffffffffffd0c,(undefined2)uStack720)) << 0x10;
  if (pvVar20 != (void *)0x0) {
    _local_3fc = CONCAT84(*(undefined8 *)(param_1 + 2),local_3fc);
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pvVar20);
  }
  __security_check_cookie(local_38 ^ (ulonglong)auStack1096);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180013dec(uint param_1,longlong param_2,undefined8 param_3)

{
  short *psVar1;
  byte bVar2;
  bool bVar3;
  bool bVar4;
  bool bVar5;
  bool bVar6;
  int iVar7;
  uint uVar8;
  int iVar9;
  undefined8 uVar10;
  wchar_t *_Str1;
  longlong lVar11;
  uint **ppuVar12;
  undefined4 uVar13;
  undefined4 uVar15;
  int **ppiVar16;
  char *pcVar17;
  undefined *puVar18;
  longlong *plVar19;
  longlong *plVar20;
  longlong *plVar21;
  longlong *plVar22;
  longlong *plVar23;
  longlong *plVar24;
  longlong in_GS_OFFSET;
  bool bVar25;
  undefined auStackY2360 [32];
  longlong local_898;
  undefined8 uStack2192;
  longlong local_888;
  ulonglong uStack2176;
  uint local_878;
  int local_874;
  int local_870;
  longlong local_868;
  uint local_860;
  ulonglong local_858;
  uint local_850;
  undefined4 uStack2124;
  undefined8 uStack2120;
  undefined8 local_840;
  uint local_838;
  undefined4 uStack2100;
  undefined4 uStack2096;
  undefined4 uStack2092;
  undefined4 local_828 [2];
  undefined8 local_820;
  uint *local_818;
  undefined4 local_810;
  undefined local_808 [16];
  undefined local_7f8 [8];
  undefined8 local_7f0;
  wchar_t *local_7e8;
  undefined2 *local_7e0;
  uint *local_7d8;
  uint *local_7d0;
  int *local_7c8;
  int *local_7c0;
  uint *local_7b8;
  int *local_7b0;
  undefined local_7a8 [8];
  undefined2 *local_7a0;
  undefined local_798 [8];
  undefined2 *local_790;
  undefined local_788 [8];
  undefined2 *local_780;
  undefined local_778 [8];
  undefined2 *local_770;
  undefined local_768 [8];
  undefined2 *local_760;
  undefined local_758 [16];
  undefined local_748 [16];
  undefined local_738 [16];
  undefined local_728 [16];
  undefined local_718 [16];
  int local_708 [2];
  undefined2 *local_700;
  undefined2 *local_6f8;
  undefined2 *local_6f0;
  undefined8 local_6e8;
  undefined8 local_6e0;
  int local_6d0 [2];
  undefined2 *local_6c8;
  undefined2 *local_6c0;
  undefined2 *local_6b8;
  undefined8 local_6b0;
  undefined8 local_6a8;
  uint local_698 [2];
  undefined2 *local_690;
  undefined2 *local_688;
  undefined2 *local_680;
  undefined8 local_678;
  undefined8 local_670;
  int local_660 [2];
  undefined2 *local_658;
  undefined2 *local_650;
  undefined2 *local_648;
  undefined8 local_640;
  undefined8 local_638;
  int local_628;
  undefined4 uStack1572;
  undefined8 uStack1568;
  undefined2 *local_618;
  undefined2 *local_610;
  undefined8 local_608;
  undefined8 local_600;
  undefined4 local_5f0 [2];
  undefined2 *local_5e8;
  undefined2 *local_5e0;
  undefined2 *local_5d8;
  undefined8 local_5d0;
  undefined8 local_5c8;
  uint local_5b8;
  undefined2 local_5b4;
  int local_5b0;
  undefined4 uStack1452;
  undefined4 uStack1448;
  undefined4 uStack1444;
  longlong local_5a0 [7];
  undefined local_568 [8];
  int local_560;
  int iStack1372;
  int iStack1368;
  int iStack1364;
  ushort local_530;
  ushort local_52e;
  longlong local_528;
  undefined local_520 [24];
  undefined8 local_508;
  undefined8 local_500;
  uint local_3b8;
  undefined4 uStack948;
  undefined4 uStack944;
  undefined4 uStack940;
  undefined4 local_3a8;
  undefined4 uStack932;
  undefined8 uStack928;
  undefined4 local_398;
  undefined4 uStack916;
  undefined4 uStack912;
  undefined4 uStack908;
  uint local_388;
  undefined4 uStack900;
  undefined4 uStack896;
  undefined4 uStack892;
  undefined4 local_378;
  undefined4 uStack884;
  undefined4 uStack880;
  undefined4 uStack876;
  undefined4 local_368;
  undefined4 uStack868;
  undefined4 uStack864;
  undefined4 uStack860;
  wchar_t local_358 [8];
  undefined2 local_348 [64];
  undefined2 local_2c8 [64];
  undefined2 local_248 [64];
  undefined2 local_1c8 [64];
  undefined2 local_148 [64];
  undefined2 local_c8 [64];
  ulonglong local_48;
  undefined4 uVar14;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStackY2360;
  plVar19 = (longlong *)0x0;
  local_878 = local_878 & 0xffff0000;
  local_7f0 = 0;
  local_7d8 = &local_838;
  local_840 = 0;
  bVar3 = true;
  local_7d0 = &local_850;
  bVar4 = true;
  local_7c8 = local_708;
  bVar5 = true;
  local_7c0 = local_6d0;
  local_868 = 0;
  local_7b8 = local_698;
  local_870 = 0;
  local_7b0 = local_660;
  local_874 = 0;
  plVar22 = (longlong *)0x0;
  bVar6 = false;
  plVar20 = (longlong *)0x0;
  local_898 = 0;
  uStack2192 = 0;
  local_888 = 0;
  uStack2176 = 0;
  local_728 = ZEXT816(0);
  local_718 = ZEXT816(0);
  local_758 = ZEXT816(0);
  local_748 = ZEXT816(0);
  local_860 = param_1;
  memset(&local_5b8,0,0x1f8);
  local_348[0] = 0;
  local_6f8 = local_348;
  local_6e8 = 0x80;
  local_6f0 = local_348;
  local_700 = local_348;
  local_6c0 = local_c8;
  local_6b8 = local_c8;
  local_6c8 = local_c8;
  local_688 = local_2c8;
  local_680 = local_2c8;
  local_690 = local_2c8;
  local_650 = local_248;
  local_648 = local_248;
  local_658 = local_248;
  local_6e0 = 0x80;
  local_708[0] = 0x800000;
  local_6b0 = 0x80;
  local_6a8 = 0x80;
  local_c8[0] = 0;
  local_6d0[0] = 0x800000;
  local_678 = 0x80;
  local_670 = 0x80;
  local_2c8[0] = 0;
  local_698[0] = 0x800000;
  local_640 = 0x80;
  local_638 = 0x80;
  local_248[0] = 0;
  local_660[0] = 0x800000;
  local_618 = local_1c8;
  local_608 = 0x80;
  uVar13 = 2;
  uVar14 = 2;
  local_610 = local_1c8;
  local_600 = 0x80;
  uStack1568 = local_1c8;
  local_5e0 = local_148;
  local_5d8 = local_148;
  local_5e8 = local_148;
  local_5b4 = *(undefined2 *)(param_2 + 0x10);
  local_1c8[0] = 0;
  local_628 = 0x800000;
  local_5d0 = 0x80;
  local_5c8 = 0x80;
  local_148[0] = 0;
  local_5f0[0] = 0x800000;
  uStack2120 = 0;
  plVar23 = plVar19;
  if ((*(byte *)(param_2 + 4) & 2) == 0) {
LAB_1800140a2:
    uVar10 = FUN_180014c50(0x38,(short *)&local_628);
    plVar21 = plVar19;
    bVar3 = true;
    if (-1 < (int)uVar10) {
      local_508 = 0xffffffffffffffff;
      local_5b0 = local_628;
      uStack1452 = uStack1572;
      uStack1448 = (undefined4)uStack1568;
      uStack1444 = uStack1568._4_4_;
      if (*(ulonglong *)(param_2 + 0x20) < 0x10000) {
        local_508 = *(undefined8 *)(param_2 + 0x20);
      }
      RtlInitUnicodeString();
      plVar21 = plVar20;
      plVar23 = plVar22;
      bVar3 = bVar4;
      if ((local_530 == 0) ||
         (((local_530 & 0xfffe) < (local_52e & 0xfffe) &&
          (*(short *)(local_528 + (ulonglong)(local_530 >> 1) * 2) == 0)))) {
        psVar1 = *(short **)(param_2 + 8);
        if ((psVar1 == (short *)0x0) || (*psVar1 == 0)) {
          DbgPrintEx(0x33,0,"SXS: %s() empty lpSource %ls\n","BasepCreateActCtx");
        }
        else {
          uStack2192 = 0xffffffffffffffff;
          local_500 = param_3;
          if ((*(byte *)(param_2 + 4) & 0x40) == 0) {
            RtlInitUnicodeString(&local_838);
            RtlDetermineDosPathNameType_U(*(undefined8 *)(param_2 + 8));
            iVar7 = RtlDosPathNameToNtPathName_U_WithStatus
                              (CONCAT44(uStack2092,uStack2096),&local_850,0,0);
            plVar21 = plVar19;
            plVar23 = plVar19;
            if (iVar7 < 0) goto LAB_180014604;
            _Str1 = wcsrchr((wchar_t *)CONCAT44(uStack2092,uStack2096),L'.');
            local_7e8 = _Str1;
            if ((*(byte *)(param_2 + 4) & 0x80) == 0) {
              local_820 = 0;
              local_818 = &local_850;
              local_828[0] = 0x30;
              local_810 = 0x40;
              local_808 = ZEXT816(0);
              iVar7 = NtOpenFile(&local_898,0x1200a9,local_828);
              if (iVar7 < 0) {
                plVar21 = plVar20;
                plVar23 = plVar22;
                if (((((iVar7 == -0x3feafffe) || (iVar7 == -0x3ffffdfc)) ||
                     (iVar7 + 0x3fffff77U < 3)) ||
                    ((iVar7 == -0x3fffffcc || (iVar7 == -0x3ffffff1)))) ||
                   (plVar24 = plVar19, iVar7 == -0x3feafffc)) goto LAB_180014604;
LAB_180031954:
                uVar13 = 0;
                pcVar17 = "SXS: %s() NtOpenFile(%wZ) failed\n";
                plVar20 = plVar19;
                plVar22 = plVar24;
              }
              else {
                if ((_Str1 == (wchar_t *)0x0) ||
                   ((iVar9 = _wcsicmp(_Str1,L".dll"), iVar9 != 0 &&
                    (iVar9 = _wcsicmp(_Str1,L".exe"), iVar9 != 0)))) {
LAB_180014a1e:
                  iVar9 = iVar7;
                  bVar25 = false;
LAB_180014970:
                  if (local_888 == 0) {
                    iVar9 = NtCreateSection(&local_888,4,0);
                  }
                  if (iVar9 < 0) {
                    if (iVar9 != -0x3fffffc0) {
                      if ((((iVar9 != -0x3feafffe) && (iVar9 != -0x3ffffdfc)) &&
                          ((2 < iVar9 + 0x3fffff77U &&
                           ((iVar9 != -0x3fffffcc && (iVar9 != -0x3ffffff1)))))) &&
                         (uVar13 = uVar14, iVar9 != -0x3feafffc)) {
                        uVar13 = 0;
                      }
                      pcVar17 = "SXS: %s() NtCreateSection() failed. Status = 0x%x.\n";
                      plVar20 = plVar19;
                      plVar22 = plVar19;
                      goto LAB_180031975;
                    }
                  }
                  else {
                    local_858 = 0;
                    iVar7 = NtMapViewOfSection(local_888,0xffffffffffffffff,&local_858,0);
                    uVar10 = 0;
                    if (-1 < iVar7) {
                      uStack2176 = local_858;
                      if (!bVar25) {
                        uStack2176 = local_858 | 1;
                      }
                      goto LAB_1800141f9;
                    }
                    if (iVar7 != -0x3fffffe9) {
                      if (((((iVar7 != -0x3feafffe) && (iVar7 != -0x3ffffdfc)) &&
                           (2 < iVar7 + 0x3fffff77U)) &&
                          ((iVar7 != -0x3fffffcc && (iVar7 != -0x3ffffff1)))) &&
                         (uVar13 = uVar14, iVar7 != -0x3feafffc)) {
                        uVar13 = 0;
                      }
                      DbgPrintEx(0x33,uVar13,"SXS: %s() NtMapViewOfSection failed\n",
                                 "BasepCreateActCtx");
                      plVar21 = plVar20;
                      plVar23 = plVar22;
                      goto LAB_180014604;
                    }
                    NtClose();
                    local_888 = 0;
                  }
                  uVar10 = 0;
                  goto LAB_1800141f9;
                }
                iVar9 = NtCreateSection(&local_888,4,0);
                iVar7 = 0;
                if (-1 < iVar9) {
                  bVar25 = true;
                  bVar6 = true;
                  goto LAB_180014970;
                }
                if (((iVar9 + 0x3ffffed1U < 3) || (iVar9 == -0x3fffff85)) || (iVar9 == -0x3ffffca6))
                goto LAB_180014a1e;
                if (((iVar9 != -0x3feafffe) && (iVar9 != -0x3ffffdfc)) &&
                   ((2 < iVar9 + 0x3fffff77U &&
                    (((iVar9 != -0x3fffffcc && (iVar9 != -0x3ffffff1)) &&
                     (uVar13 = uVar14, iVar9 != -0x3feafffc)))))) {
                  uVar13 = 0;
                }
                pcVar17 = "SXS: %s() NtCreateSection() failed. Status = 0x%x\n";
              }
              goto LAB_180031975;
            }
            uStack2176 = *(ulonglong *)(param_2 + 0x30);
            local_898 = 0;
            local_888 = 0;
            uVar10 = 1;
            bVar4 = false;
LAB_1800141f9:
            bVar3 = bVar4;
            if (uStack2176 == 0) {
              bVar25 = *(longlong *)(param_2 + 0x20) != 0;
            }
            else {
              iVar7 = RtlImageNtHeaderEx(uVar10,uStack2176 & 0xfffffffffffffffc,local_840,&local_7f0
                                        );
              if (iVar7 < 0) {
                plVar21 = plVar20;
                plVar23 = plVar22;
                bVar5 = bVar4;
                if (iVar7 != -0x3fffff85) goto LAB_180014604;
                bVar25 = false;
              }
              else {
                bVar25 = true;
              }
            }
            bVar5 = false;
            plVar22 = &local_898;
            plVar20 = (longlong *)(-(ulonglong)bVar25 & (ulonglong)&local_898);
            plVar21 = plVar20;
            if (bVar25) {
              plVar23 = (longlong *)local_728;
              plVar22 = (longlong *)local_728;
              if ((*(byte *)(param_2 + 4) & 8) != 0) goto LAB_180014267;
            }
            else {
              plVar23 = plVar22;
              if (*(longlong *)(param_2 + 0x20) == 0) {
LAB_180014267:
                local_3a8 = 0;
                uStack928 = (wchar_t *)0x0;
                local_3b8 = local_838;
                uStack948 = uStack2100;
                uStack944 = uStack2096;
                uStack940 = uStack2092;
                if ((*(byte *)(param_2 + 4) & 8) != 0) {
                  if (*(ulonglong *)(param_2 + 0x20) < 0x10000) {
                    if (*(ulonglong *)(param_2 + 0x20) != 1) {
                      swprintf_s(local_358,8,L".%lu");
                      lVar11 = -1;
                      do {
                        lVar11 = lVar11 + 1;
                      } while (local_358[lVar11] != L'\0');
                      local_3a8 = CONCAT22(0x10,(short)lVar11 * 2);
                      uStack928 = local_358;
                    }
                  }
                  else {
                    RtlInitUnicodeString(&local_3a8);
                  }
                }
                local_398 = 0x10000e;
                uStack916 = 0;
                uStack912 = 0x80086d88;
                uStack908 = 1;
                if ((local_7e8 != (wchar_t *)0x0) &&
                   (iVar7 = _wcsicmp(local_7e8,L".Manifest"), iVar7 == 0)) {
                  local_878 = 0x12;
                  local_3b8 = local_3b8 & 0xffff0000 | (uint)(ushort)((short)local_3b8 - 0x12);
                }
                iVar7 = RtlMultiAppendUnicodeStringBuffer(local_708,3,&local_3b8);
                plVar23 = plVar22;
                if (-1 < iVar7) {
                  uStack948 = uStack2124;
                  uStack944 = (undefined4)uStack2120;
                  uStack940 = uStack2120._4_4_;
                  local_3b8 = local_850 & 0xffff0000 |
                              (uint)(ushort)((short)local_850 - (short)local_878);
                  iVar7 = RtlMultiAppendUnicodeStringBuffer(local_6d0,3,&local_3b8);
                  if (-1 < iVar7) {
                    if (bVar25) {
                      local_388 = local_838;
                      uStack900 = uStack2100;
                      uStack896 = uStack2096;
                      uStack892 = uStack2092;
                      local_378 = local_3a8;
                      uStack884 = uStack932;
                      uStack880 = (undefined4)uStack928;
                      uStack876 = uStack928._4_4_;
                      local_368 = 0x140012;
                      uStack868 = 0;
                      uStack864 = 0x80085bb0;
                      uStack860 = 1;
                      iVar7 = RtlMultiAppendUnicodeStringBuffer(local_698,3,&local_388);
                      if (-1 < iVar7) {
                        local_388 = local_850;
                        uStack900 = uStack2124;
                        uStack896 = (undefined4)uStack2120;
                        uStack892 = uStack2120._4_4_;
                        iVar7 = RtlMultiAppendUnicodeStringBuffer(local_660,3,&local_388);
                        if (-1 < iVar7) {
                          bVar2 = 0;
                          if ((local_860 & 1) == 0) goto LAB_180014441;
                          goto LAB_180014446;
                        }
                      }
                    }
                    else {
LAB_180014441:
                      bVar2 = 1;
LAB_180014446:
                      puVar18 = local_568;
                      plVar19 = (longlong *)local_758;
                      ppiVar16 = &local_7c8;
                      if (*(longlong *)(param_2 + 0x20) != 1) {
                        puVar18 = (undefined *)0x0;
                        plVar19 = (longlong *)0x0;
                        ppiVar16 = (int **)0x0;
                      }
                      ppuVar12 = &local_7d8;
                      if (bVar25) {
                        ppuVar12 = &local_7b8;
                      }
                      plVar19 = FUN_180014ccc(-(ulonglong)bVar2 & (ulonglong)ppuVar12,
                                              -(ulonglong)bVar25 & (ulonglong)&local_7d8,(int *)0x0,
                                              puVar18,0,0,0,
                                              (longlong *)(-(ulonglong)bVar2 & (ulonglong)ppuVar12),
                                              plVar22,(longlong *)
                                                      (-(ulonglong)bVar25 & (ulonglong)&local_7d8),
                                              plVar20,*(longlong *)(param_2 + 0x20),
                                              (longlong *)ppiVar16,plVar19,&local_5b8,local_5a0,
                                              (undefined2 *)puVar18);
                      iVar7 = (int)plVar19;
                      uVar15 = uVar13;
                      if (local_5b8 == 0) {
                        uVar15 = uVar14;
                        if (((2 < iVar7 + 0x3fffff77U) && (iVar7 < 0)) &&
                           ((iVar7 != -0x3ffffdfc && (iVar7 != -0x3feafffe)))) {
LAB_180031b02:
                          uVar15 = uVar13;
                          if (((iVar7 != -0x3fffffcc) && (iVar7 != -0x3ffffff1)) &&
                             (uVar15 = uVar14, iVar7 != -0x3feafffc)) {
                            uVar15 = 0;
                          }
                        }
                      }
                      else {
                        if (((local_5b8 & 2) == 0) &&
                           (uVar10 = FUN_180014e10(iVar7), (int)uVar10 != 0)) {
                          iVar7 = 0;
                        }
                        if (-1 < iVar7) {
                          if (*(longlong *)(param_2 + 0x20) != 1) {
                            local_560 = *local_7c8;
                            iStack1372 = local_7c8[1];
                            iStack1368 = local_7c8[2];
                            iStack1364 = local_7c8[3];
                          }
                          goto LAB_180014539;
                        }
                        if (((iVar7 != -0x3feafffe) && (iVar7 != -0x3ffffdfc)) &&
                           (2 < iVar7 + 0x3fffff77U)) goto LAB_180031b02;
                      }
                      DbgPrintEx(0x33,uVar15,"SXS: %s() BasepSxsCreateStreams() failed\n",
                                 "BasepCreateActCtx");
                    }
                  }
                }
              }
            }
          }
          else {
            local_5b8 = 8;
            RtlInitUnicodeString(local_520,psVar1);
LAB_180014539:
            plVar21 = plVar20;
            plVar23 = plVar22;
            bVar3 = bVar4;
            if ((local_5b8 & 8) == 0) {
              lVar11 = local_898;
              if (local_898 == 0) {
                local_818 = &local_850;
                local_828[0] = 0x30;
                local_820 = 0;
                local_810 = 0x40;
                local_808 = ZEXT816(0);
                iVar7 = NtOpenFile(&local_868,0x120089,local_828,local_738);
                if (iVar7 < 0) {
                  if (((iVar7 != -0x3feafffe) && (iVar7 != -0x3ffffdfc)) &&
                     ((2 < iVar7 + 0x3fffff77U &&
                      (((iVar7 != -0x3fffffcc && (iVar7 != -0x3ffffff1)) &&
                       (plVar19 = plVar20, plVar24 = plVar22, iVar7 != -0x3feafffc))))))
                  goto LAB_180031954;
                  goto LAB_180014604;
                }
                local_870 = 1;
                lVar11 = local_868;
              }
              local_868 = lVar11;
              uVar8 = FUN_18000e1e0(local_868);
              if (uVar8 == 0) {
                local_5b8 = local_5b8 | 0x40;
              }
            }
            if ((*(uint *)(*(longlong *)
                            (*(longlong *)(*(longlong *)(in_GS_OFFSET + 0x30) + 0x60) + 0x20) + 8) &
                0x8000) != 0) {
              local_5b8 = local_5b8 | 0x80;
            }
            iVar7 = FUN_18001c2e4(&local_5b8);
            if (iVar7 < 0) {
              if ((((((iVar7 != -0x3fffffde) && (iVar7 != -0x3feafffe)) && (iVar7 != -0x3ffffdfc))
                   && ((2 < iVar7 + 0x3fffff77U && (iVar7 != -0x3fffffcc)))) &&
                  (uVar13 = uVar14, iVar7 != -0x3ffffff1)) && (iVar7 != -0x3feafffc)) {
                uVar13 = 0;
              }
              pcVar17 = "SXS: %s() Calling csrss server failed. Status = 0x%x\n";
LAB_180031975:
              DbgPrintEx(0x33,uVar13,pcVar17,"BasepCreateActCtx");
              plVar21 = plVar20;
              plVar23 = plVar22;
              bVar3 = bVar4;
            }
          }
        }
      }
      else {
        DbgPrintEx(0x33,0,"SXS: %s() AssemblyDirectory is not null terminated\n","BasepCreateActCtx"
                  );
      }
    }
LAB_180014604:
    if (local_874 != 0) {
      RtlSetThreadPreferredUILanguages(8,local_5e8,local_7f8);
    }
    plVar19 = plVar21;
    if (!bVar3) goto LAB_180014618;
  }
  else {
    uVar10 = FUN_180014c50(0x48,(short *)local_5f0);
    if (-1 < (int)uVar10) {
      SetThreadUILanguage(*(LANGID *)(param_2 + 0x12));
      local_874 = 1;
      goto LAB_1800140a2;
    }
  }
  if ((!bVar6) && (uStack2176 != 0)) {
    uStack2176 = uStack2176 & 0xfffffffffffffffc;
  }
LAB_180014618:
  if (bVar5) {
    FUN_180014c04(&local_898);
  }
  if (plVar23 != (longlong *)0x0) {
    FUN_180014c04(plVar23);
  }
  if ((plVar19 != (longlong *)0x0) && (bVar3)) {
    FUN_180014c04(plVar19);
  }
  FUN_180014c04((longlong *)local_758);
  if ((local_870 != 0) && (local_868 != 0)) {
    NtClose();
  }
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,uStack2120);
  if (local_6f8 != (undefined2 *)0x0) {
    if (local_6f8 != local_6f0) {
      local_7e0 = local_6f8;
      RtlFreeUnicodeString(&local_7e8);
    }
    local_6e8 = local_6e0;
    local_6f8 = local_6f0;
  }
  if (local_6f0 != (undefined2 *)0x0) {
    *local_6f0 = 0;
  }
  local_708[0] = (uint)(ushort)local_6e0 << 0x10;
  local_700 = local_6f0;
  if (local_6c0 != (undefined2 *)0x0) {
    if (local_6c0 != local_6b8) {
      local_7a0 = local_6c0;
      RtlFreeUnicodeString(local_7a8);
    }
    local_6b0 = local_6a8;
    local_6c0 = local_6b8;
  }
  if (local_6b8 != (undefined2 *)0x0) {
    *local_6b8 = 0;
  }
  local_6d0[0] = (uint)(ushort)local_6a8 << 0x10;
  local_6c8 = local_6b8;
  if (local_688 != (undefined2 *)0x0) {
    if (local_688 != local_680) {
      local_790 = local_688;
      RtlFreeUnicodeString(local_798);
    }
    local_678 = local_670;
    local_688 = local_680;
  }
  if (local_680 != (undefined2 *)0x0) {
    *local_680 = 0;
  }
  local_698[0] = (uint)(ushort)local_670 << 0x10;
  local_690 = local_680;
  if (local_650 != (undefined2 *)0x0) {
    if (local_650 != local_648) {
      local_780 = local_650;
      RtlFreeUnicodeString(local_788);
    }
    local_640 = local_638;
    local_650 = local_648;
  }
  if (local_648 != (undefined2 *)0x0) {
    *local_648 = 0;
  }
  local_660[0] = (uint)(ushort)local_638 << 0x10;
  local_658 = local_648;
  if (local_618 != (undefined2 *)0x0) {
    if (local_618 != local_610) {
      local_770 = local_618;
      RtlFreeUnicodeString(local_778);
    }
    local_608 = local_600;
    local_618 = local_610;
  }
  if (local_610 != (undefined2 *)0x0) {
    *local_610 = 0;
  }
  local_628 = (uint)(ushort)local_600 << 0x10;
  uStack1568 = local_610;
  if ((local_5e0 != (undefined2 *)0x0) && (local_5e0 != local_5d8)) {
    local_760 = local_5e0;
    RtlFreeUnicodeString(local_768);
  }
  if (local_5d8 != (undefined2 *)0x0) {
    *local_5d8 = 0;
  }
  __security_check_cookie(local_48 ^ (ulonglong)auStackY2360);
  return;
}



void BasepReleaseSxsCreateProcessUtilityStruct(longlong *param_1)

{
  longlong in_GS_OFFSET;
  
                    // 0x14b90  101  BasepReleaseSxsCreateProcessUtilityStruct
  FUN_180014c04(param_1);
  FUN_180014c04(param_1 + 4);
  if (param_1[8] != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
  }
  if (param_1[9] != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
  }
  if (param_1[10] == 0) {
    return;
  }
                    // WARNING: Could not recover jumptable at 0x000180014bef. Too many branches
                    // WARNING: Treating indirect jump as call
  NtClose();
  return;
}



void FUN_180014c04(longlong *param_1)

{
  if (*param_1 != 0) {
    NtClose();
  }
  if (param_1[2] != 0) {
    NtClose();
  }
  if (param_1[3] == 0) {
    return;
  }
                    // WARNING: Could not recover jumptable at 0x0001800247c8. Too many branches
                    // WARNING: Treating indirect jump as call
  NtUnmapViewOfSection(0xffffffffffffffff);
  return;
}



undefined8 FUN_180014c50(ulonglong param_1,short *param_2)

{
  undefined8 *puVar1;
  int iVar2;
  undefined8 uVar3;
  ulonglong uVar4;
  uint local_res10 [2];
  undefined4 local_res18 [2];
  
  local_res18[0] = 0;
  local_res10[0] = (uint)((ushort)param_2[1] >> 1);
  uVar3 = RtlGetThreadPreferredUILanguages
                    (param_1,local_res18,*(undefined8 *)(param_2 + 4),local_res10);
  uVar4 = (ulonglong)local_res10[0];
  if ((int)uVar3 != -0x3fffffdd) {
    if ((int)uVar3 < 0) {
      return uVar3;
    }
    if (local_res10[0] <= (ushort)param_2[1] >> 1) goto LAB_180014cad;
  }
  uVar4 = uVar4 * 2 + 2;
  if (0xfffe < uVar4) {
    return 0xc0000106;
  }
  puVar1 = (undefined8 *)(param_2 + 8);
  if (((puVar1 == (undefined8 *)0x0) ||
      (*(ulonglong *)(param_2 + 0x10) <= uVar4 && uVar4 != *(ulonglong *)(param_2 + 0x10))) &&
     (iVar2 = RtlpEnsureBufferSize(0,puVar1), iVar2 < 0)) {
    return 0xc0000017;
  }
  *(undefined8 *)(param_2 + 4) = *puVar1;
  param_2[1] = param_2[0x10];
  uVar3 = RtlGetThreadPreferredUILanguages(param_1 & 0xffffffff,local_res18,*puVar1,local_res10);
  if ((int)uVar3 < 0) {
    return uVar3;
  }
  uVar4 = (ulonglong)local_res10[0];
LAB_180014cad:
  *param_2 = (short)uVar4 * 2;
  return uVar3;
}



longlong *
FUN_180014ccc(undefined8 param_1,undefined8 param_2,int *param_3,undefined8 param_4,int param_5,
             undefined8 param_6,uint param_7,longlong *param_8,longlong *param_9,longlong *param_10,
             longlong *param_11,longlong param_12,longlong *param_13,longlong *param_14,
             uint *param_15,longlong *param_16,undefined2 *param_17)

{
  bool bVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  uint uVar7;
  undefined8 uVar8;
  longlong *plVar9;
  longlong *plVar10;
  int local_res10;
  
  bVar1 = true;
  uVar7 = 0;
  local_res10 = 0;
  if (param_3 == (int *)0x0) {
    plVar9 = (longlong *)&local_res10;
    uVar6 = FUN_18000e714((int *)plVar9);
    plVar10 = (longlong *)(ulonglong)uVar6;
    if ((int)uVar6 < 0) {
      return plVar10;
    }
    if (local_res10 == 0) {
      if (param_10 != (longlong *)0x0) {
        if (param_11[3] == 0) {
          uVar7 = FUN_18006ace8(param_10,param_12,param_11,(undefined2 *)param_16);
        }
        else {
          uVar7 = FUN_180014e50(param_10,param_11,param_12,param_5,param_6,param_7,
                                (undefined2 *)param_16);
        }
        plVar10 = (longlong *)(ulonglong)uVar7;
        plVar9 = param_10;
        if (-1 < (int)uVar7) goto LAB_180014d6e;
        param_10 = plVar10;
        uVar8 = FUN_180015214(uVar7);
        if ((int)uVar8 == 0) {
          return plVar10;
        }
      }
      if (param_8 == (longlong *)0x0) {
        return plVar10;
      }
      uVar6 = FUN_1800150e0(param_10,param_8,param_9,(undefined2 *)param_16);
      plVar9 = param_10;
      if ((int)uVar6 < 0) {
        uVar8 = FUN_180014e10(uVar6);
        if ((int)uVar8 == 0) {
          return (longlong *)(ulonglong)uVar6;
        }
        if (uVar7 == 0) {
          return (longlong *)(ulonglong)uVar6;
        }
        return (longlong *)(ulonglong)uVar7;
      }
    }
    else {
      if (param_8 != (longlong *)0x0) {
        uVar7 = FUN_1800150e0(plVar9,param_8,param_9,(undefined2 *)param_16);
        plVar10 = (longlong *)(ulonglong)uVar7;
        if (-1 < (int)uVar7) goto LAB_180014d6e;
        uVar8 = FUN_180014e10(uVar7);
        if ((int)uVar8 == 0) {
          return plVar10;
        }
      }
      if (param_10 == (longlong *)0x0) {
        return plVar10;
      }
      if (param_11[3] == 0) {
        uVar7 = FUN_18006ace8(param_10,param_12,param_11,(undefined2 *)param_16);
      }
      else {
        uVar7 = FUN_180014e50(param_10,param_11,param_12,param_5,param_6,param_7,
                              (undefined2 *)param_16);
      }
      plVar9 = param_10;
      if ((int)uVar7 < 0) {
        return (longlong *)(ulonglong)uVar7;
      }
    }
  }
  else {
    *(undefined2 *)param_16 = 0x301;
    iVar2 = *param_3;
    iVar3 = param_3[1];
    iVar4 = param_3[2];
    iVar5 = param_3[3];
    param_16[3] = 0;
    param_16[4] = 0;
    *(int *)(param_16 + 1) = iVar2;
    *(int *)((longlong)param_16 + 0xc) = iVar3;
    *(int *)(param_16 + 2) = iVar4;
    *(int *)((longlong)param_16 + 0x14) = iVar5;
    *(undefined *)((longlong)param_16 + 2) = 2;
    bVar1 = false;
    param_16[5] = *(longlong *)(param_3 + 4);
    param_16[6] = *(longlong *)(param_3 + 6);
    plVar9 = param_16;
  }
LAB_180014d6e:
  *param_15 = *param_15 | 1;
  if ((bVar1) && (param_13 != (longlong *)0x0)) {
    uVar7 = FUN_1800150e0(plVar9,param_13,param_14,param_17);
    if ((int)uVar7 < 0) {
      return (longlong *)(ulonglong)uVar7;
    }
    *param_15 = *param_15 | 2;
  }
  return (longlong *)0x0;
}



undefined8 FUN_180014e10(int param_1)

{
  int iVar1;
  undefined8 uVar2;
  
  if ((param_1 < 0) &&
     ((((param_1 + 0x3ffffff1U < 0x2c &&
        ((0x82000000001U >> ((ulonglong)(param_1 + 0x3ffffff1U) & 0x3f) & 1) != 0)) ||
       (iVar1 = RtlNtStatusToDosErrorNoTeb(), iVar1 == 0x35)) ||
      ((iVar1 - 2U < 2 || (iVar1 == 0x43)))))) {
    uVar2 = 1;
  }
  else {
    uVar2 = 0;
  }
  return uVar2;
}



void FUN_180014e50(longlong *param_1,undefined8 *param_2,longlong param_3,int param_4,
                  undefined8 param_5,uint param_6,undefined2 *param_7)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  int iVar6;
  ulonglong uVar7;
  undefined auStack120 [32];
  undefined8 *local_58;
  ulonglong *local_50;
  undefined8 local_48;
  undefined8 local_40;
  undefined8 local_38;
  ulonglong local_30;
  undefined8 local_28;
  longlong local_20;
  undefined8 local_18;
  ulonglong local_10;
  
  local_10 = DAT_1800b2220 ^ (ulonglong)auStack120;
  local_20 = 0;
  local_18 = 0;
  local_38 = 0;
  local_30 = 0;
  local_28 = 0x18;
  if (param_2[3] != 0) {
    if ((param_4 == 0) || (param_3 != 1)) {
      local_40 = 0;
      local_50 = &local_30;
      local_48 = 0;
      local_58 = &local_38;
      local_20 = param_3;
      iVar6 = LdrResSearchResource(param_2[3],&local_28,3,0x130);
      if (iVar6 < 0) goto LAB_180014f34;
      *(undefined8 *)(param_7 + 0x14) = local_38;
      *(ulonglong *)(param_7 + 0x18) = local_30;
      uVar7 = local_30;
    }
    else {
      uVar7 = (ulonglong)param_6;
      if (param_6 == 0) goto LAB_180014f34;
      *(undefined8 *)(param_7 + 0x14) = param_5;
      *(ulonglong *)(param_7 + 0x18) = uVar7;
    }
    if (uVar7 < 0x800001) {
      *(undefined8 *)(param_7 + 0x10) = param_2[1];
      *(undefined8 *)(param_7 + 0xc) = *param_2;
      *param_7 = 0x101;
      puVar1 = (undefined4 *)*param_1;
      uVar2 = *puVar1;
      uVar3 = puVar1[1];
      uVar4 = puVar1[2];
      uVar5 = puVar1[3];
      *(undefined *)(param_7 + 1) = 1;
      *(undefined4 *)(param_7 + 4) = uVar2;
      *(undefined4 *)(param_7 + 6) = uVar3;
      *(undefined4 *)(param_7 + 8) = uVar4;
      *(undefined4 *)(param_7 + 10) = uVar5;
    }
  }
LAB_180014f34:
  __security_check_cookie(local_10 ^ (ulonglong)auStack120);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

bool FUN_180014f64(void)

{
  InitOnceExecuteOnce((PINIT_ONCE)&DAT_1800b2d10,FUN_18001c8b0,(PVOID)0x0,(LPVOID *)0x0);
  return _DAT_1800b2be8 == 0x50000;
}



// WARNING: Could not reconcile some variable overlaps
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

ulonglong FUN_180014fb0(HMODULE param_1,undefined8 param_2,HANDLE *param_3)

{
  ulonglong uVar1;
  HANDLE pvVar2;
  longlong in_GS_OFFSET;
  undefined8 local_res18;
  undefined local_48 [4];
  undefined local_44 [16];
  undefined local_34 [12];
  undefined4 uStack40;
  undefined4 uStack36;
  LPCWSTR pWStack32;
  undefined8 uStack24;
  
  local_48 = 0x38;
  local_res18 = 0;
  uStack24._4_4_ = 0;
  local_44 = ZEXT816(0);
  local_34 = SUB1612(ZEXT816(0),0);
  uStack40 = 0;
  uStack36 = 0;
  pWStack32 = SUB168(ZEXT816(0) >> 0x20,0);
  uStack24._0_4_ = 0;
  if (param_3 == (HANDLE *)0x0) {
    uVar1 = 0xc000000d;
  }
  else {
    *param_3 = (HANDLE)0x0;
    InitOnceExecuteOnce((PINIT_ONCE)&DAT_1800b2d10,FUN_18001c8b0,(PVOID)0x0,(LPVOID *)0x0);
    if ((_DAT_1800b2be8 == 0x50000) &&
       (((*(byte *)(*(longlong *)(in_GS_OFFSET + 0x60) + 3) & 2) == 0 ||
        ((*(byte *)(*(longlong *)(in_GS_OFFSET + 0x60) + 3) & 0x40) != 0)))) {
      uVar1 = LdrResFindResourceDirectory(param_1,0x18,2,&local_res18,0,0,0x10);
      if (-1 < (int)uVar1) {
        uStack40 = 2;
        uStack36 = 0;
        uStack24 = param_1;
        pvVar2 = CreateActCtxW((PCACTCTXW)local_48);
        if (pvVar2 == (HANDLE)0xffffffffffffffff) {
          uVar1 = (ulonglong)*(uint *)(*(longlong *)(in_GS_OFFSET + 0x30) + 0x1250);
        }
        else {
          *param_3 = pvVar2;
          uVar1 = 0;
        }
      }
    }
    else {
      uVar1 = 0xc00000bb;
    }
  }
  return uVar1;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_1800150e0(undefined8 param_1,longlong *param_2,longlong *param_3,undefined2 *param_4)

{
  longlong *plVar1;
  undefined4 *puVar2;
  longlong lVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  int iVar8;
  uint uVar9;
  char *pcVar10;
  undefined auStack200 [32];
  undefined8 local_a8;
  int local_a0;
  longlong local_98;
  undefined4 local_88 [2];
  undefined8 local_80;
  ulonglong local_78;
  undefined4 local_70;
  undefined local_68 [16];
  undefined local_58 [16];
  undefined local_48 [8];
  longlong local_40;
  ulonglong local_30;
  
  local_30 = DAT_1800b2220 ^ (ulonglong)auStack200;
  if (*param_3 == 0) {
    local_78 = param_2[1];
    local_80 = 0;
    local_a0 = 0x60;
    local_88[0] = 0x30;
    local_68 = ZEXT816(0);
    local_70 = 0x40;
    local_a8 = CONCAT44(local_a8._4_4_,5);
    iVar8 = NtOpenFile(param_3,0x1200a9,local_88,local_58);
    if (iVar8 < 0) {
      if ((((iVar8 != -0x3fffffcc) && (2 < iVar8 + 0x3fffff77U)) && (iVar8 != -0x3ffffdfc)) &&
         ((iVar8 != -0x3ffffff1 && (iVar8 != -0x3feafffe)))) {
        local_a8 = local_78;
        local_a0 = iVar8;
        DbgPrintEx(0x33,0,"SXS: %s() NtOpenFile(%wZ) failed. Status = 0x%x\n",
                   "BasepSxsCreateFileStream");
      }
      goto LAB_180015171;
    }
  }
  local_a8 = CONCAT44(local_a8._4_4_,5);
  uVar9 = NtQueryInformationFile(*param_3,local_58,local_48,0x18);
  if ((int)uVar9 < 0) {
    pcVar10 = "SXS: %s() NtQueryInformationFile failed. Status = 0x%x\n";
LAB_180031f37:
    local_a8 = local_a8 & 0xffffffff00000000 | (ulonglong)uVar9;
    DbgPrintEx(0x33,0,pcVar10,"BasepSxsCreateFileStream");
  }
  else {
    if (0x800000 < local_40) goto LAB_180015171;
    plVar1 = param_3 + 2;
    if (*plVar1 == 0) {
      local_98 = *param_3;
      local_a0 = 0x8000000;
      local_a8 = CONCAT44(local_a8._4_4_,2);
      uVar9 = NtCreateSection(plVar1,4,0);
      if ((int)uVar9 < 0) {
        pcVar10 = "SXS: %s() NtCreateSection() failed. Status = 0x%x\n";
        goto LAB_180031f37;
      }
    }
    *(longlong *)(param_4 + 0xc) = *param_3;
    *param_4 = 0x101;
    puVar2 = (undefined4 *)*param_2;
    uVar4 = *puVar2;
    uVar5 = puVar2[1];
    uVar6 = puVar2[2];
    uVar7 = puVar2[3];
    *(undefined *)(param_4 + 1) = 3;
    *(undefined4 *)(param_4 + 4) = uVar4;
    *(undefined4 *)(param_4 + 6) = uVar5;
    *(undefined4 *)(param_4 + 8) = uVar6;
    *(undefined4 *)(param_4 + 10) = uVar7;
    lVar3 = *plVar1;
    *(undefined8 *)(param_4 + 0x14) = 0;
    *(longlong *)(param_4 + 0x10) = lVar3;
    *(longlong *)(param_4 + 0x18) = local_40;
  }
LAB_180015171:
  __security_check_cookie(local_30 ^ (ulonglong)auStack200);
  return;
}



undefined8 FUN_180015214(int param_1)

{
  if ((param_1 < 0) && ((param_1 + 0x3fffff77U < 3 || (param_1 == -0x3ffffdfc)))) {
    return 1;
  }
  return 0;
}



// WARNING: Removing unreachable block (ram,0x000180012e46)
// WARNING: Removing unreachable block (ram,0x000180012ed0)
// WARNING: Removing unreachable block (ram,0x000180012f38)
// WARNING: Removing unreachable block (ram,0x000180012ed5)

ATOM FindAtomA(LPCSTR lpString)

{
  int iVar1;
  undefined8 uVar2;
  undefined8 in_R9;
  ushort auStackX24 [4];
  ulonglong uStackX32;
  undefined *puVar3;
  undefined auStack72 [8];
  undefined8 uStack64;
  undefined auStack56 [24];
  
  if (lpString < (LPCSTR)0x10000) {
    auStackX24[0] = (ushort)lpString;
    if (auStackX24[0] < 0xc000) {
      return auStackX24[0];
    }
  }
  else {
    RtlInitAnsiString(auStack56,lpString);
    puVar3 = auStack72;
    iVar1 = RtlAnsiStringToUnicodeString(auStack72,auStack56,1);
    if (-1 < iVar1) {
      auStackX24[0] = 0;
      uVar2 = FUN_180013114(&uStackX32);
      if (((int)uVar2 < 0) ||
         (iVar1 = RtlLookupAtomInAtomTable(uStackX32,uStack64,auStackX24,in_R9,iVar1,puVar3),
         iVar1 < 0)) {
        BaseSetLastNTError();
        auStackX24[0] = 0;
      }
      RtlFreeUnicodeString(auStack72);
      return auStackX24[0];
    }
  }
  BaseSetLastNTError();
  return 0;
}



DWORD GetPrivateProfileStringA
                (LPCSTR lpAppName,LPCSTR lpKeyName,LPCSTR lpDefault,LPSTR lpReturnedString,
                DWORD nSize,LPCSTR lpFileName)

{
  DWORD DVar1;
  int iVar2;
  uint uVar3;
  BOOL BVar4;
  ulonglong uVar5;
  BYTE *pBVar6;
  ulonglong _SizeInBytes;
  DWORD DVar7;
  ulonglong _MaxCount;
  char *_Src;
  
                    // 0x15260  693  GetPrivateProfileStringA
  DVar1 = nSize;
  _SizeInBytes = (ulonglong)nSize;
  _Src = "";
  if (lpDefault != (LPCSTR)0x0) {
    _Src = lpDefault;
  }
  iVar2 = BaseDllReadWriteIniFile
                    ('\0','\0','\0',(LPCWSTR)lpFileName,(short *)lpAppName,(short *)lpKeyName,
                     (short *)lpReturnedString,(int *)&nSize);
  if (iVar2 < 0) {
    if (iVar2 == -0x7ffffffb) {
      if ((lpAppName == (LPCSTR)0x0) || (lpKeyName == (LPCSTR)0x0)) {
        if (1 < DVar1) {
          uVar3 = DVar1 - 2;
          lpReturnedString[DVar1 - 1] = '\0';
          lpReturnedString[uVar3] = '\0';
          if (uVar3 != 0) {
            pBVar6 = (BYTE *)(lpReturnedString + ((ulonglong)uVar3 - 1));
            for (; lpReturnedString <= pBVar6;
                lpReturnedString = (LPSTR)((BYTE *)lpReturnedString + (ulonglong)(BVar4 != 0) + 1))
            {
              BVar4 = IsDBCSLeadByte(*lpReturnedString);
            }
            if ((longlong)lpReturnedString - (longlong)pBVar6 == 2) {
              *pBVar6 = '\0';
            }
          }
          BaseSetLastNTError();
          return uVar3;
        }
      }
      else if (DVar1 != 0) {
        uVar3 = DVar1 - 1;
        DVar7 = uVar3;
        goto LAB_180015314;
      }
      uVar3 = 0;
      DVar7 = 0;
    }
    else {
      uVar5 = 0xffffffffffffffff;
      do {
        uVar5 = uVar5 + 1;
      } while (_Src[uVar5] != '\0');
      uVar3 = (uint)uVar5;
      _MaxCount = uVar5 & 0xffffffff;
      while ((DVar7 = (DWORD)uVar5, uVar3 != 0 && (uVar3 = DVar7 - 1, _Src[uVar3] == ' '))) {
        _MaxCount = (ulonglong)uVar3;
        uVar5 = (ulonglong)uVar3;
      }
      if (DVar1 == 0) {
        BaseSetLastNTError();
        return 0;
      }
      if (DVar1 <= (uint)_MaxCount) {
        DVar7 = DVar1 - 1;
        _MaxCount = (ulonglong)DVar7;
      }
      uVar3 = (uint)_MaxCount;
      strncpy_s(lpReturnedString,_SizeInBytes,_Src,_MaxCount);
    }
  }
  else {
    RtlSetLastWin32Error(0);
    uVar3 = nSize - 1;
    DVar7 = uVar3;
  }
LAB_180015314:
  if (DVar1 <= uVar3) {
    if (DVar1 == 0) goto LAB_18001531e;
    uVar3 = DVar1 - 1;
  }
  lpReturnedString[uVar3] = '\0';
LAB_18001531e:
  if (iVar2 < 0) {
    BaseSetLastNTError();
  }
  else {
    RtlSetLastWin32Error(0);
  }
  return DVar7;
}



UINT GetPrivateProfileIntA(LPCSTR lpAppName,LPCSTR lpKeyName,INT nDefault,LPCSTR lpFileName)

{
  DWORD DVar1;
  UINT extraout_EAX;
  int iVar2;
  undefined auStackY344 [32];
  undefined4 local_128 [4];
  CHAR local_118 [256];
  ulonglong local_18;
  
                    // 0x15370  687  GetPrivateProfileIntA
  local_18 = DAT_1800b2220 ^ (ulonglong)auStackY344;
  local_128[0] = 0;
  DVar1 = GetPrivateProfileStringA(lpAppName,lpKeyName,(LPCSTR)0x0,local_118,0x100,lpFileName);
  if (DVar1 != 0) {
    iVar2 = RtlCharToInteger(local_118,0,local_128);
    if (iVar2 < 0) {
      BaseSetLastNTError();
    }
    else {
      RtlSetLastWin32Error(0);
    }
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStackY344);
  return extraout_EAX;
}



UINT GetProfileIntA(LPCSTR lpAppName,LPCSTR lpKeyName,INT nDefault)

{
  UINT UVar1;
  
                    // 0x153e0  719  GetProfileIntA
  UVar1 = GetPrivateProfileIntA(lpAppName,lpKeyName,nDefault,(LPCSTR)0x0);
  return UVar1;
}



void GetFirmwareEnvironmentVariableExW
               (longlong param_1,longlong param_2,undefined8 param_3,undefined4 param_4,
               undefined8 param_5)

{
  int iVar1;
  undefined auStack152 [32];
  undefined8 local_78;
  undefined4 local_68 [2];
  undefined local_60 [16];
  undefined local_50 [16];
  undefined local_40 [16];
  ulonglong local_30;
  
                    // 0x153f0  606  GetFirmwareEnvironmentVariableExW
  local_30 = DAT_1800b2220 ^ (ulonglong)auStack152;
  if ((param_1 == 0) || (param_2 == 0)) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    RtlInitUnicodeString(local_50,param_1);
    RtlInitUnicodeString(local_60,param_2);
    iVar1 = RtlGUIDFromString(local_60,local_40);
    if (-1 < iVar1) {
      local_78 = param_5;
      local_68[0] = param_4;
      iVar1 = NtQuerySystemEnvironmentValueEx(local_50,local_40,param_3,local_68);
      if (-1 < iVar1) goto LAB_1800154a1;
    }
    BaseSetLastNTError();
  }
LAB_1800154a1:
  __security_check_cookie(local_30 ^ (ulonglong)auStack152);
  return;
}



BOOL RegisterWaitForSingleObject
               (PHANDLE phNewWaitObject,HANDLE hObject,WAITORTIMERCALLBACK Callback,PVOID Context,
               ULONG dwMilliseconds,ULONG dwFlags)

{
  int iVar1;
  longlong in_GS_OFFSET;
  
                    // 0x154d0  1200  RegisterWaitForSingleObject
  *phNewWaitObject = (HANDLE)0x0;
  iVar1 = (int)hObject;
  if (iVar1 == -0xc) {
    hObject = *(HANDLE *)(*(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x20) + 0x30);
  }
  else if (iVar1 == -0xb) {
    hObject = *(HANDLE *)(*(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x20) + 0x28);
  }
  else if (iVar1 == -10) {
    hObject = *(HANDLE *)(*(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x20) + 0x20);
  }
  iVar1 = RtlRegisterWait(phNewWaitObject,hObject,Callback,Context,dwMilliseconds,dwFlags);
  if (iVar1 < 0) {
    BaseSetLastNTError();
  }
  return (uint)(iVar1 >= 0);
}



LPVOID TlsGetValue(DWORD dwTlsIndex)

{
  LPVOID pvVar1;
  longlong in_GS_OFFSET;
  
                    // 0x15540  1459  TlsGetValue
  if (dwTlsIndex < 0x40) {
    pvVar1 = *(LPVOID *)(in_GS_OFFSET + (ulonglong)dwTlsIndex * 8 + 0x1480);
    if (*(int *)(in_GS_OFFSET + 0x68) == 0) {
      return pvVar1;
    }
  }
  else {
    if (0x43f < dwTlsIndex) {
      BaseSetLastNTError();
      return (LPVOID)0x0;
    }
    pvVar1 = *(LPVOID *)(in_GS_OFFSET + 0x1780);
    if (pvVar1 != (LPVOID)0x0) {
      pvVar1 = *(LPVOID *)((longlong)pvVar1 + (ulonglong)dwTlsIndex * 8 + -0x200);
    }
    if (*(int *)(in_GS_OFFSET + 0x68) == 0) {
      return pvVar1;
    }
  }
  *(undefined4 *)(in_GS_OFFSET + 0x68) = 0;
  return pvVar1;
}



DWORD GetCurrentThreadId(void)

{
  longlong in_GS_OFFSET;
  
                    // 0x15550  550  GetCurrentThreadId
  return *(DWORD *)(*(longlong *)(in_GS_OFFSET + 0x30) + 0x48);
}



BOOL HeapFree(HANDLE hHeap,DWORD dwFlags,LPVOID lpMem)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180015570. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x15570  854  HeapFree
  BVar1 = HeapFree(hHeap,dwFlags,lpMem);
  return BVar1;
}



BOOL DeviceIoControl(HANDLE hDevice,DWORD dwIoControlCode,LPVOID lpInBuffer,DWORD nInBufferSize,
                    LPVOID lpOutBuffer,DWORD nOutBufferSize,LPDWORD lpBytesReturned,
                    LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  int iVar2;
  longlong in_GS_OFFSET;
  int local_res10 [2];
  
                    // 0x15590  293  DeviceIoControl
  if ((((dwIoControlCode == 0x2d4808) || (dwIoControlCode == 0x74808)) ||
      (dwIoControlCode == 0x90020)) &&
     (iVar2 = RtlGetActiveConsoleId(), *(int *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x2c0) != iVar2
     )) {
    iVar2 = FUN_180017900(local_res10);
    if (iVar2 < 0) {
      BaseSetLastNTError();
      return 0;
    }
    if ((local_res10[0] != 0) && (iVar2 = FUN_1800675e8(), iVar2 == 0)) {
      BaseSetLastNTError();
      return 0;
    }
  }
  BVar1 = DeviceIoControl(hDevice,dwIoControlCode,lpInBuffer,nInBufferSize,lpOutBuffer,
                          nOutBufferSize,lpBytesReturned,lpOverlapped);
  return BVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

DWORD GetTickCount(void)

{
                    // 0x15640  786  GetTickCount
  return (DWORD)((ulonglong)_DAT_7ffe0004 * _DAT_7ffe0320 >> 0x18);
}



int FUN_180015660(longlong param_1,uint param_2,short *param_3,int param_4,longlong param_5,
                 int param_6)

{
  uint uVar1;
  int iVar2;
  longlong lVar3;
  ulonglong uVar4;
  longlong lVar5;
  DWORD dwErrCode;
  short *psVar6;
  
  if ((((param_4 != 0) && (-1 < param_6)) && (param_3 != (short *)0x0)) &&
     ((param_6 == 0 || (param_5 != 0)))) {
    if (param_4 < 0) {
      uVar4 = FUN_180002600(param_3);
      param_4 = (int)uVar4 + 1;
    }
    if (param_1 != 0) {
      uVar1 = param_2 & 0xfeffffff;
      if (uVar1 == 0x100) {
        if ((param_2 >> 0x18 & 1) == 0) {
          lVar3 = *(longlong *)(param_1 + 0x128);
        }
        else {
          lVar3 = *(longlong *)(param_1 + 0x118);
        }
        psVar6 = (short *)&DAT_180085c40;
LAB_1800156dc:
        iVar2 = FUN_180015740((longlong)param_3,param_4,param_5,param_6,lVar3,psVar6);
        return iVar2;
      }
      if (uVar1 == 0x200) {
        if ((param_2 >> 0x18 & 1) == 0) {
          lVar3 = *(longlong *)(param_1 + 0x120);
        }
        else {
          lVar3 = *(longlong *)(param_1 + 0x110);
        }
        psVar6 = (short *)&DAT_180085c50;
        goto LAB_1800156dc;
      }
      if (uVar1 == 0x300) {
        if ((param_2 & 0x1000000) == 0) {
          lVar3 = *(longlong *)(param_1 + 0x128);
          lVar5 = *(longlong *)(param_1 + 0x120);
        }
        else {
          lVar3 = *(longlong *)(param_1 + 0x118);
          lVar5 = *(longlong *)(param_1 + 0x110);
        }
        iVar2 = FUN_180055960((longlong)param_3,param_4,param_5,param_6,lVar5,lVar3);
        return iVar2;
      }
      dwErrCode = 0x3ec;
      goto LAB_1800321f2;
    }
  }
  dwErrCode = 0x57;
LAB_1800321f2:
  SetLastError(dwErrCode);
  return 0;
}



int FUN_180015740(longlong param_1,int param_2,longlong param_3,int param_4,longlong param_5,
                 short *param_6)

{
  ushort uVar1;
  int iVar2;
  int local_res20 [2];
  
  if (param_4 == 0) {
    return param_2;
  }
  if (param_4 < param_2) {
    SetLastError(0x7a);
    iVar2 = 0;
  }
  else {
    iVar2 = 0;
    local_res20[0] = 0;
    if (0 < param_2) {
      do {
        uVar1 = *(ushort *)((longlong)local_res20[0] * 2 + param_1);
        if (uVar1 == 0xd801) {
          FUN_180055ca4(param_6,param_1,param_2,local_res20,param_3);
        }
        else {
          *(ushort *)((longlong)local_res20[0] * 2 + param_3) =
               *(short *)(param_5 +
                         ((ulonglong)
                          *(ushort *)
                           (param_5 +
                           (ulonglong)
                           ((uint)*(ushort *)(param_5 + (ulonglong)(uVar1 >> 8) * 2) +
                           (uint)(byte)((byte)uVar1 >> 4)) * 2) + (ulonglong)((byte)uVar1 & 0xf)) *
                         2) + uVar1;
        }
        iVar2 = local_res20[0] + 1;
        local_res20[0] = iVar2;
      } while (iVar2 < param_2);
    }
  }
  return iVar2;
}



int MultiByteToWideChar(UINT CodePage,DWORD dwFlags,LPCSTR lpMultiByteStr,int cbMultiByte,
                       LPWSTR lpWideCharStr,int cchWideChar)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180015810. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x15810  1015  MultiByteToWideChar
  iVar1 = MultiByteToWideChar(CodePage,dwFlags,lpMultiByteStr,cbMultiByte,lpWideCharStr,cchWideChar)
  ;
  return iVar1;
}



int FindNLSStringEx(LPCWSTR lpLocaleName,DWORD dwFindNLSStringFlags,LPCWSTR lpStringSource,
                   int cchSource,LPCWSTR lpStringValue,int cchValue,LPINT pcchFound,
                   LPNLSVERSIONINFO lpVersionInformation,LPVOID lpReserved,LPARAM lParam)

{
  int iVar1;
  
                    // 0x15830  402  FindNLSStringEx
  iVar1 = FindNLSStringEx(lpLocaleName,dwFindNLSStringFlags,lpStringSource,cchSource,lpStringValue,
                          cchValue,pcchFound,lpVersionInformation,lpReserved,lParam);
  return iVar1;
}



HANDLE GetCurrentThread(void)

{
                    // 0x158a0  549  GetCurrentThread
  return (HANDLE)0xfffffffffffffffe;
}



BOOL GlobalUnlock(HGLOBAL hMem)

{
  short sVar1;
  char cVar2;
  short sVar3;
  undefined8 uVar4;
  BOOL BVar5;
  undefined8 in_R8;
  undefined8 in_R9;
  undefined4 uVar6;
  
                    // 0x158b0  844  GlobalUnlock
  BVar5 = 1;
  uVar6 = 1;
  if (((ulonglong)hMem & 8) == 0) {
    return 1;
  }
  RtlLockHeap(DAT_1800b2a30);
  cVar2 = RtlIsValidHandle(DAT_1800b2a20,(longlong)hMem + -8,in_R8,in_R9,uVar6);
  if (cVar2 == '\0') {
    RtlSetLastWin32Error(6);
  }
  else {
    sVar1 = *(short *)((longlong)hMem + -6);
    sVar3 = sVar1 + -1;
    *(short *)((longlong)hMem + -6) = sVar3;
    if (sVar1 == 0) {
      *(undefined2 *)((longlong)hMem + -6) = 0;
      uVar4 = 0x9e;
    }
    else {
      if (sVar3 != 0) goto LAB_18001594f;
      uVar4 = 0;
    }
    RtlSetLastWin32Error(uVar4);
    BVar5 = 0;
  }
LAB_18001594f:
  RtlUnlockHeap(DAT_1800b2a30);
  return BVar5;
}



LPVOID GlobalLock(HGLOBAL hMem)

{
  short sVar1;
  LPVOID pvVar2;
  char cVar3;
  BOOL BVar4;
  HGLOBAL local_res8;
  
                    // 0x15990  837  GlobalLock
  if (((ulonglong)hMem & 8) == 0) {
    if (DAT_1800b2a28 == (HGLOBAL)0x0) {
      NtQuerySystemInformation(0x32,&local_res8);
      DAT_1800b2a28 = local_res8;
    }
    if ((DAT_1800b2a28 <= hMem) || (BVar4 = IsBadReadPtr(hMem,1), BVar4 != 0)) {
      RtlSetLastWin32Error(6);
      hMem = (LPVOID)0x0;
    }
  }
  else {
    RtlLockHeap(DAT_1800b2a30);
    cVar3 = RtlIsValidHandle(DAT_1800b2a20,(longlong)hMem + -8);
    if (cVar3 == '\0') {
      RtlSetLastWin32Error(6);
      pvVar2 = (LPVOID)0x0;
    }
    else {
                    // WARNING: Load size is inaccurate
      pvVar2 = *hMem;
      if (pvVar2 == (LPVOID)0x0) {
        RtlSetLastWin32Error(0x9d);
      }
      else {
        sVar1 = *(short *)((longlong)hMem + -6);
        *(short *)((longlong)hMem + -6) = sVar1 + 1;
        if (sVar1 == 0xff) {
          *(undefined2 *)((longlong)hMem + -6) = 0xff;
        }
      }
    }
    hMem = pvVar2;
    RtlUnlockHeap(DAT_1800b2a30);
  }
  return hMem;
}



BOOL IsBadReadPtr(void *lp,UINT_PTR ucb)

{
  void *pvVar1;
  ulonglong uVar2;
  
                    // 0x15aa0  893  IsBadReadPtr
  if (ucb != 0) {
    if ((lp == (void *)0x0) || (pvVar1 = (void *)((ucb - 1) + (longlong)lp), pvVar1 < lp)) {
      return 1;
    }
    for (uVar2 = (longlong)(int)-DAT_1800b2a48 & (ulonglong)lp;
        uVar2 != ((ulonglong)pvVar1 & (longlong)(int)-DAT_1800b2a48); uVar2 = uVar2 + DAT_1800b2a48)
    {
    }
  }
  return 0;
}



int WideCharToMultiByte(UINT CodePage,DWORD dwFlags,LPCWSTR lpWideCharStr,int cchWideChar,
                       LPSTR lpMultiByteStr,int cbMultiByte,LPCSTR lpDefaultChar,
                       LPBOOL lpUsedDefaultChar)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180015b30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x15b30  1554  WideCharToMultiByte
  iVar1 = WideCharToMultiByte(CodePage,dwFlags,lpWideCharStr,cchWideChar,lpMultiByteStr,cbMultiByte,
                              lpDefaultChar,lpUsedDefaultChar);
  return iVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

HGLOBAL GlobalFree(HGLOBAL hMem)

{
  int iVar1;
  HGLOBAL pvVar2;
  
                    // 0x15b50  833  GlobalFree
  if ((DAT_1800b2dc0 != 0) && (iVar1 = (*(code *)DAT_1800b2dc0)(), iVar1 == 0)) {
    return (HGLOBAL)0x0;
  }
  pvVar2 = GlobalFree(hMem);
  return pvVar2;
}



BOOL TlsSetValue(DWORD dwTlsIndex,LPVOID lpTlsValue)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180015b90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x15b90  1460  TlsSetValue
  BVar1 = TlsSetValue(dwTlsIndex,lpTlsValue);
  return BVar1;
}



HANDLE GetProcessHeap(void)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180015bb0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x15bb0  703  GetProcessHeap
  pvVar1 = GetProcessHeap();
  return pvVar1;
}



UINT GetWriteWatch(DWORD dwFlags,PVOID lpBaseAddress,SIZE_T dwRegionSize,PVOID *lpAddresses,
                  ULONG_PTR *lpdwCount,PULONG lpdwGranularity)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180015bd0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x15bd0  820  GetWriteWatch
  UVar1 = GetWriteWatch(dwFlags,lpBaseAddress,dwRegionSize,lpAddresses,lpdwCount,lpdwGranularity);
  return UVar1;
}



DWORD GetLastError(void)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180015bf0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x15bf0  619  GetLastError
  DVar1 = GetLastError();
  return DVar1;
}



BOOL QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180015c10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x15c10  1107  QueryPerformanceCounter
  BVar1 = QueryPerformanceCounter(lpPerformanceCount);
  return BVar1;
}



BOOL GetThreadTimes(HANDLE hThread,LPFILETIME lpCreationTime,LPFILETIME lpExitTime,
                   LPFILETIME lpKernelTime,LPFILETIME lpUserTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180015c30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x15c30  784  GetThreadTimes
  BVar1 = GetThreadTimes(hThread,lpCreationTime,lpExitTime,lpKernelTime,lpUserTime);
  return BVar1;
}



int CompareStringEx(LPCWSTR lpLocaleName,DWORD dwCmpFlags,LPCWSTR lpString1,int cchCount1,
                   LPCWSTR lpString2,int cchCount2,LPNLSVERSIONINFO lpVersionInformation,
                   LPVOID lpReserved,LPARAM lParam)

{
  int iVar1;
  
                    // 0x15c50  157  CompareStringEx
  iVar1 = CompareStringEx(lpLocaleName,dwCmpFlags,lpString1,cchCount1,lpString2,cchCount2,
                          lpVersionInformation,lpReserved,lParam);
  return iVar1;
}



void SetLastError(void)

{
                    // WARNING: Could not recover jumptable at 0x000180015cb0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x15cb0  1346  SetLastError
  RtlSetLastWin32Error();
  return;
}



int LCMapStringEx(LPCWSTR lpLocaleName,DWORD dwMapFlags,LPCWSTR lpSrcStr,int cchSrc,LPWSTR lpDestStr
                 ,int cchDest,LPNLSVERSIONINFO lpVersionInformation,LPVOID lpReserved,LPARAM lParam)

{
  int iVar1;
  
                    // 0x15cd0  952  LCMapStringEx
  iVar1 = LCMapStringEx(lpLocaleName,dwMapFlags,lpSrcStr,cchSrc,lpDestStr,cchDest,
                        lpVersionInformation,lpReserved,lParam);
  return iVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

ULONGLONG GetTickCount64(void)

{
                    // 0x15d30  787  GetTickCount64
  return SUB168(ZEXT816((ulonglong)(_DAT_7ffe0320 << 8)) * (ZEXT416(_DAT_7ffe0004) << 0x20) >> 0x40,
                0);
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint QuirkIsEnabled3Worker(wchar_t *param_1,uint param_2)

{
  int iVar1;
  wchar_t *pwVar2;
  longlong lVar3;
  HANDLE pvVar4;
  byte bVar5;
  ulonglong uVar6;
  uint uVar7;
  longlong in_GS_OFFSET;
  
                    // 0x15d60  1122  QuirkIsEnabled3Worker
  uVar7 = 0;
  lVar3 = *(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x2d8);
  if ((param_1 != (wchar_t *)0x0) &&
     ((param_2 != 0xffffffff || ((lVar3 != 0 && ((*(uint *)(lVar3 + 0x2d8) & 0x400) != 0)))))) {
    pwVar2 = param_1;
    if ((DAT_1800b2d98 == 0) && (iVar1 = FUN_1800093c4(), iVar1 < 0)) {
      return 0;
    }
    pwVar2 = FUN_1800702fc(pwVar2,param_1);
    uVar7 = 0;
    if (pwVar2 != (wchar_t *)0x0) {
      if (param_2 == 0xffffffff) {
        uVar6 = 0xffffffffffffffff;
      }
      else {
        uVar6 = ((((ulonglong)param_2 & 0xff000000) << 8 | (ulonglong)(param_2 & 0xff0000)) << 8 |
                (ulonglong)(param_2 & 0xff00)) << 8 | (ulonglong)param_2 & 0xff;
      }
      lVar3 = FUN_18001f5dc(*(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x2d8));
      if (lVar3 == 0) {
        bVar5 = 0;
      }
      else {
        bVar5 = (byte)*(undefined4 *)(lVar3 + 0x20);
      }
      uVar7 = 1;
      if ((*(ulonglong *)(pwVar2 + 0x86) & 1 << (bVar5 & 0x3f) & 0xffffffffU) == 0) {
        uVar7 = 0;
      }
      else {
        if (DAT_1800b230c == -1) {
          if ((*(uint *)(pwVar2 + 0x114) & 1) == 0) {
            if ((*(uint *)(pwVar2 + 0x114) & 2) == 0) {
              uVar7 = (uint)(uVar6 < *(ulonglong *)(pwVar2 + 0x82));
            }
            else {
              uVar7 = 0;
            }
          }
        }
        else {
          uVar7 = (uint)(DAT_1800b230c != 0);
        }
        if ((uVar7 != 0) && (((byte)*(uint *)(pwVar2 + 0x114) & 0xc) == 4)) {
          *(uint *)(pwVar2 + 0x114) = *(uint *)(pwVar2 + 0x114) | 8;
        }
      }
      if (_DAT_1800b2cec != 0) {
        pvVar4 = GetCurrentProcess();
        FUN_18000bd38((longlong)pwVar2,uVar7,pvVar4,(undefined2 *)0x0,(undefined2 *)0x0);
      }
    }
  }
  return uVar7;
}



BOOL GetQueuedCompletionStatus
               (HANDLE CompletionPort,LPDWORD lpNumberOfBytesTransferred,PULONG_PTR lpCompletionKey,
               LPOVERLAPPED *lpOverlapped,DWORD dwMilliseconds)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180015dd0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x15dd0  725  GetQueuedCompletionStatus
  BVar1 = GetQueuedCompletionStatus
                    (CompletionPort,lpNumberOfBytesTransferred,lpCompletionKey,lpOverlapped,
                     dwMilliseconds);
  return BVar1;
}



int CompareStringOrdinal
              (LPCWSTR lpString1,int cchCount1,LPCWSTR lpString2,int cchCount2,BOOL bIgnoreCase)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180015df0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x15df0  158  CompareStringOrdinal
  iVar1 = CompareStringOrdinal(lpString1,cchCount1,lpString2,cchCount2,bIgnoreCase);
  return iVar1;
}



// WARNING: Could not reconcile some variable overlaps

longlong BasepGetAppCompatData
                   (wchar_t *param_1,short *param_2,uint *param_3,longlong param_4,short *param_5,
                   ulonglong *param_6,longlong param_7,undefined2 param_8,ulonglong param_9,
                   undefined4 param_10,longlong *param_11,int *param_12,longlong *param_13,
                   undefined4 *param_14)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  int iVar5;
  DWORD DVar6;
  wchar_t *pwVar7;
  ulonglong uVar8;
  longlong lVar9;
  undefined8 uVar10;
  undefined4 *puVar11;
  undefined4 *puVar12;
  uint uVar13;
  undefined4 uVar14;
  longlong in_GS_OFFSET;
  undefined4 local_res18 [4];
  uint local_98 [2];
  longlong local_90;
  int *local_88;
  undefined local_80 [16];
  undefined local_70 [16];
  ulonglong local_60;
  undefined4 local_58;
  undefined4 local_54;
  longlong local_50;
  undefined2 local_48;
  undefined2 local_46;
  undefined2 local_44;
  undefined2 local_42;
  short *local_40;
  longlong lVar15;
  
                    // 0x15e10  88  BasepGetAppCompatData
  local_res18[0] = 0x11c0;
  local_54 = 0;
  uVar14 = 1;
  lVar15 = 1;
  local_88 = (int *)0x0;
  uVar13 = *param_3 >> 2 & 1;
  local_98[0] = 0;
  local_80 = ZEXT816(0);
  local_70 = ZEXT816(0);
  iVar5 = RtlGetCurrentServiceSessionId();
  if (((iVar5 != 0) && (iVar5 = FUN_18007d40c(local_98), -1 < iVar5)) && (local_98[0] != 0)) {
    uVar13 = uVar13 | 4;
  }
  local_90 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,
                             local_res18[0]);
  if (local_90 != 0) {
    *(undefined4 *)(local_90 + 0x208) = local_res18[0];
    *(undefined4 *)(local_90 + 0x20c) = 0xac0dedab;
    *(undefined2 *)(local_90 + 0x214) = param_8;
    *(undefined4 *)(local_90 + 0x1144) = *(undefined4 *)(param_7 + 0x38);
    *(undefined4 *)(local_90 + 0x1148) = *(undefined4 *)(param_7 + 0x3c);
    if ((param_2 == (short *)0x0) || (*param_2 == 0)) {
      uVar14 = 0;
    }
    *(undefined4 *)(local_90 + 0x1150) = uVar14;
    *(uint *)(local_90 + 0x1154) = (uint)(*param_5 != 0);
    *(uint *)(local_90 + 0x1158) = (uint)(*(int *)(param_4 + 4) != 0);
    *(uint *)(local_90 + 0x115c) = (uint)(uVar13 != 0);
    *(undefined4 *)(local_90 + 0x1160) = *(undefined4 *)(param_4 + 4);
    DVar6 = GetCurrentProcessId();
    *(DWORD *)(local_90 + 0xb38) = DVar6;
    lVar9 = *(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x20);
    if ((lVar9 != 0) && (pwVar7 = *(wchar_t **)(lVar9 + 0x68), pwVar7 != (wchar_t *)0x0)) {
      wcsncpy_s((wchar_t *)(local_90 + 0xb3c),0x104,pwVar7,0xffffffffffffffff);
    }
    if (((undefined4 *)*param_11 != (undefined4 *)0x0) && (*param_12 == 0x1c8)) {
      lVar9 = 3;
      puVar3 = (undefined4 *)*param_11;
      puVar4 = (undefined4 *)(local_90 + 0x218);
      do {
        puVar12 = puVar4;
        puVar11 = puVar3;
        uVar14 = puVar11[1];
        uVar1 = puVar11[2];
        uVar2 = puVar11[3];
        *puVar12 = *puVar11;
        puVar12[1] = uVar14;
        puVar12[2] = uVar1;
        puVar12[3] = uVar2;
        uVar14 = puVar11[5];
        uVar1 = puVar11[6];
        uVar2 = puVar11[7];
        puVar12[4] = puVar11[4];
        puVar12[5] = uVar14;
        puVar12[6] = uVar1;
        puVar12[7] = uVar2;
        uVar14 = puVar11[9];
        uVar1 = puVar11[10];
        uVar2 = puVar11[0xb];
        puVar12[8] = puVar11[8];
        puVar12[9] = uVar14;
        puVar12[10] = uVar1;
        puVar12[0xb] = uVar2;
        uVar14 = puVar11[0xd];
        uVar1 = puVar11[0xe];
        uVar2 = puVar11[0xf];
        puVar12[0xc] = puVar11[0xc];
        puVar12[0xd] = uVar14;
        puVar12[0xe] = uVar1;
        puVar12[0xf] = uVar2;
        uVar14 = puVar11[0x11];
        uVar1 = puVar11[0x12];
        uVar2 = puVar11[0x13];
        puVar12[0x10] = puVar11[0x10];
        puVar12[0x11] = uVar14;
        puVar12[0x12] = uVar1;
        puVar12[0x13] = uVar2;
        uVar14 = puVar11[0x15];
        uVar1 = puVar11[0x16];
        uVar2 = puVar11[0x17];
        puVar12[0x14] = puVar11[0x14];
        puVar12[0x15] = uVar14;
        puVar12[0x16] = uVar1;
        puVar12[0x17] = uVar2;
        uVar14 = puVar11[0x19];
        uVar1 = puVar11[0x1a];
        uVar2 = puVar11[0x1b];
        puVar12[0x18] = puVar11[0x18];
        puVar12[0x19] = uVar14;
        puVar12[0x1a] = uVar1;
        puVar12[0x1b] = uVar2;
        uVar14 = puVar11[0x1d];
        uVar1 = puVar11[0x1e];
        uVar2 = puVar11[0x1f];
        puVar12[0x1c] = puVar11[0x1c];
        puVar12[0x1d] = uVar14;
        puVar12[0x1e] = uVar1;
        puVar12[0x1f] = uVar2;
        lVar9 = lVar9 + -1;
        puVar3 = puVar11 + 0x20;
        puVar4 = puVar12 + 0x20;
      } while (lVar9 != 0);
      uVar14 = puVar11[0x21];
      uVar1 = puVar11[0x22];
      uVar2 = puVar11[0x23];
      puVar12[0x20] = puVar11[0x20];
      puVar12[0x21] = uVar14;
      puVar12[0x22] = uVar1;
      puVar12[0x23] = uVar2;
      uVar14 = puVar11[0x25];
      uVar1 = puVar11[0x26];
      uVar2 = puVar11[0x27];
      puVar12[0x24] = puVar11[0x24];
      puVar12[0x25] = uVar14;
      puVar12[0x26] = uVar1;
      puVar12[0x27] = uVar2;
      uVar14 = puVar11[0x29];
      uVar1 = puVar11[0x2a];
      uVar2 = puVar11[0x2b];
      puVar12[0x28] = puVar11[0x28];
      puVar12[0x29] = uVar14;
      puVar12[0x2a] = uVar1;
      puVar12[0x2b] = uVar2;
      uVar14 = puVar11[0x2d];
      uVar1 = puVar11[0x2e];
      uVar2 = puVar11[0x2f];
      puVar12[0x2c] = puVar11[0x2c];
      puVar12[0x2d] = uVar14;
      puVar12[0x2e] = uVar1;
      puVar12[0x2f] = uVar2;
      *(undefined8 *)(puVar12 + 0x30) = *(undefined8 *)(puVar11 + 0x30);
    }
    pwVar7 = wcsrchr(param_1,L'\\');
    if (pwVar7 != (wchar_t *)0x0) {
      param_1 = pwVar7 + 1;
    }
    iVar5 = _wcsicmp(param_1,L"wwahost.exe");
    if ((((iVar5 == 0) || (iVar5 = _wcsicmp(param_1,L"microsoftedge.exe"), iVar5 == 0)) ||
        (iVar5 = _wcsicmp(param_1,L"microsoftedgecp.exe"), iVar5 == 0)) ||
       ((iVar5 = _wcsicmp(param_1,L"microsoftedgebchost.exe"), iVar5 == 0 ||
        (iVar5 = _wcsicmp(param_1,L"microsoftedgedevtools.exe"), iVar5 == 0)))) {
      uVar13 = uVar13 | 2;
    }
    local_50 = local_90;
    local_48 = *(undefined2 *)(param_7 + 0x26);
    local_46 = *(undefined2 *)(param_7 + 0x24);
    local_44 = *(undefined2 *)(param_7 + 0x28);
    local_42 = *(undefined2 *)(param_7 + 0x2a);
    local_40 = param_5;
    local_60 = param_9;
    if (*param_6 != 0) {
      local_60 = *param_6;
    }
    local_58 = param_10;
    if (*param_11 != 0) {
      iVar5 = FUN_180016834();
      if (iVar5 < 0) goto LAB_1800323f9;
      uVar10 = RtlDecodeSystemPointer(DAT_1800b2d68);
      local_80 = CONCAT88(local_80._8_8_,uVar10);
      uVar10 = RtlDecodeSystemPointer(DAT_1800b2d70);
      local_80 = CONCAT88(uVar10,local_80._0_8_);
      uVar10 = RtlDecodeSystemPointer(DAT_1800b2d78);
      local_70 = CONCAT88(local_70._8_8_,uVar10);
      uVar10 = RtlDecodeSystemPointer(DAT_1800b2d80);
      local_70 = CONCAT88(uVar10,local_70._0_8_);
    }
    iVar5 = FUN_180016288(&local_60,(undefined **)local_80);
    lVar9 = local_90;
    if (((-1 < iVar5) &&
        (uVar8 = FUN_1800166c0((longlong *)(local_90 + 0x810),&local_88), (int)uVar8 != 0)) &&
       (((*(uint *)(lVar9 + 0x114c) = (uint)(*local_88 == 4), uVar13 == 0 && (*param_11 == 0)) ||
        (uVar10 = BaseGenerateAppCompatData
                            ((char)param_8,(char)uVar13,(char)param_11,(char)param_12,&local_90,
                             local_res18), -1 < (int)uVar10)))) goto LAB_180016100;
  }
LAB_1800323f9:
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_90);
  local_90 = 0;
  lVar15 = 0;
  local_res18[0] = 0;
LAB_180016100:
  *param_13 = local_90;
  *param_14 = local_res18[0];
  return lVar15;
}



void FUN_180016288(ulonglong *param_1,undefined **param_2)

{
  ushort *puVar1;
  undefined4 uVar2;
  int iVar3;
  ushort uVar4;
  ushort uVar5;
  bool bVar6;
  bool bVar7;
  undefined auStackY376 [32];
  undefined local_138 [4];
  uint local_134;
  uint local_130;
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStackY376;
  memset(local_138,0,0x11c);
  if ((param_1 == (ulonglong *)0x0) || (param_1[2] == 0)) goto LAB_180016359;
  RtlGetDeviceFamilyInfoEnum();
  uVar2 = 0;
  if (*(int *)(param_1 + 1) != 0) {
    uVar2 = *(undefined4 *)(param_1 + 1);
  }
  if (*param_1 == 0) {
    iVar3 = RtlGetVersion();
    if (iVar3 < 0) goto LAB_180016359;
    uVar5 = *(ushort *)(param_1 + 3);
    if ((uVar5 != local_134) || (*(ushort *)((longlong)param_1 + 0x1a) != local_130)) {
      puVar1 = (ushort *)param_1[4];
      if (*puVar1 != 0) {
        uVar5 = *puVar1;
        uVar4 = puVar1[1];
        iVar3 = 3;
        goto LAB_18001633f;
      }
      bVar6 = uVar5 < *(ushort *)((longlong)param_1 + 0x1c);
      bVar7 = uVar5 == *(ushort *)((longlong)param_1 + 0x1c);
      if (bVar6 || bVar7) {
        uVar5 = *(ushort *)((longlong)param_1 + 0x1c);
      }
      local_134 = (uint)uVar5;
      if (bVar6) {
        local_130 = (uint)*(ushort *)((longlong)param_1 + 0x1e);
      }
      else {
        uVar5 = *(ushort *)((longlong)param_1 + 0x1a);
        if ((bVar7) &&
           (uVar5 < *(ushort *)((longlong)param_1 + 0x1e) ||
            uVar5 == *(ushort *)((longlong)param_1 + 0x1e))) {
          uVar5 = *(ushort *)((longlong)param_1 + 0x1e);
        }
        local_130 = (uint)uVar5;
      }
    }
    uVar4 = (ushort)local_130;
    uVar5 = (ushort)local_134;
    iVar3 = 1;
  }
  else {
    uVar5 = *(ushort *)((longlong)param_1 + 6);
    iVar3 = 2;
    uVar4 = *(ushort *)((longlong)param_1 + 4);
  }
LAB_18001633f:
  FUN_1800163dc(param_1,uVar5,uVar4,uVar2,iVar3,param_2);
LAB_180016359:
  __security_check_cookie(local_18 ^ (ulonglong)auStackY376);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Could not reconcile some variable overlaps

void FUN_1800163dc(ulonglong *param_1,ushort param_2,ushort param_3,undefined4 param_4,int param_5,
                  undefined **param_6)

{
  ulonglong uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  int iVar10;
  undefined4 *puVar11;
  ulonglong *puVar12;
  ulonglong uVar13;
  undefined4 *puVar14;
  longlong lVar15;
  undefined8 uVar16;
  ulonglong *puVar17;
  longlong lVar18;
  undefined auStack1432 [32];
  undefined *local_578;
  undefined4 local_570;
  undefined8 local_568;
  undefined4 uStack1376;
  undefined4 uStack1372;
  undefined8 local_558;
  ulonglong local_548;
  undefined4 uStack1344;
  undefined8 local_538;
  undefined4 uStack1328;
  undefined4 uStack1324;
  undefined4 uStack1320;
  undefined4 uStack1316;
  undefined auStack1312 [16];
  int local_510;
  undefined local_208 [464];
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack1432;
  local_570 = param_4;
  memset(&local_548,0,0x340);
  lVar15 = 0;
  memset(local_208,0,0x1c8);
  uVar1 = param_1[2];
  if (uVar1 == 0) goto LAB_1800165e2;
  local_578 = &DAT_18007f260;
  FUN_180016638(param_2,param_3,&local_578);
  if (*(int *)(uVar1 + 0x1150) != 0) {
    local_538 = 0x60002;
  }
  uStack1328 = *(undefined4 *)(local_578 + 4);
  uStack1324 = *(undefined4 *)(local_578 + 8);
  uStack1320 = *(undefined4 *)(local_578 + 0xc);
  uStack1316 = *(undefined4 *)(local_578 + 0x10);
  local_510 = param_5;
  if ((*(uint *)(uVar1 + 0x2d8) & 0x80) == 0) {
LAB_1800164cc:
    iVar10 = local_510;
    local_578 = (undefined *)0x0;
    auStack1312 = CONCAT412(uStack1316,CONCAT48(uStack1320,CONCAT44(uStack1324,uStack1328)));
    uVar13 = FUN_1800166c0((longlong *)&uStack1328,&local_578);
    if (((int)uVar13 != 0) && (local_578 != (undefined *)0x0)) {
      local_548 = (ulonglong)
                  CONCAT22(*(undefined2 *)(local_578 + 0x14),*(undefined2 *)(local_578 + 0x16)) <<
                  0x20;
      if ((iVar10 == 2) && (local_548 = 0xa00004a640000, *param_1 < 0xa00004a640000)) {
        local_548 = *param_1;
      }
      local_568 = 1;
      uStack1344 = local_570;
      uStack1372 = FUN_18001671c();
      uStack1376 = 1;
      local_558 = 0;
      lVar18 = 6;
      *(undefined4 *)(uVar1 + 0x7e0) = (undefined4)local_568;
      *(undefined4 *)(uVar1 + 0x7e4) = local_568._4_4_;
      *(undefined4 *)(uVar1 + 0x7e8) = 1;
      *(undefined4 *)(uVar1 + 0x7ec) = uStack1372;
      *(undefined8 *)(uVar1 + 0x7f0) = 0;
      puVar11 = (undefined4 *)(uVar1 + 0x7f8);
      puVar12 = &local_548;
      do {
        puVar17 = puVar12;
        puVar14 = puVar11;
        uVar2 = *(undefined4 *)((longlong)puVar17 + 4);
        uVar3 = *(undefined4 *)(puVar17 + 1);
        uVar4 = *(undefined4 *)((longlong)puVar17 + 0xc);
        uVar5 = *(undefined4 *)(puVar17 + 2);
        uVar6 = *(undefined4 *)((longlong)puVar17 + 0x14);
        uVar7 = *(undefined4 *)(puVar17 + 3);
        uVar8 = *(undefined4 *)((longlong)puVar17 + 0x1c);
        *puVar14 = *(undefined4 *)puVar17;
        puVar14[1] = uVar2;
        puVar14[2] = uVar3;
        puVar14[3] = uVar4;
        uVar2 = *(undefined4 *)(puVar17 + 4);
        uVar3 = *(undefined4 *)((longlong)puVar17 + 0x24);
        uVar4 = *(undefined4 *)(puVar17 + 5);
        uVar9 = *(undefined4 *)((longlong)puVar17 + 0x2c);
        puVar14[4] = uVar5;
        puVar14[5] = uVar6;
        puVar14[6] = uVar7;
        puVar14[7] = uVar8;
        uVar5 = *(undefined4 *)(puVar17 + 6);
        uVar6 = *(undefined4 *)((longlong)puVar17 + 0x34);
        uVar7 = *(undefined4 *)(puVar17 + 7);
        uVar8 = *(undefined4 *)((longlong)puVar17 + 0x3c);
        puVar14[8] = uVar2;
        puVar14[9] = uVar3;
        puVar14[10] = uVar4;
        puVar14[0xb] = uVar9;
        uVar2 = *(undefined4 *)(puVar17 + 8);
        uVar3 = *(undefined4 *)((longlong)puVar17 + 0x44);
        uVar4 = *(undefined4 *)(puVar17 + 9);
        uVar9 = *(undefined4 *)((longlong)puVar17 + 0x4c);
        puVar14[0xc] = uVar5;
        puVar14[0xd] = uVar6;
        puVar14[0xe] = uVar7;
        puVar14[0xf] = uVar8;
        uVar5 = *(undefined4 *)(puVar17 + 10);
        uVar6 = *(undefined4 *)((longlong)puVar17 + 0x54);
        uVar7 = *(undefined4 *)(puVar17 + 0xb);
        uVar8 = *(undefined4 *)((longlong)puVar17 + 0x5c);
        puVar14[0x10] = uVar2;
        puVar14[0x11] = uVar3;
        puVar14[0x12] = uVar4;
        puVar14[0x13] = uVar9;
        uVar2 = *(undefined4 *)(puVar17 + 0xc);
        uVar3 = *(undefined4 *)((longlong)puVar17 + 100);
        uVar4 = *(undefined4 *)(puVar17 + 0xd);
        uVar9 = *(undefined4 *)((longlong)puVar17 + 0x6c);
        puVar14[0x14] = uVar5;
        puVar14[0x15] = uVar6;
        puVar14[0x16] = uVar7;
        puVar14[0x17] = uVar8;
        uVar5 = *(undefined4 *)(puVar17 + 0xe);
        uVar6 = *(undefined4 *)((longlong)puVar17 + 0x74);
        uVar7 = *(undefined4 *)(puVar17 + 0xf);
        uVar8 = *(undefined4 *)((longlong)puVar17 + 0x7c);
        puVar14[0x18] = uVar2;
        puVar14[0x19] = uVar3;
        puVar14[0x1a] = uVar4;
        puVar14[0x1b] = uVar9;
        puVar14[0x1c] = uVar5;
        puVar14[0x1d] = uVar6;
        puVar14[0x1e] = uVar7;
        puVar14[0x1f] = uVar8;
        lVar18 = lVar18 + -1;
        puVar11 = puVar14 + 0x20;
        puVar12 = puVar17 + 0x10;
      } while (lVar18 != 0);
      uVar2 = *(undefined4 *)((longlong)puVar17 + 0x84);
      uVar3 = *(undefined4 *)(puVar17 + 0x11);
      uVar4 = *(undefined4 *)((longlong)puVar17 + 0x8c);
      uVar5 = *(undefined4 *)(puVar17 + 0x12);
      uVar6 = *(undefined4 *)((longlong)puVar17 + 0x94);
      uVar7 = *(undefined4 *)(puVar17 + 0x13);
      uVar8 = *(undefined4 *)((longlong)puVar17 + 0x9c);
      puVar14[0x20] = *(undefined4 *)(puVar17 + 0x10);
      puVar14[0x21] = uVar2;
      puVar14[0x22] = uVar3;
      puVar14[0x23] = uVar4;
      uVar2 = *(undefined4 *)(puVar17 + 0x14);
      uVar3 = *(undefined4 *)((longlong)puVar17 + 0xa4);
      uVar4 = *(undefined4 *)(puVar17 + 0x15);
      uVar9 = *(undefined4 *)((longlong)puVar17 + 0xac);
      puVar14[0x24] = uVar5;
      puVar14[0x25] = uVar6;
      puVar14[0x26] = uVar7;
      puVar14[0x27] = uVar8;
      uVar5 = *(undefined4 *)(puVar17 + 0x16);
      uVar6 = *(undefined4 *)((longlong)puVar17 + 0xb4);
      uVar7 = *(undefined4 *)(puVar17 + 0x17);
      uVar8 = *(undefined4 *)((longlong)puVar17 + 0xbc);
      puVar14[0x28] = uVar2;
      puVar14[0x29] = uVar3;
      puVar14[0x2a] = uVar4;
      puVar14[0x2b] = uVar9;
      puVar14[0x2c] = uVar5;
      puVar14[0x2d] = uVar6;
      puVar14[0x2e] = uVar7;
      puVar14[0x2f] = uVar8;
    }
  }
  else {
    lVar15 = FUN_18007d110(uVar1,local_208,param_6);
    if (lVar15 == 0) goto LAB_1800165e2;
    uVar16 = FUN_18007d1b0(lVar15,local_208,(longlong)&local_548);
    if ((int)uVar16 != 0) goto LAB_1800164cc;
  }
  if (lVar15 != 0) {
    (*(code *)param_6[1])();
  }
LAB_1800165e2:
  __security_check_cookie(local_38 ^ (ulonglong)auStack1432);
  return;
}



ulonglong FUN_180016638(ushort param_1,ushort param_2,undefined8 *param_3)

{
  ushort uVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  ushort *puVar4;
  ulonglong uVar5;
  
  uVar5 = 0;
  if (param_3 != (undefined8 *)0x0) {
    puVar4 = &DAT_18007f1f6;
    uVar2 = 0xffffffffffffffff;
    do {
      uVar1 = puVar4[-1];
      uVar3 = uVar5;
      if (((param_1 <= uVar1) && ((param_1 != uVar1 || (param_2 < *puVar4)))) &&
         ((param_1 < uVar1 || ((uVar3 = uVar2, param_1 == uVar1 && (param_2 < *puVar4)))))) break;
      uVar5 = uVar5 + 1;
      puVar4 = puVar4 + 0x10;
      uVar2 = uVar3;
    } while (uVar5 < 5);
    uVar5 = 1;
    if (uVar2 == 0xffffffffffffffff) {
      *param_3 = &DAT_18007f1e0;
    }
    else {
      *param_3 = &DAT_18007f1e0 + uVar2 * 0x20;
    }
  }
  return uVar5;
}



ulonglong FUN_1800166c0(longlong *param_1,undefined8 *param_2)

{
  ulonglong uVar1;
  longlong lVar2;
  uint uVar3;
  longlong lVar4;
  
  uVar1 = 0;
  if ((param_2 != (undefined8 *)0x0) && (param_1 != (longlong *)0x0)) {
    *param_2 = 0;
    while( true ) {
      lVar4 = uVar1 * 0x20;
      lVar2 = *param_1 - (&DAT_18007f1e4)[uVar1 * 4];
      if (lVar2 == 0) {
        lVar2 = param_1[1] - (&DAT_18007f1ec)[uVar1 * 4];
      }
      if (lVar2 == 0) break;
      uVar3 = (int)uVar1 + 1;
      uVar1 = (ulonglong)uVar3;
      if (4 < uVar3) {
        return 0;
      }
    }
    uVar1 = 1;
    *param_2 = &DAT_18007f1e0 + lVar4;
  }
  return uVar1;
}



void FUN_18001671c(void)

{
  undefined auStack184 [32];
  undefined8 local_98;
  longlong *local_90;
  longlong local_88;
  undefined4 local_80;
  undefined4 uStack124;
  undefined4 uStack120;
  undefined4 uStack116;
  undefined4 local_70;
  undefined4 uStack108;
  undefined4 uStack104;
  undefined4 uStack100;
  undefined2 local_58 [32];
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack184;
  local_90 = &local_88;
  local_98 = 0x20;
  local_80 = 0x420053;
  uStack124 = 0x45005f;
  uStack120 = 0x41004e;
  uStack116 = 0x4c0042;
  local_70 = 0x5f0045;
  uStack108 = 0x520054;
  uStack104 = 0x430041;
  uStack100 = 0x45;
  RtlQueryEnvironmentVariable(0,&local_80,0xf,local_58);
  __security_check_cookie(local_18 ^ (ulonglong)auStack184);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

undefined8
BaseGenerateAppCompatData
          (undefined param_1,undefined param_2,undefined param_3,undefined param_4,
          undefined8 param_5,undefined8 param_6)

{
  int iVar1;
  code *pcVar2;
  
                    // 0x167b0  59  BaseGenerateAppCompatData
  iVar1 = FUN_180016834();
  if (-1 < iVar1) {
    pcVar2 = (code *)RtlDecodeSystemPointer(DAT_1800b2d58);
    if (pcVar2 != (code *)0x0) {
      (*pcVar2)();
    }
  }
  return 0;
}



void FUN_180016834(void)

{
  int iVar1;
  longlong lVar2;
  ulonglong uVar3;
  undefined auStack664 [32];
  undefined8 local_278;
  undefined4 local_270 [2];
  undefined *local_268;
  undefined8 local_260;
  undefined8 local_258;
  undefined8 local_250;
  undefined8 local_248;
  undefined8 local_240;
  undefined8 local_238;
  undefined8 local_230;
  undefined local_228 [528];
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack664;
  local_278 = 0;
  if (DAT_1800b2d40 != 1) {
    if (DAT_1800b2d40 != -1) {
      lVar2 = -1;
      do {
        lVar2 = lVar2 + 1;
      } while (*(short *)(lVar2 * 2 + 0x7ffe0030) != 0);
      if ((int)lVar2 * 2 + 0x2cU < 0x209) {
        local_268 = local_228;
        local_270[0] = 0x2080000;
        iVar1 = RtlAppendUnicodeToString(local_270);
        if ((((((-1 < iVar1) &&
               (iVar1 = RtlAppendUnicodeStringToString(local_270,&DAT_18007f2f0), -1 < iVar1)) &&
              (iVar1 = LdrLoadDll(0,0,local_270,&local_278), -1 < iVar1)) &&
             ((iVar1 = LdrAddRefDll(1,local_278), -1 < iVar1 &&
              (iVar1 = LdrGetProcedureAddress(local_278,&DAT_18007f2e0,0,&local_260), -1 < iVar1))))
            && ((iVar1 = LdrGetProcedureAddress(local_278,&DAT_18007f2d0,0,&local_258), -1 < iVar1
                && ((iVar1 = LdrGetProcedureAddress(local_278,&DAT_18007f2c0,0,&local_250),
                    -1 < iVar1 &&
                    (iVar1 = LdrGetProcedureAddress(local_278,&DAT_18007f2b0,0,&local_248),
                    -1 < iVar1)))))) &&
           ((iVar1 = LdrGetProcedureAddress(local_278,&DAT_18007f2a0,0,&local_240), -1 < iVar1 &&
            ((iVar1 = LdrGetProcedureAddress(local_278,&DAT_18007f290,0,&local_238), -1 < iVar1 &&
             (iVar1 = LdrGetProcedureAddress(local_278,&DAT_18007f280,0,&local_230), -1 < iVar1)))))
           ) {
          uVar3 = RtlEncodeSystemPointer(local_260);
          LOCK();
          DAT_1800b2d50 = DAT_1800b2d50 ^ (ulonglong)(DAT_1800b2d50 == 0) * (DAT_1800b2d50 ^ uVar3);
          uVar3 = RtlEncodeSystemPointer(local_258);
          LOCK();
          DAT_1800b2d58 = DAT_1800b2d58 ^ (ulonglong)(DAT_1800b2d58 == 0) * (DAT_1800b2d58 ^ uVar3);
          uVar3 = RtlEncodeSystemPointer(local_250);
          LOCK();
          DAT_1800b2d60 = DAT_1800b2d60 ^ (ulonglong)(DAT_1800b2d60 == 0) * (DAT_1800b2d60 ^ uVar3);
          uVar3 = RtlEncodeSystemPointer(local_248);
          LOCK();
          DAT_1800b2d68 = DAT_1800b2d68 ^ (ulonglong)(DAT_1800b2d68 == 0) * (DAT_1800b2d68 ^ uVar3);
          uVar3 = RtlEncodeSystemPointer(local_240);
          LOCK();
          DAT_1800b2d70 = DAT_1800b2d70 ^ (ulonglong)(DAT_1800b2d70 == 0) * (DAT_1800b2d70 ^ uVar3);
          uVar3 = RtlEncodeSystemPointer(local_238);
          LOCK();
          DAT_1800b2d78 = DAT_1800b2d78 ^ (ulonglong)(DAT_1800b2d78 == 0) * (DAT_1800b2d78 ^ uVar3);
          uVar3 = RtlEncodeSystemPointer(local_230);
          LOCK();
          DAT_1800b2d80 = DAT_1800b2d80 ^ (ulonglong)(DAT_1800b2d80 == 0) * (DAT_1800b2d80 ^ uVar3);
          LOCK();
          if (DAT_1800b2d40 == 0) {
            DAT_1800b2d40 = 1;
          }
          goto LAB_18001687f;
        }
      }
    }
    LOCK();
    if (DAT_1800b2d40 == 0) {
      DAT_1800b2d40 = -1;
    }
  }
LAB_18001687f:
  __security_check_cookie(local_18 ^ (ulonglong)auStack664);
  return;
}



void TermsrvOpenRegEntry(void)

{
                    // 0x16b90  1449  TermsrvOpenRegEntry
  if (DAT_1800b2dd8 != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180026440. Too many branches
                    // WARNING: Treating indirect jump as call
    (*DAT_1800b2dd8)();
    return;
  }
  return;
}



HGLOBAL GlobalReAlloc(HGLOBAL hMem,SIZE_T dwBytes,UINT uFlags)

{
  ushort *puVar1;
  char cVar2;
  char cVar3;
  ushort uVar4;
  int iVar5;
  int *piVar6;
  longlong lVar7;
  void **ppvVar8;
  undefined4 *puVar9;
  size_t _Size;
  void *_Dst;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  HGLOBAL local_res20;
  
                    // 0x16bb0  840  GlobalReAlloc
  if ((uFlags & 0xffff800d) != 0) {
LAB_1800324d5:
    RtlSetLastWin32Error(0x57);
    return (HGLOBAL)0x0;
  }
  uVar13 = uFlags & 0x100;
  cVar3 = (char)uFlags;
  if ((uVar13 != 0) && (-1 < cVar3)) goto LAB_1800324d5;
  uVar10 = uFlags >> 3 & 8;
  RtlLockHeap(DAT_1800b2a30);
  uVar12 = uFlags & 2;
  uVar11 = uVar10 | 0x10;
  if (uVar12 != 0) {
    uVar11 = uVar10;
  }
  ppvVar8 = (void **)hMem;
  if (((ulonglong)hMem & 8) == 0) {
    if (cVar3 < '\0') {
      if ((uVar12 == 0) ||
         (local_res20 = hMem, cVar3 = RtlGetUserInfoHeap(DAT_1800b2a30,1,hMem,&local_res20,0),
         cVar3 == '\0')) goto LAB_180016fb8;
      puVar9 = (undefined4 *)RtlAllocateHandle(DAT_1800b2a20,0);
      if (puVar9 != (undefined4 *)0x0) {
        _Size = RtlSizeHeap(DAT_1800b2a30,1,hMem);
        piVar6 = (int *)KernelBaseGetGlobalData();
        _Dst = (void *)RtlAllocateHeap(DAT_1800b2a30,*piVar6 + 0x100000U | uVar11 | 0x301,_Size);
        ppvVar8 = (void **)(puVar9 + 2);
        *ppvVar8 = _Dst;
        if (_Dst != (void *)0x0) {
          RtlMoveMemory(_Dst,hMem,_Size);
          RtlFreeHeap(DAT_1800b2a30,1,hMem);
          *puVar9 = 3;
          uVar4 = 3;
          if (uVar13 != 0) {
            uVar4 = 7;
            *(undefined2 *)puVar9 = 7;
          }
          if (((ulonglong)local_res20 & 0x2000) != 0) {
            *(ushort *)puVar9 = uVar4 | 0x8000;
          }
          RtlSetUserValueHeap(DAT_1800b2a30,1,*ppvVar8,ppvVar8);
          goto LAB_180016fb8;
        }
        *(undefined2 *)puVar9 = 1;
        RtlFreeHandle(DAT_1800b2a20,puVar9);
      }
      goto LAB_180016e6c;
    }
    piVar6 = (int *)KernelBaseGetGlobalData();
    ppvVar8 = (void **)RtlReAllocateHeap(DAT_1800b2a30,*piVar6 + 0x100000U | uVar11 | 1,hMem,dwBytes
                                        );
    if (ppvVar8 != (void **)0x0) goto LAB_180016fb8;
  }
  else {
    puVar1 = (ushort *)((longlong)hMem + -8);
    cVar2 = RtlIsValidHandle(DAT_1800b2a20,puVar1);
    if (cVar2 == '\0') {
      RtlSetLastWin32Error(6);
      ppvVar8 = (void **)0x0;
      goto LAB_180016fb8;
    }
    if (cVar3 < '\0') {
      if (uVar13 == 0) {
        uVar4 = *puVar1 & 0xfffb;
      }
      else {
        uVar4 = *puVar1 | 4;
      }
      *puVar1 = uVar4;
      goto LAB_180016fb8;
    }
                    // WARNING: Load size is inaccurate
    lVar7 = *hMem;
    if (dwBytes == 0) {
      if ((((lVar7 != 0) && (ppvVar8 = (void **)0x0, uVar12 != 0)) &&
          (ppvVar8 = (void **)0x0, *(short *)((longlong)hMem + -6) == 0)) &&
         (iVar5 = RtlFreeHeap(DAT_1800b2a30,uVar11 | 1,lVar7), iVar5 != 0)) {
        *(undefined8 *)hMem = 0;
        *puVar1 = *puVar1 | 8;
        ppvVar8 = (void **)hMem;
      }
      goto LAB_180016fb8;
    }
    if (lVar7 == 0) {
      piVar6 = (int *)KernelBaseGetGlobalData();
      lVar7 = RtlAllocateHeap(DAT_1800b2a30,*piVar6 + 0x100000U | uVar11 | 0x301,dwBytes);
      if (lVar7 != 0) {
        RtlSetUserValueHeap(DAT_1800b2a30,1,lVar7,hMem);
      }
    }
    else {
      if ((uVar12 == 0) && (*(short *)((longlong)hMem + -6) != 0)) {
        uVar11 = uVar11 | 0x311;
      }
      else {
        uVar11 = uVar11 & 0xffffffef | 0x301;
      }
      piVar6 = (int *)KernelBaseGetGlobalData();
      lVar7 = RtlReAllocateHeap(DAT_1800b2a30,*piVar6 + 0x100000U | uVar11,lVar7,dwBytes);
    }
    if (lVar7 != 0) {
      *(longlong *)hMem = lVar7;
      *puVar1 = *puVar1 & 0xfff7;
      goto LAB_180016fb8;
    }
LAB_180016e6c:
    ppvVar8 = (void **)0x0;
  }
  RtlSetLastWin32Error(8);
LAB_180016fb8:
  RtlUnlockHeap(DAT_1800b2a30);
  return ppvVar8;
}



int lstrlenW(LPCWSTR lpString)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180017000. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x17000  1620  lstrlenW
  iVar1 = lstrlenW(lpString);
  return iVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

ulonglong BaseThreadInitThunk(int param_1,undefined *param_2)

{
  code *pcVar1;
  undefined4 uVar2;
  ulonglong uVar3;
  
                    // 0x17020  69  BaseThreadInitThunk
  if (param_1 == 0) {
    uVar2 = (*(code *)param_2)();
    RtlExitUserThread(uVar2);
    pcVar1 = (code *)swi(3);
    uVar3 = (*pcVar1)();
    return uVar3;
  }
  uVar3 = RtlGetSuiteMask();
  if (((uVar3 & 0x10) != 0) && (uVar3 = FUN_18001706c(), (int)uVar3 < 0)) {
    return uVar3;
  }
  return 0;
}



ulonglong FUN_18001706c(void)

{
  undefined8 *puVar1;
  int iVar2;
  undefined8 uVar3;
  ulonglong uVar4;
  HMODULE hModule;
  FARPROC pFVar5;
  longlong lVar6;
  longlong in_GS_OFFSET;
  int local_res8 [2];
  
  DAT_1800b2ce0 = FUN_180017970;
  uVar3 = FUN_1800175c8();
  if (((int)uVar3 == 0) && (iVar2 = FUN_180017a3c(), iVar2 == 0)) {
    uVar4 = FUN_180017900(local_res8);
    if ((int)uVar4 < 0) {
      return uVar4;
    }
    if (local_res8[0] != 0) {
      hModule = LoadLibraryExW(L"tsappcmp.dll",(HANDLE)0x0,0x800);
      if (hModule == (HMODULE)0x0) {
        return (ulonglong)*(uint *)(*(longlong *)(in_GS_OFFSET + 0x30) + 0x1250);
      }
      lVar6 = 0;
      do {
        pFVar5 = GetProcAddress(hModule,*(LPCSTR *)
                                         ((longlong)&PTR_s_TermsrvGetComputerName_1800805e0 + lVar6)
                               );
        puVar1 = (undefined8 *)((longlong)&PTR_DAT_1800805e8 + lVar6);
        lVar6 = lVar6 + 0x10;
        *(FARPROC *)*puVar1 = pFVar5;
      } while (lVar6 != 0xc0);
    }
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void entry(REGHANDLE param_1,uint param_2)

{
  wchar_t wVar1;
  longlong lVar2;
  longlong lVar3;
  code *pcVar4;
  bool bVar5;
  bool bVar6;
  bool bVar7;
  uint uVar8;
  int iVar9;
  longlong lVar10;
  ulonglong uVar11;
  undefined8 uVar12;
  wchar_t *pwVar13;
  undefined7 extraout_var;
  HMODULE hModule;
  REGHANDLE RegHandle;
  wchar_t *pwVar14;
  longlong in_GS_OFFSET;
  undefined auStack632 [32];
  int local_258;
  wchar_t *local_250;
  char local_248 [4];
  DWORD local_244;
  code *local_240;
  wchar_t local_238 [256];
  ulonglong local_38;
  undefined8 uStack48;
  
  if (param_2 == 1) {
    uStack48 = 0x1800170ed;
    _DllMainCRTStartupForGS2(param_1,1);
  }
  RegHandle = DAT_1800b2020;
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack632;
  lVar2 = *(longlong *)(in_GS_OFFSET + 0x60);
  bVar6 = false;
  lVar3 = *(longlong *)(lVar2 + 0x20);
  if (param_2 == 0) {
    local_240 = LoadLibraryExW;
    _DAT_1800b2000 = 0;
    DAT_1800b2020 = 0;
    EventUnregister(RegHandle);
  }
  else {
    RegHandle = param_1;
    if (param_2 == 1) {
      lVar10 = RtlImageNtHeader(*(undefined8 *)(lVar2 + 0x10));
      if (lVar10 == 0) goto LAB_180017349;
      RtlSetThreadPoolStartFunc(FUN_180058f20,FUN_180059020);
      LdrSetDllManifestProber(FUN_180014fb0,FUN_1800428f0,ReleaseActCtx_exref);
      bVar6 = true;
      FUN_180017570();
      if ((2 < (ushort)(*(short *)(lVar10 + 0x5c) - 1U)) || (*(ushort *)(lVar10 + 0x48) < 6)) {
        RtlSetProtectedPolicy(&DAT_180085d78,1,0);
      }
      pwVar14 = local_238;
      if (*(int *)(lVar2 + 0x2c0) == 0) {
        lVar10 = 0x100;
        do {
          if ((lVar10 == -0x7ffffefe) ||
             (wVar1 = *(wchar_t *)
                       (((longlong)L"\\Windows" - (longlong)local_238) + (longlong)pwVar14),
             wVar1 == L'\0')) break;
          *pwVar14 = wVar1;
          pwVar14 = pwVar14 + 1;
          lVar10 = lVar10 + -1;
        } while (lVar10 != 0);
        pwVar13 = pwVar14 + -1;
        if (lVar10 != 0) {
          pwVar13 = pwVar14;
        }
        *pwVar13 = L'\0';
      }
      else {
        local_250 = L"\\Windows";
        local_258 = *(int *)(lVar2 + 0x2c0);
        FUN_180017608(pwVar14,0x200,L"%ws\\%ld%ws",L"\\Sessions");
      }
      DAT_1800b2bf8 =
           *(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x88) +
           (*(longlong *)(*(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x98) + 8) -
           *(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x380));
      _DAT_1800b2bf0 = DAT_1800b2bf8 + 0x3a;
      if ((_DAT_1800b2bf0 != 0) && (*(longlong *)(lVar2 + 0x2f0) == 0)) {
        RtlInitUnicodeString(lVar2 + 0x2e8);
      }
      _DAT_1800b2c10 = *(undefined8 *)(DAT_1800b2bf8 + 0x7f8);
      lVar2 = *(longlong *)(DAT_1800b2bf8 + 0x800);
      if (lVar2 == 0) {
        _DAT_1800b2c18 = 0;
      }
      else {
        _DAT_1800b2c18 = lVar2 + (DAT_1800b2bf8 - *(longlong *)(DAT_1800b2bf8 + 0x9e8));
      }
      if ((*(uint *)(lVar3 + 8) & 0x4000) == 0) {
        local_250 = (wchar_t *)0x0;
        local_258 = 4;
        iVar9 = LdrQueryImageFileExecutionOptions(lVar2);
        if (-1 < iVar9) {
          SetSearchPathMode(local_244);
        }
      }
      if (*(int *)(lVar3 + 0xc) != 0) {
        pcVar4 = (code *)swi(3);
        (*pcVar4)();
        return;
      }
      _DAT_1800b2c08 = &DAT_1800b2c00;
      DAT_1800b2c00 = &DAT_1800b2c00;
      uVar11 = RtlGetSuiteMask();
      if ((uVar11 & 0x10) == 0) goto LAB_18001731c;
      local_248[0] = '\0';
      bVar5 = false;
      uVar12 = FUN_1800175c8();
      uVar8 = 0;
      if (((int)uVar12 == 0) &&
         (bVar7 = FUN_180017750(local_248), uVar8 = 0, (int)CONCAT71(extraout_var,bVar7) != 0)) {
        uVar8 = FUN_180067328();
        iVar9 = FUN_180017a3c();
        if (iVar9 == 0) {
          if ((uVar8 & 0x108) != 0x108) goto LAB_1800325c0;
        }
        else if ((uVar8 & 0x2008) == 0x2008) {
LAB_1800325c0:
          hModule = LoadLibraryExW(L"tsappcmp.dll",(HANDLE)0x0,0x800);
          if (hModule != (HMODULE)0x0) {
            DAT_1800b2dd0 = GetProcAddress(hModule,"TermsrvCreateRegEntry");
            DAT_1800b2dd8 = GetProcAddress(hModule,"TermsrvOpenRegEntry");
            DAT_1800b2de0 = GetProcAddress(hModule,"TermsrvSetValueKey");
            DAT_1800b2de8 = GetProcAddress(hModule,"TermsrvDeleteKey");
            DAT_1800b2df0 = GetProcAddress(hModule,"TermsrvDeleteValue");
            DAT_1800b2df8 = GetProcAddress(hModule,"TermsrvRestoreKey");
            DAT_1800b2e00 = GetProcAddress(hModule,"TermsrvSetKeySecurity");
            DAT_1800b2e08 = GetProcAddress(hModule,"TermsrvOpenUserClasses");
            DAT_1800b2e10 = GetProcAddress(hModule,"TermsrvGetPreSetValue");
            bVar5 = true;
          }
          goto LAB_180017313;
        }
      }
      else {
LAB_180017313:
        if ((bVar5) && (local_248[0] != '\0')) {
          GetRegistryExtensionFlags(uVar8);
        }
      }
LAB_18001731c:
      FUN_18001b7a4(&DAT_1800b2000);
      LdrDisableThreadCalloutsForDll();
      RegHandle = param_1;
    }
  }
  uVar11 = FUN_18001748c(RegHandle,param_2);
  if (((char)uVar11 == '\0') && (bVar6)) {
    LdrSetDllManifestProber(0,0,0);
  }
LAB_180017349:
  __security_check_cookie(local_38 ^ (ulonglong)auStack632);
  return;
}



ulonglong FUN_18001748c(undefined8 param_1,int param_2)

{
  BOOL BVar1;
  ulonglong in_RAX;
  longlong lVar2;
  undefined4 extraout_var;
  ulonglong uVar3;
  longlong in_GS_OFFSET;
  
  uVar3 = 0;
  if (param_2 == 0) {
    in_RAX = KernelBaseGetGlobalData();
    if (*(int *)(in_RAX + 0x28) != 0) {
      BVar1 = WritePrivateProfileStringW((LPCWSTR)0x0,(LPCWSTR)0x0,(LPCWSTR)0x0,(LPCWSTR)0x0);
      in_RAX = CONCAT44(extraout_var,BVar1);
    }
  }
  else if (param_2 == 1) {
    lVar2 = KernelBaseGetGlobalData();
    *(undefined4 *)(lVar2 + 0x28) = 0;
    DAT_1800b2bf8 =
         (*(longlong *)(*(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x98) + 8) -
         *(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x380)) +
         *(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x88);
    FUN_180017570();
    DAT_1800b2b30 = uVar3;
    if (*(longlong *)(DAT_1800b2bf8 + 0x170) != 0) {
      DAT_1800b2b30 =
           (*(longlong *)(DAT_1800b2bf8 + 0x170) - *(longlong *)(DAT_1800b2bf8 + 0x9e8)) +
           DAT_1800b2bf8;
    }
    in_RAX = NtQuerySystemInformation(0,&DAT_1800b2a40,0x40);
    if ((int)in_RAX < 0) goto LAB_18001753a;
  }
  uVar3 = 1;
LAB_18001753a:
  return in_RAX & 0xffffffffffffff00 | uVar3;
}



void FUN_180017570(void)

{
  longlong lVar1;
  
  lVar1 = KernelBaseGetGlobalData();
  if (DAT_1800b2a28 == 0) {
    DAT_1800b2a28 = *(longlong *)(lVar1 + 0x50);
  }
  DAT_1800b2a20 = *(undefined8 *)(lVar1 + 0x48);
  DAT_1800b2a30 = *(undefined8 *)(lVar1 + 0x40);
  return;
}



undefined8 FUN_1800175c8(void)

{
  longlong lVar1;
  undefined8 uVar2;
  
  lVar1 = RtlImageNtHeader();
  if ((lVar1 == 0) || (-1 < *(short *)(lVar1 + 0x5e))) {
    uVar2 = 0;
  }
  else {
    uVar2 = 1;
  }
  return uVar2;
}



ulonglong FUN_180017608(wchar_t *param_1,ulonglong param_2,undefined8 param_3,undefined8 param_4)

{
  ulonglong uVar1;
  ulonglong uVar2;
  undefined8 local_res20;
  
  uVar1 = param_2 >> 1;
  uVar2 = 0;
  if (0x7ffffffe < uVar1 - 1) {
    uVar2 = 0x80070057;
  }
  if ((int)uVar2 < 0) {
    if (uVar1 != 0) {
      *param_1 = L'\0';
    }
  }
  else {
    local_res20 = param_4;
    uVar2 = FUN_180017660(param_1,uVar1,param_3,(wchar_t *)param_3,(va_list)&local_res20);
    uVar2 = uVar2 & 0xffffffff;
  }
  return uVar2;
}



undefined8
FUN_180017660(wchar_t *param_1,longlong param_2,undefined8 param_3,wchar_t *param_4,va_list param_5)

{
  ulonglong _Count;
  int iVar1;
  undefined8 uVar2;
  
  _Count = param_2 - 1;
  uVar2 = 0;
  iVar1 = _vsnwprintf(param_1,_Count,param_4,param_5);
  if ((iVar1 < 0) || (_Count < (ulonglong)(longlong)iVar1)) {
    param_1[_Count] = L'\0';
    uVar2 = 0x8007007a;
  }
  else if ((longlong)iVar1 == _Count) {
    param_1[_Count] = L'\0';
  }
  return uVar2;
}



uint FUN_1800176c8(short *param_1,ulonglong param_2,longlong param_3)

{
  short sVar1;
  short *psVar2;
  ulonglong uVar3;
  longlong lVar4;
  uint uVar5;
  longlong lVar6;
  
  uVar3 = param_2 >> 1;
  uVar5 = 0;
  if (0x7ffffffe < uVar3 - 1) {
    uVar5 = 0x80070057;
  }
  if ((int)uVar5 < 0) {
    if (uVar3 != 0) {
      *param_1 = 0;
    }
  }
  else {
    if (uVar3 != 0) {
      lVar6 = 0x7ffffffe - uVar3;
      lVar4 = param_3 - (longlong)param_1;
      do {
        if ((lVar6 + uVar3 == 0) || (sVar1 = *(short *)(lVar4 + (longlong)param_1), sVar1 == 0))
        break;
        *param_1 = sVar1;
        param_1 = param_1 + 1;
        uVar3 = uVar3 - 1;
      } while (uVar3 != 0);
    }
    psVar2 = param_1 + -1;
    if (uVar3 != 0) {
      psVar2 = param_1;
    }
    uVar5 = ~-(uint)(uVar3 != 0) & 0x8007007a;
    *psVar2 = 0;
  }
  return uVar5;
}



bool FUN_180017750(undefined *param_1)

{
  undefined uVar1;
  int iVar2;
  void *_Dst;
  longlong in_GS_OFFSET;
  bool bVar3;
  undefined local_res10 [8];
  undefined8 local_res18;
  undefined local_58 [8];
  longlong local_50;
  undefined4 local_48 [2];
  undefined8 local_40;
  undefined *local_38;
  undefined4 local_30;
  undefined local_28 [16];
  
  local_res18 = 0;
  bVar3 = false;
  RtlInitUnicodeString(local_58);
  _Dst = (void *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,0x224)
  ;
  if (local_50 != 0) {
    if (_Dst == (void *)0x0) {
      return false;
    }
    local_40 = 0;
    local_38 = local_58;
    local_48[0] = 0x30;
    local_30 = 0x40;
    local_28 = ZEXT816(0);
    iVar2 = NtOpenKey(&local_res18,0x20019,local_48);
    if (-1 < iVar2) {
      RtlInitUnicodeString(local_58,L"TSAppCompat");
      iVar2 = NtQueryValueKey(local_res18,local_58,2,_Dst,0x224,local_res10);
      if ((-1 < iVar2) && (*(int *)((longlong)_Dst + 4) == 4)) {
        bVar3 = *(int *)((longlong)_Dst + 0xc) != 0;
      }
      RtlInitUnicodeString(local_58,L"TSUserEnabled");
      iVar2 = NtQueryValueKey(local_res18,local_58,2,_Dst,0x224,local_res10);
      if ((iVar2 < 0) || (*(int *)((longlong)_Dst + 4) != 4)) {
        uVar1 = 0;
      }
      else {
        uVar1 = *(undefined *)((longlong)_Dst + 0xc);
      }
      *param_1 = uVar1;
      NtClose(local_res18);
    }
  }
  if (_Dst != (void *)0x0) {
    memset(_Dst,0,0x224);
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,_Dst);
  }
  return bVar3;
}



void FUN_180017900(undefined4 *param_1)

{
  BOOL BVar1;
  undefined4 uVar2;
  undefined auStack344 [32];
  _OSVERSIONINFOW local_138;
  ushort local_20;
  char local_1e;
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack344;
  local_138.dwOSVersionInfoSize = 0x11c;
  BVar1 = GetVersionExW(&local_138);
  if ((((BVar1 == 0) || ((local_20 & 0x10) == 0)) || ((local_20 & 0x100) != 0)) ||
     (uVar2 = 1, 1 < (byte)(local_1e - 2U))) {
    uVar2 = 0;
  }
  *param_1 = uVar2;
  __security_check_cookie(local_18 ^ (ulonglong)auStack344);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_180017970(int *param_1)

{
  undefined uVar1;
  int iVar2;
  int iVar3;
  undefined8 uVar4;
  longlong lVar5;
  char cVar6;
  int iVar7;
  uint uVar8;
  wchar_t *pwVar9;
  longlong lVar10;
  wchar_t *_Str;
  ulonglong uVar12;
  ushort *puVar13;
  longlong in_GS_OFFSET;
  int iVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  int iVar18;
  int iVar19;
  int iVar20;
  int iVar21;
  undefined auStackY920 [32];
  undefined local_368;
  undefined local_367;
  undefined local_366;
  short local_360;
  undefined6 uStack862;
  ulonglong local_358;
  byte local_350;
  undefined8 local_348;
  ushort local_340 [4];
  longlong local_338;
  ushort local_330 [4];
  longlong local_328;
  uint local_320;
  short *local_318;
  int local_310 [4];
  undefined4 local_300 [2];
  undefined8 local_2f8;
  ushort *local_2f0;
  undefined4 local_2e8;
  undefined local_2e0 [16];
  undefined4 local_2d0 [2];
  undefined8 local_2c8;
  ushort *local_2c0;
  undefined4 local_2b8;
  undefined local_2b0 [16];
  undefined local_2a0 [16];
  undefined4 local_290 [10];
  short local_268 [264];
  ulonglong local_58;
  longlong lVar11;
  
  local_58 = DAT_1800b2220 ^ (ulonglong)auStackY920;
  local_318 = local_268;
  local_320 = 0x20a0208;
  _Str = (wchar_t *)0x0;
  local_368 = 0;
  iVar7 = FUN_180017a3c();
  if ((((iVar7 == 0) && (*(char *)(DAT_1800b2bf8 + 0x808) == '\0')) && (DAT_1800b2e28 != 0)) &&
     (iVar7 = (*(code *)DAT_1800b2e28)(), iVar7 != 0)) {
    pwVar9 = wcsrchr(*(wchar_t **)(param_1 + 0x10),L'\\');
    if (pwVar9 != (wchar_t *)0x0) {
      lVar11 = -1;
      do {
        lVar10 = lVar11 + 1;
        lVar5 = lVar11 + 2;
        lVar11 = lVar10;
      } while (pwVar9[lVar5] != L'\0');
      uVar12 = lVar10 * 2 + 2;
      _Str = (wchar_t *)
             RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,uVar12);
      if (_Str != (wchar_t *)0x0) {
        FUN_1800176c8(_Str,uVar12,(longlong)(pwVar9 + 1));
        pwVar9 = wcsrchr(_Str,L'.');
        if (pwVar9 != (wchar_t *)0x0) {
          *pwVar9 = L'\0';
        }
        if (((DAT_1800b2f58 != 0) && (iVar7 = (*(code *)DAT_1800b2f58)(), iVar7 != 0)) &&
           (((local_350 & 0x44) == 0x44 && (iVar7 = FUN_180067c00(local_340), iVar7 != 0)))) {
          puVar13 = local_330;
          cVar6 = FUN_180067b30((longlong)local_340,(longlong)puVar13);
          if ((((cVar6 != '\0') &&
               (uVar8 = FUN_180067a5c(local_268,puVar13,local_328,(short **)&local_360,
                                      (longlong *)&local_358), -1 < (int)uVar8)) &&
              ((*(short *)(local_328 + -2 + (ulonglong)(local_330[0] >> 1) * 2) == 0x5c ||
               (uVar12 = FUN_18006794c((short *)CONCAT62(uStack862,local_360),local_358,
                                       (short *)&DAT_180085358,(short **)&local_360,
                                       (longlong *)&local_358), -1 < (int)uVar12)))) &&
             (((uVar12 = FUN_18006794c((short *)CONCAT62(uStack862,local_360),local_358,_Str,
                                       (short **)&local_360,(longlong *)&local_358),
               -1 < (int)uVar12 &&
               (uVar12 = FUN_18006794c((short *)CONCAT62(uStack862,local_360),local_358,L".ctx",
                                       (short **)&local_360,(longlong *)&local_358),
               -1 < (int)uVar12)) &&
              (local_320 = local_320 & 0xffff0000 | (uint)(ushort)(local_360 - (short)local_268),
              DAT_1800b2f68 != 0)))) {
            (*(code *)DAT_1800b2f68)();
            local_2f0 = local_340;
            local_300[0] = 0x30;
            local_2f8 = 0;
            local_2e8 = 0x40;
            local_310[0] = 0;
            local_2e0 = ZEXT816(0);
            iVar7 = NtOpenFile(&local_348,0x120089,local_300,local_310);
            if ((-1 < iVar7) && (-1 < local_310[0])) {
              local_367 = *(undefined *)((longlong)param_1 + 5);
              iVar7 = *param_1;
              uVar1 = *(undefined *)(param_1 + 0x22);
              iVar14 = param_1[0x12];
              iVar15 = param_1[0x13];
              iVar16 = param_1[0x14];
              iVar17 = param_1[0x15];
              iVar2 = param_1[0x24];
              iVar18 = param_1[0x16];
              iVar19 = param_1[0x17];
              iVar20 = param_1[0x18];
              iVar21 = param_1[0x19];
              iVar3 = param_1[0x25];
              uVar4 = *(undefined8 *)(param_1 + 0x26);
              local_366 = *(undefined *)(param_1 + 1);
              *(undefined2 *)(param_1 + 1) = 1;
              *param_1 = 2;
              *(undefined *)(param_1 + 0x22) = 0;
              uVar12 = FUN_18000bfc4((longlong)param_1);
              if ((int)uVar12 < 0) {
                NtClose(local_348);
              }
              else {
                lVar11 = *(longlong *)(param_1 + 4);
                *(ulonglong *)(param_1 + 0x30) =
                     (ulonglong)*(uint *)(lVar11 + 0x34) + *(longlong *)(lVar11 + 0x38);
                *(undefined8 *)(param_1 + 0x2c) = *(undefined8 *)(lVar11 + 0x38);
                FUN_180067fa4(local_348,param_1,&local_368);
                NtClose(local_348);
                FUN_18000f1e8((longlong)param_1);
                *(undefined *)((longlong)param_1 + 5) = local_367;
                *(undefined *)(param_1 + 1) = local_366;
                local_2c0 = local_340;
                param_1[0x25] = iVar3;
                *param_1 = iVar7;
                *(undefined *)(param_1 + 0x22) = uVar1;
                *(undefined (*) [16])(param_1 + 0x12) =
                     CONCAT412(iVar17,CONCAT48(iVar16,CONCAT44(iVar15,iVar14)));
                param_1[0x24] = iVar2;
                *(undefined (*) [16])(param_1 + 0x16) =
                     CONCAT412(iVar21,CONCAT48(iVar20,CONCAT44(iVar19,iVar18)));
                *(undefined8 *)(param_1 + 0x26) = uVar4;
                local_2d0[0] = 0x30;
                local_2c8 = 0;
                local_2b8 = 0x40;
                local_2b0 = ZEXT816(0);
                iVar7 = NtQueryFullAttributesFile(local_2d0,local_2a0);
                if (-1 < iVar7) {
                  FUN_180068340(local_340,(longlong)local_330,local_290);
                }
              }
            }
          }
        }
      }
    }
    if (local_338 != 0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_338);
    }
    if (local_328 != 0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_328);
    }
    if (_Str != (wchar_t *)0x0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,_Str);
    }
  }
  __security_check_cookie(local_58 ^ (ulonglong)auStackY920);
  return;
}



void FUN_180017a3c(void)

{
  int iVar1;
  undefined auStack136 [32];
  undefined *local_68;
  undefined8 local_58;
  undefined local_50 [8];
  undefined local_48 [56];
  ulonglong local_10;
  
  local_10 = DAT_1800b2220 ^ (ulonglong)auStack136;
  iVar1 = NtOpenProcessToken(0xffffffffffffffff,8,&local_58);
  if (-1 < iVar1) {
    local_68 = local_50;
    NtQueryInformationToken(local_58,10,local_48);
    NtClose(local_58);
  }
  __security_check_cookie(local_10 ^ (ulonglong)auStack136);
  return;
}



BOOL WritePrivateProfileStringW
               (LPCWSTR lpAppName,LPCWSTR lpKeyName,LPCWSTR lpString,LPCWSTR lpFileName)

{
  int iVar1;
  BOOL BVar2;
  
                    // 0x17af0  1580  WritePrivateProfileStringW
  iVar1 = BaseDllReadWriteIniFile
                    ('\x01','\x01','\0',lpFileName,lpAppName,lpKeyName,
                     (short *)(-(ulonglong)(lpKeyName != (LPCWSTR)0x0) & (ulonglong)lpString),
                     (int *)0x0);
  if (iVar1 < 0) {
    if (iVar1 == -0x3fffff85) {
      RtlSetLastWin32Error(0xd);
    }
    else {
      BaseSetLastNTError();
    }
    BVar2 = 0;
  }
  else {
    BVar2 = 1;
  }
  return BVar2;
}



UINT ResetWriteWatch(LPVOID lpBaseAddress,SIZE_T dwRegionSize)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180017b40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x17b40  1230  ResetWriteWatch
  UVar1 = ResetWriteWatch(lpBaseAddress,dwRegionSize);
  return UVar1;
}



HLOCAL LocalFree(HLOCAL hMem)

{
  HLOCAL pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180017b60. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x17b60  983  LocalFree
  pvVar1 = LocalFree(hMem);
  return pvVar1;
}



void GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)

{
                    // WARNING: Could not recover jumptable at 0x000180017b80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x17b80  756  GetSystemTimeAsFileTime
  GetSystemTimeAsFileTime(lpSystemTimeAsFileTime);
  return;
}



int lstrcmpiW(LPCWSTR lpString1,LPCWSTR lpString2)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180017ba0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x17ba0  1611  lstrcmpiW
                    // 0x17ba0  1627  uaw_lstrcmpiW
  iVar1 = lstrcmpiW(lpString1,lpString2);
  return iVar1;
}



// WARNING: Could not reconcile some variable overlaps

BOOL GetSystemPowerStatus(LPSYSTEM_POWER_STATUS lpSystemPowerStatus)

{
  byte bVar1;
  int iVar2;
  BOOL extraout_EAX;
  byte bVar3;
  DWORD DVar4;
  undefined auStack120 [32];
  undefined8 local_58;
  undefined4 *local_50;
  undefined4 local_48;
  undefined local_44 [4];
  byte local_40 [8];
  char local_38;
  char local_37;
  char local_36;
  uint local_30;
  uint local_2c;
  DWORD local_24;
  ulonglong local_18;
  
                    // 0x17bc0  751  GetSystemPowerStatus
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack120;
  local_58 = (byte *)CONCAT44(local_58._4_4_,0x20);
  iVar2 = NtPowerInformation();
  if (-1 < iVar2) {
    *(undefined8 *)lpSystemPowerStatus = 0;
    lpSystemPowerStatus->BatteryFullLifeTime = 0;
    lpSystemPowerStatus->ACLineStatus = '\x01';
    if (local_37 != '\0') {
      lpSystemPowerStatus->ACLineStatus = lpSystemPowerStatus->ACLineStatus & -(local_38 != '\0');
    }
    if (local_36 != '\0') {
      lpSystemPowerStatus->BatteryFlag = lpSystemPowerStatus->BatteryFlag | 8;
    }
    if (local_37 == '\0') {
      lpSystemPowerStatus->BatteryFlag = lpSystemPowerStatus->BatteryFlag | 0x80;
    }
    lpSystemPowerStatus->BatteryLifePercent = 0xff;
    if (local_30 != 0) {
      if (local_30 < local_2c) {
        bVar3 = 100;
      }
      else {
        bVar3 = (byte)((local_2c * 100 + (local_30 >> 1)) / local_30);
      }
      lpSystemPowerStatus->BatteryLifePercent = bVar3;
      if (bVar3 < 0x43) {
        if (bVar3 < 0x21) {
          bVar1 = lpSystemPowerStatus->BatteryFlag;
          lpSystemPowerStatus->BatteryFlag = bVar1 | 2;
          if (bVar3 < 5) {
            lpSystemPowerStatus->BatteryFlag = bVar1 | 6;
          }
        }
      }
      else {
        lpSystemPowerStatus->BatteryFlag = lpSystemPowerStatus->BatteryFlag | 1;
      }
    }
    lpSystemPowerStatus->BatteryFullLifeTime = 0xffffffff;
    DVar4 = 0xffffffff;
    if (local_24 != 0) {
      DVar4 = local_24;
    }
    lpSystemPowerStatus->BatteryLifeTime = DVar4;
    if (local_37 == '\0') goto LAB_180017c5f;
    local_50 = &local_48;
    local_48 = 8;
    local_58 = local_40;
    iVar2 = NtQueryWnfStateData(&DAT_180088278,0,0,local_44);
    if (-1 < iVar2) {
      if ((local_40[0] & 2) != 0) {
        lpSystemPowerStatus->Reserved1 = '\x01';
      }
      goto LAB_180017c5f;
    }
  }
  BaseSetLastNTError();
LAB_180017c5f:
  __security_check_cookie(local_18 ^ (ulonglong)auStack120);
  return extraout_EAX;
}



LONG _llseek(HFILE hFile,LONG lOffset,int iOrigin)

{
  DWORD DVar1;
  
                    // 0x17c90  1598  _llseek
  DVar1 = 0;
  if (iOrigin != 0) {
    if (iOrigin == 1) {
      DVar1 = 1;
    }
    else {
      if (iOrigin != 2) {
        return -1;
      }
      DVar1 = 2;
    }
  }
                    // WARNING: Could not recover jumptable at 0x000180017c9e. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = SetFilePointer((HANDLE)(longlong)hFile,lOffset,(PLONG)0x0,DVar1);
  return DVar1;
}



UINT _hread(HFILE hFile,LPVOID lpBuffer,UINT uBytes)

{
  BOOL BVar1;
  UINT UVar2;
  UINT local_res8 [8];
  
                    // 0x17cc0  1594  _hread
                    // 0x17cc0  1601  _lread
  BVar1 = ReadFile((HANDLE)(longlong)hFile,lpBuffer,uBytes,local_res8,(LPOVERLAPPED)0x0);
  UVar2 = 0xffffffff;
  if (BVar1 != 0) {
    UVar2 = local_res8[0];
  }
  return UVar2;
}



DWORD GetLogicalDriveStringsA(DWORD nBufferLength,LPSTR lpBuffer)

{
  bool bVar1;
  DWORD DVar2;
  DWORD DVar3;
  uint uVar4;
  undefined local_28 [2];
  ushort local_26;
  char *local_20;
  
                    // 0x17d00  624  GetLogicalDriveStringsA
  DVar3 = 0;
  bVar1 = false;
  RtlInitAnsiString(local_28);
  DVar2 = GetLogicalDrives();
  uVar4 = 0;
  do {
    *local_20 = (char)uVar4 + 'A';
    if ((DVar2 >> (uVar4 & 0x1f) & 1) != 0) {
      DVar3 = DVar3 + local_26;
      if (DVar3 < (nBufferLength & 0xffff)) {
        memcpy(lpBuffer,local_20,(ulonglong)local_26);
        lpBuffer = lpBuffer + local_26;
        *lpBuffer = '\0';
      }
      else {
        bVar1 = true;
      }
    }
    uVar4 = uVar4 + 1;
  } while ((int)uVar4 < 0x1a);
  DVar2 = DVar3 + 1;
  if (!bVar1) {
    DVar2 = DVar3;
  }
  return DVar2;
}



DWORD GetLogicalDrives(void)

{
  int iVar1;
  DWORD local_38 [14];
  
                    // 0x17dc0  626  GetLogicalDrives
  iVar1 = NtQueryInformationProcess(0xffffffffffffffff,0x17,local_38,0x24,0);
  if (iVar1 < 0) {
    BaseSetLastNTError();
    local_38[0] = 0;
  }
  else if (local_38[0] == 0) {
    RtlSetLastWin32Error(0);
  }
  return local_38[0];
}



HGLOBAL GlobalAlloc(UINT uFlags,SIZE_T dwBytes)

{
  HGLOBAL pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180017e10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x17e10  826  GlobalAlloc
  pvVar1 = GlobalAlloc(uFlags,dwBytes);
  return pvVar1;
}



SIZE_T GlobalSize(HGLOBAL hMem)

{
  char cVar1;
  SIZE_T SVar2;
  undefined8 *puVar3;
  uint local_res10 [2];
  undefined8 *local_res18;
  
                    // 0x17e30  841  GlobalSize
  SVar2 = 0xffffffffffffffff;
  RtlLockHeap(DAT_1800b2a30);
  puVar3 = (undefined8 *)hMem;
  if (((ulonglong)hMem & 8) == 0) {
    local_res18 = (undefined8 *)0x0;
    local_res10[0] = 0x800;
    cVar1 = RtlGetUserInfoHeap(DAT_1800b2a30,0x800,hMem,&local_res18,local_res10);
    if ((cVar1 != '\0') &&
       ((local_res18 == (undefined8 *)0x0 || (puVar3 = local_res18, (local_res10[0] & 0x200) == 0)))
       ) {
      SVar2 = RtlSizeHeap(DAT_1800b2a30,1,hMem);
      puVar3 = (undefined8 *)hMem;
    }
    if (((ulonglong)puVar3 & 8) == 0) goto LAB_180017f43;
  }
  cVar1 = RtlIsValidHandle(DAT_1800b2a20,puVar3 + -1);
  if (cVar1 == '\0') {
    RtlSetLastWin32Error(6);
  }
  else if ((*(byte *)(puVar3 + -1) & 8) == 0) {
    SVar2 = RtlSizeHeap(DAT_1800b2a30,1,*puVar3);
  }
  else {
    SVar2 = (SIZE_T)*(uint *)puVar3;
  }
LAB_180017f43:
  RtlUnlockHeap(DAT_1800b2a30);
  if (SVar2 == 0xffffffffffffffff) {
    RtlSetLastWin32Error(6);
    SVar2 = 0;
  }
  return SVar2;
}



void LoadAppInitDlls(void)

{
  bool bVar1;
  int iVar2;
  LSTATUS LVar3;
  undefined7 extraout_var;
  undefined8 uVar4;
  longlong in_GS_OFFSET;
  uint local_res8 [2];
  DWORD local_res10 [2];
  int local_res18 [2];
  HKEY local_res20;
  
                    // 0x17f90  967  LoadAppInitDlls
  if ((((DAT_7ffe02ec == '\0') && ((*(byte *)(*(longlong *)(in_GS_OFFSET + 0x60) + 3) & 2) == 0)) &&
      ((((*(byte *)(*(longlong *)(in_GS_OFFSET + 0x60) + 3) & 0x10) == 0 &&
        ((DAT_7ffe02f0 & 0x80) == 0)) || (uVar4 = FUN_1800183f8(), (int)uVar4 != 0)))) &&
     ((((iVar2 = FUN_1800180a8(local_res8), iVar2 == 0 || (local_res8[0] == 0)) &&
       ((bVar1 = FUN_18001839c(local_res8), (int)CONCAT71(extraout_var,bVar1) == 0 ||
        (local_res8[0] == 0)))) &&
      (LVar3 = RegOpenKeyExW((HKEY)0xffffffff80000002,
                             L"Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows",0,0x20019,
                             &local_res20), LVar3 == 0)))) {
    local_res10[0] = 4;
    LVar3 = RegGetValueW(local_res20,(LPCWSTR)0x0,L"LoadAppInit_DLLs",0x10,(LPDWORD)0x0,local_res18,
                         local_res10);
    if ((LVar3 == 0) && (local_res18[0] != 0)) {
      FUN_1800366d4(local_res20);
    }
    RegCloseKey(local_res20);
  }
  return;
}



void FUN_1800180a8(undefined4 *param_1)

{
  BOOL BVar1;
  HANDLE ProcessHandle;
  longlong lVar2;
  PSID pvVar3;
  DWORD *pDVar4;
  uint uVar5;
  undefined4 uVar6;
  longlong in_GS_OFFSET;
  undefined auStackY296 [32];
  PSID local_c8;
  int local_c0;
  DWORD local_bc;
  DWORD local_b8 [2];
  HANDLE local_b0;
  HANDLE local_a8;
  undefined local_a0 [40];
  GENERIC_MAPPING local_78;
  _PRIVILEGE_SET local_68 [2];
  ulonglong local_30;
  
  local_30 = DAT_1800b2220 ^ (ulonglong)auStackY296;
  local_bc = 0;
  local_c8 = (PSID)0x0;
  local_c0 = 0;
  local_b0 = (HANDLE)0x0;
  local_a8 = (HANDLE)0x0;
  ProcessHandle = GetCurrentProcess();
  BVar1 = OpenProcessToken(ProcessHandle,10,&local_a8);
  if (((BVar1 != 0) &&
      (BVar1 = DuplicateToken(local_a8,SecurityImpersonation,&local_b0), BVar1 != 0)) &&
     (lVar2 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,0x198),
     lVar2 != 0)) {
    RtlCreateAcl(lVar2,0x198,2);
    uVar5 = 0;
    pDVar4 = &DAT_1800b226c;
    uVar6 = 1;
    do {
      if (local_c8 != (PSID)0x0) {
        FreeSid(local_c8);
        local_c8 = (PSID)0x0;
      }
      BVar1 = AllocateAndInitializeSid
                        ((PSID_IDENTIFIER_AUTHORITY)&DAT_1800b2240,*(BYTE *)(pDVar4 + -7),pDVar4[-6]
                         ,pDVar4[-5],pDVar4[-4],pDVar4[-3],pDVar4[-2],pDVar4[-1],*pDVar4,pDVar4[1],
                         &local_c8);
      if (BVar1 == 0) goto LAB_1800182f8;
      RtlAddAccessAllowedAce(lVar2);
      uVar5 = uVar5 + 1;
      pDVar4 = pDVar4 + 9;
    } while (uVar5 < 5);
    RtlCreateSecurityDescriptor(local_a0,1);
    RtlSetOwnerSecurityDescriptor(local_a0,local_c8,0);
    pvVar3 = local_c8;
    RtlSetGroupSecurityDescriptor(local_a0,local_c8,0);
    RtlSetDaclSecurityDescriptor(local_a0,(ulonglong)pvVar3 & 0xffffffffffffff00 | 1,lVar2,0);
    local_78.GenericRead = 0x20001;
    local_78.GenericWrite = 0x20000;
    local_78.GenericExecute = 0x20000;
    local_78.GenericAll = 0x1f0001;
    local_b8[0] = 0x38;
    BVar1 = AccessCheck(local_a0,local_b0,1,&local_78,local_68,local_b8,&local_bc,&local_c0);
    if (BVar1 != 0) {
      if ((local_c0 == 0) || (local_bc != 1)) {
        uVar6 = 0;
      }
      *param_1 = uVar6;
    }
LAB_1800182f8:
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lVar2);
  }
  if (local_c8 != (PSID)0x0) {
    FreeSid(local_c8);
  }
  if (local_b0 != (HANDLE)0x0) {
    CloseHandle(local_b0);
  }
  if (local_a8 != (HANDLE)0x0) {
    CloseHandle(local_a8);
  }
  __security_check_cookie(local_30 ^ (ulonglong)auStackY296);
  return;
}



bool FUN_18001839c(uint *param_1)

{
  int iVar1;
  HANDLE pvVar2;
  uint local_res10 [6];
  
  pvVar2 = GetCurrentProcess();
  iVar1 = GetProcessMitigationPolicy(pvVar2,6,local_res10,4);
  if (iVar1 != 0) {
    *param_1 = local_res10[0] & 1;
  }
  return iVar1 != 0;
}



undefined8 FUN_1800183f8(void)

{
  int iVar1;
  undefined8 uVar2;
  ulonglong local_res8 [4];
  
  uVar2 = 0;
  local_res8[0] = 8;
  iVar1 = NtQuerySystemInformation(0x67,local_res8,8,0);
  if ((-1 < iVar1) && ((local_res8[0] & 0x200000000) != 0)) {
    uVar2 = 1;
  }
  return uVar2;
}



BOOL VerifyVersionInfoW(LPOSVERSIONINFOEXW lpVersionInformation,DWORD dwTypeMask,
                       DWORDLONG dwlConditionMask)

{
  int iVar1;
  undefined8 uVar2;
  
                    // 0x18450  1497  VerifyVersionInfoW
  iVar1 = RtlSwitchedVVI();
  if (iVar1 == -0x3ffffff3) {
    uVar2 = 0xa0;
  }
  else {
    if (iVar1 != -0x3fffffa7) {
      return 1;
    }
    uVar2 = 0x47e;
  }
  RtlSetLastWin32Error(uVar2);
  return 0;
}



int LCMapStringW(LCID Locale,DWORD dwMapFlags,LPCWSTR lpSrcStr,int cchSrc,LPWSTR lpDestStr,
                int cchDest)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800184a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x184a0  953  LCMapStringW
  iVar1 = LCMapStringW(Locale,dwMapFlags,lpSrcStr,cchSrc,lpDestStr,cchDest);
  return iVar1;
}



HLOCAL LocalAlloc(UINT uFlags,SIZE_T uBytes)

{
  HLOCAL pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800184c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x184c0  978  LocalAlloc
  pvVar1 = LocalAlloc(uFlags,uBytes);
  return pvVar1;
}



PVOID FlsGetValue(DWORD dwFlsIndex)

{
  PVOID pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800184e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x184e0  422  FlsGetValue
  pvVar1 = FlsGetValue(dwFlsIndex);
  return pvVar1;
}



LPVOID VirtualAlloc(LPVOID lpAddress,SIZE_T dwSize,DWORD flAllocationType,DWORD flProtect)

{
  LPVOID pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180018500. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x18500  1498  VirtualAlloc
  pvVar1 = VirtualAlloc(lpAddress,dwSize,flAllocationType,flProtect);
  return pvVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Could not reconcile some variable overlaps
// WARNING: Exceeded maximum restarts with more pending

ulonglong FUN_180018514(undefined8 param_1,LPCWSTR param_2,ulonglong param_3,undefined4 param_4)

{
  uint uVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  undefined4 local_res20 [2];
  ulonglong local_1b8;
  undefined4 local_1b0;
  undefined local_1a8 [12];
  undefined4 uStack412;
  undefined8 local_198;
  undefined local_188 [80];
  undefined4 local_138;
  ulonglong local_120;
  undefined4 local_118;
  undefined4 uStack276;
  undefined4 uStack272;
  undefined4 uStack268;
  undefined4 *local_108;
  undefined4 local_100;
  
  local_1b8 = 0;
  local_1b0 = 0;
  local_198 = 0;
  _local_1a8 = ZEXT816(0);
  local_res20[0] = param_4;
  FUN_18001188c(3,0,0xb0,0x18,(char)param_2);
  uVar2 = FUN_180018ba8(&local_1b8,param_2,param_3);
  uVar3 = uVar2 & 0xffffffff;
  if (-1 < (int)uVar2) {
    memset(local_188,0,0x178);
    local_120 = local_1b8;
    local_108 = local_res20;
    local_138 = 0x80;
    local_118 = local_1a8._8_4_;
    uStack276 = uStack412;
    uStack272 = (undefined4)local_198;
    uStack268 = local_198._4_4_;
    local_100 = 4;
    uVar1 = NtApphelpCacheControl();
    uVar3 = (ulonglong)uVar1;
  }
  FUN_180018b64((longlong *)&local_1b8);
  return uVar3;
}



void CheckElevation(uint *param_1,uint *param_2,longlong param_3,uint *param_4,undefined4 *param_5)

{
  int iVar1;
  HANDLE hObject;
  undefined8 uVar2;
  undefined auStackY200 [32];
  uint local_68 [2];
  ulonglong local_60;
  undefined4 local_58 [4];
  ulonglong local_48;
  
                    // 0x18610  125  CheckElevation
  local_48 = DAT_1800b2220 ^ (ulonglong)auStackY200;
  local_60 = 0;
  local_68[0] = 0;
  hObject = CreateFileW((LPCWSTR)param_1,0x80000000,5,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0x0)
  ;
  if (hObject == (HANDLE)0xffffffffffffffff) {
    GetLastError();
    goto LAB_180018718;
  }
  uVar2 = BasepCheckAppCompat(hObject,(wchar_t *)param_1,&local_60,local_68);
  iVar1 = (int)uVar2;
  if (iVar1 < 0) {
LAB_180032d1d:
    RtlNtStatusToDosErrorNoTeb(iVar1);
  }
  else {
    iVar1 = FUN_180018c2c((LPCWSTR)param_1,local_58);
    if (iVar1 < 0) goto LAB_180032d1d;
    iVar1 = BaseCheckElevation(0xffffffffffffffff,(ulonglong)hObject,param_1,param_2,local_60,
                               (longlong)local_58,0,local_68[0],param_3,param_4,param_5);
    if (iVar1 < 0) goto LAB_180032d1d;
  }
  CloseHandle(hObject);
LAB_180018718:
  __security_check_cookie(local_48 ^ (ulonglong)auStackY200);
  return;
}



int BaseCheckElevation(undefined8 param_1,ulonglong param_2,uint *param_3,uint *param_4,
                      ulonglong param_5,longlong param_6,undefined8 param_7,uint param_8,
                      longlong param_9,uint *param_10,undefined4 *param_11)

{
  longlong lVar1;
  int iVar2;
  int iVar3;
  longlong lVar4;
  uint uVar5;
  uint uVar6;
  uint local_58;
  undefined4 local_54;
  uint local_50 [2];
  longlong local_48;
  longlong local_40;
  
                    // 0x18750  46  BaseCheckElevation
  local_58 = 0;
  lVar4 = 0;
  local_48 = 0;
  local_40 = 0;
  local_54 = 6;
  uVar5 = 1;
  iVar2 = RtlQueryElevationFlags(local_50);
  uVar6 = uVar5;
  if (-1 < iVar2) {
    iVar2 = 0;
    uVar6 = local_50[0] >> 2 & 1;
    uVar5 = local_50[0] & 1;
  }
  if ((iVar2 < 0) || (uVar5 == 0)) goto LAB_18001885a;
  uVar5 = *param_4;
  *param_4 = uVar5 | 2;
  if ((param_5 & 0x200000000) != 0) {
    *param_4 = uVar5 | 10;
  }
  iVar2 = FUN_18001891c(param_2,param_3,param_4,(uint)param_5,param_6,param_7,param_8,uVar6,
                        &local_58,&local_54);
  if (iVar2 < 0) goto LAB_18001885a;
  uVar6 = *param_4;
  if ((param_5 & 0x100000000) != 0) {
    uVar6 = uVar6 & 0xfffffffd;
    *param_4 = uVar6;
  }
  if (((param_5 & 0x400000000) != 0) && (local_58 == 0)) {
    local_58 = 1;
  }
  if (((uVar6 & 1) == 0) || (local_58 == 0)) goto LAB_18001885a;
  lVar1 = param_9;
  if ((param_9 == 0) &&
     (iVar2 = NtOpenProcessToken(param_1,8,&local_48), lVar1 = local_48, iVar2 < 0)) {
    if (iVar2 == -0x3fffffde) {
      iVar3 = FUN_18005e564(&local_40);
      lVar4 = local_40;
      if ((-1 < iVar3) && (local_40 != 0)) {
        iVar2 = NtOpenProcessToken(param_1,8,&local_48);
        FUN_18005e514(lVar4);
        goto LAB_180032d93;
      }
    }
    else {
LAB_180032d93:
      lVar1 = local_48;
      if (-1 < iVar2) goto LAB_1800188d6;
    }
    local_48 = 0;
  }
  else {
LAB_1800188d6:
    local_48 = lVar1;
    iVar2 = FUN_1800196ec(local_48,param_4,&local_58);
  }
  if (lVar4 != 0) {
    NtClose(lVar4);
  }
LAB_18001885a:
  if ((local_48 != 0) && (local_48 != param_9)) {
    NtClose();
  }
  if (param_10 != (uint *)0x0) {
    *param_10 = local_58;
  }
  if (param_11 != (undefined4 *)0x0) {
    *param_11 = local_54;
  }
  return iVar2;
}



int FUN_18001891c(ulonglong param_1,uint *param_2,uint *param_3,uint param_4,longlong param_5,
                 undefined8 param_6,uint param_7,int param_8,uint *param_9,undefined4 *param_10)

{
  int iVar1;
  int iVar2;
  uint *puVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint *puVar7;
  uint uVar8;
  int iVar9;
  int iVar10;
  uint local_res20 [2];
  
  iVar2 = 0;
  iVar9 = 0;
  uVar6 = 0;
  iVar10 = iVar9;
  if (param_4 != 0) {
    uVar8 = 0;
    do {
      if (((uVar8 < 3) || (uVar8 - 0x10 < 3)) && ((param_4 >> (uVar8 & 0x1f) & 1) != 0)) {
        *param_10 = 0;
        goto LAB_180018979;
      }
      uVar8 = uVar8 + 1;
    } while (uVar8 < 0x13);
  }
  uVar5 = 0;
  iVar1 = *(int *)(param_5 + 4);
  if (iVar1 == 1) {
    uVar4 = 0;
  }
  else {
    uVar4 = 1;
    if ((iVar1 != 2) && (uVar4 = 2, iVar1 != 3)) {
      uVar8 = uVar6;
      if (param_8 != 0) {
        if ((param_7 & 6) == 0) {
          if ((param_7 & 1) == 0) {
            local_res20[0] = 0;
            puVar3 = local_res20;
            puVar7 = param_2;
            iVar2 = FUN_180018a58(puVar3,param_5,(LPCWSTR)param_2,param_1);
            if (-1 < iVar2) {
              uVar5 = local_res20[0] & 1;
              iVar2 = 0;
            }
            if (iVar2 < 0) {
              iVar2 = -0x3ffffff3;
              if ((param_2 != (uint *)0x0) &&
                 (puVar3 = param_2, iVar2 = FUN_18001960c(param_2,param_6,puVar7,(int *)local_res20)
                 , -1 < iVar2)) {
                uVar5 = (uint)(local_res20[0] == 1);
              }
              iVar10 = iVar2;
              if (iVar2 < 0) goto LAB_180018979;
              FUN_180018514(puVar3,(LPCWSTR)param_2,param_1,(uint)(uVar5 != 0));
            }
            iVar10 = iVar2;
            if (uVar5 == 0) goto LAB_180018979;
            *param_10 = 3;
          }
          else {
            *param_10 = 1;
          }
          *param_3 = *param_3 | 4;
          uVar8 = 2;
          iVar10 = iVar2;
        }
        else {
          uVar8 = 0;
          if ((param_7 & 2) != 0) {
            *param_3 = *param_3 | 4;
            uVar8 = 2;
          }
          *param_10 = 0;
        }
      }
      goto LAB_180018979;
    }
  }
  iVar1 = *(int *)(param_5 + 8);
  *param_3 = *param_3 & 0xfffffff5;
  *param_10 = 2;
  uVar8 = uVar4 + 0x10;
  iVar10 = iVar2;
  if (iVar1 == 0) {
    uVar8 = uVar4;
    iVar10 = iVar9;
  }
LAB_180018979:
  *param_9 = uVar8;
  return iVar10;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Could not reconcile some variable overlaps
// WARNING: Exceeded maximum restarts with more pending

void FUN_180018a58(undefined4 *param_1,undefined8 param_2,LPCWSTR param_3,ulonglong param_4)

{
  int iVar1;
  ulonglong uVar2;
  undefined auStack504 [32];
  ulonglong local_1d8;
  undefined4 local_1d0;
  undefined local_1c8 [12];
  undefined4 uStack444;
  undefined8 local_1b8;
  undefined4 local_1a8 [6];
  ulonglong local_190;
  undefined4 local_178;
  undefined4 uStack372;
  undefined4 uStack368;
  undefined4 uStack364;
  undefined8 *local_40;
  undefined4 local_38;
  undefined8 local_28;
  undefined4 local_20;
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack504;
  local_1d8 = 0;
  local_1d0 = 0;
  local_1b8 = 0;
  local_28 = 0;
  local_20 = 0;
  _local_1c8 = ZEXT816(0);
  uVar2 = FUN_180018ba8(&local_1d8,param_3,param_4);
  if (-1 < (int)uVar2) {
    memset(local_1a8,0,0x178);
    local_190 = local_1d8;
    local_40 = &local_28;
    local_1a8[0] = 0x80;
    local_178 = local_1c8._8_4_;
    uStack372 = uStack444;
    uStack368 = (undefined4)local_1b8;
    uStack364 = local_1b8._4_4_;
    local_38 = 0xc;
    iVar1 = NtApphelpCacheControl();
    if (-1 < iVar1) {
      *param_1 = local_20;
    }
  }
  FUN_180018b64((longlong *)&local_1d8);
  __security_check_cookie(local_18 ^ (ulonglong)auStack504);
  return;
}



void FUN_180018b64(longlong *param_1)

{
  longlong in_GS_OFFSET;
  
  if ((*(int *)(param_1 + 1) != 0) && (*param_1 != 0)) {
    FUN_1800706f4();
  }
  if (param_1[2] != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
  }
  return;
}



ulonglong FUN_180018ba8(ulonglong *param_1,LPCWSTR param_2,ulonglong param_3)

{
  uint uVar1;
  int iVar2;
  undefined4 extraout_var;
  ulonglong uVar3;
  undefined4 extraout_var_00;
  
  uVar3 = 0;
  if (param_3 != 0xffffffffffffffff) {
    uVar3 = param_3;
  }
  if (uVar3 == 0) {
    iVar2 = FUN_18007076c(param_1,(longlong)param_2);
    if (iVar2 < 0) {
      return CONCAT44(extraout_var_00,iVar2);
    }
    uVar1 = (uint)(*param_1 != 0);
  }
  else {
    *param_1 = uVar3;
    uVar1 = 0;
  }
  *(uint *)(param_1 + 1) = uVar1;
  if (*param_1 == 0) {
    uVar3 = 0xc0000225;
  }
  else {
    uVar1 = FUN_18000e3d0((wchar_t **)(param_1 + 2),param_2);
    uVar3 = CONCAT44(extraout_var,uVar1);
    if (-1 < (int)uVar1) {
      uVar1 = RtlInitUnicodeStringEx(param_1 + 3,param_1[2]);
      uVar3 = (ulonglong)uVar1;
      if (-1 < (int)uVar1) {
        uVar3 = 0;
      }
    }
  }
  return uVar3;
}



int FUN_180018c2c(LPCWSTR param_1,undefined4 *param_2)

{
  BOOL BVar1;
  HANDLE hActCtx;
  int iVar2;
  longlong in_GS_OFFSET;
  SIZE_T local_res8;
  undefined local_48 [32];
  LPCWSTR local_28;
  undefined local_20 [16];
  
  iVar2 = 0;
  *param_2 = 0;
  param_2[1] = 0;
  param_2[2] = 0;
  local_48._16_16_ = ZEXT816(0);
  local_48._0_4_ = 0x38;
  local_20 = ZEXT816(0);
  local_28 = (LPCWSTR)0x1;
  local_48._4_4_ = 8;
  local_48._8_8_ = param_1;
  hActCtx = CreateActCtxW((PCACTCTXW)local_48);
  if (hActCtx == (HANDLE)0xffffffffffffffff) {
    iVar2 = *(int *)(*(longlong *)(in_GS_OFFSET + 0x30) + 0x1250);
    if (((iVar2 == -0x3ffffff3) || (iVar2 == -0x3fffffe9)) ||
       ((-0x3fffffce < iVar2 &&
        (((iVar2 < -0x3fffffcb || (iVar2 == -0x3fffff85)) ||
         ((-0x3fffff78 < iVar2 &&
          ((iVar2 < -0x3fffff74 || ((-0x3feb0000 < iVar2 && (iVar2 < -0x3feafffd)))))))))))) {
      iVar2 = 0;
    }
  }
  else {
    BVar1 = QueryActCtxW(0x80000000,hActCtx,(PVOID)0x0,5,param_2,0xc,&local_res8);
    if (BVar1 == 0) {
      iVar2 = *(int *)(*(longlong *)(in_GS_OFFSET + 0x30) + 0x1250);
    }
    ReleaseActCtx(hActCtx);
  }
  return iVar2;
}



undefined8
BasepCheckAppCompat(undefined8 param_1,wchar_t *param_2,undefined8 *param_3,undefined4 *param_4)

{
  undefined4 *puVar1;
  short *psVar2;
  undefined8 uVar3;
  undefined4 uVar4;
  undefined8 uVar5;
  wchar_t *pwVar6;
  short local_res18 [4];
  undefined4 local_res20 [2];
  undefined8 in_stack_ffffffffffffffa0;
  undefined8 in_stack_ffffffffffffffb8;
  undefined8 in_stack_ffffffffffffffc0;
  uint in_stack_ffffffffffffffd0;
  undefined4 local_28 [2];
  undefined8 local_20;
  
                    // 0x18d00  80  BasepCheckAppCompat
  uVar5 = 0;
  local_res18[0] = 0;
  uVar4 = 0;
  local_28[0] = 0;
  local_res20[0] = 0;
  local_20 = 0;
  psVar2 = local_res18;
  uVar3 = param_1;
  pwVar6 = param_2;
  puVar1 = param_4;
  BasepGetExeArchType(psVar2,param_1,param_2);
  puVar1 = FUN_180018dbc(psVar2,uVar3,(ulonglong)pwVar6,(ulonglong)puVar1,local_28,&local_20,
                         local_res20,in_stack_ffffffffffffffa0,param_2,param_1,
                         in_stack_ffffffffffffffb8,in_stack_ffffffffffffffc0,local_res18[0],
                         in_stack_ffffffffffffffd0);
  if (-1 < (int)puVar1) {
    uVar5 = local_20;
    uVar4 = local_res20[0];
  }
  *param_3 = uVar5;
  *param_4 = uVar4;
  return 0;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Could not reconcile some variable overlaps
// WARNING: Exceeded maximum restarts with more pending

undefined4 *
FUN_180018dbc(undefined8 param_1,undefined8 param_2,ulonglong param_3,ulonglong param_4,
             undefined4 *param_5,undefined8 *param_6,undefined4 *param_7,undefined8 param_8,
             wchar_t *param_9,undefined8 param_10,undefined8 param_11,undefined8 param_12,
             undefined2 param_13,uint param_14)

{
  wchar_t *pwVar1;
  undefined4 *puVar2;
  LPVOID pvVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  LPVOID pvVar7;
  undefined4 *puVar8;
  longlong lVar9;
  undefined4 *puVar10;
  size_t sVar11;
  undefined4 *puVar12;
  undefined4 *puVar13;
  undefined4 *puVar14;
  ulonglong uVar15;
  LPVOID lpMem;
  undefined4 *puVar16;
  undefined4 uVar17;
  undefined4 uVar19;
  longlong in_GS_OFFSET;
  ulonglong local_res18;
  ulonglong local_res20;
  undefined local_1f8 [16];
  undefined4 *local_1e8;
  LPVOID pvStack464;
  undefined4 local_1c8;
  uint local_1c4;
  undefined8 local_1b0;
  undefined8 local_1a8;
  undefined2 local_1a0;
  undefined local_198 [16];
  longlong local_188;
  undefined4 local_180;
  LPVOID local_60;
  uint local_58;
  undefined4 uVar18;
  
  lpMem = (LPVOID)0x0;
  local_res18 = param_3;
  local_res20 = param_4;
  local_1f8._0_8_ = GetProcessHeap();
  pwVar1 = param_9;
  local_1f8 = ZEXT816(local_1f8._0_8_);
  pvStack464 = (LPVOID)0x0;
  if (param_9 == (wchar_t *)0x0) {
    puVar16 = (undefined4 *)0xc000000d;
    goto LAB_1800191ed;
  }
  memset(&local_1c8,0,0x178);
  local_1b0 = param_10;
  param_9 = (wchar_t *)0x0;
  local_res18 = local_res18 & 0xffffffff00000000;
  local_res20 = local_res20 & 0xffffffff00000000;
  param_14 = 0;
  local_1c8 = 0x1f;
  local_1a8 = 0;
  uVar4 = RtlCreateEnvironmentEx(0,&local_188,0);
  puVar16 = (undefined4 *)(ulonglong)uVar4;
  pvVar7 = (LPVOID)0x0;
  if (-1 < (int)uVar4) {
    local_180 = RtlSizeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_188);
    local_1a0 = param_13;
    local_1c4 = 0;
    iVar5 = FUN_18000eb88(&param_14,pwVar1);
    if ((-1 < iVar5) && (param_14 != 0)) {
      local_1c4 = local_1c4 | 2;
    }
    iVar5 = FUN_18000edb4((undefined4 *)&local_res20,pwVar1);
    if ((-1 < iVar5) && ((int)local_res20 != 0)) {
      local_1c4 = local_1c4 | 4;
    }
    uVar4 = FUN_18000e3d0(&param_9,pwVar1);
    puVar16 = (undefined4 *)(ulonglong)uVar4;
    pvVar7 = lpMem;
    if (-1 < (int)uVar4) {
      uVar4 = RtlInitUnicodeStringEx(local_198);
      puVar16 = (undefined4 *)(ulonglong)uVar4;
      if (-1 < (int)uVar4) {
        iVar5 = FUN_18000e84c((uint *)&local_res18,param_9);
        if ((-1 < iVar5) && ((int)local_res18 != 0)) {
          local_1c4 = local_1c4 | 8;
        }
        local_1e8 = (undefined4 *)0x0;
        local_1f8._8_8_ = (undefined4 *)0x0;
        lpMem = pvStack464;
        uVar4 = 0x1000;
        pvStack464 = (LPVOID)0x0;
        do {
          puVar12 = (undefined4 *)(ulonglong)uVar4;
          pvVar7 = lpMem;
          puVar13 = local_1e8;
          pvVar3 = pvStack464;
          if (local_1e8 < puVar12) {
            if ((undefined4 *)((longlong)puVar12 + 0xfffU) < puVar12) {
              puVar16 = (undefined4 *)0x8000000b;
            }
            else {
              puVar13 = (undefined4 *)
                        ((ulonglong)(undefined4 *)((longlong)puVar12 + 0xfffU) & 0xfffffffffffff000)
              ;
              if (lpMem == (LPVOID)0x0) {
                pvVar7 = HeapAlloc(local_1f8._0_8_,0,(SIZE_T)puVar13);
                if (pvVar7 != (LPVOID)0x0) {
                  memset(pvVar7,0,(size_t)puVar13);
                }
              }
              else {
                pvVar7 = HeapReAlloc(local_1f8._0_8_,0,lpMem,(SIZE_T)puVar13);
              }
              pvVar3 = pvVar7;
              if (pvVar7 != (LPVOID)0x0) goto LAB_180018fa6;
              puVar16 = (undefined4 *)0x8007000e;
            }
          }
          else {
LAB_180018fa6:
            pvStack464 = pvVar3;
            local_1f8 = ZEXT1216(CONCAT48(uVar4,local_1f8._0_8_));
            puVar16 = (undefined4 *)0x0;
            local_1f8._8_8_ = puVar12;
            lpMem = pvVar7;
            local_1e8 = puVar13;
          }
          pvVar7 = pvStack464;
          if ((int)puVar16 < 0) goto LAB_1800191af;
          local_60 = lpMem;
          local_58 = uVar4;
          uVar6 = NtApphelpCacheControl();
          uVar4 = local_58;
        } while (uVar6 == 0xc0000023);
        puVar13 = (undefined4 *)0x0;
        puVar16 = (undefined4 *)(ulonglong)uVar6;
        if (-1 < (int)uVar6) {
          puVar12 = (undefined4 *)(ulonglong)local_58;
          pvVar7 = lpMem;
          pvVar3 = pvStack464;
          if (local_1e8 < puVar12) {
            if ((undefined4 *)((longlong)puVar12 + 0xfffU) < puVar12) {
              puVar16 = (undefined4 *)0x8000000b;
            }
            else {
              uVar15 = (ulonglong)(undefined4 *)((longlong)puVar12 + 0xfffU) & 0xfffffffffffff000;
              if (lpMem == (LPVOID)0x0) {
                pvVar7 = HeapAlloc(local_1f8._0_8_,0,uVar15);
                if (pvVar7 != (LPVOID)0x0) {
                  memset(pvVar7,0,uVar15);
                }
              }
              else {
                pvVar7 = HeapReAlloc(local_1f8._0_8_,0,lpMem,uVar15);
              }
              pvVar3 = pvVar7;
              if (pvVar7 != (LPVOID)0x0) goto LAB_180019002;
              puVar16 = (undefined4 *)0x8007000e;
            }
          }
          else {
LAB_180019002:
            pvStack464 = pvVar3;
            local_1f8 = ZEXT1216(CONCAT48(uVar4,local_1f8._0_8_));
            puVar16 = puVar13;
            local_1f8._8_8_ = puVar12;
            lpMem = pvVar7;
          }
          pvVar7 = pvStack464;
          if (-1 < (int)puVar16) {
            if (param_5 == (undefined4 *)0x0) {
LAB_180019061:
              if (param_6 != (undefined8 *)0x0) {
                param_11 = 0;
                puVar16 = puVar13;
                do {
                  if (((local_1f8._8_8_ < puVar16) || (puVar12 = puVar16 + 2, puVar12 < puVar16)) ||
                     (local_1f8._8_8_ < puVar12)) goto LAB_1800190a4;
                  uVar15 = *(ulonglong *)((longlong)puVar16 + (longlong)lpMem);
                  puVar16 = (undefined4 *)((uVar15 >> 0x20) + (longlong)puVar12);
                  if (((puVar16 < puVar12) || ((undefined4 *)((longlong)puVar16 + 3U) < puVar16)) ||
                     (puVar16 = (undefined4 *)
                                ((ulonglong)(undefined4 *)((longlong)puVar16 + 3U) &
                                0xfffffffffffffffc), local_1f8._8_8_ < puVar16)) goto LAB_1800190a4;
                } while ((int)uVar15 != 4);
                uVar4 = (uint)(uVar15 >> 0x20);
                if (8 < uVar4) goto LAB_180032faf;
                sVar11 = 8;
                if (uVar4 < 8) {
                  sVar11 = uVar15 >> 0x20;
                }
                puVar16 = puVar13;
                if ((int)sVar11 != 0) {
                  if (((local_1f8._8_8_ < puVar12) ||
                      ((undefined4 *)((longlong)puVar12 + sVar11) < puVar12)) ||
                     (local_1f8._8_8_ < (undefined4 *)((longlong)puVar12 + sVar11))) {
                    puVar16 = (undefined4 *)0x80070057;
                  }
                  else {
                    memcpy(&param_11,(void *)((longlong)puVar12 + (longlong)lpMem),sVar11);
                  }
                }
                if ((int)puVar16 < 0) goto LAB_1800191af;
LAB_1800190a4:
                *param_6 = param_11;
              }
              puVar12 = puVar13;
              if (param_7 != (undefined4 *)0x0) {
                uVar17 = 0;
                uVar18 = 0;
                param_12 = 0;
                puVar16 = puVar13;
                do {
                  uVar19 = uVar17;
                  if (((local_1f8._8_8_ < puVar16) || (puVar8 = puVar16 + 2, puVar8 < puVar16)) ||
                     (local_1f8._8_8_ < puVar8)) goto LAB_1800190ea;
                  uVar15 = *(ulonglong *)((longlong)puVar16 + (longlong)lpMem);
                  puVar16 = (undefined4 *)((uVar15 >> 0x20) + (longlong)puVar8);
                  uVar19 = uVar18;
                  if (((puVar16 < puVar8) || ((undefined4 *)((longlong)puVar16 + 3U) < puVar16)) ||
                     (puVar16 = (undefined4 *)
                                ((ulonglong)(undefined4 *)((longlong)puVar16 + 3U) &
                                0xfffffffffffffffc), local_1f8._8_8_ < puVar16)) goto LAB_1800190ea;
                } while ((int)uVar15 != 0x10);
                uVar4 = (uint)(uVar15 >> 0x20);
                if (8 < uVar4) goto LAB_180032faf;
                sVar11 = 8;
                if (uVar4 < 8) {
                  sVar11 = uVar15 >> 0x20;
                }
                puVar16 = puVar13;
                if ((int)sVar11 != 0) {
                  if (((local_1f8._8_8_ < puVar8) ||
                      ((undefined4 *)((longlong)puVar8 + sVar11) < puVar8)) ||
                     (local_1f8._8_8_ < (undefined4 *)((longlong)puVar8 + sVar11))) {
                    puVar16 = (undefined4 *)0x80070057;
                  }
                  else {
                    memcpy(&param_12,(void *)((longlong)puVar8 + (longlong)lpMem),sVar11);
                  }
                }
                uVar19 = (undefined4)param_12;
                if ((int)puVar16 < 0) goto LAB_1800191af;
LAB_1800190ea:
                *param_7 = uVar19;
              }
              do {
                puVar16 = puVar13;
                puVar8 = puVar13;
                if (((local_1f8._8_8_ < puVar12) || (puVar2 = puVar12 + 2, puVar2 < puVar12)) ||
                   (local_1f8._8_8_ < puVar2)) goto LAB_18001914a;
                uVar15 = *(ulonglong *)((longlong)puVar12 + (longlong)lpMem);
                puVar12 = (undefined4 *)((uVar15 >> 0x20) + (longlong)puVar2);
                if (((puVar12 < puVar2) || ((undefined4 *)((longlong)puVar12 + 3U) < puVar12)) ||
                   (puVar12 = (undefined4 *)
                              ((ulonglong)(undefined4 *)((longlong)puVar12 + 3U) &
                              0xfffffffffffffffc), local_1f8._8_8_ < puVar12)) goto LAB_18001914a;
              } while ((int)uVar15 != 1);
              if ((int)(uVar15 >> 0x20) == 0x1c8) {
                puVar8 = (undefined4 *)
                         RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30))
                ;
                if (puVar8 == (undefined4 *)0x0) {
                  puVar16 = (undefined4 *)0xc0000017;
                  lpMem = pvStack464;
                  goto LAB_1800191af;
                }
                lVar9 = 3;
                puVar12 = puVar8;
                puVar2 = (undefined4 *)((longlong)puVar2 + (longlong)lpMem);
                do {
                  puVar14 = puVar2;
                  puVar10 = puVar12;
                  uVar18 = puVar14[1];
                  uVar17 = puVar14[2];
                  uVar19 = puVar14[3];
                  *puVar10 = *puVar14;
                  puVar10[1] = uVar18;
                  puVar10[2] = uVar17;
                  puVar10[3] = uVar19;
                  uVar18 = puVar14[5];
                  uVar17 = puVar14[6];
                  uVar19 = puVar14[7];
                  puVar10[4] = puVar14[4];
                  puVar10[5] = uVar18;
                  puVar10[6] = uVar17;
                  puVar10[7] = uVar19;
                  uVar18 = puVar14[9];
                  uVar17 = puVar14[10];
                  uVar19 = puVar14[0xb];
                  puVar10[8] = puVar14[8];
                  puVar10[9] = uVar18;
                  puVar10[10] = uVar17;
                  puVar10[0xb] = uVar19;
                  uVar18 = puVar14[0xd];
                  uVar17 = puVar14[0xe];
                  uVar19 = puVar14[0xf];
                  puVar10[0xc] = puVar14[0xc];
                  puVar10[0xd] = uVar18;
                  puVar10[0xe] = uVar17;
                  puVar10[0xf] = uVar19;
                  uVar18 = puVar14[0x11];
                  uVar17 = puVar14[0x12];
                  uVar19 = puVar14[0x13];
                  puVar10[0x10] = puVar14[0x10];
                  puVar10[0x11] = uVar18;
                  puVar10[0x12] = uVar17;
                  puVar10[0x13] = uVar19;
                  uVar18 = puVar14[0x15];
                  uVar17 = puVar14[0x16];
                  uVar19 = puVar14[0x17];
                  puVar10[0x14] = puVar14[0x14];
                  puVar10[0x15] = uVar18;
                  puVar10[0x16] = uVar17;
                  puVar10[0x17] = uVar19;
                  uVar18 = puVar14[0x19];
                  uVar17 = puVar14[0x1a];
                  uVar19 = puVar14[0x1b];
                  puVar10[0x18] = puVar14[0x18];
                  puVar10[0x19] = uVar18;
                  puVar10[0x1a] = uVar17;
                  puVar10[0x1b] = uVar19;
                  uVar18 = puVar14[0x1d];
                  uVar17 = puVar14[0x1e];
                  uVar19 = puVar14[0x1f];
                  puVar10[0x1c] = puVar14[0x1c];
                  puVar10[0x1d] = uVar18;
                  puVar10[0x1e] = uVar17;
                  puVar10[0x1f] = uVar19;
                  lVar9 = lVar9 + -1;
                  puVar12 = puVar10 + 0x20;
                  puVar2 = puVar14 + 0x20;
                } while (lVar9 != 0);
                uVar18 = puVar14[0x21];
                uVar17 = puVar14[0x22];
                uVar19 = puVar14[0x23];
                puVar10[0x20] = puVar14[0x20];
                puVar10[0x21] = uVar18;
                puVar10[0x22] = uVar17;
                puVar10[0x23] = uVar19;
                uVar18 = puVar14[0x25];
                uVar17 = puVar14[0x26];
                uVar19 = puVar14[0x27];
                puVar10[0x24] = puVar14[0x24];
                puVar10[0x25] = uVar18;
                puVar10[0x26] = uVar17;
                puVar10[0x27] = uVar19;
                uVar18 = puVar14[0x29];
                uVar17 = puVar14[0x2a];
                uVar19 = puVar14[0x2b];
                puVar10[0x28] = puVar14[0x28];
                puVar10[0x29] = uVar18;
                puVar10[0x2a] = uVar17;
                puVar10[0x2b] = uVar19;
                uVar18 = puVar14[0x2d];
                uVar17 = puVar14[0x2e];
                uVar19 = puVar14[0x2f];
                puVar10[0x2c] = puVar14[0x2c];
                puVar10[0x2d] = uVar18;
                puVar10[0x2e] = uVar17;
                puVar10[0x2f] = uVar19;
                *(undefined8 *)(puVar10 + 0x30) = *(undefined8 *)(puVar14 + 0x30);
                lpMem = pvStack464;
              }
LAB_18001914a:
              do {
                puVar12 = puVar13;
                if (((local_1f8._8_8_ < puVar16) || (puVar2 = puVar16 + 2, puVar2 < puVar16)) ||
                   (local_1f8._8_8_ < puVar2)) goto LAB_18001919d;
                uVar15 = *(ulonglong *)((longlong)puVar16 + (longlong)lpMem);
                puVar16 = (undefined4 *)((uVar15 >> 0x20) + (longlong)puVar2);
                if (((puVar16 < puVar2) || ((undefined4 *)((longlong)puVar16 + 3U) < puVar16)) ||
                   (puVar16 = (undefined4 *)
                              ((ulonglong)(undefined4 *)((longlong)puVar16 + 3U) &
                              0xfffffffffffffffc), local_1f8._8_8_ < puVar16)) goto LAB_18001919d;
              } while ((int)uVar15 != 2);
              if ((int)(uVar15 >> 0x20) != 0) {
                puVar12 = (undefined4 *)
                          RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30)
                                          ,8,uVar15 >> 0x20);
                if (puVar12 == (undefined4 *)0x0) {
                  puVar13 = (undefined4 *)0xc0000017;
                  lpMem = pvStack464;
                }
                else {
                  memcpy(puVar12,(void *)((longlong)puVar2 + (longlong)lpMem),uVar15 >> 0x20);
                  lpMem = pvStack464;
                }
              }
LAB_18001919d:
              if (puVar8 != (undefined4 *)0x0) {
                RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar8);
                lpMem = pvStack464;
              }
              puVar16 = puVar13;
              if (puVar12 != (undefined4 *)0x0) {
                RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar12);
                lpMem = pvStack464;
              }
            }
            else {
              uVar17 = 0;
              uVar18 = 0;
              param_8 = 0;
              puVar16 = puVar13;
              do {
                uVar19 = uVar17;
                if (((local_1f8._8_8_ < puVar16) || (puVar12 = puVar16 + 2, puVar12 < puVar16)) ||
                   (local_1f8._8_8_ < puVar12)) goto LAB_18001905e;
                uVar15 = *(ulonglong *)((longlong)puVar16 + (longlong)lpMem);
                puVar16 = (undefined4 *)((uVar15 >> 0x20) + (longlong)puVar12);
                uVar19 = uVar18;
                if (((puVar16 < puVar12) || ((undefined4 *)((longlong)puVar16 + 3U) < puVar16)) ||
                   (puVar16 = (undefined4 *)
                              ((ulonglong)(undefined4 *)((longlong)puVar16 + 3U) &
                              0xfffffffffffffffc), local_1f8._8_8_ < puVar16)) goto LAB_18001905e;
              } while ((int)uVar15 != 8);
              uVar4 = (uint)(uVar15 >> 0x20);
              if (uVar4 < 9) {
                sVar11 = 8;
                if (uVar4 < 8) {
                  sVar11 = uVar15 >> 0x20;
                }
                puVar16 = puVar13;
                if ((int)sVar11 != 0) {
                  if (((local_1f8._8_8_ < puVar12) ||
                      ((undefined4 *)((longlong)puVar12 + sVar11) < puVar12)) ||
                     (local_1f8._8_8_ < (undefined4 *)((longlong)puVar12 + sVar11))) {
                    puVar16 = (undefined4 *)0x80070057;
                  }
                  else {
                    memcpy(&param_8,(void *)((longlong)puVar12 + (longlong)lpMem),sVar11);
                  }
                }
                uVar19 = (undefined4)param_8;
                if ((int)puVar16 < 0) goto LAB_1800191af;
LAB_18001905e:
                *param_5 = uVar19;
                goto LAB_180019061;
              }
LAB_180032faf:
              puVar16 = (undefined4 *)0xc0000095;
            }
          }
        }
      }
    }
LAB_1800191af:
    pvStack464 = pvVar7;
    pvVar7 = lpMem;
    if (param_9 != (wchar_t *)0x0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_9);
      pvVar7 = pvStack464;
    }
  }
  pvStack464 = pvVar7;
  if (local_188 != 0) {
    RtlDestroyEnvironment();
  }
LAB_1800191ed:
  if (pvStack464 != (LPVOID)0x0) {
    HeapFree(local_1f8._0_8_,0,pvStack464);
  }
  return puVar16;
}



// WARNING: Could not reconcile some variable overlaps

int BasepGetExeArchType(short *param_1,undefined8 param_2,undefined8 param_3)

{
  int iVar1;
  short sVar2;
  uint local_res8 [2];
  int local_res20 [2];
  undefined8 in_stack_ffffffffffffff28;
  undefined4 uVar3;
  undefined8 in_stack_ffffffffffffff30;
  undefined4 uVar4;
  longlong local_b8;
  undefined8 local_b0;
  undefined local_a8 [16];
  undefined local_98 [16];
  undefined local_88 [16];
  undefined local_78 [16];
  undefined local_68 [48];
  short local_38;
  byte local_35;
  
  uVar3 = (undefined4)((ulonglong)in_stack_ffffffffffffff28 >> 0x20);
                    // 0x194e0  90  BasepGetExeArchType
  uVar4 = (undefined4)((ulonglong)in_stack_ffffffffffffff30 >> 0x20);
  memset(local_68,0,0x40);
  local_98 = ZEXT816(0);
  local_b8 = 0;
  local_88 = ZEXT816(0);
  local_res8[0] = 0;
  local_78 = ZEXT816(0);
  local_b0 = 0;
  local_a8 = ZEXT816(0);
  local_res20[0] = 0;
  RtlInitUnicodeString(local_a8,param_3);
  iVar1 = NtCreateSection(&local_b8,1,0,0,CONCAT44(uVar3,2),CONCAT44(uVar4,0x11000000),param_2);
  sVar2 = 0;
  if (iVar1 < 0) goto LAB_1800195c0;
  uVar3 = 0;
  iVar1 = NtQuerySection(local_b8,1,local_68,0x40,0);
  if (iVar1 < 0) goto LAB_1800195c0;
  if ((local_38 == 0x14c) && ((local_35 & 1) != 0)) {
    GetSystemInfo((LPSYSTEM_INFO)local_98);
    if ((local_98._0_2_ == 9) || (local_98._0_2_ == 6)) {
      iVar1 = NtQuerySystemInformation(0x3b,local_res8,4);
      sVar2 = local_38;
      if (iVar1 < 0) goto LAB_1800195c0;
      if ((local_res8[0] & 1) != 0) {
        iVar1 = LdrOpenImageFileOptionsKey(local_a8,0,&local_b0);
        if (iVar1 < 0) {
          if (iVar1 == -0x3fffffcc) {
LAB_1800330fd:
            if (local_98._0_2_ == 6) {
              local_38 = 0x200;
            }
            else if (local_98._0_2_ == 9) {
              local_38 = -0x799c;
            }
          }
        }
        else {
          iVar1 = LdrQueryImageFileKeyOption(local_b0,L"Wow64",4,local_res20,CONCAT44(uVar3,4),0);
          if ((iVar1 == -0x3fffffcc) || ((-1 < iVar1 && (local_res20[0] != 0)))) goto LAB_1800330fd;
        }
      }
    }
  }
  iVar1 = 0;
  sVar2 = local_38;
LAB_1800195c0:
  if (local_b8 != 0) {
    NtClose();
  }
  *param_1 = sVar2;
  return iVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

undefined4 FUN_18001960c(undefined8 param_1,undefined8 param_2,undefined8 param_3,int *param_4)

{
  int iVar1;
  uint uVar2;
  undefined4 uVar3;
  undefined8 local_78 [7];
  undefined8 local_40;
  int local_1c;
  
  memset(local_78,0,0x60);
  uVar3 = 0xc0000001;
  local_40 = 0xffffffffffffffff;
  uVar2 = 0;
  local_78[0] = param_1;
  do {
    if (4 < uVar2) {
LAB_1800196b8:
      if (local_1c != 0) {
        FUN_180019dd8((longlong)local_78);
      }
      return uVar3;
    }
    iVar1 = (*(code *)(&PTR_FUN_18007fa60)[(ulonglong)uVar2 * 0xe])();
    if ((-1 < iVar1) && (*param_4 != 0)) {
      uVar3 = 0;
      goto LAB_1800196b8;
    }
    uVar2 = uVar2 + 1;
  } while( true );
}



int FUN_1800196ec(longlong param_1,uint *param_2,uint *param_3)

{
  int iVar1;
  uint local_res20 [2];
  uint local_18 [4];
  
  iVar1 = FUN_1800197d4(param_1,(int *)local_res20);
  if (-1 < iVar1) {
    iVar1 = FUN_18001976c(local_res20[0],*param_3,local_18);
    if (local_18[0] == 0) {
      if ((local_res20[0] == 0) ||
         (((local_res20[0] == 1 && (*param_3 != 0)) || (local_res20[0] - 0x10 < 3)))) {
        *param_2 = *param_2 & 0xfffffffd;
      }
      *param_3 = 0;
    }
    else {
      iVar1 = -0x3ffffbd4;
    }
  }
  return iVar1;
}



undefined4 FUN_18001976c(uint param_1,uint param_2,uint *param_3)

{
  uint uVar1;
  uint uVar2;
  undefined4 uVar3;
  
  uVar3 = 0;
  uVar2 = param_2;
  if (2 < param_2) {
    uVar2 = param_2 - 0x10;
  }
  uVar1 = param_1;
  if (2 < param_1) {
    uVar1 = param_1 - 0x10;
  }
  if (uVar1 == 0) {
    *param_3 = 0;
    uVar3 = 0;
  }
  else if (uVar1 == 1) {
    *param_3 = (uint)(uVar2 - 1 < 2);
  }
  else if (uVar1 == 2) {
    *param_3 = (uint)(uVar2 == 2);
  }
  else {
    uVar3 = 0xc00000bb;
  }
  if ((param_2 - 0x10 < 3) && (2 < param_1 - 0x10)) {
    *param_3 = 1;
  }
  return uVar3;
}



int FUN_1800197d4(longlong param_1,int *param_2)

{
  int iVar1;
  int iVar2;
  longlong lVar3;
  longlong local_res8 [2];
  uint local_res18 [2];
  int local_res20 [2];
  
  lVar3 = 0;
  local_res8[0] = param_1;
  if (param_1 == 0) {
    iVar1 = NtOpenThreadToken(0xfffffffffffffffe,8,0,local_res8);
    if (iVar1 == -0x3fffff84) {
      iVar1 = NtOpenProcessToken(0xffffffffffffffff,8,local_res8);
    }
    lVar3 = local_res8[0];
    if (iVar1 < 0) {
      return iVar1;
    }
  }
  iVar1 = FUN_1800198bc(local_res8[0],local_res18,local_res20);
  if (-1 < iVar1) {
    if (local_res18[0] == 0) {
      *param_2 = 2 - (uint)(local_res20[0] != 0);
    }
    else {
      *param_2 = 0;
    }
    iVar1 = FUN_180019864(local_res8[0],local_res18);
    if ((-1 < iVar1) && (local_res18[0] != 0)) {
      iVar2 = *param_2;
      if (2 < iVar2 - 0x10U) {
        iVar2 = iVar2 + 0x10;
      }
      *param_2 = iVar2;
    }
  }
  if (lVar3 != 0) {
    NtClose(lVar3);
  }
  return iVar1;
}



void FUN_180019864(undefined8 param_1,uint *param_2)

{
  int iVar1;
  undefined4 local_res10 [2];
  int local_res18 [4];
  
  *param_2 = 0;
  local_res10[0] = 4;
  iVar1 = NtQueryInformationToken(param_1,0x1a,local_res18,4,local_res10);
  if (-1 < iVar1) {
    *param_2 = (uint)(local_res18[0] != 0);
  }
  return;
}



void FUN_1800198bc(undefined8 param_1,undefined4 *param_2,undefined4 *param_3)

{
  int iVar1;
  int local_res10 [2];
  undefined local_res18 [8];
  int local_res20 [2];
  
  *param_2 = 0;
  *param_3 = 1;
  local_res10[0] = 1;
  iVar1 = NtQueryInformationToken(param_1,0x12,local_res10,4,local_res18);
  if (iVar1 < 0) {
    return;
  }
  if (local_res10[0] != 2) {
    if (local_res10[0] != 1) {
      return;
    }
    *param_3 = 0;
    iVar1 = NtQueryInformationToken(param_1,0x14,local_res20,4,local_res18);
    if (iVar1 < 0) {
      return;
    }
    if (local_res20[0] == 0) {
      return;
    }
  }
  *param_2 = 1;
  return;
}



undefined8 FUN_180019970(LPCWSTR *param_1,undefined8 param_2,undefined4 *param_3)

{
  LPCWSTR pWVar1;
  WCHAR WVar2;
  int iVar3;
  DWORD DVar4;
  HRSRC hResInfo;
  LPCWSTR pWVar5;
  uint uVar6;
  uint uVar7;
  undefined **ppuVar8;
  
  *param_3 = 0;
  iVar3 = FUN_180019c80(param_1);
  if (iVar3 != 0) {
    uVar7 = 0;
    ppuVar8 = &PTR_u_Setup_couldn_t_decompress_the_fi_18007f4e0;
    do {
      hResInfo = FindResourceExW((HMODULE)param_1[8],(LPCWSTR)0x6,
                                 (LPCWSTR)(ulonglong)*(ushort *)((wchar_t **)ppuVar8 + -2),
                                 *(WORD *)((wchar_t **)ppuVar8 + -1));
      if (hResInfo != (HRSRC)0x0) {
        DVar4 = SizeofResource((HMODULE)param_1[8],hResInfo);
        pWVar5 = (LPCWSTR)LoadResource((HMODULE)param_1[8],hResInfo);
        pWVar1 = (LPCWSTR)((longlong)pWVar5 + (ulonglong)DVar4);
        if ((((pWVar5 != (LPCWSTR)0x0) && (pWVar5 < pWVar1)) && (param_1[1] < pWVar5)) &&
           (pWVar1 < (LPCWSTR)((longlong)param_1[1] + (longlong)param_1[10]))) {
          uVar6 = 0;
          do {
            if (*(uint *)((longlong)ppuVar8 + -0xc) <= uVar6) break;
            uVar6 = uVar6 + 1;
            pWVar5 = pWVar5 + (ulonglong)(ushort)*pWVar5 + 1;
          } while (pWVar5 < pWVar1);
          if (pWVar5 < pWVar1) {
            WVar2 = *pWVar5;
            if (((WVar2 != L'\0') && (pWVar5 + 1 + (ushort)WVar2 < pWVar1)) &&
               (((uint)(ushort)WVar2 == *(uint *)((longlong)ppuVar8 + -4) &&
                (iVar3 = _wcsnicmp(pWVar5 + 1,(wchar_t *)*ppuVar8,
                                   (ulonglong)*(uint *)((longlong)ppuVar8 + -4)), iVar3 == 0)))) {
              *param_3 = 1;
              return 0;
            }
          }
        }
      }
      uVar7 = uVar7 + 1;
      ppuVar8 = (undefined **)((wchar_t **)ppuVar8 + 3);
    } while (uVar7 < 0xc);
  }
  return 0;
}



undefined8 FUN_180019a00(LPCWSTR *param_1,undefined8 param_2,undefined4 *param_3)

{
  ulonglong _Size;
  int iVar1;
  HRSRC hResInfo;
  LPCWSTR _Buf1;
  ulonglong uVar2;
  uint uVar3;
  ulonglong *puVar4;
  uint uVar5;
  
  *param_3 = 0;
  iVar1 = FUN_180019c80(param_1);
  if (iVar1 != 0) {
    uVar5 = 0;
    puVar4 = &DAT_18007f498;
    do {
      hResInfo = FindResourceExW((HMODULE)param_1[8],(LPCWSTR)puVar4[-3],(LPCWSTR)puVar4[-2],0);
      if ((((hResInfo != (HRSRC)0x0) &&
           (_Buf1 = (LPCWSTR)LoadResource((HMODULE)param_1[8],hResInfo), _Buf1 != (LPCWSTR)0x0)) &&
          (param_1[1] <= _Buf1 && _Buf1 != param_1[1])) &&
         (_Size = *puVar4, (LPCWSTR)((_Size - (longlong)param_1[1]) + (longlong)_Buf1) < param_1[10]
         )) {
        if (*(int *)(puVar4 + -1) == 0) {
          iVar1 = memcmp(_Buf1,(void *)puVar4[1],_Size);
          if (iVar1 == 0) {
LAB_180033311:
            *param_3 = 1;
            return 0;
          }
        }
        else if ((*(int *)(puVar4 + -1) == 1) && (uVar3 = 0, _Size != 0)) {
          uVar2 = 0;
          do {
            if ((*(byte *)(uVar2 + (longlong)_Buf1) & *(byte *)(puVar4[1] + uVar2)) != 0)
            goto LAB_180033311;
            uVar3 = uVar3 + 1;
            uVar2 = (ulonglong)uVar3;
          } while (uVar2 < _Size);
        }
      }
      uVar5 = uVar5 + 1;
      puVar4 = puVar4 + 5;
    } while (uVar5 < 2);
  }
  return 0;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180019a90(LPCWSTR *param_1,undefined8 param_2,undefined4 *param_3)

{
  int iVar1;
  undefined8 uVar2;
  uint uVar3;
  ulonglong uVar4;
  undefined **ppuVar5;
  undefined auStack136 [32];
  ulonglong local_68;
  longlong local_60;
  undefined local_58 [32];
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack136;
  *param_3 = 0;
  iVar1 = FUN_180019c80(param_1);
  if (iVar1 != 0) {
    local_60 = 0;
    local_68 = 0;
    ppuVar5 = &PTR_s__data_18007f460;
    uVar4 = 0;
    do {
      uVar2 = FUN_180019ed4((longlong)param_1,*ppuVar5,&local_60,(longlong *)&local_68);
      if ((-1 < (int)uVar2) &&
         (uVar2 = FUN_180019bf0(local_60,local_68,(longlong)(&PTR_s__data_18007f460 + uVar4 * 4)),
         (int)uVar2 != 0)) goto LAB_180019bdc;
      uVar3 = (int)uVar4 + 1;
      uVar4 = (ulonglong)uVar3;
      ppuVar5 = ppuVar5 + 4;
    } while (uVar3 == 0);
    uVar2 = FUN_180019e24((longlong)param_1,(int *)&local_60);
    if (-1 < (int)uVar2) {
      uVar2 = FUN_1800011b0((longlong)param_1,(LONG)local_60,local_58,&local_68);
      if (-1 < (int)uVar2) {
        uVar4 = 0;
        do {
          uVar2 = FUN_180019bf0((longlong)local_58,local_68,
                                (longlong)(&DAT_18007f300 + uVar4 * 0x20));
          if ((int)uVar2 != 0) goto LAB_180019bdc;
          uVar3 = (int)uVar4 + 1;
          uVar4 = (ulonglong)uVar3;
        } while (uVar3 < 0xb);
      }
      uVar2 = FUN_180001114((longlong)param_1,local_58,&local_68);
      if (-1 < (int)uVar2) {
        uVar3 = 0;
        do {
          uVar2 = FUN_180019bf0((longlong)local_58,local_68,
                                (longlong)(&DAT_18007f5f0 + (ulonglong)uVar3 * 0x20));
          if ((int)uVar2 != 0) goto LAB_180019bdc;
          uVar3 = uVar3 + 1;
        } while (uVar3 < 2);
      }
    }
  }
LAB_180019ac4:
  __security_check_cookie(local_38 ^ (ulonglong)auStack136);
  return;
LAB_180019bdc:
  *param_3 = 1;
  goto LAB_180019ac4;
}



undefined8 FUN_180019bf0(longlong param_1,ulonglong param_2,longlong param_3)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  
  uVar3 = *(uint *)(param_3 + 8);
  if (uVar3 < *(uint *)(param_3 + 0xc)) {
    uVar1 = *(uint *)(param_3 + 0x10);
    uVar4 = uVar1 + uVar3;
    do {
      if (param_2 < uVar4) {
        return 0;
      }
      iVar2 = memcmp((void *)((ulonglong)uVar3 + param_1),*(void **)(param_3 + 0x18),
                     (ulonglong)uVar1);
      if (iVar2 == 0) {
        return 1;
      }
      uVar3 = uVar3 + 1;
      uVar4 = uVar4 + 1;
    } while (uVar3 < *(uint *)(param_3 + 0xc));
  }
  return 0;
}



undefined4 FUN_180019c80(LPCWSTR *param_1)

{
  undefined8 uVar1;
  
  if ((*(int *)(param_1 + 0xb) == 0) &&
     ((*(int *)((longlong)param_1 + 0x5c) != 0 ||
      ((uVar1 = FUN_180019d2c(param_1), (int)uVar1 != 0 &&
       (uVar1 = FUN_180019ce0((longlong)param_1), (int)uVar1 != 0)))))) {
    return 1;
  }
  *(undefined4 *)(param_1 + 0xb) = 1;
  if (*(int *)((longlong)param_1 + 0x5c) != 0) {
    FUN_180019dd8((longlong)param_1);
  }
  return 0;
}



undefined8 FUN_180019ce0(longlong param_1)

{
  short *psVar1;
  int *piVar2;
  
  psVar1 = *(short **)(param_1 + 8);
  if ((((*psVar1 == 0x5a4d) && (0 < *(int *)(psVar1 + 0x1e))) &&
      (piVar2 = (int *)((longlong)*(int *)(psVar1 + 0x1e) + (longlong)psVar1), *piVar2 == 0x4550))
     && (*(short *)(piVar2 + 1) == 0x14c)) {
    *(int **)(param_1 + 0x48) = piVar2;
    *(ulonglong *)(param_1 + 0x50) = (ulonglong)(uint)piVar2[0x14];
    return 1;
  }
  return 0;
}



undefined8 FUN_180019d2c(LPCWSTR *param_1)

{
  LPCWSTR pWVar1;
  HMODULE lpAddress;
  SIZE_T SVar2;
  
  pWVar1 = (LPCWSTR)CreateFileW(*param_1,0x80000000,5,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0x0)
  ;
  param_1[7] = pWVar1;
  if (pWVar1 != (LPCWSTR)0xffffffffffffffff) {
    lpAddress = LoadLibraryExW(*param_1,(HANDLE)0x0,0x22);
    param_1[8] = (LPCWSTR)lpAddress;
    if ((lpAddress != (HMODULE)0x0) &&
       (SVar2 = VirtualQuery(lpAddress,(PMEMORY_BASIC_INFORMATION)(param_1 + 1),0x30), SVar2 == 0x30
       )) {
      *(undefined4 *)((longlong)param_1 + 0x5c) = 1;
      return 1;
    }
  }
  if ((HMODULE)param_1[8] != (HMODULE)0x0) {
    FreeLibrary((HMODULE)param_1[8]);
  }
  if (param_1[7] != (LPCWSTR)0xffffffffffffffff) {
    CloseHandle(param_1[7]);
    param_1[7] = (LPCWSTR)0xffffffffffffffff;
  }
  return 0;
}



void FUN_180019dd8(longlong param_1)

{
  if (*(HMODULE *)(param_1 + 0x40) != (HMODULE)0x0) {
    FreeLibrary(*(HMODULE *)(param_1 + 0x40));
  }
  if (*(HANDLE *)(param_1 + 0x38) != (HANDLE)0xffffffffffffffff) {
    CloseHandle(*(HANDLE *)(param_1 + 0x38));
    *(undefined8 *)(param_1 + 0x38) = 0xffffffffffffffff;
  }
  *(undefined4 *)(param_1 + 0x5c) = 0;
  return;
}



undefined8 FUN_180019e24(longlong param_1,int *param_2)

{
  ushort uVar1;
  longlong lVar2;
  uint uVar3;
  BOOL BVar4;
  ulonglong uVar5;
  uint uVar6;
  int *piVar7;
  undefined8 uVar8;
  int iVar9;
  longlong local_res8;
  
  lVar2 = *(longlong *)(param_1 + 0x48);
  uVar8 = 0xc0000089;
  uVar6 = 0;
  iVar9 = 0;
  uVar1 = *(ushort *)(lVar2 + 6);
  uVar5 = (ulonglong)uVar1;
  piVar7 = (int *)((ulonglong)*(ushort *)(lVar2 + 0x14) + lVar2);
  BVar4 = GetFileSizeEx(*(HANDLE *)(param_1 + 0x38),&local_res8);
  if (BVar4 != 0) {
    if (uVar1 != 0) {
      do {
        if (uVar6 <= (uint)piVar7[0xb] && piVar7[0xb] != uVar6) {
          iVar9 = piVar7[10];
        }
        uVar3 = piVar7[0xb];
        if ((uint)piVar7[0xb] <= uVar6) {
          uVar3 = uVar6;
        }
        uVar6 = uVar3;
        uVar5 = uVar5 - 1;
        piVar7 = piVar7 + 10;
      } while (uVar5 != 0);
    }
    if ((longlong)(ulonglong)(iVar9 + uVar6 + 0x40) < local_res8) {
      *param_2 = iVar9 + uVar6;
      uVar8 = 0;
    }
  }
  return uVar8;
}



undefined8 FUN_180019ed4(longlong param_1,char *param_2,longlong *param_3,longlong *param_4)

{
  ushort uVar1;
  longlong lVar2;
  ulonglong uVar3;
  int iVar4;
  char *_Str1;
  uint uVar5;
  size_t _MaxCount;
  ulonglong uVar6;
  
  lVar2 = *(longlong *)(param_1 + 0x48);
  uVar5 = 0;
  uVar1 = *(ushort *)(lVar2 + 6);
  _Str1 = (char *)(lVar2 + 0x18 + (ulonglong)*(ushort *)(lVar2 + 0x14));
  if (uVar1 != 0) {
    do {
      _MaxCount = 0xffffffffffffffff;
      do {
        _MaxCount = _MaxCount + 1;
      } while (param_2[_MaxCount] != '\0');
      iVar4 = strncmp(_Str1,param_2,_MaxCount);
      if (iVar4 == 0) {
        uVar6 = (ulonglong)*(uint *)(_Str1 + 0xc);
        uVar3 = *(ulonglong *)(param_1 + 0x50);
        if (uVar3 <= uVar6) {
          return 0xc0000089;
        }
        *param_3 = *(longlong *)(param_1 + 8) + uVar6;
        *param_4 = uVar3 - uVar6;
        return 0;
      }
      _Str1 = _Str1 + 0x28;
      uVar5 = uVar5 + 1;
    } while (uVar5 < uVar1);
  }
  return 0xc0000089;
}



undefined8 Module32NextW(undefined8 param_1,int *param_2)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  longlong lVar6;
  int *piVar7;
  int *piVar8;
  undefined8 uVar9;
  longlong local_res10;
  undefined8 local_res18;
  undefined8 local_res20;
  
                    // 0x19fa0  1005  Module32NextW
  uVar9 = 0;
  if ((param_2 != (int *)0x0) && (*param_2 == 0x438)) {
    local_res18 = 0;
    local_res20 = 0;
    local_res10 = 0;
    iVar5 = NtMapViewOfSection(param_1,0xffffffffffffffff,&local_res10,0,0,&local_res18,&local_res20
                               ,1,0,4);
    if (-1 < iVar5) {
      uVar1 = *(uint *)(local_res10 + 0x38);
      if (uVar1 < *(uint *)(local_res10 + 8)) {
        *(uint *)(local_res10 + 0x38) = uVar1 + 1;
        lVar6 = 8;
        piVar4 = (int *)((ulonglong)uVar1 * 0x438 + *(longlong *)(local_res10 + 0x20) + local_res10)
        ;
        do {
          piVar8 = param_2;
          piVar7 = piVar4;
          iVar5 = piVar7[1];
          iVar2 = piVar7[2];
          iVar3 = piVar7[3];
          *piVar8 = *piVar7;
          piVar8[1] = iVar5;
          piVar8[2] = iVar2;
          piVar8[3] = iVar3;
          iVar5 = piVar7[5];
          iVar2 = piVar7[6];
          iVar3 = piVar7[7];
          piVar8[4] = piVar7[4];
          piVar8[5] = iVar5;
          piVar8[6] = iVar2;
          piVar8[7] = iVar3;
          iVar5 = piVar7[9];
          iVar2 = piVar7[10];
          iVar3 = piVar7[0xb];
          piVar8[8] = piVar7[8];
          piVar8[9] = iVar5;
          piVar8[10] = iVar2;
          piVar8[0xb] = iVar3;
          iVar5 = piVar7[0xd];
          iVar2 = piVar7[0xe];
          iVar3 = piVar7[0xf];
          piVar8[0xc] = piVar7[0xc];
          piVar8[0xd] = iVar5;
          piVar8[0xe] = iVar2;
          piVar8[0xf] = iVar3;
          iVar5 = piVar7[0x11];
          iVar2 = piVar7[0x12];
          iVar3 = piVar7[0x13];
          piVar8[0x10] = piVar7[0x10];
          piVar8[0x11] = iVar5;
          piVar8[0x12] = iVar2;
          piVar8[0x13] = iVar3;
          iVar5 = piVar7[0x15];
          iVar2 = piVar7[0x16];
          iVar3 = piVar7[0x17];
          piVar8[0x14] = piVar7[0x14];
          piVar8[0x15] = iVar5;
          piVar8[0x16] = iVar2;
          piVar8[0x17] = iVar3;
          iVar5 = piVar7[0x19];
          iVar2 = piVar7[0x1a];
          iVar3 = piVar7[0x1b];
          piVar8[0x18] = piVar7[0x18];
          piVar8[0x19] = iVar5;
          piVar8[0x1a] = iVar2;
          piVar8[0x1b] = iVar3;
          iVar5 = piVar7[0x1d];
          iVar2 = piVar7[0x1e];
          iVar3 = piVar7[0x1f];
          piVar8[0x1c] = piVar7[0x1c];
          piVar8[0x1d] = iVar5;
          piVar8[0x1e] = iVar2;
          piVar8[0x1f] = iVar3;
          lVar6 = lVar6 + -1;
          piVar4 = piVar7 + 0x20;
          param_2 = piVar8 + 0x20;
        } while (lVar6 != 0);
        iVar5 = piVar7[0x21];
        iVar2 = piVar7[0x22];
        iVar3 = piVar7[0x23];
        uVar9 = 1;
        piVar8[0x20] = piVar7[0x20];
        piVar8[0x21] = iVar5;
        piVar8[0x22] = iVar2;
        piVar8[0x23] = iVar3;
        iVar5 = piVar7[0x25];
        iVar2 = piVar7[0x26];
        iVar3 = piVar7[0x27];
        piVar8[0x24] = piVar7[0x24];
        piVar8[0x25] = iVar5;
        piVar8[0x26] = iVar2;
        piVar8[0x27] = iVar3;
        iVar5 = piVar7[0x29];
        iVar2 = piVar7[0x2a];
        iVar3 = piVar7[0x2b];
        piVar8[0x28] = piVar7[0x28];
        piVar8[0x29] = iVar5;
        piVar8[0x2a] = iVar2;
        piVar8[0x2b] = iVar3;
        *(undefined8 *)(piVar8 + 0x2c) = *(undefined8 *)(piVar7 + 0x2c);
      }
      else {
        RtlSetLastWin32Error(0x12);
      }
      NtUnmapViewOfSection(0xffffffffffffffff,local_res10);
      return uVar9;
    }
  }
  BaseSetLastNTError();
  return 0;
}



LCID GetThreadLocale(void)

{
  LCID LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001a0f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1a0f0  778  GetThreadLocale
  LVar1 = GetThreadLocale();
  return LVar1;
}



BOOL SetThreadLocale(LCID Locale)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001a110. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1a110  1390  SetThreadLocale
  BVar1 = SetThreadLocale(Locale);
  return BVar1;
}



BOOL VirtualFree(LPVOID lpAddress,SIZE_T dwSize,DWORD dwFreeType)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001a130. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1a130  1501  VirtualFree
  BVar1 = VirtualFree(lpAddress,dwSize,dwFreeType);
  return BVar1;
}



// WARNING: Could not reconcile some variable overlaps

void BasepGetComputerNameFromNtPath(ushort *param_1,longlong param_2,LPWSTR param_3,LPDWORD param_4)

{
  char cVar1;
  DWORD DVar2;
  BOOL BVar3;
  int iVar4;
  wchar_t *pwVar5;
  ushort uVar6;
  uint uVar7;
  longlong lVar8;
  LPWSTR pWVar9;
  undefined7 uVar10;
  undefined auStack1928 [32];
  undefined8 local_768;
  undefined4 local_760;
  undefined8 local_758;
  int local_750;
  undefined8 local_748;
  undefined8 local_740;
  undefined4 local_738;
  ushort local_728;
  ushort local_726;
  wchar_t *local_720;
  undefined8 local_718;
  uint local_710 [2];
  wchar_t *local_708;
  undefined4 local_700 [2];
  wchar_t *local_6f8;
  undefined local_6f0 [16];
  undefined local_6e0 [16];
  undefined4 local_6d0 [2];
  undefined8 local_6c8;
  undefined *local_6c0;
  undefined4 local_6b8;
  undefined local_6b0 [16];
  uint local_6a0;
  undefined2 local_69c;
  WCHAR local_698 [26];
  short local_664;
  short local_662;
  wchar_t local_660 [236];
  short local_488 [2];
  wchar_t local_484 [262];
  uint local_278;
  wchar_t local_272 [269];
  ulonglong local_58;
  
                    // 0x1a150  89  BasepGetComputerNameFromNtPath
  local_58 = DAT_1800b2220 ^ (ulonglong)auStack1928;
  local_6a0 = 0x3a0041;
  local_69c = 0;
  local_710[0] = 0x120010;
  local_708 = L"\\??\\UNC\\";
  local_700[0] = 0xa0008;
  local_6f8 = L"\\??\\";
  pWVar9 = param_3;
  RtlInitUnicodeString(&local_728,0);
  uVar10 = (undefined7)((ulonglong)pWVar9 >> 8);
  cVar1 = RtlPrefixString(local_710,param_1);
  if (cVar1 == '\0') {
    cVar1 = RtlPrefixString(local_700,param_1,CONCAT71(uVar10,1));
    if ((cVar1 == '\0') || (*(short *)(*(longlong *)(param_1 + 4) + 10) != 0x3a))
    goto LAB_18001a2bf;
    uVar6 = *(ushort *)(*(longlong *)(param_1 + 4) + 8);
    if ((ushort)(uVar6 - 0x61) < 0x1a) {
      uVar6 = uVar6 - 0x20;
    }
    local_6a0 = local_6a0 & 0xffff0000 | (uint)uVar6;
    DVar2 = QueryDosDeviceW((LPCWSTR)&local_6a0,local_698,0x105);
    if (DVar2 != 0) {
      pwVar5 = wcsstr(local_698,L"\\Device\\LanmanRedirector\\;");
      if (((local_698 == pwVar5) && ((short)local_6a0 == local_664)) && (local_662 == 0x3a)) {
        local_720 = wcschr(local_660,L'\\');
        local_278 = 0;
        if (local_720 == (wchar_t *)0x0) goto LAB_180033397;
        local_720 = local_720 + 1;
        local_278 = (0x105 - (int)((longlong)local_720 - (longlong)local_698 >> 1)) * 2;
        goto LAB_180033610;
      }
      pwVar5 = wcsstr(local_698,L"\\Device\\Harddisk");
      if (((local_698 != pwVar5) &&
          (pwVar5 = wcsstr(local_698,L"\\Device\\CdRom"), local_698 != pwVar5)) &&
         (pwVar5 = wcsstr(local_698,L"\\Device\\Floppy"), local_698 != pwVar5)) {
        pwVar5 = wcsstr(local_698,L"\\Device\\WinDfs\\");
        if (local_698 != pwVar5) goto LAB_18001a2bf;
        local_768 = (undefined *)CONCAT44(local_768._4_4_,9);
        iVar4 = NtQueryInformationFile(param_2,local_6f0,&local_278,0x218);
        if (-1 < iVar4) {
          local_720 = local_272;
          goto LAB_180033397;
        }
        goto LAB_18003357f;
      }
      BVar3 = GetComputerNameW(param_3,param_4);
      if (BVar3 != 0) goto LAB_18001a2bf;
    }
    GetLastError();
    goto LAB_18001a2bf;
  }
  if (*param_1 < (ushort)local_710[0] || *param_1 == (ushort)local_710[0]) goto LAB_18001a2bf;
  local_278 = (uint)*param_1 - (local_710[0] & 0xffff);
  local_720 = (wchar_t *)
              (*(longlong *)(param_1 + 4) + ((ulonglong)(ushort)local_710[0] & 0xfffffffffffffffe));
LAB_180033397:
  lVar8 = -1;
  if (param_2 != -1) {
    pwVar5 = local_720 + -1;
    local_718 = 0xffffffffffffffff;
    RtlInitUnicodeString(local_6e0,L"\\Dfs");
    local_738 = 0;
    local_6c0 = local_6e0;
    local_740 = 0;
    local_748 = (short *)CONCAT44(local_748._4_4_,0xa0);
    local_750 = 3;
    local_758 = (wchar_t *)CONCAT44(local_758._4_4_,7);
    local_760 = 0x80;
    local_768 = (undefined *)0x0;
    local_6d0[0] = 0x30;
    local_6c8 = 0;
    local_6b8 = 0x40;
    local_6b0 = ZEXT816(0);
    iVar4 = NtCreateFile(&local_718,0x100000,local_6d0,local_6f0);
    if (iVar4 < 0) {
LAB_18003357f:
      RtlNtStatusToDosError(iVar4);
      goto LAB_18001a2bf;
    }
    if (*pwVar5 != L'\\') {
      NtClose(local_718);
      goto LAB_18001a2bf;
    }
    local_740 = CONCAT44(local_740._4_4_,0x20a);
    local_748 = local_488;
    local_750 = local_278 + 2;
    local_768 = local_6f0;
    local_760 = 0x600c0;
    local_758 = pwVar5;
    iVar4 = NtFsControlFile(local_718,0,0,0);
    NtClose(local_718);
    if (iVar4 < 0) {
      if (iVar4 != -0x3fffffcc) goto LAB_18003357f;
    }
    else if (local_488[0] != 0) {
      do {
        lVar8 = lVar8 + 1;
      } while (local_488[lVar8] != 0);
      local_278 = (int)lVar8 * 2;
      if (((local_278 < 6) || (local_488[0] != 0x5c)) || (local_488[1] != 0x5c)) goto LAB_18001a2bf;
      local_720 = local_484;
      local_278 = local_278 - 4;
    }
  }
LAB_180033610:
  pwVar5 = local_720;
  if (local_278 != 0) {
    do {
      if (*pwVar5 == L'\\') break;
      if (*pwVar5 == L'.') goto LAB_18001a2bf;
      pwVar5 = pwVar5 + 1;
    } while ((uint)((int)pwVar5 - (int)local_720) < local_278);
  }
  uVar6 = (short)pwVar5 - (short)local_720;
  uVar7 = (uint)uVar6;
  local_728 = uVar6;
  local_726 = uVar6;
  if (((uVar7 < local_278) && (uVar7 < 0x1f)) && ((ulonglong)uVar6 + 2 <= (ulonglong)*param_4 * 2))
  {
    memcpy(param_3,local_720,(ulonglong)uVar7);
    *param_4 = (uint)(uVar6 >> 1);
    param_3[(uint)(uVar6 >> 1)] = L'\0';
  }
LAB_18001a2bf:
  __security_check_cookie(local_58 ^ (ulonglong)auStack1928);
  return;
}



BOOL GetComputerNameA(LPSTR lpBuffer,LPDWORD nSize)

{
  BOOL BVar1;
  BOOL extraout_EAX;
  DWORD DVar2;
  undefined4 *puVar3;
  LPWSTR lpBuffer_00;
  longlong in_GS_OFFSET;
  undefined auStack88 [32];
  uint local_38 [2];
  WCHAR local_30 [16];
  ulonglong local_10;
  
                    // 0x1a300  486  GetComputerNameA
  local_10 = DAT_1800b2220 ^ (ulonglong)auStack88;
  local_38[0] = 0x10;
  lpBuffer_00 = local_30;
  BVar1 = GetComputerNameW(local_30,local_38);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
    if (DVar2 != 0x6f) goto LAB_18001a366;
    puVar3 = (undefined4 *)KernelBaseGetGlobalData();
    lpBuffer_00 = (LPWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30)
                                          ,*puVar3,(ulonglong)local_38[0] * 2);
    if (lpBuffer_00 == (LPWSTR)0x0) {
      RtlSetLastWin32Error(8);
      goto LAB_18001a366;
    }
    BVar1 = GetComputerNameW(lpBuffer_00,local_38);
    if (BVar1 == 0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpBuffer_00);
      goto LAB_18001a366;
    }
  }
  FUN_18001a38c(lpBuffer_00,lpBuffer,nSize);
  if (lpBuffer_00 != local_30) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpBuffer_00);
  }
LAB_18001a366:
  __security_check_cookie(local_10 ^ (ulonglong)auStack88);
  return extraout_EAX;
}



undefined8 FUN_18001a38c(undefined8 param_1,undefined8 param_2,uint *param_3)

{
  int iVar1;
  uint uVar2;
  ushort local_28;
  undefined2 local_26;
  undefined4 local_24;
  undefined8 local_20;
  undefined local_18 [16];
  
  local_24 = 0;
  iVar1 = RtlInitUnicodeStringEx(local_18,param_1);
  if (-1 < iVar1) {
    uVar2 = RtlxUnicodeStringToAnsiSize(local_18);
    if (*param_3 <= uVar2 && uVar2 != *param_3) {
      RtlSetLastWin32Error(0x6f);
      *param_3 = uVar2;
      return 0;
    }
    local_26 = 0xffff;
    if (*param_3 < 0x10000) {
      local_26 = *(undefined2 *)param_3;
    }
    local_28 = 0;
    local_20 = param_2;
    iVar1 = RtlUnicodeStringToAnsiString(&local_28,local_18,0);
    if (-1 < iVar1) {
      *param_3 = (uint)local_28;
      return 1;
    }
  }
  BaseSetLastNTError();
  *param_3 = 0;
  return 0;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

BOOL GetComputerNameW(LPWSTR lpBuffer,LPDWORD nSize)

{
  DWORD DVar1;
  uint uVar2;
  int iVar3;
  longlong lVar4;
  longlong lVar5;
  void *_Dst;
  int iVar6;
  int iVar7;
  longlong in_GS_OFFSET;
  int local_res10 [2];
  uint local_res18 [2];
  longlong local_res20;
  undefined local_78 [16];
  undefined4 local_68 [2];
  undefined8 local_60;
  undefined *local_58;
  undefined4 local_50;
  undefined local_48 [16];
  
                    // 0x1a460  489  GetComputerNameW
  local_res20 = 0;
  local_res10[0] = 0;
  DVar1 = GetEnvironmentVariableW(L"_CLUSTER_NETWORK_NAME_",lpBuffer,*nSize);
  iVar7 = 0;
  if (DVar1 != 0) {
    uVar2 = *nSize;
    if (uVar2 < DVar1) {
      RtlSetLastWin32Error(0x6f);
    }
    *nSize = DVar1;
    return (uint)(uVar2 >= DVar1);
  }
  lVar4 = KernelBaseGetGlobalData();
  if (*(longlong *)(lVar4 + 0xa0) != 0) {
    lVar4 = KernelBaseGetGlobalData();
    uVar2 = *(DWORD *)(lVar4 + 0xa8) + 1;
    if (uVar2 <= *nSize) {
      *nSize = *(DWORD *)(lVar4 + 0xa8);
      lVar4 = KernelBaseGetGlobalData();
      memcpy(lpBuffer,*(void **)(lVar4 + 0xa0),(ulonglong)uVar2 * 2);
      return 1;
    }
    *nSize = uVar2;
    RtlSetLastWin32Error(0x6f);
    return 0;
  }
  iVar6 = iVar7;
  if ((DAT_1800b2e30 == 0) || (iVar3 = (*(code *)DAT_1800b2e30)(), iVar3 == 0x4d5)) {
    RtlInitUnicodeString
              (local_78,L"\\Registry\\Machine\\System\\CurrentControlSet\\Control\\ComputerName");
    local_58 = local_78;
    local_68[0] = 0x30;
    local_60 = 0;
    local_50 = 0x40;
    local_48 = ZEXT816(0);
    iVar3 = NtOpenKey(&local_res20,0x20019,local_68);
    if (iVar3 == -0x3fffffcc) {
      if (lpBuffer != (LPWSTR)0x0) {
LAB_18003380a:
        *lpBuffer = L'\0';
      }
      *nSize = 0;
    }
    else {
      if (iVar3 < 0) {
LAB_18003385e:
        BaseSetLastNTError();
        goto LAB_18001a5f2;
      }
      iVar3 = FUN_18001a780(local_res20,L"ActiveComputerName",lpBuffer,nSize);
      if (iVar3 == -0x7ffffffb) {
        RtlSetLastWin32Error(0x6f);
        goto LAB_18001a5f2;
      }
      if (iVar3 < 0) {
        iVar3 = FUN_18001a780(local_res20,L"ComputerName",lpBuffer,nSize);
        if (iVar3 == -0x3fffffcc) goto LAB_18003380a;
        if ((iVar3 < 0) ||
           ((iVar3 = FUN_18007d554(lpBuffer,nSize), (iVar3 + 0x80000000U & 0x80000000) == 0 &&
            (iVar3 != -0x3fffffde)))) goto LAB_18003385e;
      }
    }
  }
  else if (iVar3 == 0x6f) goto LAB_18001a5f2;
  lVar4 = -1;
  if ((lpBuffer != (LPWSTR)0x0) && (*nSize != 0)) {
    lVar5 = -1;
    do {
      lVar5 = lVar5 + 1;
    } while (lpBuffer[lVar5] != L'\0');
    *nSize = (DWORD)lVar5;
  }
  iVar6 = 1;
  if (DAT_1800b2308 != 0) {
    KernelBaseGetGlobalData();
    RtlEnterCriticalSection();
    local_res18[0] = 4;
    iVar3 = FUN_18001a90c(0,(undefined *)L"\\Registry\\Machine\\System\\Setup",L"OOBEInProgress",
                          local_res10,local_res18);
    if ((iVar3 < 0) || (local_res10[0] == 0)) {
      local_res18[0] = 4;
      iVar3 = FUN_18001a90c(0,(undefined *)L"\\Registry\\Machine\\System\\Setup",
                            L"SystemSetupInProgress",local_res10,local_res18);
    }
    if ((-1 < iVar3) && (local_res10[0] != 0)) {
      DAT_1800b2308 = iVar7;
    }
    if ((DAT_1800b2308 != 0) &&
       (lVar5 = KernelBaseGetGlobalData(), *(longlong *)(lVar5 + 0xa0) == 0)) {
      _Dst = (void *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
      if (_Dst == (void *)0x0) {
        DAT_1800b2308 = 0;
      }
      else {
        memcpy(_Dst,lpBuffer,(ulonglong)*nSize * 2);
        *(undefined2 *)((longlong)_Dst + (ulonglong)*nSize * 2) = 0;
        do {
          lVar4 = lVar4 + 1;
        } while (*(short *)((longlong)_Dst + lVar4 * 2) != 0);
        lVar5 = KernelBaseGetGlobalData();
        *(int *)(lVar5 + 0xa8) = (int)lVar4;
        lVar4 = KernelBaseGetGlobalData();
        *(void **)(lVar4 + 0xa0) = _Dst;
      }
    }
    lVar4 = KernelBaseGetGlobalData();
    RtlLeaveCriticalSection(lVar4 + 0xb0);
  }
LAB_18001a5f2:
  if (local_res20 != 0) {
    NtClose();
  }
  return iVar6;
}



void FUN_18001a780(undefined8 param_1,undefined8 param_2,void *param_3,uint *param_4)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  ulonglong uVar4;
  undefined auStack328 [32];
  undefined4 local_128;
  undefined *local_120;
  undefined8 local_118;
  undefined local_110 [8];
  undefined local_108 [16];
  undefined local_f8 [16];
  undefined4 local_e8;
  undefined8 local_e0;
  undefined *local_d8;
  undefined4 local_d0;
  undefined local_c8 [16];
  undefined local_b8 [8];
  uint local_b0;
  uint local_ac;
  ulonglong local_48;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStack328;
  RtlInitUnicodeString(local_108);
  local_d8 = local_108;
  local_e8 = 0x30;
  local_d0 = 0x40;
  local_c8 = ZEXT816(0);
  local_e0 = param_1;
  iVar1 = NtOpenKey(&local_118,0x20019);
  if (-1 < iVar1) {
    RtlInitUnicodeString(local_f8,L"ComputerName");
    local_120 = local_110;
    local_128 = 0x6c;
    iVar1 = NtQueryValueKey(local_118,local_f8,1,local_b8);
    NtClose();
    if ((-1 < iVar1) && (1 < local_ac)) {
      uVar2 = local_ac & 0xfffffffe;
      local_ac = uVar2;
      if (*(short *)(local_c8 + (ulonglong)uVar2 + (ulonglong)local_b0 + 0xe) == 0) {
        local_ac = uVar2 - 2;
      }
      uVar3 = uVar2 - 2;
      if (*(short *)(local_c8 + (ulonglong)uVar2 + (ulonglong)local_b0 + 0xe) != 0) {
        uVar3 = uVar2;
      }
      if (*param_4 < (uVar3 >> 1) + 1) {
        uVar4 = (ulonglong)((uVar3 >> 1) + 1);
      }
      else {
        memcpy(param_3,local_b8 + local_b0,(ulonglong)uVar3);
        *(undefined2 *)((ulonglong)uVar3 + (longlong)param_3) = 0;
        uVar4 = 0xffffffffffffffff;
        do {
          uVar4 = uVar4 + 1;
        } while (*(short *)((longlong)param_3 + uVar4 * 2) != 0);
      }
      *param_4 = (uint)uVar4;
    }
  }
  __security_check_cookie(local_48 ^ (ulonglong)auStack328);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18001a90c(longlong param_1,undefined *param_2,undefined8 param_3,void *param_4,
                  uint *param_5)

{
  bool bVar1;
  bool bVar2;
  int iVar3;
  uint uVar4;
  undefined *puVar5;
  longlong in_GS_OFFSET;
  undefined auStack904 [32];
  undefined8 local_368;
  undefined8 local_360;
  undefined8 local_358;
  uint local_348 [2];
  longlong local_340;
  undefined local_338 [16];
  undefined local_328 [16];
  undefined4 local_318;
  undefined8 local_310;
  undefined *local_308;
  undefined4 local_300;
  undefined local_2f8 [16];
  undefined local_2e8 [128];
  undefined local_268 [528];
  ulonglong local_58;
  
  local_58 = DAT_1800b2220 ^ (ulonglong)auStack904;
  puVar5 = local_2e8;
  local_340 = 0;
  iVar3 = 0;
  bVar1 = false;
  if (param_1 != 0) {
    local_358 = 0;
    local_368 = local_268;
    local_360 = (uint *)CONCAT44(local_360._4_4_,0x208);
    iVar3 = RtlGetPersistedStateLocation(param_1,L"TargetNtPath",param_2,0);
    param_2 = local_268;
  }
  RtlInitUnicodeString(local_338,param_2);
  if (iVar3 < 0) goto LAB_18001aa58;
  local_308 = local_338;
  local_318 = 0x30;
  local_310 = 0;
  local_300 = 0x40;
  local_2f8 = ZEXT816(0);
  iVar3 = NtOpenKey(&local_340,0x20019);
  if (iVar3 < 0) goto LAB_18001aa58;
  RtlInitUnicodeString(local_328,param_3);
  local_360 = local_348;
  local_368 = (undefined *)CONCAT44(local_368._4_4_,0x80);
  iVar3 = NtQueryValueKey(local_340);
  bVar2 = false;
  if (iVar3 == -0x7ffffffb) {
    puVar5 = (undefined *)
             RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
    if (puVar5 == (undefined *)0x0) goto LAB_18001aa58;
    local_360 = local_348;
    local_368 = (undefined *)((ulonglong)local_368 & 0xffffffff00000000 | (ulonglong)local_348[0]);
    iVar3 = NtQueryValueKey(local_340);
    bVar2 = true;
  }
  bVar1 = bVar2;
  if ((iVar3 < 0) || (uVar4 = *(uint *)(puVar5 + 4), uVar4 == 0)) goto LAB_18001aa58;
  if (uVar4 < 3) {
LAB_18003392a:
    if (*(uint *)(puVar5 + 0xc) < 2) goto LAB_18001aa58;
    uVar4 = *(uint *)(puVar5 + 0xc) & 0xfffffffe;
    *(uint *)(puVar5 + 0xc) = uVar4;
    if (*(short *)(puVar5 + (ulonglong)uVar4 + (ulonglong)*(uint *)(puVar5 + 8) + -2) == 0) {
      uVar4 = uVar4 - 2;
      *(uint *)(puVar5 + 0xc) = uVar4;
    }
    if (((ulonglong)uVar4 + 2 <= (ulonglong)*param_5) && (param_4 != (void *)0x0)) {
      memcpy(param_4,puVar5 + *(uint *)(puVar5 + 8),(ulonglong)uVar4);
      *(undefined2 *)((ulonglong)*(uint *)(puVar5 + 0xc) + (longlong)param_4) = 0;
      uVar4 = *(uint *)(puVar5 + 0xc);
    }
    uVar4 = uVar4 + 2;
  }
  else {
    if (4 < uVar4) {
      if (uVar4 == 7) goto LAB_18003392a;
      if (uVar4 != 0xb) goto LAB_18001aa58;
    }
    uVar4 = *(uint *)(puVar5 + 0xc);
    if (uVar4 <= *param_5) {
      memcpy(param_4,puVar5 + *(uint *)(puVar5 + 8),(ulonglong)uVar4);
      uVar4 = *(uint *)(puVar5 + 0xc);
    }
  }
  *param_5 = uVar4;
LAB_18001aa58:
  if (local_340 != 0) {
    NtClose();
    local_340 = 0;
  }
  if (bVar1) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar5);
  }
  __security_check_cookie(local_58 ^ (ulonglong)auStack904);
  return;
}



int lstrlen(LPCSTR lpString)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001aab0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1aab0  1618  lstrlen
                    // 0x1aab0  1619  lstrlenA
  iVar1 = lstrlenA(lpString);
  return iVar1;
}



BOOL GetProcessTimes(HANDLE hProcess,LPFILETIME lpCreationTime,LPFILETIME lpExitTime,
                    LPFILETIME lpKernelTime,LPFILETIME lpUserTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001aad0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1aad0  713  GetProcessTimes
  BVar1 = GetProcessTimes(hProcess,lpCreationTime,lpExitTime,lpKernelTime,lpUserTime);
  return BVar1;
}



undefined8
FUN_18001aae4(uint param_1,uint param_2,uint *param_3,longlong param_4,uint *param_5,
             longlong param_6,longlong param_7)

{
  uint *puVar1;
  longlong lVar2;
  ushort uVar3;
  int *piVar4;
  uint *puVar5;
  longlong *plVar6;
  uint *puVar7;
  undefined8 *puVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  uint uVar11;
  uint uVar12;
  
  uVar9 = 0;
  puVar7 = param_3 + 0x10;
  if ((param_1 & 1) != 0) {
    *(undefined8 *)(param_3 + 4) = 0x40;
    uVar10 = uVar9;
    if (*param_3 != 0) {
      plVar6 = (longlong *)(param_3 + 0x14);
      do {
        plVar6[-2] = 0x20;
        *(uint *)(plVar6 + -1) = param_2;
        lVar2 = *(longlong *)(uVar10 * 0x58 + 8 + param_7);
        *plVar6 = lVar2;
        uVar12 = (int)uVar10 + 1;
        uVar10 = (ulonglong)uVar12;
        *(uint *)(plVar6 + 1) = (uint)(lVar2 == *(longlong *)(param_6 + 0x98));
        plVar6 = plVar6 + 4;
      } while (uVar12 < *param_3);
    }
    puVar7 = puVar7 + uVar10 * 8;
  }
  if ((param_1 & 8) != 0) {
    uVar12 = param_3[2];
    *(longlong *)(param_3 + 8) = (longlong)puVar7 - (longlong)param_3;
    puVar5 = param_5 + 2;
    if (*param_5 <= uVar12 && uVar12 != *param_5) {
      return 0xc000000d;
    }
    if (uVar12 != 0) {
      puVar8 = (undefined8 *)(puVar7 + 10);
      do {
        *(undefined4 *)(puVar8 + -5) = 0x438;
        *(uint *)(puVar8 + -4) = param_2;
        *puVar8 = *(undefined8 *)(puVar5 + 4);
        puVar8[-2] = *(undefined8 *)(puVar5 + 4);
        FUN_18001ad50(puVar8 + 0x41,puVar5 + 10,0x208);
        FUN_18001ad50(puVar8 + 1,
                      (ulonglong)*(ushort *)((longlong)puVar5 + 0x26) + 0x28 + (longlong)puVar5,
                      0x200);
        uVar12 = (int)uVar9 + 1;
        uVar9 = (ulonglong)uVar12;
        *(uint *)(puVar8 + -1) = puVar5[6];
        *(undefined4 *)((longlong)puVar8 + -0x24) = 1;
        *(uint *)((longlong)puVar8 + -0x1c) = (uint)*(ushort *)(puVar5 + 9);
        puVar1 = puVar5 + 9;
        puVar5 = puVar5 + 0x4a;
        *(uint *)(puVar8 + -3) = (uint)*(ushort *)puVar1;
        puVar8 = puVar8 + 0x87;
      } while (uVar12 < param_3[2]);
    }
    puVar7 = puVar7 + uVar9 * 0x10e;
  }
  if ((param_1 & 2) != 0) {
    puVar5 = puVar7 + 9;
    uVar10 = 0;
    *(longlong *)(param_3 + 6) = (longlong)puVar7 - (longlong)param_3;
    uVar9 = 0;
    do {
      puVar5[-9] = 0x238;
      piVar4 = (int *)(uVar9 + param_4);
      puVar5[-7] = piVar4[0x14];
      *puVar5 = piVar4[0x12];
      puVar5[-2] = piVar4[1];
      puVar5[-1] = piVar4[0x16];
      puVar5[-8] = 0;
      *(undefined8 *)(puVar5 + -5) = 0;
      puVar5[-3] = 0;
      puVar5[1] = 0;
      if (*(void **)(piVar4 + 0x10) == (void *)0x0) {
        wcscpy_s((wchar_t *)(puVar5 + 2),0x104,L"[System Process]");
      }
      else {
        uVar3 = *(ushort *)(piVar4 + 0xe);
        if (0x103 < uVar3) {
          *(undefined2 *)(piVar4 + 0xe) = 0x103;
          uVar3 = 0x103;
        }
        memcpy(puVar5 + 2,*(void **)(piVar4 + 0x10),(ulonglong)uVar3);
        *(undefined2 *)((longlong)puVar5 + (ulonglong)*(ushort *)(piVar4 + 0xe) * 2 + 8) = 0;
      }
      uVar9 = (ulonglong)(uint)((int)uVar9 + *piVar4);
      uVar10 = (ulonglong)((int)uVar10 + 1);
      puVar5 = puVar5 + 0x8e;
    } while (*piVar4 != 0);
    puVar7 = puVar7 + uVar10 * 0x8e;
  }
  if ((param_1 & 4) != 0) {
    *(longlong *)(param_3 + 10) = (longlong)puVar7 - (longlong)param_3;
    uVar9 = 0;
    do {
      piVar4 = (int *)(uVar9 + param_4);
      if (piVar4[1] != 0) {
        puVar5 = (uint *)(piVar4 + 0x4a);
        uVar10 = 0;
        do {
          *puVar7 = 0x1c;
          uVar11 = (int)uVar10 + 1;
          uVar10 = (ulonglong)uVar11;
          puVar7[2] = puVar5[2];
          puVar7[3] = *puVar5;
          uVar12 = puVar5[5];
          *(undefined8 *)(puVar7 + 5) = 0;
          puVar7[4] = uVar12;
          puVar7[1] = 0;
          puVar7 = puVar7 + 7;
          puVar5 = puVar5 + 0x14;
        } while (uVar11 < (uint)piVar4[1]);
      }
      uVar9 = (ulonglong)(uint)((int)uVar9 + *piVar4);
    } while (*piVar4 != 0);
  }
  return 0;
}



void FUN_18001ad50(undefined8 param_1,undefined8 param_2,undefined2 param_3)

{
  undefined local_28 [2];
  undefined2 local_26;
  undefined8 local_20;
  undefined local_18 [24];
  
  local_26 = param_3;
  local_20 = param_1;
  RtlInitAnsiString(local_18);
  RtlAnsiStringToUnicodeString(local_28,local_18,0);
  return;
}



void Sleep(DWORD dwMilliseconds)

{
                    // WARNING: Could not recover jumptable at 0x00018001ada0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1ada0  1424  Sleep
  Sleep(dwMilliseconds);
  return;
}



HMODULE LoadLibraryExW(LPCWSTR lpLibFileName,HANDLE hFile,DWORD dwFlags)

{
  HMODULE pHVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001adc0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1adc0  971  LoadLibraryExW
  pHVar1 = LoadLibraryExW(lpLibFileName,hFile,dwFlags);
  return pHVar1;
}



HANDLE OpenProcess(DWORD dwDesiredAccess,BOOL bInheritHandle,DWORD dwProcessId)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001ade0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1ade0  1043  OpenProcess
  pvVar1 = OpenProcess(dwDesiredAccess,bInheritHandle,dwProcessId);
  return pvVar1;
}



ushort GetSystemDirectoryW(void *param_1,int param_2)

{
  ushort uVar1;
  longlong lVar2;
  
                    // 0x1ae00  747  GetSystemDirectoryW
  lVar2 = KernelBaseGetGlobalData();
  uVar1 = *(ushort *)(lVar2 + 0x18);
  if ((ulonglong)(uint)(param_2 * 2) < (ulonglong)uVar1 + 2) {
    uVar1 = (uVar1 >> 1) + 1;
  }
  else {
    memcpy(param_1,*(void **)(lVar2 + 0x20),(ulonglong)uVar1);
    *(undefined2 *)((longlong)param_1 + (ulonglong)(*(ushort *)(lVar2 + 0x18) >> 1) * 2) = 0;
    uVar1 = *(ushort *)(lVar2 + 0x18) >> 1;
  }
  return uVar1;
}



ushort FUN_18001ae0c(void *param_1,int param_2)

{
  ushort uVar1;
  longlong lVar2;
  
  lVar2 = KernelBaseGetGlobalData();
  uVar1 = *(ushort *)(lVar2 + 0x18);
  if ((ulonglong)(uint)(param_2 * 2) < (ulonglong)uVar1 + 2) {
    uVar1 = (uVar1 >> 1) + 1;
  }
  else {
    memcpy(param_1,*(void **)(lVar2 + 0x20),(ulonglong)uVar1);
    *(undefined2 *)((longlong)param_1 + (ulonglong)(*(ushort *)(lVar2 + 0x18) >> 1) * 2) = 0;
    uVar1 = *(ushort *)(lVar2 + 0x18) >> 1;
  }
  return uVar1;
}



BOOL FlushInstructionCache(HANDLE hProcess,LPCVOID lpBaseAddress,SIZE_T dwSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001ae80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1ae80  426  FlushInstructionCache
  BVar1 = FlushInstructionCache(hProcess,lpBaseAddress,dwSize);
  return BVar1;
}



BOOL QueryPerformanceFrequency(LARGE_INTEGER *lpFrequency)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001aea0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1aea0  1108  QueryPerformanceFrequency
  BVar1 = QueryPerformanceFrequency(lpFrequency);
  return BVar1;
}



FARPROC GetProcAddress(HMODULE hModule,LPCSTR lpProcName)

{
  FARPROC pFVar1;
  undefined in_stack_00000000;
  undefined7 in_stack_00000001;
  
                    // 0x1aec0  697  GetProcAddress
                    // WARNING: Could not recover jumptable at 0x00018001aec4. Too many branches
                    // WARNING: Treating indirect jump as call
  pFVar1 = (FARPROC)GetProcAddressForCaller
                              (hModule,lpProcName,CONCAT71(in_stack_00000001,in_stack_00000000));
  return pFVar1;
}



// WARNING: Could not reconcile some variable overlaps

int GetNumberFormatA(LCID Locale,DWORD dwFlags,LPCSTR lpValue,NUMBERFMTA *lpFormat,LPSTR lpNumberStr
                    ,int cchNumber)

{
  UINT UVar1;
  int iVar2;
  int extraout_EAX;
  DWORD DVar3;
  undefined8 uVar4;
  LPWSTR lpWideCharStr;
  undefined4 in_register_00000014;
  longlong lVar5;
  LPCWSTR pWVar6;
  NUMBERFMTW *pNVar7;
  longlong in_GS_OFFSET;
  undefined auStackY728 [32];
  LPCWSTR local_298;
  int local_290;
  DWORD local_28c;
  LCID local_288;
  UINT local_284;
  undefined local_280 [16];
  undefined local_270 [8];
  LPWSTR pWStack616;
  undefined8 local_260;
  WCHAR local_258 [128];
  WCHAR local_158 [128];
  ulonglong local_58;
  
                    // 0x1aee0  668  GetNumberFormatA
  local_58 = DAT_1800b2220 ^ (ulonglong)auStackY728;
  pNVar7 = (NUMBERFMTW *)0x0;
  local_28c = dwFlags;
  local_288 = Locale;
  UVar1 = FUN_18001b2a0(Locale,CONCAT44(in_register_00000014,dwFlags));
  local_284 = UVar1;
  if ((((UVar1 == 0) || (cchNumber < 0)) || ((lpNumberStr == (LPSTR)0x0 && (cchNumber != 0)))) ||
     (lpValue == lpNumberStr)) {
    SetLastError(0x57);
  }
  else {
    local_298 = local_258;
    uVar4 = FUN_18001b10c(UVar1,lpValue,0xffffffff,&local_298,&local_290);
    if ((int)uVar4 != 0) {
      if (lpFormat != (NUMBERFMTA *)0x0) {
        local_280._0_4_ = lpFormat->NumDigits;
        local_280._4_4_ = lpFormat->LeadingZero;
        local_280._8_4_ = lpFormat->Grouping;
        local_280._12_4_ = *(undefined4 *)&lpFormat->field_0xc;
        local_260 = *(undefined8 *)&lpFormat->NegativeOrder;
        _local_270 = ZEXT816(0);
        uVar4 = FUN_18001b10c(UVar1,lpFormat->lpDecimalSep,0xffffffff,(LPWSTR *)local_270,&local_290
                             );
        if (((int)uVar4 == 0) ||
           (uVar4 = FUN_18001b10c(UVar1,lpFormat->lpThousandSep,0xffffffff,(LPWSTR *)(local_270 + 8)
                                  ,&local_290), (int)uVar4 == 0)) {
          if ((local_298 != local_258) && (local_298 != (LPCWSTR)0x0)) {
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_298);
          }
          if (local_270 != (LPWSTR)0x0) {
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_270);
          }
          goto LAB_18001b0db;
        }
        pNVar7 = (NUMBERFMTW *)local_280;
      }
      lpWideCharStr = local_158;
      lVar5 = 0x80;
      pWVar6 = local_298;
      do {
        iVar2 = FUN_18001b230((ulonglong)local_288,local_28c,pWVar6,pNVar7,lpWideCharStr,(int)lVar5)
        ;
        if (((iVar2 != 0) || (DVar3 = GetLastError(), DVar3 != 0x7a)) ||
           (lpWideCharStr != local_158)) goto LAB_18001b033;
        SetLastError(0);
        iVar2 = FUN_18001b230((ulonglong)local_288,local_28c,pWVar6,pNVar7,(LPWSTR)0x0,0);
        lVar5 = (longlong)iVar2;
      } while ((iVar2 == 0) ||
              (lpWideCharStr =
                    (LPWSTR)RtlAllocateHeap(*(undefined8 *)
                                             (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,lVar5 * 2
                                           ), pWVar6 = local_298, lpWideCharStr != (LPWSTR)0x0));
      SetLastError(0xe);
      iVar2 = 0;
      pWVar6 = local_298;
LAB_18001b033:
      if ((pWVar6 != local_258) && (pWVar6 != (LPCWSTR)0x0)) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_298);
      }
      if (lpFormat != (NUMBERFMTA *)0x0) {
        if (local_270 != (LPWSTR)0x0) {
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_270);
        }
        if (pWStack616 != (LPWSTR)0x0) {
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pWStack616);
        }
      }
      if (0 < iVar2) {
        WideCharToMultiByte(local_284,0,lpWideCharStr,iVar2,lpNumberStr,cchNumber,(LPCSTR)0x0,
                            (LPBOOL)0x0);
      }
      if ((lpWideCharStr != local_158) && (lpWideCharStr != (LPCWSTR)0x0)) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpWideCharStr);
      }
    }
  }
LAB_18001b0db:
  __security_check_cookie(local_58 ^ (ulonglong)auStackY728);
  return extraout_EAX;
}



undefined8 FUN_18001b10c(UINT param_1,LPCSTR param_2,ulonglong param_3,LPWSTR *param_4,int *param_5)

{
  int iVar1;
  undefined8 uVar2;
  LPWSTR lpWideCharStr;
  DWORD dwErrCode;
  int cchWideChar;
  longlong lVar3;
  ulonglong uVar5;
  longlong in_GS_OFFSET;
  longlong lVar4;
  
  uVar5 = param_3 & 0xffffffff;
  if (param_2 == (LPCSTR)0x0) {
    *param_4 = (LPWSTR)0x0;
LAB_18001b21e:
    *param_5 = 0;
LAB_18001b1be:
    uVar2 = 1;
  }
  else {
    if ((int)param_3 < 0) {
      lVar3 = -1;
      do {
        lVar4 = lVar3;
        lVar3 = lVar4 + 1;
      } while (param_2[lVar3] != '\0');
      uVar5 = lVar4 + 2;
      if (uVar5 < 0x80000000) goto LAB_18001b163;
LAB_180033bf9:
      dwErrCode = 0x57;
    }
    else {
LAB_18001b163:
      lpWideCharStr = *param_4;
      iVar1 = (int)uVar5;
      if ((lpWideCharStr != (LPWSTR)0x0) && (cchWideChar = 0x7f, iVar1 < 0x80)) {
LAB_18001b174:
        if (iVar1 == 0) {
          *lpWideCharStr = L'\0';
          *param_4 = lpWideCharStr;
          goto LAB_18001b21e;
        }
        iVar1 = MultiByteToWideChar(param_1,0,param_2,iVar1,lpWideCharStr,cchWideChar);
        if ((iVar1 == 0) || (cchWideChar < iVar1)) {
          if ((lpWideCharStr != *param_4) && (lpWideCharStr != (LPWSTR)0x0)) {
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpWideCharStr);
          }
          goto LAB_180033bf9;
        }
        lpWideCharStr[iVar1] = L'\0';
        *param_4 = lpWideCharStr;
        *param_5 = iVar1;
        goto LAB_18001b1be;
      }
      lpWideCharStr =
           (LPWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,
                                   (ulonglong)(iVar1 + 1) * 2);
      cchWideChar = iVar1;
      if (lpWideCharStr != (LPWSTR)0x0) goto LAB_18001b174;
      dwErrCode = 0xe;
    }
    SetLastError(dwErrCode);
    uVar2 = 0;
  }
  return uVar2;
}



int FUN_18001b230(undefined8 param_1,DWORD param_2,LPCWSTR param_3,NUMBERFMTW *param_4,
                 LPWSTR param_5,int param_6)

{
  int iVar1;
  LPCWSTR lpLocaleName;
  
  lpLocaleName = (LPCWSTR)InternalLcidToName(param_1,0);
  if (lpLocaleName == (LPCWSTR)0x0) {
    SetLastError(0x57);
    iVar1 = 0;
  }
  else {
    iVar1 = GetNumberFormatEx(lpLocaleName,param_2,param_3,param_4,param_5,param_6);
  }
  return iVar1;
}



UINT FUN_18001b2a0(LCID param_1,ulonglong param_2)

{
  BOOL BVar1;
  int iVar2;
  UINT UVar3;
  UINT local_res10 [6];
  
  local_res10[0] = 0;
  if ((param_2 & 0x60000000) == 0) {
    if (param_1 == 0x409) {
LAB_18001b2c1:
      if (DAT_1800b2cbc != 0) {
        return DAT_1800b2cbc;
      }
      BVar1 = IsValidCodePage(0x4e4);
      DAT_1800b2cbc = (-(uint)(BVar1 != 0) & 0xffff06fb) + 0xfde9;
      return DAT_1800b2cbc;
    }
    if (param_1 != 0x800) {
      if (param_1 == 0x7f) goto LAB_18001b2c1;
      iVar2 = GetLocaleInfoW(param_1,0xa0001004,(LPWSTR)local_res10,2);
      if (iVar2 == 0) {
        SetLastError(0x57);
        return 0;
      }
      if (local_res10[0] != 0) {
        return local_res10[0];
      }
    }
  }
  UVar3 = GetACP();
  return UVar3;
}



int lstrcmpi(PCNZCH param_1,char *param_2)

{
  int iVar1;
  
                    // 0x1b300  1609  lstrcmpi
                    // 0x1b300  1610  lstrcmpiA
  iVar1 = CompareStringA(0x400,0x40000001,param_1,-1,param_2,-1);
  if ((iVar1 != 0) || (iVar1 = CompareStringA(0x800,0x40000001,param_1,-1,param_2,-1), iVar1 != 0))
  {
    return iVar1 + -2;
  }
  if (param_1 == (PCNZCH)0x0) {
    return -(uint)(param_2 != (char *)0x0);
  }
  if (param_2 != (char *)0x0) {
    iVar1 = _stricmp(param_1,param_2);
    return iVar1;
  }
  return 1;
}



int FUN_18001b30c(PCNZCH param_1,char *param_2)

{
  int iVar1;
  
  iVar1 = CompareStringA(0x400,0x40000001,param_1,-1,param_2,-1);
  if ((iVar1 != 0) || (iVar1 = CompareStringA(0x800,0x40000001,param_1,-1,param_2,-1), iVar1 != 0))
  {
    return iVar1 + -2;
  }
  if (param_1 == (PCNZCH)0x0) {
    return -(uint)(param_2 != (char *)0x0);
  }
  if (param_2 != (char *)0x0) {
    iVar1 = _stricmp(param_1,param_2);
    return iVar1;
  }
  return 1;
}



HGLOBAL LoadResource(HMODULE hModule,HRSRC hResInfo)

{
  HGLOBAL pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001b360. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1b360  975  LoadResource
  pvVar1 = LoadResource(hModule,hResInfo);
  return pvVar1;
}



HRSRC FindResourceExW(HMODULE hModule,LPCWSTR lpType,LPCWSTR lpName,WORD wLanguage)

{
  HRSRC pHVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001b380. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1b380  415  FindResourceExW
  pHVar1 = FindResourceExW(hModule,lpType,lpName,wLanguage);
  return pHVar1;
}



BOOL PostQueuedCompletionStatus
               (HANDLE CompletionPort,DWORD dwNumberOfBytesTransferred,ULONG_PTR dwCompletionKey,
               LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001b3a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1b3a0  1065  PostQueuedCompletionStatus
  BVar1 = PostQueuedCompletionStatus
                    (CompletionPort,dwNumberOfBytesTransferred,dwCompletionKey,lpOverlapped);
  return BVar1;
}



LPVOID LockResource(HGLOBAL hResData)

{
  LPVOID pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001b3c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1b3c0  995  LockResource
  pvVar1 = LockResource(hResData);
  return pvVar1;
}



DWORD SizeofResource(HMODULE hModule,HRSRC hResInfo)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001b3e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1b3e0  1423  SizeofResource
  DVar1 = SizeofResource(hModule,hResInfo);
  return DVar1;
}



BOOL SwitchToThread(void)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001b400. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1b400  1434  SwitchToThread
  BVar1 = SwitchToThread();
  return BVar1;
}



SIZE_T LocalSize(HLOCAL hMem)

{
  char cVar1;
  SIZE_T SVar2;
  undefined8 *puVar3;
  uint local_res10 [2];
  undefined8 *local_res18;
  
                    // 0x1b420  988  LocalSize
  SVar2 = 0xffffffffffffffff;
  local_res10[0] = 0;
  RtlLockHeap(DAT_1800b2a30);
  puVar3 = (undefined8 *)hMem;
  if (((ulonglong)hMem & 8) == 0) {
    local_res18 = (undefined8 *)0x0;
    cVar1 = RtlGetUserInfoHeap(DAT_1800b2a30,local_res10[0],hMem,&local_res18,local_res10);
    if ((cVar1 != '\0') &&
       ((local_res18 == (undefined8 *)0x0 || (puVar3 = local_res18, (local_res10[0] & 0x200) == 0)))
       ) {
      SVar2 = RtlSizeHeap(DAT_1800b2a30,1,hMem);
      puVar3 = (undefined8 *)hMem;
    }
    if (((ulonglong)puVar3 & 8) == 0) goto LAB_18001b52e;
  }
  cVar1 = RtlIsValidHandle(DAT_1800b2a20,puVar3 + -1);
  if (cVar1 == '\0') {
    RtlSetLastWin32Error(6);
  }
  else if ((*(byte *)(puVar3 + -1) & 8) == 0) {
    SVar2 = RtlSizeHeap(DAT_1800b2a30,1,*puVar3);
  }
  else {
    SVar2 = (SIZE_T)*(uint *)puVar3;
  }
LAB_18001b52e:
  RtlUnlockHeap(DAT_1800b2a30);
  if (SVar2 == 0xffffffffffffffff) {
    RtlSetLastWin32Error(6);
    SVar2 = 0;
  }
  return SVar2;
}



void GetSystemTime(LPSYSTEMTIME lpSystemTime)

{
                    // WARNING: Could not recover jumptable at 0x00018001b580. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1b580  754  GetSystemTime
  GetSystemTime(lpSystemTime);
  return;
}



HANDLE CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes,SIZE_T dwStackSize,
                   LPTHREAD_START_ROUTINE lpStartAddress,LPVOID lpParameter,DWORD dwCreationFlags,
                   LPDWORD lpThreadId)

{
  HANDLE pvVar1;
  
                    // 0x1b5a0  246  CreateThread
  pvVar1 = CreateRemoteThreadEx
                     ((HANDLE)0xffffffffffffffff,lpThreadAttributes,dwStackSize,lpStartAddress,
                      lpParameter,dwCreationFlags & 0x10004,(LPPROC_THREAD_ATTRIBUTE_LIST)0x0,
                      lpThreadId);
  return pvVar1;
}



BOOL SetThreadPriority(HANDLE hThread,int nPriority)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001b5f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1b5f0  1392  SetThreadPriority
  BVar1 = SetThreadPriority(hThread,nPriority);
  return BVar1;
}



undefined8 BasepNotifyLoadStringResource(void)

{
                    // 0x1b610  95  BasepNotifyLoadStringResource
                    // 0x1b610  1552  WerpNotifyLoadStringResourceWorker
                    // 0x1b610  1553  WerpNotifyUseStringResourceWorker
  return 0x80004001;
}



DWORD GetEnvironmentVariableW(LPCWSTR lpName,LPWSTR lpBuffer,DWORD nSize)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001b620. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1b620  580  GetEnvironmentVariableW
  DVar1 = GetEnvironmentVariableW(lpName,lpBuffer,nSize);
  return DVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int FUN_18001b634(undefined8 param_1,undefined8 param_2,undefined8 param_3,uint *param_4,
                 undefined8 *param_5)

{
  uint uVar1;
  int iVar2;
  
  iVar2 = RtlQueryPackageClaims(param_1,0,0,0,0,0,param_4,param_5);
  if (iVar2 == -0x3ffffddb) {
    *param_5 = 0;
    *param_4 = 0;
    iVar2 = 0;
  }
  if (iVar2 < 0) {
    _DAT_1800b2be8 = 0;
    return iVar2;
  }
  if ((*(byte *)param_5 & 1) != 0) {
    if ((*(byte *)param_5 & 8) != 0) {
      _DAT_1800b2be8 = 0x50001;
      return iVar2;
    }
    uVar1 = *param_4;
    if (((((uVar1 >> 0x10 & 1) == 0) && ((uVar1 & 4) == 0)) && ((uVar1 >> 10 & 1) == 0)) &&
       (((uVar1 >> 0xb & 1) == 0 && ((uVar1 & 0x40) == 0)))) {
      if ((uVar1 >> 0xc & 1) != 0) {
        _DAT_1800b2be8 = 0x50000;
        return iVar2;
      }
      _DAT_1800b2be8 = (byte)~(byte)uVar1 >> 3 & 1 | 0x50000;
      return iVar2;
    }
  }
  _DAT_1800b2be8 = 0x50000;
  return iVar2;
}



undefined8 ActivateActCtxWorker(longlong param_1,undefined8 param_2)

{
  int iVar1;
  undefined8 uVar2;
  
                    // 0x1b700  4  ActivateActCtxWorker
  if ((param_1 == -1) || (iVar1 = RtlActivateActivationContext(0,param_1,param_2), iVar1 < 0)) {
    BaseSetLastNTError();
    uVar2 = 0;
  }
  else {
    uVar2 = 1;
  }
  return uVar2;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

undefined8 TermsrvGetPreSetValue(void)

{
  undefined8 uVar1;
  
                    // 0x1b740  1446  TermsrvGetPreSetValue
  if (DAT_1800b2e10 == 0) {
    uVar1 = 0xc0000135;
  }
  else {
    uVar1 = (*(code *)DAT_1800b2e10)();
  }
  return uVar1;
}



int lstrcmpW(LPCWSTR lpString1,LPCWSTR lpString2)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001b770. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1b770  1608  lstrcmpW
                    // 0x1b770  1626  uaw_lstrcmpW
  iVar1 = lstrcmpW(lpString1,lpString2);
  return iVar1;
}



DWORD ExpandEnvironmentStringsW(LPCWSTR lpSrc,LPWSTR lpDst,DWORD nSize)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001b790. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1b790  364  ExpandEnvironmentStringsW
  DVar1 = ExpandEnvironmentStringsW(lpSrc,lpDst,nSize);
  return DVar1;
}



void FUN_18001b7a4(PVOID param_1)

{
  longlong lVar1;
  ULONG UVar2;
  undefined auStack72 [32];
  undefined local_28 [8];
  undefined4 uStack32;
  undefined4 uStack28;
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack72;
  lVar1 = *(longlong *)((longlong)param_1 + 8);
  local_28._0_4_ = *(ulong *)(lVar1 + -0x10);
  local_28._4_4_ = *(undefined4 *)(lVar1 + -0xc);
  uStack32 = *(undefined4 *)(lVar1 + -8);
  uStack28 = *(undefined4 *)(lVar1 + -4);
  *(undefined8 *)((longlong)param_1 + 0x28) = 0;
  *(undefined8 *)((longlong)param_1 + 0x30) = 0;
  UVar2 = EventRegister((LPCGUID)local_28,FUN_18001bc10,param_1,
                        (PREGHANDLE)((longlong)param_1 + 0x20));
  if (UVar2 == 0) {
    EventSetInformation(*(undefined8 *)((longlong)param_1 + 0x20),2,
                        *(undefined2 **)((longlong)param_1 + 8),
                        **(undefined2 **)((longlong)param_1 + 8));
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack72);
  return;
}



bool DeactivateActCtxWorker(uint param_1)

{
  bool bVar1;
  
                    // 0x1b850  264  DeactivateActCtxWorker
  bVar1 = (param_1 & 0xfffffffe) != 0;
  if (bVar1) {
    BaseSetLastNTError();
  }
  else {
    RtlDeactivateActivationContext(param_1 & 1);
  }
  return !bVar1;
}



int GetThreadPriority(HANDLE hThread)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001b880. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1b880  780  GetThreadPriority
  iVar1 = GetThreadPriority(hThread);
  return iVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

longlong FUN_18001b894(void)

{
  HMODULE hModule;
  FARPROC pFVar1;
  longlong lVar2;
  
  lVar2 = DAT_1800b2cf0;
  if (DAT_1800b2cf0 == 0) {
    lVar2 = 0x7ffe0030;
    hModule = LoadLibraryExW(L"ntdll.dll",(HANDLE)0x0,0x800);
    if (hModule != (HMODULE)0x0) {
      pFVar1 = GetProcAddress(hModule,"RtlGetNtSystemRoot");
      if (pFVar1 != (FARPROC)0x0) {
        lVar2 = (*pFVar1)();
      }
      FreeLibrary(hModule);
    }
  }
  DAT_1800b2cf0 = lVar2;
  return DAT_1800b2cf0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_18001b930(void)

{
  ulonglong uVar1;
  int iVar2;
  DWORD DVar3;
  int local_res20 [2];
  undefined local_18 [16];
  
  DAT_1800b2aac = 0x37;
  iVar2 = NtQueryTimerResolution(local_res20,&DAT_1800b2b28,local_18);
  if (iVar2 < 0) {
    DAT_1800b2a80 = 10;
  }
  else {
    if (local_res20[0] + 9999U < 550000) {
      DAT_1800b2aac = (local_res20[0] + 9999U) / 10000;
    }
    uVar1 = (ulonglong)(DAT_1800b2b28 + 0x26ac) / 10000;
    DAT_1800b2a80 = (undefined4)uVar1;
    if (uVar1 == 0) {
      DAT_1800b2a80 = 1;
    }
  }
  iVar2 = 100;
  do {
    iVar2 = iVar2 + -1;
    _DAT_1800b2aa8 = GetTickCount();
    _DAT_1800b2aa0 = FUN_18001ba88();
    DVar3 = GetTickCount();
    if (DVar3 == _DAT_1800b2aa8) {
      _DAT_1800b2ab0 = DAT_1800b2aac;
      DAT_1800b2ab4 = DAT_1800b2aac;
      return 1;
    }
  } while (iVar2 != 0);
  _DAT_1800b2ab0 = DAT_1800b2aac;
  DAT_1800b2ab4 = DAT_1800b2aac;
  return 1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

DWORD timeGetTime(void)

{
  BOOL BVar1;
  DWORD DVar2;
  longlong lVar3;
  
                    // 0x1ba20  1625  timeGetTime
  BVar1 = InitOnceExecuteOnce((PINIT_ONCE)&DAT_1800b2db0,FUN_18001b930,(PVOID)0x0,(LPVOID *)0x0);
  if (BVar1 != 0) {
    lVar3 = FUN_18001ba88();
    return (int)((lVar3 - _DAT_1800b2aa0) / 10000) + _DAT_1800b2aa8;
  }
                    // WARNING: Could not recover jumptable at 0x000180033d58. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar2 = GetTickCount();
  return DVar2;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_18001ba88(void)

{
  do {
  } while (_DAT_7ffe000c != _DAT_7ffe0010);
  return CONCAT44(_DAT_7ffe000c,_DAT_7ffe0008);
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void TermsrvSetValueKey(undefined param_1,undefined param_2,undefined param_3,undefined param_4,
                       undefined8 param_5,undefined4 param_6)

{
                    // 0x1bac0  1453  TermsrvSetValueKey
  if (DAT_1800b2de0 != 0) {
    (*(code *)DAT_1800b2de0)();
  }
  return;
}



BOOL SetThreadErrorMode(DWORD dwNewMode,LPDWORD lpOldMode)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001bae0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1bae0  1384  SetThreadErrorMode
  BVar1 = SetThreadErrorMode(dwNewMode,lpOldMode);
  return BVar1;
}



void TermsrvSetKeySecurity(void)

{
                    // 0x1bb00  1452  TermsrvSetKeySecurity
  if (DAT_1800b2e00 != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180026440. Too many branches
                    // WARNING: Treating indirect jump as call
    (*DAT_1800b2e00)();
    return;
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_18001bb20(undefined8 param_1,undefined **param_2,undefined8 param_3,int *param_4,
                  undefined8 param_5)

{
  if (*param_4 < 0) {
    RtlNtStatusToDosError(*param_4);
  }
  (*(code *)*param_2)();
  return;
}



void BasepFreeAppCompatData(longlong param_1,longlong param_2,longlong param_3)

{
  longlong in_GS_OFFSET;
  
                    // 0x1bb90  87  BasepFreeAppCompatData
  if (param_1 != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_1);
  }
  if (param_3 != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_3);
  }
  if (param_2 != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_2);
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_18001bc10(undefined8 param_1,int param_2,byte param_3,undefined8 param_4,undefined8 param_5
                  ,undefined8 param_6,int *param_7)

{
  int iVar1;
  
  if (param_7 != (int *)0x0) {
    if (param_2 == 0) {
      *param_7 = 0;
    }
    else if (param_2 == 1) {
      if (param_3 == 0) {
        iVar1 = 0x100;
      }
      else {
        iVar1 = param_3 + 1;
      }
      *param_7 = iVar1;
      *(undefined8 *)(param_7 + 4) = param_4;
      *(undefined8 *)(param_7 + 6) = param_5;
    }
    if (*(code **)(param_7 + 10) != (code *)0x0) {
      (**(code **)(param_7 + 10))();
    }
  }
  return;
}



BOOL FindActCtxSectionGuid
               (DWORD dwFlags,GUID *lpExtensionGuid,ULONG ulSectionId,GUID *lpGuidToFind,
               PACTCTX_SECTION_KEYED_DATA ReturnedData)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001bc90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1bc90  376  FindActCtxSectionGuid
  BVar1 = FindActCtxSectionGuid(dwFlags,lpExtensionGuid,ulSectionId,lpGuidToFind,ReturnedData);
  return BVar1;
}



HANDLE CreateFileMappingA(HANDLE hFile,LPSECURITY_ATTRIBUTES lpFileMappingAttributes,DWORD flProtect
                         ,DWORD dwMaximumSizeHigh,DWORD dwMaximumSizeLow,LPCSTR lpName)

{
  HANDLE pvVar1;
  undefined8 uVar2;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x1bcb0  200  CreateFileMappingA
  if (lpName == (LPCSTR)0x0) {
    local_10 = (LPCWSTR)0x0;
  }
  else {
    uVar2 = Basep8BitStringToDynamicUnicodeString();
    if ((int)uVar2 == 0) {
      return (HANDLE)0x0;
    }
  }
  pvVar1 = CreateFileMappingNumaW
                     (hFile,lpFileMappingAttributes,flProtect,dwMaximumSizeHigh,dwMaximumSizeLow,
                      local_10,0xffffffff);
  if (lpName != (LPCSTR)0x0) {
    RtlFreeUnicodeString(local_18);
  }
  return pvVar1;
}



HANDLE CreateSemaphoreA(LPSECURITY_ATTRIBUTES lpSemaphoreAttributes,LONG lInitialCount,
                       LONG lMaximumCount,LPCSTR lpName)

{
  HANDLE pvVar1;
  
                    // 0x1bd80  237  CreateSemaphoreA
  pvVar1 = CreateSemaphoreExA(lpSemaphoreAttributes,lInitialCount,lMaximumCount,lpName,0,0x1f0003);
  return pvVar1;
}



HANDLE CreateSemaphoreExA(LPSECURITY_ATTRIBUTES lpSemaphoreAttributes,LONG lInitialCount,
                         LONG lMaximumCount,LPCSTR lpName,DWORD dwFlags,DWORD dwDesiredAccess)

{
  LPCWSTR pWVar1;
  HANDLE pvVar2;
  undefined8 uVar3;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x1bdb0  238  CreateSemaphoreExA
  pWVar1 = (LPCWSTR)lpName;
  if ((lpName == (LPCSTR)0x0) ||
     (uVar3 = Basep8BitStringToDynamicUnicodeString(), pWVar1 = local_10, (int)uVar3 != 0)) {
    local_10 = pWVar1;
    pvVar2 = CreateSemaphoreExW(lpSemaphoreAttributes,lInitialCount,lMaximumCount,local_10,dwFlags,
                                dwDesiredAccess);
    if (lpName != (LPCSTR)0x0) {
      RtlFreeUnicodeString(local_18);
    }
  }
  else {
    pvVar2 = (HANDLE)0x0;
  }
  return pvVar2;
}



HANDLE CreateMailslotA(LPCSTR lpName,DWORD nMaxMessageSize,DWORD lReadTimeout,
                      LPSECURITY_ATTRIBUTES lpSecurityAttributes)

{
  undefined8 uVar1;
  HANDLE pvVar2;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x1be60  216  CreateMailslotA
  uVar1 = Basep8BitStringToDynamicUnicodeString();
  if ((int)uVar1 == 0) {
    pvVar2 = (HANDLE)0xffffffffffffffff;
  }
  else {
    pvVar2 = CreateMailslotW(local_10,nMaxMessageSize,lReadTimeout,lpSecurityAttributes);
    RtlFreeUnicodeString(local_18);
  }
  return pvVar2;
}



HANDLE CreateMailslotW(LPCWSTR lpName,DWORD nMaxMessageSize,DWORD lReadTimeout,
                      LPSECURITY_ATTRIBUTES lpSecurityAttributes)

{
  char cVar1;
  int iVar2;
  longlong in_GS_OFFSET;
  longlong local_88;
  HANDLE local_80;
  undefined local_78 [8];
  undefined local_70 [8];
  undefined8 local_68;
  undefined local_60 [16];
  undefined4 local_50 [2];
  undefined8 local_48;
  undefined *local_40;
  undefined4 local_38;
  undefined local_30 [16];
  
                    // 0x1bed0  217  CreateMailslotW
  RtlInitUnicodeString(local_70,lpName);
  cVar1 = RtlDosPathNameToNtPathName_U(lpName,local_70,local_78,0);
  if (cVar1 == '\0') {
    RtlSetLastWin32Error(3);
  }
  else {
    local_48 = 0;
    local_40 = local_70;
    local_50[0] = 0x30;
    local_38 = 0x40;
    local_30 = ZEXT816(0);
    if ((lpSecurityAttributes != (LPSECURITY_ATTRIBUTES)0x0) &&
       (local_30 = ZEXT816(lpSecurityAttributes->lpSecurityDescriptor), local_38 = 0x40,
       lpSecurityAttributes->bInheritHandle != 0)) {
      local_38 = 0x42;
    }
    if (lReadTimeout == 0xffffffff) {
      local_88 = -1;
    }
    else {
      local_88 = (ulonglong)lReadTimeout * -10000;
    }
    iVar2 = NtCreateMailslotFile
                      (&local_80,0x80140000,local_50,local_60,2,0,nMaxMessageSize,&local_88);
    if ((iVar2 == -0x3fffff45) || (iVar2 == -0x3ffffff0)) {
      iVar2 = -0x3fffffcd;
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_68);
    if (-1 < iVar2) {
      return local_80;
    }
    BaseSetLastNTError();
  }
  return (HANDLE)0xffffffffffffffff;
}



HANDLE OpenMutexA(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCSTR lpName)

{
  undefined8 uVar1;
  HANDLE pvVar2;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x1c020  1038  OpenMutexA
  if (lpName == (LPCSTR)0x0) {
    BaseSetLastNTError();
  }
  else {
    uVar1 = Basep8BitStringToDynamicUnicodeString();
    if ((int)uVar1 != 0) {
      pvVar2 = OpenMutexW(dwDesiredAccess,bInheritHandle,local_10);
      RtlFreeUnicodeString(local_18);
      return pvVar2;
    }
  }
  return (HANDLE)0x0;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

undefined8 Basep8BitStringToDynamicUnicodeString(void)

{
  int iVar1;
  code *pcVar2;
  undefined local_18 [16];
  
                    // 0x1c090  75  Basep8BitStringToDynamicUnicodeString
  iVar1 = RtlInitAnsiStringEx(local_18);
  if (-1 < iVar1) {
    pcVar2 = (code *)GetEightBitStringToUnicodeStringRoutine();
    iVar1 = (*pcVar2)();
    if (-1 < iVar1) {
      return 1;
    }
    if (iVar1 != -0x7ffffffb) {
      BaseSetLastNTError();
      return 0;
    }
  }
  RtlSetLastWin32Error(0xce);
  return 0;
}



BOOL HeapValidate(HANDLE hHeap,DWORD dwFlags,LPCVOID lpMem)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001c0f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1c0f0  862  HeapValidate
  BVar1 = HeapValidate(hHeap,dwFlags,lpMem);
  return BVar1;
}



BOOL GetProcessAffinityMask
               (HANDLE hProcess,PDWORD_PTR lpProcessAffinityMask,PDWORD_PTR lpSystemAffinityMask)

{
  int iVar1;
  undefined local_68 [16];
  ULONG_PTR local_58;
  _SYSTEM_INFO local_38;
  
                    // 0x1c110  698  GetProcessAffinityMask
  iVar1 = NtQueryInformationProcess(hProcess,0,local_68,0x30,0);
  if (iVar1 < 0) {
    BaseSetLastNTError();
  }
  else {
    GetSystemInfo(&local_38);
    *lpProcessAffinityMask = local_58;
    *lpSystemAffinityMask = -(ulonglong)(local_58 != 0) & local_38.dwActiveProcessorMask;
  }
  return (BOOL)(iVar1 >= 0);
}



SIZE_T VirtualQuery(LPCVOID lpAddress,PMEMORY_BASIC_INFORMATION lpBuffer,SIZE_T dwLength)

{
  SIZE_T SVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001c1a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1c1a0  1506  VirtualQuery
  SVar1 = VirtualQuery(lpAddress,lpBuffer,dwLength);
  return SVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int BasepIsProcessAllowed(void)

{
  int iVar1;
  int iVar2;
  int iVar3;
  undefined8 **ppuVar4;
  undefined8 **ppuVar5;
  int iVar6;
  undefined8 local_res10;
  
  iVar6 = 0;
                    // 0x1c1c0  93  BasepIsProcessAllowed
  iVar3 = 0;
  do {
    if (_DAT_1800b2ca8 != 0) {
      iVar3 = DAT_1800b2238;
      if ((_DAT_1800b223c != 0) &&
         (ppuVar4 = (undefined8 **)DAT_1800b2c00, iVar3 = 0,
         (undefined8 **)DAT_1800b2c00 != &DAT_1800b2c00)) {
        do {
          iVar3 = (*(code *)ppuVar4[4])();
          if (iVar3 < 0) {
            iVar6 = iVar3;
          }
          ppuVar4 = (undefined8 **)*ppuVar4;
          ppuVar5 = (undefined8 **)DAT_1800b2c00;
        } while (ppuVar4 != &DAT_1800b2c00);
        for (; iVar3 = iVar6, ppuVar5 != &DAT_1800b2c00; ppuVar5 = (undefined8 **)*ppuVar5) {
          (*(code *)ppuVar5[4])();
        }
      }
      return iVar3;
    }
    RtlAcquireSRWLockExclusive(&DAT_1800b2d00);
    if (_DAT_1800b2ca8 == 0) {
      iVar1 = NtOpenKey(&local_res10,1,&DAT_18007f630);
      iVar2 = iVar3;
      if (iVar1 < 0) {
LAB_18001c264:
        _DAT_1800b223c = iVar3;
        if ((undefined8 **)DAT_1800b2c00 != &DAT_1800b2c00) {
          _DAT_1800b223c = 1;
          iVar2 = DAT_1800b2238;
        }
      }
      else {
        NtClose(local_res10);
        iVar2 = RtlQueryRegistryValuesEx(2,L"Session Manager",&PTR_FUN_1800803f0,0,0);
        if (-1 < iVar2) goto LAB_18001c264;
        if (iVar2 == -0x3fffffcc) {
          iVar2 = 0;
        }
        _DAT_1800b223c = iVar3;
        if (-1 < iVar2) goto LAB_18001c264;
      }
      DAT_1800b2238 = iVar2;
      _DAT_1800b2ca8 = 1;
    }
    RtlReleaseSRWLockExclusive(&DAT_1800b2d00);
  } while( true );
}



BOOL PulseEvent(HANDLE hEvent)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001c2b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1c2b0  1091  PulseEvent
  BVar1 = PulseEvent(hEvent);
  return BVar1;
}



BOOL FlsSetValue(DWORD dwFlsIndex,PVOID lpFlsData)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001c2d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1c2d0  423  FlsSetValue
  BVar1 = FlsSetValue(dwFlsIndex,lpFlsData);
  return BVar1;
}



void FUN_18001c2e4(undefined4 *param_1)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  undefined4 *puVar12;
  int iVar13;
  longlong lVar14;
  undefined4 *puVar15;
  undefined4 *puVar16;
  undefined8 uVar17;
  undefined auStack1064 [32];
  longlong local_408 [2];
  undefined local_3f8 [64];
  byte local_3b8;
  undefined auStack944 [24];
  undefined local_398 [56];
  undefined auStack864 [48];
  undefined auStack816 [16];
  undefined auStack800 [744];
  undefined *local_38;
  undefined *local_30;
  undefined *local_28;
  ulonglong local_20;
  undefined *local_18;
  ulonglong local_10;
  
  local_10 = DAT_1800b2220 ^ (ulonglong)auStack1064;
  local_408[0] = 0;
  *(undefined8 *)(param_1 + 0x30) = 0;
  lVar14 = 3;
  puVar12 = (undefined4 *)&local_3b8;
  do {
    puVar16 = puVar12;
    puVar15 = param_1;
    uVar1 = puVar15[1];
    uVar2 = puVar15[2];
    uVar3 = puVar15[3];
    uVar4 = puVar15[4];
    uVar5 = puVar15[5];
    uVar6 = puVar15[6];
    uVar7 = puVar15[7];
    *puVar16 = *puVar15;
    puVar16[1] = uVar1;
    puVar16[2] = uVar2;
    puVar16[3] = uVar3;
    uVar1 = puVar15[8];
    uVar2 = puVar15[9];
    uVar3 = puVar15[10];
    uVar8 = puVar15[0xb];
    puVar16[4] = uVar4;
    puVar16[5] = uVar5;
    puVar16[6] = uVar6;
    puVar16[7] = uVar7;
    uVar4 = puVar15[0xc];
    uVar5 = puVar15[0xd];
    uVar6 = puVar15[0xe];
    uVar7 = puVar15[0xf];
    puVar16[8] = uVar1;
    puVar16[9] = uVar2;
    puVar16[10] = uVar3;
    puVar16[0xb] = uVar8;
    uVar1 = puVar15[0x10];
    uVar2 = puVar15[0x11];
    uVar3 = puVar15[0x12];
    uVar8 = puVar15[0x13];
    puVar16[0xc] = uVar4;
    puVar16[0xd] = uVar5;
    puVar16[0xe] = uVar6;
    puVar16[0xf] = uVar7;
    uVar4 = puVar15[0x14];
    uVar5 = puVar15[0x15];
    uVar6 = puVar15[0x16];
    uVar7 = puVar15[0x17];
    puVar16[0x10] = uVar1;
    puVar16[0x11] = uVar2;
    puVar16[0x12] = uVar3;
    puVar16[0x13] = uVar8;
    uVar1 = puVar15[0x18];
    uVar2 = puVar15[0x19];
    uVar3 = puVar15[0x1a];
    uVar8 = puVar15[0x1b];
    puVar16[0x14] = uVar4;
    puVar16[0x15] = uVar5;
    puVar16[0x16] = uVar6;
    puVar16[0x17] = uVar7;
    uVar4 = puVar15[0x1c];
    uVar5 = puVar15[0x1d];
    uVar6 = puVar15[0x1e];
    uVar7 = puVar15[0x1f];
    puVar16[0x18] = uVar1;
    puVar16[0x19] = uVar2;
    puVar16[0x1a] = uVar3;
    puVar16[0x1b] = uVar8;
    puVar16[0x1c] = uVar4;
    puVar16[0x1d] = uVar5;
    puVar16[0x1e] = uVar6;
    puVar16[0x1f] = uVar7;
    lVar14 = lVar14 + -1;
    param_1 = puVar15 + 0x20;
    puVar12 = puVar16 + 0x20;
  } while (lVar14 != 0);
  uVar1 = puVar15[0x21];
  uVar2 = puVar15[0x22];
  uVar3 = puVar15[0x23];
  uVar17 = *(undefined8 *)(puVar15 + 0x3c);
  uVar4 = puVar15[0x24];
  uVar5 = puVar15[0x25];
  uVar6 = puVar15[0x26];
  uVar7 = puVar15[0x27];
  puVar16[0x20] = puVar15[0x20];
  puVar16[0x21] = uVar1;
  puVar16[0x22] = uVar2;
  puVar16[0x23] = uVar3;
  uVar1 = puVar15[0x28];
  uVar2 = puVar15[0x29];
  uVar3 = puVar15[0x2a];
  uVar8 = puVar15[0x2b];
  puVar16[0x24] = uVar4;
  puVar16[0x25] = uVar5;
  puVar16[0x26] = uVar6;
  puVar16[0x27] = uVar7;
  uVar4 = puVar15[0x2c];
  uVar5 = puVar15[0x2d];
  uVar6 = puVar15[0x2e];
  uVar7 = puVar15[0x2f];
  puVar16[0x28] = uVar1;
  puVar16[0x29] = uVar2;
  puVar16[0x2a] = uVar3;
  puVar16[0x2b] = uVar8;
  uVar8 = puVar15[0x30];
  uVar9 = puVar15[0x31];
  uVar10 = puVar15[0x32];
  uVar11 = puVar15[0x33];
  puVar16[0x2c] = uVar4;
  puVar16[0x2d] = uVar5;
  puVar16[0x2e] = uVar6;
  puVar16[0x2f] = uVar7;
  uVar1 = puVar15[0x34];
  uVar2 = puVar15[0x35];
  uVar3 = puVar15[0x36];
  uVar4 = puVar15[0x37];
  puVar16[0x30] = uVar8;
  puVar16[0x31] = uVar9;
  puVar16[0x32] = uVar10;
  puVar16[0x33] = uVar11;
  uVar5 = puVar15[0x38];
  uVar6 = puVar15[0x39];
  uVar7 = puVar15[0x3a];
  uVar8 = puVar15[0x3b];
  puVar16[0x34] = uVar1;
  puVar16[0x35] = uVar2;
  puVar16[0x36] = uVar3;
  puVar16[0x37] = uVar4;
  puVar16[0x38] = uVar5;
  puVar16[0x39] = uVar6;
  puVar16[0x3a] = uVar7;
  puVar16[0x3b] = uVar8;
  *(undefined8 *)(puVar16 + 0x3c) = uVar17;
  local_38 = local_398;
  local_30 = auStack864;
  local_28 = auStack816;
  local_20 = -(ulonglong)((local_3b8 & 8) != 0) & (ulonglong)auStack800;
  local_18 = auStack944;
  iVar13 = CsrCaptureMessageMultiUnicodeStringsInPlace(local_408,5,&local_38);
  if (iVar13 < 0) {
    uVar17 = 2;
    if ((((iVar13 != -0x3ffffdfc) && (2 < iVar13 + 0x3fffff77U)) && (iVar13 != -0x3fffffcc)) &&
       (iVar13 != -0x3feafffe)) {
      uVar17 = 0;
    }
    DbgPrintEx(0x33,uVar17,"SXS: %s() CsrCaptureMessageMultiUnicodeStringsInPlace failed\n",
               "CsrBasepCreateActCtxCommon");
  }
  else {
    CsrClientCallServer(local_3f8,local_408[0],0x1001001e,0x1f8);
  }
  if (local_408[0] != 0) {
    CsrFreeCaptureBuffer();
  }
  __security_check_cookie(local_10 ^ (ulonglong)auStack1064);
  return;
}



uint lstrcmp(byte *param_1,PCNZCH param_2)

{
  byte bVar1;
  int iVar2;
  uint uVar3;
  longlong lVar4;
  
                    // 0x1c480  1606  lstrcmp
                    // 0x1c480  1607  lstrcmpA
  iVar2 = CompareStringA(0x400,0x40000000,(PCNZCH)param_1,-1,param_2,-1);
  uVar3 = 0;
  if ((iVar2 == 0) &&
     (iVar2 = CompareStringA(0x800,0x40000000,(PCNZCH)param_1,-1,param_2,-1), iVar2 == 0)) {
    if (param_1 == (byte *)0x0) {
      uVar3 = -(uint)(param_2 != (PCNZCH)0x0);
    }
    else if (param_2 == (PCNZCH)0x0) {
      uVar3 = 1;
    }
    else {
      lVar4 = (longlong)param_2 - (longlong)param_1;
      do {
        bVar1 = *param_1;
        if (bVar1 != param_1[lVar4]) {
          return -(uint)(bVar1 < param_1[lVar4]) | 1;
        }
        param_1 = param_1 + 1;
      } while (bVar1 != 0);
    }
  }
  else {
    uVar3 = iVar2 - 2;
  }
  return uVar3;
}



uint FUN_18001c48c(byte *param_1,PCNZCH param_2)

{
  byte bVar1;
  int iVar2;
  uint uVar3;
  longlong lVar4;
  
  iVar2 = CompareStringA(0x400,0x40000000,(PCNZCH)param_1,-1,param_2,-1);
  uVar3 = 0;
  if ((iVar2 == 0) &&
     (iVar2 = CompareStringA(0x800,0x40000000,(PCNZCH)param_1,-1,param_2,-1), iVar2 == 0)) {
    if (param_1 == (byte *)0x0) {
      uVar3 = -(uint)(param_2 != (PCNZCH)0x0);
    }
    else if (param_2 == (PCNZCH)0x0) {
      uVar3 = 1;
    }
    else {
      lVar4 = (longlong)param_2 - (longlong)param_1;
      do {
        bVar1 = *param_1;
        if (bVar1 != param_1[lVar4]) {
          return -(uint)(bVar1 < param_1[lVar4]) | 1;
        }
        param_1 = param_1 + 1;
      } while (bVar1 != 0);
    }
  }
  else {
    uVar3 = iVar2 - 2;
  }
  return uVar3;
}



BOOL ReadProcessMemory(HANDLE hProcess,LPCVOID lpBaseAddress,LPVOID lpBuffer,SIZE_T nSize,
                      SIZE_T *lpNumberOfBytesRead)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001c4f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1c4f0  1149  ReadProcessMemory
  BVar1 = ReadProcessMemory(hProcess,lpBaseAddress,lpBuffer,nSize,lpNumberOfBytesRead);
  return BVar1;
}



// WARNING: Could not reconcile some variable overlaps

BOOL DnsHostnameToComputerNameW(LPCWSTR Hostname,LPWSTR ComputerName,LPDWORD nSize)

{
  int iVar1;
  BOOL extraout_EAX;
  undefined auStack136 [32];
  uint local_68 [2];
  undefined2 *local_60;
  undefined local_58 [16];
  undefined2 local_48 [16];
  ulonglong local_28;
  
                    // 0x1c510  301  DnsHostnameToComputerNameW
  local_28 = DAT_1800b2220 ^ (ulonglong)auStack136;
  local_60 = local_48;
  local_68[0] = 0x200000;
  local_48[0] = 0;
  RtlInitUnicodeString(local_58,Hostname);
  iVar1 = RtlDnsHostNameToComputerName(local_68,local_58);
  if (iVar1 < 0) {
    BaseSetLastNTError();
  }
  else {
    if (*nSize < ((ushort)local_68[0] >> 1) + 1) {
      BaseSetLastNTError();
    }
    else {
      memcpy(ComputerName,local_60,(ulonglong)(ushort)local_68[0]);
      *(undefined2 *)
       ((longlong)ComputerName + ((ulonglong)(ushort)local_68[0] & 0xfffffffffffffffe)) = 0;
    }
    *nSize = local_68[0] >> 1 & 0x7fff;
  }
  __security_check_cookie(local_28 ^ (ulonglong)auStack136);
  return extraout_EAX;
}



BOOL VirtualUnlock(LPVOID lpAddress,SIZE_T dwSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001c5f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1c5f0  1508  VirtualUnlock
  BVar1 = VirtualUnlock(lpAddress,dwSize);
  return BVar1;
}



LANGID SetThreadUILanguage(LANGID LangId)

{
  LANGID LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001c610. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1c610  1397  SetThreadUILanguage
  LVar1 = SetThreadUILanguage(LangId);
  return LVar1;
}



HFILE _lclose(HFILE hFile)

{
  BOOL BVar1;
  
                    // 0x1c630  1596  _lclose
  BVar1 = CloseHandle((HANDLE)(longlong)hFile);
  return (BVar1 != 0) - 1;
}



PTP_TIMER CreateThreadpoolTimer(PTP_TIMER_CALLBACK pfnti,PVOID pv,PTP_CALLBACK_ENVIRON pcbe)

{
  int iVar1;
  PTP_TIMER local_res20;
  
                    // 0x1c660  250  CreateThreadpoolTimer
  iVar1 = TpAllocTimer(&local_res20,pfnti,pv,pcbe);
  if (iVar1 < 0) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
    local_res20 = (PTP_TIMER)0x0;
  }
  return local_res20;
}



int CompareStringW(LCID Locale,DWORD dwCmpFlags,PCNZWCH lpString1,int cchCount1,PCNZWCH lpString2,
                  int cchCount2)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001c6a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1c6a0  159  CompareStringW
  iVar1 = CompareStringW(Locale,dwCmpFlags,lpString1,cchCount1,lpString2,cchCount2);
  return iVar1;
}



BOOL GetOverlappedResult(HANDLE hFile,LPOVERLAPPED lpOverlapped,LPDWORD lpNumberOfBytesTransferred,
                        BOOL bWait)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001c6c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1c6c0  675  GetOverlappedResult
  BVar1 = GetOverlappedResult(hFile,lpOverlapped,lpNumberOfBytesTransferred,bWait);
  return BVar1;
}



undefined8 GetCurrentActCtxWorker(longlong param_1)

{
  int iVar1;
  undefined8 uVar2;
  
                    // 0x1c6e0  534  GetCurrentActCtxWorker
  uVar2 = 0;
  if ((param_1 == 0) || (iVar1 = RtlGetActiveActivationContext(), iVar1 < 0)) {
    BaseSetLastNTError();
  }
  else {
    uVar2 = 1;
  }
  return uVar2;
}



void TermsrvGetWindowsDirectoryW(void)

{
                    // 0x1c720  1448  TermsrvGetWindowsDirectoryW
  if (DAT_1800b2e18 != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180026440. Too many branches
                    // WARNING: Treating indirect jump as call
    (*DAT_1800b2e18)();
    return;
  }
  return;
}



BOOL EnumCalendarInfoExEx
               (CALINFO_ENUMPROCEXEX pCalInfoEnumProcExEx,LPCWSTR lpLocaleName,CALID Calendar,
               LPCWSTR lpReserved,CALTYPE CalType,LPARAM lParam)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001c740. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1c740  318  EnumCalendarInfoExEx
  BVar1 = EnumCalendarInfoExEx(pCalInfoEnumProcExEx,lpLocaleName,Calendar,lpReserved,CalType,lParam)
  ;
  return BVar1;
}



BOOL CreateProcessA(LPCSTR lpApplicationName,LPSTR lpCommandLine,
                   LPSECURITY_ATTRIBUTES lpProcessAttributes,
                   LPSECURITY_ATTRIBUTES lpThreadAttributes,BOOL bInheritHandles,
                   DWORD dwCreationFlags,LPVOID lpEnvironment,LPCSTR lpCurrentDirectory,
                   LPSTARTUPINFOA lpStartupInfo,LPPROCESS_INFORMATION lpProcessInformation)

{
  BOOL BVar1;
  
                    // 0x1c760  228  CreateProcessA
  BVar1 = CreateProcessA(lpApplicationName,lpCommandLine,lpProcessAttributes,lpThreadAttributes,
                         bInheritHandles,dwCreationFlags,lpEnvironment,lpCurrentDirectory,
                         lpStartupInfo,lpProcessInformation);
  return BVar1;
}



BOOL FreeLibrary(HMODULE hLibModule)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001c7d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1c7d0  437  FreeLibrary
  BVar1 = FreeLibrary(hLibModule);
  return BVar1;
}



BOOL ProcessIdToSessionId(DWORD dwProcessId,DWORD *pSessionId)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001c7f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1c7f0  1077  ProcessIdToSessionId
  BVar1 = ProcessIdToSessionId(dwProcessId,pSessionId);
  return BVar1;
}



UINT SetErrorMode(UINT uMode)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001c810. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1c810  1318  SetErrorMode
  UVar1 = SetErrorMode(uMode);
  return UVar1;
}



DWORD TlsAlloc(void)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001c830. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1c830  1457  TlsAlloc
  DVar1 = TlsAlloc();
  return DVar1;
}



HANDLE OpenThread(DWORD dwDesiredAccess,BOOL bInheritHandle,DWORD dwThreadId)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001c850. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1c850  1050  OpenThread
  pvVar1 = OpenThread(dwDesiredAccess,bInheritHandle,dwThreadId);
  return pvVar1;
}



BOOL QueryFullProcessImageNameW(HANDLE hProcess,DWORD dwFlags,LPWSTR lpExeName,PDWORD lpdwSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001c870. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1c870  1101  QueryFullProcessImageNameW
  BVar1 = QueryFullProcessImageNameW(hProcess,dwFlags,lpExeName,lpdwSize);
  return BVar1;
}



DWORD FormatMessageW(DWORD dwFlags,LPCVOID lpSource,DWORD dwMessageId,DWORD dwLanguageId,
                    LPWSTR lpBuffer,DWORD nSize,va_list *Arguments)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001c890. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1c890  433  FormatMessageW
  DVar1 = FormatMessageW(dwFlags,lpSource,dwMessageId,dwLanguageId,lpBuffer,nSize,Arguments);
  return DVar1;
}



undefined8 FUN_18001c8b0(undefined8 param_1,undefined8 param_2,undefined8 param_3)

{
  undefined8 local_res20;
  uint local_18 [6];
  
  FUN_18001b634(0xfffffffffffffffc,param_2,param_3,local_18,&local_res20);
  return 1;
}



HANDLE CreateFileMappingW(HANDLE hFile,LPSECURITY_ATTRIBUTES lpFileMappingAttributes,DWORD flProtect
                         ,DWORD dwMaximumSizeHigh,DWORD dwMaximumSizeLow,LPCWSTR lpName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001c8e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1c8e0  204  CreateFileMappingW
  pvVar1 = CreateFileMappingW(hFile,lpFileMappingAttributes,flProtect,dwMaximumSizeHigh,
                              dwMaximumSizeLow,lpName);
  return pvVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void GlobalMemoryStatus(LPMEMORYSTATUS lpBuffer)

{
  SIZE_T SVar1;
  undefined auStack120 [32];
  _MEMORYSTATUSEX local_58;
  ulonglong local_18;
  
                    // 0x1c900  838  GlobalMemoryStatus
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack120;
  memset(&local_58,0,0x40);
  local_58.dwLength = 0x40;
  GlobalMemoryStatusEx(&local_58);
  lpBuffer->dwMemoryLoad = local_58.dwMemoryLoad;
  lpBuffer->dwLength = 0x38;
  SVar1 = 0xffffffffffffffff;
  if (local_58.ullTotalPhys != 0xffffffffffffffff) {
    SVar1 = local_58.ullTotalPhys;
  }
  lpBuffer->dwTotalPhys = SVar1;
  SVar1 = 0xffffffffffffffff;
  if (local_58.ullAvailPhys != 0xffffffffffffffff) {
    SVar1 = local_58.ullAvailPhys;
  }
  lpBuffer->dwAvailPhys = SVar1;
  SVar1 = 0xffffffffffffffff;
  if (local_58.ullTotalPageFile != 0xffffffffffffffff) {
    SVar1 = local_58.ullTotalPageFile;
  }
  lpBuffer->dwTotalPageFile = SVar1;
  SVar1 = 0xffffffffffffffff;
  if (local_58.ullAvailPageFile != 0xffffffffffffffff) {
    SVar1 = local_58.ullAvailPageFile;
  }
  lpBuffer->dwAvailPageFile = SVar1;
  SVar1 = 0xffffffffffffffff;
  if (local_58.ullTotalVirtual != 0xffffffffffffffff) {
    SVar1 = local_58.ullTotalVirtual;
  }
  lpBuffer->dwTotalVirtual = SVar1;
  SVar1 = 0xffffffffffffffff;
  if (local_58.ullAvailVirtual != 0xffffffffffffffff) {
    SVar1 = local_58.ullAvailVirtual;
  }
  lpBuffer->dwAvailVirtual = SVar1;
  if (DAT_1800b2e20 != 0) {
    (*(code *)DAT_1800b2e20)();
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack120);
  return;
}



LPVOID MapViewOfFileEx(HANDLE hFileMappingObject,DWORD dwDesiredAccess,DWORD dwFileOffsetHigh,
                      DWORD dwFileOffsetLow,SIZE_T dwNumberOfBytesToMap,LPVOID lpBaseAddress)

{
  LPVOID pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001c9f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1c9f0  999  MapViewOfFileEx
  pvVar1 = MapViewOfFileEx(hFileMappingObject,dwDesiredAccess,dwFileOffsetHigh,dwFileOffsetLow,
                           dwNumberOfBytesToMap,lpBaseAddress);
  return pvVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

MMRESULT timeEndPeriod(UINT uPeriod)

{
  uint uVar1;
  short sVar2;
  BOOL BVar3;
  int iVar4;
  ulonglong uVar5;
  MMRESULT MVar6;
  MMRESULT MVar7;
  int local_res10 [2];
  undefined local_res18 [8];
  
                    // 0x1ca10  1622  timeEndPeriod
  BVar3 = InitOnceExecuteOnce((PINIT_ONCE)&DAT_1800b2db0,FUN_18001b930,(PVOID)0x0,(LPVOID *)0x0);
  MVar6 = 0;
  if ((BVar3 == 0) || (uPeriod < DAT_1800b2a80)) {
    MVar7 = 0x61;
  }
  else if (uPeriod < DAT_1800b2aac) {
    RtlAcquireSRWLockExclusive();
    uVar1 = DAT_1800b2a80;
    if (*(short *)(&DAT_1800b2ab8 + (ulonglong)(uPeriod - DAT_1800b2a80) * 2) == 0) {
      MVar7 = 0x61;
    }
    else {
      sVar2 = *(short *)(&DAT_1800b2ab8 + (ulonglong)(uPeriod - DAT_1800b2a80) * 2) + -1;
      *(short *)(&DAT_1800b2ab8 + (ulonglong)(uPeriod - DAT_1800b2a80) * 2) = sVar2;
      MVar7 = 0;
      if ((sVar2 == 0) && (MVar7 = MVar6, uPeriod == _DAT_1800b2ab0)) {
        while ((uPeriod < DAT_1800b2aac &&
               (*(short *)(&DAT_1800b2ab8 + (ulonglong)(uPeriod - uVar1) * 2) == 0))) {
          uPeriod = uPeriod + 1;
        }
        uVar5 = 0;
        NtSetTimerResolution(DAT_1800b2ab4 * 10000,0,local_res18);
        DAT_1800b2ab4 = DAT_1800b2aac;
        _DAT_1800b2ab0 = uPeriod;
        if ((uPeriod < DAT_1800b2aac) &&
           (iVar4 = NtSetTimerResolution(uPeriod * 10000,uVar5 & 0xffffffffffffff00 | 1,local_res10)
           , -1 < iVar4)) {
          DAT_1800b2ab4 = (local_res10[0] + 9999U) / 10000;
        }
      }
    }
    RtlReleaseSRWLockExclusive(&DAT_1800b2d20);
  }
  else {
    MVar7 = 0;
  }
  return MVar7;
}



int GetLocaleInfoEx(LPCWSTR lpLocaleName,LCTYPE LCType,LPWSTR lpLCData,int cchData)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001cb40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1cb40  622  GetLocaleInfoEx
  iVar1 = GetLocaleInfoEx(lpLocaleName,LCType,lpLCData,cchData);
  return iVar1;
}



BOOL CreateProcessW(LPCWSTR lpApplicationName,LPWSTR lpCommandLine,
                   LPSECURITY_ATTRIBUTES lpProcessAttributes,
                   LPSECURITY_ATTRIBUTES lpThreadAttributes,BOOL bInheritHandles,
                   DWORD dwCreationFlags,LPVOID lpEnvironment,LPCWSTR lpCurrentDirectory,
                   LPSTARTUPINFOW lpStartupInfo,LPPROCESS_INFORMATION lpProcessInformation)

{
  BOOL BVar1;
  
                    // 0x1cb60  233  CreateProcessW
  BVar1 = CreateProcessW(lpApplicationName,lpCommandLine,lpProcessAttributes,lpThreadAttributes,
                         bInheritHandles,dwCreationFlags,lpEnvironment,lpCurrentDirectory,
                         lpStartupInfo,lpProcessInformation);
  return BVar1;
}



int WerSetFlags(undefined4 param_1)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  longlong lVar4;
  char *pcVar5;
  undefined8 uVar6;
  
                    // 0x1cbd0  1537  WerSetFlags
                    // 0x1cbd0  1538  WerSetFlagsWorker
  lVar4 = FUN_18001ce80();
  if (lVar4 == 0) {
    uVar6 = 0xfd0;
    pcVar5 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
  }
  else {
    iVar1 = FUN_18001ccd4();
    if (iVar1 < 0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpInitPEBStore failed\n",0xfd6);
      return iVar1;
    }
    iVar2 = FUN_18001ce14();
    if (-1 < iVar2) {
      lVar4 = *(longlong *)(lVar4 + 0x358);
      if ((lVar4 == 0) || (uVar3 = FUN_18001cc84(lVar4), (int)uVar3 < 0)) {
        DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid PEB entry\n",0xfe6);
      }
      else {
        *(undefined4 *)(lVar4 + 0x914) = param_1;
        iVar1 = 0;
      }
      RtlReleasePebLock();
      return iVar1;
    }
    uVar6 = 0xfdc;
    pcVar5 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
  }
  DbgPrintEx(0x96,0,pcVar5,uVar6);
  return -0x7fffbffb;
}



int FUN_18001cbdc(undefined4 param_1)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  longlong lVar4;
  char *pcVar5;
  undefined8 uVar6;
  
  lVar4 = FUN_18001ce80();
  if (lVar4 == 0) {
    uVar6 = 0xfd0;
    pcVar5 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
  }
  else {
    iVar1 = FUN_18001ccd4();
    if (iVar1 < 0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpInitPEBStore failed\n",0xfd6);
      return iVar1;
    }
    iVar2 = FUN_18001ce14();
    if (-1 < iVar2) {
      lVar4 = *(longlong *)(lVar4 + 0x358);
      if ((lVar4 == 0) || (uVar3 = FUN_18001cc84(lVar4), (int)uVar3 < 0)) {
        DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid PEB entry\n",0xfe6);
      }
      else {
        *(undefined4 *)(lVar4 + 0x914) = param_1;
        iVar1 = 0;
      }
      RtlReleasePebLock();
      return iVar1;
    }
    uVar6 = 0xfdc;
    pcVar5 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
  }
  DbgPrintEx(0x96,0,pcVar5,uVar6);
  return -0x7fffbffb;
}



uint FUN_18001cc84(longlong param_1)

{
  int iVar1;
  uint uVar2;
  
  if (param_1 == 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid args\n",500);
    uVar2 = 0x80070057;
  }
  else {
    iVar1 = wcsncmp((wchar_t *)(param_1 + 4),L"PEB_SIGNATURE",0xe);
    uVar2 = -(uint)(iVar1 != 0) & 0x80004005;
  }
  return uVar2;
}



int FUN_18001ccd4(void)

{
  int iVar1;
  uint uVar2;
  longlong lVar3;
  undefined4 *puVar4;
  int iVar5;
  char *pcVar6;
  undefined8 uVar7;
  undefined4 uVar8;
  
  uVar8 = 0x80004005;
  lVar3 = FUN_18001ce80();
  iVar5 = 0;
  if (lVar3 == 0) {
    uVar7 = 0x271;
    pcVar6 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
  }
  else {
    iVar1 = FUN_18001ce14();
    if (-1 < iVar1) {
      if (*(longlong *)(lVar3 + 0x358) == 0) {
        puVar4 = (undefined4 *)VirtualAlloc((LPVOID)0x0,0x968,0x3000,4);
        *(undefined4 **)(lVar3 + 0x358) = puVar4;
        if (puVar4 == (undefined4 *)0x0) {
          DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR VirtualAlloc failed\n",0x289,uVar8);
          iVar5 = -0x7ff8fff2;
        }
        else {
          if ((*(short *)(puVar4 + 0x246) == 0) &&
             (uVar2 = FUN_18001ced0((short *)(puVar4 + 0x246)), (int)uVar2 < 0)) {
            uVar7 = 0x29b;
            pcVar6 = "WER/CrashAPI:%u: ERROR WerpHeapInitialize failed\n";
          }
          else {
            uVar2 = FUN_18001cf30((short *)(puVar4 + 1),0xe,L"PEB_SIGNATURE");
            if (-1 < (int)uVar2) {
              *puVar4 = 0x968;
              goto LAB_18001cde1;
            }
            uVar7 = 0x2a4;
            pcVar6 = "WER/CrashAPI:%u: ERROR Could not set the peb signature\n";
          }
          DbgPrintEx(0x96,0,pcVar6,uVar7);
          iVar5 = -0x7fffbffb;
        }
      }
LAB_18001cde1:
      if ((iVar5 < 0) && (*(LPVOID *)(lVar3 + 0x358) != (LPVOID)0x0)) {
        VirtualFree(*(LPVOID *)(lVar3 + 0x358),0,0x8000);
        *(undefined8 *)(lVar3 + 0x358) = 0;
      }
      RtlReleasePebLock();
      return iVar5;
    }
    uVar7 = 0x277;
    pcVar6 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
  }
  DbgPrintEx(0x96,0,pcVar6,uVar7,uVar8);
  return -0x7fffbffb;
}



undefined4 FUN_18001ce14(void)

{
  int iVar1;
  int iVar2;
  
  iVar2 = 0;
  while( true ) {
    if (199 < iVar2) {
      return 0x80004005;
    }
    iVar1 = RtlTryAcquirePebLock();
    if (iVar1 != 0) break;
    Sleep(10);
    iVar2 = iVar2 + 1;
  }
  return 0;
}



undefined8 FUN_18001ce80(void)

{
  longlong in_GS_OFFSET;
  
  return *(undefined8 *)(in_GS_OFFSET + 0x60);
}



uint FUN_18001ced0(short *param_1)

{
  uint uVar1;
  HANDLE pvVar2;
  
  memset(param_1,0,0x48);
  uVar1 = FUN_18001cf30(param_1,0xf,L"HEAP_SIGNATURE");
  if ((int)uVar1 < 0) {
    DbgPrintEx(0x96,0,"WER/Heap:%u: ERROR Could not set heap signature\n");
    uVar1 = 0x80004005;
  }
  else {
    pvVar2 = CreateMutexW((LPSECURITY_ATTRIBUTES)0x0,0,(LPCWSTR)0x0);
    *(HANDLE *)(param_1 + 0x18) = pvVar2;
    uVar1 = ~-(uint)(pvVar2 != (HANDLE)0x0) & 0x80004005;
  }
  return uVar1;
}



uint FUN_18001cf30(short *param_1,longlong param_2,undefined8 param_3)

{
  uint uVar1;
  
  uVar1 = 0;
  if (0x7ffffffe < param_2 - 1U) {
    uVar1 = 0x80070057;
  }
  if ((int)uVar1 < 0) {
    if (param_2 != 0) {
      *param_1 = 0;
    }
  }
  else {
    uVar1 = FUN_18001cf74(param_1,param_2,param_3,param_3);
  }
  return uVar1;
}



uint FUN_18001cf74(short *param_1,longlong param_2,undefined8 param_3,longlong param_4)

{
  short sVar1;
  longlong lVar2;
  short *psVar3;
  longlong lVar4;
  
  if (param_2 != 0) {
    lVar2 = 0x7ffffffe;
    lVar4 = param_4 - (longlong)param_1;
    do {
      if ((lVar2 == 0) || (sVar1 = *(short *)(lVar4 + (longlong)param_1), sVar1 == 0)) break;
      *param_1 = sVar1;
      lVar2 = lVar2 + -1;
      param_1 = param_1 + 1;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
  }
  psVar3 = param_1 + -1;
  if (param_2 != 0) {
    psVar3 = param_1;
  }
  *psVar3 = 0;
  return ~-(uint)(param_2 != 0) & 0x8007007a;
}



DWORD GetProcessId(HANDLE Process)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001cfd0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1cfd0  705  GetProcessId
  DVar1 = GetProcessId(Process);
  return DVar1;
}



SIZE_T VirtualQueryEx(HANDLE hProcess,LPCVOID lpAddress,PMEMORY_BASIC_INFORMATION lpBuffer,
                     SIZE_T dwLength)

{
  SIZE_T SVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001cff0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1cff0  1507  VirtualQueryEx
  SVar1 = VirtualQueryEx(hProcess,lpAddress,lpBuffer,dwLength);
  return SVar1;
}



void BasepCheckWebBladeHashes(undefined8 param_1)

{
  int iVar1;
  uint uVar2;
  ulonglong uVar3;
  undefined *_Base;
  undefined auStackY88 [32];
  undefined local_28 [16];
  ulonglong local_18;
  
                    // 0x1d010  81  BasepCheckWebBladeHashes
  local_18 = DAT_1800b2220 ^ (ulonglong)auStackY88;
  uVar3 = RtlGetSuiteMask();
  if (((uVar3 & 0x6c00) != 0) && (iVar1 = RtlComputeImportTableHash(param_1,local_28,1), -1 < iVar1)
     ) {
    uVar2 = RtlGetSuiteMask();
    if ((uVar2 >> 0xe & 1) == 0) {
      uVar2 = RtlGetSuiteMask();
      if ((uVar2 >> 0xd & 1) == 0) {
        bsearch(local_28,&DAT_180088e20,0x17,0x10,FUN_180020550);
        goto LAB_18001d041;
      }
      uVar2 = 8;
      _Base = &DAT_180088da0;
    }
    else {
      _Base = &DAT_180088c70;
      uVar2 = 0x13;
    }
    bsearch(local_28,_Base,(ulonglong)uVar2,0x10,FUN_180020550);
  }
LAB_18001d041:
  __security_check_cookie(local_18 ^ (ulonglong)auStackY88);
  return;
}



BOOL GetExitCodeProcess(HANDLE hProcess,LPDWORD lpExitCode)

{
  BOOL BVar1;
  DWORD DVar2;
  int iVar3;
  
                    // 0x1d060  583  GetExitCodeProcess
  BVar1 = GetExitCodeProcess(hProcess,lpExitCode);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
    iVar3 = FUN_18003d7dc(hProcess,lpExitCode);
    if (iVar3 == 0) {
      RtlSetLastWin32Error(DVar2);
      return 0;
    }
  }
  return 1;
}



BOOL GetThreadPreferredUILanguages
               (DWORD dwFlags,PULONG pulNumLanguages,PZZWSTR pwszLanguagesBuffer,
               PULONG pcchLanguagesBuffer)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001d0b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1d0b0  779  GetThreadPreferredUILanguages
  BVar1 = GetThreadPreferredUILanguages
                    (dwFlags,pulNumLanguages,pwszLanguagesBuffer,pcchLanguagesBuffer);
  return BVar1;
}



BOOL QueryUnbiasedInterruptTime(PULONGLONG UnbiasedTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001d0d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1d0d0  1116  QueryUnbiasedInterruptTime
  BVar1 = QueryUnbiasedInterruptTime(UnbiasedTime);
  return BVar1;
}



BOOL IsThreadAFiber(void)

{
  longlong in_GS_OFFSET;
  
                    // 0x1d0f0  911  IsThreadAFiber
  return *(ushort *)(*(longlong *)(in_GS_OFFSET + 0x30) + 0x17ee) >> 2 & 1;
}



void OutputDebugStringW(LPCWSTR lpOutputString)

{
                    // WARNING: Could not recover jumptable at 0x00018001d110. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1d110  1055  OutputDebugStringW
  OutputDebugStringW(lpOutputString);
  return;
}



HMODULE GetModuleHandleW(LPCWSTR lpModuleName)

{
  HMODULE pHVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001d130. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1d130  642  GetModuleHandleW
  pHVar1 = GetModuleHandleW(lpModuleName);
  return pHVar1;
}



undefined8
FUN_18001d144(undefined8 *param_1,uint **param_2,uint param_3,undefined8 param_4,longlong param_5,
             uint param_6,uint param_7)

{
  uint *puVar1;
  uint uVar2;
  int *piVar3;
  undefined8 uVar4;
  undefined4 *puVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  ulonglong uVar9;
  uint uVar10;
  undefined8 in_stack_ffffffffffffff38;
  undefined4 uVar11;
  undefined8 in_stack_ffffffffffffff40;
  undefined4 uVar12;
  uint local_98;
  undefined4 local_94;
  undefined8 local_90;
  undefined8 local_88;
  undefined8 local_80;
  undefined4 local_78 [2];
  undefined8 local_70;
  undefined4 local_68;
  undefined local_60 [56];
  
  uVar11 = (undefined4)((ulonglong)in_stack_ffffffffffffff38 >> 0x20);
  uVar12 = (undefined4)((ulonglong)in_stack_ffffffffffffff40 >> 0x20);
  uVar7 = 0;
  uVar8 = 0;
  uVar9 = 0;
  uVar6 = 0x48;
  if ((param_3 & 6) != 0) {
    do {
      uVar7 = uVar7 + 1;
      piVar3 = (int *)(uVar9 + param_5);
      uVar9 = (ulonglong)(uint)((int)uVar9 + *piVar3);
      uVar8 = uVar8 + piVar3[1];
    } while (*piVar3 != 0);
    if ((param_3 & 2) != 0) {
      uVar6 = uVar7 * 0x238 + 0x48;
    }
    if ((param_3 & 4) != 0) {
      uVar6 = uVar6 + uVar8 * 0x1c;
    }
  }
  uVar2 = uVar6;
  uVar10 = 0;
  if ((((param_3 & 8) == 0) ||
      (((ulonglong)param_6 * 0x438 < 0x100000000 &&
       (uVar2 = (int)((ulonglong)param_6 * 0x438) + uVar6, uVar10 = param_6, uVar6 <= uVar2)))) &&
     ((uVar6 = 0, local_98 = uVar2, (param_3 & 1) == 0 ||
      (((ulonglong)param_7 << 5 < 0x100000000 &&
       (local_98 = (int)((ulonglong)param_7 << 5) + uVar2, uVar6 = param_7, uVar2 <= local_98))))))
  {
    if ((int)param_3 < 0) {
      local_70 = 0;
      puVar5 = local_78;
      local_78[0] = 0x18;
      local_68 = 1;
    }
    else {
      puVar5 = (undefined4 *)0x0;
    }
    uVar4 = BaseFormatObjectAttributes(local_60,puVar5,0,&local_88);
    if (-1 < (int)uVar4) {
      local_94 = 0;
      uVar4 = NtCreateSection(param_1,0xf0007,local_88,&local_98,CONCAT44(uVar11,4),
                              CONCAT44(uVar12,0x8000000),0);
      if (-1 < (int)uVar4) {
        local_90 = 0;
        local_80 = 0;
        uVar4 = NtMapViewOfSection(*param_1,0xffffffffffffffff,param_2,0,0,&local_90,&local_80,1,0,4
                                  );
        if (-1 < (int)uVar4) {
          puVar1 = *param_2;
          puVar1[1] = uVar7;
          *puVar1 = uVar6;
          puVar1[2] = uVar10;
          puVar1[3] = uVar8;
          uVar4 = 0;
        }
      }
    }
  }
  else {
    uVar4 = 0xc0000173;
  }
  return uVar4;
}



PRUNTIME_FUNCTION
RtlLookupFunctionEntry(DWORD64 ControlPc,PDWORD64 ImageBase,PUNWIND_HISTORY_TABLE HistoryTable)

{
  PRUNTIME_FUNCTION p_Var1;
  
                    // WARNING: Could not recover jumptable at 0x00018001d2f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1d2f0  1245  RtlLookupFunctionEntry
  p_Var1 = RtlLookupFunctionEntry(ControlPc,ImageBase,HistoryTable);
  return p_Var1;
}



undefined8 BaseElevationPostProcessing(ulonglong param_1,short param_2,undefined8 param_3)

{
  undefined8 uVar1;
  undefined4 local_res8 [8];
  
                    // 0x1d310  53  BaseElevationPostProcessing
  uVar1 = 0;
  if (((param_1 & 2) != 0) && ((param_2 == 0 || (param_2 == 10)))) {
    local_res8[0] = 1;
    uVar1 = NtSetInformationProcess(param_3,0x30,local_res8);
  }
  return uVar1;
}



void TermsrvOpenUserClasses(void)

{
                    // 0x1d360  1450  TermsrvOpenUserClasses
  if (DAT_1800b2e08 != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180026440. Too many branches
                    // WARNING: Treating indirect jump as call
    (*DAT_1800b2e08)();
    return;
  }
  return;
}



BOOL TlsFree(DWORD dwTlsIndex)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001d380. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1d380  1458  TlsFree
  BVar1 = TlsFree(dwTlsIndex);
  return BVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void TermsrvCreateRegEntry
               (undefined param_1,undefined param_2,undefined param_3,undefined param_4,
               undefined4 param_5)

{
                    // 0x1d3a0  1443  TermsrvCreateRegEntry
  if (DAT_1800b2dd0 != 0) {
    (*(code *)DAT_1800b2dd0)();
  }
  return;
}



PVOID RtlPcToFileHeader(PVOID PcValue,PVOID *BaseOfImage)

{
  PVOID pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001d3c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1d3c0  1247  RtlPcToFileHeader
  pvVar1 = RtlPcToFileHeader(PcValue,BaseOfImage);
  return pvVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

uint GetSystemDirectoryA(undefined8 param_1,ushort param_2)

{
  int iVar1;
  longlong lVar2;
  code *pcVar3;
  uint auStackX24 [4];
  ushort uStack24;
  
                    // 0x1d3e0  746  GetSystemDirectoryA
  lVar2 = KernelBaseGetGlobalData();
  iVar1 = RtlUnicodeToMultiByteSize
                    (auStackX24,*(undefined8 *)(lVar2 + 0x20),*(undefined2 *)(lVar2 + 0x1a));
  if (-1 < iVar1) {
    if (param_2 < (ushort)auStackX24[0]) {
      return auStackX24[0];
    }
    pcVar3 = (code *)GetUnicodeStringToEightBitStringRoutine();
    iVar1 = (*pcVar3)();
    if (-1 < iVar1) {
      return (uint)uStack24;
    }
  }
  return 0;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

uint FUN_18001d3ec(undefined8 param_1,ushort param_2)

{
  int iVar1;
  longlong lVar2;
  code *pcVar3;
  uint local_res18 [4];
  ushort local_18;
  
  lVar2 = KernelBaseGetGlobalData();
  iVar1 = RtlUnicodeToMultiByteSize
                    (local_res18,*(undefined8 *)(lVar2 + 0x20),*(undefined2 *)(lVar2 + 0x1a));
  if (-1 < iVar1) {
    if (param_2 < (ushort)local_res18[0]) {
      return local_res18[0];
    }
    pcVar3 = (code *)GetUnicodeStringToEightBitStringRoutine();
    iVar1 = (*pcVar3)();
    if (-1 < iVar1) {
      return (uint)local_18;
    }
  }
  return 0;
}



HANDLE GetStdHandle(DWORD nStdHandle)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001d490. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1d490  733  GetStdHandle
  pvVar1 = GetStdHandle(nStdHandle);
  return pvVar1;
}



DWORD GetActiveProcessorCount(WORD GroupNumber)

{
  byte bVar1;
  ushort uVar2;
  uint uVar3;
  undefined8 uVar4;
  byte *pbVar5;
  ulonglong uVar6;
  ushort uVar7;
  longlong in_GS_OFFSET;
  DWORD local_res10 [2];
  PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX local_res18 [2];
  
                    // 0x1d4b0  445  GetActiveProcessorCount
  uVar4 = FUN_18001d558(local_res18,local_res10);
  uVar7 = 0;
  if ((int)uVar4 == 0) {
    uVar3 = 0;
  }
  else {
    if (GroupNumber == 0xffff) {
      uVar2 = *(ushort *)&(local_res18[0]->u).field_0x2;
      uVar7 = 0;
      if (uVar2 != 0) {
        pbVar5 = &(local_res18[0]->u).field_0x19;
        uVar6 = (ulonglong)uVar2;
        do {
          bVar1 = *pbVar5;
          pbVar5 = pbVar5 + 0x30;
          uVar7 = uVar7 + bVar1;
          uVar6 = uVar6 - 1;
        } while (uVar6 != 0);
      }
    }
    else if (GroupNumber < *(ushort *)&(local_res18[0]->u).field_0x2) {
      uVar7 = (ushort)(byte)(&(local_res18[0]->u).field_0x19)[(ulonglong)GroupNumber * 0x30];
    }
    else {
      RtlSetLastWin32Error(0x57);
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_res18[0]);
    uVar3 = (uint)uVar7;
  }
  return uVar3;
}



undefined8 FUN_18001d558(PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX *param_1,DWORD *param_2)

{
  BOOL BVar1;
  DWORD DVar2;
  PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX Buffer;
  undefined8 uVar3;
  longlong in_GS_OFFSET;
  DWORD local_res18 [4];
  
  local_res18[0] = 0;
  BVar1 = GetLogicalProcessorInformationEx
                    (RelationGroup,(PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX)0x0,local_res18);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
    if (DVar2 != 0x7a) {
      return 0;
    }
    Buffer = (PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX)
             RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                             local_res18[0]);
    if (Buffer != (PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX)0x0) {
      BVar1 = GetLogicalProcessorInformationEx(RelationGroup,Buffer,local_res18);
      if (BVar1 == 0) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,Buffer);
        return 0;
      }
      *param_2 = local_res18[0];
      *param_1 = Buffer;
      return 1;
    }
    uVar3 = 8;
  }
  else {
    uVar3 = 0xd;
  }
  RtlSetLastWin32Error(uVar3);
  return 0;
}



int CompareStringA(LCID Locale,DWORD dwCmpFlags,PCNZCH lpString1,int cchCount1,PCNZCH lpString2,
                  int cchCount2)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001d620. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1d620  156  CompareStringA
  iVar1 = CompareStringA(Locale,dwCmpFlags,lpString1,cchCount1,lpString2,cchCount2);
  return iVar1;
}



ulonglong FUN_18001d634(longlong *param_1,ulonglong param_2,longlong param_3)

{
  undefined2 *puVar1;
  ulonglong uVar2;
  longlong lVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  longlong in_GS_OFFSET;
  
  uVar5 = 0;
  uVar4 = uVar5;
  uVar6 = uVar5;
  if (param_2 != 0) {
    do {
      uVar2 = *(ushort *)(*(longlong *)(param_3 + uVar6 * 8) + 2) + uVar4;
      if (uVar2 < uVar4) {
        return 0xc0000095;
      }
      uVar6 = uVar6 + 1;
      uVar4 = uVar2;
    } while (uVar6 != param_2);
  }
  lVar3 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
  *param_1 = lVar3;
  if (lVar3 == 0) {
    uVar5 = 0xc0000017;
  }
  else {
    uVar4 = uVar5;
    if (param_2 != 0) {
      do {
        puVar1 = *(undefined2 **)(param_3 + uVar4 * 8);
        *puVar1 = 0;
        if (uVar4 == 0) {
          lVar3 = *param_1;
        }
        else {
          lVar3 = *(longlong *)(param_3 + -8 + uVar4 * 8);
          lVar3 = (ulonglong)*(ushort *)(lVar3 + 2) + *(longlong *)(lVar3 + 8);
        }
        uVar4 = uVar4 + 1;
        *(longlong *)(puVar1 + 4) = lVar3;
      } while (uVar4 != param_2);
    }
  }
  return uVar5;
}



BOOL SetInformationJobObject
               (HANDLE hJob,JOBOBJECTINFOCLASS JobObjectInformationClass,
               LPVOID lpJobObjectInformation,DWORD cbJobObjectInformationLength)

{
  int iVar1;
  BOOL extraout_EAX;
  int iVar2;
  bool bVar3;
  undefined auStack264 [32];
  undefined4 local_e8 [2];
  undefined8 local_e0;
  undefined local_d8 [16];
  byte local_c8;
  int local_a0;
  ulonglong local_48;
  
                    // 0x1d700  1343  SetInformationJobObject
  local_48 = DAT_1800b2220 ^ (ulonglong)auStack264;
  local_e0 = 0;
  iVar2 = -0x3fffffff;
  if (JobObjectInformationClass == JobObjectBasicLimitInformation) {
    bVar3 = cbJobObjectInformationLength == 0x40;
LAB_18001d756:
    if (!bVar3) {
      BaseSetLastNTError();
      goto LAB_18001d7af;
    }
    memcpy(local_d8,lpJobObjectInformation,(ulonglong)cbJobObjectInformationLength);
    if ((local_c8 & 0x20) != 0) {
      if (local_a0 == 0x20) {
LAB_1800343ce:
        local_a0 = 2;
      }
      else if (local_a0 == 0x40) {
        local_a0 = 1;
      }
      else if (local_a0 == 0x80) {
        local_a0 = 3;
      }
      else if (local_a0 == 0x100) {
        local_a0 = 4;
      }
      else if (local_a0 == 0x4000) {
        local_a0 = 5;
      }
      else {
        if (local_a0 != 0x8000) goto LAB_1800343ce;
        local_a0 = 6;
      }
    }
    lpJobObjectInformation = local_d8;
    if ((local_c8 & 1) != 0) {
      local_e8[0] = 0xe;
      iVar2 = RtlAcquirePrivilege(local_e8,1,0,&local_e0);
    }
  }
  else if (JobObjectInformationClass == JobObjectExtendedLimitInformation) {
    bVar3 = cbJobObjectInformationLength == 0x90;
    goto LAB_18001d756;
  }
  iVar1 = NtSetInformationJobObject
                    (hJob,JobObjectInformationClass,lpJobObjectInformation,
                     (ulonglong)cbJobObjectInformationLength);
  if (-1 < iVar2) {
    RtlReleasePrivilege(local_e0);
    local_e0 = 0;
  }
  if (iVar1 < 0) {
    BaseSetLastNTError();
  }
LAB_18001d7af:
  __security_check_cookie(local_48 ^ (ulonglong)auStack264);
  return extraout_EAX;
}



LPVOID MapViewOfFile(HANDLE hFileMappingObject,DWORD dwDesiredAccess,DWORD dwFileOffsetHigh,
                    DWORD dwFileOffsetLow,SIZE_T dwNumberOfBytesToMap)

{
  LPVOID pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001d7f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1d7f0  998  MapViewOfFile
  pvVar1 = MapViewOfFile(hFileMappingObject,dwDesiredAccess,dwFileOffsetHigh,dwFileOffsetLow,
                         dwNumberOfBytesToMap);
  return pvVar1;
}



void ReleaseActCtxWorker(void)

{
                    // WARNING: Could not recover jumptable at 0x00018001d810. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1d810  1206  ReleaseActCtxWorker
  RtlReleaseActivationContext();
  return;
}



void GetStartupInfoW(LPSTARTUPINFOW lpStartupInfo)

{
                    // WARNING: Could not recover jumptable at 0x00018001d830. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1d830  731  GetStartupInfoW
  GetStartupInfoW(lpStartupInfo);
  return;
}



BOOL QueryInformationJobObject
               (HANDLE hJob,JOBOBJECTINFOCLASS JobObjectInformationClass,
               LPVOID lpJobObjectInformation,DWORD cbJobObjectInformationLength,
               LPDWORD lpReturnLength)

{
  int iVar1;
  BOOL extraout_EAX;
  undefined4 in_register_00000014;
  undefined *puVar2;
  bool bVar3;
  undefined auStack248 [32];
  LPDWORD local_d8;
  undefined local_c8 [56];
  int local_90;
  ulonglong local_38;
  
                    // 0x1d850  1104  QueryInformationJobObject
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack248;
  if (JobObjectInformationClass == JobObjectBasicLimitInformation) {
    bVar3 = cbJobObjectInformationLength == 0x40;
LAB_18001d893:
    puVar2 = local_c8;
    if (!bVar3) {
      BaseSetLastNTError();
      goto LAB_18001d8fd;
    }
  }
  else {
    puVar2 = (undefined *)lpJobObjectInformation;
    if (JobObjectInformationClass == JobObjectExtendedLimitInformation) {
      bVar3 = cbJobObjectInformationLength == 0x90;
      goto LAB_18001d893;
    }
  }
  local_d8 = lpReturnLength;
  iVar1 = NtQueryInformationJobObject
                    (hJob,CONCAT44(in_register_00000014,JobObjectInformationClass),puVar2,
                     (ulonglong)cbJobObjectInformationLength);
  if (iVar1 < 0) {
    BaseSetLastNTError();
    goto LAB_18001d8fd;
  }
  if (puVar2 != local_c8) goto LAB_18001d8fd;
  if (local_90 == 1) {
    local_90 = 0x40;
  }
  else if (local_90 == 2) {
LAB_18001d8e5:
    local_90 = 0x20;
  }
  else if (local_90 == 3) {
    local_90 = 0x80;
  }
  else if (local_90 == 4) {
    local_90 = 0x100;
  }
  else if (local_90 == 5) {
    local_90 = 0x4000;
  }
  else {
    if (local_90 != 6) goto LAB_18001d8e5;
    local_90 = 0x8000;
  }
  memcpy(lpJobObjectInformation,local_c8,(ulonglong)cbJobObjectInformationLength);
LAB_18001d8fd:
  __security_check_cookie(local_38 ^ (ulonglong)auStack248);
  return extraout_EAX;
}



HANDLE CreateIoCompletionPort
                 (HANDLE FileHandle,HANDLE ExistingCompletionPort,ULONG_PTR CompletionKey,
                 DWORD NumberOfConcurrentThreads)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001d950. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1d950  212  CreateIoCompletionPort
  pvVar1 = CreateIoCompletionPort
                     (FileHandle,ExistingCompletionPort,CompletionKey,NumberOfConcurrentThreads);
  return pvVar1;
}



BOOL SetThreadPreferredUILanguages
               (DWORD dwFlags,PCZZWSTR pwszLanguagesBuffer,PULONG pulNumLanguages)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001d970. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1d970  1391  SetThreadPreferredUILanguages
  BVar1 = SetThreadPreferredUILanguages(dwFlags,pwszLanguagesBuffer,pulNumLanguages);
  return BVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

MMRESULT timeBeginPeriod(UINT uPeriod)

{
  short sVar1;
  BOOL BVar2;
  uint uVar3;
  int iVar4;
  MMRESULT MVar5;
  uint local_res10 [2];
  
                    // 0x1d990  1621  timeBeginPeriod
  BVar2 = InitOnceExecuteOnce((PINIT_ONCE)&DAT_1800b2db0,FUN_18001b930,(PVOID)0x0,(LPVOID *)0x0);
  if ((BVar2 != 0) && (DAT_1800b2a80 <= uPeriod)) {
    if (DAT_1800b2aac <= uPeriod) {
      return 0;
    }
    RtlAcquireSRWLockExclusive();
    uVar3 = uPeriod - DAT_1800b2a80;
    if (*(short *)(&DAT_1800b2ab8 + (ulonglong)uVar3 * 2) != -1) {
      sVar1 = *(short *)(&DAT_1800b2ab8 + (ulonglong)uVar3 * 2) + 1;
      *(short *)(&DAT_1800b2ab8 + (ulonglong)uVar3 * 2) = sVar1;
      MVar5 = 0;
      if ((sVar1 == 1) && (MVar5 = 0, uPeriod < DAT_1800b2ab4)) {
        local_res10[0] = uPeriod * 10000;
        if (uPeriod * 10000 < DAT_1800b2b28) {
          local_res10[0] = DAT_1800b2b28;
        }
        iVar4 = NtSetTimerResolution(local_res10[0],uVar3 & 0xffffff00 | 1,local_res10);
        if (iVar4 < 0) {
          MVar5 = 0x61;
          *(short *)(&DAT_1800b2ab8 + (ulonglong)(uPeriod - DAT_1800b2a80) * 2) =
               *(short *)(&DAT_1800b2ab8 + (ulonglong)(uPeriod - DAT_1800b2a80) * 2) + -1;
        }
        else {
          DAT_1800b2ab4 = (local_res10[0] + 0x26ac) / 10000;
          _DAT_1800b2ab0 = uPeriod;
        }
      }
      RtlReleaseSRWLockExclusive(&DAT_1800b2d20);
      return MVar5;
    }
    RtlReleaseSRWLockExclusive(&DAT_1800b2d20);
  }
  return 0x61;
}



BOOL CreateProcessAsUserW
               (HANDLE hToken,LPCWSTR lpApplicationName,LPWSTR lpCommandLine,
               LPSECURITY_ATTRIBUTES lpProcessAttributes,LPSECURITY_ATTRIBUTES lpThreadAttributes,
               BOOL bInheritHandles,DWORD dwCreationFlags,LPVOID lpEnvironment,
               LPCWSTR lpCurrentDirectory,LPSTARTUPINFOW lpStartupInfo,
               LPPROCESS_INFORMATION lpProcessInformation)

{
  BOOL BVar1;
  
                    // 0x1dac0  230  CreateProcessAsUserW
  BVar1 = CreateProcessAsUserW
                    (hToken,lpApplicationName,lpCommandLine,lpProcessAttributes,lpThreadAttributes,
                     bInheritHandles,dwCreationFlags,lpEnvironment,lpCurrentDirectory,lpStartupInfo,
                     lpProcessInformation);
  return BVar1;
}



BOOL IsProcessorFeaturePresent(DWORD ProcessorFeature)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001db40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1db40  909  IsProcessorFeaturePresent
  BVar1 = IsProcessorFeaturePresent(ProcessorFeature);
  return BVar1;
}



undefined8 FUN_18001db54(undefined8 param_1,undefined8 param_2,longlong param_3)

{
  undefined8 uVar1;
  longlong lVar2;
  
  lVar2 = 0;
  do {
    uVar1 = RtlAppendUnicodeStringToString(param_1,param_3);
    if ((int)uVar1 < 0) {
      return uVar1;
    }
    lVar2 = lVar2 + 1;
    param_3 = param_3 + 0x10;
  } while (lVar2 != 2);
  return 0;
}



void GetSystemInfo(LPSYSTEM_INFO lpSystemInfo)

{
                    // WARNING: Could not recover jumptable at 0x00018001dbb0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1dbb0  750  GetSystemInfo
  GetSystemInfo(lpSystemInfo);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 Module32FirstW(undefined8 param_1,uint *param_2)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint *puVar4;
  int iVar5;
  uint *puVar6;
  longlong lVar7;
  uint *puVar8;
  undefined4 uVar9;
  
                    // 0x1dbd0  1003  Module32FirstW
  uVar9 = 0;
  if (((param_2 == (uint *)0x0) || (*param_2 != 0x438)) || (iVar5 = NtMapViewOfSection(), iVar5 < 0)
     ) {
    BaseSetLastNTError();
    uVar9 = 0;
  }
  else {
    if (_DAT_00000008 == 0) {
      memset(param_2 + 1,0,(ulonglong)*param_2 - 4);
      RtlSetLastWin32Error(0x12);
    }
    else {
      lVar7 = 8;
      puVar4 = puRam0000000000000020;
      do {
        puVar8 = param_2;
        puVar6 = puVar4;
        uVar1 = puVar6[1];
        uVar2 = puVar6[2];
        uVar3 = puVar6[3];
        *puVar8 = *puVar6;
        puVar8[1] = uVar1;
        puVar8[2] = uVar2;
        puVar8[3] = uVar3;
        uVar1 = puVar6[5];
        uVar2 = puVar6[6];
        uVar3 = puVar6[7];
        puVar8[4] = puVar6[4];
        puVar8[5] = uVar1;
        puVar8[6] = uVar2;
        puVar8[7] = uVar3;
        uVar1 = puVar6[9];
        uVar2 = puVar6[10];
        uVar3 = puVar6[0xb];
        puVar8[8] = puVar6[8];
        puVar8[9] = uVar1;
        puVar8[10] = uVar2;
        puVar8[0xb] = uVar3;
        uVar1 = puVar6[0xd];
        uVar2 = puVar6[0xe];
        uVar3 = puVar6[0xf];
        puVar8[0xc] = puVar6[0xc];
        puVar8[0xd] = uVar1;
        puVar8[0xe] = uVar2;
        puVar8[0xf] = uVar3;
        uVar1 = puVar6[0x11];
        uVar2 = puVar6[0x12];
        uVar3 = puVar6[0x13];
        puVar8[0x10] = puVar6[0x10];
        puVar8[0x11] = uVar1;
        puVar8[0x12] = uVar2;
        puVar8[0x13] = uVar3;
        uVar1 = puVar6[0x15];
        uVar2 = puVar6[0x16];
        uVar3 = puVar6[0x17];
        puVar8[0x14] = puVar6[0x14];
        puVar8[0x15] = uVar1;
        puVar8[0x16] = uVar2;
        puVar8[0x17] = uVar3;
        uVar1 = puVar6[0x19];
        uVar2 = puVar6[0x1a];
        uVar3 = puVar6[0x1b];
        puVar8[0x18] = puVar6[0x18];
        puVar8[0x19] = uVar1;
        puVar8[0x1a] = uVar2;
        puVar8[0x1b] = uVar3;
        uVar1 = puVar6[0x1d];
        uVar2 = puVar6[0x1e];
        uVar3 = puVar6[0x1f];
        puVar8[0x1c] = puVar6[0x1c];
        puVar8[0x1d] = uVar1;
        puVar8[0x1e] = uVar2;
        puVar8[0x1f] = uVar3;
        lVar7 = lVar7 + -1;
        puVar4 = puVar6 + 0x20;
        param_2 = puVar8 + 0x20;
      } while (lVar7 != 0);
      uVar1 = puVar6[0x21];
      uVar2 = puVar6[0x22];
      uVar3 = puVar6[0x23];
      uVar9 = 1;
      puVar8[0x20] = puVar6[0x20];
      puVar8[0x21] = uVar1;
      puVar8[0x22] = uVar2;
      puVar8[0x23] = uVar3;
      uVar1 = puVar6[0x25];
      uVar2 = puVar6[0x26];
      uVar3 = puVar6[0x27];
      puVar8[0x24] = puVar6[0x24];
      puVar8[0x25] = uVar1;
      puVar8[0x26] = uVar2;
      puVar8[0x27] = uVar3;
      uVar1 = puVar6[0x29];
      uVar2 = puVar6[0x2a];
      uVar3 = puVar6[0x2b];
      puVar8[0x28] = puVar6[0x28];
      puVar8[0x29] = uVar1;
      puVar8[0x2a] = uVar2;
      puVar8[0x2b] = uVar3;
      *(undefined8 *)(puVar8 + 0x2c) = *(undefined8 *)(puVar6 + 0x2c);
      uRam0000000000000038 = 1;
    }
    NtUnmapViewOfSection(0xffffffffffffffff,0);
  }
  return uVar9;
}



int FUN_18001dd00(ulonglong param_1,int param_2,longlong *param_3,longlong *param_4,
                 undefined8 *param_5,undefined8 *param_6,longlong *param_7,undefined8 *param_8,
                 undefined8 *param_9)

{
  longlong *plVar1;
  int iVar2;
  longlong lVar3;
  uint local_48;
  int local_44;
  ulonglong local_40 [2];
  
  plVar1 = param_7;
  iVar2 = 0;
  local_48 = 0x10000;
  local_40[0] = 0x10000;
  *param_3 = 0;
  *param_4 = 0;
  *param_7 = 0;
  if ((param_1 & 6) != 0) {
    while( true ) {
      local_40[0] = (ulonglong)local_48;
      iVar2 = NtAllocateVirtualMemory(0xffffffffffffffff,param_3,0,local_40,0x1000,4);
      local_44 = iVar2;
      if (iVar2 < 0) break;
      local_48 = (uint)local_40[0];
      iVar2 = NtQuerySystemInformation(5,*param_3,local_40[0] & 0xffffffff,&local_48);
      if (iVar2 != -0x3ffffffc) break;
      NtFreeVirtualMemory(0xffffffffffffffff,param_3,local_40,0x8000);
      *param_3 = 0;
      local_48 = local_48 + 0x1fff & 0xffffe000;
    }
  }
  if ((param_1 & 0x18) != 0) {
    if (-1 < iVar2) {
      lVar3 = RtlCreateQueryDebugBuffer(0,0);
      *param_4 = lVar3;
      if (lVar3 == 0) {
        iVar2 = -0x3fffffff;
      }
    }
    if (-1 < iVar2) {
      *param_5 = *(undefined8 *)(*param_4 + 8);
      *param_6 = *(undefined8 *)(*param_4 + 0x58);
      iVar2 = RtlQueryProcessDebugInformation
                        ((longlong)param_2,
                         ((uint)(param_1 & 0xffffffff) & 0x10 | 0xe0000000) << 2 |
                         (uint)((param_1 & 0xffffffff) >> 3) & 1,*param_4);
    }
  }
  if ((param_1 & 1) != 0) {
    if (iVar2 < 0) goto LAB_18001de22;
    lVar3 = RtlCreateQueryDebugBuffer(0,0);
    *plVar1 = lVar3;
    if (lVar3 == 0) {
      iVar2 = -0x3fffffff;
    }
    if (iVar2 < 0) goto LAB_18001de22;
    *param_8 = *(undefined8 *)(lVar3 + 8);
    *param_9 = *(undefined8 *)(*plVar1 + 0x58);
    iVar2 = RtlQueryProcessDebugInformation((longlong)param_2,4,*plVar1);
  }
  if (-1 < iVar2) {
    return iVar2;
  }
LAB_18001de22:
  if (*param_3 != 0) {
    param_7 = (longlong *)0x0;
    NtFreeVirtualMemory(0xffffffffffffffff,param_3,&param_7,0x8000);
    *param_3 = 0;
  }
  if (*param_4 != 0) {
    RtlDestroyQueryDebugBuffer(*param_4);
    *param_4 = 0;
  }
  if (*plVar1 != 0) {
    RtlDestroyQueryDebugBuffer(*plVar1);
    *plVar1 = 0;
  }
  return iVar2;
}



DWORD GetModuleFileNameW(HMODULE hModule,LPWSTR lpFilename,DWORD nSize)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001df20. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1df20  638  GetModuleFileNameW
  DVar1 = GetModuleFileNameW(hModule,lpFilename,nSize);
  return DVar1;
}



BOOL SetFileCompletionNotificationModes(HANDLE FileHandle,UCHAR Flags)

{
  int iVar1;
  BOOL BVar2;
  uint local_res10 [6];
  undefined local_18 [24];
  
  local_res10[0] = (uint)Flags;
                    // 0x1df40  1328  SetFileCompletionNotificationModes
  if ((Flags & 0xfc) == 0) {
    if ((Flags & 3) != 0) {
      iVar1 = NtSetInformationFile(FileHandle,local_18,local_res10,4,0x29);
      if (iVar1 < 0) {
        BaseSetLastNTError();
        goto LAB_1800345a8;
      }
    }
    BVar2 = 1;
  }
  else {
    RtlSetLastWin32Error(0x57);
LAB_1800345a8:
    BVar2 = 0;
  }
  return BVar2;
}



BOOL QueryActCtxW(DWORD dwFlags,HANDLE hActCtx,PVOID pvSubInstance,ULONG ulInfoClass,PVOID pvBuffer,
                 SIZE_T cbBuffer,SIZE_T *pcbWrittenOrRequired)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001dfa0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1dfa0  1095  QueryActCtxW
  BVar1 = QueryActCtxW(dwFlags,hActCtx,pvSubInstance,ulInfoClass,pvBuffer,cbBuffer,
                       pcbWrittenOrRequired);
  return BVar1;
}



void TermsrvDeleteValue(void)

{
                    // 0x1dfc0  1445  TermsrvDeleteValue
  if (DAT_1800b2df0 != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180026440. Too many branches
                    // WARNING: Treating indirect jump as call
    (*DAT_1800b2df0)();
    return;
  }
  return;
}



void TermsrvDeleteKey(void)

{
                    // 0x1dfe0  1444  TermsrvDeleteKey
  if (DAT_1800b2de8 != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180026440. Too many branches
                    // WARNING: Treating indirect jump as call
    (*DAT_1800b2de8)();
    return;
  }
  return;
}



BOOL UnmapViewOfFile(LPCVOID lpBaseAddress)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001e000. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1e000  1476  UnmapViewOfFile
  BVar1 = UnmapViewOfFile(lpBaseAddress);
  return BVar1;
}



void GetLocalTime(LPSYSTEMTIME lpSystemTime)

{
                    // WARNING: Could not recover jumptable at 0x00018001e020. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1e020  620  GetLocalTime
  GetLocalTime(lpSystemTime);
  return;
}



BOOL SetEnvironmentVariableA(LPCSTR lpName,LPCSTR lpValue)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001e040. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1e040  1316  SetEnvironmentVariableA
  BVar1 = SetEnvironmentVariableA(lpName,lpValue);
  return BVar1;
}



UINT GetACP(void)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001e060. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1e060  444  GetACP
  UVar1 = GetACP();
  return UVar1;
}



LCID LocaleNameToLCID(LPCWSTR lpName,DWORD dwFlags)

{
  LCID LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001e080. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1e080  991  LocaleNameToLCID
  LVar1 = LocaleNameToLCID(lpName,dwFlags);
  return LVar1;
}



void ExitProcess(UINT uExitCode)

{
  code *pcVar1;
  
                    // 0x1e0a0  360  ExitProcess
                    // 0x1e0a0  369  FatalExit
  RtlExitUserProcess();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



DWORD ResumeThread(HANDLE hThread)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001e0c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1e0c0  1236  ResumeThread
  DVar1 = ResumeThread(hThread);
  return DVar1;
}



DWORD QueueUserAPC(PAPCFUNC pfnAPC,HANDLE hThread,ULONG_PTR dwData)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001e0e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1e0e0  1117  QueueUserAPC
  DVar1 = QueueUserAPC(pfnAPC,hThread,dwData);
  return DVar1;
}



void FUN_18001e0f4(longlong param_1,undefined *param_2)

{
  int iVar1;
  char *pcVar2;
  uint *puVar3;
  undefined8 *puVar4;
  longlong in_GS_OFFSET;
  undefined auStack200 [32];
  undefined4 *local_a8;
  undefined4 local_98 [2];
  longlong local_90;
  undefined8 local_88 [12];
  ulonglong local_28;
  
  local_28 = DAT_1800b2220 ^ (ulonglong)auStack200;
  puVar4 = (undefined8 *)0x0;
  local_98[0] = 0;
  *param_2 = 0;
  local_90 = param_1;
  if ((param_1 == 0) && (iVar1 = NtOpenProcessToken(0xffffffffffffffff,8,&local_90), iVar1 < 0))
  goto LAB_18001e194;
  local_a8 = local_98;
  iVar1 = NtQueryInformationToken(local_90,0x19,local_88);
  if (iVar1 < 0) {
    puVar4 = (undefined8 *)0x0;
    if ((iVar1 != -0x3fffffdd) ||
       (puVar4 = (undefined8 *)
                 RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                                 local_98[0]), puVar4 == (undefined8 *)0x0)) goto LAB_18001e194;
    local_a8 = local_98;
    iVar1 = NtQueryInformationToken(local_90,0x19,puVar4,local_98[0]);
    if (iVar1 < 0) goto LAB_18001e194;
  }
  else {
    puVar4 = local_88;
  }
  pcVar2 = (char *)RtlSubAuthorityCountSid(*puVar4);
  puVar3 = (uint *)RtlSubAuthoritySid(*puVar4,*pcVar2 + -1);
  if (0x1000 < *puVar3) {
    *param_2 = 1;
  }
LAB_18001e194:
  if (local_90 != param_1) {
    NtClose();
  }
  if ((puVar4 != (undefined8 *)0x0) && (puVar4 != local_88)) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar4);
  }
  __security_check_cookie(local_28 ^ (ulonglong)auStack200);
  return;
}



HANDLE CreateJobObjectW(LPSECURITY_ATTRIBUTES lpJobAttributes,LPCWSTR lpName)

{
  int iVar1;
  undefined8 uVar2;
  undefined *puVar3;
  undefined8 local_res10;
  HANDLE local_res18 [2];
  undefined local_48 [16];
  undefined local_38 [48];
  
                    // 0x1e1f0  214  CreateJobObjectW
  if (lpName == (LPCWSTR)0x0) {
    puVar3 = (undefined *)0x0;
  }
  else {
    RtlInitUnicodeString(local_48);
    puVar3 = local_48;
  }
  iVar1 = BaseFormatObjectAttributes(local_38,lpJobAttributes,puVar3,&local_res10);
  if ((-1 < iVar1) && (iVar1 = NtCreateJobObject(local_res18,0x1f003f,local_res10), -1 < iVar1)) {
    if (iVar1 == 0x40000000) {
      uVar2 = 0xb7;
    }
    else {
      uVar2 = 0;
    }
    RtlSetLastWin32Error(uVar2);
    return local_res18[0];
  }
  BaseSetLastNTError();
  return (HANDLE)0x0;
}



BOOL CreateTimerQueueTimer
               (PHANDLE phNewTimer,HANDLE TimerQueue,WAITORTIMERCALLBACK Callback,PVOID Parameter,
               DWORD DueTime,DWORD Period,ULONG Flags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001e2a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1e2a0  254  CreateTimerQueueTimer
  BVar1 = CreateTimerQueueTimer(phNewTimer,TimerQueue,Callback,Parameter,DueTime,Period,Flags);
  return BVar1;
}



void AddRefActCtxWorker(void)

{
                    // WARNING: Could not recover jumptable at 0x00018001e2c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1e2c0  14  AddRefActCtxWorker
  RtlAddRefActivationContext();
  return;
}



BOOL GetCPInfo(UINT CodePage,LPCPINFO lpCPInfo)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001e2e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1e2e0  459  GetCPInfo
  BVar1 = GetCPInfo(CodePage,lpCPInfo);
  return BVar1;
}



LPSTR lstrcpy(LPSTR lpString1,LPCSTR lpString2)

{
  char cVar1;
  longlong lVar2;
  
                    // 0x1e300  1612  lstrcpy
                    // 0x1e300  1613  lstrcpyA
  lVar2 = (longlong)lpString1 - (longlong)lpString2;
  do {
    cVar1 = *lpString2;
    lpString2[lVar2] = cVar1;
    lpString2 = lpString2 + 1;
  } while (cVar1 != '\0');
  return lpString1;
}



BOOL GetStringTypeW(DWORD dwInfoType,LPCWSTR lpSrcStr,int cchSrc,LPWORD lpCharType)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001e330. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1e330  738  GetStringTypeW
  BVar1 = GetStringTypeW(dwInfoType,lpSrcStr,cchSrc,lpCharType);
  return BVar1;
}



DWORD GetEnvironmentVariableA(LPCSTR lpName,LPSTR lpBuffer,DWORD nSize)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001e350. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1e350  579  GetEnvironmentVariableA
  DVar1 = GetEnvironmentVariableA(lpName,lpBuffer,nSize);
  return DVar1;
}



int GetUserDefaultLocaleName(LPWSTR lpLocaleName,int cchLocaleName)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001e370. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1e370  801  GetUserDefaultLocaleName
  iVar1 = GetUserDefaultLocaleName(lpLocaleName,cchLocaleName);
  return iVar1;
}



BOOL SetThreadStackGuarantee(PULONG StackSizeInBytes)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001e390. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1e390  1395  SetThreadStackGuarantee
  BVar1 = SetThreadStackGuarantee(StackSizeInBytes);
  return BVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Type propagation algorithm not settling
// WARNING: Could not reconcile some variable overlaps

void BasepSetFileEncryptionCompression
               (undefined8 param_1,undefined8 *param_2,undefined8 param_3,undefined8 param_4,
               undefined8 param_5,uint param_6,uint param_7,uint param_8)

{
  DWORD DVar1;
  int iVar2;
  FARPROC pFVar3;
  undefined8 uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  undefined auStack280 [32];
  undefined8 local_f8;
  undefined4 local_f0;
  ulonglong *local_e8;
  undefined4 local_e0;
  ushort *local_d8;
  undefined4 local_d0;
  HMODULE local_c0;
  undefined8 local_b8;
  uint local_b0;
  uint local_ac;
  uint local_a8;
  ulonglong local_a0;
  undefined local_98 [16];
  uint local_88;
  undefined8 *local_80;
  undefined8 local_78;
  undefined8 local_70;
  ushort local_68 [2];
  uint local_64;
  undefined local_58 [8];
  ulonglong local_50;
  ulonglong local_48;
  
                    // 0x1e3b0  103  BasepSetFileEncryptionCompression
  local_48 = DAT_1800b2220 ^ (ulonglong)auStack280;
  local_c0 = (HMODULE)0xffffffffffffffff;
  local_b8._0_4_ = 0;
  uVar8 = param_6 & 0x4000;
  local_88 = param_6 & 0x800;
  uVar6 = param_6 & 0x8000;
  if (param_7 == 0xffffffff) {
    uVar5 = (uint)(uVar8 == 0);
    uVar7 = (uint)(local_88 == 0);
    local_a8 = (uint)(uVar6 == 0);
  }
  else {
    uVar5 = param_7 & 0x4000;
    uVar7 = param_7 & 0x800;
    local_a8 = param_7 & 0x8000;
  }
  local_b0 = uVar5;
  local_ac = uVar7;
  local_80 = param_2;
  local_78 = param_1;
  local_70 = param_3;
  if ((uVar8 == 0) && (uVar5 == 0)) {
LAB_18001e47f:
    if (local_88 == 0) {
LAB_18001e487:
      if ((uVar7 != 0) && (uVar5 == 0)) {
        local_b8._0_4_ = (uint)local_b8 & 0xffff0000;
        local_e8 = &local_b8;
LAB_18001e7f9:
        local_d0 = 0;
        local_d8 = (ushort *)0x0;
        local_e0 = 2;
        local_f0 = 0x9c040;
        local_f8 = local_98;
        local_b8._4_4_ = NtFsControlFile(*param_2,0,0,0);
        if ((param_7 != 0xffffffff) && (local_b8._4_4_ < 0)) goto LAB_18001e7d8;
      }
    }
    else if ((uVar7 == 0) && (uVar5 == 0)) {
      local_f8 = (undefined *)CONCAT44(local_f8._4_4_,0x1c);
      local_b8._4_4_ = NtQueryInformationFile(local_78,local_98,local_58,0x10);
      if (-1 < local_b8._4_4_) {
        local_e8 = &local_50;
        goto LAB_18001e7f9;
      }
      if (param_7 == 0xffffffff) goto LAB_18001e490;
LAB_18001e7d8:
      if ((param_8 & 1) == 0) goto LAB_18001e767;
    }
    else if (local_88 == 0) goto LAB_18001e487;
LAB_18001e490:
    if (uVar6 == 0) {
LAB_18001e4a3:
      if (local_a8 == 0) goto LAB_18001e984;
      local_a0 = (local_a0 >> 0x10 & 0xffff) << 0x10;
LAB_18001e911:
      local_d0 = 0;
      local_d8 = (ushort *)0x0;
      local_e0 = 8;
      local_e8 = &local_a0;
      local_f0 = 0x9c280;
      local_f8 = local_98;
      local_b8._4_4_ = NtFsControlFile(*param_2,0,0,0);
      if ((param_7 == 0xffffffff) || (-1 < local_b8._4_4_)) goto LAB_18001e984;
    }
    else {
      if (local_a8 != 0) {
        if (uVar6 != 0) goto LAB_18001e984;
        goto LAB_18001e4a3;
      }
      local_d0 = 0x10;
      local_d8 = local_68;
      local_e0 = 0;
      local_e8 = (ulonglong *)0x0;
      local_f0 = 0x9027c;
      local_f8 = local_98;
      local_b8._4_4_ = NtFsControlFile(local_78,0,0,0);
      if (-1 < local_b8._4_4_) {
        local_a0 = (ulonglong)local_68[0];
        local_a0 = local_a0 | (ulonglong)local_64 << 0x20;
        goto LAB_18001e911;
      }
      if (param_7 == 0xffffffff) goto LAB_18001e984;
    }
    if ((param_8 & 1) != 0) goto LAB_18001e984;
  }
  else {
    NtClose();
    *local_80 = 0xffffffffffffffff;
    local_c0 = LoadLibraryExW(L"advapi32.dll",(HANDLE)0x0,0x800);
    if (local_c0 == (HMODULE)0x0) {
joined_r0x00018001e51e:
      if ((param_8 & 1) == 0) goto LAB_18001e984;
    }
    else {
      if (uVar8 != 0) {
        if (uVar5 != 0) {
          if (uVar8 == 0) goto LAB_18001e5e2;
          goto LAB_18001e654;
        }
        DVar1 = GetEncryptedFileVersionExt(param_4,(undefined4 *)&local_b8);
        if ((DVar1 == 0) || ((param_8 & 1) != 0)) {
          if ((uint)local_b8 - 5 < 2) {
            uVar4 = FUN_180037634(param_4,param_5,0);
            iVar2 = (int)uVar4;
          }
          else {
            pFVar3 = GetProcAddress(local_c0,"EncryptFileW");
            if (pFVar3 == (FARPROC)0x0) goto joined_r0x00018001e51e;
            iVar2 = (*pFVar3)();
          }
          if (iVar2 == 0) goto joined_r0x00018001e51e;
          local_b0 = 1;
          local_ac = 0;
          uVar5 = 1;
          uVar7 = 0;
          goto LAB_18001e6a0;
        }
LAB_18001e557:
        RtlSetLastWin32Error(DVar1);
        goto LAB_18001e984;
      }
LAB_18001e5e2:
      if (uVar5 == 0) {
        if (uVar8 == 0) goto LAB_18001e6a0;
LAB_18001e654:
        if (uVar5 != 0) {
          DVar1 = GetEncryptedFileVersionExt(param_4,(undefined4 *)&local_b8);
          if ((DVar1 != 0) && ((param_8 & 1) == 0)) goto LAB_18001e557;
          if (((uint)local_b8 - 5 < 2) &&
             (uVar4 = FUN_180037634(param_4,param_5,1), (int)uVar4 == 0))
          goto joined_r0x00018001e51e;
        }
      }
      else {
        pFVar3 = GetProcAddress(local_c0,"DecryptFileW");
        if (pFVar3 == (FARPROC)0x0) goto joined_r0x00018001e51e;
        DVar1 = GetEncryptedFileVersionExt(param_5,(undefined4 *)&local_b8);
        if ((DVar1 != 0) && ((param_8 & 1) == 0)) goto LAB_18001e557;
        if (1 < (uint)local_b8 - 5) {
          iVar2 = (*pFVar3)();
          if (iVar2 == 0) goto joined_r0x00018001e51e;
          local_b0 = 0;
          uVar5 = 0;
        }
      }
    }
LAB_18001e6a0:
    uVar4 = local_70;
    param_2 = local_80;
    local_f0 = 0x60;
    local_f8 = (undefined *)((ulonglong)local_f8 & 0xffffffff00000000);
    local_b8._4_4_ = NtOpenFile(local_80,0xc0150000,local_70,local_98);
    if ((local_b8._4_4_ == -0x3fffffde) && ((param_8 & 1) != 0)) {
      local_f0 = 0x60;
      local_f8 = (undefined *)((ulonglong)local_f8 & 0xffffffff00000000);
      local_b8._4_4_ = NtOpenFile(param_2,0x80150000,uVar4,local_98);
    }
    if ((local_b8._4_4_ == -0x3fffffde) && ((param_8 & 1) != 0)) {
      local_f0 = 0x60;
      local_f8 = (undefined *)((ulonglong)local_f8 & 0xffffffff00000000);
      local_b8._4_4_ = NtOpenFile(param_2,0x80110000,uVar4,local_98);
    }
    if (-1 < local_b8._4_4_) goto LAB_18001e47f;
  }
LAB_18001e767:
  BaseSetLastNTError();
LAB_18001e984:
  if ((undefined *)((longlong)&local_c0[-1].unused + 3U) < (undefined *)0xfffffffffffffffe) {
    FreeLibrary(local_c0);
  }
  __security_check_cookie(local_48 ^ (ulonglong)auStack280);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 RegisterWaitUntilOOBECompleted(longlong param_1,longlong param_2,longlong **param_3)

{
  int iVar1;
  undefined8 uVar2;
  longlong *plVar3;
  longlong in_GS_OFFSET;
  int local_res8 [2];
  undefined4 local_res20 [2];
  longlong local_28 [2];
  
                    // 0x1e9c0  1202  RegisterWaitUntilOOBECompleted
  local_28[0] = 0;
  local_res8[0] = 0;
  if ((param_1 == 0) || (param_3 == (longlong **)0x0)) {
    uVar2 = 0x57;
  }
  else {
    uVar2 = FUN_18001eb88();
    if ((int)uVar2 == 0) {
      return 0;
    }
    if (_DAT_1800b2cd0 != 0) {
      uVar2 = FUN_18001eb18();
      if ((int)uVar2 == 0) {
        return 0;
      }
      iVar1 = RtlQueryWnfStateData(local_res20,DAT_1800b2cc8,FUN_1800204c0,local_res8,0);
      if (-1 < iVar1) {
        if (local_res8[0] == 1) {
          uVar2 = 0x139f;
          goto LAB_18001ea4e;
        }
        plVar3 = (longlong *)
                 RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,0x18);
        uVar2 = DAT_1800b2cc8;
        if (plVar3 != (longlong *)0x0) {
          *plVar3 = param_1;
          plVar3[1] = param_2;
          iVar1 = RtlSubscribeWnfStateChangeNotification
                            (local_28,uVar2,local_res20[0],FUN_1800671a0,plVar3,0,0,1);
          if (-1 < iVar1) {
            plVar3[2] = local_28[0];
            *param_3 = plVar3;
            return 1;
          }
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,plVar3);
        }
      }
      BaseSetLastNTError();
      return 0;
    }
    uVar2 = 0x32;
  }
LAB_18001ea4e:
  RtlSetLastWin32Error(uVar2);
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 OOBEComplete(undefined4 *param_1)

{
  int iVar1;
  undefined8 uVar2;
  undefined4 local_res8 [2];
  undefined local_res10 [24];
  
                    // 0x1ea80  1026  OOBEComplete
  local_res8[0] = 0;
  if (param_1 == (undefined4 *)0x0) {
    uVar2 = 0x57;
  }
  else {
    uVar2 = FUN_18001ebf0();
    if ((int)uVar2 == 0) {
      *param_1 = 1;
      return 1;
    }
    uVar2 = FUN_18001eb88();
    if ((int)uVar2 == 0) {
      return 0;
    }
    if (_DAT_1800b2cd0 != 0) {
      uVar2 = FUN_18001eb18();
      if ((int)uVar2 == 0) {
        return 0;
      }
      iVar1 = RtlQueryWnfStateData(local_res10,DAT_1800b2cc8,FUN_1800204c0,local_res8,0);
      if (iVar1 < 0) {
        BaseSetLastNTError();
        return 0;
      }
      *param_1 = local_res8[0];
      return 1;
    }
    uVar2 = 0x32;
  }
  RtlSetLastWin32Error(uVar2);
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_18001eb18(void)

{
  bool bVar1;
  int iVar2;
  undefined7 extraout_var;
  undefined8 uVar3;
  uint local_res8 [2];
  uint local_res10 [6];
  
  if (_DAT_1800b2cd8 == 0) {
    bVar1 = FUN_18001ec80(local_res8);
    if ((int)CONCAT71(extraout_var,bVar1) != 0) {
      iVar2 = FUN_18001ed7c(local_res10);
      if (iVar2 != 0) {
        if ((local_res8[0] != 0) || (DAT_1800b2cc8 = 0xd83063ea3bc2475, local_res10[0] != 0)) {
          DAT_1800b2cc8 = 0x41960b29a3bc0c75;
        }
        _DAT_1800b2cd8 = 1;
        goto LAB_18001eb67;
      }
    }
    uVar3 = 0;
  }
  else {
LAB_18001eb67:
    uVar3 = 1;
  }
  return uVar3;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_18001eb88(void)

{
  int iVar1;
  DWORD DVar2;
  int local_res8 [8];
  
  if (_DAT_1800b2cd4 != 0) {
    return 1;
  }
  local_res8[0] = 0;
  iVar1 = FUN_18001ecc8(L"SYSTEM\\Setup",L"SetupSupported",local_res8);
  if (iVar1 == 0) {
    DVar2 = GetLastError();
    if (1 < DVar2 - 2) {
      return 0;
    }
    RtlSetLastWin32Error(0);
  }
  else if (local_res8[0] != 0) {
    _DAT_1800b2cd0 = 1;
    _DAT_1800b2cd4 = 1;
    return 1;
  }
  iVar1 = FUN_18001ecc8(L"Software\\Microsoft\\CoreShell\\Oobe",L"OobeCompleteWnfSupported",
                        local_res8);
  if (iVar1 == 0) {
    DVar2 = GetLastError();
    if (1 < DVar2 - 2) {
      return 0;
    }
    RtlSetLastWin32Error(0);
  }
  if (local_res8[0] != 0) {
    _DAT_1800b2cd0 = 1;
    _DAT_1800b2cd4 = 1;
    return 1;
  }
  _DAT_1800b2cd0 = 0;
  _DAT_1800b2cd4 = 1;
  return 1;
}



undefined8 FUN_18001ebf0(void)

{
  uint uVar1;
  int iVar2;
  undefined8 uVar3;
  undefined4 local_res8 [2];
  int local_res10 [2];
  undefined local_18 [16];
  
  local_res8[0] = 4;
  local_res10[0] = 0;
  local_18 = ZEXT816(0);
  uVar3 = 1;
  uVar1 = FUN_1800258c8();
  if ((char)uVar1 == '\0') {
    RtlInitUnicodeString(local_18,L"Kernel-SkipOOBE");
    iVar2 = NtQueryLicenseValue(local_18,0,local_res10,local_res8[0],local_res8);
    if ((iVar2 == 0) && (local_res10[0] != 0)) {
      uVar3 = 0;
    }
  }
  else {
    uVar3 = QueryOOBESupport();
  }
  return uVar3;
}



bool FUN_18001ec80(uint *param_1)

{
  int iVar1;
  int local_res10 [6];
  
  iVar1 = FUN_18001ecc8(L"SYSTEM\\CurrentControlSet\\Control\\WinInit",L"Headless",local_res10);
  if (iVar1 != 0) {
    *param_1 = (uint)(local_res10[0] != 0);
  }
  return iVar1 != 0;
}



undefined4 FUN_18001ecc8(LPCWSTR param_1,LPCWSTR param_2,undefined4 *param_3)

{
  LSTATUS LVar1;
  DWORD local_res20 [2];
  undefined4 local_18;
  DWORD local_14;
  HKEY local_10;
  
  LVar1 = RegOpenKeyExW((HKEY)0xffffffff80000002,param_1,0,1,&local_10);
  if (LVar1 == 0) {
    local_res20[0] = 4;
    LVar1 = RegQueryValueExW(local_10,param_2,(LPDWORD)0x0,&local_14,(LPBYTE)&local_18,local_res20);
    if (LVar1 == 0) {
      *param_3 = local_18;
      RegCloseKey(local_10);
      return 1;
    }
    RegCloseKey(local_10);
  }
  RtlSetLastWin32Error(LVar1);
  return 0;
}



void FUN_18001ed7c(uint *param_1)

{
  BOOL BVar1;
  undefined auStack344 [32];
  _OSVERSIONINFOW local_138;
  char local_1e;
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack344;
  local_138.dwOSVersionInfoSize = 0x11c;
  BVar1 = GetVersionExW(&local_138);
  if (BVar1 != 0) {
    *param_1 = (uint)((byte)(local_1e - 2U) < 2);
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack344);
  return;
}



HANDLE PowerCreateRequest(PREASON_CONTEXT Context)

{
  int iVar1;
  HANDLE hHeap;
  int *local_res10;
  HANDLE local_res18 [2];
  
                    // 0x1ee00  1067  PowerCreateRequest
  local_res10 = (int *)0x0;
  local_res18[0] = (HANDLE)0xffffffffffffffff;
  iVar1 = FUN_18001ee90((int *)Context,&local_res10);
  if (-1 < iVar1) {
    iVar1 = NtPowerInformation(0x2b,local_res10,0x28,local_res18,8);
    if (-1 < iVar1) goto LAB_18001ee4a;
  }
  BaseSetLastNTError();
LAB_18001ee4a:
  if (local_res10 != (int *)0x0) {
    hHeap = GetProcessHeap();
    HeapFree(hHeap,0,local_res10);
  }
  return local_res18[0];
}



void FUN_18001ee90(int *param_1,int **param_2)

{
  int *_Dst;
  int iVar1;
  short *psVar2;
  short sVar3;
  DWORD DVar4;
  ulonglong uVar5;
  int *piVar6;
  short *psVar7;
  uint uVar8;
  undefined (*pauVar9) [16];
  size_t _Size;
  longlong lVar10;
  size_t sVar11;
  longlong in_GS_OFFSET;
  undefined auStack632 [32];
  WCHAR local_258 [264];
  ulonglong local_48;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStack632;
  sVar11 = 0;
  _Size = sVar11;
  if ((param_1 != (int *)0x0) && (uVar8 = param_1[1], _Size = 0, -1 < (int)uVar8)) {
    if ((*param_1 != 0) || (((uVar8 & 7) == 0 || ((uVar8 & 0x7ffffff8) != 0)))) goto LAB_18001eef1;
    if ((uVar8 & 2) != 0) {
      if (0xffff < (uint)param_1[4]) goto LAB_18001eef1;
      DVar4 = GetModuleFileNameW(*(HMODULE *)(param_1 + 2),local_258,0x104);
      uVar5 = (ulonglong)DVar4;
      if ((uVar5 == 0) || (uVar5 == 0x104)) goto LAB_18001eef1;
      _Size = uVar5 * 2 + 2;
    }
  }
  piVar6 = (int *)RtlAllocateHeap();
  if (piVar6 == (int *)0x0) goto LAB_18001eef1;
  if ((param_1 == (int *)0x0) || (param_1[1] < 0)) {
    *piVar6 = 0;
    piVar6[1] = -0x80000000;
  }
  else {
    pauVar9 = (undefined (*) [16])(piVar6 + 2);
    *piVar6 = *param_1;
    uVar8 = param_1[1];
    piVar6[1] = uVar8;
    if ((uVar8 & 1) != 0) {
      psVar2 = *(short **)(param_1 + 2);
      *pauVar9 = ZEXT816(0);
      if (psVar2 == (short *)0x0) {
LAB_18001f092:
        if (*(short *)*pauVar9 != 0) goto LAB_18001f016;
      }
      else {
        lVar10 = 0x7fff;
        psVar7 = psVar2;
        do {
          if (*psVar7 == 0) break;
          psVar7 = psVar7 + 1;
          lVar10 = lVar10 + -1;
        } while (lVar10 != 0);
        uVar8 = ~-(uint)(lVar10 != 0) & 0xc000000d;
        if (lVar10 != 0) {
          if (pauVar9 == (undefined (*) [16])0x0) {
            uVar8 = 0xc000000d;
          }
          else {
            sVar3 = (-(ushort)(lVar10 != 0) & 0x7fffU - (short)lVar10) * 2;
            *(short **)(piVar6 + 4) = psVar2;
            *(short *)*pauVar9 = sVar3;
            *(short *)((longlong)piVar6 + 10) = sVar3 + 2;
          }
        }
        if (-1 < (int)uVar8) goto LAB_18001f092;
      }
LAB_1800348db:
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,piVar6);
      goto LAB_18001eef1;
    }
    _Dst = piVar6 + 10;
    memcpy(_Dst,local_258,_Size);
    *(int **)(piVar6 + 4) = _Dst;
    *(short *)((longlong)piVar6 + 10) = (short)_Size;
    *(short *)*pauVar9 = (short)_Size + -2;
    *(undefined2 *)(piVar6 + 6) = *(undefined2 *)(param_1 + 4);
    iVar1 = param_1[5];
    piVar6[7] = iVar1;
    *(size_t *)(piVar6 + 8) = _Size + 7 + (longlong)_Dst & 0xfffffffffffffff8;
    if (iVar1 != 0) {
      do {
        psVar2 = *(short **)(*(longlong *)(param_1 + 6) + sVar11 * 8);
        pauVar9 = (undefined (*) [16])(sVar11 * 0x10 + *(longlong *)(piVar6 + 8));
        *pauVar9 = ZEXT816(0);
        if (psVar2 != (short *)0x0) {
          lVar10 = 0x7fff;
          psVar7 = psVar2;
          do {
            if (*psVar7 == 0) break;
            psVar7 = psVar7 + 1;
            lVar10 = lVar10 + -1;
          } while (lVar10 != 0);
          uVar8 = ~-(uint)(lVar10 != 0) & 0xc000000d;
          if (lVar10 != 0) {
            if (pauVar9 == (undefined (*) [16])0x0) {
              uVar8 = 0xc000000d;
            }
            else {
              sVar3 = (-(ushort)(lVar10 != 0) & 0x7fffU - (short)lVar10) * 2;
              *(short **)(*pauVar9 + 8) = psVar2;
              *(short *)*pauVar9 = sVar3;
              *(short *)(*pauVar9 + 2) = sVar3 + 2;
            }
          }
          if ((int)uVar8 < 0) goto LAB_1800348db;
        }
        uVar8 = (int)sVar11 + 1;
        sVar11 = (size_t)uVar8;
      } while (uVar8 < (uint)piVar6[7]);
    }
  }
LAB_18001f016:
  *param_2 = piVar6;
LAB_18001eef1:
  __security_check_cookie(local_48 ^ (ulonglong)auStack632);
  return;
}



HMODULE GetModuleHandleA(LPCSTR lpModuleName)

{
  HMODULE pHVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001f0b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1f0b0  639  GetModuleHandleA
  pHVar1 = GetModuleHandleA(lpModuleName);
  return pHVar1;
}



void K32GetModuleInformation(void)

{
                    // WARNING: Could not recover jumptable at 0x00018001f0d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1f0d0  940  K32GetModuleInformation
  K32GetModuleInformation();
  return;
}



DWORD_PTR SetThreadAffinityMask(HANDLE hThread,DWORD_PTR dwThreadAffinityMask)

{
  int iVar1;
  DWORD_PTR local_res18 [2];
  undefined local_38 [32];
  DWORD_PTR local_18;
  
                    // 0x1f0f0  1381  SetThreadAffinityMask
  iVar1 = NtQueryInformationThread(hThread,0,local_38,0x30,0);
  if ((iVar1 < 0) ||
     (local_res18[0] = dwThreadAffinityMask, iVar1 = NtSetInformationThread(hThread,4,local_res18),
     iVar1 < 0)) {
    local_18 = 0;
  }
  else {
    TpCaptureCaller(2);
    if (local_18 != 0) {
      return local_18;
    }
  }
  BaseSetLastNTError();
  return local_18;
}



DWORD GetModuleFileNameA(HMODULE hModule,LPSTR lpFilename,DWORD nSize)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001f1a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1f1a0  637  GetModuleFileNameA
  DVar1 = GetModuleFileNameA(hModule,lpFilename,nSize);
  return DVar1;
}



int GetTimeFormatW(LCID Locale,DWORD dwFlags,SYSTEMTIME *lpTime,LPCWSTR lpFormat,LPWSTR lpTimeStr,
                  int cchTime)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001f1c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1f1c0  791  GetTimeFormatW
  iVar1 = GetTimeFormatW(Locale,dwFlags,lpTime,lpFormat,lpTimeStr,cchTime);
  return iVar1;
}



GEOID GetUserGeoID(GEOCLASS GeoClass)

{
  int iVar1;
  GEOID extraout_EAX;
  ulonglong uVar2;
  wchar_t *pwVar3;
  undefined auStack792 [32];
  undefined4 local_2f8;
  longlong local_2e8;
  undefined *local_2e0;
  wchar_t local_2d8 [80];
  undefined local_238 [544];
  ulonglong local_18;
  
                    // 0x1f1e0  803  GetUserGeoID
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack792;
  local_2e8 = 0;
  if (GeoClass == 0x10) {
    pwVar3 = L"Nation";
  }
  else {
    if (GeoClass != 0xe) goto LAB_18001f2c7;
    pwVar3 = L"Region";
  }
  local_2f8 = 1;
  iVar1 = OpenRegKey(&local_2e8,0,L"Control Panel\\International\\Geo",0x20019);
  if (-1 < iVar1) {
    local_2e0 = local_238;
    iVar1 = FUN_18001f2f0(local_2e8,pwVar3,&local_2e0);
    if ((-1 < iVar1) && (2 < *(uint *)(local_2e0 + 0xc))) {
      if ((*(uint *)(local_2e0 + 0xc) & 0xfffffffe) < 0xa1) {
        uVar2 = (ulonglong)(*(uint *)(local_2e0 + 0xc) >> 1);
      }
      else {
        uVar2 = 0x50;
      }
      FUN_18000b370(local_2d8,uVar2,(longlong)(local_2e0 + *(uint *)(local_2e0 + 8)));
      _wtol(local_2d8);
    }
  }
  if (local_2e8 != 0) {
    NtClose();
  }
LAB_18001f2c7:
  __security_check_cookie(local_18 ^ (ulonglong)auStack792);
  return extraout_EAX;
}



int FUN_18001f2f0(undefined8 param_1,undefined8 param_2,void **param_3)

{
  void *pvVar1;
  int iVar2;
  undefined local_18 [16];
  
  RtlInitUnicodeString(local_18);
  memset(*param_3,0,0x214);
  iVar2 = NtQueryValueKey(param_1);
  pvVar1 = *param_3;
  if (*(int *)((longlong)pvVar1 + 4) != 1) {
    iVar2 = -0x3ffffeb4;
  }
  if (-1 < iVar2) {
    if ((*(int *)((longlong)pvVar1 + 4) == 1) &&
       ((((*(byte *)((longlong)pvVar1 + 0xc) & 1) != 0 || (*(uint *)((longlong)pvVar1 + 0xc) < 2))
        || (*(short *)((longlong)pvVar1 +
                      (ulonglong)(*(uint *)((longlong)pvVar1 + 0xc) >> 1) * 2 +
                      ((ulonglong)*(uint *)((longlong)pvVar1 + 8) - 2)) != 0)))) {
      iVar2 = -0x3ffffeb4;
    }
    if (-1 < iVar2) {
      iVar2 = 0;
    }
  }
  return iVar2;
}



LPWSTR GetCommandLineW(void)

{
  LPWSTR pWVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001f3c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1f3c0  481  GetCommandLineW
  pWVar1 = GetCommandLineW();
  return pWVar1;
}



// WARNING: Removing unreachable block (ram,0x00018001f594)

uint QuirkIsEnabledForProcessWorker(HANDLE param_1,uint param_2,uint *param_3)

{
  LPCVOID lpBaseAddress;
  uint uVar1;
  BOOL BVar2;
  LPVOID lpBuffer;
  HANDLE hProcess;
  longlong lVar3;
  longlong lVar4;
  longlong lVar5;
  byte bVar6;
  ulonglong uVar7;
  longlong in_GS_OFFSET;
  bool bVar8;
  int local_res8 [2];
  int local_res20 [2];
  
                    // 0x1f3e0  1127  QuirkIsEnabledForProcessWorker
  lpBuffer = (LPVOID)0x0;
  local_res20[0] = 0;
  local_res8[0] = 0;
  if (param_1 == (HANDLE)0xffffffffffffffff) {
    uVar1 = QuirkIsEnabledWorker(param_2);
    *param_3 = uVar1;
LAB_18001f589:
    uVar1 = 0;
  }
  else {
    uVar1 = BaseReadAppCompatDataForProcess();
    lpBaseAddress = pvRam0000000000001180;
    bVar8 = uVar1 == 0;
    if (bVar8) {
      if (pvRam0000000000001180 == (LPCVOID)0x0) {
        if ((DAT_1800b2d98 == 0) && (uVar1 = FUN_1800093c4(), (int)uVar1 < 0)) {
          uVar1 = uVar1 | 0x10000000;
          goto LAB_18001f58b;
        }
        lVar3 = FUN_18000bde0(DAT_1800b2d98,param_2);
        if (lVar3 != 0) {
          lVar5 = FUN_18001f5dc(0);
          if (lVar5 == 0) {
            bVar6 = 0;
          }
          else {
            bVar6 = (byte)*(undefined4 *)(lVar5 + 0x20);
          }
          lVar5 = FUN_18001f5dc(0);
          if (lVar5 == 0) {
            uVar7 = 0;
          }
          else {
            uVar7 = *(ulonglong *)(lVar5 + 0x18);
          }
          if ((*(ulonglong *)(lVar3 + 0x10c) & 1 << (bVar6 & 0x3f) & 0xffffffffU) == 0) {
            uVar1 = 0;
          }
          else if (DAT_1800b230c == -1) {
LAB_18001f564:
            uVar1 = (uint)(uVar7 < *(ulonglong *)(lVar3 + 0x104));
          }
          else {
            uVar1 = (uint)(DAT_1800b230c != 0);
          }
          goto LAB_18001f572;
        }
LAB_180034983:
        uVar1 = 0x80070490;
        goto LAB_18001f58b;
      }
      lpBuffer = (LPVOID)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                         0,uRam0000000000001188);
      if (lpBuffer == (LPVOID)0x0) {
        uVar1 = 0x8007000e;
        goto LAB_18001f58b;
      }
      hProcess = GetCurrentProcess();
      BVar2 = IsWow64Process(hProcess,local_res8);
      if ((BVar2 != 0) && (BVar2 = IsWow64Process(param_1,local_res20), BVar2 != 0)) {
        if ((local_res8[0] != 0) && (local_res20[0] == 0)) {
          uVar1 = 0xd0000001;
          goto LAB_18001f58b;
        }
        BVar2 = ReadProcessMemory(param_1,lpBaseAddress,lpBuffer,(ulonglong)uRam0000000000001188,
                                  (SIZE_T *)0x0);
        if (BVar2 != 0) {
          lVar3 = FUN_18000bde0((longlong)lpBuffer,param_2);
          if (lVar3 == 0) goto LAB_180034983;
          lVar5 = 0;
          lVar4 = FUN_18001f5dc(0);
          if (lVar4 == 0) {
            bVar6 = 0;
          }
          else {
            bVar6 = (byte)*(undefined4 *)(lVar4 + 0x20);
          }
          lVar5 = FUN_18001f5dc(lVar5);
          if (lVar5 == 0) {
            uVar7 = 0;
          }
          else {
            uVar7 = *(ulonglong *)(lVar5 + 0x18);
          }
          uVar1 = 1;
          if ((*(ulonglong *)(lVar3 + 0x10c) & 1 << (bVar6 & 0x3f) & 0xffffffffU) == 0) {
LAB_18001f5d2:
            uVar1 = 0;
          }
          else if (DAT_1800b230c == -1) {
            if ((*(uint *)(lVar3 + 0x228) & 1) == 0) {
              if ((*(uint *)(lVar3 + 0x228) & 2) == 0) goto LAB_18001f564;
              goto LAB_18001f5d2;
            }
          }
          else {
            uVar1 = (uint)(DAT_1800b230c != 0);
          }
LAB_18001f572:
          *param_3 = uVar1;
          FUN_18000bd38(lVar3,uVar1,param_1,(undefined2 *)0x0,(undefined2 *)0x0);
          goto LAB_18001f589;
        }
      }
      uVar1 = GetLastError();
      bVar8 = uVar1 == 0;
    }
    if (!bVar8 && -1 < (int)uVar1) {
      uVar1 = uVar1 & 0xffff | 0x80070000;
    }
  }
LAB_18001f58b:
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpBuffer);
  return uVar1;
}



longlong FUN_18001f5dc(longlong param_1)

{
  longlong lVar1;
  
  lVar1 = 0;
  if ((param_1 != 0) && ((lVar1 = param_1 + 0x7e0, lVar1 == 0 || (*(int *)(param_1 + 0x810) == 0))))
  {
    return 0;
  }
  return lVar1;
}



uint FUN_18001f604(uint param_1,uint param_2,undefined4 *param_3)

{
  undefined4 uVar1;
  ulonglong uVar2;
  
  uVar2 = (ulonglong)param_1 * (ulonglong)param_2;
  uVar1 = 0xffffffff;
  if (uVar2 < 0x100000000) {
    uVar1 = (undefined4)uVar2;
  }
  *param_3 = uVar1;
  return -(uint)(0xffffffff < uVar2) & 0x80070216;
}



BOOL GetModuleHandleExW(DWORD dwFlags,LPCWSTR lpModuleName,HMODULE *phModule)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001f630. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1f630  641  GetModuleHandleExW
  BVar1 = GetModuleHandleExW(dwFlags,lpModuleName,phModule);
  return BVar1;
}



BOOL GetFileInformationByHandleEx
               (HANDLE hFile,FILE_INFO_BY_HANDLE_CLASS FileInformationClass,LPVOID lpFileInformation
               ,DWORD dwBufferSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001f650. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1f650  595  GetFileInformationByHandleEx
  BVar1 = GetFileInformationByHandleEx(hFile,FileInformationClass,lpFileInformation,dwBufferSize);
  return BVar1;
}



BOOL IsWow64Process(HANDLE hProcess,PBOOL Wow64Process)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001f670. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1f670  921  IsWow64Process
  BVar1 = IsWow64Process(hProcess,Wow64Process);
  return BVar1;
}



LPWCH GetEnvironmentStringsW(void)

{
  LPWCH pWVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001f690. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1f690  578  GetEnvironmentStringsW
  pWVar1 = GetEnvironmentStringsW();
  return pWVar1;
}



BOOL FreeEnvironmentStringsW(LPWCH param_1)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001f6b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1f6b0  436  FreeEnvironmentStringsW
  BVar1 = FreeEnvironmentStringsW(param_1);
  return BVar1;
}



BOOL SystemTimeToFileTime(SYSTEMTIME *lpSystemTime,LPFILETIME lpFileTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001f6d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1f6d0  1435  SystemTimeToFileTime
  BVar1 = SystemTimeToFileTime(lpSystemTime,lpFileTime);
  return BVar1;
}



void BaseReadAppCompatDataForProcessWorker(HANDLE param_1,void **param_2,void **param_3)

{
  bool bVar1;
  bool bVar2;
  BOOL BVar3;
  DWORD DVar4;
  void *_Dst;
  HANDLE hProcess;
  void *pvVar5;
  longlong in_GS_OFFSET;
  undefined auStackY3288 [32];
  int local_ca8;
  int local_ca4 [3];
  undefined local_c98 [728];
  void *local_9c0;
  undefined local_4c8 [488];
  uint local_2e0;
  ulonglong local_48;
  
                    // 0x1f6f0  67  BaseReadAppCompatDataForProcessWorker
  local_48 = DAT_1800b2220 ^ (ulonglong)auStackY3288;
  memset(local_c98,0,0x7c8);
  memset(local_4c8,0,0x480);
  local_ca4[0] = 0;
  pvVar5 = (void *)0x0;
  local_ca8 = 0;
  _Dst = (void *)0x0;
  if ((param_1 == (HANDLE)0x0) || (param_2 == (void **)0x0)) {
    DVar4 = 0x57;
    local_9c0 = pvVar5;
LAB_180034aea:
    if (DVar4 != 0) {
LAB_180034af2:
      if (_Dst != (void *)0x0) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,_Dst);
      }
      goto LAB_18001f88d;
    }
  }
  else {
    _Dst = (void *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                                   0x11c0);
    if (_Dst == (void *)0x0) goto LAB_18001f88d;
    if (param_1 != (HANDLE)0xffffffffffffffff) {
      BVar3 = IsWow64Process(param_1,local_ca4);
      if (BVar3 != 0) {
        hProcess = GetCurrentProcess();
        BVar3 = IsWow64Process(hProcess,&local_ca8);
        if (BVar3 != 0) {
          if ((local_ca8 == 0) || (local_ca4[0] != 0)) {
            bVar1 = false;
            bVar2 = false;
            if (local_ca4[0] == 0) goto LAB_18001f805;
            DVar4 = FUN_18006fb5c(param_1,local_4c8);
            if (DVar4 != 0) goto LAB_180034af2;
            local_9c0 = (void *)(ulonglong)local_2e0;
          }
          else {
            bVar2 = true;
LAB_18001f805:
            bVar1 = bVar2;
            if ((local_ca8 != 0) || (DVar4 = FUN_18001f8cc(param_1,local_c98), DVar4 != 0))
            goto LAB_180034af2;
          }
          if (local_9c0 == (LPCVOID)0x0) goto LAB_180034af2;
          if ((local_ca8 != 0) && (bVar1)) {
            DVar4 = RtlNtStatusToDosError(0xc0000001);
            goto LAB_180034aea;
          }
          BVar3 = ReadProcessMemory(param_1,local_9c0,_Dst,0x11c0,(SIZE_T *)0x0);
          pvVar5 = local_9c0;
          if (BVar3 != 0) goto LAB_18001f86a;
        }
      }
      DVar4 = GetLastError();
      local_9c0 = pvVar5;
      goto LAB_180034aea;
    }
    local_9c0 = *(void **)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x2d8);
    if (local_9c0 == (void *)0x0) goto LAB_180034af2;
    memcpy(_Dst,local_9c0,0x11c0);
  }
LAB_18001f86a:
  if (((*(int *)((longlong)_Dst + 0x208) == 0x11c0) &&
      (*(int *)((longlong)_Dst + 0x20c) == -0x53f21255)) &&
     (*param_2 = _Dst, param_3 != (void **)0x0)) {
    *param_3 = local_9c0;
  }
LAB_18001f88d:
  __security_check_cookie(local_48 ^ (ulonglong)auStackY3288);
  return;
}



// WARNING: Could not reconcile some variable overlaps

DWORD FUN_18001f8cc(HANDLE param_1,LPVOID param_2)

{
  int iVar1;
  BOOL BVar2;
  DWORD DVar3;
  undefined local_38 [16];
  undefined local_28 [16];
  undefined local_18 [16];
  
  DVar3 = 0;
  local_38 = ZEXT816(0);
  local_28 = ZEXT816(0);
  local_18 = ZEXT816(0);
  if ((param_1 == (HANDLE)0x0) || (param_2 == (LPVOID)0x0)) {
    DVar3 = 0x57;
  }
  else {
    iVar1 = NtQueryInformationProcess(param_1,0,local_38,0x30,0);
    if (iVar1 < 0) {
      DVar3 = RtlNtStatusToDosError(iVar1);
    }
    else if (local_38._8_8_ == (LPCVOID)0x0) {
      DVar3 = 0xd;
    }
    else {
      BVar2 = ReadProcessMemory(param_1,local_38._8_8_,param_2,0x7c8,(SIZE_T *)0x0);
      if (BVar2 == 0) {
        DVar3 = GetLastError();
      }
    }
  }
  return DVar3;
}



BOOL GetVersionExW(LPOSVERSIONINFOW lpVersionInformation)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001f980. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1f980  808  GetVersionExW
  BVar1 = GetVersionExW(lpVersionInformation);
  return BVar1;
}



BOOL GetFileMUIPath(DWORD dwFlags,PCWSTR pcwszFilePath,PWSTR pwszLanguage,PULONG pcchLanguage,
                   PWSTR pwszFileMUIPath,PULONG pcchFileMUIPath,PULONGLONG pululEnumerator)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001f9a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1f9a0  597  GetFileMUIPath
  BVar1 = GetFileMUIPath(dwFlags,pcwszFilePath,pwszLanguage,pcchLanguage,pwszFileMUIPath,
                         pcchFileMUIPath,pululEnumerator);
  return BVar1;
}



BOOL GetExitCodeThread(HANDLE hThread,LPDWORD lpExitCode)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001f9c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1f9c0  584  GetExitCodeThread
  BVar1 = GetExitCodeThread(hThread,lpExitCode);
  return BVar1;
}



void RegisterWaitForInputIdle(undefined8 param_1)

{
  DAT_1800b2cc0 = param_1;
                    // 0x1f9e0  1199  RegisterWaitForInputIdle
  return;
}



void RtlUnwindEx(PVOID TargetFrame,PVOID TargetIp,PEXCEPTION_RECORD ExceptionRecord,
                PVOID ReturnValue,PCONTEXT ContextRecord,PUNWIND_HISTORY_TABLE HistoryTable)

{
                    // WARNING: Could not recover jumptable at 0x00018001f9f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1f9f0  1251  RtlUnwindEx
  RtlUnwindEx(TargetFrame,TargetIp,ExceptionRecord,ReturnValue,ContextRecord,HistoryTable);
  return;
}



UINT GlobalFlags(HGLOBAL hMem)

{
  char cVar1;
  byte bVar2;
  UINT UVar3;
  HGLOBAL pvVar4;
  uint local_res10 [2];
  HGLOBAL local_res18;
  
                    // 0x1fa10  832  GlobalFlags
  UVar3 = 0x8000;
  RtlLockHeap(DAT_1800b2a30);
  pvVar4 = hMem;
  if (((ulonglong)hMem & 8) == 0) {
    local_res18 = (HGLOBAL)0x0;
    local_res10[0] = 0x800;
    cVar1 = RtlGetUserInfoHeap(DAT_1800b2a30,0x800,hMem,&local_res18,local_res10);
    if ((cVar1 != '\0') &&
       ((local_res18 == (HGLOBAL)0x0 || (pvVar4 = local_res18, (local_res10[0] & 0x200) == 0)))) {
      UVar3 = 0;
      pvVar4 = hMem;
    }
    if (((ulonglong)pvVar4 & 8) == 0) goto LAB_18001fa8f;
  }
  cVar1 = RtlIsValidHandle(DAT_1800b2a20,(longlong)pvVar4 + -8);
  if (cVar1 != '\0') {
    bVar2 = (byte)*(undefined2 *)((longlong)pvVar4 + -6);
    UVar3 = (UINT)bVar2;
    if ((*(byte *)((longlong)pvVar4 + -8) & 8) != 0) {
      UVar3 = bVar2 | 0x4000;
    }
    if ((*(byte *)((longlong)pvVar4 + -8) & 4) != 0) {
      UVar3 = UVar3 | 0x100;
    }
    if (*(short *)((longlong)pvVar4 + -8) < 0) {
      UVar3 = UVar3 | 0x2000;
    }
  }
LAB_18001fa8f:
  if (UVar3 == 0x8000) {
    RtlSetLastWin32Error(6);
  }
  RtlUnlockHeap(DAT_1800b2a30);
  return UVar3;
}



void FUN_18001fb70(int param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
                  undefined8 param_5,undefined *param_6)

{
  if (param_1 != 1) {
    *param_6 = 1;
    return;
  }
                    // WARNING: Could not recover jumptable at 0x00018001fb86. Too many branches
                    // WARNING: Treating indirect jump as call
  NtUnmapViewOfSection(0xffffffffffffffff,param_3);
  return;
}



LCID GetUserDefaultLCID(void)

{
  LCID LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001fba0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1fba0  799  GetUserDefaultLCID
  LVar1 = GetUserDefaultLCID();
  return LVar1;
}



HMODULE LoadLibraryExA(LPCSTR lpLibFileName,HANDLE hFile,DWORD dwFlags)

{
  HMODULE pHVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001fbc0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1fbc0  970  LoadLibraryExA
  pHVar1 = LoadLibraryExA(lpLibFileName,hFile,dwFlags);
  return pHVar1;
}



BOOL PowerSetRequest(HANDLE PowerRequest,POWER_REQUEST_TYPE RequestType)

{
  int iVar1;
  HANDLE local_28;
  undefined4 local_20;
  undefined local_1c;
  undefined8 local_18;
  
                    // 0x1fbe0  1068  PowerSetRequest
  local_20 = 0;
  if (RequestType != PowerRequestDisplayRequired) {
    if (RequestType == PowerRequestSystemRequired) {
      local_20 = 1;
    }
    else if (RequestType == PowerRequestAwayModeRequired) {
      local_20 = 2;
    }
    else {
      if (RequestType != (PowerRequestSystemRequired|PowerRequestAwayModeRequired)) {
        BaseSetLastNTError();
        return 0;
      }
      local_20 = 3;
    }
  }
  local_1c = 1;
  local_18 = 0;
  local_28 = PowerRequest;
  iVar1 = NtPowerInformation(0x2c,&local_28,0x18,0,0);
  if (iVar1 < 0) {
    BaseSetLastNTError();
  }
  return (uint)(iVar1 >= 0);
}



BOOL IsValidCodePage(UINT CodePage)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001fc70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1fc70  915  IsValidCodePage
  BVar1 = IsValidCodePage(CodePage);
  return BVar1;
}



BOOL GetSystemTimes(LPFILETIME lpIdleTime,LPFILETIME lpKernelTime,LPFILETIME lpUserTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001fc90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1fc90  758  GetSystemTimes
  BVar1 = GetSystemTimes(lpIdleTime,lpKernelTime,lpUserTime);
  return BVar1;
}



void RaiseException(DWORD dwExceptionCode,DWORD dwExceptionFlags,DWORD nNumberOfArguments,
                   ULONG_PTR *lpArguments)

{
                    // WARNING: Could not recover jumptable at 0x00018001fcb0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1fcb0  1129  RaiseException
  RaiseException(dwExceptionCode,dwExceptionFlags,nNumberOfArguments,lpArguments);
  return;
}



BOOL PowerClearRequest(HANDLE PowerRequest,POWER_REQUEST_TYPE RequestType)

{
  int iVar1;
  HANDLE local_28;
  undefined4 local_20;
  undefined local_1c;
  undefined8 local_18;
  
                    // 0x1fcd0  1066  PowerClearRequest
  local_20 = 0;
  if (RequestType != PowerRequestDisplayRequired) {
    if (RequestType == PowerRequestSystemRequired) {
      local_20 = 1;
    }
    else if (RequestType == PowerRequestAwayModeRequired) {
      local_20 = 2;
    }
    else {
      if (RequestType != (PowerRequestSystemRequired|PowerRequestAwayModeRequired)) {
        BaseSetLastNTError();
        return 0;
      }
      local_20 = 3;
    }
  }
  local_1c = 0;
  local_18 = 0;
  local_28 = PowerRequest;
  iVar1 = NtPowerInformation(0x2c,&local_28,0x18,0,0);
  if (iVar1 < 0) {
    BaseSetLastNTError();
  }
  return (uint)(iVar1 >= 0);
}



HLOCAL LocalReAlloc(HLOCAL hMem,SIZE_T uBytes,UINT uFlags)

{
  HLOCAL pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001fd60. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1fd60  986  LocalReAlloc
  pvVar1 = LocalReAlloc(hMem,uBytes,uFlags);
  return pvVar1;
}



LPCH GetEnvironmentStrings(void)

{
  LPCH pCVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001fd80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1fd80  576  GetEnvironmentStrings
  pCVar1 = GetEnvironmentStrings();
  return pCVar1;
}



BOOL FreeEnvironmentStringsA(LPCH param_1)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001fda0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1fda0  435  FreeEnvironmentStringsA
  BVar1 = FreeEnvironmentStringsA(param_1);
  return BVar1;
}



BOOL GetProcessIoCounters(HANDLE hProcess,PIO_COUNTERS lpIoCounters)

{
  int iVar1;
  
                    // 0x1fdc0  708  GetProcessIoCounters
  iVar1 = NtQueryInformationProcess(hProcess,2,lpIoCounters,0x30,0);
  if (iVar1 < 0) {
    BaseSetLastNTError();
  }
  return (uint)(iVar1 >= 0);
}



LPTOP_LEVEL_EXCEPTION_FILTER
SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)

{
  LPTOP_LEVEL_EXCEPTION_FILTER pPVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001fe00. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1fe00  1408  SetUnhandledExceptionFilter
  pPVar1 = SetUnhandledExceptionFilter(lpTopLevelExceptionFilter);
  return pPVar1;
}



int GetLocaleInfoW(LCID Locale,LCTYPE LCType,LPWSTR lpLCData,int cchData)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001fe20. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1fe20  623  GetLocaleInfoW
  iVar1 = GetLocaleInfoW(Locale,LCType,lpLCData,cchData);
  return iVar1;
}



LPSTR GetCommandLineA(void)

{
  LPSTR pCVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001fe40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1fe40  480  GetCommandLineA
  pCVar1 = GetCommandLineA();
  return pCVar1;
}



void BaseFreeAppCompatDataForProcessWorker(longlong param_1)

{
  longlong in_GS_OFFSET;
  
                    // 0x1fe60  58  BaseFreeAppCompatDataForProcessWorker
                    // 0x1fe60  1428  SortCloseHandle
  if (param_1 != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_1);
  }
  return;
}



BOOL IsValidLocale(LCID Locale,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001fea0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1fea0  917  IsValidLocale
  BVar1 = IsValidLocale(Locale,dwFlags);
  return BVar1;
}



BOOL DisableThreadLibraryCalls(HMODULE hLibModule)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001fec0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1fec0  294  DisableThreadLibraryCalls
  BVar1 = DisableThreadLibraryCalls(hLibModule);
  return BVar1;
}



HMODULE LoadLibraryW(LPCWSTR lpLibFileName)

{
  HMODULE pHVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001fee0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1fee0  972  LoadLibraryW
  pHVar1 = LoadLibraryW(lpLibFileName);
  return pHVar1;
}



BOOL AssignProcessToJobObject(HANDLE hJob,HANDLE hProcess)

{
  int iVar1;
  
                    // 0x1ff00  37  AssignProcessToJobObject
  iVar1 = NtAssignProcessToJobObject();
  if (iVar1 < 0) {
    BaseSetLastNTError();
  }
  return (uint)(iVar1 >= 0);
}



DWORD GetCurrentDirectoryW(DWORD nBufferLength,LPWSTR lpBuffer)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001ff30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1ff30  539  GetCurrentDirectoryW
  DVar1 = GetCurrentDirectoryW(nBufferLength,lpBuffer);
  return DVar1;
}



HANDLE HeapCreate(DWORD flOptions,SIZE_T dwInitialSize,SIZE_T dwMaximumSize)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018001ff50. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x1ff50  852  HeapCreate
  pvVar1 = HeapCreate(flOptions,dwInitialSize,dwMaximumSize);
  return pvVar1;
}



void CmdBatNotification(undefined4 param_1)

{
  undefined auStack1016 [32];
  undefined local_3d8 [64];
  ulonglong local_398;
  undefined4 local_390;
  ulonglong local_18;
  
                    // 0x1ff70  151  CmdBatNotification
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack1016;
  local_398 = FUN_18001ffe0();
  if (local_398 != 0xffffffffffffffff) {
    local_390 = param_1;
    CsrClientCallServer(local_3d8,0,0x10010010,0x10);
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack1016);
  return;
}



ulonglong FUN_18001ffe0(void)

{
  int iVar1;
  ulonglong uVar2;
  ulonglong local_res8 [4];
  
  uVar2 = DAT_1800b2cb0;
  if (DAT_1800b2cb0 == 0) {
    iVar1 = NtQueryInformationProcess(0xffffffffffffffff,0x31,local_res8,8,0);
    if (iVar1 < 0) {
      uVar2 = 0xffffffffffffffff;
    }
    else if ((local_res8[0] & 1) == 0) {
      uVar2 = 0;
      DAT_1800b2cb0 = uVar2;
    }
    else {
      uVar2 = local_res8[0] & 0xfffffffffffffffe;
      DAT_1800b2cb0 = uVar2;
    }
  }
  return uVar2;
}



BOOL CancelIoEx(HANDLE hFile,LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020040. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20040  117  CancelIoEx
  BVar1 = CancelIoEx(hFile,lpOverlapped);
  return BVar1;
}



void K32GetProcessImageFileNameW(void)

{
                    // WARNING: Could not recover jumptable at 0x000180020060. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20060  943  K32GetProcessImageFileNameW
  K32GetProcessImageFileNameW();
  return;
}



BOOL ActivateActCtx(HANDLE hActCtx,ULONG_PTR *lpCookie)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020080. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20080  3  ActivateActCtx
  BVar1 = ActivateActCtx(hActCtx,lpCookie);
  return BVar1;
}



BOOL DeactivateActCtx(DWORD dwFlags,ULONG_PTR ulCookie)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800200a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x200a0  263  DeactivateActCtx
  BVar1 = DeactivateActCtx(dwFlags,ulCookie);
  return BVar1;
}



LPSTR lstrcat(LPSTR lpString1,LPCSTR lpString2)

{
  char cVar1;
  longlong lVar2;
  char *pcVar3;
  
                    // 0x200c0  1603  lstrcat
                    // 0x200c0  1604  lstrcatA
  pcVar3 = lpString1 + -1;
  do {
    pcVar3 = pcVar3 + 1;
  } while (*pcVar3 != '\0');
  lVar2 = 0;
  do {
    cVar1 = lpString2[lVar2];
    pcVar3[lVar2] = cVar1;
    lVar2 = lVar2 + 1;
  } while (cVar1 != '\0');
  return lpString1;
}



HGLOBAL GlobalHandle(LPCVOID pMem)

{
  char cVar1;
  uint local_res10 [2];
  LPCVOID local_res18 [2];
  
                    // 0x200f0  836  GlobalHandle
  local_res18[0] = (HGLOBAL)0x0;
  RtlLockHeap(DAT_1800b2a30);
  local_res18[0] = (HGLOBAL)0x0;
  local_res10[0] = 0x801;
  cVar1 = RtlGetUserInfoHeap(DAT_1800b2a30,0x801,pMem,local_res18,local_res10);
  if (cVar1 == '\0') {
    RtlSetLastWin32Error(6);
  }
  else if ((local_res18[0] == (HGLOBAL)0x0) || ((local_res10[0] & 0x200) == 0)) {
    local_res18[0] = pMem;
  }
  RtlUnlockHeap(DAT_1800b2a30);
  return local_res18[0];
}



BOOL IsDebuggerPresent(void)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800201b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x201b0  902  IsDebuggerPresent
  BVar1 = IsDebuggerPresent();
  return BVar1;
}



DWORD FlsAlloc(PFLS_CALLBACK_FUNCTION lpCallback)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800201d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x201d0  420  FlsAlloc
  DVar1 = FlsAlloc(lpCallback);
  return DVar1;
}



BOOL GetComputerNameExW(COMPUTER_NAME_FORMAT NameType,LPWSTR lpBuffer,LPDWORD nSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800201f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x201f0  488  GetComputerNameExW
  BVar1 = GetComputerNameExW(NameType,lpBuffer,nSize);
  return BVar1;
}



BOOL SetStdHandle(DWORD nStdHandle,HANDLE hHandle)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020210. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20210  1372  SetStdHandle
  BVar1 = SetStdHandle(nStdHandle,hHandle);
  return BVar1;
}



HRSRC FindResourceW(HMODULE hModule,LPCWSTR lpName,LPCWSTR lpType)

{
  HRSRC pHVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020230. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20230  416  FindResourceW
  pHVar1 = FindResourceW(hModule,lpName,lpType);
  return pHVar1;
}



BOOL CreatePipe(PHANDLE hReadPipe,PHANDLE hWritePipe,LPSECURITY_ATTRIBUTES lpPipeAttributes,
               DWORD nSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020250. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20250  225  CreatePipe
  BVar1 = CreatePipe(hReadPipe,hWritePipe,lpPipeAttributes,nSize);
  return BVar1;
}



HANDLE CreateNamedPipeW(LPCWSTR lpName,DWORD dwOpenMode,DWORD dwPipeMode,DWORD nMaxInstances,
                       DWORD nOutBufferSize,DWORD nInBufferSize,DWORD nDefaultTimeOut,
                       LPSECURITY_ATTRIBUTES lpSecurityAttributes)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020270. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20270  224  CreateNamedPipeW
  pvVar1 = CreateNamedPipeW(lpName,dwOpenMode,dwPipeMode,nMaxInstances,nOutBufferSize,nInBufferSize,
                            nDefaultTimeOut,lpSecurityAttributes);
  return pvVar1;
}



void FUN_180020284(longlong param_1)

{
  short *psVar1;
  byte bVar2;
  ushort uVar3;
  ushort *puVar4;
  ulonglong uVar5;
  byte *pbVar6;
  ushort *puVar7;
  
  uVar5 = FUN_18000f960(param_1);
  if ((-1 < (int)uVar5) && (uVar5 = FUN_18000f478(param_1), -1 < (int)uVar5)) {
    if (*(char *)(*(longlong *)(param_1 + 0x10) + 0x31) == '\0') {
      pbVar6 = *(byte **)(*(longlong *)(param_1 + 0x108) + 8);
      bVar2 = *pbVar6;
      while ((bVar2 < 0x21 && (**(short **)(param_1 + 0x108) != 0))) {
        pbVar6 = pbVar6 + 1;
        *(byte **)(*(short **)(param_1 + 0x108) + 4) = pbVar6;
        **(short **)(param_1 + 0x108) = **(short **)(param_1 + 0x108) + -1;
        psVar1 = (short *)(*(longlong *)(param_1 + 0x108) + 2);
        *psVar1 = *psVar1 + -1;
        bVar2 = *pbVar6;
      }
      puVar7 = *(ushort **)(param_1 + 0x108);
      if (((1 < *puVar7) && (bVar2 = *pbVar6, bVar2 == pbVar6[(ulonglong)*puVar7 - 1])) &&
         ((bVar2 == 0x22 || (bVar2 == 0x27)))) {
        *(longlong *)(puVar7 + 4) = *(longlong *)(puVar7 + 4) + 1;
        **(short **)(param_1 + 0x108) = **(short **)(param_1 + 0x108) + -2;
        psVar1 = (short *)(*(longlong *)(param_1 + 0x108) + 2);
        *psVar1 = *psVar1 + -2;
      }
    }
    else {
      puVar7 = *(ushort **)(*(longlong *)(param_1 + 0x150) + 8);
      uVar3 = *puVar7;
      while ((uVar3 < 0x21 && (**(short **)(param_1 + 0x150) != 0))) {
        puVar7 = puVar7 + 1;
        *(ushort **)(*(short **)(param_1 + 0x150) + 4) = puVar7;
        **(short **)(param_1 + 0x150) = **(short **)(param_1 + 0x150) + -2;
        psVar1 = (short *)(*(longlong *)(param_1 + 0x150) + 2);
        *psVar1 = *psVar1 + -2;
        uVar3 = *puVar7;
      }
      puVar4 = *(ushort **)(param_1 + 0x150);
      if (((3 < *puVar4) &&
          (uVar3 = *puVar7,
          uVar3 == *(ushort *)((longlong)puVar7 + ((ulonglong)*puVar4 - 2 & 0xfffffffffffffffe))))
         && ((uVar3 == 0x22 || (uVar3 == 0x27)))) {
        *(longlong *)(puVar4 + 4) = *(longlong *)(puVar4 + 4) + 2;
        **(short **)(param_1 + 0x150) = **(short **)(param_1 + 0x150) + -4;
        psVar1 = (short *)(*(longlong *)(param_1 + 0x150) + 2);
        *psVar1 = *psVar1 + -4;
      }
    }
    FUN_18000f720(param_1,*(ushort **)(param_1 + 0x108),*(ushort **)(param_1 + 0x150),'\x01');
  }
  return;
}



void BasepAppXExtension(undefined param_1,undefined param_2,undefined param_3,undefined param_4,
                       undefined8 param_5,undefined8 param_6)

{
                    // 0x203a0  79  BasepAppXExtension
  AppXPreCreationExtension();
  return;
}



BOOL HeapSetInformation(HANDLE HeapHandle,HEAP_INFORMATION_CLASS HeapInformationClass,
                       PVOID HeapInformation,SIZE_T HeapInformationLength)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800203e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x203e0  858  HeapSetInformation
  BVar1 = HeapSetInformation(HeapHandle,HeapInformationClass,HeapInformation,HeapInformationLength);
  return BVar1;
}



BOOL GetVersionExA(LPOSVERSIONINFOA lpVersionInformation)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020400. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20400  807  GetVersionExA
  BVar1 = GetVersionExA(lpVersionInformation);
  return BVar1;
}



BOOL DeleteTimerQueueTimer(HANDLE TimerQueue,HANDLE Timer,HANDLE CompletionEvent)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020420. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20420  287  DeleteTimerQueueTimer
  BVar1 = DeleteTimerQueueTimer(TimerQueue,Timer,CompletionEvent);
  return BVar1;
}



BOOL EnumTimeFormatsEx(TIMEFMT_ENUMPROCEX lpTimeFmtEnumProcEx,LPCWSTR lpLocaleName,DWORD dwFlags,
                      LPARAM lParam)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020440. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20440  351  EnumTimeFormatsEx
  BVar1 = EnumTimeFormatsEx(lpTimeFmtEnumProcEx,lpLocaleName,dwFlags,lParam);
  return BVar1;
}



HRESULT WerUnregisterFile(PCWSTR pwzFilePath)

{
  HRESULT HVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020460. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20460  1543  WerUnregisterFile
  HVar1 = WerUnregisterFile(pwzFilePath);
  return HVar1;
}



HRESULT WerRegisterFile(PCWSTR pwzFile,WER_REGISTER_FILE_TYPE regFileType,DWORD dwFlags)

{
  HRESULT HVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020480. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20480  1531  WerRegisterFile
  HVar1 = WerRegisterFile(pwzFile,regFileType,dwFlags);
  return HVar1;
}



void WTSGetActiveConsoleSessionId(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800204a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x204a0  1509  WTSGetActiveConsoleSessionId
  RtlGetActiveConsoleId();
  return;
}



undefined8
FUN_1800204c0(undefined param_1,undefined param_2,undefined param_3,undefined param_4,int *param_5,
             int param_6)

{
  int iVar1;
  undefined7 in_register_00000089;
  
  iVar1 = 0;
  if (param_6 == 4) {
    iVar1 = *param_5;
  }
  *(uint *)CONCAT71(in_register_00000089,param_4) = (uint)(iVar1 != 0);
  return 0;
}



HMODULE LoadLibraryA(LPCSTR lpLibFileName)

{
  HMODULE pHVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800204f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x204f0  969  LoadLibraryA
  pHVar1 = LoadLibraryA(lpLibFileName);
  return pHVar1;
}



DWORD VerLanguageNameW(DWORD wLang,LPWSTR szLang,DWORD cchLang)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020510. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20510  1492  VerLanguageNameW
  DVar1 = VerLanguageNameW(wLang,szLang,cchLang);
  return DVar1;
}



BOOL GlobalMemoryStatusEx(LPMEMORYSTATUSEX lpBuffer)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020530. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20530  839  GlobalMemoryStatusEx
  BVar1 = GlobalMemoryStatusEx(lpBuffer);
  return BVar1;
}



void FUN_180020550(void *param_1,void *param_2)

{
  memcmp(param_1,param_2,0x10);
  return;
}



BOOL GetThreadContext(HANDLE hThread,LPCONTEXT lpContext)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020570. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20570  770  GetThreadContext
  BVar1 = GetThreadContext(hThread,lpContext);
  return BVar1;
}



BOOL GetUserPreferredUILanguages
               (DWORD dwFlags,PULONG pulNumLanguages,PZZWSTR pwszLanguagesBuffer,
               PULONG pcchLanguagesBuffer)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020590. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20590  804  GetUserPreferredUILanguages
  BVar1 = GetUserPreferredUILanguages
                    (dwFlags,pulNumLanguages,pwszLanguagesBuffer,pcchLanguagesBuffer);
  return BVar1;
}



PTP_WORK CreateThreadpoolWork(PTP_WORK_CALLBACK pfnwk,PVOID pv,PTP_CALLBACK_ENVIRON pcbe)

{
  int iVar1;
  PTP_WORK local_res20;
  
                    // 0x205b0  252  CreateThreadpoolWork
  iVar1 = TpAllocWork(&local_res20,pfnwk,pv,pcbe);
  if (iVar1 < 0) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
    local_res20 = (PTP_WORK)0x0;
  }
  return local_res20;
}



void CheckElevationEnabled(uint *param_1)

{
  int iVar1;
  uint local_res10 [6];
  
                    // 0x205f0  126  CheckElevationEnabled
  iVar1 = RtlQueryElevationFlags(local_res10);
  if (-1 < iVar1) {
    *param_1 = local_res10[0] & 1;
    iVar1 = 0;
  }
                    // WARNING: Could not recover jumptable at 0x000180020620. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlNtStatusToDosErrorNoTeb(iVar1);
  return;
}



int LCIDToLocaleName(LCID Locale,LPWSTR lpName,int cchName,DWORD dwFlags)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020640. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20640  950  LCIDToLocaleName
  iVar1 = LCIDToLocaleName(Locale,lpName,cchName,dwFlags);
  return iVar1;
}



LANGID GetSystemDefaultUILanguage(void)

{
  LANGID LVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020660. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20660  745  GetSystemDefaultUILanguage
  LVar1 = GetSystemDefaultUILanguage();
  return LVar1;
}



void GetNativeSystemInfo(LPSYSTEM_INFO lpSystemInfo)

{
                    // WARNING: Could not recover jumptable at 0x000180020680. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20680  655  GetNativeSystemInfo
  GetNativeSystemInfo(lpSystemInfo);
  return;
}



int GetDateFormatW(LCID Locale,DWORD dwFlags,SYSTEMTIME *lpDate,LPCWSTR lpFormat,LPWSTR lpDateStr,
                  int cchDate)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800206a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x206a0  556  GetDateFormatW
  iVar1 = GetDateFormatW(Locale,dwFlags,lpDate,lpFormat,lpDateStr,cchDate);
  return iVar1;
}



BOOL CopyFileExW(LPCWSTR lpExistingFileName,LPCWSTR lpNewFileName,
                LPPROGRESS_ROUTINE lpProgressRoutine,LPVOID lpData,LPBOOL pbCancel,DWORD dwCopyFlags
                )

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800206c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x206c0  174  CopyFileExW
  BVar1 = CopyFileExW(lpExistingFileName,lpNewFileName,lpProgressRoutine,lpData,pbCancel,dwCopyFlags
                     );
  return BVar1;
}



HRESULT WerRegisterMemoryBlock(PVOID pvAddress,DWORD dwSize)

{
  HRESULT HVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800206e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x206e0  1533  WerRegisterMemoryBlock
  HVar1 = WerRegisterMemoryBlock(pvAddress,dwSize);
  return HVar1;
}



BOOL SetProcessShutdownParameters(DWORD dwLevel,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020700. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20700  1367  SetProcessShutdownParameters
  BVar1 = SetProcessShutdownParameters(dwLevel,dwFlags);
  return BVar1;
}



HANDLE OpenFileMappingW(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCWSTR lpName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020720. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20720  1035  OpenFileMappingW
  pvVar1 = OpenFileMappingW(dwDesiredAccess,bInheritHandle,lpName);
  return pvVar1;
}



BOOL GetSystemTimeAdjustment
               (PDWORD lpTimeAdjustment,PDWORD lpTimeIncrement,PBOOL lpTimeAdjustmentDisabled)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020740. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20740  755  GetSystemTimeAdjustment
  BVar1 = GetSystemTimeAdjustment(lpTimeAdjustment,lpTimeIncrement,lpTimeAdjustmentDisabled);
  return BVar1;
}



BOOL TerminateProcess(HANDLE hProcess,UINT uExitCode)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020760. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20760  1439  TerminateProcess
  BVar1 = TerminateProcess(hProcess,uExitCode);
  return BVar1;
}



DWORD SuspendThread(HANDLE hThread)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020780. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20780  1432  SuspendThread
  DVar1 = SuspendThread(hThread);
  return DVar1;
}



PTP_WAIT CreateThreadpoolWait(PTP_WAIT_CALLBACK pfnwa,PVOID pv,PTP_CALLBACK_ENVIRON pcbe)

{
  int iVar1;
  PTP_WAIT local_res20;
  
                    // 0x207a0  251  CreateThreadpoolWait
  iVar1 = TpAllocWait(&local_res20,pfnwa,pv,pcbe);
  if (iVar1 < 0) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
    local_res20 = (PTP_WAIT)0x0;
  }
  return local_res20;
}



DWORD GetProcessIdOfThread(HANDLE Thread)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800207e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x207e0  706  GetProcessIdOfThread
  DVar1 = GetProcessIdOfThread(Thread);
  return DVar1;
}



HANDLE CreatePrivateNamespaceW
                 (LPSECURITY_ATTRIBUTES lpPrivateNamespaceAttributes,LPVOID lpBoundaryDescriptor,
                 LPCWSTR lpAliasPrefix)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020800. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20800  227  CreatePrivateNamespaceW
  pvVar1 = CreatePrivateNamespaceW(lpPrivateNamespaceAttributes,lpBoundaryDescriptor,lpAliasPrefix);
  return pvVar1;
}



void DeleteBoundaryDescriptor(HANDLE BoundaryDescriptor)

{
                    // WARNING: Could not recover jumptable at 0x000180020820. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20820  276  DeleteBoundaryDescriptor
  DeleteBoundaryDescriptor(BoundaryDescriptor);
  return;
}



HANDLE CreateBoundaryDescriptorW(LPCWSTR Name,ULONG Flags)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020840. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20840  183  CreateBoundaryDescriptorW
  pvVar1 = CreateBoundaryDescriptorW(Name,Flags);
  return pvVar1;
}



BOOL GetNumaHighestNodeNumber(PULONG HighestNodeNumber)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020860. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20860  660  GetNumaHighestNodeNumber
  BVar1 = GetNumaHighestNodeNumber(HighestNodeNumber);
  return BVar1;
}



HRESULT WerRegisterRuntimeExceptionModule(PCWSTR pwszOutOfProcessCallbackDll,PVOID pContext)

{
  HRESULT HVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020880. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20880  1535  WerRegisterRuntimeExceptionModule
  HVar1 = WerRegisterRuntimeExceptionModule(pwszOutOfProcessCallbackDll,pContext);
  return HVar1;
}



BOOL AddSIDToBoundaryDescriptor(HANDLE *BoundaryDescriptor,PSID RequiredSid)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800208a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x208a0  16  AddSIDToBoundaryDescriptor
  BVar1 = AddSIDToBoundaryDescriptor(BoundaryDescriptor,RequiredSid);
  return BVar1;
}



BOOL IsProcessInJob(HANDLE ProcessHandle,HANDLE JobHandle,PBOOL Result)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800208c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x208c0  908  IsProcessInJob
  BVar1 = IsProcessInJob(ProcessHandle,JobHandle,Result);
  return BVar1;
}



HANDLE CreateMemoryResourceNotification(MEMORY_RESOURCE_NOTIFICATION_TYPE NotificationType)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800208e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x208e0  218  CreateMemoryResourceNotification
  pvVar1 = CreateMemoryResourceNotification(NotificationType);
  return pvVar1;
}



DWORD GetTimeZoneInformation(LPTIME_ZONE_INFORMATION lpTimeZoneInformation)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020900. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20900  793  GetTimeZoneInformation
  DVar1 = GetTimeZoneInformation(lpTimeZoneInformation);
  return DVar1;
}



undefined8 FUN_180020920(LPCWSTR *param_1,ushort *param_2,undefined4 *param_3)

{
  bool bVar1;
  int iVar2;
  BOOL BVar3;
  uint uVar4;
  undefined **ppuVar5;
  
  *param_3 = 0;
  bVar1 = false;
  if (param_2 == (ushort *)0x0) {
    iVar2 = FUN_180019c80(param_1);
    if ((iVar2 != 0) &&
       (BVar3 = EnumResourceNamesW((HMODULE)param_1[8],(LPCWSTR)&DAT_00000018,FUN_18006b030,
                                   (LONG_PTR)param_3), BVar3 == 0)) {
      GetLastError();
    }
  }
  else if (*param_2 != 0) {
    uVar4 = 0;
    ppuVar5 = &PTR_u_JR_Inno_Setup_18007fca0;
    do {
      if (bVar1) {
        return 0;
      }
      if (((ulonglong)*(uint *)((wchar_t **)ppuVar5 + -2) * 2 <= (ulonglong)*param_2) &&
         (iVar2 = _wcsnicmp(*(wchar_t **)(param_2 + 4),(wchar_t *)*ppuVar5,
                            (ulonglong)*(uint *)((wchar_t **)ppuVar5 + -2)), iVar2 == 0)) {
        *param_3 = 1;
        bVar1 = true;
      }
      uVar4 = uVar4 + 1;
      ppuVar5 = (undefined **)((wchar_t **)ppuVar5 + 3);
    } while (uVar4 < 8);
  }
  return 0;
}



BOOL SetEnvironmentVariableW(LPCWSTR lpName,LPCWSTR lpValue)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800209c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x209c0  1317  SetEnvironmentVariableW
  BVar1 = SetEnvironmentVariableW(lpName,lpValue);
  return BVar1;
}



int ResolveLocaleName(LPCWSTR lpNameToResolve,LPWSTR lpLocaleName,int cchLocaleName)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800209e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x209e0  1234  ResolveLocaleName
  iVar1 = ResolveLocaleName(lpNameToResolve,lpLocaleName,cchLocaleName);
  return iVar1;
}



LSTATUS RegOpenKeyExW(HKEY hKey,LPCWSTR lpSubKey,DWORD ulOptions,REGSAM samDesired,PHKEY phkResult)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020a00. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20a00  1178  RegOpenKeyExW
  LVar1 = RegOpenKeyExW(hKey,lpSubKey,ulOptions,samDesired,phkResult);
  return LVar1;
}



EXECUTION_STATE SetThreadExecutionState(EXECUTION_STATE esFlags)

{
  int iVar1;
  undefined4 in_register_0000000c;
  EXECUTION_STATE local_res10 [6];
  
                    // 0x20a20  1385  SetThreadExecutionState
  local_res10[0] = 0;
  iVar1 = NtSetThreadExecutionState(CONCAT44(in_register_0000000c,esFlags),local_res10);
  if (iVar1 < 0) {
    BaseSetLastNTError();
    local_res10[0] = 0;
  }
  return local_res10[0];
}



// WARNING: Could not reconcile some variable overlaps

BOOL SetDllDirectoryW(LPCWSTR lpPathName)

{
  short sVar1;
  uint uVar2;
  int iVar3;
  LPCWSTR pWVar4;
  longlong lVar5;
  undefined local_18 [16];
  
                    // 0x20a60  1311  SetDllDirectoryW
  uVar2 = 0;
  local_18 = ZEXT816(0);
  if (lpPathName != (LPCWSTR)0x0) {
    lVar5 = 0x7fff;
    pWVar4 = lpPathName;
    do {
      if (*pWVar4 == L'\0') break;
      pWVar4 = pWVar4 + 1;
      lVar5 = lVar5 + -1;
    } while (lVar5 != 0);
    uVar2 = ~-(uint)(lVar5 != 0) & 0xc000000d;
    if (lVar5 != 0) {
      sVar1 = (-(ushort)(lVar5 != 0) & 0x7fffU - (short)lVar5) * 2;
      local_18 = ZEXT816(lpPathName) << 0x40;
    }
  }
  if ((-1 < (int)uVar2) && (iVar3 = LdrSetDllDirectory(local_18), -1 < iVar3)) {
    return 1;
  }
  BaseSetLastNTError();
  return 0;
}



BOOL FlsFree(DWORD dwFlsIndex)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020b10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20b10  421  FlsFree
  BVar1 = FlsFree(dwFlsIndex);
  return BVar1;
}



LANGID GetUserDefaultUILanguage(void)

{
  LANGID LVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020b30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20b30  802  GetUserDefaultUILanguage
  LVar1 = GetUserDefaultUILanguage();
  return LVar1;
}



BOOL SetPriorityClass(HANDLE hProcess,DWORD dwPriorityClass)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020b50. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20b50  1356  SetPriorityClass
  BVar1 = SetPriorityClass(hProcess,dwPriorityClass);
  return BVar1;
}



BOOL SetThreadGroupAffinity
               (HANDLE hThread,GROUP_AFFINITY *GroupAffinity,PGROUP_AFFINITY PreviousGroupAffinity)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020b70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20b70  1386  SetThreadGroupAffinity
  BVar1 = SetThreadGroupAffinity(hThread,GroupAffinity,PreviousGroupAffinity);
  return BVar1;
}



void BasepReleaseAppXContext(void)

{
                    // WARNING: Could not recover jumptable at 0x000180020b90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20b90  100  BasepReleaseAppXContext
  AppXReleaseAppXContext();
  return;
}



void BasepPostSuccessAppXExtension(void)

{
                    // WARNING: Could not recover jumptable at 0x000180020bb0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20bb0  96  BasepPostSuccessAppXExtension
  AppXPostSuccessExtension();
  return;
}



int GetLocaleInfoA(LCID Locale,LCTYPE LCType,LPSTR lpLCData,int cchData)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020bd0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20bd0  621  GetLocaleInfoA
  iVar1 = GetLocaleInfoA(Locale,LCType,lpLCData,cchData);
  return iVar1;
}



BOOL AreFileApisANSI(void)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020bf0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20bf0  36  AreFileApisANSI
  BVar1 = AreFileApisANSI();
  return BVar1;
}



DWORD GetThreadId(HANDLE Thread)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020c10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20c10  775  GetThreadId
  DVar1 = GetThreadId(Thread);
  return DVar1;
}



PTP_POOL CreateThreadpool(PVOID reserved)

{
  int iVar1;
  PTP_POOL local_res10 [3];
  
                    // 0x20c30  247  CreateThreadpool
  iVar1 = TpAllocPool(local_res10,reserved);
  if (iVar1 < 0) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
    local_res10[0] = (PTP_POOL)0x0;
  }
  return local_res10[0];
}



BOOL CancelIo(HANDLE hFile)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020c70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20c70  116  CancelIo
  BVar1 = CancelIo(hFile);
  return BVar1;
}



BOOL MoveFileExW(LPCWSTR lpExistingFileName,LPCWSTR lpNewFileName,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020c90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20c90  1008  MoveFileExW
  BVar1 = MoveFileExW(lpExistingFileName,lpNewFileName,dwFlags);
  return BVar1;
}



LCID GetSystemDefaultLCID(void)

{
  LCID LVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020cb0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20cb0  742  GetSystemDefaultLCID
  LVar1 = GetSystemDefaultLCID();
  return LVar1;
}



DWORD GetPrivateProfileSectionW
                (LPCWSTR lpAppName,LPWSTR lpReturnedString,DWORD nSize,LPCWSTR lpFileName)

{
  int iVar1;
  ulonglong uVar2;
  DWORD local_res18 [4];
  
                    // 0x20cd0  692  GetPrivateProfileSectionW
  uVar2 = 0;
  local_res18[0] = nSize;
  iVar1 = BaseDllReadWriteIniFile
                    ('\x01','\0','\x01',lpFileName,lpAppName,(short *)0x0,lpReturnedString,
                     (int *)local_res18);
  if (iVar1 < 0) {
    if (iVar1 == -0x7ffffffb) {
      if (1 < nSize) {
        local_res18[0] = nSize - 2;
        lpReturnedString[nSize - 1] = L'\0';
        goto LAB_180020d2b;
      }
    }
    else if (iVar1 == -0x3fffff85) {
      RtlSetLastWin32Error();
    }
    else {
      BaseSetLastNTError();
    }
    local_res18[0] = 0;
  }
  else {
    RtlSetLastWin32Error();
    local_res18[0] = local_res18[0] - 1;
LAB_180020d2b:
    uVar2 = (ulonglong)local_res18[0];
  }
  if ((uint)uVar2 < nSize) {
    lpReturnedString[uVar2] = L'\0';
  }
  else if (nSize != 0) {
    lpReturnedString[nSize - 1] = L'\0';
  }
  return local_res18[0];
}



// WARNING: Could not reconcile some variable overlaps

longlong CreateThreadpoolIo(undefined8 param_1,longlong param_2,longlong param_3,undefined4 *param_4
                           )

{
  int iVar1;
  longlong *plVar2;
  longlong lVar3;
  longlong in_GS_OFFSET;
  longlong lStackX16;
  undefined4 uStack104;
  undefined4 uStack100;
  undefined8 uStack96;
  longlong lStack88;
  code *pcStack80;
  undefined auStack72 [16];
  code *pcStack56;
  undefined4 uStack48;
  undefined4 uStack44;
  undefined8 uStack40;
  
                    // 0x20d60  249  CreateThreadpoolIo
  lStackX16 = 0;
  if (param_2 == 0) {
    SetLastError(0x57);
    RaiseException(0xc000000d,0,0,(ULONG_PTR *)0x0);
    return 0;
  }
  plVar2 = (longlong *)
           RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,0x20);
  if (plVar2 == (longlong *)0x0) {
    iVar1 = -0x3fffffe9;
  }
  else {
    *plVar2 = param_2;
    if (param_4 == (undefined4 *)0x0) {
      uStack104 = 3;
      uStack96 = 0;
      lStack88 = 0;
      pcStack80 = (code *)0x0;
      auStack72 = ZEXT816(0);
      lVar3 = 0;
      uStack48 = 0;
      uStack44 = 1;
      uStack40 = CONCAT44(uStack40._4_4_,0x48);
    }
    else {
      uStack104 = *param_4;
      uStack100 = param_4[1];
      uStack96 = *(undefined8 *)(param_4 + 2);
      lStack88 = *(longlong *)(param_4 + 4);
      pcStack80 = *(code **)(param_4 + 6);
      auStack72 = *(undefined (*) [16])(param_4 + 8);
      lVar3 = *(longlong *)(param_4 + 0xc);
      uStack48 = param_4[0xe];
      uStack44 = param_4[0xf];
      uStack40 = *(undefined8 *)(param_4 + 0x10);
    }
    plVar2[1] = lVar3;
    pcStack56 = FUN_180057fa0;
    if ((lStack88 == 0) || (pcStack80 == (code *)0x0)) {
      plVar2[2] = 0;
    }
    else {
      plVar2[2] = (longlong)pcStack80;
      pcStack80 = FUN_180057f70;
    }
    *plVar2 = param_2;
    plVar2[3] = param_3;
    iVar1 = TpAllocIoCompletion(&lStackX16,param_1,FUN_18001bb20,plVar2,&uStack104);
    if (-1 < iVar1) goto LAB_180020f02;
    lStackX16 = 0;
  }
  RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
LAB_180020f02:
  if ((lStackX16 == 0) && (plVar2 != (longlong *)0x0)) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,plVar2);
  }
  return lStackX16;
}



// WARNING: Could not reconcile some variable overlaps

longlong FUN_180020d6c(undefined8 param_1,longlong param_2,longlong param_3,undefined4 *param_4)

{
  int iVar1;
  longlong *plVar2;
  longlong lVar3;
  longlong in_GS_OFFSET;
  longlong local_res10;
  undefined4 local_68;
  undefined4 uStack100;
  undefined8 uStack96;
  longlong local_58;
  code *pcStack80;
  undefined local_48 [16];
  code *local_38;
  undefined4 uStack48;
  undefined4 uStack44;
  undefined8 local_28;
  
  local_res10 = 0;
  if (param_2 == 0) {
    SetLastError(0x57);
    RaiseException(0xc000000d,0,0,(ULONG_PTR *)0x0);
    return 0;
  }
  plVar2 = (longlong *)
           RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,0x20);
  if (plVar2 == (longlong *)0x0) {
    iVar1 = -0x3fffffe9;
  }
  else {
    *plVar2 = param_2;
    if (param_4 == (undefined4 *)0x0) {
      local_68 = 3;
      uStack96 = 0;
      local_58 = 0;
      pcStack80 = (code *)0x0;
      local_48 = ZEXT816(0);
      lVar3 = 0;
      uStack48 = 0;
      uStack44 = 1;
      local_28 = CONCAT44(local_28._4_4_,0x48);
    }
    else {
      local_68 = *param_4;
      uStack100 = param_4[1];
      uStack96 = *(undefined8 *)(param_4 + 2);
      local_58 = *(longlong *)(param_4 + 4);
      pcStack80 = *(code **)(param_4 + 6);
      local_48 = *(undefined (*) [16])(param_4 + 8);
      lVar3 = *(longlong *)(param_4 + 0xc);
      uStack48 = param_4[0xe];
      uStack44 = param_4[0xf];
      local_28 = *(undefined8 *)(param_4 + 0x10);
    }
    plVar2[1] = lVar3;
    local_38 = FUN_180057fa0;
    if ((local_58 == 0) || (pcStack80 == (code *)0x0)) {
      plVar2[2] = 0;
    }
    else {
      plVar2[2] = (longlong)pcStack80;
      pcStack80 = FUN_180057f70;
    }
    *plVar2 = param_2;
    plVar2[3] = param_3;
    iVar1 = TpAllocIoCompletion(&local_res10,param_1,FUN_18001bb20,plVar2,&local_68);
    if (-1 < iVar1) goto LAB_180020f02;
    local_res10 = 0;
  }
  RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
LAB_180020f02:
  if ((local_res10 == 0) && (plVar2 != (longlong *)0x0)) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,plVar2);
  }
  return local_res10;
}



DWORD GetDynamicTimeZoneInformation(PDYNAMIC_TIME_ZONE_INFORMATION pTimeZoneInformation)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020f40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20f40  573  GetDynamicTimeZoneInformation
  DVar1 = GetDynamicTimeZoneInformation(pTimeZoneInformation);
  return DVar1;
}



undefined8 BaseCheckAppcompatCacheExWorker(void)

{
                    // 0x20f60  44  BaseCheckAppcompatCacheExWorker
                    // 0x20f60  45  BaseCheckAppcompatCacheWorker
                    // 0x20f60  63  BaseIsAppcompatInfrastructureDisabled
                    // 0x20f60  64  BaseIsAppcompatInfrastructureDisabledWorker
                    // 0x20f60  1494  VerifyConsoleIoHandle
  return 0;
}



LPWSTR lstrcpynW(LPWSTR lpString1,LPCWSTR lpString2,int iMaxLength)

{
  LPWSTR pWVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020f70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20f70  1617  lstrcpynW
  pWVar1 = lstrcpynW(lpString1,lpString2,iMaxLength);
  return pWVar1;
}



BOOL GetModuleHandleExA(DWORD dwFlags,LPCSTR lpModuleName,HMODULE *phModule)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020f90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20f90  640  GetModuleHandleExA
  BVar1 = GetModuleHandleExA(dwFlags,lpModuleName,phModule);
  return BVar1;
}



BOOL QueueUserWorkItem(LPTHREAD_START_ROUTINE Function,PVOID Context,ULONG Flags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020fb0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20fb0  1118  QueueUserWorkItem
  BVar1 = QueueUserWorkItem(Function,Context,Flags);
  return BVar1;
}



BOOL ConnectNamedPipe(HANDLE hNamedPipe,LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020fd0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20fd0  160  ConnectNamedPipe
  BVar1 = ConnectNamedPipe(hNamedPipe,lpOverlapped);
  return BVar1;
}



LANGID GetSystemDefaultLangID(void)

{
  LANGID LVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180020ff0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x20ff0  743  GetSystemDefaultLangID
  LVar1 = GetSystemDefaultLangID();
  return LVar1;
}



DWORD GetVersion(void)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021010. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21010  806  GetVersion
  DVar1 = GetVersion();
  return DVar1;
}



void FreeLibraryAndExitThread(HMODULE hLibModule,DWORD dwExitCode)

{
                    // 0x21030  438  FreeLibraryAndExitThread
                    // WARNING: Subroutine does not return
  FreeLibraryAndExitThread(hLibModule,dwExitCode);
}



DWORD GetCurrentDirectoryA(DWORD nBufferLength,LPSTR lpBuffer)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021050. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21050  538  GetCurrentDirectoryA
  DVar1 = GetCurrentDirectoryA(nBufferLength,lpBuffer);
  return DVar1;
}



BOOL GetLogicalProcessorInformation
               (PSYSTEM_LOGICAL_PROCESSOR_INFORMATION Buffer,PDWORD ReturnedLength)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021070. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21070  627  GetLogicalProcessorInformation
  BVar1 = GetLogicalProcessorInformation(Buffer,ReturnedLength);
  return BVar1;
}



BOOL TerminateJobObject(HANDLE hJob,UINT uExitCode)

{
  int iVar1;
  
                    // 0x21090  1438  TerminateJobObject
  iVar1 = NtTerminateJobObject();
  if (iVar1 < 0) {
    BaseSetLastNTError();
  }
  return (uint)(iVar1 >= 0);
}



DWORD GetPriorityClass(HANDLE hProcess)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800210c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x210c0  686  GetPriorityClass
  DVar1 = GetPriorityClass(hProcess);
  return DVar1;
}



void K32EnumProcessModules(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800210e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x210e0  927  K32EnumProcessModules
  K32EnumProcessModules();
  return;
}



BOOL FindActCtxSectionStringW
               (DWORD dwFlags,GUID *lpExtensionGuid,ULONG ulSectionId,LPCWSTR lpStringToFind,
               PACTCTX_SECTION_KEYED_DATA ReturnedData)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021100. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21100  379  FindActCtxSectionStringW
  BVar1 = FindActCtxSectionStringW(dwFlags,lpExtensionGuid,ulSectionId,lpStringToFind,ReturnedData);
  return BVar1;
}



BOOL SetThreadpoolThreadMinimum(PTP_POOL ptpp,DWORD cthrdMic)

{
  int iVar1;
  
                    // 0x21120  1400  SetThreadpoolThreadMinimum
  iVar1 = TpSetPoolMinThreads();
  if (iVar1 < 0) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  }
  return (uint)(iVar1 >= 0);
}



BOOL GetProductInfo(DWORD dwOSMajorVersion,DWORD dwOSMinorVersion,DWORD dwSpMajorVersion,
                   DWORD dwSpMinorVersion,PDWORD pdwReturnedProductType)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021150. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21150  718  GetProductInfo
  BVar1 = GetProductInfo(dwOSMajorVersion,dwOSMinorVersion,dwSpMajorVersion,dwSpMinorVersion,
                         pdwReturnedProductType);
  return BVar1;
}



BOOL UnregisterWaitEx(HANDLE WaitHandle,HANDLE CompletionEvent)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021170. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21170  1483  UnregisterWaitEx
  BVar1 = UnregisterWaitEx(WaitHandle,CompletionEvent);
  return BVar1;
}



HANDLE CreateActCtxW(PCACTCTXW pActCtx)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021190. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21190  180  CreateActCtxW
  pvVar1 = CreateActCtxW(pActCtx);
  return pvVar1;
}



PTP_CLEANUP_GROUP CreateThreadpoolCleanupGroup(void)

{
  int iVar1;
  PTP_CLEANUP_GROUP local_res8 [4];
  
                    // 0x211b0  248  CreateThreadpoolCleanupGroup
  iVar1 = TpAllocCleanupGroup(local_res8);
  if (iVar1 < 0) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
    local_res8[0] = (PTP_CLEANUP_GROUP)0x0;
  }
  return local_res8[0];
}



BOOL DeleteTimerQueue(HANDLE TimerQueue)

{
  BOOL BVar1;
  
                    // 0x211f0  285  DeleteTimerQueue
  BVar1 = DeleteTimerQueueEx(TimerQueue,(HANDLE)0x0);
  if (BVar1 == 0) {
    GetLastError();
  }
  return (uint)(BVar1 != 0);
}



void ReleaseActCtx(HANDLE hActCtx)

{
                    // WARNING: Could not recover jumptable at 0x000180021220. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21220  1205  ReleaseActCtx
  ReleaseActCtx(hActCtx);
  return;
}



HANDLE CreateTimerQueue(void)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021240. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21240  253  CreateTimerQueue
  pvVar1 = CreateTimerQueue();
  return pvVar1;
}



BOOL DeleteTimerQueueEx(HANDLE TimerQueue,HANDLE CompletionEvent)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021260. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21260  286  DeleteTimerQueueEx
  BVar1 = DeleteTimerQueueEx(TimerQueue,CompletionEvent);
  return BVar1;
}



BOOL ChangeTimerQueueTimer(HANDLE TimerQueue,HANDLE Timer,ULONG DueTime,ULONG Period)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021280. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21280  123  ChangeTimerQueueTimer
  BVar1 = ChangeTimerQueueTimer(TimerQueue,Timer,DueTime,Period);
  return BVar1;
}



BOOL HeapDestroy(HANDLE hHeap)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800212a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x212a0  853  HeapDestroy
  BVar1 = HeapDestroy(hHeap);
  return BVar1;
}



UINT GetOEMCP(void)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800212c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x212c0  674  GetOEMCP
  UVar1 = GetOEMCP();
  return UVar1;
}



UINT SetHandleCount(UINT uNumber)

{
                    // 0x212e0  1341  SetHandleCount
  return uNumber;
}



BOOL TrySubmitThreadpoolCallback(PTP_SIMPLE_CALLBACK pfns,PVOID pv,PTP_CALLBACK_ENVIRON pcbe)

{
  int iVar1;
  
                    // 0x212f0  1467  TrySubmitThreadpoolCallback
  iVar1 = TpSimpleTryPost();
  if (iVar1 < 0) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  }
  return (uint)(iVar1 >= 0);
}



HRESULT RegisterApplicationRestart(PCWSTR pwzCommandline,DWORD dwFlags)

{
  HRESULT HVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021320. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21320  1194  RegisterApplicationRestart
  HVar1 = RegisterApplicationRestart(pwzCommandline,dwFlags);
  return HVar1;
}



BOOL GetSystemPreferredUILanguages
               (DWORD dwFlags,PULONG pulNumLanguages,PZZWSTR pwszLanguagesBuffer,
               PULONG pcchLanguagesBuffer)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021340. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21340  752  GetSystemPreferredUILanguages
  BVar1 = GetSystemPreferredUILanguages
                    (dwFlags,pulNumLanguages,pwszLanguagesBuffer,pcchLanguagesBuffer);
  return BVar1;
}



BOOL SetCurrentDirectoryW(LPCWSTR lpPathName)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021360. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21360  1306  SetCurrentDirectoryW
  BVar1 = SetCurrentDirectoryW(lpPathName);
  return BVar1;
}



BOOL SetProcessPriorityBoost(HANDLE hProcess,BOOL bDisablePriorityBoost)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021380. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21380  1366  SetProcessPriorityBoost
  BVar1 = SetProcessPriorityBoost(hProcess,bDisablePriorityBoost);
  return BVar1;
}



BOOLEAN RtlAddFunctionTable(PRUNTIME_FUNCTION FunctionTable,DWORD EntryCount,DWORD64 BaseAddress)

{
  BOOLEAN BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800213a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x213a0  1237  RtlAddFunctionTable
  BVar1 = RtlAddFunctionTable(FunctionTable,EntryCount,BaseAddress);
  return BVar1;
}



DWORD VerLanguageNameA(DWORD wLang,LPSTR szLang,DWORD cchLang)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800213c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x213c0  1491  VerLanguageNameA
  DVar1 = VerLanguageNameA(wLang,szLang,cchLang);
  return DVar1;
}



INT BaseCleanupAppcompatCacheSupportWorker(void)

{
                    // 0x213e0  48  BaseCleanupAppcompatCacheSupportWorker
                    // 0x213e0  62  BaseInitAppcompatCacheSupportWorker
                    // 0x213e0  141  CloseProfileUserMapping
                    // 0x213e0  964  LZStart
                    // 0x213e0  1045  OpenProfileUserMapping
                    // 0x213e0  1288  SetConsoleMaximumWindowSize
  return 1;
}



BOOL SetThreadPriorityBoost(HANDLE hThread,BOOL bDisablePriorityBoost)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800213f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x213f0  1393  SetThreadPriorityBoost
  BVar1 = SetThreadPriorityBoost(hThread,bDisablePriorityBoost);
  return BVar1;
}



undefined8 FUN_180021410(void)

{
  return 0x2000;
}



undefined8 FUN_180021420(void)

{
  return 0x24a2;
}



undefined FUN_180021430(void)

{
  return 0;
}



undefined4 FUN_180021440(longlong param_1)

{
  return *(undefined4 *)(param_1 + 0x14);
}



undefined4 FUN_180021450(longlong param_1)

{
  return *(undefined4 *)(param_1 + 8);
}



undefined4 FUN_180021460(longlong param_1)

{
  return *(undefined4 *)(param_1 + 0x10);
}



undefined4 FUN_180021470(longlong param_1)

{
  return *(undefined4 *)(param_1 + 0xc);
}



undefined8 FUN_180021480(ushort *param_1,longlong param_2)

{
  *(int *)(param_2 + 0x28) = *(int *)(param_2 + 0x28) + 1;
  *(int *)(param_2 + 0x24) = *(int *)(param_2 + 0x24) + (uint)*param_1;
  return 0;
}



undefined8 FUN_1800214a0(undefined8 param_1,undefined8 param_2,undefined4 *param_3)

{
  *param_3 = 2;
  return 0;
}



bool Thread32Next(undefined8 param_1,int *param_2)

{
  int *piVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  longlong lVar6;
  bool bVar7;
  longlong local_res10;
  undefined8 local_res18;
  undefined8 local_res20;
  
                    // 0x214c0  1456  Thread32Next
  if ((param_2 != (int *)0x0) && (*param_2 == 0x1c)) {
    local_res18 = 0;
    local_res20 = 0;
    local_res10 = 0;
    iVar5 = NtMapViewOfSection(param_1,0xffffffffffffffff,&local_res10,0,0,&local_res18,&local_res20
                               ,1,0,4);
    if (-1 < iVar5) {
      uVar2 = *(uint *)(local_res10 + 0x3c);
      bVar7 = *(uint *)(local_res10 + 0xc) <= uVar2;
      if (bVar7) {
        RtlSetLastWin32Error(0x12);
      }
      else {
        lVar6 = (ulonglong)uVar2 * 0x1c + *(longlong *)(local_res10 + 0x28);
        *(uint *)(local_res10 + 0x3c) = uVar2 + 1;
        piVar1 = (int *)(lVar6 + local_res10);
        iVar5 = piVar1[1];
        iVar3 = piVar1[2];
        iVar4 = piVar1[3];
        *param_2 = *piVar1;
        param_2[1] = iVar5;
        param_2[2] = iVar3;
        param_2[3] = iVar4;
        *(undefined8 *)(param_2 + 4) = *(undefined8 *)(lVar6 + 0x10 + local_res10);
        param_2[6] = *(int *)(lVar6 + 0x18 + local_res10);
      }
      NtUnmapViewOfSection(0xffffffffffffffff,local_res10);
      return !bVar7;
    }
  }
  BaseSetLastNTError();
  return false;
}



int GetNumberFormatEx(LPCWSTR lpLocaleName,DWORD dwFlags,LPCWSTR lpValue,NUMBERFMTW *lpFormat,
                     LPWSTR lpNumberStr,int cchNumber)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800215c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x215c0  669  GetNumberFormatEx
  iVar1 = GetNumberFormatEx(lpLocaleName,dwFlags,lpValue,lpFormat,lpNumberStr,cchNumber);
  return iVar1;
}



BOOLEAN Wow64EnableWow64FsRedirection(BOOLEAN Wow64FsEnableRedirection)

{
  int iVar1;
  undefined7 in_register_00000009;
  
                    // 0x215e0  1557  Wow64EnableWow64FsRedirection
  iVar1 = RtlWow64EnableFsRedirection(CONCAT71(in_register_00000009,Wow64FsEnableRedirection));
  if (-1 >= iVar1) {
    BaseSetLastNTError();
  }
  return -1 < iVar1;
}



HANDLE OpenFileMappingA(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCSTR lpName)

{
  LPCWSTR pWVar1;
  undefined8 uVar2;
  HANDLE pvVar3;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x21610  1034  OpenFileMappingA
  pWVar1 = (LPCWSTR)lpName;
  if ((lpName == (LPCSTR)0x0) ||
     (uVar2 = Basep8BitStringToDynamicUnicodeString(), pWVar1 = local_10, (int)uVar2 != 0)) {
    local_10 = pWVar1;
    pvVar3 = OpenFileMappingW(dwDesiredAccess,bInheritHandle,local_10);
    if (lpName != (LPCSTR)0x0) {
      RtlFreeUnicodeString(local_18);
    }
  }
  else {
    pvVar3 = (HANDLE)0x0;
  }
  return pvVar3;
}



// WARNING: Could not reconcile some variable overlaps

HRESULT RegisterApplicationRecoveryCallback
                  (APPLICATION_RECOVERY_CALLBACK pRecoveyCallback,PVOID pvParameter,
                  DWORD dwPingInterval,DWORD dwFlags)

{
  bool bVar1;
  int iVar2;
  uint uVar3;
  undefined7 extraout_var;
  longlong lVar4;
  undefined8 uVar5;
  HANDLE pvVar6;
  HRESULT HVar7;
  DWORD DVar8;
  char *pcVar9;
  undefined local_38 [16];
  undefined8 local_28;
  
                    // 0x21690  1193  RegisterApplicationRecoveryCallback
  if ((pRecoveyCallback == (APPLICATION_RECOVERY_CALLBACK)0x0) || (300000 < dwPingInterval)) {
    return -0x7ff8ffa9;
  }
  DVar8 = 5000;
  if (dwPingInterval != 0) {
    DVar8 = dwPingInterval;
  }
  HVar7 = -0x7fffbffb;
  local_38 = ZEXT816(0);
  local_28 = 0;
  bVar1 = FUN_18002189c();
  if ((int)CONCAT71(extraout_var,bVar1) == 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid state\n",0x96c);
    return -0x7ff8ec61;
  }
  lVar4 = FUN_18001ce80();
  if (lVar4 == 0) {
    uVar5 = 0x974;
    pcVar9 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
LAB_180034e48:
    DbgPrintEx(0x96,0,pcVar9,uVar5);
    return -0x7fffbffb;
  }
  iVar2 = FUN_18001ce14();
  if (iVar2 < 0) {
    uVar5 = 0x97a;
    pcVar9 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
    goto LAB_180034e48;
  }
  iVar2 = FUN_18001ccd4();
  if (iVar2 < 0) {
    uVar5 = 0x980;
    pcVar9 = "WER/CrashAPI:%u: ERROR WerpInitPEBStore failed\n";
    goto LAB_180034e48;
  }
  lVar4 = *(longlong *)(lVar4 + 0x358);
  if ((lVar4 == 0) || (uVar3 = FUN_18001cc84(lVar4), (int)uVar3 < 0)) {
    uVar5 = 0x98b;
    pcVar9 = "WER/CrashAPI:%u: ERROR Invalid PEB entry\n";
  }
  else {
    *(undefined4 *)(lVar4 + 0x8a8) = 0x40;
    uVar5 = RtlEncodeSystemPointer(pRecoveyCallback);
    *(undefined8 *)(lVar4 + 0x8b0) = uVar5;
    *(PVOID *)(lVar4 + 0x8b8) = pvParameter;
    *(DWORD *)(lVar4 + 0x8e0) = DVar8;
    *(DWORD *)(lVar4 + 0x8e4) = dwFlags;
    local_38 = CONCAT124(local_38._4_12_,0x18);
    local_38 = local_38 & (undefined  [16])0xffffffffffffffff;
    local_28 = CONCAT44(local_28._4_4_,1);
    if (*(longlong *)(lVar4 + 0x8c0) != 0) {
LAB_1800217ca:
      if (*(longlong *)(lVar4 + 0x8c8) == 0) {
        pvVar6 = CreateEventW((LPSECURITY_ATTRIBUTES)local_38,1,0,(LPCWSTR)0x0);
        *(HANDLE *)(lVar4 + 0x8c8) = pvVar6;
        if (pvVar6 == (HANDLE)0x0) {
          uVar5 = 0x9be;
          goto LAB_18002183a;
        }
      }
      if (*(longlong *)(lVar4 + 0x8d0) == 0) {
        pvVar6 = CreateEventW((LPSECURITY_ATTRIBUTES)local_38,1,0,(LPCWSTR)0x0);
        *(HANDLE *)(lVar4 + 0x8d0) = pvVar6;
        if (pvVar6 == (HANDLE)0x0) {
          uVar5 = 0x9cd;
          goto LAB_18002183a;
        }
      }
      HVar7 = 0;
      goto LAB_18002186c;
    }
    pvVar6 = CreateEventW((LPSECURITY_ATTRIBUTES)local_38,0,0,(LPCWSTR)0x0);
    *(HANDLE *)(lVar4 + 0x8c0) = pvVar6;
    if (pvVar6 != (HANDLE)0x0) goto LAB_1800217ca;
    uVar5 = 0x9af;
LAB_18002183a:
    pcVar9 = "WER/CrashAPI:%u: ERROR Unable to create the m_hAliveEvent event\n";
  }
  DbgPrintEx(0x96,0,pcVar9,uVar5);
LAB_18002186c:
  RtlReleasePebLock();
  return HVar7;
}



bool FUN_18002189c(void)

{
  int iVar1;
  uint uVar2;
  longlong lVar3;
  bool bVar4;
  
  lVar3 = FUN_18001ce80();
  bVar4 = false;
  if (lVar3 == 0) {
    bVar4 = true;
  }
  else {
    iVar1 = FUN_18001ce14();
    if (iVar1 < 0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpAcquirePebLock failed\n",0x22d);
      bVar4 = false;
    }
    else {
      lVar3 = *(longlong *)(lVar3 + 0x358);
      if (lVar3 == 0) {
        bVar4 = true;
      }
      else {
        uVar2 = FUN_18001cc84(lVar3);
        if ((int)uVar2 < 0) {
          DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpValidatePebHeader failed\n",0x23e);
        }
        else {
          bVar4 = *(int *)(lVar3 + 0x8d8) == 0;
        }
      }
      RtlReleasePebLock();
    }
  }
  return bVar4;
}



BOOL IsDBCSLeadByte(BYTE TestChar)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021940. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21940  900  IsDBCSLeadByte
  BVar1 = IsDBCSLeadByte(TestChar);
  return BVar1;
}



void GetStartupInfoA(LPSTARTUPINFOA lpStartupInfo)

{
  uint uVar1;
  longlong lVar2;
  code *pcVar3;
  int iVar4;
  undefined4 *puVar5;
  DWORD *pDVar6;
  HANDLE pvVar7;
  longlong in_GS_OFFSET;
  bool bVar8;
  undefined local_38 [8];
  undefined8 local_30;
  undefined local_28 [8];
  undefined8 local_20;
  undefined local_18 [8];
  undefined8 local_10;
  
                    // 0x21960  730  GetStartupInfoA
  lVar2 = *(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x20);
  pDVar6 = DAT_1800b2a38;
  if (DAT_1800b2a38 != (DWORD *)0x0) {
LAB_180021afa:
    lpStartupInfo->cb = *pDVar6;
    lpStartupInfo->lpReserved = *(LPSTR *)(pDVar6 + 2);
    lpStartupInfo->lpDesktop = *(LPSTR *)(pDVar6 + 4);
    lpStartupInfo->lpTitle = *(LPSTR *)(pDVar6 + 6);
    lpStartupInfo->dwX = pDVar6[8];
    lpStartupInfo->dwY = pDVar6[9];
    lpStartupInfo->dwXSize = pDVar6[10];
    lpStartupInfo->dwYSize = pDVar6[0xb];
    lpStartupInfo->dwXCountChars = pDVar6[0xc];
    lpStartupInfo->dwYCountChars = pDVar6[0xd];
    lpStartupInfo->dwFillAttribute = pDVar6[0xe];
    uVar1 = pDVar6[0xf];
    lpStartupInfo->dwFlags = uVar1;
    lpStartupInfo->wShowWindow = *(WORD *)(pDVar6 + 0x10);
    lpStartupInfo->cbReserved2 = *(WORD *)((longlong)pDVar6 + 0x42);
    lpStartupInfo->lpReserved2 = *(LPBYTE *)(pDVar6 + 0x12);
    if ((uVar1 & 0x700) == 0) {
      pvVar7 = (HANDLE)0xffffffffffffffff;
      lpStartupInfo->hStdInput = (HANDLE)0xffffffffffffffff;
      lpStartupInfo->hStdOutput = (HANDLE)0xffffffffffffffff;
    }
    else {
      lpStartupInfo->hStdInput = *(HANDLE *)(pDVar6 + 0x14);
      lpStartupInfo->hStdOutput = *(HANDLE *)(pDVar6 + 0x16);
      pvVar7 = *(HANDLE *)(pDVar6 + 0x18);
    }
    lpStartupInfo->hStdError = pvVar7;
    return;
  }
  puVar5 = (undefined4 *)KernelBaseGetGlobalData();
  pDVar6 = (DWORD *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                    *puVar5,0x68);
  if (pDVar6 == (DWORD *)0x0) {
    iVar4 = -0x3fffffe9;
  }
  else {
    *(undefined8 *)(pDVar6 + 2) = 0;
    *(undefined8 *)(pDVar6 + 4) = 0;
    *(undefined8 *)(pDVar6 + 6) = 0;
    *pDVar6 = 0x68;
    pDVar6[8] = *(DWORD *)(lVar2 + 0x88);
    pDVar6[9] = *(DWORD *)(lVar2 + 0x8c);
    pDVar6[10] = *(DWORD *)(lVar2 + 0x90);
    pDVar6[0xb] = *(DWORD *)(lVar2 + 0x94);
    pDVar6[0xc] = *(DWORD *)(lVar2 + 0x98);
    pDVar6[0xd] = *(DWORD *)(lVar2 + 0x9c);
    pDVar6[0xe] = *(DWORD *)(lVar2 + 0xa0);
    pDVar6[0xf] = *(DWORD *)(lVar2 + 0xa4);
    *(undefined2 *)(pDVar6 + 0x10) = *(undefined2 *)(lVar2 + 0xa8);
    *(undefined2 *)((longlong)pDVar6 + 0x42) = *(undefined2 *)(lVar2 + 0xe0);
    *(undefined8 *)(pDVar6 + 0x12) = *(undefined8 *)(lVar2 + 0xe8);
    *(undefined8 *)(pDVar6 + 0x14) = *(undefined8 *)(lVar2 + 0x20);
    *(undefined8 *)(pDVar6 + 0x16) = *(undefined8 *)(lVar2 + 0x28);
    *(undefined8 *)(pDVar6 + 0x18) = *(undefined8 *)(lVar2 + 0x30);
    iVar4 = RtlUnicodeStringToAnsiString(local_28,lVar2 + 0xd0,1);
    if (-1 < iVar4) {
      *(undefined8 *)(pDVar6 + 2) = local_20;
      iVar4 = RtlUnicodeStringToAnsiString(local_38,lVar2 + 0xc0,1);
      if (-1 < iVar4) {
        *(undefined8 *)(pDVar6 + 4) = local_30;
        iVar4 = RtlUnicodeStringToAnsiString(local_18,lVar2 + 0xb0,1);
        if (-1 < iVar4) {
          *(undefined8 *)(pDVar6 + 6) = local_10;
          LOCK();
          bVar8 = DAT_1800b2a38 == (DWORD *)0x0;
          DAT_1800b2a38 =
               (DWORD *)((ulonglong)DAT_1800b2a38 ^
                        (ulonglong)bVar8 * ((ulonglong)DAT_1800b2a38 ^ (ulonglong)pDVar6));
          if (!bVar8) {
            RtlFreeAnsiString(local_18);
            RtlFreeAnsiString(local_38);
            RtlFreeAnsiString(local_28);
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pDVar6);
            pDVar6 = DAT_1800b2a38;
          }
          goto LAB_180021afa;
        }
        RtlFreeAnsiString(local_38);
      }
      RtlFreeAnsiString(local_28);
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pDVar6);
  }
  RtlRaiseStatus(iVar4);
  pcVar3 = (code *)swi(3);
  (*pcVar3)();
  return;
}



HRESULT WerUnregisterMemoryBlock(PVOID pvAddress)

{
  HRESULT HVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021ba0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21ba0  1545  WerUnregisterMemoryBlock
  HVar1 = WerUnregisterMemoryBlock(pvAddress);
  return HVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Could not reconcile some variable overlaps

HANDLE CreateActCtxA(PCACTCTXA pActCtx)

{
  USHORT *pUVar1;
  undefined *puVar2;
  PCACTCTXA pAVar3;
  int iVar4;
  uint uVar5;
  code *pcVar6;
  short *psVar7;
  HANDLE extraout_RAX;
  HANDLE pvVar8;
  char *pcVar9;
  short *psVar10;
  undefined auStack744 [32];
  PCACTCTXA local_2c8;
  uint local_2c0;
  undefined local_2b8 [8];
  LPCWSTR pWStack688;
  undefined local_2a8 [16];
  undefined local_298 [4];
  undefined local_294 [12];
  undefined4 uStack648;
  undefined4 local_284;
  LPCWSTR pWStack640;
  undefined4 uStack632;
  undefined4 uStack628;
  LPCWSTR pWStack624;
  undefined4 uStack616;
  undefined4 local_264;
  undefined local_260 [24];
  undefined local_248 [528];
  ulonglong local_38;
  
                    // 0x21bc0  179  CreateActCtxA
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack744;
  local_298 = 0x38;
  pvVar8 = (HANDLE)0xffffffffffffffff;
  local_264 = 0;
  psVar7 = (short *)0x0;
  _local_294 = ZEXT816(0);
  local_284 = 0;
  pWStack640 = SUB168(ZEXT816(0) >> 0x20,0);
  uStack632 = 0;
  uStack628 = 0;
  pWStack624 = SUB168(ZEXT816(0) >> 0x20,0);
  uStack616 = 0;
  local_2a8 = ZEXT816(0);
  _local_2b8 = ZEXT816(0);
  psVar10 = (short *)0x0;
  if (pActCtx == (PCACTCTXA)0x0) {
LAB_1800350be:
    local_2c0 = pActCtx->cbSize;
    pcVar9 = "SXS: %s() Null %p or size 0x%lx too small\n";
    local_2c8 = pActCtx;
  }
  else {
    uVar5 = pActCtx->cbSize;
    pUVar1 = &pActCtx->wProcessorArchitecture;
    puVar2 = (undefined *)((longlong)&pActCtx->cbSize + (ulonglong)uVar5);
    if (puVar2 < pUVar1) goto LAB_1800350be;
    local_294._0_4_ = pActCtx->dwFlags;
    if (((((local_294._0_4_ & 0xffffff00) == 0) &&
         (((local_294._0_4_ & 1) == 0 || (&pActCtx->wLangId <= puVar2)))) &&
        (((local_294._0_4_ & 2) == 0 || (&pActCtx->field_0x14 <= puVar2)))) &&
       (((((local_294._0_4_ & 4) == 0 || (&pActCtx->lpResourceName <= puVar2)) &&
         (((local_294._0_4_ & 8) == 0 || (&pActCtx->lpApplicationName <= puVar2)))) &&
        (((local_294._0_4_ & 0x20) == 0 || (&pActCtx->hModule <= puVar2)))))) {
      pAVar3 = (PCACTCTXA)((longlong)&pActCtx->cbSize + (ulonglong)uVar5);
      if ((((local_294._0_4_ & 0x80) == 0) || (pActCtx + 1 <= pAVar3)) &&
         (((local_294._0_4_ & 0x40) == 0 || (pUVar1 <= pAVar3)))) {
        if (pActCtx->lpSource == (LPCSTR)0x0) {
          if ((local_294._0_4_ & 0x80) == 0) goto LAB_180021d63;
          _local_294 = ZEXT416(local_294._0_4_);
        }
        else {
          RtlInitAnsiString(local_260);
          pcVar6 = (code *)GetEightBitStringToUnicodeStringRoutine();
          iVar4 = (*pcVar6)();
          psVar10 = psVar7;
          if (iVar4 < 0) goto LAB_180021d63;
          local_294 = CONCAT84(local_2a8._8_8_,local_294._0_4_);
        }
        if ((local_294._0_4_ & 1) != 0) {
          _local_294 = CONCAT212(*pUVar1,local_294);
        }
        if ((local_294._0_4_ & 2) != 0) {
          _local_294 = CONCAT214(pActCtx->wLangId,_local_294);
        }
        if ((char)local_294._0_4_ < '\0') {
          uStack616 = SUB84(pActCtx->hModule,0);
          local_264 = (undefined4)((ulonglong)pActCtx->hModule >> 0x20);
        }
        if ((local_294._0_4_ & 4) != 0) {
          RtlInitAnsiString(local_260,pActCtx->lpAssemblyDirectory);
          _local_2b8 = CONCAT88(local_248,local_2b8);
          pcVar6 = (code *)GetEightBitStringToUnicodeStringRoutine();
          uVar5 = (*pcVar6)();
          if (uVar5 == 0x80000005) {
            uVar5 = 0xc0000106;
          }
          psVar10 = psVar7;
          if ((uVar5 & 0xc0000000) == 0xc0000000) goto LAB_180021d63;
          pWStack640 = pWStack688;
        }
        if ((local_294._0_4_ & 8) != 0) {
          psVar7 = FUN_180013640((short *)pActCtx->lpResourceName);
          if (psVar7 == (short *)0xffffffffffffffff) {
            DbgPrintEx(0x33,0,"SXS: %s() BaseDllMapResourceIdA failed\n","CreateActCtxA");
            psVar10 = psVar7;
            goto LAB_180021d63;
          }
          uStack632 = SUB84(psVar7,0);
          uStack628 = (undefined4)((ulonglong)psVar7 >> 0x20);
        }
        pvVar8 = CreateActCtxW((PCACTCTXW)local_298);
        psVar10 = psVar7;
        goto LAB_180021d63;
      }
    }
    pcVar9 = "SXS: %s() Bad flags/size 0x%lx/0x%lx\n";
    local_2c8 = (PCACTCTXA)((ulonglong)local_2c8 & 0xffffffff00000000 | (ulonglong)local_294._0_4_);
    local_2c0 = uVar5;
  }
  DbgPrintEx(0x33,0,pcVar9,"CreateActCtxA");
LAB_180021d63:
  if (local_2a8._8_8_ != 0) {
    RtlFreeUnicodeString(local_2a8);
  }
  if ((pWStack688 != (LPCWSTR)0x0) && (pWStack688 != (LPCWSTR)local_248)) {
    RtlFreeUnicodeString(local_2b8);
  }
  BaseDllFreeResourceId(psVar10);
  if (pvVar8 == (HANDLE)0xffffffffffffffff) {
    BaseSetLastNTError();
  }
  __security_check_cookie(local_38 ^ (ulonglong)auStack744);
  return extraout_RAX;
}



LSTATUS RegGetValueW(HKEY hkey,LPCWSTR lpSubKey,LPCWSTR lpValue,DWORD dwFlags,LPDWORD pdwType,
                    PVOID pvData,LPDWORD pcbData)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021df0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21df0  1170  RegGetValueW
  LVar1 = RegGetValueW(hkey,lpSubKey,lpValue,dwFlags,pdwType,pvData,pcbData);
  return LVar1;
}



BOOL FreeResource(HGLOBAL hResData)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021e10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21e10  441  FreeResource
  BVar1 = FreeResource(hResData);
  return BVar1;
}



void RtlCaptureStackBackTrace(void)

{
                    // WARNING: Could not recover jumptable at 0x000180021e30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21e30  1239  RtlCaptureStackBackTrace
  RtlCaptureStackBackTrace();
  return;
}



LPWSTR lstrcpyW(LPWSTR lpString1,LPCWSTR lpString2)

{
  WCHAR WVar1;
  longlong lVar2;
  
                    // 0x21e50  1614  lstrcpyW
  lVar2 = (longlong)lpString1 - (longlong)lpString2;
  do {
    WVar1 = *lpString2;
    *(WCHAR *)(lVar2 + (longlong)lpString2) = WVar1;
    lpString2 = lpString2 + 1;
  } while (WVar1 != L'\0');
  return lpString1;
}



DWORD GetDllDirectoryW(DWORD nBufferLength,LPWSTR lpBuffer)

{
  int iVar1;
  uint uVar2;
  ushort local_18;
  
                    // 0x21e80  568  GetDllDirectoryW
  RtlSetLastWin32Error(0);
  iVar1 = LdrGetDllDirectory();
  if (((iVar1 + 0x80000000U & 0x80000000) == 0) && (iVar1 != -0x3fffffdd)) {
    BaseSetLastNTError();
    uVar2 = 0;
  }
  else {
    uVar2 = (uint)(local_18 >> 1);
  }
  return uVar2;
}



BOOL QueryIdleProcessorCycleTime(PULONG BufferLength,PULONG64 ProcessorIdleCycleTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021f00. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21f00  1102  QueryIdleProcessorCycleTime
  BVar1 = QueryIdleProcessorCycleTime(BufferLength,ProcessorIdleCycleTime);
  return BVar1;
}



BOOL QueryProcessCycleTime(HANDLE ProcessHandle,PULONG64 CycleTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021f20. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21f20  1110  QueryProcessCycleTime
  BVar1 = QueryProcessCycleTime(ProcessHandle,CycleTime);
  return BVar1;
}



BOOL SetNamedPipeHandleState
               (HANDLE hNamedPipe,LPDWORD lpMode,LPDWORD lpMaxCollectionCount,
               LPDWORD lpCollectDataTimeout)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021f40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21f40  1355  SetNamedPipeHandleState
  BVar1 = SetNamedPipeHandleState(hNamedPipe,lpMode,lpMaxCollectionCount,lpCollectDataTimeout);
  return BVar1;
}



BOOL DisconnectNamedPipe(HANDLE hNamedPipe)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021f60. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21f60  298  DisconnectNamedPipe
  BVar1 = DisconnectNamedPipe(hNamedPipe);
  return BVar1;
}



BOOL GetCurrentActCtx(HANDLE *lphActCtx)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180021f80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x21f80  533  GetCurrentActCtx
  BVar1 = GetCurrentActCtx(lphActCtx);
  return BVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

bool Thread32First(undefined8 param_1,uint *param_2)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint *puVar4;
  int iVar5;
  bool bVar6;
  
                    // 0x21fa0  1455  Thread32First
  if (((param_2 == (uint *)0x0) || (*param_2 != 0x1c)) ||
     (iVar5 = NtMapViewOfSection(), puVar4 = puRam0000000000000028, iVar5 < 0)) {
    BaseSetLastNTError();
    bVar6 = false;
  }
  else {
    bVar6 = _DAT_0000000c == 0;
    if (bVar6) {
      memset(param_2 + 1,0,(ulonglong)*param_2 - 4);
      RtlSetLastWin32Error(0x12);
    }
    else {
      uVar1 = puRam0000000000000028[1];
      uVar2 = puRam0000000000000028[2];
      uVar3 = puRam0000000000000028[3];
      *param_2 = *puRam0000000000000028;
      param_2[1] = uVar1;
      param_2[2] = uVar2;
      param_2[3] = uVar3;
      *(undefined8 *)(param_2 + 4) = *(undefined8 *)(puVar4 + 4);
      param_2[6] = puVar4[6];
      uRam000000000000003c = 1;
    }
    bVar6 = !bVar6;
    NtUnmapViewOfSection(0xffffffffffffffff,0);
  }
  return bVar6;
}



DWORD FormatMessageA(DWORD dwFlags,LPCVOID lpSource,DWORD dwMessageId,DWORD dwLanguageId,
                    LPSTR lpBuffer,DWORD nSize,va_list *Arguments)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180022080. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22080  432  FormatMessageA
  DVar1 = FormatMessageA(dwFlags,lpSource,dwMessageId,dwLanguageId,lpBuffer,nSize,Arguments);
  return DVar1;
}



DWORD GetProcessVersion(DWORD ProcessId)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800220a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x220a0  714  GetProcessVersion
  DVar1 = GetProcessVersion(ProcessId);
  return DVar1;
}



MMRESULT timeGetDevCaps(LPTIMECAPS ptc,UINT cbtc)

{
  BOOL BVar1;
  MMRESULT MVar2;
  
                    // 0x220c0  1623  timeGetDevCaps
  BVar1 = InitOnceExecuteOnce((PINIT_ONCE)&DAT_1800b2db0,FUN_18001b930,(PVOID)0x0,(LPVOID *)0x0);
  if (((BVar1 == 0) || (cbtc < 8)) || (ptc == (LPTIMECAPS)0x0)) {
    MVar2 = 0x61;
  }
  else {
    ptc->wPeriodMin = DAT_1800b2a80;
    MVar2 = 0;
    ptc->wPeriodMax = 1000000;
  }
  return MVar2;
}



void TermsrvGetWindowsDirectoryA(void)

{
                    // 0x22130  1447  TermsrvGetWindowsDirectoryA
  if (DAT_1800b2e50 != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180026440. Too many branches
                    // WARNING: Treating indirect jump as call
    (*DAT_1800b2e50)();
    return;
  }
  return;
}



BOOL SetProcessDEPPolicy(DWORD dwFlags)

{
  BOOL BVar1;
  ulonglong local_res10 [3];
  
                    // 0x22150  1359  SetProcessDEPPolicy
  local_res10[0] = (ulonglong)CONCAT14((char)dwFlags,dwFlags) & 0xffffff01ffffffff;
  BVar1 = SetProcessMitigationPolicy(0,local_res10,8);
  return BVar1;
}



BOOL GetNLSVersion(NLS_FUNCTION Function,LCID Locale,LPNLSVERSIONINFO lpVersionInformation)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180022190. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22190  643  GetNLSVersion
  BVar1 = GetNLSVersion(Function,Locale,lpVersionInformation);
  return BVar1;
}



BOOL SystemTimeToTzSpecificLocalTime
               (TIME_ZONE_INFORMATION *lpTimeZoneInformation,SYSTEMTIME *lpUniversalTime,
               LPSYSTEMTIME lpLocalTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800221b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x221b0  1436  SystemTimeToTzSpecificLocalTime
  BVar1 = SystemTimeToTzSpecificLocalTime(lpTimeZoneInformation,lpUniversalTime,lpLocalTime);
  return BVar1;
}



DWORD SearchPathW(LPCWSTR lpPath,LPCWSTR lpFileName,LPCWSTR lpExtension,DWORD nBufferLength,
                 LPWSTR lpBuffer,LPWSTR *lpFilePart)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800221d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x221d0  1257  SearchPathW
  DVar1 = SearchPathW(lpPath,lpFileName,lpExtension,nBufferLength,lpBuffer,lpFilePart);
  return DVar1;
}



UINT GetErrorMode(void)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800221f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x221f0  582  GetErrorMode
  UVar1 = GetErrorMode();
  return UVar1;
}



BOOLEAN ClosePrivateNamespace(HANDLE Handle,ULONG Flags)

{
  BOOLEAN BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180022210. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22210  140  ClosePrivateNamespace
  BVar1 = ClosePrivateNamespace(Handle,Flags);
  return BVar1;
}



UINT GetWindowsDirectoryA(LPSTR lpBuffer,UINT uSize)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180022230. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22230  818  GetWindowsDirectoryA
  UVar1 = GetWindowsDirectoryA(lpBuffer,uSize);
  return UVar1;
}



DWORD ExpandEnvironmentStringsA(LPCSTR lpSrc,LPSTR lpDst,DWORD nSize)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180022250. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22250  363  ExpandEnvironmentStringsA
  DVar1 = ExpandEnvironmentStringsA(lpSrc,lpDst,nSize);
  return DVar1;
}



void AddRefActCtx(HANDLE hActCtx)

{
                    // WARNING: Could not recover jumptable at 0x000180022270. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22270  13  AddRefActCtx
  AddRefActCtx(hActCtx);
  return;
}



HANDLE OpenPrivateNamespaceW(LPVOID lpBoundaryDescriptor,LPCWSTR lpAliasPrefix)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180022290. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22290  1042  OpenPrivateNamespaceW
  pvVar1 = OpenPrivateNamespaceW(lpBoundaryDescriptor,lpAliasPrefix);
  return pvVar1;
}



LSTATUS RegOpenUserClassesRoot(HANDLE hToken,DWORD dwOptions,REGSAM samDesired,PHKEY phkResult)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800222b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x222b0  1179  RegOpenUserClassesRoot
  LVar1 = RegOpenUserClassesRoot(hToken,dwOptions,samDesired,phkResult);
  return LVar1;
}



LSTATUS RegOpenCurrentUser(REGSAM samDesired,PHKEY phkResult)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800222d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x222d0  1176  RegOpenCurrentUser
  LVar1 = RegOpenCurrentUser(samDesired,phkResult);
  return LVar1;
}



void GetDateFormatAWorker
               (UINT *param_1,LCID param_2,DWORD param_3,SYSTEMTIME *param_4,LPCSTR param_5,
               LPSTR param_6,int param_7)

{
  DWORD DVar1;
  undefined8 uVar2;
  WCHAR *lpDateStr;
  WCHAR *lpFormat;
  longlong in_GS_OFFSET;
  undefined auStackY696 [32];
  int iVar3;
  WCHAR *local_278;
  int local_270 [2];
  LPSTR local_268;
  WCHAR local_258 [128];
  WCHAR local_158 [128];
  ulonglong local_58;
  
                    // 0x222f0  554  GetDateFormatAWorker
  local_58 = DAT_1800b2220 ^ (ulonglong)auStackY696;
  local_268 = param_6;
  local_278 = local_158;
  uVar2 = FUN_18001b10c(*param_1,param_5,0xffffffff,&local_278,local_270);
  if ((int)uVar2 != 0) {
    lpDateStr = local_258;
    iVar3 = 0x80;
    lpFormat = local_278;
    do {
      iVar3 = GetDateFormatW(param_2,param_3,param_4,lpFormat,lpDateStr,iVar3);
      if (((iVar3 != 0) || (DVar1 = GetLastError(), DVar1 != 0x7a)) || (lpDateStr != local_258)) {
        if ((lpFormat != local_158) && (lpFormat != (LPCWSTR)0x0)) {
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_278);
        }
        if (0 < iVar3) {
          WideCharToMultiByte(*param_1,0,lpDateStr,iVar3,local_268,param_7,(LPCSTR)0x0,(LPBOOL)0x0);
        }
        if ((lpDateStr != local_258) && (lpDateStr != (LPWSTR)0x0)) {
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpDateStr);
        }
        goto LAB_1800223fc;
      }
      SetLastError(0);
      iVar3 = GetDateFormatW(param_2,param_3,param_4,lpFormat,(LPWSTR)0x0,0);
    } while ((iVar3 == 0) ||
            (lpDateStr = (WCHAR *)RtlAllocateHeap(*(undefined8 *)
                                                   (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,
                                                  (longlong)iVar3 * 2), lpFormat = local_278,
            lpDateStr != (LPWSTR)0x0));
    if ((local_278 != local_158) && (local_278 != (WCHAR *)0x0)) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_278);
    }
    SetLastError(0xe);
  }
LAB_1800223fc:
  __security_check_cookie(local_58 ^ (ulonglong)auStackY696);
  return;
}



undefined4 Process32NextW(undefined8 param_1,int *param_2)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  int *piVar6;
  int *piVar7;
  longlong lVar8;
  undefined4 uVar9;
  longlong local_res10;
  undefined8 local_res18;
  undefined8 local_res20;
  
                    // 0x22430  1076  Process32NextW
  uVar9 = 0;
  if ((param_2 != (int *)0x0) && (*param_2 == 0x238)) {
    local_res18 = 0;
    lVar8 = 4;
    local_res20 = 0;
    local_res10 = 0;
    iVar5 = NtMapViewOfSection(param_1,0xffffffffffffffff,&local_res10,0,0,&local_res18,&local_res20
                               ,1,0,4);
    if (-1 < iVar5) {
      uVar1 = *(uint *)(local_res10 + 0x34);
      if (uVar1 < *(uint *)(local_res10 + 4)) {
        *(uint *)(local_res10 + 0x34) = uVar1 + 1;
        piVar4 = (int *)((ulonglong)uVar1 * 0x238 + *(longlong *)(local_res10 + 0x18) + local_res10)
        ;
        do {
          piVar7 = param_2;
          piVar6 = piVar4;
          iVar5 = piVar6[1];
          iVar2 = piVar6[2];
          iVar3 = piVar6[3];
          *piVar7 = *piVar6;
          piVar7[1] = iVar5;
          piVar7[2] = iVar2;
          piVar7[3] = iVar3;
          iVar5 = piVar6[5];
          iVar2 = piVar6[6];
          iVar3 = piVar6[7];
          piVar7[4] = piVar6[4];
          piVar7[5] = iVar5;
          piVar7[6] = iVar2;
          piVar7[7] = iVar3;
          iVar5 = piVar6[9];
          iVar2 = piVar6[10];
          iVar3 = piVar6[0xb];
          piVar7[8] = piVar6[8];
          piVar7[9] = iVar5;
          piVar7[10] = iVar2;
          piVar7[0xb] = iVar3;
          iVar5 = piVar6[0xd];
          iVar2 = piVar6[0xe];
          iVar3 = piVar6[0xf];
          piVar7[0xc] = piVar6[0xc];
          piVar7[0xd] = iVar5;
          piVar7[0xe] = iVar2;
          piVar7[0xf] = iVar3;
          iVar5 = piVar6[0x11];
          iVar2 = piVar6[0x12];
          iVar3 = piVar6[0x13];
          piVar7[0x10] = piVar6[0x10];
          piVar7[0x11] = iVar5;
          piVar7[0x12] = iVar2;
          piVar7[0x13] = iVar3;
          iVar5 = piVar6[0x15];
          iVar2 = piVar6[0x16];
          iVar3 = piVar6[0x17];
          piVar7[0x14] = piVar6[0x14];
          piVar7[0x15] = iVar5;
          piVar7[0x16] = iVar2;
          piVar7[0x17] = iVar3;
          iVar5 = piVar6[0x19];
          iVar2 = piVar6[0x1a];
          iVar3 = piVar6[0x1b];
          piVar7[0x18] = piVar6[0x18];
          piVar7[0x19] = iVar5;
          piVar7[0x1a] = iVar2;
          piVar7[0x1b] = iVar3;
          iVar5 = piVar6[0x1d];
          iVar2 = piVar6[0x1e];
          iVar3 = piVar6[0x1f];
          piVar7[0x1c] = piVar6[0x1c];
          piVar7[0x1d] = iVar5;
          piVar7[0x1e] = iVar2;
          piVar7[0x1f] = iVar3;
          lVar8 = lVar8 + -1;
          piVar4 = piVar6 + 0x20;
          param_2 = piVar7 + 0x20;
        } while (lVar8 != 0);
        iVar5 = piVar6[0x21];
        iVar2 = piVar6[0x22];
        iVar3 = piVar6[0x23];
        uVar9 = 1;
        piVar7[0x20] = piVar6[0x20];
        piVar7[0x21] = iVar5;
        piVar7[0x22] = iVar2;
        piVar7[0x23] = iVar3;
        iVar5 = piVar6[0x25];
        iVar2 = piVar6[0x26];
        iVar3 = piVar6[0x27];
        piVar7[0x24] = piVar6[0x24];
        piVar7[0x25] = iVar5;
        piVar7[0x26] = iVar2;
        piVar7[0x27] = iVar3;
        iVar5 = piVar6[0x29];
        iVar2 = piVar6[0x2a];
        iVar3 = piVar6[0x2b];
        piVar7[0x28] = piVar6[0x28];
        piVar7[0x29] = iVar5;
        piVar7[0x2a] = iVar2;
        piVar7[0x2b] = iVar3;
        *(undefined8 *)(piVar7 + 0x2c) = *(undefined8 *)(piVar6 + 0x2c);
      }
      else {
        RtlSetLastWin32Error(0x12);
      }
      NtUnmapViewOfSection(0xffffffffffffffff,local_res10);
      return uVar9;
    }
  }
  BaseSetLastNTError();
  return 0;
}



BOOL VerifyVersionInfoA(LPOSVERSIONINFOEXA lpVersionInformation,DWORD dwTypeMask,
                       DWORDLONG dwlConditionMask)

{
  BOOL extraout_EAX;
  undefined auStack344 [32];
  _OSVERSIONINFOEXW local_138;
  ulonglong local_18;
  
                    // 0x22580  1496  VerifyVersionInfoA
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack344;
  local_138.dwMajorVersion = lpVersionInformation->dwMajorVersion;
  local_138.dwMinorVersion = lpVersionInformation->dwMinorVersion;
  local_138.dwBuildNumber = lpVersionInformation->dwBuildNumber;
  local_138.dwPlatformId = lpVersionInformation->dwPlatformId;
  local_138.wServicePackMajor = lpVersionInformation->wServicePackMajor;
  local_138.dwOSVersionInfoSize = 0x11c;
  local_138.wServicePackMinor = lpVersionInformation->wServicePackMinor;
  local_138.wSuiteMask = lpVersionInformation->wSuiteMask;
  local_138.wProductType = lpVersionInformation->wProductType;
  local_138.wReserved = lpVersionInformation->wReserved;
  VerifyVersionInfoW(&local_138,dwTypeMask,dwlConditionMask);
  __security_check_cookie(local_18 ^ (ulonglong)auStack344);
  return extraout_EAX;
}



void PrivCopyFileExW(void)

{
                    // WARNING: Could not recover jumptable at 0x000180022630. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22630  1071  PrivCopyFileExW
  PrivCopyFileExW();
  return;
}



bool TermsrvAppInstallMode(void)

{
                    // 0x22650  1441  TermsrvAppInstallMode
  return *(char *)(DAT_1800b2bf8 + 0x808) != '\0';
}



BOOL GetStringTypeExW(LCID Locale,DWORD dwInfoType,LPCWSTR lpSrcStr,int cchSrc,LPWORD lpCharType)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180022670. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x22670  737  GetStringTypeExW
  BVar1 = GetStringTypeExW(Locale,dwInfoType,lpSrcStr,cchSrc,lpCharType);
  return BVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 Process32FirstW(undefined8 param_1,uint *param_2)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint *puVar4;
  int iVar5;
  uint *puVar6;
  uint *puVar7;
  longlong lVar8;
  undefined4 uVar9;
  
                    // 0x22690  1074  Process32FirstW
  uVar9 = 0;
  if ((param_2 != (uint *)0x0) && (*param_2 == 0x238)) {
    lVar8 = 4;
    iVar5 = NtMapViewOfSection();
    if (-1 < iVar5) {
      puVar4 = _DAT_00000018;
      if (iRam0000000000000004 == 0) {
        memset(param_2 + 1,0,(ulonglong)*param_2 - 4);
        RtlSetLastWin32Error(0x12);
      }
      else {
        do {
          puVar7 = param_2;
          puVar6 = puVar4;
          uVar1 = puVar6[1];
          uVar2 = puVar6[2];
          uVar3 = puVar6[3];
          *puVar7 = *puVar6;
          puVar7[1] = uVar1;
          puVar7[2] = uVar2;
          puVar7[3] = uVar3;
          uVar1 = puVar6[5];
          uVar2 = puVar6[6];
          uVar3 = puVar6[7];
          puVar7[4] = puVar6[4];
          puVar7[5] = uVar1;
          puVar7[6] = uVar2;
          puVar7[7] = uVar3;
          uVar1 = puVar6[9];
          uVar2 = puVar6[10];
          uVar3 = puVar6[0xb];
          puVar7[8] = puVar6[8];
          puVar7[9] = uVar1;
          puVar7[10] = uVar2;
          puVar7[0xb] = uVar3;
          uVar1 = puVar6[0xd];
          uVar2 = puVar6[0xe];
          uVar3 = puVar6[0xf];
          puVar7[0xc] = puVar6[0xc];
          puVar7[0xd] = uVar1;
          puVar7[0xe] = uVar2;
          puVar7[0xf] = uVar3;
          uVar1 = puVar6[0x11];
          uVar2 = puVar6[0x12];
          uVar3 = puVar6[0x13];
          puVar7[0x10] = puVar6[0x10];
          puVar7[0x11] = uVar1;
          puVar7[0x12] = uVar2;
          puVar7[0x13] = uVar3;
          uVar1 = puVar6[0x15];
          uVar2 = puVar6[0x16];
          uVar3 = puVar6[0x17];
          puVar7[0x14] = puVar6[0x14];
          puVar7[0x15] = uVar1;
          puVar7[0x16] = uVar2;
          puVar7[0x17] = uVar3;
          uVar1 = puVar6[0x19];
          uVar2 = puVar6[0x1a];
          uVar3 = puVar6[0x1b];
          puVar7[0x18] = puVar6[0x18];
          puVar7[0x19] = uVar1;
          puVar7[0x1a] = uVar2;
          puVar7[0x1b] = uVar3;
          uVar1 = puVar6[0x1d];
          uVar2 = puVar6[0x1e];
          uVar3 = puVar6[0x1f];
          puVar7[0x1c] = puVar6[0x1c];
          puVar7[0x1d] = uVar1;
          puVar7[0x1e] = uVar2;
          puVar7[0x1f] = uVar3;
          lVar8 = lVar8 + -1;
          puVar4 = puVar6 + 0x20;
          param_2 = puVar7 + 0x20;
        } while (lVar8 != 0);
        uVar1 = puVar6[0x21];
        uVar2 = puVar6[0x22];
        uVar3 = puVar6[0x23];
        uVar9 = 1;
        puVar7[0x20] = puVar6[0x20];
        puVar7[0x21] = uVar1;
        puVar7[0x22] = uVar2;
        puVar7[0x23] = uVar3;
        uVar1 = puVar6[0x25];
        uVar2 = puVar6[0x26];
        uVar3 = puVar6[0x27];
        puVar7[0x24] = puVar6[0x24];
        puVar7[0x25] = uVar1;
        puVar7[0x26] = uVar2;
        puVar7[0x27] = uVar3;
        uVar1 = puVar6[0x29];
        uVar2 = puVar6[0x2a];
        uVar3 = puVar6[0x2b];
        puVar7[0x28] = puVar6[0x28];
        puVar7[0x29] = uVar1;
        puVar7[0x2a] = uVar2;
        puVar7[0x2b] = uVar3;
        *(undefined8 *)(puVar7 + 0x2c) = *(undefined8 *)(puVar6 + 0x2c);
        uRam0000000000000034 = 1;
      }
      NtUnmapViewOfSection(0xffffffffffffffff,0);
      return uVar9;
    }
  }
  BaseSetLastNTError();
  return 0;
}



WORD GetMaximumProcessorGroupCount(void)

{
  WORD WVar1;
  undefined8 uVar2;
  longlong in_GS_OFFSET;
  DWORD local_res8 [2];
  PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX local_res10 [3];
  
                    // 0x227c0  635  GetMaximumProcessorGroupCount
  uVar2 = FUN_18001d558(local_res10,local_res8);
  if ((int)uVar2 == 0) {
    WVar1 = 0;
  }
  else {
    WVar1 = *(WORD *)&local_res10[0]->u;
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_res10[0]);
  }
  return WVar1;
}



void GetFirmwareType(undefined4 *param_1)

{
  int iVar1;
  undefined auStack88 [32];
  undefined local_38 [16];
  undefined4 local_28;
  ulonglong local_18;
  
                    // 0x22820  608  GetFirmwareType
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack88;
  if (param_1 == (undefined4 *)0x0) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    iVar1 = NtQuerySystemInformation(0x5a,local_38,0x20);
    if (iVar1 < 0) {
      BaseSetLastNTError();
    }
    else {
      *param_1 = local_28;
    }
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack88);
  return;
}



BOOL MoveFileW(LPCWSTR lpExistingFileName,LPCWSTR lpNewFileName)

{
  BOOL BVar1;
  
                    // 0x22890  1011  MoveFileW
  BVar1 = MoveFileWithProgressW
                    (lpExistingFileName,lpNewFileName,(LPPROGRESS_ROUTINE)0x0,(LPVOID)0x0,2);
  return BVar1;
}



UINT GetWindowsDirectoryW(LPWSTR lpBuffer,UINT uSize)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800228c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x228c0  819  GetWindowsDirectoryW
  UVar1 = GetWindowsDirectoryW(lpBuffer,uSize);
  return UVar1;
}



ulonglong FUN_1800228d4(int *param_1)

{
  undefined uVar1;
  undefined2 uVar2;
  bool bVar3;
  undefined4 *puVar4;
  char cVar5;
  short sVar6;
  undefined4 uVar7;
  ulonglong uVar8;
  undefined4 *puVar9;
  short *psVar10;
  undefined4 *puVar11;
  undefined2 *puVar12;
  uint uVar13;
  uint uVar14;
  undefined *puVar15;
  char *pcVar16;
  void *pvVar17;
  uint uVar18;
  longlong in_GS_OFFSET;
  uint local_res10 [2];
  ushort *local_res18;
  short *local_res20;
  ushort *local_48;
  char *local_40;
  
  puVar9 = (undefined4 *)0x0;
  uVar14 = 0;
  local_48 = (ushort *)0x0;
  uVar18 = 0;
  local_res18 = (ushort *)0x0;
  local_40 = (char *)0x0;
  local_res20 = (short *)0x0;
  uVar8 = FUN_18000f960((longlong)param_1);
  if ((int)uVar8 < 0) {
    if (*param_1 == 8) {
      return 0;
    }
    pvVar17 = *(void **)(param_1 + 0x30);
    if (*(char *)(*(longlong *)(param_1 + 4) + 0x31) == '\0') {
      uVar7 = FUN_180011d50((longlong)param_1,(short **)&local_48,(short **)0x0);
      if ((char)uVar7 == '\0') {
        return 0xc000000d;
      }
      uVar14 = *local_48 + 4;
    }
    else {
      uVar7 = FUN_180011d50((longlong)param_1,(short **)0x0,(short **)&local_res18);
      if ((char)uVar7 == '\0') {
        return 0xc000000d;
      }
      uVar14 = *local_res18 + 8;
    }
    bVar3 = true;
  }
  else {
    if (*param_1 == 8) {
      pvVar17 = *(void **)(param_1 + 0x2e);
    }
    else {
      pvVar17 = *(void **)(param_1 + 0x2c);
    }
    do {
      uVar8 = FUN_18000fac0((longlong)param_1,3 - (uint)(*param_1 != 8));
    } while ((int)uVar8 == 0x105);
    if ((int)uVar8 != -0x7fffffe6) {
      return uVar8;
    }
    bVar3 = false;
    uVar18 = param_1[0x2c] - (int)pvVar17;
  }
  if (*param_1 != 8) {
    if (*(char *)(*(longlong *)(param_1 + 4) + 0x31) == '\0') {
      uVar8 = FUN_180023058((longlong)param_1,&local_40,(undefined8 *)0x0,local_res10);
      if ((char)uVar8 == '\0') {
        return 0xc000000d;
      }
      uVar14 = uVar14 + (local_res10[0] - 1);
      pcVar16 = local_40;
      while (*pcVar16 != '\0') {
        do {
          cVar5 = *pcVar16;
          pcVar16 = pcVar16 + 1;
        } while (cVar5 != '\0');
        uVar14 = uVar14 + 1;
      }
    }
    else {
      uVar8 = FUN_180023058((longlong)param_1,(undefined8 *)0x0,&local_res20,local_res10);
      if ((char)uVar8 == '\0') {
        return 0xc000000d;
      }
      uVar14 = uVar14 + (local_res10[0] - 2);
      psVar10 = local_res20;
      while (*psVar10 != 0) {
        do {
          sVar6 = *psVar10;
          psVar10 = psVar10 + 1;
        } while (sVar6 != 0);
        uVar14 = uVar14 + 2;
      }
    }
    KernelBaseGetGlobalData();
    puVar9 = (undefined4 *)
             RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
    if (puVar9 == (undefined4 *)0x0) {
      return 0xc0000017;
    }
    if (*(char *)(*(longlong *)(param_1 + 4) + 0x31) == '\0') {
      puVar11 = puVar9;
      pcVar16 = local_40;
      if (bVar3) {
        puVar12 = (undefined2 *)((longlong)puVar9 + 1);
        *(undefined *)puVar9 = 0x5b;
        uVar13 = (uint)*local_48;
        puVar15 = *(undefined **)(local_48 + 4);
        if (*local_48 != 0) {
          do {
            uVar1 = *puVar15;
            puVar15 = puVar15 + 1;
            *(undefined *)puVar12 = uVar1;
            puVar12 = (undefined2 *)((longlong)puVar12 + 1);
            uVar13 = uVar13 - 1;
          } while (uVar13 != 0);
        }
        *puVar12 = 0xd5d;
        *(undefined *)(puVar12 + 1) = 10;
        puVar11 = (undefined4 *)((longlong)puVar12 + 3);
      }
      while (cVar5 = *pcVar16, cVar5 != '\0') {
        while( true ) {
          pcVar16 = pcVar16 + 1;
          *(char *)puVar11 = cVar5;
          if (cVar5 == '\0') break;
          cVar5 = *pcVar16;
          puVar11 = (undefined4 *)((longlong)puVar11 + 1);
        }
        *(undefined2 *)puVar11 = 0xa0d;
        puVar11 = (undefined4 *)((longlong)puVar11 + 2);
      }
    }
    else {
      puVar11 = puVar9;
      psVar10 = local_res20;
      if (bVar3) {
        *(undefined2 *)puVar9 = 0x5b;
        puVar12 = *(undefined2 **)(local_res18 + 4);
        for (uVar13 = (uint)(*local_res18 >> 1); puVar4 = (undefined4 *)((longlong)puVar11 + 2),
            uVar13 != 0; uVar13 = uVar13 - 1) {
          uVar2 = *puVar12;
          puVar12 = puVar12 + 1;
          *(undefined2 *)puVar4 = uVar2;
          puVar11 = puVar4;
        }
        *puVar4 = 0xd005d;
        *(undefined2 *)((longlong)puVar11 + 6) = 10;
        puVar11 = puVar11 + 2;
      }
      while (sVar6 = *psVar10, sVar6 != 0) {
        while( true ) {
          psVar10 = psVar10 + 1;
          *(short *)puVar11 = sVar6;
          if (sVar6 == 0) break;
          sVar6 = *psVar10;
          puVar11 = (undefined4 *)((longlong)puVar11 + 2);
        }
        *puVar11 = 0xa000d;
        puVar11 = puVar11 + 1;
      }
    }
  }
  uVar8 = FUN_180022f00((longlong)param_1,pvVar17,uVar18,puVar9,uVar14);
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar9);
  return uVar8 & 0xffffffff;
}



// WARNING: Could not reconcile some variable overlaps

ulonglong FUN_180022b0c(int *param_1,ulonglong param_2)

{
  undefined uVar1;
  undefined2 uVar2;
  bool bVar3;
  bool bVar4;
  undefined4 *puVar5;
  undefined4 uVar6;
  uint uVar7;
  ulonglong uVar8;
  undefined4 *puVar9;
  longlong lVar10;
  int iVar11;
  undefined4 *puVar12;
  undefined2 *puVar13;
  uint uVar14;
  ushort *puVar15;
  int iVar16;
  longlong lVar17;
  undefined *puVar18;
  void *pvVar19;
  longlong in_GS_OFFSET;
  ulonglong local_res10;
  ushort *local_res18;
  ushort *local_res20;
  void *local_58;
  ushort *local_50;
  ushort *local_48;
  void *local_40;
  
  pvVar19 = (void *)0x0;
  iVar16 = 0;
  local_50 = (ushort *)0x0;
  local_48 = (ushort *)0x0;
  local_res18 = (ushort *)0x0;
  local_res20 = (ushort *)0x0;
  local_40 = (void *)0x0;
  local_58 = (void *)0x0;
  local_res10 = param_2;
  uVar8 = FUN_18000f960((longlong)param_1);
  iVar11 = (int)uVar8;
  if (iVar11 < 0) {
    if (*param_1 == 3) {
      return 0;
    }
    pvVar19 = *(void **)(param_1 + 0x30);
    if (*(char *)(*(longlong *)(param_1 + 4) + 0x31) == '\0') {
      uVar6 = FUN_180011d50((longlong)param_1,(short **)&local_50,(short **)0x0);
      if ((char)uVar6 == '\0') {
        return 0xc000000d;
      }
      iVar16 = *local_50 + 4;
    }
    else {
      uVar6 = FUN_180011d50((longlong)param_1,(short **)0x0,(short **)&local_res18);
      if ((char)uVar6 == '\0') {
        return 0xc000000d;
      }
      iVar16 = *local_res18 + 8;
    }
    bVar3 = true;
  }
  else {
    bVar3 = false;
    uVar8 = FUN_18000f478((longlong)param_1);
    iVar11 = (int)uVar8;
  }
  if (iVar11 < 0) {
    if (*param_1 == 3) {
      return 0;
    }
    if (!bVar3) {
      pvVar19 = *(void **)(param_1 + 0x2c);
    }
    if (*(char *)(*(longlong *)(param_1 + 4) + 0x31) == '\0') {
      uVar6 = FUN_18000ff6c((longlong)param_1,(short **)&local_48,(short **)0x0);
      if ((char)uVar6 == '\0') {
        return 0xc000000d;
      }
      iVar11 = *local_48 + 3;
    }
    else {
      uVar6 = FUN_18000ff6c((longlong)param_1,(short **)0x0,(short **)&local_res20);
      if ((char)uVar6 == '\0') {
        return 0xc000000d;
      }
      iVar11 = *local_res20 + 6;
    }
    iVar16 = iVar16 + iVar11;
    bVar4 = true;
    lVar17 = *(longlong *)(param_1 + 4);
  }
  else {
    lVar17 = *(longlong *)(param_1 + 4);
    if (*(char *)(lVar17 + 0x31) == '\0') {
      if (*param_1 == 3) {
        uVar14 = FUN_180023148((longlong)param_1);
        puVar15 = *(ushort **)(param_1 + 0x40);
        goto LAB_180022d9f;
      }
      lVar10 = *(longlong *)(param_1 + 0x42);
    }
    else {
      if (*param_1 == 3) {
        uVar14 = FUN_180023148((longlong)param_1);
        puVar15 = *(ushort **)(param_1 + 0x52);
LAB_180022d9f:
        uVar7 = 0;
        pvVar19 = (void *)0x0;
        goto LAB_180022d3c;
      }
      lVar10 = *(longlong *)(param_1 + 0x54);
    }
    pvVar19 = *(void **)(lVar10 + 8);
    bVar4 = false;
  }
  if (*(char *)(lVar17 + 0x31) == '\0') {
    uVar8 = FUN_180023058((longlong)param_1,&local_40,(undefined8 *)0x0,(uint *)&local_res10);
    if ((char)uVar8 != '\0') {
      uVar7 = (uint)local_res10 - 1;
      local_res10 = local_res10 & 0xffffffff00000000 | (ulonglong)uVar7;
      if (iVar16 != 0) goto LAB_180022bf3;
      puVar15 = *(ushort **)(param_1 + 0x42);
      uVar14 = (uint)*puVar15;
      pvVar19 = local_40;
      goto LAB_180022d3c;
    }
  }
  else {
    uVar8 = FUN_180023058((longlong)param_1,(undefined8 *)0x0,&local_58,(uint *)&local_res10);
    if ((char)uVar8 != '\0') {
      uVar7 = (uint)local_res10 - 2;
      local_res10 = local_res10 & 0xffffffff00000000 | (ulonglong)uVar7;
      if (iVar16 != 0) {
LAB_180022bf3:
        KernelBaseGetGlobalData();
        puVar9 = (undefined4 *)
                 RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
        if (puVar9 == (undefined4 *)0x0) {
          return 0xc0000017;
        }
        if (*(char *)(*(longlong *)(param_1 + 4) + 0x31) == '\0') {
          puVar12 = puVar9;
          if (bVar3) {
            puVar13 = (undefined2 *)((longlong)puVar9 + 1);
            *(undefined *)puVar9 = 0x5b;
            uVar14 = (uint)*local_50;
            puVar18 = *(undefined **)(local_50 + 4);
            if (*local_50 != 0) {
              do {
                uVar1 = *puVar18;
                puVar18 = puVar18 + 1;
                *(undefined *)puVar13 = uVar1;
                puVar13 = (undefined2 *)((longlong)puVar13 + 1);
                uVar14 = uVar14 - 1;
              } while (uVar14 != 0);
            }
            *puVar13 = 0xd5d;
            *(undefined *)(puVar13 + 1) = 10;
            puVar12 = (undefined4 *)((longlong)puVar13 + 3);
          }
          if (bVar4) {
            uVar14 = (uint)*local_48;
            puVar18 = *(undefined **)(local_48 + 4);
            if (*local_48 != 0) {
              do {
                uVar1 = *puVar18;
                puVar18 = puVar18 + 1;
                *(undefined *)puVar12 = uVar1;
                puVar12 = (undefined4 *)((longlong)puVar12 + 1);
                uVar14 = uVar14 - 1;
              } while (uVar14 != 0);
            }
            *(undefined *)puVar12 = 0x3d;
            puVar12 = (undefined4 *)((longlong)puVar12 + 1);
          }
          if ((uint)local_res10 != 0) {
            lVar17 = (longlong)local_40 - (longlong)puVar12;
            do {
              *(undefined *)puVar12 = *(undefined *)(lVar17 + (longlong)puVar12);
              puVar12 = (undefined4 *)((longlong)puVar12 + 1);
              local_res10._0_4_ = (uint)local_res10 - 1;
            } while ((uint)local_res10 != 0);
          }
          if (bVar4) {
            *(undefined2 *)puVar12 = 0xa0d;
          }
        }
        else {
          puVar12 = puVar9;
          if (bVar3) {
            *(undefined2 *)puVar9 = 0x5b;
            puVar13 = *(undefined2 **)(local_res18 + 4);
            for (uVar14 = (uint)(*local_res18 >> 1); puVar5 = (undefined4 *)((longlong)puVar12 + 2),
                uVar14 != 0; uVar14 = uVar14 - 1) {
              uVar2 = *puVar13;
              puVar13 = puVar13 + 1;
              *(undefined2 *)puVar5 = uVar2;
              puVar12 = puVar5;
            }
            *puVar5 = 0xd005d;
            *(undefined2 *)((longlong)puVar12 + 6) = 10;
            puVar12 = puVar12 + 2;
          }
          if (bVar4) {
            puVar13 = *(undefined2 **)(local_res20 + 4);
            for (uVar14 = (uint)(*local_res20 >> 1); uVar14 != 0; uVar14 = uVar14 - 1) {
              uVar2 = *puVar13;
              puVar13 = puVar13 + 1;
              *(undefined2 *)puVar12 = uVar2;
              puVar12 = (undefined4 *)((longlong)puVar12 + 2);
            }
            *(undefined2 *)puVar12 = 0x3d;
            puVar12 = (undefined4 *)((longlong)puVar12 + 2);
          }
          local_res10._0_4_ = (uint)local_res10 >> 1;
          if ((uint)local_res10 != 0) {
            lVar17 = (longlong)local_58 - (longlong)puVar12;
            do {
              *(undefined2 *)puVar12 = *(undefined2 *)(lVar17 + (longlong)puVar12);
              puVar12 = (undefined4 *)((longlong)puVar12 + 2);
              local_res10._0_4_ = (uint)local_res10 - 1;
            } while ((uint)local_res10 != 0);
          }
          if (bVar4) {
            *puVar12 = 0xa000d;
          }
        }
        uVar8 = FUN_180022f00((longlong)param_1,pvVar19,0,puVar9,uVar7 + iVar16);
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar9);
        return uVar8 & 0xffffffff;
      }
      puVar15 = *(ushort **)(param_1 + 0x54);
      uVar14 = (uint)*puVar15;
      pvVar19 = local_58;
LAB_180022d3c:
      uVar8 = FUN_180022f00((longlong)param_1,*(void **)(puVar15 + 4),uVar14,pvVar19,uVar7);
      return uVar8;
    }
  }
  return 0xc000000d;
}



undefined8 FUN_180022f00(longlong param_1,void *param_2,uint param_3,void *param_4,uint param_5)

{
  uint uVar1;
  longlong lVar2;
  undefined8 uVar3;
  ulonglong uVar4;
  ulonglong _Size;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  
  lVar2 = *(longlong *)(param_1 + 0x10);
  _Size = (ulonglong)param_5;
  uVar6 = (*(int *)(lVar2 + 0x34) - param_3) + param_5;
  uVar4 = (ulonglong)uVar6;
  if (*(ulonglong *)(lVar2 + 0x40) <= uVar4 && uVar4 != *(ulonglong *)(lVar2 + 0x40)) {
    if (*(ulonglong *)(lVar2 + 0x48) <= uVar4 && uVar4 != *(ulonglong *)(lVar2 + 0x48)) {
      return 0x80000005;
    }
    *(ulonglong *)(lVar2 + 0x40) = uVar4;
    uVar3 = NtAllocateVirtualMemory
                      (0xffffffffffffffff,*(longlong *)(param_1 + 0x10) + 0x38,0,
                       *(longlong *)(param_1 + 0x10) + 0x40,0x1000,4);
    if ((int)uVar3 < 0) {
      return uVar3;
    }
    *(uint *)(*(longlong *)(param_1 + 0x10) + 0x34) = uVar6;
    lVar2 = *(longlong *)(param_1 + 0x10);
  }
  uVar5 = (int)param_2 - *(int *)(lVar2 + 0x38);
  uVar1 = *(int *)(param_1 + 0xc0) - (int)param_2;
  uVar8 = uVar1 - param_3;
  uVar7 = param_5 + uVar8;
  if (param_5 < param_3) {
    RtlMoveMemory(param_2,param_4,_Size);
    param_4 = (void *)((longlong)param_2 + (ulonglong)param_3);
    param_2 = (void *)(_Size + (longlong)param_2);
    _Size = (ulonglong)uVar8;
    param_5 = uVar7;
  }
  else {
    if (param_5 == 0) {
      return 0;
    }
    if (param_3 < param_5) {
      RtlMoveMemory((void *)((_Size - param_3) + (longlong)param_2),param_2,(ulonglong)uVar1);
      param_5 = uVar7;
    }
  }
  RtlMoveMemory(param_2,param_4,_Size);
  lVar2 = *(longlong *)(param_1 + 0x10);
  if (*(uint *)(lVar2 + 0x34) != uVar6) {
    *(uint *)(lVar2 + 0x34) = uVar6;
    lVar2 = *(longlong *)(param_1 + 0x10);
  }
  if (uVar5 < *(uint *)(lVar2 + 0x50)) {
    *(uint *)(lVar2 + 0x50) = uVar5;
    lVar2 = *(longlong *)(param_1 + 0x10);
  }
  uVar5 = param_5 + uVar5;
  if (*(uint *)(lVar2 + 0x54) <= uVar5 && uVar5 != *(uint *)(lVar2 + 0x54)) {
    *(uint *)(lVar2 + 0x54) = uVar5;
  }
  return 0;
}



ulonglong FUN_180023058(longlong param_1,undefined8 *param_2,undefined8 *param_3,uint *param_4)

{
  int iVar1;
  ulonglong in_RAX;
  undefined *puVar2;
  uint uVar3;
  uint local_res10 [2];
  
  if (param_2 == (undefined8 *)0x0) {
    if (param_3 == (undefined8 *)0x0) {
LAB_18002313a:
      return in_RAX & 0xffffffffffffff00;
    }
    if (*(uint *)(param_1 + 0xa8) == 0) {
      if ((*(longlong *)(param_1 + 0x90) == 0) || (iVar1 = *(int *)(param_1 + 0x98), iVar1 == 0)) {
        puVar2 = &DAT_180085634;
        *param_4 = 2;
        *param_3 = &DAT_180085634;
        goto LAB_1800230a9;
      }
      *(int *)(param_1 + 0xa8) = iVar1 * 2;
      in_RAX = RtlMultiByteToUnicodeN
                         (*(undefined8 *)(param_1 + 0xa0),iVar1 * 2,local_res10,
                          *(longlong *)(param_1 + 0x90),iVar1);
      if ((int)in_RAX < 0) goto LAB_18002313a;
      local_res10[0] = local_res10[0] >> 1;
      *(undefined2 *)(*(longlong *)(param_1 + 0xa0) + (ulonglong)local_res10[0] * 2) = 0;
    }
    else {
      local_res10[0] = *(uint *)(param_1 + 0xa8) >> 1;
    }
    *param_3 = *(undefined8 *)(param_1 + 0xa0);
    uVar3 = local_res10[0] * 2 + 2;
  }
  else {
    uVar3 = *(uint *)(param_1 + 0x98);
    if (*(uint *)(param_1 + 0x98) == 0) {
      if ((*(longlong *)(param_1 + 0xa0) == 0) || (iVar1 = *(int *)(param_1 + 0xa8), iVar1 == 0)) {
        puVar2 = &DAT_180085c3a;
        *param_4 = 1;
        *param_2 = &DAT_180085c3a;
        goto LAB_1800230a9;
      }
      *(int *)(param_1 + 0x98) = iVar1;
      in_RAX = RtlUnicodeToMultiByteN
                         (*(undefined8 *)(param_1 + 0x90),iVar1,local_res10,
                          *(longlong *)(param_1 + 0xa0),iVar1);
      if ((int)in_RAX < 0) goto LAB_18002313a;
      *(uint *)(param_1 + 0x98) = local_res10[0];
      *(undefined *)((ulonglong)local_res10[0] + *(longlong *)(param_1 + 0x90)) = 0;
      uVar3 = local_res10[0];
    }
    *param_2 = *(undefined8 *)(param_1 + 0x90);
    uVar3 = uVar3 + 1;
  }
  puVar2 = (undefined *)(ulonglong)uVar3;
  *param_4 = uVar3;
LAB_1800230a9:
  return CONCAT71((int7)((ulonglong)puVar2 >> 8),1);
}



int FUN_180023148(longlong param_1)

{
  longlong lVar1;
  
  if (*(char *)(*(longlong *)(param_1 + 0x10) + 0x31) == '\0') {
    lVar1 = *(longlong *)(param_1 + 0x100);
  }
  else {
    lVar1 = *(longlong *)(param_1 + 0x148);
  }
  return *(int *)(param_1 + 0xb0) - *(int *)(lVar1 + 8);
}



DWORD GetPrivateProfileSectionA
                (LPCSTR lpAppName,LPSTR lpReturnedString,DWORD nSize,LPCSTR lpFileName)

{
  int iVar1;
  ulonglong uVar2;
  DWORD local_res18 [4];
  
                    // 0x23180  689  GetPrivateProfileSectionA
  local_res18[0] = nSize;
  iVar1 = BaseDllReadWriteIniFile
                    ('\0','\0','\x01',(LPCWSTR)lpFileName,(short *)lpAppName,(short *)0x0,
                     (short *)lpReturnedString,(int *)local_res18);
  if (iVar1 < 0) {
    if (iVar1 == -0x7ffffffb) {
      if (1 < nSize) {
        local_res18[0] = nSize - 2;
        lpReturnedString[nSize - 1] = '\0';
        goto LAB_1800231d1;
      }
    }
    else if (iVar1 == -0x3fffff85) {
      RtlSetLastWin32Error();
    }
    else {
      BaseSetLastNTError();
    }
    local_res18[0] = 0;
    uVar2 = 0;
  }
  else {
    RtlSetLastWin32Error();
    local_res18[0] = local_res18[0] - 1;
LAB_1800231d1:
    uVar2 = (ulonglong)local_res18[0];
  }
  if ((uint)uVar2 < nSize) {
    lpReturnedString[uVar2] = '\0';
  }
  else if (nSize != 0) {
    lpReturnedString[nSize - 1] = '\0';
  }
  return local_res18[0];
}



ulonglong FUN_18002321c(longlong *param_1,int param_2)

{
  ulonglong *puVar1;
  ulonglong uVar2;
  longlong lVar3;
  int iVar4;
  longlong *plVar5;
  undefined8 uVar6;
  ulonglong uVar7;
  ulonglong uVar8;
  longlong lVar9;
  longlong in_GS_OFFSET;
  
  uVar8 = param_1[0xb];
  puVar1 = (ulonglong *)(param_1 + 8);
  uVar2 = *puVar1;
  plVar5 = (longlong *)0x0;
  FUN_180023324(param_1,(longlong)(param_1 + 0xe));
  lVar3 = param_1[9];
  if ((ulonglong)param_1[0x11] < (ulonglong)param_1[0xf]) {
    lVar9 = (longlong)(lVar3 - *puVar1) >> 1;
    if ((lVar9 == 0) || (*(longlong *)(*param_1 + 0x150) == 0)) {
      uVar7 = lVar3 - 2;
LAB_180023289:
      *puVar1 = uVar7;
      do {
        if (uVar7 < uVar8) {
LAB_1800355c2:
          SetLastError(0);
          uVar8 = 0xffffffff;
LAB_1800232f5:
          if (plVar5 != (longlong *)0x0) {
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,plVar5);
          }
          goto LAB_1800232fe;
        }
        param_1[0x11] = param_1[0xe];
        param_1[0xb] = uVar7;
        iVar4 = FUN_180003c80(param_1);
        if (iVar4 == 2) {
          lVar3 = param_1[0xb];
          *(int *)((longlong)param_1 + 0xac) = (int)((longlong)(lVar3 - uVar2) >> 1);
          if (param_2 != 0) {
            FUN_180023324(param_1,(longlong)puVar1);
            uVar8 = param_1[0xb];
            param_1[0xb] = lVar3;
            if (uVar8 < (ulonglong)param_1[9]) goto LAB_1800355c2;
          }
          uVar8 = (longlong)(*puVar1 - uVar2) >> 1;
          goto LAB_1800232f5;
        }
        lVar9 = lVar9 + -1;
        if (lVar9 < 1) goto LAB_1800355c2;
        if (plVar5 != (longlong *)0x0) goto LAB_1800355a0;
        *puVar1 = *puVar1 - 2;
LAB_1800355ba:
        uVar7 = *puVar1;
      } while( true );
    }
    plVar5 = (longlong *)
             RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,
                             lVar9 * 8 + 8);
    if (plVar5 != (longlong *)0x0) {
      uVar6 = FUN_180054b38(param_1,puVar1,plVar5,lVar9 + 1);
      if ((int)uVar6 == 0) goto LAB_1800355ba;
      lVar9 = *plVar5;
      goto LAB_1800355a0;
    }
    SetLastError(8);
    uVar8 = 0xffffffff;
  }
  else {
    uVar8 = (longlong)(lVar3 - uVar2) >> 1;
    *(int *)((longlong)param_1 + 0xac) = (int)uVar8;
  }
LAB_1800232fe:
  return uVar8 & 0xffffffff;
LAB_1800355a0:
  uVar7 = plVar5[lVar9];
  goto LAB_180023289;
}



void FUN_180023324(longlong *param_1,longlong param_2)

{
  ushort uVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  char cVar10;
  ulonglong uVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  ushort *puVar11;
  longlong lVar12;
  longlong lVar13;
  ushort uVar14;
  int iVar15;
  longlong lVar16;
  longlong lVar17;
  int iVar18;
  ushort *puVar19;
  ushort *puVar20;
  uint uVar21;
  ushort *puVar22;
  ulonglong uVar23;
  
  puVar20 = *(ushort **)(param_2 + 0x18);
  puVar19 = *(ushort **)(param_2 + 8);
  if (puVar20 < puVar19) {
    do {
      uVar7 = 0;
      uVar1 = *puVar20;
      if (param_1[1] == 0) {
        cVar10 = (char)((uint)*(undefined4 *)(DAT_1800b2b88 + (ulonglong)uVar1 * 4) >> 8);
      }
      else {
        cVar10 = (char)((uint)*(undefined4 *)
                               (DAT_1800b2b88 +
                               (ulonglong)
                               (*(int *)(param_1[1] + (ulonglong)(uVar1 >> 8) * 4) +
                               (uint)*(byte *)puVar20) * 4) >> 8);
      }
      uVar14 = 0;
      uVar21 = 0;
      if (cVar10 == '\0') {
        if ((*(int *)(param_1 + 6) != 0) && (*puVar20 == 0)) {
          return;
        }
        if (*puVar20 == 0xdb40) {
          iVar15 = *(int *)(param_2 + 0x20);
          if (iVar15 < 1) {
            if (puVar20 + 1 < puVar19) {
              uVar14 = puVar20[1];
            }
          }
          else {
            uVar14 = *(ushort *)(param_2 + 0x12 + (longlong)iVar15 * 2);
          }
          if ((ushort)(uVar14 + 0x2300) < 0xf0) {
            if (iVar15 < 1) {
              puVar20 = puVar20 + 1;
              *(ushort **)(param_2 + 0x18) = puVar20;
              if (puVar20 < puVar19) {
                *(ushort *)(param_2 + 0x2a) = *puVar20;
              }
              else {
                *(undefined2 *)(param_2 + 0x2a) = 0;
              }
            }
            else {
              *(int *)(param_2 + 0x20) = iVar15 + -1;
              *(undefined2 *)(param_2 + 0x2a) =
                   *(undefined2 *)(param_2 + 0x12 + (longlong)iVar15 * 2);
            }
          }
        }
      }
      else if (cVar10 == '\x01') {
        if ((*(int *)(param_1 + 3) == 0) && (*(int *)((longlong)param_1 + 0x24) == 0)) {
          return;
        }
        if (*(longlong *)(*param_1 + 0x150) != 0) {
          *(ushort *)(param_2 + 0x2a) = uVar1;
          uVar23 = (ulonglong)*puVar20;
          if (param_1[1] != 0) {
            uVar23 = (ulonglong)
                     (*(int *)(param_1[1] + (ulonglong)(*puVar20 >> 8) * 4) + (uint)*(byte *)puVar20
                     );
          }
          *(undefined4 *)(param_2 + 0x24) = *(undefined4 *)(DAT_1800b2b88 + uVar23 * 4);
          uVar2 = uVar21;
          if (*(char *)(param_2 + 0x25) != '\x03') {
            uVar2 = (uint)*(byte *)(param_2 + 0x27);
          }
          uVar2 = uVar2 & 0xc0;
          if (uVar2 != 0x40) {
            if (uVar2 != 0x80) {
              if (uVar2 != 0xc0) goto LAB_18003629d;
              lVar17 = *param_1;
              lVar16 = *(longlong *)(lVar17 + 0x150);
              uVar2 = *(uint *)(lVar17 + 0x140) & 0x20;
              uVar23 = uVar7;
              if ((*(short *)(lVar16 + 0x14) != 0) &&
                 (puVar19 = *(ushort **)(param_2 + 8),
                 (ushort *)((-(ulonglong)(uVar2 != 0) & 2) + 0xe + (longlong)puVar20) <= puVar19)) {
                iVar15 = *(int *)(param_2 + 0x10);
                iVar3 = (uVar2 != 0) + 8;
                puVar22 = puVar20;
                if (puVar19 == (ushort *)0x0) {
                  iVar15 = 1;
                }
                do {
                  if (((puVar19 <= puVar22) ||
                      (((uVar1 = *puVar22, uVar1 == 0 && (iVar15 != 0)) ||
                       (*(ushort *)(lVar16 + 6) <= uVar1 && uVar1 != *(ushort *)(lVar16 + 6))))) ||
                     (uVar1 < *(ushort *)(lVar16 + 4))) break;
                  puVar22 = puVar22 + 1;
                  iVar3 = iVar3 + -1;
                } while (0 < iVar3);
                uVar23 = (longlong)puVar22 - (longlong)puVar20 >> 1;
                if (7 < (int)uVar23) {
                  iVar15 = *(ushort *)(lVar16 + 0x14) - 1;
                  if ((uVar2 != 0) && (8 < (int)uVar23)) {
                    puVar19 = *(ushort **)(param_2 + 0x18);
                    lVar12 = param_1[1];
                    uVar7 = (ulonglong)*puVar19;
                    if (lVar12 != 0) {
                      uVar7 = (ulonglong)
                              (*(int *)(lVar12 + (ulonglong)(*puVar19 >> 8) * 4) +
                              (uint)*(byte *)puVar19);
                    }
                    uVar8 = (ulonglong)puVar19[1];
                    if (lVar12 != 0) {
                      uVar8 = (ulonglong)
                              (*(int *)(lVar12 + (ulonglong)(puVar19[1] >> 8) * 4) +
                              (uint)*(byte *)(puVar19 + 1));
                    }
                    uVar7 = (ulonglong)
                            (((*(uint *)(DAT_1800b2b88 + uVar8 * 4) ^
                              *(uint *)(DAT_1800b2b88 + uVar7 * 4)) & 0xe7ffffff) == 0);
                  }
                  if (-1 < iVar15) {
                    do {
                      iVar3 = (int)(iVar15 + uVar21) / 2;
                      iVar18 = 8;
                      puVar19 = (ushort *)
                                (*(longlong *)(lVar17 + 0x188) + (longlong)(iVar3 * 10) * 2);
                      lVar12 = (*(longlong *)(param_2 + 0x18) + uVar7 * 2) - (longlong)puVar19;
                      do {
                        iVar4 = (uint)*(ushort *)(lVar12 + (longlong)puVar19) - (uint)*puVar19;
                        if (iVar4 != 0) goto LAB_180035800;
                        puVar19 = puVar19 + 1;
                        iVar18 = iVar18 + -1;
                      } while (0 < iVar18);
                      iVar4 = 0;
LAB_180035800:
                      if (iVar4 == 0) {
                        *(undefined4 *)(param_2 + 0x24) =
                             *(undefined4 *)
                              (*(longlong *)(lVar17 + 0x188) + 0x10 + (longlong)(iVar3 * 10) * 2);
                        if ((int)uVar7 != 0) goto LAB_1800362e5;
                        lVar17 = *(longlong *)(param_2 + 0x18) + 0xe;
                        goto LAB_1800362e1;
                      }
                      iVar18 = iVar3 + -1;
                      if (-1 < iVar4) {
                        iVar18 = iVar15;
                      }
                      iVar15 = iVar18;
                      if (-1 < iVar4) {
                        uVar21 = iVar3 + 1;
                      }
                    } while ((int)uVar21 <= iVar15);
                  }
                }
              }
              uVar7 = uVar23;
              lVar12 = 0;
              if (*(short *)(lVar16 + 0x12) != 0) {
                puVar19 = *(ushort **)(param_2 + 0x18);
                puVar22 = *(ushort **)(param_2 + 8);
                if ((ushort *)((-(ulonglong)(uVar2 != 0) & 2) + 0xc + (longlong)puVar19) <= puVar22)
                {
                  if ((int)uVar7 == 0) {
                    iVar15 = *(int *)(param_2 + 0x10);
                    iVar3 = (uVar2 != 0) + 7;
                    puVar11 = puVar19;
                    if (puVar22 == (ushort *)0x0) {
                      iVar15 = 1;
                    }
                    do {
                      if (((puVar22 <= puVar11) || ((uVar1 = *puVar11, uVar1 == 0 && (iVar15 != 0)))
                          ) || ((*(ushort *)(lVar16 + 6) <= uVar1 &&
                                 uVar1 != *(ushort *)(lVar16 + 6) ||
                                (uVar1 < *(ushort *)(lVar16 + 4))))) break;
                      puVar11 = puVar11 + 1;
                      iVar3 = iVar3 + -1;
                    } while (0 < iVar3);
                    uVar7 = (longlong)puVar11 - (longlong)puVar19 >> 1 & 0xffffffff;
                  }
                  if (6 < (int)uVar7) {
                    iVar15 = 0;
                    iVar3 = *(ushort *)(lVar16 + 0x12) - 1;
                    if ((uVar2 != 0) && (7 < (int)uVar7)) {
                      puVar19 = *(ushort **)(param_2 + 0x18);
                      lVar13 = param_1[1];
                      uVar23 = (ulonglong)*puVar19;
                      if (lVar13 != 0) {
                        uVar23 = (ulonglong)
                                 (*(int *)(lVar13 + (ulonglong)(*puVar19 >> 8) * 4) +
                                 (uint)*(byte *)puVar19);
                      }
                      uVar8 = (ulonglong)puVar19[1];
                      if (lVar13 != 0) {
                        uVar8 = (ulonglong)
                                (*(int *)(lVar13 + (ulonglong)(puVar19[1] >> 8) * 4) +
                                (uint)*(byte *)(puVar19 + 1));
                      }
                      if (((*(uint *)(DAT_1800b2b88 + uVar8 * 4) ^
                           *(uint *)(DAT_1800b2b88 + uVar23 * 4)) & 0xe7ffffff) == 0) {
                        lVar12 = 1;
                      }
                    }
                    if (-1 < iVar3) {
                      do {
                        iVar18 = (iVar3 + iVar15) / 2;
                        iVar4 = 7;
                        puVar19 = (ushort *)
                                  (*(longlong *)(lVar17 + 0x180) + (longlong)(iVar18 * 10) * 2);
                        lVar13 = (*(longlong *)(param_2 + 0x18) + lVar12 * 2) - (longlong)puVar19;
                        do {
                          iVar5 = (uint)*(ushort *)(lVar13 + (longlong)puVar19) - (uint)*puVar19;
                          if (iVar5 != 0) goto LAB_18003597e;
                          puVar19 = puVar19 + 1;
                          iVar4 = iVar4 + -1;
                        } while (0 < iVar4);
                        iVar5 = 0;
LAB_18003597e:
                        if (iVar5 == 0) {
                          *(undefined4 *)(param_2 + 0x24) =
                               *(undefined4 *)
                                (*(longlong *)(lVar17 + 0x180) + 0x10 + (longlong)(iVar18 * 10) * 2)
                          ;
                          if ((int)lVar12 != 0) goto LAB_1800362e5;
                          lVar17 = *(longlong *)(param_2 + 0x18) + 0xc;
                          goto LAB_1800362e1;
                        }
                        iVar4 = iVar18 + -1;
                        if (-1 < iVar5) {
                          iVar4 = iVar3;
                        }
                        iVar3 = iVar4;
                        if (-1 < iVar5) {
                          iVar15 = iVar18 + 1;
                        }
                      } while (iVar15 <= iVar3);
                    }
                  }
                }
              }
              uVar23 = 0;
              if (*(short *)(lVar16 + 0x10) != 0) {
                puVar19 = *(ushort **)(param_2 + 0x18);
                puVar22 = *(ushort **)(param_2 + 8);
                if ((ushort *)((-(ulonglong)(uVar2 != 0) & 2) + 10 + (longlong)puVar19) <= puVar22)
                {
                  if ((int)uVar7 == 0) {
                    iVar3 = (uVar2 != 0) + 6;
                    puVar11 = puVar19;
                    iVar15 = *(int *)(param_2 + 0x10);
                    if (puVar22 == (ushort *)0x0) {
                      iVar15 = 1;
                    }
                    do {
                      if ((puVar22 <= puVar11) ||
                         ((((uVar1 = *puVar11, uVar1 == 0 && (iVar15 != 0)) ||
                           (*(ushort *)(lVar16 + 6) <= uVar1 && uVar1 != *(ushort *)(lVar16 + 6)))
                          || (uVar1 < *(ushort *)(lVar16 + 4))))) break;
                      puVar11 = puVar11 + 1;
                      iVar3 = iVar3 + -1;
                    } while (0 < iVar3);
                    uVar7 = (longlong)puVar11 - (longlong)puVar19 >> 1 & 0xffffffff;
                  }
                  if (5 < (int)uVar7) {
                    iVar15 = *(ushort *)(lVar16 + 0x10) - 1;
                    uVar8 = uVar23;
                    if ((uVar2 != 0) && (6 < (int)uVar7)) {
                      puVar19 = *(ushort **)(param_2 + 0x18);
                      lVar16 = param_1[1];
                      uVar8 = (ulonglong)*puVar19;
                      if (lVar16 != 0) {
                        uVar8 = (ulonglong)
                                (*(int *)(lVar16 + (ulonglong)(*puVar19 >> 8) * 4) +
                                (uint)*(byte *)puVar19);
                      }
                      uVar9 = (ulonglong)puVar19[1];
                      if (lVar16 != 0) {
                        uVar9 = (ulonglong)
                                (*(int *)(lVar16 + (ulonglong)(puVar19[1] >> 8) * 4) +
                                (uint)*(byte *)(puVar19 + 1));
                      }
                      uVar8 = (ulonglong)
                              (((*(uint *)(DAT_1800b2b88 + uVar9 * 4) ^
                                *(uint *)(DAT_1800b2b88 + uVar8 * 4)) & 0xe7ffffff) == 0);
                    }
                    if (-1 < iVar15) {
                      do {
                        iVar3 = (iVar15 + (int)uVar23) / 2;
                        iVar18 = 6;
                        puVar19 = (ushort *)
                                  ((longlong)(iVar3 << 3) * 2 + *(longlong *)(lVar17 + 0x178));
                        lVar16 = (*(longlong *)(param_2 + 0x18) + uVar8 * 2) - (longlong)puVar19;
                        do {
                          iVar4 = (uint)*(ushort *)(lVar16 + (longlong)puVar19) - (uint)*puVar19;
                          if (iVar4 != 0) goto LAB_180035b5e;
                          puVar19 = puVar19 + 1;
                          iVar18 = iVar18 + -1;
                        } while (0 < iVar18);
                        iVar4 = 0;
LAB_180035b5e:
                        if (iVar4 == 0) {
                          *(undefined4 *)(param_2 + 0x24) =
                               *(undefined4 *)
                                (*(longlong *)(lVar17 + 0x178) + 0xc + (longlong)(iVar3 << 3) * 2);
                          if ((int)uVar8 != 0) goto LAB_1800362e5;
                          lVar17 = *(longlong *)(param_2 + 0x18) + 10;
                          goto LAB_1800362e1;
                        }
                        iVar18 = iVar3 + -1;
                        if (-1 < iVar4) {
                          iVar18 = iVar15;
                        }
                        iVar15 = iVar18;
                        if (-1 < iVar4) {
                          uVar23 = (ulonglong)(iVar3 + 1);
                        }
                      } while ((int)uVar23 <= iVar15);
                    }
                  }
                }
              }
            }
            uVar23 = 0;
            lVar17 = *param_1;
            lVar16 = *(longlong *)(lVar17 + 0x150);
            uVar21 = *(uint *)(lVar17 + 0x140) & 0x20;
            if (*(short *)(lVar16 + 0xe) != 0) {
              puVar19 = *(ushort **)(param_2 + 0x18);
              puVar22 = *(ushort **)(param_2 + 8);
              if ((ushort *)((-(ulonglong)(uVar21 != 0) & 2) + 8 + (longlong)puVar19) <= puVar22) {
                if ((int)uVar7 == 0) {
                  iVar15 = *(int *)(param_2 + 0x10);
                  iVar3 = (uVar21 != 0) + 5;
                  puVar11 = puVar19;
                  if (puVar22 == (ushort *)0x0) {
                    iVar15 = 1;
                  }
                  do {
                    if ((((puVar22 <= puVar11) || ((uVar1 = *puVar11, uVar1 == 0 && (iVar15 != 0))))
                        || (*(ushort *)(lVar16 + 6) <= uVar1 && uVar1 != *(ushort *)(lVar16 + 6)))
                       || (uVar1 < *(ushort *)(lVar16 + 4))) break;
                    puVar11 = puVar11 + 1;
                    iVar3 = iVar3 + -1;
                  } while (0 < iVar3);
                  uVar7 = (longlong)puVar11 - (longlong)puVar19 >> 1 & 0xffffffff;
                }
                if (4 < (int)uVar7) {
                  iVar15 = 0;
                  iVar3 = *(ushort *)(lVar16 + 0xe) - 1;
                  if ((uVar21 != 0) && (5 < (int)uVar7)) {
                    puVar19 = *(ushort **)(param_2 + 0x18);
                    lVar12 = param_1[1];
                    uVar23 = (ulonglong)*puVar19;
                    if (lVar12 != 0) {
                      uVar23 = (ulonglong)
                               (*(int *)(lVar12 + (ulonglong)(*puVar19 >> 8) * 4) +
                               (uint)*(byte *)puVar19);
                    }
                    uVar8 = (ulonglong)puVar19[1];
                    if (lVar12 != 0) {
                      uVar8 = (ulonglong)
                              (*(int *)(lVar12 + (ulonglong)(puVar19[1] >> 8) * 4) +
                              (uint)*(byte *)(puVar19 + 1));
                    }
                    uVar23 = (ulonglong)
                             (((*(uint *)(DAT_1800b2b88 + uVar8 * 4) ^
                               *(uint *)(DAT_1800b2b88 + uVar23 * 4)) & 0xe7ffffff) == 0);
                  }
                  if (-1 < iVar3) {
                    do {
                      iVar4 = 5;
                      iVar18 = (iVar3 + iVar15) / 2;
                      puVar19 = (ushort *)
                                (*(longlong *)(lVar17 + 0x170) + (longlong)(iVar18 << 3) * 2);
                      lVar12 = (*(longlong *)(param_2 + 0x18) + uVar23 * 2) - (longlong)puVar19;
                      do {
                        iVar5 = (uint)*(ushort *)(lVar12 + (longlong)puVar19) - (uint)*puVar19;
                        if (iVar5 != 0) goto LAB_180035cfb;
                        puVar19 = puVar19 + 1;
                        iVar4 = iVar4 + -1;
                      } while (0 < iVar4);
                      iVar5 = 0;
LAB_180035cfb:
                      if (iVar5 == 0) {
                        *(undefined4 *)(param_2 + 0x24) =
                             *(undefined4 *)
                              (*(longlong *)(lVar17 + 0x170) + 0xc + (longlong)(iVar18 << 3) * 2);
                        if ((int)uVar23 != 0) goto LAB_1800362e5;
                        lVar17 = *(longlong *)(param_2 + 0x18) + 8;
                        goto LAB_1800362e1;
                      }
                      iVar4 = iVar18 + -1;
                      if (-1 < iVar5) {
                        iVar4 = iVar3;
                      }
                      iVar3 = iVar4;
                      if (-1 < iVar5) {
                        iVar15 = iVar18 + 1;
                      }
                    } while (iVar15 <= iVar3);
                  }
                }
              }
            }
            uVar23 = 0;
            if (*(short *)(lVar16 + 0xc) != 0) {
              puVar19 = *(ushort **)(param_2 + 0x18);
              puVar22 = *(ushort **)(param_2 + 8);
              if ((ushort *)((-(ulonglong)(uVar21 != 0) & 2) + 6 + (longlong)puVar19) <= puVar22) {
                if ((int)uVar7 == 0) {
                  iVar3 = (uVar21 != 0) + 4;
                  puVar11 = puVar19;
                  iVar15 = *(int *)(param_2 + 0x10);
                  if (puVar22 == (ushort *)0x0) {
                    iVar15 = 1;
                  }
                  do {
                    if (((puVar22 <= puVar11) ||
                        (((uVar1 = *puVar11, uVar1 == 0 && (iVar15 != 0)) ||
                         (*(ushort *)(lVar16 + 6) <= uVar1 && uVar1 != *(ushort *)(lVar16 + 6)))))
                       || (uVar1 < *(ushort *)(lVar16 + 4))) break;
                    puVar11 = puVar11 + 1;
                    iVar3 = iVar3 + -1;
                  } while (0 < iVar3);
                  uVar7 = (longlong)puVar11 - (longlong)puVar19 >> 1 & 0xffffffff;
                }
                if (3 < (int)uVar7) {
                  iVar15 = *(ushort *)(lVar16 + 0xc) - 1;
                  uVar8 = uVar23;
                  if ((uVar21 != 0) && (4 < (int)uVar7)) {
                    puVar19 = *(ushort **)(param_2 + 0x18);
                    lVar17 = param_1[1];
                    uVar8 = (ulonglong)*puVar19;
                    if (lVar17 != 0) {
                      uVar8 = (ulonglong)
                              (*(int *)(lVar17 + (ulonglong)(*puVar19 >> 8) * 4) +
                              (uint)*(byte *)puVar19);
                    }
                    uVar9 = (ulonglong)puVar19[1];
                    if (lVar17 != 0) {
                      uVar9 = (ulonglong)
                              (*(int *)(lVar17 + (ulonglong)(puVar19[1] >> 8) * 4) +
                              (uint)*(byte *)(puVar19 + 1));
                    }
                    uVar8 = (ulonglong)
                            (((*(uint *)(DAT_1800b2b88 + uVar9 * 4) ^
                              *(uint *)(DAT_1800b2b88 + uVar8 * 4)) & 0xe7ffffff) == 0);
                  }
                  if (-1 < iVar15) {
                    do {
                      iVar3 = (iVar15 + (int)uVar23) / 2;
                      iVar18 = 4;
                      puVar19 = (ushort *)
                                (*(longlong *)(*param_1 + 0x168) + (longlong)(iVar3 * 6) * 2);
                      lVar17 = (*(longlong *)(param_2 + 0x18) + uVar8 * 2) - (longlong)puVar19;
                      do {
                        iVar4 = (uint)*(ushort *)(lVar17 + (longlong)puVar19) - (uint)*puVar19;
                        if (iVar4 != 0) break;
                        puVar19 = puVar19 + 1;
                        iVar18 = iVar18 + -1;
                        iVar4 = 0;
                      } while (0 < iVar18);
                      if (iVar4 == 0) {
                        *(undefined4 *)(param_2 + 0x24) =
                             *(undefined4 *)
                              (*(longlong *)(*param_1 + 0x168) + 8 + (longlong)(iVar3 * 6) * 2);
                        if ((int)uVar8 != 0) goto LAB_1800362e5;
                        lVar17 = *(longlong *)(param_2 + 0x18) + 6;
                        goto LAB_1800362e1;
                      }
                      iVar18 = iVar3 + -1;
                      if (-1 < iVar4) {
                        iVar18 = iVar15;
                      }
                      iVar15 = iVar18;
                      if (-1 < iVar4) {
                        uVar23 = (ulonglong)(iVar3 + 1);
                      }
                    } while ((int)uVar23 <= iVar15);
                  }
                }
              }
            }
          }
          lVar12 = 0;
          iVar15 = (int)uVar7;
          lVar17 = *param_1;
          lVar16 = *(longlong *)(lVar17 + 0x150);
          uVar21 = *(uint *)(lVar17 + 0x140) & 0x20;
          if (*(short *)(lVar16 + 10) != 0) {
            puVar19 = *(ushort **)(param_2 + 0x18);
            puVar22 = *(ushort **)(param_2 + 8);
            if ((ushort *)((-(ulonglong)(uVar21 != 0) & 2) + 4 + (longlong)puVar19) <= puVar22) {
              if (iVar15 == 0) {
                iVar15 = *(int *)(param_2 + 0x10);
                iVar3 = (uVar21 != 0) + 3;
                puVar11 = puVar19;
                if (puVar22 == (ushort *)0x0) {
                  iVar15 = 1;
                }
                do {
                  if (((puVar22 <= puVar11) || ((uVar1 = *puVar11, uVar1 == 0 && (iVar15 != 0)))) ||
                     ((*(ushort *)(lVar16 + 6) <= uVar1 && uVar1 != *(ushort *)(lVar16 + 6) ||
                      (uVar1 < *(ushort *)(lVar16 + 4))))) break;
                  puVar11 = puVar11 + 1;
                  iVar3 = iVar3 + -1;
                } while (0 < iVar3);
                iVar15 = (int)((longlong)puVar11 - (longlong)puVar19 >> 1);
              }
              if (2 < iVar15) {
                iVar3 = 0;
                iVar18 = *(ushort *)(lVar16 + 10) - 1;
                if ((uVar21 != 0) && (3 < iVar15)) {
                  puVar19 = *(ushort **)(param_2 + 0x18);
                  lVar12 = param_1[1];
                  uVar7 = (ulonglong)*puVar19;
                  if (lVar12 != 0) {
                    uVar7 = (ulonglong)
                            (*(int *)(lVar12 + (ulonglong)(*puVar19 >> 8) * 4) +
                            (uint)*(byte *)puVar19);
                  }
                  uVar23 = (ulonglong)puVar19[1];
                  if (lVar12 != 0) {
                    uVar23 = (ulonglong)
                             (*(int *)(lVar12 + (ulonglong)(puVar19[1] >> 8) * 4) +
                             (uint)*(byte *)(puVar19 + 1));
                  }
                  lVar12 = 0;
                  if (((*(uint *)(DAT_1800b2b88 + uVar23 * 4) ^ *(uint *)(DAT_1800b2b88 + uVar7 * 4)
                       ) & 0xe7ffffff) == 0) {
                    lVar12 = 1;
                  }
                }
                if (-1 < iVar18) {
                  do {
                    iVar4 = (iVar18 + iVar3) / 2;
                    iVar5 = 3;
                    puVar19 = (ushort *)(*(longlong *)(lVar17 + 0x160) + (longlong)(iVar4 * 6) * 2);
                    lVar16 = (*(longlong *)(param_2 + 0x18) + lVar12 * 2) - (longlong)puVar19;
                    do {
                      iVar6 = (uint)*(ushort *)((longlong)puVar19 + lVar16) - (uint)*puVar19;
                      if (iVar6 != 0) goto LAB_180036094;
                      puVar19 = puVar19 + 1;
                      iVar5 = iVar5 + -1;
                    } while (0 < iVar5);
                    iVar6 = 0;
LAB_180036094:
                    if (iVar6 == 0) {
                      *(undefined4 *)(param_2 + 0x24) =
                           *(undefined4 *)
                            (*(longlong *)(lVar17 + 0x160) + 8 + (longlong)(iVar4 * 6) * 2);
                      if ((int)lVar12 != 0) goto LAB_1800362e5;
                      lVar17 = *(longlong *)(param_2 + 0x18) + 4;
                      goto LAB_1800362e1;
                    }
                    iVar5 = iVar4 + -1;
                    if (-1 < iVar6) {
                      iVar5 = iVar18;
                    }
                    iVar18 = iVar5;
                    if (-1 < iVar6) {
                      iVar3 = iVar4 + 1;
                    }
                  } while (iVar3 <= iVar18);
                  lVar16 = *(longlong *)(lVar17 + 0x150);
                }
              }
            }
          }
          uVar7 = 0;
          if (*(short *)(lVar16 + 8) != 0) {
            puVar19 = *(ushort **)(param_2 + 0x18);
            puVar22 = *(ushort **)(param_2 + 8);
            if ((ushort *)((-(ulonglong)(uVar21 != 0) & 2) + 2 + (longlong)puVar19) <= puVar22) {
              if (iVar15 == 0) {
                iVar3 = (uVar21 != 0) + 2;
                puVar11 = puVar19;
                iVar15 = *(int *)(param_2 + 0x10);
                if (puVar22 == (ushort *)0x0) {
                  iVar15 = 1;
                }
                do {
                  if (((puVar22 <= puVar11) ||
                      (((uVar1 = *puVar11, uVar1 == 0 && (iVar15 != 0)) ||
                       (*(ushort *)(lVar16 + 6) <= uVar1 && uVar1 != *(ushort *)(lVar16 + 6))))) ||
                     (uVar1 < *(ushort *)(lVar16 + 4))) break;
                  puVar11 = puVar11 + 1;
                  iVar3 = iVar3 + -1;
                } while (0 < iVar3);
                iVar15 = (int)((longlong)puVar11 - (longlong)puVar19 >> 1);
              }
              if (1 < iVar15) {
                iVar3 = *(ushort *)(lVar16 + 8) - 1;
                uVar23 = uVar7;
                if ((uVar21 != 0) && (2 < iVar15)) {
                  puVar19 = *(ushort **)(param_2 + 0x18);
                  lVar16 = param_1[1];
                  uVar23 = (ulonglong)*puVar19;
                  if (lVar16 != 0) {
                    uVar23 = (ulonglong)
                             (*(int *)(lVar16 + (ulonglong)(*puVar19 >> 8) * 4) +
                             (uint)*(byte *)puVar19);
                  }
                  uVar8 = (ulonglong)puVar19[1];
                  if (lVar16 != 0) {
                    uVar8 = (ulonglong)
                            (*(int *)(lVar16 + (ulonglong)(puVar19[1] >> 8) * 4) +
                            (uint)*(byte *)(puVar19 + 1));
                  }
                  uVar23 = (ulonglong)
                           (((*(uint *)(DAT_1800b2b88 + uVar8 * 4) ^
                             *(uint *)(DAT_1800b2b88 + uVar23 * 4)) & 0xe7ffffff) == 0);
                }
                if (-1 < iVar3) {
LAB_180036234:
                  iVar18 = 2;
                  iVar15 = (iVar3 + (int)uVar7) / 2;
                  puVar19 = (ushort *)((longlong)(iVar15 << 2) * 2 + *(longlong *)(lVar17 + 0x158));
                  lVar16 = (*(longlong *)(param_2 + 0x18) + uVar23 * 2) - (longlong)puVar19;
                  do {
                    iVar4 = (uint)*(ushort *)(lVar16 + (longlong)puVar19) - (uint)*puVar19;
                    if (iVar4 != 0) break;
                    puVar19 = puVar19 + 1;
                    iVar18 = iVar18 + -1;
                    iVar4 = 0;
                  } while (0 < iVar18);
                  if (iVar4 != 0) goto code_r0x00018003627f;
                  *(undefined4 *)(param_2 + 0x24) =
                       *(undefined4 *)
                        (*(longlong *)(lVar17 + 0x158) + 4 + (longlong)(iVar15 << 2) * 2);
                  if ((int)uVar23 == 0) {
                    lVar17 = *(longlong *)(param_2 + 0x18) + 2;
LAB_1800362e1:
                    *(longlong *)(param_2 + 0x18) = lVar17;
                  }
LAB_1800362e5:
                  puVar19 = *(ushort **)(param_2 + 0x18);
                  *(ushort **)(param_2 + 0x18) = puVar20;
                  if (puVar20 != puVar19) {
                    return;
                  }
                }
              }
            }
          }
        }
      }
      else {
        if (cVar10 == '\x06') {
          iVar15 = *(int *)((longlong)param_1 + 0x14);
        }
        else {
          if (5 < (byte)(cVar10 - 7U)) {
            return;
          }
          iVar15 = *(int *)((longlong)param_1 + 0x1c);
        }
        if (iVar15 == 0) {
          return;
        }
      }
LAB_18003629d:
      puVar20 = (ushort *)(*(longlong *)(param_2 + 0x18) + 2);
      *(ushort **)(param_2 + 0x18) = puVar20;
      puVar19 = *(ushort **)(param_2 + 8);
    } while (puVar20 < puVar19);
  }
  return;
code_r0x00018003627f:
  iVar18 = iVar15 + -1;
  if (-1 < iVar4) {
    iVar18 = iVar3;
  }
  iVar3 = iVar18;
  if (-1 < iVar4) {
    uVar7 = (ulonglong)(iVar15 + 1);
  }
  if (iVar3 < (int)uVar7) goto LAB_18003629d;
  goto LAB_180036234;
}



// WARNING: Could not reconcile some variable overlaps

BOOL SetVolumeMountPointW(LPCWSTR lpszVolumeMountPoint,LPCWSTR lpszVolumeName)

{
  undefined4 *_Dst;
  BOOL BVar1;
  DWORD DVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  BOOL extraout_EAX;
  HANDLE pvVar7;
  undefined4 *puVar8;
  undefined4 uVar9;
  longlong lVar10;
  longlong in_GS_OFFSET;
  undefined auStackY1240 [32];
  char local_498 [8];
  undefined local_490 [16];
  DWORD local_480 [2];
  undefined local_478 [16];
  WCHAR local_468 [264];
  WCHAR local_258 [264];
  ulonglong local_48;
  
                    // 0x233c0  1415  SetVolumeMountPointW
  local_48 = DAT_1800b2220 ^ (ulonglong)auStackY1240;
  local_480[0] = 0;
  local_498[0] = '\0';
  local_478 = ZEXT816(0);
  local_490 = ZEXT816(0);
  if ((lpszVolumeMountPoint == (LPCWSTR)0x0) || (lpszVolumeName == (LPCWSTR)0x0))
  goto LAB_1800237e0;
  BVar1 = GetVolumeNameForVolumeMountPointW(lpszVolumeMountPoint,local_258,0x104);
  if ((BVar1 == 0) && (DVar2 = GetLastError(), DVar2 != 0xce)) {
    iVar3 = RtlInitUnicodeStringEx(local_478,lpszVolumeMountPoint);
    if ((iVar3 < 0) || (iVar3 = RtlInitUnicodeStringEx(), iVar3 < 0)) {
LAB_180023477:
      BaseSetLastNTError();
      goto LAB_1800237f3;
    }
    if (local_478._0_2_ != 0) {
      if (local_490._0_2_ != 0) {
        if ((*(short *)((longlong)local_478._8_8_ + -2 + (ulonglong)(local_478._0_2_ >> 1) * 2) !=
             0x5c) ||
           (*(short *)((longlong)local_490._8_8_ +
                      (((ulonglong)local_490._0_2_ & 0xfffffffffffffffe) - 2)) != 0x5c))
        goto LAB_180023477;
        if (((((local_490._0_2_ == 0x60) ||
              ((local_490._0_2_ == 0x62 && (local_490._8_8_[0x30] == 0x5c)))) &&
             (*local_490._8_8_ == 0x5c)) &&
            (((((local_490._8_8_[1] == 0x3f || (local_490._8_8_[1] == 0x5c)) &&
               (local_490._8_8_[2] == 0x3f)) &&
              ((local_490._8_8_[3] == 0x5c && (local_490._8_8_[4] == 0x56)))) &&
             (local_490._8_8_[5] == 0x6f)))) &&
           (((((local_490._8_8_[6] == 0x6c && (local_490._8_8_[7] == 0x75)) &&
              ((local_490._8_8_[8] == 0x6d &&
               (((local_490._8_8_[9] == 0x65 && (local_490._8_8_[10] == 0x7b)) &&
                (local_490._8_8_[0x13] == 0x2d)))))) &&
             ((local_490._8_8_[0x18] == 0x2d && (local_490._8_8_[0x1d] == 0x2d)))) &&
            ((local_490._8_8_[0x22] == 0x2d &&
             (((local_490._8_8_[0x2f] == 0x7d && (local_490._0_2_ == 0x62)) &&
              (local_490._8_8_[1] == 0x5c)))))))) {
          iVar3 = FUN_18002393c(lpszVolumeName,local_498);
          if (iVar3 == 0) goto LAB_1800237f3;
          if (local_498[0] != '\0') {
            if (local_478._0_2_ == 6) {
              if (local_478._8_8_[1] == 0x3a) {
LAB_1800235fe:
                FUN_180023b28((ushort *)lpszVolumeMountPoint,lpszVolumeName);
                goto LAB_1800237f3;
              }
            }
            else if (((((local_478._0_2_ == 0xe) && (*local_478._8_8_ == 0x5c)) &&
                      (local_478._8_8_[1] == 0x5c)) &&
                     ((local_478._8_8_[2] == 0x2e || (local_478._8_8_[2] == 0x3f)))) &&
                    ((local_478._8_8_[3] == 0x5c && (local_478._8_8_[5] == 0x3a)))) {
              lpszVolumeMountPoint = lpszVolumeMountPoint + 4;
              goto LAB_1800235fe;
            }
            lVar10 = -1;
            pvVar7 = CreateFileW(L"\\\\.\\MountPointManager",0xc0000000,3,(LPSECURITY_ATTRIBUTES)0x0
                                 ,3,0x80,(HANDLE)0xffffffffffffffff);
            if (pvVar7 == (HANDLE)0xffffffffffffffff) goto LAB_1800237f3;
            CloseHandle(pvVar7);
            pvVar7 = CreateFileW(lpszVolumeMountPoint,0xc0000000,3,(LPSECURITY_ATTRIBUTES)0x0,3,
                                 0x2200080,(HANDLE)0xffffffffffffffff);
            if (pvVar7 == (HANDLE)0xffffffffffffffff) goto LAB_1800237f3;
            BVar1 = GetVolumePathNameW(lpszVolumeMountPoint,local_258,0x104);
            if ((BVar1 == 1) &&
               (BVar1 = GetVolumeNameForVolumeMountPointW(local_258,local_468,0x104), BVar1 == 1)) {
              do {
                lVar10 = lVar10 + 1;
              } while (local_468[lVar10] != L'\0');
              iVar3 = FUN_18007e1f0(local_468,lVar10);
              iVar4 = FUN_18007e0b4(local_468,lVar10);
              iVar5 = FUN_18007e1f0(local_490._8_8_,(ulonglong)(local_490._0_2_ >> 1));
              iVar6 = FUN_18007e0b4(local_490._8_8_,(ulonglong)(local_490._0_2_ >> 1));
              if ((iVar4 != 0) || ((iVar6 == 0 && (iVar3 != iVar5)))) {
                CloseHandle(pvVar7);
                goto LAB_1800237e0;
              }
              RtlSetLastWin32Error(0);
            }
            puVar8 = (undefined4 *)KernelBaseGetGlobalData();
            puVar8 = (undefined4 *)
                     RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                     *puVar8,0x4000);
            if (puVar8 != (undefined4 *)0x0) {
              memset(puVar8 + 1,0,0x3ffc);
              *puVar8 = 0xa0000003;
              _Dst = puVar8 + 4;
              *(undefined4 *)((longlong)puVar8 + 6) = 0;
              *(ushort *)(puVar8 + 1) = (local_490._0_2_ + 6) * 2;
              *(ushort *)((longlong)puVar8 + 10) = local_490._0_2_;
              memcpy(_Dst,local_490._8_8_,(ulonglong)local_490._0_2_);
              *(undefined2 *)((longlong)puVar8 + 0x12) = 0x3f;
              *(ushort *)(puVar8 + 3) = *(ushort *)((longlong)puVar8 + 10) + 2;
              *(ushort *)((longlong)puVar8 + 0xe) = local_490._0_2_;
              memcpy((void *)((ulonglong)*(ushort *)((longlong)puVar8 + 10) + 2 + (longlong)_Dst),
                     _Dst,(ulonglong)local_490._0_2_);
              BVar1 = DeviceIoControl(pvVar7,0x900a4,puVar8,*(ushort *)(puVar8 + 1) + 8,(LPVOID)0x0,
                                      0,local_480,(LPOVERLAPPED)0x0);
              RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar8);
              CloseHandle(pvVar7);
              if (BVar1 != 0) {
                NotifyMountMgr(lpszVolumeMountPoint,lpszVolumeName,1);
              }
              goto LAB_1800237f3;
            }
            CloseHandle(pvVar7);
            uVar9 = 8;
            goto LAB_1800237e5;
          }
        }
      }
    }
LAB_1800237e0:
    uVar9 = 0x57;
  }
  else {
    uVar9 = 0x91;
  }
LAB_1800237e5:
  RtlSetLastWin32Error(uVar9);
LAB_1800237f3:
  __security_check_cookie(local_48 ^ (ulonglong)auStackY1240);
  return extraout_EAX;
}



void FUN_18002393c(undefined8 param_1,undefined *param_2)

{
  int iVar1;
  BOOL BVar2;
  DWORD DVar3;
  undefined4 *puVar4;
  undefined (*lpInBuffer) [16];
  HANDLE hDevice;
  longlong in_GS_OFFSET;
  bool bVar5;
  undefined auStackY152 [32];
  ushort local_58;
  void *local_50;
  DWORD local_48 [2];
  undefined local_40 [4];
  int local_3c;
  ulonglong local_20;
  
  local_20 = DAT_1800b2220 ^ (ulonglong)auStackY152;
  iVar1 = RtlInitUnicodeStringEx();
  if (iVar1 < 0) {
    BaseSetLastNTError();
  }
  else {
    if (*(short *)((longlong)local_50 + (((ulonglong)local_58 & 0xfffffffffffffffe) - 2)) == 0x5c) {
      local_58 = local_58 - 2;
    }
    puVar4 = (undefined4 *)KernelBaseGetGlobalData();
    lpInBuffer = (undefined (*) [16])
                 RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),*puVar4)
    ;
    if (lpInBuffer == (undefined (*) [16])0x0) {
      RtlSetLastWin32Error(8);
    }
    else {
      *lpInBuffer = ZEXT816(0);
      *(undefined8 *)lpInBuffer[1] = 0;
      *(undefined4 *)lpInBuffer[1] = 0x18;
      *(ushort *)(lpInBuffer[1] + 4) = local_58;
      memcpy(lpInBuffer[1] + 8,local_50,(ulonglong)local_58);
      if ((3 < local_58) && (*(short *)((longlong)local_50 + 2) == 0x5c)) {
        *(undefined2 *)(*lpInBuffer + (ulonglong)*(uint *)lpInBuffer[1] + 2) = 0x3f;
      }
      hDevice = CreateFileW(L"\\\\.\\MountPointManager",0,3,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,
                            (HANDLE)0xffffffffffffffff);
      if (hDevice != (HANDLE)0xffffffffffffffff) {
        BVar2 = DeviceIoControl(hDevice,0x6d0008,lpInBuffer,local_58 + 0x18,local_40,0x20,local_48,
                                (LPOVERLAPPED)0x0);
        if (BVar2 == 0) {
          DVar3 = GetLastError();
          bVar5 = DVar3 == 0xea;
        }
        else {
          bVar5 = local_3c != 0;
        }
        *param_2 = bVar5;
        CloseHandle(hDevice);
      }
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpInBuffer);
    }
  }
  __security_check_cookie(local_20 ^ (ulonglong)auStackY152);
  return;
}



BOOL FUN_180023b28(ushort *param_1,undefined8 param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  int iVar4;
  BOOL BVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  HANDLE hDevice;
  uint uVar8;
  longlong in_GS_OFFSET;
  DWORD local_res18 [4];
  ushort local_28 [4];
  void *local_20;
  
  puVar6 = (undefined4 *)KernelBaseGetGlobalData();
  puVar6 = (undefined4 *)
           RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),*puVar6);
  BVar5 = 0;
  if (puVar6 != (undefined4 *)0x0) {
    *puVar6 = 0x44005c;
    puVar6[1] = 0x73006f;
    puVar6[2] = 0x650044;
    puVar6[3] = 0x690076;
    *(undefined8 *)(puVar6 + 4) = 0x5c007300650063;
    iVar4 = toupper((uint)*param_1);
    *(undefined4 *)((longlong)puVar6 + 0x1a) = 0x3a;
    *(short *)(puVar6 + 6) = (short)iVar4;
    RtlInitUnicodeString(local_28,param_2);
    local_28[0] = local_28[0] - 2;
    uVar8 = (uint)local_28[0];
    puVar7 = (undefined4 *)KernelBaseGetGlobalData();
    puVar7 = (undefined4 *)
             RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),*puVar7);
    if (puVar7 != (undefined4 *)0x0) {
      *(undefined2 *)(puVar7 + 1) = 0x24;
      *puVar7 = 0x1c0008;
      *(ushort *)((longlong)puVar7 + 6) = local_28[0];
      uVar1 = puVar6[1];
      uVar2 = puVar6[2];
      uVar3 = puVar6[3];
      puVar7[2] = *puVar6;
      puVar7[3] = uVar1;
      puVar7[4] = uVar2;
      puVar7[5] = uVar3;
      *(undefined8 *)(puVar7 + 6) = *(undefined8 *)(puVar6 + 4);
      puVar7[8] = puVar6[6];
      memcpy((void *)((ulonglong)*(ushort *)(puVar7 + 1) + (longlong)puVar7),local_20,
             (ulonglong)*(ushort *)((longlong)puVar7 + 6));
      *(undefined2 *)((ulonglong)*(ushort *)(puVar7 + 1) + 2 + (longlong)puVar7) = 0x3f;
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
      hDevice = CreateFileW(L"\\\\.\\MountPointManager",0xc0000000,3,(LPSECURITY_ATTRIBUTES)0x0,3,
                            0x80,(HANDLE)0xffffffffffffffff);
      if (hDevice != (HANDLE)0xffffffffffffffff) {
        BVar5 = DeviceIoControl(hDevice,0x6dc000,puVar7,uVar8 + 0x24,(LPVOID)0x0,0,local_res18,
                                (LPOVERLAPPED)0x0);
        CloseHandle(hDevice);
      }
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar7);
      return BVar5;
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar6);
  }
  RtlSetLastWin32Error(8);
  return 0;
}



DWORD SetThreadIdealProcessor(HANDLE hThread,DWORD dwIdealProcessor)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180023d40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23d40  1387  SetThreadIdealProcessor
  DVar1 = SetThreadIdealProcessor(hThread,dwIdealProcessor);
  return DVar1;
}



BOOL WritePrivateProfileSectionW(LPCWSTR lpAppName,LPCWSTR lpString,LPCWSTR lpFileName)

{
  int iVar1;
  BOOL BVar2;
  
                    // 0x23d60  1578  WritePrivateProfileSectionW
  iVar1 = BaseDllReadWriteIniFile
                    ('\x01','\x01','\x01',lpFileName,lpAppName,(short *)0x0,lpString,(int *)0x0);
  if (iVar1 < 0) {
    if (iVar1 == -0x3fffff85) {
      RtlSetLastWin32Error(0xd);
    }
    else {
      BaseSetLastNTError();
    }
    BVar2 = 0;
  }
  else {
    BVar2 = 1;
  }
  return BVar2;
}



BOOL MoveFileTransactedW(LPCWSTR lpExistingFileName,LPCWSTR lpNewFileName,
                        LPPROGRESS_ROUTINE lpProgressRoutine,LPVOID lpData,DWORD dwFlags,
                        HANDLE hTransaction)

{
  BOOL BVar1;
  longlong lVar2;
  undefined8 uVar3;
  
                    // 0x23db0  1010  MoveFileTransactedW
  if ((longlong)hTransaction - 1U < 0xfffffffffffffffe) {
    lVar2 = RtlGetCurrentTransaction();
    if (lVar2 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      BVar1 = MoveFileWithProgressTransactedW
                        (lpExistingFileName,lpNewFileName,lpProgressRoutine,lpData,dwFlags,
                         hTransaction);
      RtlSetCurrentTransaction(0);
      return BVar1;
    }
    uVar3 = 0x1a45;
  }
  else {
    uVar3 = 0x1a2c;
  }
  RtlSetLastWin32Error(uVar3);
  return 0;
}



BOOL GetProcessPreferredUILanguages
               (DWORD dwFlags,PULONG pulNumLanguages,PZZWSTR pwszLanguagesBuffer,
               PULONG pcchLanguagesBuffer)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180023e70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x23e70  710  GetProcessPreferredUILanguages
  BVar1 = GetProcessPreferredUILanguages
                    (dwFlags,pulNumLanguages,pwszLanguagesBuffer,pcchLanguagesBuffer);
  return BVar1;
}



void GetTimeFormatAWorker
               (UINT *param_1,LCID param_2,DWORD param_3,SYSTEMTIME *param_4,LPCSTR param_5,
               LPSTR param_6,int param_7)

{
  DWORD DVar1;
  undefined8 uVar2;
  WCHAR *lpTimeStr;
  WCHAR *lpFormat;
  longlong in_GS_OFFSET;
  undefined auStackY696 [32];
  int iVar3;
  WCHAR *local_278;
  int local_270 [2];
  LPSTR local_268;
  WCHAR local_258 [128];
  WCHAR local_158 [128];
  ulonglong local_58;
  
                    // 0x23e90  789  GetTimeFormatAWorker
  local_58 = DAT_1800b2220 ^ (ulonglong)auStackY696;
  local_268 = param_6;
  local_278 = local_158;
  uVar2 = FUN_18001b10c(*param_1,param_5,0xffffffff,&local_278,local_270);
  if ((int)uVar2 != 0) {
    lpTimeStr = local_258;
    iVar3 = 0x80;
    lpFormat = local_278;
    do {
      iVar3 = GetTimeFormatW(param_2,param_3,param_4,lpFormat,lpTimeStr,iVar3);
      if (((iVar3 != 0) || (DVar1 = GetLastError(), DVar1 != 0x7a)) || (lpTimeStr != local_258)) {
        if ((lpFormat != local_158) && (lpFormat != (LPCWSTR)0x0)) {
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_278);
        }
        if (0 < iVar3) {
          WideCharToMultiByte(*param_1,0,lpTimeStr,iVar3,local_268,param_7,(LPCSTR)0x0,(LPBOOL)0x0);
        }
        if ((lpTimeStr != local_258) && (lpTimeStr != (LPWSTR)0x0)) {
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpTimeStr);
        }
        goto LAB_180023fa5;
      }
      SetLastError(0);
      iVar3 = GetTimeFormatW(param_2,param_3,param_4,lpFormat,(LPWSTR)0x0,0);
    } while ((iVar3 == 0) ||
            (lpTimeStr = (WCHAR *)RtlAllocateHeap(*(undefined8 *)
                                                   (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,
                                                  (longlong)iVar3 * 2), lpFormat = local_278,
            lpTimeStr != (LPWSTR)0x0));
    if ((local_278 != local_158) && (local_278 != (WCHAR *)0x0)) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_278);
    }
    SetLastError(0xe);
  }
LAB_180023fa5:
  __security_check_cookie(local_58 ^ (ulonglong)auStackY696);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

BOOL GetVolumeNameForVolumeMountPointA
               (LPCSTR lpszVolumeMountPoint,LPSTR lpszVolumeName,DWORD cchBufferLength)

{
  ushort uVar1;
  int iVar2;
  undefined8 uVar3;
  undefined4 *puVar4;
  code *pcVar5;
  longlong in_GS_OFFSET;
  BOOL local_48;
  uint local_40 [2];
  LPWSTR local_38;
  ushort local_30;
  short local_2e;
  LPSTR local_28;
  undefined local_20 [8];
  LPCWSTR local_18;
  
                    // 0x23fd0  812  GetVolumeNameForVolumeMountPointA
  uVar3 = Basep8BitStringToDynamicUnicodeString();
  if ((int)uVar3 == 0) {
    return 0;
  }
  local_2e = (short)cchBufferLength;
  local_30 = local_2e - 1;
  local_38 = (LPWSTR)0x0;
  local_40[0] = 0;
  uVar1 = local_2e * 2;
  local_28 = lpszVolumeName;
  puVar4 = (undefined4 *)KernelBaseGetGlobalData();
  local_38 = (LPWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                     *puVar4);
  if (local_38 == (LPWSTR)0x0) {
    RtlSetLastWin32Error(8);
  }
  else {
    local_40[0] = local_40[0] & 0xffff | (uint)uVar1 << 0x10;
    local_48 = GetVolumeNameForVolumeMountPointW(local_18,local_38,cchBufferLength);
    if (local_48 == 0) goto LAB_18002410b;
    RtlInitUnicodeString(local_40,local_38);
    pcVar5 = (code *)GetUnicodeStringToEightBitStringRoutine();
    iVar2 = (*pcVar5)();
    if ((-1 < iVar2) && (local_30 < cchBufferLength)) {
      local_28[local_30] = '\0';
      goto LAB_18002410b;
    }
    BaseSetLastNTError();
  }
  local_48 = 0;
LAB_18002410b:
  if (local_38 != (LPWSTR)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_38);
  }
  RtlFreeUnicodeString(local_20);
  return local_48;
}



BOOL DeleteFileTransactedW(LPCWSTR lpFileName,HANDLE hTransaction)

{
  BOOL BVar1;
  longlong lVar2;
  undefined8 uVar3;
  
                    // 0x24170  281  DeleteFileTransactedW
  if ((longlong)hTransaction - 1U < 0xfffffffffffffffe) {
    lVar2 = RtlGetCurrentTransaction();
    if (lVar2 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      BVar1 = DeleteFileW(lpFileName);
      RtlSetCurrentTransaction(0);
      return BVar1;
    }
    uVar3 = 0x1a45;
  }
  else {
    uVar3 = 0x1a2c;
  }
  RtlSetLastWin32Error(uVar3);
  return 0;
}



BOOL SetProcessAffinityUpdateMode(HANDLE hProcess,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024200. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24200  1358  SetProcessAffinityUpdateMode
  BVar1 = SetProcessAffinityUpdateMode(hProcess,dwFlags);
  return BVar1;
}



LSTATUS RegCloseKey(HKEY hKey)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024220. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24220  1152  RegCloseKey
  LVar1 = RegCloseKey(hKey);
  return LVar1;
}



LPVOID VirtualAllocExNuma(HANDLE hProcess,LPVOID lpAddress,SIZE_T dwSize,DWORD flAllocationType,
                         DWORD flProtect,DWORD nndPreferred)

{
  LPVOID pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024240. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24240  1500  VirtualAllocExNuma
  pvVar1 = VirtualAllocExNuma(hProcess,lpAddress,dwSize,flAllocationType,flProtect,nndPreferred);
  return pvVar1;
}



BOOL BindIoCompletionCallback
               (HANDLE FileHandle,LPOVERLAPPED_COMPLETION_ROUTINE Function,ULONG Flags)

{
  int iVar1;
  
                    // 0x24260  107  BindIoCompletionCallback
  iVar1 = RtlSetIoCompletionCallback();
  if (iVar1 < 0) {
    BaseSetLastNTError();
  }
  return (uint)(iVar1 >= 0);
}



BOOL GetComputerNameExA(COMPUTER_NAME_FORMAT NameType,LPSTR lpBuffer,LPDWORD nSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024290. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24290  487  GetComputerNameExA
  BVar1 = GetComputerNameExA(NameType,lpBuffer,nSize);
  return BVar1;
}



BOOL ReadDirectoryChangesW
               (HANDLE hDirectory,LPVOID lpBuffer,DWORD nBufferLength,BOOL bWatchSubtree,
               DWORD dwNotifyFilter,LPDWORD lpBytesReturned,LPOVERLAPPED lpOverlapped,
               LPOVERLAPPED_COMPLETION_ROUTINE lpCompletionRoutine)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800242b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x242b0  1145  ReadDirectoryChangesW
  BVar1 = ReadDirectoryChangesW
                    (hDirectory,lpBuffer,nBufferLength,bWatchSubtree,dwNotifyFilter,lpBytesReturned,
                     lpOverlapped,lpCompletionRoutine);
  return BVar1;
}



void OutputDebugStringA(LPCSTR lpOutputString)

{
                    // WARNING: Could not recover jumptable at 0x0001800242d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x242d0  1054  OutputDebugStringA
  OutputDebugStringA(lpOutputString);
  return;
}



void K32GetModuleFileNameExW(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800242f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x242f0  939  K32GetModuleFileNameExW
  K32GetModuleFileNameExW();
  return;
}



void DelayLoadFailureHook(void)

{
                    // WARNING: Could not recover jumptable at 0x000180024310. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24310  274  DelayLoadFailureHook
  DelayLoadFailureHook();
  return;
}



LANGID GetThreadUILanguage(void)

{
  LANGID LVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024330. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24330  785  GetThreadUILanguage
  LVar1 = GetThreadUILanguage();
  return LVar1;
}



BOOL VirtualLock(LPVOID lpAddress,SIZE_T dwSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024350. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24350  1503  VirtualLock
  BVar1 = VirtualLock(lpAddress,dwSize);
  return BVar1;
}



// Library Function - Single Match
//  __security_check_cookie
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void __security_check_cookie(uintptr_t _StackCookie)

{
  if ((_StackCookie == DAT_1800b2220) && ((short)(_StackCookie >> 0x30) == 0)) {
    return;
  }
  __report_gsfailure(_StackCookie);
  return;
}



// Library Function - Single Match
//  _DllMainCRTStartupForGS2
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

undefined8 _DllMainCRTStartupForGS2(undefined8 param_1,int param_2)

{
  if (param_2 == 1) {
    __security_init_cookie();
  }
  return 1;
}



// Library Function - Single Match
//  __raise_securityfailure
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void __raise_securityfailure(void)

{
  RtlUnhandledExceptionFilter();
  NtTerminateProcess(0xffffffffffffffff,0xc0000409);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __report_gsfailure
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __report_gsfailure(uintptr_t _StackCookie)

{
  DWORD64 ControlPc;
  PRUNTIME_FUNCTION FunctionEntry;
  DWORD64 in_stack_00000000;
  uintptr_t local_res8 [4];
  DWORD64 local_38;
  ulonglong local_30;
  PVOID local_28;
  undefined8 uStack32;
  undefined8 uStack24;
  
  local_res8[0] = _StackCookie;
  RtlCaptureContext(&DAT_1800b2500);
  ControlPc = DAT_1800b25f8;
  FunctionEntry = RtlLookupFunctionEntry(DAT_1800b25f8,&local_38,(PUNWIND_HISTORY_TABLE)0x0);
  if (FunctionEntry == (PRUNTIME_FUNCTION)0x0) {
    _DAT_1800b2598 = local_res8;
    DAT_1800b25f8 = in_stack_00000000;
  }
  else {
    RtlVirtualUnwind(0,local_38,ControlPc,FunctionEntry,(PCONTEXT)&DAT_1800b2500,&local_28,&local_30
                     ,(PKNONVOLATILE_CONTEXT_POINTERS)0x0);
  }
  _DAT_1800b2470 = DAT_1800b25f8;
  _DAT_1800b2580 = local_res8[0];
  _DAT_1800b2460 = 0xc0000409;
  _DAT_1800b2464 = 1;
  _DAT_1800b2478 = 1;
  DAT_1800b2480 = 2;
  uStack32 = DAT_1800b2220;
  uStack24 = DAT_1800b2228;
  RtlUnhandledExceptionFilter(&PTR_DAT_18007f660);
  NtTerminateProcess(0xffffffffffffffff,0xc0000409);
  return;
}



// Library Function - Single Match
//  __report_rangecheckfailure
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __report_rangecheckfailure(void)

{
  __report_securityfailure(8);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __report_securityfailure
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __report_securityfailure(uint param_1)

{
  undefined8 uVar1;
  undefined8 in_stack_00000000;
  uint local_res8 [8];
  
  uVar1 = in_stack_00000000;
  local_res8[0] = param_1;
  RtlCaptureContext(&DAT_1800b2500);
  _DAT_1800b2470 = uVar1;
  _DAT_1800b2598 = local_res8;
  _DAT_1800b2460 = 0xc0000409;
  _DAT_1800b2464 = 1;
  _DAT_1800b2478 = 1;
  DAT_1800b2480 = (ulonglong)local_res8[0];
  DAT_1800b25f8 = _DAT_1800b2470;
  __raise_securityfailure();
  return;
}



// Library Function - Single Match
//  __security_init_cookie
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void __security_init_cookie(void)

{
  if ((DAT_1800b2220 == 0) || (DAT_1800b2220 == 0x2b992ddfa232)) {
    __security_init_cookie_ex(&DAT_1800b2220);
  }
  DAT_1800b2228 = ~DAT_1800b2220;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __security_init_cookie_ex
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void __security_init_cookie_ex(ulonglong *param_1)

{
  *param_1 = (_DAT_7ffe0320 * (ulonglong)_DAT_7ffe0004 >> 0x18 & 0xffffffff ^ (ulonglong)param_1) &
             0xffffffffffff;
  if ((*param_1 == 0) || (*param_1 == 0x2b992ddfa232)) {
    *param_1 = 0x2b992ddfa233;
  }
  return;
}



void RtlCaptureContext(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800246c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x246c0  1238  RtlCaptureContext
  RtlCaptureContext();
  return;
}



PRUNTIME_FUNCTION
RtlLookupFunctionEntry(DWORD64 ControlPc,PDWORD64 ImageBase,PUNWIND_HISTORY_TABLE HistoryTable)

{
  PRUNTIME_FUNCTION p_Var1;
  
                    // WARNING: Could not recover jumptable at 0x0001800246cc. Too many branches
                    // WARNING: Treating indirect jump as call
  p_Var1 = RtlLookupFunctionEntry(ControlPc,ImageBase,HistoryTable);
  return p_Var1;
}



PEXCEPTION_ROUTINE
RtlVirtualUnwind(DWORD HandlerType,DWORD64 ImageBase,DWORD64 ControlPc,
                PRUNTIME_FUNCTION FunctionEntry,PCONTEXT ContextRecord,PVOID *HandlerData,
                PDWORD64 EstablisherFrame,PKNONVOLATILE_CONTEXT_POINTERS ContextPointers)

{
  PEXCEPTION_ROUTINE puVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800246d8. Too many branches
                    // WARNING: Treating indirect jump as call
  puVar1 = RtlVirtualUnwind(HandlerType,ImageBase,ControlPc,FunctionEntry,ContextRecord,HandlerData,
                            EstablisherFrame,ContextPointers);
  return puVar1;
}



void * RtlMoveMemory(void *_Dst,void *_Src,size_t _Size)

{
  void *pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800246f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x246f0  1246  RtlMoveMemory
  pvVar1 = memmove(_Dst,_Src,_Size);
  return pvVar1;
}



// WARNING: Unknown calling convention yet parameter storage is locked

EXCEPTION_DISPOSITION
__C_specific_handler
          (_EXCEPTION_RECORD *ExceptionRecord,void *EstablisherFrame,_CONTEXT *ContextRecord,
          _DISPATCHER_CONTEXT *DispatcherContext)

{
  EXCEPTION_DISPOSITION EVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800246fc. Too many branches
                    // WARNING: Treating indirect jump as call
  EVar1 = __C_specific_handler(ExceptionRecord,EstablisherFrame,ContextRecord,DispatcherContext);
  return EVar1;
}



int _wcsicmp(wchar_t *_Str1,wchar_t *_Str2)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024708. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = _wcsicmp(_Str1,_Str2);
  return iVar1;
}



void RtlAllocateHeap(void)

{
                    // WARNING: Could not recover jumptable at 0x000180024714. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlAllocateHeap();
  return;
}



void RtlFreeHeap(void)

{
                    // WARNING: Could not recover jumptable at 0x000180024720. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlFreeHeap();
  return;
}



void NtSetInformationFile(void)

{
                    // WARNING: Could not recover jumptable at 0x00018002472c. Too many branches
                    // WARNING: Treating indirect jump as call
  NtSetInformationFile();
  return;
}



void NtQueryInformationFile(void)

{
                    // WARNING: Could not recover jumptable at 0x000180024738. Too many branches
                    // WARNING: Treating indirect jump as call
  NtQueryInformationFile();
  return;
}



void NtClose(void)

{
                    // WARNING: Could not recover jumptable at 0x000180024744. Too many branches
                    // WARNING: Treating indirect jump as call
  NtClose();
  return;
}



void NtOpenFile(void)

{
                    // WARNING: Could not recover jumptable at 0x000180024750. Too many branches
                    // WARNING: Treating indirect jump as call
  NtOpenFile();
  return;
}



void NtWaitForSingleObject(void)

{
                    // WARNING: Could not recover jumptable at 0x00018002475c. Too many branches
                    // WARNING: Treating indirect jump as call
  NtWaitForSingleObject();
  return;
}



void NtOpenKey(void)

{
                    // WARNING: Could not recover jumptable at 0x000180024768. Too many branches
                    // WARNING: Treating indirect jump as call
  NtOpenKey();
  return;
}



void NtQueryValueKey(void)

{
                    // WARNING: Could not recover jumptable at 0x000180024774. Too many branches
                    // WARNING: Treating indirect jump as call
  NtQueryValueKey();
  return;
}



void RtlAppendUnicodeToString(void)

{
                    // WARNING: Could not recover jumptable at 0x000180024780. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlAppendUnicodeToString();
  return;
}



void RtlInitUnicodeStringEx(void)

{
                    // WARNING: Could not recover jumptable at 0x00018002478c. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlInitUnicodeStringEx();
  return;
}



int _wcsnicmp(wchar_t *_Str1,wchar_t *_Str2,size_t _MaxCount)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024798. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = _wcsnicmp(_Str1,_Str2,_MaxCount);
  return iVar1;
}



wchar_t * wcsrchr(wchar_t *_Str,wchar_t _Ch)

{
  wchar_t *pwVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800247a4. Too many branches
                    // WARNING: Treating indirect jump as call
  pwVar1 = wcsrchr(_Str,_Ch);
  return pwVar1;
}



void RtlCreateEnvironmentEx(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800247b0. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlCreateEnvironmentEx();
  return;
}



void RtlDestroyEnvironment(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800247bc. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlDestroyEnvironment();
  return;
}



void DbgPrintEx(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800247d4. Too many branches
                    // WARNING: Treating indirect jump as call
  DbgPrintEx();
  return;
}



void RtlpEnsureBufferSize(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800247e0. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlpEnsureBufferSize();
  return;
}



void RtlDoesFileExists_U(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800247ec. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlDoesFileExists_U();
  return;
}



void NtCreateSection(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800247f8. Too many branches
                    // WARNING: Treating indirect jump as call
  NtCreateSection();
  return;
}



void NtMapViewOfSection(void)

{
                    // WARNING: Could not recover jumptable at 0x000180024804. Too many branches
                    // WARNING: Treating indirect jump as call
  NtMapViewOfSection();
  return;
}



void RtlNtStatusToDosErrorNoTeb(void)

{
                    // WARNING: Could not recover jumptable at 0x000180024810. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlNtStatusToDosErrorNoTeb();
  return;
}



int wcsncmp(wchar_t *_Str1,wchar_t *_Str2,size_t _MaxCount)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018002481c. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = wcsncmp(_Str1,_Str2,_MaxCount);
  return iVar1;
}



void NtTerminateProcess(void)

{
                    // WARNING: Could not recover jumptable at 0x000180024828. Too many branches
                    // WARNING: Treating indirect jump as call
  NtTerminateProcess();
  return;
}



void RtlUnhandledExceptionFilter(void)

{
                    // WARNING: Could not recover jumptable at 0x000180024834. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlUnhandledExceptionFilter();
  return;
}



void RtlSizeHeap(void)

{
                    // WARNING: Could not recover jumptable at 0x000180024840. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlSizeHeap();
  return;
}



void BaseFormatObjectAttributes(void)

{
                    // WARNING: Could not recover jumptable at 0x000180024860. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24860  56  BaseFormatObjectAttributes
  BaseFormatObjectAttributes();
  return;
}



BOOL GetVolumeNameForVolumeMountPointW
               (LPCWSTR lpszVolumeMountPoint,LPWSTR lpszVolumeName,DWORD cchBufferLength)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024870. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24870  813  GetVolumeNameForVolumeMountPointW
  BVar1 = GetVolumeNameForVolumeMountPointW(lpszVolumeMountPoint,lpszVolumeName,cchBufferLength);
  return BVar1;
}



HANDLE GetCurrentProcess(void)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024880. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24880  545  GetCurrentProcess
  pvVar1 = GetCurrentProcess();
  return pvVar1;
}



DWORD GetCurrentProcessId(void)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024890. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24890  546  GetCurrentProcessId
  DVar1 = GetCurrentProcessId();
  return DVar1;
}



void GetProcessInformation(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800248a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x248a0  707  GetProcessInformation
  GetProcessInformation();
  return;
}



void GetThreadInformation(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800248b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x248b0  777  GetThreadInformation
  GetThreadInformation();
  return;
}



void SetProcessInformation(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800248c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x248c0  1363  SetProcessInformation
  SetProcessInformation();
  return;
}



void SetThreadInformation(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800248d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x248d0  1389  SetThreadInformation
  SetThreadInformation();
  return;
}



BOOL CloseHandle(HANDLE hObject)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800248e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x248e0  138  CloseHandle
  BVar1 = CloseHandle(hObject);
  return BVar1;
}



BOOL DuplicateHandle(HANDLE hSourceProcessHandle,HANDLE hSourceHandle,HANDLE hTargetProcessHandle,
                    LPHANDLE lpTargetHandle,DWORD dwDesiredAccess,BOOL bInheritHandle,
                    DWORD dwOptions)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800248f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x248f0  307  DuplicateHandle
  BVar1 = DuplicateHandle(hSourceProcessHandle,hSourceHandle,hTargetProcessHandle,lpTargetHandle,
                          dwDesiredAccess,bInheritHandle,dwOptions);
  return BVar1;
}



BOOL GetHandleInformation(HANDLE hObject,LPDWORD lpdwFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024900. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24900  616  GetHandleInformation
  BVar1 = GetHandleInformation(hObject,lpdwFlags);
  return BVar1;
}



BOOL SetHandleInformation(HANDLE hObject,DWORD dwMask,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024910. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24910  1342  SetHandleInformation
  BVar1 = SetHandleInformation(hObject,dwMask,dwFlags);
  return BVar1;
}



BOOL CancelWaitableTimer(HANDLE hTimer)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024920. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24920  121  CancelWaitableTimer
  BVar1 = CancelWaitableTimer(hTimer);
  return BVar1;
}



HANDLE CreateEventA(LPSECURITY_ATTRIBUTES lpEventAttributes,BOOL bManualReset,BOOL bInitialState,
                   LPCSTR lpName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024930. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24930  192  CreateEventA
  pvVar1 = CreateEventA(lpEventAttributes,bManualReset,bInitialState,lpName);
  return pvVar1;
}



HANDLE CreateEventExA(LPSECURITY_ATTRIBUTES lpEventAttributes,LPCSTR lpName,DWORD dwFlags,
                     DWORD dwDesiredAccess)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024940. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24940  193  CreateEventExA
  pvVar1 = CreateEventExA(lpEventAttributes,lpName,dwFlags,dwDesiredAccess);
  return pvVar1;
}



HANDLE CreateEventExW(LPSECURITY_ATTRIBUTES lpEventAttributes,LPCWSTR lpName,DWORD dwFlags,
                     DWORD dwDesiredAccess)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024950. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24950  194  CreateEventExW
  pvVar1 = CreateEventExW(lpEventAttributes,lpName,dwFlags,dwDesiredAccess);
  return pvVar1;
}



HANDLE CreateEventW(LPSECURITY_ATTRIBUTES lpEventAttributes,BOOL bManualReset,BOOL bInitialState,
                   LPCWSTR lpName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024960. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24960  195  CreateEventW
  pvVar1 = CreateEventW(lpEventAttributes,bManualReset,bInitialState,lpName);
  return pvVar1;
}



HANDLE CreateMutexA(LPSECURITY_ATTRIBUTES lpMutexAttributes,BOOL bInitialOwner,LPCSTR lpName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024970. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24970  219  CreateMutexA
  pvVar1 = CreateMutexA(lpMutexAttributes,bInitialOwner,lpName);
  return pvVar1;
}



HANDLE CreateMutexExA(LPSECURITY_ATTRIBUTES lpMutexAttributes,LPCSTR lpName,DWORD dwFlags,
                     DWORD dwDesiredAccess)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024980. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24980  220  CreateMutexExA
  pvVar1 = CreateMutexExA(lpMutexAttributes,lpName,dwFlags,dwDesiredAccess);
  return pvVar1;
}



HANDLE CreateMutexExW(LPSECURITY_ATTRIBUTES lpMutexAttributes,LPCWSTR lpName,DWORD dwFlags,
                     DWORD dwDesiredAccess)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024990. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24990  221  CreateMutexExW
  pvVar1 = CreateMutexExW(lpMutexAttributes,lpName,dwFlags,dwDesiredAccess);
  return pvVar1;
}



HANDLE CreateMutexW(LPSECURITY_ATTRIBUTES lpMutexAttributes,BOOL bInitialOwner,LPCWSTR lpName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800249a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x249a0  222  CreateMutexW
  pvVar1 = CreateMutexW(lpMutexAttributes,bInitialOwner,lpName);
  return pvVar1;
}



HANDLE CreateSemaphoreExW(LPSECURITY_ATTRIBUTES lpSemaphoreAttributes,LONG lInitialCount,
                         LONG lMaximumCount,LPCWSTR lpName,DWORD dwFlags,DWORD dwDesiredAccess)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800249b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x249b0  239  CreateSemaphoreExW
  pvVar1 = CreateSemaphoreExW(lpSemaphoreAttributes,lInitialCount,lMaximumCount,lpName,dwFlags,
                              dwDesiredAccess);
  return pvVar1;
}



HANDLE CreateSemaphoreW(LPSECURITY_ATTRIBUTES lpSemaphoreAttributes,LONG lInitialCount,
                       LONG lMaximumCount,LPCWSTR lpName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800249c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x249c0  240  CreateSemaphoreW
  pvVar1 = CreateSemaphoreW(lpSemaphoreAttributes,lInitialCount,lMaximumCount,lpName);
  return pvVar1;
}



HANDLE CreateWaitableTimerExW
                 (LPSECURITY_ATTRIBUTES lpTimerAttributes,LPCWSTR lpTimerName,DWORD dwFlags,
                 DWORD dwDesiredAccess)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800249d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x249d0  260  CreateWaitableTimerExW
  pvVar1 = CreateWaitableTimerExW(lpTimerAttributes,lpTimerName,dwFlags,dwDesiredAccess);
  return pvVar1;
}



BOOL InitializeCriticalSectionAndSpinCount(LPCRITICAL_SECTION lpCriticalSection,DWORD dwSpinCount)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800249e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x249e0  876  InitializeCriticalSectionAndSpinCount
  BVar1 = InitializeCriticalSectionAndSpinCount(lpCriticalSection,dwSpinCount);
  return BVar1;
}



BOOL InitializeCriticalSectionEx(LPCRITICAL_SECTION lpCriticalSection,DWORD dwSpinCount,DWORD Flags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800249f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x249f0  877  InitializeCriticalSectionEx
  BVar1 = InitializeCriticalSectionEx(lpCriticalSection,dwSpinCount,Flags);
  return BVar1;
}



HANDLE OpenEventA(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCSTR lpName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024a00. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24a00  1030  OpenEventA
  pvVar1 = OpenEventA(dwDesiredAccess,bInheritHandle,lpName);
  return pvVar1;
}



HANDLE OpenEventW(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCWSTR lpName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024a10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24a10  1031  OpenEventW
  pvVar1 = OpenEventW(dwDesiredAccess,bInheritHandle,lpName);
  return pvVar1;
}



HANDLE OpenMutexW(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCWSTR lpName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024a20. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24a20  1039  OpenMutexW
  pvVar1 = OpenMutexW(dwDesiredAccess,bInheritHandle,lpName);
  return pvVar1;
}



HANDLE OpenSemaphoreW(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCWSTR lpName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024a30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24a30  1047  OpenSemaphoreW
  pvVar1 = OpenSemaphoreW(dwDesiredAccess,bInheritHandle,lpName);
  return pvVar1;
}



HANDLE OpenWaitableTimerW(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCWSTR lpTimerName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024a40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24a40  1053  OpenWaitableTimerW
  pvVar1 = OpenWaitableTimerW(dwDesiredAccess,bInheritHandle,lpTimerName);
  return pvVar1;
}



BOOL ReleaseMutex(HANDLE hMutex)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024a50. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24a50  1207  ReleaseMutex
  BVar1 = ReleaseMutex(hMutex);
  return BVar1;
}



BOOL ReleaseSemaphore(HANDLE hSemaphore,LONG lReleaseCount,LPLONG lpPreviousCount)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024a60. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24a60  1211  ReleaseSemaphore
  BVar1 = ReleaseSemaphore(hSemaphore,lReleaseCount,lpPreviousCount);
  return BVar1;
}



BOOL ResetEvent(HANDLE hEvent)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024a70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24a70  1229  ResetEvent
  BVar1 = ResetEvent(hEvent);
  return BVar1;
}



BOOL SetEvent(HANDLE hEvent)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024a80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24a80  1319  SetEvent
  BVar1 = SetEvent(hEvent);
  return BVar1;
}



BOOL SetWaitableTimer(HANDLE hTimer,LARGE_INTEGER *lpDueTime,LONG lPeriod,
                     PTIMERAPCROUTINE pfnCompletionRoutine,LPVOID lpArgToCompletionRoutine,
                     BOOL fResume)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024a90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24a90  1417  SetWaitableTimer
  BVar1 = SetWaitableTimer(hTimer,lpDueTime,lPeriod,pfnCompletionRoutine,lpArgToCompletionRoutine,
                           fResume);
  return BVar1;
}



DWORD SleepEx(DWORD dwMilliseconds,BOOL bAlertable)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024aa0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24aa0  1427  SleepEx
  DVar1 = SleepEx(dwMilliseconds,bAlertable);
  return DVar1;
}



DWORD WaitForMultipleObjects(DWORD nCount,HANDLE *lpHandles,BOOL bWaitAll,DWORD dwMilliseconds)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024ab0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24ab0  1513  WaitForMultipleObjects
  DVar1 = WaitForMultipleObjects(nCount,lpHandles,bWaitAll,dwMilliseconds);
  return DVar1;
}



DWORD WaitForMultipleObjectsEx
                (DWORD nCount,HANDLE *lpHandles,BOOL bWaitAll,DWORD dwMilliseconds,BOOL bAlertable)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024ac0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24ac0  1514  WaitForMultipleObjectsEx
  DVar1 = WaitForMultipleObjectsEx(nCount,lpHandles,bWaitAll,dwMilliseconds,bAlertable);
  return DVar1;
}



DWORD WaitForSingleObject(HANDLE hHandle,DWORD dwMilliseconds)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024ad0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24ad0  1515  WaitForSingleObject
  DVar1 = WaitForSingleObject(hHandle,dwMilliseconds);
  return DVar1;
}



DWORD WaitForSingleObjectEx(HANDLE hHandle,DWORD dwMilliseconds,BOOL bAlertable)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024ae0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24ae0  1516  WaitForSingleObjectEx
  DVar1 = WaitForSingleObjectEx(hHandle,dwMilliseconds,bAlertable);
  return DVar1;
}



void EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)

{
                    // WARNING: Could not recover jumptable at 0x000180024aec. Too many branches
                    // WARNING: Treating indirect jump as call
  EnterCriticalSection(lpCriticalSection);
  return;
}



void LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)

{
                    // WARNING: Could not recover jumptable at 0x000180024af8. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection(lpCriticalSection);
  return;
}



LONG CompareFileTime(FILETIME *lpFileTime1,FILETIME *lpFileTime2)

{
  LONG LVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024b10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24b10  155  CompareFileTime
  LVar1 = CompareFileTime(lpFileTime1,lpFileTime2);
  return LVar1;
}



BOOL CreateDirectoryA(LPCSTR lpPathName,LPSECURITY_ATTRIBUTES lpSecurityAttributes)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024b20. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24b20  185  CreateDirectoryA
  BVar1 = CreateDirectoryA(lpPathName,lpSecurityAttributes);
  return BVar1;
}



BOOL CreateDirectoryW(LPCWSTR lpPathName,LPSECURITY_ATTRIBUTES lpSecurityAttributes)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024b30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24b30  190  CreateDirectoryW
  BVar1 = CreateDirectoryW(lpPathName,lpSecurityAttributes);
  return BVar1;
}



void CreateFile2(void)

{
                    // WARNING: Could not recover jumptable at 0x000180024b40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24b40  198  CreateFile2
  CreateFile2();
  return;
}



HANDLE CreateFileA(LPCSTR lpFileName,DWORD dwDesiredAccess,DWORD dwShareMode,
                  LPSECURITY_ATTRIBUTES lpSecurityAttributes,DWORD dwCreationDisposition,
                  DWORD dwFlagsAndAttributes,HANDLE hTemplateFile)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024b50. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24b50  199  CreateFileA
  pvVar1 = CreateFileA(lpFileName,dwDesiredAccess,dwShareMode,lpSecurityAttributes,
                       dwCreationDisposition,dwFlagsAndAttributes,hTemplateFile);
  return pvVar1;
}



HANDLE CreateFileW(LPCWSTR lpFileName,DWORD dwDesiredAccess,DWORD dwShareMode,
                  LPSECURITY_ATTRIBUTES lpSecurityAttributes,DWORD dwCreationDisposition,
                  DWORD dwFlagsAndAttributes,HANDLE hTemplateFile)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024b60. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24b60  207  CreateFileW
  pvVar1 = CreateFileW(lpFileName,dwDesiredAccess,dwShareMode,lpSecurityAttributes,
                       dwCreationDisposition,dwFlagsAndAttributes,hTemplateFile);
  return pvVar1;
}



BOOL DefineDosDeviceW(DWORD dwFlags,LPCWSTR lpDeviceName,LPCWSTR lpTargetPath)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024b70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24b70  273  DefineDosDeviceW
  BVar1 = DefineDosDeviceW(dwFlags,lpDeviceName,lpTargetPath);
  return BVar1;
}



BOOL DeleteFileA(LPCSTR lpFileName)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024b80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24b80  279  DeleteFileA
  BVar1 = DeleteFileA(lpFileName);
  return BVar1;
}



BOOL DeleteFileW(LPCWSTR lpFileName)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024b90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24b90  282  DeleteFileW
  BVar1 = DeleteFileW(lpFileName);
  return BVar1;
}



BOOL DeleteVolumeMountPointW(LPCWSTR lpszVolumeMountPoint)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024ba0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24ba0  291  DeleteVolumeMountPointW
  BVar1 = DeleteVolumeMountPointW(lpszVolumeMountPoint);
  return BVar1;
}



BOOL FileTimeToLocalFileTime(FILETIME *lpFileTime,LPFILETIME lpLocalFileTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024bb0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24bb0  371  FileTimeToLocalFileTime
  BVar1 = FileTimeToLocalFileTime(lpFileTime,lpLocalFileTime);
  return BVar1;
}



BOOL FindClose(HANDLE hFindFile)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024bc0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24bc0  383  FindClose
  BVar1 = FindClose(hFindFile);
  return BVar1;
}



BOOL FindCloseChangeNotification(HANDLE hChangeHandle)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024bd0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24bd0  384  FindCloseChangeNotification
  BVar1 = FindCloseChangeNotification(hChangeHandle);
  return BVar1;
}



HANDLE FindFirstChangeNotificationA(LPCSTR lpPathName,BOOL bWatchSubtree,DWORD dwNotifyFilter)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024be0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24be0  385  FindFirstChangeNotificationA
  pvVar1 = FindFirstChangeNotificationA(lpPathName,bWatchSubtree,dwNotifyFilter);
  return pvVar1;
}



HANDLE FindFirstChangeNotificationW(LPCWSTR lpPathName,BOOL bWatchSubtree,DWORD dwNotifyFilter)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024bf0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24bf0  386  FindFirstChangeNotificationW
  pvVar1 = FindFirstChangeNotificationW(lpPathName,bWatchSubtree,dwNotifyFilter);
  return pvVar1;
}



HANDLE FindFirstFileA(LPCSTR lpFileName,LPWIN32_FIND_DATAA lpFindFileData)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024c00. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24c00  387  FindFirstFileA
  pvVar1 = FindFirstFileA(lpFileName,lpFindFileData);
  return pvVar1;
}



HANDLE FindFirstFileExA(LPCSTR lpFileName,FINDEX_INFO_LEVELS fInfoLevelId,LPVOID lpFindFileData,
                       FINDEX_SEARCH_OPS fSearchOp,LPVOID lpSearchFilter,DWORD dwAdditionalFlags)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024c10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24c10  388  FindFirstFileExA
  pvVar1 = FindFirstFileExA(lpFileName,fInfoLevelId,lpFindFileData,fSearchOp,lpSearchFilter,
                            dwAdditionalFlags);
  return pvVar1;
}



HANDLE FindFirstFileExW(LPCWSTR lpFileName,FINDEX_INFO_LEVELS fInfoLevelId,LPVOID lpFindFileData,
                       FINDEX_SEARCH_OPS fSearchOp,LPVOID lpSearchFilter,DWORD dwAdditionalFlags)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024c20. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24c20  389  FindFirstFileExW
  pvVar1 = FindFirstFileExW(lpFileName,fInfoLevelId,lpFindFileData,fSearchOp,lpSearchFilter,
                            dwAdditionalFlags);
  return pvVar1;
}



HANDLE FindFirstFileNameW(LPCWSTR lpFileName,DWORD dwFlags,LPDWORD StringLength,PWCHAR LinkName)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024c30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24c30  391  FindFirstFileNameW
  pvVar1 = FindFirstFileNameW(lpFileName,dwFlags,StringLength,LinkName);
  return pvVar1;
}



HANDLE FindFirstFileW(LPCWSTR lpFileName,LPWIN32_FIND_DATAW lpFindFileData)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024c40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24c40  394  FindFirstFileW
  pvVar1 = FindFirstFileW(lpFileName,lpFindFileData);
  return pvVar1;
}



HANDLE FindFirstVolumeW(LPWSTR lpszVolumeName,DWORD cchBufferLength)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024c50. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24c50  400  FindFirstVolumeW
  pvVar1 = FindFirstVolumeW(lpszVolumeName,cchBufferLength);
  return pvVar1;
}



BOOL FindNextChangeNotification(HANDLE hChangeHandle)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024c60. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24c60  403  FindNextChangeNotification
  BVar1 = FindNextChangeNotification(hChangeHandle);
  return BVar1;
}



BOOL FindNextFileA(HANDLE hFindFile,LPWIN32_FIND_DATAA lpFindFileData)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024c70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24c70  404  FindNextFileA
  BVar1 = FindNextFileA(hFindFile,lpFindFileData);
  return BVar1;
}



BOOL FindNextFileNameW(HANDLE hFindStream,LPDWORD StringLength,PWCHAR LinkName)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024c80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24c80  405  FindNextFileNameW
  BVar1 = FindNextFileNameW(hFindStream,StringLength,LinkName);
  return BVar1;
}



BOOL FindNextFileW(HANDLE hFindFile,LPWIN32_FIND_DATAW lpFindFileData)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024c90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24c90  406  FindNextFileW
  BVar1 = FindNextFileW(hFindFile,lpFindFileData);
  return BVar1;
}



BOOL FindNextVolumeW(HANDLE hFindVolume,LPWSTR lpszVolumeName,DWORD cchBufferLength)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024ca0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24ca0  411  FindNextVolumeW
  BVar1 = FindNextVolumeW(hFindVolume,lpszVolumeName,cchBufferLength);
  return BVar1;
}



BOOL FindVolumeClose(HANDLE hFindVolume)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024cb0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24cb0  418  FindVolumeClose
  BVar1 = FindVolumeClose(hFindVolume);
  return BVar1;
}



BOOL FlushFileBuffers(HANDLE hFile)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024cc0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24cc0  425  FlushFileBuffers
  BVar1 = FlushFileBuffers(hFile);
  return BVar1;
}



BOOL GetDiskFreeSpaceA(LPCSTR lpRootPathName,LPDWORD lpSectorsPerCluster,LPDWORD lpBytesPerSector,
                      LPDWORD lpNumberOfFreeClusters,LPDWORD lpTotalNumberOfClusters)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024cd0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24cd0  561  GetDiskFreeSpaceA
  BVar1 = GetDiskFreeSpaceA(lpRootPathName,lpSectorsPerCluster,lpBytesPerSector,
                            lpNumberOfFreeClusters,lpTotalNumberOfClusters);
  return BVar1;
}



BOOL GetDiskFreeSpaceExA(LPCSTR lpDirectoryName,PULARGE_INTEGER lpFreeBytesAvailableToCaller,
                        PULARGE_INTEGER lpTotalNumberOfBytes,
                        PULARGE_INTEGER lpTotalNumberOfFreeBytes)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024ce0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24ce0  562  GetDiskFreeSpaceExA
  BVar1 = GetDiskFreeSpaceExA(lpDirectoryName,lpFreeBytesAvailableToCaller,lpTotalNumberOfBytes,
                              lpTotalNumberOfFreeBytes);
  return BVar1;
}



BOOL GetDiskFreeSpaceExW(LPCWSTR lpDirectoryName,PULARGE_INTEGER lpFreeBytesAvailableToCaller,
                        PULARGE_INTEGER lpTotalNumberOfBytes,
                        PULARGE_INTEGER lpTotalNumberOfFreeBytes)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024cf0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24cf0  563  GetDiskFreeSpaceExW
  BVar1 = GetDiskFreeSpaceExW(lpDirectoryName,lpFreeBytesAvailableToCaller,lpTotalNumberOfBytes,
                              lpTotalNumberOfFreeBytes);
  return BVar1;
}



BOOL GetDiskFreeSpaceW(LPCWSTR lpRootPathName,LPDWORD lpSectorsPerCluster,LPDWORD lpBytesPerSector,
                      LPDWORD lpNumberOfFreeClusters,LPDWORD lpTotalNumberOfClusters)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024d00. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24d00  564  GetDiskFreeSpaceW
  BVar1 = GetDiskFreeSpaceW(lpRootPathName,lpSectorsPerCluster,lpBytesPerSector,
                            lpNumberOfFreeClusters,lpTotalNumberOfClusters);
  return BVar1;
}



UINT GetDriveTypeA(LPCSTR lpRootPathName)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024d10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24d10  569  GetDriveTypeA
  UVar1 = GetDriveTypeA(lpRootPathName);
  return UVar1;
}



UINT GetDriveTypeW(LPCWSTR lpRootPathName)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024d20. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24d20  570  GetDriveTypeW
  UVar1 = GetDriveTypeW(lpRootPathName);
  return UVar1;
}



DWORD GetFileAttributesA(LPCSTR lpFileName)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024d30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24d30  587  GetFileAttributesA
  DVar1 = GetFileAttributesA(lpFileName);
  return DVar1;
}



BOOL GetFileAttributesExA
               (LPCSTR lpFileName,GET_FILEEX_INFO_LEVELS fInfoLevelId,LPVOID lpFileInformation)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024d40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24d40  588  GetFileAttributesExA
  BVar1 = GetFileAttributesExA(lpFileName,fInfoLevelId,lpFileInformation);
  return BVar1;
}



BOOL GetFileAttributesExW
               (LPCWSTR lpFileName,GET_FILEEX_INFO_LEVELS fInfoLevelId,LPVOID lpFileInformation)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024d50. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24d50  589  GetFileAttributesExW
  BVar1 = GetFileAttributesExW(lpFileName,fInfoLevelId,lpFileInformation);
  return BVar1;
}



DWORD GetFileAttributesW(LPCWSTR lpFileName)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024d60. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24d60  592  GetFileAttributesW
  DVar1 = GetFileAttributesW(lpFileName);
  return DVar1;
}



BOOL GetFileInformationByHandle(HANDLE hFile,LPBY_HANDLE_FILE_INFORMATION lpFileInformation)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024d70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24d70  594  GetFileInformationByHandle
  BVar1 = GetFileInformationByHandle(hFile,lpFileInformation);
  return BVar1;
}



DWORD GetFileSize(HANDLE hFile,LPDWORD lpFileSizeHigh)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024d80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24d80  598  GetFileSize
  DVar1 = GetFileSize(hFile,lpFileSizeHigh);
  return DVar1;
}



BOOL GetFileSizeEx(HANDLE hFile,PLARGE_INTEGER lpFileSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024d90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24d90  599  GetFileSizeEx
  BVar1 = GetFileSizeEx(hFile,lpFileSize);
  return BVar1;
}



BOOL GetFileTime(HANDLE hFile,LPFILETIME lpCreationTime,LPFILETIME lpLastAccessTime,
                LPFILETIME lpLastWriteTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024da0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24da0  600  GetFileTime
  BVar1 = GetFileTime(hFile,lpCreationTime,lpLastAccessTime,lpLastWriteTime);
  return BVar1;
}



DWORD GetFileType(HANDLE hFile)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024db0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24db0  601  GetFileType
  DVar1 = GetFileType(hFile);
  return DVar1;
}



DWORD GetFinalPathNameByHandleA(HANDLE hFile,LPSTR lpszFilePath,DWORD cchFilePath,DWORD dwFlags)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024dc0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24dc0  602  GetFinalPathNameByHandleA
  DVar1 = GetFinalPathNameByHandleA(hFile,lpszFilePath,cchFilePath,dwFlags);
  return DVar1;
}



DWORD GetFinalPathNameByHandleW(HANDLE hFile,LPWSTR lpszFilePath,DWORD cchFilePath,DWORD dwFlags)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024dd0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24dd0  603  GetFinalPathNameByHandleW
  DVar1 = GetFinalPathNameByHandleW(hFile,lpszFilePath,cchFilePath,dwFlags);
  return DVar1;
}



DWORD GetFullPathNameA(LPCSTR lpFileName,DWORD nBufferLength,LPSTR lpBuffer,LPSTR *lpFilePart)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024de0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24de0  609  GetFullPathNameA
  DVar1 = GetFullPathNameA(lpFileName,nBufferLength,lpBuffer,lpFilePart);
  return DVar1;
}



DWORD GetFullPathNameW(LPCWSTR lpFileName,DWORD nBufferLength,LPWSTR lpBuffer,LPWSTR *lpFilePart)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024df0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24df0  612  GetFullPathNameW
  DVar1 = GetFullPathNameW(lpFileName,nBufferLength,lpBuffer,lpFilePart);
  return DVar1;
}



DWORD GetLogicalDriveStringsW(DWORD nBufferLength,LPWSTR lpBuffer)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024e00. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24e00  625  GetLogicalDriveStringsW
  DVar1 = GetLogicalDriveStringsW(nBufferLength,lpBuffer);
  return DVar1;
}



UINT GetTempFileNameA(LPCSTR lpPathName,LPCSTR lpPrefixString,UINT uUnique,LPSTR lpTempFileName)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024e10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24e10  766  GetTempFileNameA
  UVar1 = GetTempFileNameA(lpPathName,lpPrefixString,uUnique,lpTempFileName);
  return UVar1;
}



UINT GetTempFileNameW(LPCWSTR lpPathName,LPCWSTR lpPrefixString,UINT uUnique,LPWSTR lpTempFileName)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024e20. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24e20  767  GetTempFileNameW
  UVar1 = GetTempFileNameW(lpPathName,lpPrefixString,uUnique,lpTempFileName);
  return UVar1;
}



DWORD GetTempPathA(DWORD nBufferLength,LPSTR lpBuffer)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024e30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24e30  768  GetTempPathA
  DVar1 = GetTempPathA(nBufferLength,lpBuffer);
  return DVar1;
}



DWORD GetTempPathW(DWORD nBufferLength,LPWSTR lpBuffer)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024e40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24e40  769  GetTempPathW
  DVar1 = GetTempPathW(nBufferLength,lpBuffer);
  return DVar1;
}



BOOL GetVolumeInformationA
               (LPCSTR lpRootPathName,LPSTR lpVolumeNameBuffer,DWORD nVolumeNameSize,
               LPDWORD lpVolumeSerialNumber,LPDWORD lpMaximumComponentLength,
               LPDWORD lpFileSystemFlags,LPSTR lpFileSystemNameBuffer,DWORD nFileSystemNameSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024e50. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24e50  809  GetVolumeInformationA
  BVar1 = GetVolumeInformationA
                    (lpRootPathName,lpVolumeNameBuffer,nVolumeNameSize,lpVolumeSerialNumber,
                     lpMaximumComponentLength,lpFileSystemFlags,lpFileSystemNameBuffer,
                     nFileSystemNameSize);
  return BVar1;
}



BOOL GetVolumeInformationByHandleW
               (HANDLE hFile,LPWSTR lpVolumeNameBuffer,DWORD nVolumeNameSize,
               LPDWORD lpVolumeSerialNumber,LPDWORD lpMaximumComponentLength,
               LPDWORD lpFileSystemFlags,LPWSTR lpFileSystemNameBuffer,DWORD nFileSystemNameSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024e60. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24e60  810  GetVolumeInformationByHandleW
  BVar1 = GetVolumeInformationByHandleW
                    (hFile,lpVolumeNameBuffer,nVolumeNameSize,lpVolumeSerialNumber,
                     lpMaximumComponentLength,lpFileSystemFlags,lpFileSystemNameBuffer,
                     nFileSystemNameSize);
  return BVar1;
}



BOOL GetVolumeInformationW
               (LPCWSTR lpRootPathName,LPWSTR lpVolumeNameBuffer,DWORD nVolumeNameSize,
               LPDWORD lpVolumeSerialNumber,LPDWORD lpMaximumComponentLength,
               LPDWORD lpFileSystemFlags,LPWSTR lpFileSystemNameBuffer,DWORD nFileSystemNameSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024e70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24e70  811  GetVolumeInformationW
  BVar1 = GetVolumeInformationW
                    (lpRootPathName,lpVolumeNameBuffer,nVolumeNameSize,lpVolumeSerialNumber,
                     lpMaximumComponentLength,lpFileSystemFlags,lpFileSystemNameBuffer,
                     nFileSystemNameSize);
  return BVar1;
}



BOOL GetVolumePathNameW(LPCWSTR lpszFileName,LPWSTR lpszVolumePathName,DWORD cchBufferLength)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024e80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24e80  815  GetVolumePathNameW
  BVar1 = GetVolumePathNameW(lpszFileName,lpszVolumePathName,cchBufferLength);
  return BVar1;
}



BOOL GetVolumePathNamesForVolumeNameW
               (LPCWSTR lpszVolumeName,LPWCH lpszVolumePathNames,DWORD cchBufferLength,
               PDWORD lpcchReturnLength)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024e90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24e90  817  GetVolumePathNamesForVolumeNameW
  BVar1 = GetVolumePathNamesForVolumeNameW
                    (lpszVolumeName,lpszVolumePathNames,cchBufferLength,lpcchReturnLength);
  return BVar1;
}



BOOL LocalFileTimeToFileTime(FILETIME *lpLocalFileTime,LPFILETIME lpFileTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024ea0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24ea0  980  LocalFileTimeToFileTime
  BVar1 = LocalFileTimeToFileTime(lpLocalFileTime,lpFileTime);
  return BVar1;
}



BOOL LockFile(HANDLE hFile,DWORD dwFileOffsetLow,DWORD dwFileOffsetHigh,
             DWORD nNumberOfBytesToLockLow,DWORD nNumberOfBytesToLockHigh)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024eb0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24eb0  993  LockFile
  BVar1 = LockFile(hFile,dwFileOffsetLow,dwFileOffsetHigh,nNumberOfBytesToLockLow,
                   nNumberOfBytesToLockHigh);
  return BVar1;
}



BOOL LockFileEx(HANDLE hFile,DWORD dwFlags,DWORD dwReserved,DWORD nNumberOfBytesToLockLow,
               DWORD nNumberOfBytesToLockHigh,LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024ec0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24ec0  994  LockFileEx
  BVar1 = LockFileEx(hFile,dwFlags,dwReserved,nNumberOfBytesToLockLow,nNumberOfBytesToLockHigh,
                     lpOverlapped);
  return BVar1;
}



DWORD QueryDosDeviceW(LPCWSTR lpDeviceName,LPWSTR lpTargetPath,DWORD ucchMax)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024ed0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24ed0  1099  QueryDosDeviceW
  DVar1 = QueryDosDeviceW(lpDeviceName,lpTargetPath,ucchMax);
  return DVar1;
}



BOOL ReadFile(HANDLE hFile,LPVOID lpBuffer,DWORD nNumberOfBytesToRead,LPDWORD lpNumberOfBytesRead,
             LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024ee0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24ee0  1146  ReadFile
  BVar1 = ReadFile(hFile,lpBuffer,nNumberOfBytesToRead,lpNumberOfBytesRead,lpOverlapped);
  return BVar1;
}



BOOL ReadFileEx(HANDLE hFile,LPVOID lpBuffer,DWORD nNumberOfBytesToRead,LPOVERLAPPED lpOverlapped,
               LPOVERLAPPED_COMPLETION_ROUTINE lpCompletionRoutine)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024ef0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24ef0  1147  ReadFileEx
  BVar1 = ReadFileEx(hFile,lpBuffer,nNumberOfBytesToRead,lpOverlapped,lpCompletionRoutine);
  return BVar1;
}



BOOL ReadFileScatter(HANDLE hFile,FILE_SEGMENT_ELEMENT *aSegmentArray,DWORD nNumberOfBytesToRead,
                    LPDWORD lpReserved,LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024f00. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24f00  1148  ReadFileScatter
  BVar1 = ReadFileScatter(hFile,aSegmentArray,nNumberOfBytesToRead,lpReserved,lpOverlapped);
  return BVar1;
}



BOOL RemoveDirectoryA(LPCSTR lpPathName)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024f10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24f10  1213  RemoveDirectoryA
  BVar1 = RemoveDirectoryA(lpPathName);
  return BVar1;
}



BOOL RemoveDirectoryW(LPCWSTR lpPathName)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024f20. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24f20  1216  RemoveDirectoryW
  BVar1 = RemoveDirectoryW(lpPathName);
  return BVar1;
}



BOOL SetEndOfFile(HANDLE hFile)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024f30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24f30  1313  SetEndOfFile
  BVar1 = SetEndOfFile(hFile);
  return BVar1;
}



BOOL SetFileAttributesA(LPCSTR lpFileName,DWORD dwFileAttributes)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024f40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24f40  1323  SetFileAttributesA
  BVar1 = SetFileAttributesA(lpFileName,dwFileAttributes);
  return BVar1;
}



BOOL SetFileAttributesW(LPCWSTR lpFileName,DWORD dwFileAttributes)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024f50. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24f50  1326  SetFileAttributesW
  BVar1 = SetFileAttributesW(lpFileName,dwFileAttributes);
  return BVar1;
}



BOOL SetFileInformationByHandle
               (HANDLE hFile,FILE_INFO_BY_HANDLE_CLASS FileInformationClass,LPVOID lpFileInformation
               ,DWORD dwBufferSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024f60. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24f60  1329  SetFileInformationByHandle
  BVar1 = SetFileInformationByHandle(hFile,FileInformationClass,lpFileInformation,dwBufferSize);
  return BVar1;
}



DWORD SetFilePointer(HANDLE hFile,LONG lDistanceToMove,PLONG lpDistanceToMoveHigh,DWORD dwMoveMethod
                    )

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024f70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24f70  1331  SetFilePointer
  DVar1 = SetFilePointer(hFile,lDistanceToMove,lpDistanceToMoveHigh,dwMoveMethod);
  return DVar1;
}



BOOL SetFilePointerEx(HANDLE hFile,LARGE_INTEGER liDistanceToMove,PLARGE_INTEGER lpNewFilePointer,
                     DWORD dwMoveMethod)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024f80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24f80  1332  SetFilePointerEx
  BVar1 = SetFilePointerEx(hFile,liDistanceToMove,lpNewFilePointer,dwMoveMethod);
  return BVar1;
}



BOOL SetFileTime(HANDLE hFile,FILETIME *lpCreationTime,FILETIME *lpLastAccessTime,
                FILETIME *lpLastWriteTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024f90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24f90  1335  SetFileTime
  BVar1 = SetFileTime(hFile,lpCreationTime,lpLastAccessTime,lpLastWriteTime);
  return BVar1;
}



BOOL SetFileValidData(HANDLE hFile,LONGLONG ValidDataLength)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024fa0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24fa0  1336  SetFileValidData
  BVar1 = SetFileValidData(hFile,ValidDataLength);
  return BVar1;
}



BOOL UnlockFile(HANDLE hFile,DWORD dwFileOffsetLow,DWORD dwFileOffsetHigh,
               DWORD nNumberOfBytesToUnlockLow,DWORD nNumberOfBytesToUnlockHigh)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024fb0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24fb0  1474  UnlockFile
  BVar1 = UnlockFile(hFile,dwFileOffsetLow,dwFileOffsetHigh,nNumberOfBytesToUnlockLow,
                     nNumberOfBytesToUnlockHigh);
  return BVar1;
}



BOOL UnlockFileEx(HANDLE hFile,DWORD dwReserved,DWORD nNumberOfBytesToUnlockLow,
                 DWORD nNumberOfBytesToUnlockHigh,LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024fc0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24fc0  1475  UnlockFileEx
  BVar1 = UnlockFileEx(hFile,dwReserved,nNumberOfBytesToUnlockLow,nNumberOfBytesToUnlockHigh,
                       lpOverlapped);
  return BVar1;
}



BOOL WriteFile(HANDLE hFile,LPCVOID lpBuffer,DWORD nNumberOfBytesToWrite,
              LPDWORD lpNumberOfBytesWritten,LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024fd0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24fd0  1574  WriteFile
  BVar1 = WriteFile(hFile,lpBuffer,nNumberOfBytesToWrite,lpNumberOfBytesWritten,lpOverlapped);
  return BVar1;
}



BOOL WriteFileEx(HANDLE hFile,LPCVOID lpBuffer,DWORD nNumberOfBytesToWrite,LPOVERLAPPED lpOverlapped
                ,LPOVERLAPPED_COMPLETION_ROUTINE lpCompletionRoutine)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024fe0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24fe0  1575  WriteFileEx
  BVar1 = WriteFileEx(hFile,lpBuffer,nNumberOfBytesToWrite,lpOverlapped,lpCompletionRoutine);
  return BVar1;
}



BOOL WriteFileGather(HANDLE hFile,FILE_SEGMENT_ELEMENT *aSegmentArray,DWORD nNumberOfBytesToWrite,
                    LPDWORD lpReserved,LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180024ff0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x24ff0  1576  WriteFileGather
  BVar1 = WriteFileGather(hFile,aSegmentArray,nNumberOfBytesToWrite,lpReserved,lpOverlapped);
  return BVar1;
}



int MulDiv(int nNumber,int nNumerator,int nDenominator)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025000. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25000  1014  MulDiv
  iVar1 = MulDiv(nNumber,nNumerator,nDenominator);
  return iVar1;
}



BOOL EnumResourceNamesW(HMODULE hModule,LPCWSTR lpType,ENUMRESNAMEPROCW lpEnumFunc,LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025010. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25010  335  EnumResourceNamesW
  BVar1 = EnumResourceNamesW(hModule,lpType,lpEnumFunc,lParam);
  return BVar1;
}



void LoadPackagedLibrary(void)

{
                    // WARNING: Could not recover jumptable at 0x000180025020. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25020  974  LoadPackagedLibrary
  LoadPackagedLibrary();
  return;
}



BOOL CallNamedPipeW(LPCWSTR lpNamedPipeName,LPVOID lpInBuffer,DWORD nInBufferSize,LPVOID lpOutBuffer
                   ,DWORD nOutBufferSize,LPDWORD lpBytesRead,DWORD nTimeOut)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025030. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25030  113  CallNamedPipeW
  BVar1 = CallNamedPipeW(lpNamedPipeName,lpInBuffer,nInBufferSize,lpOutBuffer,nOutBufferSize,
                         lpBytesRead,nTimeOut);
  return BVar1;
}



void GetSystemTimePreciseAsFileTime(void)

{
                    // WARNING: Could not recover jumptable at 0x000180025040. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25040  757  GetSystemTimePreciseAsFileTime
  GetSystemTimePreciseAsFileTime();
  return;
}



BOOL FileTimeToSystemTime(FILETIME *lpFileTime,LPSYSTEMTIME lpSystemTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025050. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25050  372  FileTimeToSystemTime
  BVar1 = FileTimeToSystemTime(lpFileTime,lpSystemTime);
  return BVar1;
}



int GetCalendarInfoEx(LPCWSTR lpLocaleName,CALID Calendar,LPCWSTR lpReserved,CALTYPE CalType,
                     LPWSTR lpCalData,int cchData,LPDWORD lpValue)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025060. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25060  468  GetCalendarInfoEx
  iVar1 = GetCalendarInfoEx(lpLocaleName,Calendar,lpReserved,CalType,lpCalData,cchData,lpValue);
  return iVar1;
}



int GetCalendarInfoW(LCID Locale,CALID Calendar,CALTYPE CalType,LPWSTR lpCalData,int cchData,
                    LPDWORD lpValue)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025070. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25070  469  GetCalendarInfoW
  iVar1 = GetCalendarInfoW(Locale,Calendar,CalType,lpCalData,cchData,lpValue);
  return iVar1;
}



LPCH GetEnvironmentStringsA(void)

{
  LPCH pCVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025080. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25080  577  GetEnvironmentStringsA
  pCVar1 = GetEnvironmentStrings();
  return pCVar1;
}



BOOL ClearCommBreak(HANDLE hFile)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025090. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25090  135  ClearCommBreak
  BVar1 = ClearCommBreak(hFile);
  return BVar1;
}



BOOL ClearCommError(HANDLE hFile,LPDWORD lpErrors,LPCOMSTAT lpStat)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800250a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x250a0  136  ClearCommError
  BVar1 = ClearCommError(hFile,lpErrors,lpStat);
  return BVar1;
}



BOOL EscapeCommFunction(HANDLE hFile,DWORD dwFunc)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800250b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x250b0  358  EscapeCommFunction
  BVar1 = EscapeCommFunction(hFile,dwFunc);
  return BVar1;
}



BOOL GetCommConfig(HANDLE hCommDev,LPCOMMCONFIG lpCC,LPDWORD lpdwSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800250c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x250c0  474  GetCommConfig
  BVar1 = GetCommConfig(hCommDev,lpCC,lpdwSize);
  return BVar1;
}



BOOL GetCommMask(HANDLE hFile,LPDWORD lpEvtMask)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800250d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x250d0  475  GetCommMask
  BVar1 = GetCommMask(hFile,lpEvtMask);
  return BVar1;
}



BOOL GetCommModemStatus(HANDLE hFile,LPDWORD lpModemStat)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800250e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x250e0  476  GetCommModemStatus
  BVar1 = GetCommModemStatus(hFile,lpModemStat);
  return BVar1;
}



BOOL GetCommProperties(HANDLE hFile,LPCOMMPROP lpCommProp)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800250f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x250f0  477  GetCommProperties
  BVar1 = GetCommProperties(hFile,lpCommProp);
  return BVar1;
}



BOOL GetCommState(HANDLE hFile,LPDCB lpDCB)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025100. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25100  478  GetCommState
  BVar1 = GetCommState(hFile,lpDCB);
  return BVar1;
}



BOOL GetCommTimeouts(HANDLE hFile,LPCOMMTIMEOUTS lpCommTimeouts)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025110. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25110  479  GetCommTimeouts
  BVar1 = GetCommTimeouts(hFile,lpCommTimeouts);
  return BVar1;
}



BOOL PurgeComm(HANDLE hFile,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025120. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25120  1092  PurgeComm
  BVar1 = PurgeComm(hFile,dwFlags);
  return BVar1;
}



BOOL SetCommBreak(HANDLE hFile)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025130. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25130  1262  SetCommBreak
  BVar1 = SetCommBreak(hFile);
  return BVar1;
}



BOOL SetCommConfig(HANDLE hCommDev,LPCOMMCONFIG lpCC,DWORD dwSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025140. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25140  1263  SetCommConfig
  BVar1 = SetCommConfig(hCommDev,lpCC,dwSize);
  return BVar1;
}



BOOL SetCommMask(HANDLE hFile,DWORD dwEvtMask)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025150. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25150  1264  SetCommMask
  BVar1 = SetCommMask(hFile,dwEvtMask);
  return BVar1;
}



BOOL SetCommState(HANDLE hFile,LPDCB lpDCB)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025160. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25160  1265  SetCommState
  BVar1 = SetCommState(hFile,lpDCB);
  return BVar1;
}



BOOL SetCommTimeouts(HANDLE hFile,LPCOMMTIMEOUTS lpCommTimeouts)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025170. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25170  1266  SetCommTimeouts
  BVar1 = SetCommTimeouts(hFile,lpCommTimeouts);
  return BVar1;
}



BOOL SetupComm(HANDLE hFile,DWORD dwInQueue,DWORD dwOutQueue)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025180. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25180  1420  SetupComm
  BVar1 = SetupComm(hFile,dwInQueue,dwOutQueue);
  return BVar1;
}



BOOL TransmitCommChar(HANDLE hFile,char cChar)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025190. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25190  1463  TransmitCommChar
  BVar1 = TransmitCommChar(hFile,cChar);
  return BVar1;
}



BOOL WaitCommEvent(HANDLE hFile,LPDWORD lpEvtMask,LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800251a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x251a0  1510  WaitCommEvent
  BVar1 = WaitCommEvent(hFile,lpEvtMask,lpOverlapped);
  return BVar1;
}



UINT GetSystemWow64DirectoryA(LPSTR lpBuffer,UINT uSize)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800251b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x251b0  761  GetSystemWow64DirectoryA
  UVar1 = GetSystemWow64DirectoryA(lpBuffer,uSize);
  return UVar1;
}



UINT GetSystemWow64DirectoryW(LPWSTR lpBuffer,UINT uSize)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800251c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x251c0  762  GetSystemWow64DirectoryW
  UVar1 = GetSystemWow64DirectoryW(lpBuffer,uSize);
  return UVar1;
}



BOOL CopyFileW(LPCWSTR lpExistingFileName,LPCWSTR lpNewFileName,BOOL bFailIfExists)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800251d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x251d0  177  CopyFileW
  BVar1 = CopyFileW(lpExistingFileName,lpNewFileName,bFailIfExists);
  return BVar1;
}



BOOL ConvertFiberToThread(void)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800251e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x251e0  165  ConvertFiberToThread
  BVar1 = ConvertFiberToThread();
  return BVar1;
}



LPVOID ConvertThreadToFiber(LPVOID lpParameter)

{
  LPVOID pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800251f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x251f0  168  ConvertThreadToFiber
  pvVar1 = ConvertThreadToFiber(lpParameter);
  return pvVar1;
}



LPVOID ConvertThreadToFiberEx(LPVOID lpParameter,DWORD dwFlags)

{
  LPVOID pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025200. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25200  169  ConvertThreadToFiberEx
  pvVar1 = ConvertThreadToFiberEx(lpParameter,dwFlags);
  return pvVar1;
}



LPVOID CreateFiber(SIZE_T dwStackSize,LPFIBER_START_ROUTINE lpStartAddress,LPVOID lpParameter)

{
  LPVOID pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025210. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25210  196  CreateFiber
  pvVar1 = CreateFiber(dwStackSize,lpStartAddress,lpParameter);
  return pvVar1;
}



LPVOID CreateFiberEx(SIZE_T dwStackCommitSize,SIZE_T dwStackReserveSize,DWORD dwFlags,
                    LPFIBER_START_ROUTINE lpStartAddress,LPVOID lpParameter)

{
  LPVOID pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025220. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25220  197  CreateFiberEx
  pvVar1 = CreateFiberEx(dwStackCommitSize,dwStackReserveSize,dwFlags,lpStartAddress,lpParameter);
  return pvVar1;
}



void DeleteFiber(LPVOID lpFiber)

{
                    // WARNING: Could not recover jumptable at 0x000180025230. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25230  278  DeleteFiber
  DeleteFiber(lpFiber);
  return;
}



void SwitchToFiber(LPVOID lpFiber)

{
                    // WARNING: Could not recover jumptable at 0x000180025240. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25240  1433  SwitchToFiber
  SwitchToFiber(lpFiber);
  return;
}



void NlsCheckPolicy(void)

{
                    // WARNING: Could not recover jumptable at 0x000180025250. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25250  1018  NlsCheckPolicy
  NlsCheckPolicy();
  return;
}



void NlsGetCacheUpdateCount(void)

{
                    // WARNING: Could not recover jumptable at 0x000180025260. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25260  1019  NlsGetCacheUpdateCount
  NlsGetCacheUpdateCount();
  return;
}



void NlsUpdateLocale(void)

{
                    // WARNING: Could not recover jumptable at 0x000180025270. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25270  1020  NlsUpdateLocale
  NlsUpdateLocale();
  return;
}



void NlsUpdateSystemLocale(void)

{
                    // WARNING: Could not recover jumptable at 0x000180025280. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25280  1021  NlsUpdateSystemLocale
  NlsUpdateSystemLocale();
  return;
}



BOOL AllocConsole(void)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025290. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25290  22  AllocConsole
  BVar1 = AllocConsole();
  return BVar1;
}



BOOL AttachConsole(DWORD dwProcessId)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800252a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x252a0  38  AttachConsole
  BVar1 = AttachConsole(dwProcessId);
  return BVar1;
}



void ClosePseudoConsole(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800252b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x252b0  142  ClosePseudoConsole
  ClosePseudoConsole();
  return;
}



void CreatePseudoConsole(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800252c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x252c0  234  CreatePseudoConsole
  CreatePseudoConsole();
  return;
}



BOOL FreeConsole(void)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800252d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x252d0  434  FreeConsole
  BVar1 = FreeConsole();
  return BVar1;
}



UINT GetConsoleCP(void)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800252e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x252e0  500  GetConsoleCP
  UVar1 = GetConsoleCP();
  return UVar1;
}



BOOL GetConsoleMode(HANDLE hConsoleHandle,LPDWORD lpMode)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800252f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x252f0  518  GetConsoleMode
  BVar1 = GetConsoleMode(hConsoleHandle,lpMode);
  return BVar1;
}



UINT GetConsoleOutputCP(void)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025300. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25300  522  GetConsoleOutputCP
  UVar1 = GetConsoleOutputCP();
  return UVar1;
}



BOOL GetNumberOfConsoleInputEvents(HANDLE hConsoleInput,LPDWORD lpNumberOfEvents)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025310. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25310  672  GetNumberOfConsoleInputEvents
  BVar1 = GetNumberOfConsoleInputEvents(hConsoleInput,lpNumberOfEvents);
  return BVar1;
}



BOOL PeekConsoleInputA(HANDLE hConsoleInput,PINPUT_RECORD lpBuffer,DWORD nLength,
                      LPDWORD lpNumberOfEventsRead)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025320. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25320  1062  PeekConsoleInputA
  BVar1 = PeekConsoleInputA(hConsoleInput,lpBuffer,nLength,lpNumberOfEventsRead);
  return BVar1;
}



BOOL PeekConsoleInputW(HANDLE hConsoleInput,PINPUT_RECORD lpBuffer,DWORD nLength,
                      LPDWORD lpNumberOfEventsRead)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025330. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25330  1063  PeekConsoleInputW
  BVar1 = PeekConsoleInputW(hConsoleInput,lpBuffer,nLength,lpNumberOfEventsRead);
  return BVar1;
}



BOOL ReadConsoleA(HANDLE hConsoleInput,LPVOID lpBuffer,DWORD nNumberOfCharsToRead,
                 LPDWORD lpNumberOfCharsRead,PCONSOLE_READCONSOLE_CONTROL pInputControl)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025340. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25340  1133  ReadConsoleA
  BVar1 = ReadConsoleA(hConsoleInput,lpBuffer,nNumberOfCharsToRead,lpNumberOfCharsRead,pInputControl
                      );
  return BVar1;
}



BOOL ReadConsoleInputA(HANDLE hConsoleInput,PINPUT_RECORD lpBuffer,DWORD nLength,
                      LPDWORD lpNumberOfEventsRead)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025350. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25350  1134  ReadConsoleInputA
  BVar1 = ReadConsoleInputA(hConsoleInput,lpBuffer,nLength,lpNumberOfEventsRead);
  return BVar1;
}



BOOL ReadConsoleInputW(HANDLE hConsoleInput,PINPUT_RECORD lpBuffer,DWORD nLength,
                      LPDWORD lpNumberOfEventsRead)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025360. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25360  1137  ReadConsoleInputW
  BVar1 = ReadConsoleInputW(hConsoleInput,lpBuffer,nLength,lpNumberOfEventsRead);
  return BVar1;
}



BOOL ReadConsoleW(HANDLE hConsoleInput,LPVOID lpBuffer,DWORD nNumberOfCharsToRead,
                 LPDWORD lpNumberOfCharsRead,PCONSOLE_READCONSOLE_CONTROL pInputControl)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025370. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25370  1143  ReadConsoleW
  BVar1 = ReadConsoleW(hConsoleInput,lpBuffer,nNumberOfCharsToRead,lpNumberOfCharsRead,pInputControl
                      );
  return BVar1;
}



void ResizePseudoConsole(void)

{
                    // WARNING: Could not recover jumptable at 0x000180025380. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25380  1231  ResizePseudoConsole
  ResizePseudoConsole();
  return;
}



BOOL SetConsoleCtrlHandler(PHANDLER_ROUTINE HandlerRoutine,BOOL Add)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025390. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25390  1274  SetConsoleCtrlHandler
  BVar1 = SetConsoleCtrlHandler(HandlerRoutine,Add);
  return BVar1;
}



BOOL SetConsoleMode(HANDLE hConsoleHandle,DWORD dwMode)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800253a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x253a0  1290  SetConsoleMode
  BVar1 = SetConsoleMode(hConsoleHandle,dwMode);
  return BVar1;
}



BOOL WriteConsoleA(HANDLE hConsoleOutput,void *lpBuffer,DWORD nNumberOfCharsToWrite,
                  LPDWORD lpNumberOfCharsWritten,LPVOID lpReserved)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800253b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x253b0  1563  WriteConsoleA
  BVar1 = WriteConsoleA(hConsoleOutput,lpBuffer,nNumberOfCharsToWrite,lpNumberOfCharsWritten,
                        lpReserved);
  return BVar1;
}



BOOL WriteConsoleW(HANDLE hConsoleOutput,void *lpBuffer,DWORD nNumberOfCharsToWrite,
                  LPDWORD lpNumberOfCharsWritten,LPVOID lpReserved)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800253c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x253c0  1573  WriteConsoleW
  BVar1 = WriteConsoleW(hConsoleOutput,lpBuffer,nNumberOfCharsToWrite,lpNumberOfCharsWritten,
                        lpReserved);
  return BVar1;
}



HANDLE CreateConsoleScreenBuffer
                 (DWORD dwDesiredAccess,DWORD dwShareMode,SECURITY_ATTRIBUTES *lpSecurityAttributes,
                 DWORD dwFlags,LPVOID lpScreenBufferData)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800253d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x253d0  184  CreateConsoleScreenBuffer
  pvVar1 = CreateConsoleScreenBuffer
                     (dwDesiredAccess,dwShareMode,lpSecurityAttributes,dwFlags,lpScreenBufferData);
  return pvVar1;
}



BOOL FillConsoleOutputAttribute
               (HANDLE hConsoleOutput,WORD wAttribute,DWORD nLength,COORD dwWriteCoord,
               LPDWORD lpNumberOfAttrsWritten)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800253e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x253e0  373  FillConsoleOutputAttribute
  BVar1 = FillConsoleOutputAttribute
                    (hConsoleOutput,wAttribute,nLength,dwWriteCoord,lpNumberOfAttrsWritten);
  return BVar1;
}



BOOL FillConsoleOutputCharacterA
               (HANDLE hConsoleOutput,CHAR cCharacter,DWORD nLength,COORD dwWriteCoord,
               LPDWORD lpNumberOfCharsWritten)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800253f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x253f0  374  FillConsoleOutputCharacterA
  BVar1 = FillConsoleOutputCharacterA
                    (hConsoleOutput,cCharacter,nLength,dwWriteCoord,lpNumberOfCharsWritten);
  return BVar1;
}



BOOL FillConsoleOutputCharacterW
               (HANDLE hConsoleOutput,WCHAR cCharacter,DWORD nLength,COORD dwWriteCoord,
               LPDWORD lpNumberOfCharsWritten)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025400. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25400  375  FillConsoleOutputCharacterW
  BVar1 = FillConsoleOutputCharacterW
                    (hConsoleOutput,cCharacter,nLength,dwWriteCoord,lpNumberOfCharsWritten);
  return BVar1;
}



BOOL FlushConsoleInputBuffer(HANDLE hConsoleInput)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025410. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25410  424  FlushConsoleInputBuffer
  BVar1 = FlushConsoleInputBuffer(hConsoleInput);
  return BVar1;
}



BOOL GenerateConsoleCtrlEvent(DWORD dwCtrlEvent,DWORD dwProcessGroupId)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025420. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25420  443  GenerateConsoleCtrlEvent
  BVar1 = GenerateConsoleCtrlEvent(dwCtrlEvent,dwProcessGroupId);
  return BVar1;
}



BOOL GetConsoleCursorInfo(HANDLE hConsoleOutput,PCONSOLE_CURSOR_INFO lpConsoleCursorInfo)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025430. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25430  506  GetConsoleCursorInfo
  BVar1 = GetConsoleCursorInfo(hConsoleOutput,lpConsoleCursorInfo);
  return BVar1;
}



DWORD GetConsoleOriginalTitleA(LPSTR lpConsoleTitle,DWORD nSize)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025440. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25440  520  GetConsoleOriginalTitleA
  DVar1 = GetConsoleOriginalTitleA(lpConsoleTitle,nSize);
  return DVar1;
}



DWORD GetConsoleOriginalTitleW(LPWSTR lpConsoleTitle,DWORD nSize)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025450. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25450  521  GetConsoleOriginalTitleW
  DVar1 = GetConsoleOriginalTitleW(lpConsoleTitle,nSize);
  return DVar1;
}



BOOL GetConsoleScreenBufferInfo
               (HANDLE hConsoleOutput,PCONSOLE_SCREEN_BUFFER_INFO lpConsoleScreenBufferInfo)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025460. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25460  524  GetConsoleScreenBufferInfo
  BVar1 = GetConsoleScreenBufferInfo(hConsoleOutput,lpConsoleScreenBufferInfo);
  return BVar1;
}



BOOL GetConsoleScreenBufferInfoEx
               (HANDLE hConsoleOutput,PCONSOLE_SCREEN_BUFFER_INFOEX lpConsoleScreenBufferInfoEx)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025470. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25470  525  GetConsoleScreenBufferInfoEx
  BVar1 = GetConsoleScreenBufferInfoEx(hConsoleOutput,lpConsoleScreenBufferInfoEx);
  return BVar1;
}



DWORD GetConsoleTitleA(LPSTR lpConsoleTitle,DWORD nSize)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025480. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25480  527  GetConsoleTitleA
  DVar1 = GetConsoleTitleA(lpConsoleTitle,nSize);
  return DVar1;
}



DWORD GetConsoleTitleW(LPWSTR lpConsoleTitle,DWORD nSize)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025490. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25490  528  GetConsoleTitleW
  DVar1 = GetConsoleTitleW(lpConsoleTitle,nSize);
  return DVar1;
}



COORD GetLargestConsoleWindowSize(HANDLE hConsoleOutput)

{
  COORD CVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800254a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x254a0  618  GetLargestConsoleWindowSize
  CVar1 = GetLargestConsoleWindowSize(hConsoleOutput);
  return CVar1;
}



BOOL ReadConsoleOutputA(HANDLE hConsoleOutput,PCHAR_INFO lpBuffer,COORD dwBufferSize,
                       COORD dwBufferCoord,PSMALL_RECT lpReadRegion)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800254b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x254b0  1138  ReadConsoleOutputA
  BVar1 = ReadConsoleOutputA(hConsoleOutput,lpBuffer,dwBufferSize,dwBufferCoord,lpReadRegion);
  return BVar1;
}



BOOL ReadConsoleOutputAttribute
               (HANDLE hConsoleOutput,LPWORD lpAttribute,DWORD nLength,COORD dwReadCoord,
               LPDWORD lpNumberOfAttrsRead)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800254c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x254c0  1139  ReadConsoleOutputAttribute
  BVar1 = ReadConsoleOutputAttribute
                    (hConsoleOutput,lpAttribute,nLength,dwReadCoord,lpNumberOfAttrsRead);
  return BVar1;
}



BOOL ReadConsoleOutputCharacterA
               (HANDLE hConsoleOutput,LPSTR lpCharacter,DWORD nLength,COORD dwReadCoord,
               LPDWORD lpNumberOfCharsRead)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800254d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x254d0  1140  ReadConsoleOutputCharacterA
  BVar1 = ReadConsoleOutputCharacterA
                    (hConsoleOutput,lpCharacter,nLength,dwReadCoord,lpNumberOfCharsRead);
  return BVar1;
}



BOOL ReadConsoleOutputCharacterW
               (HANDLE hConsoleOutput,LPWSTR lpCharacter,DWORD nLength,COORD dwReadCoord,
               LPDWORD lpNumberOfCharsRead)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800254e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x254e0  1141  ReadConsoleOutputCharacterW
  BVar1 = ReadConsoleOutputCharacterW
                    (hConsoleOutput,lpCharacter,nLength,dwReadCoord,lpNumberOfCharsRead);
  return BVar1;
}



BOOL ReadConsoleOutputW(HANDLE hConsoleOutput,PCHAR_INFO lpBuffer,COORD dwBufferSize,
                       COORD dwBufferCoord,PSMALL_RECT lpReadRegion)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800254f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x254f0  1142  ReadConsoleOutputW
  BVar1 = ReadConsoleOutputW(hConsoleOutput,lpBuffer,dwBufferSize,dwBufferCoord,lpReadRegion);
  return BVar1;
}



BOOL ScrollConsoleScreenBufferA
               (HANDLE hConsoleOutput,SMALL_RECT *lpScrollRectangle,SMALL_RECT *lpClipRectangle,
               COORD dwDestinationOrigin,CHAR_INFO *lpFill)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025500. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25500  1254  ScrollConsoleScreenBufferA
  BVar1 = ScrollConsoleScreenBufferA
                    (hConsoleOutput,lpScrollRectangle,lpClipRectangle,dwDestinationOrigin,lpFill);
  return BVar1;
}



BOOL ScrollConsoleScreenBufferW
               (HANDLE hConsoleOutput,SMALL_RECT *lpScrollRectangle,SMALL_RECT *lpClipRectangle,
               COORD dwDestinationOrigin,CHAR_INFO *lpFill)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025510. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25510  1255  ScrollConsoleScreenBufferW
  BVar1 = ScrollConsoleScreenBufferW
                    (hConsoleOutput,lpScrollRectangle,lpClipRectangle,dwDestinationOrigin,lpFill);
  return BVar1;
}



BOOL SetConsoleActiveScreenBuffer(HANDLE hConsoleOutput)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025520. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25520  1272  SetConsoleActiveScreenBuffer
  BVar1 = SetConsoleActiveScreenBuffer(hConsoleOutput);
  return BVar1;
}



BOOL SetConsoleCP(UINT wCodePageID)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025530. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25530  1273  SetConsoleCP
  BVar1 = SetConsoleCP(wCodePageID);
  return BVar1;
}



BOOL SetConsoleCursorInfo(HANDLE hConsoleOutput,CONSOLE_CURSOR_INFO *lpConsoleCursorInfo)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025540. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25540  1276  SetConsoleCursorInfo
  BVar1 = SetConsoleCursorInfo(hConsoleOutput,lpConsoleCursorInfo);
  return BVar1;
}



BOOL SetConsoleCursorPosition(HANDLE hConsoleOutput,COORD dwCursorPosition)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025550. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25550  1278  SetConsoleCursorPosition
  BVar1 = SetConsoleCursorPosition(hConsoleOutput,dwCursorPosition);
  return BVar1;
}



BOOL SetConsoleOutputCP(UINT wCodePageID)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025560. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25560  1295  SetConsoleOutputCP
  BVar1 = SetConsoleOutputCP(wCodePageID);
  return BVar1;
}



BOOL SetConsoleScreenBufferInfoEx
               (HANDLE hConsoleOutput,PCONSOLE_SCREEN_BUFFER_INFOEX lpConsoleScreenBufferInfoEx)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025570. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25570  1297  SetConsoleScreenBufferInfoEx
  BVar1 = SetConsoleScreenBufferInfoEx(hConsoleOutput,lpConsoleScreenBufferInfoEx);
  return BVar1;
}



BOOL SetConsoleScreenBufferSize(HANDLE hConsoleOutput,COORD dwSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025580. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25580  1298  SetConsoleScreenBufferSize
  BVar1 = SetConsoleScreenBufferSize(hConsoleOutput,dwSize);
  return BVar1;
}



BOOL SetConsoleTextAttribute(HANDLE hConsoleOutput,WORD wAttributes)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025590. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25590  1299  SetConsoleTextAttribute
  BVar1 = SetConsoleTextAttribute(hConsoleOutput,wAttributes);
  return BVar1;
}



BOOL SetConsoleTitleA(LPCSTR lpConsoleTitle)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800255a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x255a0  1300  SetConsoleTitleA
  BVar1 = SetConsoleTitleA(lpConsoleTitle);
  return BVar1;
}



BOOL SetConsoleTitleW(LPCWSTR lpConsoleTitle)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800255b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x255b0  1301  SetConsoleTitleW
  BVar1 = SetConsoleTitleW(lpConsoleTitle);
  return BVar1;
}



BOOL SetConsoleWindowInfo(HANDLE hConsoleOutput,BOOL bAbsolute,SMALL_RECT *lpConsoleWindow)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800255c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x255c0  1302  SetConsoleWindowInfo
  BVar1 = SetConsoleWindowInfo(hConsoleOutput,bAbsolute,lpConsoleWindow);
  return BVar1;
}



BOOL WriteConsoleInputA(HANDLE hConsoleInput,INPUT_RECORD *lpBuffer,DWORD nLength,
                       LPDWORD lpNumberOfEventsWritten)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800255d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x255d0  1564  WriteConsoleInputA
  BVar1 = WriteConsoleInputA(hConsoleInput,lpBuffer,nLength,lpNumberOfEventsWritten);
  return BVar1;
}



BOOL WriteConsoleInputW(HANDLE hConsoleInput,INPUT_RECORD *lpBuffer,DWORD nLength,
                       LPDWORD lpNumberOfEventsWritten)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800255e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x255e0  1567  WriteConsoleInputW
  BVar1 = WriteConsoleInputW(hConsoleInput,lpBuffer,nLength,lpNumberOfEventsWritten);
  return BVar1;
}



BOOL WriteConsoleOutputA(HANDLE hConsoleOutput,CHAR_INFO *lpBuffer,COORD dwBufferSize,
                        COORD dwBufferCoord,PSMALL_RECT lpWriteRegion)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800255f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x255f0  1568  WriteConsoleOutputA
  BVar1 = WriteConsoleOutputA(hConsoleOutput,lpBuffer,dwBufferSize,dwBufferCoord,lpWriteRegion);
  return BVar1;
}



BOOL WriteConsoleOutputAttribute
               (HANDLE hConsoleOutput,WORD *lpAttribute,DWORD nLength,COORD dwWriteCoord,
               LPDWORD lpNumberOfAttrsWritten)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025600. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25600  1569  WriteConsoleOutputAttribute
  BVar1 = WriteConsoleOutputAttribute
                    (hConsoleOutput,lpAttribute,nLength,dwWriteCoord,lpNumberOfAttrsWritten);
  return BVar1;
}



BOOL WriteConsoleOutputCharacterA
               (HANDLE hConsoleOutput,LPCSTR lpCharacter,DWORD nLength,COORD dwWriteCoord,
               LPDWORD lpNumberOfCharsWritten)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025610. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25610  1570  WriteConsoleOutputCharacterA
  BVar1 = WriteConsoleOutputCharacterA
                    (hConsoleOutput,lpCharacter,nLength,dwWriteCoord,lpNumberOfCharsWritten);
  return BVar1;
}



BOOL WriteConsoleOutputCharacterW
               (HANDLE hConsoleOutput,LPCWSTR lpCharacter,DWORD nLength,COORD dwWriteCoord,
               LPDWORD lpNumberOfCharsWritten)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025620. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25620  1571  WriteConsoleOutputCharacterW
  BVar1 = WriteConsoleOutputCharacterW
                    (hConsoleOutput,lpCharacter,nLength,dwWriteCoord,lpNumberOfCharsWritten);
  return BVar1;
}



BOOL WriteConsoleOutputW(HANDLE hConsoleOutput,CHAR_INFO *lpBuffer,COORD dwBufferSize,
                        COORD dwBufferCoord,PSMALL_RECT lpWriteRegion)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025630. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25630  1572  WriteConsoleOutputW
  BVar1 = WriteConsoleOutputW(hConsoleOutput,lpBuffer,dwBufferSize,dwBufferCoord,lpWriteRegion);
  return BVar1;
}



BOOL AddConsoleAliasA(LPSTR Source,LPSTR Target,LPSTR ExeName)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025640. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25640  7  AddConsoleAliasA
  BVar1 = AddConsoleAliasA(Source,Target,ExeName);
  return BVar1;
}



BOOL AddConsoleAliasW(LPWSTR Source,LPWSTR Target,LPWSTR ExeName)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025650. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25650  8  AddConsoleAliasW
  BVar1 = AddConsoleAliasW(Source,Target,ExeName);
  return BVar1;
}



void ExpungeConsoleCommandHistoryA(void)

{
                    // WARNING: Could not recover jumptable at 0x000180025660. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25660  365  ExpungeConsoleCommandHistoryA
  ExpungeConsoleCommandHistoryA();
  return;
}



void ExpungeConsoleCommandHistoryW(void)

{
                    // WARNING: Could not recover jumptable at 0x000180025670. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25670  366  ExpungeConsoleCommandHistoryW
  ExpungeConsoleCommandHistoryW();
  return;
}



DWORD GetConsoleAliasA(LPSTR Source,LPSTR TargetBuffer,DWORD TargetBufferLength,LPSTR ExeName)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025680. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25680  490  GetConsoleAliasA
  DVar1 = GetConsoleAliasA(Source,TargetBuffer,TargetBufferLength,ExeName);
  return DVar1;
}



DWORD GetConsoleAliasExesA(LPSTR ExeNameBuffer,DWORD ExeNameBufferLength)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025690. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25690  491  GetConsoleAliasExesA
  DVar1 = GetConsoleAliasExesA(ExeNameBuffer,ExeNameBufferLength);
  return DVar1;
}



DWORD GetConsoleAliasExesLengthA(void)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800256a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x256a0  492  GetConsoleAliasExesLengthA
  DVar1 = GetConsoleAliasExesLengthA();
  return DVar1;
}



DWORD GetConsoleAliasExesLengthW(void)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800256b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x256b0  493  GetConsoleAliasExesLengthW
  DVar1 = GetConsoleAliasExesLengthW();
  return DVar1;
}



DWORD GetConsoleAliasExesW(LPWSTR ExeNameBuffer,DWORD ExeNameBufferLength)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800256c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x256c0  494  GetConsoleAliasExesW
  DVar1 = GetConsoleAliasExesW(ExeNameBuffer,ExeNameBufferLength);
  return DVar1;
}



DWORD GetConsoleAliasW(LPWSTR Source,LPWSTR TargetBuffer,DWORD TargetBufferLength,LPWSTR ExeName)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800256d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x256d0  495  GetConsoleAliasW
  DVar1 = GetConsoleAliasW(Source,TargetBuffer,TargetBufferLength,ExeName);
  return DVar1;
}



DWORD GetConsoleAliasesA(LPSTR AliasBuffer,DWORD AliasBufferLength,LPSTR ExeName)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800256e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x256e0  496  GetConsoleAliasesA
  DVar1 = GetConsoleAliasesA(AliasBuffer,AliasBufferLength,ExeName);
  return DVar1;
}



DWORD GetConsoleAliasesLengthA(LPSTR ExeName)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800256f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x256f0  497  GetConsoleAliasesLengthA
  DVar1 = GetConsoleAliasesLengthA(ExeName);
  return DVar1;
}



DWORD GetConsoleAliasesLengthW(LPWSTR ExeName)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025700. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25700  498  GetConsoleAliasesLengthW
  DVar1 = GetConsoleAliasesLengthW(ExeName);
  return DVar1;
}



DWORD GetConsoleAliasesW(LPWSTR AliasBuffer,DWORD AliasBufferLength,LPWSTR ExeName)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025710. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25710  499  GetConsoleAliasesW
  DVar1 = GetConsoleAliasesW(AliasBuffer,AliasBufferLength,ExeName);
  return DVar1;
}



void GetConsoleCommandHistoryA(void)

{
                    // WARNING: Could not recover jumptable at 0x000180025720. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25720  502  GetConsoleCommandHistoryA
  GetConsoleCommandHistoryA();
  return;
}



void GetConsoleCommandHistoryLengthA(void)

{
                    // WARNING: Could not recover jumptable at 0x000180025730. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25730  503  GetConsoleCommandHistoryLengthA
  GetConsoleCommandHistoryLengthA();
  return;
}



void GetConsoleCommandHistoryLengthW(void)

{
                    // WARNING: Could not recover jumptable at 0x000180025740. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25740  504  GetConsoleCommandHistoryLengthW
  GetConsoleCommandHistoryLengthW();
  return;
}



void GetConsoleCommandHistoryW(void)

{
                    // WARNING: Could not recover jumptable at 0x000180025750. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25750  505  GetConsoleCommandHistoryW
  GetConsoleCommandHistoryW();
  return;
}



BOOL GetConsoleDisplayMode(LPDWORD lpModeFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025760. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25760  508  GetConsoleDisplayMode
  BVar1 = GetConsoleDisplayMode(lpModeFlags);
  return BVar1;
}



COORD GetConsoleFontSize(HANDLE hConsoleOutput,DWORD nFont)

{
  COORD CVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025770. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25770  510  GetConsoleFontSize
  CVar1 = GetConsoleFontSize(hConsoleOutput,nFont);
  return CVar1;
}



BOOL GetConsoleHistoryInfo(PCONSOLE_HISTORY_INFO lpConsoleHistoryInfo)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025780. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25780  512  GetConsoleHistoryInfo
  BVar1 = GetConsoleHistoryInfo(lpConsoleHistoryInfo);
  return BVar1;
}



DWORD GetConsoleProcessList(LPDWORD lpdwProcessList,DWORD dwProcessCount)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025790. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25790  523  GetConsoleProcessList
  DVar1 = GetConsoleProcessList(lpdwProcessList,dwProcessCount);
  return DVar1;
}



BOOL GetConsoleSelectionInfo(PCONSOLE_SELECTION_INFO lpConsoleSelectionInfo)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800257a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x257a0  526  GetConsoleSelectionInfo
  BVar1 = GetConsoleSelectionInfo(lpConsoleSelectionInfo);
  return BVar1;
}



HWND GetConsoleWindow(void)

{
  HWND pHVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800257b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x257b0  529  GetConsoleWindow
  pHVar1 = GetConsoleWindow();
  return pHVar1;
}



BOOL GetCurrentConsoleFont
               (HANDLE hConsoleOutput,BOOL bMaximumWindow,PCONSOLE_FONT_INFO lpConsoleCurrentFont)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800257c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x257c0  536  GetCurrentConsoleFont
  BVar1 = GetCurrentConsoleFont(hConsoleOutput,bMaximumWindow,lpConsoleCurrentFont);
  return BVar1;
}



BOOL GetCurrentConsoleFontEx
               (HANDLE hConsoleOutput,BOOL bMaximumWindow,
               PCONSOLE_FONT_INFOEX lpConsoleCurrentFontEx)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800257d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x257d0  537  GetCurrentConsoleFontEx
  BVar1 = GetCurrentConsoleFontEx(hConsoleOutput,bMaximumWindow,lpConsoleCurrentFontEx);
  return BVar1;
}



BOOL GetNumberOfConsoleMouseButtons(LPDWORD lpNumberOfMouseButtons)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800257e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x257e0  673  GetNumberOfConsoleMouseButtons
  BVar1 = GetNumberOfConsoleMouseButtons(lpNumberOfMouseButtons);
  return BVar1;
}



BOOL SetConsoleDisplayMode(HANDLE hConsoleOutput,DWORD dwFlags,PCOORD lpNewScreenBufferDimensions)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800257f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x257f0  1279  SetConsoleDisplayMode
  BVar1 = SetConsoleDisplayMode(hConsoleOutput,dwFlags,lpNewScreenBufferDimensions);
  return BVar1;
}



BOOL SetConsoleHistoryInfo(PCONSOLE_HISTORY_INFO lpConsoleHistoryInfo)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025800. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25800  1282  SetConsoleHistoryInfo
  BVar1 = SetConsoleHistoryInfo(lpConsoleHistoryInfo);
  return BVar1;
}



void SetConsoleNumberOfCommandsA(void)

{
                    // WARNING: Could not recover jumptable at 0x000180025810. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25810  1292  SetConsoleNumberOfCommandsA
  SetConsoleNumberOfCommandsA();
  return;
}



void SetConsoleNumberOfCommandsW(void)

{
                    // WARNING: Could not recover jumptable at 0x000180025820. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25820  1293  SetConsoleNumberOfCommandsW
  SetConsoleNumberOfCommandsW();
  return;
}



BOOL SetCurrentConsoleFontEx
               (HANDLE hConsoleOutput,BOOL bMaximumWindow,
               PCONSOLE_FONT_INFOEX lpConsoleCurrentFontEx)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180025830. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x25830  1304  SetCurrentConsoleFontEx
  BVar1 = SetCurrentConsoleFontEx(hConsoleOutput,bMaximumWindow,lpConsoleCurrentFontEx);
  return BVar1;
}



void DelayLoad_QueryOOBESupport
               (undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
               undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = (code *)FUN_18007d510(&ImgDelayDescr_180098e40,&QueryOOBESupport_exref);
                    // WARNING: Could not recover jumptable at 0x0001800258bf. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8);
  return;
}



uint FUN_1800258c8(void)

{
  uint in_EAX;
  uint uVar1;
  
  if (DAT_1800b29d8 == 1) {
    uVar1 = in_EAX & 0xffffff00 | 1;
  }
  else {
    if ((DAT_1800b29d8 != 2) && (in_EAX = ApiSetQueryApiSetPresence(), -1 < (int)in_EAX)) {
      DAT_1800b29d8 = 2;
      return in_EAX & 0xffffff00;
    }
    uVar1 = in_EAX & 0xffffff00;
  }
  return uVar1;
}



void NtApphelpCacheControl(void)

{
                    // WARNING: Could not recover jumptable at 0x000180025920. Too many branches
                    // WARNING: Treating indirect jump as call
  NtApphelpCacheControl();
  return;
}



void DelayLoad_RpcAsyncInitializeHandle
               (undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
               undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE =
       (code *)FUN_18007d510(&ImgDelayDescr_180098e60,&RpcAsyncInitializeHandle_exref);
                    // WARNING: Could not recover jumptable at 0x0001800259af. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8);
  return;
}



void DelayLoad_RpcBindingFromStringBindingW
               (undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
               undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE =
       (code *)FUN_18007d510(&ImgDelayDescr_180098e60,&RpcBindingFromStringBindingW_exref);
                    // WARNING: Could not recover jumptable at 0x0001800259af. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8);
  return;
}



void DelayLoad_RpcStringBindingComposeW
               (undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
               undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE =
       (code *)FUN_18007d510(&ImgDelayDescr_180098e60,&RpcStringBindingComposeW_exref);
                    // WARNING: Could not recover jumptable at 0x0001800259af. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8);
  return;
}



void DelayLoad_I_RpcExceptionFilter
               (undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
               undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE =
       (code *)FUN_18007d510(&ImgDelayDescr_180098e60,&I_RpcExceptionFilter_exref);
                    // WARNING: Could not recover jumptable at 0x0001800259af. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8);
  return;
}



void DelayLoad_RpcAsyncCompleteCall
               (undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
               undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE =
       (code *)FUN_18007d510(&ImgDelayDescr_180098e60,&RpcAsyncCompleteCall_exref);
                    // WARNING: Could not recover jumptable at 0x0001800259af. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8);
  return;
}



void DelayLoad_RpcBindingSetAuthInfoExW
               (undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
               undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE =
       (code *)FUN_18007d510(&ImgDelayDescr_180098e60,&RpcBindingSetAuthInfoExW_exref);
                    // WARNING: Could not recover jumptable at 0x0001800259af. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8);
  return;
}



void DelayLoad_RpcStringFreeW
               (undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
               undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = (code *)FUN_18007d510(&ImgDelayDescr_180098e60,&RpcStringFreeW_exref);
                    // WARNING: Could not recover jumptable at 0x0001800259af. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8);
  return;
}



void DelayLoad_RpcAsyncCancelCall
               (undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
               undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = (code *)FUN_18007d510(&ImgDelayDescr_180098e60,&RpcAsyncCancelCall_exref);
                    // WARNING: Could not recover jumptable at 0x0001800259af. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8);
  return;
}



void DelayLoad_RpcBindingFree
               (undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
               undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = (code *)FUN_18007d510(&ImgDelayDescr_180098e60,&RpcBindingFree_exref);
                    // WARNING: Could not recover jumptable at 0x0001800259af. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8);
  return;
}



void DelayLoad_Ndr64AsyncClientCall
               (undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
               undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE =
       (code *)FUN_18007d510(&ImgDelayDescr_180098e60,&Ndr64AsyncClientCall_exref);
                    // WARNING: Could not recover jumptable at 0x0001800259af. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8);
  return;
}



void ApiSetQueryApiSetPresence(void)

{
                    // WARNING: Could not recover jumptable at 0x000180025a60. Too many branches
                    // WARNING: Treating indirect jump as call
  ApiSetQueryApiSetPresence();
  return;
}



void FUN_180025a70(SIZE_T param_1)

{
  HANDLE hHeap;
  
  hHeap = GetProcessHeap();
                    // WARNING: Could not recover jumptable at 0x000180025a92. Too many branches
                    // WARNING: Treating indirect jump as call
  HeapAlloc(hHeap,0,param_1);
  return;
}



void FUN_180025ab0(LPVOID param_1)

{
  HANDLE hHeap;
  
  hHeap = GetProcessHeap();
                    // WARNING: Could not recover jumptable at 0x000180025ad2. Too many branches
                    // WARNING: Treating indirect jump as call
  HeapFree(hHeap,0,param_1);
  return;
}



void BasepFinishPackageActivationForSxS
               (undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
               undefined8 param_5,undefined4 *param_6)

{
                    // 0x25af0  85  BasepFinishPackageActivationForSxS
  FUN_180025e70(param_1,param_2,param_3,param_3,param_4,param_5,param_6);
  return;
}



// WARNING: Removing unreachable block (ram,0x0001800260fa)

void BasepGetPackageActivationTokenForSxS(undefined8 param_1,undefined8 param_2,HANDLE *param_3)

{
  uint uVar1;
  DWORD DVar2;
  _RPC_ASYNC_STATE *_Dst;
  undefined8 uVar3;
  RPC_BINDING_HANDLE *ppvVar4;
  undefined auStack264 [32];
  RPC_BINDING_HANDLE pvStack232;
  undefined8 uStack224;
  undefined8 uStack216;
  HANDLE *ppvStack208;
  RPC_BINDING_HANDLE pvStack200;
  int iStack192;
  HANDLE *ppvStack184;
  _RPC_ASYNC_STATE _Stack168;
  ulonglong uStack56;
  
                    // 0x25b30  91  BasepGetPackageActivationTokenForSxS
  uStack56 = DAT_1800b2220 ^ (ulonglong)auStack264;
  *param_3 = (HANDLE)0x0;
  uVar3 = 0;
  ppvVar4 = (RPC_BINDING_HANDLE *)0x70;
  _Dst = &_Stack168;
  ppvStack184 = param_3;
  memset(_Dst,0,0x70);
  pvStack200 = (RPC_BINDING_HANDLE)0x0;
  iStack192 = 0;
  uVar1 = FUN_180025df8();
  *param_3 = (HANDLE)0x0;
  if ((DAT_1800b2d30 == (RPC_BINDING_HANDLE)0x0) || (uVar1 != 0)) {
    ppvVar4 = &pvStack200;
    DVar2 = FUN_180025c70(_Dst,(DWORD)uVar3,ppvVar4);
    if (DVar2 != 0) goto LAB_180026177;
  }
  if ((DAT_1800b2d30 == (RPC_BINDING_HANDLE)0x0) && (uVar1 == 0)) {
    LOCK();
    DAT_1800b2d30 = pvStack200;
    pvStack200 = (RPC_BINDING_HANDLE)0x0;
  }
  DVar2 = FUN_180025c04(&_Stack168);
  if (DVar2 == 0) {
    pvStack232 = DAT_1800b2d30;
    if (pvStack200 != (RPC_BINDING_HANDLE)0x0) {
      pvStack232 = pvStack200;
    }
    ppvVar4 = (RPC_BINDING_HANDLE *)0x0;
    uVar3 = 2;
    uStack224 = param_1;
    uStack216 = param_2;
    ppvStack208 = param_3;
    Ndr64AsyncClientCall((MIDL_STUBLESS_PROXY_INFO *)&PTR_PTR_DAT_18007f7b8,2,(void *)0x0);
    iStack192 = 1;
  }
LAB_180026177:
  if (iStack192 != 0) {
    DVar2 = FUN_180025b6c(&_Stack168,uVar3,ppvVar4,DVar2);
  }
  FUN_180025b3c((longlong)&_Stack168);
  if (DVar2 != 0) {
    CloseHandle(*param_3);
    *param_3 = (HANDLE)0x0;
  }
  if (pvStack200 != (RPC_BINDING_HANDLE)0x0) {
    RpcBindingFree(&pvStack200);
  }
  __security_check_cookie(uStack56 ^ (ulonglong)auStack264);
  return;
}



void FUN_180025b3c(longlong param_1)

{
  if (*(HANDLE *)(param_1 + 0x30) != (HANDLE)0x0) {
    CloseHandle(*(HANDLE *)(param_1 + 0x30));
    *(undefined8 *)(param_1 + 0x30) = 0;
  }
  return;
}



DWORD FUN_180025b6c(PRPC_ASYNC_STATE param_1,undefined8 param_2,undefined8 param_3,DWORD param_4)

{
  DWORD DVar1;
  DWORD local_res18 [4];
  
  local_res18[0] = 0;
  if (param_4 == 0) {
    param_4 = WaitForSingleObject(*(HANDLE *)&param_1->u,0xffffffff);
  }
  if (param_4 == 0x102) {
    RpcAsyncCancelCall(param_1,1);
    WaitForSingleObject(*(HANDLE *)&param_1->u,0xffffffff);
  }
  DVar1 = RpcAsyncCompleteCall(param_1,local_res18);
  if ((param_4 == 0) && (param_4 = local_res18[0], DVar1 != 0)) {
    param_4 = DVar1;
  }
  return param_4;
}



DWORD FUN_180025c04(PRPC_ASYNC_STATE param_1)

{
  DWORD DVar1;
  HANDLE pvVar2;
  
  DVar1 = RpcAsyncInitializeHandle(param_1,0x70);
  if (DVar1 == 0) {
    param_1->NotificationType = RpcNotificationTypeEvent;
    pvVar2 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCWSTR)0x0);
    *(HANDLE *)&param_1->u = pvVar2;
    if (pvVar2 == (HANDLE)0x0) {
      DVar1 = GetLastError();
    }
  }
  return DVar1;
}



// WARNING: Could not reconcile some variable overlaps

DWORD FUN_180025c70(undefined8 param_1,DWORD param_2,RPC_BINDING_HANDLE *param_3)

{
  RPC_BINDING_HANDLE pvVar1;
  DWORD DVar2;
  BOOL BVar3;
  HLOCAL pSid;
  RPC_BINDING_HANDLE local_res8;
  DWORD local_res10 [2];
  RPC_WSTR local_res20;
  undefined local_48 [8];
  undefined8 uStack64;
  undefined local_38 [16];
  HLOCAL local_28;
  
  local_res20 = (RPC_WSTR)0x0;
  local_res8 = (RPC_BINDING_HANDLE)0x0;
  local_28 = (HLOCAL)0x0;
  pSid = (HLOCAL)0x0;
  _local_48 = ZEXT816(0);
  local_38 = ZEXT816(0);
  local_res10[0] = param_2;
  DVar2 = RpcStringBindingComposeW
                    ((RPC_WSTR)L"0497B57D-2E66-424F-A0C6-157CD5D41700",(RPC_WSTR)L"ncalrpc",
                     (RPC_WSTR)0x0,(RPC_WSTR)0x0,(RPC_WSTR)0x0,&local_res20);
  if (DVar2 == 0) {
    DVar2 = RpcBindingFromStringBindingW(local_res20,&local_res8);
    RpcStringFreeW(&local_res20);
    if (DVar2 == 0) {
      local_res10[0] = 0x44;
      pSid = LocalAlloc(0x40,0x44);
      if (pSid == (HLOCAL)0x0) {
        DVar2 = 8;
      }
      else {
        BVar3 = CreateWellKnownSid(WinLocalSystemSid,(PSID)0x0,pSid,local_res10);
        if (BVar3 == 0) {
          DVar2 = GetLastError();
        }
        else {
          _local_48 = ZEXT812(local_48);
          _local_48 = CONCAT124(stack0xffffffffffffffbc,3);
          _local_48 = CONCAT412(3,_local_48);
          _local_48 = CONCAT88(uStack64,0x100000003);
          local_28 = pSid;
          DVar2 = RpcBindingSetAuthInfoExW
                            (local_res8,(RPC_WSTR)0x0,6,10,(RPC_AUTH_IDENTITY_HANDLE)0x0,0,
                             (RPC_SECURITY_QOS *)local_48);
          pvVar1 = local_res8;
          if (DVar2 == 0) {
            local_res8 = (RPC_BINDING_HANDLE)0x0;
            *param_3 = pvVar1;
          }
        }
      }
    }
  }
  LocalFree(pSid);
  if (local_res8 != (RPC_BINDING_HANDLE)0x0) {
    RpcBindingFree(&local_res8);
  }
  return DVar2;
}



uint FUN_180025df8(void)

{
  uint uVar1;
  DWORD dwProcessId;
  DWORD local_res8 [2];
  DWORD local_res10 [2];
  DWORD local_res18 [4];
  
  local_res10[0] = 0;
  local_res8[0] = 0;
  local_res18[0] = 4;
  uVar1 = GetTokenInformation((HANDLE)0xfffffffffffffffb,TokenSessionId,local_res10,4,local_res18);
  if (uVar1 != 0) {
    dwProcessId = GetCurrentProcessId();
    ProcessIdToSessionId(dwProcessId,local_res8);
    uVar1 = (uint)(local_res10[0] != local_res8[0]);
  }
  return uVar1;
}



// WARNING: Removing unreachable block (ram,0x000180025f2d)

void FUN_180025e70(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
                  undefined8 param_5,undefined8 param_6,undefined4 *param_7)

{
  uint uVar1;
  DWORD DVar2;
  _RPC_ASYNC_STATE *_Dst;
  undefined8 uVar3;
  RPC_BINDING_HANDLE *ppvVar4;
  undefined auStack296 [32];
  RPC_BINDING_HANDLE local_108;
  undefined8 local_100;
  undefined8 local_f8;
  undefined4 local_f0;
  undefined8 local_e8;
  undefined8 local_e0;
  undefined8 local_d8;
  undefined4 *local_d0;
  RPC_BINDING_HANDLE local_c8;
  int local_c0;
  undefined8 local_b8;
  undefined8 local_b0;
  _RPC_ASYNC_STATE local_a8;
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack296;
  local_b0 = param_5;
  local_b8 = param_6;
  uVar3 = 0;
  ppvVar4 = (RPC_BINDING_HANDLE *)0x70;
  _Dst = &local_a8;
  memset(_Dst,0,0x70);
  local_c8 = (RPC_BINDING_HANDLE)0x0;
  local_c0 = 0;
  uVar1 = FUN_180025df8();
  *param_7 = 0;
  if ((DAT_1800b2d28 == (RPC_BINDING_HANDLE)0x0) || (uVar1 != 0)) {
    ppvVar4 = &local_c8;
    DVar2 = FUN_180025c70(_Dst,(DWORD)uVar3,ppvVar4);
    if (DVar2 != 0) goto LAB_180025fc8;
  }
  if ((DAT_1800b2d28 == (RPC_BINDING_HANDLE)0x0) && (uVar1 == 0)) {
    LOCK();
    DAT_1800b2d28 = local_c8;
    local_c8 = (RPC_BINDING_HANDLE)0x0;
  }
  DVar2 = FUN_180025c04(&local_a8);
  if (DVar2 == 0) {
    local_108 = DAT_1800b2d28;
    if (local_c8 != (RPC_BINDING_HANDLE)0x0) {
      local_108 = local_c8;
    }
    local_d0 = param_7;
    local_d8 = local_b8;
    local_e0 = local_b0;
    local_f0 = 0;
    ppvVar4 = (RPC_BINDING_HANDLE *)0x0;
    uVar3 = 3;
    local_100 = param_1;
    local_f8 = param_2;
    local_e8 = param_4;
    Ndr64AsyncClientCall((MIDL_STUBLESS_PROXY_INFO *)&PTR_PTR_DAT_18007f7b8,3,(void *)0x0);
    local_c0 = 1;
  }
LAB_180025fc8:
  if (local_c0 != 0) {
    FUN_180025b6c(&local_a8,uVar3,ppvVar4,DVar2);
  }
  FUN_180025b3c((longlong)&local_a8);
  if (local_c8 != (RPC_BINDING_HANDLE)0x0) {
    RpcBindingFree(&local_c8);
  }
  __security_check_cookie(local_38 ^ (ulonglong)auStack296);
  return;
}



void FUN_180026033(ulong **param_1)

{
  I_RpcExceptionFilter(**param_1);
  return;
}



// WARNING: Removing unreachable block (ram,0x0001800260fa)

void FUN_18002605c(undefined8 param_1,undefined8 param_2,HANDLE *param_3)

{
  uint uVar1;
  DWORD DVar2;
  _RPC_ASYNC_STATE *_Dst;
  undefined8 uVar3;
  RPC_BINDING_HANDLE *ppvVar4;
  undefined auStack264 [32];
  RPC_BINDING_HANDLE local_e8;
  undefined8 local_e0;
  undefined8 local_d8;
  HANDLE *local_d0;
  RPC_BINDING_HANDLE local_c8;
  int local_c0;
  HANDLE *local_b8;
  _RPC_ASYNC_STATE local_a8;
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack264;
  *param_3 = (HANDLE)0x0;
  uVar3 = 0;
  ppvVar4 = (RPC_BINDING_HANDLE *)0x70;
  _Dst = &local_a8;
  local_b8 = param_3;
  memset(_Dst,0,0x70);
  local_c8 = (RPC_BINDING_HANDLE)0x0;
  local_c0 = 0;
  uVar1 = FUN_180025df8();
  *param_3 = (HANDLE)0x0;
  if ((DAT_1800b2d30 == (RPC_BINDING_HANDLE)0x0) || (uVar1 != 0)) {
    ppvVar4 = &local_c8;
    DVar2 = FUN_180025c70(_Dst,(DWORD)uVar3,ppvVar4);
    if (DVar2 != 0) goto LAB_180026177;
  }
  if ((DAT_1800b2d30 == (RPC_BINDING_HANDLE)0x0) && (uVar1 == 0)) {
    LOCK();
    DAT_1800b2d30 = local_c8;
    local_c8 = (RPC_BINDING_HANDLE)0x0;
  }
  DVar2 = FUN_180025c04(&local_a8);
  if (DVar2 == 0) {
    local_e8 = DAT_1800b2d30;
    if (local_c8 != (RPC_BINDING_HANDLE)0x0) {
      local_e8 = local_c8;
    }
    ppvVar4 = (RPC_BINDING_HANDLE *)0x0;
    uVar3 = 2;
    local_e0 = param_1;
    local_d8 = param_2;
    local_d0 = param_3;
    Ndr64AsyncClientCall((MIDL_STUBLESS_PROXY_INFO *)&PTR_PTR_DAT_18007f7b8,2,(void *)0x0);
    local_c0 = 1;
  }
LAB_180026177:
  if (local_c0 != 0) {
    DVar2 = FUN_180025b6c(&local_a8,uVar3,ppvVar4,DVar2);
  }
  FUN_180025b3c((longlong)&local_a8);
  if (DVar2 != 0) {
    CloseHandle(*param_3);
    *param_3 = (HANDLE)0x0;
  }
  if (local_c8 != (RPC_BINDING_HANDLE)0x0) {
    RpcBindingFree(&local_c8);
  }
  __security_check_cookie(local_38 ^ (ulonglong)auStack264);
  return;
}



void FUN_1800261ea(ulong **param_1)

{
  I_RpcExceptionFilter(**param_1);
  return;
}



void _guard_check_icall(void)

{
  return;
}



// Library Function - Single Match
//  __GSHandlerCheck
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

undefined8
__GSHandlerCheck(undefined8 param_1,ulonglong param_2,undefined8 param_3,longlong param_4)

{
  __GSHandlerCheckCommon(param_2,param_4,*(uint **)(param_4 + 0x38));
  return 1;
}



// Library Function - Single Match
//  __GSHandlerCheckCommon
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __GSHandlerCheckCommon(ulonglong param_1,longlong param_2,uint *param_3)

{
  ulonglong uVar1;
  ulonglong uVar2;
  
  uVar2 = param_1;
  if ((*(byte *)param_3 & 4) != 0) {
    uVar2 = (longlong)(int)param_3[1] + param_1 & (longlong)(int)-param_3[2];
  }
  uVar1 = (ulonglong)*(uint *)(*(longlong *)(param_2 + 0x10) + 8);
  if ((*(byte *)(uVar1 + 3 + *(longlong *)(param_2 + 8)) & 0xf) != 0) {
    param_1 = param_1 + (*(byte *)(uVar1 + 3 + *(longlong *)(param_2 + 8)) & 0xfffffff0);
  }
  __security_check_cookie(param_1 ^ *(ulonglong *)((longlong)(int)(*param_3 & 0xfffffff8) + uVar2));
  return;
}



// Library Function - Single Match
//  __GSHandlerCheck_SEH
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

void __GSHandlerCheck_SEH
               (_EXCEPTION_RECORD *param_1,void *param_2,_CONTEXT *param_3,
               _DISPATCHER_CONTEXT *param_4)

{
  uint uVar1;
  uint *puVar2;
  
  puVar2 = *(uint **)(param_4 + 0x38);
  uVar1 = *puVar2;
  __GSHandlerCheckCommon((ulonglong)param_2,(longlong)param_4,puVar2 + (ulonglong)uVar1 * 4 + 1);
  if ((puVar2[(ulonglong)uVar1 * 4 + 1] & ((param_1->ExceptionFlags & 0x66) != 0) + 1) != 0) {
    __C_specific_handler(param_1,param_2,param_3,param_4);
  }
  return;
}



void _local_unwind(void)

{
                    // WARNING: Could not recover jumptable at 0x00018002634b. Too many branches
                    // WARNING: Treating indirect jump as call
  _local_unwind();
  return;
}



double cos(double _X)

{
  double dVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180026357. Too many branches
                    // WARNING: Treating indirect jump as call
  dVar1 = cos(_X);
  return dVar1;
}



double floor(double _X)

{
  double dVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180026363. Too many branches
                    // WARNING: Treating indirect jump as call
  dVar1 = floor(_X);
  return dVar1;
}



int memcmp(void *_Buf1,void *_Buf2,size_t _Size)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018002636f. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = memcmp(_Buf1,_Buf2,_Size);
  return iVar1;
}



void * memcpy(void *_Dst,void *_Src,size_t _Size)

{
  void *pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018002637b. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = memcpy(_Dst,_Src,_Size);
  return pvVar1;
}



void * memset(void *_Dst,int _Val,size_t _Size)

{
  void *pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180026387. Too many branches
                    // WARNING: Treating indirect jump as call
  pvVar1 = memset(_Dst,_Val,_Size);
  return pvVar1;
}



double sin(double _X)

{
  double dVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180026393. Too many branches
                    // WARNING: Treating indirect jump as call
  dVar1 = sin(_X);
  return dVar1;
}



int wcscmp(wchar_t *_Str1,wchar_t *_Str2)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018002639f. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = wcscmp(_Str1,_Str2);
  return iVar1;
}



// Library Function - Single Match
//  TlsGetValue
// 
// Library: Visual Studio

LPVOID TlsGetValue(DWORD dwTlsIndex)

{
  LPVOID pvVar1;
  longlong in_GS_OFFSET;
  
  if (dwTlsIndex < 0x40) {
    pvVar1 = *(LPVOID *)(in_GS_OFFSET + (ulonglong)dwTlsIndex * 8 + 0x1480);
    if (*(int *)(in_GS_OFFSET + 0x68) == 0) {
      return pvVar1;
    }
  }
  else {
    if (0x43f < dwTlsIndex) {
      BaseSetLastNTError();
      return (LPVOID)0x0;
    }
    pvVar1 = *(LPVOID *)(in_GS_OFFSET + 0x1780);
    if (pvVar1 != (LPVOID)0x0) {
      pvVar1 = *(LPVOID *)((longlong)pvVar1 + (ulonglong)dwTlsIndex * 8 + -0x200);
    }
    if (*(int *)(in_GS_OFFSET + 0x68) == 0) {
      return pvVar1;
    }
  }
  *(undefined4 *)(in_GS_OFFSET + 0x68) = 0;
  return pvVar1;
}



// WARNING: This is an inlined function

void _guard_dispatch_icall(void)

{
  code *UNRECOVERED_JUMPTABLE;
  
                    // WARNING: Could not recover jumptable at 0x000180026440. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)();
  return;
}



// WARNING: Could not reconcile some variable overlaps

longlong CreateToolhelp32Snapshot(uint param_1,uint param_2)

{
  int iVar1;
  undefined8 uVar2;
  uint local_res10;
  uint *local_c0;
  uint *local_b8;
  uint local_b0;
  uint local_ac;
  uint *local_a8;
  uint *local_a0;
  uint local_98;
  uint local_94;
  undefined4 local_90;
  undefined4 local_8c;
  undefined4 local_88;
  longlong local_80;
  longlong local_78;
  longlong local_70;
  uint *local_68;
  longlong local_60;
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  uint *local_48;
  longlong local_40;
  uint *local_38;
  longlong local_30;
  longlong local_28;
  undefined8 local_20;
  ulonglong local_18;
  ulonglong local_10;
  
                    // 0x26450  255  CreateToolhelp32Snapshot
  local_70 = -1;
  local_28 = -1;
  local_80 = 0;
  local_60 = 0;
  local_78 = 0;
  local_68 = (uint *)0x0;
  local_b8 = (uint *)0x0;
  local_c0 = (uint *)0x0;
  local_b0 = 0;
  local_ac = 0;
  local_a0 = (uint *)0x0;
  local_a8 = (uint *)0x0;
  local_res10 = param_2;
  if (param_2 == 0) {
    local_res10 = GetCurrentProcessId();
  }
  iVar1 = FUN_18001dd00((ulonglong)param_1,local_res10,&local_80,&local_60,&local_b8,&local_30,
                        &local_78,&local_c0,&local_40);
  if (iVar1 < 0) {
    BaseSetLastNTError();
    goto LAB_1800269c1;
  }
  if (local_c0 != (uint *)0x0) {
    local_a8 = *(uint **)(local_78 + 0x70);
    if ((((local_a8 < local_c0) || (local_a8 + 0x18 < local_a8)) ||
        ((uint *)((longlong)local_c0 + local_40) < local_c0)) ||
       ((uint *)((longlong)local_c0 + local_40) < local_a8 + 0x18)) {
      local_58 = 0;
    }
    else {
      local_58 = 1;
    }
    if ((char)local_58 == '\0') {
      BaseSetLastNTError();
      goto LAB_1800269c1;
    }
    local_b0 = *local_a8;
    if (1 < local_b0) {
      local_98 = FUN_18001f604(local_b0 - 1,0x58,&local_94);
      if ((int)local_98 < 0) {
        BaseSetLastNTError();
        goto LAB_1800269c1;
      }
      local_18 = (ulonglong)local_94;
      local_48 = local_a8 + 0x18;
      if (((local_48 < local_c0) || ((uint *)((longlong)local_48 + local_18) < local_48)) ||
         (((uint *)((longlong)local_c0 + local_40) < local_c0 ||
          ((ulonglong)((longlong)local_c0 + local_40) < (longlong)local_48 + local_18)))) {
        local_54 = 0;
      }
      else {
        local_54 = 1;
      }
      if ((char)local_54 == '\0') {
        BaseSetLastNTError();
        goto LAB_1800269c1;
      }
    }
  }
  if (local_b8 != (uint *)0x0) {
    local_a0 = *(uint **)(local_60 + 0x60);
    if (((local_a0 < local_b8) || (local_a0 + 0x4c < local_a0)) ||
       (((uint *)((longlong)local_b8 + local_30) < local_b8 ||
        ((uint *)((longlong)local_b8 + local_30) < local_a0 + 0x4c)))) {
      local_50 = 0;
    }
    else {
      local_50 = 1;
    }
    if ((char)local_50 == '\0') {
      BaseSetLastNTError();
      goto LAB_1800269c1;
    }
    local_ac = *local_a0;
    if (1 < local_ac) {
      local_98 = FUN_18001f604(local_ac - 1,0x130,&local_94);
      if ((int)local_98 < 0) {
        BaseSetLastNTError();
        goto LAB_1800269c1;
      }
      local_10 = (ulonglong)local_94;
      local_38 = local_a0 + 0x4c;
      if ((((local_38 < local_b8) || ((uint *)((longlong)local_38 + local_10) < local_38)) ||
          ((uint *)((longlong)local_b8 + local_30) < local_b8)) ||
         ((ulonglong)((longlong)local_b8 + local_30) < (longlong)local_38 + local_10)) {
        local_4c = 0;
      }
      else {
        local_4c = 1;
      }
      if ((char)local_4c == '\0') {
        BaseSetLastNTError();
        goto LAB_1800269c1;
      }
    }
  }
  uVar2 = FUN_18001d144(&local_70,&local_68,param_1,(ulonglong)local_res10,local_80,local_ac,
                        local_b0);
  if ((int)uVar2 < 0) {
    BaseSetLastNTError();
  }
  else {
    uVar2 = FUN_18001aae4(param_1,local_res10,local_68,local_80,local_a0,local_78,(longlong)local_a8
                         );
    if ((int)uVar2 < 0) {
      BaseSetLastNTError();
    }
    else {
      local_28 = local_70;
    }
  }
LAB_1800269c1:
  if (local_28 != local_70) {
    iVar1 = NtClose(local_70);
    if (iVar1 < 0) {
      local_90 = 0;
    }
    else {
      local_90 = 1;
    }
  }
  if (local_68 != (uint *)0x0) {
    iVar1 = NtUnmapViewOfSection(0xffffffffffffffff,local_68);
    if (iVar1 < 0) {
      local_8c = 0;
    }
    else {
      local_8c = 1;
    }
  }
  if (local_80 != 0) {
    local_20 = 0;
    iVar1 = NtFreeVirtualMemory(0xffffffffffffffff,&local_80,&local_20,0x8000);
    if (iVar1 < 0) {
      local_88 = 0;
    }
    else {
      local_88 = 1;
    }
  }
  if (local_60 != 0) {
    RtlDestroyQueryDebugBuffer(local_60);
  }
  if (local_78 != 0) {
    RtlDestroyQueryDebugBuffer(local_78);
  }
  return local_28;
}



void FUN_180026af0(undefined8 param_1,longlong param_2)

{
  int iVar1;
  
  if (*(longlong *)(param_2 + 0xf0) != *(longlong *)(param_2 + 0xa8)) {
    iVar1 = NtClose(*(undefined8 *)(param_2 + 0xa8));
    if (iVar1 < 0) {
      *(undefined4 *)(param_2 + 0x88) = 0;
    }
    else {
      *(undefined4 *)(param_2 + 0x88) = 1;
    }
  }
  if (*(longlong *)(param_2 + 0xb0) != 0) {
    iVar1 = NtUnmapViewOfSection(0xffffffffffffffff,*(undefined8 *)(param_2 + 0xb0));
    if (iVar1 < 0) {
      *(undefined4 *)(param_2 + 0x8c) = 0;
    }
    else {
      *(undefined4 *)(param_2 + 0x8c) = 1;
    }
  }
  if (*(longlong *)(param_2 + 0x98) != 0) {
    *(undefined8 *)(param_2 + 0xf8) = 0;
    iVar1 = NtFreeVirtualMemory(0xffffffffffffffff,param_2 + 0x98,param_2 + 0xf8,0x8000);
    if (iVar1 < 0) {
      *(undefined4 *)(param_2 + 0x90) = 0;
    }
    else {
      *(undefined4 *)(param_2 + 0x90) = 1;
    }
  }
  if (*(longlong *)(param_2 + 0xb8) != 0) {
    RtlDestroyQueryDebugBuffer(*(undefined8 *)(param_2 + 0xb8));
  }
  if (*(longlong *)(param_2 + 0xa0) != 0) {
    RtlDestroyQueryDebugBuffer(*(undefined8 *)(param_2 + 0xa0));
  }
  return;
}



void FUN_180026c16(undefined8 param_1,longlong param_2)

{
  longlong in_GS_OFFSET;
  
  if (*(longlong *)(param_2 + 0x40) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x40));
  }
  if (*(longlong *)(param_2 + 0x28) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x28));
  }
  SetErrorMode(*(UINT *)(param_2 + 0x24));
  return;
}



void FUN_180026c8a(undefined8 param_1,longlong param_2)

{
  longlong in_GS_OFFSET;
  
  if (*(longlong *)(param_2 + 0x30) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x30));
  }
  if (*(longlong *)(param_2 + 0x40) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x40));
  }
  return;
}



void FUN_180026cee(undefined8 param_1,longlong param_2)

{
  int iVar1;
  int iVar2;
  
  iVar1 = FUN_18000f1e8(*(longlong *)(param_2 + 0x40));
  iVar2 = *(int *)(param_2 + 0x20);
  if (-1 < *(int *)(param_2 + 0x20)) {
    iVar2 = iVar1;
  }
  *(int *)(param_2 + 0x20) = iVar2;
  return;
}



undefined4 FUN_180026d18(int **param_1,longlong param_2)

{
  *(int ***)(param_2 + 0x40) = param_1;
  *(uint *)(param_2 + 0x38) = (uint)(**param_1 != -0x3fffff03);
  return *(undefined4 *)(param_2 + 0x38);
}



void FUN_180026d46(int **param_1)

{
  FUN_18007c6bc(param_1);
  return;
}



void FUN_180026d62(int **param_1)

{
  FUN_18007c6bc(param_1);
  return;
}



void FUN_180026d7e(int **param_1)

{
  FUN_18007c6bc(param_1);
  return;
}



bool FUN_180026d9a(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



void FUN_180026dba(undefined8 param_1,longlong param_2)

{
  if ((*(char *)(param_2 + 0x98) == '\0') && (*(longlong *)(param_2 + 0x28) == param_2 + 0x38)) {
    RtlFreeUnicodeString();
  }
  return;
}



bool FUN_180026df3(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



void FUN_180026e13(undefined8 param_1,longlong param_2)

{
  if ((*(char *)(param_2 + 0x88) == '\0') && (*(longlong *)(param_2 + 0x28) == param_2 + 0x30)) {
    RtlFreeUnicodeString();
  }
  return;
}



void FUN_180026e4c(undefined8 param_1,longlong param_2)

{
  BaseDllFreeResourceId(*(undefined8 *)(param_2 + 0x30));
  BaseDllFreeResourceId(*(undefined8 *)(param_2 + 0x38));
  return;
}



bool FUN_180026e7d(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



ulonglong FUN_180026ea3(byte param_1,longlong param_2)

{
  ulonglong uVar1;
  
  uVar1 = (ulonglong)param_1;
  if (param_1 != 0) {
    uVar1 = RtlFreeUnicodeString(param_2 + 0x30);
  }
  return uVar1;
}



bool FUN_180026ecb(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



bool FUN_180026ef1(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



void FUN_180026f11(void)

{
                    // WARNING: Could not recover jumptable at 0x000180026f26. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlUnlockHeap(DAT_1800b2a30);
  return;
}



bool FUN_180026f39(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



void FUN_180026f59(void)

{
                    // WARNING: Could not recover jumptable at 0x000180026f6e. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlUnlockHeap(DAT_1800b2a30);
  return;
}



bool FUN_180026f81(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



void FUN_180026fa1(void)

{
  RtlUnlockHeap(DAT_1800b2a30);
  return;
}



bool FUN_180026fcb(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



void FUN_180026feb(void)

{
  RtlUnlockHeap(DAT_1800b2a30);
  return;
}



bool FUN_180027015(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



void FUN_180027035(void)

{
  RtlUnlockHeap(DAT_1800b2a30);
  return;
}



void FUN_18002705f(void)

{
                    // WARNING: Could not recover jumptable at 0x00018002706d. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlReleasePebLock();
  return;
}



bool FUN_180027080(int **param_1)

{
  return **param_1 == -0x3ffffffb;
}



bool FUN_1800270fd(int **param_1)

{
  return **param_1 == -0x3ffffffb;
}



bool FUN_180027123(int **param_1)

{
  return **param_1 == -0x3ffffffb;
}



bool FUN_180027149(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



bool FUN_18002716f(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



void FUN_18002718d(undefined8 param_1,longlong param_2)

{
  if ((undefined *)((longlong)&(*(HMODULE *)(param_2 + 0x58))[-1].unused + 3U) <
      (undefined *)0xfffffffffffffffe) {
    FreeLibrary(*(HMODULE *)(param_2 + 0x58));
  }
  return;
}



bool FUN_1800271be(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



void FUN_1800271de(void)

{
  RtlUnlockHeap(DAT_1800b2a30);
  return;
}



bool FUN_180027208(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



bool FUN_180027226(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



void FUN_180027246(void)

{
  RtlUnlockHeap(DAT_1800b2a30);
  return;
}



ulonglong FUN_180027270(byte param_1,longlong param_2)

{
  ulonglong uVar1;
  longlong in_GS_OFFSET;
  
  uVar1 = (ulonglong)param_1;
  if (((param_1 != 0) || (*(longlong *)(param_2 + 0xb8) == 0)) &&
     (*(longlong *)(param_2 + 0x30) != 0)) {
    uVar1 = RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                        *(undefined8 *)(param_2 + 0x30));
  }
  return uVar1;
}



void FUN_1800272be(void)

{
  RtlReleasePebLock();
  return;
}



bool FUN_1800272e1(int **param_1)

{
  return **param_1 == -0x3ffffffb;
}



void FUN_180027301(void)

{
                    // WARNING: Could not recover jumptable at 0x00018002730f. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlReleasePebLock();
  return;
}



bool FUN_180027322(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



void FUN_180027340(void)

{
                    // WARNING: Could not recover jumptable at 0x000180027350. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlSetCurrentTransaction(0);
  return;
}



void FUN_180027363(undefined8 param_1,longlong param_2)

{
  longlong in_GS_OFFSET;
  
  if (*(longlong *)(param_2 + 0x30) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x30));
  }
  RtlFreeUnicodeString(param_2 + 0x48);
  return;
}



void FUN_1800273b1(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800273c1. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlSetCurrentTransaction(0);
  return;
}



int uaw_lstrlenW(LPCUWSTR String)

{
  int iVar1;
  size_t sVar2;
  
                    // 0x365b0  1628  uaw_lstrlenW
  if (String == (LPCUWSTR)0x0) {
    iVar1 = 0;
  }
  else {
    sVar2 = uaw_wcslen(String);
    iVar1 = (int)sVar2;
  }
  return iVar1;
}



bool FUN_1800365cc(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



short * uaw_wcschr(short *param_1,short param_2)

{
                    // 0x36600  1629  uaw_wcschr
  while( true ) {
    if (*param_1 == param_2) {
      return param_1;
    }
    if (*param_1 == 0) break;
    param_1 = param_1 + 1;
  }
  return (short *)0x0;
}



short * FUN_18003660b(short *param_1,short param_2)

{
  while( true ) {
    if (*param_1 == param_2) {
      return param_1;
    }
    if (*param_1 == 0) break;
    param_1 = param_1 + 1;
  }
  return (short *)0x0;
}



PUWSTR uaw_wcscpy(PUWSTR Destination,PCUWSTR Source)

{
  longlong lVar1;
  
                    // 0x36630  1630  uaw_wcscpy
  *Destination = *Source;
  if (*Source != L'\0') {
    lVar1 = (longlong)Destination - (longlong)Source;
    do {
      Source = Source + 1;
      *(WCHAR *)(lVar1 + (longlong)Source) = *Source;
    } while (*Source != L'\0');
  }
  return Destination;
}



int uaw_wcsicmp(wchar_t *_Str1,wchar_t *_Str2)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180036660. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x36660  1631  uaw_wcsicmp
  iVar1 = _wcsicmp(_Str1,_Str2);
  return iVar1;
}



size_t uaw_wcslen(PCUWSTR String)

{
  WCHAR WVar1;
  WCHAR *pWVar2;
  
                    // 0x36680  1632  uaw_wcslen
  WVar1 = *String;
  pWVar2 = String;
  while (WVar1 != L'\0') {
    pWVar2 = pWVar2 + 1;
    WVar1 = *pWVar2;
  }
  return (longlong)pWVar2 - (longlong)String >> 1;
}



PUWSTR uaw_wcsrchr(PCUWSTR String,WCHAR Character)

{
  PUWSTR pWVar1;
  
                    // 0x366b0  1633  uaw_wcsrchr
  pWVar1 = (PUWSTR)0x0;
  while( true ) {
    if (*String == Character) {
      pWVar1 = String;
    }
    if (*String == L'\0') break;
    String = String + 1;
  }
  return pWVar1;
}



void FUN_1800366d4(HKEY param_1)

{
  WCHAR WVar1;
  LSTATUS LVar2;
  LPCWSTR pvData;
  LPCWSTR lpLibFileName;
  WCHAR *pWVar3;
  DWORD dwFlags;
  longlong in_GS_OFFSET;
  undefined auStackY376 [32];
  DWORD local_138;
  int local_134 [3];
  WCHAR local_128 [128];
  ulonglong local_28;
  
  local_28 = DAT_1800b2220 ^ (ulonglong)auStackY376;
  local_138 = 4;
  dwFlags = 0;
  LVar2 = RegGetValueW(param_1,(LPCWSTR)0x0,L"RequireSignedAppInit_DLLs",0x10,(LPDWORD)0x0,local_134
                       ,&local_138);
  if ((LVar2 == 0) && (local_134[0] != 0)) {
    dwFlags = 0x80;
  }
  local_138 = 0x100;
  pvData = local_128;
  while (LVar2 = RegGetValueW(param_1,(LPCWSTR)0x0,L"AppInit_DLLs",2,(LPDWORD)0x0,pvData,&local_138)
        , LVar2 == 0xea) {
    if (pvData != local_128) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pvData);
    }
    pvData = (LPCWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                                      local_138);
    if (pvData == (LPCWSTR)0x0) goto LAB_180036891;
  }
  lpLibFileName = pvData;
  if (LVar2 == 0) {
    while( true ) {
      for (; (WVar1 = *lpLibFileName, WVar1 == L' ' || (WVar1 == L','));
          lpLibFileName = lpLibFileName + 1) {
      }
      pWVar3 = lpLibFileName;
      if (WVar1 == L'\0') break;
      do {
        if (WVar1 == L',') break;
        if (WVar1 == L'\0') goto LAB_180036853;
        pWVar3 = pWVar3 + 1;
        WVar1 = *pWVar3;
      } while (WVar1 != L' ');
      if (WVar1 != L'\0') {
        *pWVar3 = L'\0';
        pWVar3 = pWVar3 + 1;
      }
LAB_180036853:
      LoadLibraryExW(lpLibFileName,(HANDLE)0x0,dwFlags);
      lpLibFileName = pWVar3;
    }
  }
  if (pvData != local_128) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pvData);
  }
LAB_180036891:
  __security_check_cookie(local_28 ^ (ulonglong)auStackY376);
  return;
}



BOOL Beep(DWORD dwFreq,DWORD dwDuration)

{
  BOOL BVar1;
  BOOL extraout_EAX;
  undefined auStack1016 [32];
  undefined local_3d8 [64];
  uint local_398 [224];
  ulonglong local_18;
  
                    // 0x368c0  104  Beep
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack1016;
  BVar1 = GetConsoleDisplayMode(local_398);
  local_398[0] = local_398[0] & -(uint)(BVar1 != 0);
  if (local_398[0] == 0) {
    CsrClientCallServer(local_3d8,0,0x10012,4);
  }
  Beep(dwFreq,dwDuration);
  __security_check_cookie(local_18 ^ (ulonglong)auStack1016);
  return extraout_EAX;
}



undefined8 IsNativeVhdBoot(uint *param_1)

{
  int iVar1;
  char *pcVar2;
  undefined4 uVar3;
  longlong in_GS_OFFSET;
  undefined4 local_res8 [2];
  
                    // 0x36960  905  IsNativeVhdBoot
  if (param_1 == (uint *)0x0) {
    uVar3 = 0x57;
LAB_180036981:
    RtlSetLastWin32Error(uVar3);
  }
  else {
    iVar1 = NtQuerySystemInformation(0x70,0,0,local_res8);
    if (iVar1 == -0x3fffffdd) {
      pcVar2 = (char *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                                       local_res8[0]);
      if (pcVar2 == (char *)0x0) {
        uVar3 = 8;
        goto LAB_180036981;
      }
      iVar1 = NtQuerySystemInformation(0x70,pcVar2,local_res8[0],local_res8);
      if (-1 < iVar1) {
        *param_1 = (uint)(*pcVar2 != '\0');
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pcVar2);
        return 1;
      }
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
    }
    BaseSetLastNTError();
  }
  return 0;
}



LONG CopyLZFile(INT hfSource,INT hfDest)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  uint *puVar4;
  HGLOBAL *ppvVar5;
  undefined4 in_register_00000014;
  undefined8 uVar6;
  HGLOBAL pvVar7;
  longlong lVar8;
  
                    // 0x36a80  178  CopyLZFile
  uVar6 = CONCAT44(in_register_00000014,hfDest);
  lVar8 = (longlong)hfSource;
  if (hfSource < 0x400) {
    uVar1 = FUN_18003be2c(hfDest);
    uVar2 = FUN_18003be2c((uint)lVar8);
  }
  else {
    pvVar7 = *(HGLOBAL *)("RtlDnsHostNameToComputerName" + lVar8 * 8 + 0xe);
    if (pvVar7 == (HGLOBAL)0x0) {
      return -1;
    }
    puVar4 = (uint *)GlobalLock(pvVar7);
    if (puVar4 == (uint *)0x0) {
      return -6;
    }
    uVar2 = *puVar4;
    uVar1 = FUN_18003be2c(hfDest);
    GlobalUnlock(pvVar7);
  }
  ppvVar5 = FUN_1800698b0(0x8000,uVar6,0x8000);
  if (ppvVar5 == (HGLOBAL *)0x0) {
    iVar3 = -5;
  }
  else {
    *(undefined4 *)(ppvVar5 + 7) = 0;
    pvVar7 = (HGLOBAL)((longlong)ppvVar5[1] + (ulonglong)*(uint *)(ppvVar5 + 9) + 1);
    *(undefined4 *)((longlong)ppvVar5 + 0x44) = 0;
    ppvVar5[2] = pvVar7;
    ppvVar5[3] = pvVar7;
    ppvVar5[6] = ppvVar5[4];
    ppvVar5[5] = (HGLOBAL)((ulonglong)*(uint *)((longlong)ppvVar5 + 0x4c) + (longlong)ppvVar5[4]);
    iVar3 = FUN_1800699a0(uVar2,uVar1,(longlong *)ppvVar5);
    if (iVar3 == 1) {
      iVar3 = *(int *)((longlong)ppvVar5 + 0x44);
    }
    FUN_180069838(ppvVar5);
  }
  return iVar3;
}



LONG LZCopy(INT hfSource,INT hfDest)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  uint *puVar4;
  HGLOBAL *ppvVar5;
  undefined4 in_register_00000014;
  undefined8 uVar6;
  HGLOBAL pvVar7;
  longlong lVar8;
  
                    // 0x36a90  956  LZCopy
  uVar6 = CONCAT44(in_register_00000014,hfDest);
  lVar8 = (longlong)hfSource;
  if (hfSource < 0x400) {
    uVar1 = FUN_18003be2c(hfDest);
    uVar2 = FUN_18003be2c((uint)lVar8);
  }
  else {
    pvVar7 = *(HGLOBAL *)("RtlDnsHostNameToComputerName" + lVar8 * 8 + 0xe);
    if (pvVar7 == (HGLOBAL)0x0) {
      return -1;
    }
    puVar4 = (uint *)GlobalLock(pvVar7);
    if (puVar4 == (uint *)0x0) {
      return -6;
    }
    uVar2 = *puVar4;
    uVar1 = FUN_18003be2c(hfDest);
    GlobalUnlock(pvVar7);
  }
  ppvVar5 = FUN_1800698b0(0x8000,uVar6,0x8000);
  if (ppvVar5 == (HGLOBAL *)0x0) {
    iVar3 = -5;
  }
  else {
    *(undefined4 *)(ppvVar5 + 7) = 0;
    pvVar7 = (HGLOBAL)((longlong)ppvVar5[1] + (ulonglong)*(uint *)(ppvVar5 + 9) + 1);
    *(undefined4 *)((longlong)ppvVar5 + 0x44) = 0;
    ppvVar5[2] = pvVar7;
    ppvVar5[3] = pvVar7;
    ppvVar5[6] = ppvVar5[4];
    ppvVar5[5] = (HGLOBAL)((ulonglong)*(uint *)((longlong)ppvVar5 + 0x4c) + (longlong)ppvVar5[4]);
    iVar3 = FUN_1800699a0(uVar2,uVar1,(longlong *)ppvVar5);
    if (iVar3 == 1) {
      iVar3 = *(int *)((longlong)ppvVar5 + 0x44);
    }
    FUN_180069838(ppvVar5);
  }
  return iVar3;
}



void BaseDumpAppcompatCacheWorker(void)

{
                    // 0x36b90  52  BaseDumpAppcompatCacheWorker
                    // 0x36b90  958  LZDone
                    // 0x36b90  1471  UTUnRegister
  return;
}



DWORD GetFullPathNameTransactedA
                (LPCSTR lpFileName,DWORD nBufferLength,LPSTR lpBuffer,LPSTR *lpFilePart,
                HANDLE hTransaction)

{
  DWORD DVar1;
  longlong lVar2;
  undefined8 uVar3;
  undefined4 in_register_00000014;
  
                    // 0x36ba0  610  GetFullPathNameTransactedA
  if ((longlong)hTransaction - 1U < 0xfffffffffffffffe) {
    lVar2 = RtlGetCurrentTransaction(lpFileName,CONCAT44(in_register_00000014,nBufferLength));
    if (lVar2 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      DVar1 = GetFullPathNameA(lpFileName,nBufferLength,lpBuffer,lpFilePart);
      RtlSetCurrentTransaction(0);
      return DVar1;
    }
    uVar3 = 0x1a45;
  }
  else {
    uVar3 = 0x1a2c;
  }
  RtlSetLastWin32Error(uVar3);
  return 0;
}



void FUN_180036c56(void)

{
                    // WARNING: Could not recover jumptable at 0x000180036c66. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlSetCurrentTransaction(0);
  return;
}



BOOL SetSystemTimeAdjustment(DWORD dwTimeAdjustment,BOOL bTimeAdjustmentDisabled)

{
  int iVar1;
  DWORD local_res18;
  undefined local_res1c;
  
                    // 0x36c80  1377  SetSystemTimeAdjustment
  local_res1c = (undefined)bTimeAdjustmentDisabled;
  local_res18 = dwTimeAdjustment;
  iVar1 = NtSetSystemInformation(0x1c,&local_res18,8);
  if (-1 >= iVar1) {
    BaseSetLastNTError();
  }
  return (uint)(-1 < iVar1);
}



BOOL DebugBreakProcess(HANDLE Process)

{
  int iVar1;
  
                    // 0x36cd0  268  DebugBreakProcess
  iVar1 = DbgUiIssueRemoteBreakin();
  if (iVar1 < 0) {
    BaseSetLastNTError();
  }
  return (uint)(iVar1 >= 0);
}



BOOL DebugSetProcessKillOnExit(BOOL KillOnExit)

{
  int iVar1;
  longlong lVar2;
  uint local_res10 [6];
  
                    // 0x36d00  269  DebugSetProcessKillOnExit
  lVar2 = DbgUiGetThreadDebugObject();
  if (lVar2 != 0) {
    local_res10[0] = (uint)(KillOnExit != 0);
    iVar1 = NtSetInformationDebugObject(lVar2,1,local_res10,4,0);
    if (-1 < iVar1) {
      return 1;
    }
  }
  BaseSetLastNTError();
  return 0;
}



BOOL Wow64GetThreadSelectorEntry(HANDLE hThread,DWORD dwSelector,PWOW64_LDT_ENTRY lpSelectorEntry)

{
  int iVar1;
  BOOL extraout_EAX;
  undefined auStack72 [32];
  DWORD local_28;
  _WOW64_LDT_ENTRY local_24;
  ulonglong local_18;
  
                    // 0x36d70  1559  Wow64GetThreadSelectorEntry
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack72;
  local_28 = dwSelector;
  iVar1 = RtlWow64GetThreadSelectorEntry(hThread,&local_28,0xc);
  if (iVar1 < 0) {
    BaseSetLastNTError();
  }
  else {
    *lpSelectorEntry = local_24;
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack72);
  return extraout_EAX;
}



BOOL CreateDirectoryTransactedA
               (LPCSTR lpTemplateDirectory,LPCSTR lpNewDirectory,
               LPSECURITY_ATTRIBUTES lpSecurityAttributes,HANDLE hTransaction)

{
  BOOL BVar1;
  undefined8 uVar2;
  undefined local_28 [8];
  LPCWSTR local_20;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x36de0  188  CreateDirectoryTransactedA
  uVar2 = Basep8BitStringToDynamicUnicodeString();
  BVar1 = 0;
  if ((int)uVar2 == 0) {
    return 0;
  }
  if (lpTemplateDirectory == (LPCSTR)0x0) {
    local_20 = (LPCWSTR)0x0;
  }
  else {
    uVar2 = Basep8BitStringToDynamicUnicodeString();
    if ((int)uVar2 == 0) goto LAB_180036e5b;
  }
  BVar1 = CreateDirectoryTransactedW(local_20,local_10,lpSecurityAttributes,hTransaction);
  if (lpTemplateDirectory != (LPCSTR)0x0) {
    RtlFreeUnicodeString(local_28);
  }
LAB_180036e5b:
  RtlFreeUnicodeString(local_18);
  return BVar1;
}



BOOL RemoveDirectoryTransactedA(LPCSTR lpPathName,HANDLE hTransaction)

{
  int iVar1;
  undefined8 uVar2;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x36e90  1214  RemoveDirectoryTransactedA
  uVar2 = Basep8BitStringToDynamicUnicodeString();
  iVar1 = (int)uVar2;
  if (iVar1 != 0) {
    iVar1 = RemoveDirectoryTransactedW(local_10,hTransaction);
    RtlFreeUnicodeString(local_18);
  }
  return iVar1;
}



HANDLE FindFirstFileNameTransactedW
                 (LPCWSTR lpFileName,DWORD dwFlags,LPDWORD StringLength,PWCHAR LinkName,
                 HANDLE hTransaction)

{
  longlong lVar1;
  HANDLE pvVar2;
  undefined8 uVar3;
  undefined4 in_register_00000014;
  
                    // 0x36ee0  390  FindFirstFileNameTransactedW
  if ((longlong)hTransaction - 1U < 0xfffffffffffffffe) {
    lVar1 = RtlGetCurrentTransaction(lpFileName,CONCAT44(in_register_00000014,dwFlags));
    if (lVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      pvVar2 = FindFirstFileNameW(lpFileName,dwFlags,StringLength,LinkName);
      RtlSetCurrentTransaction(0);
      return pvVar2;
    }
    uVar3 = 0x1a45;
  }
  else {
    uVar3 = 0x1a2c;
  }
  RtlSetLastWin32Error(uVar3);
  return (HANDLE)0xffffffffffffffff;
}



void FUN_180036f9b(void)

{
                    // WARNING: Could not recover jumptable at 0x000180036fab. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlSetCurrentTransaction(0);
  return;
}



HANDLE FindFirstFileTransactedA
                 (LPCSTR lpFileName,FINDEX_INFO_LEVELS fInfoLevelId,LPVOID lpFindFileData,
                 FINDEX_SEARCH_OPS fSearchOp,LPVOID lpSearchFilter,DWORD dwAdditionalFlags,
                 HANDLE hTransaction)

{
  longlong lVar1;
  HANDLE pvVar2;
  undefined8 uVar3;
  undefined4 in_register_00000014;
  undefined4 in_register_0000008c;
  
                    // 0x36fc0  392  FindFirstFileTransactedA
  if ((longlong)hTransaction - 1U < 0xfffffffffffffffe) {
    lVar1 = RtlGetCurrentTransaction
                      (lpFileName,CONCAT44(in_register_00000014,fInfoLevelId),lpFindFileData,
                       CONCAT44(in_register_0000008c,fSearchOp));
    if (lVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      pvVar2 = FindFirstFileExA(lpFileName,fInfoLevelId,lpFindFileData,fSearchOp,lpSearchFilter,
                                dwAdditionalFlags);
      RtlSetCurrentTransaction(0);
      return pvVar2;
    }
    uVar3 = 0x1a45;
  }
  else {
    uVar3 = 0x1a2c;
  }
  RtlSetLastWin32Error(uVar3);
  return (HANDLE)0xffffffffffffffff;
}



void FUN_18003708d(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003709d. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlSetCurrentTransaction(0);
  return;
}



HANDLE FindFirstStreamTransactedW
                 (LPCWSTR lpFileName,STREAM_INFO_LEVELS InfoLevel,LPVOID lpFindStreamData,
                 DWORD dwFlags,HANDLE hTransaction)

{
  longlong lVar1;
  HANDLE pvVar2;
  undefined8 uVar3;
  undefined4 in_register_00000014;
  undefined4 in_register_0000008c;
  
                    // 0x370b0  395  FindFirstStreamTransactedW
  if ((longlong)hTransaction - 1U < 0xfffffffffffffffe) {
    lVar1 = RtlGetCurrentTransaction
                      (lpFileName,CONCAT44(in_register_00000014,InfoLevel),lpFindStreamData,
                       CONCAT44(in_register_0000008c,dwFlags));
    if (lVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      pvVar2 = FindFirstStreamW(lpFileName,InfoLevel,lpFindStreamData,dwFlags);
      RtlSetCurrentTransaction(0);
      return pvVar2;
    }
    uVar3 = 0x1a45;
  }
  else {
    uVar3 = 0x1a2c;
  }
  RtlSetLastWin32Error(uVar3);
  return (HANDLE)0xffffffffffffffff;
}



void FUN_18003716b(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003717b. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlSetCurrentTransaction(0);
  return;
}



BOOL GetFileBandwidthReservation
               (HANDLE hFile,LPDWORD lpPeriodMilliseconds,LPDWORD lpBytesPerPeriod,
               LPBOOL pDiscardable,LPDWORD lpTransferSize,LPDWORD lpNumOutstandingRequests)

{
  int iVar1;
  BOOL extraout_EAX;
  undefined auStack136 [32];
  undefined4 local_68;
  undefined local_58 [16];
  int local_48;
  DWORD local_44;
  byte local_3f;
  DWORD local_3c;
  DWORD local_38;
  ulonglong local_30;
  
                    // 0x37190  593  GetFileBandwidthReservation
  local_30 = DAT_1800b2220 ^ (ulonglong)auStack136;
  local_68 = 0x2c;
  iVar1 = NtQueryInformationFile(hFile,local_58,&local_48,0x14);
  if (iVar1 < 0) {
    BaseSetLastNTError();
  }
  else {
    *lpTransferSize = local_3c;
    *lpNumOutstandingRequests = local_38;
    *lpPeriodMilliseconds = local_44;
    *lpBytesPerPeriod = local_48 * local_3c;
    *pDiscardable = (uint)local_3f;
  }
  __security_check_cookie(local_30 ^ (ulonglong)auStack136);
  return extraout_EAX;
}



BOOL SetFileBandwidthReservation
               (HANDLE hFile,DWORD nPeriodMilliseconds,DWORD nBytesPerPeriod,BOOL bDiscardable,
               LPDWORD lpTransferSize,LPDWORD lpNumOutstandingRequests)

{
  int iVar1;
  BOOL extraout_EAX;
  undefined4 uVar2;
  undefined auStack152 [32];
  undefined4 local_78;
  undefined local_68 [16];
  uint local_58;
  DWORD local_54;
  undefined local_50;
  undefined local_4f;
  uint local_4c;
  DWORD local_48;
  ulonglong local_40;
  
                    // 0x37240  1327  SetFileBandwidthReservation
  local_40 = DAT_1800b2220 ^ (ulonglong)auStack152;
  local_78 = 0x2c;
  iVar1 = NtQueryInformationFile(hFile,local_68,&local_58,0x14);
  if (iVar1 < 0) {
LAB_18003729a:
    BaseSetLastNTError();
  }
  else {
    if (local_4c == 0) {
      *lpTransferSize = 0;
      *lpNumOutstandingRequests = 0;
      uVar2 = 1;
    }
    else {
      local_58 = nBytesPerPeriod / local_4c;
      if ((local_58 != 0) || (nBytesPerPeriod == 0)) {
        local_4f = (undefined)bDiscardable;
        local_50 = 1;
        local_78 = 0x2c;
        local_54 = nPeriodMilliseconds;
        iVar1 = NtSetInformationFile(hFile,local_68,&local_58,0x14);
        if (-1 < iVar1) {
          if (nBytesPerPeriod == 0) {
            *lpTransferSize = 0;
            *lpNumOutstandingRequests = 0;
            goto LAB_180037355;
          }
          local_78 = 0x2c;
          iVar1 = NtQueryInformationFile(hFile,local_68,&local_58,0x14);
          if (-1 < iVar1) {
            *lpTransferSize = local_4c;
            *lpNumOutstandingRequests = local_48;
            goto LAB_180037355;
          }
        }
        goto LAB_18003729a;
      }
      uVar2 = 0x57;
    }
    RtlSetLastWin32Error(uVar2);
  }
LAB_180037355:
  __security_check_cookie(local_40 ^ (ulonglong)auStack152);
  return extraout_EAX;
}



BOOL SetFileShortNameA(HANDLE hFile,LPCSTR lpShortName)

{
  int iVar1;
  undefined8 uVar2;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x37380  1333  SetFileShortNameA
  uVar2 = Basep8BitStringToDynamicUnicodeString();
  iVar1 = (int)uVar2;
  if (iVar1 != 0) {
    iVar1 = SetFileShortNameW(hFile,local_10);
    RtlFreeUnicodeString(local_18);
  }
  return iVar1;
}



BOOL SetFileShortNameW(HANDLE hFile,LPCWSTR lpShortName)

{
  longlong lVar1;
  undefined4 *puVar3;
  int *piVar4;
  undefined4 uVar5;
  longlong lVar6;
  int iVar7;
  longlong in_GS_OFFSET;
  undefined local_28 [16];
  longlong lVar2;
  
                    // 0x373d0  1334  SetFileShortNameW
  if (lpShortName == (LPCWSTR)0x0) {
    uVar5 = 0x57;
  }
  else {
    lVar6 = -1;
    lVar1 = -1;
    do {
      lVar2 = lVar1;
      lVar1 = lVar2 + 1;
    } while (lpShortName[lVar1] != L'\0');
    if (lVar1 == 0) {
      iVar7 = (int)lVar2 + 9;
    }
    else {
      lVar1 = -1;
      do {
        lVar1 = lVar1 + 1;
      } while (lpShortName[lVar1] != L'\0');
      iVar7 = (int)lVar1 * 2 + 6;
    }
    puVar3 = (undefined4 *)KernelBaseGetGlobalData();
    piVar4 = (int *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                    *puVar3,iVar7);
    if (piVar4 != (int *)0x0) {
      do {
        lVar6 = lVar6 + 1;
      } while (lpShortName[lVar6] != L'\0');
      *piVar4 = (uint)lVar6 * 2;
      wcscpy_s((wchar_t *)(piVar4 + 1),(ulonglong)((uint)lVar6 & 0x7fffffff) + 1,lpShortName);
      iVar7 = NtSetInformationFile(hFile,local_28,piVar4,iVar7,0x28);
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,piVar4);
      if (iVar7 < 0) {
        BaseSetLastNTError();
        return 0;
      }
      return 1;
    }
    uVar5 = 8;
  }
  RtlSetLastWin32Error(uVar5);
  return 0;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

undefined8 BasepCopyEncryption(undefined8 param_1,int param_2,uint *param_3)

{
  int iVar1;
  HMODULE hModule;
  FARPROC pFVar2;
  undefined8 uVar3;
  
  uVar3 = 0;
                    // 0x37520  84  BasepCopyEncryption
  hModule = LoadLibraryExW(L"advapi32.dll",(HANDLE)0x0,0x800);
  if (hModule == (HMODULE)0x0) goto LAB_1800375d4;
  if (param_2 == 0) {
    pFVar2 = GetProcAddress(hModule,"DecryptFileW");
    uVar3 = 0;
    if (pFVar2 == (FARPROC)0x0) goto LAB_1800375d4;
    iVar1 = (*pFVar2)();
    if (iVar1 == 0) goto LAB_1800375d4;
    *param_3 = *param_3 & 0xffffbfff;
  }
  else {
    pFVar2 = GetProcAddress(hModule,"EncryptFileW");
    if (pFVar2 == (FARPROC)0x0) goto LAB_1800375d4;
    iVar1 = (*pFVar2)();
    if (iVar1 == 0) goto LAB_1800375d4;
    *param_3 = *param_3 | 0x4000;
  }
  uVar3 = 1;
LAB_1800375d4:
  if (hModule != (HMODULE)0x0) {
    FreeLibrary(hModule);
  }
  return uVar3;
}



void FUN_180037606(undefined8 param_1,longlong param_2)

{
  if (*(HMODULE *)(param_2 + 0x20) != (HMODULE)0x0) {
    FreeLibrary(*(HMODULE *)(param_2 + 0x20));
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Removing unreachable block (ram,0x000180037806)
// WARNING: Removing unreachable block (ram,0x000180037819)
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_180037634(undefined8 param_1,undefined8 param_2,int param_3)

{
  HMODULE hModule;
  FARPROC pFVar1;
  FARPROC pFVar2;
  FARPROC pFVar3;
  HMODULE hModule_00;
  int iVar4;
  undefined8 uVar5;
  undefined8 uVar6;
  
  uVar5 = 0;
  hModule_00 = (HMODULE)0x0;
  hModule = LoadLibraryExW(L"feclient.dll",(HANDLE)0x0,0x800);
  if (hModule == (HMODULE)0x0) {
    return 0;
  }
  pFVar1 = GetProcAddress(hModule,"EfsClientEncryptFileEx");
  uVar6 = uVar5;
  if (((pFVar1 == (FARPROC)0x0) ||
      (pFVar2 = GetProcAddress(hModule,"EfsClientQueryProtectors"), pFVar2 == (FARPROC)0x0)) ||
     (pFVar3 = GetProcAddress(hModule,"EfsClientFreeProtectorList"), pFVar3 == (FARPROC)0x0))
  goto LAB_180037836;
  iVar4 = (*pFVar2)();
  if (iVar4 == 0) {
    if (iRam0000000000000000 == 0) {
      iVar4 = 0xd;
      goto LAB_18003770b;
    }
    if (param_3 == 0) {
LAB_1800377d8:
      iVar4 = (*pFVar1)();
      if (iVar4 != 0) goto LAB_18003770b;
LAB_1800377f9:
      uVar6 = 1;
    }
    else {
      iVar4 = (*pFVar2)();
      if (iVar4 != 0) goto LAB_18003770b;
      if ((iRam0000000000000000 == 1) &&
         (iVar4 = _wcsicmp(*(wchar_t **)(*_DAT_00000008 + 0x10),*(wchar_t **)(*_DAT_00000008 + 0x10)
                          ), iVar4 == 0)) goto LAB_1800377f9;
      hModule_00 = LoadLibraryExW(L"advapi32.dll",(HANDLE)0x0,0x800);
      if ((hModule_00 != (HMODULE)0x0) &&
         ((pFVar2 = GetProcAddress(hModule_00,"DecryptFileW"), pFVar2 != (FARPROC)0x0 &&
          (iVar4 = (*pFVar2)(), uVar6 = 0, iVar4 != 0)))) goto LAB_1800377d8;
    }
  }
  else {
LAB_18003770b:
    RtlSetLastWin32Error(iVar4);
    uVar6 = uVar5;
  }
  if (hModule_00 != (HMODULE)0x0) {
    FreeLibrary(hModule_00);
  }
LAB_180037836:
  FreeLibrary(hModule);
  return uVar6;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

DWORD DuplicateEncryptionInfoFileExt
                (undefined param_1,undefined param_2,undefined param_3,undefined param_4,
                undefined8 param_5)

{
  DWORD DVar1;
  HMODULE hModule;
  FARPROC pFVar2;
  
                    // 0x37870  306  DuplicateEncryptionInfoFileExt
  if (DAT_1800b2e68 == (FARPROC)0x0) {
    hModule = LoadLibraryExW(L"advapi32.dll",(HANDLE)0x0,0x800);
    if (hModule == (HMODULE)0x0) {
      DVar1 = GetLastError();
      return DVar1;
    }
    pFVar2 = GetProcAddress(hModule,"DuplicateEncryptionInfoFile");
    if (pFVar2 == (FARPROC)0x0) {
      DVar1 = GetLastError();
      FreeLibrary(hModule);
      return DVar1;
    }
    LdrAddRefDll(1,hModule);
    DAT_1800b2e68 = pFVar2;
  }
  DVar1 = (*DAT_1800b2e68)();
  return DVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Removing unreachable block (ram,0x000180037a32)
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

DWORD GetEncryptedFileVersionExt(undefined8 param_1,undefined4 *param_2)

{
  DWORD DVar1;
  HMODULE hModule;
  FARPROC pFVar2;
  FARPROC pFVar3;
  
                    // 0x37970  575  GetEncryptedFileVersionExt
  hModule = LoadLibraryExW(L"advapi32.dll",(HANDLE)0x0,0x800);
  if (((hModule == (HMODULE)0x0) ||
      (pFVar2 = GetProcAddress(hModule,"EncryptedFileKeyInfo"), pFVar2 == (FARPROC)0x0)) ||
     (pFVar3 = GetProcAddress(hModule,"FreeEncryptedFileKeyInfo"), pFVar3 == (FARPROC)0x0)) {
    DVar1 = GetLastError();
  }
  else {
    DVar1 = (*pFVar2)();
    if (DVar1 == 0) {
      *param_2 = *_DAT_00000008;
    }
  }
  if (hModule != (HMODULE)0x0) {
    FreeLibrary(hModule);
  }
  return DVar1;
}



BOOL AddSecureMemoryCacheCallback(PSECURE_MEMORY_CACHE_CALLBACK pfnCallBack)

{
  int iVar1;
  
                    // 0x37a70  18  AddSecureMemoryCacheCallback
  iVar1 = RtlRegisterSecureMemoryCacheCallback();
  if (iVar1 < 0) {
    BaseSetLastNTError();
  }
  return (uint)(iVar1 >= 0);
}



UINT EnumSystemFirmwareTables
               (DWORD FirmwareTableProviderSignature,PVOID pFirmwareTableEnumBuffer,DWORD BufferSize
               )

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180037aa0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x37aa0  342  EnumSystemFirmwareTables
  UVar1 = EnumSystemFirmwareTables
                    (FirmwareTableProviderSignature,pFirmwareTableEnumBuffer,BufferSize);
  return UVar1;
}



UINT GetSystemFirmwareTable
               (DWORD FirmwareTableProviderSignature,DWORD FirmwareTableID,
               PVOID pFirmwareTableBuffer,DWORD BufferSize)

{
  UINT UVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180037ac0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x37ac0  749  GetSystemFirmwareTable
  UVar1 = GetSystemFirmwareTable
                    (FirmwareTableProviderSignature,FirmwareTableID,pFirmwareTableBuffer,BufferSize)
  ;
  return UVar1;
}



SIZE_T GlobalCompact(HLOCAL hMem,UINT cbNewSize)

{
  SIZE_T SVar1;
  
                    // 0x37ae0  827  GlobalCompact
                    // 0x37ae0  979  LocalCompact
                    // 0x37ae0  987  LocalShrink
                    // WARNING: Could not recover jumptable at 0x000180037ae9. Too many branches
                    // WARNING: Treating indirect jump as call
  SVar1 = RtlCompactHeap(DAT_1800b2a30,0);
  return SVar1;
}



void GlobalFix(HGLOBAL hMem)

{
                    // 0x37b00  831  GlobalFix
  if (hMem != (HGLOBAL)0xffffffffffffffff) {
    GlobalLock(hMem);
  }
  return;
}



BOOL GlobalUnWire(HGLOBAL hMem)

{
  short sVar1;
  char cVar2;
  short sVar3;
  undefined8 uVar4;
  BOOL BVar5;
  undefined8 in_R8;
  undefined8 in_R9;
  undefined4 uVar6;
  
  BVar5 = 1;
  uVar6 = 1;
  if (((ulonglong)hMem & 8) == 0) {
    return 1;
  }
  RtlLockHeap(DAT_1800b2a30);
  cVar2 = RtlIsValidHandle(DAT_1800b2a20,(longlong)hMem + -8,in_R8,in_R9,uVar6);
  if (cVar2 == '\0') {
    RtlSetLastWin32Error(6);
  }
  else {
    sVar1 = *(short *)((longlong)hMem + -6);
    sVar3 = sVar1 + -1;
    *(short *)((longlong)hMem + -6) = sVar3;
    if (sVar1 == 0) {
      *(undefined2 *)((longlong)hMem + -6) = 0;
      uVar4 = 0x9e;
    }
    else {
      if (sVar3 != 0) goto LAB_18001594f;
      uVar4 = 0;
    }
    RtlSetLastWin32Error(uVar4);
    BVar5 = 0;
  }
LAB_18001594f:
  RtlUnlockHeap(DAT_1800b2a30);
  return BVar5;
}



void GlobalUnfix(HGLOBAL hMem)

{
                    // 0x37b30  843  GlobalUnfix
  if (hMem != (HGLOBAL)0xffffffffffffffff) {
    GlobalUnlock(hMem);
  }
  return;
}



LPVOID GlobalWire(HGLOBAL hMem)

{
  short sVar1;
  LPVOID pvVar2;
  char cVar3;
  BOOL BVar4;
  HGLOBAL pvStackX8;
  
  if (((ulonglong)hMem & 8) == 0) {
    if (DAT_1800b2a28 == (HGLOBAL)0x0) {
      NtQuerySystemInformation(0x32,&pvStackX8);
      DAT_1800b2a28 = pvStackX8;
    }
    if ((DAT_1800b2a28 <= hMem) || (BVar4 = IsBadReadPtr(hMem,1), BVar4 != 0)) {
      RtlSetLastWin32Error(6);
      hMem = (LPVOID)0x0;
    }
  }
  else {
    RtlLockHeap(DAT_1800b2a30);
    cVar3 = RtlIsValidHandle(DAT_1800b2a20,(longlong)hMem + -8);
    if (cVar3 == '\0') {
      RtlSetLastWin32Error(6);
      pvVar2 = (LPVOID)0x0;
    }
    else {
                    // WARNING: Load size is inaccurate
      pvVar2 = *hMem;
      if (pvVar2 == (LPVOID)0x0) {
        RtlSetLastWin32Error(0x9d);
      }
      else {
        sVar1 = *(short *)((longlong)hMem + -6);
        *(short *)((longlong)hMem + -6) = sVar1 + 1;
        if (sVar1 == 0xff) {
          *(undefined2 *)((longlong)hMem + -6) = 0xff;
        }
      }
    }
    hMem = pvVar2;
    RtlUnlockHeap(DAT_1800b2a30);
  }
  return hMem;
}



void RegisterWowBaseHandlers(undefined8 param_1)

{
  DAT_1800b2dc0 = param_1;
                    // 0x37b60  1203  RegisterWowBaseHandlers
  return;
}



BOOL RemoveSecureMemoryCacheCallback(PSECURE_MEMORY_CACHE_CALLBACK pfnCallBack)

{
  byte bVar1;
  
                    // 0x37b70  1220  RemoveSecureMemoryCacheCallback
  bVar1 = RtlDeregisterSecureMemoryCacheCallback();
  return (BOOL)bVar1;
}



HLOCAL LocalHandle(LPCVOID pMem)

{
  char cVar1;
  uint local_res10 [2];
  LPCVOID local_res18 [2];
  
                    // 0x37b90  984  LocalHandle
  local_res18[0] = (HLOCAL)0x0;
  RtlLockHeap(DAT_1800b2a30);
  local_res18[0] = (HLOCAL)0x0;
  cVar1 = RtlGetUserInfoHeap(DAT_1800b2a30,1,pMem,local_res18,local_res10);
  if (cVar1 == '\0') {
    RtlSetLastWin32Error(6);
  }
  else if ((local_res18[0] == (HLOCAL)0x0) || ((local_res10[0] & 0x200) == 0)) {
    local_res18[0] = pMem;
  }
  RtlUnlockHeap(DAT_1800b2a30);
  return local_res18[0];
}



bool FUN_180037c3a(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



void FUN_180037c5a(void)

{
  RtlUnlockHeap(DAT_1800b2a30);
  return;
}



void LoadStringBaseW(void)

{
                    // 0x37c90  977  LoadStringBaseW
  LoadStringBaseExW();
  return;
}



BOOL EnumResourceLanguagesA
               (HMODULE hModule,LPCSTR lpType,LPCSTR lpName,ENUMRESLANGPROCA lpEnumFunc,
               LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // 0x37cc0  328  EnumResourceLanguagesA
  BVar1 = EnumResourceLanguagesExA(hModule,lpType,lpName,lpEnumFunc,lParam,3,0);
  return BVar1;
}



BOOL EnumResourceLanguagesW
               (HMODULE hModule,LPCWSTR lpType,LPCWSTR lpName,ENUMRESLANGPROCW lpEnumFunc,
               LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // 0x37d00  331  EnumResourceLanguagesW
  BVar1 = EnumResourceLanguagesExW(hModule,lpType,lpName,lpEnumFunc,lParam,3,0);
  return BVar1;
}



BOOL EnumResourceNamesA(HMODULE hModule,LPCSTR lpType,ENUMRESNAMEPROCA lpEnumFunc,LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // 0x37d40  332  EnumResourceNamesA
  BVar1 = EnumResourceNamesExA(hModule,lpType,lpEnumFunc,lParam,3,0);
  return BVar1;
}



BOOL EnumResourceTypesA(HMODULE hModule,ENUMRESTYPEPROCA lpEnumFunc,LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // 0x37d70  336  EnumResourceTypesA
  BVar1 = EnumResourceTypesExA(hModule,lpEnumFunc,lParam,3,0);
  return BVar1;
}



BOOL EnumResourceTypesW(HMODULE hModule,ENUMRESTYPEPROCW lpEnumFunc,LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // 0x37da0  339  EnumResourceTypesW
  BVar1 = EnumResourceTypesExW(hModule,lpEnumFunc,lParam,3,0);
  return BVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Could not reconcile some variable overlaps

DWORD GetDllDirectoryA(DWORD nBufferLength,LPSTR lpBuffer)

{
  undefined auVar1 [16];
  int iVar2;
  DWORD DVar3;
  undefined4 *puVar4;
  code *pcVar5;
  short sVar6;
  longlong in_GS_OFFSET;
  short local_28;
  short local_26;
  longlong local_20;
  undefined local_18 [16];
  
                    // 0x37dd0  567  GetDllDirectoryA
  local_18 = ZEXT816(0);
  RtlInitUnicodeString(&local_28,0);
  LdrGetDllDirectory(&local_28);
  sVar6 = local_28;
  if (local_28 == 2) {
    if (nBufferLength == 0) {
      return 1;
    }
    RtlSetLastWin32Error(0);
    *lpBuffer = '\0';
  }
  else {
    puVar4 = (undefined4 *)KernelBaseGetGlobalData();
    local_20 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),*puVar4,
                               sVar6);
    while (local_20 != 0) {
      local_28 = 0;
      local_26 = sVar6;
      iVar2 = LdrGetDllDirectory(&local_28);
      auVar1 = local_18;
      if (iVar2 != -0x3fffffdd) {
        local_18 = CONCAT88(lpBuffer,local_18._0_8_);
        local_18._0_2_ = SUB162(auVar1,0);
        local_18._0_4_ = CONCAT22((short)nBufferLength,local_18._0_2_);
        if (0xfffe < nBufferLength) {
          local_18._0_4_ = CONCAT22(0xfffe,local_18._0_2_);
        }
        pcVar5 = (code *)GetUnicodeStringToEightBitStringRoutine();
        iVar2 = (*pcVar5)();
        if (-1 < iVar2) {
          return local_18._0_2_ - 1;
        }
        goto LAB_180037ef7;
      }
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_20);
      sVar6 = local_28;
      puVar4 = (undefined4 *)KernelBaseGetGlobalData();
      local_20 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),*puVar4,
                                 sVar6);
    }
    iVar2 = -0x3fffffe9;
LAB_180037ef7:
    if (nBufferLength != 0) {
      *lpBuffer = '\0';
    }
    if (iVar2 == -0x7ffffffb) {
      pcVar5 = (code *)GetUnicodeStringToEightBitSizeRoutine();
      DVar3 = (*pcVar5)();
      return DVar3;
    }
    BaseSetLastNTError();
  }
  return 0;
}



BOOL SetSearchPathMode(DWORD Flags)

{
  int iVar1;
  undefined4 in_register_0000000c;
  
                    // 0x37f90  1371  SetSearchPathMode
  iVar1 = RtlSetSearchPathMode(CONCAT44(in_register_0000000c,Flags));
  if (iVar1 < 0) {
    BaseSetLastNTError();
  }
  return (uint)(iVar1 >= 0);
}



undefined8
UTRegister(undefined8 param_1,PCNZCH param_2,undefined8 param_3,PCNZCH param_4,undefined **param_5)

{
  int iVar1;
  
                    // 0x37fc0  1470  UTRegister
  iVar1 = CompareStringA(0x7f,1,param_2,-1,"mem16.dll",-1);
  if ((iVar1 == 2) && (iVar1 = CompareStringA(0x7f,1,param_4,-1,"GetMemory",-1), iVar1 == 2)) {
    *param_5 = FUN_180021410;
    return 1;
  }
  return 0;
}



// WARNING: Could not reconcile some variable overlaps

BOOL GetNamedPipeClientSessionId(HANDLE Pipe,PULONG ClientSessionId)

{
  BOOL BVar1;
  undefined8 local_res18;
  ULONG_PTR local_res20;
  
                    // 0x38050  649  GetNamedPipeClientSessionId
  local_res18 = 0;
  local_res20 = 8;
  BVar1 = GetNamedPipeAttribute
                    (Pipe,PipeConnectionAttribute,"ClientSessionId",&local_res18,&local_res20);
  if (BVar1 != 0) {
    *ClientSessionId = (ULONG)local_res18;
  }
  return BVar1;
}



BOOL GetNamedPipeServerSessionId(HANDLE Pipe,PULONG ServerSessionId)

{
  BOOL BVar1;
  ULONG_PTR local_res18 [2];
  
                    // 0x380b0  654  GetNamedPipeServerSessionId
  local_res18[0] = 4;
  BVar1 = GetNamedPipeAttribute(Pipe,PipeAttribute,"ServerSessionId",ServerSessionId,local_res18);
  return BVar1;
}



BOOL SetNamedPipeAttribute
               (HANDLE Pipe,PIPE_ATTRIBUTE_TYPE AttributeType,PSTR AttributeName,
               PVOID AttributeValue,SIZE_T AttributeValueLength)

{
  int iVar1;
  uint uVar2;
  void *_Dst;
  undefined4 uVar3;
  longlong lVar4;
  size_t _Size;
  longlong in_GS_OFFSET;
  ulonglong in_stack_ffffffffffffff58;
  undefined8 local_78;
  uint local_70 [4];
  undefined4 local_60 [2];
  undefined8 local_58;
  undefined8 local_50;
  undefined4 local_48;
  undefined local_40 [16];
  longlong lVar5;
  
                    // 0x380f0  1354  SetNamedPipeAttribute
  if (AttributeType == PipeAttribute) {
    uVar3 = 0x11002c;
  }
  else if (AttributeType == PipeConnectionAttribute) {
    uVar3 = 0x110034;
  }
  else {
    if (AttributeType != PipeHandleAttribute) {
      uVar3 = 0x57;
      goto LAB_180038130;
    }
    uVar3 = 0x11003c;
  }
  lVar4 = -1;
  do {
    lVar5 = lVar4;
    lVar4 = lVar5 + 1;
  } while (AttributeName[lVar4] != '\0');
  _Size = lVar5 + 2;
  _Dst = (void *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                                 _Size + AttributeValueLength);
  if (_Dst != (void *)0x0) {
    memcpy(_Dst,AttributeName,_Size);
    if (AttributeValueLength != 0) {
      memcpy((void *)((longlong)_Dst + _Size),AttributeValue,AttributeValueLength);
    }
    local_60[0] = 0x30;
    local_58 = 0;
    local_48 = 0;
    local_50 = 0;
    local_40 = ZEXT816(0);
    iVar1 = NtCreateEvent(&local_78,0x1f0003,local_60,0,
                          in_stack_ffffffffffffff58 & 0xffffffffffffff00);
    if (iVar1 < 0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,_Dst);
      BaseSetLastNTError();
      return 0;
    }
    uVar2 = NtFsControlFile(Pipe,local_78,0,0,local_70,uVar3,_Dst,
                            (int)(_Size + AttributeValueLength),0,0);
    if ((uVar2 == 0x103) && (uVar2 = NtWaitForSingleObject(local_78,0,0), -1 < (int)uVar2)) {
      uVar2 = local_70[0];
    }
    NtClose(local_78);
    if ((int)uVar2 < 0) {
      BaseSetLastNTError();
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,_Dst);
    return ~uVar2 >> 0x1f;
  }
  uVar3 = 8;
LAB_180038130:
  RtlSetLastWin32Error(uVar3);
  return 0;
}



BOOL GetNumaAvailableMemoryNode(UCHAR Node,PULONGLONG AvailableBytes)

{
  BOOL BVar1;
  
                    // 0x38300  658  GetNumaAvailableMemoryNode
  BVar1 = GetNumaAvailableMemoryNodeEx((ushort)Node,AvailableBytes);
  return BVar1;
}



BOOL GetNumaNodeNumberFromHandle(HANDLE hFile,PUSHORT NodeNumber)

{
  int iVar1;
  USHORT local_res18 [8];
  undefined local_18 [16];
  
                    // 0x38310  661  GetNumaNodeNumberFromHandle
  iVar1 = NtQueryInformationFile(hFile,local_18,local_res18,2,0x35);
  if (-1 < iVar1) {
    *NodeNumber = local_res18[0];
  }
  else {
    BaseSetLastNTError();
  }
  return (uint)(-1 < iVar1);
}



BOOL GetNumaProcessorNode(UCHAR Processor,PUCHAR NodeNumber)

{
  BOOL BVar1;
  UCHAR local_res8;
  _PROCESSOR_NUMBER local_res18 [4];
  
                    // 0x38370  664  GetNumaProcessorNode
  if (Processor < 0x40) {
    RtlGetCurrentProcessorNumberEx(local_res18);
    local_res18[0].Number = Processor;
    BVar1 = GetNumaProcessorNodeEx(local_res18,(PUSHORT)&local_res8);
    *NodeNumber = local_res8;
  }
  else {
    *NodeNumber = 0xff;
    RtlSetLastWin32Error(0x57);
    BVar1 = 0;
  }
  return BVar1;
}



BOOL GetNumaProximityNode(ULONG ProximityId,PUCHAR NodeNumber)

{
  BOOL BVar1;
  UCHAR local_res18;
  
                    // 0x383e0  666  GetNumaProximityNode
  BVar1 = GetNumaProximityNodeEx(ProximityId,(PUSHORT)&local_res18);
  if (BVar1 != 0) {
    *NodeNumber = local_res18;
  }
  return BVar1;
}



BOOL CheckNameLegalDOS8Dot3A
               (LPCSTR lpName,LPSTR lpOemName,DWORD OemNameSize,PBOOL pbNameContainsSpaces,
               PBOOL pbNameLegal)

{
  BOOL BVar1;
  undefined8 uVar2;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x38420  130  CheckNameLegalDOS8Dot3A
  if ((((lpName == (LPCSTR)0x0) || (pbNameLegal == (PBOOL)0x0)) ||
      ((lpOemName == (LPSTR)0x0 && (OemNameSize != 0)))) || (0xffff < OemNameSize)) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    uVar2 = Basep8BitStringToDynamicUnicodeString();
    if ((int)uVar2 != 0) {
      BVar1 = CheckNameLegalDOS8Dot3W
                        (local_10,lpOemName,OemNameSize,pbNameContainsSpaces,pbNameLegal);
      RtlFreeUnicodeString(local_18);
      return BVar1;
    }
  }
  return 0;
}



// WARNING: Could not reconcile some variable overlaps

BOOL CheckNameLegalDOS8Dot3W
               (LPCWSTR lpName,LPSTR lpOemName,DWORD OemNameSize,PBOOL pbNameContainsSpaces,
               PBOOL pbNameLegal)

{
  byte bVar1;
  BOOL extraout_EAX;
  undefined8 uVar2;
  undefined *puVar3;
  ulonglong _Size;
  undefined auStack136 [32];
  byte local_68 [8];
  undefined local_60 [8];
  void *pvStack88;
  undefined local_50 [16];
  undefined local_40 [16];
  ulonglong local_30;
  
                    // 0x384d0  131  CheckNameLegalDOS8Dot3W
  local_30 = DAT_1800b2220 ^ (ulonglong)auStack136;
  _local_60 = ZEXT816(0);
  if ((((lpName == (LPCWSTR)0x0) || (pbNameLegal == (PBOOL)0x0)) ||
      ((lpOemName == (LPSTR)0x0 && (OemNameSize != 0)))) || (0xffff < OemNameSize)) {
    uVar2 = 0x57;
LAB_1800385d4:
    RtlSetLastWin32Error(uVar2);
  }
  else {
    if (lpOemName == (LPSTR)0x0) {
      puVar3 = (undefined *)0x0;
    }
    else {
      puVar3 = local_60;
      _local_60 = CONCAT124(SUB1612(_local_60 >> 0x20,0),0xc0000);
      _local_60 = CONCAT88(local_40,local_60);
    }
    RtlInitUnicodeString(local_50,lpName);
    bVar1 = RtlIsNameLegalDOS8Dot3(local_50,puVar3,local_68);
    if (bVar1 != 0) {
      if (puVar3 != (undefined *)0x0) {
        _Size = (ulonglong)local_60._0_2_;
        if ((ulonglong)OemNameSize < _Size + 1) {
          uVar2 = 0x7a;
          goto LAB_1800385d4;
        }
        memcpy(lpOemName,pvStack88,_Size);
        lpOemName[_Size] = '\0';
      }
      if (pbNameContainsSpaces != (PBOOL)0x0) {
        *pbNameContainsSpaces = (uint)local_68[0];
      }
    }
    *pbNameLegal = (uint)bVar1;
  }
  __security_check_cookie(local_30 ^ (ulonglong)auStack136);
  return extraout_EAX;
}



BOOL CancelDeviceWakeupRequest(HANDLE hDevice)

{
                    // 0x38610  115  CancelDeviceWakeupRequest
                    // 0x38610  1227  RequestDeviceWakeup
                    // 0x38610  1228  RequestWakeupLatency
                    // 0x38610  1353  SetMessageWaitingIndicator
  BaseSetLastNTError();
  return 0;
}



BOOL IsSystemResumeAutomatic(void)

{
  byte bVar1;
  
                    // 0x38630  910  IsSystemResumeAutomatic
  bVar1 = NtIsSystemResumeAutomatic();
  return (BOOL)bVar1;
}



BOOL SetSystemPowerState(BOOL fSuspend,BOOL fForce)

{
  int iVar1;
  
                    // 0x38650  1375  SetSystemPowerState
  iVar1 = NtInitiatePowerAction
                    (3 - (uint)(fSuspend != 0),(-(uint)(fSuspend != 0) & 0xfffffffd) + 5,fForce != 1
                     ,0);
  if (-1 >= iVar1) {
    BaseSetLastNTError();
  }
  return (uint)(-1 < iVar1);
}



undefined8
FUN_1800386a0(undefined8 param_1,undefined8 param_2,LPCWSTR param_3,undefined8 param_4,
             undefined8 param_5,longlong **param_6)

{
  longlong **pplVar1;
  code *pcVar2;
  int iVar3;
  undefined8 uVar4;
  undefined4 *puVar5;
  longlong **pplVar6;
  HMODULE hModule;
  longlong *plVar7;
  longlong in_GS_OFFSET;
  undefined2 local_18;
  ushort local_16;
  void *local_10;
  
  uVar4 = RtlInitUnicodeStringEx(&local_18,param_1);
  if ((int)uVar4 < 0) {
    return uVar4;
  }
  for (pplVar6 = (longlong **)*param_6; pplVar6 != param_6; pplVar6 = (longlong **)*pplVar6) {
    iVar3 = RtlCompareUnicodeString(pplVar6 + 2,&local_18);
    if (iVar3 == 0) {
      return 0;
    }
  }
  puVar5 = (undefined4 *)KernelBaseGetGlobalData();
  pplVar6 = (longlong **)
            RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),*puVar5);
  if (pplVar6 == (longlong **)0x0) {
    return 0xc0000017;
  }
  pplVar6[1] = (longlong *)pplVar6;
  pplVar6[3] = (longlong *)(pplVar6 + 5);
  *pplVar6 = (longlong *)pplVar6;
  *(undefined2 *)(pplVar6 + 2) = local_18;
  *(ushort *)((longlong)pplVar6 + 0x12) = local_16;
  memcpy(pplVar6 + 5,local_10,(ulonglong)local_16);
  plVar7 = param_6[1];
  if ((longlong **)*plVar7 != param_6) {
LAB_180038ff8:
    pcVar2 = (code *)swi(0x29);
    (*pcVar2)(3);
    pcVar2 = (code *)swi(3);
    uVar4 = (*pcVar2)();
    return uVar4;
  }
  *pplVar6 = (longlong *)param_6;
  pplVar6[1] = plVar7;
  *plVar7 = (longlong)pplVar6;
  param_6[1] = (longlong *)pplVar6;
  if ((param_3 == (LPCWSTR)0x0) || (hModule = LoadLibraryW(param_3), hModule == (HMODULE)0x0)) {
    plVar7 = *pplVar6;
    if (((longlong **)plVar7[1] != pplVar6) ||
       (pplVar1 = (longlong **)pplVar6[1], (longlong **)*pplVar1 != pplVar6)) goto LAB_180038ff8;
    *pplVar1 = plVar7;
    plVar7[1] = (longlong)pplVar1;
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pplVar6);
  }
  else {
    plVar7 = (longlong *)GetProcAddress(hModule,"CreateProcessNotify");
    pplVar6[4] = plVar7;
    if (plVar7 == (longlong *)0x0) {
      plVar7 = *pplVar6;
      if (((longlong **)plVar7[1] != pplVar6) ||
         (pplVar1 = (longlong **)pplVar6[1], (longlong **)*pplVar1 != pplVar6)) goto LAB_180038ff8;
      *pplVar1 = plVar7;
      plVar7[1] = (longlong)pplVar1;
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pplVar6);
      FreeLibrary(hModule);
    }
  }
  return 0;
}



void BasepProcessInvalidImage
               (int param_1,longlong param_2,uint *param_3,LPCWSTR *param_4,WCHAR **param_5,
               LPCWSTR param_6,uint *param_7,undefined4 *param_8,ushort *param_9,undefined *param_10
               ,wchar_t **param_11,longlong param_12,longlong param_13,uint *param_14,
               undefined4 *param_15,undefined (*param_16) [16],undefined (*param_17) [16],
               undefined4 *param_18,uint *param_19,undefined4 *param_20,longlong *param_21)

{
  uint *puVar1;
  WCHAR WVar2;
  WCHAR **ppWVar3;
  int iVar4;
  DWORD DVar5;
  int iVar6;
  undefined8 uVar7;
  undefined4 *puVar8;
  LPWSTR lpBuffer;
  longlong lVar9;
  LPWSTR pWVar10;
  wchar_t *pwVar11;
  uint uVar12;
  uint uVar13;
  LPWSTR pWVar14;
  longlong lVar15;
  longlong lVar16;
  longlong in_GS_OFFSET;
  undefined auStackY632 [32];
  DWORD local_228 [2];
  longlong local_220;
  int local_218;
  uint local_214;
  undefined4 local_210 [2];
  LPCWSTR *local_208;
  longlong *local_200;
  WCHAR **local_1f8;
  undefined (*local_1f0) [16];
  undefined4 *local_1e8;
  uint *local_1e0;
  undefined (*local_1d8) [16];
  wchar_t **local_1d0;
  undefined4 local_1c4;
  uint local_1c0 [2];
  undefined8 local_1b8;
  undefined *local_1b0;
  uint *local_1a8;
  longlong local_1a0;
  longlong local_198;
  LPCWSTR local_190;
  undefined4 *local_188;
  undefined4 *local_180;
  undefined4 local_178;
  undefined4 uStack372;
  undefined4 uStack368;
  undefined4 uStack364;
  uint *local_168;
  int local_160;
  undefined4 local_15c;
  undefined local_158 [256];
  ulonglong local_58;
  
                    // 0x386c0  97  BasepProcessInvalidImage
  local_58 = DAT_1800b2220 ^ (ulonglong)auStackY632;
  lVar15 = -1;
  local_1f8 = param_5;
  iVar6 = 1;
  local_190 = param_6;
  local_180 = param_8;
  local_1b0 = param_10;
  local_1d0 = param_11;
  local_198 = param_12;
  local_1a0 = param_13;
  local_1e0 = param_14;
  local_1f0 = param_16;
  local_1d8 = param_17;
  local_1e8 = param_18;
  local_1a8 = param_19;
  local_188 = param_20;
  local_200 = param_21;
  local_1b8 = 0x100;
  local_220 = param_2;
  local_208 = param_4;
  if (param_2 == 0) {
LAB_180038adc:
    if (param_1 == -0x3fffffe0) {
      FUN_180040f08((WCHAR *)param_3,0x14,3,0);
    }
    else {
      if (param_1 != -0x3ffffee5) {
        if (param_1 == -0x3ffffed1) {
LAB_180038d49:
          uVar7 = BaseIsDosApplication(param_9);
          iVar6 = (int)uVar7;
          if (iVar6 != 0) goto LAB_180038d64;
          iVar6 = 0xc1;
        }
        else {
          if (param_1 == -0x3ffffed0) goto LAB_180038d64;
          if (param_1 == -0x3ffffecf) {
            lVar9 = -1;
            do {
              lVar9 = lVar9 + 1;
            } while (*(short *)((longlong)param_3 + lVar9 * 2) != 0);
            local_160 = (int)lVar9 * 2;
            local_15c = 0;
            local_168 = param_3;
            EtwEventWriteNoRegistration(&DAT_180088518,&DAT_180088508,1);
            lVar9 = local_220;
            if ((*param_7 & 0x2000) != 0) goto LAB_180038d49;
            local_214 = 1;
            *local_1b0 = 1;
            iVar6 = CheckElevation(param_3,&local_214,local_220,local_1c0,&local_1c4);
            if (iVar6 == 0) {
              iVar6 = FUN_18003f048(*local_1d0,local_1f0,local_1d8);
              lVar16 = local_198;
              lVar15 = local_1a0;
              puVar1 = local_1a8;
              ppWVar3 = local_1f8;
              if (iVar6 == 0) goto LAB_180038e0e;
              uVar12 = (-(uint)((*param_7 & 0x800) != 0) & 0x20) + 0x20;
              *local_1a8 = uVar12;
              while (iVar6 = FUN_18003d894(uVar12,*local_208,*ppWVar3,local_190,(ushort *)local_1f0,
                                           lVar15,local_1e0,*param_7,lVar16,lVar9), iVar6 < 0) {
                BaseSetLastNTError();
                if (((iVar6 == -0x3ffffbec) || (*puVar1 != 0x20)) ||
                   (DVar5 = GetLastError(), DVar5 != 5)) goto LAB_180038e0e;
                *param_7 = *param_7 | 0x800;
                uVar12 = 0x80;
                *puVar1 = 0x80;
                lVar9 = local_220;
              }
              uVar12 = *(ushort *)(lVar15 + 0xee) & 7;
              uVar13 = uVar12 - 1;
              if (uVar13 == 0) {
                *local_1e8 = 1;
                iVar6 = FUN_18003f738((ulonglong)uVar13,*local_1e0,*puVar1,param_15);
                if (iVar6 == 0) goto LAB_180038e07;
                *local_188 = 1;
                *ppWVar3 = *(WCHAR **)(param_15 + 2);
                *local_208 = (LPCWSTR)0x0;
                *param_7 = *param_7 & 0xffffffe7 | 0x8000000;
                puVar1 = (uint *)(lVar16 + 0x3c);
                *puVar1 = *puVar1 | 0x40;
              }
              else {
                if (uVar12 == 2) {
                  iVar6 = 0x15;
                  goto LAB_180038b2a;
                }
                if (uVar13 == 3) {
                  *local_1e8 = 4;
                  *local_200 = *(longlong *)(lVar15 + 0x58);
                }
              }
              if (*local_200 == 0) {
                *local_180 = 0;
                *local_1d0 = *(wchar_t **)(*local_1d8 + 8);
              }
              goto LAB_180038e0e;
            }
          }
          else if (param_1 == -0x3ffffd99) {
            iVar6 = 0x10fe;
          }
          else {
            if (param_1 != -0x3ffffbd8) goto LAB_180038e07;
            iVar6 = 0x241;
          }
        }
LAB_180038b2a:
        RtlSetLastWin32Error(iVar6);
        goto LAB_180038e0e;
      }
LAB_180038d64:
      pwVar11 = FUN_18004094c((LPCWSTR)param_3,local_210,local_228);
      if ((int)pwVar11 == 0) {
        do {
          lVar15 = lVar15 + 1;
        } while (*(short *)((longlong)param_3 + lVar15 * 2) != 0);
        local_15c = 0;
        local_160 = (int)lVar15 * 2;
        local_168 = param_3;
        EtwEventWriteNoRegistration(&DAT_180088518);
        FUN_180040f08((WCHAR *)param_3,iVar6 + 0x10,0,local_228[0]);
        RaiseInvalid16BitExeError(param_9);
        goto LAB_180038e0e;
      }
      FUN_180040f08((WCHAR *)param_3,0x14,local_210[0],local_228[0]);
    }
  }
  else {
    if ((param_1 != -0x3ffffee5) && (1 < param_1 + 0x3ffffed0U)) {
      if (param_1 != -0x3ffffed1) goto LAB_180038adc;
      uVar7 = BaseIsDosApplication(param_9);
      if ((int)uVar7 != 0) goto LAB_180038800;
      goto LAB_180038d49;
    }
LAB_180038800:
    iVar4 = RtlQueryPackageIdentity(local_220,local_158,&local_1b8,0);
    if ((iVar4 < 0) && (iVar4 = NtQueryInformationToken(local_220,0xc,&local_218), -1 < iVar4)) {
      if (local_218 == *(int *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x2c0)) goto LAB_180038adc;
      puVar8 = (undefined4 *)KernelBaseGetGlobalData();
      lpBuffer = (LPWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                         *puVar8,0x208);
      DVar5 = GetEnvironmentVariableW(L"SystemRoot",lpBuffer,0xef);
      if (DVar5 - 1 < 0xee) {
        lVar15 = 0x104;
        pWVar14 = lpBuffer;
        do {
          if (*pWVar14 == L'\0') break;
          pWVar14 = pWVar14 + 1;
          lVar15 = lVar15 + -1;
        } while (lVar15 != 0);
        if (lVar15 != 0) {
          lVar9 = -lVar15 + 0x104;
          pWVar14 = lpBuffer + lVar9;
          lVar9 = 0x104 - lVar9;
          if (lVar9 != 0) {
            lVar16 = -lVar15 + 0x7ffffffe + lVar9;
            lVar15 = (longlong)L"\\system32\\csrstub.exe" - (longlong)pWVar14;
            do {
              if ((lVar16 == 0) || (WVar2 = *(WCHAR *)(lVar15 + (longlong)pWVar14), WVar2 == L'\0'))
              break;
              *pWVar14 = WVar2;
              lVar16 = lVar16 + -1;
              pWVar14 = pWVar14 + 1;
              lVar9 = lVar9 + -1;
            } while (lVar9 != 0);
          }
          pWVar10 = pWVar14 + -1;
          if (lVar9 != 0) {
            pWVar10 = pWVar14;
          }
          *pWVar10 = L'\0';
        }
        puVar8 = (undefined4 *)KernelBaseGetGlobalData();
        pwVar11 = (wchar_t *)
                  RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),*puVar8
                                  ,(ulonglong)(DVar5 + 0x119) * 2);
        ppWVar3 = local_1f8;
        if (pwVar11 == (wchar_t *)0x0) {
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpBuffer);
        }
        else {
          iVar6 = FUN_180039540(pwVar11,(ulonglong)(DVar5 + 0x119),L"%ws %d -P %ws",lpBuffer);
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpBuffer);
          if (iVar6 < 0) {
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pwVar11);
          }
          else {
            iVar6 = RtlInitUnicodeStringEx(&local_178,pwVar11);
            if (-1 < iVar6) {
              RtlFreeUnicodeString(param_15);
              *param_15 = local_178;
              param_15[1] = uStack372;
              param_15[2] = uStack368;
              param_15[3] = uStack364;
              *ppWVar3 = *(WCHAR **)(param_15 + 2);
              *local_208 = (LPCWSTR)0x0;
              *param_7 = *param_7 & 0x404 | 0xc000000;
              goto LAB_180038e0e;
            }
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pwVar11);
          }
        }
      }
      else {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
      }
    }
  }
LAB_180038e07:
  BaseSetLastNTError();
LAB_180038e0e:
  __security_check_cookie(local_58 ^ (ulonglong)auStackY632);
  return;
}



BOOL GetProcessDEPPolicy(HANDLE hProcess,LPDWORD lpFlags,PBOOL lpPermanent)

{
  BOOL BVar1;
  DWORD local_res20;
  byte local_res24;
  
                    // 0x39010  699  GetProcessDEPPolicy
  BVar1 = GetProcessMitigationPolicy(hProcess,0,&local_res20,8);
  if (BVar1 != 0) {
    *lpFlags = local_res20;
    *lpPermanent = (uint)local_res24;
  }
  return BVar1;
}



DEP_SYSTEM_POLICY_TYPE GetSystemDEPPolicy(void)

{
  DEP_SYSTEM_POLICY_TYPE DVar1;
  DEP_SYSTEM_POLICY_TYPE DVar2;
  
                    // 0x39060  741  GetSystemDEPPolicy
  DVar1 = DAT_7ffe02d5 & DEPPolicyOptOut;
  DVar2 = DEPPolicyAlwaysOff;
  if ((DAT_7ffe02d5 & 3) != 0) {
    if (DVar1 == DEPPolicyAlwaysOn) {
      DVar2 = DEPPolicyAlwaysOn;
    }
    else if (DVar1 == DEPPolicyOptIn) {
      DVar2 = DEPPolicyOptIn;
    }
    else if (DVar1 == DEPPolicyOptOut) {
      DVar2 = DVar1;
    }
  }
  return DVar2;
}



BOOL GetSystemRegistryQuota(PDWORD pdwQuotaAllowed,PDWORD pdwQuotaUsed)

{
  int iVar1;
  BOOL extraout_EAX;
  undefined auStack72 [32];
  DWORD local_28;
  DWORD local_24;
  ulonglong local_18;
  
                    // 0x390a0  753  GetSystemRegistryQuota
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack72;
  iVar1 = NtQuerySystemInformation(0x25,&local_28,0x10);
  if (iVar1 < 0) {
    BaseSetLastNTError();
  }
  else {
    if (pdwQuotaAllowed != (PDWORD)0x0) {
      *pdwQuotaAllowed = local_28;
    }
    if (pdwQuotaUsed != (PDWORD)0x0) {
      *pdwQuotaUsed = local_24;
    }
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack72);
  return extraout_EAX;
}



BOOL IsBadCodePtr(FARPROC lpfn)

{
  BOOL BVar1;
  
                    // 0x39130  890  IsBadCodePtr
  BVar1 = IsBadReadPtr(lpfn,1);
  return BVar1;
}



BOOL IsBadHugeReadPtr(void *lp,UINT_PTR ucb)

{
  void *pvVar1;
  ulonglong uVar2;
  
  if (ucb != 0) {
    if ((lp == (void *)0x0) || (pvVar1 = (void *)((ucb - 1) + (longlong)lp), pvVar1 < lp)) {
      return 1;
    }
    for (uVar2 = (longlong)(int)-DAT_1800b2a48 & (ulonglong)lp;
        uVar2 != ((ulonglong)pvVar1 & (longlong)(int)-DAT_1800b2a48); uVar2 = uVar2 + DAT_1800b2a48)
    {
    }
  }
  return 0;
}



BOOL IsBadHugeWritePtr(LPVOID lp,UINT_PTR ucb)

{
  uint uVar1;
  LPVOID pvVar2;
  undefined *puVar3;
  ulonglong uVar4;
  
                    // 0x39150  892  IsBadHugeWritePtr
  uVar1 = DAT_1800b2a48;
  uVar4 = (ulonglong)DAT_1800b2a48;
  if (ucb != 0) {
    if ((lp == (LPVOID)0x0) || (pvVar2 = (LPVOID)((ucb - 1) + (longlong)lp), pvVar2 < lp)) {
      return 1;
    }
                    // WARNING: Load size is inaccurate
    *(undefined *)lp = *lp;
    puVar3 = (undefined *)((longlong)(int)-uVar1 & (ulonglong)lp);
    while (puVar3 != (undefined *)((ulonglong)pvVar2 & (longlong)(int)-uVar1)) {
      puVar3 = puVar3 + uVar4;
      *puVar3 = *puVar3;
    }
  }
  return 0;
}



BOOL IsBadStringPtrA(LPCSTR lpsz,UINT_PTR ucchMax)

{
  char cVar1;
  LPCSTR local_18;
  
                    // 0x39160  894  IsBadStringPtrA
  if (ucchMax != 0) {
    if (lpsz == (LPCSTR)0x0) {
      return 1;
    }
    cVar1 = *lpsz;
    local_18 = lpsz;
    while ((cVar1 != '\0' && (local_18 != lpsz + (ucchMax - 1)))) {
      local_18 = local_18 + 1;
      cVar1 = *local_18;
    }
  }
  return 0;
}



BOOL IsBadStringPtrW(LPCWSTR lpsz,UINT_PTR ucchMax)

{
  WCHAR WVar1;
  LPCWSTR local_18;
  
                    // 0x391b0  895  IsBadStringPtrW
  if (ucchMax != 0) {
    if (lpsz == (LPCWSTR)0x0) {
      return 1;
    }
    WVar1 = *lpsz;
    local_18 = lpsz;
    while ((WVar1 != L'\0' && (local_18 != lpsz + (ucchMax - 1)))) {
      local_18 = local_18 + 1;
      WVar1 = *local_18;
    }
  }
  return 0;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void NtVdm64CreateProcessInternalW
               (undefined8 param_1,WCHAR *param_2,ulonglong param_3,undefined8 param_4,
               undefined8 param_5,undefined4 param_6,undefined4 param_7,undefined8 param_8,
               undefined8 param_9,undefined8 param_10,undefined8 param_11,undefined8 param_12)

{
  uint uVar1;
  int iVar2;
  HMODULE hModule;
  FARPROC pFVar3;
  DWORD DVar4;
  longlong in_GS_OFFSET;
  undefined auStack776 [32];
  undefined8 local_2e8;
  undefined4 local_2e0;
  undefined4 local_2d8;
  undefined8 local_2d0;
  undefined8 local_2c8;
  undefined8 local_2c0;
  undefined8 local_2b8;
  undefined8 local_2b0;
  undefined8 local_298;
  undefined8 local_290;
  undefined8 local_288;
  undefined8 local_280;
  undefined8 local_278;
  short local_268 [264];
  ulonglong local_58;
  
                    // 0x39210  1025  NtVdm64CreateProcessInternalW
  local_58 = DAT_1800b2220 ^ (ulonglong)auStack776;
  local_278 = param_8;
  local_280 = param_9;
  DVar4 = 0xc1;
  local_288 = param_10;
  local_290 = param_11;
  local_298 = param_12;
  if (((*(longlong *)(in_GS_OFFSET + 0x30) + 0x1268U <= param_3) &&
      (param_3 < *(longlong *)(in_GS_OFFSET + 0x30) + 0x1472U)) &&
     (uVar1 = FUN_18000b370(local_268,0x105,param_3), (int)uVar1 < 0)) {
    DVar4 = uVar1 & 0xffff;
    goto LAB_1800393e2;
  }
  hModule = LoadLibraryExW(L"NtVdm64.Dll",(HANDLE)0x0,0x800);
  if (hModule == (HMODULE)0x0) goto LAB_1800393e2;
  pFVar3 = GetProcAddress(hModule,"NtVdm64CreateProcessInternalW");
  if (pFVar3 != (FARPROC)0x0) {
    local_2b0 = local_298;
    local_2b8 = local_290;
    local_2c0 = local_288;
    local_2c8 = local_280;
    local_2d0 = local_278;
    local_2d8 = param_7;
    local_2e0 = param_6;
    local_2e8 = param_5;
    iVar2 = (*pFVar3)();
    DVar4 = GetLastError();
    if (iVar2 == 0) {
      if (DVar4 != 0xd8) goto LAB_1800393d3;
      iVar2 = 0x20;
    }
    else {
      iVar2 = 0x100;
    }
    FUN_180040f08(param_2,iVar2,0,0);
  }
LAB_1800393d3:
  FreeLibrary(hModule);
LAB_1800393e2:
  RtlSetLastWin32Error(DVar4);
  __security_check_cookie(local_58 ^ (ulonglong)auStack776);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void RaiseInvalid16BitExeError(ushort *param_1)

{
  HMODULE hModule;
  FARPROC pFVar1;
  undefined8 uVar2;
  longlong in_GS_OFFSET;
  undefined auStack88 [32];
  undefined8 local_38;
  undefined8 local_30;
  undefined8 local_28;
  uint local_20;
  undefined4 local_1c;
  ulonglong local_18;
  
                    // 0x39420  1131  RaiseInvalid16BitExeError
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack88;
  hModule = LoadLibraryExW(L"NtVdm64.Dll",(HANDLE)0x0,0x800);
  if (hModule != (HMODULE)0x0) {
    pFVar1 = GetProcAddress(hModule,"NtVdm64RaiseInvalid16BitError");
    if (pFVar1 != (FARPROC)0x0) {
      (*pFVar1)();
    }
    FreeLibrary(hModule);
  }
  local_38 = *(undefined8 *)(param_1 + 4);
  local_30 = 0;
  RtlWow64LogMessageInEventLogger(1,&local_38,0x40000455);
  local_28 = *(undefined8 *)(param_1 + 4);
  local_1c = 0;
  local_20 = (uint)*param_1;
  EtwEventWriteNoRegistration(&DAT_180088518,&DAT_180088508,1,&local_28);
  uVar2 = 0xc1;
  if (3 < *(uint *)(*(longlong *)(in_GS_OFFSET + 0x60) + 300)) {
    uVar2 = 0xd8;
  }
  RtlSetLastWin32Error(uVar2);
  __security_check_cookie(local_18 ^ (ulonglong)auStack88);
  return;
}



int FUN_180039540(wchar_t *param_1,longlong param_2,wchar_t *param_3,undefined8 param_4)

{
  ulonglong _Count;
  int iVar1;
  int iVar2;
  undefined8 local_res20;
  
  iVar2 = 0;
  if (0x7ffffffe < param_2 - 1U) {
    iVar2 = -0x3ffffff3;
  }
  if (iVar2 < 0) {
    if (param_2 != 0) {
      *param_1 = L'\0';
    }
  }
  else {
    _Count = param_2 - 1;
    iVar2 = 0;
    local_res20 = param_4;
    iVar1 = _vsnwprintf(param_1,_Count,param_3,(va_list)&local_res20);
    if ((iVar1 < 0) || (_Count < (ulonglong)(longlong)iVar1)) {
      param_1[_Count] = L'\0';
      iVar2 = -0x7ffffffb;
    }
    else if ((longlong)iVar1 == _Count) {
      param_1[_Count] = L'\0';
    }
  }
  return iVar2;
}



BOOL ReplacePartitionUnit(PWSTR TargetPartition,PWSTR SparePartition,ULONG Flags)

{
  int iVar1;
  undefined4 in_register_00000084;
  undefined local_28 [16];
  undefined local_18 [16];
  
                    // 0x395d0  1226  ReplacePartitionUnit
  RtlInitUnicodeString(local_28,SparePartition,CONCAT44(in_register_00000084,Flags));
  RtlInitUnicodeString(local_18,TargetPartition);
  iVar1 = NtReplacePartitionUnit(local_18,local_28,Flags);
  if (-1 >= iVar1) {
    BaseSetLastNTError();
  }
  return (uint)(-1 < iVar1);
}



void AddResourceAttributeAce(void)

{
                    // WARNING: Could not recover jumptable at 0x000180039650. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39650  15  AddResourceAttributeAce
  AddResourceAttributeAce();
  return;
}



void AddScopedPolicyIDAce(void)

{
                    // WARNING: Could not recover jumptable at 0x000180039670. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39670  17  AddScopedPolicyIDAce
  AddScopedPolicyIDAce();
  return;
}



BOOL AllocateUserPhysicalPagesNuma
               (HANDLE hProcess,PULONG_PTR NumberOfPages,PULONG_PTR PageArray,DWORD nndPreferred)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039690. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39690  24  AllocateUserPhysicalPagesNuma
  BVar1 = AllocateUserPhysicalPagesNuma(hProcess,NumberOfPages,PageArray,nndPreferred);
  return BVar1;
}



BOOL AllocateUserPhysicalPages(HANDLE hProcess,PULONG_PTR NumberOfPages,PULONG_PTR PageArray)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800396b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x396b0  23  AllocateUserPhysicalPages
  BVar1 = AllocateUserPhysicalPages(hProcess,NumberOfPages,PageArray);
  return BVar1;
}



void BaseCheckAppcompatCacheEx
               (undefined param_1,undefined param_2,undefined param_3,undefined param_4,
               undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8,
               undefined8 param_9)

{
                    // 0x396d0  43  BaseCheckAppcompatCacheEx
  BaseCheckAppcompatCacheEx();
  return;
}



void BaseCheckAppcompatCache(void)

{
                    // WARNING: Could not recover jumptable at 0x000180039730. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39730  42  BaseCheckAppcompatCache
  BaseCheckAppcompatCache();
  return;
}



void BaseCleanupAppcompatCacheSupport(void)

{
                    // WARNING: Could not recover jumptable at 0x000180039750. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39750  47  BaseCleanupAppcompatCacheSupport
  BaseCleanupAppcompatCacheSupport();
  return;
}



void BaseDumpAppcompatCache(void)

{
                    // WARNING: Could not recover jumptable at 0x000180039770. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39770  51  BaseDumpAppcompatCache
  BaseDumpAppcompatCache();
  return;
}



void BaseFlushAppcompatCache(void)

{
                    // WARNING: Could not recover jumptable at 0x000180039790. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39790  54  BaseFlushAppcompatCache
  BaseFlushAppcompatCache();
  return;
}



void BaseGetNamedObjectDirectory(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800397b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x397b0  60  BaseGetNamedObjectDirectory
  BaseGetNamedObjectDirectory();
  return;
}



void BaseInitAppcompatCacheSupport(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800397d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x397d0  61  BaseInitAppcompatCacheSupport
  BaseInitAppcompatCacheSupport();
  return;
}



void BaseUpdateAppcompatCache(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800397f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x397f0  70  BaseUpdateAppcompatCache
  BaseUpdateAppcompatCache();
  return;
}



BOOL CallbackMayRunLong(PTP_CALLBACK_INSTANCE pci)

{
  int iVar1;
  
                    // 0x39810  114  CallbackMayRunLong
  iVar1 = TpCallbackMayRunLong();
  if (-1 >= iVar1) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  }
  return (uint)(-1 < iVar1);
}



BOOL CancelSynchronousIo(HANDLE hThread)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039850. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39850  118  CancelSynchronousIo
  BVar1 = CancelSynchronousIo(hThread);
  return BVar1;
}



void CheckAllowDecryptedRemoteDestinationPolicy(void)

{
                    // WARNING: Could not recover jumptable at 0x000180039870. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39870  124  CheckAllowDecryptedRemoteDestinationPolicy
  CheckAllowDecryptedRemoteDestinationPolicy();
  return;
}



void CheckTokenCapability(void)

{
                    // WARNING: Could not recover jumptable at 0x000180039890. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39890  133  CheckTokenCapability
  CheckTokenCapability();
  return;
}



void CheckTokenMembershipEx(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800398b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x398b0  134  CheckTokenMembershipEx
  CheckTokenMembershipEx();
  return;
}



BOOL ContinueDebugEvent(DWORD dwProcessId,DWORD dwThreadId,DWORD dwContinueStatus)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800398d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x398d0  162  ContinueDebugEvent
  BVar1 = ContinueDebugEvent(dwProcessId,dwThreadId,dwContinueStatus);
  return BVar1;
}



LCID ConvertDefaultLocale(LCID Locale)

{
  LCID LVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800398f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x398f0  164  ConvertDefaultLocale
  LVar1 = ConvertDefaultLocale(Locale);
  return LVar1;
}



void CopyContext(void)

{
                    // WARNING: Could not recover jumptable at 0x000180039910. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39910  170  CopyContext
  CopyContext();
  return;
}



void CopyFile2(void)

{
                    // WARNING: Could not recover jumptable at 0x000180039930. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39930  171  CopyFile2
  CopyFile2();
  return;
}



BOOL CreateDirectoryExW(LPCWSTR lpTemplateDirectory,LPCWSTR lpNewDirectory,
                       LPSECURITY_ATTRIBUTES lpSecurityAttributes)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039950. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39950  187  CreateDirectoryExW
  BVar1 = CreateDirectoryExW(lpTemplateDirectory,lpNewDirectory,lpSecurityAttributes);
  return BVar1;
}



HANDLE CreateFileMappingNumaW
                 (HANDLE hFile,LPSECURITY_ATTRIBUTES lpFileMappingAttributes,DWORD flProtect,
                 DWORD dwMaximumSizeHigh,DWORD dwMaximumSizeLow,LPCWSTR lpName,DWORD nndPreferred)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039970. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39970  203  CreateFileMappingNumaW
  pvVar1 = CreateFileMappingNumaW
                     (hFile,lpFileMappingAttributes,flProtect,dwMaximumSizeHigh,dwMaximumSizeLow,
                      lpName,nndPreferred);
  return pvVar1;
}



BOOL CreateHardLinkA(LPCSTR lpFileName,LPCSTR lpExistingFileName,
                    LPSECURITY_ATTRIBUTES lpSecurityAttributes)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039990. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39990  208  CreateHardLinkA
  BVar1 = CreateHardLinkA(lpFileName,lpExistingFileName,lpSecurityAttributes);
  return BVar1;
}



BOOL CreateHardLinkW(LPCWSTR lpFileName,LPCWSTR lpExistingFileName,
                    LPSECURITY_ATTRIBUTES lpSecurityAttributes)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800399b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x399b0  211  CreateHardLinkW
  BVar1 = CreateHardLinkW(lpFileName,lpExistingFileName,lpSecurityAttributes);
  return BVar1;
}



BOOL CreateProcessAsUserA
               (HANDLE hToken,LPCSTR lpApplicationName,LPSTR lpCommandLine,
               LPSECURITY_ATTRIBUTES lpProcessAttributes,LPSECURITY_ATTRIBUTES lpThreadAttributes,
               BOOL bInheritHandles,DWORD dwCreationFlags,LPVOID lpEnvironment,
               LPCSTR lpCurrentDirectory,LPSTARTUPINFOA lpStartupInfo,
               LPPROCESS_INFORMATION lpProcessInformation)

{
  BOOL BVar1;
  
                    // 0x399d0  229  CreateProcessAsUserA
  BVar1 = CreateProcessAsUserA
                    (hToken,lpApplicationName,lpCommandLine,lpProcessAttributes,lpThreadAttributes,
                     bInheritHandles,dwCreationFlags,lpEnvironment,lpCurrentDirectory,lpStartupInfo,
                     lpProcessInformation);
  return BVar1;
}



void CreateProcessInternalA
               (undefined param_1,undefined param_2,undefined param_3,undefined param_4,
               undefined8 param_5,undefined4 param_6,undefined4 param_7,undefined8 param_8,
               undefined8 param_9,undefined8 param_10,undefined8 param_11,undefined8 param_12)

{
                    // 0x39a50  231  CreateProcessInternalA
  CreateProcessInternalA();
  return;
}



void CreateProcessInternalW
               (undefined param_1,undefined param_2,undefined param_3,undefined param_4,
               undefined8 param_5,undefined4 param_6,undefined4 param_7,undefined8 param_8,
               undefined8 param_9,undefined8 param_10,undefined8 param_11,undefined8 param_12)

{
                    // 0x39ad0  232  CreateProcessInternalW
  CreateProcessInternalW();
  return;
}



HANDLE CreateRemoteThread(HANDLE hProcess,LPSECURITY_ATTRIBUTES lpThreadAttributes,
                         SIZE_T dwStackSize,LPTHREAD_START_ROUTINE lpStartAddress,LPVOID lpParameter
                         ,DWORD dwCreationFlags,LPDWORD lpThreadId)

{
  HANDLE pvVar1;
  
                    // 0x39b50  235  CreateRemoteThread
  pvVar1 = CreateRemoteThreadEx
                     (hProcess,lpThreadAttributes,dwStackSize,lpStartAddress,lpParameter,
                      dwCreationFlags & 0x10004,(LPPROC_THREAD_ATTRIBUTE_LIST)0x0,lpThreadId);
  return pvVar1;
}



BOOLEAN CreateSymbolicLinkW(LPCWSTR lpSymlinkFileName,LPCWSTR lpTargetFileName,DWORD dwFlags)

{
  BOOLEAN BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039ba0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39ba0  244  CreateSymbolicLinkW
  BVar1 = CreateSymbolicLinkW(lpSymlinkFileName,lpTargetFileName,dwFlags);
  return BVar1;
}



BOOL DebugActiveProcessStop(DWORD dwProcessId)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039bc0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39bc0  266  DebugActiveProcessStop
  BVar1 = DebugActiveProcessStop(dwProcessId);
  return BVar1;
}



BOOL DebugActiveProcess(DWORD dwProcessId)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039be0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39be0  265  DebugActiveProcess
  BVar1 = DebugActiveProcess(dwProcessId);
  return BVar1;
}



void DebugBreak(void)

{
                    // WARNING: Could not recover jumptable at 0x000180039c00. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39c00  267  DebugBreak
  DebugBreak();
  return;
}



void DeleteSynchronizationBarrier(void)

{
                    // WARNING: Could not recover jumptable at 0x000180039c20. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39c20  284  DeleteSynchronizationBarrier
  DeleteSynchronizationBarrier();
  return;
}



void DnsHostnameToComputerNameExW(void)

{
                    // WARNING: Could not recover jumptable at 0x000180039c40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39c40  300  DnsHostnameToComputerNameExW
  DnsHostnameToComputerNameExW();
  return;
}



void EnterSynchronizationBarrier(void)

{
                    // WARNING: Could not recover jumptable at 0x000180039c60. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39c60  314  EnterSynchronizationBarrier
  EnterSynchronizationBarrier();
  return;
}



BOOL EnumCalendarInfoExW(CALINFO_ENUMPROCEXW lpCalInfoEnumProcEx,LCID Locale,CALID Calendar,
                        CALTYPE CalType)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039c80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39c80  319  EnumCalendarInfoExW
  BVar1 = EnumCalendarInfoExW(lpCalInfoEnumProcEx,Locale,Calendar,CalType);
  return BVar1;
}



BOOL EnumCalendarInfoW(CALINFO_ENUMPROCW lpCalInfoEnumProc,LCID Locale,CALID Calendar,
                      CALTYPE CalType)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039ca0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39ca0  320  EnumCalendarInfoW
  BVar1 = EnumCalendarInfoW(lpCalInfoEnumProc,Locale,Calendar,CalType);
  return BVar1;
}



BOOL EnumDateFormatsExEx(DATEFMT_ENUMPROCEXEX lpDateFmtEnumProcExEx,LPCWSTR lpLocaleName,
                        DWORD dwFlags,LPARAM lParam)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039cc0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39cc0  323  EnumDateFormatsExEx
  BVar1 = EnumDateFormatsExEx(lpDateFmtEnumProcExEx,lpLocaleName,dwFlags,lParam);
  return BVar1;
}



BOOL EnumDateFormatsExW(DATEFMT_ENUMPROCEXW lpDateFmtEnumProcEx,LCID Locale,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039ce0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39ce0  324  EnumDateFormatsExW
  BVar1 = EnumDateFormatsExW(lpDateFmtEnumProcEx,Locale,dwFlags);
  return BVar1;
}



BOOL EnumDateFormatsW(DATEFMT_ENUMPROCW lpDateFmtEnumProc,LCID Locale,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039d00. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39d00  325  EnumDateFormatsW
  BVar1 = EnumDateFormatsW(lpDateFmtEnumProc,Locale,dwFlags);
  return BVar1;
}



BOOL EnumLanguageGroupLocalesW
               (LANGGROUPLOCALE_ENUMPROCW lpLangGroupLocaleEnumProc,LGRPID LanguageGroup,
               DWORD dwFlags,LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039d20. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39d20  327  EnumLanguageGroupLocalesW
  BVar1 = EnumLanguageGroupLocalesW(lpLangGroupLocaleEnumProc,LanguageGroup,dwFlags,lParam);
  return BVar1;
}



BOOL EnumResourceLanguagesExA
               (HMODULE hModule,LPCSTR lpType,LPCSTR lpName,ENUMRESLANGPROCA lpEnumFunc,
               LONG_PTR lParam,DWORD dwFlags,LANGID LangId)

{
  BOOL BVar1;
  
                    // 0x39d40  329  EnumResourceLanguagesExA
                    // WARNING: Could not recover jumptable at 0x000180039d4a. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumResourceLanguagesExA(hModule,lpType,lpName,lpEnumFunc,lParam,dwFlags,LangId);
  return BVar1;
}



BOOL EnumResourceLanguagesExW
               (HMODULE hModule,LPCWSTR lpType,LPCWSTR lpName,ENUMRESLANGPROCW lpEnumFunc,
               LONG_PTR lParam,DWORD dwFlags,LANGID LangId)

{
  BOOL BVar1;
  
                    // 0x39d60  330  EnumResourceLanguagesExW
                    // WARNING: Could not recover jumptable at 0x000180039d6a. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumResourceLanguagesExW(hModule,lpType,lpName,lpEnumFunc,lParam,dwFlags,LangId);
  return BVar1;
}



BOOL EnumResourceNamesExA
               (HMODULE hModule,LPCSTR lpType,ENUMRESNAMEPROCA lpEnumFunc,LONG_PTR lParam,
               DWORD dwFlags,LANGID LangId)

{
  BOOL BVar1;
  
                    // 0x39d80  333  EnumResourceNamesExA
                    // WARNING: Could not recover jumptable at 0x000180039d8a. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumResourceNamesExA(hModule,lpType,lpEnumFunc,lParam,dwFlags,LangId);
  return BVar1;
}



BOOL EnumResourceNamesExW
               (HMODULE hModule,LPCWSTR lpType,ENUMRESNAMEPROCW lpEnumFunc,LONG_PTR lParam,
               DWORD dwFlags,LANGID LangId)

{
  BOOL BVar1;
  
                    // 0x39da0  334  EnumResourceNamesExW
                    // WARNING: Could not recover jumptable at 0x000180039daa. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumResourceNamesExW(hModule,lpType,lpEnumFunc,lParam,dwFlags,LangId);
  return BVar1;
}



BOOL EnumResourceTypesExA
               (HMODULE hModule,ENUMRESTYPEPROCA lpEnumFunc,LONG_PTR lParam,DWORD dwFlags,
               LANGID LangId)

{
  BOOL BVar1;
  
                    // 0x39dc0  337  EnumResourceTypesExA
                    // WARNING: Could not recover jumptable at 0x000180039dca. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumResourceTypesExA(hModule,lpEnumFunc,lParam,dwFlags,LangId);
  return BVar1;
}



BOOL EnumResourceTypesExW
               (HMODULE hModule,ENUMRESTYPEPROCW lpEnumFunc,LONG_PTR lParam,DWORD dwFlags,
               LANGID LangId)

{
  BOOL BVar1;
  
                    // 0x39de0  338  EnumResourceTypesExW
                    // WARNING: Could not recover jumptable at 0x000180039dea. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = EnumResourceTypesExW(hModule,lpEnumFunc,lParam,dwFlags,LangId);
  return BVar1;
}



BOOL EnumSystemCodePagesW(CODEPAGE_ENUMPROCW lpCodePageEnumProc,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039e00. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39e00  341  EnumSystemCodePagesW
  BVar1 = EnumSystemCodePagesW(lpCodePageEnumProc,dwFlags);
  return BVar1;
}



BOOL EnumSystemLanguageGroupsW
               (LANGUAGEGROUP_ENUMPROCW lpLanguageGroupEnumProc,DWORD dwFlags,LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039e20. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39e20  346  EnumSystemLanguageGroupsW
  BVar1 = EnumSystemLanguageGroupsW(lpLanguageGroupEnumProc,dwFlags,lParam);
  return BVar1;
}



BOOL EnumSystemLocalesA(LOCALE_ENUMPROCA lpLocaleEnumProc,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039e40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39e40  347  EnumSystemLocalesA
  BVar1 = EnumSystemLocalesA(lpLocaleEnumProc,dwFlags);
  return BVar1;
}



BOOL EnumSystemLocalesEx(LOCALE_ENUMPROCEX lpLocaleEnumProcEx,DWORD dwFlags,LPARAM lParam,
                        LPVOID lpReserved)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039e60. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39e60  348  EnumSystemLocalesEx
  BVar1 = EnumSystemLocalesEx(lpLocaleEnumProcEx,dwFlags,lParam,lpReserved);
  return BVar1;
}



BOOL EnumSystemLocalesW(LOCALE_ENUMPROCW lpLocaleEnumProc,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039e80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39e80  349  EnumSystemLocalesW
  BVar1 = EnumSystemLocalesW(lpLocaleEnumProc,dwFlags);
  return BVar1;
}



BOOL EnumTimeFormatsW(TIMEFMT_ENUMPROCW lpTimeFmtEnumProc,LCID Locale,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039ea0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39ea0  352  EnumTimeFormatsW
  BVar1 = EnumTimeFormatsW(lpTimeFmtEnumProc,Locale,dwFlags);
  return BVar1;
}



BOOL EnumUILanguagesW(UILANGUAGE_ENUMPROCW lpUILanguageEnumProc,DWORD dwFlags,LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039ec0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39ec0  354  EnumUILanguagesW
  BVar1 = EnumUILanguagesW(lpUILanguageEnumProc,dwFlags,lParam);
  return BVar1;
}



void FatalAppExitA(UINT uAction,LPCSTR lpMessageText)

{
                    // WARNING: Could not recover jumptable at 0x000180039ee0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39ee0  367  FatalAppExitA
  FatalAppExitA(uAction,lpMessageText);
  return;
}



void FatalAppExitW(UINT uAction,LPCWSTR lpMessageText)

{
                    // WARNING: Could not recover jumptable at 0x000180039f00. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39f00  368  FatalAppExitW
  FatalAppExitW(uAction,lpMessageText);
  return;
}



int FindNLSString(LCID Locale,DWORD dwFindNLSStringFlags,LPCWSTR lpStringSource,int cchSource,
                 LPCWSTR lpStringValue,int cchValue,LPINT pcchFound)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039f20. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39f20  401  FindNLSString
  iVar1 = FindNLSString(Locale,dwFindNLSStringFlags,lpStringSource,cchSource,lpStringValue,cchValue,
                        pcchFound);
  return iVar1;
}



int FindStringOrdinal(DWORD dwFindStringOrdinalFlags,LPCWSTR lpStringSource,int cchSource,
                     LPCWSTR lpStringValue,int cchValue,BOOL bIgnoreCase)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039f40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39f40  417  FindStringOrdinal
  iVar1 = FindStringOrdinal(dwFindStringOrdinalFlags,lpStringSource,cchSource,lpStringValue,cchValue
                            ,bIgnoreCase);
  return iVar1;
}



BOOL FlushViewOfFile(LPCVOID lpBaseAddress,SIZE_T dwNumberOfBytesToFlush)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039f60. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39f60  428  FlushViewOfFile
  BVar1 = FlushViewOfFile(lpBaseAddress,dwNumberOfBytesToFlush);
  return BVar1;
}



int FoldStringW(DWORD dwMapFlags,LPCWSTR lpSrcStr,int cchSrc,LPWSTR lpDestStr,int cchDest)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039f80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39f80  430  FoldStringW
  iVar1 = FoldStringW(dwMapFlags,lpSrcStr,cchSrc,lpDestStr,cchDest);
  return iVar1;
}



BOOL FreeUserPhysicalPages(HANDLE hProcess,PULONG_PTR NumberOfPages,PULONG_PTR PageArray)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180039fa0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39fa0  442  FreeUserPhysicalPages
  BVar1 = FreeUserPhysicalPages(hProcess,NumberOfPages,PageArray);
  return BVar1;
}



void GetAppContainerAce(void)

{
                    // WARNING: Could not recover jumptable at 0x000180039fc0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39fc0  447  GetAppContainerAce
  GetAppContainerAce();
  return;
}



void GetAppContainerNamedObjectPath(void)

{
                    // WARNING: Could not recover jumptable at 0x000180039fe0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x39fe0  448  GetAppContainerNamedObjectPath
  GetAppContainerNamedObjectPath();
  return;
}



HRESULT GetApplicationRecoveryCallback
                  (HANDLE hProcess,APPLICATION_RECOVERY_CALLBACK *pRecoveryCallback,
                  PVOID *ppvParameter,PDWORD pdwPingInterval,PDWORD pdwFlags)

{
  HRESULT HVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a000. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a000  449  GetApplicationRecoveryCallback
  HVar1 = GetApplicationRecoveryCallback
                    (hProcess,pRecoveryCallback,ppvParameter,pdwPingInterval,pdwFlags);
  return HVar1;
}



HRESULT GetApplicationRestartSettings
                  (HANDLE hProcess,PWSTR pwzCommandline,PDWORD pcchSize,PDWORD pdwFlags)

{
  HRESULT HVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a020. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a020  451  GetApplicationRestartSettings
  HVar1 = GetApplicationRestartSettings(hProcess,pwzCommandline,pcchSize,pdwFlags);
  return HVar1;
}



BOOL GetCPInfoExW(UINT CodePage,DWORD dwFlags,LPCPINFOEXW lpCPInfoEx)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a040. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a040  461  GetCPInfoExW
  BVar1 = GetCPInfoExW(CodePage,dwFlags,lpCPInfoEx);
  return BVar1;
}



void GetCachedSigningLevel(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a060. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a060  462  GetCachedSigningLevel
  GetCachedSigningLevel();
  return;
}



DWORD GetCompressedFileSizeA(LPCSTR lpFileName,LPDWORD lpFileSizeHigh)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a080. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a080  482  GetCompressedFileSizeA
  DVar1 = GetCompressedFileSizeA(lpFileName,lpFileSizeHigh);
  return DVar1;
}



DWORD GetCompressedFileSizeW(LPCWSTR lpFileName,LPDWORD lpFileSizeHigh)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a0a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a0a0  485  GetCompressedFileSizeW
  DVar1 = GetCompressedFileSizeW(lpFileName,lpFileSizeHigh);
  return DVar1;
}



int GetCurrencyFormatEx(LPCWSTR lpLocaleName,DWORD dwFlags,LPCWSTR lpValue,CURRENCYFMTW *lpFormat,
                       LPWSTR lpCurrencyStr,int cchCurrency)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a0c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a0c0  531  GetCurrencyFormatEx
  iVar1 = GetCurrencyFormatEx(lpLocaleName,dwFlags,lpValue,lpFormat,lpCurrencyStr,cchCurrency);
  return iVar1;
}



int GetCurrencyFormatW(undefined8 param_1,DWORD param_2,LPCWSTR param_3,CURRENCYFMTW *param_4,
                      LPWSTR param_5,int param_6)

{
  int iVar1;
  LPCWSTR lpLocaleName;
  
                    // 0x3a0e0  532  GetCurrencyFormatW
  lpLocaleName = (LPCWSTR)InternalLcidToName(param_1,0);
  if (lpLocaleName == (LPCWSTR)0x0) {
    SetLastError(0x57);
    iVar1 = 0;
  }
  else {
    iVar1 = GetCurrencyFormatEx(lpLocaleName,param_2,param_3,param_4,param_5,param_6);
  }
  return iVar1;
}



int GetDateFormatA(LCID Locale,DWORD dwFlags,SYSTEMTIME *lpDate,LPCSTR lpFormat,LPSTR lpDateStr,
                  int cchDate)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a0f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a0f0  553  GetDateFormatA
  iVar1 = GetDateFormatA(Locale,dwFlags,lpDate,lpFormat,lpDateStr,cchDate);
  return iVar1;
}



int GetDateFormatEx(LPCWSTR lpLocaleName,DWORD dwFlags,SYSTEMTIME *lpDate,LPCWSTR lpFormat,
                   LPWSTR lpDateStr,int cchDate,LPCWSTR lpCalendar)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a110. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a110  555  GetDateFormatEx
  iVar1 = GetDateFormatEx(lpLocaleName,dwFlags,lpDate,lpFormat,lpDateStr,cchDate,lpCalendar);
  return iVar1;
}



int GetDurationFormatEx(LPCWSTR lpLocaleName,DWORD dwFlags,SYSTEMTIME *lpDuration,
                       ULONGLONG ullDuration,LPCWSTR lpFormat,LPWSTR lpDurationStr,int cchDuration)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a130. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a130  572  GetDurationFormatEx
  iVar1 = GetDurationFormatEx(lpLocaleName,dwFlags,lpDuration,ullDuration,lpFormat,lpDurationStr,
                              cchDuration);
  return iVar1;
}



void GetEnabledXStateFeatures(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a150. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a150  574  GetEnabledXStateFeatures
  GetEnabledXStateFeatures();
  return;
}



void GetEraNameCountedString(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a170. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a170  581  GetEraNameCountedString
  GetEraNameCountedString();
  return;
}



BOOL GetFileMUIInfo(DWORD dwFlags,PCWSTR pcwszFilePath,PFILEMUIINFO pFileMUIInfo,
                   DWORD *pcbFileMUIInfo)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a190. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a190  596  GetFileMUIInfo
  BVar1 = GetFileMUIInfo(dwFlags,pcwszFilePath,pFileMUIInfo,pcbFileMUIInfo);
  return BVar1;
}



SIZE_T GetLargePageMinimum(void)

{
  SIZE_T SVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a1b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a1b0  617  GetLargePageMinimum
  SVar1 = GetLargePageMinimum();
  return SVar1;
}



void GetMemoryErrorHandlingCapabilities(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a1d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a1d0  636  GetMemoryErrorHandlingCapabilities
  GetMemoryErrorHandlingCapabilities();
  return;
}



BOOL GetNLSVersionEx(NLS_FUNCTION function,LPCWSTR lpLocaleName,
                    LPNLSVERSIONINFOEX lpVersionInformation)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a1f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a1f0  644  GetNLSVersionEx
  BVar1 = GetNLSVersionEx(function,lpLocaleName,lpVersionInformation);
  return BVar1;
}



BOOL GetNamedPipeAttribute
               (HANDLE Pipe,PIPE_ATTRIBUTE_TYPE AttributeType,PSTR AttributeName,
               PVOID AttributeValue,PSIZE_T AttributeValueLength)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a210. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a210  645  GetNamedPipeAttribute
  BVar1 = GetNamedPipeAttribute
                    (Pipe,AttributeType,AttributeName,AttributeValue,AttributeValueLength);
  return BVar1;
}



BOOL GetNamedPipeClientComputerNameW
               (HANDLE Pipe,LPWSTR ClientComputerName,ULONG ClientComputerNameLength)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a230. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a230  647  GetNamedPipeClientComputerNameW
  BVar1 = GetNamedPipeClientComputerNameW(Pipe,ClientComputerName,ClientComputerNameLength);
  return BVar1;
}



BOOL GetNamedPipeHandleStateW
               (HANDLE hNamedPipe,LPDWORD lpState,LPDWORD lpCurInstances,
               LPDWORD lpMaxCollectionCount,LPDWORD lpCollectDataTimeout,LPWSTR lpUserName,
               DWORD nMaxUserNameSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a250. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a250  651  GetNamedPipeHandleStateW
  BVar1 = GetNamedPipeHandleStateW
                    (hNamedPipe,lpState,lpCurInstances,lpMaxCollectionCount,lpCollectDataTimeout,
                     lpUserName,nMaxUserNameSize);
  return BVar1;
}



BOOL GetNumaNodeProcessorMaskEx(USHORT Node,PGROUP_AFFINITY ProcessorMask)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a270. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a270  663  GetNumaNodeProcessorMaskEx
  BVar1 = GetNumaNodeProcessorMaskEx(Node,ProcessorMask);
  return BVar1;
}



BOOL GetNumaProximityNodeEx(ULONG ProximityId,PUSHORT NodeNumber)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a290. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a290  667  GetNumaProximityNodeEx
  BVar1 = GetNumaProximityNodeEx(ProximityId,NodeNumber);
  return BVar1;
}



BOOL GetProcessGroupAffinity(HANDLE hProcess,PUSHORT GroupCount,PUSHORT GroupArray)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a2b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a2b0  701  GetProcessGroupAffinity
  BVar1 = GetProcessGroupAffinity(hProcess,GroupCount,GroupArray);
  return BVar1;
}



BOOL GetProcessHandleCount(HANDLE hProcess,PDWORD pdwHandleCount)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a2d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a2d0  702  GetProcessHandleCount
  BVar1 = GetProcessHandleCount(hProcess,pdwHandleCount);
  return BVar1;
}



DWORD GetProcessHeaps(DWORD NumberOfHeaps,PHANDLE ProcessHeaps)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a2f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a2f0  704  GetProcessHeaps
  DVar1 = GetProcessHeaps(NumberOfHeaps,ProcessHeaps);
  return DVar1;
}



BOOL GetProcessPriorityBoost(HANDLE hProcess,PBOOL pDisablePriorityBoost)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a310. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a310  711  GetProcessPriorityBoost
  BVar1 = GetProcessPriorityBoost(hProcess,pDisablePriorityBoost);
  return BVar1;
}



BOOL GetProcessShutdownParameters(LPDWORD lpdwLevel,LPDWORD lpdwFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a330. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a330  712  GetProcessShutdownParameters
  BVar1 = GetProcessShutdownParameters(lpdwLevel,lpdwFlags);
  return BVar1;
}



BOOL GetProcessWorkingSetSizeEx
               (HANDLE hProcess,PSIZE_T lpMinimumWorkingSetSize,PSIZE_T lpMaximumWorkingSetSize,
               PDWORD Flags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a350. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a350  716  GetProcessWorkingSetSizeEx
  BVar1 = GetProcessWorkingSetSizeEx(hProcess,lpMinimumWorkingSetSize,lpMaximumWorkingSetSize,Flags)
  ;
  return BVar1;
}



BOOL GetQueuedCompletionStatusEx
               (HANDLE CompletionPort,LPOVERLAPPED_ENTRY lpCompletionPortEntries,ULONG ulCount,
               PULONG ulNumEntriesRemoved,DWORD dwMilliseconds,BOOL fAlertable)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a370. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a370  726  GetQueuedCompletionStatusEx
  BVar1 = GetQueuedCompletionStatusEx
                    (CompletionPort,lpCompletionPortEntries,ulCount,ulNumEntriesRemoved,
                     dwMilliseconds,fAlertable);
  return BVar1;
}



int GetStringScripts(DWORD dwFlags,LPCWSTR lpString,int cchString,LPWSTR lpScripts,int cchScripts)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a390. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a390  734  GetStringScripts
  iVar1 = GetStringScripts(dwFlags,lpString,cchString,lpScripts,cchScripts);
  return iVar1;
}



BOOL GetStringTypeA(LCID Locale,DWORD dwInfoType,LPCSTR lpSrcStr,int cchSrc,LPWORD lpCharType)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a3b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a3b0  735  GetStringTypeA
                    // 0x3a3b0  736  GetStringTypeExA
  BVar1 = GetStringTypeA(Locale,dwInfoType,lpSrcStr,cchSrc,lpCharType);
  return BVar1;
}



BOOL GetSystemFileCacheSize
               (PSIZE_T lpMinimumFileCacheSize,PSIZE_T lpMaximumFileCacheSize,PDWORD lpFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a3d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a3d0  748  GetSystemFileCacheSize
  BVar1 = GetSystemFileCacheSize(lpMinimumFileCacheSize,lpMaximumFileCacheSize,lpFlags);
  return BVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

uint GetSystemWindowsDirectoryA(undefined8 param_1,ushort param_2)

{
  int iVar1;
  longlong lVar2;
  longlong lVar3;
  code *pcVar4;
  uint auStackX24 [4];
  ushort uStack24;
  
                    // 0x3a3f0  759  GetSystemWindowsDirectoryA
  lVar2 = KernelBaseGetGlobalData();
  lVar3 = KernelBaseGetGlobalData();
  iVar1 = RtlUnicodeToMultiByteSize
                    (auStackX24,*(undefined8 *)(lVar3 + 0x10),*(undefined2 *)(lVar2 + 10));
  if (-1 < iVar1) {
    if (param_2 < (ushort)auStackX24[0]) {
      return auStackX24[0];
    }
    KernelBaseGetGlobalData();
    pcVar4 = (code *)GetUnicodeStringToEightBitStringRoutine();
    iVar1 = (*pcVar4)();
    if (-1 < iVar1) {
      return (uint)uStack24;
    }
  }
  return 0;
}



DWORD GetThreadErrorMode(void)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a400. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a400  772  GetThreadErrorMode
  DVar1 = GetThreadErrorMode();
  return DVar1;
}



BOOL GetThreadGroupAffinity(HANDLE hThread,PGROUP_AFFINITY GroupAffinity)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a420. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a420  773  GetThreadGroupAffinity
  BVar1 = GetThreadGroupAffinity(hThread,GroupAffinity);
  return BVar1;
}



BOOL GetThreadIOPendingFlag(HANDLE hThread,PBOOL lpIOIsPending)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a440. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a440  774  GetThreadIOPendingFlag
  BVar1 = GetThreadIOPendingFlag(hThread,lpIOIsPending);
  return BVar1;
}



BOOL GetThreadIdealProcessorEx(HANDLE hThread,PPROCESSOR_NUMBER lpIdealProcessor)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a460. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a460  776  GetThreadIdealProcessorEx
  BVar1 = GetThreadIdealProcessorEx(hThread,lpIdealProcessor);
  return BVar1;
}



BOOL GetThreadPriorityBoost(HANDLE hThread,PBOOL pDisablePriorityBoost)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a480. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a480  781  GetThreadPriorityBoost
  BVar1 = GetThreadPriorityBoost(hThread,pDisablePriorityBoost);
  return BVar1;
}



int GetTimeFormatA(LCID Locale,DWORD dwFlags,SYSTEMTIME *lpTime,LPCSTR lpFormat,LPSTR lpTimeStr,
                  int cchTime)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a4a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a4a0  788  GetTimeFormatA
  iVar1 = GetTimeFormatA(Locale,dwFlags,lpTime,lpFormat,lpTimeStr,cchTime);
  return iVar1;
}



int GetTimeFormatEx(LPCWSTR lpLocaleName,DWORD dwFlags,SYSTEMTIME *lpTime,LPCWSTR lpFormat,
                   LPWSTR lpTimeStr,int cchTime)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a4c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a4c0  790  GetTimeFormatEx
  iVar1 = GetTimeFormatEx(lpLocaleName,dwFlags,lpTime,lpFormat,lpTimeStr,cchTime);
  return iVar1;
}



BOOL GetUILanguageInfo(DWORD dwFlags,PCZZWSTR pwmszLanguage,PZZWSTR pwszFallbackLanguages,
                      PDWORD pcchFallbackLanguages,PDWORD pAttributes)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a4e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a4e0  795  GetUILanguageInfo
  BVar1 = GetUILanguageInfo(dwFlags,pwmszLanguage,pwszFallbackLanguages,pcchFallbackLanguages,
                            pAttributes);
  return BVar1;
}



LANGID GetUserDefaultLangID(void)

{
  LANGID LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a500. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a500  800  GetUserDefaultLangID
  LVar1 = GetUserDefaultLangID();
  return LVar1;
}



void GetXStateFeaturesMask(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a520. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a520  821  GetXStateFeaturesMask
  GetXStateFeaturesMask();
  return;
}



SIZE_T HeapCompact(HANDLE hHeap,DWORD dwFlags)

{
  SIZE_T SVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a540. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a540  851  HeapCompact
  SVar1 = HeapCompact(hHeap,dwFlags);
  return SVar1;
}



BOOL HeapLock(HANDLE hHeap)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a560. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a560  855  HeapLock
  BVar1 = HeapLock(hHeap);
  return BVar1;
}



BOOL HeapQueryInformation
               (HANDLE HeapHandle,HEAP_INFORMATION_CLASS HeapInformationClass,PVOID HeapInformation,
               SIZE_T HeapInformationLength,PSIZE_T ReturnLength)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a580. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a580  856  HeapQueryInformation
  BVar1 = HeapQueryInformation
                    (HeapHandle,HeapInformationClass,HeapInformation,HeapInformationLength,
                     ReturnLength);
  return BVar1;
}



void HeapSummary(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a5a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a5a0  860  HeapSummary
  HeapSummary();
  return;
}



BOOL HeapUnlock(HANDLE hHeap)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a5c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a5c0  861  HeapUnlock
  BVar1 = HeapUnlock(hHeap);
  return BVar1;
}



BOOL HeapWalk(HANDLE hHeap,LPPROCESS_HEAP_ENTRY lpEntry)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a5e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a5e0  863  HeapWalk
  BVar1 = HeapWalk(hHeap,lpEntry);
  return BVar1;
}



int IdnToNameprepUnicode
              (DWORD dwFlags,LPCWSTR lpUnicodeCharStr,int cchUnicodeChar,LPWSTR lpNameprepCharStr,
              int cchNameprepChar)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a600. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a600  865  IdnToNameprepUnicode
  iVar1 = IdnToNameprepUnicode
                    (dwFlags,lpUnicodeCharStr,cchUnicodeChar,lpNameprepCharStr,cchNameprepChar);
  return iVar1;
}



int IdnToUnicode(DWORD dwFlags,LPCWSTR lpASCIICharStr,int cchASCIIChar,LPWSTR lpUnicodeCharStr,
                int cchUnicodeChar)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a620. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a620  866  IdnToUnicode
  iVar1 = IdnToUnicode(dwFlags,lpASCIICharStr,cchASCIIChar,lpUnicodeCharStr,cchUnicodeChar);
  return iVar1;
}



void InitializeContext2(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a640. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a640  874  InitializeContext2
  InitializeContext2();
  return;
}



void InitializeContext(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a660. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a660  873  InitializeContext
  InitializeContext();
  return;
}



void InitializeSynchronizationBarrier(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a680. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a680  882  InitializeSynchronizationBarrier
  InitializeSynchronizationBarrier();
  return;
}



BOOL IsDBCSLeadByteEx(UINT CodePage,BYTE TestChar)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a6a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a6a0  901  IsDBCSLeadByteEx
  BVar1 = IsDBCSLeadByteEx(CodePage,TestChar);
  return BVar1;
}



BOOL IsNLSDefinedString(NLS_FUNCTION Function,DWORD dwFlags,LPNLSVERSIONINFO lpVersionInformation,
                       LPCWSTR lpString,INT cchStr)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a6c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a6c0  904  IsNLSDefinedString
  BVar1 = IsNLSDefinedString(Function,dwFlags,lpVersionInformation,lpString,cchStr);
  return BVar1;
}



BOOL IsNormalizedString(NORM_FORM NormForm,LPCWSTR lpString,int cwLength)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a6e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a6e0  906  IsNormalizedString
  BVar1 = IsNormalizedString(NormForm,lpString,cwLength);
  return BVar1;
}



BOOL IsValidLanguageGroup(LGRPID LanguageGroup,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a700. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a700  916  IsValidLanguageGroup
  BVar1 = IsValidLanguageGroup(LanguageGroup,dwFlags);
  return BVar1;
}



BOOL IsValidLocaleName(LPCWSTR lpLocaleName)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003a720. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a720  918  IsValidLocaleName
  BVar1 = IsValidLocaleName(lpLocaleName);
  return BVar1;
}



void IsValidNLSVersion(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a740. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a740  919  IsValidNLSVersion
  IsValidNLSVersion();
  return;
}



void K32EmptyWorkingSet(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a760. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a760  923  K32EmptyWorkingSet
  K32EmptyWorkingSet();
  return;
}



void K32EnumDeviceDrivers(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a780. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a780  924  K32EnumDeviceDrivers
  K32EnumDeviceDrivers();
  return;
}



void K32EnumPageFilesA(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a7a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a7a0  925  K32EnumPageFilesA
  K32EnumPageFilesA();
  return;
}



void K32EnumPageFilesW(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a7c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a7c0  926  K32EnumPageFilesW
  K32EnumPageFilesW();
  return;
}



void K32EnumProcessModulesEx(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a7e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a7e0  928  K32EnumProcessModulesEx
  K32EnumProcessModulesEx();
  return;
}



void K32EnumProcesses(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a800. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a800  929  K32EnumProcesses
  K32EnumProcesses();
  return;
}



void K32GetDeviceDriverBaseNameA(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a820. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a820  930  K32GetDeviceDriverBaseNameA
  K32GetDeviceDriverBaseNameA();
  return;
}



void K32GetDeviceDriverBaseNameW(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a840. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a840  931  K32GetDeviceDriverBaseNameW
  K32GetDeviceDriverBaseNameW();
  return;
}



void K32GetDeviceDriverFileNameA(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a860. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a860  932  K32GetDeviceDriverFileNameA
  K32GetDeviceDriverFileNameA();
  return;
}



void K32GetDeviceDriverFileNameW(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a880. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a880  933  K32GetDeviceDriverFileNameW
  K32GetDeviceDriverFileNameW();
  return;
}



void K32GetMappedFileNameA(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a8a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a8a0  934  K32GetMappedFileNameA
  K32GetMappedFileNameA();
  return;
}



void K32GetMappedFileNameW(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a8c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a8c0  935  K32GetMappedFileNameW
  K32GetMappedFileNameW();
  return;
}



void K32GetModuleBaseNameA(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a8e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a8e0  936  K32GetModuleBaseNameA
  K32GetModuleBaseNameA();
  return;
}



void K32GetModuleBaseNameW(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a900. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a900  937  K32GetModuleBaseNameW
  K32GetModuleBaseNameW();
  return;
}



void K32GetModuleFileNameExA(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a920. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a920  938  K32GetModuleFileNameExA
  K32GetModuleFileNameExA();
  return;
}



void K32GetPerformanceInfo(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a940. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a940  941  K32GetPerformanceInfo
  K32GetPerformanceInfo();
  return;
}



void K32GetProcessImageFileNameA(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a960. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a960  942  K32GetProcessImageFileNameA
  K32GetProcessImageFileNameA();
  return;
}



void K32GetProcessMemoryInfo(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a980. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a980  944  K32GetProcessMemoryInfo
  K32GetProcessMemoryInfo();
  return;
}



void K32GetWsChangesEx(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a9a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a9a0  946  K32GetWsChangesEx
  K32GetWsChangesEx();
  return;
}



void K32GetWsChanges(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a9c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a9c0  945  K32GetWsChanges
  K32GetWsChanges();
  return;
}



void K32InitializeProcessForWsWatch(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003a9e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3a9e0  947  K32InitializeProcessForWsWatch
  K32InitializeProcessForWsWatch();
  return;
}



void K32QueryWorkingSetEx(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003aa00. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3aa00  949  K32QueryWorkingSetEx
  K32QueryWorkingSetEx();
  return;
}



void K32QueryWorkingSet(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003aa20. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3aa20  948  K32QueryWorkingSet
  K32QueryWorkingSet();
  return;
}



int LCMapStringA(LCID Locale,DWORD dwMapFlags,LPCSTR lpSrcStr,int cchSrc,LPSTR lpDestStr,int cchDest
                )

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003aa40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3aa40  951  LCMapStringA
  iVar1 = LCMapStringA(Locale,dwMapFlags,lpSrcStr,cchSrc,lpDestStr,cchDest);
  return iVar1;
}



void LoadStringBaseExW(undefined param_1,undefined param_2,undefined param_3,undefined param_4,
                      undefined2 param_5)

{
                    // 0x3aa60  976  LoadStringBaseExW
                    // WARNING: Could not recover jumptable at 0x00018003aa6a. Too many branches
                    // WARNING: Treating indirect jump as call
  LoadStringBaseExW();
  return;
}



LPVOID LocalLock(HLOCAL hMem)

{
  LPVOID pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003aa80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3aa80  985  LocalLock
  pvVar1 = LocalLock(hMem);
  return pvVar1;
}



BOOL LocalUnlock(HLOCAL hMem)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003aaa0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3aaa0  990  LocalUnlock
  BVar1 = LocalUnlock(hMem);
  return BVar1;
}



void LocateXStateFeature(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003aac0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3aac0  992  LocateXStateFeature
  LocateXStateFeature();
  return;
}



BOOL MapUserPhysicalPages(PVOID VirtualAddress,ULONG_PTR NumberOfPages,PULONG_PTR PageArray)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003aae0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3aae0  996  MapUserPhysicalPages
  BVar1 = MapUserPhysicalPages(VirtualAddress,NumberOfPages,PageArray);
  return BVar1;
}



LPVOID MapViewOfFileExNuma(HANDLE hFileMappingObject,DWORD dwDesiredAccess,DWORD dwFileOffsetHigh,
                          DWORD dwFileOffsetLow,SIZE_T dwNumberOfBytesToMap,LPVOID lpBaseAddress,
                          DWORD nndPreferred)

{
  LPVOID pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003ab00. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ab00  1000  MapViewOfFileExNuma
  pvVar1 = MapViewOfFileExNuma(hFileMappingObject,dwDesiredAccess,dwFileOffsetHigh,dwFileOffsetLow,
                               dwNumberOfBytesToMap,lpBaseAddress,nndPreferred);
  return pvVar1;
}



BOOL MoveFileWithProgressW
               (LPCWSTR lpExistingFileName,LPCWSTR lpNewFileName,
               LPPROGRESS_ROUTINE lpProgressRoutine,LPVOID lpData,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003ab20. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ab20  1013  MoveFileWithProgressW
  BVar1 = MoveFileWithProgressW(lpExistingFileName,lpNewFileName,lpProgressRoutine,lpData,dwFlags);
  return BVar1;
}



BOOL NeedCurrentDirectoryForExePathA(LPCSTR ExeName)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003ab40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ab40  1016  NeedCurrentDirectoryForExePathA
  BVar1 = NeedCurrentDirectoryForExePathA(ExeName);
  return BVar1;
}



BOOL NeedCurrentDirectoryForExePathW(LPCWSTR ExeName)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003ab60. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ab60  1017  NeedCurrentDirectoryForExePathW
  BVar1 = NeedCurrentDirectoryForExePathW(ExeName);
  return BVar1;
}



int NormalizeString(NORM_FORM NormForm,LPCWSTR lpSrcString,int cwSrcLength,LPWSTR lpDstString,
                   int cwDstLength)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003ab80. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ab80  1022  NormalizeString
  iVar1 = NormalizeString(NormForm,lpSrcString,cwSrcLength,lpDstString,cwDstLength);
  return iVar1;
}



void NotifyMountMgr(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003aba0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3aba0  1023  NotifyMountMgr
  NotifyMountMgr();
  return;
}



// WARNING: Could not reconcile some variable overlaps

void OpenConsoleWStub(LPCWSTR param_1,DWORD param_2,uint param_3,DWORD param_4)

{
  undefined auStack40 [16];
  ulonglong uStack24;
  
                    // 0x3abc0  1029  OpenConsoleWStub
  auStack40 = CONCAT124(SUB1612(ZEXT816(0) >> 0x20,0),0x18);
  uStack24 = (ulonglong)param_3;
  CreateFileW(param_1,param_2,param_4,(LPSECURITY_ATTRIBUTES)auStack40,3,0,(HANDLE)0x0);
  return;
}



HANDLE OpenFileById(HANDLE hVolumeHint,LPFILE_ID_DESCRIPTOR lpFileId,DWORD dwDesiredAccess,
                   DWORD dwShareMode,LPSECURITY_ATTRIBUTES lpSecurityAttributes,
                   DWORD dwFlagsAndAttributes)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003abd0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3abd0  1033  OpenFileById
  pvVar1 = OpenFileById(hVolumeHint,lpFileId,dwDesiredAccess,dwShareMode,lpSecurityAttributes,
                        dwFlagsAndAttributes);
  return pvVar1;
}



BOOL PeekNamedPipe(HANDLE hNamedPipe,LPVOID lpBuffer,DWORD nBufferSize,LPDWORD lpBytesRead,
                  LPDWORD lpTotalBytesAvail,LPDWORD lpBytesLeftThisMessage)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003abf0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3abf0  1064  PeekNamedPipe
  BVar1 = PeekNamedPipe(hNamedPipe,lpBuffer,nBufferSize,lpBytesRead,lpTotalBytesAvail,
                        lpBytesLeftThisMessage);
  return BVar1;
}



void PssCaptureSnapshot(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003ac10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ac10  1078  PssCaptureSnapshot
  PssCaptureSnapshot();
  return;
}



void PssDuplicateSnapshot(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003ac30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ac30  1079  PssDuplicateSnapshot
  PssDuplicateSnapshot();
  return;
}



void PssFreeSnapshot(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003ac50. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ac50  1080  PssFreeSnapshot
  PssFreeSnapshot();
  return;
}



void PssQuerySnapshot(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003ac70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ac70  1081  PssQuerySnapshot
  PssQuerySnapshot();
  return;
}



void PssWalkMarkerCreate(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003ac90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ac90  1082  PssWalkMarkerCreate
  PssWalkMarkerCreate();
  return;
}



void PssWalkMarkerFree(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003acb0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3acb0  1083  PssWalkMarkerFree
  PssWalkMarkerFree();
  return;
}



void PssWalkMarkerGetPosition(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003acd0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3acd0  1084  PssWalkMarkerGetPosition
                    // 0x3acd0  1089  PssWalkMarkerTell
  PssWalkMarkerGetPosition();
  return;
}



void PssWalkMarkerRewind(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003acf0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3acf0  1085  PssWalkMarkerRewind
                    // 0x3acf0  1087  PssWalkMarkerSeekToBeginning
  PssWalkMarkerSeekToBeginning();
  return;
}



void PssWalkMarkerSeek(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003ad10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ad10  1086  PssWalkMarkerSeek
                    // 0x3ad10  1088  PssWalkMarkerSetPosition
  PssWalkMarkerSetPosition();
  return;
}



void PssWalkSnapshot(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003ad30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ad30  1090  PssWalkSnapshot
  PssWalkSnapshot();
  return;
}



BOOL QueryActCtxSettingsW
               (DWORD dwFlags,HANDLE hActCtx,PCWSTR settingsNameSpace,PCWSTR settingName,
               PWSTR pvBuffer,SIZE_T dwBuffer,SIZE_T *pdwWrittenOrRequired)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003ad50. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ad50  1093  QueryActCtxSettingsW
  BVar1 = QueryActCtxSettingsW
                    (dwFlags,hActCtx,settingsNameSpace,settingName,pvBuffer,dwBuffer,
                     pdwWrittenOrRequired);
  return BVar1;
}



BOOL QueryFullProcessImageNameA(HANDLE hProcess,DWORD dwFlags,LPSTR lpExeName,PDWORD lpdwSize)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003ad70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ad70  1100  QueryFullProcessImageNameA
  BVar1 = QueryFullProcessImageNameA(hProcess,dwFlags,lpExeName,lpdwSize);
  return BVar1;
}



BOOL QueryIdleProcessorCycleTimeEx(USHORT Group,PULONG BufferLength,PULONG64 ProcessorIdleCycleTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003ad90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ad90  1103  QueryIdleProcessorCycleTimeEx
  BVar1 = QueryIdleProcessorCycleTimeEx(Group,BufferLength,ProcessorIdleCycleTime);
  return BVar1;
}



BOOL QueryMemoryResourceNotification(HANDLE ResourceNotificationHandle,PBOOL ResourceState)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003adb0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3adb0  1106  QueryMemoryResourceNotification
  BVar1 = QueryMemoryResourceNotification(ResourceNotificationHandle,ResourceState);
  return BVar1;
}



BOOL QueryProcessAffinityUpdateMode(HANDLE hProcess,LPDWORD lpdwFlags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003add0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3add0  1109  QueryProcessAffinityUpdateMode
  BVar1 = QueryProcessAffinityUpdateMode(hProcess,lpdwFlags);
  return BVar1;
}



BOOL QueryThreadpoolStackInformation(PTP_POOL ptpp,PTP_POOL_STACK_INFORMATION ptpsi)

{
  int iVar1;
  
                    // 0x3adf0  1114  QueryThreadpoolStackInformation
  iVar1 = TpQueryPoolStackInformation();
  if (-1 >= iVar1) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  }
  return (uint)(-1 < iVar1);
}



HANDLE ReOpenFile(HANDLE hOriginalFile,DWORD dwDesiredAccess,DWORD dwShareMode,
                 DWORD dwFlagsAndAttributes)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003ae30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ae30  1132  ReOpenFile
  pvVar1 = ReOpenFile(hOriginalFile,dwDesiredAccess,dwShareMode,dwFlagsAndAttributes);
  return pvVar1;
}



void ReadDirectoryChangesExW(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003ae50. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ae50  1144  ReadDirectoryChangesExW
  ReadDirectoryChangesExW();
  return;
}



LSTATUS RegCopyTreeW(HKEY hKeySrc,LPCWSTR lpSubKey,HKEY hKeyDest)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003ae70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ae70  1153  RegCopyTreeW
  LVar1 = RegCopyTreeW(hKeySrc,lpSubKey,hKeyDest);
  return LVar1;
}



LSTATUS RegCreateKeyExA(HKEY hKey,LPCSTR lpSubKey,DWORD Reserved,LPSTR lpClass,DWORD dwOptions,
                       REGSAM samDesired,LPSECURITY_ATTRIBUTES lpSecurityAttributes,PHKEY phkResult,
                       LPDWORD lpdwDisposition)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003ae90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ae90  1154  RegCreateKeyExA
  LVar1 = RegCreateKeyExA(hKey,lpSubKey,Reserved,lpClass,dwOptions,samDesired,lpSecurityAttributes,
                          phkResult,lpdwDisposition);
  return LVar1;
}



LSTATUS RegCreateKeyExW(HKEY hKey,LPCWSTR lpSubKey,DWORD Reserved,LPWSTR lpClass,DWORD dwOptions,
                       REGSAM samDesired,LPSECURITY_ATTRIBUTES lpSecurityAttributes,PHKEY phkResult,
                       LPDWORD lpdwDisposition)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003aeb0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3aeb0  1155  RegCreateKeyExW
  LVar1 = RegCreateKeyExW(hKey,lpSubKey,Reserved,lpClass,dwOptions,samDesired,lpSecurityAttributes,
                          phkResult,lpdwDisposition);
  return LVar1;
}



LSTATUS RegDeleteKeyExA(HKEY hKey,LPCSTR lpSubKey,REGSAM samDesired,DWORD Reserved)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003aed0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3aed0  1156  RegDeleteKeyExA
  LVar1 = RegDeleteKeyExA(hKey,lpSubKey,samDesired,Reserved);
  return LVar1;
}



LSTATUS RegDeleteKeyExW(HKEY hKey,LPCWSTR lpSubKey,REGSAM samDesired,DWORD Reserved)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003aef0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3aef0  1157  RegDeleteKeyExW
  LVar1 = RegDeleteKeyExW(hKey,lpSubKey,samDesired,Reserved);
  return LVar1;
}



LSTATUS RegDeleteTreeA(HKEY hKey,LPCSTR lpSubKey)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003af10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3af10  1158  RegDeleteTreeA
  LVar1 = RegDeleteTreeA(hKey,lpSubKey);
  return LVar1;
}



LSTATUS RegDeleteTreeW(HKEY hKey,LPCWSTR lpSubKey)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003af30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3af30  1159  RegDeleteTreeW
  LVar1 = RegDeleteTreeW(hKey,lpSubKey);
  return LVar1;
}



LSTATUS RegDeleteValueA(HKEY hKey,LPCSTR lpValueName)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003af50. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3af50  1160  RegDeleteValueA
  LVar1 = RegDeleteValueA(hKey,lpValueName);
  return LVar1;
}



LSTATUS RegDeleteValueW(HKEY hKey,LPCWSTR lpValueName)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003af70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3af70  1161  RegDeleteValueW
  LVar1 = RegDeleteValueW(hKey,lpValueName);
  return LVar1;
}



LSTATUS RegDisablePredefinedCacheEx(void)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003af90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3af90  1162  RegDisablePredefinedCacheEx
  LVar1 = RegDisablePredefinedCacheEx();
  return LVar1;
}



LSTATUS RegEnumKeyExA(HKEY hKey,DWORD dwIndex,LPSTR lpName,LPDWORD lpcchName,LPDWORD lpReserved,
                     LPSTR lpClass,LPDWORD lpcchClass,PFILETIME lpftLastWriteTime)

{
  LSTATUS LVar1;
  
                    // 0x3afb0  1163  RegEnumKeyExA
  LVar1 = RegEnumKeyExA(hKey,dwIndex,lpName,lpcchName,lpReserved,lpClass,lpcchClass,
                        lpftLastWriteTime);
  return LVar1;
}



LSTATUS RegEnumKeyExW(HKEY hKey,DWORD dwIndex,LPWSTR lpName,LPDWORD lpcchName,LPDWORD lpReserved,
                     LPWSTR lpClass,LPDWORD lpcchClass,PFILETIME lpftLastWriteTime)

{
  LSTATUS LVar1;
  
                    // 0x3b000  1164  RegEnumKeyExW
  LVar1 = RegEnumKeyExW(hKey,dwIndex,lpName,lpcchName,lpReserved,lpClass,lpcchClass,
                        lpftLastWriteTime);
  return LVar1;
}



LSTATUS RegEnumValueA(HKEY hKey,DWORD dwIndex,LPSTR lpValueName,LPDWORD lpcchValueName,
                     LPDWORD lpReserved,LPDWORD lpType,LPBYTE lpData,LPDWORD lpcbData)

{
  LSTATUS LVar1;
  
                    // 0x3b050  1165  RegEnumValueA
  LVar1 = RegEnumValueA(hKey,dwIndex,lpValueName,lpcchValueName,lpReserved,lpType,lpData,lpcbData);
  return LVar1;
}



LSTATUS RegEnumValueW(HKEY hKey,DWORD dwIndex,LPWSTR lpValueName,LPDWORD lpcchValueName,
                     LPDWORD lpReserved,LPDWORD lpType,LPBYTE lpData,LPDWORD lpcbData)

{
  LSTATUS LVar1;
  
                    // 0x3b0a0  1166  RegEnumValueW
  LVar1 = RegEnumValueW(hKey,dwIndex,lpValueName,lpcchValueName,lpReserved,lpType,lpData,lpcbData);
  return LVar1;
}



LSTATUS RegFlushKey(HKEY hKey)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b0f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b0f0  1167  RegFlushKey
  LVar1 = RegFlushKey(hKey);
  return LVar1;
}



LSTATUS RegGetKeySecurity(HKEY hKey,SECURITY_INFORMATION SecurityInformation,
                         PSECURITY_DESCRIPTOR pSecurityDescriptor,LPDWORD lpcbSecurityDescriptor)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b110. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b110  1168  RegGetKeySecurity
  LVar1 = RegGetKeySecurity(hKey,SecurityInformation,pSecurityDescriptor,lpcbSecurityDescriptor);
  return LVar1;
}



LSTATUS RegGetValueA(HKEY hkey,LPCSTR lpSubKey,LPCSTR lpValue,DWORD dwFlags,LPDWORD pdwType,
                    PVOID pvData,LPDWORD pcbData)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b130. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b130  1169  RegGetValueA
  LVar1 = RegGetValueA(hkey,lpSubKey,lpValue,dwFlags,pdwType,pvData,pcbData);
  return LVar1;
}



LSTATUS RegLoadKeyA(HKEY hKey,LPCSTR lpSubKey,LPCSTR lpFile)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b150. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b150  1171  RegLoadKeyA
  LVar1 = RegLoadKeyA(hKey,lpSubKey,lpFile);
  return LVar1;
}



LSTATUS RegLoadKeyW(HKEY hKey,LPCWSTR lpSubKey,LPCWSTR lpFile)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b170. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b170  1172  RegLoadKeyW
  LVar1 = RegLoadKeyW(hKey,lpSubKey,lpFile);
  return LVar1;
}



LSTATUS RegLoadMUIStringA(HKEY hKey,LPCSTR pszValue,LPSTR pszOutBuf,DWORD cbOutBuf,LPDWORD pcbData,
                         DWORD Flags,LPCSTR pszDirectory)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b190. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b190  1173  RegLoadMUIStringA
  LVar1 = RegLoadMUIStringA(hKey,pszValue,pszOutBuf,cbOutBuf,pcbData,Flags,pszDirectory);
  return LVar1;
}



LSTATUS RegLoadMUIStringW(HKEY hKey,LPCWSTR pszValue,LPWSTR pszOutBuf,DWORD cbOutBuf,LPDWORD pcbData
                         ,DWORD Flags,LPCWSTR pszDirectory)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b1b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b1b0  1174  RegLoadMUIStringW
  LVar1 = RegLoadMUIStringW(hKey,pszValue,pszOutBuf,cbOutBuf,pcbData,Flags,pszDirectory);
  return LVar1;
}



LSTATUS RegNotifyChangeKeyValue
                  (HKEY hKey,BOOL bWatchSubtree,DWORD dwNotifyFilter,HANDLE hEvent,
                  BOOL fAsynchronous)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b1d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b1d0  1175  RegNotifyChangeKeyValue
  LVar1 = RegNotifyChangeKeyValue(hKey,bWatchSubtree,dwNotifyFilter,hEvent,fAsynchronous);
  return LVar1;
}



LSTATUS RegOpenKeyExA(HKEY hKey,LPCSTR lpSubKey,DWORD ulOptions,REGSAM samDesired,PHKEY phkResult)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b1f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b1f0  1177  RegOpenKeyExA
  LVar1 = RegOpenKeyExA(hKey,lpSubKey,ulOptions,samDesired,phkResult);
  return LVar1;
}



LSTATUS RegQueryInfoKeyA(HKEY hKey,LPSTR lpClass,LPDWORD lpcchClass,LPDWORD lpReserved,
                        LPDWORD lpcSubKeys,LPDWORD lpcbMaxSubKeyLen,LPDWORD lpcbMaxClassLen,
                        LPDWORD lpcValues,LPDWORD lpcbMaxValueNameLen,LPDWORD lpcbMaxValueLen,
                        LPDWORD lpcbSecurityDescriptor,PFILETIME lpftLastWriteTime)

{
  LSTATUS LVar1;
  
                    // 0x3b210  1180  RegQueryInfoKeyA
  LVar1 = RegQueryInfoKeyA(hKey,lpClass,lpcchClass,lpReserved,lpcSubKeys,lpcbMaxSubKeyLen,
                           lpcbMaxClassLen,lpcValues,lpcbMaxValueNameLen,lpcbMaxValueLen,
                           lpcbSecurityDescriptor,lpftLastWriteTime);
  return LVar1;
}



LSTATUS RegQueryInfoKeyW(HKEY hKey,LPWSTR lpClass,LPDWORD lpcchClass,LPDWORD lpReserved,
                        LPDWORD lpcSubKeys,LPDWORD lpcbMaxSubKeyLen,LPDWORD lpcbMaxClassLen,
                        LPDWORD lpcValues,LPDWORD lpcbMaxValueNameLen,LPDWORD lpcbMaxValueLen,
                        LPDWORD lpcbSecurityDescriptor,PFILETIME lpftLastWriteTime)

{
  LSTATUS LVar1;
  
                    // 0x3b290  1181  RegQueryInfoKeyW
  LVar1 = RegQueryInfoKeyW(hKey,lpClass,lpcchClass,lpReserved,lpcSubKeys,lpcbMaxSubKeyLen,
                           lpcbMaxClassLen,lpcValues,lpcbMaxValueNameLen,lpcbMaxValueLen,
                           lpcbSecurityDescriptor,lpftLastWriteTime);
  return LVar1;
}



LSTATUS RegQueryValueExA(HKEY hKey,LPCSTR lpValueName,LPDWORD lpReserved,LPDWORD lpType,
                        LPBYTE lpData,LPDWORD lpcbData)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b310. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b310  1182  RegQueryValueExA
  LVar1 = RegQueryValueExA(hKey,lpValueName,lpReserved,lpType,lpData,lpcbData);
  return LVar1;
}



LSTATUS RegQueryValueExW(HKEY hKey,LPCWSTR lpValueName,LPDWORD lpReserved,LPDWORD lpType,
                        LPBYTE lpData,LPDWORD lpcbData)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b330. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b330  1183  RegQueryValueExW
  LVar1 = RegQueryValueExW(hKey,lpValueName,lpReserved,lpType,lpData,lpcbData);
  return LVar1;
}



LSTATUS RegRestoreKeyA(HKEY hKey,LPCSTR lpFile,DWORD dwFlags)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b350. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b350  1184  RegRestoreKeyA
  LVar1 = RegRestoreKeyA(hKey,lpFile,dwFlags);
  return LVar1;
}



LSTATUS RegRestoreKeyW(HKEY hKey,LPCWSTR lpFile,DWORD dwFlags)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b370. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b370  1185  RegRestoreKeyW
  LVar1 = RegRestoreKeyW(hKey,lpFile,dwFlags);
  return LVar1;
}



LSTATUS RegSaveKeyExA(HKEY hKey,LPCSTR lpFile,LPSECURITY_ATTRIBUTES lpSecurityAttributes,DWORD Flags
                     )

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b390. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b390  1186  RegSaveKeyExA
  LVar1 = RegSaveKeyExA(hKey,lpFile,lpSecurityAttributes,Flags);
  return LVar1;
}



LSTATUS RegSaveKeyExW(HKEY hKey,LPCWSTR lpFile,LPSECURITY_ATTRIBUTES lpSecurityAttributes,
                     DWORD Flags)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b3b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b3b0  1187  RegSaveKeyExW
  LVar1 = RegSaveKeyExW(hKey,lpFile,lpSecurityAttributes,Flags);
  return LVar1;
}



LSTATUS RegSetKeySecurity(HKEY hKey,SECURITY_INFORMATION SecurityInformation,
                         PSECURITY_DESCRIPTOR pSecurityDescriptor)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b3d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b3d0  1188  RegSetKeySecurity
  LVar1 = RegSetKeySecurity(hKey,SecurityInformation,pSecurityDescriptor);
  return LVar1;
}



LSTATUS RegSetValueExA(HKEY hKey,LPCSTR lpValueName,DWORD Reserved,DWORD dwType,BYTE *lpData,
                      DWORD cbData)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b3f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b3f0  1189  RegSetValueExA
  LVar1 = RegSetValueExA(hKey,lpValueName,Reserved,dwType,lpData,cbData);
  return LVar1;
}



LSTATUS RegSetValueExW(HKEY hKey,LPCWSTR lpValueName,DWORD Reserved,DWORD dwType,BYTE *lpData,
                      DWORD cbData)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b410. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b410  1190  RegSetValueExW
  LVar1 = RegSetValueExW(hKey,lpValueName,Reserved,dwType,lpData,cbData);
  return LVar1;
}



LSTATUS RegUnLoadKeyA(HKEY hKey,LPCSTR lpSubKey)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b430. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b430  1191  RegUnLoadKeyA
  LVar1 = RegUnLoadKeyA(hKey,lpSubKey);
  return LVar1;
}



LSTATUS RegUnLoadKeyW(HKEY hKey,LPCWSTR lpSubKey)

{
  LSTATUS LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b450. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b450  1192  RegUnLoadKeyW
  LVar1 = RegUnLoadKeyW(hKey,lpSubKey);
  return LVar1;
}



void RegisterBadMemoryNotification(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003b470. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b470  1195  RegisterBadMemoryNotification
  RegisterBadMemoryNotification();
  return;
}



HANDLE RegisterWaitForSingleObjectEx
                 (HANDLE hObject,WAITORTIMERCALLBACK Callback,PVOID Context,ULONG dwMilliseconds,
                 ULONG dwFlags)

{
  HANDLE pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b490. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b490  1201  RegisterWaitForSingleObjectEx
  pvVar1 = RegisterWaitForSingleObjectEx(hObject,Callback,Context,dwMilliseconds,dwFlags);
  return pvVar1;
}



BOOL ReplaceFile(LPCWSTR lpReplacedFileName,LPCWSTR lpReplacementFileName,LPCWSTR lpBackupFileName,
                DWORD dwReplaceFlags,LPVOID lpExclude,LPVOID lpReserved)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b4b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b4b0  1223  ReplaceFile
                    // 0x3b4b0  1225  ReplaceFileW
  BVar1 = ReplaceFileW(lpReplacedFileName,lpReplacementFileName,lpBackupFileName,dwReplaceFlags,
                       lpExclude,lpReserved);
  return BVar1;
}



void RtlCompareMemory(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003b4d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b4d0  1240  RtlCompareMemory
  RtlCompareMemory();
  return;
}



void * RtlCopyMemory(void *param_1,void *param_2,size_t param_3)

{
                    // 0x3b4f0  1241  RtlCopyMemory
  memcpy(param_1,param_2,param_3);
  return param_1;
}



BOOLEAN RtlDeleteFunctionTable(PRUNTIME_FUNCTION FunctionTable)

{
  BOOLEAN BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b510. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b510  1242  RtlDeleteFunctionTable
  BVar1 = RtlDeleteFunctionTable(FunctionTable);
  return BVar1;
}



void * RtlFillMemory(void *param_1,int param_2,int param_3)

{
                    // 0x3b530  1243  RtlFillMemory
  memset(param_1,param_3,(longlong)param_2);
  return param_1;
}



BOOLEAN RtlInstallFunctionTableCallback
                  (DWORD64 TableIdentifier,DWORD64 BaseAddress,DWORD Length,
                  PGET_RUNTIME_FUNCTION_CALLBACK Callback,PVOID Context,
                  PCWSTR OutOfProcessCallbackDll)

{
  BOOLEAN BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b560. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b560  1244  RtlInstallFunctionTableCallback
  BVar1 = RtlInstallFunctionTableCallback
                    (TableIdentifier,BaseAddress,Length,Callback,Context,OutOfProcessCallbackDll);
  return BVar1;
}



void RtlRaiseException(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003b580. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b580  1248  RtlRaiseException
  RtlRaiseException();
  return;
}



void RtlRestoreContext(PCONTEXT ContextRecord,_EXCEPTION_RECORD *ExceptionRecord)

{
                    // WARNING: Could not recover jumptable at 0x00018003b5a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b5a0  1249  RtlRestoreContext
  RtlRestoreContext(ContextRecord,ExceptionRecord);
  return;
}



void RtlUnwind(PVOID TargetFrame,PVOID TargetIp,PEXCEPTION_RECORD ExceptionRecord,PVOID ReturnValue)

{
                    // WARNING: Could not recover jumptable at 0x00018003b5c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b5c0  1250  RtlUnwind
  RtlUnwind(TargetFrame,TargetIp,ExceptionRecord,ReturnValue);
  return;
}



DWORD SearchPathA(LPCSTR lpPath,LPCSTR lpFileName,LPCSTR lpExtension,DWORD nBufferLength,
                 LPSTR lpBuffer,LPSTR *lpFilePart)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b5e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b5e0  1256  SearchPathA
  DVar1 = SearchPathA(lpPath,lpFileName,lpExtension,nBufferLength,lpBuffer,lpFilePart);
  return DVar1;
}



void SetCachedSigningLevel(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003b600. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b600  1258  SetCachedSigningLevel
  SetCachedSigningLevel();
  return;
}



BOOL SetCalendarInfoW(LCID Locale,CALID Calendar,CALTYPE CalType,LPCWSTR lpCalData)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b620. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b620  1260  SetCalendarInfoW
  BVar1 = SetCalendarInfoW(Locale,Calendar,CalType,lpCalData);
  return BVar1;
}



BOOL SetComputerNameA(LPCSTR lpComputerName)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b640. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b640  1267  SetComputerNameA
  BVar1 = SetComputerNameA(lpComputerName);
  return BVar1;
}



void SetComputerNameEx2W(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003b660. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b660  1268  SetComputerNameEx2W
  SetComputerNameEx2W();
  return;
}



BOOL SetComputerNameExA(COMPUTER_NAME_FORMAT NameType,LPCSTR lpBuffer)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b680. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b680  1269  SetComputerNameExA
  BVar1 = SetComputerNameExA(NameType,lpBuffer);
  return BVar1;
}



BOOL SetComputerNameExW(COMPUTER_NAME_FORMAT NameType,LPCWSTR lpBuffer)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b6a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b6a0  1270  SetComputerNameExW
  BVar1 = SetComputerNameExW(NameType,lpBuffer);
  return BVar1;
}



BOOL SetComputerNameW(LPCWSTR lpComputerName)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b6c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b6c0  1271  SetComputerNameW
  BVar1 = SetComputerNameW(lpComputerName);
  return BVar1;
}



BOOL SetCurrentDirectoryA(LPCSTR lpPathName)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b6e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b6e0  1305  SetCurrentDirectoryA
  BVar1 = SetCurrentDirectoryA(lpPathName);
  return BVar1;
}



BOOL SetDynamicTimeZoneInformation(DYNAMIC_TIME_ZONE_INFORMATION *lpTimeZoneInformation)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b700. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b700  1312  SetDynamicTimeZoneInformation
  BVar1 = SetDynamicTimeZoneInformation(lpTimeZoneInformation);
  return BVar1;
}



BOOL SetEnvironmentStringsW(LPWCH NewEnvironment)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b720. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b720  1315  SetEnvironmentStringsW
  BVar1 = SetEnvironmentStringsW(NewEnvironment);
  return BVar1;
}



void SetFileApisToANSI(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003b740. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b740  1321  SetFileApisToANSI
  SetFileApisToANSI();
  return;
}



void SetFileApisToOEM(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003b760. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b760  1322  SetFileApisToOEM
  SetFileApisToOEM();
  return;
}



BOOL SetFileIoOverlappedRange(HANDLE FileHandle,PUCHAR OverlappedRangeStart,ULONG Length)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b780. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b780  1330  SetFileIoOverlappedRange
  BVar1 = SetFileIoOverlappedRange(FileHandle,OverlappedRangeStart,Length);
  return BVar1;
}



BOOL SetLocalTime(SYSTEMTIME *lpSystemTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b7a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b7a0  1349  SetLocalTime
  BVar1 = SetLocalTime(lpSystemTime);
  return BVar1;
}



BOOL SetLocaleInfoW(LCID Locale,LCTYPE LCType,LPCWSTR lpLCData)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b7c0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b7c0  1351  SetLocaleInfoW
  BVar1 = SetLocaleInfoW(Locale,LCType,lpLCData);
  return BVar1;
}



BOOL SetProcessPreferredUILanguages
               (DWORD dwFlags,PCZZWSTR pwszLanguagesBuffer,PULONG pulNumLanguages)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b7e0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b7e0  1365  SetProcessPreferredUILanguages
  BVar1 = SetProcessPreferredUILanguages(dwFlags,pwszLanguagesBuffer,pulNumLanguages);
  return BVar1;
}



BOOL SetProcessWorkingSetSizeEx
               (HANDLE hProcess,SIZE_T dwMinimumWorkingSetSize,SIZE_T dwMaximumWorkingSetSize,
               DWORD Flags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b800. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b800  1369  SetProcessWorkingSetSizeEx
  BVar1 = SetProcessWorkingSetSizeEx(hProcess,dwMinimumWorkingSetSize,dwMaximumWorkingSetSize,Flags)
  ;
  return BVar1;
}



BOOL SetStdHandleEx(DWORD nStdHandle,HANDLE hHandle,PHANDLE phPrevValue)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b820. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b820  1373  SetStdHandleEx
  BVar1 = SetStdHandleEx(nStdHandle,hHandle,phPrevValue);
  return BVar1;
}



BOOL SetSystemFileCacheSize(SIZE_T MinimumFileCacheSize,SIZE_T MaximumFileCacheSize,DWORD Flags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b840. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b840  1374  SetSystemFileCacheSize
  BVar1 = SetSystemFileCacheSize(MinimumFileCacheSize,MaximumFileCacheSize,Flags);
  return BVar1;
}



BOOL SetSystemTime(SYSTEMTIME *lpSystemTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b860. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b860  1376  SetSystemTime
  BVar1 = SetSystemTime(lpSystemTime);
  return BVar1;
}



BOOL SetThreadContext(HANDLE hThread,CONTEXT *lpContext)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b880. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b880  1382  SetThreadContext
  BVar1 = SetThreadContext(hThread,lpContext);
  return BVar1;
}



BOOL SetThreadIdealProcessorEx
               (HANDLE hThread,PPROCESSOR_NUMBER lpIdealProcessor,
               PPROCESSOR_NUMBER lpPreviousIdealProcessor)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b8a0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b8a0  1388  SetThreadIdealProcessorEx
  BVar1 = SetThreadIdealProcessorEx(hThread,lpIdealProcessor,lpPreviousIdealProcessor);
  return BVar1;
}



BOOL SetThreadpoolStackInformation(PTP_POOL ptpp,PTP_POOL_STACK_INFORMATION ptpsi)

{
  int iVar1;
  
                    // 0x3b8c0  1398  SetThreadpoolStackInformation
  iVar1 = TpSetPoolStackInformation();
  if (-1 >= iVar1) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  }
  return (uint)(-1 < iVar1);
}



BOOL SetTimeZoneInformation(TIME_ZONE_INFORMATION *lpTimeZoneInformation)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b900. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b900  1405  SetTimeZoneInformation
  BVar1 = SetTimeZoneInformation(lpTimeZoneInformation);
  return BVar1;
}



// WARNING: Could not reconcile some variable overlaps

BOOL SetVolumeMountPointWStub(LPCWSTR lpszVolumeMountPoint,LPCWSTR lpszVolumeName)

{
  undefined4 *_Dst;
  BOOL BVar1;
  DWORD DVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  BOOL extraout_EAX;
  HANDLE pvVar7;
  undefined4 *puVar8;
  undefined4 uVar9;
  longlong lVar10;
  longlong in_GS_OFFSET;
  undefined auStackY1240 [32];
  char acStack1176 [8];
  undefined auStack1168 [16];
  DWORD aDStack1152 [2];
  undefined auStack1144 [16];
  WCHAR aWStack1128 [264];
  WCHAR aWStack600 [264];
  ulonglong uStack72;
  
  uStack72 = DAT_1800b2220 ^ (ulonglong)auStackY1240;
  aDStack1152[0] = 0;
  acStack1176[0] = '\0';
  auStack1144 = ZEXT816(0);
  auStack1168 = ZEXT816(0);
  if ((lpszVolumeMountPoint == (LPCWSTR)0x0) || (lpszVolumeName == (LPCWSTR)0x0))
  goto LAB_1800237e0;
  BVar1 = GetVolumeNameForVolumeMountPointW(lpszVolumeMountPoint,aWStack600,0x104);
  if ((BVar1 == 0) && (DVar2 = GetLastError(), DVar2 != 0xce)) {
    iVar3 = RtlInitUnicodeStringEx(auStack1144,lpszVolumeMountPoint);
    if ((iVar3 < 0) || (iVar3 = RtlInitUnicodeStringEx(), iVar3 < 0)) {
LAB_180023477:
      BaseSetLastNTError();
      goto LAB_1800237f3;
    }
    if (auStack1144._0_2_ != 0) {
      if (auStack1168._0_2_ != 0) {
        if ((*(short *)((longlong)auStack1144._8_8_ + -2 + (ulonglong)(auStack1144._0_2_ >> 1) * 2)
             != 0x5c) ||
           (*(short *)((longlong)auStack1168._8_8_ +
                      (((ulonglong)auStack1168._0_2_ & 0xfffffffffffffffe) - 2)) != 0x5c))
        goto LAB_180023477;
        if (((((auStack1168._0_2_ == 0x60) ||
              ((auStack1168._0_2_ == 0x62 && (auStack1168._8_8_[0x30] == 0x5c)))) &&
             (*auStack1168._8_8_ == 0x5c)) &&
            (((((auStack1168._8_8_[1] == 0x3f || (auStack1168._8_8_[1] == 0x5c)) &&
               (auStack1168._8_8_[2] == 0x3f)) &&
              ((auStack1168._8_8_[3] == 0x5c && (auStack1168._8_8_[4] == 0x56)))) &&
             (auStack1168._8_8_[5] == 0x6f)))) &&
           (((((auStack1168._8_8_[6] == 0x6c && (auStack1168._8_8_[7] == 0x75)) &&
              ((auStack1168._8_8_[8] == 0x6d &&
               (((auStack1168._8_8_[9] == 0x65 && (auStack1168._8_8_[10] == 0x7b)) &&
                (auStack1168._8_8_[0x13] == 0x2d)))))) &&
             ((auStack1168._8_8_[0x18] == 0x2d && (auStack1168._8_8_[0x1d] == 0x2d)))) &&
            ((auStack1168._8_8_[0x22] == 0x2d &&
             (((auStack1168._8_8_[0x2f] == 0x7d && (auStack1168._0_2_ == 0x62)) &&
              (auStack1168._8_8_[1] == 0x5c)))))))) {
          iVar3 = FUN_18002393c(lpszVolumeName,acStack1176);
          if (iVar3 == 0) goto LAB_1800237f3;
          if (acStack1176[0] != '\0') {
            if (auStack1144._0_2_ == 6) {
              if (auStack1144._8_8_[1] == 0x3a) {
LAB_1800235fe:
                FUN_180023b28((ushort *)lpszVolumeMountPoint,lpszVolumeName);
                goto LAB_1800237f3;
              }
            }
            else if (((((auStack1144._0_2_ == 0xe) && (*auStack1144._8_8_ == 0x5c)) &&
                      (auStack1144._8_8_[1] == 0x5c)) &&
                     ((auStack1144._8_8_[2] == 0x2e || (auStack1144._8_8_[2] == 0x3f)))) &&
                    ((auStack1144._8_8_[3] == 0x5c && (auStack1144._8_8_[5] == 0x3a)))) {
              lpszVolumeMountPoint = lpszVolumeMountPoint + 4;
              goto LAB_1800235fe;
            }
            lVar10 = -1;
            pvVar7 = CreateFileW(L"\\\\.\\MountPointManager",0xc0000000,3,(LPSECURITY_ATTRIBUTES)0x0
                                 ,3,0x80,(HANDLE)0xffffffffffffffff);
            if (pvVar7 == (HANDLE)0xffffffffffffffff) goto LAB_1800237f3;
            CloseHandle(pvVar7);
            pvVar7 = CreateFileW(lpszVolumeMountPoint,0xc0000000,3,(LPSECURITY_ATTRIBUTES)0x0,3,
                                 0x2200080,(HANDLE)0xffffffffffffffff);
            if (pvVar7 == (HANDLE)0xffffffffffffffff) goto LAB_1800237f3;
            BVar1 = GetVolumePathNameW(lpszVolumeMountPoint,aWStack600,0x104);
            if ((BVar1 == 1) &&
               (BVar1 = GetVolumeNameForVolumeMountPointW(aWStack600,aWStack1128,0x104), BVar1 == 1)
               ) {
              do {
                lVar10 = lVar10 + 1;
              } while (aWStack1128[lVar10] != L'\0');
              iVar3 = FUN_18007e1f0(aWStack1128,lVar10);
              iVar4 = FUN_18007e0b4(aWStack1128,lVar10);
              iVar5 = FUN_18007e1f0(auStack1168._8_8_,(ulonglong)(auStack1168._0_2_ >> 1));
              iVar6 = FUN_18007e0b4(auStack1168._8_8_,(ulonglong)(auStack1168._0_2_ >> 1));
              if ((iVar4 != 0) || ((iVar6 == 0 && (iVar3 != iVar5)))) {
                CloseHandle(pvVar7);
                goto LAB_1800237e0;
              }
              RtlSetLastWin32Error(0);
            }
            puVar8 = (undefined4 *)KernelBaseGetGlobalData();
            puVar8 = (undefined4 *)
                     RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                     *puVar8,0x4000);
            if (puVar8 != (undefined4 *)0x0) {
              memset(puVar8 + 1,0,0x3ffc);
              *puVar8 = 0xa0000003;
              _Dst = puVar8 + 4;
              *(undefined4 *)((longlong)puVar8 + 6) = 0;
              *(ushort *)(puVar8 + 1) = (auStack1168._0_2_ + 6) * 2;
              *(ushort *)((longlong)puVar8 + 10) = auStack1168._0_2_;
              memcpy(_Dst,auStack1168._8_8_,(ulonglong)auStack1168._0_2_);
              *(undefined2 *)((longlong)puVar8 + 0x12) = 0x3f;
              *(ushort *)(puVar8 + 3) = *(ushort *)((longlong)puVar8 + 10) + 2;
              *(ushort *)((longlong)puVar8 + 0xe) = auStack1168._0_2_;
              memcpy((void *)((ulonglong)*(ushort *)((longlong)puVar8 + 10) + 2 + (longlong)_Dst),
                     _Dst,(ulonglong)auStack1168._0_2_);
              BVar1 = DeviceIoControl(pvVar7,0x900a4,puVar8,*(ushort *)(puVar8 + 1) + 8,(LPVOID)0x0,
                                      0,aDStack1152,(LPOVERLAPPED)0x0);
              RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar8);
              CloseHandle(pvVar7);
              if (BVar1 != 0) {
                NotifyMountMgr(lpszVolumeMountPoint,lpszVolumeName,1);
              }
              goto LAB_1800237f3;
            }
            CloseHandle(pvVar7);
            uVar9 = 8;
            goto LAB_1800237e5;
          }
        }
      }
    }
LAB_1800237e0:
    uVar9 = 0x57;
  }
  else {
    uVar9 = 0x91;
  }
LAB_1800237e5:
  RtlSetLastWin32Error(uVar9);
LAB_1800237f3:
  __security_check_cookie(uStack72 ^ (ulonglong)auStackY1240);
  return extraout_EAX;
}



void SetXStateFeaturesMask(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003b930. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b930  1419  SetXStateFeaturesMask
  SetXStateFeaturesMask();
  return;
}



DWORD SignalObjectAndWait(HANDLE hObjectToSignal,HANDLE hObjectToWaitOn,DWORD dwMilliseconds,
                         BOOL bAlertable)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b950. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b950  1422  SignalObjectAndWait
  DVar1 = SignalObjectAndWait(hObjectToSignal,hObjectToWaitOn,dwMilliseconds,bAlertable);
  return DVar1;
}



BOOL TerminateThread(HANDLE hThread,DWORD dwExitCode)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b970. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b970  1440  TerminateThread
  BVar1 = TerminateThread(hThread,dwExitCode);
  return BVar1;
}



BOOL TransactNamedPipe(HANDLE hNamedPipe,LPVOID lpInBuffer,DWORD nInBufferSize,LPVOID lpOutBuffer,
                      DWORD nOutBufferSize,LPDWORD lpBytesRead,LPOVERLAPPED lpOverlapped)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b990. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b990  1462  TransactNamedPipe
  BVar1 = TransactNamedPipe(hNamedPipe,lpInBuffer,nInBufferSize,lpOutBuffer,nOutBufferSize,
                            lpBytesRead,lpOverlapped);
  return BVar1;
}



BOOL TzSpecificLocalTimeToSystemTime
               (TIME_ZONE_INFORMATION *lpTimeZoneInformation,SYSTEMTIME *lpLocalTime,
               LPSYSTEMTIME lpUniversalTime)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b9b0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b9b0  1468  TzSpecificLocalTimeToSystemTime
  BVar1 = TzSpecificLocalTimeToSystemTime(lpTimeZoneInformation,lpLocalTime,lpUniversalTime);
  return BVar1;
}



LONG UnhandledExceptionFilter(_EXCEPTION_POINTERS *ExceptionInfo)

{
  LONG LVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b9d0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b9d0  1473  UnhandledExceptionFilter
  LVar1 = UnhandledExceptionFilter(ExceptionInfo);
  return LVar1;
}



HRESULT UnregisterApplicationRestart(void)

{
  HRESULT HVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003b9f0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3b9f0  1479  UnregisterApplicationRestart
  HVar1 = UnregisterApplicationRestart();
  return HVar1;
}



void UnregisterBadMemoryNotification(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003ba10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ba10  1480  UnregisterBadMemoryNotification
  UnregisterBadMemoryNotification();
  return;
}



BOOL VerifyScripts(DWORD dwFlags,LPCWSTR lpLocaleScripts,int cchLocaleScripts,LPCWSTR lpTestScripts,
                  int cchTestScripts)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003ba30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ba30  1495  VerifyScripts
  BVar1 = VerifyScripts(dwFlags,lpLocaleScripts,cchLocaleScripts,lpTestScripts,cchTestScripts);
  return BVar1;
}



LPVOID VirtualAllocEx(HANDLE hProcess,LPVOID lpAddress,SIZE_T dwSize,DWORD flAllocationType,
                     DWORD flProtect)

{
  LPVOID pvVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003ba50. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ba50  1499  VirtualAllocEx
  pvVar1 = VirtualAllocEx(hProcess,lpAddress,dwSize,flAllocationType,flProtect);
  return pvVar1;
}



BOOL VirtualFreeEx(HANDLE hProcess,LPVOID lpAddress,SIZE_T dwSize,DWORD dwFreeType)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003ba70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ba70  1502  VirtualFreeEx
  BVar1 = VirtualFreeEx(hProcess,lpAddress,dwSize,dwFreeType);
  return BVar1;
}



BOOL VirtualProtectEx(HANDLE hProcess,LPVOID lpAddress,SIZE_T dwSize,DWORD flNewProtect,
                     PDWORD lpflOldProtect)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003ba90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3ba90  1505  VirtualProtectEx
  BVar1 = VirtualProtectEx(hProcess,lpAddress,dwSize,flNewProtect,lpflOldProtect);
  return BVar1;
}



BOOL WaitForDebugEvent(LPDEBUG_EVENT lpDebugEvent,DWORD dwMilliseconds)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003bab0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3bab0  1511  WaitForDebugEvent
  BVar1 = WaitForDebugEvent(lpDebugEvent,dwMilliseconds);
  return BVar1;
}



BOOL WaitNamedPipeW(LPCWSTR lpNamedPipeName,DWORD nTimeOut)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003bad0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3bad0  1522  WaitNamedPipeW
  BVar1 = WaitNamedPipeW(lpNamedPipeName,nTimeOut);
  return BVar1;
}



void WerRegisterAdditionalProcess(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003baf0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3baf0  1527  WerRegisterAdditionalProcess
  WerRegisterAdditionalProcess();
  return;
}



void WerRegisterAppLocalDump(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003bb10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3bb10  1528  WerRegisterAppLocalDump
  WerRegisterAppLocalDump();
  return;
}



void WerRegisterCustomMetadata(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003bb30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3bb30  1529  WerRegisterCustomMetadata
  WerRegisterCustomMetadata();
  return;
}



void WerRegisterExcludedMemoryBlock(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003bb50. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3bb50  1530  WerRegisterExcludedMemoryBlock
  WerRegisterExcludedMemoryBlock();
  return;
}



void WerUnregisterAdditionalProcess(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003bb70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3bb70  1539  WerUnregisterAdditionalProcess
  WerUnregisterAdditionalProcess();
  return;
}



void WerUnregisterAppLocalDump(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003bb90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3bb90  1540  WerUnregisterAppLocalDump
  WerUnregisterAppLocalDump();
  return;
}



void WerUnregisterCustomMetadata(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003bbb0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3bbb0  1541  WerUnregisterCustomMetadata
  WerUnregisterCustomMetadata();
  return;
}



void WerUnregisterExcludedMemoryBlock(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003bbd0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3bbd0  1542  WerUnregisterExcludedMemoryBlock
  WerUnregisterExcludedMemoryBlock();
  return;
}



HRESULT WerUnregisterRuntimeExceptionModule(PCWSTR pwszOutOfProcessCallbackDll,PVOID pContext)

{
  HRESULT HVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003bbf0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3bbf0  1547  WerUnregisterRuntimeExceptionModule
  HVar1 = WerUnregisterRuntimeExceptionModule(pwszOutOfProcessCallbackDll,pContext);
  return HVar1;
}



BOOL Wow64DisableWow64FsRedirection(PVOID *OldValue)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003bc10. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3bc10  1556  Wow64DisableWow64FsRedirection
  BVar1 = Wow64DisableWow64FsRedirection(OldValue);
  return BVar1;
}



BOOL Wow64GetThreadContext(HANDLE hThread,PWOW64_CONTEXT lpContext)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003bc30. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3bc30  1558  Wow64GetThreadContext
  BVar1 = Wow64GetThreadContext(hThread,lpContext);
  return BVar1;
}



BOOL Wow64RevertWow64FsRedirection(PVOID OlValue)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003bc50. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3bc50  1560  Wow64RevertWow64FsRedirection
  BVar1 = Wow64RevertWow64FsRedirection(OlValue);
  return BVar1;
}



BOOL Wow64SetThreadContext(HANDLE hThread,WOW64_CONTEXT *lpContext)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003bc70. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3bc70  1561  Wow64SetThreadContext
  BVar1 = Wow64SetThreadContext(hThread,lpContext);
  return BVar1;
}



DWORD Wow64SuspendThread(HANDLE hThread)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003bc90. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3bc90  1562  Wow64SuspendThread
  DVar1 = Wow64SuspendThread(hThread);
  return DVar1;
}



BOOL WriteProcessMemory(HANDLE hProcess,LPVOID lpBaseAddress,LPCVOID lpBuffer,SIZE_T nSize,
                       SIZE_T *lpNumberOfBytesWritten)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003bcb0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3bcb0  1583  WriteProcessMemory
  BVar1 = WriteProcessMemory(hProcess,lpBaseAddress,lpBuffer,nSize,lpNumberOfBytesWritten);
  return BVar1;
}



BOOL ZombifyActCtx(HANDLE hActCtx)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003bcd0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3bcd0  1589  ZombifyActCtx
  BVar1 = ZombifyActCtx(hActCtx);
  return BVar1;
}



LPSTR lstrcpyn(LPSTR lpString1,LPCSTR lpString2,int iMaxLength)

{
  LPSTR pCVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018003bcf0. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x3bcf0  1615  lstrcpyn
                    // 0x3bcf0  1616  lstrcpynA
  pCVar1 = lstrcpynA(lpString1,lpString2,iMaxLength);
  return pCVar1;
}



BOOL AddIntegrityLabelToBoundaryDescriptor(HANDLE *BoundaryDescriptor,PSID IntegrityLabel)

{
  int iVar1;
  
                    // 0x3bd10  10  AddIntegrityLabelToBoundaryDescriptor
  iVar1 = RtlAddIntegrityLabelToBoundaryDescriptor();
  if (iVar1 < 0) {
    BaseSetLastNTError();
  }
  return (uint)(iVar1 >= 0);
}



undefined8 CheckForReadOnlyResourceFilter(int **param_1)

{
  int iVar1;
  undefined8 uVar2;
  longlong local_res10 [3];
  
                    // 0x3bd40  128  CheckForReadOnlyResourceFilter
  iVar1 = RtlQueryProtectedPolicy(&DAT_180085d78,local_res10);
  if (iVar1 < 0) {
    local_res10[0] = 0;
  }
  if (local_res10[0] == 0) {
    uVar2 = 0;
  }
  else {
    uVar2 = CheckForReadOnlyResource(param_1,0);
  }
  return uVar2;
}



HANDLE Toolhelp32ReadProcessMemory
                 (DWORD param_1,LPCVOID param_2,LPVOID param_3,SIZE_T param_4,SIZE_T *param_5)

{
  uint uVar1;
  HANDLE hProcess;
  HANDLE pvVar2;
  
                    // 0x3bda0  1461  Toolhelp32ReadProcessMemory
  hProcess = OpenProcess(0x10,0,param_1);
  pvVar2 = hProcess;
  if (hProcess != (HANDLE)0x0) {
    uVar1 = ReadProcessMemory(hProcess,param_2,param_3,param_4,param_5);
    pvVar2 = (HANDLE)(ulonglong)uVar1;
    CloseHandle(hProcess);
  }
  return pvVar2;
}



uint FUN_18003be2c(uint param_1)

{
  uint uVar1;
  
  if ((0xf < param_1) ||
     (uVar1 = (&DAT_1800b2f00)[(int)param_1], (&DAT_1800b2f00)[(int)param_1] == 0)) {
    uVar1 = param_1;
  }
  return uVar1;
}



int FUN_18003be4c(undefined4 param_1)

{
  int *piVar1;
  int iVar2;
  
  RtlAcquireSRWLockExclusive(&DAT_1800b2e60);
  iVar2 = 0;
  piVar1 = &DAT_1800b2f00;
  do {
    if (*piVar1 == 0) break;
    iVar2 = iVar2 + 1;
    piVar1 = piVar1 + 1;
  } while ((longlong)piVar1 < 0x1800b2f40);
  if (iVar2 < 0x10) {
    (&DAT_1800b2f00)[iVar2] = param_1;
  }
  else {
    iVar2 = -5;
  }
  RtlReleaseSRWLockExclusive(&DAT_1800b2e60);
  return iVar2;
}



INT GetExpandedNameA(LPSTR lpszSource,LPSTR lpszBuffer)

{
  HFILE hFile;
  int iVar1;
  INT extraout_EAX;
  uint uVar2;
  undefined8 uVar3;
  undefined auStack248 [32];
  int local_d8 [2];
  undefined8 local_d0;
  BYTE local_c7;
  _OFSTRUCT local_b8;
  ulonglong local_28;
  
                    // 0x3bed0  585  GetExpandedNameA
  local_28 = DAT_1800b2220 ^ (ulonglong)auStack248;
  memset(&local_b8,0,0x88);
  local_d8[0] = 0;
  hFile = OpenFile(lpszSource,&local_b8,0);
  if (hFile != -1) {
    iVar1 = FUN_180069b80(&local_d0,hFile,local_d8);
    if ((iVar1 == 1) || (local_d8[0] < 0xe)) {
      _lclose(hFile);
      uVar3 = 0x104;
      uVar2 = FID_conflict_RtlStringCchCopyA(lpszBuffer,0x104,(longlong)lpszSource);
      if ((-1 < (int)uVar2) && ((iVar1 == 1 && (iVar1 = FUN_180069c50(&local_d0), iVar1 == 1)))) {
        FUN_180069f74((BYTE *)lpszBuffer,uVar3,local_c7);
      }
    }
    else {
      _lclose(hFile);
    }
  }
  __security_check_cookie(local_28 ^ (ulonglong)auStack248);
  return extraout_EAX;
}



// WARNING: Could not reconcile some variable overlaps

INT GetExpandedNameW(LPWSTR lpszSource,LPWSTR lpszBuffer)

{
  longlong lVar1;
  int iVar2;
  INT IVar3;
  uint uVar4;
  INT extraout_EAX;
  longlong lVar5;
  longlong lVar6;
  undefined auStack376 [32];
  undefined local_158 [4];
  undefined auStack340 [12];
  undefined local_148 [16];
  CHAR local_138;
  char acStack311 [271];
  ulonglong local_28;
  
                    // 0x3bfc0  586  GetExpandedNameW
  local_28 = DAT_1800b2220 ^ (ulonglong)auStack376;
  RtlInitUnicodeString(local_148,lpszSource);
  _local_158 = ZEXT816(&local_138) << 0x40;
  _local_158 = CONCAT124(auStack340,0x1060000);
  iVar2 = RtlUnicodeStringToAnsiString(local_158,local_148,0);
  if (-1 < iVar2) {
    IVar3 = GetExpandedNameA(&local_138,(LPSTR)lpszBuffer);
    lVar5 = -1;
    if ((IVar3 != -1) &&
       (uVar4 = FID_conflict_RtlStringCchCopyA(&local_138,0x106,(longlong)lpszBuffer),
       -1 < (int)uVar4)) {
      do {
        lVar6 = lVar5 + 1;
        lVar1 = lVar5 + 1;
        lVar5 = lVar6;
      } while ((&local_138)[lVar1] != '\0');
      _local_158 = CONCAT142(stack0xfffffffffffffeaa,(short)lVar6);
      local_148 = ZEXT816(lpszBuffer) << 0x40;
      local_148 = CONCAT124(local_148._4_12_,0x2080000);
      RtlAnsiStringToUnicodeString(local_148,local_158,0);
    }
  }
  __security_check_cookie(local_28 ^ (ulonglong)auStack376);
  return extraout_EAX;
}



void LZClose(INT hFile)

{
  HGLOBAL hMem;
  uint hFile_00;
  HFILE *pHVar1;
  longlong lVar2;
  
                    // 0x3c0f0  954  LZClose
  lVar2 = (longlong)hFile;
  if ((uint)hFile < 0x410) {
    if (hFile < 0x400) {
      hFile_00 = FUN_18003be2c(hFile);
      _lclose(hFile_00);
      if (hFile < 0x10) {
        (&DAT_1800b2f00)[lVar2] = 0;
      }
    }
    else {
      hMem = *(HGLOBAL *)("RtlDnsHostNameToComputerName" + lVar2 * 8 + 0xe);
      *(undefined8 *)("RtlDnsHostNameToComputerName" + lVar2 * 8 + 0xe) = 0;
      pHVar1 = (HFILE *)GlobalLock(hMem);
      if (pHVar1 != (HFILE *)0x0) {
        _lclose(*pHVar1);
        if (*(HGLOBAL **)(pHVar1 + 0x10) != (HGLOBAL *)0x0) {
          FUN_180069838(*(HGLOBAL **)(pHVar1 + 0x10));
        }
        GlobalUnlock(hMem);
        GlobalFree(hMem);
      }
    }
  }
  return;
}



void LZCloseFile(uint param_1)

{
  HGLOBAL hMem;
  uint uVar1;
  int *piVar2;
  longlong lVar3;
  
                    // 0x3c1b0  955  LZCloseFile
  lVar3 = (longlong)(int)param_1;
  if (param_1 < 0x410) {
    if ((int)param_1 < 0x400) {
      uVar1 = FUN_18003be2c(param_1);
      CloseHandle((HANDLE)(longlong)(int)uVar1);
      if ((int)param_1 < 0x10) {
        (&DAT_1800b2f00)[lVar3] = 0;
      }
    }
    else {
      hMem = *(HGLOBAL *)("RtlDnsHostNameToComputerName" + lVar3 * 8 + 0xe);
      *(undefined8 *)("RtlDnsHostNameToComputerName" + lVar3 * 8 + 0xe) = 0;
      piVar2 = (int *)GlobalLock(hMem);
      if (piVar2 != (int *)0x0) {
        CloseHandle((HANDLE)(longlong)*piVar2);
        if (*(HGLOBAL **)(piVar2 + 0x10) != (HGLOBAL *)0x0) {
          FUN_180069838(*(HGLOBAL **)(piVar2 + 0x10));
        }
        GlobalUnlock(hMem);
        GlobalFree(hMem);
      }
    }
  }
  return;
}



INT LZCreateFileW(longlong param_1,DWORD param_2,DWORD param_3,DWORD param_4,short *param_5)

{
  uint uVar1;
  DWORD DVar2;
  int iVar3;
  INT IVar4;
  HANDLE hObject;
  
                    // 0x3c280  957  LZCreateFileW
  uVar1 = FUN_18000ecd4(&DAT_1800b3000,0x106,param_1);
  if (-1 < (int)uVar1) {
    hObject = CreateFileW(&DAT_1800b3000,param_2,param_3,(LPSECURITY_ATTRIBUTES)0x0,param_4,0x80,
                          (HANDLE)0x0);
    if (hObject == (HANDLE)0xffffffffffffffff) {
      DVar2 = GetLastError();
      if (DVar2 != 2) {
        return -1;
      }
      FUN_180069e88();
      hObject = CreateFileW(&DAT_1800b3000,param_2,param_3,(LPSECURITY_ATTRIBUTES)0x0,param_4,0x80,
                            (HANDLE)0x0);
      if (hObject == (HANDLE)0xffffffffffffffff) {
        return -1;
      }
    }
    if (param_4 != 3) {
      iVar3 = FUN_18003be4c((INT)hObject);
      if (iVar3 == -5) {
        CloseHandle(hObject);
        return -5;
      }
      return iVar3;
    }
    IVar4 = LZInit((INT)hObject);
    if (IVar4 < 0) {
      CloseHandle(hObject);
    }
    if (param_5 == (short *)0x0) {
      return IVar4;
    }
    uVar1 = FUN_18000ecd4(param_5,0x104,(longlong)&DAT_1800b3000);
    if (-1 < (int)uVar1) {
      return IVar4;
    }
  }
  return -7;
}



INT LZInit(INT hfSource)

{
  longlong lVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  LONG LVar5;
  INT extraout_EAX;
  HGLOBAL hMem;
  INT *pIVar6;
  ulonglong uVar7;
  undefined auStack104 [32];
  int local_48 [2];
  undefined8 local_40;
  char local_38;
  INT local_34;
  INT local_30;
  ulonglong local_28;
  
                    // 0x3c3c0  959  LZInit
  local_28 = DAT_1800b2220 ^ (ulonglong)auStack104;
  local_48[0] = 0;
  iVar4 = FUN_180069b80(&local_40,hfSource,local_48);
  if (iVar4 == 1) {
    iVar4 = FUN_180069c50(&local_40);
    if (iVar4 == 1) {
      if (local_38 == 'A') {
        RtlAcquireSRWLockExclusive(&DAT_1800b2e60);
        uVar3 = DAT_1800b2f40;
        uVar7 = (ulonglong)(int)DAT_1800b2f40;
        lVar1 = (&DAT_1800b2e80)[uVar7];
        uVar2 = DAT_1800b2f40;
        while (lVar1 != 0) {
          DAT_1800b2f40 = (int)uVar7 + 1;
          uVar7 = (ulonglong)DAT_1800b2f40;
          if (0xf < (int)DAT_1800b2f40) {
            DAT_1800b2f40 = 0;
            uVar7 = 0;
          }
          if (DAT_1800b2f40 == uVar3) goto LAB_18003c524;
          uVar2 = DAT_1800b2f40;
          lVar1 = (&DAT_1800b2e80)[(int)DAT_1800b2f40];
        }
        DAT_1800b2f40 = uVar2;
        hMem = GlobalAlloc(0x42,0x48);
        if (hMem != (HGLOBAL)0x0) {
          pIVar6 = (INT *)GlobalLock(hMem);
          if (pIVar6 == (INT *)0x0) {
            GlobalFree(hMem);
          }
          else {
            *pIVar6 = hfSource;
            *(undefined *)(pIVar6 + 1) = 0x41;
            *(undefined2 *)((longlong)pIVar6 + 6) = 0;
            pIVar6[2] = local_34;
            pIVar6[3] = local_30;
            pIVar6[0xe] = 0;
            *(undefined8 *)(pIVar6 + 0x10) = 0;
            (&DAT_1800b2e80)[(int)uVar2] = hMem;
            GlobalUnlock(hMem);
            DAT_1800b2f40 = DAT_1800b2f40 + 1;
            if (0xf < (int)DAT_1800b2f40) {
              DAT_1800b2f40 = 0;
            }
          }
        }
LAB_18003c524:
        RtlReleaseSRWLockExclusive(&DAT_1800b2e60);
      }
      goto LAB_18003c542;
    }
  }
  else if (0xd < local_48[0]) goto LAB_18003c542;
  LVar5 = _llseek(hfSource,0,0);
  if (LVar5 == 0) {
    FUN_18003be4c(hfSource);
  }
LAB_18003c542:
  __security_check_cookie(local_28 ^ (ulonglong)auStack104);
  return extraout_EAX;
}



INT LZOpenFileA(LPSTR lpFileName,LPOFSTRUCT lpReOpenBuf,WORD wStyle)

{
  uint uVar1;
  HFILE hfSource;
  int iVar2;
  INT IVar3;
  INT extraout_EAX;
  LPOFSTRUCT p_Var4;
  undefined auStack344 [32];
  char local_138 [272];
  ulonglong local_28;
  
                    // 0x3c570  960  LZOpenFileA
  local_28 = DAT_1800b2220 ^ (ulonglong)auStack344;
  uVar1 = FID_conflict_RtlStringCchCopyA(local_138,0x106,(longlong)lpFileName);
  if ((int)uVar1 < 0) goto LAB_18003c627;
  p_Var4 = lpReOpenBuf;
  hfSource = OpenFile(local_138,lpReOpenBuf,(uint)wStyle);
  if (hfSource == -1) {
    if (lpReOpenBuf->nErrCode != 2) goto LAB_18003c627;
    FUN_180069dac(local_138,(ulonglong)p_Var4);
    hfSource = OpenFile(local_138,lpReOpenBuf,(uint)wStyle);
    if (hfSource == -1) goto LAB_18003c627;
  }
  if ((wStyle & 0xff0f) == 0) {
    IVar3 = LZInit(hfSource);
    if (-1 < IVar3) goto LAB_18003c627;
  }
  else {
    iVar2 = FUN_18003be4c(hfSource);
    if (iVar2 != -5) goto LAB_18003c627;
  }
  _lclose(hfSource);
LAB_18003c627:
  __security_check_cookie(local_28 ^ (ulonglong)auStack344);
  return extraout_EAX;
}



// WARNING: Could not reconcile some variable overlaps

INT LZOpenFileW(LPWSTR lpFileName,LPOFSTRUCT lpReOpenBuf,WORD wStyle)

{
  int iVar1;
  INT extraout_EAX;
  undefined auStack360 [32];
  undefined local_148 [16];
  undefined local_138 [16];
  CHAR local_128 [272];
  ulonglong local_18;
  
                    // 0x3c660  961  LZOpenFileW
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack360;
  RtlInitUnicodeString(local_138,lpFileName);
  local_148 = CONCAT124(SUB1612(ZEXT816(0) >> 0x20,0),0x1040000);
  local_148 = CONCAT88(local_128,local_148._0_8_);
  iVar1 = RtlUnicodeStringToAnsiString(local_148,local_138);
  if (-1 < iVar1) {
    LZOpenFileA(local_128,lpReOpenBuf,wStyle);
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack360);
  return extraout_EAX;
}



INT LZRead(INT hFile,CHAR *lpBuffer,INT cbRead)

{
  int iVar1;
  int iVar2;
  HGLOBAL hMem;
  UINT UVar3;
  uint uVar4;
  HFILE *pHVar5;
  HGLOBAL *ppvVar6;
  ulonglong uVar7;
  int iVar8;
  int iVar9;
  CHAR *pCVar10;
  HGLOBAL pvVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  longlong lVar15;
  int iVar16;
  byte in_stack_ffffffffffffffc8;
  
                    // 0x3c720  962  LZRead
  UVar3 = 0;
  if ((uint)hFile < 0x410) {
    if (cbRead < 0) {
      UVar3 = 0xfffffff9;
    }
    else if (hFile < 0x400) {
      uVar4 = FUN_18003be2c(hFile);
      UVar3 = _hread(uVar4,lpBuffer,cbRead);
    }
    else {
      hMem = *(HGLOBAL *)("RtlDnsHostNameToComputerName" + (longlong)hFile * 8 + 0xe);
      pCVar10 = lpBuffer;
      pHVar5 = (HFILE *)GlobalLock(hMem);
      if (pHVar5 == (HFILE *)0x0) {
        UVar3 = 0xfffffffa;
      }
      else {
        ppvVar6 = *(HGLOBAL **)(pHVar5 + 0x10);
        if (ppvVar6 == (HGLOBAL *)0x0) {
          ppvVar6 = FUN_1800698b0(0x400,pCVar10,0x402);
          *(HGLOBAL **)(pHVar5 + 0x10) = ppvVar6;
          if (ppvVar6 == (HGLOBAL *)0x0) {
            iVar13 = -5;
LAB_18003c94c:
            GlobalUnlock(hMem);
            return iVar13;
          }
          *(undefined4 *)(ppvVar6 + 7) = 0;
          pvVar11 = (HGLOBAL)((longlong)ppvVar6[1] + (ulonglong)*(uint *)(ppvVar6 + 9) + 1);
          ppvVar6[2] = pvVar11;
          ppvVar6[3] = pvVar11;
          ppvVar6[6] = ppvVar6[4];
          *(undefined4 *)((longlong)ppvVar6 + 0x44) = 0;
          ppvVar6[5] = (HGLOBAL)((ulonglong)*(uint *)((longlong)ppvVar6 + 0x4c) +
                                (longlong)ppvVar6[4]);
        }
        iVar1 = *(int *)(ppvVar6 + 5);
        iVar2 = *(int *)(ppvVar6 + 4);
        iVar13 = (*(int *)((longlong)ppvVar6 + 0x44) - *(int *)(ppvVar6 + 6)) +
                 *(int *)(ppvVar6 + 4);
        if ((*(ushort *)((longlong)pHVar5 + 6) & 1) == 0) {
          uVar4 = 1;
          *(ushort *)((longlong)pHVar5 + 6) = *(ushort *)((longlong)pHVar5 + 6) | 1;
        }
        else {
          uVar4 = (uint)(pHVar5[0xe] < iVar13);
        }
        if (0 < cbRead) {
          while (iVar8 = pHVar5[0xe], iVar8 < pHVar5[2]) {
            iVar12 = *(int *)(ppvVar6 + 6);
            iVar9 = *(int *)(ppvVar6 + 4);
            iVar14 = -1;
            if (iVar8 - iVar13 < iVar1 - iVar2) {
              iVar14 = iVar8 - iVar13;
            }
            if (-1 < iVar14) {
              iVar16 = 0;
              lVar15 = (longlong)iVar14;
              for (; (lVar15 < iVar12 - iVar9 && (0 < cbRead)); cbRead = cbRead + -1) {
                iVar16 = iVar16 + 1;
                pCVar10 = (CHAR *)(lVar15 + (longlong)ppvVar6[4]);
                lVar15 = lVar15 + 1;
                *lpBuffer = *pCVar10;
                lpBuffer = lpBuffer + 1;
              }
              pHVar5[0xe] = pHVar5[0xe] + iVar16;
              iVar8 = pHVar5[0xe];
              UVar3 = UVar3 + iVar16;
            }
            if (cbRead < 1) break;
            if (iVar8 < pHVar5[2]) {
              if (uVar4 == 0) {
                iVar12 = ((iVar12 - iVar9) - *(int *)((longlong)ppvVar6 + 0x3c)) + (iVar1 - iVar2) +
                         iVar13;
              }
              else {
                iVar13 = iVar8 - *(int *)((longlong)ppvVar6 + 0x3c);
                iVar12 = 0;
                if (-1 < iVar13) {
                  iVar12 = iVar13;
                }
              }
              iVar8 = iVar8 + cbRead;
              iVar9 = pHVar5[2] + -1;
              iVar13 = iVar8;
              if (iVar9 <= iVar8) {
                iVar13 = iVar9;
              }
              if ((iVar13 <= iVar12) && (iVar12 = iVar9, iVar8 < iVar9)) {
                iVar12 = iVar8;
              }
              ppvVar6[6] = ppvVar6[4];
              if (*(char *)(pHVar5 + 1) != 'A') {
                iVar13 = -8;
                goto LAB_18003c94c;
              }
              uVar7 = FUN_18006a0e4(*pHVar5,-2,iVar12,uVar4,in_stack_ffffffffffffffc8,
                                    (longlong *)ppvVar6);
              iVar13 = (int)uVar7;
              if (iVar13 < 0) goto LAB_18003c94c;
              if ((*(int *)(ppvVar6 + 6) - *(int *)(ppvVar6 + 4) < 1) ||
                 (iVar13 = *(int *)((longlong)ppvVar6 + 0x44) -
                           (*(int *)(ppvVar6 + 6) - *(int *)(ppvVar6 + 4)),
                 *(int *)((longlong)ppvVar6 + 0x44) < iVar12)) {
                iVar13 = -3;
                goto LAB_18003c94c;
              }
              uVar4 = 0;
            }
          }
        }
        GlobalUnlock(hMem);
      }
    }
  }
  else {
    UVar3 = 0xffffffff;
  }
  return UVar3;
}



LONG LZSeek(INT hFile,LONG lOffset,INT iOrigin)

{
  HGLOBAL hMem;
  uint hFile_00;
  LONG LVar1;
  LPVOID pvVar2;
  int iVar3;
  
                    // 0x3c990  963  LZSeek
  if (0x40f < (uint)hFile) {
    return -1;
  }
  if (hFile < 0x400) {
    hFile_00 = FUN_18003be2c(hFile);
    LVar1 = _llseek(hFile_00,lOffset,iOrigin);
    return LVar1;
  }
  hMem = *(HGLOBAL *)("RtlDnsHostNameToComputerName" + (longlong)hFile * 8 + 0xe);
  pvVar2 = GlobalLock(hMem);
  iVar3 = 0;
  if (pvVar2 == (LPVOID)0x0) {
    return -6;
  }
  if (iOrigin != 0) {
    if (iOrigin == 1) {
      iVar3 = *(int *)((longlong)pvVar2 + 0x38);
    }
    else {
      if (iOrigin != 2) goto LAB_18003ca1b;
      iVar3 = *(int *)((longlong)pvVar2 + 8);
    }
  }
  iVar3 = iVar3 + lOffset;
  if (-1 < iVar3) {
    *(int *)((longlong)pvVar2 + 0x38) = iVar3;
    GlobalUnlock(hMem);
    return iVar3;
  }
LAB_18003ca1b:
  GlobalUnlock(hMem);
  return -7;
}



// Library Function - Multiple Matches With Different Base Names
//  RtlStringCbCopyA
//  RtlStringCchCopyA
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

uint FID_conflict_RtlStringCchCopyA(char *param_1,longlong param_2,longlong param_3)

{
  char *pcVar1;
  longlong lVar2;
  uint uVar3;
  longlong lVar4;
  
  uVar3 = 0;
  if (0x7ffffffe < param_2 - 1U) {
    uVar3 = 0xc000000d;
  }
  if ((int)uVar3 < 0) {
    if (param_2 != 0) {
      *param_1 = '\0';
    }
  }
  else {
    if (param_2 != 0) {
      lVar4 = 0x7ffffffe - param_2;
      lVar2 = param_3 - (longlong)param_1;
      do {
        if ((lVar4 + param_2 == 0) || (param_1[lVar2] == '\0')) break;
        *param_1 = param_1[lVar2];
        param_1 = param_1 + 1;
        param_2 = param_2 + -1;
      } while (param_2 != 0);
    }
    pcVar1 = param_1 + -1;
    if (param_2 != 0) {
      pcVar1 = param_1;
    }
    uVar3 = ~-(uint)(param_2 != 0) & 0x80000005;
    *pcVar1 = '\0';
  }
  return uVar3;
}



BOOL CommConfigDialogA(LPCSTR lpszName,HWND hWnd,LPCOMMCONFIG lpCC)

{
  int iVar1;
  BOOL BVar2;
  undefined local_28 [8];
  LPCWSTR local_20;
  undefined local_18 [16];
  
                    // 0x3cad0  152  CommConfigDialogA
  iVar1 = RtlInitAnsiStringEx(local_18,lpszName);
  if ((-1 < iVar1) && (iVar1 = RtlAnsiStringToUnicodeString(local_28,local_18,1), -1 < iVar1)) {
    BVar2 = CommConfigDialogW(local_20,hWnd,lpCC);
    RtlFreeUnicodeString(local_28);
    return BVar2;
  }
  BaseSetLastNTError();
  return 0;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Could not reconcile some variable overlaps

BOOL CommConfigDialogW(LPCWSTR lpszName,HWND hWnd,LPCOMMCONFIG lpCC)

{
  FARPROC pFVar1;
  uint uVar2;
  longlong in_GS_OFFSET;
  bool bVar3;
  uint local_res20;
  DWORD local_38;
  HMODULE local_30;
  undefined local_28 [16];
  
                    // 0x3cb80  153  CommConfigDialogW
  local_28 = ZEXT816(0);
  local_30 = (HMODULE)0x0;
  local_38 = 0;
  FUN_18003d0a4(lpszName,(undefined4 *)local_28);
  if (local_28._8_8_ != (LPCWSTR)0x0) {
    local_30 = LoadLibraryW(local_28._8_8_);
    if (local_30 != (HMODULE)0x0) {
      pFVar1 = GetProcAddress(local_30,"drvCommConfigDialogW");
      bVar3 = pFVar1 != (FARPROC)0x0;
      if (bVar3) {
        local_38 = (*pFVar1)();
      }
      else {
        local_38 = GetLastError();
      }
      local_res20 = (uint)bVar3;
      uVar2 = (uint)bVar3;
      goto LAB_18003cc4a;
    }
    local_38 = GetLastError();
  }
  uVar2 = 0;
  local_res20 = 0;
LAB_18003cc4a:
  if (local_28._8_8_ != (LPCWSTR)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_28._8_8_);
    uVar2 = local_res20;
  }
  if (local_30 != (HMODULE)0x0) {
    FreeLibrary(local_30);
  }
  if (local_38 != 0) {
    RtlSetLastWin32Error(local_38);
    uVar2 = 0;
  }
  return uVar2;
}



void FUN_18003ccc4(undefined8 param_1,longlong param_2)

{
  longlong in_GS_OFFSET;
  
  if (*(longlong *)(param_2 + 0x38) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x38));
  }
  if (*(HMODULE *)(param_2 + 0x28) != (HMODULE)0x0) {
    FreeLibrary(*(HMODULE *)(param_2 + 0x28));
  }
  if (*(int *)(param_2 + 0x20) != 0) {
    RtlSetLastWin32Error();
  }
  return;
}



undefined8 FUN_18003cd30(undefined8 param_1,int param_2,void *param_3,uint param_4,short *param_5)

{
  undefined8 uVar1;
  undefined4 *puVar2;
  void *_Dst;
  longlong in_GS_OFFSET;
  
  if (param_2 == 1) {
    RtlInitUnicodeString(param_5,0);
    puVar2 = (undefined4 *)KernelBaseGetGlobalData();
    _Dst = (void *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                   *puVar2,(ulonglong)param_4);
    *(void **)(param_5 + 4) = _Dst;
    if (_Dst == (void *)0x0) {
      uVar1 = 0xc000009a;
    }
    else {
      memcpy(_Dst,param_3,(ulonglong)param_4);
      param_5[1] = (short)param_4;
      *param_5 = (short)param_4 + -2;
      uVar1 = 0;
    }
  }
  else {
    uVar1 = 0xc000000d;
  }
  return uVar1;
}



BOOL GetDefaultCommConfigA(LPCSTR lpszName,LPCOMMCONFIG lpCC,LPDWORD lpdwSize)

{
  int iVar1;
  BOOL BVar2;
  undefined local_28 [8];
  LPCWSTR local_20;
  undefined local_18 [16];
  
                    // 0x3cde0  558  GetDefaultCommConfigA
  iVar1 = RtlInitAnsiStringEx(local_18,lpszName);
  if ((-1 < iVar1) && (iVar1 = RtlAnsiStringToUnicodeString(local_28,local_18,1), -1 < iVar1)) {
    BVar2 = GetDefaultCommConfigW(local_20,lpCC,lpdwSize);
    RtlFreeUnicodeString(local_28);
    return BVar2;
  }
  BaseSetLastNTError();
  return 0;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Could not reconcile some variable overlaps

BOOL GetDefaultCommConfigW(LPCWSTR lpszName,LPCOMMCONFIG lpCC,LPDWORD lpdwSize)

{
  FARPROC pFVar1;
  BOOL BVar2;
  longlong in_GS_OFFSET;
  BOOL local_res20;
  DWORD local_38;
  HMODULE local_30;
  undefined local_28 [16];
  
                    // 0x3ce90  559  GetDefaultCommConfigW
  local_28 = ZEXT816(0);
  BVar2 = 1;
  local_res20 = 1;
  local_30 = (HMODULE)0x0;
  local_38 = 0;
  FUN_18003d0a4(lpszName,(undefined4 *)local_28);
  if (local_28._8_8_ != (LPCWSTR)0x0) {
    local_30 = LoadLibraryW(local_28._8_8_);
    if (local_30 != (HMODULE)0x0) {
      pFVar1 = GetProcAddress(local_30,"drvGetDefaultCommConfigW");
      if (pFVar1 != (FARPROC)0x0) {
        local_38 = (*pFVar1)();
        goto LAB_18003cf44;
      }
    }
    local_38 = GetLastError();
  }
  BVar2 = 0;
  local_res20 = 0;
LAB_18003cf44:
  if (local_28._8_8_ != (LPCWSTR)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_28._8_8_);
    BVar2 = local_res20;
  }
  if (local_30 != (HMODULE)0x0) {
    FreeLibrary(local_30);
  }
  if (local_38 != 0) {
    RtlSetLastWin32Error(local_38);
    BVar2 = 0;
  }
  return BVar2;
}



void FUN_18003cfbe(undefined8 param_1,longlong param_2)

{
  longlong in_GS_OFFSET;
  
  if (*(longlong *)(param_2 + 0x38) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x38));
  }
  if (*(HMODULE *)(param_2 + 0x28) != (HMODULE)0x0) {
    FreeLibrary(*(HMODULE *)(param_2 + 0x28));
  }
  if (*(int *)(param_2 + 0x20) != 0) {
    RtlSetLastWin32Error();
  }
  return;
}



undefined8
FUN_18003d030(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
             undefined4 *param_5)

{
  char cVar1;
  undefined local_28 [16];
  undefined local_18 [16];
  
  RtlInitUnicodeString(local_18,*(undefined8 *)(param_5 + 2));
  RtlInitUnicodeString(local_28,param_3);
  cVar1 = RtlEqualUnicodeString(local_18,local_28,1);
  if (cVar1 != '\0') {
    *param_5 = 1;
  }
  return 0;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_18003d0a4(undefined8 param_1,undefined4 *param_2)

{
  int iVar1;
  HMODULE hModule;
  FARPROC pFVar2;
  FARPROC pFVar3;
  FARPROC pFVar4;
  undefined4 *puVar5;
  short *psVar6;
  longlong lVar7;
  short *psVar9;
  longlong in_GS_OFFSET;
  undefined auStack312 [32];
  HANDLE *local_118;
  undefined4 local_110;
  HANDLE local_f8;
  int local_f0 [2];
  undefined8 local_e8;
  short *local_e0;
  FARPROC local_d8;
  FARPROC local_d0;
  FARPROC local_c8;
  undefined *local_c0;
  HMODULE local_b8;
  code *local_a8;
  undefined4 local_a0;
  undefined local_9c [4];
  wchar_t *local_98;
  longlong lVar8;
  
  local_c0 = auStack312;
  memset(local_9c,0,100);
  local_f0[0] = 0;
  local_a8 = FUN_18003d030;
  local_a0 = 4;
  local_e8 = param_1;
  hModule = LoadLibraryW(L"cfgmgr32.dll");
  local_b8 = hModule;
  if (hModule != (HMODULE)0x0) {
    pFVar2 = GetProcAddress(hModule,"CM_Get_Device_ID_List_SizeW");
    pFVar3 = GetProcAddress(hModule,"CM_Get_Device_ID_ListW");
    local_d8 = pFVar3;
    pFVar4 = GetProcAddress(hModule,"CM_Locate_DevNodeW");
    local_d0 = pFVar4;
    local_c8 = GetProcAddress(hModule,"CM_Open_DevNode_Key");
    if ((((pFVar2 != (FARPROC)0x0) && (pFVar3 != (FARPROC)0x0)) && (pFVar4 != (FARPROC)0x0)) &&
       (local_c8 != (FARPROC)0x0)) {
      local_e0 = (short *)0x0;
      lVar7 = (*pFVar2)();
      if (lVar7 == 0) {
        puVar5 = (undefined4 *)KernelBaseGetGlobalData();
        psVar6 = (short *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30)
                                          ,*puVar5,4);
        pFVar3 = local_c8;
        pFVar2 = local_d0;
        local_e0 = psVar6;
        if (psVar6 != (short *)0x0) {
          lVar7 = (*local_d8)();
          psVar9 = psVar6;
          if (lVar7 == 0) {
            for (; *psVar9 != 0; psVar9 = psVar9 + lVar8 + 2) {
              lVar7 = (*pFVar2)();
              if (lVar7 == 0) {
                local_110 = 1;
                local_118 = &local_f8;
                lVar7 = (*pFVar3)();
                if (lVar7 == 0) {
                  local_f0[0] = 0;
                  local_98 = L"FriendlyName";
                  local_118 = (HANDLE *)0x0;
                  iVar1 = RtlQueryRegistryValuesEx(0x40000000,local_f8,&local_a8,local_f0);
                  if ((iVar1 < 0) || (local_f0[0] == 0)) {
                    CloseHandle(local_f8);
                  }
                  else {
                    local_a8 = FUN_18003cd30;
                    local_98 = L"ConfigDialog";
                    local_118 = (HANDLE *)0x0;
                    iVar1 = RtlQueryRegistryValuesEx(0x40000000,local_f8,&local_a8,param_2);
                    local_a8 = FUN_18003d030;
                    if (iVar1 < 0) {
                      BaseSetLastNTError();
                      CloseHandle(local_f8);
                      _local_unwind(local_c0);
                    }
                    CloseHandle(local_f8);
                    if (*(longlong *)(param_2 + 2) != 0) {
                      _local_unwind(local_c0);
                    }
                  }
                }
              }
              lVar7 = -1;
              do {
                lVar8 = lVar7;
                lVar7 = lVar8 + 1;
              } while (psVar9[lVar7] != 0);
            }
          }
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,psVar6);
        }
      }
    }
    FreeLibrary(hModule);
  }
  if (*(longlong *)(param_2 + 2) == 0) {
    local_98 = (wchar_t *)0x0;
    local_118 = (HANDLE *)0x0;
    iVar1 = RtlQueryRegistryValuesEx(4,L"SERIALCOMM",&local_a8,local_f0);
    if ((iVar1 < 0) || (local_f0[0] == 0)) {
      RtlSetLastWin32Error(0x57);
    }
    else {
      puVar5 = (undefined4 *)KernelBaseGetGlobalData();
      puVar5 = (undefined4 *)
               RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),*puVar5,
                               0x1a);
      *(undefined4 **)(param_2 + 2) = puVar5;
      if (puVar5 == (undefined4 *)0x0) {
        BaseSetLastNTError();
      }
      else {
        *param_2 = 0x1a0018;
        *puVar5 = 0x650073;
        puVar5[1] = 0x690072;
        puVar5[2] = 0x6c0061;
        puVar5[3] = 0x690075;
        *(undefined8 *)(puVar5 + 4) = 0x6c006c0064002e;
        *(undefined2 *)(puVar5 + 6) = 0;
      }
    }
  }
  return;
}



void FUN_18003d525(undefined8 param_1,longlong param_2)

{
  longlong in_GS_OFFSET;
  
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
              *(undefined8 *)(param_2 + 0x58));
  return;
}



void FUN_18003d555(undefined8 param_1,longlong param_2)

{
  FreeLibrary(*(HMODULE *)(param_2 + 0x80));
  return;
}



BOOL SetDefaultCommConfigA(LPCSTR lpszName,LPCOMMCONFIG lpCC,DWORD dwSize)

{
  int iVar1;
  BOOL BVar2;
  undefined local_28 [8];
  LPCWSTR local_20;
  undefined local_18 [16];
  
                    // 0x3d580  1307  SetDefaultCommConfigA
  iVar1 = RtlInitAnsiStringEx(local_18,lpszName);
  if ((-1 < iVar1) && (iVar1 = RtlAnsiStringToUnicodeString(local_28,local_18), -1 < iVar1)) {
    BVar2 = SetDefaultCommConfigW(local_20,lpCC,dwSize);
    RtlFreeUnicodeString(local_28);
    return BVar2;
  }
  BaseSetLastNTError();
  return 0;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Could not reconcile some variable overlaps

BOOL SetDefaultCommConfigW(LPCWSTR lpszName,LPCOMMCONFIG lpCC,DWORD dwSize)

{
  FARPROC pFVar1;
  uint uVar2;
  longlong in_GS_OFFSET;
  bool bVar3;
  uint local_res20;
  DWORD local_38;
  HMODULE local_30;
  undefined local_28 [16];
  
                    // 0x3d630  1308  SetDefaultCommConfigW
  local_28 = ZEXT816(0);
  local_30 = (HMODULE)0x0;
  local_38 = 0;
  FUN_18003d0a4(lpszName,(undefined4 *)local_28);
  if (local_28._8_8_ != (LPCWSTR)0x0) {
    local_30 = LoadLibraryW(local_28._8_8_);
    if (local_30 != (HMODULE)0x0) {
      pFVar1 = GetProcAddress(local_30,"drvSetDefaultCommConfigW");
      bVar3 = pFVar1 != (FARPROC)0x0;
      if (bVar3) {
        local_38 = (*pFVar1)();
      }
      else {
        local_38 = GetLastError();
      }
      local_res20 = (uint)bVar3;
      uVar2 = (uint)bVar3;
      goto LAB_18003d6fa;
    }
    local_38 = GetLastError();
  }
  uVar2 = 0;
  local_res20 = 0;
LAB_18003d6fa:
  if (local_28._8_8_ != (LPCWSTR)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_28._8_8_);
    uVar2 = local_res20;
  }
  if (local_30 != (HMODULE)0x0) {
    FreeLibrary(local_30);
  }
  if (local_38 != 0) {
    RtlSetLastWin32Error(local_38);
    uVar2 = 0;
  }
  return uVar2;
}



void FUN_18003d774(undefined8 param_1,longlong param_2)

{
  longlong in_GS_OFFSET;
  
  if (*(longlong *)(param_2 + 0x38) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x38));
  }
  if (*(HMODULE *)(param_2 + 0x28) != (HMODULE)0x0) {
    FreeLibrary(*(HMODULE *)(param_2 + 0x28));
  }
  if (*(int *)(param_2 + 0x20) != 0) {
    RtlSetLastWin32Error();
  }
  return;
}



void FUN_18003d7dc(undefined8 param_1,undefined4 *param_2)

{
  int iVar1;
  undefined auStack1048 [32];
  undefined8 local_3f8;
  undefined local_3e8 [16];
  undefined local_3d8 [64];
  ulonglong local_398;
  undefined8 local_390;
  undefined4 local_388;
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack1048;
  local_3f8 = 0;
  iVar1 = NtQueryEvent(param_1,0,local_3e8,8);
  if (-1 < iVar1) {
    local_398 = FUN_18001ffe0();
    local_390 = param_1;
    iVar1 = CsrClientCallServer(local_3d8,0,0x1001000a,0x18);
    if (-1 < iVar1) {
      *param_2 = local_388;
    }
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack1048);
  return;
}



int FUN_18003d894(uint param_1,LPCWSTR param_2,WCHAR *param_3,LPCWSTR param_4,ushort *param_5,
                 longlong param_6,undefined4 *param_7,uint param_8,longlong param_9,
                 longlong param_10)

{
  bool bVar1;
  int iVar2;
  wchar_t *pwVar3;
  longlong in_GS_OFFSET;
  DWORD local_res8 [2];
  ushort *puVar4;
  undefined4 uVar5;
  undefined4 local_58;
  undefined local_54 [4];
  undefined8 local_50;
  undefined local_48 [16];
  undefined *local_38 [2];
  
  local_58 = 0;
  local_res8[0] = 0;
  bVar1 = false;
  if (((param_1 & 0xfffffff0) == 0x10) &&
     (pwVar3 = FUN_18004094c(param_2,&local_58,local_res8), (int)pwVar3 != 0)) {
    FUN_180040f08(param_2,0x14,local_58,local_res8[0]);
    iVar2 = -0x3ffffefe;
  }
  else {
    puVar4 = param_5;
    iVar2 = FUN_18003da74(param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8,param_9,
                          param_10);
    uVar5 = (undefined4)((ulonglong)puVar4 >> 0x20);
    if (iVar2 == -0x3fffffde) {
      local_50 = *(undefined8 *)(param_9 + 0x10);
      *(undefined8 *)(param_9 + 0x10) =
           *(undefined8 *)(*(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x20) + 200);
      iVar2 = FUN_18003da74(param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8,param_9,
                            param_10);
      uVar5 = (undefined4)((ulonglong)param_5 >> 0x20);
      if (iVar2 < 0) {
        *(undefined8 *)(param_9 + 0x10) = local_50;
      }
      if ((param_1 == 0x20) && (iVar2 == -0x3fffffde)) {
        return -0x3fffffde;
      }
    }
    else {
      bVar1 = false;
      if (iVar2 == -0x3ffffbec) {
        bVar1 = true;
      }
    }
    FUN_180040f08(param_2,param_1,local_58,local_res8[0]);
    if (bVar1) {
      RtlInitUnicodeString(local_48,param_2);
      local_38[0] = local_48;
      NtRaiseHardError(0xc0000414,1,1,local_38,CONCAT44(uVar5,1),local_54);
    }
  }
  return iVar2;
}



void FUN_18003da74(uint param_1,LPCWSTR param_2,WCHAR *param_3,LPCWSTR param_4,ushort *param_5,
                  longlong param_6,undefined4 *param_7,uint param_8,longlong param_9,
                  longlong param_10)

{
  void **ppvVar1;
  wchar_t wVar2;
  HANDLE pvVar3;
  bool bVar4;
  ushort *puVar5;
  WCHAR WVar6;
  BOOL BVar7;
  uint uVar8;
  DWORD DVar9;
  int iVar10;
  int iVar11;
  UINT UVar12;
  int *piVar13;
  LPWSTR pWVar14;
  ulonglong uVar15;
  ulonglong uVar16;
  wchar_t *pwVar17;
  wchar_t *pwVar18;
  short sVar19;
  longlong lVar20;
  uint uVar22;
  LPCWSTR lpFileName;
  ulonglong _MaxCount;
  int iVar23;
  longlong in_GS_OFFSET;
  undefined auStackY936 [32];
  int local_378;
  wchar_t *local_358;
  ushort local_350;
  short local_34e;
  WCHAR *local_348;
  LPWSTR local_340;
  ushort local_338 [4];
  char *local_330;
  ushort local_328 [4];
  void *local_320;
  LPWSTR local_318;
  ushort local_310 [4];
  char *local_308;
  ushort local_300 [4];
  void *local_2f8;
  ushort local_2f0 [4];
  void *local_2e8;
  ushort local_2e0 [4];
  void *local_2d8;
  ushort local_2d0 [4];
  void *local_2c8;
  DWORD local_2c0;
  uint local_2bc;
  int local_2b8;
  uint local_2b4;
  LPCWSTR local_2b0;
  wchar_t *local_2a8;
  ushort *local_2a0;
  longlong local_298;
  undefined8 local_290;
  char *local_288;
  LPCWSTR local_280;
  undefined4 *local_278;
  undefined8 local_268;
  undefined2 local_260;
  WCHAR local_258 [264];
  ulonglong local_48;
  longlong lVar21;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStackY936;
  local_2a0 = param_5;
  local_278 = param_7;
  local_298 = param_10;
  local_268 = 0x6600690070002e;
  local_260 = 0;
  local_2a8 = (wchar_t *)0x0;
  local_290 = 0;
  local_2b0 = param_2;
  local_280 = param_4;
  if ((param_5 == (ushort *)0x0) || (0x8000 < *param_5)) {
    BaseSetLastNTError();
    goto LAB_18003ee99;
  }
  local_318 = (LPWSTR)0x0;
  local_320 = (void *)0x0;
  local_308 = (char *)0x0;
  local_330 = (char *)0x0;
  local_338[0] = 0;
  local_2e8 = (void *)0x0;
  local_2f0[0] = 0;
  local_2f8 = (void *)0x0;
  local_300[0] = 0;
  local_2d8 = (void *)0x0;
  local_2e0[0] = 0;
  local_2c8 = (void *)0x0;
  local_2d0[0] = 0;
  local_358 = (wchar_t *)0x0;
  local_340 = (LPWSTR)0x0;
  uVar22 = param_1 & 0xfffffff0;
  if ((*(longlong *)(*(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x20) + 0x10) == 0) ||
     ((param_8 & 0x10) != 0)) {
    bVar4 = true;
  }
  else {
    bVar4 = false;
  }
  local_2b4 = uVar22;
  if (uVar22 == 0x10) {
    lVar20 = *(longlong *)(in_GS_OFFSET + 0x60);
    if ((param_9 == 0) || ((*(uint *)(param_9 + 0x3c) & 0x100) == 0)) {
      pvVar3 = *(HANDLE *)(*(longlong *)(lVar20 + 0x20) + 0x20);
      *(HANDLE *)(param_6 + 0x60) = pvVar3;
      *(undefined8 *)(param_6 + 0x68) = *(undefined8 *)(*(longlong *)(lVar20 + 0x20) + 0x28);
      *(undefined8 *)(param_6 + 0x70) = *(undefined8 *)(*(longlong *)(lVar20 + 0x20) + 0x30);
      if ((*(uint *)(*(longlong *)(lVar20 + 0x20) + 0xa4) & 0x600) != 0) {
        if ((pvVar3 != (HANDLE)0x0) && (BVar7 = GetHandleInformation(pvVar3,&local_2c0), BVar7 == 0)
           ) {
          *(undefined8 *)(param_6 + 0x60) = 0;
        }
        if ((*(HANDLE *)(param_6 + 0x68) != (HANDLE)0x0) &&
           (BVar7 = GetHandleInformation(*(HANDLE *)(param_6 + 0x68),&local_2c0), BVar7 == 0)) {
          if (*(longlong *)(param_6 + 0x70) == *(longlong *)(param_6 + 0x68)) {
            *(undefined8 *)(param_6 + 0x70) = 0;
          }
          *(undefined8 *)(param_6 + 0x68) = 0;
        }
        pvVar3 = *(HANDLE *)(param_6 + 0x70);
        if (((pvVar3 != (HANDLE)0x0) && (pvVar3 != *(HANDLE *)(param_6 + 0x68))) &&
           (BVar7 = GetHandleInformation(pvVar3,&local_2c0), BVar7 == 0)) {
          *(undefined8 *)(param_6 + 0x70) = 0;
        }
      }
    }
    else {
      *(undefined8 *)(param_6 + 0x60) = *(undefined8 *)(param_9 + 0x50);
      *(undefined8 *)(param_6 + 0x68) = *(undefined8 *)(param_9 + 0x58);
      *(undefined8 *)(param_6 + 0x70) = *(undefined8 *)(param_9 + 0x60);
    }
    uVar8 = FUN_18003f96c(*(longlong *)(param_6 + 0x60));
    if ((char)uVar8 != '\0') {
      *(undefined8 *)(param_6 + 0x60) = 0;
    }
    uVar8 = FUN_18003f96c(*(longlong *)(param_6 + 0x68));
    if ((char)uVar8 != '\0') {
      *(undefined8 *)(param_6 + 0x68) = 0;
    }
    uVar8 = FUN_18003f96c(*(longlong *)(param_6 + 0x70));
    if ((char)uVar8 != '\0') {
      *(undefined8 *)(param_6 + 0x70) = 0;
    }
  }
  if ((uVar22 - 0x40 & 0xffffffbf) == 0) {
    bVar4 = true;
  }
  iVar23 = 2;
  for (; (*local_2b0 == L' ' || (*local_2b0 == L'\t')); local_2b0 = local_2b0 + 1) {
  }
  lVar20 = -1;
  do {
    lVar21 = lVar20;
    lVar20 = lVar21 + 1;
  } while (local_2b0[lVar20] != L'\0');
  local_2bc = (int)lVar21 + 0x106;
  piVar13 = (int *)KernelBaseGetGlobalData();
  pWVar14 = (LPWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                    *piVar13 + 0x200000);
  local_318 = pWVar14;
  if (pWVar14 != (LPWSTR)0x0) {
    uVar15 = (ulonglong)local_2bc;
    DVar9 = GetShortPathNameW(local_2b0,pWVar14,local_2bc);
    if ((DVar9 != 0) && (DVar9 <= local_2bc)) {
      RtlInitUnicodeString(&local_350,pWVar14);
      iVar10 = RtlUnicodeStringToOemString(local_310,&local_350,uVar15 & 0xffffffffffffff00 | 1);
      if (-1 < iVar10) {
        local_2b8 = 1;
        uVar22 = (uint)local_310[0];
        for (local_288 = local_308; (iVar10 = local_2b8, uVar22 != 0 && (*local_288 != '.'));
            local_288 = local_288 + 1) {
          iVar10 = 1;
          if (*local_288 != '\\') {
            iVar10 = local_2b8 + 1;
          }
          local_2b8 = iVar10;
          uVar22 = uVar22 - 1;
        }
        uVar15 = 0xffffffffffffffff;
        do {
          uVar15 = uVar15 + 1;
        } while (local_2b0[uVar15] != L'\0');
        uVar16 = 0;
        if (*param_3 == L'\"') {
          param_3 = param_3 + 1;
          do {
            WVar6 = *param_3;
            if (WVar6 == L'\0') break;
            param_3 = param_3 + 1;
          } while (WVar6 != L'\"');
        }
        else {
          _MaxCount = uVar15 & 0xffffffff;
          uVar16 = 0xffffffffffffffff;
          do {
            uVar16 = uVar16 + 1;
          } while (param_3[uVar16] != L'\0');
          if ((uVar16 < _MaxCount) ||
             (uVar16 = _MaxCount, iVar11 = _wcsnicmp(local_2b0,param_3,_MaxCount), iVar11 != 0)) {
            uVar16 = 0;
            for (; (WVar6 = *param_3, WVar6 == L'\t' || (WVar6 == L' ')); param_3 = param_3 + 1) {
            }
            if (WVar6 == L'\"') {
              param_3 = param_3 + 1;
              do {
                WVar6 = *param_3;
                if (WVar6 == L'\0') break;
                param_3 = param_3 + 1;
              } while (WVar6 != L'\"');
            }
            else {
              while ((0x20 < (ushort)WVar6 ||
                     ((0x100000201U >> ((ulonglong)(ushort)WVar6 & 0x3f) & 1) == 0))) {
                param_3 = param_3 + 1;
                WVar6 = *param_3;
              }
            }
          }
          else {
            param_3 = param_3 + _MaxCount;
          }
        }
        for (; (*param_3 == L'\t' || (*param_3 == L' ')); param_3 = param_3 + 1) {
        }
        lVar20 = -1;
        do {
          lVar20 = lVar20 + 1;
        } while (param_3[lVar20] != L'\0');
        local_350 = (short)lVar20 * 2;
        local_34e = local_350 + 2;
        local_348 = param_3;
        iVar11 = RtlUnicodeStringToOemString(local_328,&local_350,uVar16 & 0xffffffffffffff00 | 1);
        if ((-1 < iVar11) && ((uint)local_328[0] < 0x80U - iVar10)) {
          piVar13 = (int *)KernelBaseGetGlobalData();
          local_358 = (wchar_t *)
                      RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                      *piVar13 + 0x200000,0x208);
          uVar16 = 0;
          if (local_358 != (wchar_t *)0x0) {
            piVar13 = (int *)KernelBaseGetGlobalData();
            local_340 = (LPWSTR)RtlAllocateHeap(*(undefined8 *)
                                                 (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                                *piVar13 + 0x200000,0x208);
            if (local_340 != (LPWSTR)0x0) {
              if (local_2b4 == 0x20) {
                FUN_18000b370(local_358,0x104,(longlong)L"wowexec.pif");
LAB_18003e16e:
                iVar10 = (int)uVar16;
                pwVar17 = wcsrchr(local_358,L'\\');
                if (pwVar17 == (wchar_t *)0x0) {
                  pwVar17 = wcsrchr(local_358,L':');
                }
                if (pwVar17 != (wchar_t *)0x0) {
                  while( true ) {
                    pwVar17 = pwVar17 + 1;
                    wVar2 = *pwVar17;
                    iVar10 = (int)uVar16;
                    if (((ushort)wVar2 < 0x21) &&
                       ((0x100000201U >> ((ulonglong)(ushort)wVar2 & 0x3f) & 1) != 0)) break;
                    local_358[uVar16] = wVar2;
                    uVar16 = (ulonglong)(iVar10 + 1);
                  }
                  local_358[uVar16] = L'\0';
                }
                if (iVar10 != 0) {
                  DVar9 = SearchPathW((LPCWSTR)0x0,local_358,(LPCWSTR)&local_268,0x104,local_340,
                                      (LPWSTR *)0x0);
                  if (0x103 < DVar9) goto LAB_18003ed00;
                  if (DVar9 != 0) goto LAB_18003e247;
                }
                *local_340 = L'\0';
LAB_18003e247:
                lpFileName = local_280;
                if (local_280 == (LPCWSTR)0x0) {
                  lpFileName = (LPCWSTR)0x20a;
                  uVar22 = RtlGetCurrentDirectory_U(0x20a,local_258);
                  if (0x209 < ((ulonglong)uVar22 & 0xfffffffffffffffe)) {
                    __report_rangecheckfailure();
                    goto LAB_18003e365;
                  }
                  *(undefined2 *)((longlong)local_258 + ((ulonglong)uVar22 & 0xfffffffffffffffe)) =
                       0;
                  pwVar17 = (wchar_t *)0x105;
                  DVar9 = GetShortPathNameW(local_258,local_258,0x105);
                  if (0x105 < DVar9) goto LAB_18003ed00;
                  if (DVar9 == 0) {
                    RtlInitUnicodeString();
                    DVar9 = (DWORD)(local_350 >> 1);
                  }
                  else {
                    local_350 = (short)DVar9 * 2;
                    local_348 = local_258;
                    local_34e = 0x20a;
                  }
                  if (DVar9 - 2 < 0x41) {
                    pwVar17 = (wchar_t *)((ulonglong)pwVar17 & 0xffffffffffffff00 | 1);
                    local_378 = RtlUnicodeStringToAnsiString(local_338,&local_350,pwVar17);
                  }
                  else {
                    local_378 = -0x3ffffff3;
                  }
                  if (local_378 < 0) goto LAB_18003ed00;
LAB_18003e423:
                  lVar20 = 0;
                  if (*local_330 < '[') {
                    sVar19 = *local_330 + -0x41;
                  }
                  else {
                    sVar19 = *local_330 + -0x61;
                  }
                  *(short *)(param_6 + 0xec) = sVar19;
                  if ((param_9 != 0) && ((*(uint *)(param_9 + 0x3c) & 0x200) != 0)) {
                    if (*(longlong *)(param_9 + 8) != 0) {
                      lVar20 = -1;
                      do {
                        lVar20 = lVar20 + 1;
                      } while (*(short *)(*(longlong *)(param_9 + 8) + lVar20 * 2) != 0);
                    }
                    uVar22 = (int)lVar20 * 2 + 0x2a;
                    piVar13 = (int *)KernelBaseGetGlobalData();
                    pwVar17 = (wchar_t *)(ulonglong)uVar22;
                    pwVar18 = (wchar_t *)
                              RtlAllocateHeap(*(undefined8 *)
                                               (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                              *piVar13 + 0x200000,pwVar17);
                    local_2a8 = pwVar18;
                    if (pwVar18 != (wchar_t *)0x0) {
                      pwVar17 = L"hotkey.%u %s";
                      FUN_180017608(pwVar18,(ulonglong)uVar22,L"hotkey.%u %s",
                                    (ulonglong)*(uint *)(param_9 + 0x50));
                      *(uint *)(param_9 + 0x3c) = *(uint *)(param_9 + 0x3c) & 0xfffffdff;
                      *(undefined8 *)(param_9 + 0x50) = 0;
                      *(wchar_t **)(param_9 + 8) = pwVar18;
                    }
                  }
                  iVar10 = (local_328[0] + 6 & 0xfffffffc) + (local_310[0] + 4 & 0xfffffffc);
                  if (*local_2a0 != 0) {
                    iVar23 = 3;
                    iVar10 = iVar10 + (*local_2a0 + 3 & 0xfffffffc);
                  }
                  if (local_338[0] != 0) {
                    iVar23 = iVar23 + 1;
                    iVar10 = iVar10 + (local_338[0] + 4 & 0xfffffffc);
                  }
                  if (*local_340 != L'\0') {
                    iVar23 = iVar23 + 1;
                    RtlInitUnicodeString(&local_350,local_340);
                    pwVar17 = (wchar_t *)((ulonglong)pwVar17 & 0xffffffffffffff00 | 1);
                    iVar11 = RtlUnicodeStringToAnsiString(local_300,&local_350,pwVar17);
                    if (iVar11 < 0) goto LAB_18003ed00;
                    iVar10 = iVar10 + (local_300[0] + 4 & 0xfffffffc);
                  }
                  iVar11 = iVar23;
                  if (param_9 != 0) {
                    iVar10 = iVar10 + 0x68;
                    iVar11 = iVar23 + 1;
                    if (*(longlong *)(param_9 + 0x10) != 0) {
                      iVar11 = iVar23 + 2;
                      RtlInitUnicodeString(&local_350);
                      pwVar17 = (wchar_t *)((ulonglong)pwVar17 & 0xffffffffffffff00 | 1);
                      iVar23 = RtlUnicodeStringToAnsiString(local_2f0,&local_350,pwVar17);
                      if (iVar23 < 0) goto LAB_18003ed00;
                      iVar10 = iVar10 + (local_2f0[0] + 4 & 0xfffffffc);
                    }
                    if (*(longlong *)(param_9 + 0x18) != 0) {
                      iVar11 = iVar11 + 1;
                      RtlInitUnicodeString(&local_350);
                      pwVar17 = (wchar_t *)((ulonglong)pwVar17 & 0xffffffffffffff00 | 1);
                      iVar23 = RtlUnicodeStringToOemString(local_2e0,&local_350,pwVar17);
                      if (iVar23 < 0) goto LAB_18003ed00;
                      iVar10 = iVar10 + (local_2e0[0] + 4 & 0xfffffffc);
                    }
                    if (*(longlong *)(param_9 + 8) != 0) {
                      iVar11 = iVar11 + 1;
                      RtlInitUnicodeString(&local_350);
                      iVar23 = RtlUnicodeStringToAnsiString
                                         (local_2d0,&local_350,
                                          (ulonglong)pwVar17 & 0xffffffffffffff00 | 1);
                      if (iVar23 < 0) goto LAB_18003ed00;
                      iVar10 = iVar10 + (local_2d0[0] + 4 & 0xfffffffc);
                    }
                  }
                  if (local_298 != 0) {
                    iVar11 = iVar11 + 1;
                    uVar15 = FUN_18003f87c(local_298,&local_290);
                    if ((int)uVar15 < 0) goto LAB_18003ed00;
                    iVar10 = iVar10 + 8;
                  }
                  lVar20 = CsrAllocateCaptureBuffer(iVar11,iVar10);
                  if (lVar20 != 0) {
                    ppvVar1 = (void **)(param_6 + 0x80);
                    CsrAllocateMessagePointer(lVar20,local_328[0] + 6 & 0xfffffffc);
                    RtlMoveMemory(*ppvVar1,local_320,(ulonglong)local_328[0]);
                    *(undefined *)((ulonglong)local_328[0] + (longlong)*ppvVar1) = 0xd;
                    *(undefined *)((ulonglong)local_328[0] + 1 + (longlong)*ppvVar1) = 10;
                    *(undefined *)((ulonglong)local_328[0] + 2 + (longlong)*ppvVar1) = 0;
                    *(ushort *)(param_6 + 0xe4) = local_328[0] + 3;
                    CsrAllocateMessagePointer(lVar20,local_310[0] + 4 & 0xfffffffc);
                    RtlMoveMemory(*(void **)(param_6 + 0x88),local_308,(ulonglong)local_310[0]);
                    *(undefined *)((ulonglong)local_310[0] + (longlong)*(void **)(param_6 + 0x88)) =
                         0;
                    *(ushort *)(param_6 + 0xe6) = local_310[0] + 1;
                    if (local_2f8 == (void *)0x0) {
                      *(undefined2 *)(param_6 + 0xe8) = 0;
                      *(undefined8 *)(param_6 + 0x90) = 0;
                    }
                    else {
                      CsrAllocateMessagePointer(lVar20,local_300[0] + 4 & 0xfffffffc);
                      RtlMoveMemory(*(void **)(param_6 + 0x90),local_2f8,(ulonglong)local_300[0]);
                      *(undefined *)((ulonglong)local_300[0] + *(longlong *)(param_6 + 0x90)) = 0;
                      *(ushort *)(param_6 + 0xe8) = local_300[0] + 1;
                    }
                    puVar5 = local_2a0;
                    if (*local_2a0 == 0) {
                      *(undefined4 *)(param_6 + 0xa8) = 0;
                      *(undefined8 *)(param_6 + 0xa0) = 0;
                    }
                    else {
                      CsrAllocateMessagePointer(lVar20,*local_2a0 + 3 & 0xfffffffc);
                      RtlMoveMemory(*(void **)(param_6 + 0xa0),*(void **)(puVar5 + 4),
                                    (ulonglong)*puVar5);
                      *(uint *)(param_6 + 0xa8) = (uint)*puVar5;
                    }
                    if (local_338[0] == 0) {
                      *(undefined8 *)(param_6 + 0x98) = 0;
                      *(undefined2 *)(param_6 + 0xea) = 0;
                    }
                    else {
                      CsrAllocateMessagePointer(lVar20,local_338[0] + 4 & 0xfffffffc);
                      RtlMoveMemory(*(void **)(param_6 + 0x98),local_330,(ulonglong)local_338[0]);
                      *(undefined *)((ulonglong)local_338[0] + *(longlong *)(param_6 + 0x98)) = 0;
                      *(ushort *)(param_6 + 0xea) = local_338[0] + 1;
                    }
                    if (param_9 == 0) {
                      *(undefined8 *)(param_6 + 0xb0) = 0;
                    }
                    else {
                      CsrAllocateMessagePointer(lVar20,0x68,(undefined8 *)(param_6 + 0xb0));
                      *(undefined4 *)(*(longlong *)(param_6 + 0xb0) + 0x20) =
                           *(undefined4 *)(param_9 + 0x20);
                      *(undefined4 *)(*(longlong *)(param_6 + 0xb0) + 0x24) =
                           *(undefined4 *)(param_9 + 0x24);
                      *(undefined4 *)(*(longlong *)(param_6 + 0xb0) + 0x28) =
                           *(undefined4 *)(param_9 + 0x28);
                      *(undefined4 *)(*(longlong *)(param_6 + 0xb0) + 0x2c) =
                           *(undefined4 *)(param_9 + 0x2c);
                      *(undefined4 *)(*(longlong *)(param_6 + 0xb0) + 0x30) =
                           *(undefined4 *)(param_9 + 0x30);
                      *(undefined4 *)(*(longlong *)(param_6 + 0xb0) + 0x34) =
                           *(undefined4 *)(param_9 + 0x34);
                      *(undefined4 *)(*(longlong *)(param_6 + 0xb0) + 0x38) =
                           *(undefined4 *)(param_9 + 0x38);
                      *(undefined4 *)(*(longlong *)(param_6 + 0xb0) + 0x3c) =
                           *(undefined4 *)(param_9 + 0x3c);
                      *(undefined2 *)(*(longlong *)(param_6 + 0xb0) + 0x40) =
                           *(undefined2 *)(param_9 + 0x40);
                      **(undefined4 **)(param_6 + 0xb0) = 0x68;
                    }
                    if (local_2e8 == (void *)0x0) {
                      *(undefined8 *)(param_6 + 0xb8) = 0;
                      *(undefined4 *)(param_6 + 0xc0) = 0;
                    }
                    else {
                      CsrAllocateMessagePointer(lVar20,local_2f0[0] + 4 & 0xfffffffc);
                      RtlMoveMemory(*(void **)(param_6 + 0xb8),local_2e8,(ulonglong)local_2f0[0]);
                      *(undefined *)((ulonglong)local_2f0[0] + *(longlong *)(param_6 + 0xb8)) = 0;
                      *(uint *)(param_6 + 0xc0) = local_2f0[0] + 1;
                    }
                    if (local_2d8 == (void *)0x0) {
                      *(undefined8 *)(param_6 + 200) = 0;
                      *(undefined4 *)(param_6 + 0xd0) = 0;
                    }
                    else {
                      CsrAllocateMessagePointer(lVar20,local_2e0[0] + 4 & 0xfffffffc);
                      RtlMoveMemory(*(void **)(param_6 + 200),local_2d8,(ulonglong)local_2e0[0]);
                      *(undefined *)((ulonglong)local_2e0[0] + *(longlong *)(param_6 + 200)) = 0;
                      *(uint *)(param_6 + 0xd0) = local_2e0[0] + 1;
                    }
                    if (local_2c8 == (void *)0x0) {
                      *(undefined8 *)(param_6 + 0xd8) = 0;
                      *(undefined4 *)(param_6 + 0xe0) = 0;
                    }
                    else {
                      CsrAllocateMessagePointer(lVar20,local_2d0[0] + 4 & 0xfffffffc);
                      RtlMoveMemory(*(void **)(param_6 + 0xd8),local_2c8,(ulonglong)local_2d0[0]);
                      *(undefined *)((ulonglong)local_2d0[0] + *(longlong *)(param_6 + 0xd8)) = 0;
                      *(uint *)(param_6 + 0xe0) = local_2d0[0] + 1;
                    }
                    if (local_298 == 0) {
                      *(undefined8 *)(param_6 + 0xf0) = 0;
                    }
                    else {
                      CsrAllocateMessagePointer(lVar20,8,(undefined8 *)(param_6 + 0xf0));
                      **(undefined8 **)(param_6 + 0xf0) = local_290;
                    }
                    uVar22 = local_2b4;
                    if (local_2b4 == 0x20) {
                      *(undefined8 *)(param_6 + 0x48) = 0xffffffffffffffff;
                    }
                    else if (bVar4) {
                      *(undefined8 *)(param_6 + 0x48) = 0;
                    }
                    else {
                      uVar15 = FUN_18001ffe0();
                      *(ulonglong *)(param_6 + 0x48) = uVar15;
                    }
                    *(undefined2 *)(param_6 + 0xee) = 0;
                    *(uint *)(param_6 + 0x50) = uVar22;
                    UVar12 = GetConsoleCP();
                    *(UINT *)(param_6 + 0x78) = UVar12;
                    *(uint *)(param_6 + 0x7c) = param_8;
                    iVar23 = CsrClientCallServer(param_6,lVar20,0x10010005,0xb8);
                    if ((iVar23 == -0x3fffffde) && (*(int *)(param_6 + 0xc0) == 0)) {
                      CsrFreeCaptureBuffer(lVar20);
                    }
                    else {
                      CsrFreeCaptureBuffer(lVar20);
                      if ((-1 < iVar23) && (-1 < *(int *)(param_6 + 0x34))) {
                        *local_278 = *(undefined4 *)(param_6 + 0x40);
                      }
                    }
                  }
                }
                else {
LAB_18003e365:
                  pWVar14 = local_258;
                  uVar22 = GetFullPathNameW(lpFileName,0x105,pWVar14,(LPWSTR *)0x0);
                  if (uVar22 - 1 < 0x105) {
                    pWVar14 = (LPWSTR)0x105;
                    uVar22 = GetShortPathNameW(local_258,local_258,0x105);
                  }
                  if (uVar22 < 0x106) {
                    if (uVar22 == 0) {
                      RtlInitUnicodeString(&local_350,lpFileName);
                    }
                    else {
                      local_348 = local_258;
                      local_350 = (short)uVar22 * 2;
                      local_34e = 0x20a;
                    }
                    pwVar17 = (wchar_t *)((ulonglong)pWVar14 & 0xffffffffffffff00 | 1);
                    iVar10 = RtlUnicodeStringToAnsiString(local_338,&local_350,pwVar17);
                    if ((-1 < iVar10) && (local_338[0] < 0x43)) goto LAB_18003e423;
                  }
                }
              }
              else if ((uint)uVar15 < 0x104) {
                FUN_18000b370(local_358,0x104,(longlong)local_2b0);
                pwVar17 = wcsrchr(local_358,L'.');
                if ((pwVar17 != (wchar_t *)0x0) &&
                   (4 < ((longlong)local_358 - (longlong)pwVar17 >> 1) + 0x104U)) {
                  FUN_1800176c8(pwVar17,10,(longlong)&local_268);
                  DVar9 = GetFileAttributesW(local_358);
                  if ((DVar9 != 0xffffffff) && ((DVar9 & 0x10) == 0)) {
                    lVar20 = -1;
                    do {
                      lVar20 = lVar20 + 1;
                    } while (local_358[lVar20] != L'\0');
                    uVar22 = (int)lVar20 + 1;
                    uVar16 = (ulonglong)uVar22;
                    FUN_180007094(local_340,0x104,(longlong)local_358,(ulonglong)uVar22);
                  }
                  if ((int)uVar16 == 0) goto LAB_18003e16e;
                  goto LAB_18003e247;
                }
              }
            }
          }
        }
      }
    }
  }
LAB_18003ed00:
  if (local_358 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_358);
  }
  if (local_340 != (LPWSTR)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_340);
  }
  if (local_320 != (void *)0x0) {
    RtlFreeOemString(local_328);
  }
  if (local_308 != (char *)0x0) {
    RtlFreeOemString(local_310);
  }
  if (local_2f8 != (void *)0x0) {
    RtlFreeAnsiString(local_300);
  }
  if (local_330 != (char *)0x0) {
    RtlFreeAnsiString(local_338);
  }
  if (local_2e8 != (void *)0x0) {
    RtlFreeAnsiString(local_2f0);
  }
  if (local_2d8 != (void *)0x0) {
    RtlFreeAnsiString(local_2e0);
  }
  if (local_2c8 != (void *)0x0) {
    RtlFreeAnsiString(local_2d0);
  }
  if (local_318 != (LPWSTR)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_318);
  }
  if (local_2a8 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_2a8);
  }
LAB_18003ee99:
  __security_check_cookie(local_48 ^ (ulonglong)auStackY936);
  return;
}



void FUN_18003eebd(undefined8 param_1,longlong param_2)

{
  longlong in_GS_OFFSET;
  
  if (*(longlong *)(param_2 + 0x50) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x50));
  }
  if (*(longlong *)(param_2 + 0x68) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x68));
  }
  if (*(longlong *)(param_2 + 0x88) != 0) {
    RtlFreeOemString(param_2 + 0x80);
  }
  if (*(longlong *)(param_2 + 0xa0) != 0) {
    RtlFreeOemString(param_2 + 0x98);
  }
  if (*(longlong *)(param_2 + 0xb0) != 0) {
    RtlFreeAnsiString(param_2 + 0xa8);
  }
  if (*(longlong *)(param_2 + 0x78) != 0) {
    RtlFreeAnsiString(param_2 + 0x70);
  }
  if (*(longlong *)(param_2 + 0xc0) != 0) {
    RtlFreeAnsiString(param_2 + 0xb8);
  }
  if (*(longlong *)(param_2 + 0xd0) != 0) {
    RtlFreeAnsiString(param_2 + 200);
  }
  if (*(longlong *)(param_2 + 0xe0) != 0) {
    RtlFreeAnsiString(param_2 + 0xd8);
  }
  if (*(longlong *)(param_2 + 0x90) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x90));
  }
  if (*(longlong *)(param_2 + 0x100) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x100));
  }
  return;
}



int FUN_18003f048(wchar_t *param_1,undefined (*param_2) [16],undefined (*param_3) [16])

{
  wchar_t *pwVar1;
  WCHAR WVar2;
  int iVar3;
  DWORD DVar4;
  ulonglong uVar5;
  wchar_t *pwVar6;
  LPCWSTR lpszLongPath;
  uint uVar7;
  short sVar8;
  WCHAR *lpszShortPath;
  int iVar9;
  longlong lVar10;
  LPCWSTR pWVar12;
  longlong in_GS_OFFSET;
  int iVar13;
  wchar_t *local_60;
  WCHAR *local_58;
  longlong lVar11;
  
  iVar9 = 0;
  local_60 = (wchar_t *)0x0;
  local_58 = (WCHAR *)0x0;
  iVar13 = 0;
  if ((param_2 == (undefined (*) [16])0x0) || (param_3 == (undefined (*) [16])0x0)) {
    RtlSetLastWin32Error(0x57);
    iVar13 = 0;
  }
  else {
    pwVar6 = param_1;
    pwVar1 = param_1;
    if ((param_1 == (wchar_t *)0x0) &&
       (iVar3 = RtlCreateEnvironment(1), pwVar6 = local_60, pwVar1 = local_60, iVar3 < 0)) {
      BaseSetLastNTError();
      local_60 = (wchar_t *)0x0;
    }
    else {
      while ((local_60 = pwVar1, *pwVar6 != L'\0' || (pwVar6[1] != L'\0'))) {
        iVar9 = iVar9 + 1;
        pwVar6 = pwVar6 + 1;
        pwVar1 = local_60;
      }
      uVar5 = (ulonglong)(iVar9 + 0x106) * 2;
      if ((uVar5 < 0x10000) &&
         (local_58 = (WCHAR *)RtlAllocateHeap(*(undefined8 *)
                                               (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,uVar5),
         local_58 != (WCHAR *)0x0)) {
        iVar9 = 0x102;
        pWVar12 = local_60;
        lpszShortPath = local_58;
        while (WVar2 = *pWVar12, WVar2 != L'\0') {
          lpszLongPath = pWVar12;
          if (WVar2 == L'=') {
            WVar2 = pWVar12[1];
            if (((((ushort)(WVar2 + L'﾿') < 0x1a) || ((ushort)(WVar2 + L'ﾟ') < 0x1a)) &&
                (pWVar12[2] == L':')) && (pWVar12[3] == L'=')) {
              uVar5 = 0xffffffffffffffff;
              do {
                uVar5 = uVar5 + 1;
              } while (pWVar12[uVar5] != L'\0');
              if ((6 < uVar5) &&
                 ((((pWVar12[7] != L'\0' || ((pWVar12[6] != L'\\' && (pWVar12[6] != L'/')))) ||
                   (pWVar12[5] != L':')) ||
                  ((0x19 < (ushort)(pWVar12[4] + L'﾿') && (0x19 < (ushort)(pWVar12[4] + L'ﾟ'))))
                  ))) {
                *lpszShortPath = L'=';
                lpszShortPath[1] = pWVar12[1];
                lpszShortPath[2] = pWVar12[2];
                lpszShortPath[3] = pWVar12[3];
                lpszShortPath = lpszShortPath + 4;
                iVar3 = 2;
                lpszLongPath = pWVar12 + 4;
                goto LAB_18003f2c8;
              }
            }
            iVar3 = 1;
          }
          else {
            while (WVar2 != L'\0') {
              *lpszShortPath = WVar2;
              lpszShortPath = lpszShortPath + 1;
              lpszLongPath = lpszLongPath + 1;
              if (WVar2 == L'=') break;
              WVar2 = *lpszLongPath;
            }
            iVar3 = FUN_18003f6a4(pWVar12,(int)((longlong)lpszLongPath - (longlong)pWVar12 >> 1) - 1
                                 );
          }
LAB_18003f2c8:
          if (iVar3 == 1) {
            do {
              WVar2 = *lpszLongPath;
              *lpszShortPath = WVar2;
              lpszShortPath = lpszShortPath + 1;
              lpszLongPath = lpszLongPath + 1;
              pWVar12 = lpszLongPath;
            } while (WVar2 != L'\0');
          }
          else {
            pWVar12 = lpszLongPath;
            if (iVar3 == 2) {
              lVar10 = -1;
              do {
                lVar11 = lVar10;
                lVar10 = lVar11 + 1;
              } while (lpszLongPath[lVar10] != L'\0');
              uVar7 = (int)lVar11 + 2;
              DVar4 = GetShortPathNameW(lpszLongPath,lpszShortPath,uVar7 + iVar9);
              if ((DVar4 == 0) || (uVar7 + iVar9 <= DVar4)) {
                RtlMoveMemory(lpszShortPath,lpszLongPath,(ulonglong)uVar7 * 2);
                DVar4 = (DWORD)lVar10;
              }
              lpszShortPath = lpszShortPath + (DVar4 + 1);
              pWVar12 = lpszLongPath + uVar7;
              if (uVar7 < DVar4) {
                iVar9 = iVar9 + (uVar7 - DVar4);
              }
            }
            else {
              while (*lpszLongPath != L'\0') {
                if (*lpszLongPath == L';') {
                  uVar5 = (longlong)lpszLongPath - (longlong)pWVar12 >> 1;
                  uVar7 = (uint)uVar5;
                  if (uVar7 != 0) {
                    *lpszLongPath = L'\0';
                    DVar4 = GetShortPathNameW(pWVar12,lpszShortPath,uVar7 + iVar9 + 1);
                    if ((DVar4 == 0) || (uVar7 + iVar9 < DVar4)) {
                      RtlMoveMemory(lpszShortPath,pWVar12,(uVar5 & 0xffffffff) * 2);
                      DVar4 = uVar7;
                    }
                    *lpszLongPath = L';';
                    lpszShortPath[DVar4] = L';';
                    lpszShortPath = lpszShortPath + DVar4 + 1;
                    lpszLongPath = lpszLongPath + 1;
                    if (uVar7 < DVar4) {
                      iVar9 = iVar9 + (uVar7 - DVar4);
                    }
                  }
                  for (; pWVar12 = lpszLongPath, *lpszLongPath == L';';
                      lpszLongPath = lpszLongPath + 1) {
                    *lpszShortPath = L';';
                    lpszShortPath = lpszShortPath + 1;
                  }
                }
                else {
                  lpszLongPath = lpszLongPath + 1;
                }
              }
              uVar5 = (longlong)lpszLongPath - (longlong)pWVar12 >> 1;
              uVar7 = (uint)uVar5;
              if (uVar7 != 0) {
                DVar4 = GetShortPathNameW(pWVar12,lpszShortPath,iVar9 + 1 + uVar7);
                if ((DVar4 == 0) || (uVar7 < DVar4)) {
                  RtlMoveMemory(lpszShortPath,pWVar12,(uVar5 & 0xffffffff) * 2);
                  DVar4 = uVar7;
                }
                lpszShortPath = lpszShortPath + DVar4;
                if (uVar7 < DVar4) {
                  iVar9 = iVar9 + (uVar7 - DVar4);
                }
              }
              *lpszShortPath = *lpszLongPath;
              lpszShortPath = lpszShortPath + 1;
              pWVar12 = lpszLongPath + 1;
            }
          }
        }
        *lpszShortPath = L'\0';
        sVar8 = (short)(lpszShortPath + 1) - (short)local_58;
        *(short *)*param_3 = sVar8;
        *(short *)(*param_3 + 2) = sVar8;
        iVar9 = RtlCreateEnvironmentEx
                          (local_58,*param_3 + 8,0,0x3d,iVar13,pWVar12,lpszShortPath + 1);
        if (iVar9 < 0) {
          BaseSetLastNTError();
        }
        else {
          iVar9 = RtlUnicodeStringToAnsiString(param_2,param_3,1);
          if (iVar9 < 0) {
            RtlDestroyEnvironment(*(undefined8 *)(*param_3 + 8));
            BaseSetLastNTError();
          }
          else {
            iVar13 = 1;
          }
        }
      }
      else {
        BaseSetLastNTError();
      }
    }
    if ((param_1 == (wchar_t *)0x0) && (local_60 != (wchar_t *)0x0)) {
      RtlDestroyEnvironment();
    }
    if (local_58 != (WCHAR *)0x0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_58);
    }
    if (iVar13 == 0) {
      *param_3 = ZEXT816(0);
      *param_2 = ZEXT816(0);
    }
  }
  return iVar13;
}



void FUN_18003f5d5(undefined8 param_1,longlong param_2)

{
  longlong in_GS_OFFSET;
  
  if ((*(longlong *)(param_2 + 0xa0) == 0) && (*(longlong *)(param_2 + 0x38) != 0)) {
    RtlDestroyEnvironment();
  }
  if (*(longlong *)(param_2 + 0x40) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x40));
  }
  if (*(int *)(param_2 + 0x20) == 0) {
    **(undefined (**) [16])(param_2 + 0xb0) = ZEXT816(0);
    **(undefined (**) [16])(param_2 + 0xa8) = ZEXT816(0);
  }
  return;
}



undefined8 BaseDestroyVDMEnvironment(longlong param_1,longlong param_2)

{
                    // 0x3f660  49  BaseDestroyVDMEnvironment
  if (*(longlong *)(param_1 + 8) != 0) {
    RtlFreeAnsiString();
  }
  if (*(longlong *)(param_2 + 8) != 0) {
    RtlDestroyEnvironment();
  }
  return 1;
}



undefined4 FUN_18003f6a4(wchar_t *param_1,uint param_2)

{
  int iVar1;
  undefined **ppuVar2;
  int iVar3;
  
  ppuVar2 = &PTR_u_PATH_1800b2048;
  iVar3 = 0;
  while ((*(uint *)((longlong)ppuVar2 + -4) != param_2 ||
         (iVar1 = _wcsnicmp((wchar_t *)*ppuVar2,param_1,(ulonglong)param_2), iVar1 != 0))) {
    iVar3 = iVar3 + 1;
    ppuVar2 = (undefined **)((wchar_t **)ppuVar2 + 2);
    if (0x1800b2097 < (longlong)ppuVar2) {
      return 1;
    }
  }
  return (&DAT_1800b2040)[(longlong)iVar3 * 4];
}



void FUN_18003f738(undefined8 param_1,uint param_2,int param_3,undefined8 param_4)

{
  ushort uVar1;
  uint uVar2;
  undefined6 extraout_var;
  undefined auStack1656 [32];
  undefined *local_658;
  undefined *local_650;
  int local_648;
  undefined local_638 [528];
  wchar_t local_428 [520];
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack1656;
  RtlFreeUnicodeString(param_4);
  uVar1 = FUN_18001ae0c(local_638,0x104);
  if ((int)CONCAT62(extraout_var,uVar1) - 1U < 0x103) {
    uVar2 = param_3 - 0x40U & 0xffffffbf;
    if (param_2 == 0) {
      local_658 = &DAT_180088780;
      local_650 = (undefined *)
                  ((ulonglong)local_650 & 0xffffffff00000000 |
                  (ulonglong)~-(uint)(uVar2 != 0) & 0xffffffff00000073);
      if (param_3 == 0x10) {
        local_658 = &DAT_180085634;
      }
      FUN_180017608(local_428,0x410,L"\"%s\\ntvdm.exe\"  %s%c",local_638);
    }
    else {
      local_650 = &DAT_180088780;
      local_648 = (-(uint)(uVar2 != 0) & 0xffffffad) + 0x73;
      if (param_3 == 0x10) {
        local_650 = &DAT_180085634;
      }
      local_658 = (undefined *)((ulonglong)local_658 & 0xffffffff00000000 | (ulonglong)param_2);
      FUN_180017608(local_428,0x410,L"\"%s\\ntvdm.exe\" -i%lx %s%c",local_638);
    }
    RtlCreateUnicodeString(param_4,local_428);
  }
  else {
    RtlSetLastWin32Error(0x7b);
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack1656);
  return;
}



ulonglong FUN_18003f87c(undefined8 param_1,undefined8 *param_2)

{
  uint uVar1;
  ulonglong uVar2;
  int *piVar3;
  longlong lVar4;
  longlong in_GS_OFFSET;
  undefined4 local_res18 [4];
  
  uVar2 = NtQueryInformationToken(param_1,10,0,0,local_res18);
  if ((int)uVar2 == -0x3fffffdd) {
    piVar3 = (int *)KernelBaseGetGlobalData();
    lVar4 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                            *piVar3 + 0x200000,local_res18[0]);
    if (lVar4 == 0) {
      uVar2 = 0xc0000023;
    }
    else {
      uVar1 = NtQueryInformationToken(param_1,10,lVar4,local_res18[0],local_res18);
      uVar2 = (ulonglong)uVar1;
      if ((-1 < (int)uVar1) && (param_2 != (undefined8 *)0x0)) {
        *param_2 = *(undefined8 *)(lVar4 + 8);
      }
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lVar4);
    }
  }
  return uVar2;
}



uint FUN_18003f96c(longlong param_1)

{
  uint in_EAX;
  int local_res8 [8];
  undefined local_18 [24];
  
  if ((param_1 != 0) &&
     (in_EAX = NtQueryVolumeInformationFile(param_1,local_18,local_res8,8,4), -1 < (int)in_EAX)) {
    return in_EAX & 0xffffff00 | (uint)(local_res8[0] == 0x50);
  }
  return in_EAX & 0xffffff00;
}



void BaseUpdateVDMEntry(int param_1,undefined8 *param_2,int param_3,int param_4)

{
  int iVar1;
  undefined auStack1016 [32];
  undefined local_3d8 [52];
  int local_3a4;
  int local_398;
  int local_394;
  ulonglong local_390;
  undefined8 local_388;
  undefined8 local_380;
  undefined2 local_378;
  undefined2 local_376;
  ulonglong local_18;
  
                    // 0x3f9c0  72  BaseUpdateVDMEntry
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack1016;
  if (param_1 == 0) {
    local_398 = *(int *)param_2;
    local_376 = (undefined2)param_3;
  }
  else if (param_1 == 1) {
    local_388 = *param_2;
    local_398 = param_3;
  }
  if (param_4 == 0x20) {
    local_390 = 0xffffffffffffffff;
  }
  else if (local_398 == 0) {
    local_390 = FUN_18001ffe0();
  }
  else {
    local_390 = 0;
  }
  local_378 = (undefined2)param_1;
  local_394 = param_4;
  iVar1 = CsrClientCallServer(local_3d8,0,0x10010006,0x28);
  if ((iVar1 < 0) || (local_3a4 < 0)) {
    BaseSetLastNTError();
  }
  else if (param_1 == 1) {
    *param_2 = local_380;
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack1016);
  return;
}



undefined8 FUN_18003fac0(LPCWSTR param_1)

{
  LSTATUS LVar1;
  undefined8 uVar2;
  DWORD local_res10 [2];
  ulonglong local_res18;
  longlong local_res20;
  HKEY local_38;
  HKEY local_30;
  _FILETIME local_28;
  ulonglong local_20;
  
  local_res18 = 0;
  local_res20 = 0;
  uVar2 = 1;
  LVar1 = RegOpenKeyExW((HKEY)0xffffffff80000001,L"SYSTEM\\CurrentControlSet\\Control\\WOW",0,
                        0x20019,&local_30);
  if (LVar1 == 0) {
    local_res10[0] = 8;
    RegGetValueW(local_30,(LPCWSTR)0x0,L"UTCLimitTimeout",0x20000048,(LPDWORD)0x0,&local_res20,
                 local_res10);
    if (local_res20 != 0) {
      LVar1 = RegOpenKeyExW(local_30,L"UTCLimit",0,0x2001b,&local_38);
      if (LVar1 == 0) {
        local_res10[0] = 8;
        RegGetValueW(local_38,(LPCWSTR)0x0,param_1,0x20000048,(LPDWORD)0x0,&local_res18,local_res10)
        ;
        GetSystemTimeAsFileTime(&local_28);
        local_20 = CONCAT44(local_28.dwHighDateTime,local_28.dwLowDateTime);
        if ((local_res18 < local_20) &&
           ((ulonglong)(local_res20 * 10000000) < local_20 - local_res18)) {
          RegSetValueExW(local_38,param_1,0,0xb,(BYTE *)&local_20,8);
        }
        else {
          uVar2 = 0;
        }
        RegCloseKey(local_38);
      }
    }
    RegCloseKey(local_30);
  }
  return uVar2;
}



void ExitVDM(int param_1,uint param_2)

{
  int iVar1;
  undefined auStack1016 [32];
  undefined local_3d8 [64];
  ulonglong local_398;
  uint local_390;
  longlong local_388;
  ulonglong local_18;
  
                    // 0x3fc60  362  ExitVDM
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack1016;
  local_398 = FUN_18001ffe0();
  local_388 = 0;
  local_390 = -(uint)(param_1 != 0) & param_2;
  iVar1 = CsrClientCallServer(local_3d8,0,0x10010008,0x18);
  if ((-1 < iVar1) && (local_388 != 0)) {
    NtClose();
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack1016);
  return;
}



DWORD GetLongPathNameTransactedA
                (LPCSTR lpszShortPath,LPSTR lpszLongPath,DWORD cchBuffer,HANDLE hTransaction)

{
  DWORD DVar1;
  longlong lVar2;
  undefined8 uVar3;
  
                    // 0x3fd00  630  GetLongPathNameTransactedA
  if ((longlong)hTransaction - 1U < 0xfffffffffffffffe) {
    lVar2 = RtlGetCurrentTransaction();
    if (lVar2 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      DVar1 = GetLongPathNameA(lpszShortPath,lpszLongPath,cchBuffer);
      RtlSetCurrentTransaction(0);
      return DVar1;
    }
    uVar3 = 0x1a45;
  }
  else {
    uVar3 = 0x1a2c;
  }
  RtlSetLastWin32Error(uVar3);
  return 0;
}



void FUN_18003fda8(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003fdb8. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlSetCurrentTransaction(0);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void GetNextVDMCommand(uint *param_1)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  longlong lVar4;
  uint uVar5;
  uint uVar6;
  ushort uVar7;
  ushort uVar8;
  ushort uVar9;
  ushort uVar10;
  undefined auStack1064 [32];
  longlong local_408;
  undefined4 local_400;
  undefined local_3f8 [52];
  int local_3c4;
  ulonglong local_3b8;
  ulonglong local_3b0;
  longlong local_3a8;
  undefined8 local_3a0;
  undefined8 local_398;
  undefined8 local_390;
  uint local_388;
  uint local_384;
  uint local_380;
  void *local_378;
  void *local_370;
  void *local_368;
  void *local_360;
  void *local_358;
  uint local_350;
  void *local_348;
  void *local_340;
  uint local_338;
  void *local_330;
  uint local_328;
  void *local_320;
  uint local_318;
  undefined2 local_314;
  ushort local_312;
  ushort local_310;
  ushort local_30e;
  ushort local_30c;
  ushort local_30a;
  undefined local_308;
  ulonglong local_38;
  
                    // 0x3fdd0  657  GetNextVDMCommand
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack1064;
  lVar4 = 0;
  uVar2 = 0;
  if (param_1 == (uint *)0x0) {
    iVar1 = CsrClientCallServer(local_3f8,0,0x10009,4);
joined_r0x0001800406df:
    if (-1 < iVar1) goto LAB_1800406f5;
  }
  else {
    uVar10 = *(ushort *)(param_1 + 0x3d);
    if (uVar10 == 0) goto LAB_1800406f5;
    if ((uVar10 & 0xd000) == 0) {
      if ((uVar10 - 0x10 & 0xffef) == 0) {
        local_3b8 = FUN_18001ffe0();
        local_3b0 = local_3b0 & 0xffffffff00000000 | (ulonglong)*(ushort *)(param_1 + 0x3d);
        iVar1 = CsrClientCallServer(local_3f8,0,0x1001000b,0x10);
        goto joined_r0x0001800406df;
      }
      local_3b0 = FUN_18001ffe0();
      if ((*(ushort *)(param_1 + 0x3d) & 0x100) == 0) {
        local_3b8 = local_3b8 & 0xffffffff00000000;
      }
      else {
        local_3b8 = local_3b8 & 0xffffffff00000000 | (ulonglong)*param_1;
      }
      local_310 = *(ushort *)((longlong)param_1 + 0xee);
      local_30e = *(ushort *)(param_1 + 0x3c);
      local_312 = *(ushort *)(param_1 + 0x3b);
      local_350 = param_1[0x14];
      local_380 = param_1[2];
      local_3a8 = 0;
      local_338 = param_1[0x32];
      local_328 = param_1[0x36];
      local_318 = param_1[0x3a];
      local_30c = *(ushort *)((longlong)param_1 + 0xf2);
      uVar5 = 0x68;
      iVar1 = 1;
      if (local_312 != 0) {
        uVar5 = (local_312 + 3 & 0xfffffffc) + 0x68;
        iVar1 = 2;
      }
      if (local_310 != 0) {
        uVar5 = uVar5 + (local_310 + 3 & 0xfffffffc);
        iVar1 = iVar1 + 1;
      }
      if (local_30e != 0) {
        uVar5 = uVar5 + (local_30e + 3 & 0xfffffffc);
        iVar1 = iVar1 + 1;
      }
      if (*(longlong *)(param_1 + 0x12) != 0) {
        iVar1 = iVar1 + 1;
        if (local_350 == 0) {
          uVar3 = 4;
        }
        else {
          uVar3 = local_350 + 3 & 0xfffffffc;
        }
        local_30a = uVar10;
        if (uVar3 + uVar5 < uVar5) goto LAB_1800406ee;
      }
      if (local_30c == 0) {
        local_360 = (void *)0x0;
      }
      else {
        iVar1 = iVar1 + 1;
      }
      if (local_338 == 0) {
        local_340 = (void *)0x0;
      }
      else {
        iVar1 = iVar1 + 1;
      }
      if (local_328 == 0) {
        local_330 = (void *)0x0;
      }
      else {
        iVar1 = iVar1 + 1;
      }
      if (local_318 == 0) {
        local_320 = (void *)0x0;
      }
      else {
        iVar1 = iVar1 + 1;
      }
      local_30a = uVar10;
      lVar4 = CsrAllocateCaptureBuffer(iVar1);
      local_408 = lVar4;
      if (lVar4 == 0) goto LAB_1800406ee;
      if (*(longlong *)(param_1 + 10) == 0) {
        local_378 = (void *)0x0;
      }
      else {
        CsrAllocateMessagePointer(lVar4,*(undefined2 *)(param_1 + 0x3b),&local_378);
      }
      if (*(short *)((longlong)param_1 + 0xee) == 0) {
        local_370 = (void *)0x0;
      }
      else {
        CsrAllocateMessagePointer(lVar4,*(short *)((longlong)param_1 + 0xee),&local_370);
      }
      if (*(short *)(param_1 + 0x3c) == 0) {
        local_368 = (void *)0x0;
      }
      else {
        CsrAllocateMessagePointer(lVar4,*(short *)(param_1 + 0x3c),&local_368);
      }
      if (param_1[0x14] == 0) {
        local_358 = (void *)0x0;
      }
      else {
        CsrAllocateMessagePointer(lVar4,param_1[0x14],&local_358);
      }
      if (*(short *)((longlong)param_1 + 0xf2) == 0) {
        local_360 = (void *)0x0;
      }
      else {
        CsrAllocateMessagePointer(lVar4,*(short *)((longlong)param_1 + 0xf2),&local_360);
      }
      CsrAllocateMessagePointer(lVar4,0x68,&local_348);
      if (param_1[0x32] == 0) {
        local_340 = (void *)0x0;
      }
      else {
        CsrAllocateMessagePointer(lVar4,param_1[0x32],&local_340);
      }
      if (param_1[0x36] == 0) {
        local_330 = (void *)0x0;
      }
      else {
        CsrAllocateMessagePointer(lVar4,param_1[0x36],&local_330);
      }
      if (param_1[0x3a] == 0) {
        local_320 = (void *)0x0;
      }
      else {
        CsrAllocateMessagePointer(lVar4,param_1[0x3a],&local_320);
      }
      while (iVar1 = CsrClientCallServer(), local_3a8 != 0) {
        iVar1 = NtWaitForSingleObject(local_3a8,0,0);
        if (iVar1 != 0) goto LAB_18003ff53;
        local_30a = local_30a | 8;
        local_380 = 0;
      }
      if (-1 < iVar1) {
        iVar1 = local_3c4;
      }
      uVar10 = 0;
      if (-1 < iVar1) {
        if (*(short *)(param_1 + 0x3b) != 0) {
          RtlMoveMemory(*(void **)(param_1 + 10),local_378,(ulonglong)local_312);
        }
        if (*(short *)((longlong)param_1 + 0xee) != 0) {
          RtlMoveMemory(*(void **)(param_1 + 0xc),local_370,(ulonglong)local_310);
        }
        if (*(short *)(param_1 + 0x3c) != 0) {
          RtlMoveMemory(*(void **)(param_1 + 0xe),local_368,(ulonglong)local_30e);
        }
        if (*(void **)(param_1 + 0x12) != (void *)0x0) {
          RtlMoveMemory(*(void **)(param_1 + 0x12),local_358,(ulonglong)local_350);
        }
        if (*(short *)((longlong)param_1 + 0xf2) != 0) {
          RtlMoveMemory(*(void **)(param_1 + 0x10),local_360,(ulonglong)local_30c);
        }
        if ((local_30a & 0x200) != 0) {
          RtlMoveMemory(param_1 + 0x16,local_348,0x68);
        }
        if (param_1[0x32] != 0) {
          RtlMoveMemory(*(void **)(param_1 + 0x30),local_340,(ulonglong)local_338);
          *(undefined8 *)(param_1 + 0x1a) = *(undefined8 *)(param_1 + 0x30);
        }
        if (param_1[0x36] != 0) {
          RtlMoveMemory(*(void **)(param_1 + 0x34),local_330,(ulonglong)local_328);
          *(undefined8 *)(param_1 + 0x1c) = *(undefined8 *)(param_1 + 0x34);
        }
        if (param_1[0x3a] != 0) {
          RtlMoveMemory(*(void **)(param_1 + 0x38),local_320,(ulonglong)local_318);
          *(undefined8 *)(param_1 + 0x18) = *(undefined8 *)(param_1 + 0x38);
        }
        *(ushort *)(param_1 + 0x3b) = local_312;
        *(ushort *)((longlong)param_1 + 0xee) = local_310;
        *(ushort *)(param_1 + 0x3c) = local_30e;
        param_1[0x14] = local_350;
        if ((local_30a & 0x200) == 0) {
          *(undefined2 *)(param_1 + 0x3d) = 0;
        }
        else {
          *(undefined2 *)(param_1 + 0x3d) = 0x200;
        }
        *(undefined2 *)((longlong)param_1 + 0xf6) = local_314;
        *(undefined8 *)(param_1 + 4) = local_3a0;
        *(undefined8 *)(param_1 + 6) = local_398;
        *(undefined8 *)(param_1 + 8) = local_390;
        *param_1 = (uint)local_3b8;
        param_1[3] = local_388;
        *(ushort *)((longlong)param_1 + 0xf2) = local_30c;
        param_1[0x32] = local_338;
        param_1[0x36] = local_328;
        param_1[0x3a] = local_318;
        param_1[1] = local_384;
        *(undefined *)(param_1 + 0x3e) = local_308;
        CsrFreeCaptureBuffer(lVar4);
        local_400 = 1;
        goto LAB_1800406f5;
      }
      uVar5 = uVar2;
      uVar3 = uVar2;
      uVar9 = uVar10;
      uVar8 = uVar10;
      uVar7 = uVar10;
      uVar6 = uVar2;
      if (iVar1 == -0x3ffffff3) {
        uVar2 = local_328;
        uVar5 = local_338;
        uVar3 = local_350;
        uVar10 = local_312;
        uVar9 = local_310;
        uVar8 = local_30e;
        uVar7 = local_30c;
        uVar6 = local_318;
      }
      *(ushort *)(param_1 + 0x3b) = uVar10;
      *(ushort *)((longlong)param_1 + 0xee) = uVar9;
      *(ushort *)(param_1 + 0x3c) = uVar8;
      param_1[0x14] = uVar3;
      *(ushort *)((longlong)param_1 + 0xf2) = uVar7;
      param_1[0x32] = uVar5;
      param_1[0x36] = uVar2;
      param_1[0x3a] = uVar6;
    }
    else {
      memset(&local_3b8,0,0xb8);
      local_3b8 = local_3b8 & 0xffffffff00000000 | (ulonglong)*param_1;
      local_350 = param_1[0x14];
      local_320 = *(void **)(param_1 + 0x38);
      local_408 = 0;
      local_30a = uVar10;
      if (*(longlong *)(param_1 + 0x12) != 0) {
        if (local_350 == 0) {
          uVar2 = 4;
        }
        else {
          uVar2 = local_350 + 3 & 0xfffffffc;
        }
        lVar4 = CsrAllocateCaptureBuffer(1,uVar2);
        local_408 = lVar4;
        if (lVar4 == 0) goto LAB_1800406ee;
        CsrAllocateMessagePointer(lVar4,param_1[0x14]);
        RtlMoveMemory(local_358,*(void **)(param_1 + 0x12),(ulonglong)param_1[0x14]);
      }
      iVar1 = CsrClientCallServer(local_3f8,lVar4,0x10010007,0xb8);
      if (-1 < iVar1) {
        iVar1 = local_3c4;
      }
      if (-1 < iVar1) {
        if (*(void **)(param_1 + 0x12) != (void *)0x0) {
          RtlMoveMemory(*(void **)(param_1 + 0x12),local_358,(ulonglong)param_1[0x14]);
        }
        *param_1 = (uint)local_3b8;
        param_1[0x14] = local_350;
        if (lVar4 != 0) {
          CsrFreeCaptureBuffer(lVar4);
        }
        goto LAB_1800406f5;
      }
      if (lVar4 == 0) goto LAB_1800406ee;
    }
LAB_18003ff53:
    CsrFreeCaptureBuffer(lVar4);
  }
LAB_1800406ee:
  BaseSetLastNTError();
LAB_1800406f5:
  __security_check_cookie(local_38 ^ (ulonglong)auStack1064);
  return;
}



bool FUN_180040723(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



void FUN_180040743(undefined8 param_1,longlong param_2)

{
  CsrFreeCaptureBuffer(*(undefined8 *)(param_2 + 0x20));
  return;
}



bool FUN_180040764(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



void GetVDMCurrentDirectories(uint param_1,void *param_2)

{
  int iVar1;
  longlong lVar2;
  undefined auStack1048 [32];
  longlong local_3f8;
  undefined local_3e8 [52];
  int local_3b4;
  ulonglong local_3a8;
  void *local_3a0;
  uint local_398;
  ulonglong local_28;
  
                    // 0x40790  805  GetVDMCurrentDirectories
  local_28 = DAT_1800b2220 ^ (ulonglong)auStack1048;
  lVar2 = 0;
  local_3f8 = 0;
  local_3a8 = FUN_18001ffe0();
  if (local_3a8 == 0xffffffffffffffff) {
    BaseSetLastNTError();
    goto LAB_1800407da;
  }
  if ((param_1 == 0) || (param_2 == (void *)0x0)) {
    local_398 = 0;
    local_3a0 = (void *)0x0;
    local_3f8 = 0;
LAB_18004086c:
    local_3b4 = -1;
    iVar1 = CsrClientCallServer(local_3e8,lVar2,0x1001000f,0x18);
    if (local_3b4 == -1) {
      local_398 = 0;
    }
    if (-1 < iVar1) {
      iVar1 = local_3b4;
    }
    if (iVar1 < 0) {
      BaseSetLastNTError();
    }
    else {
      RtlMoveMemory(param_2,local_3a0,(ulonglong)local_398);
    }
  }
  else {
    lVar2 = CsrAllocateCaptureBuffer(1,param_1);
    local_3f8 = lVar2;
    if (lVar2 != 0) {
      CsrAllocateMessagePointer(lVar2,param_1,&local_3a0);
      local_398 = param_1;
      goto LAB_18004086c;
    }
    BaseSetLastNTError();
  }
  if (lVar2 != 0) {
    CsrFreeCaptureBuffer(lVar2);
  }
LAB_1800407da:
  __security_check_cookie(local_28 ^ (ulonglong)auStack1048);
  return;
}



void FUN_18004091d(undefined8 param_1,longlong param_2)

{
  if (*(longlong *)(param_2 + 0x20) != 0) {
    CsrFreeCaptureBuffer();
  }
  return;
}



wchar_t * FUN_18004094c(LPCWSTR param_1,undefined4 *param_2,DWORD *param_3)

{
  char cVar1;
  uint uVar2;
  DWORD DVar3;
  BOOL BVar4;
  int iVar5;
  HANDLE hFile;
  wchar_t *_Str1;
  char cVar6;
  char cVar7;
  uint uVar8;
  wchar_t *pwVar9;
  wchar_t wVar10;
  wchar_t *pwVar11;
  wchar_t *pwVar12;
  LPCWSTR pWVar13;
  uint local_res10 [2];
  uint local_res18 [2];
  undefined local_res20 [8];
  undefined4 uVar14;
  undefined local_58 [16];
  undefined *local_48 [2];
  
  pwVar9 = (wchar_t *)0x0;
  pwVar11 = (wchar_t *)0x0;
  *param_2 = 0;
  *param_3 = 0;
  uVar2 = FUN_18006a87c();
  if ((uVar2 & 1) != 0) {
    return (wchar_t *)0x0;
  }
  local_res10[0] = 0x5a5a5a5a;
  hFile = CreateFileW(param_1,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0x0);
  if (hFile == (HANDLE)0xffffffffffffffff) {
    *param_2 = 1;
    DVar3 = GetLastError();
    *param_3 = DVar3;
    return (wchar_t *)0x0;
  }
  uVar14 = 0;
  BVar4 = ReadFile(hFile,local_res10,4,local_res18,(LPOVERLAPPED)0x0);
  pwVar12 = pwVar11;
  if (BVar4 == 0) {
    *param_2 = 2;
    DVar3 = GetLastError();
    *param_3 = DVar3;
    goto LAB_180040bd5;
  }
  *param_3 = local_res10[0];
  if (local_res18[0] == 0) {
    *param_2 = 4;
  }
  else {
    cVar6 = (char)local_res10[0];
    if (local_res18[0] == 1) {
      if (cVar6 == '\0') {
        *param_2 = 6;
      }
      else {
        if (cVar6 != -1) goto LAB_180040bd5;
        *param_2 = 5;
      }
    }
    else {
      pwVar12 = pwVar9;
      if (local_res18[0] < 2) goto LAB_180040bd5;
      if (local_res18[0] < 4) {
        if ((short)local_res10[0] == 0) {
          *param_2 = 8;
        }
        else {
          pwVar12 = pwVar11;
          if ((short)local_res10[0] != -1) goto LAB_180040bd5;
          *param_2 = 7;
        }
      }
      else {
        if (local_res18[0] != 4) goto LAB_180040bd5;
        if (local_res10[0] == 0) {
          *param_2 = 0xb;
        }
        else if (local_res10[0] == 0xffffffff) {
          *param_2 = 10;
        }
        else {
          pwVar12 = pwVar11;
          if ((cVar6 != '<') || (wVar10 = *param_1, pWVar13 = param_1, wVar10 == L'\0'))
          goto LAB_180040bd5;
          do {
            pWVar13 = pWVar13 + 1;
            _Str1 = pWVar13;
            if (wVar10 != L'.') {
              _Str1 = pwVar9;
            }
            wVar10 = *pWVar13;
            pwVar9 = _Str1;
          } while (wVar10 != L'\0');
          if ((_Str1 == (wchar_t *)0x0) || (iVar5 = _wcsicmp(_Str1,L"exe"), iVar5 != 0))
          goto LAB_180040bd5;
          uVar8 = local_res10[0] >> 8;
          cVar6 = (char)(local_res10[0] >> 8);
          if ((cVar6 != '?') && (cVar6 != '!')) {
            cVar1 = (char)(local_res10[0] >> 0x10);
            cVar7 = (char)(local_res10[0] >> 0x18);
            if (cVar6 == '\0') {
              local_res10[0] = uVar8;
              if ((0x5a < (byte)(cVar1 - 0x20U)) || (cVar7 != '\0')) goto LAB_180040bd5;
            }
            else {
              local_res10[0] = uVar8;
              if (((0x39 < (byte)(cVar6 + 0xbfU)) || (0x39 < (byte)(cVar1 + 0xbfU))) ||
                 (0x39 < (byte)(cVar7 + 0xbfU))) goto LAB_180040bd5;
            }
          }
          *param_2 = 0xc;
          local_res10[0] = uVar8;
        }
      }
    }
  }
  RtlSetLastWin32Error(0xc1);
  pwVar12 = (wchar_t *)0x1;
  if ((uVar2 & 2) != 0) {
    RtlInitUnicodeString(local_58,param_1);
    local_48[0] = local_58;
    NtRaiseHardError(0xc0000102,1,1,local_48,CONCAT44(uVar14,1),local_res20);
  }
LAB_180040bd5:
  CloseHandle(hFile);
  return pwVar12;
}



void FUN_180040c08(uint *param_1,undefined8 *param_2,undefined8 param_3,undefined8 param_4)

{
  ulonglong uVar1;
  undefined auStackY264 [32];
  undefined4 local_d8;
  undefined4 local_d4;
  undefined4 local_d0;
  undefined4 local_cc;
  undefined4 local_c8 [4];
  _EVENT_DATA_DESCRIPTOR local_b8 [2];
  undefined8 local_98 [2];
  undefined8 local_88 [2];
  undefined8 local_78 [2];
  undefined4 *local_68;
  undefined4 local_60;
  undefined4 local_5c;
  undefined4 *local_58;
  undefined4 local_50;
  undefined4 local_4c;
  undefined4 *local_48;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 *local_38;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 *local_28;
  undefined4 local_20;
  undefined4 local_1c;
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStackY264;
  if (5 < *param_1) {
    uVar1 = FUN_1800410b8((longlong)param_1);
    if ((char)uVar1 != '\0') {
      FUN_180041078(local_98,(undefined *)*param_2);
      FUN_180041078(local_88,(undefined *)(param_2 + 6));
      FUN_180041078(local_78,(undefined *)(param_2 + 0x26));
      local_d8 = *(undefined4 *)(param_2 + 1);
      local_68 = &local_d8;
      local_5c = 0;
      local_4c = 0;
      local_3c = 0;
      local_2c = 0;
      local_1c = 0;
      local_d4 = *(undefined4 *)((longlong)param_2 + 0xc);
      local_58 = &local_d4;
      local_d0 = *(undefined4 *)(param_2 + 2);
      local_48 = &local_d0;
      local_cc = *(undefined4 *)((longlong)param_2 + 0x14);
      local_38 = &local_cc;
      local_c8[0] = *(undefined4 *)(param_2 + 3);
      local_28 = local_c8;
      local_60 = 4;
      local_50 = 4;
      local_40 = 4;
      local_30 = 4;
      local_20 = 4;
      FUN_1800410e4((longlong)param_1,&DAT_180087d81,param_3,param_4,10,local_b8);
    }
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStackY264);
  return;
}



void RegisterWowExec(undefined8 param_1)

{
  undefined auStack1016 [32];
  undefined local_3d8 [64];
  undefined8 local_398;
  ulonglong local_390;
  ulonglong local_18;
  
                    // 0x40d20  1204  RegisterWowExec
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack1016;
  local_398 = param_1;
  local_390 = FUN_18001ffe0();
  CsrClientCallServer(local_3d8,0,0x10010011,0x10);
  __security_check_cookie(local_18 ^ (ulonglong)auStack1016);
  return;
}



void SetVDMCurrentDirectories(uint param_1,void *param_2)

{
  int iVar1;
  longlong lVar2;
  undefined auStack1032 [32];
  longlong local_3e8;
  undefined local_3d8 [52];
  int local_3a4;
  ulonglong local_398;
  void *local_390;
  uint local_388;
  ulonglong local_18;
  
                    // 0x40d90  1411  SetVDMCurrentDirectories
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack1032;
  local_398 = FUN_18001ffe0();
  if (local_398 != 0xffffffffffffffff) {
    if ((param_1 == 0) || (param_2 == (void *)0x0)) goto LAB_180040e94;
    lVar2 = CsrAllocateCaptureBuffer(1,(ulonglong)param_1);
    local_3e8 = lVar2;
    if (lVar2 != 0) {
      CsrAllocateMessagePointer(lVar2,param_1,&local_390);
      local_388 = param_1;
      RtlMoveMemory(local_390,param_2,(ulonglong)param_1);
      iVar1 = CsrClientCallServer(local_3d8,lVar2,0x1001000e,0x18);
      CsrFreeCaptureBuffer(lVar2);
      if ((-1 < iVar1) && (-1 < local_3a4)) goto LAB_180040e94;
    }
  }
  BaseSetLastNTError();
LAB_180040e94:
  __security_check_cookie(local_18 ^ (ulonglong)auStack1032);
  return;
}



ulonglong FUN_180040eba(byte param_1,longlong param_2)

{
  ulonglong uVar1;
  
  uVar1 = (ulonglong)param_1;
  if (param_1 != 0) {
    uVar1 = CsrFreeCaptureBuffer(*(undefined8 *)(param_2 + 0x20));
  }
  return uVar1;
}



bool FUN_180040ee2(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



void FUN_180040f08(WCHAR *param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  WCHAR *pWVar4;
  undefined8 uVar5;
  int *piVar6;
  uint uVar7;
  WCHAR *pWVar8;
  WCHAR WVar9;
  WCHAR *pWVar10;
  undefined auStack680 [32];
  undefined4 local_288;
  undefined4 local_284;
  LPCWSTR local_278;
  int local_270;
  undefined4 local_26c;
  uint local_268;
  undefined4 local_264;
  undefined4 local_260;
  int local_258;
  undefined4 local_254;
  WCHAR *local_250;
  ulonglong local_48;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStack680;
  uVar7 = 0;
  WVar9 = *param_1;
  pWVar8 = param_1;
  pWVar10 = param_1;
  while (WVar9 != L'\0') {
    pWVar8 = pWVar8 + 1;
    pWVar4 = pWVar8;
    if (WVar9 != L'\\') {
      pWVar4 = pWVar10;
    }
    pWVar10 = pWVar4;
    WVar9 = *pWVar8;
  }
  local_288 = param_3;
  local_284 = param_4;
  uVar5 = FUN_18003fac0(pWVar10);
  if ((int)uVar5 != 0) {
    bVar1 = FUN_18006a87c();
    iVar2 = FUN_18006a988('\x01');
    iVar3 = FUN_18006a988('\0');
    local_270 = (-(uint)((bVar1 & 1) != 0) & 9) + iVar3 + iVar2 * 3;
    memset(&local_278,0,0x230);
    piVar6 = &DAT_180088818;
    do {
      if (param_2 == *piVar6) break;
      uVar7 = uVar7 + 1;
      piVar6 = piVar6 + 1;
    } while (uVar7 < 10);
    local_26c = 9;
    piVar6 = &local_258;
    local_258 = 1;
    local_268 = uVar7;
    if (9 < uVar7) {
      local_268 = 9;
    }
    local_254 = 0x210;
    local_264 = local_288;
    local_260 = local_284;
    local_278 = pWVar10;
    local_250 = param_1;
    FUN_18005837c(piVar6);
    FUN_18006aae8(piVar6,&local_278);
  }
  __security_check_cookie(local_48 ^ (ulonglong)auStack680);
  return;
}



void VDMOperationStarted(int param_1)

{
                    // 0x41060  1490  VDMOperationStarted
  BaseUpdateVDMEntry(2,(undefined8 *)0x0,0,param_1);
  return;
}



void FUN_180041078(undefined8 *param_1,undefined *param_2)

{
  longlong lVar1;
  int iVar2;
  
  if (param_2 == (undefined *)0x0) {
    param_2 = &DAT_180085634;
    iVar2 = 2;
  }
  else {
    lVar1 = -1;
    do {
      lVar1 = lVar1 + 1;
    } while (*(short *)(param_2 + lVar1 * 2) != 0);
    iVar2 = (int)lVar1 * 2 + 2;
  }
  *param_1 = param_2;
  *(int *)(param_1 + 1) = iVar2;
  *(undefined4 *)((longlong)param_1 + 0xc) = 0;
  return;
}



ulonglong FUN_1800410b8(longlong param_1)

{
  ulonglong in_RAX;
  
  if (((*(ulonglong *)(param_1 + 0x10) & 0x400000000000) != 0) &&
     (in_RAX = *(ulonglong *)(param_1 + 0x18) & 0x400000000000,
     in_RAX == *(ulonglong *)(param_1 + 0x18))) {
    return CONCAT71((int7)(in_RAX >> 8),1);
  }
  return in_RAX & 0xffffffffffffff00;
}



void FUN_1800410e4(longlong param_1,byte *param_2,undefined8 param_3,undefined8 param_4,
                  ULONG param_5,PEVENT_DATA_DESCRIPTOR param_6)

{
  int local_18;
  uint local_14;
  ULONGLONG local_10;
  
  local_18 = (uint)*param_2 << 0x18;
  local_14 = (uint)*(ushort *)(param_2 + 1);
  local_10 = *(ULONGLONG *)(param_2 + 3);
  param_6->Ptr = *(ULONGLONG *)(param_1 + 8);
  param_6->Size = (uint)**(ushort **)(param_1 + 8);
  param_6[1].Ptr = (ULONGLONG)(param_2 + 0xb);
  param_6->Reserved = 2;
  param_6[1].Size = (uint)*(ushort *)(param_2 + 0xb);
  param_6[1].Reserved = 1;
  EventWriteTransfer(*(REGHANDLE *)(param_1 + 0x20),(PCEVENT_DESCRIPTOR)&local_18,(LPCGUID)0x0,
                     (LPCGUID)0x0,param_5,param_6);
  return;
}



BOOL CreateUmsCompletionList(PUMS_COMPLETION_LIST *UmsCompletionList)

{
  int iVar1;
  
                    // 0x41190  256  CreateUmsCompletionList
  iVar1 = RtlCreateUmsCompletionList();
  if (-1 >= iVar1) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  }
  return (uint)(-1 < iVar1);
}



BOOL CreateUmsThreadContext(PUMS_CONTEXT *lpUmsThread)

{
  int iVar1;
  
                    // 0x411d0  257  CreateUmsThreadContext
  iVar1 = RtlCreateUmsThreadContext();
  if (-1 >= iVar1) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  }
  return (uint)(-1 < iVar1);
}



BOOL DeleteUmsCompletionList(PUMS_COMPLETION_LIST UmsCompletionList)

{
  int iVar1;
  
                    // 0x41210  288  DeleteUmsCompletionList
  iVar1 = RtlDeleteUmsCompletionList();
  if (-1 >= iVar1) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  }
  return (uint)(-1 < iVar1);
}



BOOL DeleteUmsThreadContext(PUMS_CONTEXT UmsThread)

{
  int iVar1;
  
                    // 0x41250  289  DeleteUmsThreadContext
  iVar1 = RtlDeleteUmsThreadContext();
  if (-1 >= iVar1) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  }
  return (uint)(-1 < iVar1);
}



BOOL DequeueUmsCompletionListItems
               (PUMS_COMPLETION_LIST UmsCompletionList,DWORD WaitTimeOut,PUMS_CONTEXT *UmsThreadList
               )

{
  int iVar1;
  longlong *plVar2;
  longlong local_res20;
  
                    // 0x41290  292  DequeueUmsCompletionListItems
  plVar2 = BaseFormatTimeOut(&local_res20,WaitTimeOut);
  iVar1 = RtlDequeueUmsCompletionListItems(UmsCompletionList,plVar2,UmsThreadList);
  if (-1 >= iVar1) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  }
  return (uint)(-1 < iVar1);
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

BOOL EnterUmsSchedulingMode(PUMS_SCHEDULER_STARTUP_INFO SchedulerStartupInfo)

{
  int iVar1;
  BOOL extraout_EAX;
  ulonglong uVar2;
  undefined *puVar3;
  undefined8 in_R8;
  undefined8 in_R9;
  undefined auStackY120 [32];
  ulonglong local_48;
  _EVENT_DATA_DESCRIPTOR local_40 [2];
  ulonglong *local_20;
  undefined4 local_18;
  undefined4 local_14;
  ulonglong local_10;
  
                    // 0x412f0  315  EnterUmsSchedulingMode
  local_10 = DAT_1800b2220 ^ (ulonglong)auStackY120;
  iVar1 = RtlEnterUmsSchedulingMode();
  if (5 < _DAT_1800b2000) {
    puVar3 = &DAT_1800b2000;
    uVar2 = FUN_1800410b8((longlong)&DAT_1800b2000);
    if ((char)uVar2 != '\0') {
      local_14 = 0;
      local_20 = &local_48;
      local_18 = 8;
      local_48 = (longlong)iVar1;
      FUN_1800410e4((longlong)puVar3,&DAT_180087e0b,in_R8,in_R9,3,local_40);
    }
  }
  if (iVar1 < 0) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus((longlong)iVar1 & 0xffffffff);
  }
  __security_check_cookie(local_10 ^ (ulonglong)auStackY120);
  return extraout_EAX;
}



BOOL ExecuteUmsThread(PUMS_CONTEXT UmsThread)

{
  int iVar1;
  
                    // 0x413a0  359  ExecuteUmsThread
  iVar1 = RtlExecuteUmsThread();
  if (-1 >= iVar1) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  }
  return (uint)(-1 < iVar1);
}



PUMS_CONTEXT GetCurrentUmsThread(void)

{
  int iVar1;
  PUMS_CONTEXT local_res8 [4];
  
                    // 0x413e0  552  GetCurrentUmsThread
  iVar1 = RtlGetCurrentUmsThread(local_res8);
  if (iVar1 < 0) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
    local_res8[0] = (PUMS_CONTEXT)0x0;
  }
  return local_res8[0];
}



PUMS_CONTEXT GetNextUmsListItem(PUMS_CONTEXT UmsContext)

{
  int iVar1;
  PUMS_CONTEXT local_res10 [3];
  
                    // 0x41420  656  GetNextUmsListItem
  iVar1 = RtlGetNextUmsListItem(UmsContext,local_res10);
  if (iVar1 < 0) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
    local_res10[0] = (PUMS_CONTEXT)0x0;
  }
  return local_res10[0];
}



BOOL GetUmsCompletionListEvent(PUMS_COMPLETION_LIST UmsCompletionList,PHANDLE UmsCompletionEvent)

{
  int iVar1;
  
                    // 0x41460  796  GetUmsCompletionListEvent
  iVar1 = RtlGetUmsCompletionListEvent();
  if (-1 >= iVar1) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  }
  return (uint)(-1 < iVar1);
}



undefined8 GetUmsSystemThreadInformation(undefined8 param_1,int *param_2)

{
  int iVar1;
  undefined4 local_28 [2];
  uint local_20;
  
                    // 0x414a0  797  GetUmsSystemThreadInformation
  if (*param_2 == 0x100) {
    local_28[0] = 3;
    iVar1 = NtQueryInformationThread(param_1,0x1f,local_28,0x18,0);
    if (-1 < iVar1) {
      param_2[1] = local_20 & 3;
      return 1;
    }
  }
  else {
    iVar1 = -0x3ffffff3;
  }
  RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  return 0;
}



BOOL QueryUmsThreadInformation
               (PUMS_CONTEXT UmsThread,UMS_THREAD_INFO_CLASS UmsThreadInfoClass,
               PVOID UmsThreadInformation,ULONG UmsThreadInformationLength,PULONG ReturnLength)

{
  int iVar1;
  
                    // 0x41520  1115  QueryUmsThreadInformation
  iVar1 = RtlQueryUmsThreadInformation();
  if (-1 >= iVar1) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  }
  return (uint)(-1 < iVar1);
}



BOOL SetUmsThreadInformation
               (PUMS_CONTEXT UmsThread,UMS_THREAD_INFO_CLASS UmsThreadInfoClass,
               PVOID UmsThreadInformation,ULONG UmsThreadInformationLength)

{
  int iVar1;
  
                    // 0x41570  1407  SetUmsThreadInformation
  iVar1 = RtlSetUmsThreadInformation();
  if (-1 >= iVar1) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  }
  return (uint)(-1 < iVar1);
}



BOOL UmsThreadYield(PVOID SchedulerParam)

{
  int iVar1;
  
                    // 0x415b0  1472  UmsThreadYield
  iVar1 = RtlUmsThreadYield();
  if (-1 >= iVar1) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus(iVar1);
  }
  return (uint)(-1 < iVar1);
}



void FUN_1800415f4(char **param_1)

{
  char *pcVar1;
  
  pcVar1 = param_1[1];
  *param_1 = pcVar1;
  while (*pcVar1 == ' ') {
    *param_1 = *param_1 + 1;
    pcVar1 = *param_1;
  }
  return;
}



BOOL BuildCommDCBA(LPCSTR lpDef,LPDCB lpDCB)

{
  BOOL extraout_EAX;
  undefined8 uVar1;
  undefined auStack72 [32];
  undefined8 local_28 [3];
  ulonglong local_10;
  
                    // 0x41610  108  BuildCommDCBA
  local_10 = DAT_1800b2220 ^ (ulonglong)auStack72;
  uVar1 = FUN_1800417b4((byte *)lpDef,(longlong)lpDCB,local_28);
  if ((int)uVar1 == 0) {
    RtlSetLastWin32Error(0x57);
  }
  __security_check_cookie(local_10 ^ (ulonglong)auStack72);
  return extraout_EAX;
}



BOOL BuildCommDCBAndTimeoutsA(LPCSTR lpDef,LPDCB lpDCB,LPCOMMTIMEOUTS lpCommTimeouts)

{
  undefined8 uVar1;
  bool bVar2;
  
                    // 0x41670  109  BuildCommDCBAndTimeoutsA
  uVar1 = FUN_1800417b4((byte *)lpDef,(longlong)lpDCB,(undefined8 *)lpCommTimeouts);
  bVar2 = (int)uVar1 != 0;
  if (!bVar2) {
    RtlSetLastWin32Error(0x57);
  }
  return (uint)bVar2;
}



BOOL BuildCommDCBAndTimeoutsW(LPCWSTR lpDef,LPDCB lpDCB,LPCOMMTIMEOUTS lpCommTimeouts)

{
  int iVar1;
  BOOL BVar2;
  undefined local_28 [8];
  LPCSTR local_20;
  undefined local_18 [16];
  
                    // 0x416b0  110  BuildCommDCBAndTimeoutsW
  RtlInitUnicodeString(local_18,lpDef);
  iVar1 = RtlUnicodeStringToAnsiString(local_28,local_18,1);
  if (iVar1 < 0) {
    BaseSetLastNTError();
    BVar2 = 0;
  }
  else {
    BVar2 = BuildCommDCBAndTimeoutsA(local_20,lpDCB,lpCommTimeouts);
    RtlFreeAnsiString(local_28);
  }
  return BVar2;
}



BOOL BuildCommDCBW(LPCWSTR lpDef,LPDCB lpDCB)

{
  int iVar1;
  BOOL BVar2;
  undefined local_28 [8];
  LPCSTR local_20;
  undefined local_18 [16];
  
                    // 0x41740  111  BuildCommDCBW
  RtlInitUnicodeString(local_18,lpDef);
  iVar1 = RtlUnicodeStringToAnsiString(local_28,local_18,1);
  if (iVar1 < 0) {
    BaseSetLastNTError();
    BVar2 = 0;
  }
  else {
    BVar2 = BuildCommDCBA(local_20,lpDCB);
    RtlFreeAnsiString(local_28);
  }
  return BVar2;
}



// WARNING: Could not reconcile some variable overlaps

undefined8 FUN_1800417b4(byte *param_1,longlong param_2,undefined8 *param_3)

{
  bool bVar1;
  byte bVar2;
  uint uVar3;
  long lVar4;
  uint uVar5;
  undefined8 uVar6;
  byte bVar7;
  int iVar8;
  byte bVar9;
  byte bVar10;
  byte bVar11;
  int iVar12;
  int iVar13;
  byte local_res8 [8];
  byte local_res20 [8];
  int local_108;
  byte local_104;
  undefined local_103;
  undefined local_102 [2];
  byte *local_100;
  byte *local_f8;
  undefined local_f0 [16];
  int local_e0;
  uint local_dc;
  int local_d8;
  int local_d4;
  int local_d0;
  int local_cc;
  int local_c8;
  int local_c4;
  int local_c0;
  int local_bc;
  int local_b8;
  int local_b4;
  int local_b0;
  code *local_a8 [3];
  byte **local_90;
  
  local_108 = 0;
  local_c8 = 0;
  local_e0 = 0;
  bVar1 = false;
  local_c4 = 0;
  local_b0 = 0;
  bVar7 = 0;
  local_d0 = 0;
  iVar12 = 0;
  local_c0 = 0;
  iVar13 = 0;
  local_d8 = 0;
  uVar3 = 0;
  local_b8 = 0;
  local_b4 = 0;
  local_dc = 0;
  local_103 = 0;
  local_res8[0] = 0;
  local_102[0] = 0;
  local_cc = 0;
  local_bc = 0;
  local_d4 = 0;
  local_res20[0] = 0;
  local_104 = 0;
  local_f0 = ZEXT816(0);
  local_100 = param_1;
  local_f8 = param_1;
  memset(local_a8,0,0x70);
  local_a8[0] = FUN_180042320;
  local_90 = &local_100;
  RtlQueryRegistryValuesEx(4,L"SERIALCOMM",local_a8,0,0);
  uVar6 = FUN_1800423ac(&local_100,&DAT_180088840);
  if ((int)uVar6 == 0) {
    if (*local_100 != 0) {
      do {
        uVar6 = FUN_1800423ac(&local_100,(byte *)"BAUD=#");
        if ((int)uVar6 == 0) {
          uVar6 = FUN_1800423ac(&local_100,(byte *)"PARITY=@");
          if ((int)uVar6 == 0) {
            uVar6 = FUN_1800423ac(&local_100,(byte *)"DATA=#");
            if ((int)uVar6 == 0) {
              uVar6 = FUN_1800423ac(&local_100,(byte *)"STOP=1.5");
              if ((int)uVar6 == 0) {
                uVar6 = FUN_1800423ac(&local_100,(byte *)"STOP=#");
                if ((int)uVar6 == 0) {
                  uVar6 = FUN_1800423ac(&local_100,(byte *)"TO=ON");
                  if ((int)uVar6 == 0) {
                    uVar6 = FUN_1800423ac(&local_100,(byte *)"TO=OFF");
                    if ((int)uVar6 == 0) {
                      uVar6 = FUN_1800423ac(&local_100,(byte *)"XON=ON");
                      if ((int)uVar6 == 0) {
                        uVar6 = FUN_1800423ac(&local_100,(byte *)"XON=OFF");
                        if ((int)uVar6 == 0) {
                          uVar6 = FUN_1800423ac(&local_100,(byte *)"ODSR=ON");
                          if ((int)uVar6 == 0) {
                            uVar6 = FUN_1800423ac(&local_100,(byte *)"ODSR=OFF");
                            if ((int)uVar6 == 0) {
                              uVar6 = FUN_1800423ac(&local_100,(byte *)"IDSR=ON");
                              if ((int)uVar6 == 0) {
                                uVar6 = FUN_1800423ac(&local_100,(byte *)"IDSR=OFF");
                                if ((int)uVar6 == 0) {
                                  uVar6 = FUN_1800423ac(&local_100,(byte *)"OCTS=ON");
                                  if ((int)uVar6 == 0) {
                                    uVar6 = FUN_1800423ac(&local_100,(byte *)"OCTS=OFF");
                                    if ((int)uVar6 == 0) {
                                      uVar6 = FUN_1800423ac(&local_100,(byte *)"DTR=*");
                                      if ((int)uVar6 == 0) {
                                        uVar6 = FUN_1800423ac(&local_100,(byte *)"RTS=*");
                                        if ((int)uVar6 == 0) {
                                          return 0;
                                        }
                                        uVar6 = FUN_1800421b4(local_f0._0_8_,local_f0._8_8_,
                                                              &local_104);
                                        if ((int)uVar6 == 0) {
                                          return 0;
                                        }
                                        local_b4 = 1;
                                      }
                                      else {
                                        uVar6 = FUN_180042054(local_f0._0_8_,local_f0._8_8_,
                                                              local_res20);
                                        if ((int)uVar6 == 0) {
                                          return 0;
                                        }
                                        local_b8 = 1;
                                      }
                                    }
                                    else {
                                      local_d8 = 1;
                                      local_d4 = 0;
                                    }
                                  }
                                  else {
                                    local_d8 = 1;
                                    local_d4 = 1;
                                  }
                                }
                                else {
                                  local_c0 = 1;
                                  local_bc = 0;
                                }
                              }
                              else {
                                local_c0 = 1;
                                local_bc = 1;
                              }
                            }
                            else {
                              local_d0 = 1;
                              iVar13 = 0;
                            }
                          }
                          else {
                            local_d0 = 1;
                            iVar13 = 1;
                          }
                        }
                        else {
                          bVar1 = true;
                          iVar12 = 0;
                        }
                      }
                      else {
                        bVar1 = true;
                        iVar12 = 1;
                      }
                    }
                    else {
                      local_b0 = 1;
                      local_cc = 0;
                    }
                  }
                  else {
                    local_b0 = 1;
                    local_cc = 1;
                  }
                }
                else {
                  lVar4 = atol(local_f0._0_8_);
                  uVar6 = FUN_1800422f0(lVar4,local_res8);
                  if ((int)uVar6 == 0) {
                    return 0;
                  }
                  local_e0 = 1;
                  bVar7 = local_res8[0];
                }
              }
              else {
                local_e0 = 1;
                local_res8[0] = 1;
                bVar7 = 1;
              }
            }
            else {
              lVar4 = atol(local_f0._0_8_);
              uVar6 = FUN_180042038(lVar4,&local_103);
              if ((int)uVar6 == 0) {
                return 0;
              }
              local_c8 = 1;
            }
          }
          else {
            uVar6 = FUN_180042154(*local_f0._0_8_,local_102);
            if ((int)uVar6 == 0) {
              return 0;
            }
            local_c4 = 1;
          }
        }
        else {
          uVar3 = atol(local_f0._0_8_);
          uVar6 = FUN_180041f58(uVar3,&local_dc);
          if ((int)uVar6 == 0) {
            return 0;
          }
          local_108 = 1;
        }
        iVar8 = local_108;
        FUN_1800415f4((char **)&local_100);
      } while (*local_100 != 0);
      uVar3 = (uint)local_res20[0];
      uVar5 = (uint)local_res20[0];
      if (iVar8 != 0) goto LAB_180041e26;
      goto LAB_180041e31;
    }
  }
  else {
    uVar5 = 1;
    bVar10 = 1;
    bVar9 = 1;
    uVar3 = atol(local_f0._0_8_);
    uVar6 = FUN_180041f58(uVar3,&local_dc);
    if ((int)uVar6 == 0) {
      return 0;
    }
    bVar1 = true;
    FUN_1800415f4((char **)&local_100);
    uVar6 = FUN_1800423ac(&local_100,&DAT_180088844);
    bVar11 = bVar7;
    bVar2 = bVar10;
    if ((int)uVar6 != 0) {
      FUN_1800415f4((char **)&local_100);
      uVar6 = FUN_1800423ac(&local_100,&DAT_180088844);
      if (((int)uVar6 == 0) && (uVar6 = FUN_1800423ac(&local_100,&DAT_180088848), (int)uVar6 != 0))
      {
        uVar6 = FUN_180042154(*local_f0._0_8_,local_102);
        if ((int)uVar6 == 0) {
          return 0;
        }
        local_c4 = 1;
        FUN_1800415f4((char **)&local_100);
      }
      uVar6 = FUN_1800423ac(&local_100,&DAT_180088844);
      bVar2 = bVar9;
      if ((int)uVar6 != 0) {
        FUN_1800415f4((char **)&local_100);
        uVar6 = FUN_1800423ac(&local_100,&DAT_180088840);
        if ((int)uVar6 != 0) {
          lVar4 = atol(local_f0._0_8_);
          uVar6 = FUN_180042038(lVar4,&local_103);
          if ((int)uVar6 == 0) {
            return 0;
          }
          local_c8 = 1;
          FUN_1800415f4((char **)&local_100);
        }
        uVar6 = FUN_1800423ac(&local_100,&DAT_180088844);
        bVar11 = 0;
        if ((int)uVar6 != 0) {
          FUN_1800415f4((char **)&local_100);
          uVar6 = FUN_1800423ac(&local_100,&DAT_18008884c);
          if ((int)uVar6 == 0) {
            uVar6 = FUN_1800423ac(&local_100,&DAT_180088840);
            bVar11 = bVar7;
            if ((int)uVar6 != 0) {
              lVar4 = atol(local_f0._0_8_);
              uVar6 = FUN_1800422f0(lVar4,local_res8);
              if ((int)uVar6 == 0) {
                return 0;
              }
              local_e0 = 1;
              FUN_1800415f4((char **)&local_100);
              bVar11 = local_res8[0];
            }
          }
          else {
            local_e0 = 1;
            FUN_1800415f4((char **)&local_100);
            bVar11 = 1;
          }
          uVar6 = FUN_1800423ac(&local_100,&DAT_180088844);
          if ((int)uVar6 != 0) {
            FUN_1800415f4((char **)&local_100);
            uVar6 = FUN_1800423ac(&local_100,&DAT_180088850);
            iVar8 = 1;
            if ((int)uVar6 == 0) {
              uVar6 = FUN_1800423ac(&local_100,&DAT_180088854);
              if ((int)uVar6 == 0) goto LAB_180041aaa;
              uVar5 = 2;
              bVar10 = 2;
              iVar8 = iVar12;
              iVar13 = 1;
            }
            iVar12 = iVar8;
            FUN_1800415f4((char **)&local_100);
            bVar2 = bVar10;
          }
        }
      }
    }
LAB_180041aaa:
    local_104 = bVar2;
    if (*local_100 != 0) {
      return 0;
    }
    local_d0 = 1;
    iVar8 = 1;
    local_d8 = 1;
    local_b8 = 1;
    local_b4 = 1;
    bVar7 = bVar11;
    local_d4 = iVar13;
LAB_180041e26:
    uVar3 = uVar5;
    *(uint *)(param_2 + 4) = local_dc;
LAB_180041e31:
    if (local_c8 != 0) {
      *(undefined *)(param_2 + 0x12) = local_103;
    }
    if (local_e0 != 0) {
      *(byte *)(param_2 + 0x14) = bVar7;
      bVar7 = local_104;
      goto LAB_180041e68;
    }
    bVar7 = local_104;
    if ((iVar8 != 0) && (local_dc == 0x6e)) {
      *(undefined *)(param_2 + 0x14) = 2;
      goto LAB_180041e68;
    }
  }
  *(undefined *)(param_2 + 0x14) = 0;
LAB_180041e68:
  if (local_c4 != 0) {
    *(undefined *)(param_2 + 0x13) = local_102[0];
  }
  if (bVar1) {
    if (iVar12 == 0) {
      uVar5 = *(uint *)(param_2 + 8) & 0xfffffcff;
    }
    else {
      uVar5 = *(uint *)(param_2 + 8) | 0x300;
    }
    *(uint *)(param_2 + 8) = uVar5;
  }
  if (local_d8 != 0) {
    if (local_d4 == 0) {
      uVar5 = *(uint *)(param_2 + 8) & 0xfffffffb;
    }
    else {
      uVar5 = *(uint *)(param_2 + 8) | 4;
    }
    *(uint *)(param_2 + 8) = uVar5;
  }
  if (local_d0 != 0) {
    if (iVar13 == 0) {
      uVar5 = *(uint *)(param_2 + 8) & 0xfffffff7;
    }
    else {
      uVar5 = *(uint *)(param_2 + 8) | 8;
    }
    *(uint *)(param_2 + 8) = uVar5;
  }
  if (local_c0 != 0) {
    if (local_bc == 0) {
      uVar5 = *(uint *)(param_2 + 8) & 0xffffffbf;
    }
    else {
      uVar5 = *(uint *)(param_2 + 8) | 0x40;
    }
    *(uint *)(param_2 + 8) = uVar5;
  }
  if (local_b8 != 0) {
    *(uint *)(param_2 + 8) = *(uint *)(param_2 + 8) & 0xffffffcf;
    *(uint *)(param_2 + 8) = *(uint *)(param_2 + 8) | (uVar3 & 3) << 4;
  }
  if (local_b4 != 0) {
    *(uint *)(param_2 + 8) = *(uint *)(param_2 + 8) & 0xffffcfff;
    *(uint *)(param_2 + 8) = *(uint *)(param_2 + 8) | (bVar7 & 3) << 0xc;
  }
  if (local_b0 != 0) {
    *param_3 = 0;
    param_3[1] = 0;
    *(uint *)(param_3 + 2) = -(uint)(local_cc != 0) & 60000;
  }
  return 1;
}



undefined8 FUN_180041f58(uint param_1,uint *param_2)

{
  uint uVar1;
  
  if (param_1 < 0x6f) {
    uVar1 = 0x6e;
    if ((param_1 == 0x6e) || (param_1 == 0xb)) goto LAB_180042025;
    if (param_1 == 0xc) goto LAB_18004200d;
    if (param_1 != 0xf) {
      if (param_1 == 0x13) {
LAB_180041ff8:
        uVar1 = 0x4b00;
        goto LAB_180042025;
      }
      if (param_1 == 0x18) {
LAB_180042005:
        uVar1 = 0x960;
        goto LAB_180042025;
      }
      if (param_1 != 0x1e) {
        if (param_1 == 0x30) goto LAB_180041ffd;
        if (param_1 != 0x3c) {
          uVar1 = param_1;
          if (param_1 != 0x60) goto LAB_180042025;
          goto LAB_180041fb4;
        }
        goto LAB_180042012;
      }
      goto LAB_18004201a;
    }
  }
  else if (param_1 != 0x96) {
    if (param_1 == 300) {
LAB_18004201a:
      uVar1 = 300;
      goto LAB_180042025;
    }
    if (param_1 == 600) {
LAB_180042012:
      uVar1 = 600;
      goto LAB_180042025;
    }
    if (param_1 != 0x4b0) {
      if (param_1 == 0x960) goto LAB_180042005;
      if (param_1 == 0x12c0) {
LAB_180041ffd:
        uVar1 = 0x12c0;
        goto LAB_180042025;
      }
      if (param_1 == 0x2580) {
LAB_180041fb4:
        uVar1 = 0x2580;
        goto LAB_180042025;
      }
      uVar1 = param_1;
      if (param_1 != 0x4b00) goto LAB_180042025;
      goto LAB_180041ff8;
    }
LAB_18004200d:
    uVar1 = 0x4b0;
    goto LAB_180042025;
  }
  uVar1 = 0x96;
LAB_180042025:
  *param_2 = uVar1;
  return 1;
}



undefined8 FUN_180042038(int param_1,undefined *param_2)

{
  if (3 < param_1 - 5U) {
    return 0;
  }
  *param_2 = (char)param_1;
  return 1;
}



undefined8 FUN_180042054(char *param_1,char *param_2,undefined *param_3)

{
  int iVar1;
  undefined8 uVar2;
  
  iVar1 = tolower((int)*param_1);
  if (iVar1 == 0x6f) {
    iVar1 = tolower((int)param_1[1]);
    if ((iVar1 != 0x6e) || (param_2 != param_1 + 1)) goto LAB_1800420af;
    *param_3 = 1;
LAB_1800420a5:
    uVar2 = 1;
  }
  else {
LAB_1800420af:
    iVar1 = tolower((int)*param_1);
    if (iVar1 == 0x6f) {
      iVar1 = tolower((int)param_1[1]);
      if (iVar1 == 0x66) {
        iVar1 = tolower((int)param_1[2]);
        if ((iVar1 == 0x66) && (param_2 == param_1 + 2)) {
          *param_3 = 0;
          goto LAB_1800420a5;
        }
      }
    }
    iVar1 = tolower((int)*param_1);
    if (iVar1 == 0x68) {
      iVar1 = tolower((int)param_1[1]);
      if ((iVar1 == 0x73) && (param_2 == param_1 + 2)) {
        *param_3 = 2;
        goto LAB_1800420a5;
      }
    }
    uVar2 = 0;
  }
  return uVar2;
}



undefined8 FUN_180042154(char param_1,undefined *param_2)

{
  int iVar1;
  
  iVar1 = tolower((int)param_1);
  if (iVar1 == 0x65) {
    *param_2 = 2;
  }
  else if (iVar1 == 0x6d) {
    *param_2 = 3;
  }
  else if (iVar1 == 0x6e) {
    *param_2 = 0;
  }
  else if (iVar1 == 0x6f) {
    *param_2 = 1;
  }
  else {
    if (iVar1 != 0x73) {
      return 0;
    }
    *param_2 = 4;
  }
  return 1;
}



undefined8 FUN_1800421b4(char *param_1,char *param_2,undefined *param_3)

{
  int iVar1;
  undefined8 uVar2;
  
  iVar1 = tolower((int)*param_1);
  if (iVar1 == 0x6f) {
    iVar1 = tolower((int)param_1[1]);
    if ((iVar1 != 0x6e) || (param_2 != param_1 + 1)) goto LAB_18004220f;
    *param_3 = 1;
LAB_180042205:
    uVar2 = 1;
  }
  else {
LAB_18004220f:
    iVar1 = tolower((int)*param_1);
    if (iVar1 == 0x6f) {
      iVar1 = tolower((int)param_1[1]);
      if (iVar1 == 0x66) {
        iVar1 = tolower((int)param_1[2]);
        if ((iVar1 == 0x66) && (param_2 == param_1 + 2)) {
          *param_3 = 0;
          goto LAB_180042205;
        }
      }
    }
    iVar1 = tolower((int)*param_1);
    if (iVar1 == 0x68) {
      iVar1 = tolower((int)param_1[1]);
      if ((iVar1 == 0x73) && (param_2 == param_1 + 2)) {
        *param_3 = 2;
        goto LAB_180042205;
      }
    }
    iVar1 = tolower((int)*param_1);
    if (iVar1 == 0x74) {
      iVar1 = tolower((int)param_1[1]);
      if ((iVar1 == 0x67) && (param_2 == param_1 + 2)) {
        *param_3 = 3;
        goto LAB_180042205;
      }
    }
    uVar2 = 0;
  }
  return uVar2;
}



undefined8 FUN_1800422f0(int param_1,undefined *param_2)

{
  undefined uVar1;
  
  if (param_1 == 1) {
    uVar1 = 0;
  }
  else {
    if (param_1 != 2) {
      return 0;
    }
    uVar1 = 2;
  }
  *param_2 = uVar1;
  return 1;
}



undefined8
FUN_180042320(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
             undefined8 param_5,byte **param_6)

{
  int iVar1;
  undefined8 uVar2;
  byte **ppbVar3;
  undefined local_28 [8];
  byte *local_20;
  undefined local_18 [24];
  
  RtlInitUnicodeString(local_18,param_3);
  iVar1 = RtlUnicodeStringToAnsiString(local_28,local_18,1);
  if (-1 < iVar1) {
    uVar2 = FUN_1800423ac(param_6,local_20);
    if ((int)uVar2 != 0) {
      ppbVar3 = param_6;
      FUN_1800415f4((char **)param_6);
      uVar2 = FUN_1800423ac(ppbVar3,&DAT_180088904);
      if ((int)uVar2 != 0) {
        FUN_1800415f4((char **)param_6);
      }
    }
    RtlFreeAnsiString(local_28);
  }
  return 0;
}



undefined8 FUN_1800423ac(byte **param_1,byte *param_2)

{
  int iVar1;
  int iVar2;
  byte bVar3;
  uint _C;
  byte *pbVar4;
  uint _C_00;
  
  pbVar4 = *param_1;
  bVar3 = *param_2;
  do {
    if (bVar3 == 0) {
      param_1[1] = pbVar4;
      return 1;
    }
    if (bVar3 == 0x23) {
      param_1[2] = pbVar4;
      param_1[3] = pbVar4;
      bVar3 = *pbVar4;
      while ((bVar3 != 0 && (iVar1 = isdigit((int)(char)bVar3), iVar1 != 0))) {
        param_1[3] = param_1[3] + 1;
        bVar3 = *param_1[3];
      }
      param_1[3] = param_1[3] + -1;
      pbVar4 = param_1[3];
      if (pbVar4 <= param_1[2] && param_1[2] != pbVar4) {
        return 0;
      }
      pbVar4 = pbVar4 + 1;
    }
    else if (bVar3 == 0x2a) {
      param_1[2] = pbVar4;
      while( true ) {
        param_1[3] = pbVar4;
        if ((*pbVar4 == 0) || (*pbVar4 == 0x20)) break;
        pbVar4 = param_1[3] + 1;
      }
      param_1[3] = pbVar4 + -1;
    }
    else {
      if (bVar3 == 0x40) {
        if (*pbVar4 == 0) {
          return 0;
        }
        param_1[3] = pbVar4;
        param_1[2] = pbVar4;
      }
      else {
        if (bVar3 == 0x5b) {
          _C_00 = (uint)(char)*pbVar4;
          param_2 = param_2 + 1;
          bVar3 = *param_2;
          _C = (uint)(char)bVar3;
          if ((_C_00 & 0xdf) != 0) {
            iVar1 = toupper(_C_00);
            iVar2 = toupper(_C);
            if (iVar1 == iVar2) {
              while ((char)_C != ']') {
                iVar1 = toupper((int)(char)_C_00);
                iVar2 = toupper((int)(char)_C);
                if (iVar2 != iVar1) {
                  return 0;
                }
                pbVar4 = pbVar4 + 1;
                param_2 = param_2 + 1;
                _C_00 = (uint)*pbVar4;
                _C = (uint)*param_2;
              }
              goto LAB_18004253d;
            }
          }
          while (bVar3 != 0x5d) {
            param_2 = param_2 + 1;
            bVar3 = *param_2;
          }
          goto LAB_18004253d;
        }
        if (*pbVar4 == 0) {
          return 0;
        }
        iVar1 = toupper((int)(char)*pbVar4);
        iVar2 = toupper((int)(char)bVar3);
        if (iVar1 != iVar2) {
          return 0;
        }
      }
      pbVar4 = pbVar4 + 1;
    }
LAB_18004253d:
    param_2 = param_2 + 1;
    bVar3 = *param_2;
  } while( true );
}



DWORD CreateTapePartition(HANDLE hDevice,DWORD dwPartitionMethod,DWORD dwCount,DWORD dwSize)

{
  DWORD extraout_EAX;
  undefined auStackY88 [32];
  DWORD local_28;
  DWORD local_24;
  DWORD local_20;
  ulonglong local_18;
  
                    // 0x42580  245  CreateTapePartition
  local_18 = DAT_1800b2220 ^ (ulonglong)auStackY88;
  local_28 = dwPartitionMethod;
  local_24 = dwCount;
  local_20 = dwSize;
  FUN_180066ec4(hDevice,0x1fc028,&local_28,0xc,0,0);
  __security_check_cookie(local_18 ^ (ulonglong)auStackY88);
  return extraout_EAX;
}



DWORD EraseTape(HANDLE hDevice,DWORD dwEraseType,BOOL bImmediate)

{
  DWORD DVar1;
  DWORD local_res20;
  undefined local_res24;
  
                    // 0x425e0  357  EraseTape
  local_res24 = (undefined)bImmediate;
  local_res20 = dwEraseType;
  DVar1 = FUN_180066ec4(hDevice,0x1fc000,&local_res20,8,0,0);
  return DVar1;
}



DWORD GetTapePosition(HANDLE hDevice,DWORD dwPositionType,LPDWORD lpdwPartition,
                     LPDWORD lpdwOffsetLow,LPDWORD lpdwOffsetHigh)

{
  DWORD DVar1;
  DWORD extraout_EAX;
  DWORD DVar2;
  undefined auStackY104 [32];
  DWORD local_38;
  DWORD local_34;
  DWORD local_30;
  DWORD local_2c;
  ulonglong local_28;
  
                    // 0x42620  764  GetTapePosition
  local_28 = DAT_1800b2220 ^ (ulonglong)auStackY104;
  local_38 = dwPositionType;
  DVar1 = FUN_180066ec4(hDevice,0x1f400c,&local_38,0x10,&local_38,0x10);
  DVar2 = 0;
  if (DVar1 == 0) {
    *lpdwPartition = local_34;
    *lpdwOffsetLow = local_30;
    DVar2 = local_2c;
  }
  else {
    *lpdwPartition = 0;
    *lpdwOffsetLow = 0;
  }
  *lpdwOffsetHigh = DVar2;
  __security_check_cookie(local_28 ^ (ulonglong)auStackY104);
  return extraout_EAX;
}



DWORD GetTapeStatus(HANDLE hDevice)

{
  DWORD DVar1;
  
                    // 0x426b0  765  GetTapeStatus
  DVar1 = FUN_180066ec4(hDevice,0x1f4024,0,0,0,0);
  return DVar1;
}



DWORD PrepareTape(HANDLE hDevice,DWORD dwOperation,BOOL bImmediate)

{
  DWORD DVar1;
  DWORD local_res20;
  undefined local_res24;
  
                    // 0x426e0  1070  PrepareTape
  local_res24 = (undefined)bImmediate;
  local_res20 = dwOperation;
  DVar1 = FUN_180066ec4(hDevice,0x1f4004,&local_res20,8,0,0);
  return DVar1;
}



DWORD SetTapeParameters(HANDLE hDevice,DWORD dwOperation,LPVOID lpTapeInformation)

{
  DWORD DVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  
                    // 0x42720  1378  SetTapeParameters
  if (dwOperation == 0) {
    uVar2 = 0x1f4020;
    uVar3 = 4;
  }
  else {
    if (dwOperation != 1) {
      return 1;
    }
    uVar2 = 0x1fc018;
    uVar3 = 8;
  }
  DVar1 = FUN_180066ec4(hDevice,uVar2,lpTapeInformation,uVar3,0,0);
  return DVar1;
}



DWORD SetTapePosition(HANDLE hDevice,DWORD dwPositionMethod,DWORD dwPartition,DWORD dwOffsetLow,
                     DWORD dwOffsetHigh,BOOL bImmediate)

{
  DWORD extraout_EAX;
  undefined auStackY88 [32];
  DWORD local_28;
  DWORD local_24;
  DWORD local_20;
  DWORD local_1c;
  undefined local_18;
  ulonglong local_10;
  
                    // 0x42770  1379  SetTapePosition
  local_10 = DAT_1800b2220 ^ (ulonglong)auStackY88;
  local_1c = dwOffsetHigh;
  local_18 = (undefined)bImmediate;
  local_28 = dwPositionMethod;
  local_24 = dwPartition;
  local_20 = dwOffsetLow;
  FUN_180066ec4(hDevice,0x1f4010,&local_28,0x18,0,0);
  __security_check_cookie(local_10 ^ (ulonglong)auStackY88);
  return extraout_EAX;
}



DWORD WriteTapemark(HANDLE hDevice,DWORD dwTapemarkType,DWORD dwTapemarkCount,BOOL bImmediate)

{
  DWORD extraout_EAX;
  undefined auStackY88 [32];
  DWORD local_28;
  DWORD local_24;
  undefined local_20;
  ulonglong local_18;
  
                    // 0x427e0  1588  WriteTapemark
  local_18 = DAT_1800b2220 ^ (ulonglong)auStackY88;
  local_20 = (undefined)bImmediate;
  local_28 = dwTapemarkType;
  local_24 = dwTapemarkCount;
  FUN_180066ec4(hDevice,0x1fc008,&local_28,0xc,0,0);
  __security_check_cookie(local_18 ^ (ulonglong)auStackY88);
  return extraout_EAX;
}



BOOL CreateHardLinkTransactedA
               (LPCSTR lpFileName,LPCSTR lpExistingFileName,
               LPSECURITY_ATTRIBUTES lpSecurityAttributes,HANDLE hTransaction)

{
  BOOL BVar1;
  undefined8 uVar2;
  undefined local_28 [8];
  LPCWSTR local_20;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x42840  209  CreateHardLinkTransactedA
  uVar2 = Basep8BitStringToDynamicUnicodeString();
  BVar1 = 0;
  if ((int)uVar2 == 0) {
    return 0;
  }
  if (lpExistingFileName == (LPCSTR)0x0) {
    local_20 = (LPCWSTR)0x0;
  }
  else {
    uVar2 = Basep8BitStringToDynamicUnicodeString();
    if ((int)uVar2 == 0) goto LAB_1800428be;
  }
  BVar1 = CreateHardLinkTransactedW(local_10,local_20,lpSecurityAttributes,hTransaction);
  if (lpExistingFileName != (LPCSTR)0x0) {
    RtlFreeUnicodeString(local_28);
  }
LAB_1800428be:
  RtlFreeUnicodeString(local_18);
  return BVar1;
}



// WARNING: Could not reconcile some variable overlaps

int FUN_1800428f0(longlong param_1,undefined2 param_2,HANDLE *param_3)

{
  int iVar1;
  wchar_t *_Str1;
  HANDLE pvVar2;
  longlong lVar3;
  longlong in_GS_OFFSET;
  uint local_res18 [2];
  longlong local_res20;
  undefined4 local_68;
  undefined4 local_64;
  undefined local_60 [4];
  undefined local_5c [12];
  undefined4 uStack80;
  undefined local_4c [12];
  uint uStack64;
  undefined4 uStack60;
  undefined auStack56 [12];
  undefined4 local_2c;
  
  local_60 = 0x38;
  local_res20 = 0;
  lVar3 = 0;
  local_2c = 0;
  _local_5c = ZEXT816(0);
  local_4c = SUB1612(ZEXT816(0),0);
  uStack64 = 0;
  uStack60 = 0;
  auStack56 = SUB1612(ZEXT816(0) >> 0x20,0);
  if ((param_3 == (HANDLE *)0x0) || (*param_3 = (HANDLE)0x0, param_1 == -1)) {
    iVar1 = -0x3ffffff3;
    goto LAB_180042ae5;
  }
  local_64 = 0;
  local_68 = 1;
  iVar1 = RtlQueryInformationActivationContext(0,param_1,&local_68,3,0,0,&local_res20);
  if (iVar1 != -0x3fffffdd) {
    return iVar1;
  }
  if (local_res20 == 0) {
    return -0x3fffffdd;
  }
  lVar3 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_res20);
  if (lVar3 == 0) {
    return -0x3fffffdd;
  }
  iVar1 = RtlQueryInformationActivationContext(0,param_1,&local_68,3,lVar3,local_res20,&local_res20)
  ;
  if (iVar1 < 0) goto LAB_180042ae5;
  if (param_1 == -4) {
    local_5c._0_4_ = local_5c._0_4_ | 0x40;
    _local_5c = ZEXT1214(CONCAT48(uStack80,*(undefined8 *)(lVar3 + 0x40)) &
                         (undefined  [12])0xffffffffffffffff) << 0x20;
  }
  else {
    _Str1 = wcsrchr(*(wchar_t **)(lVar3 + 0x48),L'.');
    if (_Str1 == (wchar_t *)0x0) {
LAB_180042a53:
      iVar1 = RtlQueryInformationActivationContext(0,param_1,0,7,local_res18,4,&local_res20);
      if (iVar1 < 0) goto LAB_180042ae5;
      if (local_res18[0] != 0) {
        uStack64 = local_res18[0] & 0xffff;
        local_5c._0_4_ = local_5c._0_4_ | 8;
        uStack60 = 0;
        goto LAB_180042aa7;
      }
    }
    else {
      iVar1 = _wcsicmp(_Str1,L".Manifest");
      if (iVar1 != 0) goto LAB_180042a53;
    }
  }
LAB_180042aa7:
  _local_5c = CONCAT214(param_2,_local_5c);
  _local_5c = CONCAT124(stack0xffffffffffffffa8,local_5c._0_4_) | (undefined  [16])0x2;
  pvVar2 = CreateActCtxW((PCACTCTXW)local_60);
  if (pvVar2 == (HANDLE)0xffffffffffffffff) {
    iVar1 = *(int *)(*(longlong *)(in_GS_OFFSET + 0x30) + 0x1250);
  }
  else {
    *param_3 = pvVar2;
    iVar1 = 0;
  }
LAB_180042ae5:
  if (lVar3 != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lVar3);
  }
  return iVar1;
}



ulonglong FUN_180042b28(int *param_1,longlong param_2,undefined8 param_3,uint param_4,
                       longlong *param_5,longlong *param_6,longlong *param_7,longlong *param_8,
                       longlong *param_9,longlong *param_10,uint *param_11,longlong param_12,
                       uint *param_13)

{
  undefined4 *puVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  ulonglong uVar5;
  longlong *plVar6;
  longlong lVar7;
  undefined8 uVar8;
  longlong local_res10;
  undefined8 local_res18;
  undefined4 local_58;
  undefined4 uStack84;
  undefined4 uStack80;
  undefined4 uStack76;
  undefined4 local_48;
  undefined4 uStack68;
  undefined4 uStack64;
  undefined4 uStack60;
  
  local_res10 = param_2;
  local_res18 = param_3;
  memset(param_13,0,0x1c8);
  uVar8 = 8;
  lVar7 = param_12 + 0x10;
  uVar4 = NtReadVirtualMemory(param_8[1],lVar7,&local_res10);
  uVar5 = (ulonglong)uVar4;
  if (-1 < (int)uVar4) {
    uVar5 = 0;
    param_8[3] = local_res10;
  }
  if ((int)uVar5 < 0) {
    return uVar5;
  }
  puVar1 = (undefined4 *)*param_7;
  local_58 = *puVar1;
  uStack84 = puVar1[1];
  uStack80 = puVar1[2];
  uStack76 = puVar1[3];
  local_48 = 0x140012;
  uStack68 = 0;
  uStack64 = 0x80085bb0;
  uStack60 = 1;
  uVar5 = FUN_18001db54(*param_5,lVar7,(longlong)&local_58);
  if ((int)uVar5 < 0) {
    return uVar5 & 0xffffffff;
  }
  local_48 = 0x10000e;
  uStack68 = 0;
  uStack64 = 0x80086d88;
  uStack60 = 1;
  uVar5 = FUN_18001db54(*param_9,lVar7,(longlong)&local_58);
  if (-1 < (int)uVar5) {
    puVar1 = (undefined4 *)param_7[1];
    local_58 = *puVar1;
    uStack84 = puVar1[1];
    uStack80 = puVar1[2];
    uStack76 = puVar1[3];
    local_48 = 0x140012;
    uStack68 = 0;
    uStack64 = 0x80085bb0;
    uStack60 = 1;
    uVar5 = FUN_18001db54(param_5[1],lVar7,(longlong)&local_58);
    if ((int)uVar5 < 0) {
      return uVar5 & 0xffffffff;
    }
    local_48 = 0x10000e;
    uStack68 = 0;
    uStack64 = 0x80086d88;
    uStack60 = 1;
    uVar5 = FUN_18001db54(param_9[1],lVar7,(longlong)&local_58);
    if ((int)uVar5 < 0) {
      return uVar5 & 0xffffffff;
    }
    plVar6 = FUN_180014ccc(1,lVar7,param_1,uVar8,1,local_res18,param_4,param_5,param_6,param_7,
                           param_8,1,param_9,param_10,param_13,(longlong *)(param_13 + 2),
                           (undefined2 *)(param_13 + 0x10));
    uVar8 = FUN_180014e10((int)plVar6);
    if (((int)uVar8 != 0) ||
       (uVar8 = FUN_180015214((int)((ulonglong)plVar6 & 0xffffffff)),
       uVar5 = (ulonglong)plVar6 & 0xffffffff, (int)uVar8 != 0)) {
      uVar5 = 0;
    }
    if ((int)uVar5 < 0) {
      return uVar5;
    }
    if (*param_13 != 0) {
      uVar4 = RtlAppendUnicodeStringToString(param_11,*param_7);
      if ((int)uVar4 < 0) {
        return (ulonglong)uVar4;
      }
      uVar4 = RtlpApplyLengthFunction
                        (0,0x10,param_11,RtlGetLengthWithoutLastFullDosOrNtPathElement_exref);
      if ((int)uVar4 < 0) {
        return (ulonglong)uVar4;
      }
      *(undefined2 *)(*(longlong *)(param_11 + 2) + (ulonglong)(*(ushort *)param_11 >> 1) * 2) = 0;
      uVar4 = param_11[1];
      uVar2 = param_11[2];
      uVar3 = param_11[3];
      param_13[0x1e] = *param_11;
      param_13[0x1f] = uVar4;
      param_13[0x20] = uVar2;
      param_13[0x21] = uVar3;
    }
    return 0;
  }
  return uVar5 & 0xffffffff;
}



bool ZombifyActCtxWorker(void)

{
  int iVar1;
  
                    // 0x42d80  1590  ZombifyActCtxWorker
  iVar1 = RtlZombifyActivationContext();
  if (-1 >= iVar1) {
    BaseSetLastNTError();
  }
  return -1 < iVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int GetComPlusPackageInstallStatus(void)

{
  int iVar1;
  int local_res8 [8];
  
                    // 0x42db0  473  GetComPlusPackageInstallStatus
  local_res8[0] = _DAT_7ffe02e0;
  if (_DAT_7ffe02e0 == -1) {
    iVar1 = NtQuerySystemInformation(0x3b,local_res8,4);
    if (iVar1 < 0) {
      local_res8[0] = 0;
    }
  }
  return local_res8[0];
}



undefined8 SetComPlusPackageInstallStatus(uint param_1)

{
  int iVar1;
  undefined8 uVar2;
  uint local_res8 [8];
  
                    // 0x42e00  1261  SetComPlusPackageInstallStatus
  local_res8[0] = param_1;
  if (((param_1 & 0xfffffffe) == 0) && (iVar1 = NtSetSystemInformation(0x3b,local_res8), -1 < iVar1)
     ) {
    uVar2 = 1;
  }
  else {
    BaseSetLastNTError();
    uVar2 = 0;
  }
  return uVar2;
}



void ApplicationRecoveryFinished(int param_1)

{
  undefined8 uVar1;
  int *apiStackX16 [3];
  
                    // 0x42e60  34  ApplicationRecoveryFinished
  apiStackX16[0] = (int *)0x0;
  uVar1 = FUN_18006b804(apiStackX16);
  if ((int)uVar1 < 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpGetRecoveryInfoForSelf failed with 0x%x\n",0xf73,
               (int)uVar1);
    return;
  }
  if (apiStackX16[0][0xc] == 1) {
    apiStackX16[0][0xd] = param_1;
    if (*(HANDLE *)(apiStackX16[0] + 8) != (HANDLE)0x0) {
                    // WARNING: Could not recover jumptable at 0x00018006d563. Too many branches
                    // WARNING: Treating indirect jump as call
      SetEvent(*(HANDLE *)(apiStackX16[0] + 8));
      return;
    }
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR No done event for recovery mode\n",0xf86);
  }
  return;
}



undefined8 ApplicationRecoveryInProgress(undefined4 *param_1)

{
  int *piVar1;
  DWORD DVar2;
  undefined8 uVar3;
  int *piStackX8;
  
                    // 0x42e70  35  ApplicationRecoveryInProgress
  piStackX8 = (int *)0x0;
  if (param_1 == (undefined4 *)0x0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid params\n",0xf33);
    uVar3 = 0x80070057;
  }
  else {
    *param_1 = 0;
    uVar3 = FUN_18006b804(&piStackX8);
    piVar1 = piStackX8;
    if ((int)uVar3 < 0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpGetRecoveryInfoForSelf failed with 0x%x\n",0xf3c
                 ,(int)uVar3);
    }
    else if (piStackX8[0xc] != 0) {
      DVar2 = WaitForSingleObject(*(HANDLE *)(piStackX8 + 10),0);
      if (DVar2 == 0) {
        *param_1 = 1;
      }
      else if (*(HANDLE *)(piVar1 + 6) != (HANDLE)0x0) {
        SetEvent(*(HANDLE *)(piVar1 + 6));
      }
      return 0;
    }
    uVar3 = 0x80004005;
  }
  return uVar3;
}



DWORD GetApplicationRecoveryCallbackWorker
                (HANDLE param_1,undefined8 *param_2,undefined8 *param_3,undefined4 *param_4,
                undefined4 *param_5)

{
  DWORD DVar1;
  undefined8 uVar2;
  undefined4 local_48 [2];
  undefined8 local_40;
  undefined8 local_38;
  undefined4 local_10;
  undefined4 local_c;
  
                    // 0x42e80  450  GetApplicationRecoveryCallbackWorker
  memset(local_48,0,0x40);
  if ((param_1 == (HANDLE)0x0) || (param_2 == (undefined8 *)0x0)) {
    DVar1 = 0x80070057;
  }
  else {
    DVar1 = FUN_18006c6d0(param_1,local_48);
    if (-1 < (int)DVar1) {
      uVar2 = RtlDecodeSystemPointer(local_40);
      *param_2 = uVar2;
      if (param_3 != (undefined8 *)0x0) {
        *param_3 = local_38;
      }
      if (param_4 != (undefined4 *)0x0) {
        *param_4 = local_10;
      }
      if (param_5 != (undefined4 *)0x0) {
        *param_5 = local_c;
      }
    }
  }
  return DVar1;
}



void GetApplicationRestartSettingsWorker
               (HANDLE param_1,short *param_2,uint *param_3,undefined4 *param_4)

{
  DWORD DVar1;
  uint uVar2;
  longlong lVar3;
  uint uVar5;
  undefined auStack2520 [32];
  uint uStack2488;
  undefined auStack2472 [32];
  undefined4 uStack2440;
  int iStack2436;
  short asStack2304 [1124];
  ulonglong uStack56;
  longlong lVar4;
  
                    // 0x42f40  452  GetApplicationRestartSettingsWorker
  uStack56 = DAT_1800b2220 ^ (ulonglong)auStack2520;
  memset(auStack2472,0,0x968);
  if (param_3 == (uint *)0x0) {
LAB_18006c8a0:
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid arg\n",0xd9e);
  }
  else {
    if (param_2 == (short *)0x0) {
      if (*param_3 != 0) goto LAB_18006c8a0;
    }
    else {
      *param_2 = 0;
    }
    DVar1 = FUN_18006b4bc(param_1,auStack2472);
    if (-1 < (int)DVar1) {
      if (iStack2436 == 0) {
        *param_3 = 0;
      }
      else {
        if (param_4 != (undefined4 *)0x0) {
          *param_4 = uStack2440;
        }
        lVar3 = -1;
        do {
          lVar4 = lVar3;
          lVar3 = lVar4 + 1;
        } while (asStack2304[lVar3] != 0);
        uVar5 = (int)lVar4 + 2;
        if (*param_3 < uVar5) {
          *param_3 = uVar5;
        }
        else {
          if (param_2 != (short *)0x0) {
            if ((int)lVar3 == 0) {
              *param_2 = 0;
            }
            else {
              uVar2 = FUN_18001cf30(param_2,(ulonglong)*param_3,asStack2304);
              if ((int)uVar2 < 0) {
                uStack2488 = uVar2;
                DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR StringCchCopy failed with 0x%x\n",0xdd2);
                goto LAB_18006c8c5;
              }
            }
          }
          *param_3 = uVar5;
        }
      }
    }
  }
LAB_18006c8c5:
  __security_check_cookie(uStack56 ^ (ulonglong)auStack2520);
  return;
}



// WARNING: Could not reconcile some variable overlaps

HRESULT UnregisterApplicationRecoveryCallback(void)

{
  bool bVar1;
  int iVar2;
  uint uVar3;
  undefined7 extraout_var;
  longlong lVar4;
  undefined8 uVar5;
  HANDLE pvVar6;
  HRESULT HVar7;
  char *pcVar8;
  undefined auStack56 [16];
  undefined8 uStack40;
  
  HVar7 = -0x7fffbffb;
  auStack56 = ZEXT816(0);
  uStack40 = 0;
  bVar1 = FUN_18002189c();
  if ((int)CONCAT71(extraout_var,bVar1) == 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid state\n",0x96c);
    return -0x7ff8ec61;
  }
  lVar4 = FUN_18001ce80();
  if (lVar4 == 0) {
    uVar5 = 0x974;
    pcVar8 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
LAB_180034e48:
    DbgPrintEx(0x96,0,pcVar8,uVar5);
    return -0x7fffbffb;
  }
  iVar2 = FUN_18001ce14();
  if (iVar2 < 0) {
    uVar5 = 0x97a;
    pcVar8 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
    goto LAB_180034e48;
  }
  iVar2 = FUN_18001ccd4();
  if (iVar2 < 0) {
    uVar5 = 0x980;
    pcVar8 = "WER/CrashAPI:%u: ERROR WerpInitPEBStore failed\n";
    goto LAB_180034e48;
  }
  lVar4 = *(longlong *)(lVar4 + 0x358);
  if ((lVar4 == 0) || (uVar3 = FUN_18001cc84(lVar4), (int)uVar3 < 0)) {
    uVar5 = 0x98b;
    pcVar8 = "WER/CrashAPI:%u: ERROR Invalid PEB entry\n";
  }
  else {
    *(undefined4 *)(lVar4 + 0x8a8) = 0x40;
    uVar5 = RtlEncodeSystemPointer(0);
    *(undefined8 *)(lVar4 + 0x8b0) = uVar5;
    *(undefined8 *)(lVar4 + 0x8b8) = 0;
    *(undefined4 *)(lVar4 + 0x8e0) = 0;
    *(undefined4 *)(lVar4 + 0x8e4) = 0;
    auStack56 = CONCAT124(auStack56._4_12_,0x18);
    auStack56 = auStack56 & (undefined  [16])0xffffffffffffffff;
    uStack40 = CONCAT44(uStack40._4_4_,1);
    if (*(longlong *)(lVar4 + 0x8c0) != 0) {
LAB_1800217ca:
      if (*(longlong *)(lVar4 + 0x8c8) == 0) {
        pvVar6 = CreateEventW((LPSECURITY_ATTRIBUTES)auStack56,1,0,(LPCWSTR)0x0);
        *(HANDLE *)(lVar4 + 0x8c8) = pvVar6;
        if (pvVar6 == (HANDLE)0x0) {
          uVar5 = 0x9be;
          goto LAB_18002183a;
        }
      }
      if (*(longlong *)(lVar4 + 0x8d0) == 0) {
        pvVar6 = CreateEventW((LPSECURITY_ATTRIBUTES)auStack56,1,0,(LPCWSTR)0x0);
        *(HANDLE *)(lVar4 + 0x8d0) = pvVar6;
        if (pvVar6 == (HANDLE)0x0) {
          uVar5 = 0x9cd;
          goto LAB_18002183a;
        }
      }
      HVar7 = 0;
      goto LAB_18002186c;
    }
    pvVar6 = CreateEventW((LPSECURITY_ATTRIBUTES)auStack56,0,0,(LPCWSTR)0x0);
    *(HANDLE *)(lVar4 + 0x8c0) = pvVar6;
    if (pvVar6 != (HANDLE)0x0) goto LAB_1800217ca;
    uVar5 = 0x9af;
LAB_18002183a:
    pcVar8 = "WER/CrashAPI:%u: ERROR Unable to create the m_hAliveEvent event\n";
  }
  DbgPrintEx(0x96,0,pcVar8,uVar5);
LAB_18002186c:
  RtlReleasePebLock();
  return HVar7;
}



void WerGetFlags(HANDLE param_1,undefined4 *param_2)

{
  undefined auStack2488 [32];
  DWORD DStack2456;
  undefined auStack2440 [2324];
  undefined4 uStack116;
  ulonglong uStack24;
  
                    // 0x42f70  1525  WerGetFlags
                    // 0x42f70  1526  WerGetFlagsWorker
  uStack24 = DAT_1800b2220 ^ (ulonglong)auStack2488;
  memset(auStack2440,0,0x968);
  if ((param_1 == (HANDLE)0x0) || (param_2 == (undefined4 *)0x0)) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid params\n",0x1013);
  }
  else {
    DStack2456 = FUN_18006b4bc(param_1,auStack2440);
    if (-1 < (int)DStack2456) {
      *param_2 = uStack116;
      DStack2456 = 0;
    }
  }
  __security_check_cookie(uStack24 ^ (ulonglong)auStack2488);
  return;
}



uint WerRegisterFileWorker(wchar_t *param_1,int param_2,uint param_3)

{
  ulonglong uVar1;
  bool bVar2;
  int iVar3;
  undefined7 extraout_var;
  longlong lVar4;
  wchar_t *pwVar6;
  longlong *_Dst;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  undefined8 uVar10;
  undefined8 uVar11;
  wchar_t *pwVar12;
  longlong lVar5;
  
                    // 0x42f80  1532  WerRegisterFileWorker
  _Dst = (longlong *)0x0;
  uVar10 = 0;
  uVar11 = 0;
  bVar2 = FUN_18002189c();
  if ((int)CONCAT71(extraout_var,bVar2) == 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid state\n",0x8c2);
    uVar7 = 0x8007139f;
  }
  else {
    if (param_1 == (wchar_t *)0x0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid params\n",0x8c8);
    }
    else if (((param_3 & 0xfffffffc) == 0) && (param_2 - 1U < 2)) {
      lVar4 = -1;
      do {
        lVar5 = lVar4;
        lVar4 = lVar5 + 1;
      } while (param_1[lVar4] != L'\0');
      uVar7 = (int)lVar5 + 2;
      if (uVar7 < (uint)lVar4) {
        uVar10 = 0x8de;
      }
      else {
        uVar1 = (ulonglong)uVar7 * 2;
        if (uVar1 < 0x100000000) {
          uVar8 = (int)uVar1 + 0x20;
          uVar7 = 0xffffffff;
          if (uVar8 >= 0x20) {
            uVar7 = uVar8;
          }
          uVar9 = -(uint)(uVar8 < 0x20) & 0x80070216;
          if (uVar8 < 0x20) {
            DbgPrintEx(0x96,0,
                       "WER/CrashAPI:%u: ERROR Arithmetic overflow when calculating allocation size\n"
                       ,0x8ee,uVar9,uVar10,uVar11);
            return uVar9;
          }
          if (0x228 < uVar7) {
            DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Final gather block size exceeds limit\n",0x8f4
                       ,uVar9,uVar10,uVar11);
            return 0x800700ce;
          }
          iVar3 = FUN_18001ccd4();
          if (-1 < iVar3) {
            FUN_18006dbd8(param_1);
            pwVar6 = FUN_18006b700();
            if (pwVar6 == (wchar_t *)0x0) {
              DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Unable to get the heap handle\n",0x90c,uVar9
                         ,uVar10,0);
              uVar7 = 0x80004005;
            }
            else {
              pwVar12 = pwVar6;
              _Dst = FUN_18006e27c((longlong)pwVar6,(ulonglong)uVar7);
              if (_Dst == (longlong *)0x0) {
                DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR OOM\n",0x916,uVar9,0,pwVar12);
                uVar7 = 0x8007000e;
              }
              else {
                memset(_Dst,0,(ulonglong)uVar7);
                *(ushort *)(_Dst + 1) = *(ushort *)(_Dst + 1) & 0x3fff;
                *(ushort *)(_Dst + 1) = *(ushort *)(_Dst + 1) | 0x4000;
                *(ushort *)(_Dst + 2) = *(ushort *)(_Dst + 2) & 0x8000;
                *(ushort *)(_Dst + 2) = *(ushort *)(_Dst + 2) | (ushort)param_3 & 0x7fff;
                *(ushort *)(_Dst + 1) = *(ushort *)(_Dst + 1) & 0xc000;
                *(ushort *)(_Dst + 1) = *(ushort *)(_Dst + 1) | (ushort)uVar7 & 0x3fff;
                if (param_2 == 1) {
                  *(ushort *)(_Dst + 2) = *(ushort *)(_Dst + 2) & 0x7fff;
                }
                else if (param_2 == 2) {
                  *(ushort *)(_Dst + 2) = *(ushort *)(_Dst + 2) | 0x8000;
                }
                uVar7 = FUN_18006b158((short *)((longlong)_Dst + 0x12),uVar1 & 0xffffffff,param_1);
                if (-1 < (int)uVar7) {
                  uVar10 = FUN_18006b1a4(_Dst);
                  uVar7 = (uint)uVar10;
                }
              }
            }
            if (-1 < (int)uVar7) {
              return uVar7;
            }
            if (_Dst == (longlong *)0x0) {
              return uVar7;
            }
            FUN_18006e550((longlong)pwVar6,(longlong)_Dst);
            return uVar7;
          }
          DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpInitPEBStore failed\n",0x8fa,uVar9,uVar10,
                     uVar11);
          return 0x80004005;
        }
        uVar10 = 0x8e6;
      }
      DbgPrintEx(0x96,0,
                 "WER/CrashAPI:%u: ERROR Arithmetic overflow when calculating filename size\n",
                 uVar10);
      return 0x80070216;
    }
    uVar7 = 0x80070057;
  }
  return uVar7;
}



ulonglong WerRegisterMemoryBlockWorker(longlong param_1,uint param_2)

{
  bool bVar1;
  int iVar2;
  undefined7 extraout_var;
  wchar_t *pwVar3;
  undefined (*pauVar4) [16];
  ulonglong uVar5;
  char *pcVar6;
  undefined4 uVar7;
  undefined8 uVar8;
  undefined8 uVar9;
  wchar_t *pwVar10;
  
                    // 0x42f90  1534  WerRegisterMemoryBlockWorker
  uVar5 = 0x80004005;
  uVar7 = 0x80004005;
  pauVar4 = (undefined (*) [16])0x0;
  uVar8 = 0;
  uVar9 = 0;
  if ((param_1 == 0) || (param_2 == 0)) {
    uVar8 = 0xa5b;
    pcVar6 = "WER/CrashAPI:%u: ERROR Invalid args passed\n";
  }
  else {
    if (param_2 < 0x10001) {
      bVar1 = FUN_18002189c();
      if ((int)CONCAT71(extraout_var,bVar1) == 0) {
        DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid state\n",0xa69,uVar7,uVar8,uVar9);
        return 0x8007139f;
      }
      iVar2 = FUN_18001ccd4();
      if (iVar2 < 0) {
        DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpInitPEBStore failed\n",0xa6f,uVar7,uVar8,uVar9
                  );
        return 0x80004005;
      }
      FUN_18006dd48(param_1);
      pwVar3 = FUN_18006b700();
      if (pwVar3 == (wchar_t *)0x0) {
        DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpGetHeapHandle returned NULL\n",0xa86,uVar7,
                   uVar8,0);
      }
      else {
        pwVar10 = pwVar3;
        pauVar4 = (undefined (*) [16])FUN_18006e27c((longlong)pwVar3,0x20);
        if (pauVar4 == (undefined (*) [16])0x0) {
          DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR OOM\n",0xa90,uVar7,0,pwVar10);
          uVar5 = 0x8007000e;
        }
        else {
          *pauVar4 = ZEXT816(0);
          pauVar4[1] = ZEXT816(0);
          *(ushort *)(*pauVar4 + 8) = *(ushort *)(*pauVar4 + 8) & 0x3fff;
          *(longlong *)pauVar4[1] = param_1;
          *(uint *)(pauVar4[1] + 8) = param_2;
          *(ushort *)(*pauVar4 + 8) = *(ushort *)(*pauVar4 + 8) & 0xc020;
          *(ushort *)(*pauVar4 + 8) = *(ushort *)(*pauVar4 + 8) | 0x20;
          uVar5 = FUN_18006b1a4((undefined8 *)pauVar4);
          uVar5 = uVar5 & 0xffffffff;
        }
      }
      if (-1 < (int)uVar5) {
        return uVar5;
      }
      if (pauVar4 == (undefined (*) [16])0x0) {
        return uVar5;
      }
      FUN_18006e550((longlong)pwVar3,(longlong)pauVar4);
      return uVar5;
    }
    uVar8 = 0xa63;
    pcVar6 = "WER/CrashAPI:%u: ERROR Invalid args, too  big block\n";
  }
  DbgPrintEx(0x96,0,pcVar6,uVar8,0x80004005,0,0);
  return 0x80070057;
}



ulonglong WerRegisterRuntimeExceptionModuleWorker(longlong param_1,longlong param_2)

{
  bool bVar1;
  int iVar2;
  uint uVar3;
  undefined7 extraout_var;
  longlong lVar4;
  wchar_t *pwVar5;
  longlong *_Dst;
  ulonglong uVar6;
  char *pcVar7;
  int aiStackX24 [4];
  undefined4 uVar8;
  undefined8 uVar9;
  longlong *plVar10;
  undefined8 uVar11;
  wchar_t *pwVar12;
  
                    // 0x42fa0  1536  WerRegisterRuntimeExceptionModuleWorker
  uVar6 = 0x80004005;
  uVar8 = 0x80004005;
  _Dst = (longlong *)0x0;
  uVar9 = 0;
  uVar11 = 0;
  aiStackX24[0] = 0;
  bVar1 = FUN_18002189c();
  if ((int)CONCAT71(extraout_var,bVar1) == 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid state\n",0x14dd,uVar8,uVar9,uVar11);
    return 0x8007139f;
  }
  if (param_1 == 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid arguments in call to function\n",0x14e3,uVar8,
               uVar9,uVar11);
    return 0x80070057;
  }
  iVar2 = FUN_18001ccd4();
  if (iVar2 < 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpInitPEBStore failed\n",0x14e9,uVar8,uVar9,uVar11);
    return 0x80004005;
  }
  lVar4 = -1;
  do {
    lVar4 = lVar4 + 1;
  } while (*(short *)(param_1 + lVar4 * 2) != 0);
  iVar2 = (int)lVar4 * 2;
  uVar3 = iVar2 + 0x1a;
  pwVar5 = FUN_18006b700();
  if (pwVar5 == (wchar_t *)0x0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Unable to get the heap handle\n",0x14fd,uVar8,uVar9,0)
    ;
  }
  else {
    pwVar12 = pwVar5;
    _Dst = FUN_18006e27c((longlong)pwVar5,(ulonglong)uVar3);
    if (_Dst == (longlong *)0x0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR OOM\n",0x1507,uVar8,0,pwVar12);
      uVar6 = 0x8007000e;
    }
    else {
      plVar10 = _Dst;
      memset(_Dst,0,(ulonglong)uVar3);
      _Dst[2] = param_2;
      *(uint *)(_Dst + 1) = uVar3;
      uVar3 = FUN_18006b158((short *)(_Dst + 3),(ulonglong)(iVar2 + 2),param_1);
      uVar6 = (ulonglong)uVar3;
      if ((int)uVar3 < 0) {
        uVar9 = 0x151d;
        pcVar7 = "WER/CrashAPI:%u: ERROR StringCbCopy failed\n";
      }
      else {
        uVar6 = FUN_18006b2e4(_Dst,aiStackX24);
        uVar3 = (uint)uVar6;
        uVar6 = uVar6 & 0xffffffff;
        if (-1 < (int)uVar3) goto LAB_18006db70;
        uVar9 = 0x1528;
        pcVar7 = "WER/CrashAPI:%u: ERROR Failed register runtime crash dll\n";
      }
      DbgPrintEx(0x96,0,pcVar7,uVar9,uVar3,plVar10,pwVar12);
    }
  }
LAB_18006db70:
  if ((((int)uVar6 < 0) || (aiStackX24[0] != 0)) && (_Dst != (longlong *)0x0)) {
    FUN_18006e550((longlong)pwVar5,(longlong)_Dst);
  }
  return uVar6;
}



ulonglong WerUnregisterFileWorker(wchar_t *param_1)

{
  bool bVar1;
  int iVar2;
  uint uVar3;
  undefined7 extraout_var;
  longlong lVar4;
  ulonglong uVar5;
  char *pcVar6;
  undefined8 uVar7;
  undefined8 *puStackX8;
  undefined8 *puStackX16;
  
                    // 0x42fb0  1544  WerUnregisterFileWorker
  puStackX16 = (undefined8 *)0x0;
  puStackX8 = (undefined8 *)0x0;
  uVar5 = 0x80004005;
  if (param_1 == (wchar_t *)0x0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid args\n",0x621);
    uVar5 = 0x80070057;
  }
  else {
    bVar1 = FUN_18002189c();
    if ((int)CONCAT71(extraout_var,bVar1) == 0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid state\n",0x627);
      uVar5 = 0x8007139f;
    }
    else {
      lVar4 = FUN_18001ce80();
      if (lVar4 == 0) {
        uVar7 = 0x62f;
        pcVar6 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
      }
      else {
        iVar2 = FUN_18001ce14();
        if (-1 < iVar2) {
          lVar4 = *(longlong *)(lVar4 + 0x358);
          if ((lVar4 == 0) || (uVar3 = FUN_18001cc84(lVar4), (int)uVar3 < 0)) {
            DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR PEB is not initialized\n",0x63f);
          }
          else {
            uVar3 = FUN_18006bf74(param_1,&puStackX16,&puStackX8);
            uVar5 = (ulonglong)uVar3;
            if (uVar3 == 0) {
              uVar5 = FUN_18006bebc(lVar4,puStackX16,puStackX8);
              uVar5 = uVar5 & 0xffffffff;
            }
          }
          RtlReleasePebLock();
          return uVar5;
        }
        uVar7 = 0x635;
        pcVar6 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
      }
      DbgPrintEx(0x96,0,pcVar6,uVar7);
    }
  }
  return uVar5;
}



ulonglong WerUnregisterMemoryBlockWorker(longlong param_1)

{
  bool bVar1;
  int iVar2;
  uint uVar3;
  undefined7 extraout_var;
  longlong lVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  char *pcVar7;
  undefined8 uVar8;
  undefined8 *puStackX8;
  undefined8 *puStackX24;
  
                    // 0x42fc0  1546  WerUnregisterMemoryBlockWorker
  puStackX24 = (undefined8 *)0x0;
  puStackX8 = (undefined8 *)0x0;
  uVar6 = 0x80070490;
  if (param_1 == 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid args\n",0xb02);
    return 0x80070057;
  }
  bVar1 = FUN_18002189c();
  if ((int)CONCAT71(extraout_var,bVar1) != 0) {
    lVar4 = FUN_18001ce80();
    if (lVar4 == 0) {
      uVar8 = 0xb10;
      pcVar7 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
    }
    else {
      iVar2 = FUN_18001ce14();
      if (-1 < iVar2) {
        lVar4 = *(longlong *)(lVar4 + 0x358);
        if ((lVar4 == 0) || (uVar3 = FUN_18001cc84(lVar4), (int)uVar3 < 0)) {
          DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR PEB is not initialized\n",0xb20);
        }
        else {
          uVar5 = FUN_18006c0c0(param_1,&puStackX24,&puStackX8);
          uVar6 = uVar5 & 0xffffffff;
          if ((int)uVar5 == 0) {
            uVar6 = FUN_18006bebc(lVar4,puStackX24,puStackX8);
            uVar6 = uVar6 & 0xffffffff;
          }
        }
        RtlReleasePebLock();
        return uVar6;
      }
      uVar8 = 0xb16;
      pcVar7 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
    }
    DbgPrintEx(0x96,0,pcVar7,uVar8);
    return 0x80004005;
  }
  DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid state\n",0xb08);
  return 0x8007139f;
}



undefined8 WerUnregisterRuntimeExceptionModuleWorker(longlong param_1,longlong param_2)

{
  short sVar1;
  short sVar2;
  int iVar3;
  uint uVar4;
  longlong lVar5;
  wchar_t *pwVar6;
  undefined8 *puVar7;
  undefined8 *puVar8;
  undefined8 *puVar9;
  undefined8 uVar10;
  char *pcVar11;
  undefined8 uVar12;
  longlong lVar13;
  
                    // 0x42fd0  1548  WerUnregisterRuntimeExceptionModuleWorker
  uVar10 = 0x80004005;
  if (param_1 == 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid arguments in call to function\n",0x1557);
    return 0x80070057;
  }
  lVar5 = FUN_18001ce80();
  if (lVar5 == 0) {
    uVar10 = 0x155f;
    pcVar11 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
LAB_18006df37:
    DbgPrintEx(0x96,0,pcVar11,uVar10);
    return 0x80004005;
  }
  iVar3 = FUN_18001ce14();
  if (iVar3 < 0) {
    uVar10 = 0x1567;
    pcVar11 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
    goto LAB_18006df37;
  }
  lVar5 = *(longlong *)(lVar5 + 0x358);
  if ((lVar5 == 0) || (uVar4 = FUN_18001cc84(lVar5), (int)uVar4 < 0)) {
    uVar12 = 0x1571;
    pcVar11 = "WER/CrashAPI:%u: ERROR Invalid PEB entry\n";
  }
  else {
    pwVar6 = FUN_18006b700();
    if (pwVar6 != (wchar_t *)0x0) {
      puVar8 = *(undefined8 **)(lVar5 + 0x8f8);
      puVar9 = (undefined8 *)0x0;
      while (puVar7 = puVar8, puVar7 != (undefined8 *)0x0) {
        puVar8 = puVar7 + 3;
        lVar13 = param_1 - (longlong)puVar8;
        do {
          sVar1 = *(short *)puVar8;
          sVar2 = *(short *)((longlong)puVar8 + lVar13);
          if (sVar1 != sVar2) break;
          puVar8 = (undefined8 *)((longlong)puVar8 + 2);
        } while (sVar2 != 0);
        if ((sVar1 == sVar2) && (puVar7[2] == param_2)) {
          if (puVar9 == (undefined8 *)0x0) {
            *(undefined8 *)(lVar5 + 0x8f8) = *puVar7;
          }
          else {
            *puVar9 = *puVar7;
          }
          FUN_18006e550((longlong)pwVar6,(longlong)puVar7);
          uVar10 = 0;
          goto LAB_18006e02f;
        }
        puVar9 = puVar7;
        puVar8 = (undefined8 *)*puVar7;
      }
      uVar10 = 0x80070002;
      goto LAB_18006e02f;
    }
    uVar12 = 0x157c;
    pcVar11 = "WER/CrashAPI:%u: ERROR Unable to get the heap handle\n";
  }
  DbgPrintEx(0x96,0,pcVar11,uVar12);
LAB_18006e02f:
  RtlReleasePebLock();
  return uVar10;
}



undefined8 WerpInitiateRemoteRecovery(void)

{
                    // 0x42fe0  1550  WerpInitiateRemoteRecovery
  FUN_18006e1f8();
  return 0;
}



BOOL GetProcessWorkingSetSize
               (HANDLE hProcess,PSIZE_T lpMinimumWorkingSetSize,PSIZE_T lpMaximumWorkingSetSize)

{
  BOOL BVar1;
  DWORD local_res20 [2];
  
                    // 0x43000  715  GetProcessWorkingSetSize
  BVar1 = GetProcessWorkingSetSizeEx
                    (hProcess,lpMinimumWorkingSetSize,lpMaximumWorkingSetSize,local_res20);
  return BVar1;
}



BOOL MapUserPhysicalPagesScatter
               (PVOID *VirtualAddresses,ULONG_PTR NumberOfPages,PULONG_PTR PageArray)

{
  int iVar1;
  
                    // 0x43030  997  MapUserPhysicalPagesScatter
  iVar1 = NtMapUserPhysicalPagesScatter();
  if (-1 >= iVar1) {
    BaseSetLastNTError();
  }
  return (uint)(-1 < iVar1);
}



BOOL SetProcessWorkingSetSize
               (HANDLE hProcess,SIZE_T dwMinimumWorkingSetSize,SIZE_T dwMaximumWorkingSetSize)

{
  BOOL BVar1;
  
                    // 0x43060  1368  SetProcessWorkingSetSize
                    // WARNING: Could not recover jumptable at 0x000180043063. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = SetProcessWorkingSetSizeEx(hProcess,dwMinimumWorkingSetSize,dwMaximumWorkingSetSize,0);
  return BVar1;
}



BOOL CancelTimerQueueTimer(HANDLE TimerQueue,HANDLE Timer)

{
  BOOL BVar1;
  
                    // 0x43080  120  CancelTimerQueueTimer
  BVar1 = DeleteTimerQueueTimer(TimerQueue,Timer,(HANDLE)0x0);
  if (BVar1 == 0) {
    GetLastError();
  }
  return (uint)(BVar1 != 0);
}



HANDLE SetTimerQueueTimer(HANDLE TimerQueue,WAITORTIMERCALLBACK Callback,PVOID Parameter,
                         DWORD DueTime,DWORD Period,BOOL PreferIo)

{
  BOOL BVar1;
  HANDLE local_18 [3];
  
                    // 0x430c0  1406  SetTimerQueueTimer
  BVar1 = CreateTimerQueueTimer
                    (local_18,TimerQueue,Callback,Parameter,DueTime,Period,(uint)(PreferIo != 0));
  return (HANDLE)(-(ulonglong)(BVar1 != 0) & (ulonglong)local_18[0]);
}



undefined4 BasepReportFault(int **param_1)

{
  int iVar1;
  bool bVar2;
  undefined4 uVar3;
  undefined7 extraout_var;
  int iVar4;
  int iVar5;
  longlong in_GS_OFFSET;
  
                    // 0x43120  102  BasepReportFault
  bVar2 = FUN_18006f1b4(param_1);
  if ((int)CONCAT71(extraout_var,bVar2) == 0) {
    return 8;
  }
  uVar3 = 3;
  NtSetSystemInformation(0xb1,0,0);
  if (param_1 == (int **)0x0) {
    DbgPrintEx(0x96,0,"WER/ReportFault:%u: ERROR Invalid params passed\n",0x503);
  }
  else {
    if (DAT_1800b3210 < 1) {
      iVar5 = 0;
      iVar4 = 0;
      iVar1 = *(int *)(*(longlong *)(in_GS_OFFSET + 0x30) + 0x48);
      do {
        LOCK();
        uVar3 = 3;
        if (DAT_1800b2d38 == 0) goto LAB_18006f29a;
        if (DAT_1800b2d38 == iVar1) goto LAB_18006f2a8;
        iVar5 = 8;
        Sleep(1000);
        iVar4 = iVar4 + 1;
      } while (iVar4 < 10);
      iVar5 = 3;
      iVar1 = DAT_1800b2d38;
LAB_18006f29a:
      DAT_1800b2d38 = iVar1;
      if (iVar5 == 0) {
        uVar3 = FUN_18006f2e0(param_1);
      }
LAB_18006f2a8:
      DAT_1800b3210 = DAT_1800b3210 + 1;
    }
    else {
      uVar3 = 8;
    }
    DAT_1800b2d38 = 0;
  }
  return uVar3;
}



DWORD DisableThreadProfiling(HANDLE PerformanceDataHandle)

{
  int iVar1;
  DWORD DVar2;
  
                    // 0x43160  295  DisableThreadProfiling
  iVar1 = RtlDisableThreadProfiling();
  if (iVar1 < 0) {
                    // WARNING: Could not recover jumptable at 0x00018004317a. Too many branches
                    // WARNING: Treating indirect jump as call
    DVar2 = RtlNtStatusToDosErrorNoTeb(iVar1);
    return DVar2;
  }
  return 0;
}



DWORD EnableThreadProfiling
                (HANDLE ThreadHandle,DWORD Flags,DWORD64 HardwareCounters,
                HANDLE *PerformanceDataHandle)

{
  int iVar1;
  DWORD DVar2;
  
                    // 0x431a0  308  EnableThreadProfiling
  iVar1 = RtlEnableThreadProfiling();
  if (iVar1 < 0) {
                    // WARNING: Could not recover jumptable at 0x0001800431ba. Too many branches
                    // WARNING: Treating indirect jump as call
    DVar2 = RtlNtStatusToDosErrorNoTeb(iVar1);
    return DVar2;
  }
  return 0;
}



DWORD QueryThreadProfiling(HANDLE ThreadHandle,PBOOLEAN Enabled)

{
  int iVar1;
  DWORD DVar2;
  
                    // 0x431e0  1113  QueryThreadProfiling
  iVar1 = RtlQueryThreadProfiling();
  if (iVar1 < 0) {
                    // WARNING: Could not recover jumptable at 0x0001800431fa. Too many branches
                    // WARNING: Treating indirect jump as call
    DVar2 = RtlNtStatusToDosErrorNoTeb(iVar1);
    return DVar2;
  }
  return 0;
}



DWORD ReadThreadProfilingData
                (HANDLE PerformanceDataHandle,DWORD Flags,PPERFORMANCE_DATA PerformanceData)

{
  int iVar1;
  DWORD DVar2;
  
                    // 0x43220  1150  ReadThreadProfilingData
  iVar1 = RtlReadThreadProfilingData();
  if (iVar1 < 0) {
                    // WARNING: Could not recover jumptable at 0x00018004323a. Too many branches
                    // WARNING: Treating indirect jump as call
    DVar2 = RtlNtStatusToDosErrorNoTeb(iVar1);
    return DVar2;
  }
  return 0;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180043254(HFILE param_1,HFILE param_2,LONG param_3,longlong param_4)

{
  undefined (*pauVar1) [16];
  short sVar2;
  short sVar3;
  undefined2 uVar4;
  undefined2 uVar5;
  undefined4 uVar6;
  ulonglong **ppuVar7;
  undefined8 *puVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  undefined4 uVar12;
  undefined4 uVar13;
  undefined4 uVar14;
  undefined4 uVar15;
  undefined4 uVar16;
  bool bVar17;
  HFILE HVar18;
  HFILE hFile;
  ulonglong *puVar19;
  uint uVar20;
  LONG LVar21;
  LONG LVar22;
  int iVar23;
  int *piVar24;
  ulonglong *puVar25;
  short *psVar26;
  char *pcVar27;
  ulonglong *puVar28;
  ulonglong *puVar29;
  ulonglong *puVar30;
  undefined (*pauVar31) [16];
  undefined8 *puVar32;
  undefined (*pauVar33) [16];
  undefined8 *puVar34;
  longlong *plVar35;
  ulonglong *puVar36;
  uint *puVar37;
  longlong lVar38;
  undefined8 *puVar39;
  uint uVar40;
  undefined8 *puVar41;
  uint uVar42;
  ulonglong **ppuVar43;
  undefined (*pauVar44) [16];
  undefined8 *puVar45;
  longlong lVar46;
  int iVar47;
  ulonglong uVar48;
  uint uVar49;
  uint uVar50;
  ulonglong uVar51;
  uint uVar52;
  longlong in_GS_OFFSET;
  undefined auStackY920 [32];
  ulonglong *local_340;
  uint local_338;
  uint local_334;
  uint local_330;
  uint local_32c;
  HFILE local_328;
  uint local_324;
  undefined8 local_320;
  uint local_318;
  undefined8 *local_310;
  LONG local_308;
  undefined8 *local_300;
  ulonglong *local_2f8;
  ulonglong *local_2f0;
  LONG local_2e8;
  longlong local_2e0;
  int local_2d8;
  uint local_2d4;
  uint local_2d0;
  char *local_2c8;
  ulonglong *local_2c0;
  ulonglong *local_2b8;
  ulonglong *local_2b0;
  undefined (*local_2a8) [16];
  HFILE local_2a0;
  uint local_29c;
  undefined (*local_298) [16];
  undefined8 *local_290;
  ulonglong *local_288;
  undefined8 local_278;
  int iStack620;
  int local_258;
  uint uStack576;
  int iStack572;
  uint local_228;
  uint uStack548;
  uint local_1f0 [4];
  undefined4 local_1e0;
  uint local_1dc;
  undefined4 local_1c8;
  int local_1bc;
  undefined8 local_168;
  int iStack300;
  uint uStack276;
  undefined8 local_b0;
  ulonglong local_58;
  
  local_58 = DAT_1800b2220 ^ (ulonglong)auStackY920;
  uVar50 = 0;
  uVar20 = 0xffffffff;
  local_320 = CONCAT44(local_320._4_4_,0xffffffff);
  local_2c0 = (ulonglong *)0xffffffff;
  local_290 = (undefined8 *)0x0;
  local_32c = 0;
  local_310 = (undefined8 *)((ulonglong)local_310 & 0xffffffff00000000);
  local_300 = (undefined8 *)((ulonglong)local_300 & 0xffffffff00000000);
  local_330 = 0;
  local_318 = 0;
  local_2f0 = (ulonglong *)((ulonglong)local_2f0 & 0xffffffff00000000);
  local_2e8 = 0;
  local_324 = 0;
  local_298 = (undefined (*) [16])0x0;
  local_2d4 = 0;
  local_328 = param_1;
  local_308 = param_3;
  local_2e0 = param_4;
  local_2a0 = param_2;
  _llseek(param_1,param_3,0);
  _hread(param_1,&local_168,0x108);
  lVar38 = 2;
  local_2d8 = ((uint)local_168._6_2_ + (uint)local_168._6_2_ * 4) * 8 + param_3 + 0x108;
  puVar32 = &local_168;
  puVar34 = &local_278;
  do {
    uVar6 = *(undefined4 *)((longlong)puVar32 + 4);
    uVar9 = *(undefined4 *)(puVar32 + 1);
    uVar10 = *(undefined4 *)((longlong)puVar32 + 0xc);
    uVar11 = *(undefined4 *)(puVar32 + 2);
    uVar12 = *(undefined4 *)((longlong)puVar32 + 0x14);
    uVar13 = *(undefined4 *)(puVar32 + 3);
    uVar14 = *(undefined4 *)((longlong)puVar32 + 0x1c);
    *(undefined4 *)puVar34 = *(undefined4 *)puVar32;
    *(undefined4 *)((longlong)puVar34 + 4) = uVar6;
    *(undefined4 *)(puVar34 + 1) = uVar9;
    *(undefined4 *)((longlong)puVar34 + 0xc) = uVar10;
    uVar6 = *(undefined4 *)(puVar32 + 4);
    uVar9 = *(undefined4 *)((longlong)puVar32 + 0x24);
    uVar10 = *(undefined4 *)(puVar32 + 5);
    uVar15 = *(undefined4 *)((longlong)puVar32 + 0x2c);
    *(undefined4 *)(puVar34 + 2) = uVar11;
    *(undefined4 *)((longlong)puVar34 + 0x14) = uVar12;
    *(undefined4 *)(puVar34 + 3) = uVar13;
    *(undefined4 *)((longlong)puVar34 + 0x1c) = uVar14;
    uVar11 = *(undefined4 *)(puVar32 + 6);
    uVar12 = *(undefined4 *)((longlong)puVar32 + 0x34);
    uVar13 = *(undefined4 *)(puVar32 + 7);
    uVar14 = *(undefined4 *)((longlong)puVar32 + 0x3c);
    *(undefined4 *)(puVar34 + 4) = uVar6;
    *(undefined4 *)((longlong)puVar34 + 0x24) = uVar9;
    *(undefined4 *)(puVar34 + 5) = uVar10;
    *(undefined4 *)((longlong)puVar34 + 0x2c) = uVar15;
    uVar6 = *(undefined4 *)(puVar32 + 8);
    uVar9 = *(undefined4 *)((longlong)puVar32 + 0x44);
    uVar10 = *(undefined4 *)(puVar32 + 9);
    uVar15 = *(undefined4 *)((longlong)puVar32 + 0x4c);
    *(undefined4 *)(puVar34 + 6) = uVar11;
    *(undefined4 *)((longlong)puVar34 + 0x34) = uVar12;
    *(undefined4 *)(puVar34 + 7) = uVar13;
    *(undefined4 *)((longlong)puVar34 + 0x3c) = uVar14;
    uVar12 = *(undefined4 *)(puVar32 + 10);
    uVar13 = *(undefined4 *)((longlong)puVar32 + 0x54);
    uVar14 = *(undefined4 *)(puVar32 + 0xb);
    uVar16 = *(undefined4 *)((longlong)puVar32 + 0x5c);
    *(undefined4 *)(puVar34 + 8) = uVar6;
    *(undefined4 *)((longlong)puVar34 + 0x44) = uVar9;
    *(undefined4 *)(puVar34 + 9) = uVar10;
    *(undefined4 *)((longlong)puVar34 + 0x4c) = uVar15;
    uVar6 = *(undefined4 *)(puVar32 + 0xc);
    uVar9 = *(undefined4 *)((longlong)puVar32 + 100);
    uVar10 = *(undefined4 *)(puVar32 + 0xd);
    uVar11 = *(undefined4 *)((longlong)puVar32 + 0x6c);
    *(undefined4 *)(puVar34 + 10) = uVar12;
    *(undefined4 *)((longlong)puVar34 + 0x54) = uVar13;
    *(undefined4 *)(puVar34 + 0xb) = uVar14;
    *(undefined4 *)((longlong)puVar34 + 0x5c) = uVar16;
    uVar12 = *(undefined4 *)(puVar32 + 0xe);
    uVar13 = *(undefined4 *)((longlong)puVar32 + 0x74);
    uVar14 = *(undefined4 *)(puVar32 + 0xf);
    uVar15 = *(undefined4 *)((longlong)puVar32 + 0x7c);
    puVar32 = puVar32 + 0x10;
    *(undefined4 *)(puVar34 + 0xc) = uVar6;
    *(undefined4 *)((longlong)puVar34 + 100) = uVar9;
    *(undefined4 *)(puVar34 + 0xd) = uVar10;
    *(undefined4 *)((longlong)puVar34 + 0x6c) = uVar11;
    puVar45 = puVar34 + 0x10;
    *(undefined4 *)(puVar34 + 0xe) = uVar12;
    *(undefined4 *)((longlong)puVar34 + 0x74) = uVar13;
    *(undefined4 *)(puVar34 + 0xf) = uVar14;
    *(undefined4 *)((longlong)puVar34 + 0x7c) = uVar15;
    lVar38 = lVar38 + -1;
    puVar34 = puVar45;
  } while (lVar38 != 0);
  *puVar45 = *puVar32;
  piVar24 = (int *)KernelBaseGetGlobalData();
  puVar25 = (ulonglong *)
            RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                            *piVar24 + 0x1c0000U | 8,(ulonglong)local_168._6_2_ * 0x28);
  local_2b0 = puVar25;
  if (puVar25 == (ulonglong *)0x0) goto LAB_1800449b2;
  memset(puVar25,0,(ulonglong)local_168._6_2_ * 0x28);
  _llseek(param_1,param_3 + 0x108,0);
  _hread(param_1,puVar25,((uint)local_168._6_2_ + (uint)local_168._6_2_ * 4) * 8);
  uVar40 = 0;
  local_2d0 = 0;
  puVar29 = puVar25 + (ulonglong)local_168._6_2_ * 5;
  if (puVar25 < puVar29) {
    puVar28 = puVar25 + 2;
    lVar38 = ((ulonglong)local_168._6_2_ * 0x28 - 1) / 0x28 + 1;
    local_2d0 = uVar40;
    do {
      if (local_2d0 < *(uint *)((longlong)puVar28 + 4)) {
        local_2d0 = *(int *)puVar28 + *(uint *)((longlong)puVar28 + 4);
      }
      puVar28 = puVar28 + 5;
      lVar38 = lVar38 + -1;
    } while (lVar38 != 0);
  }
  ppuVar7 = *(ulonglong ***)(param_4 + 0x20);
  uVar52 = uVar50;
  uVar49 = uVar40;
  if (ppuVar7 != (ulonglong **)0x0) {
    ppuVar43 = ppuVar7;
    uVar42 = uVar40;
    do {
      lVar38 = 0;
      plVar35 = (longlong *)ppuVar43[4];
      if ((plVar35 != (longlong *)0x0) || (ppuVar43[3] != (ulonglong *)0x0)) {
        local_330 = local_330 + 1;
        local_300._0_4_ = (uint)local_300 + 1;
        uVar42 = uVar42 + (uint)*(ushort *)((longlong)ppuVar43[1] + 0x16) * 2 + 2;
        if (plVar35 != (longlong *)0x0) {
          do {
            uVar50 = uVar50 + 1;
            if (lVar38 == 0) {
LAB_1800434f1:
              lVar38 = plVar35[1];
              uVar49 = uVar49 + (uint)*(ushort *)(lVar38 + 0x16) * 2 + 2;
              uVar52 = uVar52 + 1;
            }
            else {
              psVar26 = *(short **)(lVar38 + 0x18);
              lVar38 = *(longlong *)(plVar35[1] + 0x18) - (longlong)psVar26;
              do {
                sVar2 = *psVar26;
                sVar3 = *(short *)((longlong)psVar26 + lVar38);
                if (sVar2 != sVar3) break;
                psVar26 = psVar26 + 1;
              } while (sVar3 != 0);
              lVar38 = plVar35[1];
              if (sVar2 != sVar3) goto LAB_1800434f1;
            }
            piVar24 = (int *)((longlong)plVar35 + 0x24);
            plVar35 = (longlong *)*plVar35;
            uVar40 = uVar40 + (*piVar24 + 3U & 0xfffffffc);
          } while (plVar35 != (longlong *)0x0);
          local_2f0 = (ulonglong *)((ulonglong)local_2f0 & 0xffffffff00000000 | (ulonglong)uVar50);
          local_32c = uVar49;
          local_318 = uVar52;
        }
        lVar38 = 0;
        plVar35 = (longlong *)ppuVar43[3];
        if (plVar35 != (longlong *)0x0) {
          do {
            uVar50 = uVar50 + 1;
            if ((lVar38 == 0) || (*(short *)(lVar38 + 8) != *(short *)(plVar35[1] + 8))) {
              uVar52 = uVar52 + 1;
            }
            piVar24 = (int *)((longlong)plVar35 + 0x24);
            lVar38 = plVar35[1];
            plVar35 = (longlong *)*plVar35;
            uVar40 = uVar40 + (*piVar24 + 3U & 0xfffffffc);
          } while (plVar35 != (longlong *)0x0);
          local_2f0 = (ulonglong *)((ulonglong)local_2f0 & 0xffffffff00000000 | (ulonglong)uVar50);
          local_318 = uVar52;
        }
      }
      ppuVar43 = (ulonglong **)*ppuVar43;
    } while (ppuVar43 != (ulonglong **)0x0);
    local_300 = (undefined8 *)
                ((ulonglong)local_300 & 0xffffffff00000000 | (ulonglong)(uint)local_300);
    uVar20 = (uint)local_2c0;
    local_310 = (undefined8 *)((ulonglong)local_310 & 0xffffffff00000000 | (ulonglong)uVar42);
    puVar25 = local_2b0;
  }
  for (puVar32 = *(undefined8 **)(local_2e0 + 0x18); puVar32 != (undefined8 *)0x0;
      puVar32 = (undefined8 *)*puVar32) {
    lVar38 = 0;
    plVar35 = (longlong *)puVar32[4];
    if ((plVar35 != (longlong *)0x0) || (puVar32[3] != 0)) {
      local_330 = local_330 + 1;
      if (plVar35 != (longlong *)0x0) {
        do {
          uVar50 = uVar50 + 1;
          if (lVar38 == 0) {
LAB_1800435fe:
            lVar38 = plVar35[1];
            uVar52 = uVar52 + 1;
            uVar49 = uVar49 + (uint)*(ushort *)(lVar38 + 0x16) * 2 + 2;
          }
          else {
            psVar26 = *(short **)(lVar38 + 0x18);
            lVar38 = *(longlong *)(plVar35[1] + 0x18) - (longlong)psVar26;
            do {
              sVar2 = *psVar26;
              sVar3 = *(short *)((longlong)psVar26 + lVar38);
              if (sVar2 != sVar3) break;
              psVar26 = psVar26 + 1;
            } while (sVar3 != 0);
            lVar38 = plVar35[1];
            if (sVar2 != sVar3) goto LAB_1800435fe;
          }
          piVar24 = (int *)((longlong)plVar35 + 0x24);
          plVar35 = (longlong *)*plVar35;
          uVar40 = uVar40 + (*piVar24 + 3U & 0xfffffffc);
        } while (plVar35 != (longlong *)0x0);
        local_2f0 = (ulonglong *)((ulonglong)local_2f0 & 0xffffffff00000000 | (ulonglong)uVar50);
        local_32c = uVar49;
        local_318 = uVar52;
      }
      lVar38 = 0;
      plVar35 = (longlong *)puVar32[3];
      if (plVar35 != (longlong *)0x0) {
        do {
          uVar50 = uVar50 + 1;
          if ((lVar38 == 0) || (*(short *)(lVar38 + 8) != *(short *)(plVar35[1] + 8))) {
            uVar52 = uVar52 + 1;
          }
          piVar24 = (int *)((longlong)plVar35 + 0x24);
          lVar38 = plVar35[1];
          plVar35 = (longlong *)*plVar35;
          uVar40 = uVar40 + (*piVar24 + 3U & 0xfffffffc);
        } while (plVar35 != (longlong *)0x0);
        local_2f0 = (ulonglong *)((ulonglong)local_2f0 & 0xffffffff00000000 | (ulonglong)uVar50);
        local_318 = uVar52;
      }
    }
    puVar25 = local_2b0;
  }
  uVar52 = (-((int)local_310 + local_32c) & 3) + (int)local_310 +
           uVar52 * 0x18 + uVar50 * 0x18 + local_330 * 0x18 + 0x10 + local_32c;
  local_2f8 = puVar29;
  local_2b8 = (ulonglong *)ppuVar7;
  pcVar27 = FUN_18004775c((char *)puVar25,(char *)puVar29,(longlong)".rsrc");
  local_2c8 = pcVar27;
  puVar28 = (ulonglong *)FUN_18004775c((char *)puVar25,(char *)puVar29,(longlong)".rsrc1");
  local_2c0 = puVar28;
  puVar29 = (ulonglong *)FUN_18004775c((char *)puVar25,(char *)puVar29,(longlong)".reloc");
  uVar50 = local_324;
  if (pcVar27 == (char *)0x0) {
    uVar48 = 0x7fffffff;
  }
  else {
    puVar30 = (ulonglong *)(pcVar27 + 0x28);
    uVar20 = (uint)(((longlong)pcVar27 - (longlong)puVar25) / 0x28);
    if ((puVar30 == puVar28) || (local_2f8 <= puVar30)) {
      uVar48 = 0x7fffffff;
    }
    else {
      if (puVar29 == (ulonglong *)0x0) {
        uVar48 = 0x7fffffff;
      }
      else {
        uVar48 = (ulonglong)(uint)(*(int *)(pcVar27 + 0x34) - *(int *)(pcVar27 + 0xc));
      }
      if ((uint)uVar48 < uVar52) goto LAB_1800449b2;
    }
    if ((uint)uVar48 < uVar40 + uVar52) {
      if (puVar29 == puVar30) {
        uVar48 = 0x7fffffff;
      }
      else {
        if (puVar28 == (ulonglong *)0x0) {
          iVar23 = *(int *)((longlong)puVar29 + 0xc);
          local_320 = ((longlong)puVar29 - (longlong)puVar25) / 0x28;
        }
        else {
          local_320 = local_320 & 0xffffffff00000000 |
                      ((longlong)puVar28 - (longlong)puVar25) / 0x28 & 0xffffffffU;
          iVar23 = *(int *)((longlong)puVar28 + 0xc);
        }
        uVar50 = iVar23 - *(int *)(pcVar27 + 0xc);
      }
    }
  }
  uVar51 = (ulonglong)uVar50;
  local_338 = 0;
  local_334 = uVar52;
  uVar50 = uVar52;
  for (; ppuVar7 != (ulonglong **)0x0; ppuVar7 = (ulonglong **)*ppuVar7) {
    puVar29 = ppuVar7[4];
    uVar40 = local_334;
    if ((puVar29 != (ulonglong *)0x0) || (ppuVar7[3] != (ulonglong *)0x0)) {
      while (local_340 = puVar29, local_340 != (ulonglong *)0x0) {
        uVar50 = FUN_18004727c((longlong *)&local_340,(uint)uVar51,uVar50,(uint)uVar48,&local_338);
        puVar29 = local_340;
        uVar40 = uVar50;
      }
      local_340 = ppuVar7[3];
      local_334 = uVar40;
      while (local_340 != (ulonglong *)0x0) {
        uVar40 = FUN_18004727c((longlong *)&local_340,(uint)uVar51,uVar50,(uint)uVar48,&local_338);
        uVar50 = uVar40;
      }
    }
    local_334 = uVar40;
  }
  puVar29 = local_2f8;
  for (puVar32 = *(undefined8 **)(local_2e0 + 0x18); local_2f8 = puVar29,
      puVar32 != (undefined8 *)0x0; puVar32 = (undefined8 *)*puVar32) {
    puVar29 = (ulonglong *)puVar32[4];
    uVar40 = local_334;
    if ((puVar29 != (ulonglong *)0x0) || (puVar32[3] != 0)) {
      while (local_340 = puVar29, local_340 != (ulonglong *)0x0) {
        uVar50 = FUN_18004727c((longlong *)&local_340,(uint)uVar51,uVar50,(uint)uVar48,&local_338);
        puVar29 = local_340;
        uVar40 = uVar50;
      }
      local_340 = (ulonglong *)puVar32[3];
      local_334 = uVar40;
      while (local_340 != (ulonglong *)0x0) {
        uVar40 = FUN_18004727c((longlong *)&local_340,(uint)uVar51,uVar50,(uint)uVar48,&local_338);
        uVar50 = uVar40;
      }
    }
    local_334 = uVar40;
    puVar29 = local_2f8;
  }
  if (local_338 == 0) {
    local_338 = uVar50;
  }
  puVar30 = (ulonglong *)FUN_18004775c((char *)puVar25,(char *)puVar29,(longlong)".debug");
  local_288 = puVar30;
  if ((puVar30 != (ulonglong *)0x0) && (((uint)local_b0 == 0 || (puVar30 != puVar29 + -5))))
  goto LAB_1800449b2;
  local_2b8 = (ulonglong *)0x0;
  for (puVar36 = puVar25;
      (puVar19 = local_2b8, puVar36 < puVar29 &&
      (((uint)local_b0 < *(uint *)((longlong)puVar36 + 0xc) ||
       (puVar19 = puVar36,
       *(uint *)((longlong)puVar36 + 0xc) + *(int *)(puVar36 + 2) <= (uint)local_b0))));
      puVar36 = puVar36 + 5) {
  }
  local_2b8 = puVar19;
  puVar29 = (ulonglong *)FUN_18004775c((char *)puVar25,(char *)puVar29,(longlong)".reloc");
  if (uVar20 == 0xffffffff) {
    puVar36 = puVar29;
    if ((puVar29 == (ulonglong *)0x0) && (puVar36 = puVar30, puVar30 == (ulonglong *)0x0)) {
      uVar20 = (uint)local_278._6_2_;
    }
    else {
      uVar20 = (uint)(((longlong)puVar36 - (longlong)puVar25) / 0x28);
    }
    local_278._6_2_ = local_278._6_2_ + 1;
  }
  if ((int)local_320 == -1) {
    if (puVar28 != (ulonglong *)0x0) {
      local_278._6_2_ = local_278._6_2_ - 1;
    }
  }
  else {
    if (puVar28 == (ulonglong *)0x0) {
      if (puVar29 == (ulonglong *)0x0) {
        if (puVar30 == (ulonglong *)0x0) {
          local_320 = (ulonglong)local_278._6_2_;
          goto LAB_180043a8e;
        }
        lVar38 = SUB168(SEXT816(0x6666666666666667) * SEXT816((longlong)puVar30 - (longlong)puVar25)
                        >> 0x40,0);
      }
      else {
        lVar38 = SUB168(SEXT816(0x6666666666666667) * SEXT816((longlong)puVar29 - (longlong)puVar25)
                        >> 0x40,0);
      }
      local_320 = local_320 & 0xffffffff00000000 |
                  (ulonglong)(uint)((int)(lVar38 >> 4) - (int)(lVar38 >> 0x3f));
    }
    else {
      local_278._6_2_ = local_278._6_2_ - 1;
      local_320 = local_320 & 0xffffffff00000000 |
                  ((longlong)puVar28 - (longlong)puVar25) / 0x28 & 0xffffffffU;
    }
LAB_180043a8e:
    local_278._6_2_ = local_278._6_2_ + 1;
  }
  lVar38 = 0x10;
  local_29c = ((uint)local_278._6_2_ - (uint)local_168._6_2_) * 0x28;
  uVar50 = ((uStack276 + ((uint)local_168._6_2_ + (uint)local_168._6_2_ * 4) * -8) - local_308) -
           0x108;
  if (uVar50 < local_29c) {
    local_29c = local_29c - uVar50;
    local_2d4 = iStack572 + -1 + local_29c & ~(iStack572 - 1U);
    puVar37 = local_1f0;
    do {
      uVar50 = *puVar37;
      if ((uVar50 != 0) && (uVar50 < uStack548)) {
        *puVar37 = uVar50 + local_29c;
      }
      puVar37 = puVar37 + 2;
      lVar38 = lVar38 + -1;
    } while (lVar38 != 0);
    uStack548 = uStack548 + local_29c;
  }
  else if (local_29c != 0) {
    puVar37 = local_1f0;
    lVar38 = 0x10;
    do {
      uVar50 = *puVar37;
      if ((uVar50 != 0) && (uVar50 < uStack276)) {
        *puVar37 = uVar50 + local_29c;
      }
      puVar37 = puVar37 + 2;
      lVar38 = lVar38 + -1;
    } while (lVar38 != 0);
  }
  local_29c = local_2d8 + local_29c;
  uVar40 = (uint)local_278._6_2_;
  uVar50 = (uint)local_278._6_2_;
  KernelBaseGetGlobalData();
  pauVar31 = (undefined (*) [16])
             RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
  local_2a8 = pauVar31;
  if (pauVar31 == (undefined (*) [16])0x0) goto LAB_1800449b2;
  memset(pauVar31,0,(ulonglong)((uVar50 + uVar40 * 4) * 8));
  puVar28 = local_2c0;
  uVar50 = local_338;
  uVar48 = 0;
  pauVar1 = (undefined (*) [16])((longlong)pauVar31 + (longlong)(int)uVar20 * 0x28);
  pauVar33 = pauVar31;
  puVar30 = local_2f8;
  uVar51 = uVar48;
  puVar29 = puVar25;
  if (puVar25 < local_2f8) {
    do {
      puVar36 = puVar29 + 5;
      iVar47 = (int)uVar48;
      iVar23 = (int)local_320;
      if (puVar25 == puVar28) {
        pauVar44 = pauVar33;
        if ((iVar23 == -1) && (puVar36 < puVar30)) {
          uVar48 = (ulonglong)
                   (uint)(iVar47 + (*(int *)((longlong)puVar29 + 0xc) -
                                   *(int *)((longlong)puVar29 + 0x34)));
        }
      }
      else {
        if (pauVar33 == pauVar1) {
          iVar23 = uVar50 - 1;
          uVar51 = 1;
          uVar20 = iVar23 + iStack572 & ~(iStack572 - 1U);
          if (local_2c8 == (char *)0x0) {
            *pauVar33 = ZEXT816(0);
            uVar48 = (ulonglong)(uStack576 + iVar23 & ~(uStack576 - 1));
            pauVar33[1] = ZEXT816(0);
            *(undefined8 *)pauVar33[2] = 0;
            uVar40 = FUN_1800491bc((char *)pauVar33,(ulonglong)uStack576,(longlong)".rsrc");
            if ((int)uVar40 < 0) goto LAB_18004498b;
            *(undefined4 *)(*pauVar33 + 0xc) = *(undefined4 *)((longlong)puVar36 + -0x1c);
            *(undefined4 *)(pauVar33[1] + 4) = *(undefined4 *)((longlong)puVar36 + -0x14);
            *(undefined4 *)(pauVar33[2] + 4) = 0x40000040;
            *(uint *)pauVar33[1] = uVar20;
            *(uint *)(*pauVar33 + 8) = uVar50;
            puVar30 = local_2f8;
          }
          else {
            uVar6 = *(undefined4 *)((longlong)puVar25 + 4);
            uVar9 = *(undefined4 *)(puVar25 + 1);
            uVar10 = *(undefined4 *)((longlong)puVar25 + 0xc);
            *(undefined4 *)*pauVar33 = *(undefined4 *)puVar25;
            *(undefined4 *)(*pauVar33 + 4) = uVar6;
            *(undefined4 *)(*pauVar33 + 8) = uVar9;
            *(undefined4 *)(*pauVar33 + 0xc) = uVar10;
            uVar6 = *(undefined4 *)((longlong)puVar25 + 0x14);
            uVar9 = *(undefined4 *)(puVar25 + 3);
            uVar10 = *(undefined4 *)((longlong)puVar25 + 0x1c);
            *(undefined4 *)pauVar33[1] = *(undefined4 *)(puVar25 + 2);
            *(undefined4 *)(pauVar33[1] + 4) = uVar6;
            *(undefined4 *)(pauVar33[1] + 8) = uVar9;
            *(undefined4 *)(pauVar33[1] + 0xc) = uVar10;
            *(ulonglong *)pauVar33[2] = puVar25[4];
            *(uint *)pauVar33[1] = uVar20;
            *(uint *)(*pauVar33 + 8) = uVar50;
            uVar48 = 0;
            if (uVar20 != *(uint *)(puVar29 + 2)) {
              uVar20 = iVar47 + (iVar23 + uStack576 & ~(uStack576 - 1));
              if (puVar36 < puVar30) {
                uVar20 = uVar20 + (*(int *)((longlong)puVar29 + 0xc) -
                                  *(int *)((longlong)puVar29 + 0x34));
              }
              uVar48 = (ulonglong)uVar20;
            }
          }
          pauVar33 = (undefined (*) [16])(pauVar33[2] + 8);
          pauVar44 = pauVar33;
          if (local_2c8 != (char *)0x0) goto LAB_180043d00;
        }
        else if ((iVar23 == -1) ||
                (pauVar33 != (undefined (*) [16])((longlong)pauVar31 + (longlong)iVar23 * 0x28))) {
          if (pauVar33 < pauVar1) {
            uVar6 = *(undefined4 *)((longlong)puVar25 + 4);
            uVar9 = *(undefined4 *)(puVar25 + 1);
            uVar10 = *(undefined4 *)((longlong)puVar25 + 0xc);
            *(undefined4 *)*pauVar33 = *(undefined4 *)puVar25;
            *(undefined4 *)(*pauVar33 + 4) = uVar6;
            *(undefined4 *)(*pauVar33 + 8) = uVar9;
            *(undefined4 *)(*pauVar33 + 0xc) = uVar10;
            uVar6 = *(undefined4 *)((longlong)puVar25 + 0x14);
            uVar9 = *(undefined4 *)(puVar25 + 3);
            uVar10 = *(undefined4 *)((longlong)puVar25 + 0x1c);
            *(undefined4 *)pauVar33[1] = *(undefined4 *)(puVar25 + 2);
            *(undefined4 *)(pauVar33[1] + 4) = uVar6;
            *(undefined4 *)(pauVar33[1] + 8) = uVar9;
            *(undefined4 *)(pauVar33[1] + 0xc) = uVar10;
            *(ulonglong *)pauVar33[2] = puVar25[4];
            pauVar44 = (undefined (*) [16])(pauVar33[2] + 8);
            goto LAB_180043d00;
          }
        }
        else {
          *pauVar33 = ZEXT816(0);
          pauVar33[1] = ZEXT816(0);
          *(undefined8 *)pauVar33[2] = 0;
          uVar20 = FUN_1800491bc((char *)pauVar33,0,(longlong)".rsrc1");
          if ((int)uVar20 < 0) goto LAB_18004498b;
          if (puVar28 == (ulonglong *)0x0) {
            iVar23 = *(int *)((longlong)puVar36 + -0x1c);
            *(int *)(*pauVar33 + 0xc) = iVar23;
            *(undefined4 *)(pauVar33[2] + 4) = 0x40000040;
            uVar20 = ((~(uStack576 - 1) & uStack576 + (local_334 - 1)) - iVar23) +
                     *(int *)(*pauVar1 + 0xc);
          }
          else {
            *(undefined4 *)(*pauVar33 + 0xc) = *(undefined4 *)((longlong)puVar28 + 0xc);
            *(undefined4 *)(pauVar33[2] + 4) = 0x40000040;
            uVar20 = ((~(uStack576 - 1) & uStack576 + (local_334 - 1)) -
                     *(int *)((longlong)puVar36 + -0x1c)) + *(int *)(*pauVar1 + 0xc);
          }
          uVar48 = (ulonglong)uVar20;
          pauVar33 = (undefined (*) [16])(pauVar33[2] + 8);
        }
        uVar6 = *(undefined4 *)((longlong)puVar25 + 4);
        uVar9 = *(undefined4 *)(puVar25 + 1);
        uVar10 = *(undefined4 *)((longlong)puVar25 + 0xc);
        *(undefined4 *)*pauVar33 = *(undefined4 *)puVar25;
        *(undefined4 *)(*pauVar33 + 4) = uVar6;
        *(undefined4 *)(*pauVar33 + 8) = uVar9;
        *(undefined4 *)(*pauVar33 + 0xc) = uVar10;
        uVar6 = *(undefined4 *)((longlong)puVar25 + 0x14);
        uVar9 = *(undefined4 *)(puVar25 + 3);
        uVar10 = *(undefined4 *)((longlong)puVar25 + 0x1c);
        *(undefined4 *)pauVar33[1] = *(undefined4 *)(puVar25 + 2);
        *(undefined4 *)(pauVar33[1] + 4) = uVar6;
        *(undefined4 *)(pauVar33[1] + 8) = uVar9;
        *(undefined4 *)(pauVar33[1] + 0xc) = uVar10;
        *(ulonglong *)pauVar33[2] = puVar25[4];
        pauVar44 = (undefined (*) [16])(pauVar33[2] + 8);
        *(int *)(*pauVar33 + 0xc) = *(int *)(*pauVar33 + 0xc) + (int)uVar48;
        puVar30 = local_2f8;
      }
LAB_180043d00:
      puVar25 = puVar25 + 5;
      pauVar33 = pauVar44;
      puVar29 = puVar36;
    } while (puVar25 < puVar30);
    if ((int)uVar51 == 0) goto LAB_180043d16;
LAB_180043d76:
    local_228 = (uStack576 - 1) +
                *(int *)((longlong)pauVar31 + (ulonglong)local_278._6_2_ * 0x28 + -0x1c) +
                *(int *)((longlong)pauVar31 + (ulonglong)local_278._6_2_ * 0x28 + -0x18) &
                ~(uStack576 - 1);
    piVar24 = (int *)KernelBaseGetGlobalData();
    puVar32 = (undefined8 *)
              RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                              *piVar24 + 0x1c0000U | 8,uVar52);
    if (puVar32 != (undefined8 *)0x0) {
      memset(puVar32,0,(ulonglong)uVar52);
      puVar39 = puVar32 + 2;
      *(short *)((longlong)puVar32 + 0xc) = (short)local_300;
      *(short *)((longlong)puVar32 + 0xe) = (short)local_330 - (short)local_300;
      puVar34 = puVar39 + local_330;
      *puVar32 = 0;
      *(undefined4 *)(puVar32 + 1) = 4;
      puVar45 = puVar39 + (ulonglong)local_318 + (ulonglong)local_330 * 3;
      puVar41 = puVar45 + ((ulonglong)local_2f0 & 0xffffffff) + (ulonglong)local_318 * 2;
      puVar25 = puVar41 + ((ulonglong)local_2f0 & 0xffffffff) * 2;
      local_2f0 = (ulonglong *)
                  ((longlong)puVar25 + (ulonglong)local_32c + ((ulonglong)local_310 & 0xffffffff));
      iVar23 = (int)puVar32;
      for (puVar8 = *(undefined8 **)(local_2e0 + 0x20); local_340 = puVar25,
          puVar8 != (undefined8 *)0x0; puVar8 = (undefined8 *)*puVar8) {
        *(uint *)puVar39 = (int)puVar25 - iVar23 | 0x80000000;
        *(uint *)((longlong)puVar39 + 4) = (int)puVar34 - iVar23 | 0x80000000;
        local_300 = puVar39 + 1;
        *(undefined2 *)puVar25 = *(undefined2 *)(puVar8[1] + 0x16);
        local_310 = puVar8;
        wcsncpy((wchar_t *)((longlong)puVar25 + 2),*(wchar_t **)(puVar8[1] + 0x18),
                (ulonglong)*(ushort *)(puVar8[1] + 0x16));
        lVar38 = 0;
        uVar4 = *(undefined2 *)((longlong)puVar8 + 0x2c);
        uVar5 = *(undefined2 *)(puVar8 + 5);
        puVar25 = (ulonglong *)
                  ((longlong)puVar25 + (ulonglong)*(ushort *)(puVar8[1] + 0x16) * 2 + 2);
        *puVar34 = 0;
        *(undefined4 *)(puVar34 + 1) = 4;
        *(undefined2 *)((longlong)puVar34 + 0xc) = uVar4;
        *(undefined2 *)((longlong)puVar34 + 0xe) = uVar5;
        puVar34 = puVar34 + 2;
        puVar39 = (undefined8 *)puVar8[4];
        local_340 = puVar25;
        for (; puVar39 != (undefined8 *)0x0; puVar39 = (undefined8 *)*puVar39) {
          if (lVar38 == 0) {
LAB_18004402b:
            *(uint *)puVar34 = (int)puVar25 - iVar23 | 0x80000000;
            *(uint *)((longlong)puVar34 + 4) = (int)puVar45 - iVar23 | 0x80000000;
            puVar34 = puVar34 + 1;
            *(undefined2 *)puVar25 = *(undefined2 *)(puVar39[1] + 0x16);
            wcsncpy((wchar_t *)((longlong)puVar25 + 2),*(wchar_t **)(puVar39[1] + 0x18),
                    (ulonglong)*(ushort *)(puVar39[1] + 0x16));
            lVar38 = puVar39[1];
            puVar25 = (ulonglong *)
                      ((longlong)puVar25 + (ulonglong)*(ushort *)(lVar38 + 0x16) * 2 + 2);
            *(undefined2 *)((longlong)puVar45 + 0xe) = *(undefined2 *)((longlong)puVar39 + 0x32);
            *puVar45 = 0;
            *(undefined4 *)(puVar45 + 1) = 4;
            *(undefined2 *)((longlong)puVar45 + 0xc) = 0;
            puVar45 = puVar45 + 2;
          }
          else {
            psVar26 = *(short **)(lVar38 + 0x18);
            lVar46 = *(longlong *)(puVar39[1] + 0x18) - (longlong)psVar26;
            do {
              sVar2 = *psVar26;
              sVar3 = *(short *)((longlong)psVar26 + lVar46);
              if (sVar2 != sVar3) break;
              psVar26 = psVar26 + 1;
            } while (sVar3 != 0);
            if (sVar2 != sVar3) goto LAB_18004402b;
          }
          *(uint *)puVar45 = (uint)*(ushort *)((longlong)puVar39 + 0x34);
          *(int *)((longlong)puVar45 + 4) = (int)puVar41 - iVar23;
          puVar45 = puVar45 + 1;
          uVar6 = *(undefined4 *)((longlong)puVar39 + 0x24);
          *(int *)puVar41 = *(int *)(puVar39 + 2) + *(int *)(*pauVar1 + 0xc);
          *(undefined4 *)((longlong)puVar41 + 4) = uVar6;
          puVar41[1] = 0x4e4;
          puVar41 = puVar41 + 2;
          puVar8 = local_310;
        }
        lVar38 = 0;
        for (puVar39 = (undefined8 *)puVar8[3]; puVar39 != (undefined8 *)0x0;
            puVar39 = (undefined8 *)*puVar39) {
          if ((lVar38 == 0) || (*(short *)(lVar38 + 8) != *(short *)(puVar39[1] + 8))) {
            *(uint *)puVar34 = (uint)*(ushort *)(puVar39[1] + 8);
            *(uint *)((longlong)puVar34 + 4) = (int)puVar45 - iVar23 | 0x80000000;
            puVar34 = puVar34 + 1;
            lVar38 = puVar39[1];
            uVar4 = *(undefined2 *)((longlong)puVar39 + 0x32);
            *puVar45 = 0;
            *(undefined2 *)((longlong)puVar45 + 0xe) = uVar4;
            *(undefined4 *)(puVar45 + 1) = 4;
            *(undefined2 *)((longlong)puVar45 + 0xc) = 0;
            puVar45 = puVar45 + 2;
          }
          *(uint *)puVar45 = (uint)*(ushort *)((longlong)puVar39 + 0x34);
          *(int *)((longlong)puVar45 + 4) = (int)puVar41 - iVar23;
          puVar45 = puVar45 + 1;
          uVar6 = *(undefined4 *)((longlong)puVar39 + 0x24);
          *(int *)puVar41 = *(int *)(puVar39 + 2) + *(int *)(*pauVar1 + 0xc);
          *(undefined4 *)((longlong)puVar41 + 4) = uVar6;
          puVar41[1] = 0x4e4;
          puVar41 = puVar41 + 2;
        }
        puVar39 = local_300;
      }
      for (local_310 = *(undefined8 **)(local_2e0 + 0x18); HVar18 = local_328, lVar38 = 0,
          local_310 != (undefined8 *)0x0; local_310 = (undefined8 *)*local_310) {
        *(uint *)puVar39 = (uint)*(ushort *)(local_310[1] + 8);
        *(uint *)((longlong)puVar39 + 4) = (int)puVar34 - iVar23 | 0x80000000;
        uVar4 = *(undefined2 *)(local_310 + 5);
        uVar5 = *(undefined2 *)((longlong)local_310 + 0x2c);
        *puVar34 = 0;
        *(undefined2 *)((longlong)puVar34 + 0xc) = uVar5;
        *(undefined2 *)((longlong)puVar34 + 0xe) = uVar4;
        *(undefined4 *)(puVar34 + 1) = 4;
        puVar34 = puVar34 + 2;
        puVar39 = puVar39 + 1;
        puVar25 = local_340;
        for (puVar8 = (undefined8 *)local_310[4]; local_300 = puVar39, puVar8 != (undefined8 *)0x0;
            puVar8 = (undefined8 *)*puVar8) {
          if (lVar38 == 0) {
LAB_180044224:
            *(uint *)puVar34 = (int)puVar25 - iVar23 | 0x80000000;
            *(uint *)((longlong)puVar34 + 4) = (int)puVar45 - iVar23 | 0x80000000;
            puVar34 = puVar34 + 1;
            *(undefined2 *)puVar25 = *(undefined2 *)(puVar8[1] + 0x16);
            wcsncpy((wchar_t *)((longlong)puVar25 + 2),*(wchar_t **)(puVar8[1] + 0x18),
                    (ulonglong)*(ushort *)(puVar8[1] + 0x16));
            lVar38 = puVar8[1];
            puVar25 = (ulonglong *)
                      ((longlong)puVar25 + (ulonglong)*(ushort *)(lVar38 + 0x16) * 2 + 2);
            *(undefined2 *)((longlong)puVar45 + 0xe) = *(undefined2 *)((longlong)puVar8 + 0x32);
            *puVar45 = 0;
            *(undefined4 *)(puVar45 + 1) = 4;
            *(undefined2 *)((longlong)puVar45 + 0xc) = 0;
            puVar45 = puVar45 + 2;
          }
          else {
            psVar26 = *(short **)(lVar38 + 0x18);
            lVar46 = *(longlong *)(puVar8[1] + 0x18) - (longlong)psVar26;
            do {
              sVar2 = *psVar26;
              sVar3 = *(short *)((longlong)psVar26 + lVar46);
              if (sVar2 != sVar3) break;
              psVar26 = psVar26 + 1;
            } while (sVar3 != 0);
            if (sVar2 != sVar3) goto LAB_180044224;
          }
          *(uint *)puVar45 = (uint)*(ushort *)((longlong)puVar8 + 0x34);
          *(int *)((longlong)puVar45 + 4) = (int)puVar41 - iVar23;
          puVar45 = puVar45 + 1;
          uVar6 = *(undefined4 *)((longlong)puVar8 + 0x24);
          *(int *)puVar41 = *(int *)(puVar8 + 2) + *(int *)(*pauVar1 + 0xc);
          *(undefined4 *)((longlong)puVar41 + 4) = uVar6;
          puVar41[1] = 0x4e4;
          puVar41 = puVar41 + 2;
          puVar39 = local_300;
        }
        lVar38 = 0;
        for (puVar8 = (undefined8 *)local_310[3]; puVar8 != (undefined8 *)0x0;
            puVar8 = (undefined8 *)*puVar8) {
          if ((lVar38 == 0) || (*(short *)(lVar38 + 8) != *(short *)(puVar8[1] + 8))) {
            *(uint *)puVar34 = (uint)*(ushort *)(puVar8[1] + 8);
            *(uint *)((longlong)puVar34 + 4) = (int)puVar45 - iVar23 | 0x80000000;
            puVar34 = puVar34 + 1;
            lVar38 = puVar8[1];
            uVar4 = *(undefined2 *)((longlong)puVar8 + 0x32);
            *puVar45 = 0;
            *(undefined2 *)((longlong)puVar45 + 0xe) = uVar4;
            *(undefined4 *)(puVar45 + 1) = 4;
            *(undefined2 *)((longlong)puVar45 + 0xc) = 0;
            puVar45 = puVar45 + 2;
          }
          *(uint *)puVar45 = (uint)*(ushort *)((longlong)puVar8 + 0x34);
          *(int *)((longlong)puVar45 + 4) = (int)puVar41 - iVar23;
          puVar45 = puVar45 + 1;
          uVar6 = *(undefined4 *)((longlong)puVar8 + 0x24);
          *(int *)puVar41 = *(int *)(puVar8 + 2) + *(int *)(*pauVar1 + 0xc);
          *(undefined4 *)((longlong)puVar41 + 4) = uVar6;
          puVar41[1] = 0x4e4;
          puVar41 = puVar41 + 2;
        }
        local_340 = puVar25;
      }
      if (local_340 < local_2f0) {
        puVar25 = local_340;
        for (lVar38 = ((ulonglong)((longlong)local_2f0 + (-1 - (longlong)local_340)) >> 1) + 1;
            lVar38 != 0; lVar38 = lVar38 + -1) {
          *(undefined2 *)puVar25 = 0;
          puVar25 = (ulonglong *)((longlong)puVar25 + 2);
        }
      }
      _llseek(local_328,0,0);
      hFile = local_2a0;
      FUN_18004808c(HVar18,local_2a0,local_308 + 0x108);
      uVar20 = local_29c;
      _llseek(hFile,local_29c,0);
      _llseek(HVar18,local_2d8,0);
      if (uVar20 < uStack276) {
        FUN_18004808c(HVar18,hFile,uStack276 - uVar20);
      }
      uVar20 = iStack572 - (iStack572 - 1U & uStack548) & iStack572 - 1U;
      uStack548 = uStack548 + uVar20;
      if (0xf < (int)uVar20) {
        uVar48 = (ulonglong)(uVar20 >> 4);
        uVar20 = uVar20 + (uVar20 >> 4) * -0x10;
        do {
          _hwrite(hFile,"",0x10);
          uVar48 = uVar48 - 1;
        } while (uVar48 != 0);
      }
      _hwrite(hFile,"",uVar20);
      _llseek(HVar18,(uStack276 - 1) + iStack300 & ~(iStack300 - 1U),0);
      bVar17 = false;
      local_258 = 0;
      puVar25 = local_2b0;
      pauVar31 = local_2a8;
      if (local_2b0 < local_2f8) {
        do {
          puVar29 = puVar25 + 5;
          if (puVar25 != local_2c0) {
            puVar29 = puVar25;
          }
          if (pauVar31 == pauVar1) {
            bVar17 = true;
            LVar21 = _llseek(hFile,0,1);
            *(LONG *)(pauVar31[1] + 4) = LVar21;
            local_1e0 = *(undefined4 *)(*pauVar1 + 0xc);
            local_1dc = local_334;
            local_2e8 = _llseek(hFile,0,1);
            _hwrite(hFile,(LPCCH)puVar32,uVar52);
            local_290 = FUN_180048a8c(local_2e0,hFile,iStack572,*(int *)pauVar1[1] - uVar52,
                                      (undefined8 *)0x0);
            LVar21 = _llseek(hFile,0,1);
            if ((int)local_320 == -1) {
              _llseek(hFile,local_2e8,0);
              _hwrite(hFile,(LPCCH)puVar32,uVar52);
              _llseek(hFile,LVar21,0);
              LVar21 = _llseek(local_328,0,1);
              _llseek(local_328,*(int *)(puVar29 + 2) + LVar21,0);
            }
            local_258 = local_258 + *(int *)pauVar31[1];
            if (local_2c8 == (char *)0x0) {
LAB_18004459a:
              pauVar31 = (undefined (*) [16])(pauVar31[2] + 8);
              goto LAB_18004466f;
            }
          }
          else {
            if (((int)local_320 != -1) &&
               (pauVar31 ==
                (undefined (*) [16])((longlong)local_2a8 + (longlong)(int)local_320 * 0x28))) {
              LVar21 = _llseek(hFile,0,1);
              *(LONG *)(pauVar31[1] + 4) = LVar21;
              FUN_180048a8c(local_2e0,hFile,iStack572,0xffffffff,local_290);
              LVar21 = _llseek(hFile,0,1);
              iVar23 = LVar21 - *(int *)(pauVar31[1] + 4);
              *(int *)pauVar31[1] = iVar23;
              *(int *)(*pauVar31 + 8) = iVar23;
              _llseek(hFile,local_2e8,0);
              _hwrite(hFile,(LPCCH)puVar32,uVar52);
              _llseek(hFile,LVar21,0);
              local_258 = local_258 + *(int *)pauVar31[1];
              goto LAB_18004459a;
            }
            if (pauVar31 < pauVar1) {
              if (*(int *)((longlong)puVar29 + 0x14) != 0) {
                LVar21 = _llseek(hFile,0,1);
                if (*(int *)((longlong)puVar29 + 0x14) != LVar21) {
                  _llseek(hFile,local_2d4 + *(int *)((longlong)puVar29 + 0x14),0);
                }
                goto LAB_18004466f;
              }
            }
            else {
LAB_18004466f:
              if (*(int *)((longlong)puVar29 + 0x14) != 0) {
                LVar21 = _llseek(hFile,0,1);
                *(LONG *)(pauVar31[1] + 4) = LVar21;
                _llseek(local_328,*(LONG *)((longlong)puVar29 + 0x14),0);
                FUN_18004808c(local_328,hFile,*(uint *)(puVar29 + 2));
              }
            }
            pauVar33 = pauVar31;
            if (puVar29 != local_2b8) {
              pauVar33 = local_298;
            }
            local_298 = pauVar33;
            if ((pauVar31[2][4] & 0x40) != 0) {
              local_258 = local_258 + *(int *)pauVar31[1];
            }
          }
          puVar25 = puVar29 + 5;
          pauVar31 = (undefined (*) [16])(pauVar31[2] + 8);
        } while (puVar25 < local_2f8);
      }
      if (local_2c0 != (ulonglong *)0x0) {
        local_258 = local_258 - *(int *)(local_2c0 + 2);
      }
      if (!bVar17) {
        LVar21 = _llseek(hFile,0,1);
        *(LONG *)(pauVar1[1] + 4) = LVar21;
        local_1e0 = *(undefined4 *)(*pauVar1 + 0xc);
        local_1dc = local_334;
        LVar21 = _llseek(hFile,0,1);
        _hwrite(hFile,(LPCCH)puVar32,uVar52);
        FUN_180048a8c(local_2e0,hFile,iStack572,*(int *)pauVar1[1] - uVar52,(undefined8 *)0x0);
        LVar22 = _llseek(hFile,0,1);
        if ((int)local_320 == -1) {
          _llseek(hFile,LVar21,0);
          _hwrite(hFile,(LPCCH)puVar32,uVar52);
          _llseek(hFile,LVar22,0);
        }
        local_258 = local_258 + *(int *)pauVar31[1];
      }
      pauVar31 = local_2a8;
      pcVar27 = FUN_18004775c((char *)local_2a8,
                              (char *)((longlong)local_2a8 + (ulonglong)local_278._6_2_ * 0x28),
                              (longlong)".reloc");
      if (pcVar27 != (char *)0x0) {
        local_1c8 = *(undefined4 *)(pcVar27 + 0xc);
      }
      _llseek(hFile,local_308 + 0x108,0);
      _hwrite(hFile,(LPCCH)pauVar31,((uint)local_278._6_2_ + (uint)local_278._6_2_ * 4) * 8);
      local_324 = _llseek(hFile,0,2);
      _hwrite(hFile,(LPCCH)0x0,0);
      pcVar27 = FUN_18004775c((char *)pauVar31,
                              (char *)((longlong)pauVar31 + (ulonglong)local_278._6_2_ * 0x28),
                              (longlong)".debug");
      puVar29 = local_288;
      puVar25 = local_2b8;
      iVar23 = FUN_180046194(local_328,hFile,(longlong)local_288,(longlong)pcVar27,
                             (longlong)local_2b8,(longlong)local_298,(longlong)&local_168,
                             (longlong)&local_278,local_2d0,&local_324);
      HVar18 = local_328;
      if (iVar23 == 0) {
        if (local_2c8 == (char *)0x0) {
          iVar23 = *(int *)pauVar1[1];
        }
        else {
          iVar23 = *(int *)(local_2c8 + 0x10) - *(int *)pauVar1[1];
        }
        FUN_18004666c(local_328,hFile,(longlong)pauVar31,iVar23,(longlong)&local_278,uStack276);
      }
      if (((puVar25 != (ulonglong *)0x0) && (puVar29 == (ulonglong *)0x0)) && (local_1bc != 0)) {
        LVar21 = _llseek(HVar18,0,2);
        LVar22 = _llseek(hFile,0,2);
        uVar20 = local_324;
        if (iStack620 != 0) {
          iStack620 = iStack620 + (LVar22 - local_324);
        }
        _llseek(HVar18,local_324,0);
        FUN_18004808c(HVar18,hFile,LVar21 - uVar20);
      }
      _llseek(hFile,local_308,0);
      _hwrite(hFile,(LPCCH)&local_278,0x108);
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_2b0);
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar32);
      pauVar31 = local_2a8;
    }
  }
  else {
LAB_180043d16:
    *pauVar1 = ZEXT816(0);
    pauVar1[1] = ZEXT816(0);
    *(undefined8 *)pauVar1[2] = 0;
    uVar20 = FUN_1800491bc((char *)pauVar1,0,(longlong)".rsrc");
    if (-1 < (int)uVar20) {
      *(uint *)(*pauVar1 + 8) = uVar50;
      *(uint *)pauVar1[1] = (uVar50 - 1) + iStack572 & ~(iStack572 - 1U);
      *(uint *)(*pauVar1 + 0xc) =
           ((uStack576 - 1) + *(int *)(puVar25 + -4) & ~(uStack576 - 1)) +
           *(int *)((longlong)puVar25 + -0x1c);
      *(undefined4 *)(pauVar1[2] + 4) = 0x40000040;
      goto LAB_180043d76;
    }
  }
LAB_18004498b:
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pauVar31);
LAB_1800449b2:
  __security_check_cookie(local_58 ^ (ulonglong)auStackY920);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_1800449dc(HFILE param_1,HFILE param_2,LONG param_3,longlong param_4)

{
  undefined (*pauVar1) [16];
  short sVar2;
  short sVar3;
  undefined2 uVar4;
  undefined2 uVar5;
  undefined4 uVar6;
  longlong **pplVar7;
  undefined8 *puVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  bool bVar11;
  HFILE HVar12;
  HFILE hFile;
  undefined4 *puVar13;
  uint uVar14;
  LONG LVar15;
  LONG LVar16;
  int iVar17;
  int *piVar18;
  undefined4 *puVar19;
  short *psVar20;
  char *pcVar21;
  undefined4 *puVar22;
  undefined4 *puVar23;
  undefined4 *puVar24;
  undefined (*pauVar25) [16];
  undefined8 *puVar26;
  undefined (*pauVar27) [16];
  undefined4 *puVar28;
  uint *puVar29;
  longlong lVar30;
  undefined8 *puVar31;
  uint uVar32;
  undefined8 *puVar33;
  uint uVar34;
  undefined8 *puVar35;
  longlong **pplVar36;
  undefined (*pauVar37) [16];
  undefined8 *puVar38;
  longlong lVar39;
  int iVar40;
  ulonglong uVar41;
  uint uVar42;
  uint uVar43;
  ulonglong uVar44;
  longlong *plVar45;
  uint uVar46;
  longlong in_GS_OFFSET;
  undefined auStackY888 [32];
  longlong *local_320;
  uint local_318;
  uint local_314;
  uint local_310;
  uint local_30c;
  HFILE local_308;
  uint local_304;
  undefined8 local_300;
  uint local_2f8;
  undefined8 *local_2f0;
  LONG local_2e8;
  undefined8 *local_2e0;
  undefined4 *local_2d8;
  longlong *local_2d0;
  LONG local_2c8;
  longlong local_2c0;
  int local_2b8;
  uint local_2b4;
  uint local_2b0;
  char *local_2a8;
  undefined4 *local_2a0;
  undefined4 *local_298;
  undefined (*local_290) [16];
  longlong **local_288;
  HFILE local_280;
  uint local_27c;
  undefined (*local_278) [16];
  undefined8 *local_270;
  undefined4 *local_268;
  undefined4 local_258;
  undefined4 uStack596;
  undefined4 uStack592;
  int iStack588;
  undefined4 local_248;
  undefined4 uStack580;
  undefined4 uStack576;
  undefined4 uStack572;
  int local_238;
  undefined4 uStack564;
  undefined4 uStack560;
  undefined4 uStack556;
  undefined4 local_228;
  undefined4 uStack548;
  uint uStack544;
  int iStack540;
  undefined4 local_218;
  undefined4 uStack532;
  undefined4 uStack528;
  undefined4 uStack524;
  uint local_208;
  uint uStack516;
  undefined4 uStack512;
  undefined4 uStack508;
  undefined4 local_1f8;
  undefined4 uStack500;
  undefined4 uStack496;
  undefined4 uStack492;
  undefined4 local_1e8;
  undefined4 uStack484;
  uint auStack480 [4];
  undefined4 uStack464;
  uint uStack460;
  undefined4 local_1c8;
  undefined4 uStack452;
  undefined4 uStack448;
  undefined4 uStack444;
  undefined4 local_1b8;
  undefined4 uStack436;
  uint uStack432;
  int iStack428;
  undefined4 local_1a8;
  undefined4 uStack420;
  undefined4 uStack416;
  undefined4 uStack412;
  undefined4 local_198;
  undefined4 uStack404;
  undefined4 uStack400;
  undefined4 uStack396;
  undefined4 local_188;
  undefined4 uStack388;
  undefined4 uStack384;
  undefined4 uStack380;
  undefined4 local_178;
  undefined4 uStack372;
  undefined4 uStack368;
  undefined4 uStack364;
  undefined8 local_168;
  undefined4 local_158;
  undefined4 uStack340;
  undefined4 uStack336;
  int iStack332;
  undefined4 local_148;
  undefined4 uStack324;
  undefined4 uStack320;
  undefined4 uStack316;
  int local_138;
  undefined4 uStack308;
  undefined4 uStack304;
  undefined4 uStack300;
  undefined4 local_128;
  undefined4 uStack292;
  uint uStack288;
  int iStack284;
  undefined4 local_118;
  undefined4 uStack276;
  undefined4 uStack272;
  undefined4 uStack268;
  uint local_108;
  uint uStack260;
  undefined4 uStack256;
  undefined4 uStack252;
  undefined4 local_f8;
  undefined4 uStack244;
  undefined4 uStack240;
  undefined4 uStack236;
  undefined4 local_e8;
  undefined4 uStack228;
  uint uStack224;
  undefined4 uStack220;
  undefined4 local_d8;
  undefined4 uStack212;
  undefined4 uStack208;
  uint uStack204;
  undefined4 local_c8;
  undefined4 uStack196;
  undefined4 uStack192;
  undefined4 uStack188;
  undefined4 local_b8;
  undefined4 uStack180;
  uint uStack176;
  int iStack172;
  undefined4 local_a8;
  undefined4 uStack164;
  undefined4 uStack160;
  undefined4 uStack156;
  undefined4 local_98;
  undefined4 uStack148;
  undefined4 uStack144;
  undefined4 uStack140;
  undefined4 local_88;
  undefined4 uStack132;
  undefined4 uStack128;
  undefined4 uStack124;
  undefined4 local_78;
  undefined4 uStack116;
  undefined4 uStack112;
  undefined4 uStack108;
  undefined8 local_68;
  ulonglong local_58;
  
  local_58 = DAT_1800b2220 ^ (ulonglong)auStackY888;
  uVar43 = 0;
  uVar14 = 0xffffffff;
  local_300 = CONCAT44(local_300._4_4_,0xffffffff);
  local_298 = (undefined4 *)0xffffffff;
  local_270 = (undefined8 *)0x0;
  local_30c = 0;
  local_2f0 = (undefined8 *)((ulonglong)local_2f0 & 0xffffffff00000000);
  local_2e0 = (undefined8 *)((ulonglong)local_2e0 & 0xffffffff00000000);
  local_310 = 0;
  local_2f8 = 0;
  local_2d0 = (longlong *)((ulonglong)local_2d0 & 0xffffffff00000000);
  local_2c8 = 0;
  local_304 = 0;
  local_278 = (undefined (*) [16])0x0;
  local_2b4 = 0;
  local_308 = param_1;
  local_2e8 = param_3;
  local_2c0 = param_4;
  local_280 = param_2;
  _llseek(param_1,param_3,0);
  _hread(param_1,&local_158,0xf8);
  local_2b8 = ((uint)uStack340._2_2_ + (uint)uStack340._2_2_ * 4) * 8 + param_3 + 0xf8;
  local_258 = local_158;
  uStack596 = uStack340;
  uStack592 = uStack336;
  iStack588 = iStack332;
  local_248 = local_148;
  uStack580 = uStack324;
  uStack576 = uStack320;
  uStack572 = uStack316;
  local_238 = local_138;
  uStack564 = uStack308;
  uStack560 = uStack304;
  uStack556 = uStack300;
  local_228 = local_128;
  uStack548 = uStack292;
  uStack544 = uStack288;
  iStack540 = iStack284;
  local_218 = local_118;
  uStack532 = uStack276;
  uStack528 = uStack272;
  uStack524 = uStack268;
  local_208 = local_108;
  uStack516 = uStack260;
  uStack512 = uStack256;
  uStack508 = uStack252;
  local_1f8 = local_f8;
  uStack500 = uStack244;
  uStack496 = uStack240;
  uStack492 = uStack236;
  local_1e8 = local_e8;
  uStack484 = uStack228;
  auStack480[0] = uStack224;
  auStack480[1] = uStack220;
  auStack480[2] = local_d8;
  auStack480[3] = uStack212;
  uStack464 = uStack208;
  uStack460 = uStack204;
  local_1c8 = local_c8;
  uStack452 = uStack196;
  uStack448 = uStack192;
  uStack444 = uStack188;
  local_1b8 = local_b8;
  uStack436 = uStack180;
  uStack432 = uStack176;
  iStack428 = iStack172;
  local_1a8 = local_a8;
  uStack420 = uStack164;
  uStack416 = uStack160;
  uStack412 = uStack156;
  local_198 = local_98;
  uStack404 = uStack148;
  uStack400 = uStack144;
  uStack396 = uStack140;
  local_188 = local_88;
  uStack388 = uStack132;
  uStack384 = uStack128;
  uStack380 = uStack124;
  local_178 = local_78;
  uStack372 = uStack116;
  uStack368 = uStack112;
  uStack364 = uStack108;
  local_168 = local_68;
  piVar18 = (int *)KernelBaseGetGlobalData();
  puVar19 = (undefined4 *)
            RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                            *piVar18 + 0x1c0000U | 8,(ulonglong)uStack340._2_2_ * 0x28);
  local_2a0 = puVar19;
  if (puVar19 == (undefined4 *)0x0) goto LAB_180046169;
  memset(puVar19,0,(ulonglong)uStack340._2_2_ * 0x28);
  _llseek(param_1,param_3 + 0xf8,0);
  _hread(param_1,puVar19,((uint)uStack340._2_2_ + (uint)uStack340._2_2_ * 4) * 8);
  uVar32 = 0;
  local_2b0 = 0;
  puVar23 = puVar19 + (ulonglong)uStack340._2_2_ * 10;
  if (puVar19 < puVar23) {
    piVar18 = puVar19 + 4;
    lVar30 = ((ulonglong)uStack340._2_2_ * 0x28 - 1) / 0x28 + 1;
    local_2b0 = uVar32;
    do {
      if (local_2b0 < (uint)piVar18[1]) {
        local_2b0 = *piVar18 + piVar18[1];
      }
      piVar18 = piVar18 + 10;
      lVar30 = lVar30 + -1;
    } while (lVar30 != 0);
  }
  pplVar7 = *(longlong ***)(param_4 + 0x20);
  uVar46 = uVar43;
  uVar42 = uVar32;
  if (pplVar7 != (longlong **)0x0) {
    pplVar36 = pplVar7;
    uVar34 = uVar32;
    do {
      lVar30 = 0;
      plVar45 = pplVar36[4];
      if ((plVar45 != (longlong *)0x0) || (pplVar36[3] != (longlong *)0x0)) {
        local_310 = local_310 + 1;
        local_2e0._0_4_ = (uint)local_2e0 + 1;
        uVar34 = uVar34 + (uint)*(ushort *)((longlong)pplVar36[1] + 0x16) * 2 + 2;
        if (plVar45 != (longlong *)0x0) {
          do {
            uVar43 = uVar43 + 1;
            if (lVar30 == 0) {
LAB_180044cae:
              lVar30 = plVar45[1];
              uVar42 = uVar42 + (uint)*(ushort *)(lVar30 + 0x16) * 2 + 2;
              uVar46 = uVar46 + 1;
            }
            else {
              psVar20 = *(short **)(lVar30 + 0x18);
              lVar30 = *(longlong *)(plVar45[1] + 0x18) - (longlong)psVar20;
              do {
                sVar2 = *psVar20;
                sVar3 = *(short *)((longlong)psVar20 + lVar30);
                if (sVar2 != sVar3) break;
                psVar20 = psVar20 + 1;
              } while (sVar3 != 0);
              lVar30 = plVar45[1];
              if (sVar2 != sVar3) goto LAB_180044cae;
            }
            piVar18 = (int *)((longlong)plVar45 + 0x24);
            plVar45 = (longlong *)*plVar45;
            uVar32 = uVar32 + (*piVar18 + 3U & 0xfffffffc);
          } while (plVar45 != (longlong *)0x0);
          local_2d0 = (longlong *)((ulonglong)local_2d0 & 0xffffffff00000000 | (ulonglong)uVar43);
          local_30c = uVar42;
          local_2f8 = uVar46;
        }
        lVar30 = 0;
        plVar45 = pplVar36[3];
        if (plVar45 != (longlong *)0x0) {
          do {
            uVar43 = uVar43 + 1;
            if ((lVar30 == 0) || (*(short *)(lVar30 + 8) != *(short *)(plVar45[1] + 8))) {
              uVar46 = uVar46 + 1;
            }
            piVar18 = (int *)((longlong)plVar45 + 0x24);
            lVar30 = plVar45[1];
            plVar45 = (longlong *)*plVar45;
            uVar32 = uVar32 + (*piVar18 + 3U & 0xfffffffc);
          } while (plVar45 != (longlong *)0x0);
          local_2d0 = (longlong *)((ulonglong)local_2d0 & 0xffffffff00000000 | (ulonglong)uVar43);
          local_2f8 = uVar46;
        }
      }
      pplVar36 = (longlong **)*pplVar36;
    } while (pplVar36 != (longlong **)0x0);
    local_2e0 = (undefined8 *)
                ((ulonglong)local_2e0 & 0xffffffff00000000 | (ulonglong)(uint)local_2e0);
    uVar14 = (uint)local_298;
    local_2f0 = (undefined8 *)((ulonglong)local_2f0 & 0xffffffff00000000 | (ulonglong)uVar34);
    puVar19 = local_2a0;
  }
  for (puVar26 = *(undefined8 **)(local_2c0 + 0x18); puVar26 != (undefined8 *)0x0;
      puVar26 = (undefined8 *)*puVar26) {
    lVar30 = 0;
    plVar45 = (longlong *)puVar26[4];
    if ((plVar45 != (longlong *)0x0) || (puVar26[3] != 0)) {
      local_310 = local_310 + 1;
      if (plVar45 != (longlong *)0x0) {
        do {
          uVar43 = uVar43 + 1;
          if (lVar30 == 0) {
LAB_180044dbb:
            lVar30 = plVar45[1];
            uVar46 = uVar46 + 1;
            uVar42 = uVar42 + (uint)*(ushort *)(lVar30 + 0x16) * 2 + 2;
          }
          else {
            psVar20 = *(short **)(lVar30 + 0x18);
            lVar30 = *(longlong *)(plVar45[1] + 0x18) - (longlong)psVar20;
            do {
              sVar2 = *psVar20;
              sVar3 = *(short *)((longlong)psVar20 + lVar30);
              if (sVar2 != sVar3) break;
              psVar20 = psVar20 + 1;
            } while (sVar3 != 0);
            lVar30 = plVar45[1];
            if (sVar2 != sVar3) goto LAB_180044dbb;
          }
          piVar18 = (int *)((longlong)plVar45 + 0x24);
          plVar45 = (longlong *)*plVar45;
          uVar32 = uVar32 + (*piVar18 + 3U & 0xfffffffc);
        } while (plVar45 != (longlong *)0x0);
        local_2d0 = (longlong *)((ulonglong)local_2d0 & 0xffffffff00000000 | (ulonglong)uVar43);
        local_30c = uVar42;
        local_2f8 = uVar46;
      }
      lVar30 = 0;
      plVar45 = (longlong *)puVar26[3];
      if (plVar45 != (longlong *)0x0) {
        do {
          uVar43 = uVar43 + 1;
          if ((lVar30 == 0) || (*(short *)(lVar30 + 8) != *(short *)(plVar45[1] + 8))) {
            uVar46 = uVar46 + 1;
          }
          piVar18 = (int *)((longlong)plVar45 + 0x24);
          lVar30 = plVar45[1];
          plVar45 = (longlong *)*plVar45;
          uVar32 = uVar32 + (*piVar18 + 3U & 0xfffffffc);
        } while (plVar45 != (longlong *)0x0);
        local_2d0 = (longlong *)((ulonglong)local_2d0 & 0xffffffff00000000 | (ulonglong)uVar43);
        local_2f8 = uVar46;
      }
    }
    puVar19 = local_2a0;
  }
  uVar46 = (-((int)local_2f0 + local_30c) & 3) + (int)local_2f0 +
           uVar43 * 0x18 + uVar46 * 0x18 + local_310 * 0x18 + 0x10 + local_30c;
  local_2d8 = puVar23;
  local_288 = pplVar7;
  pcVar21 = FUN_18004775c((char *)puVar19,(char *)puVar23,(longlong)".rsrc");
  local_2a8 = pcVar21;
  puVar22 = (undefined4 *)FUN_18004775c((char *)puVar19,(char *)puVar23,(longlong)".rsrc1");
  local_288 = (longlong **)puVar22;
  puVar23 = (undefined4 *)FUN_18004775c((char *)puVar19,(char *)puVar23,(longlong)".reloc");
  uVar43 = local_304;
  if (pcVar21 == (char *)0x0) {
    uVar41 = 0x7fffffff;
  }
  else {
    puVar24 = (undefined4 *)(pcVar21 + 0x28);
    uVar14 = (uint)(((longlong)pcVar21 - (longlong)puVar19) / 0x28);
    if ((puVar24 == puVar22) || (local_2d8 <= puVar24)) {
      uVar41 = 0x7fffffff;
    }
    else {
      if (puVar23 == (undefined4 *)0x0) {
        uVar41 = 0x7fffffff;
      }
      else {
        uVar41 = (ulonglong)(uint)(*(int *)(pcVar21 + 0x34) - *(int *)(pcVar21 + 0xc));
      }
      if ((uint)uVar41 < uVar46) goto LAB_180046169;
    }
    if ((uint)uVar41 < uVar32 + uVar46) {
      if (puVar23 == puVar24) {
        uVar41 = 0x7fffffff;
      }
      else {
        if (puVar22 == (undefined4 *)0x0) {
          iVar17 = puVar23[3];
          local_300 = ((longlong)puVar23 - (longlong)puVar19) / 0x28;
        }
        else {
          local_300 = local_300 & 0xffffffff00000000 |
                      ((longlong)puVar22 - (longlong)puVar19) / 0x28 & 0xffffffffU;
          iVar17 = puVar22[3];
        }
        uVar43 = iVar17 - *(int *)(pcVar21 + 0xc);
      }
    }
  }
  uVar44 = (ulonglong)uVar43;
  local_318 = 0;
  local_314 = uVar46;
  uVar43 = uVar46;
  for (; pplVar7 != (longlong **)0x0; pplVar7 = (longlong **)*pplVar7) {
    plVar45 = pplVar7[4];
    uVar32 = local_314;
    if ((plVar45 != (longlong *)0x0) || (pplVar7[3] != (longlong *)0x0)) {
      while (local_320 = plVar45, local_320 != (longlong *)0x0) {
        uVar43 = FUN_18004727c((longlong *)&local_320,(uint)uVar44,uVar43,(uint)uVar41,&local_318);
        plVar45 = local_320;
        uVar32 = uVar43;
      }
      local_320 = pplVar7[3];
      local_314 = uVar32;
      while (local_320 != (longlong *)0x0) {
        uVar32 = FUN_18004727c((longlong *)&local_320,(uint)uVar44,uVar43,(uint)uVar41,&local_318);
        uVar43 = uVar32;
      }
    }
    local_314 = uVar32;
  }
  uStack340._2_2_ = (ushort)(uStack340 >> 0x10);
  puVar23 = local_2d8;
  for (puVar26 = *(undefined8 **)(local_2c0 + 0x18); local_2d8 = puVar23,
      puVar26 != (undefined8 *)0x0; puVar26 = (undefined8 *)*puVar26) {
    plVar45 = (longlong *)puVar26[4];
    uVar32 = local_314;
    if ((plVar45 != (longlong *)0x0) || (puVar26[3] != 0)) {
      while (local_320 = plVar45, local_320 != (longlong *)0x0) {
        uVar43 = FUN_18004727c((longlong *)&local_320,(uint)uVar44,uVar43,(uint)uVar41,&local_318);
        plVar45 = local_320;
        uVar32 = uVar43;
      }
      local_320 = (longlong *)puVar26[3];
      local_314 = uVar32;
      while (local_320 != (longlong *)0x0) {
        uVar32 = FUN_18004727c((longlong *)&local_320,(uint)uVar44,uVar43,(uint)uVar41,&local_318);
        uVar43 = uVar32;
      }
    }
    local_314 = uVar32;
    puVar23 = local_2d8;
  }
  if (local_318 == 0) {
    local_318 = uVar43;
  }
  puVar24 = (undefined4 *)FUN_18004775c((char *)puVar19,(char *)puVar23,(longlong)".debug");
  local_268 = puVar24;
  if ((puVar24 != (undefined4 *)0x0) && ((uStack176 == 0 || (puVar24 != puVar23 + -10))))
  goto LAB_180046169;
  local_298 = (undefined4 *)0x0;
  for (puVar28 = puVar19;
      (puVar13 = local_298, puVar28 < puVar23 &&
      ((uStack176 < (uint)puVar28[3] ||
       (puVar13 = puVar28, (uint)(puVar28[3] + puVar28[4]) <= uStack176)))); puVar28 = puVar28 + 10)
  {
  }
  local_298 = puVar13;
  puVar23 = (undefined4 *)FUN_18004775c((char *)puVar19,(char *)puVar23,(longlong)".reloc");
  if (uVar14 == 0xffffffff) {
    puVar28 = puVar23;
    if ((puVar23 == (undefined4 *)0x0) && (puVar28 = puVar24, puVar24 == (undefined4 *)0x0)) {
      uVar14 = (uint)uStack596._2_2_;
    }
    else {
      uVar14 = (uint)(((longlong)puVar28 - (longlong)puVar19) / 0x28);
    }
    uStack596._2_2_ = uStack596._2_2_ + 1;
    uStack596 = uStack596 & 0xffff | (uint)uStack596._2_2_ << 0x10;
  }
  if ((int)local_300 == -1) {
    if (puVar22 != (undefined4 *)0x0) {
      uStack596._2_2_ = uStack596._2_2_ - 1;
      goto LAB_180045259;
    }
  }
  else {
    if (puVar22 == (undefined4 *)0x0) {
      if (puVar23 == (undefined4 *)0x0) {
        if (puVar24 == (undefined4 *)0x0) {
          local_300 = (ulonglong)uStack596._2_2_;
          goto LAB_180045246;
        }
        lVar30 = SUB168(SEXT816(0x6666666666666667) * SEXT816((longlong)puVar24 - (longlong)puVar19)
                        >> 0x40,0);
      }
      else {
        lVar30 = SUB168(SEXT816(0x6666666666666667) * SEXT816((longlong)puVar23 - (longlong)puVar19)
                        >> 0x40,0);
      }
      local_300 = local_300 & 0xffffffff00000000 |
                  (ulonglong)(uint)((int)(lVar30 >> 4) - (int)(lVar30 >> 0x3f));
    }
    else {
      uStack596._2_2_ = uStack596._2_2_ - 1;
      local_300 = local_300 & 0xffffffff00000000 |
                  ((longlong)puVar22 - (longlong)puVar19) / 0x28 & 0xffffffffU;
    }
LAB_180045246:
    uStack596._2_2_ = uStack596._2_2_ + 1;
LAB_180045259:
    uStack596 = uStack596 & 0xffff | (uint)uStack596._2_2_ << 0x10;
  }
  lVar30 = 0x10;
  local_27c = ((uint)uStack596._2_2_ - (uint)uStack340._2_2_) * 0x28;
  uVar43 = ((uStack260 + ((uint)uStack340._2_2_ + (uint)uStack340._2_2_ * 4) * -8) - local_2e8) -
           0xf8;
  if (uVar43 < local_27c) {
    local_27c = local_27c - uVar43;
    local_2b4 = iStack540 + -1 + local_27c & ~(iStack540 - 1U);
    puVar29 = auStack480;
    do {
      uVar43 = *puVar29;
      if ((uVar43 != 0) && (uVar43 < uStack516)) {
        *puVar29 = uVar43 + local_27c;
      }
      puVar29 = puVar29 + 2;
      lVar30 = lVar30 + -1;
    } while (lVar30 != 0);
    uStack516 = uStack516 + local_27c;
LAB_1800452f8:
  }
  else if (local_27c != 0) {
    puVar29 = auStack480;
    lVar30 = 0x10;
    do {
      uVar43 = *puVar29;
      if ((uVar43 != 0) && (uVar43 < uStack260)) {
        *puVar29 = uVar43 + local_27c;
      }
      puVar29 = puVar29 + 2;
      lVar30 = lVar30 + -1;
    } while (lVar30 != 0);
    goto LAB_1800452f8;
  }
  local_27c = local_2b8 + local_27c;
  KernelBaseGetGlobalData();
  pauVar25 = (undefined (*) [16])
             RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
  local_290 = pauVar25;
  if (pauVar25 == (undefined (*) [16])0x0) goto LAB_180046169;
  memset(pauVar25,0,(ulonglong)(((uint)uStack596._2_2_ + (uint)uStack596._2_2_ * 4) * 8));
  uVar43 = local_318;
  uVar41 = 0;
  pauVar1 = (undefined (*) [16])((longlong)pauVar25 + (longlong)(int)uVar14 * 0x28);
  pauVar27 = pauVar25;
  puVar23 = local_2d8;
  puVar24 = local_2a0;
  uVar44 = uVar41;
  puVar19 = local_2a0;
  if (local_2a0 < local_2d8) {
    do {
      puVar28 = puVar19 + 10;
      iVar40 = (int)uVar41;
      iVar17 = (int)local_300;
      if (puVar24 == puVar22) {
        pauVar37 = pauVar27;
        if ((iVar17 == -1) && (puVar28 < puVar23)) {
          uVar41 = (ulonglong)(uint)(iVar40 + (puVar19[3] - puVar19[0xd]));
        }
      }
      else {
        if (pauVar27 == pauVar1) {
          iVar17 = uVar43 - 1;
          uVar44 = 1;
          uVar14 = iVar17 + iStack540 & ~(iStack540 - 1U);
          if (local_2a8 == (char *)0x0) {
            *pauVar27 = ZEXT816(0);
            uVar41 = (ulonglong)(uStack544 + iVar17 & ~(uStack544 - 1));
            pauVar27[1] = ZEXT816(0);
            *(undefined8 *)pauVar27[2] = 0;
            uVar32 = FUN_1800491bc((char *)pauVar27,(ulonglong)uStack544,(longlong)".rsrc");
            if ((int)uVar32 < 0) goto LAB_180046142;
            *(undefined4 *)(*pauVar27 + 0xc) = puVar28[-7];
            *(undefined4 *)(pauVar27[1] + 4) = puVar28[-5];
            *(undefined4 *)(pauVar27[2] + 4) = 0x40000040;
            *(uint *)pauVar27[1] = uVar14;
            *(uint *)(*pauVar27 + 8) = uVar43;
            puVar23 = local_2d8;
          }
          else {
            uVar6 = puVar24[1];
            uVar9 = puVar24[2];
            uVar10 = puVar24[3];
            *(undefined4 *)*pauVar27 = *puVar24;
            *(undefined4 *)(*pauVar27 + 4) = uVar6;
            *(undefined4 *)(*pauVar27 + 8) = uVar9;
            *(undefined4 *)(*pauVar27 + 0xc) = uVar10;
            uVar6 = puVar24[5];
            uVar9 = puVar24[6];
            uVar10 = puVar24[7];
            *(undefined4 *)pauVar27[1] = puVar24[4];
            *(undefined4 *)(pauVar27[1] + 4) = uVar6;
            *(undefined4 *)(pauVar27[1] + 8) = uVar9;
            *(undefined4 *)(pauVar27[1] + 0xc) = uVar10;
            *(undefined8 *)pauVar27[2] = *(undefined8 *)(puVar24 + 8);
            *(uint *)pauVar27[1] = uVar14;
            *(uint *)(*pauVar27 + 8) = uVar43;
            uVar41 = 0;
            if (uVar14 != puVar19[4]) {
              uVar14 = iVar40 + (iVar17 + uStack544 & ~(uStack544 - 1));
              if (puVar28 < puVar23) {
                uVar14 = uVar14 + (puVar19[3] - puVar19[0xd]);
              }
              uVar41 = (ulonglong)uVar14;
            }
          }
          pauVar27 = (undefined (*) [16])(pauVar27[2] + 8);
          pauVar37 = pauVar27;
          if (local_2a8 != (char *)0x0) goto LAB_1800454b7;
        }
        else if ((iVar17 == -1) ||
                (pauVar27 != (undefined (*) [16])((longlong)pauVar25 + (longlong)iVar17 * 0x28))) {
          if (pauVar27 < pauVar1) {
            uVar6 = puVar24[1];
            uVar9 = puVar24[2];
            uVar10 = puVar24[3];
            *(undefined4 *)*pauVar27 = *puVar24;
            *(undefined4 *)(*pauVar27 + 4) = uVar6;
            *(undefined4 *)(*pauVar27 + 8) = uVar9;
            *(undefined4 *)(*pauVar27 + 0xc) = uVar10;
            uVar6 = puVar24[5];
            uVar9 = puVar24[6];
            uVar10 = puVar24[7];
            *(undefined4 *)pauVar27[1] = puVar24[4];
            *(undefined4 *)(pauVar27[1] + 4) = uVar6;
            *(undefined4 *)(pauVar27[1] + 8) = uVar9;
            *(undefined4 *)(pauVar27[1] + 0xc) = uVar10;
            *(undefined8 *)pauVar27[2] = *(undefined8 *)(puVar24 + 8);
            pauVar37 = (undefined (*) [16])(pauVar27[2] + 8);
            goto LAB_1800454b7;
          }
        }
        else {
          *pauVar27 = ZEXT816(0);
          pauVar27[1] = ZEXT816(0);
          *(undefined8 *)pauVar27[2] = 0;
          uVar14 = FUN_1800491bc((char *)pauVar27,0,(longlong)".rsrc1");
          if ((int)uVar14 < 0) goto LAB_180046142;
          if (puVar22 == (undefined4 *)0x0) {
            iVar17 = puVar28[-7];
            *(int *)(*pauVar27 + 0xc) = iVar17;
            *(undefined4 *)(pauVar27[2] + 4) = 0x40000040;
            uVar14 = ((~(uStack544 - 1) & uStack544 + (local_314 - 1)) - iVar17) +
                     *(int *)(*pauVar1 + 0xc);
          }
          else {
            *(undefined4 *)(*pauVar27 + 0xc) = puVar22[3];
            *(undefined4 *)(pauVar27[2] + 4) = 0x40000040;
            uVar14 = ((~(uStack544 - 1) & uStack544 + (local_314 - 1)) - puVar28[-7]) +
                     *(int *)(*pauVar1 + 0xc);
          }
          uVar41 = (ulonglong)uVar14;
          pauVar27 = (undefined (*) [16])(pauVar27[2] + 8);
        }
        uVar6 = puVar24[1];
        uVar9 = puVar24[2];
        uVar10 = puVar24[3];
        *(undefined4 *)*pauVar27 = *puVar24;
        *(undefined4 *)(*pauVar27 + 4) = uVar6;
        *(undefined4 *)(*pauVar27 + 8) = uVar9;
        *(undefined4 *)(*pauVar27 + 0xc) = uVar10;
        uVar6 = puVar24[5];
        uVar9 = puVar24[6];
        uVar10 = puVar24[7];
        *(undefined4 *)pauVar27[1] = puVar24[4];
        *(undefined4 *)(pauVar27[1] + 4) = uVar6;
        *(undefined4 *)(pauVar27[1] + 8) = uVar9;
        *(undefined4 *)(pauVar27[1] + 0xc) = uVar10;
        *(undefined8 *)pauVar27[2] = *(undefined8 *)(puVar24 + 8);
        pauVar37 = (undefined (*) [16])(pauVar27[2] + 8);
        *(int *)(*pauVar27 + 0xc) = *(int *)(*pauVar27 + 0xc) + (int)uVar41;
        puVar23 = local_2d8;
      }
LAB_1800454b7:
      puVar24 = puVar24 + 10;
      pauVar27 = pauVar37;
      puVar19 = puVar28;
    } while (puVar24 < puVar23);
    if ((int)uVar44 == 0) goto LAB_1800454cd;
LAB_18004552d:
    local_208 = (uStack544 - 1) +
                *(int *)((longlong)pauVar25 + (ulonglong)uStack596._2_2_ * 0x28 + -0x1c) +
                *(int *)((longlong)pauVar25 + (ulonglong)uStack596._2_2_ * 0x28 + -0x18) &
                ~(uStack544 - 1);
    piVar18 = (int *)KernelBaseGetGlobalData();
    puVar26 = (undefined8 *)
              RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                              *piVar18 + 0x1c0000U | 8,uVar46);
    if (puVar26 != (undefined8 *)0x0) {
      memset(puVar26,0,(ulonglong)uVar46);
      puVar31 = puVar26 + 2;
      *(short *)((longlong)puVar26 + 0xc) = (short)local_2e0;
      *(short *)((longlong)puVar26 + 0xe) = (short)local_310 - (short)local_2e0;
      puVar35 = puVar31 + local_310;
      *puVar26 = 0;
      *(undefined4 *)(puVar26 + 1) = 4;
      puVar38 = puVar31 + (ulonglong)local_2f8 + (ulonglong)local_310 * 3;
      puVar33 = puVar38 + ((ulonglong)local_2d0 & 0xffffffff) + (ulonglong)local_2f8 * 2;
      plVar45 = puVar33 + ((ulonglong)local_2d0 & 0xffffffff) * 2;
      local_2d0 = (longlong *)
                  ((longlong)plVar45 + (ulonglong)local_30c + ((ulonglong)local_2f0 & 0xffffffff));
      iVar17 = (int)puVar26;
      for (puVar8 = *(undefined8 **)(local_2c0 + 0x20); local_320 = plVar45,
          puVar8 != (undefined8 *)0x0; puVar8 = (undefined8 *)*puVar8) {
        *(uint *)puVar31 = (int)plVar45 - iVar17 | 0x80000000;
        *(uint *)((longlong)puVar31 + 4) = (int)puVar35 - iVar17 | 0x80000000;
        local_2e0 = puVar31 + 1;
        *(undefined2 *)plVar45 = *(undefined2 *)(puVar8[1] + 0x16);
        local_2f0 = puVar8;
        wcsncpy((wchar_t *)((longlong)plVar45 + 2),*(wchar_t **)(puVar8[1] + 0x18),
                (ulonglong)*(ushort *)(puVar8[1] + 0x16));
        lVar30 = 0;
        uVar4 = *(undefined2 *)((longlong)puVar8 + 0x2c);
        uVar5 = *(undefined2 *)(puVar8 + 5);
        plVar45 = (longlong *)((longlong)plVar45 + (ulonglong)*(ushort *)(puVar8[1] + 0x16) * 2 + 2)
        ;
        *puVar35 = 0;
        *(undefined4 *)(puVar35 + 1) = 4;
        *(undefined2 *)((longlong)puVar35 + 0xc) = uVar4;
        *(undefined2 *)((longlong)puVar35 + 0xe) = uVar5;
        puVar35 = puVar35 + 2;
        puVar31 = (undefined8 *)puVar8[4];
        local_320 = plVar45;
        for (; puVar31 != (undefined8 *)0x0; puVar31 = (undefined8 *)*puVar31) {
          if (lVar30 == 0) {
LAB_1800457e2:
            *(uint *)puVar35 = (int)plVar45 - iVar17 | 0x80000000;
            *(uint *)((longlong)puVar35 + 4) = (int)puVar38 - iVar17 | 0x80000000;
            puVar35 = puVar35 + 1;
            *(undefined2 *)plVar45 = *(undefined2 *)(puVar31[1] + 0x16);
            wcsncpy((wchar_t *)((longlong)plVar45 + 2),*(wchar_t **)(puVar31[1] + 0x18),
                    (ulonglong)*(ushort *)(puVar31[1] + 0x16));
            lVar30 = puVar31[1];
            plVar45 = (longlong *)
                      ((longlong)plVar45 + (ulonglong)*(ushort *)(lVar30 + 0x16) * 2 + 2);
            *(undefined2 *)((longlong)puVar38 + 0xe) = *(undefined2 *)((longlong)puVar31 + 0x32);
            *puVar38 = 0;
            *(undefined4 *)(puVar38 + 1) = 4;
            *(undefined2 *)((longlong)puVar38 + 0xc) = 0;
            puVar38 = puVar38 + 2;
          }
          else {
            psVar20 = *(short **)(lVar30 + 0x18);
            lVar39 = *(longlong *)(puVar31[1] + 0x18) - (longlong)psVar20;
            do {
              sVar2 = *psVar20;
              sVar3 = *(short *)((longlong)psVar20 + lVar39);
              if (sVar2 != sVar3) break;
              psVar20 = psVar20 + 1;
            } while (sVar3 != 0);
            if (sVar2 != sVar3) goto LAB_1800457e2;
          }
          *(uint *)puVar38 = (uint)*(ushort *)((longlong)puVar31 + 0x34);
          *(int *)((longlong)puVar38 + 4) = (int)puVar33 - iVar17;
          puVar38 = puVar38 + 1;
          uVar6 = *(undefined4 *)((longlong)puVar31 + 0x24);
          *(int *)puVar33 = *(int *)(puVar31 + 2) + *(int *)(*pauVar1 + 0xc);
          *(undefined4 *)((longlong)puVar33 + 4) = uVar6;
          puVar33[1] = 0x4e4;
          puVar33 = puVar33 + 2;
          puVar8 = local_2f0;
        }
        lVar30 = 0;
        for (puVar31 = (undefined8 *)puVar8[3]; puVar31 != (undefined8 *)0x0;
            puVar31 = (undefined8 *)*puVar31) {
          if ((lVar30 == 0) || (*(short *)(lVar30 + 8) != *(short *)(puVar31[1] + 8))) {
            *(uint *)puVar35 = (uint)*(ushort *)(puVar31[1] + 8);
            *(uint *)((longlong)puVar35 + 4) = (int)puVar38 - iVar17 | 0x80000000;
            puVar35 = puVar35 + 1;
            lVar30 = puVar31[1];
            uVar4 = *(undefined2 *)((longlong)puVar31 + 0x32);
            *puVar38 = 0;
            *(undefined2 *)((longlong)puVar38 + 0xe) = uVar4;
            *(undefined4 *)(puVar38 + 1) = 4;
            *(undefined2 *)((longlong)puVar38 + 0xc) = 0;
            puVar38 = puVar38 + 2;
          }
          *(uint *)puVar38 = (uint)*(ushort *)((longlong)puVar31 + 0x34);
          *(int *)((longlong)puVar38 + 4) = (int)puVar33 - iVar17;
          puVar38 = puVar38 + 1;
          uVar6 = *(undefined4 *)((longlong)puVar31 + 0x24);
          *(int *)puVar33 = *(int *)(puVar31 + 2) + *(int *)(*pauVar1 + 0xc);
          *(undefined4 *)((longlong)puVar33 + 4) = uVar6;
          puVar33[1] = 0x4e4;
          puVar33 = puVar33 + 2;
        }
        puVar31 = local_2e0;
      }
      for (local_2f0 = *(undefined8 **)(local_2c0 + 0x18); HVar12 = local_308, lVar30 = 0,
          local_2f0 != (undefined8 *)0x0; local_2f0 = (undefined8 *)*local_2f0) {
        *(uint *)puVar31 = (uint)*(ushort *)(local_2f0[1] + 8);
        *(uint *)((longlong)puVar31 + 4) = (int)puVar35 - iVar17 | 0x80000000;
        uVar4 = *(undefined2 *)(local_2f0 + 5);
        uVar5 = *(undefined2 *)((longlong)local_2f0 + 0x2c);
        *puVar35 = 0;
        *(undefined2 *)((longlong)puVar35 + 0xc) = uVar5;
        *(undefined2 *)((longlong)puVar35 + 0xe) = uVar4;
        *(undefined4 *)(puVar35 + 1) = 4;
        puVar35 = puVar35 + 2;
        puVar31 = puVar31 + 1;
        plVar45 = local_320;
        for (puVar8 = (undefined8 *)local_2f0[4]; local_2e0 = puVar31, puVar8 != (undefined8 *)0x0;
            puVar8 = (undefined8 *)*puVar8) {
          if (lVar30 == 0) {
LAB_1800459db:
            *(uint *)puVar35 = (int)plVar45 - iVar17 | 0x80000000;
            *(uint *)((longlong)puVar35 + 4) = (int)puVar38 - iVar17 | 0x80000000;
            puVar35 = puVar35 + 1;
            *(undefined2 *)plVar45 = *(undefined2 *)(puVar8[1] + 0x16);
            wcsncpy((wchar_t *)((longlong)plVar45 + 2),*(wchar_t **)(puVar8[1] + 0x18),
                    (ulonglong)*(ushort *)(puVar8[1] + 0x16));
            lVar30 = puVar8[1];
            plVar45 = (longlong *)
                      ((longlong)plVar45 + (ulonglong)*(ushort *)(lVar30 + 0x16) * 2 + 2);
            *(undefined2 *)((longlong)puVar38 + 0xe) = *(undefined2 *)((longlong)puVar8 + 0x32);
            *puVar38 = 0;
            *(undefined4 *)(puVar38 + 1) = 4;
            *(undefined2 *)((longlong)puVar38 + 0xc) = 0;
            puVar38 = puVar38 + 2;
          }
          else {
            psVar20 = *(short **)(lVar30 + 0x18);
            lVar39 = *(longlong *)(puVar8[1] + 0x18) - (longlong)psVar20;
            do {
              sVar2 = *psVar20;
              sVar3 = *(short *)((longlong)psVar20 + lVar39);
              if (sVar2 != sVar3) break;
              psVar20 = psVar20 + 1;
            } while (sVar3 != 0);
            if (sVar2 != sVar3) goto LAB_1800459db;
          }
          *(uint *)puVar38 = (uint)*(ushort *)((longlong)puVar8 + 0x34);
          *(int *)((longlong)puVar38 + 4) = (int)puVar33 - iVar17;
          puVar38 = puVar38 + 1;
          uVar6 = *(undefined4 *)((longlong)puVar8 + 0x24);
          *(int *)puVar33 = *(int *)(puVar8 + 2) + *(int *)(*pauVar1 + 0xc);
          *(undefined4 *)((longlong)puVar33 + 4) = uVar6;
          puVar33[1] = 0x4e4;
          puVar33 = puVar33 + 2;
          puVar31 = local_2e0;
        }
        lVar30 = 0;
        for (puVar8 = (undefined8 *)local_2f0[3]; puVar8 != (undefined8 *)0x0;
            puVar8 = (undefined8 *)*puVar8) {
          if ((lVar30 == 0) || (*(short *)(lVar30 + 8) != *(short *)(puVar8[1] + 8))) {
            *(uint *)puVar35 = (uint)*(ushort *)(puVar8[1] + 8);
            *(uint *)((longlong)puVar35 + 4) = (int)puVar38 - iVar17 | 0x80000000;
            puVar35 = puVar35 + 1;
            lVar30 = puVar8[1];
            uVar4 = *(undefined2 *)((longlong)puVar8 + 0x32);
            *puVar38 = 0;
            *(undefined2 *)((longlong)puVar38 + 0xe) = uVar4;
            *(undefined4 *)(puVar38 + 1) = 4;
            *(undefined2 *)((longlong)puVar38 + 0xc) = 0;
            puVar38 = puVar38 + 2;
          }
          *(uint *)puVar38 = (uint)*(ushort *)((longlong)puVar8 + 0x34);
          *(int *)((longlong)puVar38 + 4) = (int)puVar33 - iVar17;
          puVar38 = puVar38 + 1;
          uVar6 = *(undefined4 *)((longlong)puVar8 + 0x24);
          *(int *)puVar33 = *(int *)(puVar8 + 2) + *(int *)(*pauVar1 + 0xc);
          *(undefined4 *)((longlong)puVar33 + 4) = uVar6;
          puVar33[1] = 0x4e4;
          puVar33 = puVar33 + 2;
        }
        local_320 = plVar45;
      }
      if (local_320 < local_2d0) {
        plVar45 = local_320;
        for (lVar30 = ((ulonglong)((longlong)local_2d0 + (-1 - (longlong)local_320)) >> 1) + 1;
            lVar30 != 0; lVar30 = lVar30 + -1) {
          *(undefined2 *)plVar45 = 0;
          plVar45 = (longlong *)((longlong)plVar45 + 2);
        }
      }
      _llseek(local_308,0,0);
      hFile = local_280;
      FUN_18004808c(HVar12,local_280,local_2e8 + 0xf8);
      uVar14 = local_27c;
      _llseek(hFile,local_27c,0);
      _llseek(HVar12,local_2b8,0);
      if (uVar14 < uStack260) {
        FUN_18004808c(HVar12,hFile,uStack260 - uVar14);
      }
      uVar14 = iStack540 - (iStack540 - 1U & uStack516) & iStack540 - 1U;
      uStack516 = uStack516 + uVar14;
      if (0xf < (int)uVar14) {
        uVar41 = (ulonglong)(uVar14 >> 4);
        uVar14 = uVar14 + (uVar14 >> 4) * -0x10;
        do {
          _hwrite(hFile,"",0x10);
          uVar41 = uVar41 - 1;
        } while (uVar41 != 0);
      }
      _hwrite(hFile,"",uVar14);
      _llseek(HVar12,(uStack260 - 1) + iStack284 & ~(iStack284 - 1U),0);
      bVar11 = false;
      local_238 = 0;
      puVar19 = local_2a0;
      pauVar25 = local_290;
      if (local_2a0 < local_2d8) {
        do {
          puVar23 = puVar19 + 10;
          if ((longlong **)puVar19 != local_288) {
            puVar23 = puVar19;
          }
          if (pauVar25 == pauVar1) {
            bVar11 = true;
            LVar15 = _llseek(hFile,0,1);
            *(LONG *)(pauVar25[1] + 4) = LVar15;
            uStack464 = *(undefined4 *)(*pauVar1 + 0xc);
            uStack460 = local_314;
            local_2c8 = _llseek(hFile,0,1);
            _hwrite(hFile,(LPCCH)puVar26,uVar46);
            local_270 = FUN_180048a8c(local_2c0,hFile,iStack540,*(int *)pauVar1[1] - uVar46,
                                      (undefined8 *)0x0);
            LVar15 = _llseek(hFile,0,1);
            if ((int)local_300 == -1) {
              _llseek(hFile,local_2c8,0);
              _hwrite(hFile,(LPCCH)puVar26,uVar46);
              _llseek(hFile,LVar15,0);
              LVar15 = _llseek(local_308,0,1);
              _llseek(local_308,puVar23[4] + LVar15,0);
            }
            local_238 = local_238 + *(int *)pauVar25[1];
            if (local_2a8 == (char *)0x0) {
LAB_180045d51:
              pauVar25 = (undefined (*) [16])(pauVar25[2] + 8);
              goto LAB_180045e26;
            }
          }
          else {
            if (((int)local_300 != -1) &&
               (pauVar25 ==
                (undefined (*) [16])((longlong)local_290 + (longlong)(int)local_300 * 0x28))) {
              LVar15 = _llseek(hFile,0,1);
              *(LONG *)(pauVar25[1] + 4) = LVar15;
              FUN_180048a8c(local_2c0,hFile,iStack540,0xffffffff,local_270);
              LVar15 = _llseek(hFile,0,1);
              iVar17 = LVar15 - *(int *)(pauVar25[1] + 4);
              *(int *)pauVar25[1] = iVar17;
              *(int *)(*pauVar25 + 8) = iVar17;
              _llseek(hFile,local_2c8,0);
              _hwrite(hFile,(LPCCH)puVar26,uVar46);
              _llseek(hFile,LVar15,0);
              local_238 = local_238 + *(int *)pauVar25[1];
              goto LAB_180045d51;
            }
            if (pauVar25 < pauVar1) {
              if (puVar23[5] != 0) {
                LVar15 = _llseek(hFile,0,1);
                if (puVar23[5] != LVar15) {
                  _llseek(hFile,local_2b4 + puVar23[5],0);
                }
                goto LAB_180045e26;
              }
            }
            else {
LAB_180045e26:
              if (puVar23[5] != 0) {
                LVar15 = _llseek(hFile,0,1);
                *(LONG *)(pauVar25[1] + 4) = LVar15;
                _llseek(local_308,puVar23[5],0);
                FUN_18004808c(local_308,hFile,puVar23[4]);
              }
            }
            pauVar27 = pauVar25;
            if (puVar23 != local_298) {
              pauVar27 = local_278;
            }
            local_278 = pauVar27;
            if ((pauVar25[2][4] & 0x40) != 0) {
              local_238 = local_238 + *(int *)pauVar25[1];
            }
          }
          puVar19 = puVar23 + 10;
          pauVar25 = (undefined (*) [16])(pauVar25[2] + 8);
        } while (puVar19 < local_2d8);
      }
      if (local_288 != (longlong **)0x0) {
        local_238 = local_238 - *(int *)((longlong)local_288 + 0x10);
      }
      if (!bVar11) {
        LVar15 = _llseek(hFile,0,1);
        *(LONG *)(pauVar1[1] + 4) = LVar15;
        uStack464 = *(undefined4 *)(*pauVar1 + 0xc);
        uStack460 = local_314;
        LVar15 = _llseek(hFile,0,1);
        _hwrite(hFile,(LPCCH)puVar26,uVar46);
        FUN_180048a8c(local_2c0,hFile,iStack540,*(int *)pauVar1[1] - uVar46,(undefined8 *)0x0);
        LVar16 = _llseek(hFile,0,1);
        if ((int)local_300 == -1) {
          _llseek(hFile,LVar15,0);
          _hwrite(hFile,(LPCCH)puVar26,uVar46);
          _llseek(hFile,LVar16,0);
        }
        local_238 = local_238 + *(int *)pauVar25[1];
      }
      pauVar25 = local_290;
      pcVar21 = FUN_18004775c((char *)local_290,
                              (char *)((longlong)local_290 + (ulonglong)uStack596._2_2_ * 0x28),
                              (longlong)".reloc");
      if (pcVar21 != (char *)0x0) {
        local_1b8 = *(undefined4 *)(pcVar21 + 0xc);
      }
      _llseek(hFile,local_2e8 + 0xf8,0);
      _hwrite(hFile,(LPCCH)pauVar25,((uint)uStack596._2_2_ + (uint)uStack596._2_2_ * 4) * 8);
      local_304 = _llseek(hFile,0,2);
      _hwrite(hFile,(LPCCH)0x0,0);
      pcVar21 = FUN_18004775c((char *)pauVar25,
                              (char *)((longlong)pauVar25 + (ulonglong)uStack596._2_2_ * 0x28),
                              (longlong)".debug");
      puVar23 = local_268;
      puVar19 = local_298;
      iVar17 = FUN_180046400(local_308,hFile,(longlong)local_268,(longlong)pcVar21,
                             (longlong)local_298,(longlong)local_278,(longlong)&local_158,
                             (longlong)&local_258,local_2b0,&local_304);
      HVar12 = local_308;
      if (iVar17 == 0) {
        if (local_2a8 == (char *)0x0) {
          iVar17 = *(int *)pauVar1[1];
        }
        else {
          iVar17 = *(int *)(local_2a8 + 0x10) - *(int *)pauVar1[1];
        }
        FUN_180046844(local_308,hFile,(longlong)pauVar25,iVar17,(longlong)&local_258,uStack260);
      }
      if (((puVar19 != (undefined4 *)0x0) && (puVar23 == (undefined4 *)0x0)) && (iStack428 != 0)) {
        LVar15 = _llseek(HVar12,0,2);
        LVar16 = _llseek(hFile,0,2);
        uVar14 = local_304;
        if (iStack588 != 0) {
          iStack588 = iStack588 + (LVar16 - local_304);
        }
        _llseek(HVar12,local_304,0);
        FUN_18004808c(HVar12,hFile,LVar15 - uVar14);
      }
      _llseek(hFile,local_2e8,0);
      _hwrite(hFile,(LPCCH)&local_258,0xf8);
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_2a0);
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar26);
      pauVar25 = local_290;
    }
  }
  else {
LAB_1800454cd:
    *pauVar1 = ZEXT816(0);
    pauVar1[1] = ZEXT816(0);
    *(undefined8 *)pauVar1[2] = 0;
    uVar14 = FUN_1800491bc((char *)pauVar1,0,(longlong)".rsrc");
    if (-1 < (int)uVar14) {
      *(uint *)(*pauVar1 + 8) = uVar43;
      *(uint *)pauVar1[1] = (uVar43 - 1) + iStack540 & ~(iStack540 - 1U);
      *(uint *)(*pauVar1 + 0xc) = ((uStack544 - 1) + puVar24[-8] & ~(uStack544 - 1)) + puVar24[-7];
      *(undefined4 *)(pauVar1[2] + 4) = 0x40000040;
      goto LAB_18004552d;
    }
  }
LAB_180046142:
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pauVar25);
LAB_180046169:
  __security_check_cookie(local_58 ^ (ulonglong)auStackY888);
  return;
}



undefined4
FUN_180046194(HFILE param_1,HFILE param_2,longlong param_3,longlong param_4,longlong param_5,
             longlong param_6,longlong param_7,longlong param_8,uint param_9,uint *param_10)

{
  LPCCH pCVar1;
  uint uVar2;
  LPCCH lpBuffer;
  longlong lVar3;
  int iVar4;
  ulonglong uVar5;
  LPCCH pCVar6;
  int *piVar7;
  uint uVar8;
  uint *puVar9;
  longlong in_GS_OFFSET;
  bool bVar10;
  uint local_48;
  
  local_48 = 0;
  if (param_5 == 0) {
    return 0;
  }
  if (*(int *)(param_8 + 0xbc) == 0) {
    return 0;
  }
  KernelBaseGetGlobalData();
  lpBuffer = (LPCCH)RtlAllocateHeap();
  if (lpBuffer == (LPCCH)0x0) {
    return 8;
  }
  if (param_3 == 0) {
    local_48 = *param_10;
  }
  iVar4 = *(int *)(param_7 + 0xb8) - *(int *)(param_5 + 0xc);
  _llseek(param_1,*(int *)(param_5 + 0x14) + iVar4,0);
  uVar8 = *(uint *)(param_8 + 0xbc);
  uVar5 = (ulonglong)uVar8 / 7;
  lVar3 = ((uVar8 - uVar5 >> 1) + uVar5 >> 4) * 0x1c;
  pCVar1 = lpBuffer + lVar3;
  _hread(param_1,lpBuffer,uVar8);
  if (param_3 != 0) {
    if (lpBuffer < pCVar1) {
      piVar7 = (int *)(lpBuffer + 0x18);
      uVar5 = (lVar3 - 1U) / 7;
      lVar3 = (((lVar3 - 1U) - uVar5 >> 1) + uVar5 >> 4) + 1;
      do {
        piVar7[-1] = piVar7[-1] + (*(int *)(param_4 + 0xc) - *(int *)(param_3 + 0xc));
        *piVar7 = *piVar7 + (*(int *)(param_4 + 0x14) - *(int *)(param_3 + 0x14));
        piVar7 = piVar7 + 7;
        lVar3 = lVar3 + -1;
      } while (lVar3 != 0);
    }
    goto LAB_180046390;
  }
  uVar2 = 0xffffffff;
  uVar8 = 0xffffffff;
  pCVar6 = lpBuffer;
  if (lpBuffer < pCVar1) {
    do {
      if ((param_9 <= *(uint *)(pCVar6 + 0x18)) &&
         (bVar10 = *(uint *)(pCVar6 + 0x18) < uVar8, uVar8 = uVar2, bVar10)) {
        uVar8 = *(uint *)(pCVar6 + 0x18);
        uVar2 = uVar8;
      }
      pCVar6 = pCVar6 + 0x1c;
    } while (pCVar6 < pCVar1);
    uVar2 = uVar8;
    if (uVar8 == 0xffffffff) goto LAB_1800462e2;
  }
  else {
LAB_1800462e2:
    uVar2 = _llseek(param_1,0,2);
  }
  *param_10 = uVar2;
  if (lpBuffer < pCVar1) {
    puVar9 = (uint *)(lpBuffer + 0x18);
    uVar5 = (lVar3 - 1U) / 7;
    lVar3 = (((lVar3 - 1U) - uVar5 >> 1) + uVar5 >> 4) + 1;
    do {
      if (param_9 <= *puVar9) {
        *puVar9 = (*puVar9 - uVar8) + local_48;
      }
      puVar9 = puVar9 + 7;
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
  }
LAB_180046390:
  _llseek(param_2,iVar4 + *(int *)(param_6 + 0x14),0);
  _hwrite(param_2,lpBuffer,*(long *)(param_8 + 0xbc));
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpBuffer);
  return 0;
}



undefined4
FUN_180046400(HFILE param_1,HFILE param_2,longlong param_3,longlong param_4,longlong param_5,
             longlong param_6,longlong param_7,longlong param_8,uint param_9,uint *param_10)

{
  LPCCH pCVar1;
  uint uVar2;
  LPCCH lpBuffer;
  longlong lVar3;
  int iVar4;
  ulonglong uVar5;
  LPCCH pCVar6;
  int *piVar7;
  uint uVar8;
  uint *puVar9;
  longlong in_GS_OFFSET;
  bool bVar10;
  uint local_48;
  
  local_48 = 0;
  if (param_5 == 0) {
    return 0;
  }
  if (*(int *)(param_8 + 0xac) == 0) {
    return 0;
  }
  KernelBaseGetGlobalData();
  lpBuffer = (LPCCH)RtlAllocateHeap();
  if (lpBuffer == (LPCCH)0x0) {
    return 8;
  }
  if (param_3 == 0) {
    local_48 = *param_10;
  }
  iVar4 = *(int *)(param_7 + 0xa8) - *(int *)(param_5 + 0xc);
  _llseek(param_1,*(int *)(param_5 + 0x14) + iVar4,0);
  uVar8 = *(uint *)(param_8 + 0xac);
  uVar5 = (ulonglong)uVar8 / 7;
  lVar3 = ((uVar8 - uVar5 >> 1) + uVar5 >> 4) * 0x1c;
  pCVar1 = lpBuffer + lVar3;
  _hread(param_1,lpBuffer,uVar8);
  if (param_3 != 0) {
    if (lpBuffer < pCVar1) {
      piVar7 = (int *)(lpBuffer + 0x18);
      uVar5 = (lVar3 - 1U) / 7;
      lVar3 = (((lVar3 - 1U) - uVar5 >> 1) + uVar5 >> 4) + 1;
      do {
        piVar7[-1] = piVar7[-1] + (*(int *)(param_4 + 0xc) - *(int *)(param_3 + 0xc));
        *piVar7 = *piVar7 + (*(int *)(param_4 + 0x14) - *(int *)(param_3 + 0x14));
        piVar7 = piVar7 + 7;
        lVar3 = lVar3 + -1;
      } while (lVar3 != 0);
    }
    goto LAB_1800465fc;
  }
  uVar2 = 0xffffffff;
  uVar8 = 0xffffffff;
  pCVar6 = lpBuffer;
  if (lpBuffer < pCVar1) {
    do {
      if ((param_9 <= *(uint *)(pCVar6 + 0x18)) &&
         (bVar10 = *(uint *)(pCVar6 + 0x18) < uVar8, uVar8 = uVar2, bVar10)) {
        uVar8 = *(uint *)(pCVar6 + 0x18);
        uVar2 = uVar8;
      }
      pCVar6 = pCVar6 + 0x1c;
    } while (pCVar6 < pCVar1);
    uVar2 = uVar8;
    if (uVar8 == 0xffffffff) goto LAB_18004654e;
  }
  else {
LAB_18004654e:
    uVar2 = _llseek(param_1,0,2);
  }
  *param_10 = uVar2;
  if (lpBuffer < pCVar1) {
    puVar9 = (uint *)(lpBuffer + 0x18);
    uVar5 = (lVar3 - 1U) / 7;
    lVar3 = (((lVar3 - 1U) - uVar5 >> 1) + uVar5 >> 4) + 1;
    do {
      if (param_9 <= *puVar9) {
        *puVar9 = (*puVar9 - uVar8) + local_48;
      }
      puVar9 = puVar9 + 7;
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
  }
LAB_1800465fc:
  _llseek(param_2,iVar4 + *(int *)(param_6 + 0x14),0);
  _hwrite(param_2,lpBuffer,*(long *)(param_8 + 0xac));
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpBuffer);
  return 0;
}



void FUN_18004666c(HFILE param_1,HFILE param_2,longlong param_3,int param_4,longlong param_5,
                  int param_6)

{
  uint uVar1;
  ulonglong uVar2;
  int lOffset;
  int iVar3;
  uint uVar4;
  undefined auStack200 [32];
  int local_a8;
  int local_a4;
  longlong local_a0;
  CHAR local_98 [12];
  int local_8c;
  uint local_88;
  CHAR local_80 [12];
  int local_74;
  int local_64;
  int local_60;
  int local_5c;
  ulonglong local_58;
  
  local_58 = DAT_1800b2220 ^ (ulonglong)auStack200;
  iVar3 = *(int *)(param_5 + 0x54) - param_6;
  local_a4 = param_4;
  local_a0 = param_3;
  if (iVar3 != 0) {
    uVar4 = *(uint *)(param_5 + 0x88);
    if ((uVar4 != 0) && (uVar4 < *(uint *)(param_5 + 0x54))) {
      _llseek(param_1,uVar4 - iVar3,0);
      _hread(param_1,local_80,0x28);
      local_74 = local_74 + iVar3;
      local_64 = local_64 + iVar3;
      local_60 = local_60 + iVar3;
      local_5c = local_5c + iVar3;
      _llseek(param_2,uVar4,0);
      _hwrite(param_2,local_80,0x28);
    }
    uVar4 = *(uint *)(param_5 + 0x90);
    if ((uVar4 != 0) && (uVar4 < *(uint *)(param_5 + 0x54))) {
      while( true ) {
        _llseek(param_1,uVar4 - iVar3,0);
        _hread(param_1,local_98,0x14);
        if (local_88 == 0) break;
        local_8c = local_8c + iVar3;
        _llseek(param_2,uVar4,0);
        _hwrite(param_2,local_98,0x14);
        uVar2 = 0;
        while( true ) {
          if ((uint)*(ushort *)(param_5 + 6) <= (uint)uVar2) goto LAB_18004681b;
          uVar1 = *(uint *)(local_a0 + 0xc + uVar2 * 0x28);
          if ((uVar1 <= local_88) && (local_88 < *(int *)(local_a0 + 0x10 + uVar2 * 0x28) + uVar1))
          break;
          uVar2 = (ulonglong)((uint)uVar2 + 1);
        }
        lOffset = (*(int *)(local_a0 + 0x14 + uVar2 * 0x28) - uVar1) + local_88;
        _llseek(param_1,lOffset - local_a4,0);
        _llseek(param_2,lOffset,0);
        while (_hread(param_1,&local_a8,4), local_a8 != 0) {
          local_a8 = local_a8 + iVar3;
          _hwrite(param_2,(LPCCH)&local_a8,4);
        }
        uVar4 = uVar4 + 0x14;
      }
    }
  }
LAB_18004681b:
  __security_check_cookie(local_58 ^ (ulonglong)auStack200);
  return;
}



void FUN_180046844(HFILE param_1,HFILE param_2,longlong param_3,int param_4,longlong param_5,
                  int param_6)

{
  uint uVar1;
  ulonglong uVar2;
  int lOffset;
  int iVar3;
  uint uVar4;
  undefined auStack200 [32];
  int local_a8;
  int local_a4;
  longlong local_a0;
  CHAR local_98 [12];
  int local_8c;
  uint local_88;
  CHAR local_80 [12];
  int local_74;
  int local_64;
  int local_60;
  int local_5c;
  ulonglong local_58;
  
  local_58 = DAT_1800b2220 ^ (ulonglong)auStack200;
  iVar3 = *(int *)(param_5 + 0x54) - param_6;
  local_a4 = param_4;
  local_a0 = param_3;
  if (iVar3 != 0) {
    uVar4 = *(uint *)(param_5 + 0x78);
    if ((uVar4 != 0) && (uVar4 < *(uint *)(param_5 + 0x54))) {
      _llseek(param_1,uVar4 - iVar3,0);
      _hread(param_1,local_80,0x28);
      local_74 = local_74 + iVar3;
      local_64 = local_64 + iVar3;
      local_60 = local_60 + iVar3;
      local_5c = local_5c + iVar3;
      _llseek(param_2,uVar4,0);
      _hwrite(param_2,local_80,0x28);
    }
    uVar4 = *(uint *)(param_5 + 0x80);
    if ((uVar4 != 0) && (uVar4 < *(uint *)(param_5 + 0x54))) {
      while( true ) {
        _llseek(param_1,uVar4 - iVar3,0);
        _hread(param_1,local_98,0x14);
        if (local_88 == 0) break;
        local_8c = local_8c + iVar3;
        _llseek(param_2,uVar4,0);
        _hwrite(param_2,local_98,0x14);
        uVar2 = 0;
        while( true ) {
          if ((uint)*(ushort *)(param_5 + 6) <= (uint)uVar2) goto LAB_1800469f0;
          uVar1 = *(uint *)(local_a0 + 0xc + uVar2 * 0x28);
          if ((uVar1 <= local_88) && (local_88 < *(int *)(local_a0 + 0x10 + uVar2 * 0x28) + uVar1))
          break;
          uVar2 = (ulonglong)((uint)uVar2 + 1);
        }
        lOffset = (*(int *)(local_a0 + 0x14 + uVar2 * 0x28) - uVar1) + local_88;
        _llseek(param_1,lOffset - local_a4,0);
        _llseek(param_2,lOffset,0);
        while (_hread(param_1,&local_a8,4), local_a8 != 0) {
          local_a8 = local_a8 + iVar3;
          _hwrite(param_2,(LPCCH)&local_a8,4);
        }
        uVar4 = uVar4 + 0x14;
      }
    }
  }
LAB_1800469f0:
  __security_check_cookie(local_58 ^ (ulonglong)auStack200);
  return;
}



undefined8
FUN_180046a18(int *param_1,undefined (*param_2) [16],ushort param_3,longlong param_4,HGLOBAL param_5
             ,longlong param_6,undefined4 param_7)

{
  ushort *puVar1;
  ushort uVar2;
  ushort uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  int *piVar8;
  undefined (*pauVar9) [16];
  undefined (*pauVar10) [16];
  ushort *puVar11;
  undefined8 uVar12;
  undefined (*pauVar13) [16];
  ulonglong uVar14;
  wchar_t *_Str2;
  longlong lVar15;
  undefined (*pauVar16) [16];
  undefined (*pauVar17) [16];
  longlong lVar18;
  longlong in_GS_OFFSET;
  bool bVar19;
  bool bVar20;
  undefined8 in_stack_ffffffffffffff88;
  
  iVar7 = *param_1;
  iVar4 = *(int *)*param_2;
  lVar18 = 0x20;
  uVar5 = (uint)(iVar4 == 2);
  bVar20 = false;
  lVar15 = 0x18;
  if (iVar7 != 2) {
    lVar15 = lVar18;
  }
  pauVar10 = *(undefined (**) [16])*(undefined (*) [16])(lVar15 + param_4);
  pauVar13 = (undefined (*) [16])(lVar15 + param_4);
  while (pauVar9 = pauVar10, pauVar9 != (undefined (*) [16])0x0) {
    uVar14 = *(ulonglong *)(*pauVar9 + 8);
    if (iVar7 == 2) {
      uVar2 = *(ushort *)(param_1 + 2);
      bVar19 = *(ushort *)(uVar14 + 8) == uVar2;
      if (bVar19) {
        lVar15 = 0x18;
        if (iVar4 != 2) {
          lVar15 = lVar18;
        }
LAB_180046af6:
        pauVar10 = (undefined (*) [16])(*pauVar9 + lVar15);
        if (pauVar10 != (undefined (*) [16])0x0) goto LAB_180046c5f;
        break;
      }
      if (uVar2 <= *(ushort *)(uVar14 + 8) && !bVar19) break;
    }
    else {
      puVar11 = *(ushort **)(param_1 + 6);
      lVar15 = *(longlong *)(uVar14 + 0x18) - (longlong)puVar11;
      do {
        uVar2 = *puVar11;
        uVar14 = (ulonglong)uVar2;
        puVar1 = (ushort *)((longlong)puVar11 + lVar15);
        if (uVar2 != *puVar1) {
          uVar6 = -(uint)(uVar2 < *puVar1) | 1;
          goto LAB_180046acb;
        }
        puVar11 = puVar11 + 1;
      } while (uVar2 != 0);
      uVar6 = 0;
LAB_180046acb:
      if (uVar6 == 0) {
        lVar15 = lVar18;
        if (iVar4 == 2) {
          lVar15 = 0x18;
        }
        goto LAB_180046af6;
      }
      if ((int)uVar6 < 0) break;
    }
    pauVar13 = pauVar9;
    pauVar10 = *(undefined (**) [16])*pauVar9;
  }
  piVar8 = (int *)KernelBaseGetGlobalData();
  uVar14 = *(ulonglong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30);
  pauVar9 = (undefined (*) [16])RtlAllocateHeap(uVar14,*piVar8 + 0x1c0000U | 8);
  if (pauVar9 != (undefined (*) [16])0x0) {
    bVar20 = true;
    *pauVar9 = ZEXT816(0);
    pauVar9[1] = ZEXT816(0);
    pauVar9[2] = ZEXT816(0);
    if (iVar7 == 2) {
      piVar8 = (int *)KernelBaseGetGlobalData();
      pauVar10 = (undefined (*) [16])
                 RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                 *piVar8 + 0x1c0000U | 8);
      *(undefined (**) [16])(*pauVar9 + 8) = pauVar10;
      if (pauVar10 == (undefined (*) [16])0x0) {
        if (*param_1 == 2) {
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_1);
        }
        if (*(int *)*param_2 == 2) {
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_2);
        }
        goto LAB_180046bf2;
      }
      *pauVar10 = ZEXT816(0);
      pauVar10[1] = ZEXT816(0);
      **(undefined4 **)(*pauVar9 + 8) = 2;
      uVar14 = *(ulonglong *)(*pauVar9 + 8);
      *(undefined2 *)(uVar14 + 8) = *(undefined2 *)(param_1 + 2);
    }
    else {
      *(int **)(*pauVar9 + 8) = param_1;
    }
    pauVar10 = (undefined (*) [16])(pauVar9[1] + 8);
    *(undefined8 *)*pauVar9 = *(undefined8 *)*pauVar13;
    *(undefined (**) [16])*pauVar13 = pauVar9;
    if (iVar4 != 2) {
      pauVar10 = pauVar9[2];
    }
LAB_180046c5f:
    for (pauVar13 = *(undefined (**) [16])*pauVar10; pauVar13 != (undefined (*) [16])0x0;
        pauVar13 = *(undefined (**) [16])*pauVar13) {
      if (uVar5 == 0) {
        puVar11 = *(ushort **)(param_2[1] + 8);
        lVar15 = *(longlong *)(*(longlong *)(*pauVar13 + 8) + 0x18) - (longlong)puVar11;
        do {
          uVar2 = *puVar11;
          uVar14 = (ulonglong)uVar2;
          puVar1 = (ushort *)((longlong)puVar11 + lVar15);
          if (uVar2 != *puVar1) {
            uVar6 = -(uint)(uVar2 < *puVar1) | 1;
            goto LAB_180046d0c;
          }
          puVar11 = puVar11 + 1;
        } while (uVar2 != 0);
        uVar6 = 0;
LAB_180046d0c:
        if (uVar6 == 0) goto LAB_180046d2a;
        if ((int)uVar6 < 0) break;
      }
      else {
        uVar2 = *(ushort *)(*(longlong *)(*pauVar13 + 8) + 8);
        if (*(ushort *)(*param_2 + 8) == uVar2) {
LAB_180046d2a:
          if (*(short *)(pauVar13[3] + 2) != 1) {
            pauVar16 = *(undefined (**) [16])*pauVar10;
            if (*(undefined (**) [16])*pauVar10 == (undefined (*) [16])0x0) goto LAB_180046df6;
            goto LAB_180046e42;
          }
          if (param_3 != *(ushort *)(pauVar13[3] + 4)) goto LAB_180046df6;
          *(undefined4 *)(pauVar13[2] + 4) = param_7;
          if (*param_1 == 2) {
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_1);
          }
          if (*(int *)*param_2 == 2) {
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_2);
          }
          if (param_6 != 0) {
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                        *(undefined8 *)(pauVar13[2] + 8));
            *(longlong *)(pauVar13[2] + 8) = param_6;
            return 0;
          }
          goto LAB_180046da1;
        }
        if (*(ushort *)(*param_2 + 8) < uVar2) break;
      }
      pauVar10 = pauVar13;
    }
    if (param_6 == 0) goto LAB_180046c96;
    if (iVar4 == 2) {
      *(int *)(pauVar9[2] + 8) = *(int *)(pauVar9[2] + 8) + 1;
    }
    else {
      *(int *)(pauVar9[2] + 0xc) = *(int *)(pauVar9[2] + 0xc) + 1;
    }
    piVar8 = (int *)KernelBaseGetGlobalData();
    pauVar13 = (undefined (*) [16])
               RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                               *piVar8 + 0x1c0000U | 8);
    if (pauVar13 != (undefined (*) [16])0x0) {
      *pauVar13 = ZEXT816(0);
      pauVar13[1] = ZEXT816(0);
      pauVar13[2] = ZEXT816(0);
      *(undefined8 *)pauVar13[3] = 0;
      *(undefined8 *)*pauVar13 = *(undefined8 *)*pauVar10;
      *(undefined (**) [16])*pauVar10 = pauVar13;
      *(undefined (**) [16])(*pauVar13 + 8) = param_2;
      *(int **)(pauVar13[1] + 8) = param_1;
      *(undefined2 *)(pauVar13[3] + 2) = 1;
      *(ushort *)(pauVar13[3] + 4) = param_3;
      *(undefined4 *)(pauVar13[2] + 4) = param_7;
      *(longlong *)(pauVar13[2] + 8) = param_6;
      if ((bVar20) && (param_5 != (HGLOBAL)0x0)) {
        if (iVar7 == 2) {
          _Str2 = (wchar_t *)(ulonglong)*(ushort *)(param_1 + 2);
        }
        else {
          _Str2 = *(wchar_t **)(param_1 + 6);
          iVar7 = wcscmp(L"MUI",_Str2);
          if (iVar7 == 0) {
            return 0;
          }
        }
        FUN_18004826c(param_5,_Str2,1);
      }
      return 0;
    }
  }
  if (*param_1 == 2) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_1);
  }
  pauVar9 = param_2;
  if (*(int *)*param_2 != 2) {
    return 8;
  }
LAB_180046bf2:
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pauVar9);
  return 8;
LAB_180046e42:
  uVar14 = *(ulonglong *)(*(longlong *)*pauVar10 + 8);
  pauVar17 = pauVar16;
  if (uVar5 == 0) {
    puVar11 = *(ushort **)(*(longlong *)(*pauVar16 + 8) + 0x18);
    lVar15 = *(longlong *)(uVar14 + 0x18) - (longlong)puVar11;
    do {
      uVar2 = *puVar11;
      uVar3 = *(ushort *)((longlong)puVar11 + lVar15);
      uVar14 = (ulonglong)uVar3;
      if (uVar2 != uVar3) break;
      puVar11 = puVar11 + 1;
    } while (uVar3 != 0);
    if (uVar2 != uVar3) {
      bVar20 = false;
      goto LAB_180046e8e;
    }
  }
  else {
    bVar20 = *(short *)(*(longlong *)(*pauVar16 + 8) + 8) == *(short *)(uVar14 + 8);
LAB_180046e8e:
    if (!bVar20) goto LAB_180046ea5;
  }
  if ((param_3 < *(ushort *)(pauVar16[3] + 4) || param_3 == *(ushort *)(pauVar16[3] + 4)) ||
     (pauVar17 = *(undefined (**) [16])*pauVar16, pauVar10 = pauVar16, pauVar16 = pauVar17,
     pauVar17 == (undefined (*) [16])0x0)) goto LAB_180046ea5;
  goto LAB_180046e42;
LAB_180046ea5:
  if ((pauVar17 != (undefined (*) [16])0x0) && (param_3 == *(ushort *)(pauVar17[3] + 4))) {
    if (*param_1 == 2) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_1);
    }
    if (*(int *)*param_2 == 2) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_2);
    }
    pauVar13 = pauVar17;
    if (param_6 != 0) {
      *(undefined4 *)(pauVar17[2] + 4) = param_7;
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                  *(undefined8 *)(pauVar17[2] + 8));
      *(longlong *)(pauVar17[2] + 8) = param_6;
      return 0;
    }
LAB_180046da1:
    uVar12 = FUN_1800472bc(param_4,param_5,(undefined8 *)pauVar9,(longlong **)pauVar13,
                           in_stack_ffffffffffffff88,(uint)(iVar7 == 2),uVar5);
    return uVar12;
  }
LAB_180046df6:
  if (param_6 != 0) {
    uVar12 = FUN_1800479fc(uVar14,param_1,(int *)param_2,(longlong)pauVar9,pauVar13,(uint)param_3,
                           uVar5,param_7,param_6);
    return uVar12;
  }
LAB_180046c96:
  if (*param_1 == 2) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_1);
  }
  if (*(int *)*param_2 == 2) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_2);
  }
  return 0x57;
}



undefined (*) [16] FUN_180047078(wchar_t *param_1,int *param_2)

{
  short *psVar1;
  int iVar2;
  int *piVar3;
  undefined (*pauVar4) [16];
  short sVar5;
  longlong lVar6;
  longlong lVar7;
  size_t _MaxCount;
  undefined (**ppauVar9) [16];
  longlong in_GS_OFFSET;
  longlong lVar8;
  
  if (param_1 < (wchar_t *)0x10000) {
    piVar3 = (int *)KernelBaseGetGlobalData();
    pauVar4 = (undefined (*) [16])
              RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                              *piVar3 + 0x1c0000U | 8,0x20);
    if (pauVar4 != (undefined (*) [16])0x0) {
      *pauVar4 = ZEXT816(0);
      pauVar4[1] = ZEXT816(0);
      *(undefined4 *)*pauVar4 = 2;
      *(short *)(*pauVar4 + 8) = (short)param_1;
      return pauVar4;
    }
  }
  else {
    lVar6 = 0;
    lVar7 = -1;
    do {
      lVar8 = lVar7;
      lVar7 = lVar8 + 1;
    } while (param_1[lVar7] != L'\0');
    ppauVar9 = (undefined (**) [16])(param_2 + 2);
    pauVar4 = *ppauVar9;
    _MaxCount = lVar8 + 2;
    if (pauVar4 != (undefined (*) [16])0x0) {
      do {
        iVar2 = wcsncmp(*(wchar_t **)(pauVar4[1] + 8),param_1,_MaxCount);
        if (iVar2 == 0) break;
        ppauVar9 = (undefined (**) [16])(*pauVar4 + 8);
        pauVar4 = *ppauVar9;
      } while (pauVar4 != (undefined (*) [16])0x0);
      if (pauVar4 != (undefined (*) [16])0x0) {
        return pauVar4;
      }
    }
    piVar3 = (int *)KernelBaseGetGlobalData();
    pauVar4 = (undefined (*) [16])
              RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                              *piVar3 + 0x1c0000U | 8,0x20);
    if (pauVar4 != (undefined (*) [16])0x0) {
      *pauVar4 = ZEXT816(0);
      pauVar4[1] = ZEXT816(0);
      piVar3 = (int *)KernelBaseGetGlobalData();
      lVar7 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                              *piVar3 + 0x1c0000U | 8,_MaxCount * 2);
      *(longlong *)(pauVar4[1] + 8) = lVar7;
      if (lVar7 != 0) {
        *(undefined4 *)*pauVar4 = 1;
        *(int *)pauVar4[1] = *param_2;
        *(short *)(pauVar4[1] + 4) = ((short)_MaxCount + 1) * 2;
        *(short *)(pauVar4[1] + 6) = (short)_MaxCount + -1;
        do {
          sVar5 = *(short *)(lVar6 + (longlong)param_1);
          if ((ushort)(sVar5 - 0x61U) < 0x1a) {
            sVar5 = sVar5 + -0x20;
          }
          *(short *)(*(longlong *)(pauVar4[1] + 8) + lVar6) = sVar5;
          psVar1 = (short *)(lVar6 + (longlong)param_1);
          lVar6 = lVar6 + 2;
        } while (*psVar1 != 0);
        *param_2 = *param_2 + (uint)*(ushort *)(pauVar4[1] + 4);
        *(undefined8 *)(*pauVar4 + 8) = 0;
        *ppauVar9 = pauVar4;
        return pauVar4;
      }
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pauVar4);
    }
  }
  return (undefined (*) [16])0x0;
}



int FUN_18004727c(longlong *param_1,uint param_2,uint param_3,uint param_4,uint *param_5)

{
  longlong *plVar1;
  uint uVar2;
  
  plVar1 = (longlong *)*param_1;
  uVar2 = *(int *)((longlong)plVar1 + 0x24) + 3U & 0xfffffffc;
  if ((param_3 < param_2) && (param_4 < uVar2 + param_3)) {
    *param_5 = param_3;
    param_3 = param_2;
  }
  *(uint *)(plVar1 + 2) = param_3;
  *param_1 = *plVar1;
  return uVar2 + param_3;
}



undefined8
FUN_1800472bc(longlong param_1,HGLOBAL param_2,undefined8 *param_3,longlong **param_4,
             undefined8 param_5,int param_6,int param_7)

{
  short sVar1;
  short sVar2;
  longlong *plVar3;
  undefined8 *puVar4;
  longlong *plVar5;
  short *psVar6;
  undefined8 *puVar7;
  longlong **pplVar8;
  longlong *plVar9;
  longlong lVar10;
  longlong in_GS_OFFSET;
  
  puVar7 = (undefined8 *)((-(ulonglong)(param_6 != 0) & 0xfffffffffffffff8) + param_1 + 0x20);
  for (puVar4 = (undefined8 *)*puVar7; puVar4 != param_3; puVar4 = (undefined8 *)*puVar4) {
    puVar7 = puVar4;
  }
  pplVar8 = (longlong **)
            ((-(ulonglong)(param_7 != 0) & 0xfffffffffffffff8) + 0x20 + (longlong)param_3);
  plVar9 = (longlong *)0x0;
  if ((longlong **)*pplVar8 != param_4) {
    do {
      plVar5 = plVar9;
      if (param_7 == 0) {
        plVar3 = *pplVar8;
        psVar6 = *(short **)(plVar3[1] + 0x18);
        lVar10 = param_4[1][3] - (longlong)psVar6;
        do {
          sVar1 = *psVar6;
          sVar2 = *(short *)((longlong)psVar6 + lVar10);
          if (sVar1 != sVar2) break;
          psVar6 = psVar6 + 1;
        } while (sVar2 != 0);
        if (sVar1 == sVar2) {
          plVar5 = plVar3;
          if (plVar9 != (longlong *)0x0) {
            plVar5 = plVar9;
          }
          if (1 < *(ushort *)((longlong)plVar3 + 0x32)) {
            *(ushort *)((longlong)plVar3 + 0x32) = *(ushort *)((longlong)plVar3 + 0x32) - 1;
          }
        }
      }
      else {
        plVar3 = *pplVar8;
        if (*(short *)(plVar3[1] + 8) == *(short *)(param_4[1] + 1)) {
          plVar5 = plVar3;
          if (plVar9 != (longlong *)0x0) {
            plVar5 = plVar9;
          }
          if (1 < *(ushort *)((longlong)plVar3 + 0x32)) {
            *(ushort *)((longlong)plVar3 + 0x32) = *(ushort *)((longlong)plVar3 + 0x32) - 1;
          }
        }
      }
      pplVar8 = (longlong **)*pplVar8;
      plVar9 = plVar5;
    } while ((longlong **)*pplVar8 != param_4);
    if (plVar5 != (longlong *)0x0) {
      sVar1 = *(short *)((longlong)plVar5 + 0x32);
      goto LAB_1800473d7;
    }
  }
  psVar6 = (short *)((longlong)param_4 + 0x32);
  *psVar6 = *psVar6 + -1;
  sVar1 = *psVar6;
LAB_1800473d7:
  if (sVar1 == 0) {
    if (param_7 == 0) {
      *(int *)((longlong)param_3 + 0x2c) = *(int *)((longlong)param_3 + 0x2c) + -1;
    }
    else {
      *(int *)(param_3 + 5) = *(int *)(param_3 + 5) + -1;
    }
  }
  *pplVar8 = *param_4;
  FUN_1800478d8((longlong)param_4);
  if ((param_3[3] == 0) && (param_3[4] == 0)) {
    *puVar7 = *param_3;
    if (param_6 == 0) {
      psVar6 = *(short **)(param_3[1] + 0x18);
    }
    else {
      psVar6 = (short *)(ulonglong)*(ushort *)(param_3[1] + 8);
    }
    FUN_18004826c(param_2,psVar6,0);
    if (*(int *)param_3[1] == 2) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_3);
  }
  return 0;
}



// WARNING: Removing unreachable block (ram,0x00018004751a)
// WARNING: Removing unreachable block (ram,0x000180047536)
// WARNING: Removing unreachable block (ram,0x0001800475bd)
// WARNING: Removing unreachable block (ram,0x0001800475dc)
// WARNING: Removing unreachable block (ram,0x00018004761b)
// WARNING: Removing unreachable block (ram,0x000180047667)
// WARNING: Removing unreachable block (ram,0x000180047644)
// WARNING: Removing unreachable block (ram,0x00018004767b)
// WARNING: Removing unreachable block (ram,0x0001800476cd)
// WARNING: Removing unreachable block (ram,0x0001800476be)
// WARNING: Removing unreachable block (ram,0x000180047549)
// WARNING: Removing unreachable block (ram,0x000180047550)
// WARNING: Removing unreachable block (ram,0x000180047556)
// WARNING: Removing unreachable block (ram,0x000180047574)
// WARNING: Removing unreachable block (ram,0x000180047579)
// WARNING: Removing unreachable block (ram,0x00018004757e)
// WARNING: Removing unreachable block (ram,0x000180047581)
// WARNING: Removing unreachable block (ram,0x00018004752d)

void FUN_180047490(HMODULE param_1,wchar_t *param_2,wchar_t *param_3,ushort param_4,int *param_5)

{
  int iVar1;
  ulonglong uVar2;
  undefined auStackY184 [32];
  
  uVar2 = DAT_1800b2220 ^ (ulonglong)auStackY184;
  iVar1 = LdrFindResourceEx_U(0x10,param_1);
  if (iVar1 < 0) {
    BaseSetLastNTError();
  }
  __security_check_cookie(uVar2 ^ (ulonglong)auStackY184);
  return;
}



undefined8 FUN_1800476e0(HMODULE param_1,LPCWSTR param_2,LPCWSTR param_3,LONG_PTR param_4)

{
  EnumResourceLanguagesExW(param_1,param_2,param_3,FUN_180047490,param_4,0x10,0);
  return 1;
}



undefined8 FUN_180047720(HMODULE param_1,LPCWSTR param_2,LONG_PTR param_3)

{
  EnumResourceNamesExW(param_1,param_2,FUN_1800476e0,param_3,0x10,0);
  return 1;
}



char * FUN_18004775c(char *param_1,char *param_2,longlong param_3)

{
  char cVar1;
  char cVar2;
  char *pcVar3;
  
  if (param_1 < param_2) {
    do {
      pcVar3 = param_1;
      do {
        cVar1 = *pcVar3;
        cVar2 = pcVar3[param_3 - (longlong)param_1];
        if (cVar1 != cVar2) break;
        pcVar3 = pcVar3 + 1;
      } while (cVar2 != '\0');
      if (cVar1 == cVar2) {
        return param_1;
      }
      param_1 = param_1 + 0x28;
    } while (param_1 < param_2);
  }
  return (char *)0x0;
}



void FUN_1800477a4(longlong param_1)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  longlong in_GS_OFFSET;
  
  puVar1 = *(undefined8 **)(param_1 + 0x18);
  while (puVar1 != (undefined8 *)0x0) {
    *(undefined8 *)(param_1 + 0x18) = *puVar1;
    while (puVar2 = (undefined8 *)puVar1[3], puVar2 != (undefined8 *)0x0) {
      puVar1[3] = *puVar2;
      FUN_1800478d8((longlong)puVar2);
    }
    while (puVar2 = (undefined8 *)puVar1[4], puVar2 != (undefined8 *)0x0) {
      puVar1[4] = *puVar2;
      FUN_1800478d8((longlong)puVar2);
    }
    if (*(int *)puVar1[1] == 2) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar1);
    puVar1 = *(undefined8 **)(param_1 + 0x18);
  }
  puVar1 = *(undefined8 **)(param_1 + 0x20);
  while (puVar1 != (undefined8 *)0x0) {
    *(undefined8 *)(param_1 + 0x20) = *puVar1;
    while (puVar2 = (undefined8 *)puVar1[3], puVar2 != (undefined8 *)0x0) {
      puVar1[3] = *puVar2;
      FUN_1800478d8((longlong)puVar2);
    }
    while (puVar2 = (undefined8 *)puVar1[4], puVar2 != (undefined8 *)0x0) {
      puVar1[4] = *puVar2;
      FUN_1800478d8((longlong)puVar2);
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar1);
    puVar1 = *(undefined8 **)(param_1 + 0x20);
  }
  FUN_180047984(param_1);
  return;
}



void FUN_1800478d8(longlong param_1)

{
  longlong in_GS_OFFSET;
  
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
              *(undefined8 *)(param_1 + 0x28));
  *(undefined8 *)(param_1 + 0x28) = 0;
  if (**(int **)(param_1 + 8) == 2) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
    *(undefined8 *)(param_1 + 8) = 0;
  }
  if (**(int **)(param_1 + 0x18) == 2) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
    *(undefined8 *)(param_1 + 0x18) = 0;
  }
                    // WARNING: Could not recover jumptable at 0x000180047970. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_1);
  return;
}



void FUN_180047984(longlong param_1)

{
  int *piVar1;
  int *piVar2;
  longlong in_GS_OFFSET;
  
  piVar2 = *(int **)(param_1 + 8);
  while (piVar2 != (int *)0x0) {
    piVar1 = *(int **)(piVar2 + 2);
    if (*piVar2 == 1) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                  *(undefined8 *)(piVar2 + 6));
      *(undefined8 *)(piVar2 + 6) = 0;
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,piVar2);
    piVar2 = piVar1;
  }
  return;
}



undefined8
FUN_1800479fc(undefined8 param_1,int *param_2,int *param_3,longlong param_4,
             undefined (*param_5) [16],int param_6,int param_7,undefined4 param_8,undefined8 param_9
             )

{
  short sVar1;
  short sVar2;
  undefined (*pauVar3) [16];
  int *piVar4;
  undefined (*pauVar5) [16];
  undefined8 uVar6;
  undefined (*pauVar7) [16];
  short *psVar8;
  undefined (*pauVar9) [16];
  longlong lVar10;
  longlong in_GS_OFFSET;
  bool bVar11;
  
  piVar4 = (int *)KernelBaseGetGlobalData();
  pauVar5 = (undefined (*) [16])
            RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                            *piVar4 + 0x1c0000U | 8);
  if (pauVar5 == (undefined (*) [16])0x0) {
    if (*param_2 == 2) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_2);
    }
    if (*param_3 == 2) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_3);
    }
    uVar6 = 8;
  }
  else {
    *pauVar5 = ZEXT816(0);
    pauVar5[1] = ZEXT816(0);
    pauVar5[2] = ZEXT816(0);
    *(undefined8 *)pauVar5[3] = 0;
    *(undefined4 *)(pauVar5[2] + 4) = param_8;
    *(int **)(pauVar5[1] + 8) = param_2;
    *(undefined8 *)(pauVar5[2] + 8) = param_9;
    *(int **)(*pauVar5 + 8) = param_3;
    *(short *)(pauVar5[3] + 4) = (short)param_6;
    *(undefined2 *)(pauVar5[3] + 2) = 1;
    pauVar3 = param_5;
    if (param_6 < (int)(uint)*(ushort *)(param_5[3] + 4)) {
      *(short *)(pauVar5[3] + 2) = *(short *)(param_5[3] + 2) + 1;
      pauVar9 = (undefined (*) [16])
                ((-(ulonglong)(param_7 != 0) & 0xfffffffffffffff8) + 0x20 + param_4);
      pauVar3 = *(undefined (**) [16])*pauVar9;
      while (pauVar7 = pauVar3, param_5 != pauVar7) {
        pauVar9 = pauVar7;
        pauVar3 = *(undefined (**) [16])*pauVar7;
      }
      *(undefined (**) [16])*pauVar5 = pauVar7;
      *(undefined (**) [16])*pauVar9 = pauVar5;
    }
    else {
      do {
        pauVar9 = pauVar3;
        if (param_7 == 0) {
          psVar8 = *(short **)(param_3 + 6);
          lVar10 = *(longlong *)(*(longlong *)(*pauVar9 + 8) + 0x18) - (longlong)psVar8;
          do {
            sVar1 = *psVar8;
            sVar2 = *(short *)((longlong)psVar8 + lVar10);
            if (sVar1 != sVar2) break;
            psVar8 = psVar8 + 1;
          } while (sVar2 != 0);
          if (sVar1 != sVar2) {
            bVar11 = false;
            goto LAB_180047b75;
          }
        }
        else {
          bVar11 = *(short *)(param_3 + 2) == *(short *)(*(longlong *)(*pauVar9 + 8) + 8);
LAB_180047b75:
          if (!bVar11) break;
        }
        if (param_6 <= (int)(uint)*(ushort *)(pauVar9[3] + 4)) break;
        *(short *)(pauVar9[3] + 2) = *(short *)(pauVar9[3] + 2) + 1;
        pauVar3 = *(undefined (**) [16])*pauVar9;
        param_5 = pauVar9;
      } while (*(undefined (**) [16])*pauVar9 != (undefined (*) [16])0x0);
      uVar6 = *(undefined8 *)*param_5;
      *(undefined (**) [16])*param_5 = pauVar5;
      *(undefined8 *)*pauVar5 = uVar6;
    }
    uVar6 = 0;
  }
  return uVar6;
}



undefined8
FUN_180047bc0(undefined4 *param_1,uint param_2,undefined4 *param_3,void *param_4,int param_5,
             int param_6)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined8 uVar4;
  uint uVar5;
  uint uVar6;
  uint local_res8 [2];
  
  if (param_1 == (undefined4 *)0x0) {
    return 0;
  }
  if (param_3 == (undefined4 *)0x0) {
    return 0;
  }
  if (0x83 < param_2) {
    uVar1 = param_3[1];
    uVar2 = param_3[2];
    uVar3 = param_3[3];
    *param_1 = *param_3;
    param_1[1] = uVar1;
    param_1[2] = uVar2;
    param_1[3] = uVar3;
    uVar1 = param_3[5];
    uVar2 = param_3[6];
    uVar3 = param_3[7];
    param_1[4] = param_3[4];
    param_1[5] = uVar1;
    param_1[6] = uVar2;
    param_1[7] = uVar3;
    uVar1 = param_3[9];
    uVar2 = param_3[10];
    uVar3 = param_3[0xb];
    param_1[8] = param_3[8];
    param_1[9] = uVar1;
    param_1[10] = uVar2;
    param_1[0xb] = uVar3;
    uVar1 = param_3[0xd];
    uVar2 = param_3[0xe];
    uVar3 = param_3[0xf];
    param_1[0xc] = param_3[0xc];
    param_1[0xd] = uVar1;
    param_1[0xe] = uVar2;
    param_1[0xf] = uVar3;
    uVar1 = param_3[0x11];
    uVar2 = param_3[0x12];
    uVar3 = param_3[0x13];
    param_1[0x10] = param_3[0x10];
    param_1[0x11] = uVar1;
    param_1[0x12] = uVar2;
    param_1[0x13] = uVar3;
    uVar1 = param_3[0x15];
    uVar2 = param_3[0x16];
    uVar3 = param_3[0x17];
    param_1[0x14] = param_3[0x14];
    param_1[0x15] = uVar1;
    param_1[0x16] = uVar2;
    param_1[0x17] = uVar3;
    uVar1 = param_3[0x19];
    uVar2 = param_3[0x1a];
    uVar3 = param_3[0x1b];
    param_1[0x18] = param_3[0x18];
    param_1[0x19] = uVar1;
    param_1[0x1a] = uVar2;
    param_1[0x1b] = uVar3;
    uVar1 = param_3[0x1d];
    uVar2 = param_3[0x1e];
    uVar3 = param_3[0x1f];
    param_1[0x1c] = param_3[0x1c];
    param_1[0x1d] = uVar1;
    param_1[0x1e] = uVar2;
    param_1[0x1f] = uVar3;
    param_1[0x20] = param_3[0x20];
    param_1[1] = param_2;
    local_res8[0] = 0x88;
    if (param_3[0x11] != 0) {
      param_1[0x11] = 0x88;
      memcpy(param_1 + 0x22,(void *)((ulonglong)(uint)param_3[0x11] + (longlong)param_3),
             (ulonglong)(uint)param_3[0x12]);
      local_res8[0] = (param_3[0x12] + 7 & 0xfffffff8) + 0x88;
    }
    uVar6 = local_res8[0];
    if (param_3[0x13] != 0) {
      param_1[0x13] = local_res8[0];
      memcpy((void *)((ulonglong)local_res8[0] + (longlong)param_1),
             (void *)((ulonglong)(uint)param_3[0x13] + (longlong)param_3),
             (ulonglong)(uint)param_3[0x14]);
      local_res8[0] = uVar6 + (param_3[0x14] + 7 & 0xfffffff8);
    }
    uVar5 = local_res8[0];
    uVar6 = param_1[1];
    if (local_res8[0] < uVar6) {
      if (param_5 == 0) {
        if (param_3[0x15] != 0) {
          param_1[0x15] = local_res8[0];
          memcpy((void *)((ulonglong)local_res8[0] + (longlong)param_1),
                 (void *)((ulonglong)(uint)param_3[0x15] + (longlong)param_3),
                 (ulonglong)(uint)param_3[0x16]);
          uVar6 = param_1[1];
          local_res8[0] = uVar5 + (param_3[0x16] + 7 & 0xfffffff8);
        }
        if (uVar6 <= local_res8[0]) goto LAB_180047d62;
        param_1[0x17] = local_res8[0];
        uVar4 = FUN_180048494((uint *)((ulonglong)local_res8[0] + (longlong)param_1),
                              (ulonglong)(uVar6 - local_res8[0]),
                              (uint *)((ulonglong)(uint)param_3[0x17] + (longlong)param_3),
                              param_3[0x18],(uint)param_4,param_6,(int *)local_res8);
        if ((int)uVar4 == 0) {
          return 0;
        }
        if ((uint)param_1[1] <= local_res8[0]) goto LAB_180047d62;
        param_1[0x18] = local_res8[0] - param_1[0x17];
        if (local_res8[0] - param_1[0x17] == 0) {
          param_1[0x17] = 0;
        }
        uVar6 = local_res8[0] + 3 & 0xfffffffc;
      }
      else {
        param_1[0x15] = local_res8[0];
        uVar4 = FUN_1800485b8((undefined2 *)((ulonglong)local_res8[0] + (longlong)param_1),
                              uVar6 - local_res8[0],
                              (ushort *)((ulonglong)(uint)param_3[0x15] + (longlong)param_3),
                              param_3[0x16],param_4,param_6,(int *)local_res8);
        if ((int)uVar4 == 0) {
          return 0;
        }
        uVar5 = param_1[1];
        if (uVar5 <= local_res8[0]) goto LAB_180047d62;
        param_1[0x16] = local_res8[0] - param_1[0x15];
        if (local_res8[0] - param_1[0x15] == 0) {
          param_1[0x15] = 0;
        }
        uVar6 = local_res8[0] + 7 & 0xfffffff8;
        if (param_3[0x17] != 0) {
          param_1[0x17] = uVar6;
          memcpy((void *)((ulonglong)uVar6 + (longlong)param_1),
                 (void *)((ulonglong)(uint)param_3[0x17] + (longlong)param_3),
                 (ulonglong)(uint)param_3[0x18]);
          uVar5 = param_1[1];
          uVar6 = (param_3[0x18] + 7 & 0xfffffff8) + uVar6;
        }
        if (uVar5 <= uVar6) goto LAB_180047d62;
      }
      if (param_3[0x19] != 0) {
        param_1[0x19] = uVar6;
        memcpy((void *)((ulonglong)uVar6 + (longlong)param_1),
               (void *)((ulonglong)(uint)param_3[0x19] + (longlong)param_3),
               (ulonglong)(uint)param_3[0x1a]);
        uVar6 = (param_3[0x1a] + 7 & 0xfffffff8) + uVar6;
      }
      if (param_3[0x1b] != 0) {
        param_1[0x1b] = uVar6;
        memcpy((void *)((ulonglong)uVar6 + (longlong)param_1),
               (void *)((ulonglong)(uint)param_3[0x1b] + (longlong)param_3),
               (ulonglong)(uint)param_3[0x1c]);
        uVar6 = (param_3[0x1c] + 7 & 0xfffffff8) + uVar6;
      }
      if (uVar6 < (uint)param_1[1]) {
        if (param_3[0x1d] != 0) {
          param_1[0x1d] = uVar6;
          memcpy((void *)((ulonglong)uVar6 + (longlong)param_1),
                 (void *)((ulonglong)(uint)param_3[0x1d] + (longlong)param_3),
                 (ulonglong)(uint)param_3[0x1e]);
          uVar6 = (param_3[0x1e] + 7 & 0xfffffff8) + uVar6;
        }
        if (param_3[0x1f] != 0) {
          param_1[0x1f] = uVar6;
          memcpy((void *)((ulonglong)uVar6 + (longlong)param_1),
                 (void *)((ulonglong)(uint)param_3[0x1f] + (longlong)param_3),
                 (ulonglong)(uint)param_3[0x20]);
          uVar6 = (param_3[0x20] + 7 & 0xfffffff8) + uVar6;
        }
        if (uVar6 < (uint)param_1[1]) {
          param_1[1] = uVar6;
          return 1;
        }
      }
    }
  }
LAB_180047d62:
  RtlSetLastWin32Error(0x6f);
  return 0;
}



undefined8 FUN_180047ef0(longlong param_1,wchar_t *param_2,short param_3)

{
  short sVar1;
  short sVar2;
  int iVar3;
  short *psVar4;
  uint uVar5;
  uint uVar6;
  longlong lVar7;
  int *piVar8;
  short *psVar9;
  undefined8 uVar10;
  undefined8 uVar11;
  longlong *plVar12;
  undefined8 uVar13;
  
  plVar12 = *(longlong **)(param_1 + 0x20);
  uVar13 = 0;
  uVar10 = 1;
  uVar11 = uVar10;
  if (plVar12 != (longlong *)0x0) {
    do {
      iVar3 = wcscmp(L"MUI",*(wchar_t **)(plVar12[1] + 0x18));
      if (iVar3 == 0) break;
      plVar12 = (longlong *)*plVar12;
    } while (plVar12 != (longlong *)0x0);
    if ((plVar12 != (longlong *)0x0) &&
       (plVar12 = (longlong *)plVar12[3], plVar12 != (longlong *)0x0)) {
      do {
        if (*(short *)(plVar12[1] + 8) == 1) break;
        plVar12 = (longlong *)*plVar12;
      } while (plVar12 != (longlong *)0x0);
      if (((plVar12 != (longlong *)0x0) &&
          (uVar11 = uVar13, *(short *)((longlong)plVar12 + 0x32) == 1)) &&
         ((param_3 == 0 || (param_3 == *(short *)((longlong)plVar12 + 0x34))))) {
        if (param_2 < (wchar_t *)0x10000) {
          if (param_2 == (wchar_t *)&DAT_00000010) {
            return 1;
          }
          if (param_2 == (wchar_t *)&DAT_00000018) {
            return 1;
          }
        }
        else {
          iVar3 = wcscmp(param_2,L"MUI");
          if (iVar3 == 0) {
            return 1;
          }
        }
        lVar7 = plVar12[5];
        if ((*(byte *)(lVar7 + 0x10) & 2) == 0) {
          if (param_2 < (wchar_t *)0x10000) {
            uVar11 = uVar10;
            if (*(int *)(lVar7 + 0x6c) != 0) {
              piVar8 = (int *)((ulonglong)*(uint *)(lVar7 + 0x6c) + lVar7);
              uVar5 = *(uint *)(lVar7 + 0x70) >> 2;
              if (*(uint *)(lVar7 + 0x70) >> 2 != 0) {
                do {
                  uVar5 = uVar5 - 1;
                  if (*piVar8 == (int)param_2) {
                    return 0;
                  }
                  piVar8 = piVar8 + 1;
                } while (0 < (int)uVar5);
              }
            }
          }
          else {
            uVar11 = uVar10;
            if (*(int *)(lVar7 + 100) != 0) {
              psVar9 = (short *)((ulonglong)*(uint *)(lVar7 + 100) + lVar7);
              uVar5 = *(uint *)(lVar7 + 0x68) >> 1;
              if (uVar5 != 0) {
                do {
                  if (*psVar9 == 0) {
                    return 1;
                  }
                  psVar4 = psVar9;
                  do {
                    sVar1 = *psVar4;
                    sVar2 = *(short *)((longlong)psVar4 + ((longlong)param_2 - (longlong)psVar9));
                    if (sVar1 != sVar2) break;
                    psVar4 = psVar4 + 1;
                  } while (sVar2 != 0);
                  if (sVar1 == sVar2) {
                    return 0;
                  }
                  lVar7 = -1;
                  do {
                    lVar7 = lVar7 + 1;
                  } while (psVar9[lVar7] != 0);
                  uVar6 = (int)lVar7 + 1;
                  if (uVar6 == 1) {
                    return 1;
                  }
                  uVar5 = uVar5 - uVar6;
                  psVar9 = psVar9 + uVar6;
                } while (0 < (int)uVar5);
              }
            }
          }
        }
      }
    }
  }
  return uVar11;
}



LPCCH FUN_18004808c(HFILE param_1,HFILE param_2,uint param_3)

{
  UINT UVar1;
  int *piVar2;
  LPCCH lpBuffer;
  UINT UVar3;
  UINT uBytes;
  uint uVar4;
  longlong in_GS_OFFSET;
  
  uVar4 = 0;
  piVar2 = (int *)KernelBaseGetGlobalData();
  lpBuffer = (LPCCH)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                    *piVar2 + 0x1c0000U | 8,0x1000);
  if (lpBuffer != (LPCCH)0x0) {
    memset(lpBuffer,0,0x1000);
    while (param_3 != 0) {
      uBytes = 0x1000;
      if (param_3 < 0x1001) {
        uBytes = param_3;
      }
      param_3 = param_3 - uBytes;
      UVar1 = _hread(param_1,lpBuffer,uBytes);
      UVar3 = 0;
      if (UVar1 != uBytes) {
        UVar3 = UVar1;
      }
      if (UVar3 != 0) break;
      uVar4 = uVar4 + uBytes;
      _hwrite(param_2,lpBuffer,uBytes);
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpBuffer);
    lpBuffer = (LPCCH)(ulonglong)uVar4;
  }
  return lpBuffer;
}



void FUN_180048184(HFILE param_1,HFILE param_2,LONG param_3,longlong param_4)

{
  undefined auStack360 [32];
  int *local_148;
  int local_138 [5];
  ushort local_122;
  short local_120;
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack360;
  _llseek(param_1,param_3,0);
  _hread(param_1,local_138,0xf8);
  if ((local_138[0] == 0x4550) && (((local_122 & 2) != 0 || ((local_122 & 0x2000) != 0)))) {
    if (local_120 == 0x20b) {
      local_148 = local_138;
      FUN_180043254(param_1,param_2,param_3,param_4);
    }
    else if (local_120 == 0x10b) {
      local_148 = local_138;
      FUN_1800449dc(param_1,param_2,param_3,param_4);
    }
  }
  __security_check_cookie(local_38 ^ (ulonglong)auStack360);
  return;
}



undefined8 FUN_18004826c(HGLOBAL param_1,short *param_2,int param_3)

{
  undefined4 *puVar1;
  undefined8 uVar2;
  int iVar3;
  LPVOID pvVar4;
  longlong lVar5;
  int *piVar6;
  undefined4 *puVar7;
  undefined8 uVar8;
  undefined4 uVar9;
  longlong lVar10;
  longlong *plVar11;
  uint uVar12;
  uint uVar13;
  longlong in_GS_OFFSET;
  
  pvVar4 = GlobalLock(param_1);
  if (pvVar4 == (LPVOID)0x0) {
    return 0;
  }
  plVar11 = *(longlong **)((longlong)pvVar4 + 0x20);
  if (plVar11 == (longlong *)0x0) {
    return 0;
  }
  do {
    iVar3 = wcscmp(L"MUI",*(wchar_t **)(plVar11[1] + 0x18));
    if (iVar3 == 0) break;
    plVar11 = (longlong *)*plVar11;
  } while (plVar11 != (longlong *)0x0);
  if (plVar11 == (longlong *)0x0) {
    return 0;
  }
  plVar11 = (longlong *)plVar11[3];
  if (plVar11 == (longlong *)0x0) {
    return 0;
  }
  do {
    if (*(short *)(plVar11[1] + 8) == 1) break;
    plVar11 = (longlong *)*plVar11;
  } while (plVar11 != (longlong *)0x0);
  if (plVar11 == (longlong *)0x0) {
    return 0;
  }
  if (*(short *)((longlong)plVar11 + 0x32) == 0) {
    return 0;
  }
  if (param_2 < (short *)0x10000) {
    iVar3 = 0;
  }
  else {
    iVar3 = 1;
    if (*param_2 == 0) {
      return 1;
    }
  }
  puVar1 = (undefined4 *)plVar11[5];
  uVar13 = puVar1[1];
  if (param_3 == 0) {
LAB_1800483b3:
    uVar12 = uVar13 + 0x46;
    if (uVar13 < uVar12) {
      piVar6 = (int *)KernelBaseGetGlobalData();
      puVar7 = (undefined4 *)
               RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                               *piVar6 + 0x1c0000U | 8,uVar12);
      if (puVar7 != (undefined4 *)0x0) {
        uVar8 = FUN_180047bc0(puVar7,uVar12,puVar1,param_2,iVar3,param_3);
        uVar2 = *(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30);
        if ((int)uVar8 == 0) {
          RtlFreeHeap(uVar2,0,puVar7);
          return 0;
        }
        RtlFreeHeap(uVar2,0,puVar1);
        plVar11[5] = (longlong)puVar7;
        *(undefined4 *)((longlong)plVar11 + 0x24) = puVar7[1];
        return 1;
      }
      uVar9 = 8;
      goto LAB_180048461;
    }
  }
  else if (iVar3 == 0) {
    uVar12 = uVar13 + 4;
    if ((uVar13 < uVar12) && (uVar13 = uVar13 + 8, uVar12 < uVar13)) goto LAB_1800483b3;
  }
  else {
    lVar5 = -1;
    do {
      lVar5 = lVar5 + 1;
    } while (param_2[lVar5] != 0);
    if (uVar13 < uVar13 + ((int)lVar5 + 1) * 2) {
      lVar5 = -1;
      do {
        lVar10 = lVar5;
        lVar5 = lVar10 + 1;
      } while (param_2[lVar5] != 0);
      uVar13 = uVar13 + ((int)lVar10 + 2) * 2;
      lVar5 = -1;
      do {
        lVar5 = lVar5 + 1;
      } while (param_2[lVar5] != 0);
      lVar10 = -1;
      if (uVar13 < uVar13 + ((int)lVar5 + 1) * 2) {
        do {
          lVar5 = lVar10;
          lVar10 = lVar5 + 1;
        } while (param_2[lVar10] != 0);
        uVar13 = uVar13 + ((int)lVar5 + 2) * 2;
        goto LAB_1800483b3;
      }
    }
  }
  uVar9 = 0x6f;
LAB_180048461:
  RtlSetLastWin32Error(uVar9);
  return 0;
}



undefined8
FUN_180048494(uint *param_1,ulonglong param_2,uint *param_3,uint param_4,uint param_5,int param_6,
             int *param_7)

{
  bool bVar1;
  undefined8 uVar2;
  int iVar3;
  ulonglong uVar4;
  uint uVar5;
  ulonglong uVar6;
  
  uVar4 = param_2 & 0xffffffff;
  bVar1 = false;
  if (((param_1 == (uint *)0x0) || (param_3 == (uint *)0x0)) || (param_7 == (int *)0x0)) {
    uVar2 = 0x57;
  }
  else {
    if ((param_6 == 0) || (param_4 <= (uint)uVar4)) {
      iVar3 = *param_7;
      uVar6 = (ulonglong)(longlong)(int)param_4 >> 2;
      if (param_6 == 0) {
        while (0 < (int)uVar6) {
          uVar6 = (ulonglong)((int)uVar6 - 1);
          if (*param_3 != param_5) {
            if (uVar4 < (ulonglong)(uint)(iVar3 - *param_7) + 4) goto LAB_18004858a;
            *param_1 = *param_3;
            param_1 = param_1 + 1;
            iVar3 = iVar3 + 4;
          }
          param_3 = param_3 + 1;
        }
LAB_180048552:
        *param_7 = iVar3;
        return 1;
      }
      if ((ulonglong)param_4 + 4 <= uVar4) {
        if (0 < (int)uVar6) {
          do {
            uVar5 = (int)uVar6 - 1;
            uVar6 = (ulonglong)uVar5;
            if ((!bVar1) && (param_5 <= *param_3)) {
              if (*param_3 == param_5) {
                return 0;
              }
              *param_1 = param_5;
              bVar1 = true;
              param_1 = param_1 + 1;
              iVar3 = iVar3 + 4;
            }
            iVar3 = iVar3 + 4;
            *param_1 = *param_3;
            param_3 = param_3 + 1;
            param_1 = param_1 + 1;
          } while (0 < (int)uVar5);
          if (bVar1) goto LAB_180048552;
        }
        if ((ulonglong)(uint)(iVar3 - *param_7) + 4 <= uVar4) {
          *param_1 = param_5;
          iVar3 = iVar3 + 4;
          goto LAB_180048552;
        }
      }
    }
LAB_18004858a:
    uVar2 = 0x6f;
  }
  RtlSetLastWin32Error(uVar2);
  return 0;
}



undefined8
FUN_1800485b8(undefined2 *param_1,uint param_2,ushort *param_3,int param_4,void *param_5,int param_6
             ,int *param_7)

{
  ushort *puVar1;
  ushort uVar2;
  size_t sVar3;
  bool bVar4;
  ushort *puVar5;
  longlong lVar6;
  undefined8 uVar7;
  uint uVar8;
  uint uVar9;
  ulonglong uVar10;
  int iVar11;
  ulonglong uVar12;
  longlong lVar13;
  
  bVar4 = false;
  uVar8 = 1;
  if ((((param_1 == (undefined2 *)0x0) || (param_3 == (ushort *)0x0)) || (param_7 == (int *)0x0)) ||
     (param_5 == (void *)0x0)) {
LAB_1800488bf:
    uVar7 = 0x57;
  }
  else {
    if ((param_6 == 0) || (param_4 <= (int)param_2)) {
      if (((int)param_2 < 0) || (param_4 < 0)) goto LAB_1800488bf;
      iVar11 = *param_7;
      uVar12 = (ulonglong)(longlong)param_4 >> 1;
      lVar13 = -1;
      lVar6 = -1;
      do {
        lVar6 = lVar6 + 1;
      } while (*(short *)((longlong)param_5 + lVar6 * 2) != 0);
      if (param_6 == 0) {
        for (; (0 < (int)uVar12 && (*param_3 != 0)); param_3 = param_3 + uVar10) {
          lVar13 = -1;
          do {
            lVar13 = lVar13 + 1;
          } while (param_3[lVar13] != 0);
          uVar9 = (int)lVar13 + 1;
          if (uVar9 - (int)lVar6 == 1) {
            puVar5 = param_3;
            do {
              uVar2 = *puVar5;
              puVar1 = (ushort *)((longlong)puVar5 + ((longlong)param_5 - (longlong)param_3));
              if (uVar2 != *puVar1) {
                uVar8 = -(uint)(uVar2 < *puVar1) | 1;
                goto LAB_180048856;
              }
              puVar5 = puVar5 + 1;
            } while (uVar2 != 0);
            uVar8 = 0;
          }
LAB_180048856:
          uVar10 = (ulonglong)uVar9;
          if (uVar8 == 0) {
            uVar8 = 1;
          }
          else {
            if ((ulonglong)param_2 < (ulonglong)(uint)(iVar11 - *param_7) + uVar10 * 2)
            goto LAB_1800488b8;
            memcpy(param_1,param_3,uVar10 * 2);
            iVar11 = iVar11 + uVar9 * 2;
            param_1 = param_1 + uVar10;
          }
          uVar12 = (ulonglong)((int)uVar12 - uVar9);
        }
LAB_1800487d7:
        if ((ulonglong)(uint)(iVar11 - *param_7) + 2 <= (ulonglong)param_2) {
          *param_1 = 0;
          iVar11 = iVar11 + 2;
        }
        *param_7 = iVar11;
        return 1;
      }
      if (0 < (int)uVar12) {
        do {
          if (*param_3 == 0) break;
          puVar5 = param_3;
          do {
            uVar2 = *puVar5;
            puVar1 = (ushort *)((longlong)puVar5 + ((longlong)param_5 - (longlong)param_3));
            if (uVar2 != *puVar1) {
              uVar8 = -(uint)(uVar2 < *puVar1) | 1;
              goto LAB_1800486a4;
            }
            puVar5 = puVar5 + 1;
          } while (uVar2 != 0);
          uVar8 = 0;
LAB_1800486a4:
          if (uVar8 == 0) {
            return 0;
          }
          if ((!bVar4) && (0 < (int)uVar8)) {
            lVar6 = -1;
            do {
              lVar6 = lVar6 + 1;
            } while (*(short *)((longlong)param_5 + lVar6 * 2) != 0);
            uVar8 = (int)lVar6 + 1;
            sVar3 = (ulonglong)uVar8 * 2;
            if ((ulonglong)param_2 < (uint)(iVar11 - *param_7) + sVar3) goto LAB_1800488b8;
            memcpy(param_1,param_5,sVar3);
            iVar11 = iVar11 + uVar8 * 2;
            param_1 = param_1 + uVar8;
            bVar4 = true;
          }
          lVar6 = -1;
          do {
            lVar6 = lVar6 + 1;
          } while (param_3[lVar6] != 0);
          uVar8 = (int)lVar6 + 1;
          if (uVar8 == 1) break;
          uVar10 = (ulonglong)uVar8;
          if ((ulonglong)param_2 < (ulonglong)(uint)(iVar11 - *param_7) + uVar10 * 2)
          goto LAB_1800488b8;
          memcpy(param_1,param_3,uVar10 * 2);
          iVar11 = iVar11 + uVar8 * 2;
          param_1 = param_1 + uVar10;
          param_3 = param_3 + uVar10;
          uVar8 = (int)uVar12 - uVar8;
          uVar12 = (ulonglong)uVar8;
        } while (0 < (int)uVar8);
        if (bVar4) goto LAB_1800487d7;
      }
      do {
        lVar13 = lVar13 + 1;
      } while (*(short *)((longlong)param_5 + lVar13 * 2) != 0);
      uVar8 = (int)lVar13 + 1;
      sVar3 = (ulonglong)uVar8 * 2;
      if ((uint)(iVar11 - *param_7) + sVar3 <= (ulonglong)param_2) {
        memcpy(param_1,param_5,sVar3);
        param_1 = param_1 + uVar8;
        iVar11 = iVar11 + uVar8 * 2;
        goto LAB_1800487d7;
      }
    }
LAB_1800488b8:
    uVar7 = 0x6f;
  }
  RtlSetLastWin32Error(uVar7);
  return 0;
}



void FUN_1800488f4(HGLOBAL param_1,LPCWSTR param_2)

{
  int hFile;
  UINT UVar1;
  int hFile_00;
  LPVOID pvVar2;
  LPCWSTR lpFileName;
  undefined auStackY184 [32];
  short local_78 [30];
  int local_3c;
  ulonglong local_38;
  HANDLE pvVar3;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStackY184;
  pvVar2 = GlobalLock(param_1);
  if (pvVar2 != (LPVOID)0x0) {
    lpFileName = (LPCWSTR)GlobalLock(*(HGLOBAL *)((longlong)pvVar2 + 0x30));
    if (lpFileName != (LPCWSTR)0x0) {
      pvVar3 = CreateFileW(lpFileName,0x80000000,0,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0x0);
      hFile = (int)pvVar3;
      GlobalUnlock(*(HGLOBAL *)((longlong)pvVar2 + 0x30));
      if (hFile != -1) {
        UVar1 = _hread(hFile,local_78,0x40);
        if (UVar1 == 0x40) {
          if (local_78[0] == 0x5a4d) {
            if (local_3c == 0) {
              _lclose(hFile);
            }
            else {
              pvVar3 = CreateFileW(param_2,0xc0000000,0,(LPSECURITY_ATTRIBUTES)0x0,2,0x80,
                                   (HANDLE)0x0);
              hFile_00 = (int)pvVar3;
              if (hFile_00 != -1) {
                FUN_180048184(hFile,hFile_00,local_3c,(longlong)pvVar2);
                _lclose(hFile_00);
              }
              _lclose(hFile);
            }
          }
          else {
            _lclose(hFile);
          }
        }
        else {
          _lclose(hFile);
        }
      }
      GlobalUnlock(param_1);
      goto LAB_180048a5d;
    }
    GlobalUnlock(param_1);
  }
  GetLastError();
LAB_180048a5d:
  __security_check_cookie(local_38 ^ (ulonglong)auStackY184);
  return;
}



undefined8 *
FUN_180048a8c(longlong param_1,HFILE param_2,int param_3,uint param_4,undefined8 *param_5)

{
  bool bVar1;
  LONG LVar2;
  undefined8 *puVar3;
  ulonglong uVar4;
  uint uVar5;
  undefined8 *puVar6;
  uint uVar7;
  
  for (puVar6 = *(undefined8 **)(param_1 + 0x20); puVar6 != (undefined8 *)0x0;
      puVar6 = (undefined8 *)*puVar6) {
    puVar3 = (undefined8 *)puVar6[4];
    bVar1 = true;
    while( true ) {
      for (; puVar3 != (undefined8 *)0x0; puVar3 = (undefined8 *)*puVar3) {
        if ((param_5 == (undefined8 *)0x0) || (puVar3 == param_5)) {
          param_5 = (undefined8 *)0x0;
          if ((param_4 == 0) || (uVar5 = *(uint *)((longlong)puVar3 + 0x24), param_4 < uVar5))
          goto LAB_180048be4;
          _hwrite(param_2,(LPCCH)puVar3[5],uVar5);
          uVar7 = -uVar5 & 3;
          if (uVar7 != 0) {
            _hwrite(param_2,"PADDINGXXPADDING",uVar7);
          }
          param_4 = param_4 - (uVar7 + uVar5);
        }
      }
      if (!bVar1) break;
      puVar3 = (undefined8 *)puVar6[3];
      bVar1 = false;
    }
  }
  for (puVar6 = *(undefined8 **)(param_1 + 0x18); puVar6 != (undefined8 *)0x0;
      puVar6 = (undefined8 *)*puVar6) {
    puVar3 = (undefined8 *)puVar6[4];
    bVar1 = true;
    while( true ) {
      for (; puVar3 != (undefined8 *)0x0; puVar3 = (undefined8 *)*puVar3) {
        if ((param_5 == (undefined8 *)0x0) || (puVar3 == param_5)) {
          param_5 = (undefined8 *)0x0;
          if ((param_4 == 0) || (uVar5 = *(uint *)((longlong)puVar3 + 0x24), param_4 < uVar5))
          goto LAB_180048be4;
          _hwrite(param_2,(LPCCH)puVar3[5],uVar5);
          uVar7 = -uVar5 & 3;
          if (uVar7 != 0) {
            _hwrite(param_2,"PADDINGXXPADDING",uVar7);
          }
          param_4 = param_4 - (uVar7 + uVar5);
        }
      }
      if (!bVar1) break;
      puVar3 = (undefined8 *)puVar6[3];
      bVar1 = false;
    }
  }
  puVar3 = (undefined8 *)0x0;
LAB_180048be4:
  LVar2 = _llseek(param_2,0,1);
  uVar5 = (param_3 + -1 + LVar2 & -param_3) - LVar2;
  if (uVar5 != 0) {
    if (0xf < uVar5) {
      uVar4 = (ulonglong)(uVar5 >> 4);
      do {
        _hwrite(param_2,"PADDINGXXPADDING",0x10);
        uVar5 = uVar5 - 0x10;
        uVar4 = uVar4 - 1;
      } while (uVar4 != 0);
    }
    _hwrite(param_2,"PADDINGXXPADDING",uVar5);
  }
  return puVar3;
}



HANDLE BeginUpdateResourceA(LPCSTR pFileName,BOOL bDeleteExistingResources)

{
  undefined8 uVar1;
  HANDLE pvVar2;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x48c60  105  BeginUpdateResourceA
  if (pFileName == (LPCSTR)0x0) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    uVar1 = Basep8BitStringToDynamicUnicodeString();
    if ((int)uVar1 != 0) {
      pvVar2 = BeginUpdateResourceW(local_10,bDeleteExistingResources);
      RtlFreeUnicodeString(local_18);
      return pvVar2;
    }
  }
  return (HANDLE)0x0;
}



HANDLE BeginUpdateResourceW(LPCWSTR pFileName,BOOL bDeleteExistingResources)

{
  uint uVar1;
  DWORD DVar2;
  HGLOBAL hMem;
  LPVOID lParam;
  HGLOBAL hMem_00;
  LPCWSTR lpFileName;
  HMODULE hModule;
  DWORD DVar3;
  uint local_res8;
  
                    // 0x48cd0  106  BeginUpdateResourceW
  DVar3 = 0;
  if ((pFileName == (LPCWSTR)0x0) || (*pFileName == L'\0')) {
    DVar3 = 0x57;
    goto LAB_180048ee7;
  }
  hMem = GlobalAlloc(0x42,0x38);
  if (hMem == (HGLOBAL)0x0) {
    DVar3 = 8;
    goto LAB_180048ee7;
  }
  lParam = GlobalLock(hMem);
  if (lParam == (LPVOID)0x0) {
    DVar3 = 8;
  }
  else {
    uVar1 = FID_conflict_StringCchLengthW(pFileName,0x7fffffff,(longlong *)&local_res8);
    if ((int)uVar1 < 0) {
      DVar3 = uVar1 & 0xffff;
    }
    else {
      *(undefined4 *)((longlong)lParam + 0x28) = 0;
      uVar1 = local_res8 + 1;
      if (local_res8 <= uVar1) {
        if ((ulonglong)uVar1 * 2 < 0x100000000) {
          hMem_00 = GlobalAlloc(0x42,(ulonglong)uVar1 * 2 & 0xffffffff);
          *(HGLOBAL *)((longlong)lParam + 0x30) = hMem_00;
          if (hMem_00 == (HGLOBAL)0x0) {
            DVar3 = 8;
          }
          else {
            lpFileName = (LPCWSTR)GlobalLock(hMem_00);
            if (lpFileName == (LPCWSTR)0x0) {
              DVar3 = 8;
            }
            else {
              uVar1 = FUN_18000b370(lpFileName,(ulonglong)uVar1,(longlong)pFileName);
              GlobalUnlock(*(HGLOBAL *)((longlong)lParam + 0x30));
              if ((int)uVar1 < 0) {
                DVar3 = uVar1 & 0xffff;
              }
              else {
                DVar2 = GetFileAttributesW(lpFileName);
                if (DVar2 == 0xffffffff) {
                  DVar3 = GetLastError();
                  if (DVar3 == 0) {
                    DVar3 = 2;
                  }
                }
                else if ((DVar2 & 0x17) == 0) {
                  hModule = LoadLibraryExW(pFileName,(HANDLE)0x0,3);
                  if (hModule == (HMODULE)0x0) {
                    DVar3 = GetLastError();
                    if (DVar3 == 0) {
                      DVar3 = 0xc1;
                    }
                  }
                  else {
                    if (bDeleteExistingResources == 0) {
                      EnumResourceTypesExW(hModule,FUN_180047720,(LONG_PTR)lParam,0x10,0);
                    }
                    FreeLibrary(hModule);
                    if (*(int *)((longlong)lParam + 0x28) == 0) {
                      GlobalUnlock(hMem);
                      return hMem;
                    }
                  }
                }
                else {
                  DVar3 = 0x13;
                }
              }
            }
            GlobalFree(*(HGLOBAL *)((longlong)lParam + 0x30));
          }
          goto LAB_180048ec9;
        }
      }
      DVar3 = 0x216;
    }
LAB_180048ec9:
    GlobalUnlock(hMem);
  }
  GlobalFree(hMem);
LAB_180048ee7:
  RtlSetLastWin32Error(DVar3);
  return (HANDLE)0x0;
}



BOOL EndUpdateResourceA(HANDLE hUpdate,BOOL fDiscard)

{
  uint uVar1;
  UINT UVar2;
  DWORD DVar3;
  BOOL BVar4;
  BOOL extraout_EAX;
  LPVOID pvVar5;
  LPCWSTR lpNewFileName;
  undefined4 *puVar6;
  LPVOID pvVar7;
  undefined8 uVar8;
  LPCWSTR pWVar9;
  LPCWSTR pWVar10;
  undefined auStackY648 [32];
  undefined4 *apuStack600 [2];
  undefined4 uStack584;
  undefined2 uStack580;
  ulonglong uStack56;
  
                    // 0x48f20  311  EndUpdateResourceA
  uStack56 = DAT_1800b2220 ^ (ulonglong)auStackY648;
  pWVar9 = (LPCWSTR)0x0;
  pWVar10 = (LPCWSTR)0x0;
  RtlSetLastWin32Error(0);
  if (hUpdate == (HANDLE)0x0) {
    uVar8 = 0x57;
LAB_180048f84:
    RtlSetLastWin32Error(uVar8);
    goto LAB_180049187;
  }
  pvVar5 = GlobalLock(hUpdate);
  lpNewFileName = pWVar9;
  if (fDiscard == 0) {
    if (pvVar5 == (LPVOID)0x0) goto LAB_180049187;
    lpNewFileName = (LPCWSTR)GlobalLock(*(HGLOBAL *)((longlong)pvVar5 + 0x30));
    if (lpNewFileName == (LPCWSTR)0x0) {
      uVar8 = 0x54f;
      goto LAB_180048f84;
    }
    uVar1 = FUN_18000b120((short *)&uStack584,0x104,lpNewFileName,(short **)apuStack600,
                          (longlong *)0x0);
    if ((int)uVar1 < 0) {
      pWVar10 = (LPCWSTR)(ulonglong)(uVar1 & 0xffff);
    }
    else {
      do {
        puVar6 = apuStack600[0];
        apuStack600[0] = (undefined4 *)((longlong)puVar6 + -2);
        if (*(short *)apuStack600[0] == 0x5c) break;
      } while (&uStack584 <= apuStack600[0]);
      *(short *)puVar6 = 0;
      UVar2 = GetTempFileNameW((LPCWSTR)&uStack584,L"RCX",0,(LPWSTR)&uStack584);
      if (UVar2 == 0) {
        DVar3 = GetTempPathW(0x104,(LPWSTR)&uStack584);
        if (DVar3 == 0) {
          uStack584 = 0x5c002e;
          uStack580 = 0;
        }
        UVar2 = GetTempFileNameW((LPCWSTR)&uStack584,L"RCX",0,(LPWSTR)&uStack584);
        if (UVar2 == 0) {
          GetLastError();
          pWVar10 = pWVar9;
          goto LAB_180049112;
        }
        uVar1 = FUN_1800488f4(hUpdate,(LPCWSTR)&uStack584);
        if (uVar1 == 0) goto LAB_1800490b0;
        pWVar10 = (LPCWSTR)(ulonglong)uVar1;
      }
      else {
        uVar1 = FUN_1800488f4(hUpdate,(LPCWSTR)&uStack584);
        if (uVar1 == 0) {
LAB_1800490b0:
          BVar4 = MoveFileExW((LPCWSTR)&uStack584,lpNewFileName,3);
          if (BVar4 != 0) goto LAB_180049112;
          DVar3 = GetLastError();
          pWVar10 = (LPCWSTR)(ulonglong)DVar3;
          if (DVar3 == 0) {
            pWVar10 = (LPCWSTR)0x54f;
          }
        }
        else {
          pWVar10 = (LPCWSTR)(ulonglong)uVar1;
        }
      }
      DeleteFileW((LPCWSTR)&uStack584);
    }
LAB_180049112:
    GlobalUnlock(*(HGLOBAL *)((longlong)pvVar5 + 0x30));
    GlobalFree(*(HGLOBAL *)((longlong)pvVar5 + 0x30));
    pWVar9 = pWVar10;
  }
  if (pvVar5 != (LPVOID)0x0) {
    if (lpNewFileName == (LPCWSTR)0x0) {
      pvVar7 = GlobalLock(*(HGLOBAL *)((longlong)pvVar5 + 0x30));
      if (pvVar7 != (LPVOID)0x0) {
        GlobalFree(*(HGLOBAL *)((longlong)pvVar5 + 0x30));
        goto LAB_180049153;
      }
    }
    else {
LAB_180049153:
      FUN_1800477a4((longlong)pvVar5);
    }
    GlobalUnlock(hUpdate);
  }
  GlobalFree(hUpdate);
  RtlSetLastWin32Error(pWVar9);
LAB_180049187:
  __security_check_cookie(uStack56 ^ (ulonglong)auStackY648);
  return extraout_EAX;
}



BOOL EndUpdateResourceW(HANDLE hUpdate,BOOL fDiscard)

{
  uint uVar1;
  UINT UVar2;
  DWORD DVar3;
  BOOL BVar4;
  BOOL extraout_EAX;
  LPVOID pvVar5;
  LPCWSTR lpNewFileName;
  undefined4 *puVar6;
  LPVOID pvVar7;
  undefined8 uVar8;
  LPCWSTR pWVar9;
  LPCWSTR pWVar10;
  undefined auStackY648 [32];
  undefined4 *local_258 [2];
  undefined4 local_248;
  undefined2 local_244;
  ulonglong local_38;
  
                    // 0x48f30  312  EndUpdateResourceW
  local_38 = DAT_1800b2220 ^ (ulonglong)auStackY648;
  pWVar9 = (LPCWSTR)0x0;
  pWVar10 = (LPCWSTR)0x0;
  RtlSetLastWin32Error(0);
  if (hUpdate == (HANDLE)0x0) {
    uVar8 = 0x57;
LAB_180048f84:
    RtlSetLastWin32Error(uVar8);
    goto LAB_180049187;
  }
  pvVar5 = GlobalLock(hUpdate);
  lpNewFileName = pWVar9;
  if (fDiscard == 0) {
    if (pvVar5 == (LPVOID)0x0) goto LAB_180049187;
    lpNewFileName = (LPCWSTR)GlobalLock(*(HGLOBAL *)((longlong)pvVar5 + 0x30));
    if (lpNewFileName == (LPCWSTR)0x0) {
      uVar8 = 0x54f;
      goto LAB_180048f84;
    }
    uVar1 = FUN_18000b120((short *)&local_248,0x104,lpNewFileName,(short **)local_258,
                          (longlong *)0x0);
    if ((int)uVar1 < 0) {
      pWVar10 = (LPCWSTR)(ulonglong)(uVar1 & 0xffff);
    }
    else {
      do {
        puVar6 = local_258[0];
        local_258[0] = (undefined4 *)((longlong)puVar6 + -2);
        if (*(short *)local_258[0] == 0x5c) break;
      } while (&local_248 <= local_258[0]);
      *(short *)puVar6 = 0;
      UVar2 = GetTempFileNameW((LPCWSTR)&local_248,L"RCX",0,(LPWSTR)&local_248);
      if (UVar2 == 0) {
        DVar3 = GetTempPathW(0x104,(LPWSTR)&local_248);
        if (DVar3 == 0) {
          local_248 = 0x5c002e;
          local_244 = 0;
        }
        UVar2 = GetTempFileNameW((LPCWSTR)&local_248,L"RCX",0,(LPWSTR)&local_248);
        if (UVar2 == 0) {
          GetLastError();
          pWVar10 = pWVar9;
          goto LAB_180049112;
        }
        uVar1 = FUN_1800488f4(hUpdate,(LPCWSTR)&local_248);
        if (uVar1 == 0) goto LAB_1800490b0;
        pWVar10 = (LPCWSTR)(ulonglong)uVar1;
      }
      else {
        uVar1 = FUN_1800488f4(hUpdate,(LPCWSTR)&local_248);
        if (uVar1 == 0) {
LAB_1800490b0:
          BVar4 = MoveFileExW((LPCWSTR)&local_248,lpNewFileName,3);
          if (BVar4 != 0) goto LAB_180049112;
          DVar3 = GetLastError();
          pWVar10 = (LPCWSTR)(ulonglong)DVar3;
          if (DVar3 == 0) {
            pWVar10 = (LPCWSTR)0x54f;
          }
        }
        else {
          pWVar10 = (LPCWSTR)(ulonglong)uVar1;
        }
      }
      DeleteFileW((LPCWSTR)&local_248);
    }
LAB_180049112:
    GlobalUnlock(*(HGLOBAL *)((longlong)pvVar5 + 0x30));
    GlobalFree(*(HGLOBAL *)((longlong)pvVar5 + 0x30));
    pWVar9 = pWVar10;
  }
  if (pvVar5 != (LPVOID)0x0) {
    if (lpNewFileName == (LPCWSTR)0x0) {
      pvVar7 = GlobalLock(*(HGLOBAL *)((longlong)pvVar5 + 0x30));
      if (pvVar7 != (LPVOID)0x0) {
        GlobalFree(*(HGLOBAL *)((longlong)pvVar5 + 0x30));
        goto LAB_180049153;
      }
    }
    else {
LAB_180049153:
      FUN_1800477a4((longlong)pvVar5);
    }
    GlobalUnlock(hUpdate);
  }
  GlobalFree(hUpdate);
  RtlSetLastWin32Error(pWVar9);
LAB_180049187:
  __security_check_cookie(local_38 ^ (ulonglong)auStackY648);
  return extraout_EAX;
}



uint FUN_1800491bc(char *param_1,undefined8 param_2,longlong param_3)

{
  char *pcVar1;
  longlong lVar2;
  longlong lVar3;
  
  lVar2 = 8;
  lVar3 = param_3 - (longlong)param_1;
  do {
    if ((lVar2 == -0x7ffffff6) || (param_1[lVar3] == '\0')) break;
    *param_1 = param_1[lVar3];
    param_1 = param_1 + 1;
    lVar2 = lVar2 + -1;
  } while (lVar2 != 0);
  pcVar1 = param_1 + -1;
  if (lVar2 != 0) {
    pcVar1 = param_1;
  }
  *pcVar1 = '\0';
  return ~-(uint)(lVar2 != 0) & 0x8007007a;
}



// Library Function - Multiple Matches With Different Base Names
//  long __cdecl StringCchLengthW(unsigned short const * __ptr64,unsigned __int64,unsigned __int64 *
// __ptr64)
//  long __cdecl StringCchLengthW(wchar_t const * __ptr64,unsigned __int64,unsigned __int64 *
// __ptr64)
//  StringCchLengthW
// 
// Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release

void FID_conflict_StringCchLengthW(short *param_1,ulonglong param_2,longlong *param_3)

{
  uint uVar1;
  ulonglong uVar2;
  
  if ((param_1 == (short *)0x0) || (0x7fffffff < param_2)) {
    uVar1 = 0x80070057;
  }
  else {
    uVar2 = param_2;
    if (param_2 != 0) {
      do {
        if (*param_1 == 0) break;
        param_1 = param_1 + 1;
        uVar2 = uVar2 - 1;
      } while (uVar2 != 0);
    }
    uVar1 = ~-(uint)(uVar2 != 0) & 0x80070057;
    if (param_3 != (longlong *)0x0) {
      if (uVar2 == 0) {
        *param_3 = 0;
      }
      else {
        *param_3 = param_2 - uVar2;
      }
    }
  }
  if (((int)uVar1 < 0) && (param_3 != (longlong *)0x0)) {
    *param_3 = 0;
  }
  return;
}



BOOL UpdateResourceA(HANDLE hUpdate,LPCSTR lpType,LPCSTR lpName,WORD wLanguage,LPVOID lpData,
                    DWORD cb)

{
  int iVar1;
  BOOL BVar2;
  longlong lVar3;
  longlong lVar4;
  undefined2 local_48 [4];
  LPCSTR local_40;
  undefined local_38 [8];
  LPCWSTR local_30;
  undefined local_28 [8];
  LPCWSTR local_20;
  
                    // 0x49270  1487  UpdateResourceA
  BVar2 = 0;
  if ((lpType == (LPCSTR)0x0) || (lpName == (LPCSTR)0x0)) {
    BaseSetLastNTError();
    return 0;
  }
  RtlInitUnicodeString(local_38,0);
  RtlInitUnicodeString(local_28,0);
  lVar4 = -1;
  if (lpType < (LPCSTR)0x10000) {
LAB_180049325:
    if ((LPCSTR)0xffff < lpName) {
      do {
        lVar4 = lVar4 + 1;
      } while (lpName[lVar4] != '\0');
      local_48[0] = (undefined2)lVar4;
      local_40 = lpName;
      iVar1 = RtlAnsiStringToUnicodeString(local_28,local_48,1);
      lpName = (LPCSTR)local_20;
      if (iVar1 < 0) goto LAB_180049317;
    }
    BVar2 = UpdateResourceW(hUpdate,(LPCWSTR)lpType,(LPCWSTR)lpName,wLanguage,lpData,cb);
  }
  else {
    lVar3 = -1;
    do {
      lVar3 = lVar3 + 1;
    } while (lpType[lVar3] != '\0');
    local_48[0] = (undefined2)lVar3;
    local_40 = lpType;
    iVar1 = RtlAnsiStringToUnicodeString(local_38,local_48,1);
    lpType = (LPCSTR)local_30;
    if (-1 < iVar1) goto LAB_180049325;
LAB_180049317:
    BaseSetLastNTError();
  }
  RtlFreeUnicodeString(local_38);
  RtlFreeUnicodeString(local_28);
  return BVar2;
}



void FUN_1800493e3(undefined8 param_1,longlong param_2)

{
  RtlFreeUnicodeString(param_2 + 0x40);
  RtlFreeUnicodeString(param_2 + 0x50);
  return;
}



// WARNING: Removing unreachable block (ram,0x000180049536)
// WARNING: Removing unreachable block (ram,0x000180049575)
// WARNING: Removing unreachable block (ram,0x00018004957f)
// WARNING: Removing unreachable block (ram,0x0001800495ce)
// WARNING: Removing unreachable block (ram,0x000180049646)

BOOL UpdateResourceW(HANDLE hUpdate,LPCWSTR lpType,LPCWSTR lpName,WORD wLanguage,LPVOID lpData,
                    DWORD cb)

{
  int iVar1;
  int *piVar2;
  LPVOID pvVar3;
  undefined8 uVar4;
  undefined (*pauVar5) [16];
  undefined (*pauVar6) [16];
  longlong in_GS_OFFSET;
  
                    // 0x49420  1488  UpdateResourceW
  RtlSetLastWin32Error(0);
  piVar2 = (int *)GlobalLock(hUpdate);
  if ((piVar2 == (int *)0x0) || (cb != 0)) {
    iVar1 = 0x57;
  }
  else {
    pvVar3 = GlobalLock(*(HGLOBAL *)(piVar2 + 0xc));
    if (pvVar3 == (LPVOID)0x0) {
      iVar1 = 0x54f;
    }
    else {
      uVar4 = FUN_180047ef0((longlong)piVar2,lpType,wLanguage);
      if ((int)uVar4 == 0) {
        GlobalUnlock(hUpdate);
        iVar1 = 0x32;
      }
      else {
        pauVar5 = FUN_180047078(lpName,piVar2);
        if (pauVar5 == (undefined (*) [16])0x0) {
          piVar2[10] = 8;
        }
        else {
          pauVar6 = FUN_180047078(lpType,piVar2);
          if (pauVar6 != (undefined (*) [16])0x0) {
            uVar4 = FUN_180046a18((int *)pauVar6,pauVar5,wLanguage,(longlong)piVar2,hUpdate,0,0);
            iVar1 = (int)uVar4;
            if (iVar1 == 0) {
              GlobalUnlock(hUpdate);
              return 1;
            }
            GlobalFree(*(HGLOBAL *)(piVar2 + 0xc));
            FUN_1800477a4((longlong)piVar2);
            GlobalUnlock(hUpdate);
            goto LAB_180049484;
          }
          piVar2[10] = 8;
          if (*(int *)*pauVar5 == 2) {
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pauVar5);
          }
          FUN_180047984((longlong)piVar2);
        }
        iVar1 = 8;
        GlobalUnlock(hUpdate);
      }
    }
  }
LAB_180049484:
  RtlSetLastWin32Error(iVar1);
  return 0;
}



undefined8 CompareCalendarDates(uint *param_1,uint *param_2,undefined4 *param_3)

{
  uint uVar1;
  int iVar2;
  bool bVar3;
  undefined local_res18 [16];
  
                    // 0x49670  154  CompareCalendarDates
  if (param_3 == (undefined4 *)0x0) {
LAB_1800496ef:
    SetLastError(0x57);
    return 0;
  }
  iVar2 = IsValidCalDateTime(param_1,(longlong)local_res18);
  if (iVar2 == 0) {
    return 0;
  }
  iVar2 = IsValidCalDateTime(param_2,(longlong)local_res18);
  if (iVar2 == 0) {
    return 0;
  }
  if (*param_1 != *param_2) goto LAB_1800496ef;
  uVar1 = param_2[1];
  bVar3 = uVar1 <= param_1[1];
  if (bVar3 && param_1[1] != uVar1) {
LAB_1800496e9:
    *param_3 = 1;
  }
  else {
    if (bVar3) {
      uVar1 = param_2[2];
      bVar3 = uVar1 <= param_1[2];
      if (bVar3 && param_1[2] != uVar1) goto LAB_1800496e9;
      if (bVar3) {
        uVar1 = param_2[3];
        bVar3 = uVar1 <= param_1[3];
        if (bVar3 && param_1[3] != uVar1) goto LAB_1800496e9;
        if (bVar3) {
          uVar1 = param_2[4];
          bVar3 = uVar1 <= param_1[4];
          if (bVar3 && param_1[4] != uVar1) goto LAB_1800496e9;
          if (bVar3) {
            *param_3 = 0;
            return 1;
          }
        }
      }
    }
    *param_3 = 0xffffffff;
  }
  return 1;
}



ulonglong ConvertCalDateTimeToSystemTime(uint *param_1,undefined2 *param_2)

{
  bool bVar1;
  int iVar2;
  uint uVar3;
  ulonglong uVar4;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined local_res10 [8];
  undefined4 local_38 [12];
  
                    // 0x49720  163  ConvertCalDateTimeToSystemTime
  uVar3 = 0;
  if ((param_2 != (undefined2 *)0x0) &&
     (iVar2 = IsValidCalDateTime(param_1,(longlong)local_res10), iVar2 != 0)) {
    if (*param_1 < 9) {
      if (*param_1 == 8) {
        uVar4 = FUN_18004f550(param_1,param_2);
        return uVar4;
      }
      if (*param_1 != 0) {
        if (2 < *param_1) {
          if (5 < *param_1) {
            if (*param_1 == 6) {
              uVar4 = FUN_180051408((longlong)param_1,param_2);
              return uVar4;
            }
            if (*param_1 != 7) goto LAB_180049771;
          }
          iVar2 = FUN_18004e08c(local_38,param_1);
          if (iVar2 != 0) {
            bVar1 = FUN_18004db54((longlong)local_38,param_2);
            uVar3 = (uint)CONCAT71(extraout_var,bVar1);
          }
          return (ulonglong)uVar3;
        }
LAB_1800497fc:
        bVar1 = FUN_18004db54((longlong)param_1,param_2);
        return CONCAT71(extraout_var_00,bVar1);
      }
    }
    else {
      if (*param_1 < 0xd) goto LAB_1800497fc;
      if (*param_1 == 0x16) {
        uVar4 = FUN_180050884((longlong)param_1,param_2);
        return uVar4;
      }
      if (*param_1 == 0x17) {
        uVar4 = FUN_18004ec94(param_1,param_2);
        return uVar4;
      }
    }
  }
LAB_180049771:
  SetLastError(0x57);
  return 0;
}



int ConvertNLSDayOfWeekToWin32DayOfWeek(uint param_1)

{
  int iVar1;
  
                    // 0x49820  166  ConvertNLSDayOfWeekToWin32DayOfWeek
  if (param_1 < 7) {
    iVar1 = param_1 + 1;
    if (iVar1 == 7) {
      iVar1 = 0;
    }
  }
  else {
    SetLastError(0x57);
    iVar1 = -1;
  }
  return iVar1;
}



void GetCalendarDateFormat
               (LCID param_1,uint param_2,uint *param_3,ushort *param_4,short *param_5,int param_6)

{
  int iVar1;
  undefined auStackY280 [32];
  WCHAR local_e8 [88];
  ulonglong local_38;
  
                    // 0x49860  463  GetCalendarDateFormat
  local_38 = DAT_1800b2220 ^ (ulonglong)auStackY280;
  iVar1 = LCIDToLocaleName(param_1,local_e8,0x55,0);
  if (iVar1 != 0) {
    GetCalendarDateFormatEx(local_e8,param_2,param_3,param_4,param_5,param_6);
  }
  __security_check_cookie(local_38 ^ (ulonglong)auStackY280);
  return;
}



ulonglong FUN_1800498f0(uint *param_1,undefined8 param_2)

{
  int iVar1;
  int iVar2;
  ulonglong uVar3;
  undefined4 extraout_var;
  undefined4 extraout_var_00;
  uint local_38;
  uint uStack52;
  uint uStack48;
  undefined4 uStack44;
  undefined4 local_28;
  uint uStack36;
  uint uStack32;
  uint uStack28;
  undefined8 local_18;
  
  if (param_1 != (uint *)0x0) {
    if (*param_1 < 9) {
      if (*param_1 == 8) {
        iVar1 = FUN_18004f6bc((int *)param_1,param_2);
        return CONCAT44(extraout_var,iVar1);
      }
      if (*param_1 != 0) {
        if (2 < *param_1) {
          if (5 < *param_1) {
            if (*param_1 == 6) {
              uVar3 = FUN_1800516d0(param_1,param_2);
              return uVar3;
            }
            if (*param_1 != 7) goto LAB_18004992b;
          }
          uVar3 = FUN_18004e25c(param_1);
          return uVar3;
        }
LAB_1800499b4:
        iVar1 = FUN_180008558(param_1[2],param_1[3],param_1[4]);
        iVar2 = FUN_180008558(param_1[2],1,1);
        return (ulonglong)(uint)((1 - iVar2) + iVar1);
      }
    }
    else {
      if (*param_1 < 0xd) goto LAB_1800499b4;
      if (*param_1 == 0x16) {
        local_38 = *param_1;
        uStack52 = param_1[1];
        uStack48 = param_1[2];
        uStack36 = param_1[5];
        uStack32 = param_1[6];
        uStack28 = param_1[7];
        uStack44 = 1;
        local_18 = *(undefined8 *)(param_1 + 8);
        local_28 = 1;
        iVar1 = FUN_180050c64((longlong)&local_38,(longlong)param_1);
        return (ulonglong)(iVar1 + 1);
      }
      if (*param_1 == 0x17) {
        iVar1 = FUN_18004ecf8((int *)param_1,param_2);
        return CONCAT44(extraout_var_00,iVar1);
      }
    }
  }
LAB_18004992b:
  SetLastError(0x57);
  return 0;
}



uint FUN_1800499e8(uint param_1,uint param_2,uint param_3)

{
  int iVar1;
  DWORD DVar2;
  undefined8 uVar3;
  ulonglong uVar4;
  uint uVar5;
  
  uVar5 = 0;
  if (param_1 < 9) {
    if (param_1 == 8) {
      uVar3 = FUN_18004fe38(param_2,param_3);
      if ((int)uVar3 == 0) {
        return 0;
      }
      return (-(uint)((byte)(&DAT_180089a20)[param_2 * 2 - 0x29bd] < 4) & 0xffffffe5) + 0x17b +
             (uint)(byte)(&DAT_180089a20)[param_2 * 2 - 0x29bd];
    }
    if (param_1 == 0) {
LAB_180049a29:
      SetLastError(0x57);
      return 0;
    }
    if (2 < param_1) {
      if (5 < param_1) {
        if (param_1 == 6) {
          uVar3 = FUN_180051a0c(param_2,param_3);
          if ((int)uVar3 == 0) {
            return 0;
          }
          uVar4 = FUN_180051860(param_2,1);
          return ((int)uVar4 != 0) + 0x162;
        }
        if (param_1 != 7) goto LAB_180049a29;
      }
      iVar1 = FUN_18004e6c8(param_1,param_2,param_3);
      if (iVar1 != 0) {
        return 0x16e;
      }
      DVar2 = GetLastError();
      return ~-(uint)(DVar2 != 0) & 0x16d;
    }
  }
  else if (0xc < param_1) {
    if (param_1 == 0x16) {
      uVar5 = FUN_180050bbc(param_2,param_3);
      return uVar5;
    }
    if (param_1 == 0x17) {
      uVar3 = FUN_18004f0f4(param_2,param_3);
      if ((int)uVar3 == 0) {
        return 0;
      }
      uVar5 = FUN_18004edd4(param_2);
      return uVar5;
    }
    goto LAB_180049a29;
  }
  uVar3 = FUN_1800084e0(param_2,param_3);
  if ((int)uVar3 != 0) {
    uVar3 = FUN_18000846c(param_2,param_3);
    uVar5 = ((int)uVar3 != 0) + 0x16d;
  }
  return uVar5;
}



undefined8 GetCalendarDifferenceInDays(uint *param_1,uint *param_2,int *param_3)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  undefined local_res18 [8];
  
                    // 0x49b40  466  GetCalendarDifferenceInDays
  if (param_3 == (int *)0x0) {
LAB_180049c65:
    SetLastError(0x57);
    return 0;
  }
  iVar2 = IsValidCalDateTime(param_1,(longlong)local_res18);
  if (iVar2 == 0) {
    return 0;
  }
  iVar2 = IsValidCalDateTime(param_2,(longlong)local_res18);
  if (iVar2 == 0) {
    return 0;
  }
  uVar1 = *param_1;
  if (uVar1 != *param_2) goto LAB_180049c65;
  if (uVar1 < 9) {
    if (uVar1 == 8) {
      iVar3 = FUN_18004fa1c(param_1);
      iVar2 = FUN_18004fa1c(param_2);
    }
    else {
      if (uVar1 == 0) {
LAB_180049bbc:
        SetLastError(0x57);
        return 0;
      }
      if (2 < uVar1) {
        if (5 < uVar1) {
          if (uVar1 == 6) {
            iVar3 = FUN_18005179c((longlong)param_1);
            iVar2 = FUN_18005179c((longlong)param_2);
            goto LAB_180049c57;
          }
          if (uVar1 != 7) goto LAB_180049bbc;
        }
        iVar2 = FUN_18004e318(param_1,param_2);
        goto LAB_180049c59;
      }
LAB_180049c37:
      iVar3 = FUN_180008558(param_1[2],param_1[3],param_1[4]);
      iVar2 = FUN_180008558(param_2[2],param_2[3],param_2[4]);
    }
  }
  else {
    if (uVar1 < 0xd) goto LAB_180049c37;
    if (uVar1 == 0x16) {
      iVar2 = FUN_180050c64((longlong)param_1,(longlong)param_2);
      goto LAB_180049c59;
    }
    if (uVar1 != 0x17) goto LAB_180049bbc;
    iVar3 = FUN_18004f134(param_1);
    iVar2 = FUN_18004f134(param_2);
  }
LAB_180049c57:
  iVar2 = iVar2 - iVar3;
LAB_180049c59:
  *param_3 = iVar2;
  return 1;
}



byte GetCalendarMonthsInYear(uint param_1,uint param_2,uint param_3)

{
  byte bVar1;
  int iVar2;
  undefined8 uVar3;
  undefined **local_38;
  undefined4 local_30;
  int iStackY44;
  undefined4 uStackY40;
  undefined4 uStackY36;
  undefined4 local_20;
  undefined4 local_1c;
  char cVar5;
  ulonglong uVar4;
  
                    // 0x49ca0  470  GetCalendarMonthsInYear
  uVar3 = FUN_180007490(param_1);
  if ((int)uVar3 == 0) {
    SetLastError(0x57);
    return 0;
  }
  if (param_1 < 9) {
    if (param_1 == 8) {
      bVar1 = FUN_18004f78c(param_2,param_3);
      return bVar1;
    }
    if (param_1 == 0) {
      return 0;
    }
    if (2 < param_1) {
      if (5 < param_1) {
        if (param_1 == 6) {
          uVar3 = FUN_180051a0c(param_2,param_3);
          iVar2 = (int)uVar3;
          goto LAB_180049d5a;
        }
        if (param_1 != 7) {
          return 0;
        }
      }
      uVar4 = FUN_18004e728(param_1,10,10,param_2,param_3);
      iVar2 = (int)uVar4;
      goto LAB_180049d5a;
    }
  }
  else if (0xc < param_1) {
    if (param_1 == 0x16) {
      local_20 = 0x3764f;
      local_1c = 0x37b9da;
      bVar1 = 0;
      cVar5 = '\0';
      local_38 = &PTR_FUN_180080460;
      local_30 = 1;
      iStackY44 = 1;
      uStackY40 = 1;
      uStackY36 = 1;
      FUN_1800533d0((longlong *)&local_38,param_3);
      FUN_180053490((longlong *)&local_38,param_2);
      if (cVar5 == '\0') {
        bVar1 = 0xc;
        if ((iStackY44 != 1) && (bVar1 = 0xc, iStackY44 == 0x24a2)) {
          bVar1 = 10;
        }
      }
      else {
        SetLastError(0x57);
      }
      return bVar1;
    }
    if (param_1 != 0x17) {
      return 0;
    }
    uVar3 = FUN_18004f0f4(param_2,param_3);
    iVar2 = (int)uVar3;
    goto LAB_180049d5a;
  }
  uVar3 = FUN_1800084e0(param_2,param_3);
  iVar2 = (int)uVar3;
LAB_180049d5a:
  return -(iVar2 != 0) & 0xc;
}



undefined8 GetCalendarWeekNumber(uint *param_1,uint param_2,ulonglong param_3,int *param_4)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  undefined local_res10 [8];
  
                    // 0x49d70  472  GetCalendarWeekNumber
  if (((param_2 < 7) && (uVar3 = (uint)(param_3 & 0xffffffff), uVar3 < 3)) &&
     (param_4 != (int *)0x0)) {
    iVar2 = IsValidCalDateTime(param_1,(longlong)local_res10);
    if (iVar2 != 0) {
      if (uVar3 == 0) {
        iVar2 = FUN_180049e54(param_1,(ulonglong)param_2);
      }
      else {
        uVar1 = *param_1;
        iVar2 = 7;
        if ((uVar1 == 0) || (((5 < uVar1 && (uVar1 != 7)) && (3 < uVar1 - 9)))) {
          if (uVar3 != 1) {
            iVar2 = 4;
          }
          iVar2 = FUN_180049f70(param_1,param_3 & 0xffffffff,param_2,iVar2);
        }
        else {
          iVar2 = 7;
          if (uVar3 != 1) {
            iVar2 = 4;
          }
          iVar2 = FUN_18004dd8c(param_1,(ulonglong)param_2,iVar2);
        }
      }
      *param_4 = iVar2;
      return 1;
    }
  }
  else {
    SetLastError(0x57);
  }
  return 0;
}



int FUN_180049e54(uint *param_1,undefined8 param_2)

{
  int iVar1;
  int iVar2;
  ulonglong uVar3;
  uint uVar4;
  
  iVar2 = (int)param_2;
  uVar3 = FUN_1800498f0(param_1,param_2);
  uVar4 = (int)uVar3 - 1;
  iVar1 = UpdateCalendarDayOfWeek(param_1,param_2);
  if (iVar1 == 0) {
    iVar2 = 0;
  }
  else {
    iVar2 = (((((uVar4 / 7 + 2) * 7 + param_1[5]) - uVar4) - iVar2) % 7 + uVar4) / 7 + 1;
  }
  return iVar2;
}



// WARNING: Could not reconcile some variable overlaps

undefined4 FUN_180049ef0(uint param_1)

{
  undefined4 uVar1;
  undefined **local_38;
  undefined8 local_30;
  undefined4 uStack40;
  undefined4 uStack36;
  undefined4 local_20;
  undefined4 local_1c;
  undefined local_18;
  
  if (param_1 < 8) {
    if (param_1 != 7) {
      if (param_1 == 0) goto LAB_180049f49;
      if (2 < param_1) {
        if (param_1 == 3) {
          return 0x74c;
        }
        if ((param_1 < 4) || ((5 < param_1 && (param_1 != 6)))) goto LAB_180049f49;
      }
    }
LAB_180049f15:
    uVar1 = 1;
  }
  else {
    if (param_1 == 8) {
      return 0x14df;
    }
    if (8 < param_1) {
      if (param_1 < 0xd) goto LAB_180049f15;
      if (param_1 == 0x16) {
        local_38 = &PTR_FUN_180080460;
        local_20 = 0x3764f;
        local_30._0_4_ = 1;
        local_30._4_4_ = 1;
        uStack40 = 1;
        uStack36 = 1;
        local_1c = 0x37b9da;
        local_18 = 0;
        FUN_1800531e8((longlong *)&local_38,0x3764f);
        return local_30._4_4_;
      }
      if (param_1 == 0x17) {
        return 0x526;
      }
    }
LAB_180049f49:
    local_30 = 0x180049f55;
    SetLastError(0x57);
    uVar1 = 0;
  }
  return uVar1;
}



void FUN_180049f70(uint *param_1,ulonglong param_2,int param_3,int param_4)

{
  int iVar1;
  ulonglong uVar2;
  uint uVar3;
  uint uVar4;
  ulonglong uVar5;
  undefined auStack120 [32];
  uint local_58 [10];
  ulonglong local_30;
  
  local_30 = DAT_1800b2220 ^ (ulonglong)auStack120;
  uVar5 = param_2 & 0xffffffff;
  uVar2 = FUN_1800498f0(param_1,param_2);
  uVar4 = (int)uVar2 - 1;
  UpdateCalendarDayOfWeek(param_1,param_2);
  uVar3 = (((2 - (int)uVar4 / 7) * 7 - param_1[5]) + param_3 + uVar4) % 7;
  if ((uVar3 != 0) && (param_4 <= (int)uVar3)) {
    uVar3 = uVar3 - 7;
  }
  if ((int)(uVar4 - uVar3) < 0) {
    FUN_1800075c4(local_58,param_1);
    iVar1 = AdjustCalendarDate(local_58,4,~uVar4);
    if (iVar1 != 0) {
      FUN_180049f70(local_58,uVar5,param_3,param_4);
    }
  }
  __security_check_cookie(local_30 ^ (ulonglong)auStack120);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

ulonglong IsCalendarLeapDay(uint param_1,uint param_2,uint param_3,uint param_4,uint param_5)

{
  char cVar1;
  uint uVar2;
  undefined4 uVar3;
  undefined4 extraout_var;
  ulonglong uVar4;
  undefined4 extraout_var_00;
  undefined8 uVar5;
  ulonglong uVar6;
  DWORD dwErrCode;
  ulonglong uVar7;
  undefined **local_38;
  undefined8 local_30;
  undefined4 uStackY40;
  undefined4 uStackY36;
  undefined4 local_20;
  undefined4 local_1c;
  
                    // 0x4a070  897  IsCalendarLeapDay
  if (param_1 < 9) {
    if (param_1 == 8) {
      local_30 = 0x18004fbb3;
      uVar5 = FUN_18004fd80(param_2,param_3,param_4,param_5);
      if ((int)uVar5 == 0) {
LAB_18004fbf3:
        uVar4 = 0;
      }
      else {
        local_30 = 0x18004fbc0;
        SetLastError(0);
        local_30 = 0x18004fbd1;
        uVar4 = FUN_18004fc14(param_3,param_4,param_5);
        if ((int)uVar4 == 0) {
          local_30 = 0x18004fbde;
          uVar4 = FUN_18004fc7c(param_4,param_5);
          if ((((int)uVar4 == 0) || (param_3 != 6)) || (param_2 != 0x1e)) goto LAB_18004fbf3;
        }
        uVar4 = 1;
      }
      return uVar4;
    }
    if (param_1 != 0) {
      if (param_1 < 3) goto LAB_18004a133;
      if (param_1 < 6) {
LAB_18004e64c:
        uVar4 = FUN_18004e728(param_1,10,param_3,param_4,param_5);
        if ((int)uVar4 != 0) {
          uVar2 = FUN_18004e4d0(param_1,param_4,param_5);
          uVar3 = FUN_18004df08(param_2,param_3,uVar2,1);
          uVar4 = CONCAT44(extraout_var_00,uVar3);
        }
        return uVar4;
      }
      if (param_1 == 6) {
        local_30 = 0x18005180c;
        uVar4 = FUN_180051958(param_2,param_3,param_4,param_5);
        uVar7 = 0;
        if ((int)uVar4 != 0) {
          local_30 = 0x18005181b;
          SetLastError(0);
          local_30 = 0x18005182a;
          uVar6 = FUN_180051860(param_4,param_5);
          uVar4 = uVar7;
          if ((((int)uVar6 != 0) && (param_3 == 0xc)) && (param_2 == 0x1e)) {
            uVar4 = 1;
          }
        }
        return uVar4;
      }
      if (param_1 == 7) goto LAB_18004e64c;
    }
  }
  else {
    if (param_1 < 0xd) {
LAB_18004a133:
      uVar3 = FUN_18004df08(param_2,param_3,param_4,param_5);
      return CONCAT44(extraout_var,uVar3);
    }
    if (param_1 == 0x16) {
      local_38 = &PTR_FUN_180080460;
      local_20 = 0x3764f;
      uVar2 = 0;
      local_1c = 0x37b9da;
      cVar1 = '\0';
      local_30 = 0x100000001;
      uStackY40 = 1;
      uStackY36 = 1;
      FUN_1800533d0((longlong *)&local_38,param_5);
      FUN_180053490((longlong *)&local_38,param_4);
      FUN_180053430((longlong *)&local_38,param_3);
      FUN_180053380((longlong *)&local_38,param_2);
      if (cVar1 == '\0') {
        cVar1 = (*(code *)local_38[0x19])();
        if (((cVar1 != '\0') && (param_3 == 0xc)) && (param_2 == 0x1e)) {
          uVar2 = 1;
        }
      }
      else {
        SetLastError(0x57);
        uVar2 = 0;
      }
      return (ulonglong)uVar2;
    }
    if (param_1 == 0x17) {
      uVar5 = FUN_18004f05c(param_2,param_3,param_4,param_5);
      if ((int)uVar5 == 0) {
        return 0;
      }
      dwErrCode = 0;
      goto LAB_18004a107;
    }
  }
  dwErrCode = 0x57;
LAB_18004a107:
  SetLastError(dwErrCode);
  return 0;
}



ulonglong IsCalendarLeapMonth(uint param_1,uint param_2,uint param_3,uint param_4)

{
  int iVar1;
  ulonglong uVar2;
  DWORD dwErrCode;
  undefined **local_38;
  undefined4 local_30;
  undefined4 uStackY44;
  undefined4 uStackY40;
  undefined4 uStackY36;
  undefined4 local_20;
  undefined4 local_1c;
  char cVar4;
  undefined8 uVar3;
  
                    // 0x4a150  898  IsCalendarLeapMonth
  if (param_1 < 9) {
    if (param_1 == 8) {
      uVar2 = FUN_18004fc14(param_2,param_3,param_4);
      return uVar2;
    }
    if (param_1 != 0) {
      if (param_1 < 3) goto LAB_18004a206;
      if (param_1 < 6) {
LAB_18004a186:
        uVar2 = FUN_18004e728(param_1,10,param_2,param_3,param_4);
        if ((int)uVar2 == 0) {
          return 0;
        }
        RtlSetLastWin32Error(0);
        return 0;
      }
      if (param_1 == 6) {
        uVar3 = FUN_1800519a8(param_2,param_3,param_4);
        iVar1 = (int)uVar3;
        goto LAB_18004a1bf;
      }
      if (param_1 == 7) goto LAB_18004a186;
    }
  }
  else if (param_1 < 0xd) {
LAB_18004a206:
    uVar3 = FUN_1800084e0(param_3,param_4);
    if ((int)uVar3 == 0) {
      return 0;
    }
    if (param_2 - 1 < 0xc) {
LAB_18004a1c3:
      dwErrCode = 0;
      goto LAB_18004a221;
    }
  }
  else {
    if (param_1 == 0x16) {
      local_20 = 0x3764f;
      local_1c = 0x37b9da;
      cVar4 = '\0';
      local_38 = &PTR_FUN_180080460;
      local_30 = 1;
      uStackY44 = 1;
      uStackY40 = 1;
      uStackY36 = 1;
      FUN_1800533d0((longlong *)&local_38,param_4);
      FUN_180053490((longlong *)&local_38,param_3);
      FUN_180053430((longlong *)&local_38,param_2);
      if (cVar4 != '\0') {
        SetLastError(0x57);
      }
      return 0;
    }
    if (param_1 == 0x17) {
      uVar3 = FUN_18004f0ac(param_2,param_3,param_4);
      iVar1 = (int)uVar3;
LAB_18004a1bf:
      if (iVar1 == 0) {
        return 0;
      }
      goto LAB_18004a1c3;
    }
  }
  dwErrCode = 0x57;
LAB_18004a221:
  SetLastError(dwErrCode);
  return 0;
}



ulonglong IsCalendarLeapYear(uint param_1,uint param_2,uint param_3)

{
  bool bVar1;
  int iVar2;
  ulonglong uVar3;
  undefined8 uVar4;
  undefined7 extraout_var;
  
                    // 0x4a240  899  IsCalendarLeapYear
  if (param_1 < 9) {
    if (param_1 == 8) {
      uVar3 = FUN_18004fc7c(param_2,param_3);
      return uVar3;
    }
    if (param_1 != 0) {
      if (2 < param_1) {
        if (5 < param_1) {
          if (param_1 == 6) {
            uVar3 = FUN_180051860(param_2,param_3);
            return uVar3;
          }
          if (param_1 != 7) goto LAB_18004a26f;
        }
        uVar3 = FUN_18004e6c8(param_1,param_2,param_3);
        return uVar3;
      }
LAB_18004a2ef:
      uVar3 = FUN_18000846c(param_2,param_3);
      return uVar3;
    }
  }
  else {
    if (param_1 < 0xd) goto LAB_18004a2ef;
    if (param_1 == 0x16) {
      bVar1 = FUN_180050fac(param_2,param_3);
      return CONCAT71(extraout_var,bVar1);
    }
    if (param_1 == 0x17) {
      uVar4 = FUN_18004f0f4(param_2,param_3);
      if ((int)uVar4 == 0) {
        return 0;
      }
      SetLastError(0);
      iVar2 = FUN_18004edd4(param_2);
      return (ulonglong)(iVar2 == 0x163);
    }
  }
LAB_18004a26f:
  SetLastError(0x57);
  return 0;
}



BOOL EnumCalendarInfoA(CALINFO_ENUMPROCA lpCalInfoEnumProc,LCID Locale,CALID Calendar,
                      CALTYPE CalType)

{
  BOOL BVar1;
  undefined8 uVar2;
  undefined4 in_register_00000084;
  LCID local_res10 [2];
  
                    // 0x4a310  316  EnumCalendarInfoA
  local_res10[0] = Locale;
  uVar2 = NlsValidateLocale(local_res10,0,CONCAT44(in_register_00000084,Calendar));
  if (((CalType >> 0x1c & 1) == 0) && ((CalType & 0xfffffff) < 0x38)) {
    BVar1 = Internal_EnumCalendarInfo(lpCalInfoEnumProc,uVar2,Calendar,CalType,0,0,0,0);
  }
  else {
    SetLastError(0x3ec);
    BVar1 = 0;
  }
  return BVar1;
}



BOOL EnumCalendarInfoExA(CALINFO_ENUMPROCEXA lpCalInfoEnumProcEx,LCID Locale,CALID Calendar,
                        CALTYPE CalType)

{
  BOOL BVar1;
  undefined8 uVar2;
  undefined4 in_register_00000084;
  LCID local_res10 [2];
  
                    // 0x4a3b0  317  EnumCalendarInfoExA
  local_res10[0] = Locale;
  uVar2 = NlsValidateLocale(local_res10,0,CONCAT44(in_register_00000084,Calendar));
  if (((CalType >> 0x1c & 1) == 0) && ((CalType & 0xfffffff) < 0x38)) {
    BVar1 = Internal_EnumCalendarInfo(lpCalInfoEnumProcEx,uVar2,Calendar,CalType,0,1,0,0);
  }
  else {
    SetLastError(0x3ec);
    BVar1 = 0;
  }
  return BVar1;
}



BOOL EnumDateFormatsA(DATEFMT_ENUMPROCA lpDateFmtEnumProc,LCID Locale,DWORD dwFlags)

{
  undefined8 uVar1;
  BOOL BVar2;
  undefined4 in_register_00000084;
  LCID local_res10 [6];
  
                    // 0x4a450  321  EnumDateFormatsA
  local_res10[0] = Locale;
  uVar1 = NlsValidateLocale(local_res10,0,CONCAT44(in_register_00000084,dwFlags));
  BVar2 = Internal_EnumDateFormats(lpDateFmtEnumProc,uVar1,dwFlags,0,0,0,0);
  return BVar2;
}



BOOL EnumDateFormatsExA(DATEFMT_ENUMPROCEXA lpDateFmtEnumProcEx,LCID Locale,DWORD dwFlags)

{
  undefined8 uVar1;
  BOOL BVar2;
  undefined4 in_register_00000084;
  LCID local_res10 [6];
  
                    // 0x4a4b0  322  EnumDateFormatsExA
  local_res10[0] = Locale;
  uVar1 = NlsValidateLocale(local_res10,0,CONCAT44(in_register_00000084,dwFlags));
  BVar2 = Internal_EnumDateFormats(lpDateFmtEnumProcEx,uVar1,dwFlags,0,1,0,0);
  return BVar2;
}



BOOL EnumLanguageGroupLocalesA
               (LANGGROUPLOCALE_ENUMPROCA lpLangGroupLocaleEnumProc,LGRPID LanguageGroup,
               DWORD dwFlags,LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // 0x4a520  326  EnumLanguageGroupLocalesA
  BVar1 = Internal_EnumLanguageGroupLocales();
  return BVar1;
}



BOOL EnumSystemCodePagesA(CODEPAGE_ENUMPROCA lpCodePageEnumProc,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // 0x4a550  340  EnumSystemCodePagesA
                    // WARNING: Could not recover jumptable at 0x00018004a553. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = Internal_EnumSystemCodePages(lpCodePageEnumProc,dwFlags,0);
  return BVar1;
}



BOOL EnumSystemLanguageGroupsA
               (LANGUAGEGROUP_ENUMPROCA lpLanguageGroupEnumProc,DWORD dwFlags,LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // 0x4a570  345  EnumSystemLanguageGroupsA
                    // WARNING: Could not recover jumptable at 0x00018004a573. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = Internal_EnumSystemLanguageGroups();
  return BVar1;
}



BOOL EnumTimeFormatsA(TIMEFMT_ENUMPROCA lpTimeFmtEnumProc,LCID Locale,DWORD dwFlags)

{
  BOOL BVar1;
  undefined8 uVar2;
  LCID local_res10 [6];
  
                    // 0x4a590  350  EnumTimeFormatsA
  local_res10[0] = Locale;
  uVar2 = NlsValidateLocale(local_res10,0);
  if ((dwFlags & 2) == 0) {
    BVar1 = Internal_EnumTimeFormats(lpTimeFmtEnumProc,uVar2,dwFlags,0,0,0);
  }
  else {
    SetLastError(0x3ec);
    BVar1 = 0;
  }
  return BVar1;
}



BOOL EnumUILanguagesA(UILANGUAGE_ENUMPROCA lpUILanguageEnumProc,DWORD dwFlags,LONG_PTR lParam)

{
  BOOL BVar1;
  
                    // 0x4a610  353  EnumUILanguagesA
                    // WARNING: Could not recover jumptable at 0x00018004a613. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = Internal_EnumUILanguages();
  return BVar1;
}



int FoldStringA(DWORD dwMapFlags,LPCSTR lpSrcStr,int cchSrc,LPSTR lpDestStr,int cchDest)

{
  UINT UVar1;
  DWORD DVar2;
  int cchDest_00;
  int extraout_EAX;
  undefined8 uVar3;
  WCHAR *lpDestStr_00;
  WCHAR *lpSrcStr_00;
  int cchSrc_00;
  longlong in_GS_OFFSET;
  undefined auStackY680 [32];
  WCHAR *local_268;
  int local_260 [2];
  WCHAR local_258 [128];
  WCHAR local_158 [128];
  ulonglong local_58;
  
                    // 0x4a630  429  FoldStringA
  local_58 = DAT_1800b2220 ^ (ulonglong)auStackY680;
  if ((cchDest < 0) || (((cchDest != 0 && (lpDestStr == (LPSTR)0x0)) || (lpSrcStr == lpDestStr)))) {
    DVar2 = 0x57;
LAB_18004a89b:
    SetLastError(DVar2);
  }
  else {
    memset(local_258,0,0x100);
    local_268 = local_258;
    UVar1 = GetACP();
    uVar3 = FUN_18001b10c(UVar1,lpSrcStr,(ulonglong)(uint)cchSrc,&local_268,local_260);
    if ((int)uVar3 != 0) {
      lpDestStr_00 = local_158;
      cchDest_00 = 0x80;
      lpSrcStr_00 = local_268;
      cchSrc_00 = local_260[0];
      do {
        while( true ) {
          cchDest_00 = FoldStringW(dwMapFlags,lpSrcStr_00,cchSrc_00,lpDestStr_00,cchDest_00);
          if (((cchDest_00 != 0) || (DVar2 = GetLastError(), DVar2 != 0x7a)) ||
             (lpDestStr_00 != local_158)) goto LAB_18004a7be;
          SetLastError(0);
          cchDest_00 = FoldStringW(dwMapFlags,lpSrcStr_00,cchSrc_00,(LPWSTR)0x0,0);
          if (cchDest_00 == 0) break;
          lpDestStr_00 = (WCHAR *)RtlAllocateHeap(*(undefined8 *)
                                                   (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8);
          lpSrcStr_00 = local_268;
          cchSrc_00 = local_260[0];
          if (lpDestStr_00 == (LPWSTR)0x0) {
            if ((local_268 != local_258) && (local_268 != (WCHAR *)0x0)) {
              RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_268);
            }
            DVar2 = 0xe;
            goto LAB_18004a89b;
          }
        }
        DVar2 = GetLastError();
      } while (DVar2 == 0);
LAB_18004a7be:
      if ((lpSrcStr_00 != local_258) && (lpSrcStr_00 != (LPCWSTR)0x0)) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_268);
      }
      if (0 < cchDest_00) {
        UVar1 = GetACP();
        WideCharToMultiByte(UVar1,0,lpDestStr_00,cchDest_00,lpDestStr,cchDest,(LPCSTR)0x0,
                            (LPBOOL)0x0);
      }
      if ((lpDestStr_00 != local_158) && (lpDestStr_00 != (LPWSTR)0x0)) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpDestStr_00);
      }
    }
  }
  __security_check_cookie(local_58 ^ (ulonglong)auStackY680);
  return extraout_EAX;
}



BOOL GetCPInfoExA(UINT CodePage,DWORD dwFlags,LPCPINFOEXA lpCPInfoEx)

{
  BOOL BVar1;
  UINT CodePage_00;
  int iVar2;
  BOOL extraout_EAX;
  undefined auStackY632 [32];
  undefined local_238 [8];
  undefined4 uStack560;
  undefined4 uStack556;
  undefined8 local_228;
  WCHAR local_220 [260];
  ulonglong local_18;
  
                    // 0x4a8e0  460  GetCPInfoExA
  local_18 = DAT_1800b2220 ^ (ulonglong)auStackY632;
  if (lpCPInfoEx == (LPCPINFOEXA)0x0) {
    SetLastError(0x57);
  }
  else {
    BVar1 = GetCPInfoExW(CodePage,dwFlags,(LPCPINFOEXW)local_238);
    if (BVar1 == 1) {
      CodePage_00 = GetACP();
      iVar2 = WideCharToMultiByte(CodePage_00,0,local_220,-1,lpCPInfoEx->CodePageName,0x104,
                                  (LPCSTR)0x0,(LPBOOL)0x0);
      if (iVar2 == 0) goto LAB_18004a98e;
    }
    lpCPInfoEx->MaxCharSize = local_238._0_4_;
    *(undefined4 *)lpCPInfoEx->DefaultChar = local_238._4_4_;
    *(undefined4 *)(lpCPInfoEx->LeadByte + 2) = uStack560;
    *(undefined4 *)(lpCPInfoEx->LeadByte + 6) = uStack556;
    *(undefined8 *)(lpCPInfoEx->LeadByte + 10) = local_228;
  }
LAB_18004a98e:
  __security_check_cookie(local_18 ^ (ulonglong)auStackY632);
  return extraout_EAX;
}



int GetCalendarInfoA(LCID Locale,CALID Calendar,CALTYPE CalType,LPSTR lpCalData,int cchData,
                    LPDWORD lpValue)

{
  int extraout_EAX;
  int cchWideChar;
  DWORD DVar1;
  uint uVar2;
  UINT CodePage;
  WCHAR *lpWideCharStr;
  longlong in_GS_OFFSET;
  undefined auStackY424 [32];
  WCHAR local_158 [128];
  ulonglong local_58;
  
                    // 0x4a9c0  467  GetCalendarInfoA
  local_58 = DAT_1800b2220 ^ (ulonglong)auStackY424;
  if ((cchData < 0) || ((lpCalData == (LPSTR)0x0 && (cchData != 0)))) goto LAB_18004aa47;
  if (((CalType >> 0x1c & 1) != 0) || (0x37 < (CalType & 0xfffffff))) {
    DVar1 = 0x3ec;
    goto LAB_18004aa4c;
  }
  if ((CalType & 0x20000000) == 0) {
    if ((lpValue == (LPDWORD)0x0) && ((lpCalData != (LPSTR)0x0 || (cchData == 0))))
    goto LAB_18004aa8e;
  }
  else if ((lpCalData == (LPSTR)0x0) && ((cchData == 0 && (lpValue != (LPDWORD)0x0)))) {
LAB_18004aa8e:
    lpWideCharStr = local_158;
    uVar2 = 0x80;
    do {
      cchWideChar = GetCalendarInfoW(Locale,Calendar,CalType,
                                     (LPWSTR)(-(ulonglong)(lpCalData != (LPSTR)0x0) &
                                             (ulonglong)lpWideCharStr),
                                     -(uint)(lpCalData != (LPSTR)0x0) & uVar2,lpValue);
      if (cchWideChar != 0) {
        if ((0 < cchWideChar) && ((CalType & 0x20000000) == 0)) {
          CodePage = FUN_18001b2a0(Locale,(ulonglong)CalType);
          if (CodePage == 0) {
            SetLastError(0x57);
          }
          else {
            WideCharToMultiByte(CodePage,0,lpWideCharStr,cchWideChar,lpCalData,cchData,(LPCSTR)0x0,
                                (LPBOOL)0x0);
          }
        }
LAB_18004abd9:
        if (lpWideCharStr != local_158) {
LAB_18004abe3:
          if (lpWideCharStr != (LPCWSTR)0x0) {
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpWideCharStr);
          }
        }
        goto LAB_18004aa5a;
      }
      if ((lpValue != (LPDWORD)0x0) || (DVar1 = GetLastError(), DVar1 != 0x7a)) goto LAB_18004abd9;
      if (lpWideCharStr != local_158) goto LAB_18004abe3;
      SetLastError(0);
      uVar2 = GetCalendarInfoW(Locale,Calendar,CalType,(LPWSTR)0x0,0,(LPDWORD)0x0);
    } while ((uVar2 == 0) ||
            (lpWideCharStr = (WCHAR *)RtlAllocateHeap(), lpWideCharStr != (LPCWSTR)0x0));
    DVar1 = 0xe;
    goto LAB_18004aa4c;
  }
LAB_18004aa47:
  DVar1 = 0x57;
LAB_18004aa4c:
  SetLastError(DVar1);
LAB_18004aa5a:
  __security_check_cookie(local_58 ^ (ulonglong)auStackY424);
  return extraout_EAX;
}



// WARNING: Could not reconcile some variable overlaps

int GetCurrencyFormatA(LCID Locale,DWORD dwFlags,LPCSTR lpValue,CURRENCYFMTA *lpFormat,
                      LPSTR lpCurrencyStr,int cchCurrency)

{
  UINT CodePage;
  int iVar1;
  DWORD DVar2;
  int extraout_EAX;
  undefined8 uVar3;
  LPWSTR lpWideCharStr;
  undefined4 in_register_00000014;
  CURRENCYFMTW *pCVar4;
  longlong lVar5;
  LPCWSTR pWVar6;
  longlong in_GS_OFFSET;
  undefined auStackY744 [32];
  int local_2a8 [2];
  LPCWSTR local_2a0;
  DWORD local_298;
  LCID local_294;
  undefined local_290 [16];
  undefined local_280 [8];
  LPWSTR pWStack632;
  UINT local_270;
  UINT UStack620;
  LPWSTR pWStack616;
  LPSTR local_260;
  WCHAR local_258 [128];
  WCHAR local_158 [128];
  ulonglong local_58;
  
                    // 0x4ac20  530  GetCurrencyFormatA
  local_58 = DAT_1800b2220 ^ (ulonglong)auStackY744;
  pCVar4 = (CURRENCYFMTW *)0x0;
  local_260 = lpCurrencyStr;
  local_298 = dwFlags;
  local_294 = Locale;
  CodePage = FUN_18001b2a0(Locale,CONCAT44(in_register_00000014,dwFlags));
  if ((((CodePage == 0) || (cchCurrency < 0)) ||
      ((lpCurrencyStr == (LPSTR)0x0 && (cchCurrency != 0)))) || (lpValue == lpCurrencyStr)) {
    SetLastError(0x57);
  }
  else {
    local_2a0 = local_258;
    uVar3 = FUN_18001b10c(CodePage,lpValue,0xffffffff,&local_2a0,local_2a8);
    if ((int)uVar3 != 0) {
      if (lpFormat != (CURRENCYFMTA *)0x0) {
        local_290._0_4_ = lpFormat->NumDigits;
        local_290._4_4_ = lpFormat->LeadingZero;
        local_290._8_4_ = lpFormat->Grouping;
        local_290._12_4_ = *(undefined4 *)&lpFormat->field_0xc;
        local_270 = lpFormat->NegativeOrder;
        UStack620 = lpFormat->PositiveOrder;
        _local_280 = ZEXT816(0);
        pWStack616 = (LPWSTR)0x0;
        uVar3 = FUN_18001b10c(CodePage,lpFormat->lpDecimalSep,0xffffffff,(LPWSTR *)local_280,
                              local_2a8);
        if ((((int)uVar3 == 0) ||
            (uVar3 = FUN_18001b10c(CodePage,lpFormat->lpThousandSep,0xffffffff,
                                   (LPWSTR *)(local_280 + 8),local_2a8), (int)uVar3 == 0)) ||
           (uVar3 = FUN_18001b10c(CodePage,lpFormat->lpCurrencySymbol,0xffffffff,&pWStack616,
                                  local_2a8), (int)uVar3 == 0)) {
          if ((local_2a0 != local_258) && (local_2a0 != (LPCWSTR)0x0)) {
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_2a0);
          }
          if (local_280 != (LPWSTR)0x0) {
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_280);
          }
          if (pWStack632 != (LPWSTR)0x0) {
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pWStack632);
          }
          goto LAB_18004afee;
        }
        pCVar4 = (CURRENCYFMTW *)local_290;
      }
      lpWideCharStr = local_158;
      lVar5 = 0x80;
      pWVar6 = local_2a0;
      do {
        iVar1 = FUN_18004b85c((ulonglong)local_294,local_298,pWVar6,pCVar4,lpWideCharStr,(int)lVar5)
        ;
        if (((iVar1 != 0) || (DVar2 = GetLastError(), DVar2 != 0x7a)) ||
           (lpWideCharStr != local_158)) goto LAB_18004ae42;
        SetLastError(0);
        iVar1 = FUN_18004b85c((ulonglong)local_294,local_298,pWVar6,pCVar4,(LPWSTR)0x0,0);
        lVar5 = (longlong)iVar1;
      } while ((iVar1 == 0) ||
              (lpWideCharStr =
                    (LPWSTR)RtlAllocateHeap(*(undefined8 *)
                                             (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,lVar5 * 2
                                           ), pWVar6 = local_2a0, lpWideCharStr != (LPWSTR)0x0));
      SetLastError(0xe);
      iVar1 = 0;
      pWVar6 = local_2a0;
LAB_18004ae42:
      if ((pWVar6 != local_258) && (pWVar6 != (LPCWSTR)0x0)) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_2a0);
      }
      if (lpFormat != (CURRENCYFMTA *)0x0) {
        if (local_280 != (LPWSTR)0x0) {
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_280);
        }
        if (pWStack632 != (LPWSTR)0x0) {
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pWStack632);
        }
        if (pWStack616 != (LPWSTR)0x0) {
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pWStack616);
        }
      }
      if (0 < iVar1) {
        WideCharToMultiByte(CodePage,0,lpWideCharStr,iVar1,local_260,cchCurrency,(LPCSTR)0x0,
                            (LPBOOL)0x0);
      }
      if ((lpWideCharStr != local_158) && (lpWideCharStr != (LPCWSTR)0x0)) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpWideCharStr);
      }
    }
  }
LAB_18004afee:
  __security_check_cookie(local_58 ^ (ulonglong)auStackY744);
  return extraout_EAX;
}



int GetGeoInfoA(GEOID Location,GEOTYPE GeoType,LPSTR lpGeoData,int cchData,LANGID LangId)

{
  int cchWideChar;
  int extraout_EAX;
  undefined auStackY280 [32];
  WCHAR local_d8 [80];
  ulonglong local_38;
  
                    // 0x4b020  613  GetGeoInfoA
  local_38 = DAT_1800b2220 ^ (ulonglong)auStackY280;
  memset(local_d8,0,0xa0);
  if ((lpGeoData == (LPSTR)0x0) && (0 < cchData)) {
    SetLastError(0x57);
  }
  else {
    cchWideChar = GetGeoInfoW(Location,GeoType,local_d8,0x50,LangId);
    if (cchWideChar != 0) {
      WideCharToMultiByte(0,0,local_d8,cchWideChar,lpGeoData,cchData,(LPCSTR)0x0,(LPBOOL)0x0);
    }
  }
  __security_check_cookie(local_38 ^ (ulonglong)auStackY280);
  return extraout_EAX;
}



BOOL SetCalendarInfoA(LCID Locale,CALID Calendar,CALTYPE CalType,LPCSTR lpCalData)

{
  LPCWSTR pWVar1;
  UINT UVar2;
  BOOL extraout_EAX;
  undefined8 uVar3;
  longlong in_GS_OFFSET;
  undefined auStackY376 [32];
  WCHAR *local_148;
  int local_140 [2];
  WCHAR local_138 [128];
  ulonglong local_38;
  
                    // 0x4b0f0  1259  SetCalendarInfoA
  local_38 = DAT_1800b2220 ^ (ulonglong)auStackY376;
  UVar2 = FUN_18001b2a0(Locale,(ulonglong)CalType);
  if (UVar2 == 0) {
    SetLastError(0x57);
  }
  else {
    local_148 = local_138;
    uVar3 = FUN_18001b10c(UVar2,lpCalData,0xffffffff,&local_148,local_140);
    pWVar1 = local_148;
    if ((((int)uVar3 != 0) &&
        (SetCalendarInfoW(Locale,Calendar,CalType,local_148), pWVar1 != local_138)) &&
       (pWVar1 != (LPCWSTR)0x0)) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_148);
    }
  }
  __security_check_cookie(local_38 ^ (ulonglong)auStackY376);
  return extraout_EAX;
}



BOOL SetLocaleInfoA(LCID Locale,LCTYPE LCType,LPCSTR lpLCData)

{
  LPCWSTR pWVar1;
  UINT UVar2;
  BOOL extraout_EAX;
  undefined8 uVar3;
  DWORD dwErrCode;
  undefined4 in_register_00000014;
  longlong in_GS_OFFSET;
  undefined auStackY360 [32];
  WCHAR *local_138;
  int local_130 [2];
  WCHAR local_128 [128];
  ulonglong local_28;
  
                    // 0x4b1e0  1350  SetLocaleInfoA
  local_28 = DAT_1800b2220 ^ (ulonglong)auStackY360;
  UVar2 = FUN_18001b2a0(Locale,CONCAT44(in_register_00000014,LCType));
  if (UVar2 == 0) {
    dwErrCode = 0x57;
  }
  else {
    local_138 = local_128;
    uVar3 = FUN_18001b10c(UVar2,lpLCData,0xffffffff,&local_138,local_130);
    pWVar1 = local_138;
    if ((int)uVar3 == 0) goto LAB_18004b2b1;
    if (0xf8f < (LCType & 0xfffffff) - 0x70) {
      SetLocaleInfoW(Locale,LCType,local_138);
      if ((pWVar1 != local_128) && (pWVar1 != (LPCWSTR)0x0)) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_138);
      }
      goto LAB_18004b2b1;
    }
    dwErrCode = 0x3ec;
  }
  SetLastError(dwErrCode);
LAB_18004b2b1:
  __security_check_cookie(local_28 ^ (ulonglong)auStackY360);
  return extraout_EAX;
}



ushort FUN_18004b2d4(longlong *param_1,short *param_2,uint param_3,longlong param_4,longlong param_5
                    ,ushort param_6,ushort param_7,ushort param_8)

{
  ushort uVar1;
  ushort *puVar2;
  longlong lVar3;
  ushort uVar4;
  ushort uVar5;
  bool bVar6;
  
  *param_1 = 0;
  if (param_2 != (short *)0x0) {
    *param_2 = 1;
  }
  if (2 < param_3) {
    if (param_3 < 5) {
      puVar2 = (ushort *)GetPtrCalDataArray(param_3,param_5,*(undefined4 *)(param_4 + 0x14));
      uVar1 = *puVar2;
      if (uVar1 != 0) {
        uVar4 = 0;
        while( true ) {
          uVar5 = uVar4 + 1;
          lVar3 = GetPtrCalData(param_3,param_5,puVar2 + 1,uVar5);
          bVar6 = param_6 != *(ushort *)(lVar3 + 4);
          if (*(ushort *)(lVar3 + 4) <= param_6 && bVar6) break;
          if (((!bVar6) &&
              ((bVar6 = param_7 != *(ushort *)(lVar3 + 6),
               *(ushort *)(lVar3 + 6) <= param_7 && bVar6 ||
               ((!bVar6 && (*(ushort *)(lVar3 + 8) <= param_8)))))) ||
             (uVar4 = uVar5, uVar1 <= uVar5)) break;
        }
        if (uVar4 < uVar1) {
          param_6 = param_6 - *(short *)(lVar3 + 10);
          *param_1 = lVar3;
          if (param_2 != (short *)0x0) {
            *param_2 = uVar1 - uVar4;
          }
        }
      }
    }
    else if ((param_3 - 5 & 0xfffffffd) == 0) {
      lVar3 = param_5 + (ulonglong)*(uint *)(param_5 + 2 + (ulonglong)*(uint *)(param_4 + 0x14) * 2)
                        * 2;
      param_6 = param_6 - *(short *)(lVar3 + 10);
      *param_1 = lVar3;
    }
  }
  return param_6;
}



bool FUN_18004b42c(ushort *param_1,undefined4 *param_2)

{
  undefined8 uVar1;
  ulonglong uVar2;
  bool bVar3;
  undefined4 local_38;
  int local_34;
  int local_30;
  ushort local_2c;
  ushort local_28;
  
  uVar1 = FUN_18004f5b4(param_1,&local_38);
  bVar3 = (int)uVar1 != 0;
  if (bVar3) {
    param_1[1] = local_2c;
    param_1[3] = local_28;
    *param_1 = (ushort)local_30;
    uVar2 = FUN_18004fc7c(local_30,local_34);
    *param_2 = (int)uVar2;
  }
  return bVar3;
}



bool FUN_18004b48c(undefined2 *param_1)

{
  int iVar1;
  undefined local_38 [8];
  undefined2 local_30;
  undefined2 local_2c;
  undefined2 local_28;
  
  iVar1 = FUN_180050990(param_1,(longlong)local_38);
  if (iVar1 != 0) {
    *param_1 = local_30;
    param_1[1] = local_2c;
    param_1[3] = local_28;
  }
  return iVar1 != 0;
}



undefined8 FUN_18004b4d4(ushort *param_1)

{
  int iVar1;
  undefined8 uVar2;
  undefined4 local_38 [2];
  ushort local_30;
  ushort local_2c;
  ushort local_28;
  
  iVar1 = FUN_18000751c(param_1,1,local_38);
  if ((iVar1 != 0) && (uVar2 = FUN_18004ee0c(local_38), (int)uVar2 != 0)) {
    *param_1 = local_30;
    param_1[1] = local_2c;
    param_1[3] = local_28;
    return 1;
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18004b530(void)

{
  int iVar1;
  undefined auStackY88 [32];
  WCHAR local_18 [4];
  ulonglong local_10;
  
  local_10 = DAT_1800b2220 ^ (ulonglong)auStackY88;
  if (_DAT_1800b2f44 == 0) {
    iVar1 = GetCalendarInfoEx(L"ja-JP",3,(LPCWSTR)0x0,0x3d,local_18,3,(LPDWORD)0x0);
    DAT_1800b2f48 = 0;
    if ((iVar1 != 0) && (local_18[0] == L'1')) {
      DAT_1800b2f48 = 1;
    }
    _DAT_1800b2f44 = 1;
  }
  __security_check_cookie(local_10 ^ (ulonglong)auStackY88);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18004b5c0(uint param_1,undefined2 *param_2)

{
  longlong lVar1;
  short sVar2;
  ushort uVar3;
  short sVar4;
  uint uVar5;
  int iVar6;
  short sVar7;
  ushort uVar8;
  uint uVar9;
  longlong lVar10;
  short sVar11;
  int iVar12;
  ulonglong uVar13;
  undefined2 *puVar14;
  short *psVar15;
  undefined auStack88 [32];
  short local_38;
  undefined8 local_30;
  undefined local_28 [2];
  undefined auStack38 [14];
  undefined4 local_18;
  ulonglong local_10;
  
  local_10 = DAT_1800b2220 ^ (ulonglong)auStack88;
  uVar13 = (ulonglong)(param_1 - 5000);
  if (param_1 < 0x1389) {
    uVar13 = (ulonglong)param_1;
  }
  local_30 = 0;
  uVar5 = (uint)(uVar13 / 100);
  if (uVar13 / 100 == 0) goto LAB_18004b67e;
  uVar13 = (ulonglong)((int)uVar13 + uVar5 * -100);
  if (uVar5 < 4) {
    local_30._4_2_ = 0;
    uVar9 = uVar5;
LAB_18004b642:
    uVar3 = 0;
  }
  else {
    local_30._4_2_ = 0x5ea;
    local_30 = 0x5ea00000000;
    uVar9 = uVar5 - 4;
    if (uVar5 - 4 < 4) goto LAB_18004b642;
    uVar9 = uVar5 - 8;
    local_30 = 0x5ea05ea0000;
    uVar3 = local_30._4_2_;
  }
  if (uVar9 != 0) {
    uVar8 = (short)uVar9 + 0x5e6;
    if (uVar3 == 0) {
      local_30 = local_30 & 0xffffffff00000000 | (ulonglong)uVar8 << 0x10;
      uVar3 = uVar8;
    }
    else {
      local_30 = local_30 | uVar8;
    }
  }
  if (uVar3 == 0) {
    local_30 = local_30 & 0xffffffffffff0000 | (ulonglong)local_30._4_2_;
  }
  else if ((short)local_30 == 0) {
    local_30._0_4_ = CONCAT22(local_30._4_2_,uVar3);
    local_30 = (ulonglong)(uint)local_30;
  }
LAB_18004b67e:
  iVar12 = (int)uVar13;
  iVar6 = (int)(uVar13 / 10);
  if (uVar13 / 10 == 0) {
    sVar7 = 0;
  }
  else {
    iVar12 = iVar12 + iVar6 * -10;
    if (iVar6 == 1) {
      sVar7 = 0x5d9;
    }
    else if (iVar6 == 2) {
      sVar7 = 0x5db;
    }
    else if (iVar6 == 3) {
      sVar7 = 0x5dc;
    }
    else if (iVar6 == 4) {
      sVar7 = 0x5de;
    }
    else if (iVar6 == 5) {
      sVar7 = 0x5e0;
    }
    else if (iVar6 == 6) {
      sVar7 = 0x5e1;
    }
    else if (iVar6 == 7) {
      sVar7 = 0x5e2;
    }
    else if (iVar6 == 8) {
      sVar7 = 0x5e4;
    }
    else {
      sVar7 = 0x5e6;
      if (iVar6 != 9) {
        sVar7 = local_38;
      }
    }
  }
  if (iVar12 == 0) {
    sVar11 = 0;
  }
  else {
    sVar11 = (short)iVar12 + 0x5cf;
  }
  sVar4 = sVar11;
  sVar2 = sVar7;
  if ((((sVar11 != 0x5d4) || (sVar4 = 0x5d5, sVar2 = 0x5d8, sVar7 == 0x5d9)) &&
      (sVar7 = sVar2, sVar11 = sVar4, sVar11 == 0x5d5)) && (sVar7 == 0x5d9)) {
    sVar11 = 0x5d6;
    sVar7 = 0x5d8;
  }
  local_18 = 0;
  sVar4 = 0;
  if (sVar11 != 0) {
    sVar4 = sVar11;
  }
  _local_28 = CONCAT142(SUB1614(ZEXT816(0) >> 0x10,0),sVar4);
  psVar15 = (short *)local_28;
  if (sVar11 != 0) {
    psVar15 = (short *)(local_28 + 2);
  }
  if (sVar7 != 0) {
    *psVar15 = sVar7;
    psVar15 = psVar15 + 1;
  }
  uVar5 = FUN_18000b370(psVar15,9 - ((longlong)psVar15 - (longlong)local_28 >> 1),
                        (longlong)&local_30);
  if (-1 < (int)uVar5) {
    uVar13 = FUN_18000865c((short *)local_28);
    if ((int)uVar13 < 2) {
      _local_28 = CONCAT142(CONCAT122(auStack38._2_12_,local_28),0x27);
    }
    else {
      uVar13 = FUN_18000865c((short *)(local_28 + 2));
      memcpy(auStack38 + 2,local_28 + 2,(longlong)(int)uVar13 * 2);
    }
    uVar13 = FUN_18000865c((short *)local_28);
    iVar6 = (int)uVar13 + -1;
    if (iVar6 < 9) {
      lVar10 = (longlong)iVar6;
      puVar14 = param_2;
      iVar12 = 0;
      if (-1 < iVar6) {
        do {
          lVar1 = lVar10 * 2;
          lVar10 = lVar10 + -1;
          *puVar14 = *(undefined2 *)(local_28 + lVar1);
          puVar14 = puVar14 + 1;
          iVar12 = (int)uVar13;
        } while (-1 < lVar10);
      }
      param_2[iVar12] = 0;
    }
  }
  __security_check_cookie(local_10 ^ (ulonglong)auStack88);
  return;
}



int FUN_18004b85c(undefined8 param_1,DWORD param_2,LPCWSTR param_3,CURRENCYFMTW *param_4,
                 LPWSTR param_5,int param_6)

{
  int iVar1;
  LPCWSTR lpLocaleName;
  
  lpLocaleName = (LPCWSTR)InternalLcidToName(param_1,0);
  if (lpLocaleName == (LPCWSTR)0x0) {
    SetLastError(0x57);
    iVar1 = 0;
  }
  else {
    iVar1 = GetCurrencyFormatEx(lpLocaleName,param_2,param_3,param_4,param_5,param_6);
  }
  return iVar1;
}



int GetDurationFormat(LCID Locale,DWORD dwFlags,SYSTEMTIME *lpDuration,ULONGLONG ullDuration,
                     LPCWSTR lpFormat,LPWSTR lpDurationStr,int cchDuration)

{
  int iVar1;
  LPCWSTR lpLocaleName;
  undefined4 in_register_0000000c;
  
                    // 0x4b8e0  571  GetDurationFormat
  lpLocaleName = (LPCWSTR)InternalLcidToName(CONCAT44(in_register_0000000c,Locale),0);
  if (lpLocaleName == (LPCWSTR)0x0) {
    SetLastError(0x57);
    iVar1 = 0;
  }
  else {
    iVar1 = GetDurationFormatEx(lpLocaleName,dwFlags,lpDuration,ullDuration,lpFormat,lpDurationStr,
                                cchDuration);
  }
  return iVar1;
}



// WARNING: Could not reconcile some variable overlaps

int FUN_18004b96c(longlong param_1,longlong param_2)

{
  char cVar1;
  int iVar2;
  longlong lVar3;
  longlong in_GS_OFFSET;
  undefined4 local_res8 [2];
  undefined local_18 [16];
  
  local_res8[0] = 0;
  local_18 = ZEXT816(0);
  if (((param_1 == 0) || (param_2 == 0)) ||
     (lVar3 = RtlSizeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_2),
     0xffffffffffffff54 < lVar3 - 0xaaU)) {
    iVar2 = -0x3ffffff3;
  }
  else {
    RtlInitUnicodeString(local_18,param_1);
    iVar2 = RtlUnicodeStringToInteger(local_18,0x10,local_res8);
    if (-1 < iVar2) {
      local_18 = CONCAT88(param_2,local_18._0_8_);
      local_18 = CONCAT124(local_18._4_12_,0xaa0000);
      cVar1 = RtlLCIDToCultureName(local_res8[0],local_18);
      if (cVar1 == '\0') {
        iVar2 = -0x3fffffff;
      }
    }
  }
  return iVar2;
}



int FUN_18004ba4c(int param_1,void *param_2,longlong param_3)

{
  int iVar1;
  
  iVar1 = 0;
  if (param_1 == 0) {
    iVar1 = FUN_18004b96c(param_3 + 0xc,(longlong)param_2);
  }
  else if (*(uint *)(param_3 + 8) < 0x25) {
    memcpy(param_2,(void *)(param_3 + 0xc),(ulonglong)*(uint *)(param_3 + 8));
  }
  else {
    iVar1 = -0x3ffffdfa;
  }
  return iVar1;
}



void FUN_18004ba98(byte *param_1)

{
  int iVar1;
  undefined4 local_res10;
  uint uStackX20;
  
  local_res10 = 8;
  uStackX20 = 0;
  iVar1 = NtQuerySystemInformation(0x67,&local_res10,8,0);
  if (-1 < iVar1) {
    *param_1 = (byte)(uStackX20 >> 5) & 1;
  }
  return;
}



void FUN_18004bae8(void *param_1,int param_2)

{
  int iVar1;
  longlong lVar2;
  longlong in_GS_OFFSET;
  undefined auStack376 [32];
  undefined4 local_158;
  undefined4 *local_150;
  undefined4 local_148 [2];
  longlong local_140;
  undefined local_138 [16];
  undefined local_128 [16];
  undefined4 local_118;
  undefined4 local_114;
  undefined8 local_110;
  undefined *local_108;
  undefined4 local_100;
  undefined4 local_fc;
  undefined local_f8 [16];
  undefined local_e8 [192];
  ulonglong local_28;
  
  local_28 = DAT_1800b2220 ^ (ulonglong)auStack376;
  local_114 = 0;
  local_fc = 0;
  local_140 = 0;
  local_148[0] = 0;
  memset(local_e8,0,0xba);
  local_138 = ZEXT816(0);
  local_128 = ZEXT816(0);
  RtlInitUnicodeString
            (local_128,L"\\Registry\\Machine\\System\\CurrentControlSet\\Control\\NLS\\Language");
  if ((param_1 == (void *)0x0) ||
     (lVar2 = RtlSizeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_1),
     0xffffffffffffff52 < lVar2 - 0xacU)) goto LAB_18004bccf;
  local_110 = 0;
  local_108 = local_128;
  local_118 = 0x30;
  local_100 = 0x40;
  local_f8 = ZEXT816(0);
  iVar1 = NtOpenKey(&local_140,0x20019,&local_118);
  if (-1 < iVar1) {
    RtlInitUnicodeString(local_138,L"PreviousInstallLanguage");
    local_150 = local_148;
    local_158 = 0xba;
    iVar1 = NtQueryValueKey();
    if (iVar1 < 0) {
      if (iVar1 == -0x3fffffcc) {
        memset(local_e8,0,0xba);
        local_148[0] = 0;
        RtlInitUnicodeString(local_138,L"InstallLanguage");
        local_150 = local_148;
        local_158 = 0xba;
        iVar1 = NtQueryValueKey(local_140,local_138,2,local_e8);
        if (-1 < iVar1) goto LAB_18004bca0;
      }
    }
    else {
LAB_18004bca0:
      FUN_18004ba4c(param_2,param_1,(longlong)local_e8);
    }
  }
  if (local_140 != 0) {
    NtClose();
  }
LAB_18004bccf:
  __security_check_cookie(local_28 ^ (ulonglong)auStack376);
  return;
}



int FUN_18004bcfc(uint param_1,PZZWSTR param_2,uint param_3,longlong param_4,char param_5,
                 uint *param_6)

{
  int iVar1;
  BOOL BVar2;
  short *psVar3;
  PZZWSTR pWVar4;
  uint uVar5;
  longlong in_GS_OFFSET;
  uint local_res8 [2];
  ULONG local_38 [4];
  
  local_38[0] = 0;
  local_res8[0] = 0x57;
  uVar5 = -(uint)((param_1 & 0x100) != 0) & 0x100;
  psVar3 = (short *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,
                                    0xae);
  if (psVar3 == (short *)0x0) {
    return -0x3fffffe9;
  }
  iVar1 = FUN_18004bae8(psVar3,uVar5 + 1 & 0x100);
  pWVar4 = (PZZWSTR)0x0;
  if (iVar1 < 0) goto LAB_18004be32;
  if (param_2 == (PZZWSTR)0x0) {
    param_2 = (PZZWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,
                                       (ulonglong)local_res8[0] * 2);
    pWVar4 = param_2;
    if (param_2 == (PZZWSTR)0x0) {
      iVar1 = -0x3fffffe9;
      goto LAB_18004be32;
    }
    BVar2 = GetSystemPreferredUILanguages
                      ((-(uint)((param_1 & 0x100) != 0) & 0xfffffffc) + 0x408,local_38,param_2,
                       local_res8);
    if (BVar2 == 0) {
      iVar1 = -0x3fffff1b;
      goto LAB_18004be32;
    }
  }
  iVar1 = FUN_18004be9c(uVar5 + 1,param_2,psVar3,param_3,param_4,param_5,param_6);
LAB_18004be32:
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,psVar3);
  if (pWVar4 != (PZZWSTR)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pWVar4);
  }
  return iVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Could not reconcile some variable overlaps

void FUN_18004be9c(uint param_1,short *param_2,short *param_3,uint param_4,longlong param_5,
                  char param_6,uint *param_7)

{
  int iVar1;
  char cVar2;
  int iVar3;
  short *psVar4;
  undefined8 uVar5;
  longlong lVar6;
  FARPROC pFVar7;
  short *psVar8;
  FARPROC pFVar9;
  FARPROC pFVar10;
  undefined *puVar11;
  short *psVar12;
  wchar_t **ppwVar13;
  char *lpProcName;
  uint uVar14;
  longlong in_GS_OFFSET;
  uint local_res8 [8];
  undefined auStack1320 [32];
  undefined4 local_508;
  undefined4 *local_500;
  uint local_4e0;
  uint local_4d8 [2];
  uint local_4d0;
  wchar_t *local_4c8;
  undefined2 local_4c0 [2];
  uint local_4bc;
  undefined4 local_4b8;
  uint local_4b4;
  short *local_4b0;
  longlong local_4a8;
  undefined4 local_4a0;
  short *local_498;
  short *local_490;
  ushort local_488 [4];
  longlong local_480;
  wchar_t *local_478;
  short *local_470;
  short *local_468;
  uint local_460;
  int local_45c;
  short *local_458;
  longlong local_450;
  ulonglong local_448;
  HMODULE local_440;
  longlong local_438;
  short *local_430;
  HMODULE local_428;
  FARPROC local_418;
  undefined4 local_400 [2];
  short *local_3f8;
  uint *local_3f0;
  undefined4 local_3e8;
  longlong local_3e0;
  ushort *local_3d8;
  undefined4 local_3d0;
  undefined local_3c8 [16];
  undefined4 local_3b8;
  undefined4 local_3b4;
  undefined4 local_3b0;
  undefined4 local_3ac;
  wchar_t *local_3a8;
  int local_3a0;
  undefined4 local_39c;
  wchar_t *local_398;
  int local_390;
  undefined4 local_38c;
  wchar_t *local_388;
  int local_380;
  undefined4 local_37c;
  wchar_t *local_378;
  int local_370;
  undefined4 local_36c;
  uint *local_368;
  undefined8 local_360;
  LPCSTR local_358;
  int local_350;
  undefined4 local_34c;
  wchar_t *local_348;
  int local_340;
  undefined4 local_33c;
  uint *local_338;
  undefined8 local_330;
  LPCSTR local_328;
  int local_320;
  undefined4 local_31c;
  wchar_t *local_318;
  int local_310;
  undefined4 local_30c;
  uint *local_308;
  undefined8 local_300;
  LPCSTR local_2f8;
  int local_2f0;
  undefined4 local_2ec;
  wchar_t *local_2e8;
  int local_2e0;
  undefined4 local_2dc;
  LPCSTR local_2d8;
  int local_2d0;
  undefined4 local_2cc;
  uint *local_2c8;
  undefined8 local_2c0;
  uint *local_2b0;
  undefined8 local_2a8;
  short *local_2a0;
  int local_298;
  undefined4 local_294;
  short *local_290;
  int local_288;
  undefined4 local_284;
  uint *local_280;
  undefined8 local_278;
  undefined local_260 [12];
  uint local_254;
  undefined2 local_250 [248];
  ulonglong local_60;
  
  local_60 = DAT_1800b2220 ^ (ulonglong)auStack1320;
  psVar8 = (short *)0x0;
  local_3f0 = param_7;
  local_498 = (short *)0x0;
  local_470 = (short *)0x0;
  local_490 = (short *)0x0;
  local_468 = (short *)0x0;
  local_450 = 0;
  local_4a8 = 0;
  local_4b8 = 0;
  local_4bc = 0;
  local_478 = (wchar_t *)0x0;
  local_4a0 = 0;
  local_428 = (HMODULE)0x0;
  local_4e0 = 0;
  local_460 = 0;
  local_4b0 = (short *)0x0;
  local_440 = (HMODULE)0x0;
  local_418 = (FARPROC)0x0;
  local_438 = 0;
  local_3b8 = 0xf750e6c3;
  local_3b4 = 0x11d138ee;
  local_3b0 = 0xc000e585;
  local_3ac = 0xee95c24f;
  psVar4 = psVar8;
  local_res8[0] = param_1;
  local_4d8[0] = param_4;
  if ((param_4 & 0xfffffffe) == 0) {
    uVar14 = param_1 & 0xff;
    local_4b4 = param_1 & 0xff;
    if (uVar14 == 1) {
      if ((((param_2 != (short *)0x0) && (param_3 != (short *)0x0)) && (*param_2 != 0)) &&
         (*param_3 != 0)) {
        lpProcName = "OnMachineUILanguageSwitch";
        psVar4 = (short *)0x0;
LAB_18004c359:
        if (param_2 != (short *)0x0) {
          if ((local_res8[0] >> 8 & 1) == 0) {
            local_498 = param_2;
            iVar3 = RtlpConvertCultureNamesToLCIDs(param_2,&local_490);
          }
          else {
            local_490 = param_2;
            iVar3 = RtlpConvertLCIDsToCultureNames(param_2,&local_498);
          }
          if (iVar3 < 0) goto LAB_18004bff5;
        }
LAB_18004c3a2:
        if (param_3 != (short *)0x0) {
          if ((local_res8[0] >> 8 & 1) == 0) {
            local_470 = param_3;
            iVar3 = RtlpConvertCultureNamesToLCIDs(param_3,&local_468);
          }
          else {
            local_468 = param_3;
            iVar3 = RtlpConvertLCIDsToCultureNames(param_3,&local_470);
          }
          if (iVar3 < 0) goto LAB_18004bff5;
        }
LAB_18004c3e4:
        psVar12 = (short *)0x0;
        if ((param_5 != 0) &&
           (cVar2 = EtwEventEnabled(param_5,&DAT_180088478), psVar8 = (short *)0x0, cVar2 != '\0'))
        {
          local_430 = (short *)0x0;
          local_458 = (short *)0x0;
          uVar5 = FUN_18004d27c(param_2,&local_430);
          psVar8 = local_430;
          if ((-1 < (int)uVar5) &&
             (uVar5 = FUN_18004d27c(param_3,&local_458), psVar12 = local_458, -1 < (int)uVar5)) {
            local_2b0 = local_res8;
            lVar6 = -1;
            local_2a8 = 4;
            do {
              lVar6 = lVar6 + 1;
            } while (psVar8[lVar6] != 0);
            local_298 = (int)lVar6 * 2 + 2;
            lVar6 = -1;
            local_2a0 = psVar8;
            local_294 = 0;
            do {
              lVar6 = lVar6 + 1;
            } while (local_458[lVar6] != 0);
            local_288 = (int)lVar6 * 2 + 2;
            local_284 = 0;
            local_280 = local_4d8;
            local_290 = local_458;
            local_278 = 4;
            EtwEventWrite(param_5,&DAT_180088478,4,&local_2b0);
          }
          if (psVar8 != (short *)0x0) {
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
            psVar12 = local_458;
          }
          psVar8 = local_4b0;
          if (psVar12 != (short *)0x0) {
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
            psVar8 = local_4b0;
          }
        }
        local_440 = LoadLibraryW(L"wintrust.dll");
        if (local_440 != (HMODULE)0x0) {
          pFVar7 = GetProcAddress(local_440,"CryptCATAdminAcquireContext");
          local_418 = GetProcAddress(local_440,"CryptCATAdminReleaseContext");
          if (((pFVar7 != (FARPROC)0x0) && (local_418 != (FARPROC)0x0)) &&
             (iVar3 = (*pFVar7)(), iVar3 != 0)) {
            RtlInitUnicodeString
                      (local_488,
                       L"\\Registry\\Machine\\System\\CurrentControlSet\\Control\\MUI\\CallbackDlls"
                      );
            local_3d8 = local_488;
            local_3e8 = 0x30;
            local_3d0 = 0x40;
            local_3e0 = 0;
            local_3c8 = ZEXT816(0);
            iVar3 = NtOpenKey(&local_450,0x20019);
            if (iVar3 < 0) {
              uVar14 = 0;
              goto LAB_18004bffa;
            }
            local_448 = 0x216;
            psVar8 = (short *)RtlAllocateHeap(*(undefined8 *)
                                               (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,0x216);
            local_4b0 = psVar8;
            local_478 = (wchar_t *)
                        RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8
                                       );
            if ((psVar8 != (short *)0x0) && (local_478 != (wchar_t *)0x0)) {
              local_45c = 0;
              local_4d0 = 0x2080000;
              local_4c8 = local_478;
              do {
                local_500 = &local_4b8;
                local_508 = 0x1fe;
                iVar3 = NtEnumerateKey(local_450,local_45c,0,local_260);
                if (iVar3 < 0) {
                  uVar14 = local_4e0;
                  if (iVar3 == -0x7fffffe6) break;
LAB_18004cf9d:
                  local_4e0 = local_4e0 | 1;
                  psVar8 = local_4b0;
                }
                else {
                  if (0x1e8 < local_254 + 1) {
LAB_18004c74a:
                    iVar3 = -0x3fffffe9;
                    goto LAB_18004cf9d;
                  }
                  local_250[local_254 >> 1] = 0;
                  RtlInitUnicodeString(local_488,local_250);
                  local_3e0 = local_450;
                  local_3d8 = local_488;
                  local_3e8 = 0x30;
                  local_3d0 = 0x40;
                  local_3c8 = ZEXT816(0);
                  iVar3 = NtOpenKey(&local_4a8);
                  if (iVar3 < 0) goto LAB_18004cf9d;
                  RtlInitUnicodeString(local_488,L"Type");
                  local_500 = &local_4b8;
                  local_508 = (undefined4)local_448;
                  iVar3 = NtQueryValueKey(local_4a8,local_488,2,psVar8);
                  if ((iVar3 < 0) || (*(int *)(psVar8 + 2) != 4)) goto LAB_18004cf9d;
                  local_4bc = *(uint *)(psVar8 + 6);
                  if ((local_4b4 & local_4bc) != 0) {
                    RtlInitUnicodeString(local_488,L"DllPath");
                    local_500 = &local_4b8;
                    local_508 = (undefined4)local_448;
                    iVar3 = NtQueryValueKey(local_4a8,local_488,2,psVar8);
                    if (iVar3 < 0) {
                      if (iVar3 == -0x7ffffffb) {
                        iVar1 = *(int *)(psVar8 + 4);
                        if (iVar1 == 0) goto LAB_18004cf9d;
                        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                                    psVar8);
                        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
                        local_448 = (ulonglong)(iVar1 + 0xe);
                        psVar8 = (short *)RtlAllocateHeap(*(undefined8 *)
                                                           (*(longlong *)(in_GS_OFFSET + 0x60) +
                                                           0x30),8);
                        local_4b0 = psVar8;
                        local_478 = (wchar_t *)
                                    RtlAllocateHeap(*(undefined8 *)
                                                     (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
                        if ((psVar8 == (short *)0x0) || (local_478 == (wchar_t *)0x0))
                        goto LAB_18004c74a;
                        local_500 = &local_4b8;
                        local_508 = (undefined4)local_448;
                        iVar3 = NtQueryValueKey(local_4a8,local_488,2,psVar8);
                      }
                      if (iVar3 < 0) goto LAB_18004cf9d;
                    }
                    if (*(int *)(psVar8 + 2) == 2) {
                      psVar8[(ulonglong)(*(uint *)(psVar8 + 4) >> 1) + 6] = 0;
                      RtlInitUnicodeString();
                      iVar3 = RtlExpandEnvironmentStrings_U();
                      if (iVar3 < 0) {
                        if (iVar3 == -0x3fffffdd) {
                          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                                      local_478);
                          local_4c8 = (wchar_t *)
                                      RtlAllocateHeap(*(undefined8 *)
                                                       (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8
                                                      ,local_4a0);
                          local_478 = local_4c8;
                          iVar3 = RtlExpandEnvironmentStrings_U();
                        }
                        if (iVar3 < 0) goto LAB_18004cf9d;
                      }
                      local_4c8[(ushort)local_4d0 >> 1] = L'\0';
                      _wcslwr(local_4c8);
                      cVar2 = RtlDoesFileExists_U(local_4c8);
                      if (cVar2 == '\0') {
                        if ((param_5 != 0) && (cVar2 = EtwEventEnabled(param_5), cVar2 != '\0')) {
                          ppwVar13 = &local_3a8;
                          local_3a8 = local_4c8;
                          puVar11 = &DAT_180088488;
                          local_3a0 = (local_4d0 & 0xffff) + 2;
                          local_39c = 0;
LAB_18004caf4:
                          uVar5 = 1;
LAB_18004cafa:
                          EtwEventWrite(param_5,puVar11,uVar5,ppwVar13);
                        }
                      }
                      else {
                        cVar2 = FUN_18004d6b8(local_440,local_438,local_4c8,param_6);
                        if (cVar2 == '\0') {
                          local_4e0 = local_4e0 | 0x1000;
                          if ((param_5 != 0) && (cVar2 = EtwEventEnabled(param_5), cVar2 != '\0')) {
                            local_398 = local_4c8;
                            local_390 = (local_4d0 & 0xffff) + 2;
                            local_38c = 0;
                            EtwEventWrite(param_5,&DAT_180088498,1,&local_398);
                          }
                          goto LAB_18004cfa5;
                        }
                        local_428 = LoadLibraryW(local_4c8);
                        if (local_428 == (HMODULE)0x0) {
                          if ((param_5 != 0) && (cVar2 = EtwEventEnabled(param_5), cVar2 != '\0')) {
                            ppwVar13 = &local_388;
                            local_388 = local_4c8;
                            puVar11 = &DAT_1800884b8;
                            local_380 = (local_4d0 & 0xffff) + 2;
                            local_37c = 0;
                            goto LAB_18004caf4;
                          }
                        }
                        else {
                          uVar14 = local_4b4 & 1;
                          if (uVar14 == 0) {
                            if ((local_4b4 & 0x20) == 0) {
                              pFVar10 = GetProcAddress(local_428,lpProcName);
                              pFVar7 = (FARPROC)0x0;
                              if (pFVar10 != (FARPROC)0x0) goto LAB_18004ce5e;
                              if ((param_5 != 0) &&
                                 (cVar2 = EtwEventEnabled(param_5), cVar2 != '\0')) {
                                local_318 = local_4c8;
                                local_310 = (local_4d0 & 0xffff) + 2;
                                local_30c = 0;
                                local_308 = &local_4bc;
                                lVar6 = -1;
                                local_300 = 4;
                                do {
                                  lVar6 = lVar6 + 1;
                                } while (lpProcName[lVar6] != '\0');
                                local_2f0 = (int)lVar6 + 1;
                                local_2ec = 0;
                                ppwVar13 = &local_318;
                                local_2f8 = lpProcName;
                                goto LAB_18004cce5;
                              }
                            }
                            else {
                              pFVar7 = GetProcAddress(local_428,lpProcName);
                              pFVar10 = (FARPROC)0x0;
                              if (pFVar7 != (FARPROC)0x0) {
LAB_18004ce5e:
                                pFVar9 = (FARPROC)0x0;
                                goto LAB_18004ce61;
                              }
                              if ((param_5 != 0) &&
                                 (cVar2 = EtwEventEnabled(param_5), cVar2 != '\0')) {
                                local_348 = local_4c8;
                                local_340 = (local_4d0 & 0xffff) + 2;
                                local_33c = 0;
                                local_338 = &local_4bc;
                                lVar6 = -1;
                                local_330 = 4;
                                do {
                                  lVar6 = lVar6 + 1;
                                } while (lpProcName[lVar6] != '\0');
                                local_320 = (int)lVar6 + 1;
                                local_31c = 0;
                                ppwVar13 = &local_348;
                                local_328 = lpProcName;
LAB_18004cce5:
                                uVar5 = 3;
                                puVar11 = &DAT_1800884a8;
                                goto LAB_18004cafa;
                              }
                            }
                          }
                          else {
                            pFVar9 = GetProcAddress(local_428,lpProcName);
                            pFVar10 = (FARPROC)0x0;
                            pFVar7 = pFVar10;
                            if (pFVar9 == (FARPROC)0x0) {
                              if ((param_5 != 0) &&
                                 (cVar2 = EtwEventEnabled(param_5), cVar2 != '\0')) {
                                local_378 = local_4c8;
                                local_370 = (local_4d0 & 0xffff) + 2;
                                local_36c = 0;
                                local_368 = &local_4bc;
                                lVar6 = -1;
                                local_360 = 4;
                                do {
                                  lVar6 = lVar6 + 1;
                                } while (lpProcName[lVar6] != '\0');
                                local_350 = (int)lVar6 + 1;
                                local_34c = 0;
                                ppwVar13 = &local_378;
                                local_358 = lpProcName;
                                goto LAB_18004cce5;
                              }
                            }
                            else {
LAB_18004ce61:
                              if (-1 < iVar3) {
                                if ((local_4bc & 0x100) == 0) {
                                  if (uVar14 != 0) goto LAB_18004cea3;
                                  if (((local_4b4 & 0x10) != 0) || ((local_4b4 & 0x20) == 0))
                                  goto LAB_18004ced7;
                                  local_460 = (*pFVar7)();
                                }
                                else if (uVar14 == 0) {
LAB_18004ced7:
                                  local_460 = (*pFVar10)();
                                }
                                else {
LAB_18004cea3:
                                  local_460 = (*pFVar9)();
                                }
                                local_4e0 = local_4e0 | local_460;
                                psVar8 = local_4b0;
                                if ((param_5 != 0) &&
                                   (cVar2 = EtwEventEnabled(param_5), psVar8 = local_4b0,
                                   cVar2 != '\0')) {
                                  local_2e8 = local_4c8;
                                  local_2e0 = (local_4d0 & 0xffff) + 2;
                                  local_2dc = 0;
                                  lVar6 = -1;
                                  do {
                                    lVar6 = lVar6 + 1;
                                  } while (lpProcName[lVar6] != '\0');
                                  local_2d0 = (int)lVar6 + 1;
                                  local_2cc = 0;
                                  local_2c8 = &local_460;
                                  local_2c0 = 4;
                                  local_2d8 = lpProcName;
                                  EtwEventWrite(param_5,&DAT_180088468,3,&local_2e8);
                                  psVar8 = local_4b0;
                                }
                                goto LAB_18004cfa5;
                              }
                            }
                          }
                        }
                      }
                    }
                    goto LAB_18004cf9d;
                  }
                }
LAB_18004cfa5:
                if (local_4a8 != 0) {
                  NtClose();
                  local_4a8 = 0;
                }
                if (local_428 != (HMODULE)0x0) {
                  LdrUnloadDll(local_428);
                }
                local_45c = local_45c + 1;
                local_428 = (HMODULE)0x0;
                uVar14 = local_4e0;
              } while (iVar3 != -0x7fffffe6);
              goto LAB_18004bffa;
            }
            goto LAB_18004bff5;
          }
        }
        uVar14 = 0;
        goto LAB_18004bffa;
      }
    }
    else if ((uVar14 == 2) || (uVar14 == 4)) {
      if ((((param_3 == (short *)0x0) && ((param_2 != (short *)0x0 && (*param_2 != 0)))) &&
          (RtlInitUnicodeString(), 1 < local_488[0])) &&
         (*(short *)(local_480 + 2 + (ulonglong)(local_488[0] >> 1) * 2) == 0)) {
        lpProcName = "OnUILanguageAdd";
        if (uVar14 != 2) {
          lpProcName = "OnUILanguageRemove";
        }
        goto LAB_18004c359;
      }
    }
    else if (uVar14 == 8) {
      if (param_3 == (short *)0x0) {
        if (param_2 == (short *)0x0) {
          local_4c0[0] = 0;
          iVar3 = NtQueryInstallUILanguage(local_4c0);
          psVar4 = (short *)0x0;
          if ((-1 < iVar3) &&
             (psVar4 = (short *)RtlAllocateHeap(*(undefined8 *)
                                                 (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8),
             psVar4 != (short *)0x0)) {
            local_400[0] = 0xaa0000;
            local_3f8 = psVar4;
            cVar2 = RtlLCIDToCultureName(local_4c0[0],local_400);
            if (cVar2 != '\0') {
              local_498 = local_3f8;
              iVar3 = RtlpConvertCultureNamesToLCIDs(local_3f8,&local_490);
              if (-1 < iVar3) {
                local_res8[0] = local_res8[0] | 0x100;
                goto LAB_18004c2af;
              }
            }
          }
        }
        else if (*param_2 != 0) {
LAB_18004c2af:
          lpProcName = "OnMachineUILanguageInit";
          goto LAB_18004c359;
        }
      }
    }
    else if (uVar14 == 0x10) {
      if (((param_2 == (short *)0x0) && (param_3 != (short *)0x0)) && (*param_3 != 0)) {
        lpProcName = "OnMachineUILanguageClear";
        goto LAB_18004c3a2;
      }
    }
    else if (((uVar14 == 0x20) && (param_2 == (short *)0x0)) && (param_3 == (short *)0x0)) {
      lpProcName = "OnUserProfileChanged";
      goto LAB_18004c3e4;
    }
  }
LAB_18004bff5:
  uVar14 = 1;
LAB_18004bffa:
  if (local_3f0 != (uint *)0x0) {
    *local_3f0 = uVar14;
  }
  if (local_450 != 0) {
    NtClose();
    local_450 = 0;
  }
  if (local_4a8 != 0) {
    NtClose();
    local_4a8 = 0;
  }
  if (psVar8 != (short *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
  }
  if (local_478 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
  }
  if ((local_498 != (short *)0x0) && (local_498 != param_2)) {
    if (psVar4 == local_498) {
      psVar4 = (short *)0x0;
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
  }
  if ((local_490 != (short *)0x0) && (local_490 != param_2)) {
    if (psVar4 == local_490) {
      psVar4 = (short *)0x0;
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
  }
  if ((local_470 != (short *)0x0) && (local_470 != param_3)) {
    if (psVar4 == local_470) {
      psVar4 = (short *)0x0;
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
  }
  if ((local_468 != (short *)0x0) && (local_468 != param_3)) {
    if (psVar4 == local_468) {
      psVar4 = (short *)0x0;
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_468);
  }
  if (psVar4 != (short *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,psVar4);
  }
  if (local_438 != 0) {
    (*local_418)();
  }
  if (local_440 != (HMODULE)0x0) {
    FreeLibrary(local_440);
  }
  __security_check_cookie(local_60 ^ (ulonglong)auStack1320);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Could not reconcile some variable overlaps

void FUN_18004d020(HMODULE param_1,undefined8 param_2,char param_3)

{
  int iVar1;
  HMODULE hModule;
  FARPROC pFVar2;
  FARPROC pFVar3;
  FARPROC pFVar4;
  FARPROC pFVar5;
  longlong lVar6;
  undefined auStack312 [48];
  undefined local_108 [16];
  undefined local_f8 [16];
  undefined8 local_e8;
  undefined4 local_d8 [2];
  undefined8 local_d0;
  undefined8 local_c8;
  undefined8 local_c0;
  undefined4 local_b8;
  undefined *local_b0;
  undefined4 local_a8;
  longlong local_a0;
  undefined4 local_90;
  undefined local_78 [16];
  undefined local_68 [16];
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  ulonglong local_48;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStack312;
  local_108 = CONCAT88(local_108._0_8_,param_2);
  memset(local_d8,0,0x58);
  local_58 = 0xaac56b;
  local_54 = 0x11d0cd44;
  local_78 = ZEXT816(0);
  local_50 = 0xc000c28c;
  local_68 = ZEXT816(0);
  local_4c = 0xee95c24f;
  hModule = LoadLibraryW(L"crypt32.dll");
  if (hModule != (HMODULE)0x0) {
    pFVar2 = GetProcAddress(param_1,"WinVerifyTrust");
    pFVar3 = GetProcAddress(param_1,"WTHelperProvDataFromStateData");
    pFVar4 = GetProcAddress(param_1,"WTHelperGetProvSignerFromChain");
    pFVar5 = GetProcAddress(hModule,"CertVerifyCertificateChainPolicy");
    if ((((pFVar2 != (FARPROC)0x0) && (pFVar3 != (FARPROC)0x0)) && (pFVar4 != (FARPROC)0x0)) &&
       (pFVar5 != (FARPROC)0x0)) {
      local_78 = CONCAT88(local_108._0_8_,local_78._0_8_);
      local_b0 = local_78;
      local_d0 = 0;
      local_c8 = 0;
      local_b8 = 1;
      local_a8 = 1;
      local_d8[0] = 0x58;
      local_78 = CONCAT124(local_78._4_12_,0x20);
      local_c0 = 2;
      local_90 = 0x10;
      iVar1 = (*pFVar2)();
      if (iVar1 == 0) {
        lVar6 = (*pFVar3)();
        if ((lVar6 != 0) && (lVar6 = (*pFVar4)(), lVar6 != 0)) {
          local_e8 = 0;
          local_108 = CONCAT124(SUB1612(ZEXT816(0) >> 0x20,0),0x10);
          if (param_3 != '\0') {
            local_108 = ZEXT816(0x1000000000010);
          }
          local_f8 = CONCAT124(SUB1612(ZEXT816(0) >> 0x20,0),0x18);
          (*pFVar5)();
        }
        if (local_a0 != 0) {
          local_a8 = 2;
          (*pFVar2)();
        }
      }
    }
    FreeLibrary(hModule);
  }
  __security_check_cookie(local_48 ^ (ulonglong)auStack312);
  return;
}



undefined8 FUN_18004d27c(short *param_1,short **param_2)

{
  short sVar1;
  int iVar2;
  short *_Dst;
  short *psVar3;
  longlong lVar4;
  ulonglong uVar5;
  longlong lVar6;
  undefined8 uVar7;
  longlong in_GS_OFFSET;
  longlong local_res8;
  
  lVar6 = 0;
  local_res8 = 0;
  uVar5 = 0x156;
  uVar7 = 0;
  if ((param_2 == (short **)0x0) || (*param_2 != (short *)0x0)) {
    uVar7 = 0xc000000d;
  }
  else {
    if ((param_1 == (short *)0x0) || (*param_1 == 0)) {
      uVar5 = 8;
    }
    _Dst = (short *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                                    uVar5 * 2);
    *param_2 = _Dst;
    *_Dst = 0;
    if ((param_1 == (short *)0x0) || (*param_1 == 0)) {
      lVar6 = 0x7ffffffe - uVar5;
      lVar4 = (longlong)L"(null)" - (longlong)_Dst;
      do {
        if ((lVar6 + uVar5 == 0) || (sVar1 = *(short *)(lVar4 + (longlong)_Dst), sVar1 == 0)) break;
        *_Dst = sVar1;
        _Dst = _Dst + 1;
        uVar5 = uVar5 - 1;
      } while (uVar5 != 0);
      psVar3 = _Dst + -1;
      if (uVar5 != 0) {
        psVar3 = _Dst;
      }
      *psVar3 = 0;
    }
    else {
      while ((iVar2 = FID_conflict_StringCchLengthW(param_1,uVar5 - lVar6,&local_res8),
             lVar4 = local_res8, -1 < iVar2 &&
             ((ulonglong)(((longlong)_Dst - (longlong)*param_2 >> 1) + 1 + local_res8) <= uVar5))) {
        memcpy(_Dst,param_1,local_res8 * 2 + 2);
        param_1 = param_1 + lVar4 + 1;
        psVar3 = _Dst + lVar4;
        _Dst = psVar3 + 1;
        lVar6 = lVar6 + 1 + lVar4;
        if (*param_1 == 0) {
          return 0;
        }
        *psVar3 = 0x2c;
        if (*param_1 == 0) {
          return 0;
        }
      }
      uVar7 = 0x80000005;
      if (_Dst != (short *)0x0) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,_Dst);
      }
    }
  }
  return uVar7;
}



BOOL NotifyUILanguageChange
               (DWORD dwFlags,PCWSTR pcwstrNewLanguage,PCWSTR pcwstrPreviousLanguage,
               DWORD dwReserved,PDWORD pdwStatusRtrn)

{
  byte bVar1;
  char cVar2;
  int iVar3;
  DWORD dwErrCode;
  BOOL extraout_EAX;
  undefined auStackY184 [32];
  byte local_78 [4];
  DWORD local_74;
  longlong local_70;
  uint local_68;
  DWORD *local_60;
  undefined8 local_58;
  ulonglong local_50;
  
                    // 0x4d420  1024  NotifyUILanguageChange
  local_50 = DAT_1800b2220 ^ (ulonglong)auStackY184;
  local_70 = 0;
  local_68 = 0;
  local_78[0] = 0;
  iVar3 = EtwEventRegister(&DAT_1800884d8,0,0);
  if (iVar3 != 0) {
    local_70 = 0;
  }
  if ((local_70 != 0) && (cVar2 = EtwEventEnabled(local_70,&DAT_180088458), cVar2 != '\0')) {
    local_60 = (DWORD *)0x180089200;
    local_58 = 0x36;
    EtwEventWrite(local_70,&DAT_180088458,1);
  }
  if (pcwstrNewLanguage == (PCWSTR)0x0) {
LAB_18004d543:
    local_74 = FUN_18004ba98(local_78);
    bVar1 = local_78[0];
    if (((-1 < (int)local_74) &&
        (local_74 = FUN_18004be9c(dwFlags,pcwstrNewLanguage,pcwstrPreviousLanguage,dwReserved,
                                  local_70,local_78[0],pdwStatusRtrn), -1 < (int)local_74)) &&
       ((dwFlags & 8) != 0)) {
      local_74 = FUN_18004bcfc(dwFlags,pcwstrNewLanguage,dwReserved,local_70,bVar1,pdwStatusRtrn);
    }
  }
  else {
    local_74 = RtlGetUILanguageInfo
                         ((-(uint)((dwFlags & 0x100) != 0) & 0xfffffffc) + 0x88,pcwstrNewLanguage,0)
    ;
    if ((dwFlags & 4) == 0) {
      if (-1 < (int)local_74) goto LAB_18004d532;
    }
    else if (local_74 == 0xc0000034) {
LAB_18004d532:
      if ((local_68 & 4) == 0 || (dwFlags & 8) == 0) goto LAB_18004d543;
    }
    local_74 = 0xc000000d;
  }
  dwErrCode = RtlNtStatusToDosError(local_74);
  SetLastError(dwErrCode);
  if (local_74 != 0) {
    if (pdwStatusRtrn != (PDWORD)0x0) {
      *pdwStatusRtrn = local_74;
    }
    if (local_70 == 0) goto LAB_18004d685;
    cVar2 = EtwEventEnabled(local_70,&DAT_1800884c8);
    if (cVar2 != '\0') {
      local_60 = &local_74;
      local_58 = 4;
      EtwEventWrite(local_70,&DAT_1800884c8,1,&local_60);
    }
  }
  if ((local_70 != 0) && (cVar2 = EtwEventEnabled(local_70,&DAT_180088448), cVar2 != '\0')) {
    local_58 = 0x36;
    local_60 = (DWORD *)0x180089200;
    EtwEventWrite(local_70,&DAT_180088448,1,&local_60);
  }
LAB_18004d685:
  EtwEventUnregister(local_70);
  __security_check_cookie(local_50 ^ (ulonglong)auStackY184);
  return extraout_EAX;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_18004d6b8(HMODULE param_1,longlong param_2,LPCWSTR param_3,char param_4)

{
  DWORD DVar1;
  int iVar2;
  FARPROC pFVar3;
  FARPROC pFVar4;
  FARPROC pFVar5;
  FARPROC pFVar6;
  FARPROC pFVar7;
  HLOCAL hMem;
  longlong lVar8;
  HANDLE hObject;
  undefined auStackY952 [32];
  undefined4 local_340;
  undefined4 local_33c;
  LPCWSTR local_338;
  HANDLE local_330;
  undefined8 local_328;
  undefined4 local_318 [2];
  undefined8 local_310;
  undefined8 local_300;
  undefined4 local_2f8;
  undefined4 *local_2f0;
  undefined4 local_2e8;
  undefined4 local_2d0;
  undefined4 local_2b8 [2];
  undefined *local_2b0;
  LPCWSTR local_2a8;
  HLOCAL local_290;
  undefined4 local_288;
  undefined4 local_268;
  undefined4 local_264;
  undefined4 local_260;
  undefined4 local_25c;
  undefined4 local_258;
  undefined local_254 [524];
  ulonglong local_48;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStackY952;
  hObject = (HANDLE)0xffffffffffffffff;
  hMem = (HLOCAL)0x0;
  local_268 = 0xf750e6c3;
  local_264 = 0x11d138ee;
  local_260 = 0xc000e585;
  local_25c = 0xee95c24f;
  if ((param_1 != (HMODULE)0x0) && (param_2 != 0)) {
    pFVar3 = GetProcAddress(param_1,"CryptCATAdminCalcHashFromFileHandle");
    pFVar4 = GetProcAddress(param_1,"CryptCATAdminEnumCatalogFromHash");
    pFVar5 = GetProcAddress(param_1,"CryptCATCatalogInfoFromContext");
    pFVar6 = GetProcAddress(param_1,"WinVerifyTrust");
    pFVar7 = GetProcAddress(param_1,"CryptCATAdminReleaseCatalogContext");
    if ((pFVar3 == (FARPROC)0x0) ||
       ((((pFVar4 == (FARPROC)0x0 || (pFVar5 == (FARPROC)0x0)) || (pFVar6 == (FARPROC)0x0)) ||
        ((pFVar7 == (FARPROC)0x0 ||
         (hObject = CreateFileW(param_3,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0x0),
         hObject == (HANDLE)0xffffffffffffffff)))))) {
      GetLastError();
      goto LAB_18004da73;
    }
    memset(local_318,0,0x58);
    local_318[0] = 0x58;
    local_300 = 2;
    local_2e8 = 3;
    local_2d0 = 0x10;
    local_310 = 0;
    local_2f0 = local_2b8;
    do {
      hMem = LocalAlloc(0,100);
      if (hMem == (HLOCAL)0x0) goto LAB_18004d8c3;
      iVar2 = (*pFVar3)();
      if (iVar2 != 0) {
        local_2f8 = 2;
        memset(local_2b8,0,0x48);
        local_2b8[0] = 0x48;
        local_288 = 100;
        local_2a8 = param_3;
        local_290 = hMem;
        goto LAB_18004da0f;
      }
      DVar1 = GetLastError();
      LocalFree(hMem);
    } while (DVar1 == 0x7a);
    hMem = (HLOCAL)0x0;
LAB_18004d8c3:
    local_33c = 0;
    local_2f0 = &local_340;
    local_328 = 0;
    local_2f8 = 1;
    local_340 = 0x20;
    local_338 = param_3;
    local_330 = hObject;
    iVar2 = (*pFVar6)();
    if (iVar2 == 0) {
      FUN_18004d020(param_1,param_3,param_4);
    }
  }
  goto LAB_18004da4a;
  while( true ) {
    local_2b0 = local_254;
    local_2e8 = 4;
    (*pFVar6)();
    local_2e8 = 0;
    local_2b0 = local_254;
    iVar2 = (*pFVar6)();
    if ((iVar2 == 0) && (iVar2 = FUN_18004d020(param_1,local_254,param_4), iVar2 != 0)) break;
LAB_18004da0f:
    do {
      lVar8 = (*pFVar4)();
      if (lVar8 == 0) goto LAB_18004d8c3;
      local_258 = 0x20c;
      iVar2 = (*pFVar5)();
    } while (iVar2 == 0);
  }
  (*pFVar7)();
LAB_18004da4a:
  if (hMem != (HLOCAL)0x0) {
    LocalFree(hMem);
  }
  if (hObject != (HANDLE)0xffffffffffffffff) {
    CloseHandle(hObject);
  }
LAB_18004da73:
  __security_check_cookie(local_48 ^ (ulonglong)auStackY952);
  return;
}



bool FUN_18004daac(undefined4 *param_1,int param_2)

{
  int iVar1;
  undefined8 uVar2;
  undefined4 local_38 [6];
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  
  if (param_1 != (undefined4 *)0x0) {
    iVar1 = FUN_180008558(param_1[2],param_1[3],param_1[4]);
    if (iVar1 + param_2 < 0) {
      SetLastError(0x120);
    }
    else {
      iVar1 = FUN_18004dbd4(iVar1 + param_2,local_38);
      if (iVar1 != 0) {
        local_1c = param_1[7];
        local_38[0] = *param_1;
        local_18 = param_1[8];
        local_14 = param_1[9];
        local_20 = param_1[6];
        uVar2 = FUN_1800075c4(param_1,local_38);
        return (int)uVar2 != 0;
      }
    }
  }
  return false;
}



bool FUN_18004db54(longlong param_1,undefined2 *param_2)

{
  bool bVar1;
  
  bVar1 = 0x640 < *(uint *)(param_1 + 8);
  if (bVar1) {
    *param_2 = *(undefined2 *)(param_1 + 8);
    param_2[1] = *(undefined2 *)(param_1 + 0xc);
    param_2[3] = *(undefined2 *)(param_1 + 0x10);
    param_2[4] = *(undefined2 *)(param_1 + 0x18);
    param_2[5] = *(undefined2 *)(param_1 + 0x1c);
    param_2[6] = *(undefined2 *)(param_1 + 0x20);
    param_2[7] = (short)((ulonglong)*(uint *)(param_1 + 0x24) / 10000);
    param_2[2] = *(undefined2 *)(param_1 + 0x14);
  }
  else {
    SetLastError(0x120);
  }
  return bVar1;
}



int FUN_18004dbd4(int param_1,undefined4 *param_2)

{
  int iVar1;
  int iVar2;
  undefined8 uVar3;
  int iVar4;
  int iVar5;
  int *piVar6;
  int iVar7;
  undefined4 local_38;
  undefined4 local_34;
  int local_30;
  int local_2c;
  int local_28;
  uint local_24;
  undefined local_20 [16];
  
  iVar1 = 1;
  iVar5 = (param_1 % 0x23ab1) / 0x8eac;
  if (iVar5 == 4) {
    iVar5 = 3;
  }
  iVar7 = param_1 % 0x23ab1 + iVar5 * -0x8eac;
  iVar2 = iVar7 / 0x5b5;
  iVar7 = iVar7 % 0x5b5;
  iVar4 = iVar7 / 0x16d;
  if (iVar4 == 4) {
    iVar4 = 3;
  }
  iVar7 = iVar7 + iVar4 * -0x16d;
  local_30 = ((iVar5 + (param_1 / 0x23ab1) * 4) * 0x19 + iVar2) * 4 + 1 + iVar4;
  if ((iVar4 != 3) || ((iVar4 = iVar1, iVar2 == 0x18 && (iVar5 != 3)))) {
    iVar4 = 0;
  }
  local_2c = (iVar7 >> 5) + 1;
  if (iVar4 == 0) {
    for (piVar6 = (int *)(&DAT_1800875c8 + (longlong)local_2c * 4); *piVar6 <= iVar7;
        piVar6 = piVar6 + 1) {
      local_2c = local_2c + 1;
    }
    iVar5 = *(int *)(&DAT_1800875c4 + (longlong)local_2c * 4);
  }
  else {
    for (piVar6 = (int *)(&DAT_180087590 + (longlong)local_2c * 4); *piVar6 <= iVar7;
        piVar6 = piVar6 + 1) {
      local_2c = local_2c + 1;
    }
    iVar5 = *(int *)((longlong)&DAT_180087588 + (longlong)local_2c * 4 + 4);
  }
  local_28 = (iVar7 - iVar5) + 1;
  local_38 = 1;
  local_34 = 1;
  local_20 = ZEXT816(0);
  uVar3 = FUN_180008308((longlong)&local_38,0x180000000,0);
  iVar5 = 0;
  if ((int)uVar3 != 0) {
    local_24 = FUN_18000850c((longlong)&local_38);
    uVar3 = FUN_1800075c4(param_2,&local_38);
    iVar5 = 0;
    if ((int)uVar3 != 0) {
      iVar5 = iVar1;
    }
  }
  return iVar5;
}



void FUN_18004dd8c(uint *param_1,ulonglong param_2,int param_3)

{
  uint uVar1;
  int iVar2;
  ulonglong uVar3;
  uint uVar4;
  ulonglong uVar5;
  int iVar6;
  int iVar7;
  undefined auStack120 [32];
  uint local_58 [10];
  ulonglong local_30;
  
  local_30 = DAT_1800b2220 ^ (ulonglong)auStack120;
  uVar5 = param_2 & 0xffffffff;
  uVar3 = FUN_1800498f0(param_1,param_2);
  iVar6 = (int)uVar3 + -1;
  UpdateCalendarDayOfWeek(param_1,param_2);
  iVar2 = (int)uVar5;
  iVar7 = ((iVar6 / 7) * 7 + param_1[5]) - iVar6;
  uVar4 = ((iVar2 - iVar7) + 0xeU) % 7;
  if ((uVar4 != 0) && (param_3 <= (int)uVar4)) {
    uVar4 = uVar4 - 7;
  }
  if ((int)(iVar6 - uVar4) < 0) {
    uVar4 = param_1[2];
    uVar1 = FUN_180049ef0(*param_1);
    if (uVar1 < uVar4) {
      uVar4 = FUN_1800499e8(*param_1,uVar4 - 1,param_1[1]);
    }
    else {
      uVar4 = 0x16d;
    }
    uVar1 = (((2 - (int)uVar4 / 7) * 7 - iVar7) + iVar2 + uVar4) % 7;
    if ((uVar1 != 0) && (param_3 <= (int)uVar1)) {
      uVar1 = uVar1 - 7;
    }
    if ((int)(uVar4 - uVar1) < 0) {
      FUN_1800075c4(local_58,param_1);
      iVar2 = AdjustCalendarDate(local_58,4,~uVar4);
      if (iVar2 != 0) {
        FUN_18004dd8c(local_58,uVar5,param_3);
      }
    }
  }
  __security_check_cookie(local_30 ^ (ulonglong)auStack120);
  return;
}



undefined4 FUN_18004df08(uint param_1,uint param_2,uint param_3,int param_4)

{
  undefined8 uVar1;
  uint uVar2;
  
  uVar1 = FUN_1800084e0(param_3,param_4);
  if ((int)uVar1 != 0) {
    uVar2 = param_2 - 1;
    if (uVar2 < 0xc) {
      uVar1 = FUN_18000846c(param_3,param_4);
      if ((int)uVar1 == 0) {
        uVar2 = *(int *)(&DAT_1800875c8 + (ulonglong)param_2 * 4) -
                *(int *)(&DAT_1800875c8 + (ulonglong)uVar2 * 4);
      }
      else {
        uVar2 = *(int *)(&DAT_180087590 + (ulonglong)param_2 * 4) -
                *(int *)(&DAT_180087590 + (ulonglong)uVar2 * 4);
      }
      if (param_1 <= uVar2) {
        SetLastError(0);
        if ((int)uVar1 == 0) {
          return 0;
        }
        if (param_2 != 2) {
          return 0;
        }
        if (param_1 != 0x1d) {
          return 0;
        }
        return 1;
      }
    }
    SetLastError(0x57);
  }
  return 0;
}



undefined8 FUN_18004dfd8(uint *param_1,int param_2,int param_3)

{
  bool bVar1;
  int iVar2;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  ulonglong uVar3;
  uint local_38 [2];
  uint local_30;
  uint local_2c;
  uint local_28;
  uint local_24;
  
  iVar2 = FUN_18004e08c(local_38,param_1);
  if (iVar2 != 0) {
    if (param_2 == 2) {
      iVar2 = FUN_180007288(local_38,param_3);
    }
    else {
      bVar1 = FUN_18004daac(local_38,param_3);
      iVar2 = (int)CONCAT71(extraout_var,bVar1);
    }
    if (iVar2 != 0) {
      uVar3 = (ulonglong)local_30;
      bVar1 = FUN_18004e9ac(*param_1,(ushort)local_30,(ushort)local_2c,(ushort)local_28,
                            (longlong)param_1);
      if ((int)CONCAT71(extraout_var_00,bVar1) != 0) {
        param_1[5] = local_24;
        param_1[3] = local_2c;
        param_1[4] = local_28;
        iVar2 = FUN_18004e7f8(param_1,uVar3,0);
        if (iVar2 != 0) {
          return 1;
        }
        RtlSetLastWin32Error(0x120);
      }
    }
  }
  return 0;
}



void FUN_18004e08c(undefined4 *param_1,uint *param_2)

{
  int iVar1;
  
  iVar1 = FUN_18004e4d0(*param_2,param_2[2],param_2[1]);
  FUN_1800075c4(param_1,param_2);
  *param_1 = 1;
  param_1[1] = 1;
  param_1[2] = iVar1;
  return;
}



undefined8 FUN_18004e154(undefined4 param_1,longlong param_2,uint param_3,uint *param_4)

{
  short sVar1;
  longlong lVar2;
  longlong lVar3;
  ushort *puVar4;
  ushort uVar5;
  ulonglong uVar6;
  uint uVar7;
  
  lVar2 = GetCalendar(0,param_1);
  if (lVar2 != 0) {
    lVar3 = KernelBaseGetGlobalData();
    puVar4 = (ushort *)
             GetPtrCalDataArray(param_1,*(undefined8 *)(lVar3 + 0x58),*(undefined4 *)(lVar2 + 0x14))
    ;
    uVar7 = 0;
    if (*puVar4 != 0) {
      do {
        if (param_3 <= uVar7) break;
        KernelBaseGetGlobalData();
        lVar2 = GetPtrCalData();
        sVar1 = *(short *)(lVar2 + 10);
        uVar5 = -sVar1;
        if (-1 < sVar1) {
          uVar5 = sVar1 + 1;
        }
        uVar6 = (ulonglong)uVar7;
        uVar7 = uVar7 + 1;
        *(uint *)(param_2 + uVar6 * 4) = (uint)uVar5;
      } while (uVar7 < *puVar4);
      if (uVar7 != 0) {
        *param_4 = uVar7;
        return 1;
      }
    }
  }
  return 0;
}



ulonglong FUN_18004e25c(uint *param_1)

{
  int iVar1;
  int iVar2;
  ulonglong uVar3;
  undefined4 local_38 [2];
  uint local_30;
  int local_2c;
  int local_28;
  
  uVar3 = FUN_18004e08c(local_38,param_1);
  if ((int)uVar3 != 0) {
    iVar1 = FUN_180008558(local_30,1,1);
    iVar2 = FUN_180008558(local_30,local_2c,local_28);
    uVar3 = (ulonglong)(uint)(iVar2 + (1 - iVar1));
  }
  return uVar3;
}



void FUN_18004e2ac(uint param_1,uint param_2,uint param_3,uint param_4)

{
  uint uVar1;
  ulonglong uVar2;
  
  uVar2 = FUN_18004e728(param_1,10,param_2,param_3,param_4);
  if ((int)uVar2 != 0) {
    uVar1 = FUN_18004e4d0(param_1,param_3,param_4);
    FUN_1800073fc(param_2,uVar1,1);
  }
  return;
}



int FUN_18004e318(uint *param_1,uint *param_2)

{
  int iVar1;
  int iVar2;
  undefined4 local_58 [2];
  uint local_50;
  int local_4c;
  int local_48;
  undefined4 local_30 [2];
  uint local_28;
  int local_24;
  int local_20;
  
  FUN_18004e08c(local_30,param_1);
  FUN_18004e08c(local_58,param_2);
  iVar1 = FUN_180008558(local_50,local_4c,local_48);
  iVar2 = FUN_180008558(local_28,local_24,local_20);
  return iVar1 - iVar2;
}



undefined8 FUN_18004e374(int param_1,longlong param_2,longlong param_3)

{
  ushort uVar1;
  short *psVar2;
  longlong lVar3;
  
  lVar3 = 0;
  if (param_1 == 3) {
    *(undefined4 *)(param_2 + 4) = 1;
    *(undefined4 *)(param_2 + 8) = 1;
    *(undefined4 *)(param_2 + 0xc) = 9;
    *(undefined4 *)(param_2 + 0x10) = 8;
    *(undefined4 *)(param_2 + 0x14) = 2;
    uVar1 = FUN_18004e628();
    *(uint *)(param_3 + 4) = (uint)uVar1;
    psVar2 = (short *)FUN_18004e5c8();
    if ((psVar2 != (short *)0x0) && (*psVar2 != 0)) {
      lVar3 = *(longlong *)(psVar2 + 4);
    }
    if (lVar3 == 0) {
      uVar1 = 0x1f2d;
    }
    else {
      uVar1 = 10000 - *(short *)(lVar3 + 4);
    }
    *(uint *)(param_3 + 8) = (uint)uVar1;
    *(undefined4 *)(param_3 + 0xc) = 0xc;
    *(undefined4 *)(param_3 + 0x10) = 0x1f;
    *(undefined4 *)(param_3 + 0x14) = 5;
  }
  else {
    if (param_1 == 4) {
      *(undefined4 *)(param_2 + 4) = 1;
      *(undefined4 *)(param_2 + 8) = 1;
      *(undefined4 *)(param_2 + 0xc) = 1;
      *(undefined4 *)(param_2 + 0x10) = 1;
      *(undefined4 *)(param_2 + 0x14) = 1;
      *(undefined4 *)(param_3 + 8) = 0x1f98;
    }
    else if (param_1 == 5) {
      *(undefined4 *)(param_2 + 4) = 1;
      *(undefined4 *)(param_2 + 8) = 0x91e;
      *(undefined4 *)(param_2 + 0xc) = 1;
      *(undefined4 *)(param_2 + 0x10) = 1;
      *(undefined4 *)(param_2 + 0x14) = 1;
      *(undefined4 *)(param_3 + 8) = 0x302c;
    }
    else {
      if (param_1 != 7) goto LAB_18004e48f;
      *(undefined4 *)(param_2 + 4) = 1;
      *(undefined4 *)(param_2 + 8) = 0x220;
      *(undefined4 *)(param_2 + 0xc) = 1;
      *(undefined4 *)(param_2 + 0x10) = 1;
      *(undefined4 *)(param_2 + 0x14) = 1;
      *(undefined4 *)(param_3 + 8) = 0x292e;
    }
    *(undefined4 *)(param_3 + 4) = 1;
    *(undefined4 *)(param_3 + 0xc) = 0xc;
    *(undefined4 *)(param_3 + 0x10) = 0x1f;
    *(undefined4 *)(param_3 + 0x14) = 5;
  }
LAB_18004e48f:
  *(undefined4 *)(param_3 + 0x18) = 0x17;
  *(undefined4 *)(param_3 + 0x1c) = 0x3b;
  *(undefined4 *)(param_3 + 0x20) = 0x3b;
  *(undefined4 *)(param_3 + 0x24) = 9999999;
  *(undefined8 *)(param_2 + 0x18) = 0;
  *(undefined8 *)(param_2 + 0x20) = 0;
  return 1;
}



int FUN_18004e4d0(uint param_1,int param_2,int param_3)

{
  ushort *puVar1;
  int *piVar2;
  undefined8 uVar3;
  int iVar4;
  ushort uVar5;
  longlong in_GS_OFFSET;
  uint local_res20 [2];
  
  puVar1 = (ushort *)FUN_18004e5c8();
  if (puVar1 == (ushort *)0x0) {
    uVar5 = 5;
  }
  else {
    uVar5 = *puVar1;
  }
  piVar2 = (int *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8);
  if (piVar2 == (int *)0x0) {
    RtlSetLastWin32Error(8);
    iVar4 = 0;
  }
  else {
    uVar3 = FUN_18004e154(param_1,(longlong)piVar2,(uint)uVar5,local_res20);
    iVar4 = 0;
    if (((int)uVar3 != 0) && (iVar4 = param_2, 2 < param_1)) {
      if (param_1 < 5) {
        iVar4 = param_2 + -1 + piVar2[local_res20[0] - param_3];
      }
      else if ((param_1 == 5) || (param_1 == 7)) {
        iVar4 = param_2 - *piVar2;
      }
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,piVar2);
  }
  return iVar4;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_18004e5c8(void)

{
  longlong lVar1;
  
  if (_DAT_1800b2f4c == 0) {
    lVar1 = GetCalendar(0,3);
    if (lVar1 != 0) {
      DAT_1800b2f50 = GetPtrCalDataArray(3,0,0);
    }
    _DAT_1800b2f4c = 1;
  }
  return DAT_1800b2f50;
}



undefined2 FUN_18004e628(void)

{
  undefined2 uVar1;
  undefined2 *puVar2;
  
  puVar2 = (undefined2 *)FUN_18004e5c8();
  if (puVar2 == (undefined2 *)0x0) {
    uVar1 = 5;
  }
  else {
    uVar1 = *puVar2;
  }
  return uVar1;
}



void FUN_18004e6c8(uint param_1,uint param_2,uint param_3)

{
  uint uVar1;
  ulonglong uVar2;
  
  uVar2 = FUN_18004e728(param_1,10,10,param_2,param_3);
  if ((int)uVar2 != 0) {
    uVar1 = FUN_18004e4d0(param_1,param_2,param_3);
    FUN_18000846c(uVar1,1);
  }
  return;
}



ulonglong FUN_18004e728(uint param_1,uint param_2,uint param_3,uint param_4,uint param_5)

{
  bool bVar1;
  uint uVar2;
  ulonglong uVar3;
  undefined7 extraout_var;
  undefined8 uVar4;
  uint uVar5;
  uint uVar6;
  
  uVar5 = 0;
  if (param_1 == 3) {
    uVar3 = FUN_18004e8a4(param_2,param_3,param_4,param_5);
    return uVar3;
  }
  uVar6 = 1;
  if (param_5 != 1) {
    uVar4 = 0x57;
    goto LAB_18004e7c9;
  }
  uVar2 = FUN_18004e4d0(param_1,param_4,1);
  if (param_1 == 4) {
    uVar5 = 0x1f98;
LAB_18004e7ac:
    if (uVar6 <= param_4) goto LAB_18004e7b0;
  }
  else {
    if (param_1 == 5) {
      uVar6 = 0x91e;
      uVar5 = 0x302c;
      goto LAB_18004e7ac;
    }
    if (param_1 == 7) {
      uVar6 = 0x220;
      uVar5 = 0x292e;
      goto LAB_18004e7ac;
    }
LAB_18004e7b0:
    if (param_4 <= uVar5) {
      bVar1 = FUN_1800083dc(param_2,param_3,uVar2);
      return CONCAT71(extraout_var,bVar1);
    }
  }
  uVar4 = 0x120;
LAB_18004e7c9:
  RtlSetLastWin32Error(uVar4);
  return 0;
}



void FUN_18004e7f8(uint *param_1,undefined8 param_2,int param_3)

{
  bool bVar1;
  undefined7 extraout_var;
  ulonglong uVar2;
  undefined8 uVar3;
  undefined7 extraout_var_00;
  undefined auStackY104 [32];
  uint local_38 [5];
  uint local_24;
  ulonglong local_10;
  
  local_10 = DAT_1800b2220 ^ (ulonglong)auStackY104;
  bVar1 = FUN_180008390((longlong)param_1);
  if (((((int)CONCAT71(extraout_var,bVar1) != 0) &&
       (uVar2 = FUN_18004e728(*param_1,param_1[4],param_1[3],param_1[2],param_1[1]), (int)uVar2 != 0
       )) && (param_3 != 0)) &&
     (((uVar3 = FUN_1800075c4(local_38,param_1), (int)uVar3 != 0 &&
       (bVar1 = FUN_18004e94c(local_38), (int)CONCAT71(extraout_var_00,bVar1) != 0)) &&
      (param_1[5] != local_24)))) {
    RtlSetLastWin32Error(0x120);
  }
  __security_check_cookie(local_10 ^ (ulonglong)auStackY104);
  return;
}



undefined8 FUN_18004e8a4(uint param_1,uint param_2,int param_3,uint param_4)

{
  bool bVar1;
  ushort uVar2;
  uint uVar3;
  undefined7 extraout_var;
  
  if (((((param_4 != 0) && (uVar2 = FUN_18004e628(), param_4 <= uVar2)) && (param_3 != 0)) &&
      ((((param_4 != 1 || (param_3 != 1)) || ((8 < param_2 && ((param_2 != 9 || (7 < param_1))))))
       && (uVar3 = FUN_18004e4d0(3,param_3,param_4), uVar3 < 10000)))) &&
     (bVar1 = FUN_1800083dc(param_1,param_2,uVar3), (int)CONCAT71(extraout_var,bVar1) != 0)) {
    return 1;
  }
  RtlSetLastWin32Error(0x120);
  return 0;
}



bool FUN_18004e94c(uint *param_1)

{
  int iVar1;
  uint uVar2;
  bool bVar3;
  undefined local_res10 [24];
  undefined4 local_38 [12];
  
  iVar1 = FUN_18004e7f8(param_1,local_res10,0);
  if ((iVar1 == 0) || (iVar1 = FUN_18004e08c(local_38,param_1), iVar1 == 0)) {
    bVar3 = false;
  }
  else {
    uVar2 = FUN_18000850c((longlong)local_38);
    bVar3 = uVar2 != 0xffffffff;
    if (bVar3) {
      param_1[5] = uVar2;
    }
  }
  return bVar3;
}



bool FUN_18004e9ac(uint param_1,ushort param_2,ushort param_3,ushort param_4,longlong param_5)

{
  ushort uVar1;
  longlong lVar2;
  longlong lVar3;
  bool bVar4;
  ushort local_18 [4];
  longlong local_10;
  
  local_10 = 0;
  lVar2 = GetCalendar(0,param_1);
  lVar3 = KernelBaseGetGlobalData();
  uVar1 = FUN_18004b2d4(&local_10,(short *)local_18,param_1,lVar2,*(longlong *)(lVar3 + 0x58),
                        param_2,param_3,param_4);
  bVar4 = local_10 != 0;
  if (bVar4) {
    *(uint *)(param_5 + 4) = (uint)local_18[0];
    *(uint *)(param_5 + 8) = (uint)uVar1;
  }
  else {
    RtlSetLastWin32Error(0x120);
  }
  return bVar4;
}



undefined8 FUN_18004ea7c(int param_1,longlong param_2)

{
  int iVar1;
  undefined8 uVar2;
  undefined4 local_38 [2];
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  
  iVar1 = FUN_18004dbd4(param_1,local_38);
  if ((iVar1 != 0) && (uVar2 = FUN_18004ee0c(local_38), (int)uVar2 != 0)) {
    *(undefined4 *)(param_2 + 8) = local_30;
    *(undefined4 *)(param_2 + 0xc) = local_2c;
    *(undefined4 *)(param_2 + 0x10) = local_28;
    *(undefined4 *)(param_2 + 0x14) = local_24;
    return 1;
  }
  return 0;
}



undefined8 FUN_18004ead4(undefined4 *param_1,int param_2)

{
  int iVar1;
  undefined8 uVar2;
  
  iVar1 = FUN_18004f134(param_1);
  if (iVar1 != 0) {
    if ((iVar1 + param_2) - 0xa95d2U < 0xfd52) {
      uVar2 = FUN_18004ea7c(iVar1 + param_2,(longlong)param_1);
      return uVar2;
    }
    SetLastError(0x120);
  }
  return 0;
}



undefined8 FUN_18004eb2c(undefined4 *param_1,int param_2)

{
  ulonglong uVar1;
  undefined8 uVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  
  uVar4 = param_1[4];
  iVar5 = param_1[3] + param_2;
  iVar3 = iVar5 + -1;
  if (iVar3 < 0) {
    iVar3 = iVar5 % 0xc + 0xc;
    iVar5 = (iVar5 + -0xc) / 0xc;
  }
  else {
    iVar5 = iVar3 / 0xc;
    iVar3 = iVar3 + iVar5 * -0xc + 1;
  }
  iVar5 = param_1[2] + iVar5;
  if (iVar5 - 0x526U < 0xb7) {
    if (0x1d < uVar4) {
      uVar1 = FUN_18004ed84(iVar3,iVar5,param_1[1]);
      if ((uint)uVar1 < uVar4) {
        uVar4 = (uint)uVar1;
      }
    }
    param_1[4] = uVar4;
    param_1[3] = iVar3;
    param_1[2] = iVar5;
    iVar3 = FUN_18004f134(param_1);
    uVar2 = 1;
    param_1[5] = (iVar3 + 1U) % 7;
  }
  else {
    SetLastError(0x120);
    uVar2 = 0;
  }
  return uVar2;
}



undefined8 FUN_18004ec94(undefined4 *param_1,undefined2 *param_2)

{
  bool bVar1;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined8 uVar2;
  undefined4 local_38;
  undefined4 uStack52;
  undefined4 uStack48;
  undefined4 uStack44;
  undefined4 local_28;
  undefined4 uStack36;
  undefined4 uStack32;
  undefined4 uStack28;
  undefined8 local_18;
  
  local_38 = *param_1;
  uStack52 = param_1[1];
  uStack48 = param_1[2];
  uStack44 = param_1[3];
  local_28 = param_1[4];
  uStack36 = param_1[5];
  uStack32 = param_1[6];
  uStack28 = param_1[7];
  local_18 = *(undefined8 *)(param_1 + 8);
  bVar1 = FUN_18004f184(&local_38);
  uVar2 = 0;
  if ((int)CONCAT71(extraout_var,bVar1) != 0) {
    bVar1 = FUN_18004db54((longlong)&local_38,param_2);
    if ((int)CONCAT71(extraout_var_00,bVar1) != 0) {
      uVar2 = 1;
    }
  }
  return uVar2;
}



int FUN_18004ecf8(int *param_1,undefined8 param_2)

{
  int iVar1;
  int iVar2;
  undefined8 uVar3;
  int local_38;
  int iStack52;
  int iStack48;
  undefined4 uStack44;
  undefined4 local_28;
  int iStack36;
  int iStack32;
  int iStack28;
  undefined8 local_18;
  
  uVar3 = FUN_18004efbc(param_1,param_2,1);
  if (((int)uVar3 != 0) && (iVar1 = FUN_18004f134(param_1), iVar1 != 0)) {
    local_38 = *param_1;
    iStack52 = param_1[1];
    iStack48 = param_1[2];
    iStack36 = param_1[5];
    iStack32 = param_1[6];
    iStack28 = param_1[7];
    uStack44 = 1;
    local_18 = *(undefined8 *)(param_1 + 8);
    local_28 = 1;
    FUN_18004f25c(&local_38,param_2);
    iVar2 = FUN_18004f134(&local_38);
    if (iVar2 != 0) {
      return (iVar1 - iVar2) + 1;
    }
  }
  return 0;
}



ulonglong FUN_18004ed84(int param_1,int param_2,int param_3)

{
  ushort uVar1;
  ulonglong uVar2;
  
  uVar2 = FUN_18004f0ac(param_1,param_2,param_3);
  if ((int)uVar2 != 0) {
    uVar1 = *(ushort *)(&DAT_1800893f0 + (ulonglong)(param_2 - 0x526) * 8);
    uVar2 = (ulonglong)
            (0x1d - (((uint)uVar1 - (uint)uVar1) -
                    (uint)((1 << ((char)param_1 - 1U & 0x1f) & (uint)uVar1) != 0)));
  }
  return uVar2;
}



int FUN_18004edd4(int param_1)

{
  ushort uVar1;
  uint uVar2;
  int iVar3;
  longlong lVar4;
  
  iVar3 = 0;
  lVar4 = 0xc;
  uVar1 = *(ushort *)(&DAT_1800893f0 + (ulonglong)(param_1 - 0x526) * 8);
  do {
    uVar2 = (uint)uVar1;
    uVar1 = uVar1 >> 1;
    iVar3 = iVar3 + 0x1d + (uVar2 & 1);
    lVar4 = lVar4 + -1;
  } while (lVar4 != 0);
  return iVar3;
}



undefined8 FUN_18004ee0c(undefined4 *param_1)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  longlong lVar7;
  int iVar8;
  uint uVar9;
  ulonglong uVar10;
  ushort *puVar11;
  undefined8 uVar12;
  int iStack60;
  
  iVar5 = FUN_180008558(param_1[2],param_1[3],param_1[4]);
  if ((iVar5 - 0xa95d2U < 0xfd52) && (uVar4 = (int)(iVar5 - 0xa95d2U) / 0x163, uVar4 < 0xb8)) {
    uVar1 = param_1[5];
    uVar2 = param_1[6];
    uVar3 = param_1[7];
    uVar12 = *(undefined8 *)(param_1 + 8);
    puVar11 = (ushort *)(&DAT_1800893f4 + (longlong)(int)uVar4 * 8);
    do {
      uVar9 = uVar4;
      iVar6 = FUN_180008558((uint)puVar11[-1],(uint)*puVar11,(uint)puVar11[1]);
      iVar6 = iVar5 - iVar6;
      puVar11 = puVar11 + 4;
      if (iVar6 < 1) break;
      uVar4 = uVar9 + 1;
    } while ((longlong)puVar11 < 0x1800899b4);
    if (iVar6 != 0) {
      uVar9 = uVar9 - 1;
      if ((int)uVar9 < 0) goto LAB_18004ef86;
      if ((int)uVar9 < 0xb8) {
        lVar7 = (longlong)(int)uVar9;
        iVar6 = FUN_180008558((uint)*(ushort *)(&DAT_1800893f2 + lVar7 * 8),
                              (uint)*(ushort *)(&DAT_1800893f4 + lVar7 * 8),
                              (uint)*(ushort *)(&DAT_1800893f6 + lVar7 * 8));
        iVar6 = iVar5 - iVar6;
      }
    }
    if (uVar9 < 0xb8) {
      iVar8 = 1;
      iStack60 = 1;
      uVar10 = (ulonglong)*(ushort *)(&DAT_1800893f0 + (longlong)(int)uVar9 * 8);
      iVar5 = (*(ushort *)(&DAT_1800893f0 + (longlong)(int)uVar9 * 8) & 1) + 0x1d;
      if (iVar5 <= iVar6) {
        do {
          iVar6 = iVar6 - iVar5;
          uVar10 = uVar10 >> 1;
          iVar8 = iVar8 + 1;
          iVar5 = ((uint)uVar10 & 1) + 0x1d;
          iStack60 = iVar8;
        } while (iVar5 <= iVar6);
      }
      *param_1 = 0x17;
      param_1[1] = 1;
      param_1[2] = uVar9 + 0x526;
      param_1[3] = iStack60;
      param_1[4] = iVar6 + 1;
      param_1[5] = uVar1;
      param_1[6] = uVar2;
      param_1[7] = uVar3;
      *(undefined8 *)(param_1 + 8) = uVar12;
      return 1;
    }
  }
LAB_18004ef86:
  SetLastError(0x120);
  return 0;
}



undefined8 FUN_18004efbc(int *param_1,undefined8 param_2,int param_3)

{
  int iVar1;
  undefined8 uVar2;
  
  if (*param_1 == 0x17) {
    uVar2 = FUN_18004f05c(param_1[4],param_1[3],param_1[2],param_1[1]);
    if ((int)uVar2 == 0) {
      return 0;
    }
    if (((((uint)param_1[6] < 0x18) && ((uint)param_1[7] < 0x3c)) && ((uint)param_1[8] < 0x3c)) &&
       (((uint)param_1[9] < 10000000 &&
        ((param_3 == 0 || (iVar1 = FUN_18004f134(param_1), param_1[5] == (iVar1 + 1U) % 7)))))) {
      return 1;
    }
  }
  SetLastError(0x57);
  return 0;
}



undefined8 FUN_18004f05c(uint param_1,int param_2,int param_3,int param_4)

{
  ulonglong uVar1;
  
  uVar1 = FUN_18004ed84(param_2,param_3,param_4);
  if ((uint)uVar1 != 0) {
    if ((param_1 != 0) && (param_1 <= (uint)uVar1)) {
      return 1;
    }
    SetLastError(0x57);
  }
  return 0;
}



undefined8 FUN_18004f0ac(int param_1,int param_2,int param_3)

{
  undefined8 uVar1;
  
  uVar1 = FUN_18004f0f4(param_2,param_3);
  if ((int)uVar1 != 0) {
    if (param_1 - 1U < 0xc) {
      return 1;
    }
    SetLastError(0x57);
  }
  return 0;
}



undefined8 FUN_18004f0f4(int param_1,int param_2)

{
  DWORD dwErrCode;
  
  if (param_2 == 1) {
    if (param_1 - 0x526U < 0xb7) {
      return 1;
    }
    dwErrCode = 0x120;
  }
  else {
    dwErrCode = 0x57;
  }
  SetLastError(dwErrCode);
  return 0;
}



void FUN_18004f134(undefined4 *param_1)

{
  bool bVar1;
  undefined7 extraout_var;
  undefined4 local_38;
  undefined4 uStack52;
  uint uStack48;
  int iStack44;
  int local_28;
  undefined4 uStack36;
  undefined4 uStack32;
  undefined4 uStack28;
  undefined8 local_18;
  
  local_38 = *param_1;
  uStack52 = param_1[1];
  uStack48 = param_1[2];
  iStack44 = param_1[3];
  local_28 = param_1[4];
  uStack36 = param_1[5];
  uStack32 = param_1[6];
  uStack28 = param_1[7];
  local_18 = *(undefined8 *)(param_1 + 8);
  bVar1 = FUN_18004f184(&local_38);
  if ((int)CONCAT71(extraout_var,bVar1) == 0) {
    return;
  }
  FUN_180008558(uStack48,iStack44,local_28);
  return;
}



bool FUN_18004f184(undefined4 *param_1)

{
  bool bVar1;
  uint uVar2;
  undefined7 extraout_var;
  int iVar3;
  ulonglong uVar4;
  ushort uVar5;
  undefined4 local_38;
  undefined4 uStack52;
  uint uStack48;
  uint uStack44;
  uint local_28;
  undefined4 uStack36;
  undefined4 uStack32;
  undefined4 uStack28;
  undefined4 local_18;
  undefined4 uStack20;
  
  local_38 = 1;
  uVar4 = (ulonglong)(param_1[2] - 0x526);
  uStack52 = 1;
  uStack48 = (uint)*(ushort *)(&DAT_1800893f2 + (ulonglong)(param_1[2] - 0x526) * 8);
  uStack44 = (uint)*(ushort *)(&DAT_1800893f4 + uVar4 * 8);
  uVar5 = *(ushort *)(&DAT_1800893f0 + uVar4 * 8);
  local_28 = (uint)*(ushort *)(&DAT_1800893f6 + uVar4 * 8);
  uStack36 = param_1[5];
  uStack32 = param_1[6];
  uStack28 = param_1[7];
  local_18 = param_1[8];
  uStack20 = param_1[9];
  iVar3 = param_1[4] + -1;
  if (1 < (uint)param_1[3]) {
    uVar4 = (ulonglong)(param_1[3] - 1);
    do {
      uVar2 = (uint)uVar5;
      uVar5 = uVar5 >> 1;
      iVar3 = iVar3 + 0x1d + (uVar2 & 1);
      uVar4 = uVar4 - 1;
    } while (uVar4 != 0);
  }
  bVar1 = FUN_18004daac(&local_38,iVar3);
  bVar1 = (int)CONCAT71(extraout_var,bVar1) != 0;
  if (bVar1) {
    *param_1 = local_38;
    param_1[1] = uStack52;
    param_1[2] = uStack48;
    param_1[3] = uStack44;
    param_1[4] = local_28;
    param_1[5] = uStack36;
    param_1[6] = uStack32;
    param_1[7] = uStack28;
    *(ulonglong *)(param_1 + 8) = CONCAT44(uStack20,local_18);
  }
  return bVar1;
}



undefined8 FUN_18004f25c(int *param_1,undefined8 param_2)

{
  int iVar1;
  undefined8 uVar2;
  
  uVar2 = FUN_18004efbc(param_1,param_2,0);
  if ((int)uVar2 != 0) {
    iVar1 = FUN_18004f134(param_1);
    uVar2 = 1;
    param_1[5] = (iVar1 + 1U) % 7;
  }
  return uVar2;
}



undefined8 FUN_18004f2b0(int param_1,longlong param_2)

{
  int iVar1;
  undefined8 uVar2;
  undefined4 local_38 [2];
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  
  iVar1 = FUN_18004dbd4(param_1,local_38);
  if ((iVar1 != 0) && (uVar2 = FUN_18004f868(local_38), (int)uVar2 != 0)) {
    *(undefined4 *)(param_2 + 8) = local_30;
    *(undefined4 *)(param_2 + 0xc) = local_2c;
    *(undefined4 *)(param_2 + 0x10) = local_28;
    *(undefined4 *)(param_2 + 0x14) = local_24;
    return 1;
  }
  return 0;
}



undefined8 FUN_18004f308(undefined4 *param_1,int param_2)

{
  int iVar1;
  undefined8 uVar2;
  
  iVar1 = FUN_18004fa1c(param_1);
  if (iVar1 != 0) {
    if ((iVar1 + param_2) - 0x8d115U < 0x3a8ff) {
      uVar2 = FUN_18004f2b0(iVar1 + param_2,(longlong)param_1);
      return uVar2;
    }
    SetLastError(0x120);
  }
  return 0;
}



undefined8 FUN_18004f360(undefined4 *param_1,int param_2)

{
  char cVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  ulonglong uVar5;
  uint uVar6;
  int iVar7;
  int iVar8;
  
  iVar4 = param_1[2];
  iVar8 = param_1[4];
  if (iVar4 - 0x14dfU < 0x291) {
    uVar6 = param_1[3] + param_2;
    if (param_2 < 0) {
      if ((int)uVar6 < 1) {
        iVar7 = -uVar6;
        iVar2 = iVar4;
        if (0x290 < iVar4 - 0x14e0U) goto LAB_18004f460;
        while( true ) {
          iVar4 = iVar2 + -1;
          cVar1 = FUN_18004f78c(iVar4,param_1[1]);
          iVar3 = (int)CONCAT71(extraout_var_00,cVar1);
          if (iVar7 <= iVar3) break;
          if (0x290 < iVar2 - 0x14e1U) goto LAB_18004f460;
          iVar7 = iVar7 - iVar3;
          iVar2 = iVar4;
        }
        cVar1 = FUN_18004f78c(iVar4,param_1[1]);
        uVar6 = (int)CONCAT71(extraout_var_01,cVar1) - iVar7;
      }
    }
    else {
      while( true ) {
        cVar1 = FUN_18004f78c(iVar4,param_1[1]);
        iVar2 = (int)CONCAT71(extraout_var,cVar1);
        if ((int)uVar6 <= iVar2) break;
        if (0x290 < iVar4 - 0x14deU) goto LAB_18004f460;
        uVar6 = uVar6 - iVar2;
        iVar4 = iVar4 + 1;
      }
    }
    uVar5 = FUN_18004f73c(uVar6,iVar4,param_1[1]);
    iVar2 = (int)uVar5;
    if (iVar2 != 0) {
      param_1[3] = uVar6;
      param_1[2] = iVar4;
      if (iVar2 < iVar8) {
        iVar8 = iVar2;
      }
      param_1[4] = iVar8;
      iVar4 = FUN_18004fa1c(param_1);
      param_1[5] = (iVar4 + 1U) % 7;
      return 1;
    }
  }
  else {
LAB_18004f460:
    SetLastError(0x120);
  }
  return 0;
}



undefined8 FUN_18004f494(undefined4 *param_1,int param_2)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  undefined7 extraout_var;
  ulonglong uVar4;
  undefined8 uVar5;
  uint uVar6;
  int iVar7;
  
  uVar6 = param_1[3];
  iVar7 = param_1[2] + param_2;
  iVar3 = param_1[4];
  if (iVar7 - 0x14dfU < 0x291) {
    cVar1 = FUN_18004f78c(iVar7,param_1[1]);
    uVar2 = (uint)CONCAT71(extraout_var,cVar1);
    if ((int)uVar2 < (int)uVar6) {
      uVar6 = uVar2;
    }
    uVar4 = FUN_18004f73c(uVar6,iVar7,param_1[1]);
    param_1[3] = uVar6;
    param_1[2] = iVar7;
    if ((int)uVar4 < iVar3) {
      iVar3 = (int)uVar4;
    }
    param_1[4] = iVar3;
    iVar3 = FUN_18004fa1c(param_1);
    uVar5 = 1;
    param_1[5] = (iVar3 + 1U) % 7;
  }
  else {
    SetLastError(0x120);
    uVar5 = 0;
  }
  return uVar5;
}



undefined8 FUN_18004f550(undefined4 *param_1,undefined2 *param_2)

{
  bool bVar1;
  undefined8 uVar2;
  undefined7 extraout_var;
  undefined8 uVar3;
  undefined4 local_38;
  undefined4 uStack52;
  undefined4 uStack48;
  undefined4 uStack44;
  undefined4 local_28;
  undefined4 uStack36;
  undefined4 uStack32;
  undefined4 uStack28;
  undefined8 local_18;
  
  local_38 = *param_1;
  uStack52 = param_1[1];
  uStack48 = param_1[2];
  uStack44 = param_1[3];
  local_28 = param_1[4];
  uStack36 = param_1[5];
  uStack32 = param_1[6];
  uStack28 = param_1[7];
  local_18 = *(undefined8 *)(param_1 + 8);
  uVar2 = FUN_18004fa70(&local_38);
  uVar3 = 0;
  if ((int)uVar2 != 0) {
    bVar1 = FUN_18004db54((longlong)&local_38,param_2);
    if ((int)CONCAT71(extraout_var,bVar1) != 0) {
      uVar3 = 1;
    }
  }
  return uVar3;
}



undefined8 FUN_18004f5b4(ushort *param_1,undefined4 *param_2)

{
  int iVar1;
  undefined8 uVar2;
  undefined4 local_38;
  undefined4 uStack52;
  undefined4 uStack48;
  undefined4 uStack44;
  undefined4 local_28;
  undefined4 uStack36;
  undefined4 uStack32;
  undefined4 uStack28;
  undefined8 local_18;
  
  iVar1 = FUN_18000751c(param_1,1,&local_38);
  if ((iVar1 != 0) && (uVar2 = FUN_18004f868(&local_38), (int)uVar2 != 0)) {
    *param_2 = local_38;
    param_2[1] = uStack52;
    param_2[2] = uStack48;
    param_2[3] = uStack44;
    param_2[4] = local_28;
    param_2[5] = uStack36;
    param_2[6] = uStack32;
    param_2[7] = uStack28;
    *(undefined8 *)(param_2 + 8) = local_18;
    return 1;
  }
  return 0;
}



int FUN_18004f610(uint param_1,uint param_2,int param_3,uint param_4,int param_5)

{
  byte bVar1;
  bool bVar2;
  int iVar3;
  int iVar4;
  byte *pbVar5;
  int iVar6;
  uint uVar7;
  ulonglong uVar8;
  
  uVar8 = (ulonglong)param_4;
  if (param_2 == param_4) {
    iVar4 = param_3 - param_5;
  }
  else {
    bVar2 = param_2 <= param_4;
    iVar3 = param_3;
    if (bVar2) {
      uVar8 = (ulonglong)param_2;
      iVar3 = param_5;
      param_2 = param_4;
    }
    if (bVar2) {
      param_5 = param_3;
    }
    uVar7 = (int)uVar8 + 1;
    iVar6 = (uint)(byte)(&DAT_1800899b0)[uVar8 + (ulonglong)param_1 * 0xe] - param_5;
    if (uVar7 < param_2) {
      pbVar5 = &DAT_1800899b0 + (ulonglong)uVar7 + (ulonglong)param_1 * 0xe;
      uVar8 = (ulonglong)(param_2 - uVar7);
      do {
        bVar1 = *pbVar5;
        pbVar5 = pbVar5 + 1;
        iVar6 = iVar6 + (uint)bVar1;
        uVar8 = uVar8 - 1;
      } while (uVar8 != 0);
    }
    iVar4 = iVar6 + iVar3;
    if (bVar2) {
      iVar4 = -(iVar6 + iVar3);
    }
  }
  return iVar4;
}



int FUN_18004f6bc(int *param_1,undefined8 param_2)

{
  int iVar1;
  int iVar2;
  undefined8 uVar3;
  int local_38;
  int iStack52;
  int iStack48;
  undefined4 uStack44;
  undefined4 local_28;
  int iStack36;
  int iStack32;
  int iStack28;
  undefined8 local_18;
  
  uVar3 = FUN_18004fce0(param_1,param_2,1);
  if (((int)uVar3 != 0) && (iVar1 = FUN_18004fa1c(param_1), iVar1 != 0)) {
    local_38 = *param_1;
    iStack52 = param_1[1];
    iStack48 = param_1[2];
    iStack36 = param_1[5];
    iStack32 = param_1[6];
    iStack28 = param_1[7];
    uStack44 = 1;
    local_18 = *(undefined8 *)(param_1 + 8);
    local_28 = 1;
    iVar2 = FUN_18004fa1c(&local_38);
    if (iVar2 != 0) {
      return (iVar1 - iVar2) + 1;
    }
  }
  return 0;
}



ulonglong FUN_18004f73c(uint param_1,int param_2,int param_3)

{
  ulonglong uVar1;
  
  uVar1 = FUN_18004fdd0(param_1,param_2,param_3);
  if ((int)uVar1 != 0) {
    uVar1 = (ulonglong)
            (byte)(&DAT_1800899b0)
                  [(ulonglong)(byte)(&DAT_180089a20)[param_2 * 2 - 0x29bd] * 0xe +
                   (ulonglong)param_1];
  }
  return uVar1;
}



char FUN_18004f78c(int param_1,int param_2)

{
  char cVar1;
  undefined8 uVar2;
  ulonglong uVar3;
  
  uVar2 = FUN_18004fe38(param_1,param_2);
  if ((int)uVar2 == 0) {
    cVar1 = '\0';
  }
  else {
    uVar3 = FUN_18004fc7c(param_1,param_2);
    cVar1 = ((int)uVar3 != 0) + '\f';
  }
  return cVar1;
}



undefined FUN_18004f7cc(int param_1,longlong param_2)

{
  byte bVar1;
  undefined uVar2;
  int iVar3;
  
  if ((param_2 != 0) && (param_1 - 0x62fU < 0x291)) {
    iVar3 = (param_1 - 0x62fU) * 2;
    bVar1 = (&DAT_180089a20)[iVar3];
    uVar2 = (&DAT_180089a21)[iVar3];
    *(uint *)(param_2 + 0x10) = (uint)bVar1;
    if (bVar1 == 0) {
      *(undefined4 *)(param_2 + 0x10) = 1;
    }
    else {
      if (bVar1 == 0x1e) {
        *(undefined4 *)(param_2 + 0xc) = 3;
        return uVar2;
      }
      if (bVar1 == 0x1f) {
        *(undefined4 *)(param_2 + 0x10) = 2;
      }
      else {
        if (bVar1 != 0x20) {
          if (bVar1 != 0x21) {
            *(undefined4 *)(param_2 + 0xc) = 4;
            return uVar2;
          }
          *(undefined4 *)(param_2 + 0xc) = 3;
          *(undefined4 *)(param_2 + 0x10) = 0x1d;
          return uVar2;
        }
        *(undefined4 *)(param_2 + 0x10) = 3;
      }
    }
    *(undefined4 *)(param_2 + 0xc) = 5;
    return uVar2;
  }
  return 0;
}



undefined8 FUN_18004f868(undefined4 *param_1)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  undefined8 uVar6;
  longlong lVar7;
  ulonglong uVar8;
  uint uVar9;
  undefined4 local_48;
  undefined4 uStack68;
  int iStack64;
  uint uStack60;
  uint local_38;
  undefined4 uStack52;
  undefined4 uStack48;
  undefined4 uStack44;
  undefined8 local_28;
  
  uVar3 = param_1[2];
  iVar2 = FUN_180008558(uVar3,param_1[3],param_1[4]);
  if (iVar2 - 0x8d115U < 0x3a8ff) {
    uStack60 = param_1[3];
    iStack64 = uVar3 + 0xeb0;
    local_38 = param_1[4];
    uStack52 = param_1[5];
    uStack48 = param_1[6];
    uStack44 = param_1[7];
    local_48 = 8;
    local_28 = *(undefined8 *)(param_1 + 8);
    uStack68 = 1;
    uVar3 = FUN_18004f7cc(uVar3,(longlong)&local_48);
    uVar8 = (ulonglong)uVar3;
    if ((param_1[3] != 1) || (uVar3 = local_38, param_1[4] != 1)) {
      uVar1 = param_1[2];
      iVar4 = FUN_180008558(uVar1,1,1);
      lVar7 = uVar8 * 0xe;
      uVar3 = local_38 + (iVar2 - iVar4);
      if ((byte)(&DAT_1800899b0)[lVar7 + (ulonglong)uStack60] < uVar3) {
        iVar5 = local_38 - (byte)(&DAT_1800899b0)[lVar7 + (ulonglong)uStack60];
        local_38 = 1;
        uVar9 = (iVar2 - iVar4) + iVar5;
        uStack60 = uStack60 + 1;
        uVar3 = local_38;
        if ((1 < uVar9) &&
           (uVar3 = uVar9, (byte)(&DAT_1800899b0)[(ulonglong)uStack60 + lVar7] < uVar9)) {
          do {
            uVar9 = uVar9 - (byte)(&DAT_1800899b0)[(ulonglong)uStack60 + lVar7];
            uStack60 = uStack60 + 1;
            if ((0xd < uStack60) || ((&DAT_1800899b0)[(ulonglong)uStack60 + lVar7] == '\0')) {
              uVar8 = (ulonglong)(byte)(&DAT_180089a20)[uVar1 * 2 - 0xc5b];
              iStack64 = iStack64 + 1;
              uStack60 = 1;
            }
            lVar7 = uVar8 * 0xe;
            uVar3 = uVar9;
          } while ((byte)(&DAT_1800899b0)[(ulonglong)uStack60 + lVar7] < uVar9);
        }
      }
    }
    local_38 = uVar3;
    uVar6 = 1;
    *param_1 = local_48;
    param_1[1] = uStack68;
    param_1[2] = iStack64;
    param_1[3] = uStack60;
    param_1[4] = local_38;
    param_1[5] = uStack52;
    param_1[6] = uStack48;
    param_1[7] = uStack44;
    *(undefined8 *)(param_1 + 8) = local_28;
  }
  else {
    SetLastError(0x120);
    uVar6 = 0;
  }
  return uVar6;
}



int FUN_18004fa1c(undefined4 *param_1)

{
  int iVar1;
  undefined8 uVar2;
  undefined4 local_38;
  undefined4 uStack52;
  uint uStack48;
  int iStack44;
  int local_28;
  undefined4 uStack36;
  undefined4 uStack32;
  undefined4 uStack28;
  undefined8 local_18;
  
  local_38 = *param_1;
  uStack52 = param_1[1];
  uStack48 = param_1[2];
  iStack44 = param_1[3];
  local_28 = param_1[4];
  uStack36 = param_1[5];
  uStack32 = param_1[6];
  uStack28 = param_1[7];
  local_18 = *(undefined8 *)(param_1 + 8);
  uVar2 = FUN_18004fa70(&local_38);
  if ((int)uVar2 != 0) {
    iVar1 = FUN_180008558(uStack48,iStack44,local_28);
    return iVar1;
  }
  return 0;
}



undefined8 FUN_18004fa70(undefined4 *param_1)

{
  bool bVar1;
  uint uVar2;
  int iVar3;
  undefined8 uVar4;
  undefined7 extraout_var;
  undefined4 local_58;
  undefined4 uStack84;
  int iStack80;
  undefined4 uStack76;
  undefined4 local_48;
  undefined4 uStack68;
  undefined4 uStack64;
  undefined4 uStack60;
  undefined4 local_38;
  undefined4 uStack52;
  undefined local_30 [12];
  uint local_24;
  int local_20;
  
  iStack80 = param_1[2] + -0xeb0;
  uVar2 = FUN_18004f7cc(iStack80,(longlong)local_30);
  if (uVar2 == 0) {
LAB_18004fb67:
    uVar4 = 0;
  }
  else {
    uStack68 = param_1[5];
    uStack64 = param_1[6];
    uStack60 = param_1[7];
    local_38 = param_1[8];
    uStack52 = param_1[9];
    uStack84 = 1;
    local_58 = 1;
    local_48 = 1;
    uStack76 = 1;
    if ((param_1[3] == local_24) && (param_1[4] == local_20)) {
      *param_1 = 1;
      param_1[1] = 1;
      param_1[2] = iStack80;
      param_1[3] = 1;
      param_1[4] = 1;
      param_1[5] = uStack68;
      param_1[6] = uStack64;
      param_1[7] = uStack60;
      param_1[8] = local_38;
      param_1[9] = uStack52;
    }
    else {
      iVar3 = FUN_18004f610(uVar2,param_1[3],param_1[4],local_24,local_20);
      bVar1 = FUN_18004daac(&local_58,iVar3);
      if ((int)CONCAT71(extraout_var,bVar1) == 0) goto LAB_18004fb67;
      *param_1 = local_58;
      param_1[1] = uStack84;
      param_1[2] = iStack80;
      param_1[3] = uStack76;
      param_1[4] = local_48;
      param_1[5] = uStack68;
      param_1[6] = uStack64;
      param_1[7] = uStack60;
      *(ulonglong *)(param_1 + 8) = CONCAT44(uStack52,local_38);
    }
    uVar4 = 1;
  }
  return uVar4;
}



ulonglong FUN_18004fc14(uint param_1,int param_2,int param_3)

{
  ulonglong uVar1;
  ulonglong uVar2;
  
  uVar1 = FUN_18004fdd0(param_1,param_2,param_3);
  if ((int)uVar1 != 0) {
    SetLastError(0);
    uVar2 = FUN_18004fc7c(param_2,param_3);
    uVar1 = 0;
    if (((int)uVar2 != 0) && (param_1 == 7)) {
      uVar1 = 1;
    }
  }
  return uVar1;
}



ulonglong FUN_18004fc7c(int param_1,int param_2)

{
  ulonglong uVar1;
  
  uVar1 = FUN_18004fe38(param_1,param_2);
  if ((int)uVar1 != 0) {
    SetLastError(0);
    uVar1 = (ulonglong)((param_1 * 7 + 1U) % 0x13 < 7);
  }
  return uVar1;
}



undefined8 FUN_18004fce0(int *param_1,undefined8 param_2,int param_3)

{
  int iVar1;
  undefined8 uVar2;
  
  if (*param_1 == 8) {
    uVar2 = FUN_18004fd80(param_1[4],param_1[3],param_1[2],param_1[1]);
    if ((int)uVar2 == 0) {
      return 0;
    }
    if (((((uint)param_1[6] < 0x18) && ((uint)param_1[7] < 0x3c)) && ((uint)param_1[8] < 0x3c)) &&
       (((uint)param_1[9] < 10000000 &&
        ((param_3 == 0 || (iVar1 = FUN_18004fa1c(param_1), param_1[5] == (iVar1 + 1U) % 7)))))) {
      return 1;
    }
  }
  SetLastError(0x57);
  return 0;
}



undefined8 FUN_18004fd80(uint param_1,uint param_2,int param_3,int param_4)

{
  ulonglong uVar1;
  
  uVar1 = FUN_18004f73c(param_2,param_3,param_4);
  if ((uint)uVar1 != 0) {
    if ((param_1 != 0) && (param_1 <= (uint)uVar1)) {
      return 1;
    }
    SetLastError(0x57);
  }
  return 0;
}



undefined8 FUN_18004fdd0(uint param_1,int param_2,int param_3)

{
  char cVar1;
  undefined8 uVar2;
  undefined7 extraout_var;
  
  uVar2 = FUN_18004fe38(param_2,param_3);
  if ((int)uVar2 != 0) {
    cVar1 = FUN_18004f78c(param_2,param_3);
    if ((param_1 != 0) && (param_1 <= (uint)CONCAT71(extraout_var,cVar1))) {
      return 1;
    }
    SetLastError(0x57);
  }
  return 0;
}



undefined8 FUN_18004fe38(int param_1,int param_2)

{
  DWORD dwErrCode;
  
  if (param_2 == 1) {
    if (param_1 - 0x14dfU < 0x291) {
      return 1;
    }
    dwErrCode = 0x120;
  }
  else {
    dwErrCode = 0x57;
  }
  SetLastError(dwErrCode);
  return 0;
}



undefined8 FUN_18004fe78(int *param_1,undefined8 param_2)

{
  int iVar1;
  undefined8 uVar2;
  
  uVar2 = FUN_18004fce0(param_1,param_2,0);
  if ((int)uVar2 != 0) {
    iVar1 = FUN_18004fa1c(param_1);
    uVar2 = 1;
    param_1[5] = (iVar1 + 1U) % 7;
  }
  return uVar2;
}



longlong * FUN_18004fecc(longlong *param_1,longlong param_2)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  ulonglong uVar5;
  
  *(undefined4 *)(param_1 + 1) = 0;
  *(undefined4 *)((longlong)param_1 + 0xc) = 0;
  *(undefined4 *)(param_1 + 2) = 0;
  *(undefined4 *)((longlong)param_1 + 0x14) = 0;
  *(undefined4 *)(param_1 + 3) = 0x3764f;
  *(undefined4 *)((longlong)param_1 + 0x1c) = 0x37b9da;
  *(undefined *)(param_1 + 4) = 0;
  *param_1 = (longlong)&PTR_FUN_180080460;
  uVar1 = *(uint *)(param_2 + 4);
  *(uint *)(param_1 + 1) = uVar1;
  uVar2 = *(uint *)(param_2 + 8);
  *(uint *)((longlong)param_1 + 0xc) = uVar2;
  iVar3 = *(int *)(param_2 + 0xc);
  *(int *)(param_1 + 2) = iVar3;
  iVar4 = *(int *)(param_2 + 0x10);
  *(int *)((longlong)param_1 + 0x14) = iVar4;
  uVar5 = FUN_180050320(param_1,(ulonglong)uVar1,uVar2,iVar3,iVar4);
  if ((char)uVar5 == '\0') {
    *(undefined *)(param_1 + 4) = 1;
  }
  return param_1;
}



undefined8 * FUN_18004ff50(undefined8 *param_1,ulonglong param_2)

{
  longlong in_GS_OFFSET;
  
  *param_1 = &PTR_FUN_18007f6b0;
  if ((param_2 & 1) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_1);
  }
  return param_1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_18004ffa0(longlong *param_1,int param_2)

{
  uint uVar1;
  int iVar2;
  char cVar3;
  int iVar4;
  int iVar5;
  
  iVar5 = *(int *)(param_1 + 2) + param_2;
  iVar2 = *(int *)((longlong)param_1 + 0x14);
  iVar4 = iVar5 + -1;
  if (iVar4 < 0) {
    iVar4 = iVar5 + -0xc;
    iVar5 = iVar5 % 0xc + 0xc;
  }
  else {
    iVar5 = iVar4 % 0xc + 1;
  }
  uVar1 = *(int *)((longlong)param_1 + 0xc) + iVar4 / 0xc;
  cVar3 = (**(code **)(*param_1 + 0xe8))();
  if (cVar3 == '\0') {
    *(undefined *)(param_1 + 4) = 1;
  }
  else {
    iVar4 = FUN_1800500e4(param_1,(ulonglong)uVar1,iVar5,iVar2);
    *(int *)((longlong)param_1 + 0x14) = iVar4;
    *(uint *)((longlong)param_1 + 0xc) = uVar1;
    *(int *)(param_1 + 2) = iVar5;
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_180050070(longlong *param_1,int param_2)

{
  char cVar1;
  int iVar2;
  int iVar3;
  longlong *plVar4;
  ulonglong uVar5;
  uint uVar6;
  
  uVar6 = *(int *)((longlong)param_1 + 0xc) + param_2;
  plVar4 = param_1;
  cVar1 = (**(code **)(*param_1 + 0xe0))();
  if (cVar1 == '\0') {
    *(undefined *)(param_1 + 4) = 1;
  }
  else {
    uVar5 = (ulonglong)uVar6;
    iVar2 = FUN_180050180(plVar4,uVar6,*(int *)(param_1 + 2));
    iVar3 = FUN_1800500e4(param_1,uVar5,iVar2,*(int *)((longlong)param_1 + 0x14));
    *(int *)((longlong)param_1 + 0x14) = iVar3;
    *(uint *)((longlong)param_1 + 0xc) = uVar6;
    *(int *)(param_1 + 2) = iVar2;
  }
  return;
}



int FUN_1800500e4(longlong *param_1,undefined8 param_2,int param_3,int param_4)

{
  int iVar1;
  int iVar2;
  
  iVar2 = param_4;
  if ((int)param_2 == 1) {
    if (param_3 < 2) {
      param_3 = 1;
      iVar2 = 1;
      if (0 < param_4) {
        iVar2 = param_4;
      }
    }
  }
  else if (((int)param_2 == 0x24a2) && (9 < param_3)) {
    if (0xd < param_4) {
      param_4 = 0xd;
    }
    param_3 = 10;
    iVar2 = param_4;
  }
  iVar1 = FUN_180050274(param_1,param_2,param_3);
  if (iVar1 < iVar2) {
    iVar2 = iVar1;
  }
  return iVar2;
}



void FUN_180050140(longlong *param_1)

{
  int iVar1;
  int iVar2;
  longlong *plVar3;
  ulonglong uVar4;
  
  uVar4 = (ulonglong)*(uint *)((longlong)param_1 + 0xc);
  plVar3 = param_1;
  iVar1 = FUN_180050180(param_1,*(uint *)((longlong)param_1 + 0xc),*(int *)(param_1 + 2));
  iVar2 = FUN_1800500e4(plVar3,uVar4,iVar1,*(int *)((longlong)plVar3 + 0x14));
  *(int *)(param_1 + 2) = iVar1;
  *(int *)((longlong)param_1 + 0x14) = iVar2;
  return;
}



int FUN_180050180(undefined8 param_1,int param_2,int param_3)

{
  if (param_2 == 1) {
    if (param_3 < 2) {
      return 1;
    }
  }
  else if ((param_2 == 0x24a2) && (9 < param_3)) {
    return 10;
  }
  return param_3;
}



int * FUN_1800501b0(int *param_1,int param_2,int param_3,int param_4)

{
  int iVar1;
  int iVar2;
  
  iVar1 = *(int *)(&DAT_180089ffc + (longlong)param_3 * 4);
  iVar2 = param_2 + -1;
  if (param_2 < 1) {
    iVar2 = param_2;
  }
  FUN_1800504cc(param_1,(ulonglong)((DAT_1800b224c - (int)((double)iVar2 * -365.242189)) + 0xb4));
  *param_1 = *param_1 + param_4 + -1 + iVar1;
  return param_1;
}



ulonglong FUN_180050228(longlong *param_1,longlong param_2)

{
  int iVar1;
  undefined4 extraout_var;
  
  *(undefined4 *)(param_2 + 4) = *(undefined4 *)(param_1 + 1);
  *(undefined4 *)(param_2 + 8) = *(undefined4 *)((longlong)param_1 + 0xc);
  *(undefined4 *)(param_2 + 0xc) = *(undefined4 *)(param_1 + 2);
  *(undefined4 *)(param_2 + 0x10) = *(undefined4 *)((longlong)param_1 + 0x14);
  iVar1 = FUN_180053210(param_1);
  *(int *)(param_2 + 0x14) = iVar1;
  return CONCAT44(extraout_var,iVar1) & 0xffffffffffffff00 |
         (ulonglong)(*(char *)(param_1 + 4) == '\0');
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

int FUN_180050274(longlong *param_1,undefined8 param_2,int param_3)

{
  char cVar1;
  int iVar2;
  
  iVar2 = *(int *)(&DAT_18008a000 + (longlong)param_3 * 4) -
          *(int *)(&DAT_180089ffc + (longlong)param_3 * 4);
  if (param_3 == 0xc) {
    cVar1 = (**(code **)(*param_1 + 200))();
    if (cVar1 == '\0') {
      iVar2 = iVar2 + -1;
    }
  }
  return iVar2;
}



ulonglong FUN_1800502c0(undefined8 param_1,int param_2)

{
  int *piVar1;
  int *piVar2;
  int local_res10 [2];
  int local_res18 [4];
  
  piVar1 = FUN_1800501b0(local_res10,param_2,1,1);
  piVar2 = FUN_1800501b0(local_res18,param_2 + 1,1,1);
  return (ulonglong)piVar2 & 0xffffffffffffff00 | (ulonglong)(*piVar2 - *piVar1 == 0x16e);
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

ulonglong FUN_180050320(longlong *param_1,undefined8 param_2,uint param_3,int param_4,int param_5)

{
  int iVar1;
  ulonglong uVar2;
  
  uVar2 = (**(code **)(*param_1 + 0xe8))();
  if ((char)uVar2 != '\0') {
    if ((param_3 == 0x24a2) && (param_4 == 10)) {
      iVar1 = 0xd;
    }
    else {
      iVar1 = FUN_180050274(param_1,(ulonglong)param_3,param_4);
    }
    uVar2 = 0;
    if ((0 < param_5) && (param_5 <= iVar1)) {
      return 1;
    }
  }
  return uVar2 & 0xffffffffffffff00;
}



bool FUN_1800503a0(undefined8 param_1,int param_2)

{
  return param_2 == 1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

ulonglong FUN_1800503b0(longlong *param_1,undefined8 param_2,int param_3,int param_4)

{
  int iVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  
  uVar2 = (**(code **)(*param_1 + 0xe0))();
  if (((char)uVar2 != '\0') && (uVar3 = 1, 0 < param_4)) {
    iVar1 = 10;
    if (param_3 != 0x24a2) {
      iVar1 = 0xc;
    }
    uVar2 = 0;
    if (param_4 <= iVar1) goto LAB_1800503f2;
  }
  uVar3 = 0;
LAB_1800503f2:
  return uVar2 & 0xffffffffffffff00 | uVar3;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

ulonglong FUN_180050410(longlong *param_1,undefined8 param_2,int param_3)

{
  ulonglong uVar1;
  byte bVar2;
  
  uVar1 = (**(code **)(*param_1 + 0xd8))();
  bVar2 = 0;
  if (((char)uVar1 != '\0') && (uVar1 = (ulonglong)(param_3 - 1U), param_3 - 1U < 0x24a2)) {
    bVar2 = 1;
  }
  return uVar1 & 0xffffffffffffff00 | (ulonglong)bVar2;
}



double * FUN_18005044c(undefined8 param_1,double param_2,double *param_3,undefined8 param_4)

{
  double extraout_XMM0_Qa;
  
  FUN_1800525b8(232.5);
  FUN_180052558(extraout_XMM0_Qa - 180.0,param_2,param_3,param_4,extraout_XMM0_Qa - 180.0);
  return param_3;
}



int * FUN_1800504a0(longlong param_1,int *param_2)

{
  FUN_1800501b0(param_2,*(int *)(param_1 + 0xc),*(int *)(param_1 + 0x10),*(int *)(param_1 + 0x14));
  return param_2;
}



int * FUN_1800504cc(int *param_1,undefined8 param_2)

{
  double dVar1;
  int iVar2;
  double *pdVar3;
  double dVar4;
  double extraout_XMM0_Qa;
  double extraout_XMM0_Qa_00;
  double extraout_XMM0_Qa_01;
  double _X;
  double dVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  undefined4 uVar12;
  undefined4 uVar13;
  double local_res8;
  double local_res18;
  double local_res20;
  
  iVar2 = (int)param_2;
  uVar6 = 0;
  uVar7 = 0x40668000;
  FUN_1800525b8(180.0);
  local_res8 = extraout_XMM0_Qa - (double)CONCAT44(uVar7,uVar6);
  uVar10 = SUB84(local_res8,0);
  uVar11 = (undefined4)((ulonglong)local_res8 >> 0x20);
  FUN_1800525b8(182.0);
  FUN_1800525b8((extraout_XMM0_Qa_00 - (double)CONCAT44(uVar7,uVar6)) +
                (double)CONCAT44(uVar11,uVar10) + (double)CONCAT44(uVar7,uVar6));
  dVar4 = extraout_XMM0_Qa_01 - (double)CONCAT44(uVar7,uVar6);
  uVar12 = SUB84(dVar4,0);
  uVar13 = (undefined4)((ulonglong)dVar4 >> 0x20);
  pdVar3 = FUN_18005044c(extraout_XMM0_Qa_01,(double)(iVar2 + 1),&local_res18,param_2);
  dVar4 = *pdVar3;
  FUN_180052358(local_res8,dVar4);
  dVar5 = floor(_X);
  dVar1 = dVar5 - 1.0;
  uVar6 = SUB84(dVar1,0);
  uVar8 = SUB84(dVar1 + 3.0,0);
  uVar9 = (undefined4)((ulonglong)(dVar1 + 3.0) >> 0x20);
  uVar7 = (undefined4)((ulonglong)dVar1 >> 0x20);
  while ((double)CONCAT44(uVar7,uVar6) != (double)CONCAT44(uVar9,uVar8)) {
    FUN_18005044c(dVar5,CONCAT44(uVar7,uVar6),&local_res8,dVar4);
    dVar4 = local_res8;
    FUN_180051c18(&local_res18,local_res8);
    local_res20 = local_res18;
    if (((double)CONCAT44(uVar11,uVar10) <= local_res18) &&
       (local_res18 <= (double)CONCAT44(uVar13,uVar12))) break;
    dVar1 = (double)CONCAT44(uVar7,uVar6) + 1.0;
    uVar6 = SUB84(dVar1,0);
    dVar5 = local_res18;
    uVar7 = (undefined4)((ulonglong)dVar1 >> 0x20);
  }
  *param_1 = (int)(double)CONCAT44(uVar7,uVar6) + -1;
  return param_1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_180050600(longlong *param_1,undefined8 param_2)

{
  int iVar1;
  char cVar2;
  int *piVar3;
  ulonglong uVar4;
  int iVar5;
  int iVar6;
  double dVar7;
  int local_res10 [2];
  
  FUN_1800504cc(local_res10,param_2);
  dVar7 = floor((double)(local_res10[0] - DAT_1800b224c) / 365.242189 + 0.5);
  iVar5 = (int)dVar7;
  if (-1 < iVar5) {
    iVar5 = iVar5 + 1;
  }
  piVar3 = FUN_1800501b0(local_res10,iVar5,1,1);
  iVar6 = ((int)param_2 - *piVar3) + 1;
  uVar4 = FUN_1800530fc(iVar6);
  iVar1 = *(int *)(&DAT_180089ffc + (longlong)(int)uVar4 * 4);
  cVar2 = (**(code **)(*param_1 + 0xf0))();
  if (cVar2 == '\0') {
    *(undefined *)(param_1 + 4) = 1;
  }
  else {
    *(int *)((longlong)param_1 + 0xc) = iVar5;
    *(int *)(param_1 + 2) = (int)uVar4;
    *(int *)((longlong)param_1 + 0x14) = iVar6 - iVar1;
  }
  return;
}



int FUN_1800506e0(longlong *param_1)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  
  uVar1 = *(uint *)((longlong)param_1 + 0xc);
  iVar2 = *(int *)(param_1 + 2);
  iVar3 = FUN_180050274(param_1,(ulonglong)uVar1,iVar2);
  if ((((uVar1 != 1) || (iVar2 != 1)) && (uVar1 == 0x24a2)) && (iVar2 == 10)) {
    iVar3 = 0xd;
  }
  return iVar3;
}



undefined8 FUN_180050730(longlong param_1)

{
  undefined8 uVar1;
  
  uVar1 = 0xc;
  if (*(int *)(param_1 + 0xc) == 0x24a2) {
    uVar1 = 10;
  }
  return uVar1;
}



bool FUN_18005074c(longlong param_1,int param_2)

{
  longlong local_38 [4];
  char local_18;
  
  FUN_18004fecc(local_38,param_1);
  FUN_180053150(local_38,param_2);
  if (local_18 == '\0') {
    FUN_180050228(local_38,param_1);
  }
  else {
    SetLastError(0x57);
  }
  return local_18 == '\0';
}



bool FUN_1800507b4(longlong param_1,int param_2)

{
  longlong local_38 [4];
  char local_18;
  
  FUN_18004fecc(local_38,param_1);
  FUN_18004ffa0(local_38,param_2);
  if (local_18 == '\0') {
    FUN_180050228(local_38,param_1);
  }
  else {
    SetLastError(0x57);
  }
  return local_18 == '\0';
}



bool FUN_18005081c(longlong param_1,int param_2)

{
  longlong local_38 [4];
  char local_18;
  
  FUN_18004fecc(local_38,param_1);
  FUN_180050070(local_38,param_2);
  if (local_18 == '\0') {
    FUN_180050228(local_38,param_1);
  }
  else {
    SetLastError(0x57);
  }
  return local_18 == '\0';
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_180050884(longlong param_1,undefined2 *param_2)

{
  undefined auStack136 [32];
  int local_68;
  longlong local_60;
  longlong local_58 [4];
  char local_38;
  undefined2 local_30;
  undefined2 local_2e;
  undefined2 local_2c;
  undefined2 local_22;
  ulonglong local_20;
  
  local_20 = DAT_1800b2220 ^ (ulonglong)auStack136;
  FUN_18004fecc(local_58,param_1);
  (**(code **)(local_58[0] + 0xf8))();
  local_60 = (longlong)(local_68 + -0x8eac4) * 864000000000;
  if ((local_38 == '\0') && (-1 < local_60)) {
    RtlTimeToTimeFields(&local_60);
    *param_2 = local_30;
    param_2[1] = local_2e;
    param_2[3] = local_2c;
    param_2[2] = local_22;
    param_2[4] = *(undefined2 *)(param_1 + 0x18);
    param_2[5] = *(undefined2 *)(param_1 + 0x1c);
    param_2[6] = *(undefined2 *)(param_1 + 0x20);
    param_2[7] = (short)((ulonglong)*(uint *)(param_1 + 0x24) / 10000);
  }
  else {
    SetLastError(0x57);
  }
  __security_check_cookie(local_20 ^ (ulonglong)auStack136);
  return;
}



void FUN_180050990(undefined2 *param_1,longlong param_2)

{
  char cVar1;
  longlong lVar2;
  undefined auStack136 [32];
  longlong local_68;
  undefined **local_60;
  undefined4 local_58;
  undefined4 uStack84;
  undefined4 uStack80;
  undefined4 uStack76;
  undefined4 local_48;
  undefined4 local_44;
  undefined local_40;
  undefined2 local_38;
  undefined2 local_36;
  undefined2 local_34;
  undefined8 local_32;
  ulonglong local_28;
  
  local_28 = DAT_1800b2220 ^ (ulonglong)auStack136;
  local_38 = *param_1;
  local_36 = param_1[1];
  local_34 = param_1[3];
  local_32 = 0;
  cVar1 = RtlTimeFieldsToTime(&local_38,&local_68);
  if (cVar1 == '\0') {
    SetLastError(0x57);
  }
  else {
    local_60 = &PTR_FUN_180080460;
    local_48 = 0x3764f;
    lVar2 = local_68 / 864000000000;
    local_44 = 0x37b9da;
    local_40 = 0;
    local_58 = 1;
    uStack84 = 1;
    uStack80 = 1;
    uStack76 = 1;
    if (lVar2 < 0) {
      if (lVar2 * 864000000000 - local_68 != 0) {
        lVar2 = lVar2 + -1;
      }
    }
    else if ((lVar2 == 0) && (local_68 < 0)) {
      lVar2 = -1;
    }
    FUN_1800531e8((longlong *)&local_60,(int)lVar2 + 0x8eac4);
    FUN_180050228((longlong *)&local_60,param_2);
    *(uint *)(param_2 + 0x18) = (uint)(ushort)param_1[4];
    *(uint *)(param_2 + 0x1c) = (uint)(ushort)param_1[5];
    *(uint *)(param_2 + 0x20) = (uint)(ushort)param_1[6];
    *(uint *)(param_2 + 0x24) = (uint)(ushort)param_1[7] * 10000;
  }
  __security_check_cookie(local_28 ^ (ulonglong)auStack136);
  return;
}



int FUN_180050b18(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  undefined **local_38;
  undefined4 local_30;
  undefined4 uStack44;
  undefined4 uStack40;
  undefined4 uStack36;
  undefined4 local_20;
  undefined4 local_1c;
  char local_18;
  
  local_20 = 0x3764f;
  local_1c = 0x37b9da;
  iVar1 = 0;
  local_18 = '\0';
  local_38 = &PTR_FUN_180080460;
  local_30 = 1;
  uStack44 = 1;
  uStack40 = 1;
  uStack36 = 1;
  FUN_1800533d0((longlong *)&local_38,param_3);
  FUN_180053490((longlong *)&local_38,param_2);
  FUN_180053430((longlong *)&local_38,param_1);
  if (local_18 == '\0') {
    iVar1 = FUN_1800506e0((longlong *)&local_38);
  }
  else {
    SetLastError(0x57);
  }
  return iVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

int FUN_180050bbc(undefined4 param_1,undefined4 param_2)

{
  char cVar1;
  int iVar2;
  undefined **local_38;
  undefined4 local_30;
  undefined4 uStack44;
  undefined4 uStack40;
  undefined4 uStack36;
  undefined4 local_20;
  undefined4 local_1c;
  char local_18;
  
  local_20 = 0x3764f;
  local_1c = 0x37b9da;
  iVar2 = 0;
  local_18 = '\0';
  local_38 = &PTR_FUN_180080460;
  local_30 = 1;
  uStack44 = 1;
  uStack40 = 1;
  uStack36 = 1;
  FUN_1800533d0((longlong *)&local_38,param_2);
  FUN_180053490((longlong *)&local_38,param_1);
  if (local_18 == '\0') {
    cVar1 = (*(code *)local_38[0x19])();
    iVar2 = (cVar1 != '\0') + 0x16d;
  }
  else {
    SetLastError(0x57);
  }
  return iVar2;
}



int FUN_180050c64(longlong param_1,longlong param_2)

{
  int iVar1;
  int local_res18 [2];
  int local_res20 [2];
  longlong local_58 [4];
  char local_38;
  longlong local_30 [4];
  char local_10;
  
  FUN_18004fecc(local_58,param_1);
  FUN_18004fecc(local_30,param_2);
  iVar1 = 0;
  if ((local_38 == '\0') && (local_10 == '\0')) {
    FUN_1800504a0((longlong)local_58,local_res20);
    FUN_1800504a0((longlong)local_30,local_res18);
    iVar1 = local_res18[0] - local_res20[0];
  }
  else {
    SetLastError(0x57);
  }
  return iVar1;
}



undefined8 FUN_180050d84(longlong param_1,longlong param_2)

{
  undefined **local_38;
  undefined4 local_30;
  undefined4 uStack44;
  undefined4 uStack40;
  undefined4 uStack36;
  undefined4 local_20;
  int local_1c;
  undefined local_18;
  
  local_1c = 0x37b9da;
  local_20 = 0x3764f;
  local_18 = 0;
  local_38 = &PTR_FUN_180080460;
  local_30 = 1;
  uStack44 = 1;
  uStack40 = 1;
  uStack36 = 1;
  FUN_1800531e8((longlong *)&local_38,0x3764f);
  FUN_180050228((longlong *)&local_38,param_1);
  *(undefined4 *)(param_1 + 0x18) = 0;
  *(undefined4 *)(param_1 + 0x1c) = 0;
  *(undefined4 *)(param_1 + 0x20) = 0;
  *(undefined4 *)(param_1 + 0x24) = 0;
  FUN_1800531e8((longlong *)&local_38,local_1c);
  FUN_180050228((longlong *)&local_38,param_2);
  *(undefined4 *)(param_2 + 0x1c) = 0x3b;
  *(undefined4 *)(param_2 + 0x20) = 0x3b;
  *(undefined4 *)(param_2 + 0x18) = 0x17;
  *(undefined4 *)(param_2 + 0x24) = 9999999;
  return 1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

bool FUN_180050fac(undefined4 param_1,undefined4 param_2)

{
  char cVar1;
  bool bVar2;
  undefined **local_38;
  undefined4 local_30;
  undefined4 uStack44;
  undefined4 uStack40;
  undefined4 uStack36;
  undefined4 local_20;
  undefined4 local_1c;
  char local_18;
  
  local_20 = 0x3764f;
  local_1c = 0x37b9da;
  bVar2 = false;
  local_18 = '\0';
  local_38 = &PTR_FUN_180080460;
  local_30 = 1;
  uStack44 = 1;
  uStack40 = 1;
  uStack36 = 1;
  FUN_1800533d0((longlong *)&local_38,param_2);
  FUN_180053490((longlong *)&local_38,param_1);
  if (local_18 == '\0') {
    cVar1 = (*(code *)local_38[0x19])();
    bVar2 = cVar1 != '\0';
  }
  else {
    SetLastError(0x57);
  }
  return bVar2;
}



undefined8 FUN_18005104c(longlong param_1)

{
  int iVar1;
  longlong local_38 [4];
  char local_18;
  
  FUN_18004fecc(local_38,param_1);
  if ((((local_18 == '\0') && (iVar1 = FUN_180053210(local_38), iVar1 == *(int *)(param_1 + 0x14)))
      && (*(uint *)(param_1 + 0x18) < 0x18)) &&
     (((*(uint *)(param_1 + 0x1c) < 0x3c && (*(uint *)(param_1 + 0x20) < 0x3c)) &&
      (*(uint *)(param_1 + 0x24) < 10000000)))) {
    return 1;
  }
  SetLastError(0x57);
  return 0;
}



bool FUN_1800510c8(longlong param_1)

{
  int iVar1;
  longlong local_38 [4];
  char local_18;
  
  FUN_18004fecc(local_38,param_1);
  if (local_18 == '\0') {
    iVar1 = FUN_180053210(local_38);
    *(int *)(param_1 + 0x14) = iVar1;
  }
  else {
    SetLastError(0x57);
  }
  return local_18 == '\0';
}



undefined8 FUN_180051124(int param_1,undefined4 *param_2,uint param_3)

{
  int iVar1;
  uint uVar2;
  undefined8 uVar3;
  ulonglong uVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  uint uVar8;
  
  if (param_1 - 0x376c5U < 0x344316) {
    iVar1 = FUN_180051574(param_3);
    uVar8 = param_1 + 1 + iVar1;
    uVar5 = (uVar8 * 0x1e - 0x67eb16) / 0x2987;
    uVar7 = uVar5 + 1;
    uVar2 = FUN_1800514f8(uVar7);
    uVar3 = FUN_180051a0c(uVar7,1);
    iVar6 = 0;
    iVar1 = 0;
    if ((int)uVar3 != 0) {
      uVar4 = FUN_180051860(uVar7,1);
      iVar1 = ((int)uVar4 != 0) + 0x162;
    }
    if (uVar8 < uVar2) {
      uVar7 = uVar5;
      uVar2 = uVar2 - iVar1;
    }
    else if (uVar8 == uVar2) {
      uVar3 = FUN_180051a0c(uVar5,1);
      if ((int)uVar3 != 0) {
        uVar4 = FUN_180051860(uVar5,1);
        iVar6 = ((int)uVar4 != 0) + 0x162;
      }
      uVar7 = uVar5;
      uVar2 = uVar2 - iVar6;
    }
    else if (iVar1 + uVar2 < uVar8) {
      uVar7 = uVar5 + 2;
      uVar2 = iVar1 + uVar2;
    }
    uVar5 = 1;
    uVar8 = uVar8 - uVar2;
    do {
      if (uVar8 < (uint)(&DAT_180089fc8)[uVar5 - 1] || uVar8 == (&DAT_180089fc8)[uVar5 - 1]) break;
      uVar5 = uVar5 + 1;
    } while (uVar5 < 0xd);
    if (uVar5 - 2 < 0xc) {
      param_2[4] = uVar8 - (&DAT_180089fc8)[uVar5 - 2];
      param_2[2] = uVar7;
      param_2[3] = uVar5 - 1;
      param_2[5] = (param_1 + 1U) % 7;
      *param_2 = 6;
      param_2[1] = 1;
      return 1;
    }
  }
  return 0;
}



undefined8 FUN_18005128c(undefined4 *param_1,int param_2)

{
  int iVar1;
  undefined8 uVar2;
  
  iVar1 = FUN_18005179c((longlong)param_1);
  if ((param_2 + iVar1) - 0x376c5U < 0x344316) {
    uVar2 = FUN_180051124(param_2 + iVar1,param_1,0);
  }
  else {
    SetLastError(0x120);
    uVar2 = 0;
  }
  return uVar2;
}



undefined8 FUN_1800512e4(longlong param_1,int param_2)

{
  int iVar1;
  undefined8 uVar2;
  ulonglong uVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  
  uVar5 = *(uint *)(param_1 + 0x10);
  iVar6 = *(int *)(param_1 + 0xc) + param_2;
  iVar1 = iVar6 + -1;
  if (iVar1 < 0) {
    uVar4 = iVar6 % 0xc + 0xc;
    iVar6 = (iVar6 + -0xc) / 0xc;
  }
  else {
    iVar6 = iVar1 / 0xc;
    uVar4 = iVar1 + iVar6 * -0xc + 1;
  }
  iVar6 = *(int *)(param_1 + 8) + iVar6;
  uVar2 = FUN_1800519a8(uVar4,iVar6,*(int *)(param_1 + 4));
  if ((int)uVar2 != 0) {
    if (0x1d < uVar5) {
      uVar3 = FUN_180051744(uVar4,iVar6,*(int *)(param_1 + 4));
      if ((uint)uVar3 < uVar5) {
        uVar5 = (uint)uVar3;
      }
    }
    if (((iVar6 != 0x25c2) || (uVar4 != 4)) || (uVar5 < 4)) {
      *(uint *)(param_1 + 0x10) = uVar5;
      *(uint *)(param_1 + 0xc) = uVar4;
      *(int *)(param_1 + 8) = iVar6;
      iVar1 = FUN_18005179c(param_1);
      *(uint *)(param_1 + 0x14) = (iVar1 + 1U) % 7;
      return 1;
    }
  }
  SetLastError(0x120);
  return 0;
}



undefined FUN_180051408(longlong param_1,undefined2 *param_2)

{
  bool bVar1;
  int iVar2;
  undefined4 local_38 [6];
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  
  iVar2 = FUN_18005179c(param_1);
  if ((iVar2 != 0) && (iVar2 = FUN_18004dbd4(iVar2,local_38), iVar2 != 0)) {
    local_20 = *(undefined4 *)(param_1 + 0x18);
    local_1c = *(undefined4 *)(param_1 + 0x1c);
    local_18 = *(undefined4 *)(param_1 + 0x20);
    local_14 = *(undefined4 *)(param_1 + 0x24);
    bVar1 = FUN_18004db54((longlong)local_38,param_2);
    return bVar1;
  }
  return 0;
}



undefined8 FUN_180051470(ushort *param_1,undefined4 *param_2,uint param_3)

{
  int iVar1;
  undefined8 uVar2;
  
  iVar1 = FUN_180008558((uint)*param_1,(uint)param_1[1],(uint)param_1[3]);
  if ((iVar1 != 0) && (uVar2 = FUN_180051124(iVar1,param_2,param_3), (int)uVar2 != 0)) {
    param_2[6] = (uint)param_1[4];
    param_2[7] = (uint)param_1[5];
    param_2[8] = (uint)param_1[6];
    param_2[9] = (uint)param_1[7] * 10000;
    param_2[5] = (uint)param_1[2];
    return 1;
  }
  return 0;
}



int FUN_1800514f8(int param_1)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  
  uVar2 = (param_1 - 1U) / 0x1e;
  iVar4 = (uVar2 * 0x4ddd2) / 0x1e + 0x376c5;
  iVar3 = param_1 + uVar2 * -0x1e + -1;
  if (iVar3 != 0) {
    uVar2 = iVar3 * 0xb + 0xe;
    do {
      uVar1 = uVar2 % 0x1e;
      uVar2 = uVar2 - 0xb;
      iVar4 = iVar4 + (uVar1 < 0xb) + 0x162;
      iVar3 = iVar3 + -1;
    } while (iVar3 != 0);
  }
  return iVar4;
}



void FUN_180051574(uint param_1)

{
  int iVar1;
  wchar_t *pwVar2;
  undefined auStack632 [32];
  undefined4 local_258;
  longlong local_248;
  undefined *local_240;
  undefined local_238 [544];
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack632;
  local_258 = 3;
  local_248 = 0;
  iVar1 = OpenRegKey(&local_248,0,L"Control Panel\\International",0x20019);
  if (iVar1 < 0) {
    SetLastError(0x3f1);
  }
  else {
    local_240 = local_238;
    pwVar2 = L"AddHijriDateTemp";
    if ((param_1 >> 0x1e & 1) == 0) {
      pwVar2 = L"AddHijriDate";
    }
    iVar1 = FUN_18001f2f0(local_248,pwVar2,&local_240);
    if (local_248 != 0) {
      NtClose();
      local_248 = 0;
    }
    if ((-1 < iVar1) && (0x17 < *(uint *)(local_240 + 0xc))) {
      wcsncmp((wchar_t *)(local_240 + *(uint *)(local_240 + 8)),L"AddHijriDate",0xc);
    }
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack632);
  return;
}



ulonglong FUN_1800516d0(undefined4 *param_1,undefined8 param_2)

{
  int iVar1;
  int iVar2;
  ulonglong uVar3;
  undefined4 local_38;
  undefined4 uStack52;
  undefined4 uStack48;
  undefined4 uStack44;
  undefined4 local_28;
  undefined4 uStack36;
  undefined4 uStack32;
  undefined4 uStack28;
  undefined8 local_18;
  
  uVar3 = FUN_1800518bc((longlong)param_1,param_2,1);
  if ((int)uVar3 != 0) {
    iVar1 = FUN_18005179c((longlong)param_1);
    local_38 = *param_1;
    uStack52 = param_1[1];
    uStack48 = param_1[2];
    uStack36 = param_1[5];
    uStack32 = param_1[6];
    uStack28 = param_1[7];
    uStack44 = 1;
    local_18 = *(undefined8 *)(param_1 + 8);
    local_28 = 1;
    iVar2 = FUN_18005179c((longlong)&local_38);
    uVar3 = (ulonglong)((iVar1 - iVar2) + 1);
  }
  return uVar3;
}



ulonglong FUN_180051744(uint param_1,int param_2,int param_3)

{
  ulonglong uVar1;
  
  uVar1 = FUN_1800519a8(param_1,param_2,param_3);
  if ((int)uVar1 != 0) {
    if (param_1 == 0xc) {
      uVar1 = FUN_180051860(param_2,param_3);
      uVar1 = (ulonglong)(((int)uVar1 != 0) + 0x1d);
    }
    else {
      uVar1 = (ulonglong)((param_1 & 1) + 0x1d);
    }
  }
  return uVar1;
}



int FUN_18005179c(longlong param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  iVar3 = FUN_180051574(0);
  iVar1 = (&DAT_180089fc8)[*(int *)(param_1 + 0xc) - 1];
  iVar2 = *(int *)(param_1 + 0x10);
  iVar4 = FUN_1800514f8(*(int *)(param_1 + 8));
  return iVar4 + -1 + ((iVar1 + iVar2) - iVar3);
}



ulonglong FUN_180051860(int param_1,int param_2)

{
  ulonglong uVar1;
  
  uVar1 = FUN_180051a0c(param_1,param_2);
  if ((int)uVar1 != 0) {
    SetLastError(0);
    uVar1 = (ulonglong)((param_1 * 0xb + 0xeU) % 0x1e < 0xb);
  }
  return uVar1;
}



undefined8 FUN_1800518bc(longlong param_1,undefined8 param_2,int param_3)

{
  int iVar1;
  undefined8 uVar2;
  
  uVar2 = FUN_180051958(*(uint *)(param_1 + 0x10),*(uint *)(param_1 + 0xc),*(int *)(param_1 + 8),
                        *(int *)(param_1 + 4));
  if ((int)uVar2 != 0) {
    if ((((*(uint *)(param_1 + 0x18) < 0x18) && (*(uint *)(param_1 + 0x1c) < 0x3c)) &&
        (*(uint *)(param_1 + 0x20) < 0x3c)) &&
       ((*(uint *)(param_1 + 0x24) < 10000000 &&
        ((param_3 == 0 ||
         (iVar1 = FUN_18005179c(param_1), *(uint *)(param_1 + 0x14) == (iVar1 + 1U) % 7)))))) {
      return 1;
    }
    SetLastError(0x57);
  }
  return 0;
}



undefined8 FUN_180051958(uint param_1,uint param_2,int param_3,int param_4)

{
  ulonglong uVar1;
  
  uVar1 = FUN_180051744(param_2,param_3,param_4);
  if ((uint)uVar1 != 0) {
    if ((param_1 != 0) && (param_1 <= (uint)uVar1)) {
      return 1;
    }
    SetLastError(0x57);
  }
  return 0;
}



undefined8 FUN_1800519a8(uint param_1,int param_2,int param_3)

{
  undefined8 uVar1;
  DWORD dwErrCode;
  
  uVar1 = FUN_180051a0c(param_2,param_3);
  if ((int)uVar1 != 0) {
    if (param_1 - 1 < 0xc) {
      if ((param_2 != 0x25c2) || (param_1 < 5)) {
        return 1;
      }
      dwErrCode = 0x120;
    }
    else {
      dwErrCode = 0x57;
    }
    SetLastError(dwErrCode);
  }
  return 0;
}



undefined8 FUN_180051a0c(int param_1,int param_2)

{
  DWORD dwErrCode;
  
  if (param_2 == 1) {
    if (param_1 - 1U < 0x25c2) {
      return 1;
    }
    dwErrCode = 0x120;
  }
  else {
    dwErrCode = 0x57;
  }
  SetLastError(dwErrCode);
  return 0;
}



undefined8 FUN_180051a48(longlong param_1,undefined8 param_2)

{
  int iVar1;
  undefined8 uVar2;
  
  uVar2 = FUN_1800518bc(param_1,param_2,0);
  if ((int)uVar2 != 0) {
    iVar1 = FUN_18005179c(param_1);
    uVar2 = 1;
    *(uint *)(param_1 + 0x14) = (iVar1 + 1U) % 7;
  }
  return uVar2;
}



ulonglong FUN_180051a9c(int param_1,int param_2)

{
  uint uVar1;
  uint uVar2;
  ulonglong uVar3;
  
  uVar3 = (longlong)param_1 / (longlong)param_2 & 0xffffffff;
  uVar1 = (uint)uVar3;
  if ((int)uVar1 < 0) {
    uVar2 = uVar1 - 1;
    if (uVar1 * param_2 == param_1) {
      uVar2 = uVar1;
    }
    uVar3 = (ulonglong)uVar2;
  }
  else if (uVar1 == 0) {
    if (param_1 < 0) {
      if (param_2 < 0) {
        return uVar3;
      }
    }
    else if (-1 < param_2) {
      return uVar3;
    }
    uVar3 = 0xffffffff;
  }
  return uVar3;
}



double FUN_180051ae8(undefined8 param_1,undefined8 param_2,double param_3,double *param_4,
                    double *param_5)

{
  unkfloat1 in_AL;
  ulonglong uVar1;
  ulonglong uVar2;
  
  if (param_4 != param_5) {
    uVar2 = 0;
    uVar1 = (ulonglong)((longlong)param_5 + (7 - (longlong)(param_4 + 1))) >> 3;
    if (param_5 < param_4 + 1) {
      uVar1 = uVar2;
    }
    if (uVar1 != 0) {
      do {
        uVar2 = uVar2 + 1;
      } while (uVar2 != uVar1);
    }
    return (double)(unkfloat1)uVar1;
  }
  return (double)in_AL;
}



bool FUN_180051b48(double param_1)

{
  bool bVar1;
  bool bVar2;
  
  if (param_1 == 0.0) {
    bVar1 = 1.0 / param_1 == 0.0;
    bVar2 = 0.0 < 1.0 / param_1;
  }
  else {
    bVar1 = param_1 == 0.0;
    bVar2 = 0.0 < param_1;
  }
  return !bVar2 && !bVar1;
}



double * FUN_180051b74(double *param_1,double *param_2,double param_3)

{
  double dVar1;
  
  dVar1 = (double)FUN_180052068(*param_1 - param_3 / 360.0);
  *param_2 = *param_1 - dVar1;
  return param_2;
}



int FUN_180051bdc(uint param_1)

{
  int local_res10 [6];
  
  FUN_1800526f4(local_res10,param_1,7);
  return local_res10[0] + -0xa955b;
}



double * FUN_180051c18(double *param_1,double param_2)

{
  undefined4 uVar1;
  double dVar2;
  undefined4 uVar3;
  double extraout_XMM0_Qa;
  undefined4 uVar4;
  undefined4 uVar5;
  
  dVar2 = FUN_180052520(param_2);
  uVar1 = SUB84(dVar2,0);
  uVar3 = (undefined4)((ulonglong)dVar2 >> 0x20);
  dVar2 = FUN_18005277c(dVar2);
  dVar2 = dVar2 * 5.729577951308232e-06 +
          (double)CONCAT44(uVar3,uVar1) * 36000.76953744 + 282.7771834;
  uVar4 = SUB84(dVar2,0);
  uVar5 = (undefined4)((ulonglong)dVar2 >> 0x20);
  dVar2 = cos((((double)CONCAT44(uVar3,uVar1) * 35999.01848 + 177.63) * 3.141592653589793) / 180.0);
  dVar2 = (double)CONCAT44(uVar5,uVar4) + (dVar2 * 9.74e-05 - 0.005575);
  uVar4 = SUB84(dVar2,0);
  uVar5 = (undefined4)((ulonglong)dVar2 >> 0x20);
  dVar2 = (double)FUN_180052604(CONCAT44(uVar3,uVar1));
  FUN_1800525b8((double)CONCAT44(uVar5,uVar4) + dVar2 + 180.0);
  *param_1 = extraout_XMM0_Qa - 180.0;
  return param_1;
}



double FUN_180051cf0(uint param_1)

{
  uint uVar1;
  double dVar2;
  double dVar3;
  int local_res10 [6];
  
  FUN_1800526f4(local_res10,param_1,1);
  dVar2 = 1.0;
  uVar1 = 2;
  dVar3 = (double)(local_res10[0] + -0xa14f3) + 0.5;
  while( true ) {
    if ((uVar1 & 1) != 0) {
      dVar2 = dVar2 * dVar3;
    }
    uVar1 = uVar1 >> 1;
    if (uVar1 == 0) break;
    dVar3 = dVar3 * dVar3;
  }
  return (dVar2 / 41048480.0 - 15.0) / 86400.0;
}



void FUN_180051d70(undefined8 param_1,undefined8 param_2,int param_3)

{
  undefined auStack72 [32];
  undefined4 local_28;
  undefined4 uStack36;
  undefined4 uStack32;
  undefined4 uStack28;
  undefined8 local_18;
  double local_10 [2];
  
  local_10[0] = (double)(DAT_1800b2220 ^ (ulonglong)auStack72);
  local_28 = 0xa3ad18d2;
  uStack36 = 0x406892aa;
  uStack32 = 0xb851eb85;
  uStack28 = 0xc010451e;
  local_18 = 0x3f967154d6f1e9bd;
  FUN_180051ae8(0x3f967154d6f1e9bd,param_2,(double)(param_3 + -0x640),(double *)&local_28,local_10);
  __security_check_cookie((ulonglong)local_10[0] ^ (ulonglong)auStack72);
  return;
}



void FUN_180051de0(int param_1)

{
  undefined auStack88 [32];
  double local_38;
  undefined8 uStack48;
  undefined8 local_28;
  undefined8 uStack32;
  double local_18 [3];
  
  local_18[0] = (double)(DAT_1800b2220 ^ (ulonglong)auStack88);
  local_38 = 8.118780842;
  uStack48 = 0xbf74db7f75b495a7;
  local_28 = 0x3f6b545a52e55dc6;
  uStack32 = 0xbefbf1601a96051a;
  FUN_180051ae8(0x40203cd0d7af900c,0x3f6b545a52e55dc6,(double)(param_1 + -0x6a4),&local_38,local_18)
  ;
  __security_check_cookie((ulonglong)local_18[0] ^ (ulonglong)auStack88);
  return;
}



void FUN_180051e50(uint param_1)

{
  undefined4 extraout_XMM0_Da;
  undefined4 extraout_XMM0_Db;
  undefined4 uVar1;
  undefined4 uVar2;
  undefined auStack152 [32];
  undefined4 local_78;
  undefined4 uStack116;
  undefined4 uStack112;
  undefined4 uStack108;
  undefined4 local_68;
  undefined4 uStack100;
  undefined4 uStack96;
  undefined4 uStack92;
  undefined4 local_58;
  undefined4 uStack84;
  undefined4 uStack80;
  undefined4 uStack76;
  undefined4 local_48;
  undefined4 uStack68;
  undefined4 uStack64;
  undefined4 uStack60;
  undefined4 local_38;
  undefined4 uStack52;
  undefined4 uStack48;
  undefined4 uStack44;
  undefined8 local_28;
  double local_20;
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack152;
  local_78 = 0x94ccab3f;
  uStack116 = 0xbee2dfd6;
  uStack112 = 0xc9257860;
  uStack108 = 0x3f6f7d73;
  local_68 = 0x8027d88c;
  uStack100 = 0x3fb56462;
  uStack96 = 0xfbdf090f;
  uStack92 = 0x3febb41b;
  local_58 = 0x94af4f0e;
  uStack84 = 0x40137865;
  uStack80 = 0xf6a93f29;
  uStack76 = 0x402fb0e9;
  local_48 = 0x733a8a40;
  uStack68 = 0x403f550f;
  uStack64 = 0x3925bb7b;
  uStack60 = 0x40432560;
  uVar1 = 0xab2e1694;
  uVar2 = 0x400059b0;
  local_28 = 0x400059b0ab2e1694;
  local_38 = 0x50df15a5;
  uStack52 = 0x403c50f8;
  uStack48 = 0x87db2b34;
  uStack44 = 0x402745bc;
  FUN_180051bdc(param_1);
  FUN_180051ae8(CONCAT44(extraout_XMM0_Db,extraout_XMM0_Da),CONCAT44(uVar2,uVar1),
                (double)CONCAT44(extraout_XMM0_Db,extraout_XMM0_Da),(double *)&local_78,&local_20);
  __security_check_cookie(local_18 ^ (ulonglong)auStack152);
  return;
}



void FUN_180051ef0(uint param_1)

{
  undefined4 extraout_XMM0_Da;
  undefined4 extraout_XMM0_Db;
  undefined4 uVar1;
  undefined4 uVar2;
  undefined auStack120 [32];
  undefined4 local_58;
  undefined4 uStack84;
  undefined4 uStack80;
  undefined4 uStack76;
  undefined4 local_48;
  undefined4 uStack68;
  undefined4 uStack64;
  undefined4 uStack60;
  undefined4 local_38;
  undefined4 uStack52;
  undefined4 uStack48;
  undefined4 uStack44;
  undefined4 local_28;
  undefined4 uStack36;
  undefined4 uStack32;
  undefined4 uStack28;
  double local_18 [3];
  
  local_18[0] = (double)(DAT_1800b2220 ^ (ulonglong)auStack120);
  local_58 = 0x88e368f1;
  uStack84 = 0xbef4f8b5;
  uStack80 = 0x49731099;
  uStack76 = 0x3f3376d5;
  local_48 = 0xa187a4a5;
  uStack68 = 0x3f99c9d5;
  uStack64 = 0xbb9cf9a0;
  uStack60 = 0xbfc72f5d;
  uVar1 = 0x50e77920;
  uVar2 = 0x3fe5aa86;
  local_38 = 0xf12c27a6;
  uStack52 = 0x3fe1b280;
  uStack48 = 0x25bfad;
  uStack44 = 0xbfeb94ff;
  local_28 = 0x50e77920;
  uStack36 = 0x3fe5aa86;
  uStack32 = 0x90364389;
  uStack28 = 0xbfcb362e;
  FUN_180051bdc(param_1);
  FUN_180051ae8(CONCAT44(extraout_XMM0_Db,extraout_XMM0_Da),CONCAT44(uVar2,uVar1),
                (double)CONCAT44(extraout_XMM0_Db,extraout_XMM0_Da),(double *)&local_58,local_18);
  __security_check_cookie((ulonglong)local_18[0] ^ (ulonglong)auStack120);
  return;
}



int FUN_180051f70(int param_1)

{
  return param_1 + -0x78d;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_180051f90(double param_1)

{
  int iVar1;
  int *piVar2;
  undefined auStack168 [32];
  int local_88 [2];
  code *local_80;
  undefined4 local_78;
  code *local_70;
  undefined4 local_68;
  code *local_60;
  undefined4 local_58;
  code *local_50;
  undefined4 local_48;
  code *local_40;
  undefined4 local_38;
  code *local_30;
  int local_28 [2];
  code *local_20;
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack168;
  local_88[0] = 0x7e4;
  local_80 = FUN_180051cf0;
  local_70 = FUN_180051f70;
  local_60 = FUN_180051ef0;
  local_50 = FUN_180051e50;
  local_40 = FUN_180051de0;
  local_30 = FUN_180051d70;
  local_78 = 0x7c4;
  local_68 = 0x76c;
  local_58 = 0x708;
  local_48 = 0x6a4;
  local_38 = 0x654;
  local_28[0] = -0x80000000;
  local_20 = FUN_180051cf0;
  iVar1 = FUN_180052414(param_1);
  piVar2 = local_88;
  do {
    if (*piVar2 == iVar1 || *piVar2 < iVar1) break;
    piVar2 = piVar2 + 4;
  } while (piVar2 != local_28);
  (**(code **)(piVar2 + 2))();
  __security_check_cookie(local_18 ^ (ulonglong)auStack168);
  return;
}



void FUN_180052068(double param_1)

{
  double dVar1;
  uint uVar2;
  uint uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  double dVar9;
  undefined4 uVar10;
  undefined8 extraout_XMM0_Qa;
  undefined4 uVar11;
  undefined8 extraout_XMM0_Qa_00;
  undefined4 uVar12;
  undefined8 extraout_XMM0_Qa_01;
  undefined4 uVar13;
  double extraout_XMM0_Qa_02;
  undefined4 uVar14;
  undefined4 uVar15;
  undefined4 uVar16;
  undefined4 uVar17;
  uint uVar18;
  undefined4 uVar19;
  undefined4 uVar20;
  undefined4 uVar21;
  undefined4 uVar22;
  undefined4 uVar23;
  undefined4 uVar24;
  undefined auStack248 [32];
  double local_d8;
  double local_d0;
  double local_c8;
  double local_c0;
  undefined8 uStack184;
  undefined8 local_b0;
  undefined4 uStack168;
  undefined4 uStack164;
  double local_a0 [19];
  
  local_a0[0] = (double)(DAT_1800b2220 ^ (ulonglong)auStack248);
  dVar9 = FUN_180052520(param_1);
  local_c0 = 280.46645;
  uStack184 = 0x40e19418a272862f;
  uVar4 = SUB84(dVar9,0);
  uVar10 = (undefined4)((ulonglong)dVar9 >> 0x20);
  local_b0 = 0x3f33deda158aabc0;
  FUN_180051ae8(dVar9,0x3f33deda158aabc0,dVar9,&local_c0,(double *)&uStack168);
  local_b0 = 0xbf246f22cd8a61ee;
  uStack168 = 0x29a4692b;
  uStack164 = 0xbea01b2b;
  uVar5 = (undefined4)extraout_XMM0_Qa;
  uVar11 = (undefined4)((ulonglong)extraout_XMM0_Qa >> 0x20);
  local_c0 = 357.5291;
  uStack184 = 0x40e193e19c0ebee0;
  FUN_180051ae8(extraout_XMM0_Qa,0x40765877318fc505,(double)CONCAT44(uVar10,uVar4),&local_c0,
                local_a0);
  uVar6 = (undefined4)extraout_XMM0_Qa_00;
  uVar12 = (undefined4)((ulonglong)extraout_XMM0_Qa_00 >> 0x20);
  local_b0 = 0xbe8096dd18f8b401;
  local_c0 = 0.016708617;
  uStack184 = 0xbf060a1c525fe303;
  FUN_180051ae8(0xbe8096dd18f8b401,0x3f911c104e4e3915,(double)CONCAT44(uVar10,uVar4),&local_c0,
                (double *)&uStack168);
  local_b0 = 0xbe85ff2de9770fa3;
  uStack168 = 0x8b8ade57;
  uStack164 = 0x3ea0e5fc;
  uVar7 = (undefined4)extraout_XMM0_Qa_01;
  uVar13 = (undefined4)((ulonglong)extraout_XMM0_Qa_01 >> 0x20);
  local_c0 = 23.43929111111111;
  uStack184 = 0xbf8aa1edb45c4bea;
  FUN_180051ae8(extraout_XMM0_Qa_01,0x4037707561dba54e,(double)CONCAT44(uVar10,uVar4),&local_c0,
                local_a0);
  uVar17 = 0;
  uVar18 = 0x3fe00000;
  uVar21 = 0x54442d18;
  uVar22 = 0x400921fb;
  uVar23 = 0;
  uVar24 = 0x40668000;
  dVar9 = (extraout_XMM0_Qa_02 * 0.5 * 3.141592653589793) / 180.0;
  uVar8 = SUB84(dVar9,0);
  uVar14 = (undefined4)((ulonglong)dVar9 >> 0x20);
  dVar9 = sin(dVar9);
  uVar4 = SUB84(dVar9,0);
  uVar10 = (undefined4)((ulonglong)dVar9 >> 0x20);
  local_d8 = cos((double)CONCAT44(uVar14,uVar8));
  local_d8 = (double)CONCAT44(uVar10,uVar4) / local_d8;
  local_d8 = local_d8 * local_d8;
  uVar15 = SUB84(local_d8,0);
  uVar16 = (undefined4)((ulonglong)local_d8 >> 0x20);
  dVar9 = (((double)CONCAT44(uVar11,uVar5) + (double)CONCAT44(uVar11,uVar5)) *
          (double)CONCAT44(uVar22,uVar21)) / (double)CONCAT44(uVar24,uVar23);
  uVar4 = SUB84(dVar9,0);
  uVar10 = (undefined4)((ulonglong)dVar9 >> 0x20);
  dVar9 = sin(dVar9);
  uVar8 = SUB84(dVar9,0);
  uVar14 = (undefined4)((ulonglong)dVar9 >> 0x20);
  local_d0 = sin(((double)CONCAT44(uVar12,uVar6) * (double)CONCAT44(uVar22,uVar21)) /
                 (double)CONCAT44(uVar24,uVar23));
  local_c8 = cos((double)CONCAT44(uVar10,uVar4));
  uVar19 = 0;
  uVar20 = 0x3ff00000;
  uVar3 = 2;
  uVar2 = 2;
  uVar4 = uVar19;
  uVar10 = uVar20;
  while( true ) {
    if ((uVar2 & 1) != 0) {
      dVar9 = (double)CONCAT44(uVar10,uVar4) * (double)CONCAT44(uVar16,uVar15);
      uVar4 = SUB84(dVar9,0);
      uVar10 = (undefined4)((ulonglong)dVar9 >> 0x20);
    }
    uVar2 = uVar2 >> 1;
    if (uVar2 == 0) break;
    dVar9 = (double)CONCAT44(uVar16,uVar15) * (double)CONCAT44(uVar16,uVar15);
    uVar15 = SUB84(dVar9,0);
    uVar16 = (undefined4)((ulonglong)dVar9 >> 0x20);
  }
  dVar9 = sin(((double)CONCAT44(uVar11,uVar5) * 4.0 * (double)CONCAT44(uVar22,uVar21)) /
              (double)CONCAT44(uVar24,uVar23));
  uVar5 = uVar7;
  uVar11 = uVar13;
  while( true ) {
    if ((uVar3 & 1) != 0) {
      dVar1 = (double)CONCAT44(uVar20,uVar19) * (double)CONCAT44(uVar11,uVar5);
      uVar19 = SUB84(dVar1,0);
      uVar20 = (undefined4)((ulonglong)dVar1 >> 0x20);
    }
    uVar3 = uVar3 >> 1;
    if (uVar3 == 0) break;
    dVar1 = (double)CONCAT44(uVar11,uVar5) * (double)CONCAT44(uVar11,uVar5);
    uVar5 = SUB84(dVar1,0);
    uVar11 = (undefined4)((ulonglong)dVar1 >> 0x20);
  }
  dVar9 = (((double)CONCAT44(uVar14,uVar8) * local_d8 -
           ((double)CONCAT44(uVar13,uVar7) + (double)CONCAT44(uVar13,uVar7)) * local_d0) +
          (double)CONCAT44(uVar13,uVar7) * 4.0 * local_d8 * local_d0 * local_c8) -
          (double)CONCAT44(uVar10,uVar4) * (double)CONCAT44(uVar18,uVar17) * dVar9;
  uVar4 = SUB84(dVar9,0);
  uVar10 = (undefined4)((ulonglong)dVar9 >> 0x20);
  dVar9 = sin((((double)CONCAT44(uVar12,uVar6) + (double)CONCAT44(uVar12,uVar6)) *
              (double)CONCAT44(uVar22,uVar21)) / (double)CONCAT44(uVar24,uVar23));
  dVar9 = ((double)CONCAT44(uVar10,uVar4) - dVar9 * (double)CONCAT44(uVar20,uVar19) * 1.25) /
          6.283185307179586;
  if ((double)((ulonglong)dVar9 & 0x7fffffffffffffff) <= (double)CONCAT44(uVar18,uVar17)) {
    uVar17 = SUB84(dVar9,0);
    uVar18 = (uint)((ulonglong)dVar9 >> 0x20) & 0x7fffffff;
  }
  FUN_180051b48(dVar9);
  FUN_180051b48((double)CONCAT44(uVar18,uVar17));
  __security_check_cookie((ulonglong)local_a0[0] ^ (ulonglong)auStack248);
  return;
}



undefined8 FUN_180052358(double param_1,double param_2)

{
  undefined8 uVar1;
  double extraout_XMM0_Qa;
  double dVar2;
  double local_res18 [2];
  
  FUN_180051c18(local_res18,param_2);
  FUN_1800525b8((local_res18[0] - param_1) + 180.0);
  dVar2 = extraout_XMM0_Qa - 180.0;
  if (dVar2 < 0.0) {
    dVar2 = dVar2 + 360.0;
  }
  local_res18[0] = param_2 - dVar2 * 1.014561636111111;
  FUN_180051c18(local_res18,local_res18[0]);
  uVar1 = FUN_1800525b8((local_res18[0] - param_1) + 180.0);
  return uVar1;
}



int FUN_180052414(double param_1)

{
  int *piVar1;
  double dVar2;
  int local_res8 [2];
  int local_res10 [6];
  
  dVar2 = floor(param_1 - 1.0);
  local_res8[0] = (int)dVar2;
  piVar1 = FUN_18005244c(local_res10,local_res8);
  return *piVar1;
}



int * FUN_18005244c(int *param_1,int *param_2)

{
  ulonglong uVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  iVar3 = *param_2;
  uVar1 = FUN_180051a9c(iVar3,0x23ab1);
  iVar3 = iVar3 + (int)uVar1 * -0x23ab1;
  iVar2 = iVar3 / 0x8eac + -1;
  if (0x8eab < iVar3 - 0x23ab0U) {
    iVar2 = iVar3 / 0x8eac;
  }
  iVar3 = iVar3 + iVar2 * -0x8eac;
  iVar4 = iVar3 % 0x5b5;
  iVar5 = iVar4 / 0x16d + -1;
  if (0x16c < iVar4 - 0x5b4U) {
    iVar5 = iVar4 / 0x16d;
  }
  *param_1 = ((iVar2 + (int)uVar1 * 4) * 0x19 + iVar3 / 0x5b5) * 4 + 1 + iVar5;
  param_1[1] = iVar4 + iVar5 * -0x16d + 1;
  return param_1;
}



double FUN_180052520(double param_1)

{
  double dVar1;
  
  dVar1 = (double)FUN_180051f90(param_1);
  return ((dVar1 + param_1) - 730120.5) / 36525.0;
}



double * FUN_180052558(undefined8 param_1,double param_2,double *param_3,undefined8 param_4,
                      double param_5)

{
  double *pdVar1;
  double local_res8;
  double local_res10;
  double local_res18 [2];
  
  local_res8 = param_2 + 0.5;
  local_res10 = param_5;
  pdVar1 = FUN_180051b74(&local_res8,local_res18,param_5);
  *param_3 = *pdVar1 - local_res10 / 360.0;
  return param_3;
}



undefined8 FUN_1800525b8(double param_1)

{
  undefined8 extraout_RAX;
  
  floor(param_1 / 360.0);
  return extraout_RAX;
}



void FUN_180052604(double param_1)

{
  double extraout_XMM0_Qa;
  double dVar1;
  double extraout_XMM0_Qa_00;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined auStack136 [32];
  undefined4 local_68;
  undefined4 uStack100;
  undefined4 uStack96;
  undefined4 uStack92;
  undefined8 local_58;
  undefined4 local_50;
  undefined4 uStack76;
  undefined4 uStack72;
  undefined4 uStack68;
  undefined8 local_40;
  double local_38 [7];
  
  local_38[0] = (double)(DAT_1800b2220 ^ (ulonglong)auStack136);
  local_68 = 0x9999999a;
  uStack100 = 0x405f3999;
  uStack96 = 0x374bc6a8;
  uStack92 = 0xc09e3889;
  local_58 = 0x3f60e66cb10342ab;
  uVar2 = 0xadea8976;
  uVar3 = 0x3f42ad81;
  local_50 = 0x1eb851ec;
  uStack76 = 0x40692385;
  uStack72 = 0x9a6b50b1;
  uStack68 = 0x40f19418;
  local_40 = 0x3f42ad81adea8976;
  FUN_180051ae8(param_1,0x3f42ad81adea8976,param_1,(double *)&local_68,(double *)&local_50);
  dVar1 = sin((extraout_XMM0_Qa * 3.141592653589793) / 180.0);
  FUN_180051ae8(dVar1,CONCAT44(uVar3,uVar2),param_1,(double *)&local_50,local_38);
  sin((extraout_XMM0_Qa_00 * 3.141592653589793) / 180.0);
  __security_check_cookie((ulonglong)local_38[0] ^ (ulonglong)auStack136);
  return;
}



int * FUN_1800526f4(int *param_1,uint param_2,int param_3)

{
  ulonglong uVar1;
  int iVar2;
  undefined *puVar3;
  int iVar4;
  
  iVar2 = param_2 - 1;
  uVar1 = FUN_1800534e8(param_2);
  puVar3 = &DAT_18008a070;
  if ((char)uVar1 == '\0') {
    puVar3 = &DAT_18008a038;
  }
  iVar4 = *(int *)(puVar3 + (longlong)param_3 * 4 + -4) + iVar2 * 0x16d;
  uVar1 = FUN_180051a9c(iVar2,100);
  iVar4 = iVar4 - (int)uVar1;
  uVar1 = FUN_180051a9c(iVar2,400);
  iVar4 = iVar4 + (int)uVar1;
  uVar1 = FUN_180051a9c(iVar2,4);
  *param_1 = iVar4 + (int)uVar1;
  return param_1;
}



double FUN_18005277c(double param_1)

{
  double dVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  
  uVar4 = 0;
  uVar5 = 0x40668000;
  uVar6 = 0x54442d18;
  uVar7 = 0x400921fb;
  dVar1 = sin(((param_1 * 0.9287892 + 270.54861) * 3.141592653589793) / 180.0);
  dVar1 = dVar1 * 403406.0 + 0.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 35999.1376958 + 340.19128) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 195207.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 35999.4089666 + 63.91854) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 119433.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 35998.7287385 + 331.2622) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 112392.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 71998.20260999999 + 317.843) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 3891.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 71998.4403 + 86.631) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 2819.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 36000.35726 + 240.052) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 1721.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 71997.48119999999 + 310.26) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 660.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 32964.4678 + 247.23) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 350.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((260.87 - param_1 * 19.441) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 334.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 445267.1117 + 297.82) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 314.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 45036.884 + 343.14) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 268.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 3.1008 + 166.79) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 242.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 22518.4434 + 81.53) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 234.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((3.5 - param_1 * 19.9739) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 158.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 65928.9345 + 132.75) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 132.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 9038.0293 + 182.95) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 129.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 3034.7684 + 162.03) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 114.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 33718.148 + 29.8) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 99.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 3034.448 + 266.4) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 93.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((249.2 - param_1 * 2280.773) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 86.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 29929.992 + 157.6) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 78.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 31556.493 + 257.8) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 72.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 149.588 + 185.1) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 68.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 9037.75 + 69.90000000000001) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 64.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 107997.405 + 8.0) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 46.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((197.1 - param_1 * 4444.176) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 38.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 151.771 + 250.4) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 37.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 67555.31600000001 + 65.3) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 32.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 31556.08 + 162.7) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 29.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((341.5 - param_1 * 4561.54) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 28.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 107996.706 + 291.6) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 27.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 1221.655 + 98.5) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 27.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 62894.167 + 146.7) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 25.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 31437.369 + 110.0) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 24.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 14578.298 + 5.2) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 21.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((342.6 - param_1 * 31931.757) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 21.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 34777.243 + 230.9) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 20.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 1221.999 + 256.1) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 18.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 62894.511 + 45.3) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 17.0;
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((242.9 - param_1 * 4442.039) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 14.0;
  uVar8 = SUB84(dVar1,0);
  uVar9 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 107997.909 + 115.2) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  uVar2 = 0;
  uVar3 = 0x402a0000;
  dVar1 = (double)CONCAT44(uVar9,uVar8) + dVar1 * 13.0;
  uVar8 = SUB84(dVar1,0);
  uVar9 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 119.066 + 151.8) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar9,uVar8) + dVar1 * (double)CONCAT44(uVar3,uVar2);
  uVar8 = SUB84(dVar1,0);
  uVar9 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 16859.071 + 285.3) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar9,uVar8) + dVar1 * (double)CONCAT44(uVar3,uVar2);
  uVar2 = SUB84(dVar1,0);
  uVar3 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((53.3 - param_1 * 4.578) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar3,uVar2) + dVar1 * 12.0;
  uVar8 = SUB84(dVar1,0);
  uVar9 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 26895.292 + 126.6) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  uVar2 = 0;
  uVar3 = 0x40240000;
  dVar1 = (double)CONCAT44(uVar9,uVar8) + dVar1 * 10.0;
  uVar8 = SUB84(dVar1,0);
  uVar9 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((205.7 - param_1 * 39.127) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar9,uVar8) + dVar1 * (double)CONCAT44(uVar3,uVar2);
  uVar8 = SUB84(dVar1,0);
  uVar9 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 12297.536 + 85.90000000000001) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  dVar1 = (double)CONCAT44(uVar9,uVar8) + dVar1 * (double)CONCAT44(uVar3,uVar2);
  uVar8 = SUB84(dVar1,0);
  uVar9 = (undefined4)((ulonglong)dVar1 >> 0x20);
  dVar1 = sin(((param_1 * 90073.77800000001 + 146.1) * (double)CONCAT44(uVar7,uVar6)) /
              (double)CONCAT44(uVar5,uVar4));
  return (double)CONCAT44(uVar9,uVar8) + dVar1 * (double)CONCAT44(uVar3,uVar2);
}



ulonglong FUN_1800530fc(int param_1)

{
  longlong lVar1;
  int *piVar2;
  longlong lVar3;
  
  piVar2 = (int *)&DAT_18008a000;
  lVar3 = 0xd;
  do {
    lVar1 = lVar3 / 2;
    if (piVar2[lVar1] < param_1) {
      piVar2 = piVar2 + lVar1 + 1;
      lVar1 = lVar3 + (-1 - lVar1);
    }
    lVar3 = lVar1;
  } while (0 < lVar1);
  return (longlong)(piVar2 + -0x60022800) >> 2 & 0xffffffff;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_180053150(longlong *param_1,int param_2)

{
  int local_res10;
  
  if (param_2 != 0) {
    (**(code **)(*param_1 + 0xf8))();
    FUN_1800531e8(param_1,local_res10 + param_2);
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_1800531a0(longlong *param_1)

{
  longlong lVar1;
  
  lVar1 = *param_1;
  (**(code **)(lVar1 + 0x20))();
  (**(code **)(lVar1 + 0x28))();
                    // WARNING: Treating indirect jump as call
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_1800531e8(longlong *param_1,int param_2)

{
  if ((*(int *)(param_1 + 3) <= param_2) && (param_2 <= *(int *)((longlong)param_1 + 0x1c))) {
    (**(code **)(*param_1 + 0x100))();
                    // WARNING: Treating indirect jump as call
    return;
  }
  *(undefined *)(param_1 + 4) = 1;
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

int FUN_180053210(longlong *param_1)

{
  int iVar1;
  int iVar2;
  int local_res8;
  
  (**(code **)(*param_1 + 0xf8))();
  iVar2 = (local_res8 + 1) % 7;
  iVar1 = iVar2 + 7;
  if (-1 < iVar2) {
    iVar1 = iVar2;
  }
  return iVar1;
}



bool FUN_180053260(longlong param_1,int param_2)

{
  return param_2 == *(int *)(param_1 + 8);
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

int FUN_180053270(longlong *param_1)

{
  int iVar1;
  int iVar2;
  
  iVar1 = (**(code **)(*param_1 + 0xb0))();
  iVar2 = (**(code **)(*param_1 + 0xc0))();
  return iVar2 + iVar1 + -1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_1800532c0(longlong *param_1)

{
  (**(code **)(*param_1 + 0x18))();
                    // WARNING: Treating indirect jump as call
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

int FUN_1800532e0(longlong *param_1)

{
  int iVar1;
  int iVar2;
  
  iVar1 = (**(code **)(*param_1 + 0x80))();
  iVar2 = (**(code **)(*param_1 + 0x90))();
  return iVar2 + iVar1 + -1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

int FUN_180053330(longlong *param_1)

{
  int iVar1;
  int iVar2;
  
  iVar1 = (**(code **)(*param_1 + 0x38))();
  iVar2 = (**(code **)(*param_1 + 0x48))();
  return iVar2 + iVar1 + -1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_180053380(longlong *param_1,undefined4 param_2)

{
  char cVar1;
  
  cVar1 = (**(code **)(*param_1 + 0xf0))();
  if (cVar1 == '\0') {
    *(undefined *)(param_1 + 4) = 1;
  }
  else {
    *(undefined4 *)((longlong)param_1 + 0x14) = param_2;
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_1800533d0(longlong *param_1,undefined4 param_2)

{
  char cVar1;
  
  cVar1 = (**(code **)(*param_1 + 0xd8))();
  if (cVar1 == '\0') {
    *(undefined *)(param_1 + 4) = 1;
  }
  else {
    *(undefined4 *)(param_1 + 1) = param_2;
    (**(code **)(*param_1 + 0xd0))();
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_180053430(longlong *param_1,undefined4 param_2)

{
  char cVar1;
  
  cVar1 = (**(code **)(*param_1 + 0xe8))();
  if (cVar1 == '\0') {
    *(undefined *)(param_1 + 4) = 1;
  }
  else {
    *(undefined4 *)(param_1 + 2) = param_2;
    (**(code **)(*param_1 + 0xd0))();
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_180053490(longlong *param_1,undefined4 param_2)

{
  char cVar1;
  
  cVar1 = (**(code **)(*param_1 + 0xe0))();
  if (cVar1 == '\0') {
    *(undefined *)(param_1 + 4) = 1;
  }
  else {
    *(undefined4 *)((longlong)param_1 + 0xc) = param_2;
    (**(code **)(*param_1 + 0xd0))();
  }
  return;
}



ulonglong FUN_1800534e8(uint param_1)

{
  uint uVar1;
  ulonglong uVar2;
  byte bVar3;
  
  uVar2 = (longlong)(int)param_1 / 4 & 0xffffffff;
  bVar3 = 0;
  if (((int)param_1 % 4 == 0) &&
     ((uVar2 = (ulonglong)(uint)-((int)param_1 >> 0x1f), param_1 != ((int)param_1 / 100) * 100 ||
      (uVar1 = ((int)param_1 / 400) * 400, uVar2 = (ulonglong)uVar1, param_1 == uVar1)))) {
    bVar3 = 1;
  }
  return uVar2 & 0xffffffffffffff00 | (ulonglong)bVar3;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

BOOL EnumSystemGeoID(GEOCLASS GeoClass,GEOID ParentGeoId,GEO_ENUMPROC lpGeoEnumProc)

{
  int iVar1;
  int iVar2;
  longlong lVar3;
  undefined8 uVar4;
  int *piVar5;
  longlong lVar6;
  
                    // 0x53550  343  EnumSystemGeoID
  lVar3 = KernelBaseGetGlobalData();
  iVar1 = *(int *)(lVar3 + 0x70);
  lVar3 = KernelBaseGetGlobalData();
  lVar6 = 0;
  if (lpGeoEnumProc == (GEO_ENUMPROC)0x0) {
    uVar4 = 0x57;
  }
  else {
    if ((GeoClass < 0x11) && ((0x14001U >> (GeoClass & 0x1f) & 1) != 0)) {
      if (0 < iVar1) {
        piVar5 = (int *)(*(longlong *)(lVar3 + 0x78) + 0x38);
        do {
          if ((((piVar5[-1] == GeoClass) || (GeoClass == 0)) &&
              ((*piVar5 == ParentGeoId || (ParentGeoId == 0)))) &&
             (((*(short *)(piVar5 + 5) != 0 && (piVar5[-0xe] != 0x10d)) &&
              (iVar2 = (*lpGeoEnumProc)(), iVar2 == 0)))) {
            return 1;
          }
          lVar6 = lVar6 + 1;
          piVar5 = piVar5 + 0x1a;
        } while (lVar6 < iVar1);
      }
      return 1;
    }
    uVar4 = 0x3ec;
  }
  RtlSetLastWin32Error(uVar4);
  return 0;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

undefined8 EnumSystemGeoNames(uint param_1,undefined *param_2)

{
  int iVar1;
  int iVar2;
  longlong lVar3;
  longlong lVar4;
  undefined4 uVar5;
  int iVar6;
  uint *puVar7;
  longlong lVar8;
  
                    // 0x53640  344  EnumSystemGeoNames
  lVar3 = KernelBaseGetGlobalData();
  iVar1 = *(int *)(lVar3 + 0x60);
  lVar3 = KernelBaseGetGlobalData();
  lVar3 = *(longlong *)(lVar3 + 0x68);
  lVar4 = KernelBaseGetGlobalData();
  lVar4 = *(longlong *)(lVar4 + 0x78);
  if (param_2 == (undefined *)0x0) {
    uVar5 = 0x57;
  }
  else {
    if ((param_1 < 0x11) && ((0x14001U >> (param_1 & 0x1f) & 1) != 0)) {
      iVar6 = 0;
      if (0 < iVar1) {
        lVar8 = 0;
        puVar7 = (uint *)(lVar3 + 8);
        do {
          iVar2 = CompareStringOrdinal((LPCWSTR)(lVar3 + (longlong)iVar6 * 0xc),-1,L"CS",-1,1);
          if ((iVar2 != 2) &&
             (((*(uint *)((ulonglong)*puVar7 * 0x68 + 0x34 + lVar4) == param_1 || (param_1 == 0)) &&
              (iVar2 = (*(code *)param_2)(), iVar2 == 0)))) {
            return 1;
          }
          iVar6 = iVar6 + 1;
          lVar8 = lVar8 + 1;
          puVar7 = puVar7 + 3;
        } while (lVar8 < iVar1);
      }
      return 1;
    }
    uVar5 = 0x3ec;
  }
  RtlSetLastWin32Error(uVar5);
  return 0;
}



undefined8 GetGeoInfoEx(LPCWSTR param_1,uint param_2,short *param_3,int param_4)

{
  uint *puVar1;
  undefined8 uVar2;
  
                    // 0x53770  614  GetGeoInfoEx
  if (((-1 < param_4) && (((param_3 != (short *)0x0 || (param_4 < 1)) && (param_1 != (LPCWSTR)0x0)))
      ) && (puVar1 = (uint *)FUN_1800537e0(param_1), puVar1 != (uint *)0x0)) {
    uVar2 = FUN_18000631c(puVar1,param_2,param_3,param_4);
    return uVar2;
  }
  RtlSetLastWin32Error(0x57);
  return 0;
}



longlong FUN_1800537e0(LPCWSTR param_1)

{
  int iVar1;
  int iVar2;
  longlong lVar3;
  longlong lVar4;
  int iVar5;
  int iVar6;
  
  lVar3 = KernelBaseGetGlobalData();
  iVar6 = 0;
  lVar3 = *(longlong *)(lVar3 + 0x68);
  lVar4 = KernelBaseGetGlobalData();
  iVar5 = *(int *)(lVar4 + 0x60) + -1;
  if (-1 < iVar5) {
    do {
      iVar1 = (iVar5 + iVar6) / 2;
      iVar2 = CompareStringOrdinal(param_1,-1,(LPCWSTR)(lVar3 + (longlong)iVar1 * 0xc),-1,1);
      if (iVar2 == 2) {
        lVar4 = KernelBaseGetGlobalData();
        if (*(int *)(lVar4 + 0x70) <= iVar1) {
          return 0;
        }
        lVar4 = KernelBaseGetGlobalData();
        return (ulonglong)*(uint *)(lVar3 + 8 + (longlong)iVar1 * 0xc) * 0x68 +
               *(longlong *)(lVar4 + 0x78);
      }
      if (iVar2 == 1) {
        iVar5 = iVar1 + -1;
      }
      else {
        iVar6 = iVar1 + 1;
      }
    } while (iVar6 <= iVar5);
  }
  return 0;
}



void GetUserDefaultGeoName(short *param_1,int param_2)

{
  undefined *puVar1;
  int iVar2;
  GEOID GVar3;
  int *piVar4;
  undefined8 uVar5;
  ulonglong uVar6;
  int *piVar7;
  undefined auStackY824 [32];
  longlong local_308;
  undefined *local_300;
  int local_2f8 [40];
  undefined local_258 [544];
  ulonglong local_38;
  
                    // 0x538d0  798  GetUserDefaultGeoName
  local_38 = DAT_1800b2220 ^ (ulonglong)auStackY824;
  local_308 = 0;
  if ((param_2 < 0) || ((param_1 == (short *)0x0 && (0 < param_2)))) {
    uVar5 = 0x57;
  }
  else {
    iVar2 = OpenRegKey(&local_308,0,L"Control Panel\\International\\Geo",0x20019);
    if (iVar2 < 0) {
LAB_1800539ac:
      GVar3 = GetUserGeoID(0x10);
      if ((GVar3 < 1) || (piVar4 = FUN_180005fac(GVar3), piVar4 == (int *)0x0)) {
LAB_180053a09:
        piVar7 = (int *)&DAT_18008a0a8;
      }
      else {
        piVar7 = piVar4 + 0xf;
        if ((*(short *)piVar7 == 0x58) &&
           ((*(short *)((longlong)piVar4 + 0x3e) == 0x58 && (*(short *)(piVar4 + 0x13) != 0)))) {
          FUN_180058004((ulonglong)*(ushort *)(piVar4 + 0x13),10,3,(short *)local_2f8,0x50);
          piVar7 = local_2f8;
        }
        else if (piVar7 == (int *)0x0) goto LAB_180053a09;
      }
    }
    else {
      local_300 = local_258;
      iVar2 = FUN_18001f2f0(local_308,L"Name",&local_300);
      puVar1 = local_300;
      if ((iVar2 < 0) || (*(uint *)(local_300 + 0xc) < 3)) goto LAB_1800539ac;
      if ((*(uint *)(local_300 + 0xc) & 0xfffffffe) < 0xa1) {
        uVar6 = (ulonglong)(*(uint *)(local_300 + 0xc) >> 1);
      }
      else {
        uVar6 = 0x50;
      }
      FUN_18000b370((short *)local_2f8,uVar6,(longlong)(local_300 + *(uint *)(local_300 + 8)));
      piVar7 = (int *)(puVar1 + *(uint *)(puVar1 + 8));
      if (piVar7 == (int *)0x0) goto LAB_1800539ac;
    }
    if (local_308 != 0) {
      NtClose();
      local_308 = 0;
    }
    uVar6 = FUN_18000865c((short *)piVar7);
    if (param_2 == 0) goto LAB_180053a71;
    if ((int)uVar6 + 1 <= param_2) {
      FUN_180007094(param_1,(longlong)param_2,(longlong)piVar7,(longlong)(int)uVar6);
      goto LAB_180053a71;
    }
    uVar5 = 0x7a;
  }
  RtlSetLastWin32Error(uVar5);
LAB_180053a71:
  __security_check_cookie(local_38 ^ (ulonglong)auStackY824);
  return;
}



BOOL SetUserGeoID(GEOID GeoId)

{
  BOOL BVar1;
  uint *puVar2;
  
                    // 0x53aa0  1409  SetUserGeoID
  puVar2 = (uint *)FUN_180005fac(GeoId);
  BVar1 = FUN_180053b4c(puVar2);
  return BVar1;
}



void SetUserGeoName(LPCWSTR param_1)

{
  int iVar1;
  uint *puVar2;
  undefined auStackY72 [32];
  WCHAR local_18 [4];
  ulonglong local_10;
  
                    // 0x53ac0  1410  SetUserGeoName
  local_10 = DAT_1800b2220 ^ (ulonglong)auStackY72;
  puVar2 = (uint *)FUN_1800537e0(param_1);
  iVar1 = GetUserDefaultGeoName(local_18,4);
  if ((iVar1 == 0) || (iVar1 = CompareStringOrdinal(param_1,-1,local_18,iVar1,1), iVar1 != 2)) {
    FUN_180053b4c(puVar2);
  }
  __security_check_cookie(local_10 ^ (ulonglong)auStackY72);
  return;
}



void FUN_180053b4c(uint *param_1)

{
  int iVar1;
  int iVar2;
  ulonglong uVar3;
  undefined4 uVar4;
  wchar_t *pwVar5;
  uint *puVar6;
  undefined auStackY616 [32];
  longlong local_238 [2];
  uint local_228 [132];
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStackY616;
  local_238[0] = 0;
  memset(local_228,0,0x208);
  iVar1 = CheckGroupPolicyEnabled(L"PreventGeoIdChange",1);
  if (iVar1 == 0) {
    if (param_1 == (uint *)0x0) {
      uVar4 = 0x57;
    }
    else {
      iVar1 = OpenRegKey(local_238,0);
      if (-1 < iVar1) {
        puVar6 = param_1 + 0xf;
        if (((*(short *)puVar6 == 0x58) && (*(short *)((longlong)param_1 + 0x3e) == 0x58)) &&
           (*(short *)(param_1 + 0x13) != 0)) {
          FUN_180058004((ulonglong)*(ushort *)(param_1 + 0x13),10,3,(short *)local_228,0x104);
          puVar6 = local_228;
        }
        uVar3 = FUN_18000865c((short *)puVar6);
        iVar1 = FUN_1800580cc(local_238[0],L"Name",puVar6,(int)uVar3 * 2 + 2);
        FUN_180058004((ulonglong)*param_1,10,0,(short *)local_228,0x104);
        uVar3 = FUN_18000865c((short *)local_228);
        pwVar5 = L"Region";
        if (param_1[0xd] == 0x10) {
          pwVar5 = L"Nation";
        }
        iVar2 = FUN_1800580cc(local_238[0],pwVar5,local_228,(int)uVar3 * 2 + 2);
        if (local_238[0] != 0) {
          NtClose();
          local_238[0] = 0;
        }
        if (iVar2 == 0 && iVar1 == 0) {
          RtlPublishWnfStateData(0x41950223a3bc2035,0,param_1,4);
          RtlPublishWnfStateData(0x389022aa3bc1035,0,0,0);
        }
        else {
          RtlSetLastWin32Error(0x54f);
        }
        goto LAB_180053d3b;
      }
      uVar4 = 0x54f;
    }
  }
  else {
    uVar4 = 0x4ec;
  }
  RtlSetLastWin32Error(uVar4);
LAB_180053d3b:
  __security_check_cookie(local_18 ^ (ulonglong)auStackY616);
  return;
}



longlong FUN_180053d6c(longlong *param_1,int param_2)

{
  ushort uVar1;
  ushort *puVar2;
  longlong lVar3;
  longlong lVar4;
  int iVar5;
  ushort *puVar6;
  longlong lVar7;
  uint uVar8;
  int iVar9;
  uint uVar10;
  int iVar11;
  byte *pbVar12;
  ulonglong uVar13;
  ulonglong uVar14;
  uint uVar15;
  ushort *puVar16;
  uint uVar17;
  ulonglong uVar18;
  ushort **ppuVar19;
  int iVar20;
  int iVar21;
  ulonglong uVar22;
  uint uVar23;
  
  puVar2 = (ushort *)param_1[8];
  FUN_180023324(param_1,(longlong)(param_1 + 0xe));
  if ((ulonglong)param_1[0x11] < (ulonglong)param_1[0xf]) {
    puVar6 = (ushort *)param_1[0xb];
    param_1[8] = (longlong)puVar6;
    if (puVar6 < (ushort *)param_1[9]) {
      uVar18 = 0;
      do {
        ppuVar19 = (ushort **)(param_1 + 8);
        param_1[0xb] = (longlong)puVar6;
        param_1[0x11] = param_1[0xe];
        FUN_180023324(param_1,(longlong)ppuVar19);
        if ((ushort *)param_1[9] <= (ushort *)param_1[0xb]) break;
        *ppuVar19 = (ushort *)param_1[0xb];
        iVar5 = FUN_180003c80(param_1);
        if (iVar5 == 2) {
          *(int *)((longlong)param_1 + 0xac) = (int)(param_1[0xb] - (longlong)puVar2 >> 1);
          return (longlong)*ppuVar19 - (longlong)puVar2 >> 1;
        }
        if (param_2 != 0) break;
        puVar6 = *ppuVar19;
        param_1[0xb] = (longlong)puVar6;
        if (*(longlong *)(*param_1 + 0x150) != 0) {
          *(ushort *)((longlong)param_1 + 0x6a) = *puVar6;
          uVar22 = (ulonglong)*puVar6;
          if (param_1[1] != 0) {
            uVar22 = (ulonglong)
                     (*(int *)(param_1[1] + (ulonglong)(*puVar6 >> 8) * 4) + (uint)*(byte *)puVar6);
          }
          uVar17 = 0;
          *(undefined4 *)((longlong)param_1 + 100) = *(undefined4 *)(DAT_1800b2b88 + uVar22 * 4);
          uVar8 = uVar17;
          if (*(char *)((longlong)param_1 + 0x65) != '\x03') {
            uVar8 = (uint)*(byte *)((longlong)param_1 + 0x67);
          }
          uVar8 = uVar8 & 0xc0;
          iVar5 = 0;
          if (uVar8 != 0x40) {
            iVar5 = 0;
            if (uVar8 != 0x80) {
              if (uVar8 != 0xc0) goto LAB_180054adc;
              lVar7 = *param_1;
              lVar3 = *(longlong *)(lVar7 + 0x150);
              uVar8 = *(uint *)(lVar7 + 0x140);
              uVar23 = uVar8 & 0x20;
              uVar15 = uVar8 & 0x20;
              iVar5 = 0;
              if ((*(short *)(lVar3 + 0x14) != 0) &&
                 (pbVar12 = (byte *)((-(ulonglong)(uVar23 != 0) & 2) + 0xe + (longlong)puVar6),
                 iVar5 = 0, pbVar12 < (byte *)param_1[9] || pbVar12 == (byte *)param_1[9])) {
                iVar5 = *(int *)(param_1 + 10);
                iVar9 = (uVar23 != 0) + 8;
                puVar16 = puVar6;
                if (param_1[9] == 0) {
                  iVar5 = 1;
                }
                do {
                  if ((((ushort *)param_1[9] <= puVar16) ||
                      (((uVar1 = *puVar16, uVar1 == 0 && (iVar5 != 0)) ||
                       (*(ushort *)(lVar3 + 6) <= uVar1 && uVar1 != *(ushort *)(lVar3 + 6))))) ||
                     (uVar1 < *(ushort *)(lVar3 + 4))) break;
                  puVar16 = puVar16 + 1;
                  iVar9 = iVar9 + -1;
                } while (0 < iVar9);
                iVar5 = (int)((longlong)puVar16 - (longlong)puVar6 >> 1);
                if (7 < iVar5) {
                  iVar9 = *(ushort *)(lVar3 + 0x14) - 1;
                  uVar22 = uVar18;
                  if ((uVar23 != 0) && (uVar22 = 0, 8 < iVar5)) {
                    lVar4 = param_1[1];
                    if (lVar4 == 0) {
                      uVar23 = *(uint *)(DAT_1800b2b88 + (ulonglong)*puVar6 * 4);
                    }
                    else {
                      uVar23 = *(uint *)(DAT_1800b2b88 +
                                        (ulonglong)
                                        ((uint)*(byte *)puVar6 +
                                        *(int *)(lVar4 + (ulonglong)(*puVar6 >> 8) * 4)) * 4);
                    }
                    if (lVar4 == 0) {
                      uVar10 = *(uint *)(DAT_1800b2b88 + (ulonglong)puVar6[1] * 4);
                    }
                    else {
                      uVar10 = *(uint *)(DAT_1800b2b88 +
                                        (ulonglong)
                                        ((uint)*(byte *)(puVar6 + 1) +
                                        *(int *)(lVar4 + (ulonglong)(puVar6[1] >> 8) * 4)) * 4);
                    }
                    uVar22 = 0;
                    if (((uVar10 ^ uVar23) & 0xe7ffffff) == 0) {
                      uVar22 = 1;
                    }
                  }
                  if (-1 < iVar9) {
                    uVar23 = uVar17;
                    do {
                      iVar21 = (int)(iVar9 + uVar23) / 2;
                      iVar20 = 8;
                      puVar16 = (ushort *)
                                ((longlong)(iVar21 * 10) * 2 + *(longlong *)(lVar7 + 0x188));
                      lVar4 = uVar22 * 2 - (longlong)puVar16;
                      do {
                        iVar11 = (uint)*(ushort *)
                                        ((byte *)((longlong)puVar6 + lVar4) + (longlong)puVar16) -
                                 (uint)*puVar16;
                        if (iVar11 != 0) break;
                        puVar16 = puVar16 + 1;
                        iVar20 = iVar20 + -1;
                        iVar11 = 0;
                      } while (0 < iVar20);
                      if (iVar11 == 0) {
                        *(undefined4 *)((longlong)param_1 + 100) =
                             *(undefined4 *)
                              (*(longlong *)(lVar7 + 0x188) + 0x10 + (longlong)(iVar21 * 10) * 2);
                        if ((int)uVar22 != 0) goto LAB_180054aba;
                        puVar16 = puVar6 + 7;
                        goto LAB_180054ab6;
                      }
                      iVar20 = iVar21 + -1;
                      if (-1 < iVar11) {
                        iVar20 = iVar9;
                      }
                      iVar9 = iVar20;
                      if (-1 < iVar11) {
                        uVar23 = iVar21 + 1;
                      }
                    } while ((int)uVar23 <= iVar9);
                    lVar7 = *param_1;
                  }
                }
              }
              uVar8 = uVar8 & 0x20;
              if ((*(short *)(lVar3 + 0x12) != 0) &&
                 (pbVar12 = (byte *)((-(ulonglong)(uVar8 != 0) & 2) + 0xc + (longlong)puVar6),
                 pbVar12 < (byte *)param_1[9] || pbVar12 == (byte *)param_1[9])) {
                if (iVar5 == 0) {
                  iVar5 = *(int *)(param_1 + 10);
                  iVar9 = (uVar8 != 0) + 7;
                  puVar16 = puVar6;
                  if (param_1[9] == 0) {
                    iVar5 = 1;
                  }
                  do {
                    if (((ushort *)param_1[9] <= puVar16) ||
                       ((((uVar1 = *puVar16, uVar1 == 0 && (iVar5 != 0)) ||
                         (*(ushort *)(lVar3 + 6) <= uVar1 && uVar1 != *(ushort *)(lVar3 + 6))) ||
                        (uVar1 < *(ushort *)(lVar3 + 4))))) break;
                    puVar16 = puVar16 + 1;
                    iVar9 = iVar9 + -1;
                  } while (0 < iVar9);
                  iVar5 = (int)((longlong)puVar16 - (longlong)puVar6 >> 1);
                }
                if (6 < iVar5) {
                  iVar9 = *(ushort *)(lVar3 + 0x12) - 1;
                  uVar22 = uVar18;
                  if ((uVar8 != 0) && (uVar22 = 0, 7 < iVar5)) {
                    lVar4 = param_1[1];
                    uVar13 = (ulonglong)*puVar6;
                    if (lVar4 != 0) {
                      uVar13 = (ulonglong)
                               (*(int *)(lVar4 + (ulonglong)(*puVar6 >> 8) * 4) +
                               (uint)*(byte *)puVar6);
                    }
                    uVar14 = (ulonglong)puVar6[1];
                    if (lVar4 != 0) {
                      uVar14 = (ulonglong)
                               (*(int *)(lVar4 + (ulonglong)(puVar6[1] >> 8) * 4) +
                               (uint)*(byte *)(puVar6 + 1));
                    }
                    uVar22 = 0;
                    if (((*(uint *)(DAT_1800b2b88 + uVar14 * 4) ^
                         *(uint *)(DAT_1800b2b88 + uVar13 * 4)) & 0xe7ffffff) == 0) {
                      uVar22 = 1;
                    }
                  }
                  if (-1 < iVar9) {
                    uVar8 = uVar17;
                    do {
                      iVar21 = (int)(iVar9 + uVar8) / 2;
                      iVar20 = 7;
                      puVar16 = (ushort *)
                                ((longlong)(iVar21 * 10) * 2 + *(longlong *)(lVar7 + 0x180));
                      lVar4 = uVar22 * 2 - (longlong)puVar16;
                      do {
                        iVar11 = (uint)*(ushort *)
                                        ((byte *)((longlong)puVar6 + lVar4) + (longlong)puVar16) -
                                 (uint)*puVar16;
                        if (iVar11 != 0) break;
                        puVar16 = puVar16 + 1;
                        iVar20 = iVar20 + -1;
                        iVar11 = 0;
                      } while (0 < iVar20);
                      if (iVar11 == 0) {
                        *(undefined4 *)((longlong)param_1 + 100) =
                             *(undefined4 *)
                              (*(longlong *)(lVar7 + 0x180) + 0x10 + (longlong)(iVar21 * 10) * 2);
                        if ((int)uVar22 != 0) goto LAB_180054aba;
                        puVar16 = puVar6 + 6;
                        goto LAB_180054ab6;
                      }
                      iVar20 = iVar21 + -1;
                      if (-1 < iVar11) {
                        iVar20 = iVar9;
                      }
                      iVar9 = iVar20;
                      if (-1 < iVar11) {
                        uVar8 = iVar21 + 1;
                      }
                    } while ((int)uVar8 <= iVar9);
                  }
                }
              }
              if ((*(short *)(lVar3 + 0x10) != 0) &&
                 (pbVar12 = (byte *)((-(ulonglong)(uVar15 != 0) & 2) + 10 + (longlong)puVar6),
                 pbVar12 < (byte *)param_1[9] || pbVar12 == (byte *)param_1[9])) {
                if (iVar5 == 0) {
                  iVar9 = (uVar15 != 0) + 6;
                  puVar16 = puVar6;
                  iVar5 = *(int *)(param_1 + 10);
                  if (param_1[9] == 0) {
                    iVar5 = 1;
                  }
                  do {
                    if ((((ushort *)param_1[9] <= puVar16) ||
                        (((uVar1 = *puVar16, uVar1 == 0 && (iVar5 != 0)) ||
                         (*(ushort *)(lVar3 + 6) <= uVar1 && uVar1 != *(ushort *)(lVar3 + 6))))) ||
                       (uVar1 < *(ushort *)(lVar3 + 4))) break;
                    puVar16 = puVar16 + 1;
                    iVar9 = iVar9 + -1;
                  } while (0 < iVar9);
                  iVar5 = (int)((longlong)puVar16 - (longlong)puVar6 >> 1);
                }
                if (5 < iVar5) {
                  iVar9 = *(ushort *)(lVar3 + 0x10) - 1;
                  uVar22 = uVar18;
                  if ((uVar15 != 0) && (uVar22 = 0, 6 < iVar5)) {
                    lVar7 = param_1[1];
                    uVar13 = (ulonglong)*puVar6;
                    if (lVar7 != 0) {
                      uVar13 = (ulonglong)
                               (*(int *)(lVar7 + (ulonglong)(*puVar6 >> 8) * 4) +
                               (uint)*(byte *)puVar6);
                    }
                    uVar14 = (ulonglong)puVar6[1];
                    if (lVar7 != 0) {
                      uVar14 = (ulonglong)
                               (*(int *)(lVar7 + (ulonglong)(puVar6[1] >> 8) * 4) +
                               (uint)*(byte *)(puVar6 + 1));
                    }
                    uVar22 = 0;
                    if (((*(uint *)(DAT_1800b2b88 + uVar14 * 4) ^
                         *(uint *)(DAT_1800b2b88 + uVar13 * 4)) & 0xe7ffffff) == 0) {
                      uVar22 = 1;
                    }
                  }
                  if (-1 < iVar9) {
                    uVar13 = uVar18;
                    do {
                      iVar20 = 6;
                      iVar21 = (iVar9 + (int)uVar13) / 2;
                      puVar16 = (ushort *)
                                ((longlong)(iVar21 << 3) * 2 + *(longlong *)(*param_1 + 0x178));
                      lVar7 = uVar22 * 2 - (longlong)puVar16;
                      do {
                        uVar8 = (uint)*(ushort *)
                                       ((byte *)((longlong)puVar6 + lVar7) + (longlong)puVar16) -
                                (uint)*puVar16;
                        if (uVar8 != 0) break;
                        puVar16 = puVar16 + 1;
                        iVar20 = iVar20 + -1;
                        uVar8 = uVar17;
                      } while (0 < iVar20);
                      if (uVar8 == 0) {
                        *(undefined4 *)((longlong)param_1 + 100) =
                             *(undefined4 *)
                              (*(longlong *)(*param_1 + 0x178) + 0xc + (longlong)(iVar21 << 3) * 2);
                        if ((int)uVar22 != 0) goto LAB_180054aba;
                        puVar16 = puVar6 + 5;
                        goto LAB_180054ab6;
                      }
                      iVar20 = iVar21 + -1;
                      if (-1 < (int)uVar8) {
                        iVar20 = iVar9;
                      }
                      iVar9 = iVar20;
                      if (-1 < (int)uVar8) {
                        uVar13 = (ulonglong)(iVar21 + 1);
                      }
                    } while ((int)uVar13 <= iVar9);
                  }
                }
              }
            }
            lVar7 = *param_1;
            lVar3 = *(longlong *)(lVar7 + 0x150);
            uVar8 = *(uint *)(lVar7 + 0x140) & 0x20;
            if ((*(short *)(lVar3 + 0xe) != 0) &&
               (pbVar12 = (byte *)((-(ulonglong)(uVar8 != 0) & 2) + 8 + (longlong)puVar6),
               pbVar12 < (byte *)param_1[9] || pbVar12 == (byte *)param_1[9])) {
              if (iVar5 == 0) {
                iVar5 = *(int *)(param_1 + 10);
                iVar9 = (uVar8 != 0) + 5;
                puVar16 = puVar6;
                if (param_1[9] == 0) {
                  iVar5 = 1;
                }
                do {
                  if ((((ushort *)param_1[9] <= puVar16) ||
                      (((uVar1 = *puVar16, uVar1 == 0 && (iVar5 != 0)) ||
                       (*(ushort *)(lVar3 + 6) <= uVar1 && uVar1 != *(ushort *)(lVar3 + 6))))) ||
                     (uVar1 < *(ushort *)(lVar3 + 4))) break;
                  puVar16 = puVar16 + 1;
                  iVar9 = iVar9 + -1;
                } while (0 < iVar9);
                iVar5 = (int)((longlong)puVar16 - (longlong)puVar6 >> 1);
              }
              if (4 < iVar5) {
                iVar9 = *(ushort *)(lVar3 + 0xe) - 1;
                uVar22 = uVar18;
                if ((uVar8 != 0) && (uVar22 = 0, 5 < iVar5)) {
                  lVar4 = param_1[1];
                  uVar13 = (ulonglong)*puVar6;
                  if (lVar4 != 0) {
                    uVar13 = (ulonglong)
                             (*(int *)(lVar4 + (ulonglong)(*puVar6 >> 8) * 4) +
                             (uint)*(byte *)puVar6);
                  }
                  uVar14 = (ulonglong)puVar6[1];
                  if (lVar4 != 0) {
                    uVar14 = (ulonglong)
                             (*(int *)(lVar4 + (ulonglong)(puVar6[1] >> 8) * 4) +
                             (uint)*(byte *)(puVar6 + 1));
                  }
                  uVar22 = 0;
                  if (((*(uint *)(DAT_1800b2b88 + uVar14 * 4) ^
                       *(uint *)(DAT_1800b2b88 + uVar13 * 4)) & 0xe7ffffff) == 0) {
                    uVar22 = 1;
                  }
                }
                if (-1 < iVar9) {
                  uVar8 = uVar17;
                  do {
                    iVar20 = 5;
                    iVar21 = (int)(iVar9 + uVar8) / 2;
                    puVar16 = (ushort *)(*(longlong *)(lVar7 + 0x170) + (longlong)(iVar21 << 3) * 2)
                    ;
                    lVar4 = uVar22 * 2 - (longlong)puVar16;
                    do {
                      iVar11 = (uint)*(ushort *)
                                      ((byte *)((longlong)puVar6 + lVar4) + (longlong)puVar16) -
                               (uint)*puVar16;
                      if (iVar11 != 0) break;
                      puVar16 = puVar16 + 1;
                      iVar20 = iVar20 + -1;
                      iVar11 = 0;
                    } while (0 < iVar20);
                    if (iVar11 == 0) {
                      *(undefined4 *)((longlong)param_1 + 100) =
                           *(undefined4 *)
                            (*(longlong *)(lVar7 + 0x170) + 0xc + (longlong)(iVar21 << 3) * 2);
                      if ((int)uVar22 != 0) goto LAB_180054aba;
                      puVar16 = puVar6 + 4;
                      goto LAB_180054ab6;
                    }
                    iVar20 = iVar21 + -1;
                    if (-1 < iVar11) {
                      iVar20 = iVar9;
                    }
                    iVar9 = iVar20;
                    if (-1 < iVar11) {
                      uVar8 = iVar21 + 1;
                    }
                  } while ((int)uVar8 <= iVar9);
                }
              }
            }
            uVar8 = *(uint *)(lVar7 + 0x140) & 0x20;
            if ((*(short *)(lVar3 + 0xc) != 0) &&
               (pbVar12 = (byte *)((-(ulonglong)(uVar8 != 0) & 2) + 6 + (longlong)puVar6),
               pbVar12 < (byte *)param_1[9] || pbVar12 == (byte *)param_1[9])) {
              if (iVar5 == 0) {
                iVar5 = *(int *)(param_1 + 10);
                iVar9 = (uVar8 != 0) + 4;
                puVar16 = puVar6;
                if (param_1[9] == 0) {
                  iVar5 = 1;
                }
                do {
                  if (((ushort *)param_1[9] <= puVar16) ||
                     ((((uVar1 = *puVar16, uVar1 == 0 && (iVar5 != 0)) ||
                       (*(ushort *)(lVar3 + 6) <= uVar1 && uVar1 != *(ushort *)(lVar3 + 6))) ||
                      (uVar1 < *(ushort *)(lVar3 + 4))))) break;
                  puVar16 = puVar16 + 1;
                  iVar9 = iVar9 + -1;
                } while (0 < iVar9);
                iVar5 = (int)((longlong)puVar16 - (longlong)puVar6 >> 1);
              }
              if (3 < iVar5) {
                iVar9 = *(ushort *)(lVar3 + 0xc) - 1;
                uVar22 = uVar18;
                if ((uVar8 != 0) && (uVar22 = 0, 4 < iVar5)) {
                  lVar7 = param_1[1];
                  uVar13 = (ulonglong)*puVar6;
                  if (lVar7 != 0) {
                    uVar13 = (ulonglong)
                             (*(int *)(lVar7 + (ulonglong)(*puVar6 >> 8) * 4) +
                             (uint)*(byte *)puVar6);
                  }
                  uVar14 = (ulonglong)puVar6[1];
                  if (lVar7 != 0) {
                    uVar14 = (ulonglong)
                             (*(int *)(lVar7 + (ulonglong)(puVar6[1] >> 8) * 4) +
                             (uint)*(byte *)(puVar6 + 1));
                  }
                  uVar22 = 0;
                  if (((*(uint *)(DAT_1800b2b88 + uVar14 * 4) ^
                       *(uint *)(DAT_1800b2b88 + uVar13 * 4)) & 0xe7ffffff) == 0) {
                    uVar22 = 1;
                  }
                }
                if (-1 < iVar9) {
                  uVar8 = uVar17;
                  do {
                    iVar21 = (int)(iVar9 + uVar8) / 2;
                    iVar20 = 4;
                    puVar16 = (ushort *)
                              ((longlong)(iVar21 * 6) * 2 + *(longlong *)(*param_1 + 0x168));
                    lVar7 = uVar22 * 2 - (longlong)puVar16;
                    do {
                      iVar11 = (uint)*(ushort *)
                                      ((byte *)((longlong)puVar6 + lVar7) + (longlong)puVar16) -
                               (uint)*puVar16;
                      if (iVar11 != 0) break;
                      puVar16 = puVar16 + 1;
                      iVar20 = iVar20 + -1;
                      iVar11 = 0;
                    } while (0 < iVar20);
                    if (iVar11 == 0) {
                      *(undefined4 *)((longlong)param_1 + 100) =
                           *(undefined4 *)
                            (*(longlong *)(*param_1 + 0x168) + 8 + (longlong)(iVar21 * 6) * 2);
                      if ((int)uVar22 != 0) goto LAB_180054aba;
                      puVar16 = puVar6 + 3;
                      goto LAB_180054ab6;
                    }
                    iVar20 = iVar21 + -1;
                    if (-1 < iVar11) {
                      iVar20 = iVar9;
                    }
                    iVar9 = iVar20;
                    if (-1 < iVar11) {
                      uVar8 = iVar21 + 1;
                    }
                  } while ((int)uVar8 <= iVar9);
                }
              }
            }
          }
          lVar7 = *param_1;
          lVar3 = *(longlong *)(lVar7 + 0x150);
          uVar8 = *(uint *)(lVar7 + 0x140) & 0x20;
          if ((*(short *)(lVar3 + 10) != 0) &&
             (pbVar12 = (byte *)((-(ulonglong)(uVar8 != 0) & 2) + 4 + (longlong)puVar6),
             pbVar12 < (byte *)param_1[9] || pbVar12 == (byte *)param_1[9])) {
            if (iVar5 == 0) {
              iVar5 = *(int *)(param_1 + 10);
              iVar9 = (uVar8 != 0) + 3;
              puVar16 = puVar6;
              if (param_1[9] == 0) {
                iVar5 = 1;
              }
              do {
                if ((((ushort *)param_1[9] <= puVar16) ||
                    (((uVar1 = *puVar16, uVar1 == 0 && (iVar5 != 0)) ||
                     (*(ushort *)(lVar3 + 6) <= uVar1 && uVar1 != *(ushort *)(lVar3 + 6))))) ||
                   (uVar1 < *(ushort *)(lVar3 + 4))) break;
                puVar16 = puVar16 + 1;
                iVar9 = iVar9 + -1;
              } while (0 < iVar9);
              iVar5 = (int)((longlong)puVar16 - (longlong)puVar6 >> 1);
            }
            if (2 < iVar5) {
              iVar9 = *(ushort *)(lVar3 + 10) - 1;
              uVar22 = uVar18;
              if ((uVar8 != 0) && (uVar22 = 0, 3 < iVar5)) {
                lVar4 = param_1[1];
                uVar13 = (ulonglong)*puVar6;
                if (lVar4 != 0) {
                  uVar13 = (ulonglong)
                           (*(int *)(lVar4 + (ulonglong)(*puVar6 >> 8) * 4) + (uint)*(byte *)puVar6)
                  ;
                }
                uVar14 = (ulonglong)puVar6[1];
                if (lVar4 != 0) {
                  uVar14 = (ulonglong)
                           (*(int *)(lVar4 + (ulonglong)(puVar6[1] >> 8) * 4) +
                           (uint)*(byte *)(puVar6 + 1));
                }
                uVar22 = 0;
                if (((*(uint *)(DAT_1800b2b88 + uVar14 * 4) ^ *(uint *)(DAT_1800b2b88 + uVar13 * 4))
                    & 0xe7ffffff) == 0) {
                  uVar22 = 1;
                }
              }
              if (-1 < iVar9) {
                uVar15 = uVar17;
                do {
                  iVar21 = (int)(iVar9 + uVar15) / 2;
                  iVar20 = 3;
                  puVar16 = (ushort *)(*(longlong *)(lVar7 + 0x160) + (longlong)(iVar21 * 6) * 2);
                  lVar4 = uVar22 * 2 - (longlong)puVar16;
                  do {
                    iVar11 = (uint)*(ushort *)
                                    ((byte *)((longlong)puVar6 + lVar4) + (longlong)puVar16) -
                             (uint)*puVar16;
                    if (iVar11 != 0) break;
                    puVar16 = puVar16 + 1;
                    iVar20 = iVar20 + -1;
                    iVar11 = 0;
                  } while (0 < iVar20);
                  if (iVar11 == 0) {
                    *(undefined4 *)((longlong)param_1 + 100) =
                         *(undefined4 *)
                          (*(longlong *)(lVar7 + 0x160) + 8 + (longlong)(iVar21 * 6) * 2);
                    if ((int)uVar22 != 0) goto LAB_180054aba;
                    puVar16 = puVar6 + 2;
                    goto LAB_180054ab6;
                  }
                  iVar20 = iVar21 + -1;
                  if (-1 < iVar11) {
                    iVar20 = iVar9;
                  }
                  iVar9 = iVar20;
                  if (-1 < iVar11) {
                    uVar15 = iVar21 + 1;
                  }
                } while ((int)uVar15 <= iVar9);
              }
            }
          }
          if ((*(short *)(lVar3 + 8) != 0) &&
             (pbVar12 = (byte *)((-(ulonglong)(uVar8 != 0) & 2) + 2 + (longlong)puVar6),
             pbVar12 < (byte *)param_1[9] || pbVar12 == (byte *)param_1[9])) {
            if (iVar5 == 0) {
              iVar9 = (uVar8 != 0) + 2;
              puVar16 = puVar6;
              iVar5 = *(int *)(param_1 + 10);
              if (param_1[9] == 0) {
                iVar5 = 1;
              }
              do {
                if ((((ushort *)param_1[9] <= puVar16) ||
                    (((uVar1 = *puVar16, uVar1 == 0 && (iVar5 != 0)) ||
                     (*(ushort *)(lVar3 + 6) <= uVar1 && uVar1 != *(ushort *)(lVar3 + 6))))) ||
                   (uVar1 < *(ushort *)(lVar3 + 4))) break;
                puVar16 = puVar16 + 1;
                iVar9 = iVar9 + -1;
              } while (0 < iVar9);
              iVar5 = (int)((longlong)puVar16 - (longlong)puVar6 >> 1);
            }
            if (1 < iVar5) {
              iVar9 = *(ushort *)(lVar3 + 8) - 1;
              uVar22 = uVar18;
              if ((uVar8 != 0) && (2 < iVar5)) {
                lVar7 = param_1[1];
                uVar22 = (ulonglong)*puVar6;
                if (lVar7 != 0) {
                  uVar22 = (ulonglong)
                           (*(int *)(lVar7 + (ulonglong)(*puVar6 >> 8) * 4) + (uint)*(byte *)puVar6)
                  ;
                }
                uVar13 = (ulonglong)puVar6[1];
                if (lVar7 != 0) {
                  uVar13 = (ulonglong)
                           (*(int *)(lVar7 + (ulonglong)(puVar6[1] >> 8) * 4) +
                           (uint)*(byte *)(puVar6 + 1));
                }
                uVar22 = (ulonglong)
                         (((*(uint *)(DAT_1800b2b88 + uVar13 * 4) ^
                           *(uint *)(DAT_1800b2b88 + uVar22 * 4)) & 0xe7ffffff) == 0);
              }
              if (-1 < iVar9) {
                uVar8 = uVar17;
LAB_180054a44:
                iVar21 = 2;
                iVar5 = (int)(iVar9 + uVar8) / 2;
                puVar16 = (ushort *)(*(longlong *)(*param_1 + 0x158) + (longlong)(iVar5 << 2) * 2);
                lVar7 = uVar22 * 2 - (longlong)puVar16;
                do {
                  uVar15 = (uint)*(ushort *)
                                  ((longlong)puVar16 + (longlong)((longlong)puVar6 + lVar7)) -
                           (uint)*puVar16;
                  if (uVar15 != 0) break;
                  puVar16 = puVar16 + 1;
                  iVar21 = iVar21 + -1;
                  uVar15 = uVar17;
                } while (0 < iVar21);
                if (uVar15 != 0) goto code_r0x000180054a85;
                *(undefined4 *)((longlong)param_1 + 100) =
                     *(undefined4 *)
                      (*(longlong *)(*param_1 + 0x158) + 4 + (longlong)(iVar5 << 2) * 2);
                if ((int)uVar22 == 0) {
                  puVar16 = puVar6 + 1;
LAB_180054ab6:
                  param_1[0xb] = (longlong)puVar16;
                }
LAB_180054aba:
                puVar16 = (ushort *)param_1[0xb];
                param_1[0xb] = (longlong)puVar6;
                puVar6 = puVar16;
              }
            }
          }
        }
LAB_180054adc:
        puVar6 = puVar6 + 1;
        param_1[8] = (longlong)puVar6;
      } while (puVar6 < (ushort *)param_1[9]);
    }
    SetLastError(0);
    lVar7 = 0xffffffff;
  }
  else {
    *(undefined4 *)((longlong)param_1 + 0xac) = 0;
    lVar7 = 0;
  }
  return lVar7;
code_r0x000180054a85:
  iVar21 = iVar5 + -1;
  if (-1 < (int)uVar15) {
    iVar21 = iVar9;
  }
  iVar9 = iVar21;
  if (-1 < (int)uVar15) {
    uVar8 = iVar5 + 1;
  }
  if (iVar9 < (int)uVar8) goto LAB_180054adc;
  goto LAB_180054a44;
}



undefined8 FUN_180054b38(longlong *param_1,ulonglong *param_2,longlong *param_3,longlong param_4)

{
  ushort uVar1;
  ulonglong uVar2;
  undefined8 uVar3;
  longlong lVar4;
  ulonglong uVar5;
  byte bVar6;
  int iVar7;
  int iVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  ushort *puVar11;
  ulonglong uVar12;
  int iVar13;
  int iVar14;
  ushort *puVar15;
  longlong lVar16;
  longlong lVar17;
  int iVar18;
  ushort *puVar19;
  uint uVar20;
  ulonglong uVar21;
  
  uVar2 = param_2[3];
  if ((param_3 == (longlong *)0x0) || (param_4 == 0)) {
LAB_180055873:
    uVar3 = 0;
  }
  else {
    lVar17 = *(longlong *)(*param_1 + 0x150);
    *param_3 = 0;
    if (lVar17 == 0) {
      uVar3 = 1;
    }
    else {
      param_2[3] = *param_2;
      if (*param_2 < param_2[1]) {
        do {
          uVar5 = 0;
          *param_3 = *param_3 + 1;
          if (param_4 <= *param_3) goto LAB_180055873;
          param_3[*param_3] = param_2[3];
          puVar19 = (ushort *)param_2[3];
          if (*(longlong *)(*param_1 + 0x150) != 0) {
            *(ushort *)((longlong)param_2 + 0x2a) = *puVar19;
            uVar21 = (ulonglong)*puVar19;
            if (param_1[1] != 0) {
              uVar21 = (ulonglong)
                       (*(int *)(param_1[1] + (ulonglong)(*puVar19 >> 8) * 4) +
                       (uint)*(byte *)puVar19);
            }
            *(undefined4 *)((longlong)param_2 + 0x24) = *(undefined4 *)(DAT_1800b2b88 + uVar21 * 4);
            bVar6 = 0;
            if (*(char *)((longlong)param_2 + 0x25) != '\x03') {
              bVar6 = *(byte *)((longlong)param_2 + 0x27);
            }
            bVar6 = bVar6 & 0xc0;
            if (bVar6 != 0x40) {
              if (bVar6 != 0x80) {
                if (bVar6 != 0xc0) goto LAB_18005572c;
                lVar17 = *param_1;
                uVar20 = *(uint *)(lVar17 + 0x140) & 0x20;
                lVar4 = *(longlong *)(lVar17 + 0x150);
                uVar21 = uVar5;
                if ((*(short *)(lVar4 + 0x14) != 0) &&
                   (puVar15 = (ushort *)param_2[1],
                   (ushort *)((-(ulonglong)(uVar20 != 0) & 2) + 0xe + (longlong)puVar19) <= puVar15)
                   ) {
                  iVar7 = (uVar20 != 0) + 8;
                  uVar21 = (ulonglong)*(uint *)(param_2 + 2);
                  puVar11 = puVar19;
                  if (puVar15 == (ushort *)0x0) {
                    uVar21 = 1;
                  }
                  do {
                    if (((puVar15 <= puVar11) ||
                        (((uVar1 = *puVar11, uVar1 == 0 && ((int)uVar21 != 0)) ||
                         (*(ushort *)(lVar4 + 6) <= uVar1 && uVar1 != *(ushort *)(lVar4 + 6))))) ||
                       (uVar1 < *(ushort *)(lVar4 + 4))) break;
                    puVar11 = puVar11 + 1;
                    iVar7 = iVar7 + -1;
                  } while (0 < iVar7);
                  uVar21 = (longlong)puVar11 - (longlong)puVar19 >> 1;
                  if (7 < (int)uVar21) {
                    iVar7 = *(ushort *)(lVar4 + 0x14) - 1;
                    uVar12 = uVar5;
                    if ((uVar20 != 0) && (8 < (int)uVar21)) {
                      lVar16 = param_1[1];
                      puVar15 = (ushort *)param_2[3];
                      uVar9 = (ulonglong)*puVar15;
                      if (lVar16 != 0) {
                        uVar9 = (ulonglong)
                                (*(int *)(lVar16 + (ulonglong)(*puVar15 >> 8) * 4) +
                                (uint)*(byte *)puVar15);
                      }
                      uVar10 = (ulonglong)puVar15[1];
                      if (lVar16 != 0) {
                        uVar10 = (ulonglong)
                                 (*(int *)(lVar16 + (ulonglong)(puVar15[1] >> 8) * 4) +
                                 (uint)*(byte *)(puVar15 + 1));
                      }
                      if (((*(uint *)(DAT_1800b2b88 + uVar10 * 4) ^
                           *(uint *)(DAT_1800b2b88 + uVar9 * 4)) & 0xe7ffffff) == 0) {
                        uVar12 = 1;
                      }
                    }
                    if (-1 < iVar7) {
                      do {
                        iVar13 = (iVar7 + (int)uVar5) / 2;
                        iVar18 = 8;
                        puVar15 = (ushort *)
                                  (*(longlong *)(lVar17 + 0x188) + (longlong)(iVar13 * 10) * 2);
                        lVar16 = (param_2[3] + uVar12 * 2) - (longlong)puVar15;
                        do {
                          iVar8 = (uint)*(ushort *)(lVar16 + (longlong)puVar15) - (uint)*puVar15;
                          if (iVar8 != 0) goto LAB_180054da2;
                          puVar15 = puVar15 + 1;
                          iVar18 = iVar18 + -1;
                        } while (0 < iVar18);
                        iVar8 = 0;
LAB_180054da2:
                        if (iVar8 == 0) {
                          *(undefined4 *)((longlong)param_2 + 0x24) =
                               *(undefined4 *)
                                (*(longlong *)(lVar17 + 0x188) + 0x10 + (longlong)(iVar13 * 10) * 2)
                          ;
                          if ((int)uVar12 != 0) goto LAB_1800557e5;
                          uVar5 = param_2[3] + 0xe;
                          goto LAB_180055773;
                        }
                        iVar18 = iVar13 + -1;
                        if (-1 < iVar8) {
                          iVar18 = iVar7;
                        }
                        iVar7 = iVar18;
                        if (-1 < iVar8) {
                          uVar5 = (ulonglong)(iVar13 + 1);
                        }
                      } while ((int)uVar5 <= iVar7);
                    }
                  }
                }
                uVar5 = uVar21;
                uVar21 = 0;
                if ((*(short *)(lVar4 + 0x12) != 0) &&
                   (puVar15 = (ushort *)param_2[1],
                   (ushort *)((-(ulonglong)(uVar20 != 0) & 2) + 0xc + (longlong)puVar19) <= puVar15)
                   ) {
                  if ((int)uVar5 == 0) {
                    iVar7 = (uVar20 != 0) + 7;
                    puVar11 = puVar19;
                    uVar5 = (ulonglong)*(uint *)(param_2 + 2);
                    if (puVar15 == (ushort *)0x0) {
                      uVar5 = 1;
                    }
                    do {
                      if ((puVar15 <= puVar11) ||
                         ((((uVar1 = *puVar11, uVar1 == 0 && ((int)uVar5 != 0)) ||
                           (*(ushort *)(lVar4 + 6) <= uVar1 && uVar1 != *(ushort *)(lVar4 + 6))) ||
                          (uVar1 < *(ushort *)(lVar4 + 4))))) break;
                      puVar11 = puVar11 + 1;
                      iVar7 = iVar7 + -1;
                    } while (0 < iVar7);
                    uVar5 = (longlong)puVar11 - (longlong)puVar19 >> 1 & 0xffffffff;
                  }
                  if (6 < (int)uVar5) {
                    iVar7 = *(ushort *)(lVar4 + 0x12) - 1;
                    uVar12 = uVar21;
                    if ((uVar20 != 0) && (7 < (int)uVar5)) {
                      lVar17 = param_1[1];
                      puVar15 = (ushort *)param_2[3];
                      uVar9 = (ulonglong)*puVar15;
                      if (lVar17 != 0) {
                        uVar9 = (ulonglong)
                                (*(int *)(lVar17 + (ulonglong)(*puVar15 >> 8) * 4) +
                                (uint)*(byte *)puVar15);
                      }
                      uVar10 = (ulonglong)puVar15[1];
                      if (lVar17 != 0) {
                        uVar10 = (ulonglong)
                                 (*(int *)(lVar17 + (ulonglong)(puVar15[1] >> 8) * 4) +
                                 (uint)*(byte *)(puVar15 + 1));
                      }
                      if (((*(uint *)(DAT_1800b2b88 + uVar10 * 4) ^
                           *(uint *)(DAT_1800b2b88 + uVar9 * 4)) & 0xe7ffffff) == 0) {
                        uVar12 = 1;
                      }
                    }
                    if (-1 < iVar7) {
                      do {
                        iVar13 = (iVar7 + (int)uVar21) / 2;
                        iVar18 = 7;
                        puVar15 = (ushort *)
                                  (*(longlong *)(*param_1 + 0x180) + (longlong)(iVar13 * 10) * 2);
                        lVar17 = (param_2[3] + uVar12 * 2) - (longlong)puVar15;
                        do {
                          iVar8 = (uint)*(ushort *)(lVar17 + (longlong)puVar15) - (uint)*puVar15;
                          if (iVar8 != 0) goto LAB_180054f20;
                          puVar15 = puVar15 + 1;
                          iVar18 = iVar18 + -1;
                        } while (0 < iVar18);
                        iVar8 = 0;
LAB_180054f20:
                        if (iVar8 == 0) {
                          *(undefined4 *)((longlong)param_2 + 0x24) =
                               *(undefined4 *)
                                (*(longlong *)(*param_1 + 0x180) + 0x10 +
                                (longlong)(iVar13 * 10) * 2);
                          if ((int)uVar12 != 0) goto LAB_1800557e5;
                          uVar5 = param_2[3] + 0xc;
                          goto LAB_180055773;
                        }
                        iVar18 = iVar13 + -1;
                        if (-1 < iVar8) {
                          iVar18 = iVar7;
                        }
                        iVar7 = iVar18;
                        if (-1 < iVar8) {
                          uVar21 = (ulonglong)(iVar13 + 1);
                        }
                      } while ((int)uVar21 <= iVar7);
                    }
                  }
                }
                lVar17 = 0;
                if ((*(short *)(lVar4 + 0x10) != 0) &&
                   (puVar15 = (ushort *)param_2[1],
                   (ushort *)((-(ulonglong)(uVar20 != 0) & 2) + 10 + (longlong)puVar19) <= puVar15))
                {
                  if ((int)uVar5 == 0) {
                    iVar13 = (uVar20 != 0) + 6;
                    puVar11 = puVar19;
                    iVar7 = *(int *)(param_2 + 2);
                    if (puVar15 == (ushort *)0x0) {
                      iVar7 = 1;
                    }
                    do {
                      if (((puVar15 <= puVar11) ||
                          (((uVar1 = *puVar11, uVar1 == 0 && (iVar7 != 0)) ||
                           (*(ushort *)(lVar4 + 6) <= uVar1 && uVar1 != *(ushort *)(lVar4 + 6)))))
                         || (uVar1 < *(ushort *)(lVar4 + 4))) break;
                      puVar11 = puVar11 + 1;
                      iVar13 = iVar13 + -1;
                    } while (0 < iVar13);
                    uVar5 = (longlong)puVar11 - (longlong)puVar19 >> 1 & 0xffffffff;
                  }
                  if (5 < (int)uVar5) {
                    iVar7 = 0;
                    iVar13 = *(ushort *)(lVar4 + 0x10) - 1;
                    if ((uVar20 != 0) && (6 < (int)uVar5)) {
                      puVar15 = (ushort *)param_2[3];
                      lVar4 = param_1[1];
                      uVar21 = (ulonglong)*puVar15;
                      if (lVar4 != 0) {
                        uVar21 = (ulonglong)
                                 (*(int *)(lVar4 + (ulonglong)(*puVar15 >> 8) * 4) +
                                 (uint)*(byte *)puVar15);
                      }
                      uVar12 = (ulonglong)puVar15[1];
                      if (lVar4 != 0) {
                        uVar12 = (ulonglong)
                                 (*(int *)(lVar4 + (ulonglong)(puVar15[1] >> 8) * 4) +
                                 (uint)*(byte *)(puVar15 + 1));
                      }
                      if (((*(uint *)(DAT_1800b2b88 + uVar12 * 4) ^
                           *(uint *)(DAT_1800b2b88 + uVar21 * 4)) & 0xe7ffffff) == 0) {
                        lVar17 = 1;
                      }
                    }
                    if (-1 < iVar13) {
                      do {
                        iVar8 = 6;
                        iVar18 = (iVar13 + iVar7) / 2;
                        puVar15 = (ushort *)
                                  (*(longlong *)(*param_1 + 0x178) + (longlong)(iVar18 << 3) * 2);
                        lVar4 = (param_2[3] + lVar17 * 2) - (longlong)puVar15;
                        do {
                          iVar14 = (uint)*(ushort *)((longlong)puVar15 + lVar4) - (uint)*puVar15;
                          if (iVar14 != 0) break;
                          puVar15 = puVar15 + 1;
                          iVar8 = iVar8 + -1;
                          iVar14 = 0;
                        } while (0 < iVar8);
                        if (iVar14 == 0) {
                          *(undefined4 *)((longlong)param_2 + 0x24) =
                               *(undefined4 *)
                                (*(longlong *)(*param_1 + 0x178) + 0xc + (longlong)(iVar18 << 3) * 2
                                );
                          if ((int)lVar17 != 0) goto LAB_1800557e5;
                          uVar5 = param_2[3] + 10;
                          goto LAB_180055773;
                        }
                        iVar8 = iVar18 + -1;
                        if (-1 < iVar14) {
                          iVar8 = iVar13;
                        }
                        iVar13 = iVar8;
                        if (-1 < iVar14) {
                          iVar7 = iVar18 + 1;
                        }
                      } while (iVar7 <= iVar13);
                    }
                  }
                }
              }
              uVar21 = 0;
              lVar17 = *param_1;
              lVar4 = *(longlong *)(lVar17 + 0x150);
              uVar20 = *(uint *)(lVar17 + 0x140) & 0x20;
              if ((*(short *)(lVar4 + 0xe) != 0) &&
                 (puVar15 = (ushort *)param_2[1],
                 (ushort *)((-(ulonglong)(uVar20 != 0) & 2) + 8 + (longlong)puVar19) <= puVar15)) {
                if ((int)uVar5 == 0) {
                  iVar13 = (uVar20 != 0) + 5;
                  puVar11 = puVar19;
                  iVar7 = *(int *)(param_2 + 2);
                  if (puVar15 == (ushort *)0x0) {
                    iVar7 = 1;
                  }
                  do {
                    if (((puVar15 <= puVar11) ||
                        (((uVar1 = *puVar11, uVar1 == 0 && (iVar7 != 0)) ||
                         (*(ushort *)(lVar4 + 6) <= uVar1 && uVar1 != *(ushort *)(lVar4 + 6))))) ||
                       (uVar1 < *(ushort *)(lVar4 + 4))) break;
                    puVar11 = puVar11 + 1;
                    iVar13 = iVar13 + -1;
                  } while (0 < iVar13);
                  uVar5 = (longlong)puVar11 - (longlong)puVar19 >> 1 & 0xffffffff;
                }
                if (4 < (int)uVar5) {
                  iVar7 = 0;
                  iVar13 = *(ushort *)(lVar4 + 0xe) - 1;
                  if ((uVar20 != 0) && (5 < (int)uVar5)) {
                    puVar15 = (ushort *)param_2[3];
                    lVar16 = param_1[1];
                    uVar21 = (ulonglong)*puVar15;
                    if (lVar16 != 0) {
                      uVar21 = (ulonglong)
                               (*(int *)(lVar16 + (ulonglong)(*puVar15 >> 8) * 4) +
                               (uint)*(byte *)puVar15);
                    }
                    uVar12 = (ulonglong)puVar15[1];
                    if (lVar16 != 0) {
                      uVar12 = (ulonglong)
                               (*(int *)(lVar16 + (ulonglong)(puVar15[1] >> 8) * 4) +
                               (uint)*(byte *)(puVar15 + 1));
                    }
                    uVar21 = (ulonglong)
                             (((*(uint *)(DAT_1800b2b88 + uVar12 * 4) ^
                               *(uint *)(DAT_1800b2b88 + uVar21 * 4)) & 0xe7ffffff) == 0);
                  }
                  if (-1 < iVar13) {
                    do {
                      iVar18 = (iVar13 + iVar7) / 2;
                      iVar8 = 5;
                      puVar15 = (ushort *)
                                (*(longlong *)(lVar17 + 0x170) + (longlong)(iVar18 << 3) * 2);
                      lVar16 = (param_2[3] + uVar21 * 2) - (longlong)puVar15;
                      do {
                        iVar14 = (uint)*(ushort *)(lVar16 + (longlong)puVar15) - (uint)*puVar15;
                        if (iVar14 != 0) goto LAB_18005524b;
                        puVar15 = puVar15 + 1;
                        iVar8 = iVar8 + -1;
                      } while (0 < iVar8);
                      iVar14 = 0;
LAB_18005524b:
                      if (iVar14 == 0) {
                        *(undefined4 *)((longlong)param_2 + 0x24) =
                             *(undefined4 *)
                              (*(longlong *)(lVar17 + 0x170) + 0xc + (longlong)(iVar18 << 3) * 2);
                        if ((int)uVar21 == 0) {
                          param_2[3] = param_2[3] + 8;
                        }
                        goto LAB_1800557e5;
                      }
                      iVar8 = iVar18 + -1;
                      if (-1 < iVar14) {
                        iVar8 = iVar13;
                      }
                      iVar13 = iVar8;
                      if (-1 < iVar14) {
                        iVar7 = iVar18 + 1;
                      }
                    } while (iVar7 <= iVar13);
                  }
                }
              }
              lVar17 = 0;
              if ((*(short *)(lVar4 + 0xc) != 0) &&
                 (puVar15 = (ushort *)param_2[1],
                 (ushort *)((-(ulonglong)(uVar20 != 0) & 2) + 6 + (longlong)puVar19) <= puVar15)) {
                if ((int)uVar5 == 0) {
                  iVar13 = (uVar20 != 0) + 4;
                  puVar11 = puVar19;
                  iVar7 = *(int *)(param_2 + 2);
                  if (puVar15 == (ushort *)0x0) {
                    iVar7 = 1;
                  }
                  do {
                    if ((puVar15 <= puVar11) ||
                       ((((uVar1 = *puVar11, uVar1 == 0 && (iVar7 != 0)) ||
                         (*(ushort *)(lVar4 + 6) <= uVar1 && uVar1 != *(ushort *)(lVar4 + 6))) ||
                        (uVar1 < *(ushort *)(lVar4 + 4))))) break;
                    puVar11 = puVar11 + 1;
                    iVar13 = iVar13 + -1;
                  } while (0 < iVar13);
                  uVar5 = (longlong)puVar11 - (longlong)puVar19 >> 1 & 0xffffffff;
                }
                if (3 < (int)uVar5) {
                  iVar7 = 0;
                  iVar13 = *(ushort *)(lVar4 + 0xc) - 1;
                  if ((uVar20 != 0) && (4 < (int)uVar5)) {
                    puVar15 = (ushort *)param_2[3];
                    lVar4 = param_1[1];
                    uVar21 = (ulonglong)*puVar15;
                    if (lVar4 != 0) {
                      uVar21 = (ulonglong)
                               (*(int *)(lVar4 + (ulonglong)(*puVar15 >> 8) * 4) +
                               (uint)*(byte *)puVar15);
                    }
                    uVar12 = (ulonglong)puVar15[1];
                    if (lVar4 != 0) {
                      uVar12 = (ulonglong)
                               (*(int *)(lVar4 + (ulonglong)(puVar15[1] >> 8) * 4) +
                               (uint)*(byte *)(puVar15 + 1));
                    }
                    if (((*(uint *)(DAT_1800b2b88 + uVar21 * 4) ^
                         *(uint *)(DAT_1800b2b88 + uVar12 * 4)) & 0xe7ffffff) == 0) {
                      lVar17 = 1;
                    }
                  }
                  if (-1 < iVar13) {
                    do {
                      iVar18 = (iVar13 + iVar7) / 2;
                      iVar8 = 4;
                      puVar15 = (ushort *)
                                (*(longlong *)(*param_1 + 0x168) + (longlong)(iVar18 * 6) * 2);
                      lVar4 = (param_2[3] + lVar17 * 2) - (longlong)puVar15;
                      do {
                        iVar14 = (uint)*(ushort *)(lVar4 + (longlong)puVar15) - (uint)*puVar15;
                        if (iVar14 != 0) break;
                        puVar15 = puVar15 + 1;
                        iVar8 = iVar8 + -1;
                        iVar14 = 0;
                      } while (0 < iVar8);
                      if (iVar14 == 0) {
                        *(undefined4 *)((longlong)param_2 + 0x24) =
                             *(undefined4 *)
                              (*(longlong *)(*param_1 + 0x168) + 8 + (longlong)(iVar18 * 6) * 2);
                        if ((int)lVar17 != 0) goto LAB_1800557e5;
                        uVar5 = param_2[3] + 6;
                        goto LAB_180055773;
                      }
                      iVar8 = iVar18 + -1;
                      if (-1 < iVar14) {
                        iVar8 = iVar13;
                      }
                      iVar13 = iVar8;
                      if (-1 < iVar14) {
                        iVar7 = iVar18 + 1;
                      }
                    } while (iVar7 <= iVar13);
                  }
                }
              }
            }
            uVar21 = 0;
            iVar7 = (int)uVar5;
            lVar17 = *param_1;
            lVar4 = *(longlong *)(lVar17 + 0x150);
            uVar20 = *(uint *)(lVar17 + 0x140) & 0x20;
            if ((*(short *)(lVar4 + 10) != 0) &&
               (puVar15 = (ushort *)param_2[1],
               (ushort *)((-(ulonglong)(uVar20 != 0) & 2) + 4 + (longlong)puVar19) <= puVar15)) {
              if (iVar7 == 0) {
                iVar7 = (uVar20 != 0) + 3;
                puVar11 = puVar19;
                uVar5 = (ulonglong)*(uint *)(param_2 + 2);
                if (puVar15 == (ushort *)0x0) {
                  uVar5 = 1;
                }
                do {
                  if (((puVar15 <= puVar11) ||
                      (((uVar1 = *puVar11, uVar1 == 0 && ((int)uVar5 != 0)) ||
                       (*(ushort *)(lVar4 + 6) <= uVar1 && uVar1 != *(ushort *)(lVar4 + 6))))) ||
                     (uVar1 < *(ushort *)(lVar4 + 4))) break;
                  puVar11 = puVar11 + 1;
                  iVar7 = iVar7 + -1;
                } while (0 < iVar7);
                iVar7 = (int)((longlong)puVar11 - (longlong)puVar19 >> 1);
              }
              if (2 < iVar7) {
                iVar13 = *(ushort *)(lVar4 + 10) - 1;
                uVar5 = uVar21;
                if ((uVar20 != 0) && (3 < iVar7)) {
                  puVar15 = (ushort *)param_2[3];
                  lVar16 = param_1[1];
                  uVar12 = (ulonglong)*puVar15;
                  if (lVar16 != 0) {
                    uVar12 = (ulonglong)
                             (*(int *)(lVar16 + (ulonglong)(*puVar15 >> 8) * 4) +
                             (uint)*(byte *)puVar15);
                  }
                  uVar9 = (ulonglong)puVar15[1];
                  if (lVar16 != 0) {
                    uVar9 = (ulonglong)
                            (*(int *)(lVar16 + (ulonglong)(puVar15[1] >> 8) * 4) +
                            (uint)*(byte *)(puVar15 + 1));
                  }
                  if (((*(uint *)(DAT_1800b2b88 + uVar9 * 4) ^ *(uint *)(DAT_1800b2b88 + uVar12 * 4)
                       ) & 0xe7ffffff) == 0) {
                    uVar5 = 1;
                  }
                }
                if (-1 < iVar13) {
                  do {
                    iVar18 = (iVar13 + (int)uVar21) / 2;
                    iVar8 = 3;
                    puVar15 = (ushort *)(*(longlong *)(lVar17 + 0x160) + (longlong)(iVar18 * 6) * 2)
                    ;
                    lVar16 = (param_2[3] + uVar5 * 2) - (longlong)puVar15;
                    do {
                      iVar14 = (uint)*(ushort *)((longlong)puVar15 + lVar16) - (uint)*puVar15;
                      if (iVar14 != 0) goto LAB_180055563;
                      puVar15 = puVar15 + 1;
                      iVar8 = iVar8 + -1;
                    } while (0 < iVar8);
                    iVar14 = 0;
LAB_180055563:
                    if (iVar14 == 0) {
                      *(undefined4 *)((longlong)param_2 + 0x24) =
                           *(undefined4 *)
                            (*(longlong *)(lVar17 + 0x160) + 8 + (longlong)(iVar18 * 6) * 2);
                      if ((int)uVar5 != 0) goto LAB_1800557e5;
                      uVar5 = param_2[3] + 4;
                      goto LAB_180055773;
                    }
                    iVar8 = iVar18 + -1;
                    if (-1 < iVar14) {
                      iVar8 = iVar13;
                    }
                    iVar13 = iVar8;
                    if (-1 < iVar14) {
                      uVar21 = (ulonglong)(iVar18 + 1);
                    }
                  } while ((int)uVar21 <= iVar13);
                }
              }
            }
            lVar17 = 0;
            if ((*(short *)(lVar4 + 8) != 0) &&
               (puVar15 = (ushort *)param_2[1],
               (ushort *)((-(ulonglong)(uVar20 != 0) & 2) + 2 + (longlong)puVar19) <= puVar15)) {
              if (iVar7 == 0) {
                iVar13 = (uVar20 != 0) + 2;
                puVar11 = puVar19;
                iVar7 = *(int *)(param_2 + 2);
                if (puVar15 == (ushort *)0x0) {
                  iVar7 = 1;
                }
                do {
                  if (((puVar15 <= puVar11) ||
                      (((uVar1 = *puVar11, uVar1 == 0 && (iVar7 != 0)) ||
                       (*(ushort *)(lVar4 + 6) <= uVar1 && uVar1 != *(ushort *)(lVar4 + 6))))) ||
                     (uVar1 < *(ushort *)(lVar4 + 4))) break;
                  puVar11 = puVar11 + 1;
                  iVar13 = iVar13 + -1;
                } while (0 < iVar13);
                iVar7 = (int)((longlong)puVar11 - (longlong)puVar19 >> 1);
              }
              if (1 < iVar7) {
                iVar13 = 0;
                iVar18 = *(ushort *)(lVar4 + 8) - 1;
                if ((uVar20 != 0) && (2 < iVar7)) {
                  puVar15 = (ushort *)param_2[3];
                  lVar4 = param_1[1];
                  uVar5 = (ulonglong)*puVar15;
                  if (lVar4 != 0) {
                    uVar5 = (ulonglong)
                            (*(int *)(lVar4 + (ulonglong)(*puVar15 >> 8) * 4) +
                            (uint)*(byte *)puVar15);
                  }
                  uVar21 = (ulonglong)puVar15[1];
                  if (lVar4 != 0) {
                    uVar21 = (ulonglong)
                             (*(int *)(lVar4 + (ulonglong)(puVar15[1] >> 8) * 4) +
                             (uint)*(byte *)(puVar15 + 1));
                  }
                  if (((*(uint *)(DAT_1800b2b88 + uVar21 * 4) ^ *(uint *)(DAT_1800b2b88 + uVar5 * 4)
                       ) & 0xe7ffffff) == 0) {
                    lVar17 = 1;
                  }
                }
                if (-1 < iVar18) {
LAB_1800556ba:
                  iVar7 = (iVar18 + iVar13) / 2;
                  puVar15 = (ushort *)(*(longlong *)(*param_1 + 0x158) + (longlong)(iVar7 << 2) * 2)
                  ;
                  lVar4 = (param_2[3] + lVar17 * 2) - (longlong)puVar15;
                  iVar8 = 2;
                  do {
                    iVar14 = (uint)*(ushort *)((longlong)puVar15 + lVar4) - (uint)*puVar15;
                    if (iVar14 != 0) break;
                    puVar15 = puVar15 + 1;
                    iVar8 = iVar8 + -1;
                    iVar14 = 0;
                  } while (0 < iVar8);
                  if (iVar14 != 0) goto code_r0x0001800556fa;
                  *(undefined4 *)((longlong)param_2 + 0x24) =
                       *(undefined4 *)
                        (*(longlong *)(*param_1 + 0x158) + 4 + (longlong)(iVar7 << 2) * 2);
                  if ((int)lVar17 == 0) {
                    uVar5 = param_2[3] + 2;
LAB_180055773:
                    param_2[3] = uVar5;
                  }
LAB_1800557e5:
                  puVar19 = (ushort *)param_2[3];
                }
              }
            }
          }
LAB_18005572c:
          param_2[3] = (ulonglong)(puVar19 + 1);
        } while (puVar19 + 1 < (ushort *)param_2[1]);
      }
      uVar3 = 1;
      param_2[3] = uVar2;
    }
  }
  return uVar3;
code_r0x0001800556fa:
  iVar8 = iVar7 + -1;
  if (-1 < iVar14) {
    iVar8 = iVar18;
  }
  iVar18 = iVar8;
  if (-1 < iVar14) {
    iVar13 = iVar7 + 1;
  }
  if (iVar18 < iVar13) goto LAB_18005572c;
  goto LAB_1800556ba;
}



void FUN_180055890(longlong param_1,longlong param_2)

{
  ushort *puVar1;
  undefined4 uVar2;
  ulonglong uVar3;
  ushort uVar4;
  byte local_res10;
  undefined local_res11;
  undefined local_res12;
  
  *(undefined4 *)(param_2 + 0x2c) = 0;
  puVar1 = (ushort *)(param_2 + 0x28);
  uVar3 = FUN_180057c10(param_1,*(ushort **)(param_2 + 0x18),*(ushort **)(param_2 + 8),puVar1,
                        &local_res10);
  if ((int)uVar3 < 1) {
    if (param_1 == 0) {
      uVar3 = (ulonglong)*(ushort *)(param_2 + 0x2a);
    }
    else {
      uVar3 = (ulonglong)
              (*(int *)(param_1 + (ulonglong)(*(ushort *)(param_2 + 0x2a) >> 8) * 4) +
              (uint)(byte)*(ushort *)(param_2 + 0x2a));
    }
    uVar2 = *(undefined4 *)(DAT_1800b2b88 + uVar3 * 4);
    *(undefined4 *)(param_2 + 0x24) = uVar2;
    uVar4 = (short)uVar2 << 8 | (ushort)*(byte *)(param_2 + 0x26);
    *(undefined *)(param_2 + 0x26) = 2;
    *(byte *)(param_2 + 0x27) = *(byte *)(param_2 + 0x27) & 0x3f;
    *puVar1 = uVar4;
    *(ushort *)(param_2 + 0x24) = uVar4;
  }
  else {
    *(uint *)(param_2 + 0x24) = *puVar1 | 0x2020000;
    *(uint *)(param_2 + 0x2c) = (uint)CONCAT21(CONCAT11(local_res10,local_res11),local_res12);
    *(longlong *)(param_2 + 0x18) = *(longlong *)(param_2 + 0x18) + (longlong)((int)uVar3 + -1) * 2;
  }
  return;
}



int FUN_180055960(longlong param_1,int param_2,longlong param_3,int param_4,longlong param_5,
                 longlong param_6)

{
  byte bVar1;
  ushort uVar2;
  short sVar3;
  bool bVar4;
  undefined2 uVar5;
  int iVar6;
  ulonglong uVar7;
  ushort uVar8;
  undefined2 *puVar9;
  longlong lVar10;
  longlong lVar11;
  int iVar12;
  int local_res20 [2];
  
  bVar4 = false;
  iVar6 = param_2;
  if (param_4 != 0) {
    if (param_4 < param_2) {
      SetLastError(0x7a);
      iVar6 = 0;
    }
    else {
      local_res20[0] = 0;
      if (0 < param_2) {
        do {
          lVar10 = (longlong)local_res20[0];
          if (*(short *)(param_1 + lVar10 * 2) == -0x27ff) {
            FUN_180055ca4((short *)&DAT_180085c40,param_1,param_2,local_res20,param_3);
          }
          else {
            bVar1 = *(byte *)(param_1 + lVar10 * 2);
            *(short *)(param_3 + lVar10 * 2) =
                 *(short *)(param_6 +
                           ((ulonglong)
                            *(ushort *)
                             (param_6 +
                             (ulonglong)
                             ((uint)*(ushort *)
                                     (param_6 +
                                     (ulonglong)(*(ushort *)(param_1 + lVar10 * 2) >> 8) * 2) +
                             (uint)(bVar1 >> 4)) * 2) + (ulonglong)(bVar1 & 0xf)) * 2) +
                 *(short *)(param_1 + lVar10 * 2);
          }
          local_res20[0] = local_res20[0] + 1;
        } while (local_res20[0] < param_2);
      }
      iVar12 = 0;
      local_res20[0] = 0;
      lVar10 = DAT_1800b2bb8;
      iVar6 = 0;
      if (0 < param_2) {
        do {
          lVar11 = (longlong)local_res20[0] * 2;
          uVar2 = *(ushort *)(param_1 + lVar11);
          if (bVar4) {
            uVar8 = *(ushort *)
                     (DAT_1800b2bb0 +
                     (ulonglong)
                     *(byte *)((ulonglong)((uint)((ulonglong)uVar2 & 0xff) & 0xf) +
                              (ulonglong)
                              *(ushort *)
                               (lVar10 + ((ulonglong)
                                          (*(ushort *)(lVar10 + (ulonglong)(uVar2 >> 8) * 2) >> 1) +
                                         (((ulonglong)uVar2 & 0xff) >> 4)) * 2) + lVar10) * 6);
            if ((uVar8 & 0x100) == 0) {
              if ((uVar2 == 0x27) || (uVar2 == 0x2019)) {
                uVar8 = 0;
              }
              else {
                uVar8 = uVar8 & 0x38;
              }
              if ((uVar8 != 0) && (bVar4 = false, -1 < iVar12)) {
                if (iVar12 < local_res20[0]) {
                  uVar7 = (ulonglong)(uint)(local_res20[0] - iVar12);
                  puVar9 = (undefined2 *)(param_3 + (longlong)iVar12 * 2);
                  do {
                    *puVar9 = *(undefined2 *)((param_1 - param_3) + (longlong)puVar9);
                    puVar9 = puVar9 + 1;
                    uVar7 = uVar7 - 1;
                    lVar10 = DAT_1800b2bb8;
                  } while (uVar7 != 0);
                }
                goto LAB_180055c38;
              }
            }
            else if ((-1 < iVar12) && (*(ushort *)(lVar11 + param_3) == uVar2)) {
LAB_180055c38:
              iVar12 = -1;
            }
          }
          else {
            if (uVar2 == 0xd801) {
              FUN_180055ca4((short *)&DAT_180085c50,param_1,param_2,local_res20,param_3);
            }
            else {
              *(ushort *)(lVar11 + param_3) =
                   *(short *)(param_5 +
                             ((ulonglong)
                              *(ushort *)
                               (param_5 +
                               (ulonglong)
                               ((uint)*(ushort *)(param_5 + (ulonglong)(uVar2 >> 8) * 2) +
                               (uint)(*(byte *)(param_1 + lVar11) >> 4)) * 2) +
                             (ulonglong)(*(byte *)(param_1 + lVar11) & 0xf)) * 2) + uVar2;
            }
            lVar11 = (longlong)local_res20[0];
            sVar3 = *(short *)(param_3 + lVar11 * 2);
            iVar12 = local_res20[0];
            if (sVar3 != *(short *)(param_1 + lVar11 * 2)) {
              iVar12 = -1;
            }
            if (sVar3 == 0x1c4) {
              uVar5 = 0x1c5;
LAB_180055b28:
              *(undefined2 *)(param_3 + lVar11 * 2) = uVar5;
            }
            else {
              if (sVar3 == 0x1c7) {
                uVar5 = 0x1c8;
                goto LAB_180055b28;
              }
              if (sVar3 == 0x1ca) {
                uVar5 = 0x1cb;
                goto LAB_180055b28;
              }
              if (sVar3 == 0x1f1) {
                uVar5 = 0x1f2;
                goto LAB_180055b28;
              }
            }
            bVar1 = *(byte *)(param_1 + lVar11 * 2);
            lVar10 = DAT_1800b2bb8;
            if ((*(ushort *)
                  (DAT_1800b2bb0 +
                  (ulonglong)
                  *(byte *)((ulonglong)(bVar1 & 0xf) +
                           (ulonglong)
                           *(ushort *)
                            (DAT_1800b2bb8 +
                            ((ulonglong)
                             (*(ushort *)
                               (DAT_1800b2bb8 +
                               (ulonglong)(*(ushort *)(param_1 + lVar11 * 2) >> 8) * 2) >> 1) +
                            (ulonglong)(bVar1 >> 4)) * 2) + DAT_1800b2bb8) * 6) & 0x100) != 0) {
              bVar4 = true;
            }
          }
          local_res20[0] = local_res20[0] + 1;
        } while (local_res20[0] < param_2);
        iVar6 = local_res20[0];
        if ((-1 < iVar12) && (iVar12 < local_res20[0])) {
          puVar9 = (undefined2 *)(param_3 + (longlong)iVar12 * 2);
          uVar7 = (ulonglong)(uint)(local_res20[0] - iVar12);
          do {
            *puVar9 = *(undefined2 *)((longlong)puVar9 + (param_1 - param_3));
            puVar9 = puVar9 + 1;
            uVar7 = uVar7 - 1;
          } while (uVar7 != 0);
        }
      }
    }
  }
  return iVar6;
}



void FUN_180055ca4(short *param_1,longlong param_2,int param_3,int *param_4,longlong param_5)

{
  ushort uVar1;
  int iVar2;
  longlong lVar3;
  
  iVar2 = *param_4;
  lVar3 = (longlong)iVar2;
  *(undefined2 *)(param_5 + lVar3 * 2) = 0xd801;
  iVar2 = iVar2 + 1;
  if (((iVar2 < param_3) &&
      (uVar1 = *(ushort *)(param_2 + 2 + lVar3 * 2), *(int *)(param_1 + 2) <= (int)(uint)uVar1)) &&
     ((int)(uint)uVar1 <= *(int *)(param_1 + 4))) {
    *param_4 = iVar2;
    *(ushort *)(param_5 + 2 + lVar3 * 2) = *param_1 + uVar1;
  }
  return;
}



uint FUN_180055cf4(uint param_1,byte *param_2,byte *param_3)

{
  byte *pbVar1;
  longlong lVar2;
  
  lVar2 = (longlong)param_3 - (longlong)param_2;
  if (param_3 < param_2) {
    lVar2 = 0;
  }
  pbVar1 = param_2;
  if (lVar2 != 0) {
    do {
      if (2 < *pbVar1) {
        param_1 = (*pbVar1 ^ param_1) * 0x83;
      }
      pbVar1 = pbVar1 + 1;
    } while ((longlong)pbVar1 - (longlong)param_2 != lVar2);
  }
  return param_1;
}



bool FUN_180055d38(uint param_1)

{
  bool bVar1;
  bool bVar2;
  bool bVar3;
  
  bVar1 = ((param_1 & 0xffffffe2) - 1 & param_1 & 0x22) == 0;
  bVar2 = (param_1 & 0xe7fcefc0) == 0;
  bVar3 = ((param_1 & 0xfffffff1) - 1 & param_1 & 0x11) == 0;
  if (!bVar3 || (!bVar1 || !bVar2)) {
    SetLastError(0x3ec);
  }
  return bVar3 && (bVar1 && bVar2);
}



void FUN_180055d9c(longlong param_1,longlong param_2,uint param_3)

{
  byte *_Dst;
  void *pvVar1;
  void *pvVar2;
  uint uVar3;
  rsize_t rVar4;
  uint uVar5;
  ulonglong uVar6;
  
  _Dst = *(byte **)(param_1 + 0x38);
  uVar6 = (ulonglong)param_3;
  uVar3 = FUN_180055cf4(*(uint *)(param_2 + 0x30),_Dst,*(byte **)(param_2 + 8));
  uVar5 = (uint)uVar6;
  *(uint *)(param_2 + 0x30) = uVar3;
  if ((uVar6 & 2) == 0) {
    uVar3 = FUN_180055cf4(*(uint *)(param_2 + 0x34),*(byte **)(param_1 + 0x40),
                          *(byte **)(param_2 + 0x10));
    *(uint *)(param_2 + 0x34) = uVar3;
  }
  if ((uVar5 & 0x20001) != 0x20001) {
    uVar3 = FUN_180055cf4(*(uint *)(param_2 + 0x38),*(byte **)(param_1 + 0x48),
                          *(byte **)(param_2 + 0x18));
    *(uint *)(param_2 + 0x38) = uVar3;
  }
  if (*(int *)(param_1 + 0x20) == 0) {
    uVar3 = FUN_180055cf4(*(uint *)(param_2 + 0x40),*(byte **)(param_1 + 0x58),
                          *(byte **)(param_2 + 0x28));
    *(uint *)(param_2 + 0x40) = uVar3;
  }
  if ((uVar6 & 2) == 0) {
    uVar3 = FUN_180055cf4(*(uint *)(param_2 + 0x3c),*(byte **)(param_1 + 0x50),
                          *(byte **)(param_2 + 0x20));
    *(uint *)(param_2 + 0x3c) = uVar3;
  }
  rVar4 = *(longlong *)(param_1 + 0x78) - *(longlong *)(param_2 + 8);
  memmove_s(_Dst,rVar4,*(void **)(param_2 + 8),rVar4);
  pvVar1 = *(void **)(param_2 + 0x10);
  *(byte **)(param_1 + 0x78) = _Dst + rVar4;
  pvVar2 = *(void **)(param_1 + 0x40);
  rVar4 = *(longlong *)(param_1 + 0x80) - (longlong)pvVar1;
  memmove_s(pvVar2,rVar4,pvVar1,rVar4);
  pvVar1 = *(void **)(param_2 + 0x18);
  *(rsize_t *)(param_1 + 0x80) = rVar4 + (longlong)pvVar2;
  pvVar2 = *(void **)(param_1 + 0x48);
  rVar4 = *(longlong *)(param_1 + 0x88) - (longlong)pvVar1;
  memmove_s(pvVar2,rVar4,pvVar1,rVar4);
  pvVar1 = *(void **)(param_2 + 0x20);
  *(rsize_t *)(param_1 + 0x88) = rVar4 + (longlong)pvVar2;
  pvVar2 = *(void **)(param_1 + 0x50);
  rVar4 = *(longlong *)(param_1 + 0x90) - (longlong)pvVar1;
  memmove_s(pvVar2,rVar4,pvVar1,rVar4);
  pvVar1 = *(void **)(param_2 + 0x28);
  *(rsize_t *)(param_1 + 0x90) = rVar4 + (longlong)pvVar2;
  pvVar2 = *(void **)(param_1 + 0x58);
  rVar4 = *(longlong *)(param_1 + 0x98) - (longlong)pvVar1;
  memmove_s(pvVar2,rVar4,pvVar1,rVar4);
  *(rsize_t *)(param_1 + 0x98) = rVar4 + (longlong)pvVar2;
  return;
}



void FUN_180055f48(longlong *param_1,longlong param_2,uint param_3,longlong param_4,int param_5)

{
  int iVar1;
  uint uVar2;
  longlong lVar3;
  longlong lVar4;
  longlong lVar5;
  
  if ((param_3 >> 0x1b & 1) == 0) {
    lVar3 = *(longlong *)(param_2 + 0x138);
  }
  else {
    lVar3 = *(longlong *)(param_2 + 0x130);
  }
  param_1[1] = lVar3;
  *param_1 = param_2;
  param_1[0xc] = param_4;
  param_1[0x14] = param_4;
  param_1[0xd] = param_4 + (longlong)param_5 * 2;
  *(uint *)(param_1 + 6) = *(uint *)(param_2 + 0x140) & 1;
  param_1[2] = DAT_1800b2b98;
  uVar2 = param_3 & 0x30001;
  *(undefined *)(param_1 + 3) = 0xff;
  if (uVar2 == 1) {
    *(undefined *)(param_1 + 3) = 0xe7;
  }
  else if (uVar2 == 0x10000) {
    *(undefined *)(param_1 + 3) = 0xdf;
  }
  else if (uVar2 == 0x10001) {
    *(undefined *)(param_1 + 3) = 199;
  }
  else if (uVar2 == 0x20000) {
    *(undefined *)(param_1 + 3) = 0xfe;
  }
  else if (uVar2 == 0x20001) {
    *(undefined *)(param_1 + 3) = 0xe6;
  }
  else if (uVar2 == 0x30000) {
    *(undefined *)(param_1 + 3) = 0xde;
  }
  else if (uVar2 == 0x30001) {
    *(undefined *)(param_1 + 3) = 0xc6;
  }
  iVar1 = *(int *)(param_1 + 0xe);
  *(undefined4 *)((longlong)param_1 + 0xb4) = 0;
  lVar5 = (longlong)(iVar1 << 3) + param_1[7];
  param_1[8] = lVar5;
  param_1[0xf] = param_1[7];
  lVar3 = iVar1 + lVar5;
  param_1[0x10] = lVar5;
  lVar5 = lVar3 + iVar1;
  param_1[9] = lVar3;
  lVar4 = (iVar1 << 2) + lVar5;
  param_1[10] = lVar5;
  param_1[0xb] = lVar4;
  param_1[0x13] = lVar4;
  param_1[0x11] = lVar3;
  *(uint *)((longlong)param_1 + 0x1c) = param_3 & 0x1000;
  param_1[0x12] = lVar5;
  *(uint *)(param_1 + 4) = param_3 & 4;
  *(uint *)((longlong)param_1 + 0x2c) = param_3 & 8;
  *(uint *)(param_1 + 5) = param_3 & 0x20;
  *(uint *)((longlong)param_1 + 0x24) = param_3 & 0x10;
  return;
}



void FUN_1800560a0(longlong param_1,uint param_2,short *param_3,uint param_4,uint *param_5)

{
  undefined2 uVar1;
  undefined4 uVar2;
  longlong lVar3;
  undefined2 *puVar4;
  int iVar5;
  bool bVar6;
  byte bVar7;
  int iVar8;
  undefined7 extraout_var;
  ulonglong uVar9;
  ushort *puVar10;
  byte bVar11;
  DWORD dwErrCode;
  uint uVar12;
  short sVar13;
  uint uVar14;
  ushort *puVar15;
  longlong lVar16;
  ushort uVar17;
  byte *pbVar18;
  byte bVar19;
  ushort uVar20;
  int iVar21;
  ushort uVar22;
  undefined *puVar23;
  byte bVar24;
  longlong lVar25;
  ulonglong uVar26;
  longlong lVar27;
  int iVar28;
  int iVar29;
  uint uVar30;
  ushort *puVar31;
  longlong lVar32;
  undefined2 *puVar33;
  undefined auStackY3944 [32];
  uint local_f28;
  int local_f24;
  uint local_f20;
  ushort *local_f18;
  longlong local_ef8;
  longlong local_ef0;
  longlong local_ee8;
  byte local_ee0;
  int local_edc;
  int local_ed8;
  int local_ed4;
  int local_ed0;
  int local_ecc;
  int local_ec8;
  byte *local_ec0;
  byte *local_eb8;
  ushort *local_e98;
  ushort *local_e90;
  int local_e88;
  byte *local_e80;
  byte *local_e78;
  byte *local_e70;
  byte *local_e68;
  undefined *local_e60;
  ushort *local_e58;
  undefined2 *local_e50;
  byte local_e48;
  int local_e44;
  ushort *local_e38;
  byte local_e30;
  byte local_e2f;
  byte local_e2e;
  undefined2 local_e2c [2];
  uint local_e28;
  uint *local_e20;
  longlong *local_e18;
  byte *local_e10;
  byte *local_e08;
  byte *local_e00;
  byte *local_df8;
  undefined *local_df0;
  int local_de8;
  int local_de4;
  int local_de0;
  int local_ddc;
  int local_dd8;
  byte local_dc8 [3456];
  ulonglong local_48;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStackY3944;
  local_e20 = param_5;
  local_e28 = param_2;
  if (((param_1 == 0) || (param_4 == 0)) || (param_3 == (short *)0x0)) {
    dwErrCode = 0x57;
  }
  else {
    bVar6 = FUN_180055d38(param_2);
    if ((int)CONCAT71(extraout_var,bVar6) == 0) goto LAB_180057985;
    if (DAT_1800b2b88 != 0) {
      local_e88 = 0xc0;
      local_ec0 = local_dc8;
      iVar28 = 1;
      if (0x7fffffff < param_4) {
        uVar9 = FUN_180002600(param_3);
        param_4 = iVar28 + (int)uVar9;
      }
      FUN_180055f48(&local_ef8,param_1,param_2,(longlong)param_3,param_4);
      local_e18 = &local_ef8;
      local_de8 = -0x7ee3623b;
      local_de4 = -0x7ee3623b;
      local_de0 = -0x7ee3623b;
      local_ddc = -0x7ee3623b;
      local_dd8 = -0x7ee3623b;
      local_f18 = local_e58;
      puVar10 = local_e58;
      lVar16 = local_ef0;
      pbVar18 = local_e80;
      puVar31 = local_e90;
      lVar32 = DAT_1800b2b88;
      if (local_e58 < local_e90) {
        do {
          puVar15 = local_e58;
          bVar7 = 2;
          if (lVar16 == 0) {
            uVar9 = (ulonglong)*local_e58;
          }
          else {
            uVar9 = (ulonglong)
                    (*(int *)(lVar16 + (ulonglong)(*local_e58 >> 8) * 4) + (uint)*(byte *)local_e58)
            ;
            puVar10 = local_f18;
          }
          puVar33 = (undefined2 *)(lVar32 + uVar9 * 4);
          local_e48 = *(byte *)((longlong)puVar33 + 1);
          uVar17 = 0;
          local_e50 = puVar33;
          if (local_e48 < 0xd) {
            if (local_e48 == 0) {
              if (*local_e58 == 0xdb40) {
                puVar15 = local_e58 + 1;
                if (puVar15 < puVar31) {
                  uVar17 = *puVar15;
                }
                puVar10 = local_f18;
                if ((ushort)(uVar17 + 0x2300) < 0xf0) {
                  local_e58 = puVar15;
                }
              }
            }
            else {
              if (local_e48 != 1) {
                if (local_e48 == 2) {
                  bVar11 = *(byte *)((longlong)puVar33 + 1);
                  while (puVar4 = puVar33, bVar11 == 2) {
                    uVar9 = (ulonglong)(ushort)puVar4[1];
                    if (lVar16 == 0) {
                      uVar9 = (ulonglong)*(ushort *)(local_ee8 + uVar9 * 4);
                    }
                    else {
                      uVar9 = (ulonglong)
                              (*(int *)(lVar16 + (ulonglong)
                                                 (*(ushort *)(local_ee8 + uVar9 * 4) >> 8) * 4) +
                              (uint)*(byte *)(local_ee8 + uVar9 * 4));
                    }
                    puVar33 = (undefined2 *)(lVar32 + uVar9 * 4);
                    uVar1 = *puVar33;
                    pbVar18[1] = (byte)uVar1;
                    *pbVar18 = (byte)((ushort)uVar1 >> 8);
                    pbVar18 = pbVar18 + 2;
                    if ((local_ed0 == 0) ||
                       ((bVar11 = bVar7, 0x14 < *(byte *)((longlong)puVar33 + 1) &&
                        (*(byte *)((longlong)puVar33 + 1) != 0x29)))) {
                      bVar11 = *(byte *)(puVar33 + 1);
                    }
                    *local_e78 = bVar11;
                    if ((local_ed4 == 0) ||
                       ((bVar11 = bVar7, 0x14 < *(byte *)((longlong)puVar33 + 1) &&
                        (*(byte *)((longlong)puVar33 + 1) != 0x29)))) {
                      bVar11 = *(byte *)((longlong)puVar33 + 3) & 0x3f;
                    }
                    *local_e70 = bVar11 & local_ee0;
                    local_e78 = local_e78 + 1;
                    local_e70 = local_e70 + 1;
                    uVar17 = *(ushort *)(local_ee8 + 2 + (ulonglong)(ushort)puVar4[1] * 4);
                    uVar9 = (ulonglong)uVar17;
                    if (local_ef0 != 0) {
                      uVar9 = (ulonglong)
                              (*(int *)(local_ef0 + (ulonglong)(uVar17 >> 8) * 4) +
                              (uint)(byte)uVar17);
                    }
                    puVar33 = (undefined2 *)(DAT_1800b2b88 + uVar9 * 4);
                    bVar11 = *(byte *)((longlong)puVar33 + 1);
                    lVar16 = local_ef0;
                    lVar32 = DAT_1800b2b88;
                    local_e50 = puVar4;
                  }
                  uVar1 = *puVar4;
                  pbVar18[1] = (byte)uVar1;
                  *pbVar18 = (byte)((ushort)uVar1 >> 8);
                  local_e80 = pbVar18 + 2;
                  if ((local_ed0 == 0) ||
                     ((0x14 < *(byte *)((longlong)puVar4 + 1) &&
                      (*(byte *)((longlong)puVar4 + 1) != 0x29)))) {
                    bVar7 = *(byte *)(puVar4 + 1);
                  }
                  *local_e78 = bVar7;
                  if ((local_ed4 != 0) &&
                     ((*(byte *)((longlong)puVar4 + 1) < 0x15 ||
                      (*(byte *)((longlong)puVar4 + 1) == 0x29)))) goto LAB_1800577c3;
                  bVar7 = *(byte *)((longlong)puVar4 + 3);
                  goto LAB_1800577cc;
                }
                if (local_e48 == 3) {
                  bVar24 = *(byte *)((longlong)puVar33 + 3) & local_ee0;
                  bVar11 = *(byte *)puVar33;
                  puVar10 = local_e58;
                  if (bVar11 < 2) {
                    do {
                      while( true ) {
                        puVar10 = puVar10 + -1;
                        uVar17 = 0xffff;
                        if (puVar10 < local_e98) goto LAB_18005747a;
                        uVar9 = (ulonglong)*puVar10;
                        if (lVar16 != 0) {
                          uVar9 = (ulonglong)
                                  (*(int *)(lVar16 + (ulonglong)(*puVar10 >> 8) * 4) +
                                  (uint)*(byte *)puVar10);
                        }
                        uVar2 = *(undefined4 *)(lVar32 + uVar9 * 4);
                        bVar19 = (byte)((uint)uVar2 >> 8);
                        if (2 < bVar19) break;
                        uVar17 = 0xffff;
                        if (bVar19 == 2) goto LAB_18005747a;
                      }
                      uVar17 = (ushort)uVar2;
                      if (bVar19 != 3) goto LAB_18005747a;
                    } while ((byte)uVar2 < 2);
                    uVar22 = uVar17 & 0xff;
                    bVar19 = (byte)((uint)uVar2 >> 0x18) & local_ee0;
                    *local_e68 = bVar19 & 0xc6 | 0xc4;
                    local_e68[local_e88 * 2] = bVar19 & 0xe4 | 0xc4;
                    if (bVar11 == 0) {
                      local_e68[local_e88] = 4;
                      local_e68[local_e88 * 3] = bVar19 & 0xc5 | 0xc4;
                    }
                    else {
                      uVar22 = uVar17 & 0x87;
                      local_e68[local_e88] = 5;
                      local_e68[local_e88 * 3] = bVar24 & 0xc5 | 0xc4;
                    }
                    local_e68 = local_e68 + 1;
                    uVar17 = uVar22 | 0x2200;
                  }
                  else {
                    *local_e68 = bVar24 & 0xc6 | 0xc4;
                    local_e68[local_e88] = 3;
                    local_e68[local_e88 * 2] = bVar24 & 0xe4 | 0xc4;
                    local_e68[local_e88 * 3] = bVar24 & 0xc5 | 0xc4;
                    local_e68 = local_e68 + 1;
                    uVar17 = bVar11 | 0x2200;
                  }
LAB_18005747a:
                  if ((local_ed0 == 0) ||
                     ((0x14 < *(byte *)((longlong)puVar33 + 1) &&
                      (*(byte *)((longlong)puVar33 + 1) != 0x29)))) {
                    bVar7 = *(byte *)(puVar33 + 1);
                  }
                  *local_e78 = bVar7;
                  *local_e70 = 2;
                  bVar7 = (byte)(uVar17 >> 8);
                  *local_e80 = bVar7;
                  local_e80[1] = (byte)uVar17;
                  pbVar18 = local_e80 + 2;
                  if (((byte)(bVar7 + 0x57) < 7) ||
                     ((local_ec8 != 0 && ((byte)(bVar7 + 0x40) < 0x30)))) {
                    puVar10 = local_e58 + -1;
                    if (puVar10 < local_e98) {
                      *pbVar18 = 0;
                    }
                    else {
                      uVar9 = (ulonglong)*puVar10;
                      if (local_ef0 != 0) {
                        uVar9 = (ulonglong)
                                (*(int *)(local_ef0 + (ulonglong)(*puVar10 >> 8) * 4) +
                                (uint)*(byte *)puVar10);
                      }
                      *pbVar18 = *(byte *)(DAT_1800b2b88 + uVar9 * 4 + 2);
                    }
                    pbVar18 = local_e80 + 3;
                  }
                  local_e80 = pbVar18;
                  puVar10 = local_f18;
                  lVar16 = local_ef0;
                  pbVar18 = local_e80;
                  puVar31 = local_e90;
                  lVar32 = DAT_1800b2b88;
                  if (uVar17 != 0xffff) {
                    local_e78 = local_e78 + 1;
                    local_e70 = local_e70 + 1;
                  }
                  goto LAB_180057872;
                }
                if (local_e48 == 4) {
                  uVar9 = FUN_180057c10(lVar16,local_e58,puVar31,local_e2c,&local_e30);
                  lVar16 = local_ef0;
                  puVar31 = local_e90;
                  if ((int)uVar9 < 1) {
                    bVar7 = *(byte *)local_e50;
                    local_e80[1] = *(byte *)(local_e50 + 1);
                    *local_e80 = bVar7;
                    *local_e78 = 2;
                    *local_e70 = *(byte *)((longlong)local_e50 + 3) & 0x3f;
                    local_e78 = local_e78 + 1;
                    local_e70 = local_e70 + 1;
                    puVar10 = local_f18;
                    pbVar18 = local_e80 + 2;
                    lVar32 = DAT_1800b2b88;
                    local_e80 = local_e80 + 2;
                  }
                  else {
                    *local_e80 = (byte)((ushort)local_e2c[0] >> 8);
                    local_e80[1] = (byte)local_e2c[0];
                    local_e80[3] = local_e30;
                    local_e80[2] = 0xff;
                    local_e80[5] = local_e2f;
                    local_e80[4] = 0xff;
                    local_e80[7] = local_e2e;
                    local_e80[6] = 0xff;
                    pbVar18 = local_e80 + 8;
                    *local_e78 = 2;
                    *local_e70 = 2;
                    local_e78 = local_e78 + 1;
                    local_e70 = local_e70 + 1;
                    puVar10 = local_f18;
                    lVar32 = DAT_1800b2b88;
                    local_e80 = pbVar18;
                    local_e58 = local_e58 + ((int)uVar9 + -1);
                  }
                  goto LAB_180057872;
                }
                if (local_e48 != 5) {
                  if (local_e48 == 6) {
                    if (local_edc != 0) goto LAB_18005718e;
                    uVar17 = ~(ushort)((ulonglong)((longlong)pbVar18 - (longlong)local_ec0) >> 1);
                    if (uVar17 < 2) {
                      uVar17 = 2;
                    }
                    *local_e60 = (char)(uVar17 >> 8);
                    local_e60[1] = (char)uVar17;
                    if ((local_ed0 == 0) ||
                       ((0x14 < *(byte *)((longlong)puVar33 + 1) &&
                        (*(byte *)((longlong)puVar33 + 1) != 0x29)))) {
                      uVar17 = (ushort)*(byte *)(puVar33 + 1);
                    }
                    else {
                      uVar17 = 2;
                    }
                    if ((local_ed4 == 0) ||
                       ((0x14 < *(byte *)((longlong)puVar33 + 1) &&
                        (*(byte *)((longlong)puVar33 + 1) != 0x29)))) {
                      uVar22 = (ushort)(*(byte *)((longlong)puVar33 + 3) & 0x3f);
                    }
                    else {
                      uVar22 = 2;
                    }
                    sVar13 = (ushort)*(byte *)puVar33 * 0x100 + (local_ee0 & uVar22 | uVar17 << 3);
                    local_e60[3] = (char)sVar13;
                    local_e60[2] = (char)((ushort)sVar13 >> 8);
                    local_e60 = local_e60 + 4;
                    puVar10 = local_f18;
                    lVar16 = local_ef0;
                    pbVar18 = local_e80;
                    puVar31 = local_e90;
                    lVar32 = DAT_1800b2b88;
                    goto LAB_180057872;
                  }
                  if ((local_e48 < 7) || (0xc < local_e48)) goto LAB_180057872;
LAB_18005718e:
                  if (local_ed8 != 0) goto LAB_180057872;
                  uVar1 = *puVar33;
                  pbVar18[1] = (byte)uVar1;
                  *pbVar18 = (byte)((ushort)uVar1 >> 8);
                  local_e80 = pbVar18 + 2;
                  *local_e78 = *(byte *)(puVar33 + 1);
                  bVar7 = *(byte *)((longlong)puVar33 + 3) & local_ee0 & 0x3f;
                  goto LAB_1800577d2;
                }
                *pbVar18 = 0xfd;
                pbVar18[1] = 0xff;
                bVar7 = *(byte *)puVar33;
                pbVar18[3] = *(byte *)(puVar33 + 1);
                pbVar18[2] = bVar7;
                local_e80 = pbVar18 + 4;
                *local_e78 = 2;
                *local_e70 = 2;
                goto LAB_1800572c3;
              }
              if (local_eb8 < local_e78) {
                if ((local_ed0 == 0) ||
                   ((0x14 < *(byte *)((longlong)puVar33 + 1) &&
                    (*(byte *)((longlong)puVar33 + 1) != 0x29)))) {
                  bVar7 = *(byte *)(puVar33 + 1);
                }
                local_e78[-1] = local_e78[-1] + bVar7;
                puVar10 = local_f18;
                lVar16 = local_ef0;
                pbVar18 = local_e80;
                puVar31 = local_e90;
                lVar32 = DAT_1800b2b88;
              }
              else {
                if ((local_ed0 == 0) ||
                   ((0x14 < *(byte *)((longlong)puVar33 + 1) &&
                    (*(byte *)((longlong)puVar33 + 1) != 0x29)))) {
                  bVar7 = *(byte *)(puVar33 + 1);
                }
                *local_e78 = bVar7;
                local_e78 = local_e78 + 1;
                puVar10 = local_f18;
                lVar16 = local_ef0;
                pbVar18 = local_e80;
                puVar31 = local_e90;
                lVar32 = DAT_1800b2b88;
              }
            }
          }
          else {
            if (*(longlong *)(local_ef8 + 0x150) != 0) {
              local_e44 = 0;
              bVar7 = 0;
              if (*(byte *)((longlong)puVar33 + 1) != 3) {
                bVar7 = *(byte *)((longlong)puVar33 + 3);
              }
              local_f24 = 0;
              bVar7 = bVar7 & 0xc0;
              if (bVar7 == 0x40) {
LAB_180056b2d:
                lVar3 = *(longlong *)(local_ef8 + 0x150);
                uVar30 = *(uint *)(local_ef8 + 0x140) & 0x20;
                lVar27 = *(longlong *)(local_ef8 + 0x160);
                if ((*(short *)(lVar3 + 10) != 0) &&
                   ((ushort *)((ulonglong)(-(uint)(uVar30 != 0) & 2) + 4 + (longlong)puVar15) <=
                    puVar31)) {
                  if (local_f24 == 0) {
                    uVar9 = FUN_1800026d4(puVar15,puVar31,3,*(ushort *)(lVar3 + 4),
                                          *(ushort *)(lVar3 + 6),uVar30,0);
                    local_f24 = (int)uVar9;
                  }
                  uVar9 = 0;
                  if (2 < local_f24) {
                    local_f20 = 0;
                    iVar29 = *(ushort *)(lVar3 + 10) - 1;
                    uVar26 = uVar9;
                    if ((uVar30 != 0) && (uVar26 = 0, puVar15 + 3 < puVar31)) {
                      if (lVar16 == 0) {
                        uVar14 = *(uint *)(lVar32 + (ulonglong)*puVar15 * 4);
                        uVar12 = *(uint *)(lVar32 + (ulonglong)puVar15[1] * 4);
                      }
                      else {
                        uVar14 = *(uint *)(lVar32 + (ulonglong)
                                                    (*(int *)(lVar16 + (ulonglong)(*puVar15 >> 8) *
                                                                       4) + (uint)*(byte *)puVar15)
                                                    * 4);
                        uVar12 = *(uint *)(lVar32 + (ulonglong)
                                                    (*(int *)(lVar16 + (ulonglong)(puVar15[1] >> 8)
                                                                       * 4) +
                                                    (uint)*(byte *)(puVar15 + 1)) * 4);
                      }
                      uVar26 = 0;
                      if (((uVar12 ^ uVar14) & 0xe7ffffff) == 0) {
                        uVar26 = 1;
                      }
                    }
                    if (-1 < iVar29) {
                      local_e38 = puVar15 + uVar26;
                      do {
                        iVar21 = (iVar29 + (int)uVar9) / 2;
                        iVar8 = FUN_1800026a4((longlong)local_e38,
                                              (ushort *)(lVar27 + (longlong)(iVar21 * 6) * 2),3);
                        iVar28 = (int)uVar26;
                        if (iVar8 == 0) {
                          puVar33 = (undefined2 *)(lVar27 + -4 + (longlong)(iVar21 * 6 + 6) * 2);
                          uVar9 = (ulonglong)(iVar28 + 2);
                          goto LAB_1800564c4;
                        }
                        iVar28 = iVar21 + -1;
                        if (-1 < iVar8) {
                          iVar28 = iVar29;
                        }
                        if (-1 < iVar8) {
                          local_f20 = iVar21 + 1;
                        }
                        uVar9 = (ulonglong)local_f20;
                        iVar29 = iVar28;
                      } while ((int)local_f20 <= iVar28);
                    }
                  }
                }
                lVar27 = *(longlong *)(local_ef8 + 0x158);
                if ((*(short *)(lVar3 + 8) != 0) &&
                   ((ushort *)((-(ulonglong)(uVar30 != 0) & 2) + 2 + (longlong)puVar15) <= puVar31))
                {
                  if (local_f24 == 0) {
                    uVar9 = FUN_1800026d4(puVar15,puVar31,2,*(ushort *)(lVar3 + 4),
                                          *(ushort *)(lVar3 + 6),uVar30,0);
                    local_f24 = (int)uVar9;
                  }
                  uVar9 = 0;
                  if (1 < local_f24) {
                    iVar29 = *(ushort *)(lVar3 + 8) - 1;
                    local_f20 = 0;
                    uVar26 = uVar9;
                    if ((uVar30 != 0) && (uVar26 = 0, puVar15 + 2 < puVar31)) {
                      if (lVar16 == 0) {
                        uVar30 = *(uint *)(lVar32 + (ulonglong)*puVar15 * 4);
                        uVar14 = *(uint *)(lVar32 + (ulonglong)puVar15[1] * 4);
                      }
                      else {
                        uVar30 = *(uint *)(lVar32 + (ulonglong)
                                                    (*(int *)(lVar16 + (ulonglong)(*puVar15 >> 8) *
                                                                       4) + (uint)*(byte *)puVar15)
                                                    * 4);
                        uVar14 = *(uint *)(lVar32 + (ulonglong)
                                                    (*(int *)(lVar16 + (ulonglong)(puVar15[1] >> 8)
                                                                       * 4) +
                                                    (uint)*(byte *)(puVar15 + 1)) * 4);
                      }
                      uVar26 = 0;
                      if (((uVar14 ^ uVar30) & 0xe7ffffff) == 0) {
                        uVar26 = 1;
                      }
                    }
                    if (-1 < iVar29) {
                      puVar10 = puVar15 + uVar26;
LAB_180056e0d:
                      iVar21 = (iVar29 + (int)uVar9) / 2;
                      iVar8 = FUN_1800026a4((longlong)puVar10,
                                            (ushort *)(lVar27 + (longlong)(iVar21 * 4) * 2),2);
                      iVar28 = (int)uVar26;
                      if (iVar8 != 0) goto code_r0x000180056e37;
                      puVar33 = (undefined2 *)(lVar27 + -4 + (longlong)(iVar21 * 4 + 4) * 2);
                      uVar9 = (ulonglong)(iVar28 + 1);
LAB_1800564c4:
                      puVar15 = puVar15 + uVar9;
                      local_e58 = puVar15;
                      local_e50 = puVar33;
                      local_e44 = iVar28;
                    }
                  }
                }
              }
              else {
                if (bVar7 == 0x80) {
LAB_1800567f6:
                  lVar3 = *(longlong *)(local_ef8 + 0x170);
                  lVar27 = *(longlong *)(local_ef8 + 0x150);
                  uVar30 = *(uint *)(local_ef8 + 0x140) & 0x20;
                  if ((*(short *)(lVar27 + 0xe) != 0) &&
                     ((ushort *)((ulonglong)(-(uint)(uVar30 != 0) & 2) + 8 + (longlong)puVar15) <=
                      puVar31)) {
                    if (local_f24 == 0) {
                      uVar9 = FUN_1800026d4(puVar15,puVar31,5,*(ushort *)(lVar27 + 4),
                                            *(ushort *)(lVar27 + 6),uVar30,0);
                      local_f24 = (int)uVar9;
                    }
                    uVar9 = 0;
                    if (4 < local_f24) {
                      local_f28 = 0;
                      iVar29 = *(ushort *)(lVar27 + 0xe) - 1;
                      uVar26 = uVar9;
                      if ((uVar30 != 0) && (uVar26 = 0, puVar15 + 5 < puVar31)) {
                        if (lVar16 == 0) {
                          uVar14 = *(uint *)(lVar32 + (ulonglong)*puVar15 * 4);
                          uVar12 = *(uint *)(lVar32 + (ulonglong)puVar15[1] * 4);
                        }
                        else {
                          uVar14 = *(uint *)(lVar32 + (ulonglong)
                                                      (*(int *)(lVar16 + (ulonglong)(*puVar15 >> 8)
                                                                         * 4) +
                                                      (uint)*(byte *)puVar15) * 4);
                          uVar12 = *(uint *)(lVar32 + (ulonglong)
                                                      (*(int *)(lVar16 + (ulonglong)
                                                                         (puVar15[1] >> 8) * 4) +
                                                      (uint)*(byte *)(puVar15 + 1)) * 4);
                        }
                        uVar26 = 0;
                        if (((uVar12 ^ uVar14) & 0xe7ffffff) == 0) {
                          uVar26 = 1;
                        }
                      }
                      if (-1 < iVar29) {
                        local_e38 = puVar15 + uVar26;
                        do {
                          iVar21 = (iVar29 + (int)uVar9) / 2;
                          iVar8 = FUN_1800026a4((longlong)local_e38,
                                                (ushort *)(lVar3 + (longlong)(iVar21 << 3) * 2),5);
                          iVar28 = (int)uVar26;
                          if (iVar8 == 0) {
                            puVar33 = (undefined2 *)(lVar3 + -4 + (longlong)(iVar21 * 8 + 8) * 2);
                            uVar9 = (ulonglong)(iVar28 + 4);
                            goto LAB_1800564c4;
                          }
                          iVar28 = iVar21 + -1;
                          if (-1 < iVar8) {
                            iVar28 = iVar29;
                          }
                          if (-1 < iVar8) {
                            local_f28 = iVar21 + 1;
                          }
                          uVar9 = (ulonglong)local_f28;
                          iVar29 = iVar28;
                        } while ((int)local_f28 <= iVar28);
                      }
                    }
                  }
                  lVar3 = *(longlong *)(local_ef8 + 0x168);
                  if ((*(short *)(lVar27 + 0xc) != 0) &&
                     ((ushort *)((ulonglong)(-(uint)(uVar30 != 0) & 2) + 6 + (longlong)puVar15) <=
                      puVar31)) {
                    if (local_f24 == 0) {
                      uVar9 = FUN_1800026d4(puVar15,puVar31,4,*(ushort *)(lVar27 + 4),
                                            *(ushort *)(lVar27 + 6),uVar30,0);
                      local_f24 = (int)uVar9;
                    }
                    if (3 < local_f24) {
                      iVar29 = *(ushort *)(lVar27 + 0xc) - 1;
                      local_f28 = 0;
                      lVar27 = 0;
                      if ((uVar30 != 0) && (lVar27 = 0, puVar15 + 4 < puVar31)) {
                        if (lVar16 == 0) {
                          uVar30 = *(uint *)(lVar32 + (ulonglong)*puVar15 * 4);
                          uVar14 = *(uint *)(lVar32 + (ulonglong)puVar15[1] * 4);
                        }
                        else {
                          uVar30 = *(uint *)(lVar32 + (ulonglong)
                                                      (*(int *)(lVar16 + (ulonglong)(*puVar15 >> 8)
                                                                         * 4) +
                                                      (uint)*(byte *)puVar15) * 4);
                          uVar14 = *(uint *)(lVar32 + (ulonglong)
                                                      (*(int *)(lVar16 + (ulonglong)
                                                                         (puVar15[1] >> 8) * 4) +
                                                      (uint)*(byte *)(puVar15 + 1)) * 4);
                        }
                        lVar27 = 0;
                        if (((uVar14 ^ uVar30) & 0xe7ffffff) == 0) {
                          lVar27 = 1;
                        }
                      }
                      if (-1 < iVar29) {
                        local_e38 = puVar15 + lVar27;
                        do {
                          iVar21 = (int)(iVar29 + local_f28) / 2;
                          iVar8 = FUN_1800026a4((longlong)local_e38,
                                                (ushort *)(lVar3 + (longlong)(iVar21 * 6) * 2),4);
                          iVar28 = (int)lVar27;
                          if (iVar8 == 0) {
                            puVar33 = (undefined2 *)(lVar3 + -4 + (longlong)(iVar21 * 6 + 6) * 2);
                            uVar9 = (ulonglong)(iVar28 + 3);
                            goto LAB_1800564c4;
                          }
                          iVar28 = iVar21 + -1;
                          if (-1 < iVar8) {
                            iVar28 = iVar29;
                          }
                          if (-1 < iVar8) {
                            local_f28 = iVar21 + 1;
                          }
                          iVar29 = iVar28;
                        } while ((int)local_f28 <= iVar28);
                      }
                    }
                  }
                  goto LAB_180056b2d;
                }
                if (bVar7 == 0xc0) {
                  lVar3 = *(longlong *)(local_ef8 + 0x188);
                  lVar27 = *(longlong *)(local_ef8 + 0x150);
                  uVar30 = *(uint *)(local_ef8 + 0x140) & 0x20;
                  if ((*(short *)(lVar27 + 0x14) != 0) &&
                     ((ushort *)((ulonglong)(-(uint)(uVar30 != 0) & 2) + 0xe + (longlong)local_e58)
                      <= puVar31)) {
                    uVar9 = FUN_1800026d4(local_e58,puVar31,8,*(ushort *)(lVar27 + 4),
                                          *(ushort *)(lVar27 + 6),uVar30,0);
                    local_f24 = (int)uVar9;
                    if (7 < local_f24) {
                      iVar28 = *(ushort *)(lVar27 + 0x14) - 1;
                      local_f28 = 0;
                      lVar25 = 0;
                      if ((uVar30 != 0) && (puVar15 + 8 < puVar31)) {
                        if (lVar16 == 0) {
                          uVar14 = *(uint *)(lVar32 + (ulonglong)*puVar15 * 4);
                          uVar12 = *(uint *)(lVar32 + (ulonglong)puVar15[1] * 4);
                        }
                        else {
                          uVar14 = *(uint *)(lVar32 + (ulonglong)
                                                      (*(int *)(lVar16 + (ulonglong)(*puVar15 >> 8)
                                                                         * 4) +
                                                      (uint)*(byte *)puVar15) * 4);
                          uVar12 = *(uint *)(lVar32 + (ulonglong)
                                                      (*(int *)(lVar16 + (ulonglong)
                                                                         (puVar15[1] >> 8) * 4) +
                                                      (uint)*(byte *)(puVar15 + 1)) * 4);
                        }
                        lVar25 = 0;
                        if (((uVar12 ^ uVar14) & 0xe7ffffff) == 0) {
                          lVar25 = 1;
                        }
                      }
                      if (-1 < iVar28) {
                        local_e38 = puVar15 + lVar25;
                        do {
                          iVar29 = (int)(iVar28 + local_f28) / 2;
                          iVar21 = iVar28;
                          iVar8 = FUN_1800026a4((longlong)local_e38,
                                                (ushort *)(lVar3 + (longlong)(iVar29 * 10) * 2),8);
                          iVar28 = (int)lVar25;
                          if (iVar8 == 0) {
                            puVar33 = (undefined2 *)(lVar3 + -4 + (longlong)(iVar29 * 10 + 10) * 2);
                            uVar9 = (ulonglong)(iVar28 + 7);
                            goto LAB_1800564c4;
                          }
                          iVar28 = iVar29 + -1;
                          if (-1 < iVar8) {
                            iVar28 = iVar21;
                          }
                          if (-1 < iVar8) {
                            local_f28 = iVar29 + 1;
                          }
                        } while ((int)local_f28 <= iVar28);
                      }
                    }
                  }
                  lVar3 = *(longlong *)(local_ef8 + 0x180);
                  if ((*(short *)(lVar27 + 0x12) != 0) &&
                     ((ushort *)((ulonglong)(-(uint)(uVar30 != 0) & 2) + 0xc + (longlong)puVar15) <=
                      puVar31)) {
                    if (local_f24 == 0) {
                      uVar9 = FUN_1800026d4(puVar15,puVar31,7,*(ushort *)(lVar27 + 4),
                                            *(ushort *)(lVar27 + 6),uVar30,0);
                      local_f24 = (int)uVar9;
                    }
                    uVar9 = 0;
                    if (6 < local_f24) {
                      local_f28 = 0;
                      iVar29 = *(ushort *)(lVar27 + 0x12) - 1;
                      uVar26 = uVar9;
                      if ((uVar30 != 0) && (uVar26 = 0, puVar15 + 7 < puVar31)) {
                        if (lVar16 == 0) {
                          uVar14 = *(uint *)(lVar32 + (ulonglong)*puVar15 * 4);
                          uVar12 = *(uint *)(lVar32 + (ulonglong)puVar15[1] * 4);
                        }
                        else {
                          uVar14 = *(uint *)(lVar32 + (ulonglong)
                                                      (*(int *)(lVar16 + (ulonglong)(*puVar15 >> 8)
                                                                         * 4) +
                                                      (uint)*(byte *)puVar15) * 4);
                          uVar12 = *(uint *)(lVar32 + (ulonglong)
                                                      (*(int *)(lVar16 + (ulonglong)
                                                                         (puVar15[1] >> 8) * 4) +
                                                      (uint)*(byte *)(puVar15 + 1)) * 4);
                        }
                        uVar26 = 0;
                        if (((uVar12 ^ uVar14) & 0xe7ffffff) == 0) {
                          uVar26 = 1;
                        }
                      }
                      if (-1 < iVar29) {
                        local_e38 = puVar15 + uVar26;
                        do {
                          iVar21 = (iVar29 + (int)uVar9) / 2;
                          iVar8 = FUN_1800026a4((longlong)local_e38,
                                                (ushort *)(lVar3 + (longlong)(iVar21 * 10) * 2),7);
                          iVar28 = (int)uVar26;
                          if (iVar8 == 0) {
                            puVar33 = (undefined2 *)(lVar3 + -4 + (longlong)(iVar21 * 10 + 10) * 2);
                            uVar9 = (ulonglong)(iVar28 + 6);
                            goto LAB_1800564c4;
                          }
                          iVar28 = iVar21 + -1;
                          if (-1 < iVar8) {
                            iVar28 = iVar29;
                          }
                          if (-1 < iVar8) {
                            local_f28 = iVar21 + 1;
                          }
                          uVar9 = (ulonglong)local_f28;
                          iVar29 = iVar28;
                        } while ((int)local_f28 <= iVar28);
                      }
                    }
                  }
                  lVar3 = *(longlong *)(local_ef8 + 0x178);
                  if ((*(short *)(lVar27 + 0x10) != 0) &&
                     ((ushort *)((ulonglong)(-(uint)(uVar30 != 0) & 2) + 10 + (longlong)puVar15) <=
                      puVar31)) {
                    if (local_f24 == 0) {
                      uVar9 = FUN_1800026d4(puVar15,puVar31,6,*(ushort *)(lVar27 + 4),
                                            *(ushort *)(lVar27 + 6),uVar30,0);
                      local_f24 = (int)uVar9;
                    }
                    uVar9 = 0;
                    if (5 < local_f24) {
                      local_f28 = 0;
                      iVar29 = *(ushort *)(lVar27 + 0x10) - 1;
                      uVar26 = uVar9;
                      if ((uVar30 != 0) && (uVar26 = 0, puVar15 + 6 < puVar31)) {
                        if (lVar16 == 0) {
                          uVar30 = *(uint *)(lVar32 + (ulonglong)*puVar15 * 4);
                          uVar14 = *(uint *)(lVar32 + (ulonglong)puVar15[1] * 4);
                        }
                        else {
                          uVar30 = *(uint *)(lVar32 + (ulonglong)
                                                      (*(int *)(lVar16 + (ulonglong)(*puVar15 >> 8)
                                                                         * 4) +
                                                      (uint)*(byte *)puVar15) * 4);
                          uVar14 = *(uint *)(lVar32 + (ulonglong)
                                                      (*(int *)(lVar16 + (ulonglong)
                                                                         (puVar15[1] >> 8) * 4) +
                                                      (uint)*(byte *)(puVar15 + 1)) * 4);
                        }
                        uVar26 = 0;
                        if (((uVar14 ^ uVar30) & 0xe7ffffff) == 0) {
                          uVar26 = 1;
                        }
                      }
                      if (-1 < iVar29) {
                        local_e38 = puVar15 + uVar26;
                        do {
                          iVar21 = (iVar29 + (int)uVar9) / 2;
                          iVar8 = FUN_1800026a4((longlong)local_e38,
                                                (ushort *)(lVar3 + (longlong)(iVar21 * 8) * 2),6);
                          iVar28 = (int)uVar26;
                          if (iVar8 == 0) {
                            puVar33 = (undefined2 *)(lVar3 + -4 + (longlong)(iVar21 * 8 + 8) * 2);
                            uVar9 = (ulonglong)(iVar28 + 5);
                            goto LAB_1800564c4;
                          }
                          iVar28 = iVar21 + -1;
                          if (-1 < iVar8) {
                            iVar28 = iVar29;
                          }
                          if (-1 < iVar8) {
                            local_f28 = iVar21 + 1;
                          }
                          uVar9 = (ulonglong)local_f28;
                          iVar29 = iVar28;
                        } while ((int)local_f28 <= iVar28);
                      }
                    }
                  }
                  goto LAB_1800567f6;
                }
              }
LAB_1800564dd:
              local_e48 = *(byte *)((longlong)puVar33 + 1);
            }
            iVar28 = 0;
            bVar7 = 2;
            lVar16 = local_ef0;
            if ((local_e48 == 0xd) && (local_ecc != 0)) {
              puVar23 = &DAT_180085130;
              uVar17 = *puVar15;
              uVar22 = 0;
              iVar21 = 0x37;
              iVar29 = iVar28;
              if (((ushort)(uVar17 + 0x2400) < 0x400) && (local_e98 < puVar15)) {
                if (puVar15[-1] != 0xd835) goto LAB_18005702f;
                puVar23 = &DAT_180086580;
                iVar21 = 9;
                iVar29 = 0;
              }
              do {
                iVar8 = iVar21 + iVar29 >> 1;
                bVar6 = *(ushort *)(puVar23 + (longlong)iVar8 * 2) <= uVar17;
                if (uVar17 == *(ushort *)(puVar23 + (longlong)iVar8 * 2)) break;
                iVar5 = iVar8 + -1;
                if (bVar6) {
                  iVar5 = iVar21;
                }
                iVar21 = iVar5;
                if (bVar6) {
                  iVar29 = iVar8 + 1;
                }
              } while (iVar29 <= iVar21);
              uVar20 = *(ushort *)(puVar23 + ((longlong)iVar8 & 0xfffffffffffffffeU) * 2);
              if ((uVar17 < uVar20) ||
                 (*(ushort *)(puVar23 + ((longlong)iVar8 & 0xfffffffffffffffeU) * 2 + 2) < uVar17))
              {
                uVar20 = 0;
              }
              uVar30 = 0;
              if (uVar20 != 0) {
                if ((0xdbff < uVar20) && (uVar20 < 0xe000)) {
                  uVar22 = 0xd835;
                }
                while (puVar10 = puVar15, *puVar15 == uVar20) {
                  puVar10 = puVar15 + 1;
                  iVar28 = iVar28 + 1;
                  if (uVar22 != 0) {
                    if ((puVar31 <= puVar10) || (*puVar10 != uVar22)) {
                      puVar10 = puVar15 + 2;
                      local_e58 = puVar10;
                      break;
                    }
                    puVar10 = puVar15 + 2;
                  }
                  local_e58 = puVar10;
                  if ((puVar31 <= puVar10) || (puVar15 = puVar10, 0x12 < iVar28)) break;
                }
                uVar14 = uVar30;
                if ((puVar10 < puVar31) && (iVar29 = iVar28, uVar14 = 0, iVar28 < 0x13)) {
                  do {
                    uVar14 = uVar30;
                    if ((*puVar10 < uVar20) || ((int)(uint)uVar20 < (int)(*puVar10 - 9))) break;
                    uVar30 = uVar30 + 1;
                    iVar29 = iVar29 + 1;
                    puVar15 = puVar10 + 1;
                    uVar14 = uVar30;
                    if (uVar22 != 0) {
                      if ((puVar31 <= puVar15) || (*puVar15 != uVar22)) break;
                      puVar15 = puVar10 + 2;
                    }
                    if ((puVar31 <= puVar15) || (puVar10 = puVar15, 0x12 < iVar29)) break;
                  } while( true );
                }
                *pbVar18 = 0xd;
                local_e80[1] = 2;
                local_e80[2] = (char)uVar14 + 2;
                local_e80 = local_e80 + 3;
                *local_e78 = *(byte *)(local_e50 + 1);
                local_e78 = local_e78 + 1;
                *local_e70 = *(byte *)((longlong)local_e50 + 3) & local_ee0 & 0x3f;
                local_e70 = local_e70 + 1;
                puVar15 = local_e58;
                if ((uVar14 & 1) != 0) {
                  *local_e80 = 0x20;
                }
                for (; 0 < (int)uVar14; uVar14 = uVar14 - 1) {
                  bVar7 = (*(byte *)puVar15 - (char)uVar20) + 2;
                  if ((uVar14 & 1) == 0) {
                    *local_e80 = bVar7 * '\x10';
                  }
                  else {
                    *local_e80 = *local_e80 | bVar7;
                    local_e80 = local_e80 + 1;
                  }
                  puVar10 = puVar15 + 1;
                  if (uVar22 != 0) {
                    puVar10 = puVar15 + 2;
                  }
                  puVar15 = puVar10;
                }
                *local_e80 = -(char)iVar28 - 2;
                pbVar18 = local_e80 + 1;
                puVar10 = local_f18;
                puVar31 = local_e90;
                lVar32 = DAT_1800b2b88;
                local_e80 = pbVar18;
                local_e58 = puVar15 + -1;
                if (uVar22 != 0) {
                  local_e58 = puVar15 + -2;
                }
                goto LAB_180057872;
              }
            }
LAB_18005702f:
            uVar1 = *puVar33;
            *pbVar18 = (byte)((ushort)uVar1 >> 8);
            pbVar18[1] = (byte)uVar1;
            local_e80 = pbVar18 + 2;
            if (((byte)(local_e48 + 0x57) < 7) ||
               ((local_ec8 != 0 && ((byte)(local_e48 + 0x40) < 0x30)))) {
              *local_e80 = *(byte *)(local_e50 + 1);
              local_e80 = pbVar18 + 3;
            }
            else {
              if ((local_ed0 == 0) ||
                 ((bVar11 = bVar7, 0x14 < *(byte *)((longlong)local_e50 + 1) &&
                  (*(byte *)((longlong)local_e50 + 1) != 0x29)))) {
                bVar11 = *(byte *)(local_e50 + 1);
              }
              *local_e78 = bVar11;
              local_e78 = local_e78 + 1;
            }
            if ((local_ed4 == 0) ||
               ((bVar11 = bVar7, 0x14 < *(byte *)((longlong)local_e50 + 1) &&
                (*(byte *)((longlong)local_e50 + 1) != 0x29)))) {
              bVar11 = *(byte *)((longlong)local_e50 + 3) & 0x3f;
            }
            *local_e70 = bVar11 & local_ee0;
            local_e70 = local_e70 + 1;
            puVar10 = local_f18;
            pbVar18 = local_e80;
            puVar31 = local_e90;
            lVar32 = DAT_1800b2b88;
            if (local_e44 != 0) {
              uVar1 = *local_e50;
              local_e80[1] = (byte)uVar1;
              *local_e80 = (byte)((ushort)uVar1 >> 8);
              local_e80 = local_e80 + 2;
              if ((local_ed0 == 0) ||
                 ((0x14 < *(byte *)((longlong)local_e50 + 1) &&
                  (*(byte *)((longlong)local_e50 + 1) != 0x29)))) {
                bVar7 = *(byte *)(local_e50 + 1);
              }
              *local_e78 = bVar7;
              if ((local_ed4 == 0) ||
                 ((0x14 < *(byte *)((longlong)local_e50 + 1) &&
                  (*(byte *)((longlong)local_e50 + 1) != 0x29)))) {
                bVar7 = *(byte *)((longlong)local_e50 + 3);
LAB_1800577cc:
                bVar7 = bVar7 & 0x3f;
              }
              else {
LAB_1800577c3:
                bVar7 = 2;
              }
              bVar7 = bVar7 & local_ee0;
LAB_1800577d2:
              *local_e70 = bVar7;
LAB_1800572c3:
              local_e78 = local_e78 + 1;
              local_e70 = local_e70 + 1;
              puVar10 = local_f18;
              lVar16 = local_ef0;
              pbVar18 = local_e80;
              puVar31 = local_e90;
              lVar32 = DAT_1800b2b88;
            }
          }
LAB_180057872:
          if (0x7a < (longlong)((longlong)local_e58 - (longlong)puVar10 & 0xfffffffffffffffeU)) {
            FUN_180055d9c((longlong)&local_ef8,(longlong)&local_e18,local_e28);
            local_f18 = local_e58;
            puVar10 = local_e58;
            lVar16 = local_ef0;
            pbVar18 = local_e80;
            puVar31 = local_e90;
            lVar32 = DAT_1800b2b88;
          }
          local_e08 = local_e78;
          local_e58 = local_e58 + 1;
          local_e00 = local_e70;
          local_df8 = local_e68;
          local_df0 = local_e60;
          param_5 = local_e20;
          param_2 = local_e28;
          local_e10 = pbVar18;
        } while (local_e58 < puVar31);
      }
      if (pbVar18 != local_ec0) {
        FUN_180055d9c((longlong)&local_ef8,(longlong)&local_e18,param_2);
      }
      uVar30 = (((uint)(local_de8 * -0x61c88647) >> 0x10 ^ local_de8 * -0x61c88647) + local_de4) *
               -0x61c88647;
      uVar30 = ((uVar30 >> 0x10 ^ uVar30) + local_de0) * -0x61c88647;
      uVar30 = ((uVar30 >> 0x10 ^ uVar30) + local_ddc) * -0x61c88647;
      uVar30 = ((uVar30 >> 0x10 ^ uVar30) + local_dd8) * -0x61c88647;
      *param_5 = uVar30 ^ uVar30 >> 0x10;
      goto LAB_180057985;
    }
    dwErrCode = 2;
  }
  SetLastError(dwErrCode);
LAB_180057985:
  __security_check_cookie(local_48 ^ (ulonglong)auStackY3944);
  return;
code_r0x000180056e37:
  iVar28 = iVar21 + -1;
  if (-1 < iVar8) {
    iVar28 = iVar29;
  }
  if (-1 < iVar8) {
    local_f20 = iVar21 + 1;
  }
  uVar9 = (ulonglong)local_f20;
  iVar29 = iVar28;
  if (iVar28 < (int)local_f20) goto LAB_1800564dd;
  goto LAB_180056e0d;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_180057b70(undefined8 param_1,int param_2,int param_3,ushort *param_4,uint param_5)

{
  ushort *puVar1;
  ushort uVar2;
  uint uVar3;
  uint uVar4;
  undefined8 uVar5;
  ulonglong uVar6;
  DWORD dwErrCode;
  bool bVar7;
  bool bVar8;
  
  if ((param_5 == 0) || (param_4 == (ushort *)0x0)) {
    dwErrCode = 0x57;
  }
  else {
    if (param_3 == 0) {
      if (0x7fffffff < param_5) {
        uVar6 = FUN_180002600((short *)param_4);
        param_5 = (uint)uVar6;
      }
      if (param_2 == 1) {
        if ((_DAT_1800b2be0 == 0) || (DAT_1800b2b88 == 0)) {
          SetLastError(2);
LAB_180057b57:
          uVar5 = 0;
        }
        else {
          puVar1 = param_4 + (int)param_5;
          for (; param_4 < puVar1; param_4 = param_4 + 1) {
            uVar2 = *param_4;
            if (*(char *)(DAT_1800b2b88 + 1 + (ulonglong)uVar2 * 4) == '\0') {
              uVar3 = (uint)uVar2;
              if (uVar2 < 0x2010) {
                if ((((uVar2 < 0x200c) && (uVar2 != 0)) && (uVar2 != 0xad)) &&
                   (((uVar2 != 0x34f && (uVar2 != 0x640)) && ((uVar3 != 0xecc && (uVar3 != 0x1806)))
                    ))) {
                  bVar7 = uVar3 - 0x180b < 2;
                  bVar8 = uVar3 - 0x180b == 2;
                  goto LAB_180057b30;
                }
              }
              else {
                uVar4 = (uint)uVar2;
                if (uVar4 < 0x3192) {
                  if (uVar3 < 0x3190) {
                    if (uVar4 < 0x202a) goto LAB_180057b57;
                    if (0x202e < uVar4) {
                      if (uVar4 < 0x2060) goto LAB_180057b57;
                      if (0x2064 < uVar4) {
                        bVar7 = uVar4 - 0x206a < 5;
                        bVar8 = uVar4 - 0x206a == 5;
                        goto LAB_180057b30;
                      }
                    }
                  }
                }
                else {
                  if (uVar4 == 0xdb40) {
                    param_4 = param_4 + 1;
                    if (puVar1 <= param_4) goto LAB_180057b57;
                    bVar7 = (ushort)(*param_4 + 0x2300) < 0xef;
                    bVar8 = (ushort)(*param_4 + 0x2300) == 0xef;
                  }
                  else {
                    if (uVar4 < 0xfe00) goto LAB_180057b57;
                    if (uVar4 < 0xfe10) goto LAB_180057b32;
                    if (uVar4 < 0xfff9) goto LAB_180057b57;
                    bVar7 = uVar2 < 0xfffd;
                    bVar8 = uVar2 == 0xfffd;
                  }
LAB_180057b30:
                  if (!bVar7 && !bVar8) goto LAB_180057b57;
                }
              }
            }
            else {
              if ((ushort)(uVar2 + 0x2480) < 0x1d80) goto LAB_180057b57;
              if ((ushort)(uVar2 + 0x2800) < 0x400) {
                param_4 = param_4 + 1;
                if (param_4 < puVar1) {
                  bVar7 = (ushort)(*param_4 + 0x2400) < 0x3ff;
                  bVar8 = (ushort)(*param_4 + 0x2400) == 0x3ff;
                  goto LAB_180057b30;
                }
                goto LAB_180057b57;
              }
            }
LAB_180057b32:
          }
          uVar5 = 1;
        }
        return uVar5;
      }
    }
    dwErrCode = 0x3ec;
  }
  SetLastError(dwErrCode);
  return 0;
}



uint FUN_180057bd0(int param_1)

{
  uint uVar1;
  
  uVar1 = param_1 - 0x1100;
  if (0xff < uVar1) {
    if (param_1 - 0xa960U < 0x1d) {
      return param_1 - 0xa860;
    }
    uVar1 = param_1 - 0xd693;
    if (0x16 < param_1 - 0xd7b0U) {
      uVar1 = param_1 - 0xd697;
    }
  }
  return uVar1;
}



// WARNING: Could not reconcile some variable overlaps

ulonglong FUN_180057c10(longlong param_1,ushort *param_2,ushort *param_3,undefined2 *param_4,
                       byte *param_5)

{
  longlong lVar1;
  uint uVar2;
  ulonglong uVar3;
  short sVar4;
  ushort uVar5;
  ushort *puVar6;
  int iVar7;
  byte bVar8;
  longlong lVar9;
  ushort *puVar10;
  undefined local_38 [8];
  undefined8 uStack48;
  
  lVar9 = 2;
  puVar6 = param_2;
  if (param_2 < param_3) {
    do {
      if ((5 < (longlong)((longlong)puVar6 - (longlong)param_2 & 0xfffffffffffffffeU)) ||
         (*puVar6 == 0)) break;
      puVar6 = puVar6 + 1;
    } while (puVar6 < param_3);
  }
  if (((longlong)((longlong)puVar6 - (longlong)param_2 & 0xfffffffffffffffeU) < 2) ||
     ((((uVar5 = *param_2, 0x1c < (ushort)(uVar5 + 0x56a0) && (0xff < (ushort)(uVar5 + 0xef00))) &&
       (0x16 < (ushort)(uVar5 + 0x2850))) && (0x30 < (ushort)(uVar5 + 0x2835))))) {
    uVar3 = 0;
  }
  else {
    if (((ushort)(uVar5 + 0xef00) < 0x60) || ((ushort)(uVar5 + 0x56a0) < 0x1d)) {
      puVar10 = param_2 + 1;
    }
    else {
      uVar5 = 0x115f;
      puVar10 = param_2;
    }
    _local_38 = ZEXT116(uVar5 == 0x115f) << 0x20;
    uVar2 = FUN_180057bd0((uint)uVar5);
    lVar1 = DAT_1800b2bc8;
    FUN_180057efc(1,(byte *)(DAT_1800b2bc8 + (longlong)(int)uVar2 * 8),local_38);
    iVar7 = 0x1160;
    if (puVar10 < puVar6) {
      uVar5 = *puVar10;
      if (((ushort)(uVar5 + 0xeea0) < 0x48) || ((ushort)(uVar5 + 0x2850) < 0x17)) {
        puVar10 = (ushort *)((longlong)puVar10 + lVar9);
      }
      else {
        uVar5 = 0x1160;
      }
    }
    else {
      uVar5 = 0x1160;
    }
    if (uVar5 == 0x1160) {
      local_38._4_4_ = 1;
    }
    uVar2 = FUN_180057bd0((uint)uVar5);
    FUN_180057efc((int)lVar9,(byte *)(lVar1 + (longlong)(int)uVar2 * 8),local_38);
    if ((puVar10 < puVar6) &&
       (((ushort)(*puVar10 + 0xee58) < 0x58 || ((ushort)(*puVar10 + 0x2835) < 0x31)))) {
      uVar2 = FUN_180057bd0((uint)*puVar10);
      FUN_180057efc(3,(byte *)(lVar1 + (longlong)(int)uVar2 * 8),local_38);
      puVar10 = (ushort *)((longlong)puVar10 + lVar9);
    }
    if (local_38[0] == 0) {
      _local_38 = ZEXT816(0);
      uVar2 = FUN_180057bd0((uint)*param_2);
      FUN_180057efc(1,(byte *)(lVar1 + (longlong)(int)uVar2 * 8),local_38);
      puVar10 = param_2 + 1;
      uVar2 = FUN_180057bd0(iVar7);
      FUN_180057efc((int)lVar9,(byte *)(lVar1 + (longlong)(int)uVar2 * 8),local_38);
      local_38._4_4_ = 1;
    }
    else {
    }
    bVar8 = (byte)lVar9;
    sVar4 = ((char)uStack48 * 0x15 + (short)uStack48._1_1_) * 0x1c + (short)uStack48._2_1_;
    uVar5 = sVar4 + 0xac00;
    if (local_38._4_4_ != 0) {
      uVar5 = sVar4 + 0xabff;
      if (uVar5 < 0xac00) {
        uVar5 = 0x3260;
      }
      uStack48._3_1_ = uStack48._3_1_ + 0x80;
    }
    uVar3 = (ulonglong)uVar5;
    if (param_1 != 0) {
      uVar3 = (ulonglong)((uint)(byte)uVar5 + *(int *)(param_1 + (ulonglong)(uVar5 >> 8) * 4));
    }
    *param_4 = *(undefined2 *)(DAT_1800b2b88 + uVar3 * 4);
    if (uStack48._3_1_ <= bVar8) {
      uStack48._3_1_ = bVar8;
    }
    *param_5 = uStack48._3_1_;
    if (uStack48._4_1_ <= bVar8) {
      uStack48._4_1_ = bVar8;
    }
    param_5[1] = uStack48._4_1_;
    if (bVar8 < uStack48._5_1_) {
      bVar8 = uStack48._5_1_;
    }
    param_5[2] = bVar8;
    uVar3 = (longlong)puVar10 - (longlong)param_2 >> 1 & 0xffffffff;
  }
  return uVar3;
}



void FUN_180057efc(int param_1,byte *param_2,byte *param_3)

{
  byte bVar1;
  
  *param_3 = *param_3 | *param_2;
  if ((char)param_3[8] < (char)param_2[1]) {
    param_3[8] = param_2[1];
  }
  if ((char)param_3[9] < (char)param_2[2]) {
    param_3[9] = param_2[2];
  }
  if ((char)param_3[10] < (char)param_2[3]) {
    param_3[10] = param_2[3];
  }
  if (param_1 == 1) {
    bVar1 = param_2[4];
    if (param_3[0xb] <= bVar1 && bVar1 != param_3[0xb]) {
      param_3[0xb] = bVar1;
    }
  }
  else if (param_1 == 2) {
    bVar1 = param_2[4];
    if (param_3[0xc] <= bVar1 && bVar1 != param_3[0xc]) {
      param_3[0xc] = bVar1;
      return;
    }
  }
  else if ((param_1 == 3) && (bVar1 = param_2[4], param_3[0xd] <= bVar1 && bVar1 != param_3[0xd])) {
    param_3[0xd] = bVar1;
    return;
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_180057f70(longlong param_1)

{
  if (*(code **)(param_1 + 0x10) != (code *)0x0) {
    (**(code **)(param_1 + 0x10))();
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_180057fa0(undefined8 param_1,longlong param_2)

{
  code *pcVar1;
  longlong in_GS_OFFSET;
  
  pcVar1 = *(code **)(param_2 + 8);
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_2);
  if (pcVar1 != (code *)0x0) {
    (*pcVar1)();
  }
  return;
}



void FUN_180058004(undefined8 param_1,undefined8 param_2,uint param_3,short *param_4,uint param_5)

{
  int iVar1;
  uint uVar2;
  undefined auStack1112 [32];
  ushort local_438;
  ushort local_436;
  undefined *local_430;
  undefined local_428 [1024];
  ulonglong local_28;
  
  local_28 = DAT_1800b2220 ^ (ulonglong)auStack1112;
  if (param_5 < 0x200) {
    local_438 = (short)param_5 * 2;
    local_430 = local_428;
    local_436 = local_438;
    iVar1 = RtlIntegerToUnicodeString(param_1,param_2,&local_438);
    if (-1 < iVar1) {
      for (uVar2 = (uint)(local_438 >> 1); uVar2 < param_3; uVar2 = uVar2 + 1) {
        if (param_5 == 0) goto LAB_1800580aa;
        *param_4 = 0x30;
        param_4 = param_4 + 1;
        param_5 = param_5 - 1;
      }
      FUN_18000b370(param_4,(ulonglong)param_5,(longlong)local_430);
    }
  }
LAB_1800580aa:
  __security_check_cookie(local_28 ^ (ulonglong)auStack1112);
  return;
}



void FUN_1800580cc(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined4 param_4)

{
  undefined local_18 [16];
  
  RtlInitUnicodeString(local_18);
  NtSetValueKey(param_1,local_18,0,1,param_3,param_4);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

uint FUN_180058134(wchar_t *param_1,undefined8 param_2,wchar_t *param_3)

{
  errno_t eVar1;
  HMODULE hModule;
  FARPROC pFVar2;
  uint uVar3;
  
  hModule = LoadLibraryExW(L"ntdll.dll",(HANDLE)0x0,0x800);
  if ((hModule == (HMODULE)0x0) ||
     (pFVar2 = GetProcAddress(hModule,"RtlGetPersistedStateLocation"), pFVar2 == (FARPROC)0x0)) {
    uVar3 = 0x80004005;
  }
  else {
    uVar3 = (*pFVar2)();
    uVar3 = uVar3 | 0x10000000;
    if (-1 < (int)uVar3) {
      return uVar3;
    }
  }
  eVar1 = wcscpy_s(param_1,0x105,param_3);
  if (eVar1 == 0) {
    uVar3 = 0;
  }
  return uVar3;
}



// WARNING: Type propagation algorithm not settling

void FUN_180058200(wchar_t *param_1,undefined8 param_2,longlong param_3)

{
  wint_t wVar1;
  undefined8 uVar2;
  wint_t *pwVar3;
  undefined *puVar4;
  uint uVar5;
  undefined auStack648 [32];
  ulonglong local_268;
  ulonglong local_258 [2];
  undefined8 local_248;
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack648;
  puVar4 = (undefined *)&local_248;
  memset(param_1,0,0x5a);
  uVar2 = 0;
  memset(&local_248,0,0x208);
  pwVar3 = (wint_t *)&local_248;
  uVar5 = 0;
  do {
    wVar1 = *(wint_t *)((param_3 - (longlong)&local_248) + (longlong)pwVar3);
    if (wVar1 == 0) break;
    if (wVar1 == 0x5c) {
      puVar4 = (undefined *)((longlong)&local_248 + (ulonglong)uVar5 * 2 + 2);
    }
    wVar1 = towlower(wVar1);
    *pwVar3 = wVar1;
    uVar5 = uVar5 + 1;
    pwVar3 = pwVar3 + 1;
  } while (uVar5 < 0x104);
  FUN_180058734(&local_248,uVar2,local_258);
  local_268 = local_258[0];
  FUN_1800582f8(param_1,0x2d,L"%.16ls|%I64x",puVar4);
  __security_check_cookie(local_38 ^ (ulonglong)auStack648);
  return;
}



int FUN_1800582f8(wchar_t *param_1,longlong param_2,wchar_t *param_3,undefined8 param_4)

{
  ulonglong _Count;
  int iVar1;
  int iVar2;
  undefined8 local_res20;
  
  iVar2 = 0;
  if (0x7ffffffe < param_2 - 1U) {
    iVar2 = -0x7ff8ffa9;
  }
  if (iVar2 < 0) {
    if (param_2 != 0) {
      *param_1 = L'\0';
    }
  }
  else {
    _Count = param_2 - 1;
    iVar2 = 0;
    local_res20 = param_4;
    iVar1 = _vsnwprintf(param_1,_Count,param_3,(va_list)&local_res20);
    if ((iVar1 < 0) || (_Count < (ulonglong)(longlong)iVar1)) {
      param_1[_Count] = L'\0';
      iVar2 = -0x7ff8ff86;
    }
    else if ((longlong)iVar1 == _Count) {
      param_1[_Count] = L'\0';
    }
  }
  return iVar2;
}



void FUN_18005837c(int *param_1)

{
  uint uVar1;
  LSTATUS LVar2;
  undefined8 uVar3;
  undefined uVar4;
  undefined uVar5;
  undefined auStackY1816 [32];
  DWORD local_6d8 [2];
  HKEY local_6d0;
  HKEY local_6c8;
  HKEY local_6c0;
  wchar_t local_6b8 [48];
  wchar_t local_658 [264];
  wchar_t local_448 [264];
  wchar_t local_238 [264];
  ulonglong local_28;
  
  local_28 = DAT_1800b2220 ^ (ulonglong)auStackY1816;
  memset(local_448,0,0x20a);
  uVar3 = 0;
  memset(local_658,0,0x20a);
  local_6c0 = (HKEY)0x0;
  local_6d0 = (HKEY)0x0;
  local_6c8 = (HKEY)0x0;
  if ((param_1[1] != 0x210) || (*param_1 != 1)) goto LAB_1800586c0;
  uVar1 = FUN_180058200(local_6b8,uVar3,*(longlong *)(param_1 + 2));
  if ((int)uVar1 < 0) {
    uVar5 = 0xd0;
    uVar4 = 0x79;
  }
  else {
    uVar3 = 0x105;
    uVar1 = FUN_1800582f8(local_658,0x105,L"%s\\%s",0x7ffe0030);
    if ((int)uVar1 < 0) {
      uVar5 = 0x40;
      uVar4 = 0x87;
    }
    else {
      uVar1 = FUN_180058134(local_448,uVar3,local_658);
      if ((int)uVar1 < 0) {
        uVar5 = 0x70;
        uVar4 = 0x92;
      }
      else {
        uVar1 = FUN_1800582f8(local_238,0x104,L"%s\\%s",local_448);
        if (-1 < (int)uVar1) {
          LVar2 = RegLoadAppKeyW(local_238,&local_6c0,0x20019,0,0);
          if (LVar2 == 0) {
            LVar2 = RegOpenKeyExW(local_6c0,L"Root",0,0x20019,&local_6c8);
            if (LVar2 == 0) {
              LVar2 = RegOpenKeyExW(local_6c8,L"InventoryApplicationFile",0,0x20019,&local_6d0);
              if (LVar2 == 0) {
                local_6d8[0] = 0x100;
                uVar1 = RegGetValueW(local_6d0,local_6b8,L"ProgramId",2,(LPDWORD)0x0,param_1 + 4,
                                     local_6d8);
                if ((uVar1 & 0xfffffffd) != 0) {
                  FUN_18001188c(3,0xf0,0xd7,0x68,(char)uVar1);
                }
                local_6d8[0] = 0x100;
                uVar1 = RegGetValueW(local_6d0,local_6b8,L"FileId",2,(LPDWORD)0x0,param_1 + 0x44,
                                     local_6d8);
                if ((uVar1 & 0xfffffffd) != 0) {
                  FUN_18001188c(3,0xf0,0xea,0x98,(char)uVar1);
                }
                goto LAB_1800586c0;
              }
              if (LVar2 == 2) goto LAB_1800586c0;
              uVar5 = 0xf8;
              uVar4 = 0xc2;
            }
            else {
              if (LVar2 == 2) goto LAB_1800586c0;
              uVar5 = 0xf8;
              uVar4 = 0xb8;
            }
          }
          else {
            uVar5 = 200;
            uVar4 = 0xab;
          }
          FUN_18001188c(1,0xf0,uVar4,uVar5,(char)LVar2);
          goto LAB_1800586c0;
        }
        uVar5 = 0xb0;
        uVar4 = 0xa0;
      }
    }
  }
  FUN_18001188c(1,0xf0,uVar4,uVar5,(char)uVar1);
LAB_1800586c0:
  if (local_6d0 != (HKEY)0x0) {
    RegCloseKey(local_6d0);
  }
  if (local_6c8 != (HKEY)0x0) {
    RegCloseKey(local_6c8);
  }
  if (local_6c0 != (HKEY)0x0) {
    RegCloseKey(local_6c0);
  }
  __security_check_cookie(local_28 ^ (ulonglong)auStackY1816);
  return;
}



void FUN_180058734(longlong *param_1,undefined8 param_2,ulonglong *param_3)

{
  ushort uVar1;
  uint uVar2;
  longlong lVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  ulonglong uVar7;
  ulonglong uVar8;
  longlong *plVar9;
  longlong *plVar10;
  
  uVar5 = 0x52bc33fedbe4cbb5;
  uVar8 = 0x52bc33fedbe4cbb5;
  uVar6 = 0x52bc33fedbe4cbb5;
  uVar7 = 0x52bc33fedbe4cbb5;
  plVar10 = param_1;
  do {
    plVar9 = plVar10;
    uVar7 = uVar7 + *plVar9 * 0xd6d018f5;
    uVar5 = uVar5 + plVar9[1] * 0xa2aa033b;
    uVar7 = (uVar7 >> 0x1d | uVar7 << 0x23) + uVar6;
    uVar6 = uVar6 + plVar9[2] * 0x62992fc1;
    plVar10 = plVar9 + 4;
    uVar5 = (uVar5 >> 0x1d | uVar5 << 0x23) + uVar8;
    uVar8 = uVar8 + plVar9[3] * 0x30bc5b29;
    uVar6 = (uVar6 >> 0x1d | uVar6 << 0x23) + uVar7;
    uVar8 = (uVar8 >> 0x1d | uVar8 << 0x23) + uVar5;
  } while (plVar10 <= param_1 + 0x3d);
  uVar4 = (uVar8 + uVar7) * 0xd6d018f5 + uVar5;
  uVar6 = (uVar4 >> 0x25 | uVar4 * 0x8000000) * 0xa2aa033b ^ uVar6;
  uVar4 = (uVar6 + uVar5) * 0xa2aa033b + uVar7;
  uVar8 = (uVar4 >> 0x25 | uVar4 * 0x8000000) * 0xd6d018f5 ^ uVar8;
  uVar4 = (uVar8 + uVar5) * 0xa2aa033b + uVar6;
  uVar8 = (uVar6 + uVar7) * 0xd6d018f5 + uVar8;
  uVar7 = ((uVar4 >> 0x25 | uVar4 * 0x8000000) * 0xd6d018f5 ^
           (uVar8 >> 0x25 | uVar8 * 0x8000000) * 0xa2aa033b ^ uVar5 ^ uVar7) + 0x52bc33fedbe4cbb5;
  if (0xf < (longlong)param_1 + (0x208 - (longlong)plVar10)) {
    lVar3 = *plVar10;
    plVar10 = plVar9 + 6;
    uVar5 = lVar3 * 0x62992fc1 + uVar7;
    uVar6 = uVar5 >> 0x1d | uVar5 << 0x23;
    uVar5 = plVar9[5] * 0x62992fc1 + uVar7;
    uVar5 = uVar5 >> 0x1d | uVar5 << 0x23;
    uVar4 = uVar5 * 0x30bc5b29;
    uVar8 = uVar6 * 0x28e511fea41f163d;
    uVar5 = uVar5 * 0x9472cc564ae2c91;
    uVar7 = uVar7 + (((uVar8 >> 0x15 | uVar8 << 0x2b) + uVar4 ^ uVar6 * 0x30bc5b29) +
                     (uVar5 >> 0x15 | uVar5 << 0x2b) ^ uVar4);
  }
  if (7 < (longlong)param_1 + (0x208 - (longlong)plVar10)) {
    lVar3 = *plVar10;
    plVar10 = plVar10 + 1;
    uVar7 = uVar7 + lVar3 * 0x30bc5b29;
    uVar7 = uVar7 ^ (uVar7 >> 0x37 | uVar7 * 0x200) * 0xa2aa033b;
  }
  if (3 < (longlong)param_1 + (0x208 - (longlong)plVar10)) {
    uVar2 = *(uint *)plVar10;
    plVar10 = (longlong *)((longlong)plVar10 + 4);
    uVar7 = uVar7 + (ulonglong)uVar2 * 0x30bc5b29;
    uVar7 = uVar7 ^ (uVar7 >> 0x1a | uVar7 << 0x26) * 0xa2aa033b;
  }
  if (1 < (longlong)param_1 + (0x208 - (longlong)plVar10)) {
    uVar1 = *(ushort *)plVar10;
    plVar10 = (longlong *)((longlong)plVar10 + 2);
    uVar7 = uVar7 + (ulonglong)uVar1 * 0x30bc5b29;
    uVar7 = uVar7 ^ (uVar7 >> 0x30 | uVar7 * 0x10000) * 0xa2aa033b;
  }
  if (0 < (longlong)param_1 + (0x208 - (longlong)plVar10)) {
    uVar7 = uVar7 + (ulonglong)*(byte *)plVar10 * 0x30bc5b29;
    uVar7 = uVar7 ^ (uVar7 >> 0x25 | uVar7 * 0x8000000) * 0xa2aa033b;
  }
  uVar7 = ((uVar7 >> 0x1c | uVar7 << 0x24) ^ uVar7) * 0xd6d018f5;
  *param_3 = (uVar7 >> 0x1d | uVar7 << 0x23) ^ uVar7;
  return;
}



longlong * BaseFormatTimeOut(longlong *param_1,uint param_2)

{
                    // 0x58990  57  BaseFormatTimeOut
  if (param_2 == 0xffffffff) {
    return (longlong *)0x0;
  }
  *param_1 = (ulonglong)param_2 * -10000;
  return param_1;
}



undefined8 BasepAnsiStringToDynamicUnicodeString(undefined8 param_1)

{
  int iVar1;
  undefined local_18 [16];
  
                    // 0x589c0  77  BasepAnsiStringToDynamicUnicodeString
  iVar1 = RtlInitAnsiStringEx(local_18);
  if (-1 < iVar1) {
    iVar1 = RtlAnsiStringToUnicodeString(param_1,local_18,1);
    if (-1 < iVar1) {
      return 1;
    }
    if (iVar1 != -0x7ffffffb) {
      BaseSetLastNTError();
      return 0;
    }
  }
  RtlSetLastWin32Error(0xce);
  return 0;
}



undefined8 BaseVerifyUnicodeString(ushort *param_1)

{
  ushort uVar1;
  char cVar2;
  
                    // 0x58a30  73  BaseVerifyUnicodeString
  uVar1 = param_1[1];
  if (*(longlong *)(param_1 + 4) == 0) {
    if ((uVar1 == 0) && (*param_1 == 0)) {
      return 0;
    }
  }
  else if ((((uVar1 != 0) && (*param_1 <= uVar1)) && (((*param_1 | uVar1) & 1) == 0)) &&
          (cVar2 = CsrVerifyRegion(*(undefined8 *)(param_1 + 4),uVar1), cVar2 != '\0')) {
    return 0;
  }
  return 0xc0000022;
}



// WARNING: Could not reconcile some variable overlaps

uint BasepAllocateActivationContextActivationBlock
               (uint param_1,undefined8 param_2,undefined8 param_3,uint **param_4)

{
  uint uVar1;
  undefined4 *puVar2;
  uint *puVar3;
  longlong in_GS_OFFSET;
  undefined *puVar4;
  undefined local_18 [16];
  
                    // 0x58a90  76  BasepAllocateActivationContextActivationBlock
  local_18 = ZEXT816(0);
  if (param_4 != (uint **)0x0) {
    *param_4 = (uint *)0x0;
  }
  if ((param_1 & 0xfffffffc) == 0) {
    if (param_4 == (uint **)0x0) {
      uVar1 = 0xc00000f2;
    }
    else {
      puVar4 = local_18;
      uVar1 = RtlQueryInformationActivationContext(1,0,0,1,puVar4,0x10,0);
      if ((int)uVar1 < 0) {
        DbgPrintEx(0x33,0,"SXS: %s - Failure getting active activation context; ntstatus %08lx\n",
                   "BasepAllocateActivationContextActivationBlock",
                   (ulonglong)puVar4 & 0xffffffff00000000 | (ulonglong)uVar1);
      }
      else {
        if ((local_18 & (undefined  [16])0x1) != (undefined  [16])0x0) {
          RtlReleaseActivationContext(local_18._0_8_);
          local_18 = local_18 & (undefined  [16])0xffffffffffffffff;
        }
        if (((param_1 & 2) == 0) || (local_18._0_8_ != 0)) {
          puVar2 = (undefined4 *)KernelBaseGetGlobalData();
          puVar3 = (uint *)RtlAllocateHeap(*(undefined8 *)
                                            (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),*puVar2,0x20
                                          );
          *param_4 = puVar3;
          if (puVar3 == (uint *)0x0) {
            uVar1 = 0xc0000017;
            goto LAB_180058bdf;
          }
          *puVar3 = 0;
          *(longlong *)(*param_4 + 6) = local_18._0_8_;
          local_18 = local_18 & (undefined  [16])0xffffffffffffffff;
          if ((param_1 & 1) != 0) {
            **param_4 = **param_4 | 1;
          }
          *(undefined8 *)(*param_4 + 2) = param_2;
          *(undefined8 *)(*param_4 + 4) = param_3;
        }
        uVar1 = 0;
      }
    }
  }
  else {
    uVar1 = 0xc00000ef;
  }
LAB_180058bdf:
  if (local_18._0_8_ != 0) {
    RtlReleaseActivationContext();
  }
  return uVar1;
}



void BasepFreeActivationContextActivationBlock(longlong param_1)

{
  longlong in_GS_OFFSET;
  
                    // 0x58c20  86  BasepFreeActivationContextActivationBlock
  if (param_1 != 0) {
    if (*(longlong *)(param_1 + 0x18) != 0) {
      RtlReleaseActivationContext();
      *(undefined8 *)(param_1 + 0x18) = 0;
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_1);
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

DWORD GetLongPathNameA(LPCSTR lpszShortPath,LPSTR lpszLongPath,DWORD cchBuffer)

{
  DWORD extraout_EAX;
  DWORD DVar1;
  int iVar2;
  undefined8 uVar3;
  int *piVar4;
  LPWSTR lpszLongPath_00;
  code *pcVar5;
  longlong in_GS_OFFSET;
  undefined auStack696 [32];
  uint local_298;
  LPWSTR local_290;
  undefined local_288 [2];
  short local_286;
  LPCWSTR local_280;
  DWORD local_278;
  ushort local_270 [4];
  void *local_268;
  short local_260;
  LPWSTR local_258;
  WCHAR local_248 [264];
  ulonglong local_38;
  
                    // 0x58c80  629  GetLongPathNameA
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack696;
  lpszLongPath_00 = (LPWSTR)0x0;
  local_290 = (LPWSTR)0x0;
  if (lpszShortPath == (LPCSTR)0x0) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    local_268 = (void *)0x0;
    local_280 = (LPCWSTR)0x0;
    local_298 = 0;
    uVar3 = Basep8BitStringToDynamicUnicodeString();
    if ((int)uVar3 != 0) {
      lpszLongPath_00 = local_248;
      local_290 = lpszLongPath_00;
      DVar1 = GetLongPathNameW(local_280,local_248,0x104);
      local_278 = DVar1;
      if (0x103 < DVar1) {
        piVar4 = (int *)KernelBaseGetGlobalData();
        lpszLongPath_00 =
             (LPWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                     *piVar4 + 0x200000);
        local_290 = lpszLongPath_00;
        if (lpszLongPath_00 == (LPWSTR)0x0) {
          DVar1 = 0;
          RtlSetLastWin32Error(8);
        }
        else {
          DVar1 = GetLongPathNameW(local_280,lpszLongPath_00,local_278);
        }
      }
      if (DVar1 != 0) {
        local_286 = ((short)DVar1 + 1) * 2;
        local_260 = (short)DVar1 * 2;
        local_258 = lpszLongPath_00;
        pcVar5 = (code *)GetUnicodeStringToEightBitStringRoutine();
        iVar2 = (*pcVar5)();
        if (iVar2 < 0) {
          BaseSetLastNTError();
          local_298 = 0;
        }
        else {
          local_298 = (uint)local_270[0];
          if ((lpszLongPath == (LPSTR)0x0) || (cchBuffer < local_298 || cchBuffer == local_270[0]))
          {
            local_298 = local_270[0] + 1;
          }
          else {
            RtlMoveMemory(lpszLongPath,local_268,(ulonglong)local_270[0]);
            lpszLongPath[local_270[0]] = '\0';
          }
        }
      }
    }
    if (local_280 != (LPCWSTR)0x0) {
      RtlFreeUnicodeString(local_288);
    }
    if (local_268 != (void *)0x0) {
      RtlFreeAnsiString(local_270);
    }
    if ((lpszLongPath_00 != (LPWSTR)0x0) && (lpszLongPath_00 != local_248)) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_290);
    }
  }
  __security_check_cookie(local_38 ^ (ulonglong)auStack696);
  return extraout_EAX;
}



int FUN_180058f20(LPTHREAD_START_ROUTINE param_1,LPVOID param_2,HANDLE *param_3)

{
  HANDLE pvVar1;
  int iVar2;
  longlong in_GS_OFFSET;
  undefined8 local_58;
  undefined4 local_50;
  undefined local_48 [16];
  undefined local_38 [16];
  undefined local_28 [16];
  undefined8 local_18;
  
  local_58 = 0x48;
  local_50 = 1;
  local_48 = ZEXT816(0);
  local_38 = ZEXT816(0);
  local_28 = ZEXT816(0);
  local_18 = 0;
  iVar2 = 0;
  RtlActivateActivationContextUnsafeFast(&local_58,0);
  pvVar1 = CreateRemoteThread((HANDLE)0xffffffffffffffff,(LPSECURITY_ATTRIBUTES)0x0,0,param_1,
                              param_2,4,(LPDWORD)0x0);
  *param_3 = pvVar1;
  if ((pvVar1 == (HANDLE)0x0) &&
     (iVar2 = *(int *)(*(longlong *)(in_GS_OFFSET + 0x30) + 0x1250), -1 < iVar2)) {
    iVar2 = -0x3fffffff;
  }
  RtlDeactivateActivationContextUnsafeFast(&local_58);
  return iVar2;
}



void FUN_180058ff9(undefined8 param_1,longlong param_2)

{
  RtlDeactivateActivationContextUnsafeFast(param_2 + 0x40);
  return;
}



void FUN_180059020(void)

{
  code *pcVar1;
  
  RtlExitUserThread();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

uint FUN_180059038(undefined8 param_1,ushort param_2)

{
  int iVar1;
  longlong lVar2;
  longlong lVar3;
  code *pcVar4;
  uint local_res18 [4];
  ushort local_18;
  
  lVar2 = KernelBaseGetGlobalData();
  lVar3 = KernelBaseGetGlobalData();
  iVar1 = RtlUnicodeToMultiByteSize
                    (local_res18,*(undefined8 *)(lVar3 + 0x10),*(undefined2 *)(lVar2 + 10));
  if (-1 < iVar1) {
    if (param_2 < (ushort)local_res18[0]) {
      return local_res18[0];
    }
    KernelBaseGetGlobalData();
    pcVar4 = (code *)GetUnicodeStringToEightBitStringRoutine();
    iVar1 = (*pcVar4)();
    if (-1 < iVar1) {
      return (uint)local_18;
    }
  }
  return 0;
}



void FUN_1800590ec(longlong param_1)

{
  undefined auStack632 [32];
  undefined4 local_258;
  undefined local_248 [16];
  undefined4 local_238 [136];
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack632;
  if (param_1 != 0) {
    local_258 = 9;
    NtQueryInformationFile(param_1,local_248,local_238,0x218);
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack632);
  return;
}



// WARNING: Removing unreachable block (ram,0x000180012963)
// WARNING: Removing unreachable block (ram,0x0001800129f5)

ATOM AddAtomA(LPCSTR lpString)

{
  int iVar1;
  undefined8 uVar2;
  ushort auStackX24 [4];
  undefined4 uStackX32;
  ulonglong uStack88;
  undefined auStack80 [8];
  undefined8 uStack72;
  undefined auStack64 [24];
  
  uStackX32 = 0;
  if (lpString < (LPCSTR)0x10000) {
    auStackX24[0] = (ushort)lpString;
    if (auStackX24[0] < 0xc000) {
      return auStackX24[0];
    }
  }
  else {
    RtlInitAnsiString(auStack64,lpString);
    iVar1 = RtlAnsiStringToUnicodeString(auStack80,auStack64,1);
    if (-1 < iVar1) {
      auStackX24[0] = 0;
      uVar2 = FUN_180013114(&uStack88);
      if (((int)uVar2 < 0) ||
         (iVar1 = RtlAddAtomToAtomTable(uStack88,uStack72,auStackX24), iVar1 < 0)) {
        BaseSetLastNTError();
        auStackX24[0] = 0;
      }
      RtlFreeUnicodeString(auStack80);
      return auStackX24[0];
    }
  }
  BaseSetLastNTError();
  return 0;
}



UINT GetAtomNameA(ATOM nAtom,LPSTR lpBuffer,int nSize)

{
  void *pvVar1;
  
                    // 0x59190  454  GetAtomNameA
  pvVar1 = FUN_1800126a8('\x01','\0',nAtom,lpBuffer,nSize);
  return (UINT)pvVar1;
}



// WARNING: Removing unreachable block (ram,0x000180012963)
// WARNING: Removing unreachable block (ram,0x000180012a28)
// WARNING: Removing unreachable block (ram,0x000180012a36)

ulonglong GlobalAddAtomExA(ulonglong param_1,undefined4 param_2)

{
  int iVar1;
  ushort auStackX24 [4];
  undefined4 uStackX32;
  undefined2 *puVar2;
  undefined2 auStack80 [4];
  undefined8 uStack72;
  undefined auStack64 [24];
  
                    // 0x591c0  823  GlobalAddAtomExA
  uStackX32 = param_2;
  if (param_1 < 0x10000) {
    auStackX24[0] = (ushort)param_1;
    if (auStackX24[0] < 0xc000) {
      return param_1 & 0xffff;
    }
  }
  else {
    RtlInitAnsiString(auStack64,param_1);
    puVar2 = auStack80;
    iVar1 = RtlAnsiStringToUnicodeString(auStack80,auStack64,1);
    if (-1 < iVar1) {
      auStackX24[0] = 0;
      iVar1 = NtAddAtomEx(uStack72,auStack80[0],auStackX24,param_2,iVar1,puVar2);
      if (iVar1 < 0) {
        BaseSetLastNTError();
        auStackX24[0] = 0;
      }
      RtlFreeUnicodeString(auStack80);
      return (ulonglong)auStackX24[0];
    }
  }
  BaseSetLastNTError();
  return 0;
}



// WARNING: Removing unreachable block (ram,0x000180012e46)
// WARNING: Removing unreachable block (ram,0x000180012f05)
// WARNING: Removing unreachable block (ram,0x000180012f16)

ATOM GlobalFindAtomA(LPCSTR lpString)

{
  int iVar1;
  undefined8 in_R9;
  ushort local_res18 [8];
  short *psVar2;
  short local_48 [4];
  undefined8 local_40;
  undefined local_38 [24];
  
  if (lpString < (LPCSTR)0x10000) {
    local_res18[0] = (ushort)lpString;
    if (local_res18[0] < 0xc000) {
      return local_res18[0];
    }
  }
  else {
    RtlInitAnsiString(local_38,lpString);
    psVar2 = local_48;
    iVar1 = RtlAnsiStringToUnicodeString(local_48,local_38,1);
    if (-1 < iVar1) {
      local_res18[0] = 0;
      if (local_48[0] == 0) {
        RtlSetLastWin32Error(0x7b);
      }
      else {
        iVar1 = NtFindAtom(local_40,local_48[0],local_res18,in_R9,iVar1,psVar2);
        if (iVar1 < 0) {
          BaseSetLastNTError();
          local_res18[0] = 0;
        }
      }
      RtlFreeUnicodeString(local_48);
      return local_res18[0];
    }
  }
  BaseSetLastNTError();
  return 0;
}



UINT GlobalGetAtomNameA(ATOM nAtom,LPSTR lpBuffer,int nSize)

{
  void *pvVar1;
  
                    // 0x59200  834  GlobalGetAtomNameA
  pvVar1 = FUN_1800126a8('\0','\0',nAtom,lpBuffer,nSize);
  return (UINT)pvVar1;
}



BOOL InitAtomTable(DWORD nSize)

{
  int iVar1;
  bool bVar2;
  ulonglong local_res10 [3];
  
                    // 0x59230  867  InitAtomTable
  if (DAT_1800b2b38 == 0) {
    if (0x1fb < nSize - 4) {
      nSize = 0x25;
    }
    local_res10[0] = 0;
    iVar1 = RtlCreateAtomTable(nSize,local_res10);
    if (iVar1 < 0) {
      return 0;
    }
    LOCK();
    bVar2 = DAT_1800b2b38 == 0;
    DAT_1800b2b38 = DAT_1800b2b38 ^ (ulonglong)bVar2 * (DAT_1800b2b38 ^ local_res10[0]);
    if (!bVar2) {
      RtlDestroyAtomTable(local_res10[0]);
    }
  }
  return 1;
}



DWORD AddLocalAlternateComputerNameA(LPCSTR param_1,int param_2)

{
  DWORD DVar1;
  LPCWSTR local_res8;
  
                    // 0x592b0  11  AddLocalAlternateComputerNameA
  local_res8 = (LPCWSTR)0x0;
  if (param_1 == (LPCSTR)0x0) {
    DVar1 = 0x57;
  }
  else {
    DVar1 = FUN_180059c0c(param_1,&local_res8);
    if (DVar1 == 0) {
      DVar1 = AddLocalAlternateComputerNameW(local_res8,param_2);
    }
    BaseFreeAppCompatDataForProcessWorker((longlong)local_res8);
  }
  return DVar1;
}



DWORD AddLocalAlternateComputerNameW(LPCWSTR param_1,int param_2)

{
  DWORD DVar1;
  BOOL BVar2;
  undefined8 uVar3;
  ulonglong uVar4;
  undefined4 *puVar5;
  wchar_t *ComputerName;
  longlong in_GS_OFFSET;
  uint local_res8 [2];
  
                    // 0x59310  12  AddLocalAlternateComputerNameW
  local_res8[0] = 0;
  if (((param_1 == (LPCWSTR)0x0) || (param_2 != 0)) || (uVar3 = FUN_18007d6c4(), (int)uVar3 == 0)) {
    DVar1 = 0x57;
  }
  else {
    uVar4 = FUN_180059458((undefined *)
                          L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\DnsCache\\Parameters"
                          ,L"AlternateComputerNames",param_1);
    DVar1 = RtlNtStatusToDosError(uVar4 & 0xffffffff);
    if (((DVar1 == 0) &&
        (BVar2 = DnsHostnameToComputerNameW(param_1,(LPWSTR)0x0,local_res8), BVar2 == 0)) &&
       (DVar1 = GetLastError(), DVar1 == 0xea)) {
      local_res8[0] = local_res8[0] + 1;
      uVar4 = (ulonglong)local_res8[0];
      puVar5 = (undefined4 *)KernelBaseGetGlobalData();
      ComputerName = (wchar_t *)
                     RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                     *puVar5,uVar4 * 2);
      if (ComputerName == (wchar_t *)0x0) {
        DVar1 = 8;
      }
      else {
        BVar2 = DnsHostnameToComputerNameW(param_1,ComputerName,local_res8);
        if ((BVar2 == 0) || (uVar3 = BaseSetAltNetBiosName(ComputerName), (int)uVar3 == 0)) {
          DVar1 = GetLastError();
        }
        else {
          DVar1 = 0;
        }
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,ComputerName);
      }
    }
  }
  return DVar1;
}



ulonglong FUN_180059458(undefined *param_1,undefined8 param_2,wchar_t *param_3)

{
  uint uVar1;
  uint uVar2;
  undefined4 *puVar3;
  short *psVar4;
  undefined8 uVar5;
  ulonglong uVar6;
  longlong lVar7;
  longlong lVar8;
  uint uVar9;
  longlong in_GS_OFFSET;
  uint local_res20 [2];
  uint local_38 [4];
  
  local_res20[0] = 0;
  local_38[0] = 0;
  uVar9 = 0;
  psVar4 = (short *)0x0;
  uVar1 = FUN_18007d8f0(0,param_1,param_2,(void *)0x0,local_res20);
  if ((uVar1 == 0xc0000225) || (uVar1 == 0xc0000034)) {
    uVar6 = FUN_180059658(param_1,param_2,param_3);
    return uVar6;
  }
  lVar8 = -1;
  if (uVar1 == 0x80000005) {
    lVar7 = -1;
    do {
      lVar7 = lVar7 + 1;
    } while (param_3[lVar7] != L'\0');
    uVar9 = local_res20[0] + 1 + (int)lVar7;
    puVar3 = (undefined4 *)KernelBaseGetGlobalData();
    psVar4 = (short *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                      *puVar3,(ulonglong)uVar9 * 2);
    if (psVar4 == (short *)0x0) {
      uVar1 = 0xc0000017;
      goto LAB_1800595c2;
    }
    uVar1 = FUN_18007d8f0(0,param_1,param_2,psVar4,local_res20);
  }
  if (((-1 < (int)uVar1) && (uVar2 = FUN_1800597e4(psVar4,param_3,local_38), uVar2 != 0)) &&
     (uVar5 = FUN_1800595fc((longlong)psVar4,uVar9,param_3,local_res20[0]), (int)uVar5 == 0)) {
    do {
      lVar8 = lVar8 + 1;
    } while (param_3[lVar8] != L'\0');
    uVar6 = FUN_18005a0bc(param_1,param_2,psVar4,((int)lVar8 + local_res20[0]) * 2 + 4);
    uVar1 = (uint)uVar6;
  }
  if (psVar4 != (short *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,psVar4);
  }
LAB_1800595c2:
  return (ulonglong)uVar1;
}



undefined8 FUN_1800595fc(longlong param_1,int param_2,wchar_t *param_3,uint param_4)

{
  longlong lVar1;
  
  wcscpy_s((wchar_t *)(param_1 + (ulonglong)param_4 * 2),(ulonglong)(param_2 - param_4),param_3);
  lVar1 = -1;
  do {
    lVar1 = lVar1 + 1;
  } while (param_3[lVar1] != L'\0');
  *(undefined2 *)(param_1 + 2 + (lVar1 + (ulonglong)param_4) * 2) = 0;
  return 0;
}



ulonglong FUN_180059658(undefined8 param_1,undefined8 param_2,void *param_3)

{
  undefined4 *puVar1;
  void *_Dst;
  longlong lVar2;
  ulonglong uVar3;
  longlong lVar4;
  longlong in_GS_OFFSET;
  
  puVar1 = (undefined4 *)KernelBaseGetGlobalData();
  lVar2 = -1;
  lVar4 = -1;
  do {
    lVar4 = lVar4 + 1;
  } while (*(short *)((longlong)param_3 + lVar4 * 2) != 0);
  _Dst = (void *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),*puVar1,
                                 lVar4 * 2 + 4);
  if (_Dst == (void *)0x0) {
    uVar3 = 0xc0000017;
  }
  else {
    lVar4 = -1;
    do {
      lVar4 = lVar4 + 1;
    } while (*(short *)((longlong)param_3 + lVar4 * 2) != 0);
    memcpy(_Dst,param_3,lVar4 * 2);
    lVar4 = -1;
    do {
      lVar4 = lVar4 + 1;
    } while (*(short *)((longlong)param_3 + lVar4 * 2) != 0);
    *(undefined2 *)((longlong)_Dst + lVar4 * 2) = 0;
    lVar4 = -1;
    do {
      lVar4 = lVar4 + 1;
    } while (*(short *)((longlong)param_3 + lVar4 * 2) != 0);
    *(undefined2 *)((longlong)_Dst + lVar4 * 2 + 2) = 0;
    do {
      lVar2 = lVar2 + 1;
    } while (*(short *)((longlong)param_3 + lVar2 * 2) != 0);
    uVar3 = FUN_18005a0bc(param_1,param_2,_Dst,(int)lVar2 * 2 + 4);
    uVar3 = uVar3 & 0xffffffff;
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,_Dst);
  }
  return uVar3;
}



// Library Function - Single Match
//  BaseEnumAltDnsFQHostnames
// 
// Library: Visual Studio 2019 Release

void BaseEnumAltDnsFQHostnames(undefined2 *param_1,uint *param_2)

{
  int iVar1;
  
  iVar1 = FUN_18007d8f0((longlong)L"Dnscache",
                        (undefined *)
                        L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\DnsCache\\Parameters"
                        ,L"AlternateComputerNames",param_1,param_2);
  if (iVar1 == -0x3fffffcc) {
    iVar1 = 0;
    if ((param_1 == (undefined2 *)0x0) || (*param_2 == 0)) {
      *param_2 = 1;
      iVar1 = -0x7ffffffb;
    }
    else {
      *param_1 = 0;
      *param_2 = 0;
    }
  }
                    // WARNING: Could not recover jumptable at 0x0001800597d2. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlNtStatusToDosError(iVar1);
  return;
}



uint FUN_1800597e4(short *param_1,void *param_2,uint *param_3)

{
  uint uVar1;
  int iVar2;
  longlong lVar3;
  longlong lVar4;
  uint uVar5;
  uint uVar6;
  uint local_res20 [2];
  short *local_38 [2];
  
  uVar5 = 0;
  local_38[0] = (short *)0x0;
  uVar1 = uVar5;
  uVar6 = uVar5;
  do {
    if (uVar5 != 0) {
      return uVar1;
    }
    uVar1 = BasepGetMultiValueAddr(param_1,uVar6,local_38,local_res20);
    if (uVar1 == 0) {
      lVar4 = -1;
      do {
        lVar4 = lVar4 + 1;
      } while (local_38[0][lVar4] != 0);
      lVar3 = -1;
      do {
        lVar3 = lVar3 + 1;
      } while (*(short *)((longlong)param_2 + lVar3 * 2) != 0);
      if (lVar4 == lVar3) {
        lVar4 = -1;
        do {
          lVar4 = lVar4 + 1;
        } while (*(short *)((longlong)param_2 + lVar4 * 2) != 0);
        iVar2 = _memicmp(local_38[0],param_2,lVar4 * 2);
        if (iVar2 == 0) {
          uVar5 = 1;
          *param_3 = uVar6;
        }
      }
    }
    uVar6 = uVar6 + 1;
  } while (uVar1 == 0);
  return uVar1;
}



bool FUN_1800598bc(void *param_1)

{
  int iVar1;
  uint uVar2;
  undefined4 *puVar3;
  short *psVar4;
  bool bVar5;
  longlong in_GS_OFFSET;
  bool bVar6;
  uint local_res10 [2];
  uint local_res18 [2];
  
  bVar6 = false;
  local_res10[0] = 0;
  local_res18[0] = 0;
  iVar1 = FUN_18007d8f0((longlong)L"Dnscache",
                        (undefined *)
                        L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\DnsCache\\Parameters"
                        ,L"AlternateComputerNames",(void *)0x0,local_res10);
  bVar5 = bVar6;
  if (iVar1 == -0x7ffffffb) {
    puVar3 = (undefined4 *)KernelBaseGetGlobalData();
    psVar4 = (short *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                      *puVar3,(ulonglong)local_res10[0] * 2);
    bVar5 = false;
    if (psVar4 != (short *)0x0) {
      iVar1 = FUN_18007d8f0((longlong)L"Dnscache",
                            (undefined *)
                            L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\DnsCache\\Parameters"
                            ,L"AlternateComputerNames",psVar4,local_res10);
      iVar1 = RtlNtStatusToDosError(iVar1);
      if (iVar1 == 0) {
        uVar2 = FUN_1800597e4(psVar4,param_1,local_res18);
        bVar6 = uVar2 == 0;
      }
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,psVar4);
      bVar5 = bVar6;
    }
  }
  return bVar5;
}



ulonglong FUN_1800599c4(wchar_t *param_1)

{
  int iVar1;
  uint uVar2;
  BOOL BVar3;
  ulonglong uVar4;
  undefined4 *puVar5;
  short *psVar6;
  LPWSTR ComputerName;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  longlong in_GS_OFFSET;
  uint local_res10 [2];
  uint local_res18 [2];
  uint local_res20 [2];
  LPCWSTR local_48 [2];
  
  psVar6 = (short *)0x0;
  local_res18[0] = 0;
  local_48[0] = (LPCWSTR)0x0;
  local_res10[0] = 0;
  ComputerName = (LPWSTR)0x0;
  uVar7 = 1;
  uVar8 = 0;
  iVar1 = FUN_18007d8f0((longlong)L"Dnscache",
                        (undefined *)
                        L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\DnsCache\\Parameters"
                        ,L"AlternateComputerNames",(void *)0x0,local_res18);
  uVar4 = RtlNtStatusToDosError(iVar1);
  if ((int)uVar4 == 0xea) {
    puVar5 = (undefined4 *)KernelBaseGetGlobalData();
    psVar6 = (short *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                      *puVar5,(ulonglong)local_res18[0] * 2);
    if (psVar6 == (short *)0x0) {
      RtlSetLastWin32Error(8);
      goto LAB_180059be9;
    }
    iVar1 = FUN_18007d8f0((longlong)L"Dnscache",
                          (undefined *)
                          L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\DnsCache\\Parameters"
                          ,L"AlternateComputerNames",psVar6,local_res18);
    uVar4 = RtlNtStatusToDosError(iVar1);
  }
  if ((int)uVar4 == 0) {
    if (psVar6 == (short *)0x0) {
      return uVar4;
    }
    uVar9 = 0;
    do {
      uVar2 = BasepGetMultiValueAddr(psVar6,uVar9,local_48,local_res20);
      if (uVar2 == 0) {
        BVar3 = DnsHostnameToComputerNameW(local_48[0],ComputerName,local_res10);
        if (BVar3 == 0) {
          uVar2 = GetLastError();
          if (uVar2 == 0xea) {
            local_res10[0] = local_res10[0] + 1;
            uVar4 = (ulonglong)local_res10[0];
            puVar5 = (undefined4 *)KernelBaseGetGlobalData();
            ComputerName = (LPWSTR)RtlAllocateHeap(*(undefined8 *)
                                                    (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                                   *puVar5,uVar4 * 2);
            if (ComputerName == (LPWSTR)0x0) {
              uVar2 = 8;
              goto LAB_180059b8e;
            }
            BVar3 = DnsHostnameToComputerNameW(local_48[0],ComputerName,local_res10);
            if (BVar3 == 0) {
              uVar2 = GetLastError();
            }
            else {
              uVar2 = 0;
            }
          }
          if (uVar2 != 0) goto LAB_180059b8e;
        }
        iVar1 = _wcsicmp(ComputerName,param_1);
        if (iVar1 == 0) {
          uVar8 = uVar7;
        }
      }
LAB_180059b8e:
      uVar9 = uVar9 + 1;
    } while (uVar2 == 0);
    if (uVar2 == 0x490) {
      uVar7 = uVar8;
    }
  }
  if (psVar6 != (short *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,psVar6);
  }
  if (ComputerName != (LPWSTR)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,ComputerName);
  }
LAB_180059be9:
  return (ulonglong)uVar7;
}



DWORD FUN_180059c0c(LPCSTR param_1,LPWSTR *param_2)

{
  int iVar1;
  DWORD DVar2;
  longlong lVar3;
  undefined4 *puVar5;
  LPWSTR lpWideCharStr;
  uint cbMultiByte;
  longlong in_GS_OFFSET;
  longlong lVar4;
  
  if (param_1 == (LPCSTR)0x0) {
    *param_2 = (LPWSTR)0x0;
  }
  else {
    lVar3 = -1;
    do {
      lVar4 = lVar3;
      lVar3 = lVar4 + 1;
    } while (param_1[lVar3] != '\0');
    cbMultiByte = (int)lVar4 + 2;
    if (0xffffffff < (ulonglong)cbMultiByte * 2) {
      return 0xd;
    }
    puVar5 = (undefined4 *)KernelBaseGetGlobalData();
    lpWideCharStr =
         (LPWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),*puVar5,
                                 (ulonglong)cbMultiByte * 2 & 0xffffffff);
    *param_2 = lpWideCharStr;
    if (lpWideCharStr == (LPWSTR)0x0) {
      return 8;
    }
    iVar1 = MultiByteToWideChar(0,0,param_1,cbMultiByte,lpWideCharStr,cbMultiByte);
    if (iVar1 == 0) {
      DVar2 = GetLastError();
      return DVar2;
    }
  }
  return 0;
}



wchar_t * FUN_180059ce8(wchar_t *param_1,int param_2)

{
  size_t sVar1;
  undefined4 *puVar2;
  wchar_t *_Dst;
  ulonglong uVar3;
  uint uVar4;
  longlong lVar5;
  longlong in_GS_OFFSET;
  
  if (param_1 != (wchar_t *)0x0) {
    sVar1 = wcscspn(param_1,L".");
    uVar4 = (uint)sVar1;
    if (param_2 != 0) {
      lVar5 = -1;
      uVar3 = 0xffffffffffffffff;
      do {
        uVar3 = uVar3 + 1;
      } while (param_1[uVar3] != L'\0');
      if ((sVar1 & 0xffffffff) == uVar3) {
        uVar4 = 0;
      }
      else {
        do {
          lVar5 = lVar5 + 1;
        } while (param_1[lVar5] != L'\0');
        uVar4 = (int)lVar5 + ~uVar4;
      }
    }
    puVar2 = (undefined4 *)KernelBaseGetGlobalData();
    _Dst = (wchar_t *)
           RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),*puVar2,
                           (ulonglong)(uVar4 + 1) * 2);
    if (_Dst != (wchar_t *)0x0) {
      if (param_2 != 0) {
        param_1 = param_1 + (sVar1 & 0xffffffff) + 1;
      }
      wcsncpy_s(_Dst,(ulonglong)(uVar4 + 1),param_1,(ulonglong)uVar4);
      return _Dst;
    }
  }
  return (wchar_t *)0x0;
}



undefined8 FUN_180059df4(void *param_1)

{
  bool bVar1;
  bool bVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  undefined4 *puVar6;
  short *psVar7;
  ulonglong uVar8;
  longlong in_GS_OFFSET;
  uint local_res10 [2];
  uint local_res18 [4];
  
  local_res18[0] = 0;
  local_res10[0] = 0;
  iVar3 = FUN_18007d8f0(0,(undefined *)
                          L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\LanmanServer\\Parameters"
                        ,L"OptionalNames",(void *)0x0,local_res10);
  if (iVar3 == -0x7ffffffb) {
    puVar6 = (undefined4 *)KernelBaseGetGlobalData();
    psVar7 = (short *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                      *puVar6,(ulonglong)local_res10[0] * 2);
    if (psVar7 == (short *)0x0) goto LAB_180059f34;
    iVar3 = FUN_18007d8f0(0,(undefined *)
                            L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\LanmanServer\\Parameters"
                          ,L"OptionalNames",psVar7,local_res10);
    iVar4 = RtlNtStatusToDosError(iVar3);
    bVar2 = false;
    if (iVar4 == 0) {
      do {
        bVar1 = bVar2;
        uVar5 = FUN_1800597e4(psVar7,param_1,local_res18);
        if (uVar5 != 0) break;
        uVar5 = FUN_180059f58(psVar7,local_res18[0],local_res10);
        bVar1 = true;
        bVar2 = true;
      } while (uVar5 == 0);
      if (bVar1) {
        uVar8 = FUN_18005a0bc(L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\LanmanServer\\Parameters"
                              ,L"OptionalNames",psVar7,local_res10[0] * 2 + 2);
        iVar3 = (int)uVar8;
      }
      else {
        iVar3 = -0x3ffffddb;
      }
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,psVar7);
  }
  if (-1 < iVar3) {
    return 1;
  }
LAB_180059f34:
  BaseSetLastNTError();
  return 0;
}



uint FUN_180059f58(short *param_1,uint param_2,uint *param_3)

{
  uint uVar1;
  uint uVar2;
  longlong lVar3;
  uint local_res20 [2];
  uint local_38 [2];
  short *local_30;
  short *local_28 [2];
  
  local_28[0] = (short *)0x0;
  local_30 = (short *)0x0;
  local_38[0] = 0;
  local_res20[0] = 0;
  uVar1 = BasepGetMultiValueAddr(param_1,param_2,&local_30,local_38);
  if (uVar1 == 0) {
    uVar1 = BasepGetMultiValueAddr(param_1,param_2 + 1,local_28,local_res20);
    if (uVar1 == 0) {
      uVar2 = *param_3 - local_res20[0];
      RtlMoveMemory(local_30,local_28[0],(ulonglong)uVar2 * 2);
      local_38[0] = local_38[0] + uVar2;
      *param_3 = local_38[0];
      param_1[local_38[0]] = 0;
    }
    else if (uVar1 == 0x490) {
      lVar3 = -1;
      do {
        lVar3 = lVar3 + 1;
      } while (local_30[lVar3] != 0);
      uVar1 = 0;
      *param_3 = *param_3 + (-1 - (int)lVar3);
      param_1[*param_3] = 0;
    }
  }
  return uVar1;
}



bool FUN_18005a030(wchar_t *param_1)

{
  ulonglong uVar1;
  bool bVar2;
  
  uVar1 = FUN_180059458((undefined *)
                        L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\DnsCache\\Parameters"
                        ,L"AlternateComputerNames",param_1);
  bVar2 = -1 < (int)uVar1;
  if (!bVar2) {
    BaseSetLastNTError();
  }
  return bVar2;
}



// Library Function - Single Match
//  BaseSetAltNetBiosName
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

undefined8 BaseSetAltNetBiosName(wchar_t *param_1)

{
  undefined8 uVar1;
  ulonglong uVar2;
  
  uVar1 = FUN_18007d780(param_1);
  if (((int)uVar1 == 0) ||
     (uVar2 = FUN_180059458((undefined *)
                            L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\LanmanServer\\Parameters"
                            ,L"OptionalNames",param_1), (int)uVar2 < 0)) {
    BaseSetLastNTError();
    uVar1 = 0;
  }
  else {
    uVar1 = 1;
  }
  return uVar1;
}



ulonglong FUN_18005a0bc(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined4 param_4)

{
  uint uVar1;
  ulonglong uVar2;
  undefined8 local_68;
  undefined local_60 [16];
  undefined local_50 [16];
  undefined4 local_40 [2];
  undefined8 local_38;
  undefined *local_30;
  undefined4 local_28;
  undefined local_20 [16];
  
  local_68 = 0;
  RtlInitUnicodeString(local_60,param_1);
  local_30 = local_60;
  local_38 = 0;
  local_40[0] = 0x30;
  local_20 = ZEXT816(0);
  local_28 = 0x40;
  uVar2 = NtCreateKey(&local_68,0x2001f,local_40,0,0,0,0);
  if (-1 < (int)uVar2) {
    RtlInitUnicodeString(local_50,param_2);
    uVar1 = NtSetValueKey(local_68,local_50,0,7,param_3,param_4);
    uVar2 = (ulonglong)uVar1;
    if (-1 < (int)uVar1) {
      NtFlushKey(local_68);
    }
    NtClose(local_68);
  }
  return uVar2;
}



// Library Function - Single Match
//  BasepGetMultiValueAddr
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

uint BasepGetMultiValueAddr(short *param_1,uint param_2,short **param_3,uint *param_4)

{
  uint uVar1;
  longlong lVar2;
  longlong lVar3;
  uint uVar4;
  uint uVar5;
  
  uVar1 = 0;
  uVar5 = 0;
  uVar4 = 0;
  if (param_2 != 0) {
    do {
      if (*param_1 == 0) goto LAB_18005a224;
      lVar2 = -1;
      do {
        lVar2 = lVar2 + 1;
      } while (param_1[lVar2] != 0);
      uVar5 = uVar5 + (int)lVar2 + 1;
      lVar2 = -1;
      do {
        lVar3 = lVar2;
        lVar2 = lVar3 + 1;
      } while (param_1[lVar2] != 0);
      uVar4 = uVar4 + 1;
      param_1 = param_1 + lVar3 + 2;
    } while (uVar4 < param_2);
  }
  if (*param_1 == 0) {
LAB_18005a224:
    uVar1 = 0x490;
  }
  else {
    *param_3 = param_1;
    *param_4 = uVar5;
  }
  return uVar1;
}



BOOL DnsHostnameToComputerNameA(LPCSTR Hostname,LPSTR ComputerName,LPDWORD nSize)

{
  char cVar1;
  int iVar2;
  BOOL extraout_EAX;
  undefined auStack168 [32];
  undefined4 local_88 [2];
  undefined2 *local_80;
  ushort local_78;
  undefined2 local_76;
  LPSTR local_70;
  undefined local_68 [16];
  undefined2 local_58 [16];
  ulonglong local_38;
  
                    // 0x5a240  299  DnsHostnameToComputerNameA
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack168;
  cVar1 = RtlCreateUnicodeStringFromAsciiz(local_68,Hostname);
  if (cVar1 == '\0') {
    iVar2 = -0x3fffffe9;
  }
  else {
    local_80 = local_58;
    local_58[0] = 0;
    local_88[0] = 0x200000;
    iVar2 = RtlDnsHostNameToComputerName(local_88,local_68,0);
    if (-1 < iVar2) {
      local_76 = *(undefined2 *)nSize;
      local_78 = 0;
      local_70 = ComputerName;
      iVar2 = RtlUnicodeStringToAnsiString(&local_78,local_88,0);
      if (-1 < iVar2) {
        *nSize = (uint)local_78;
      }
    }
    RtlFreeUnicodeString(local_68);
  }
  if (iVar2 < 0) {
    BaseSetLastNTError();
  }
  __security_check_cookie(local_38 ^ (ulonglong)auStack168);
  return extraout_EAX;
}



DWORD EnumerateLocalComputerNamesA(uint param_1,int param_2,LPSTR param_3,uint *param_4)

{
  DWORD DVar1;
  int iVar2;
  undefined4 *puVar3;
  LPWSTR lpWideCharStr;
  longlong in_GS_OFFSET;
  
                    // 0x5a330  355  EnumerateLocalComputerNamesA
  lpWideCharStr = (LPWSTR)0x0;
  if (param_4 == (uint *)0x0) {
LAB_18005a42d:
    DVar1 = 0x57;
  }
  else {
    if (param_3 == (LPSTR)0x0) {
      if (*param_4 != 0) goto LAB_18005a42d;
    }
    else {
      puVar3 = (undefined4 *)KernelBaseGetGlobalData();
      lpWideCharStr =
           (LPWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                   *puVar3,(ulonglong)*param_4 * 2);
      if (lpWideCharStr == (LPWSTR)0x0) {
        return 8;
      }
    }
    DVar1 = EnumerateLocalComputerNamesW(param_1,param_2,lpWideCharStr,param_4);
    if ((DVar1 == 0) &&
       (iVar2 = WideCharToMultiByte(0,0,lpWideCharStr,*param_4 + 1,param_3,*param_4 + 1,(LPCSTR)0x0,
                                    (LPBOOL)0x0), iVar2 == 0)) {
      DVar1 = GetLastError();
    }
    if (lpWideCharStr != (LPWSTR)0x0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpWideCharStr);
    }
  }
  return DVar1;
}



DWORD EnumerateLocalComputerNamesW(uint param_1,int param_2,LPWSTR param_3,uint *param_4)

{
  BOOL BVar1;
  DWORD DVar2;
  uint uVar3;
  undefined4 *puVar4;
  LPWSTR lpBuffer;
  longlong in_GS_OFFSET;
  uint local_res10 [2];
  uint local_28 [4];
  
                    // 0x5a460  356  EnumerateLocalComputerNamesW
  local_res10[0] = 0;
  DVar2 = 0;
  if ((param_2 == 0) && (param_1 < 3)) {
    if (param_1 == 0) {
      if (param_4 != (uint *)0x0) {
        local_res10[0] = -(uint)(*param_4 != 0) & *param_4 - 1;
        BVar1 = GetComputerNameExW(ComputerNamePhysicalDnsFullyQualified,param_3,local_res10);
        if (BVar1 == 0) {
          DVar2 = GetLastError();
        }
        else if (param_3 == (LPWSTR)0x0) {
          DVar2 = 0x1f;
        }
        else {
          param_3[local_res10[0] + 1] = L'\0';
        }
        *param_4 = local_res10[0] + 1;
        return DVar2;
      }
    }
    else if (param_1 == 1) {
      if ((param_4 != (uint *)0x0) && ((param_3 != (LPWSTR)0x0 || (*param_4 == 0)))) {
        DVar2 = BaseEnumAltDnsFQHostnames(param_3,param_4);
        return DVar2;
      }
    }
    else if (((param_1 == 2) && (param_4 != (uint *)0x0)) &&
            ((param_3 != (LPWSTR)0x0 || (*param_4 == 0)))) {
      local_res10[0] = *param_4;
      puVar4 = (undefined4 *)KernelBaseGetGlobalData();
      lpBuffer = (LPWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                         *puVar4,(ulonglong)*param_4 * 2);
      if (lpBuffer == (LPWSTR)0x0) {
        return 8;
      }
      BVar1 = GetComputerNameExW(ComputerNamePhysicalDnsFullyQualified,lpBuffer,local_res10);
      if ((BVar1 == 0) && (DVar2 = GetLastError(), DVar2 != 0)) {
        if (DVar2 == 0xea) {
          local_28[0] = 0;
          DVar2 = BaseEnumAltDnsFQHostnames((undefined2 *)0x0,local_28);
          if (DVar2 == 0) {
            DVar2 = 0xea;
          }
          *param_4 = local_res10[0] + local_28[0];
        }
      }
      else {
        local_28[0] = (*param_4 - local_res10[0]) - 1;
        DVar2 = BaseEnumAltDnsFQHostnames(lpBuffer + (ulonglong)local_res10[0] + 1,local_28);
        uVar3 = local_28[0] + 1 + local_res10[0];
        *param_4 = uVar3;
        if (DVar2 == 0) {
          memcpy(param_3,lpBuffer,(ulonglong)(uVar3 + 1) * 2);
        }
      }
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpBuffer);
      return DVar2;
    }
  }
  return 0x57;
}



DWORD RemoveLocalAlternateComputerNameA(LPCSTR param_1,int param_2)

{
  DWORD DVar1;
  LPCWSTR local_res8;
  
                    // 0x5a680  1218  RemoveLocalAlternateComputerNameA
  local_res8 = (LPCWSTR)0x0;
  if (param_1 == (LPCSTR)0x0) {
    DVar1 = 0x57;
  }
  else {
    DVar1 = FUN_180059c0c(param_1,&local_res8);
    if (DVar1 == 0) {
      DVar1 = RemoveLocalAlternateComputerNameW(local_res8,param_2);
    }
    BaseFreeAppCompatDataForProcessWorker((longlong)local_res8);
  }
  return DVar1;
}



DWORD RemoveLocalAlternateComputerNameW(LPCWSTR param_1,int param_2)

{
  bool bVar1;
  bool bVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  DWORD DVar6;
  BOOL BVar7;
  undefined4 *puVar8;
  short *psVar9;
  wchar_t *ComputerName;
  ulonglong uVar10;
  undefined8 uVar11;
  longlong in_GS_OFFSET;
  uint local_res10 [2];
  uint local_res18 [2];
  uint local_res20 [2];
  
                    // 0x5a6e0  1219  RemoveLocalAlternateComputerNameW
  local_res18[0] = 0;
  if ((param_2 == 0) && (param_1 != (LPCWSTR)0x0)) {
    local_res20[0] = 0;
    local_res10[0] = 0;
    iVar3 = FUN_18007d8f0(0,(undefined *)
                            L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\DnsCache\\Parameters"
                          ,L"AlternateComputerNames",(void *)0x0,local_res10);
    if (iVar3 == -0x7ffffffb) {
      puVar8 = (undefined4 *)KernelBaseGetGlobalData();
      psVar9 = (short *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                        *puVar8,(ulonglong)local_res10[0] * 2);
      if (psVar9 == (short *)0x0) {
        iVar3 = -0x3fffffe9;
      }
      else {
        iVar3 = FUN_18007d8f0(0,(undefined *)
                                L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\DnsCache\\Parameters"
                              ,L"AlternateComputerNames",psVar9,local_res10);
        iVar4 = RtlNtStatusToDosError(iVar3);
        bVar2 = false;
        if (iVar4 == 0) {
          do {
            bVar1 = bVar2;
            uVar5 = FUN_1800597e4(psVar9,param_1,local_res20);
            if (uVar5 != 0) break;
            uVar5 = FUN_180059f58(psVar9,local_res20[0],local_res10);
            bVar1 = true;
            bVar2 = true;
          } while (uVar5 == 0);
          if (bVar1) {
            uVar10 = FUN_18005a0bc(L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\DnsCache\\Parameters"
                                   ,L"AlternateComputerNames",psVar9,local_res10[0] * 2 + 2);
            iVar3 = (int)uVar10;
          }
          else {
            iVar3 = -0x3ffffddb;
          }
        }
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,psVar9);
      }
    }
    DVar6 = RtlNtStatusToDosError(iVar3);
    if (((DVar6 == 0) &&
        (BVar7 = DnsHostnameToComputerNameW(param_1,(LPWSTR)0x0,local_res18), BVar7 == 0)) &&
       (DVar6 = GetLastError(), DVar6 == 0xea)) {
      local_res18[0] = local_res18[0] + 1;
      uVar10 = (ulonglong)local_res18[0];
      puVar8 = (undefined4 *)KernelBaseGetGlobalData();
      ComputerName = (wchar_t *)
                     RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                     *puVar8,uVar10 * 2);
      if (ComputerName == (wchar_t *)0x0) {
        DVar6 = 8;
      }
      else {
        BVar7 = DnsHostnameToComputerNameW(param_1,ComputerName,local_res18);
        if ((BVar7 == 0) ||
           ((uVar10 = FUN_1800599c4(ComputerName), (int)uVar10 == 0 &&
            (uVar11 = FUN_180059df4(ComputerName), (int)uVar11 == 0)))) {
          DVar6 = GetLastError();
        }
        else {
          DVar6 = 0;
        }
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,ComputerName);
      }
    }
  }
  else {
    DVar6 = 0x57;
  }
  return DVar6;
}



DWORD SetLocalPrimaryComputerNameA(LPCSTR param_1,int param_2)

{
  DWORD DVar1;
  wchar_t *local_res8;
  
                    // 0x5a930  1347  SetLocalPrimaryComputerNameA
  local_res8 = (wchar_t *)0x0;
  if (param_1 == (LPCSTR)0x0) {
    DVar1 = 0x57;
  }
  else {
    DVar1 = FUN_180059c0c(param_1,&local_res8);
    if (DVar1 == 0) {
      DVar1 = SetLocalPrimaryComputerNameW(local_res8,param_2);
    }
    BaseFreeAppCompatDataForProcessWorker((longlong)local_res8);
  }
  return DVar1;
}



DWORD SetLocalPrimaryComputerNameW(wchar_t *param_1,int param_2)

{
  bool bVar1;
  BOOL BVar2;
  DWORD DVar3;
  wchar_t *lpBuffer;
  wchar_t *lpBuffer_00;
  undefined7 extraout_var;
  undefined4 *puVar4;
  wchar_t *pwVar5;
  undefined8 uVar6;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  longlong in_GS_OFFSET;
  uint local_res8 [2];
  uint local_res18 [2];
  
                    // 0x5a990  1348  SetLocalPrimaryComputerNameW
  DVar3 = 0;
  local_res8[0] = 0;
  local_res18[0] = 0;
  lpBuffer = FUN_180059ce8(param_1,0);
  lpBuffer_00 = FUN_180059ce8(param_1,1);
  if ((param_1 != (wchar_t *)0x0) && (param_2 == 0)) {
    bVar1 = FUN_1800598bc(param_1);
    if ((int)CONCAT71(extraout_var,bVar1) != 0) {
      BVar2 = GetComputerNameExW(ComputerNamePhysicalNetBIOS,(LPWSTR)0x0,local_res8);
      if ((BVar2 == 0) && (DVar3 = GetLastError(), DVar3 == 0xea)) {
        puVar4 = (undefined4 *)KernelBaseGetGlobalData();
        pwVar5 = (wchar_t *)
                 RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),*puVar4,
                                 (ulonglong)local_res8[0] * 2);
        if (pwVar5 == (wchar_t *)0x0) {
          DVar3 = 8;
        }
        else {
          BVar2 = GetComputerNameExW(ComputerNamePhysicalNetBIOS,pwVar5,local_res8);
          if ((BVar2 == 0) || (uVar6 = BaseSetAltNetBiosName(pwVar5), (int)uVar6 == 0)) {
            DVar3 = GetLastError();
          }
          else {
            DVar3 = 0;
          }
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pwVar5);
        }
      }
      pwVar5 = FUN_18007d998(4);
      if (pwVar5 != (wchar_t *)0x0) {
        uVar6 = BaseSetAltNetBiosName(pwVar5);
        if ((int)uVar6 == 0) {
          DVar3 = GetLastError();
        }
        else {
          DVar3 = 0;
        }
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pwVar5);
      }
      if (DVar3 == 0) {
        BVar2 = GetComputerNameExW(ComputerNamePhysicalDnsFullyQualified,(LPWSTR)0x0,local_res18);
        if (BVar2 == 0) {
          DVar3 = GetLastError();
          if (DVar3 == 0xea) {
            puVar4 = (undefined4 *)KernelBaseGetGlobalData();
            pwVar5 = (wchar_t *)
                     RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                     *puVar4,(ulonglong)local_res18[0] * 2);
            if (pwVar5 == (wchar_t *)0x0) {
              DVar3 = 8;
              goto LAB_18005ace7;
            }
            BVar2 = GetComputerNameExW(ComputerNamePhysicalDnsFullyQualified,pwVar5,local_res18);
            if ((BVar2 == 0) ||
               (bVar1 = FUN_18005a030(pwVar5), (int)CONCAT71(extraout_var_00,bVar1) == 0)) {
              DVar3 = GetLastError();
            }
            else {
              DVar3 = 0;
            }
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pwVar5);
          }
          if (DVar3 != 0) goto LAB_18005ace7;
        }
        pwVar5 = FUN_18007d998(7);
        if (pwVar5 != (wchar_t *)0x0) {
          bVar1 = FUN_18005a030(pwVar5);
          if ((int)CONCAT71(extraout_var_01,bVar1) == 0) {
            DVar3 = GetLastError();
          }
          else {
            DVar3 = 0;
          }
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pwVar5);
          if (DVar3 != 0) goto LAB_18005ace7;
        }
        BVar2 = SetComputerNameExW(ComputerNamePhysicalDnsHostname,lpBuffer);
        if (((BVar2 != 0) || (DVar3 = GetLastError(), DVar3 == 0)) &&
           ((BVar2 = SetComputerNameExW(ComputerNamePhysicalDnsDomain,lpBuffer_00), BVar2 != 0 ||
            (DVar3 = GetLastError(), DVar3 == 0)))) {
          DVar3 = RemoveLocalAlternateComputerNameW(param_1,0);
        }
      }
LAB_18005ace7:
      if (lpBuffer != (wchar_t *)0x0) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpBuffer);
      }
      if (lpBuffer_00 == (wchar_t *)0x0) {
        return DVar3;
      }
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpBuffer_00);
      return DVar3;
    }
    if (lpBuffer != (wchar_t *)0x0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpBuffer);
    }
    if (lpBuffer_00 != (wchar_t *)0x0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpBuffer_00);
    }
  }
  return 0x57;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Could not reconcile some variable overlaps

void FUN_18005ad3c(undefined *param_1)

{
  code *pcVar1;
  short sVar2;
  DWORD DVar3;
  int iVar4;
  BOOL BVar5;
  HANDLE hFindVolume;
  ulonglong uVar6;
  WCHAR *pWVar7;
  ulonglong uVar8;
  longlong lVar9;
  undefined auStack1160 [32];
  undefined local_468 [14];
  WCHAR aWStack1114 [5];
  WCHAR local_450 [260];
  WCHAR local_248 [264];
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack1160;
  hFindVolume = FindFirstVolumeW(aWStack1114 + 1,0x104);
  if (hFindVolume == (HANDLE)0xffffffffffffffff) {
    GetLastError();
  }
  else {
    uVar8 = 0xffffffffffffffff;
    do {
      uVar6 = uVar8 + 1;
      lVar9 = uVar8 + 2;
      uVar8 = uVar6;
    } while (aWStack1114[lVar9] != L'\0');
    while( true ) {
      if (0x207 < (uVar6 & 0xffff) * 2 - 2) {
        __report_rangecheckfailure();
        pcVar1 = (code *)swi(3);
        (*pcVar1)();
        return;
      }
      aWStack1114[uVar6 & 0xffff] = L'\0';
      DVar3 = QueryDosDeviceW(local_450,local_248,0x104);
      if ((short)DVar3 == 0) break;
      pWVar7 = local_248;
      _local_468 = ZEXT816(0);
      lVar9 = 0x7fff;
      do {
        if (*pWVar7 == L'\0') break;
        pWVar7 = pWVar7 + 1;
        lVar9 = lVar9 + -1;
      } while (lVar9 != 0);
      if (lVar9 == 0) goto LAB_18005aee4;
      sVar2 = (-(ushort)(lVar9 != 0) & 0x7fffU - (short)lVar9) * 2;
      _local_468 = CONCAT88(local_248,local_468._0_8_);
      if ((lVar9 == 0) || (iVar4 = (*(code *)param_1)(), iVar4 != 0)) goto LAB_18005aee4;
      BVar5 = FindNextVolumeW(hFindVolume,aWStack1114 + 1,0x104);
      if (BVar5 == 0) {
        GetLastError();
        goto LAB_18005aee4;
      }
      uVar8 = 0xffffffffffffffff;
      do {
        uVar6 = uVar8 + 1;
        lVar9 = uVar8 + 2;
        uVar8 = uVar6;
      } while (aWStack1114[lVar9] != L'\0');
    }
    GetLastError();
LAB_18005aee4:
    FindVolumeClose(hFindVolume);
  }
  __security_check_cookie(local_38 ^ (ulonglong)auStack1160);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18005af30(ushort *param_1,undefined8 *param_2)

{
  longlong *plVar1;
  ulonglong *puVar2;
  undefined4 *puVar3;
  undefined2 *puVar4;
  longlong lVar5;
  uint uVar6;
  ulonglong uVar7;
  ulonglong uVar8;
  undefined local_38 [8];
  undefined4 uStack48;
  undefined4 uStack44;
  undefined local_28 [8];
  undefined4 uStack32;
  undefined4 uStack28;
  undefined local_18 [16];
  
  plVar1 = param_2 + 1;
  puVar4 = (undefined2 *)*plVar1;
  puVar2 = param_2 + 2;
  uVar7 = FUN_18005b638(puVar4,*puVar2,param_1,plVar1,(longlong *)puVar2);
  uVar8 = uVar7 & 0xffffffff;
  if (-1 < (int)uVar7) {
    *plVar1 = *plVar1 + 2;
    *puVar2 = *puVar2 - 2;
    _local_28 = ZEXT816(puVar4) << 0x40;
    local_18 = ZEXT216(*param_1) << 0x40;
    _local_38 = ZEXT816(0);
    uVar6 = NtQueryInformationJobObject(*param_2,0x1f,local_38,0x30,0);
    uVar8 = (ulonglong)uVar6;
    if (-1 < (int)uVar6) {
      uVar7 = (ulonglong)*(uint *)(param_2 + 4);
      lVar5 = param_2[3];
      puVar3 = (undefined4 *)(lVar5 + uVar7 * 0x28);
      *puVar3 = local_38._0_4_;
      puVar3[1] = local_38._4_4_;
      puVar3[2] = uStack48;
      puVar3[3] = uStack44;
      puVar3 = (undefined4 *)(lVar5 + 0x10 + uVar7 * 0x28);
      *puVar3 = local_28._0_4_;
      puVar3[1] = local_28._4_4_;
      puVar3[2] = uStack32;
      puVar3[3] = uStack28;
      *(undefined8 *)(lVar5 + 0x20 + uVar7 * 0x28) = local_18._0_8_;
      *(int *)(param_2 + 4) = *(int *)(param_2 + 4) + 1;
    }
  }
  RtlNtStatusToDosError(uVar8);
  return;
}



int FUN_18005b024(undefined8 param_1,LPVOID *param_2,undefined4 *param_3)

{
  int iVar1;
  LPVOID pvStack32;
  
  pvStack32 = (LPVOID)0x0;
  while( true ) {
    if (pvStack32 != (LPVOID)0x0) {
      FUN_180025ab0(pvStack32);
    }
    pvStack32 = (LPVOID)0x0;
    iVar1 = FUN_18005ad3c(FUN_180021480);
    if (iVar1 != 0) goto LAB_18005b0fe;
    pvStack32 = (LPVOID)FUN_180025a70(0);
    if (pvStack32 == (LPVOID)0x0) break;
    iVar1 = FUN_18005ad3c(FUN_18005af30);
    if (((iVar1 != 0) && (iVar1 != 0x7a)) || (iVar1 != 0x7a)) goto LAB_18005b0f4;
  }
  iVar1 = 0xe;
LAB_18005b0f4:
  if (iVar1 != 0) {
LAB_18005b0fe:
    if (pvStack32 != (LPVOID)0x0) {
      FUN_180025ab0(pvStack32);
    }
    if (iVar1 != 0) {
      return iVar1;
    }
  }
  *param_2 = pvStack32;
  *param_3 = 0;
  return iVar1;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18005b140(undefined8 param_1,short *param_2,LPVOID *param_3)

{
  uint uVar1;
  short *psVar2;
  undefined4 *puVar3;
  ulonglong uVar4;
  longlong lVar5;
  ulonglong uVar6;
  ushort uVar7;
  undefined local_68 [16];
  undefined local_58 [8];
  undefined4 uStack80;
  undefined4 uStack76;
  undefined local_48 [8];
  undefined4 uStack64;
  undefined4 uStack60;
  undefined local_38 [16];
  
  uVar6 = 0;
  _local_58 = ZEXT816(0);
  _local_48 = ZEXT816(0);
  local_38 = ZEXT816(0);
  local_68 = ZEXT816(0);
  if (param_2 == (short *)0x0) {
LAB_18005b1dc:
    uVar7 = 0;
  }
  else {
    lVar5 = 0x7fff;
    psVar2 = param_2;
    do {
      if (*psVar2 == 0) break;
      psVar2 = psVar2 + 1;
      lVar5 = lVar5 + -1;
    } while (lVar5 != 0);
    uVar6 = (ulonglong)(~-(uint)(lVar5 != 0) & 0xc000000d);
    if (lVar5 == 0) goto LAB_18005b1dc;
    uVar7 = (-(ushort)(lVar5 != 0) & 0x7fffU - (short)lVar5) * 2;
    local_68 = ZEXT816(param_2) << 0x40;
  }
  if (-1 < (int)uVar6) {
    puVar3 = (undefined4 *)FUN_180025a70((ulonglong)uVar7 + 0x2a);
    uVar4 = FUN_18005b5b0((undefined2 *)(puVar3 + 10),(ulonglong)uVar7 + 2,(ushort *)local_68);
    uVar6 = uVar4 & 0xffffffff;
    if (-1 < (int)uVar4) {
      _local_48 = CONCAT88(puVar3 + 10,local_48);
      uVar1 = NtQueryInformationJobObject(param_1,0x1f,local_58,0x30,0);
      uVar6 = (ulonglong)uVar1;
      if (-1 < (int)uVar1) {
        *puVar3 = local_58._0_4_;
        puVar3[1] = local_58._4_4_;
        puVar3[2] = uStack80;
        puVar3[3] = uStack76;
        puVar3[4] = local_48._0_4_;
        puVar3[5] = local_48._4_4_;
        puVar3[6] = uStack64;
        puVar3[7] = uStack60;
        *(undefined8 *)(puVar3 + 8) = local_38._0_8_;
        *param_3 = puVar3;
        goto LAB_18005b26c;
      }
    }
    if (puVar3 != (undefined4 *)0x0) {
      FUN_180025ab0(puVar3);
    }
  }
LAB_18005b26c:
  RtlNtStatusToDosError(uVar6);
  return;
}



HANDLE CreateJobObjectA(LPSECURITY_ATTRIBUTES lpJobAttributes,LPCSTR lpName)

{
  LPCWSTR pWVar1;
  undefined8 uVar2;
  HANDLE pvVar3;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x5b2a0  213  CreateJobObjectA
  pWVar1 = (LPCWSTR)lpName;
  if ((lpName == (LPCSTR)0x0) ||
     (uVar2 = Basep8BitStringToDynamicUnicodeString(), pWVar1 = local_10, (int)uVar2 != 0)) {
    local_10 = pWVar1;
    pvVar3 = CreateJobObjectW(lpJobAttributes,local_10);
    if (lpName != (LPCSTR)0x0) {
      RtlFreeUnicodeString(local_18);
    }
  }
  else {
    pvVar3 = (HANDLE)0x0;
  }
  return pvVar3;
}



BOOL CreateJobSet(ULONG NumJob,PJOB_SET_ARRAY UserJobSet,ULONG Flags)

{
  int iVar1;
  undefined4 in_register_0000000c;
  
                    // 0x5b310  215  CreateJobSet
  iVar1 = NtCreateJobSet(CONCAT44(in_register_0000000c,NumJob));
  if (-1 >= iVar1) {
    BaseSetLastNTError();
  }
  return (uint)(-1 < iVar1);
}



void FreeMemoryJobObject(LPVOID param_1)

{
  HANDLE hHeap;
  
  hHeap = GetProcessHeap();
                    // WARNING: Could not recover jumptable at 0x000180025ad2. Too many branches
                    // WARNING: Treating indirect jump as call
  HeapFree(hHeap,0,param_1);
  return;
                    // 0x5b340  440  FreeMemoryJobObject
}



HANDLE OpenJobObjectA(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCSTR lpName)

{
  LPCWSTR pWVar1;
  undefined8 uVar2;
  HANDLE pvVar3;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x5b350  1036  OpenJobObjectA
  pWVar1 = (LPCWSTR)lpName;
  if ((lpName == (LPCSTR)0x0) ||
     (uVar2 = Basep8BitStringToDynamicUnicodeString(), pWVar1 = local_10, (int)uVar2 != 0)) {
    local_10 = pWVar1;
    pvVar3 = OpenJobObjectW(dwDesiredAccess,bInheritHandle,local_10);
    if (lpName != (LPCSTR)0x0) {
      RtlFreeUnicodeString(local_18);
    }
  }
  else {
    pvVar3 = (HANDLE)0x0;
  }
  return pvVar3;
}



HANDLE OpenJobObjectW(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCWSTR lpName)

{
  int iVar1;
  undefined8 local_res18;
  HANDLE local_res20;
  undefined local_48 [16];
  undefined4 local_38 [2];
  undefined8 local_30;
  undefined *local_28;
  uint local_20;
  undefined local_18 [16];
  
                    // 0x5b3d0  1037  OpenJobObjectW
  if (lpName != (LPCWSTR)0x0) {
    RtlInitUnicodeString(local_48,lpName);
    iVar1 = BaseGetNamedObjectDirectory(&local_res18);
    if (-1 < iVar1) {
      local_30 = local_res18;
      local_38[0] = 0x30;
      local_18 = ZEXT816(0);
      local_20 = -(uint)(bInheritHandle != 0) & 2;
      local_28 = local_48;
      BasepAdjustObjectAttributesForPrivateNamespace(local_38);
      iVar1 = NtOpenJobObject(&local_res20,dwDesiredAccess,local_38);
      if (-1 < iVar1) {
        return local_res20;
      }
    }
  }
  BaseSetLastNTError();
  return (HANDLE)0x0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void QueryIoRateControlInformationJobObject
               (undefined8 param_1,short *param_2,LPVOID *param_3,undefined4 *param_4)

{
  REGHANDLE RegHandle;
  int iVar1;
  ulonglong uVar2;
  LPVOID *ppvVar3;
  undefined4 *puVar4;
  undefined auStackY152 [32];
  uint local_68 [2];
  _EVENT_DATA_DESCRIPTOR local_60 [2];
  uint *local_40;
  undefined8 local_38;
  ulonglong local_30;
  
                    // 0x5b4a0  1105  QueryIoRateControlInformationJobObject
  local_30 = DAT_1800b2220 ^ (ulonglong)auStackY152;
  ppvVar3 = param_3;
  puVar4 = param_4;
  FUN_18001b7a4(&DAT_1800b2090);
  if (5 < _DAT_1800b2090) {
    uVar2 = FUN_1800410b8((longlong)&DAT_1800b2090);
    if ((char)uVar2 != '\0') {
      local_38 = 4;
      local_68[0] = (uint)(param_2 != (short *)0x0);
      local_40 = local_68;
      FUN_1800410e4((longlong)&DAT_1800b2090,&DAT_180087ea2,ppvVar3,puVar4,3,local_60);
    }
  }
  RegHandle = DAT_1800b20b0;
  DAT_1800b20b0 = 0;
  _DAT_1800b2090 = 0;
  EventUnregister(RegHandle);
  if (param_2 == (short *)0x0) {
    iVar1 = FUN_18005b024(param_1,param_3,param_4);
  }
  else {
    iVar1 = FUN_18005b140(param_1,param_2,param_3);
    *param_4 = 1;
  }
  RtlSetLastWin32Error(iVar1);
  __security_check_cookie(local_30 ^ (ulonglong)auStackY152);
  return;
}



ulonglong FUN_18005b5b0(undefined2 *param_1,ulonglong param_2,ushort *param_3)

{
  uint uVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  ulonglong local_res10 [2];
  longlong local_res20;
  
  uVar1 = 0;
  if (0x7ffe < (param_2 >> 1) - 1) {
    uVar1 = 0xc000000d;
  }
  uVar3 = (ulonglong)uVar1;
  if (-1 < (int)uVar1) {
    uVar2 = FUN_18005b7bc(param_3,&local_res20,local_res10);
    uVar3 = uVar2 & 0xffffffff;
    if ((int)uVar2 < 0) {
      *param_1 = 0;
    }
    else {
      uVar1 = RtlStringCopyWideCharArrayWorker
                        (param_1,param_2 >> 1,(longlong *)0x0,local_res20,local_res10[0]);
      uVar3 = (ulonglong)uVar1;
    }
  }
  return uVar3;
}



ulonglong FUN_18005b638(undefined2 *param_1,ulonglong param_2,ushort *param_3,longlong *param_4,
                       longlong *param_5)

{
  uint uVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  ulonglong local_res10;
  longlong local_28;
  longlong local_20;
  
  uVar2 = 0;
  uVar3 = param_2 >> 1;
  uVar5 = 0xc000000d;
  if (0x7ffe < uVar3 - 1) {
    uVar2 = 0xc000000d;
  }
  if ((int)uVar2 < 0) {
    return uVar2;
  }
  uVar2 = FUN_18005b7bc(param_3,&local_20,&local_res10);
  uVar4 = uVar2 & 0xffffffff;
  if ((int)uVar2 < 0) {
    if (uVar3 != 0) {
      *param_1 = 0;
    }
LAB_18005b6f7:
    if (-1 < (int)uVar4) goto LAB_18005b705;
  }
  else {
    if (uVar3 == 0) {
      if (local_res10 != 0) {
        if (param_1 == (undefined2 *)0x0) {
          return uVar5 & 0xffffffff;
        }
        uVar4 = 0x80000005;
      }
      goto LAB_18005b6f7;
    }
    local_28 = 0;
    uVar1 = RtlStringCopyWideCharArrayWorker(param_1,uVar3,&local_28,local_20,local_res10);
    uVar4 = (ulonglong)uVar1;
    uVar3 = uVar3 - local_28;
    param_1 = param_1 + local_28;
    if (-1 < (int)uVar1) goto LAB_18005b6f7;
  }
  if ((int)uVar4 != -0x7ffffffb) {
    return uVar4;
  }
LAB_18005b705:
  if (param_4 != (longlong *)0x0) {
    *param_4 = (longlong)param_1;
  }
  if (param_5 != (longlong *)0x0) {
    *param_5 = (ulonglong)((uint)param_2 & 1) + uVar3 * 2;
  }
  return uVar4;
}



// Library Function - Single Match
//  RtlStringCopyWideCharArrayWorker
// 
// Library: Visual Studio 2019 Release

uint RtlStringCopyWideCharArrayWorker
               (undefined2 *param_1,longlong param_2,longlong *param_3,longlong param_4,
               longlong param_5)

{
  undefined2 *puVar1;
  longlong lVar2;
  longlong lVar3;
  
  lVar3 = 0;
  if (param_2 != 0) {
    lVar2 = param_4 - (longlong)param_1;
    do {
      if (param_5 == 0) break;
      param_5 = param_5 + -1;
      *param_1 = *(undefined2 *)(lVar2 + (longlong)param_1);
      lVar3 = lVar3 + 1;
      param_1 = param_1 + 1;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
  }
  puVar1 = param_1 + -1;
  if (param_2 != 0) {
    puVar1 = param_1;
  }
  *puVar1 = 0;
  if (param_3 != (longlong *)0x0) {
    lVar2 = lVar3 + -1;
    if (param_2 != 0) {
      lVar2 = lVar3;
    }
    *param_3 = lVar2;
  }
  return ~-(uint)(param_2 != 0) & 0x80000005;
}



undefined8 FUN_18005b7bc(ushort *param_1,longlong *param_2,ulonglong *param_3)

{
  byte bVar1;
  ushort uVar2;
  longlong lVar3;
  undefined8 uVar4;
  
  uVar4 = 0;
  bVar1 = *(byte *)param_1;
  *param_2 = 0;
  *param_3 = 0;
  if ((((((bVar1 & 1) == 0) && (uVar2 = param_1[1], (uVar2 & 1) == 0)) &&
       (*param_1 < uVar2 || *param_1 == uVar2)) && (uVar2 != 0xffff)) &&
     ((lVar3 = *(longlong *)(param_1 + 4), lVar3 != 0 || ((*param_1 == 0 && (uVar2 == 0)))))) {
    *param_3 = (ulonglong)(*param_1 >> 1);
    *param_2 = lVar3;
  }
  else {
    uVar4 = 0xc000000d;
  }
  return uVar4;
}



// WARNING: Could not reconcile some variable overlaps
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void SetIoRateControlInformationJobObject
               (undefined8 param_1,undefined8 *param_2,longlong param_3,undefined8 param_4)

{
  REGHANDLE RegHandle;
  undefined4 uVar1;
  short *psVar2;
  ulonglong uVar3;
  ushort uVar4;
  undefined *puVar5;
  longlong lVar6;
  uint uVar7;
  undefined auStackY296 [32];
  undefined2 local_f8 [2];
  undefined4 local_f4;
  undefined8 local_f0;
  undefined8 local_e8;
  undefined8 local_e0;
  short *local_d8;
  undefined4 local_d0;
  undefined4 local_cc;
  ulonglong local_c8;
  undefined8 local_c0;
  undefined8 local_b8;
  undefined local_b0 [24];
  _EVENT_DATA_DESCRIPTOR local_98 [2];
  undefined8 *local_78;
  undefined8 local_70;
  undefined8 *local_68;
  undefined8 local_60;
  undefined *local_58;
  undefined8 local_50;
  undefined4 *local_48;
  undefined8 local_40;
  undefined2 *local_38;
  undefined8 local_30;
  ulonglong local_28;
  
                    // 0x5b820  1344  SetIoRateControlInformationJobObject
  local_28 = DAT_1800b2220 ^ (ulonglong)auStackY296;
  local_f0 = *param_2;
  uVar7 = 0;
  local_e8 = param_2[1];
  local_d0 = *(undefined4 *)(param_2 + 4);
  local_cc = *(undefined4 *)((longlong)param_2 + 0x24);
  local_d8 = (short *)param_2[3];
  local_e0 = 0;
  local_c8 = 0;
  local_b0._0_16_ = ZEXT816(0);
  if (local_d8 != (short *)0x0) {
    lVar6 = 0x7fff;
    psVar2 = local_d8;
    do {
      if (*psVar2 == 0) break;
      psVar2 = psVar2 + 1;
      lVar6 = lVar6 + -1;
    } while (lVar6 != 0);
    param_3 = 0x7fff - lVar6;
    uVar7 = ~-(uint)(lVar6 != 0) & 0xc000000d;
    if (lVar6 != 0) {
      uVar4 = (-(ushort)(lVar6 != 0) & (ushort)param_3) * 2;
      goto LAB_18005b8ce;
    }
  }
  uVar4 = 0;
LAB_18005b8ce:
  if (-1 < (int)uVar7) {
    local_c8 = (ulonglong)uVar4;
    FUN_18001b7a4(&DAT_1800b2090);
    if (5 < _DAT_1800b2090) {
      puVar5 = &DAT_1800b2090;
      uVar3 = FUN_1800410b8((longlong)&DAT_1800b2090);
      if ((char)uVar3 != '\0') {
        local_c0 = local_f0;
        local_78 = &local_c0;
        local_b8 = local_e8;
        local_68 = &local_b8;
        local_b0._0_16_ = CONCAT88(local_b0._8_8_,local_e0);
        local_58 = local_b0;
        local_f4 = local_d0;
        local_48 = &local_f4;
        local_f8[0] = (undefined2)local_c8;
        local_38 = local_f8;
        local_70 = 8;
        local_60 = 8;
        local_50 = 8;
        local_40 = 4;
        local_30 = 2;
        FUN_1800410e4((longlong)puVar5,&DAT_180087e27,param_3,param_4,7,local_98);
      }
    }
    RegHandle = DAT_1800b20b0;
    DAT_1800b20b0 = 0;
    _DAT_1800b2090 = 0;
    EventUnregister(RegHandle);
    uVar7 = NtSetInformationJobObject(param_1,0x1f,&local_f0);
  }
  uVar1 = RtlNtStatusToDosError(uVar7);
  RtlSetLastWin32Error(uVar1);
  __security_check_cookie(local_28 ^ (ulonglong)auStackY296);
  return;
}



void * FUN_18005ba34(uint param_1)

{
  void *_Dst;
  undefined8 uVar1;
  longlong in_GS_OFFSET;
  
  _Dst = (void *)FUN_18005bacc(0x478);
  if (_Dst != (void *)0x0) {
    memset(_Dst,0,0x478);
    *(undefined *)((longlong)_Dst + 0x469) = 1;
    if ((param_1 != 0) &&
       (uVar1 = FUN_18005e448((uint *)((longlong)_Dst + 0x438),param_1), (int)uVar1 == 0)) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,_Dst);
      _Dst = (void *)0x0;
    }
    if (_Dst != (void *)0x0) {
      return _Dst;
    }
  }
  RtlSetLastWin32Error(8);
  return _Dst;
}



void FUN_18005bacc(undefined4 param_1)

{
  int *piVar1;
  longlong in_GS_OFFSET;
  
  piVar1 = (int *)KernelBaseGetGlobalData();
                    // WARNING: Could not recover jumptable at 0x00018005bafd. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),*piVar1 + 0x40000,
                  param_1);
  return;
}



void FUN_18005bb10(HANDLE param_1,longlong param_2)

{
  longlong *plVar1;
  bool bVar2;
  bool bVar3;
  DWORD DVar4;
  int iVar5;
  undefined8 uVar6;
  longlong lVar7;
  uint uVar8;
  uint uVar9;
  ulonglong uVar10;
  undefined auStack168 [32];
  undefined *local_88;
  undefined4 local_80;
  longlong *local_78;
  undefined4 local_70;
  longlong local_68;
  int local_60;
  DWORD local_58;
  DWORD DStack84;
  undefined local_50 [8];
  undefined8 local_48;
  longlong local_40;
  undefined8 local_38;
  ulonglong local_30;
  
  local_30 = DAT_1800b2220 ^ (ulonglong)auStack168;
  uVar10 = 0x1000;
  bVar3 = false;
  bVar2 = false;
  local_58 = GetFileSize(param_1,&DStack84);
  if ((local_58 != 0xffffffff) || (DVar4 = GetLastError(), DVar4 == 0)) {
    local_38 = CONCAT44(DStack84,local_58);
    local_40 = 0;
    while( true ) {
      uVar9 = (uint)uVar10;
      uVar6 = FUN_18005e448((uint *)(param_2 + 0x438),uVar9);
      if ((int)uVar6 == 0) break;
      local_48 = 0;
      local_60 = uVar9 - *(uint *)(param_2 + 0x448);
      local_68 = (ulonglong)*(uint *)(param_2 + 0x448) + *(longlong *)(param_2 + 0x440);
      local_78 = &local_40;
      local_70 = 0x10;
      local_88 = local_50;
      local_80 = 0x940cf;
      iVar5 = NtFsControlFile(param_1);
      lVar7 = CONCAT44(DStack84,local_58);
      if (((iVar5 + 0x80000000U & 0x80000000) != 0) || (iVar5 == -0x7ffffffb)) {
        if (((int)local_48 == 0) &&
           (((-1 < iVar5 && (local_40 == 0)) && (bVar2 = bVar3, 0 < lVar7)))) {
          bVar3 = true;
          bVar2 = true;
        }
        *(int *)(param_2 + 0x448) = *(int *)(param_2 + 0x448) + (int)local_48;
        local_40 = *(longlong *)
                    (((ulonglong)*(uint *)(param_2 + 0x448) - 8) + *(longlong *)(param_2 + 0x440)) +
                   *(longlong *)
                    (((ulonglong)*(uint *)(param_2 + 0x448) - 0x10) + *(longlong *)(param_2 + 0x440)
                    );
      }
      uVar8 = *(uint *)(param_2 + 0x448);
      if ((ulonglong)uVar8 + 0x10 <= uVar10) {
        if (iVar5 < 0) goto LAB_18005bc7e;
        goto LAB_18005bc88;
      }
      uVar10 = (ulonglong)(uVar9 + 0x1000);
    }
    lVar7 = CONCAT44(DStack84,local_58);
LAB_18005bc7e:
    *(undefined4 *)(param_2 + 0x448) = 0;
    uVar8 = 0;
LAB_18005bc88:
    if (((bVar2) || (0xf < uVar8)) &&
       ((plVar1 = *(longlong **)(param_2 + 0x440), bVar2 || ((*plVar1 != 0 || (plVar1[1] != lVar7)))
        ))) {
      uVar8 = uVar8 + 0x10;
      *(uint *)(param_2 + 0x448) = uVar8;
      *(undefined8 *)(((ulonglong)uVar8 - 8) + (longlong)plVar1) = 0;
      *(longlong *)(((ulonglong)uVar8 - 0x10) + (longlong)plVar1) = lVar7;
      *(undefined *)(param_2 + 0x450) = 1;
    }
    else {
      *(undefined4 *)(param_2 + 0x448) = 0;
    }
  }
  __security_check_cookie(local_30 ^ (ulonglong)auStack168);
  return;
}



BOOL BackupRead(HANDLE hFile,LPBYTE lpBuffer,DWORD nNumberOfBytesToRead,LPDWORD lpNumberOfBytesRead,
               BOOL bAbort,BOOL bProcessSecurity,LPVOID *lpContext)

{
  int iVar1;
  BOOL extraout_EAX;
  int iVar2;
  undefined8 *puVar3;
  undefined8 uVar4;
  longlong lVar5;
  uint uVar6;
  ulonglong uVar7;
  undefined auStack200 [32];
  undefined4 local_a8;
  LPBYTE local_98;
  LPDWORD local_90;
  DWORD local_88;
  undefined local_84;
  undefined4 local_50;
  ulonglong local_48;
  
                    // 0x5bd10  39  BackupRead
  local_48 = DAT_1800b2220 ^ (ulonglong)auStack200;
  puVar3 = (undefined8 *)*lpContext;
  local_84 = (undefined)bProcessSecurity;
  local_98 = lpBuffer;
  local_90 = lpNumberOfBytesRead;
  local_88 = nNumberOfBytesToRead;
  if (bAbort == 0) {
    *lpNumberOfBytesRead = 0;
    if ((puVar3 == (undefined8 *)0xffffffffffffffff) || (nNumberOfBytesToRead == 0))
    goto LAB_18005bd70;
    if (puVar3 == (undefined8 *)0x0) {
      puVar3 = (undefined8 *)FUN_18005ba34(0x400);
      if (puVar3 == (undefined8 *)0x0) goto LAB_18005bd70;
      local_a8 = 4;
      iVar2 = NtQueryInformationFile();
      if (iVar2 < 0) {
        BaseSetLastNTError();
        goto LAB_18005bd70;
      }
      *(undefined4 *)((longlong)puVar3 + 0x46c) = local_50;
    }
    else if (*(int *)(&DAT_18008a588 + (ulonglong)*(uint *)(puVar3 + 0x85) * 4) == 0)
    goto LAB_18005bd5e;
    *lpContext = puVar3;
    do {
      if (*(char *)((longlong)puVar3 + 0x469) == '\0') {
        lVar5 = puVar3[0x84];
      }
      else {
        puVar3[1] = 0;
        puVar3[0x84] = 0;
        *(undefined4 *)((longlong)puVar3 + 0x44c) = 0;
        *(undefined4 *)(puVar3 + 0x89) = 0;
        lVar5 = 0;
        *(undefined *)((longlong)puVar3 + 0x46a) = 0;
      }
      iVar2 = 1;
      if ((*(char *)((longlong)puVar3 + 0x469) != '\0') ||
         ((longlong)(ulonglong)*(uint *)((longlong)puVar3 + 0x42c) <= lVar5)) {
        iVar1 = *(int *)(&DAT_18008a588 + (ulonglong)*(uint *)(puVar3 + 0x85) * 4);
        if (iVar1 == 1) {
          iVar2 = FUN_18005c3c0(hFile,(int *)puVar3,&local_98);
        }
        else if (iVar1 == 2) {
          uVar4 = FUN_18005c4dc(hFile,(int *)puVar3,&local_98);
          iVar2 = (int)uVar4;
        }
        else if (iVar1 == 3) {
          uVar4 = FUN_18005ca6c(hFile,(int *)puVar3,&local_98);
          iVar2 = (int)uVar4;
        }
        else if (iVar1 == 4) {
          iVar2 = FUN_18005bff8(hFile,(int *)puVar3,&local_98);
        }
        else if (iVar1 == 7) {
          uVar4 = FUN_18005c7c8(hFile,(int *)puVar3,&local_98);
          iVar2 = (int)uVar4;
        }
        else if (iVar1 == 8) {
          uVar4 = FUN_18005c8bc(hFile,puVar3,&local_98);
          iVar2 = (int)uVar4;
        }
        else if (iVar1 == 10) {
          uVar4 = FUN_18005cd40(hFile,(int *)puVar3,&local_98);
          iVar2 = (int)uVar4;
        }
        else if (iVar1 == 0xb) {
          iVar2 = FUN_18005c610(hFile,(int *)puVar3,&local_98);
        }
        else {
          *(undefined *)((longlong)puVar3 + 0x469) = 1;
          *(uint *)(puVar3 + 0x85) = *(uint *)(puVar3 + 0x85) + 1;
        }
      }
      uVar7 = (ulonglong)*(uint *)((longlong)puVar3 + 0x42c);
      lVar5 = puVar3[0x84];
      if (lVar5 < (longlong)uVar7) {
        uVar6 = local_88;
        if ((longlong)(uVar7 - lVar5) < (longlong)(ulonglong)local_88) {
          uVar6 = *(uint *)((longlong)puVar3 + 0x42c) - (int)lVar5;
        }
        memcpy(local_98,(void *)(lVar5 + (longlong)puVar3),(ulonglong)uVar6);
        puVar3[0x84] = puVar3[0x84] + (ulonglong)uVar6;
        local_88 = local_88 - uVar6;
        *local_90 = *local_90 + uVar6;
        local_98 = local_98 + uVar6;
        uVar7 = (ulonglong)*(uint *)((longlong)puVar3 + 0x42c);
        lVar5 = puVar3[0x84];
      }
      if ((((longlong)uVar7 <= lVar5) && (uVar4 = FUN_18005d0c4((int *)puVar3), (int)uVar4 == 0)) ||
         (iVar2 == 0)) goto LAB_18005bd70;
    } while ((*(int *)(&DAT_18008a588 + (ulonglong)*(uint *)(puVar3 + 0x85) * 4) != 0) &&
            (local_88 != 0));
    if (*local_90 == 0) {
      FUN_18005e4d8(hFile);
      FUN_18005e3bc((longlong *)lpContext);
    }
  }
  else {
    if (puVar3 == (undefined8 *)0x0) goto LAB_18005bd70;
LAB_18005bd5e:
    FUN_18005e4d8(hFile);
    FUN_18005e3bc((longlong *)lpContext);
  }
LAB_18005bd70:
  __security_check_cookie(local_48 ^ (ulonglong)auStack200);
  return extraout_EAX;
}



BOOL FUN_18005bff8(undefined8 param_1,int *param_2,LPVOID *param_3)

{
  uint *puVar1;
  HANDLE *ppvVar2;
  int iVar3;
  BOOL BVar4;
  DWORD DVar5;
  undefined8 uVar6;
  int *piVar7;
  uint uVar8;
  uint local_res10 [2];
  undefined2 local_78;
  undefined2 local_76;
  int *local_70;
  undefined local_68 [16];
  undefined4 local_58 [2];
  undefined8 local_50;
  undefined2 *local_48;
  undefined4 local_40;
  undefined local_38 [16];
  
  if ((*(char *)((longlong)param_2 + 0x471) == '\0') || ((param_2[0x11d] & 0x40000U) != 0)) {
    if (*(char *)((longlong)param_2 + 0x469) == '\0') {
      ppvVar2 = (HANDLE *)(param_2 + 0x10c);
      if (*ppvVar2 == (HANDLE)0xffffffffffffffff) {
        piVar7 = (int *)((ulonglong)(uint)param_2[0x115] + *(longlong *)(param_2 + 0x118));
        *(undefined8 *)(param_2 + 2) = 0;
        local_78 = *(undefined2 *)(piVar7 + 1);
        local_48 = &local_78;
        local_58[0] = 0x30;
        local_40 = 0x40;
        local_38 = ZEXT816(0);
        local_76 = local_78;
        local_70 = piVar7 + 6;
        local_50 = param_1;
        iVar3 = NtOpenFile(ppvVar2,0x100081,local_58,local_68,7,
                           (param_2[0x11b] & 0x400U) << 0xb | 0x4020);
        if (iVar3 < 0) {
          param_2[0x115] = param_2[0x115] + *piVar7;
          if (*piVar7 != 0) {
            param_2[2] = 1;
            *(undefined *)((longlong)param_2 + 0x46a) = 1;
          }
        }
        else {
          BVar4 = LockFile(*ppvVar2,0,0,0xffffffff,0xffffffff);
          if (BVar4 != 0) {
            param_2[1] = 0;
            param_2[4] = piVar7[1];
            param_2[0x10b] = piVar7[1] + 0x14;
            memcpy(param_2 + 5,piVar7 + 6,(ulonglong)(uint)piVar7[1]);
            if (*piVar7 != 0) {
              param_2[0x115] = param_2[0x115] + *piVar7;
              *(undefined *)((longlong)param_2 + 0x46a) = 1;
            }
            if ((uint)piVar7[1] < 0xd) {
              return 1;
            }
            iVar3 = _wcsnicmp((wchar_t *)
                              ((longlong)piVar7 +
                              (((ulonglong)(uint)piVar7[1] - 0xc >> 1) + 0xc) * 2),L":$DATA",6);
            if (iVar3 != 0) {
              return 1;
            }
            *param_2 = 4;
            *(undefined8 *)(param_2 + 0x112) = 0;
            *(undefined *)(param_2 + 0x114) = 0;
            BVar4 = GetFileInformationByHandleEx(*ppvVar2,FileAttributeTagInfo,local_res10,8);
            uVar8 = 0;
            if (BVar4 != 0) {
              uVar8 = local_res10[0];
            }
            if (((uVar8 >> 9 & 1) != 0) &&
               (iVar3 = FUN_18005bb10(*ppvVar2,(longlong)param_2), iVar3 != 0)) {
              *(undefined8 *)(param_2 + 2) = 0;
              param_2[1] = 8;
              return 1;
            }
            DVar5 = GetFileSize(*ppvVar2,(LPDWORD)(param_2 + 3));
            param_2[2] = DVar5;
            return 1;
          }
        }
        RtlSetLastWin32Error(0x20);
        return 0;
      }
      if (((longlong)(ulonglong)(uint)param_2[0x10b] <= *(longlong *)(param_2 + 0x108)) &&
         ((*param_2 == 4 || (*param_2 == 9)))) {
        BVar4 = FUN_18005cbf4(*ppvVar2,param_2,param_3);
        return BVar4;
      }
    }
    else if ((param_2[0x11b] & 0x4010U) != 0x4000) {
      if (*(char *)(param_2 + 0x11a) == '\0') {
        puVar1 = (uint *)(param_2 + 0x116);
        uVar8 = 0x400;
        while( true ) {
          uVar6 = FUN_18005e448(puVar1,uVar8);
          if ((int)uVar6 == 0) {
            return 0;
          }
          iVar3 = NtQueryInformationFile
                            (param_1,&local_78,*(undefined8 *)(param_2 + 0x118),*puVar1,0x16);
          if ((-1 < iVar3) && (local_70 != (int *)0x0)) break;
          if ((iVar3 != -0x7ffffffb) && (iVar3 != -0x3fffffdd)) {
            return 1;
          }
          uVar8 = *puVar1 * 2;
        }
        param_2[0x115] = 0;
        *(undefined *)(param_2 + 0x11a) = 1;
      }
      *(undefined8 *)(param_2 + 0x10c) = 0xffffffffffffffff;
      piVar7 = (int *)((ulonglong)(uint)param_2[0x115] + *(longlong *)(param_2 + 0x118));
      *(undefined *)((longlong)param_2 + 0x469) = 0;
      if ((3 < (uint)piVar7[1]) && (*(short *)((longlong)piVar7 + 0x1a) == 0x3a)) {
        if (*piVar7 == 0) {
          return 1;
        }
        param_2[0x115] = *piVar7 + param_2[0x115];
      }
      param_2[2] = 1;
    }
  }
  return 1;
}



void FUN_18005c33c(int *param_1,void **param_2)

{
  void *_Dst;
  int *piVar1;
  undefined8 uVar2;
  uint local_res10 [2];
  
  uVar2 = FUN_18005e338(param_1,*(uint *)(param_2 + 2),local_res10);
  if ((int)uVar2 != 0) {
    _Dst = *param_2;
    memcpy(_Dst,(void *)((*(longlong *)(param_1 + 0x110) - (ulonglong)(uint)param_1[0x10b]) +
                        *(longlong *)(param_1 + 0x108)),(ulonglong)local_res10[0]);
    piVar1 = (int *)param_2[1];
    *(ulonglong *)(param_1 + 0x108) = *(longlong *)(param_1 + 0x108) + (ulonglong)local_res10[0];
    *piVar1 = *piVar1 + local_res10[0];
    *(uint *)(param_2 + 2) = *(int *)(param_2 + 2) - local_res10[0];
    *param_2 = (void *)((longlong)_Dst + (ulonglong)local_res10[0]);
  }
  return;
}



BOOL FUN_18005c3c0(HANDLE param_1,int *param_2,LPVOID *param_3)

{
  undefined8 uVar1;
  DWORD DVar2;
  DWORD DVar3;
  int iVar4;
  BOOL BVar5;
  DWORD aDStackX20 [5];
  
  if (*(char *)((longlong)param_2 + 0x469) == '\0') {
    BVar5 = FUN_18005cbf4(param_1,param_2,param_3);
    return BVar5;
  }
  if (((((uint)param_2[0x11b] >> 0xe & 1) == 0) && ((param_2[0x11b] & 0x10U) == 0)) &&
     (DVar2 = GetFileSize(param_1,aDStackX20), CONCAT44(aDStackX20[0],DVar2) != 0)) {
    if ((DVar2 == 0xffffffff) && (DVar3 = GetLastError(), DVar3 != 0)) {
      return 0;
    }
    param_2[1] = 0;
    param_2[4] = 0;
    param_2[0x112] = 0;
    param_2[0x113] = 0;
    *param_2 = 1;
    param_2[0x10b] = 0x14;
    *(undefined *)((longlong)param_2 + 0x469) = 0;
    *(undefined *)(param_2 + 0x114) = 0;
    if (((param_2[0x11b] & 0x400200U) == 0x200) &&
       (iVar4 = FUN_18005bb10(param_1,(longlong)param_2), iVar4 != 0)) {
      *(undefined8 *)(param_2 + 2) = 0;
      param_2[1] = 8;
    }
    else {
      uVar1 = CONCAT44(aDStackX20[0],DVar2);
      aDStackX20[0] = 0;
      *(undefined8 *)(param_2 + 2) = uVar1;
      SetFilePointer(param_1,0,(PLONG)aDStackX20,0);
    }
  }
  return 1;
}



undefined8 FUN_18005c4dc(undefined8 param_1,int *param_2,void **param_3)

{
  int iVar1;
  undefined8 uVar2;
  int local_res10 [2];
  uint in_stack_ffffffffffffffb8;
  undefined local_18 [8];
  longlong local_10;
  
  if (*(char *)((longlong)param_2 + 0x469) == '\0') {
    if ((longlong)(ulonglong)(uint)param_2[0x10b] <= *(longlong *)(param_2 + 0x108)) {
      FUN_18005c33c(param_2,param_3);
    }
LAB_18005c5f1:
    uVar2 = 1;
  }
  else {
    do {
      iVar1 = NtQueryEaFile(param_1,local_18,*(undefined8 *)(param_2 + 0x110),param_2[0x10e],
                            in_stack_ffffffffffffffb8 & 0xffffff00,0,0,0,1);
      if ((-1 < iVar1) && (local_10 != 0)) {
        param_2[1] = 0;
        param_2[4] = 0;
        *(undefined2 *)(param_2 + 0x11a) = 1;
        *param_2 = 2;
        param_2[0x10b] = 0x14;
        *(longlong *)(param_2 + 2) = local_10;
        goto LAB_18005c5f1;
      }
      if ((iVar1 != -0x7ffffffb) && (iVar1 != -0x3fffffdd)) goto LAB_18005c5f1;
      in_stack_ffffffffffffffb8 = 0;
      iVar1 = NtQueryInformationFile(param_1,local_18,local_res10);
      if (iVar1 < 0) goto LAB_18005c5f1;
      uVar2 = FUN_18005e448((uint *)(param_2 + 0x10e),(uint)(local_res10[0] * 5) >> 2);
    } while ((int)uVar2 != 0);
    *(undefined *)((longlong)param_2 + 0x46b) = 1;
  }
  return uVar2;
}



void FUN_18005c610(HANDLE param_1,int *param_2,void **param_3)

{
  DWORD DVar1;
  int iVar2;
  undefined8 uVar3;
  uint uVar4;
  undefined auStack152 [32];
  undefined *local_78;
  undefined4 local_70;
  undefined8 *local_68;
  undefined4 local_60;
  undefined8 local_58;
  uint local_50;
  DWORD local_48;
  DWORD DStack68;
  undefined local_40 [8];
  undefined8 local_38;
  undefined8 local_30;
  undefined8 local_28;
  ulonglong local_20;
  
  local_20 = DAT_1800b2220 ^ (ulonglong)auStack152;
  if (*(char *)((longlong)param_2 + 0x469) == '\0') {
    if ((longlong)(ulonglong)(uint)param_2[0x10b] <= *(longlong *)(param_2 + 0x108)) {
      FUN_18005c33c(param_2,param_3);
    }
  }
  else {
    uVar4 = 0x1000;
    if (((param_2[0x11b] & 0x10U) == 0) &&
       ((local_48 = GetFileSize(param_1,&DStack68), local_48 != 0xffffffff ||
        (DVar1 = GetLastError(), DVar1 == 0)))) {
      local_28 = CONCAT44(DStack68,local_48);
      local_30 = 0;
      while (uVar3 = FUN_18005e448((uint *)(param_2 + 0x10e),uVar4), (int)uVar3 != 0) {
        local_58 = *(undefined8 *)(param_2 + 0x110);
        local_38 = 0;
        local_60 = 0x10;
        local_68 = &local_30;
        local_78 = local_40;
        local_70 = 0x903b0;
        local_50 = uVar4;
        iVar2 = NtFsControlFile(param_1,0,0,0);
        if (iVar2 != -0x7ffffffb) {
          if (((iVar2 != -0x3ffffff0) && (iVar2 != -0x3ffffffe)) && (iVar2 != -0x3fffff45)) {
            if (iVar2 < 0) {
              BaseSetLastNTError();
            }
            else if (*(int *)(*(longlong *)(param_2 + 0x110) + 4) != 0) {
              param_2[4] = 0;
              *(undefined8 *)(param_2 + 2) = local_38;
              *(undefined2 *)(param_2 + 0x11a) = 1;
              *param_2 = 0xb;
              param_2[1] = 0x10;
              param_2[0x10b] = 0x14;
            }
          }
          goto LAB_18005c79e;
        }
        uVar4 = uVar4 * 2;
      }
      *(undefined *)((longlong)param_2 + 0x46b) = 1;
    }
  }
LAB_18005c79e:
  __security_check_cookie(local_20 ^ (ulonglong)auStack152);
  return;
}



undefined8 FUN_18005c7c8(undefined8 param_1,int *param_2,void **param_3)

{
  int iVar1;
  undefined8 uVar2;
  undefined local_18 [8];
  undefined8 local_10;
  
  if (*(char *)((longlong)param_2 + 0x469) == '\0') {
    if ((longlong)(ulonglong)(uint)param_2[0x10b] <= *(longlong *)(param_2 + 0x108)) {
      FUN_18005c33c(param_2,param_3);
    }
  }
  else {
    uVar2 = FUN_18005e448((uint *)(param_2 + 0x10e),0x400);
    if ((int)uVar2 == 0) {
      *(undefined *)((longlong)param_2 + 0x46b) = 1;
      return uVar2;
    }
    iVar1 = NtFsControlFile(param_1,0,0,0,local_18,0x9009c,0,0,*(undefined8 *)(param_2 + 0x110),
                            param_2[0x10e]);
    if (-1 < iVar1) {
      param_2[1] = 0;
      param_2[4] = 0;
      *(undefined8 *)(param_2 + 2) = local_10;
      *(undefined2 *)(param_2 + 0x11a) = 1;
      *param_2 = 7;
      param_2[0x10b] = 0x14;
    }
  }
  return 1;
}



undefined8 FUN_18005c8bc(undefined8 param_1,undefined8 *param_2,void **param_3)

{
  undefined8 *puVar1;
  ulonglong uVar2;
  int iVar3;
  undefined8 uVar4;
  ulonglong uVar5;
  undefined local_18 [8];
  undefined2 local_10;
  ushort uStack14;
  undefined4 uStack12;
  
  if ((*(uint *)((longlong)param_2 + 0x46c) & 0x400400) == 0x400) {
    if (*(char *)((longlong)param_2 + 0x469) == '\0') {
      if ((longlong)(ulonglong)*(uint *)((longlong)param_2 + 0x42c) <= (longlong)param_2[0x84]) {
        FUN_18005c33c((int *)param_2,param_3);
      }
    }
    else {
      puVar1 = param_2 + 0x87;
      uStack14 = 0x4000;
      iVar3 = NtFsControlFile(param_1,0,0,0,local_18,0x900a8,0,0,param_2[0x88],*(uint *)puVar1);
      if ((iVar3 == -0x7ffffffb) || (iVar3 == -0x3fffffdd)) {
        if (uStack14 == 0) {
          uStack14 = 0x4000;
        }
        uVar4 = FUN_18005e448((uint *)puVar1,(uint)uStack14);
        if ((int)uVar4 == 0) {
          *(undefined *)((longlong)param_2 + 0x46b) = 1;
          return uVar4;
        }
        iVar3 = NtFsControlFile(param_1,0,0,0,local_18,0x900a8,0,0,param_2[0x88],*(uint *)puVar1);
      }
      if (-1 < iVar3) {
        *(undefined *)(param_2 + 0x8d) = 1;
        *param_2 = 8;
        *(undefined4 *)(param_2 + 2) = 0;
        *(undefined4 *)((longlong)param_2 + 0x42c) = 0x14;
        uVar5 = ((longlong)*(int *)param_2[0x88] >> 0x3f & 0xfffffffffffffff0U) +
                (ulonglong)*(ushort *)((int *)param_2[0x88] + 1) + 0x18;
        param_2[1] = uVar5;
        uVar2 = CONCAT44(uStack12,CONCAT22(uStack14,local_10));
        if (uVar2 < (uVar5 & 0xffffffff)) {
          param_2[1] = uVar2;
        }
        *(undefined *)((longlong)param_2 + 0x469) = 0;
      }
    }
  }
  return 1;
}



undefined8 FUN_18005ca6c(undefined8 param_1,int *param_2,void **param_3)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  undefined8 uVar4;
  uint local_res18 [4];
  
  if (*(char *)((longlong)param_3 + 0x14) != '\0') {
    if (*(char *)((longlong)param_2 + 0x469) == '\0') {
      if ((longlong)(ulonglong)(uint)param_2[0x10b] <= *(longlong *)(param_2 + 0x108)) {
        FUN_18005c33c(param_2,param_3);
      }
    }
    else {
      puVar1 = (uint *)(param_2 + 0x10e);
      while( true ) {
        memset(*(void **)(param_2 + 0x110),0,(ulonglong)*puVar1);
        iVar2 = NtQuerySecurityObject
                          (param_1,0x1007f,*(undefined8 *)(param_2 + 0x110),*puVar1,local_res18);
        if (-1 < iVar2) break;
        if ((iVar2 != -0x7ffffffb) && (iVar2 != -0x3fffffdd)) {
          iVar2 = NtQuerySecurityObject(param_1);
          if (-1 < iVar2) break;
          if ((iVar2 != -0x7ffffffb) && (iVar2 != -0x3fffffdd)) {
            iVar2 = NtQuerySecurityObject(param_1);
          }
        }
        if (-1 < iVar2) break;
        if ((iVar2 != -0x7ffffffb) && (iVar2 != -0x3fffffdd)) {
          return 1;
        }
        uVar4 = FUN_18005e448(puVar1,local_res18[0]);
        if ((int)uVar4 == 0) {
          return uVar4;
        }
      }
      param_2[4] = 0;
      *(undefined *)(param_2 + 0x11a) = 1;
      *param_2 = 3;
      param_2[1] = 2;
      param_2[0x10b] = 0x14;
      uVar3 = RtlLengthSecurityDescriptor(*(undefined8 *)(param_2 + 0x110));
      *(ulonglong *)(param_2 + 2) = (ulonglong)uVar3;
      *(undefined *)((longlong)param_2 + 0x469) = 0;
    }
  }
  return 1;
}



BOOL FUN_18005cbf4(HANDLE param_1,int *param_2,LPVOID *param_3)

{
  longlong lVar1;
  int *piVar2;
  DWORD DVar3;
  BOOL BVar4;
  undefined8 uVar5;
  longlong *plVar6;
  DWORD local_res10;
  LONG LStackX20;
  uint local_res20 [2];
  
  if (*(char *)(param_2 + 0x114) == '\0') {
    if (*(longlong *)(param_2 + 0x108) < (longlong)(ulonglong)(uint)param_2[0x10b]) {
      return 1;
    }
    uVar5 = FUN_18005e338(param_2,*(uint *)(param_3 + 2),&local_res10);
    if ((int)uVar5 != 0) {
      BVar4 = ReadFile(param_1,*param_3,local_res10,local_res20,(LPOVERLAPPED)0x0);
      if (local_res20[0] != 0) {
        piVar2 = (int *)param_3[1];
        *(ulonglong *)(param_2 + 0x108) = *(longlong *)(param_2 + 0x108) + (ulonglong)local_res20[0]
        ;
        *(uint *)(param_3 + 2) = *(int *)(param_3 + 2) - local_res20[0];
        *piVar2 = *piVar2 + local_res20[0];
        *param_3 = (LPVOID)((longlong)*param_3 + (ulonglong)local_res20[0]);
        return BVar4;
      }
      if (BVar4 == 0) {
        return 0;
      }
      if (local_res10 == 0) {
        return BVar4;
      }
      RtlSetLastWin32Error(0x45d);
    }
  }
  else {
    plVar6 = (longlong *)((ulonglong)(uint)param_2[0x113] + *(longlong *)(param_2 + 0x110));
    lVar1 = plVar6[1];
    param_2[4] = 0;
    *(longlong *)(param_2 + 2) = lVar1 + 8;
    *param_2 = 9;
    param_2[1] = 8;
    param_2[0x10b] = 0x1c;
    lVar1 = *plVar6;
    *(longlong *)(param_2 + 0x106) = lVar1;
    *(longlong *)(param_2 + 5) = lVar1;
    *(undefined *)(param_2 + 0x114) = 0;
    LStackX20 = *(LONG *)((longlong)plVar6 + 4);
    DVar3 = SetFilePointer(param_1,*(LONG *)plVar6,&LStackX20,0);
    if (CONCAT44(LStackX20,DVar3) == *plVar6) {
      return 1;
    }
    *(undefined *)((longlong)param_2 + 0x46b) = 1;
  }
  return 0;
}



undefined8 FUN_18005cd40(undefined8 param_1,int *param_2,void **param_3)

{
  uint *puVar1;
  int iVar2;
  undefined8 uVar3;
  undefined local_18 [8];
  undefined8 local_10;
  
  if (*(char *)((longlong)param_2 + 0x469) == '\0') {
    if (*(longlong *)(param_2 + 0x108) < (longlong)(ulonglong)(uint)param_2[0x10b]) {
      return 1;
    }
    FUN_18005c33c(param_2,param_3);
    return 1;
  }
  puVar1 = (uint *)(param_2 + 0x10e);
  uVar3 = FUN_18005e448(puVar1,0x400);
  if ((int)uVar3 == 0) {
LAB_18005ce88:
    *(undefined *)((longlong)param_2 + 0x46b) = 1;
    return 0;
  }
  iVar2 = NtFsControlFile(param_1,0,0,0,local_18,0x901f8,0,0,*(undefined8 *)(param_2 + 0x110),
                          *puVar1);
  if (iVar2 == -0x7ffffffb) {
    uVar3 = FUN_18005e448(puVar1,**(int **)(param_2 + 0x110) - *puVar1);
    if ((int)uVar3 == 0) goto LAB_18005ce88;
    iVar2 = NtFsControlFile(param_1,0,0,0,local_18,0x901f8,0,0,*(undefined8 *)(param_2 + 0x110),
                            *puVar1);
  }
  if ((((iVar2 != -0x7fe6ffd7) && (iVar2 != -0x3ffffff0)) && (iVar2 != -0x3ffffffe)) &&
     ((iVar2 != -0x3fe6fffb && (iVar2 != -0x3fffff45)))) {
    if (iVar2 < 0) {
      BaseSetLastNTError();
      return 0;
    }
    param_2[1] = 0;
    param_2[4] = 0;
    *(undefined8 *)(param_2 + 2) = local_10;
    *(undefined2 *)(param_2 + 0x11a) = 1;
    *param_2 = 10;
    param_2[0x10b] = 0x14;
  }
  return 1;
}



BOOL BackupSeek(HANDLE hFile,DWORD dwLowBytesToSeek,DWORD dwHighBytesToSeek,
               LPDWORD lpdwLowByteSeeked,LPDWORD lpdwHighByteSeeked,LPVOID *lpContext)

{
  int iVar1;
  int *piVar2;
  undefined8 uVar3;
  longlong lVar4;
  uint uVar5;
  longlong lVar6;
  DWORD local_48;
  LONG aLStack68 [2];
  DWORD local_3c;
  
                    // 0x5ced0  40  BackupSeek
  lVar4 = 0;
  piVar2 = (int *)*lpContext;
  *lpdwHighByteSeeked = 0;
  *lpdwLowByteSeeked = 0;
  if ((((0xfffffffffffffffd < (longlong)piVar2 - 1U) ||
       (*(char *)((longlong)piVar2 + 0x469) != '\0')) ||
      (*(longlong *)(piVar2 + 0x108) < (longlong)(ulonglong)(uint)piVar2[0x10b])) ||
     (uVar3 = FUN_18005e2dc(piVar2,(longlong *)&local_48), (int)uVar3 == 0)) {
    return 0;
  }
  uVar5 = 1;
  lpContext = (LPVOID *)(CONCAT44(dwHighBytesToSeek,dwLowBytesToSeek) & 0x7fffffffffffffff);
  iVar1 = *piVar2;
  if (CONCAT44(aLStack68[0],local_48) < (longlong)lpContext) {
    lpContext = (LPVOID *)CONCAT44(aLStack68[0],local_48);
  }
  lVar6 = lVar4;
  if ((iVar1 == 1) || (lVar6 = 0, iVar1 == 4)) {
LAB_18005cfd0:
    if (*piVar2 != 1) goto LAB_18005cfd4;
  }
  else {
    if (iVar1 != 9) {
      lpContext._4_4_ = (DWORD)((ulonglong)lpContext >> 0x20);
      goto LAB_18005d02c;
    }
    lVar6 = lVar4;
    if (*(ulonglong *)(piVar2 + 0x108) < 8) {
      lVar6 = 8 - *(ulonglong *)(piVar2 + 0x108);
      if ((longlong)lpContext <= lVar6) {
        lpContext = (LPVOID *)0x0;
        goto LAB_18005cfd0;
      }
      lpContext = (LPVOID *)((longlong)lpContext - lVar6);
    }
LAB_18005cfd4:
    hFile = *(HANDLE *)(piVar2 + 0x10c);
  }
  aLStack68[0] = 0;
  local_48 = SetFilePointer(hFile,0,aLStack68,1);
  local_3c = lpContext._4_4_;
  SetFilePointer(hFile,(DWORD)lpContext,(PLONG)&local_3c,1);
  lVar4 = lVar6;
LAB_18005d02c:
  if ((dwHighBytesToSeek != lpContext._4_4_) || (dwLowBytesToSeek != (DWORD)lpContext)) {
    uVar5 = 0;
  }
  lVar4 = (longlong)lpContext + lVar4;
  *(longlong *)(piVar2 + 0x108) = *(longlong *)(piVar2 + 0x108) + lVar4;
  lpContext._0_4_ = (DWORD)lVar4;
  *lpdwLowByteSeeked = (DWORD)lpContext;
  *lpdwHighByteSeeked = (DWORD)((ulonglong)lVar4 >> 0x20);
  uVar3 = FUN_18005d0c4(piVar2);
  uVar5 = -(uint)((int)uVar3 != 0) & uVar5;
  if (uVar5 == 0) {
    RtlSetLastWin32Error(0x19);
  }
  return uVar5;
}



undefined8 FUN_18005d0c4(int *param_1)

{
  int iVar1;
  undefined8 uVar2;
  longlong local_res10 [3];
  
  uVar2 = FUN_18005e2dc(param_1,local_res10);
  if ((int)uVar2 != 0) {
    if (local_res10[0] == 0) {
      iVar1 = param_1[0x113];
      if ((iVar1 != param_1[0x112]) && (*(char *)(param_1 + 0x114) == '\0')) {
        iVar1 = iVar1 + 0x10;
        param_1[0x113] = iVar1;
      }
      if (iVar1 == param_1[0x112]) {
        if ((*(char *)((longlong)param_1 + 0x451) == '\0') &&
           ((longlong)*(HANDLE *)(param_1 + 0x10c) - 1U < 0xfffffffffffffffe)) {
          CloseHandle(*(HANDLE *)(param_1 + 0x10c));
          *(undefined8 *)(param_1 + 0x10c) = 0xffffffffffffffff;
        }
        param_1[0x10b] = 0;
        *(undefined8 *)(param_1 + 0x108) = 0;
        *(undefined *)((longlong)param_1 + 0x469) = 1;
        *(undefined *)(param_1 + 0x114) = 1;
        if (*(char *)((longlong)param_1 + 0x46a) == '\0') {
          param_1[0x10a] = param_1[0x10a] + 1;
          *(undefined *)(param_1 + 0x11a) = 0;
          *param_1 = *(int *)(&DAT_18008a588 + (ulonglong)(uint)param_1[0x10a] * 4);
        }
      }
      else {
        param_1[0x10b] = 0;
        *(undefined8 *)(param_1 + 0x108) = 0;
        *(undefined *)(param_1 + 0x114) = 1;
      }
    }
    uVar2 = 1;
  }
  return uVar2;
}



BOOL BackupWrite(HANDLE hFile,LPBYTE lpBuffer,DWORD nNumberOfBytesToWrite,
                LPDWORD lpNumberOfBytesWritten,BOOL bAbort,BOOL bProcessSecurity,LPVOID *lpContext)

{
  uint uVar1;
  LPVOID *ppvVar2;
  BOOL BVar3;
  uint *puVar4;
  undefined8 uVar5;
  LPBYTE local_28;
  LPDWORD local_20;
  DWORD local_18;
  undefined local_14;
  
                    // 0x5d1b0  41  BackupWrite
  ppvVar2 = lpContext;
  BVar3 = 0;
  puVar4 = (uint *)*lpContext;
  local_14 = (undefined)bProcessSecurity;
  local_28 = lpBuffer;
  local_20 = lpNumberOfBytesWritten;
  local_18 = nNumberOfBytesToWrite;
  if (bAbort == 0) {
    *lpNumberOfBytesWritten = 0;
    if (puVar4 != (uint *)0xffffffffffffffff) {
      if ((puVar4 == (uint *)0x0) && (puVar4 = (uint *)FUN_18005ba34(0), puVar4 == (uint *)0x0)) {
        return 0;
      }
      *ppvVar2 = puVar4;
      do {
        if (puVar4[0x10b] == 0) {
          *(undefined2 *)((longlong)puVar4 + 0x469) = 0x101;
          FUN_18005da80((longlong)puVar4,&local_28,0x14);
        }
        if (local_18 == 0) {
          return 1;
        }
        if (puVar4[0x10b] == 0x14) {
          if (puVar4[4] != 0) {
            uVar1 = puVar4[4] + 0x14;
            if ((uVar1 < 0x14) ||
               (uVar5 = FUN_18005da80((longlong)puVar4,&local_28,(ulonglong)uVar1), (int)uVar5 == 0)
               ) {
              RtlSetLastWin32Error(0xd);
              return 0;
            }
            if (local_18 == 0) {
              if (*puVar4 != 4) {
                return 1;
              }
              if ((longlong)(ulonglong)puVar4[0x10b] < *(longlong *)(puVar4 + 0x108)) {
                return 1;
              }
            }
          }
          if ((((puVar4[0x10b] == 0x14) && (*puVar4 == 9)) &&
              (FUN_18005da80((longlong)puVar4,&local_28,0x1c), local_18 == 0)) &&
             (puVar4[0x10b] == 0x14)) {
            return 1;
          }
        }
        uVar5 = FUN_18005e338((int *)puVar4,local_18,&bProcessSecurity);
        if ((int)uVar5 == 0) {
          return 0;
        }
        uVar5 = FUN_18005e2dc((int *)puVar4,(longlong *)&lpContext);
        if ((int)uVar5 == 0) {
          return 0;
        }
        if ((*(char *)((longlong)puVar4 + 0x46b) == '\0') || (lpContext != (LPVOID *)0x0)) {
          uVar1 = *puVar4;
          *(undefined *)((longlong)puVar4 + 0x46b) = 0;
          if (uVar1 < 8) {
            if (uVar1 == 7) {
              uVar5 = FUN_18005dd34(hFile,(int *)puVar4,&local_28);
              BVar3 = (BOOL)uVar5;
            }
            else if (uVar1 == 1) {
              BVar3 = FUN_18005e124(hFile,(int *)puVar4,&local_28);
            }
            else if (uVar1 == 2) {
              BVar3 = FUN_18005d7c0(hFile,(int *)puVar4,&local_28);
            }
            else if (uVar1 == 3) {
              uVar5 = FUN_18005de78(hFile,(int *)puVar4,&local_28);
              BVar3 = (BOOL)uVar5;
            }
            else if (uVar1 == 4) {
              BVar3 = FUN_18005d4ac(hFile,(int *)puVar4,&local_28);
            }
            else {
              if (uVar1 != 5) goto LAB_18005d3fe;
              uVar5 = FUN_18005db48(hFile,(int *)puVar4,&local_28);
              BVar3 = (BOOL)uVar5;
            }
          }
          else if (uVar1 == 8) {
            uVar5 = FUN_18005dddc(hFile,(int *)puVar4,&local_28);
            BVar3 = (BOOL)uVar5;
          }
          else if (uVar1 == 9) {
            BVar3 = FUN_18005e010(hFile,(int *)puVar4,&local_28);
          }
          else if (uVar1 == 10) {
            uVar5 = FUN_18005e248(hFile,(int *)puVar4,&local_28);
            BVar3 = (BOOL)uVar5;
          }
          else if (uVar1 == 0xb) {
            uVar5 = FUN_18005d8e4(hFile,(int *)puVar4,&local_28);
            BVar3 = (BOOL)uVar5;
          }
          else {
LAB_18005d3fe:
            RtlSetLastWin32Error(0xd);
            BVar3 = 0;
          }
          uVar5 = FUN_18005d0c4((int *)puVar4);
          if ((int)uVar5 == 0) {
            return 0;
          }
        }
        else {
          *(ulonglong *)(puVar4 + 0x108) =
               *(longlong *)(puVar4 + 0x108) + (ulonglong)(uint)bProcessSecurity;
          local_18 = local_18 - bProcessSecurity;
          *local_20 = *local_20 + bProcessSecurity;
          local_28 = local_28 + (uint)bProcessSecurity;
        }
        if (BVar3 == 0) {
          return 0;
        }
        if (local_18 == 0) {
          if (*local_20 == 0) {
            FUN_18005e3bc((longlong *)ppvVar2);
            return BVar3;
          }
          return BVar3;
        }
      } while( true );
    }
  }
  else if (puVar4 != (uint *)0x0) {
    FUN_18005e3bc((longlong *)lpContext);
  }
  return 1;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18005d4ac(undefined8 param_1,int *param_2,LPCVOID *param_3)

{
  HANDLE *ppvVar1;
  uint uVar2;
  int iVar3;
  undefined auStack776 [32];
  undefined8 local_2e8;
  undefined4 local_2e0;
  undefined8 local_2d8;
  undefined4 local_2d0;
  ulonglong local_2c8;
  ulonglong local_2c0;
  undefined4 local_2b8;
  undefined2 local_2a8;
  undefined2 local_2a6;
  int *local_2a0;
  undefined local_298 [16];
  undefined4 local_288 [2];
  undefined8 local_280;
  undefined2 *local_278;
  undefined4 local_270;
  undefined local_268 [16];
  int local_258;
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack776;
  if (*(char *)(param_2 + 0x11c) == '\0') {
    *(undefined *)(param_2 + 0x11c) = 1;
    local_2e8 = (undefined *)CONCAT44(local_2e8._4_4_,5);
    iVar3 = NtQueryVolumeInformationFile();
    *(bool *)((longlong)param_2 + 0x471) = -1 < iVar3;
    if (-1 < iVar3) {
      param_2[0x11d] = local_258;
    }
  }
  if ((*(char *)((longlong)param_2 + 0x471) != '\0') && ((param_2[0x11d] & 0x40000U) == 0)) {
    uVar2 = *(uint *)(param_3 + 2);
    *(ulonglong *)(param_2 + 0x108) = *(longlong *)(param_2 + 0x108) + (ulonglong)uVar2;
                    // WARNING: Load size is inaccurate
    *(uint *)param_3[1] = *param_3[1] + uVar2;
    *(uint *)(param_3 + 2) = *(int *)(param_3 + 2) - uVar2;
    *param_3 = (LPCVOID)((longlong)*param_3 + (ulonglong)uVar2);
    goto LAB_18005d6a7;
  }
  if (*(char *)((longlong)param_2 + 0x469) == '\0') {
LAB_18005d68f:
    if (*(HANDLE *)(param_2 + 0x10c) != (HANDLE)0xffffffffffffffff) {
      FUN_18005e124(*(HANDLE *)(param_2 + 0x10c),param_2,param_3);
      goto LAB_18005d6a7;
    }
  }
  else {
    local_2a8 = *(undefined2 *)(param_2 + 4);
    ppvVar1 = (HANDLE *)(param_2 + 0x10c);
    local_2a0 = param_2 + 5;
    local_2a6 = local_2a8;
    if (*ppvVar1 != (HANDLE)0xffffffffffffffff) {
      CloseHandle(*ppvVar1);
      *ppvVar1 = (HANDLE)0xffffffffffffffff;
      *(undefined *)((longlong)param_2 + 0x451) = 0;
    }
    local_2b8 = 0;
    local_278 = &local_2a8;
    local_2c0 = 0;
    local_288[0] = 0x30;
    local_2c8 = local_2c8 & 0xffffffff00000000 | (ulonglong)((param_2[0x11b] & 0x400U) << 0xb) |
                0x4020;
    local_2d0 = 5;
    local_2d8 = CONCAT44(local_2d8._4_4_,7);
    local_2e0 = 0x80;
    local_2e8 = (undefined *)0x0;
    local_270 = 0x40;
    local_268 = ZEXT816(0);
    local_280 = param_1;
    iVar3 = NtCreateFile(ppvVar1,0x100002,local_288,local_298);
    if (-1 < iVar3) {
      if ((*(byte *)(param_2 + 1) & 8) != 0) {
        local_2c0 = local_2c0 & 0xffffffff00000000;
        local_2e8 = local_298;
        local_2c8 = 0;
        local_2d0 = 0;
        local_2d8 = 0;
        local_2e0 = 0x900c4;
        *(undefined *)((longlong)param_2 + 0x451) = 1;
        NtFsControlFile(*ppvVar1,0,0,0);
      }
      goto LAB_18005d68f;
    }
    BaseSetLastNTError();
  }
  *(undefined *)((longlong)param_2 + 0x46b) = 1;
LAB_18005d6a7:
  __security_check_cookie(local_38 ^ (ulonglong)auStack776);
  return;
}



char FUN_18005d6cc(int *param_1,void **param_2)

{
  void *_Src;
  int *piVar1;
  uint uVar2;
  undefined8 uVar3;
  ulonglong uVar4;
  uint local_res8;
  undefined4 uStackX12;
  
  if (*(char *)((longlong)param_1 + 0x469) != '\0') {
    *(undefined *)((longlong)param_1 + 0x469) = 0;
    if (param_1[3] != 0) {
      RtlSetLastWin32Error(0xd);
      return '\0';
    }
    if (((longlong)(ulonglong)(uint)param_1[0x10e] < *(longlong *)(param_1 + 2)) &&
       (uVar3 = FUN_18005e448((uint *)(param_1 + 0x10e),param_1[2]), (int)uVar3 == 0)) {
      return '\0';
    }
  }
  uVar3 = FUN_18005e338(param_1,*(uint *)(param_2 + 2),&local_res8);
  uVar2 = local_res8;
  if ((int)uVar3 != 0) {
    uVar4 = (ulonglong)local_res8;
    _Src = *param_2;
    memcpy((void *)((*(longlong *)(param_1 + 0x110) - (ulonglong)(uint)param_1[0x10b]) +
                   *(longlong *)(param_1 + 0x108)),_Src,(ulonglong)local_res8);
    piVar1 = (int *)param_2[1];
    *(ulonglong *)(param_1 + 0x108) = *(longlong *)(param_1 + 0x108) + uVar4;
    *(uint *)(param_2 + 2) = *(int *)(param_2 + 2) - uVar2;
    *piVar1 = *piVar1 + uVar2;
    *param_2 = (void *)((longlong)_Src + uVar4);
    uVar3 = FUN_18005e2dc(param_1,(longlong *)&local_res8);
    if ((int)uVar3 != 0) {
      return (CONCAT44(uStackX12,local_res8) != 0) + '\x01';
    }
  }
  return '\0';
}



void FUN_18005d7c0(undefined8 param_1,int *param_2,void **param_3)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  undefined7 extraout_var;
  undefined auStack664 [32];
  undefined4 local_278;
  undefined local_268 [16];
  undefined local_258 [16];
  int local_248 [136];
  ulonglong local_28;
  
  local_28 = DAT_1800b2220 ^ (ulonglong)auStack664;
  cVar1 = FUN_18005d6cc(param_2,param_3);
  if (((int)CONCAT71(extraout_var,cVar1) == 1) &&
     ((*(char *)((longlong)param_2 + 0x471) == '\0' || ((param_2[0x11d] & 0x800000U) != 0)))) {
    uVar2 = NtSetEaFile(param_1,local_268,*(undefined8 *)(param_2 + 0x110),param_2[2]);
    if (((int)uVar2 < 0) && (*(char *)(param_2 + 0x11c) == '\0')) {
      *(undefined *)(param_2 + 0x11c) = 1;
      local_278 = 5;
      iVar3 = NtQueryVolumeInformationFile(param_1,local_258,local_248,0x218);
      *(bool *)((longlong)param_2 + 0x471) = -1 < iVar3;
      if (-1 < iVar3) {
        param_2[0x11d] = local_248[0];
      }
    }
    if (*(char *)((longlong)param_2 + 0x471) != '\0') {
      uVar2 = uVar2 & -(uint)((param_2[0x11d] & 0x800000U) != 0);
    }
    if ((int)uVar2 < 0) {
      BaseSetLastNTError();
    }
  }
  __security_check_cookie(local_28 ^ (ulonglong)auStack664);
  return;
}



// WARNING: Could not reconcile some variable overlaps

undefined8 FUN_18005d8e4(undefined8 param_1,int *param_2,void **param_3)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  char cVar4;
  int iVar5;
  undefined7 extraout_var;
  undefined8 uVar6;
  ulonglong uVar7;
  ulonglong uVar8;
  undefined8 *puVar9;
  undefined local_28 [32];
  
  local_28._0_16_ = ZEXT816(0);
  cVar4 = FUN_18005d6cc(param_2,param_3);
  iVar5 = (int)CONCAT71(extraout_var,cVar4);
  if (iVar5 == 1) {
    if (7 < *(ulonglong *)(param_2 + 2)) {
      uVar8 = *(ulonglong *)(param_2 + 2) - 8;
      for (puVar9 = (undefined8 *)(*(longlong *)(param_2 + 0x110) + 8);
          (0x27 < uVar8 && ((ulonglong)*(uint *)((longlong)puVar9 + 0x24) <= uVar8 - 0x28));
          puVar9 = (undefined8 *)((longlong)puVar9 + uVar7)) {
        uVar6 = FUN_18005e448((uint *)local_28,*(uint *)((longlong)puVar9 + 0x24) + 0x24);
        if ((int)uVar6 == 0) {
          FUN_18005e37c((longlong)local_28);
          return 0;
        }
        *local_28._8_8_ = *puVar9;
        local_28._8_8_[1] = puVar9[1];
        uVar1 = *(undefined4 *)((longlong)puVar9 + 0x14);
        uVar2 = *(undefined4 *)(puVar9 + 3);
        uVar3 = *(undefined4 *)((longlong)puVar9 + 0x1c);
        *(undefined4 *)(local_28._8_8_ + 2) = *(undefined4 *)(puVar9 + 2);
        *(undefined4 *)((longlong)local_28._8_8_ + 0x14) = uVar1;
        *(undefined4 *)(local_28._8_8_ + 3) = uVar2;
        *(undefined4 *)((longlong)local_28._8_8_ + 0x1c) = uVar3;
        *(undefined4 *)(local_28._8_8_ + 4) = *(undefined4 *)((longlong)puVar9 + 0x24);
        if (*(int *)((longlong)puVar9 + 0x24) != 0) {
          memcpy((void *)((longlong)local_28._8_8_ + 0x24),puVar9 + 5,
                 (ulonglong)*(uint *)((longlong)puVar9 + 0x24));
        }
        iVar5 = NtFsControlFile();
        if (iVar5 < 0) {
          FUN_18005e37c((longlong)local_28);
          BaseSetLastNTError();
          return 0;
        }
        if (*(int *)(puVar9 + 4) == 0) {
          FUN_18005e37c((longlong)local_28);
          return 1;
        }
        uVar7 = (ulonglong)*(uint *)(puVar9 + 4);
        if (uVar8 < uVar7) break;
        uVar8 = uVar8 - uVar7;
      }
      FUN_18005e37c((longlong)local_28);
    }
    RtlSetLastWin32Error(0xd);
  }
  else if (iVar5 == 2) {
    return 1;
  }
  return 0;
}



undefined8 FUN_18005da80(longlong param_1,void **param_2,ulonglong param_3)

{
  uint uVar1;
  longlong lVar2;
  void *_Src;
  int *piVar3;
  undefined8 uVar4;
  uint uVar5;
  int iVar6;
  
  uVar1 = *(uint *)(param_2 + 2);
  lVar2 = *(longlong *)(param_1 + 0x420);
  iVar6 = (int)(param_3 & 0xffffffff);
  uVar5 = uVar1;
  if ((longlong)((param_3 & 0xffffffff) - lVar2) <= (longlong)(ulonglong)uVar1) {
    uVar5 = iVar6 - (int)lVar2;
  }
  if (((uVar5 < 0x214) && (lVar2 <= (longlong)(ulonglong)(0x214 - uVar5))) && (-1 < lVar2)) {
    _Src = *param_2;
    memcpy((void *)(lVar2 + param_1),_Src,(ulonglong)uVar5);
    piVar3 = (int *)param_2[1];
    *(longlong *)(param_1 + 0x420) = *(longlong *)(param_1 + 0x420) + (ulonglong)uVar5;
    *(uint *)(param_2 + 2) = uVar1 - uVar5;
    *piVar3 = *piVar3 + uVar5;
    *param_2 = (void *)((longlong)_Src + (ulonglong)uVar5);
    if (*(ulonglong *)(param_1 + 0x420) == (param_3 & 0xffffffff)) {
      *(int *)(param_1 + 0x42c) = iVar6;
    }
    uVar4 = 1;
  }
  else {
    uVar4 = 0;
  }
  return uVar4;
}



undefined8 FUN_18005db48(undefined8 param_1,int *param_2,void **param_3)

{
  short sVar1;
  char cVar2;
  int iVar3;
  int iVar4;
  undefined7 extraout_var;
  short *psVar5;
  undefined *puVar6;
  HANDLE pvVar7;
  undefined8 uVar8;
  short *psVar9;
  int iVar10;
  short *psVar11;
  short sVar12;
  longlong in_GS_OFFSET;
  undefined local_38 [8];
  longlong local_30;
  
  cVar2 = FUN_18005d6cc(param_2,param_3);
  iVar4 = (int)CONCAT71(extraout_var,cVar2);
  if (iVar4 == 1) {
    psVar9 = *(short **)(param_2 + 0x110);
    iVar10 = 0;
    iVar4 = 2;
    sVar12 = 0x5c;
    psVar11 = (short *)0x0;
    while (sVar1 = *psVar9, sVar1 != 0) {
      psVar5 = psVar9;
      if (sVar1 != 0x5c) {
        psVar5 = psVar11;
      }
      iVar3 = iVar10 + 1;
      if (sVar1 != 0x5c) {
        iVar3 = iVar10;
      }
      iVar10 = iVar3;
      psVar9 = psVar9 + 1;
      iVar3 = 0;
      if (sVar1 != 0x5c) {
        iVar3 = iVar4;
      }
      iVar4 = iVar3 + 2;
      psVar11 = psVar5;
    }
    puVar6 = (undefined *)FUN_18005bacc(iVar4 + 0x18);
    if (puVar6 != (undefined *)0x0) {
      memcpy(puVar6 + 0x14,psVar11 + 1,(longlong)iVar4);
      *(int *)(puVar6 + 0x10) = iVar4 + -2;
      if (iVar10 < 2) {
        sVar12 = *psVar11;
        psVar11 = psVar11 + 1;
      }
      uVar8 = 0;
      *psVar11 = 0;
      pvVar7 = CreateFileW(*(LPCWSTR *)(param_2 + 0x110),0xc0000000,7,(LPSECURITY_ATTRIBUTES)0x0,3,
                           0x2000080,(HANDLE)0x0);
      *(HANDLE *)(puVar6 + 8) = pvVar7;
      *psVar11 = sVar12;
      *puVar6 = 1;
      if (*(longlong *)(puVar6 + 8) == -1) {
        RtlSetLastWin32Error(2);
      }
      else {
        iVar4 = NtSetInformationFile(param_1,local_38,puVar6,iVar4 + 0x18,0xb);
        CloseHandle(*(HANDLE *)(puVar6 + 8));
        *(undefined8 *)(puVar6 + 8) = 0xffffffffffffffff;
        if (iVar4 < 0) {
          BaseSetLastNTError();
        }
        else {
          if (local_30 == 3) {
            uVar8 = 0xb7;
          }
          else {
            uVar8 = 0;
          }
          RtlSetLastWin32Error(uVar8);
          uVar8 = 1;
        }
      }
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar6);
      return uVar8;
    }
    RtlSetLastWin32Error(8);
  }
  else if (iVar4 == 2) {
    return 1;
  }
  return 0;
}



undefined8 FUN_18005dd34(undefined8 param_1,int *param_2,void **param_3)

{
  longlong lVar1;
  char cVar2;
  int iVar3;
  undefined7 extraout_var;
  undefined local_18 [16];
  
  cVar2 = FUN_18005d6cc(param_2,param_3);
  iVar3 = (int)CONCAT71(extraout_var,cVar2);
  if (iVar3 == 1) {
    lVar1 = *(longlong *)(param_2 + 0x110);
    *(undefined (*) [16])(lVar1 + 0x10) = ZEXT816(0);
    *(undefined (*) [16])(lVar1 + 0x20) = ZEXT816(0);
    *(undefined (*) [16])(lVar1 + 0x30) = ZEXT816(0);
    iVar3 = NtFsControlFile(param_1,0,0,0,local_18,0x90098,*(undefined8 *)(param_2 + 0x110),
                            param_2[2],0,0);
    if (iVar3 < 0) {
      BaseSetLastNTError();
    }
  }
  else if (iVar3 != 2) {
    return 0;
  }
  return 1;
}



undefined8 FUN_18005dddc(undefined8 param_1,int *param_2,void **param_3)

{
  char cVar1;
  int iVar2;
  undefined7 extraout_var;
  undefined local_18 [16];
  
  cVar1 = FUN_18005d6cc(param_2,param_3);
  iVar2 = (int)CONCAT71(extraout_var,cVar1);
  if (iVar2 == 1) {
    param_2[0x11b] = param_2[0x11b] | 0x400;
    iVar2 = NtFsControlFile(param_1,0,0,0,local_18,0x900a4,*(undefined8 *)(param_2 + 0x110),
                            param_2[2],0,0);
    if (-1 < iVar2) {
      return 1;
    }
    BaseSetLastNTError();
  }
  else if (iVar2 == 2) {
    return 1;
  }
  return 0;
}



undefined8 FUN_18005de78(undefined8 param_1,int *param_2,void **param_3)

{
  ushort uVar1;
  uint uVar2;
  char cVar3;
  int iVar4;
  int iVar5;
  undefined7 extraout_var;
  longlong lVar6;
  
  cVar3 = FUN_18005d6cc(param_2,param_3);
  iVar4 = (int)CONCAT71(extraout_var,cVar3);
  if (iVar4 == 1) {
    if (*(char *)((longlong)param_3 + 0x14) != '\0') {
      lVar6 = *(longlong *)(param_2 + 0x110);
      uVar1 = *(ushort *)(lVar6 + 2);
      uVar2 = uVar1 & 4 | 0x7b;
      if ((uVar1 & 0x10) == 0) {
        uVar2 = uVar1 & 4 | 3;
      }
      if ((uVar1 & 0x400) != 0) {
        *(ushort *)(lVar6 + 2) = uVar1 | 0x100;
        lVar6 = *(longlong *)(param_2 + 0x110);
      }
      if ((*(ushort *)(lVar6 + 2) & 0x800) != 0) {
        *(ushort *)(lVar6 + 2) = *(ushort *)(lVar6 + 2) | 0x200;
        lVar6 = *(longlong *)(param_2 + 0x110);
      }
      iVar4 = NtSetSecurityObject(param_1,uVar2 | 0x10000,lVar6);
      if ((iVar4 < 0) &&
         (iVar4 = NtSetSecurityObject(param_1,uVar2,*(undefined8 *)(param_2 + 0x110)), iVar4 < 0)) {
        if ((uVar2 & 0x48) != 0) {
          NtSetSecurityObject(param_1,uVar2 & 0x48,*(undefined8 *)(param_2 + 0x110));
        }
        if ((uVar2 & 0x10) != 0) {
          NtSetSecurityObject(param_1,0x10,*(undefined8 *)(param_2 + 0x110));
        }
        if ((uVar2 & 0x24) != 0) {
          iVar4 = NtSetSecurityObject(param_1,uVar2 & 0x24,*(undefined8 *)(param_2 + 0x110));
        }
        iVar5 = NtSetSecurityObject(param_1,3,*(undefined8 *)(param_2 + 0x110));
        if ((iVar4 < 0) || (iVar5 < 0)) {
          BaseSetLastNTError();
          return 0;
        }
      }
    }
  }
  else if (iVar4 != 2) {
    return 0;
  }
  return 1;
}



// WARNING: Could not reconcile some variable overlaps

BOOL FUN_18005e010(HANDLE param_1,int *param_2,LPCVOID *param_3)

{
  DWORD DVar1;
  BOOL BVar2;
  undefined8 uVar3;
  HANDLE pvVar4;
  DWORD local_res10 [2];
  uint local_res20 [2];
  undefined8 local_18;
  
  if (*(char *)(param_2 + 0x114) != '\0') {
    local_18 = *(ulonglong *)(param_2 + 5);
    *(ulonglong *)(param_2 + 0x106) = local_18;
    pvVar4 = param_1;
    if (*(char *)((longlong)param_2 + 0x451) != '\0') {
      pvVar4 = *(HANDLE *)(param_2 + 0x10c);
    }
    DVar1 = SetFilePointer(pvVar4,(LONG)local_18,(PLONG)((longlong)&local_18 + 4),0);
    local_18 = local_18 & 0xffffffff00000000 | (ulonglong)DVar1;
    if (local_18 != *(ulonglong *)(param_2 + 0x106)) {
      return 0;
    }
    if (*(longlong *)(param_2 + 2) == 8) {
      pvVar4 = param_1;
      if (*(char *)((longlong)param_2 + 0x451) != '\0') {
        pvVar4 = *(HANDLE *)(param_2 + 0x10c);
      }
      SetEndOfFile(pvVar4);
    }
    *(undefined *)(param_2 + 0x114) = 0;
  }
  uVar3 = FUN_18005e338(param_2,*(uint *)(param_3 + 2),local_res10);
  if ((int)uVar3 == 0) {
    return 0;
  }
  if (*(char *)((longlong)param_2 + 0x451) != '\0') {
    param_1 = *(HANDLE *)(param_2 + 0x10c);
  }
  BVar2 = WriteFile(param_1,*param_3,local_res10[0],local_res20,(LPOVERLAPPED)0x0);
  *(ulonglong *)(param_2 + 0x108) = *(longlong *)(param_2 + 0x108) + (ulonglong)local_res20[0];
  *(uint *)(param_3 + 2) = *(int *)(param_3 + 2) - local_res20[0];
                    // WARNING: Load size is inaccurate
  *(uint *)param_3[1] = *param_3[1] + local_res20[0];
  *param_3 = (LPCVOID)((longlong)*param_3 + (ulonglong)local_res20[0]);
  return BVar2;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18005e124(HANDLE param_1,int *param_2,LPCVOID *param_3)

{
  undefined8 uVar1;
  undefined8 local_res10;
  uint local_res18 [2];
  undefined local_18 [16];
  
  if (*(char *)((longlong)param_2 + 0x469) != '\0') {
    if ((*(byte *)(param_2 + 1) & 8) == 0) {
      local_res10 = *(undefined8 *)(param_2 + 2);
      SetFilePointer(param_1,(LONG)local_res10,(PLONG)((longlong)&local_res10 + 4),0);
      SetEndOfFile(param_1);
      local_res10 = 0;
      SetFilePointer(param_1,0,(PLONG)((longlong)&local_res10 + 4),0);
    }
    else {
      NtFsControlFile(param_1,0,0,0,local_18,0x900c4,0,0,0,0);
    }
    *(undefined *)((longlong)param_2 + 0x469) = 0;
  }
  uVar1 = FUN_18005e338(param_2,*(uint *)(param_3 + 2),(undefined4 *)&local_res10);
  if ((int)uVar1 != 0) {
    WriteFile(param_1,*param_3,(DWORD)local_res10,local_res18,(LPOVERLAPPED)0x0);
    *(ulonglong *)(param_2 + 0x108) = *(longlong *)(param_2 + 0x108) + (ulonglong)local_res18[0];
    *(uint *)(param_3 + 2) = *(int *)(param_3 + 2) - local_res18[0];
                    // WARNING: Load size is inaccurate
    *(uint *)param_3[1] = *param_3[1] + local_res18[0];
    *param_3 = (LPCVOID)((longlong)*param_3 + (ulonglong)local_res18[0]);
  }
  return;
}



undefined8 FUN_18005e248(undefined8 param_1,int *param_2,void **param_3)

{
  char cVar1;
  int iVar2;
  undefined7 extraout_var;
  undefined local_18 [16];
  
  cVar1 = FUN_18005d6cc(param_2,param_3);
  iVar2 = (int)CONCAT71(extraout_var,cVar1);
  if (iVar2 == 1) {
    iVar2 = NtFsControlFile(param_1,0,0,0,local_18,0x90200,*(undefined8 *)(param_2 + 0x110),
                            param_2[2],0,0);
    if (iVar2 < 0) {
      BaseSetLastNTError();
    }
  }
  else if (iVar2 != 2) {
    return 0;
  }
  return 1;
}



undefined8 FUN_18005e2dc(int *param_1,longlong *param_2)

{
  longlong lVar1;
  undefined8 uVar2;
  ulonglong uVar3;
  longlong lVar4;
  
  lVar4 = *(longlong *)(param_1 + 2);
  if ((lVar4 < 0) ||
     (uVar3 = (ulonglong)(uint)param_1[0x10b], (longlong)(uVar3 + lVar4) < (longlong)uVar3)) {
    RtlSetLastWin32Error(0xd);
    uVar2 = 0;
  }
  else {
    lVar4 = (uVar3 - *(longlong *)(param_1 + 0x108)) + lVar4;
    lVar1 = lVar4 + -8;
    if (*param_1 != 9) {
      lVar1 = lVar4;
    }
    *param_2 = lVar1;
    uVar2 = 1;
  }
  return uVar2;
}



undefined8 FUN_18005e338(int *param_1,uint param_2,undefined4 *param_3)

{
  undefined8 uVar1;
  ulonglong local_res20;
  
  uVar1 = FUN_18005e2dc(param_1,(longlong *)&local_res20);
  if ((int)uVar1 != 0) {
    uVar1 = 1;
    if ((longlong)(ulonglong)param_2 < (longlong)local_res20) {
      local_res20 = (ulonglong)param_2;
    }
    *param_3 = (int)local_res20;
  }
  return uVar1;
}



void FUN_18005e37c(longlong param_1)

{
  longlong in_GS_OFFSET;
  
  if (*(longlong *)(param_1 + 8) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
    *(undefined8 *)(param_1 + 8) = 0;
  }
  return;
}



void FUN_18005e3bc(longlong *param_1)

{
  longlong lVar1;
  longlong in_GS_OFFSET;
  
  lVar1 = *param_1;
  if (lVar1 != -1) {
    FUN_18005e37c(lVar1 + 0x438);
    FUN_18005e37c(lVar1 + 0x458);
    FUN_18005e4d8(*(HANDLE *)(lVar1 + 0x430));
    if ((longlong)*(HANDLE *)(lVar1 + 0x430) - 1U < 0xfffffffffffffffe) {
      CloseHandle(*(HANDLE *)(lVar1 + 0x430));
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lVar1);
    *param_1 = -1;
  }
  return;
}



undefined8 FUN_18005e448(uint *param_1,uint param_2)

{
  void *_Dst;
  longlong in_GS_OFFSET;
  
  if (param_1[1] < param_2) {
    _Dst = (void *)FUN_18005bacc(param_2);
    if (_Dst == (void *)0x0) {
      RtlSetLastWin32Error(8);
      return 0;
    }
    memcpy(_Dst,*(void **)(param_1 + 2),(ulonglong)*param_1);
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_1 + 2));
    *(void **)(param_1 + 2) = _Dst;
    param_1[1] = param_2;
  }
  *param_1 = param_2;
  return 1;
}



void FUN_18005e4d8(HANDLE param_1)

{
  FILETIME local_res8 [4];
  
  local_res8[0] = (FILETIME)0xffffffffffffffff;
  if ((longlong)param_1 - 1U < 0xfffffffffffffffe) {
    SetFileTime(param_1,local_res8,local_res8,local_res8);
  }
  return;
}



void FUN_18005e514(longlong param_1)

{
  code *pcVar1;
  int iVar2;
  longlong local_res8 [4];
  
  if ((param_1 != 0) &&
     (local_res8[0] = param_1, iVar2 = NtSetInformationThread(0xfffffffffffffffe,5,local_res8),
     iVar2 < 0)) {
    RtlRaiseStatus(iVar2);
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  return;
}



int FUN_18005e564(longlong *param_1)

{
  longlong lVar1;
  int iVar2;
  longlong in_GS_OFFSET;
  longlong local_res8;
  undefined8 local_res10;
  
  iVar2 = 0;
  local_res8 = 0;
  local_res10 = 0;
  lVar1 = *(longlong *)(in_GS_OFFSET + 0x30);
  *param_1 = 0;
  if (*(int *)(lVar1 + 0x179c) != 0) {
    iVar2 = NtOpenThreadToken(0xfffffffffffffffe,0x2000004,1,&local_res8);
    if ((-1 < iVar2) &&
       (iVar2 = NtSetInformationThread(0xfffffffffffffffe,5,&local_res10), -1 < iVar2)) {
      *param_1 = local_res8;
      local_res8 = 0;
    }
    if (local_res8 != 0) {
      NtClose();
    }
  }
  return iVar2;
}



void BaseWriteErrorElevationRequiredEvent(void)

{
  int iVar1;
  undefined8 local_res8 [4];
  
                    // 0x5e620  74  BaseWriteErrorElevationRequiredEvent
  iVar1 = EtwEventRegister(&DAT_1800884f8,0,0,local_res8);
  if (iVar1 == 0) {
    EtwEventWrite(local_res8[0],&DAT_1800884e8,0,0);
    EtwEventUnregister(local_res8[0]);
  }
  return;
}



void FUN_18005e680(undefined8 param_1,undefined8 param_2)

{
  int iVar1;
  undefined auStack152 [32];
  undefined4 local_78;
  undefined *local_70;
  undefined8 local_68;
  undefined local_60 [8];
  undefined4 local_58 [2];
  undefined8 local_50;
  undefined8 local_48;
  undefined4 local_40;
  undefined local_38 [16];
  undefined local_28 [16];
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack152;
  local_58[0] = 0x30;
  local_40 = 0x40;
  local_38 = ZEXT816(0);
  local_50 = param_1;
  local_48 = param_2;
  iVar1 = NtOpenKey(&local_68,0x80000000,local_58);
  if (-1 < iVar1) {
    local_70 = local_60;
    local_78 = 0x10;
    NtEnumerateValueKey(local_68,0,0,local_28);
    NtClose(local_68);
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack152);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18005e754(int *param_1,longlong param_2)

{
  int iVar1;
  undefined4 uVar2;
  longlong *plVar3;
  longlong lVar4;
  undefined auStackY680 [32];
  longlong local_278;
  longlong local_270;
  longlong lStack616;
  ushort *local_258;
  undefined2 local_250;
  undefined2 local_24e;
  undefined *local_248;
  undefined local_238 [8];
  undefined2 local_230;
  undefined local_22c [500];
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStackY680;
  lVar4 = DAT_1800b2bf8;
  if (*(longlong *)(param_2 + 0x18) != 0) {
    for (plVar3 = (longlong *)
                  ((*(longlong *)(param_2 + 0x18) - *(longlong *)(DAT_1800b2bf8 + 0x9e8)) +
                  DAT_1800b2bf8); plVar3 != (longlong *)0x0;
        plVar3 = (longlong *)((*plVar3 - *(longlong *)(lVar4 + 0x9e8)) + lVar4)) {
      local_270 = plVar3[1];
      if (plVar3[2] == 0) {
        lStack616 = 0;
      }
      else {
        lStack616 = plVar3[2] + (lVar4 - *(longlong *)(lVar4 + 0x9e8));
      }
      if ((((short)local_270 != 0) &&
          (iVar1 = FUN_18005f454(param_1,param_2,plVar3,(ushort *)&local_270), lVar4 = DAT_1800b2bf8
          , (iVar1 + 0x80000000U & 0x80000000) == 0)) && (iVar1 != -0x3fffffea)) goto LAB_18005e934;
      if (*plVar3 == 0) break;
    }
  }
  if (((*(longlong *)(param_2 + 0x20) != 0) &&
      (lVar4 = (*(longlong *)(param_2 + 0x20) - *(longlong *)(lVar4 + 0x9e8)) + lVar4, lVar4 != 0))
     && ((uVar2 = FUN_180011d50((longlong)param_1,(short **)0x0,(short **)&local_258),
         (char)uVar2 != '\0' &&
         ((iVar1 = FUN_180008bc8((longlong)param_1,lVar4,local_258,'\x01',&local_278), -1 < iVar1 &&
          (local_278 != -1)))))) {
    do {
      iVar1 = NtEnumerateValueKey(local_278,0,0,local_238);
      if (iVar1 < 0) break;
      local_248 = local_22c;
      local_250 = local_230;
      local_24e = local_230;
      iVar1 = NtDeleteValueKey(local_278);
      if (iVar1 == -0x3fffffcc) {
        iVar1 = 0;
      }
    } while (-1 < iVar1);
    NtClose(local_278);
  }
LAB_18005e934:
  __security_check_cookie(local_38 ^ (ulonglong)auStackY680);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18005eb74(int *param_1,longlong param_2)

{
  undefined4 uVar1;
  int iVar2;
  longlong lVar3;
  longlong *plVar4;
  longlong lVar5;
  int iVar6;
  undefined auStackY680 [32];
  longlong local_278 [2];
  longlong local_268;
  longlong lStack608;
  ushort *local_258;
  ushort local_250;
  ushort local_24e;
  undefined *local_248;
  undefined local_238 [8];
  ushort local_230;
  undefined local_22c [500];
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStackY680;
  iVar6 = 0;
  lVar3 = *(longlong *)(param_2 + 0x18);
  lVar5 = DAT_1800b2bf8;
  while ((lVar3 != 0 &&
         (plVar4 = (longlong *)((lVar3 - *(longlong *)(lVar5 + 0x9e8)) + lVar5),
         plVar4 != (longlong *)0x0))) {
    local_268 = plVar4[1];
    if (plVar4[2] == 0) {
      lStack608 = 0;
    }
    else {
      lStack608 = plVar4[2] + (lVar5 - *(longlong *)(lVar5 + 0x9e8));
    }
    if (((((short)local_268 != 0) &&
         (iVar2 = FUN_180008964(param_1,param_2,plVar4,(ushort *)&local_268), lVar5 = DAT_1800b2bf8,
         iVar2 < 0)) && (iVar2 != -0x3fffffcc)) && (iVar2 != -0x3fffffdc)) goto LAB_18005ed66;
    lVar3 = *plVar4;
  }
  if (((*(longlong *)(param_2 + 0x20) != 0) &&
      (lVar5 = (*(longlong *)(param_2 + 0x20) - *(longlong *)(lVar5 + 0x9e8)) + lVar5, lVar5 != 0))
     && ((uVar1 = FUN_180011d50((longlong)param_1,(short **)0x0,(short **)&local_258),
         (char)uVar1 != '\0' &&
         ((iVar2 = FUN_180008bc8((longlong)param_1,lVar5,local_258,'\0',local_278), -1 < iVar2 &&
          (local_278[0] != -1)))))) {
    while (iVar2 = NtEnumerateValueKey(local_278[0],iVar6,0,local_238), iVar2 != -0x7fffffe6) {
      if (iVar2 < 0) {
LAB_18005ed4c:
        NtClose(local_278[0]);
        goto LAB_18005ed66;
      }
      local_248 = local_22c;
      local_250 = local_230;
      local_24e = local_230;
      iVar2 = FUN_180008964(param_1,param_2,(longlong *)0x0,&local_250);
      if (((iVar2 < 0) && (iVar2 != -0x3fffffcc)) && (iVar2 != -0x3fffffdc)) goto LAB_18005ed4c;
      iVar6 = iVar6 + 1;
    }
    NtClose(local_278[0]);
  }
LAB_18005ed66:
  __security_check_cookie(local_38 ^ (ulonglong)auStackY680);
  return;
}



// Library Function - Single Match
//  BaseDllReadSectionNames
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

ulonglong BaseDllReadSectionNames(longlong param_1)

{
  ulonglong uVar1;
  
  do {
    uVar1 = FUN_18000fac0(param_1,1);
    if ((int)uVar1 != 0x105) {
      if ((int)uVar1 != -0x7fffffe6) {
        return uVar1 & 0xffffffff;
      }
      return 0;
    }
    uVar1 = FUN_18000f720(param_1,*(ushort **)(param_1 + 0xf8),*(ushort **)(param_1 + 0x140),'\x01')
    ;
  } while (-1 < (int)uVar1);
  return uVar1;
}



ulonglong FUN_18005edf0(int *param_1,longlong param_2)

{
  ushort *puVar1;
  short sVar2;
  uint uVar3;
  ulonglong uVar4;
  undefined4 *puVar5;
  ushort *puVar6;
  ushort *puVar7;
  uint uVar8;
  void *_Src;
  uint uVar9;
  ushort *_Src_00;
  longlong in_GS_OFFSET;
  uint local_74;
  uint local_70;
  ushort *local_68;
  longlong local_60;
  
  local_70 = 0xc000000d;
  uVar4 = 0;
  if (*param_1 == 8) {
    uVar4 = FUN_18005e754(param_1,param_2);
  }
  else {
    _Src = *(void **)(param_1 + 0x24);
    if (((_Src == (void *)0x0) || (uVar8 = param_1[0x26], uVar8 == 0)) &&
       ((_Src = *(void **)(param_1 + 0x28), _Src == (void *)0x0 ||
        (uVar8 = param_1[0x2a], uVar8 == 0)))) {
      uVar4 = 0xc000000d;
    }
    else {
      puVar5 = (undefined4 *)KernelBaseGetGlobalData();
      local_68 = (ushort *)
                 RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),*puVar5,
                                 uVar8);
      if (local_68 == (ushort *)0x0) {
        uVar4 = 0xc0000017;
      }
      else {
        local_60 = 0;
        RtlMoveMemory(local_68,_Src,(ulonglong)uVar8);
        local_74 = 0;
        puVar7 = local_68;
        while (uVar9 = (uint)uVar4, uVar8 != 0) {
          _Src_00 = puVar7;
          if (*(char *)((longlong)param_1 + 5) == '\0') {
            while( true ) {
              if (uVar8 == 0) goto LAB_18005f313;
              if (0x1f < (byte)(*(byte *)_Src_00 - 1)) break;
              uVar8 = uVar8 - 1;
              _Src_00 = (ushort *)((longlong)_Src_00 + 1);
            }
            if ((uVar8 == 0) || (*(byte *)_Src_00 == 0)) break;
            *(ushort **)(param_1 + 0x18) = _Src_00;
            puVar7 = _Src_00;
            while( true ) {
              if (uVar8 == 0) goto LAB_18005f313;
              if (*(byte *)puVar7 == 0x3d) break;
              uVar8 = uVar8 - 1;
              puVar7 = (ushort *)((longlong)puVar7 + 1);
            }
            puVar1 = puVar7;
            if (uVar8 == 0) break;
            do {
              puVar6 = puVar1;
              if (puVar6 < *(ushort **)(param_1 + 0x18) || puVar6 == *(ushort **)(param_1 + 0x18))
              break;
              puVar1 = (ushort *)((longlong)puVar6 + -1);
            } while (*(byte *)(ushort *)((longlong)puVar6 + -1) < 0x21);
            sVar2 = (short)puVar6 - *(short *)(param_1 + 0x18);
            *(short *)(param_1 + 0x16) = sVar2;
            if (sVar2 == 0) break;
            *(short *)((longlong)param_1 + 0x5a) = sVar2 + 1;
            do {
              uVar8 = uVar8 - 1;
              puVar7 = (ushort *)((longlong)puVar7 + 1);
              if (uVar8 == 0) break;
            } while (*(byte *)puVar7 == 0x20);
            *(ushort **)(param_1 + 0x24) = puVar7;
            while( true ) {
              if (uVar8 == 0) goto LAB_18005f313;
              if (*(byte *)puVar7 == 0) break;
              uVar8 = uVar8 - 1;
              puVar7 = (ushort *)((longlong)puVar7 + 1);
            }
            if (uVar8 == 0) break;
            param_1[0x26] = (uint)(ushort)((short)puVar7 - *(short *)(param_1 + 0x24));
            uVar8 = uVar8 - 1;
            puVar7 = (ushort *)((longlong)puVar7 + 1);
            uVar3 = (int)puVar7 - (int)_Src_00;
            *(short *)((longlong)param_1 + 0x7a) = *(short *)((longlong)param_1 + 0x5a) * 2;
            *(undefined2 *)(param_1 + 0x1e) = 0;
            puVar5 = (undefined4 *)KernelBaseGetGlobalData();
            local_60 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                       *puVar5);
            if (local_60 == 0) {
              local_70 = 0xc0000017;
              uVar9 = local_74;
              break;
            }
            *(longlong *)(param_1 + 0x20) = local_60;
            *(ulonglong *)(param_1 + 0x28) =
                 (ulonglong)*(ushort *)((longlong)param_1 + 0x7a) + local_60;
            uVar4 = (ulonglong)local_74;
          }
          else {
            uVar8 = uVar8 >> 1;
            while( true ) {
              if (uVar8 == 0) goto LAB_18005f313;
              if (0x1f < (ushort)(*_Src_00 - 1)) break;
              uVar8 = uVar8 - 1;
              _Src_00 = _Src_00 + 1;
            }
            if ((uVar8 == 0) || (*_Src_00 == 0)) break;
            *(ushort **)(param_1 + 0x20) = _Src_00;
            puVar7 = _Src_00;
            while( true ) {
              if (uVar8 == 0) goto LAB_18005f313;
              if (*puVar7 == 0x3d) break;
              uVar8 = uVar8 - 1;
              puVar7 = puVar7 + 1;
            }
            puVar1 = puVar7;
            if (uVar8 == 0) break;
            do {
              puVar6 = puVar1;
              if (puVar6 <= *(ushort **)(param_1 + 0x20)) break;
              puVar1 = puVar6 + -1;
            } while (puVar6[-1] < 0x21);
            sVar2 = (short)puVar6 - (short)*(ushort **)(param_1 + 0x20);
            *(short *)(param_1 + 0x1e) = sVar2;
            if (sVar2 == 0) break;
            *(short *)((longlong)param_1 + 0x7a) = sVar2 + 2;
            do {
              uVar8 = uVar8 - 1;
              puVar7 = puVar7 + 1;
              if (uVar8 == 0) break;
            } while (*puVar7 == 0x20);
            *(ushort **)(param_1 + 0x28) = puVar7;
            while( true ) {
              if (uVar8 == 0) goto LAB_18005f313;
              if (*puVar7 == 0) break;
              uVar8 = uVar8 - 1;
              puVar7 = puVar7 + 1;
            }
            if (uVar8 == 0) break;
            param_1[0x2a] = (uint)(ushort)((short)puVar7 - *(short *)(param_1 + 0x28));
            puVar7 = puVar7 + 1;
            uVar3 = (int)puVar7 - (int)_Src_00;
            uVar8 = (uVar8 - 1) * 2;
          }
          local_70 = FUN_18005f454(param_1,param_2,(longlong *)0x0,(ushort *)0x0);
          if (local_60 != 0) {
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
            local_60 = 0;
            RtlInitUnicodeString();
            *(undefined8 *)(param_1 + 0x28) = 0;
            param_1[0x2a] = 0;
            uVar4 = (ulonglong)local_74;
          }
          if ((int)local_70 < 0) {
            uVar9 = (uint)uVar4;
            if (local_70 != 0xc0000016) break;
            RtlMoveMemory((byte *)(uVar4 + (longlong)local_68),_Src_00,(ulonglong)uVar3);
            local_74 = (uint)uVar4 + uVar3;
            uVar4 = (ulonglong)local_74;
            local_70 = 0;
          }
        }
LAB_18005f313:
        if (uVar9 != 0) {
          *(undefined *)((longlong)param_1 + 6) = 1;
          if (*(char *)((longlong)param_1 + 5) == '\0') {
            *(ushort **)(param_1 + 0x24) = local_68;
            param_1[0x26] = uVar9;
          }
          else {
            *(ushort **)(param_1 + 0x28) = local_68;
            param_1[0x2a] = uVar9;
          }
          local_68 = (ushort *)0x0;
        }
        if (local_60 != 0) {
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_60);
        }
        if (local_68 != (ushort *)0x0) {
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_68);
        }
        uVar4 = (ulonglong)local_70;
      }
    }
  }
  return uVar4;
}



bool FUN_18005f3cf(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



void FUN_18005f3ef(undefined8 param_1,longlong param_2)

{
  longlong in_GS_OFFSET;
  
  if (*(longlong *)(param_2 + 0x38) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x38));
  }
  if (*(longlong *)(param_2 + 0x30) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x30));
  }
  return;
}



void FUN_18005f454(int *param_1,longlong param_2,longlong *param_3,ushort *param_4)

{
  ushort *puVar1;
  undefined4 uVar2;
  int iVar3;
  ulonglong uVar4;
  undefined auStackY152 [32];
  ushort *local_68;
  longlong local_60 [2];
  undefined8 local_50;
  undefined local_48 [4];
  int local_44;
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStackY152;
  local_68 = param_4;
  if ((((param_4 != (ushort *)0x0) ||
       (uVar2 = FUN_18000ff6c((longlong)param_1,(short **)0x0,(short **)&local_68),
       (char)uVar2 != '\0')) &&
      ((puVar1 = local_68, param_3 != (longlong *)0x0 ||
       (param_3 = FUN_1800088a0(param_2,local_68), param_3 != (longlong *)0x0)))) &&
     (((uVar2 = FUN_180011d50((longlong)param_1,(short **)0x0,(short **)&local_68),
       (char)uVar2 != '\0' &&
       (iVar3 = FUN_180008bc8((longlong)param_1,(longlong)param_3,local_68,'\x01',local_60),
       -1 < iVar3)) && (local_60[0] != -1)))) {
    iVar3 = NtQueryValueKey(local_60[0],puVar1,0,local_48);
    if ((((iVar3 + 0x80000000U & 0x80000000) == 0) && (iVar3 != -0x7ffffffb)) || (local_44 == 1)) {
      if ((*param_1 == 2) || (*param_1 == 7)) {
        uVar4 = FUN_180023058((longlong)param_1,(undefined8 *)0x0,&local_50,(uint *)&local_68);
        if ((char)uVar4 != '\0') {
          NtSetValueKey(local_60[0],puVar1,0,1);
        }
      }
      else {
        NtDeleteValueKey(local_60[0],puVar1);
      }
      NtClose(local_60[0]);
    }
    else {
      NtClose(local_60[0]);
    }
  }
  __security_check_cookie(local_38 ^ (ulonglong)auStackY152);
  return;
}



DWORD GetPrivateProfileSectionNamesA(LPSTR lpszReturnBuffer,DWORD nSize,LPCSTR lpFileName)

{
  DWORD DVar1;
  
                    // 0x5f620  690  GetPrivateProfileSectionNamesA
  DVar1 = GetPrivateProfileStringA
                    ((LPCSTR)0x0,(LPCSTR)0x0,(LPCSTR)0x0,lpszReturnBuffer,nSize,lpFileName);
  return DVar1;
}



DWORD GetPrivateProfileSectionNamesW(LPWSTR lpszReturnBuffer,DWORD nSize,LPCWSTR lpFileName)

{
  DWORD DVar1;
  
                    // 0x5f650  691  GetPrivateProfileSectionNamesW
  DVar1 = GetPrivateProfileStringW
                    ((LPCWSTR)0x0,(LPCWSTR)0x0,(LPCWSTR)0x0,lpszReturnBuffer,nSize,lpFileName);
  return DVar1;
}



BOOL GetPrivateProfileStructA
               (LPCSTR lpszSection,LPCSTR lpszKey,LPVOID lpStruct,UINT uSizeStruct,LPCSTR szFile)

{
  uint nSize;
  byte bVar1;
  DWORD DVar2;
  BOOL extraout_EAX;
  LPSTR pCVar3;
  undefined8 uVar4;
  char cVar5;
  int iVar6;
  byte bVar7;
  char *lpReturnedString;
  longlong in_GS_OFFSET;
  undefined auStackY408 [32];
  CHAR local_158 [256];
  ulonglong local_58;
  
                    // 0x5f680  695  GetPrivateProfileStructA
  local_58 = DAT_1800b2220 ^ (ulonglong)auStackY408;
  if (uSizeStruct < 0x7ffffffb) {
    nSize = uSizeStruct * 2 + 10;
    if (nSize < 0x101) {
      pCVar3 = (LPSTR)0x0;
      lpReturnedString = local_158;
    }
    else {
      pCVar3 = (LPSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
      lpReturnedString = pCVar3;
      if (pCVar3 == (LPSTR)0x0) goto LAB_18005f7e9;
    }
    DVar2 = GetPrivateProfileStringA(lpszSection,lpszKey,(LPCSTR)0x0,lpReturnedString,nSize,szFile);
    if (DVar2 == uSizeStruct * 2 + 2) {
      bVar7 = 0;
      for (iVar6 = uSizeStruct + 1; iVar6 != 0; iVar6 = iVar6 + -1) {
        cVar5 = *lpReturnedString;
        if (9 < (byte)(cVar5 - 0x30U)) {
          cVar5 = cVar5 + -7;
        }
        bVar1 = lpReturnedString[1] - 0x30;
        if (9 < bVar1) {
          bVar1 = lpReturnedString[1] - 7U & 0xf;
        }
        bVar1 = cVar5 << 4 | bVar1;
        if (iVar6 == 1) {
          if (bVar7 != bVar1) {
            uVar4 = 0xd;
            goto LAB_18005f7b7;
          }
          break;
        }
        *(byte *)lpStruct = bVar1;
        bVar7 = bVar7 + bVar1;
        lpStruct = (LPVOID)((longlong)lpStruct + 1);
        lpReturnedString = lpReturnedString + 2;
      }
    }
    else {
      uVar4 = 0x18;
LAB_18005f7b7:
      RtlSetLastWin32Error(uVar4);
    }
    if (pCVar3 != (LPSTR)0x0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pCVar3);
    }
  }
  else {
    RtlSetLastWin32Error(0x57);
  }
LAB_18005f7e9:
  __security_check_cookie(local_58 ^ (ulonglong)auStackY408);
  return extraout_EAX;
}



BOOL GetPrivateProfileStructW
               (LPCWSTR lpszSection,LPCWSTR lpszKey,LPVOID lpStruct,UINT uSizeStruct,LPCWSTR szFile)

{
  uint nSize;
  DWORD DVar1;
  BOOL extraout_EAX;
  LPWSTR pWVar2;
  char cVar3;
  char cVar4;
  byte bVar5;
  undefined8 uVar6;
  LPWSTR lpReturnedString;
  int iVar7;
  byte bVar8;
  longlong in_GS_OFFSET;
  undefined auStackY664 [32];
  WCHAR local_258 [256];
  ulonglong local_58;
  
                    // 0x5f820  696  GetPrivateProfileStructW
  local_58 = DAT_1800b2220 ^ (ulonglong)auStackY664;
  nSize = uSizeStruct * 2 + 10;
  if (nSize < uSizeStruct) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    if ((nSize < 0x201) && ((ulonglong)nSize * 2 < 0x201)) {
      pWVar2 = (LPWSTR)0x0;
      lpReturnedString = local_258;
    }
    else {
      pWVar2 = (LPWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0)
      ;
      lpReturnedString = pWVar2;
      if (pWVar2 == (LPWSTR)0x0) goto LAB_18005f99b;
    }
    DVar1 = GetPrivateProfileStringW(lpszSection,lpszKey,(LPCWSTR)0x0,lpReturnedString,nSize,szFile)
    ;
    if (DVar1 == uSizeStruct * 2 + 2) {
      bVar8 = 0;
      for (iVar7 = uSizeStruct + 1; iVar7 != 0; iVar7 = iVar7 + -1) {
        cVar3 = (char)*lpReturnedString;
        if (9 < (ushort)(*lpReturnedString + L'￐')) {
          cVar3 = cVar3 + -7;
        }
        cVar4 = (char)lpReturnedString[1];
        if ((ushort)(lpReturnedString[1] + L'￐') < 10) {
          bVar5 = cVar4 - 0x30;
        }
        else {
          bVar5 = cVar4 - 7U & 0xf;
        }
        bVar5 = cVar3 << 4 | bVar5;
        if (iVar7 == 1) {
          if (bVar8 != bVar5) {
            uVar6 = 0xd;
            goto LAB_18005f969;
          }
          break;
        }
        *(byte *)lpStruct = bVar5;
        bVar8 = bVar8 + bVar5;
        lpStruct = (LPVOID)((longlong)lpStruct + 1);
        lpReturnedString = lpReturnedString + 2;
      }
    }
    else {
      uVar6 = 0x18;
LAB_18005f969:
      RtlSetLastWin32Error(uVar6);
    }
    if (pWVar2 != (LPWSTR)0x0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pWVar2);
    }
  }
LAB_18005f99b:
  __security_check_cookie(local_58 ^ (ulonglong)auStackY664);
  return extraout_EAX;
}



DWORD GetProfileSectionA(LPCSTR lpAppName,LPSTR lpReturnedString,DWORD nSize)

{
  DWORD DVar1;
  
                    // 0x5f9d0  721  GetProfileSectionA
  DVar1 = GetPrivateProfileSectionA(lpAppName,lpReturnedString,nSize,(LPCSTR)0x0);
  return DVar1;
}



DWORD GetProfileSectionW(LPCWSTR lpAppName,LPWSTR lpReturnedString,DWORD nSize)

{
  DWORD DVar1;
  
                    // 0x5f9e0  722  GetProfileSectionW
  DVar1 = GetPrivateProfileSectionW(lpAppName,lpReturnedString,nSize,(LPCWSTR)0x0);
  return DVar1;
}



DWORD GetProfileStringA(LPCSTR lpAppName,LPCSTR lpKeyName,LPCSTR lpDefault,LPSTR lpReturnedString,
                       DWORD nSize)

{
  DWORD DVar1;
  
                    // 0x5f9f0  723  GetProfileStringA
  DVar1 = GetPrivateProfileStringA(lpAppName,lpKeyName,lpDefault,lpReturnedString,nSize,(LPCSTR)0x0)
  ;
  return DVar1;
}



DWORD GetProfileStringW(LPCWSTR lpAppName,LPCWSTR lpKeyName,LPCWSTR lpDefault,
                       LPWSTR lpReturnedString,DWORD nSize)

{
  DWORD DVar1;
  
                    // 0x5fa20  724  GetProfileStringW
  DVar1 = GetPrivateProfileStringW
                    (lpAppName,lpKeyName,lpDefault,lpReturnedString,nSize,(LPCWSTR)0x0);
  return DVar1;
}



BOOL WritePrivateProfileSectionA(LPCSTR lpAppName,LPCSTR lpString,LPCSTR lpFileName)

{
  int iVar1;
  BOOL BVar2;
  
                    // 0x5fa50  1577  WritePrivateProfileSectionA
  iVar1 = BaseDllReadWriteIniFile
                    ('\0','\x01','\x01',(LPCWSTR)lpFileName,(short *)lpAppName,(short *)0x0,
                     (short *)lpString,(int *)0x0);
  if (iVar1 < 0) {
    if (iVar1 == -0x3fffff85) {
      RtlSetLastWin32Error(0xd);
    }
    else {
      BaseSetLastNTError();
    }
    BVar2 = 0;
  }
  else {
    BVar2 = 1;
  }
  return BVar2;
}



BOOL WritePrivateProfileStringA(LPCSTR lpAppName,LPCSTR lpKeyName,LPCSTR lpString,LPCSTR lpFileName)

{
  int iVar1;
  BOOL BVar2;
  
                    // 0x5fac0  1579  WritePrivateProfileStringA
  iVar1 = BaseDllReadWriteIniFile
                    ('\0','\x01','\0',(LPCWSTR)lpFileName,(short *)lpAppName,(short *)lpKeyName,
                     (short *)(-(ulonglong)(lpKeyName != (LPCSTR)0x0) & (ulonglong)lpString),
                     (int *)0x0);
  if (iVar1 < 0) {
    if (iVar1 == -0x3fffff85) {
      RtlSetLastWin32Error(0xd);
    }
    else {
      BaseSetLastNTError();
    }
    BVar2 = 0;
  }
  else {
    BVar2 = 1;
  }
  return BVar2;
}



BOOL WritePrivateProfileStructA
               (LPCSTR lpszSection,LPCSTR lpszKey,LPVOID lpStruct,UINT uSizeStruct,LPCSTR szFile)

{
  byte bVar1;
  uint uVar2;
  BOOL extraout_EAX;
  LPCSTR pCVar3;
  LPCSTR pCVar4;
  CHAR *lpString;
  byte bVar5;
  longlong in_GS_OFFSET;
  undefined auStack344 [32];
  CHAR local_138 [256];
  ulonglong local_38;
  
                    // 0x5fb30  1581  WritePrivateProfileStructA
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack344;
  if (lpStruct == (LPVOID)0x0) {
    WritePrivateProfileStringA(lpszSection,lpszKey,(LPCSTR)0x0,szFile);
  }
  else {
    uVar2 = uSizeStruct * 2 + 3;
    if (uVar2 < uSizeStruct) {
      RtlSetLastWin32Error(0x57);
    }
    else {
      if (uVar2 < 0x101) {
        pCVar3 = (LPCSTR)0x0;
        lpString = local_138;
      }
      else {
        pCVar3 = (LPCSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                         0,uVar2);
        lpString = pCVar3;
        if (pCVar3 == (LPCSTR)0x0) goto LAB_18005fc64;
      }
      bVar5 = 0;
      pCVar4 = lpString;
      if (uSizeStruct != 0) {
        do {
                    // WARNING: Load size is inaccurate
          bVar1 = *lpStruct;
          lpStruct = (LPVOID)((longlong)lpStruct + 1);
          bVar5 = bVar5 + bVar1;
          *pCVar4 = "0123456789ABCDEFClientProcessId"[bVar1 >> 4];
          pCVar4[1] = "0123456789ABCDEFClientProcessId"[bVar1 & 0xf];
          pCVar4 = pCVar4 + 2;
          uSizeStruct = uSizeStruct - 1;
        } while (uSizeStruct != 0);
      }
      *pCVar4 = "0123456789ABCDEFClientProcessId"[bVar5 >> 4];
      pCVar4[1] = "0123456789ABCDEFClientProcessId"[bVar5 & 0xf];
      pCVar4[2] = '\0';
      WritePrivateProfileStringA(lpszSection,lpszKey,lpString,szFile);
      if (pCVar3 != (LPCSTR)0x0) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pCVar3);
      }
    }
  }
LAB_18005fc64:
  __security_check_cookie(local_38 ^ (ulonglong)auStack344);
  return extraout_EAX;
}



BOOL WritePrivateProfileStructW
               (LPCWSTR lpszSection,LPCWSTR lpszKey,LPVOID lpStruct,UINT uSizeStruct,LPCWSTR szFile)

{
  byte bVar1;
  uint uVar2;
  BOOL extraout_EAX;
  LPCWSTR pWVar3;
  LPCWSTR pWVar4;
  WCHAR *lpString;
  ulonglong uVar5;
  longlong in_GS_OFFSET;
  undefined auStack616 [32];
  WCHAR local_248 [256];
  ulonglong local_48;
  
                    // 0x5fca0  1582  WritePrivateProfileStructW
  local_48 = DAT_1800b2220 ^ (ulonglong)auStack616;
  pWVar3 = (LPCWSTR)0x0;
  if (lpStruct == (LPVOID)0x0) {
    WritePrivateProfileStringW(lpszSection,lpszKey,(LPCWSTR)0x0,szFile);
  }
  else {
    uVar2 = uSizeStruct * 2 + 3;
    if (uVar2 < uSizeStruct) {
      RtlSetLastWin32Error(0x57);
    }
    else {
      if ((ulonglong)uVar2 * 2 < 0x201) {
        lpString = local_248;
      }
      else {
        pWVar3 = (LPCWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30)
                                          ,0);
        lpString = pWVar3;
        if (pWVar3 == (LPCWSTR)0x0) goto LAB_18005fde5;
      }
      uVar5 = 0;
      pWVar4 = lpString;
      if (uSizeStruct != 0) {
        do {
                    // WARNING: Load size is inaccurate
          bVar1 = *lpStruct;
          lpStruct = (LPVOID)((longlong)lpStruct + 1);
          uVar5 = (ulonglong)(byte)((char)uVar5 + bVar1);
          *pWVar4 = (short)"0123456789ABCDEFClientProcessId"[bVar1 >> 4];
          pWVar4[1] = (short)"0123456789ABCDEFClientProcessId"[bVar1 & 0xf];
          pWVar4 = pWVar4 + 2;
          uSizeStruct = uSizeStruct - 1;
        } while (uSizeStruct != 0);
      }
      *pWVar4 = (short)"0123456789ABCDEFClientProcessId"[uVar5 >> 4];
      pWVar4[1] = (short)"0123456789ABCDEFClientProcessId"[(uint)uVar5 & 0xf];
      pWVar4[2] = L'\0';
      WritePrivateProfileStringW(lpszSection,lpszKey,lpString,szFile);
      if (pWVar3 != (LPCWSTR)0x0) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pWVar3);
      }
    }
  }
LAB_18005fde5:
  __security_check_cookie(local_48 ^ (ulonglong)auStack616);
  return extraout_EAX;
}



BOOL WriteProfileSectionA(LPCSTR lpAppName,LPCSTR lpString)

{
  BOOL BVar1;
  
                    // 0x5fe10  1584  WriteProfileSectionA
  BVar1 = WritePrivateProfileSectionA(lpAppName,lpString,(LPCSTR)0x0);
  return BVar1;
}



BOOL WriteProfileSectionW(LPCWSTR lpAppName,LPCWSTR lpString)

{
  BOOL BVar1;
  
                    // 0x5fe20  1585  WriteProfileSectionW
  BVar1 = WritePrivateProfileSectionW(lpAppName,lpString,(LPCWSTR)0x0);
  return BVar1;
}



BOOL WriteProfileStringA(LPCSTR lpAppName,LPCSTR lpKeyName,LPCSTR lpString)

{
  BOOL BVar1;
  
                    // 0x5fe30  1586  WriteProfileStringA
  BVar1 = WritePrivateProfileStringA(lpAppName,lpKeyName,lpString,(LPCSTR)0x0);
  return BVar1;
}



BOOL WriteProfileStringW(LPCWSTR lpAppName,LPCWSTR lpKeyName,LPCWSTR lpString)

{
  BOOL BVar1;
  
                    // 0x5fe40  1587  WriteProfileStringW
  BVar1 = WritePrivateProfileStringW(lpAppName,lpKeyName,lpString,(LPCWSTR)0x0);
  return BVar1;
}



undefined8 BaseIsDosApplication(ushort *param_1)

{
  char cVar1;
  undefined2 local_18 [4];
  longlong local_10;
  
                    // 0x5fe50  65  BaseIsDosApplication
  local_18[0] = 8;
  if (7 < *param_1) {
    local_10 = *(longlong *)(param_1 + 4) + ((ulonglong)*param_1 - 8 & 0xfffffffffffffffe);
    cVar1 = RtlEqualUnicodeString(local_18,&DAT_1800806b0,1);
    if (cVar1 != '\0') {
      return 2;
    }
    local_18[0] = 8;
    if (7 < *param_1) {
      local_10 = *(longlong *)(param_1 + 4) + ((ulonglong)*param_1 - 8 & 0xfffffffffffffffe);
      cVar1 = RtlEqualUnicodeString(local_18,&DAT_1800806a0,1);
      if (cVar1 != '\0') {
        return 3;
      }
      local_18[0] = 8;
      if (7 < *param_1) {
        local_10 = *(longlong *)(param_1 + 4) + ((ulonglong)*param_1 - 8 & 0xfffffffffffffffe);
        cVar1 = RtlEqualUnicodeString(local_18,&DAT_1800806c0,1);
        if (cVar1 != '\0') {
          return 1;
        }
      }
    }
  }
  return 0;
}



BOOL GetBinaryType(LPCSTR lpApplicationName,LPDWORD lpBinaryType)

{
  int iVar1;
  undefined8 uVar2;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x5ff60  456  GetBinaryType
                    // 0x5ff60  457  GetBinaryTypeA
  uVar2 = Basep8BitStringToDynamicUnicodeString();
  iVar1 = (int)uVar2;
  if (iVar1 != 0) {
    iVar1 = GetBinaryTypeW(local_10,lpBinaryType);
    RtlFreeUnicodeString(local_18);
  }
  return iVar1;
}



// WARNING: Could not reconcile some variable overlaps

BOOL GetBinaryTypeW(LPCWSTR lpApplicationName,LPDWORD lpBinaryType)

{
  char cVar1;
  int iVar2;
  undefined8 uVar3;
  longlong lVar4;
  DWORD DVar5;
  BOOL BVar6;
  longlong in_GS_OFFSET;
  longlong local_res18;
  undefined8 local_res20;
  undefined8 in_stack_ffffffffffffff08;
  undefined4 uVar7;
  longlong local_d0;
  undefined4 local_c8;
  undefined4 uStack196;
  undefined4 uStack192;
  undefined4 uStack188;
  undefined4 local_b8;
  undefined4 uStack180;
  undefined4 uStack176;
  undefined4 uStack172;
  undefined8 local_a8;
  undefined4 local_98 [2];
  undefined8 local_90;
  undefined4 *local_88;
  undefined4 local_80;
  undefined local_78 [16];
  undefined local_68 [32];
  int local_48;
  ushort local_3c;
  short local_38;
  undefined local_28 [16];
  
                    // 0x5ffb0  458  GetBinaryTypeW
  uVar7 = (undefined4)((ulonglong)in_stack_ffffffffffffff08 >> 0x20);
  BVar6 = 0;
  local_d0 = 0;
  local_res18 = 0;
  cVar1 = RtlDosPathNameToRelativeNtPathName_U(lpApplicationName,&local_c8,0,&local_b8);
  if (cVar1 != '\0') {
    local_d0 = CONCAT44(uStack188,uStack192);
    if ((short)local_b8 == 0) {
      local_a8 = 0;
    }
    else {
      local_c8 = local_b8;
      uStack196 = uStack180;
      uStack192 = uStack176;
      uStack188 = uStack172;
    }
    local_98[0] = 0x30;
    local_80 = 0x40;
    local_88 = &local_c8;
    local_78 = ZEXT816(0);
    uVar3 = CONCAT44(uVar7,5);
    local_90 = local_a8;
    iVar2 = NtOpenFile(&local_res20,0x100020,local_98,local_28,uVar3,0x60);
    uVar7 = (undefined4)((ulonglong)uVar3 >> 0x20);
    RtlReleaseRelativeName(&local_b8);
    if (-1 < iVar2) {
      iVar2 = NtCreateSection(&local_res18,0xf001f,0,0,CONCAT44(uVar7,0x10),0x1000000,local_res20);
      NtClose(local_res20);
      DVar5 = 0;
      if (iVar2 < 0) {
        local_res18 = 0;
        if (iVar2 == -0x3ffffee5) {
LAB_1800601a6:
          DVar5 = 1;
        }
        else if (iVar2 == -0x3ffffed1) {
          uVar3 = BaseIsDosApplication((ushort *)&local_c8);
          if ((int)uVar3 == 0) goto LAB_18005fffb;
          DVar5 = 1;
          if ((int)uVar3 == 3) {
            DVar5 = 3;
          }
        }
        else {
          if (iVar2 == -0x3ffffed0) goto LAB_1800601a6;
          if (iVar2 == -0x3ffffecf) {
            DVar5 = 2;
          }
          else if ((iVar2 != -0x3ffffca7) && (DVar5 = 6, iVar2 != -0x3ffffca6)) goto LAB_18005fffb;
        }
LAB_180060276:
        BVar6 = 1;
        *lpBinaryType = DVar5;
        goto LAB_180060278;
      }
      iVar2 = NtQuerySection(local_res18,1,local_68,0x40,0);
      if (-1 < iVar2) {
        if ((local_3c & 0x2000) != 0) {
LAB_1800601f9:
          RtlSetLastWin32Error(0xc1);
          goto LAB_180060278;
        }
        lVar4 = RtlImageNtHeader();
        if (local_38 == *(short *)(lVar4 + 4)) {
          DVar5 = 6;
          if (local_48 == 7) {
            DVar5 = 4;
          }
        }
        else {
          if (local_38 != 0x14c) goto LAB_1800601f9;
          if (local_48 == 7) {
            DVar5 = 4;
          }
        }
        goto LAB_180060276;
      }
    }
  }
LAB_18005fffb:
  BaseSetLastNTError();
LAB_180060278:
  if (local_res18 != 0) {
    NtClose();
  }
  if (local_d0 != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_d0);
  }
  return BVar6;
}



void FUN_1800602cf(undefined8 param_1,longlong param_2)

{
  longlong in_GS_OFFSET;
  
  if (*(longlong *)(param_2 + 0x130) != 0) {
    NtClose();
  }
  if (*(longlong *)(param_2 + 0x48) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x48));
  }
  return;
}



DWORD GetLongPathNameTransactedW
                (LPCWSTR lpszShortPath,LPWSTR lpszLongPath,DWORD cchBuffer,HANDLE hTransaction)

{
  DWORD DVar1;
  longlong lVar2;
  undefined8 uVar3;
  
                    // 0x60330  631  GetLongPathNameTransactedW
  if ((longlong)hTransaction - 1U < 0xfffffffffffffffe) {
    lVar2 = RtlGetCurrentTransaction();
    if (lVar2 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      DVar1 = GetLongPathNameW(lpszShortPath,lpszLongPath,cchBuffer);
      RtlSetCurrentTransaction(0);
      return DVar1;
    }
    uVar3 = 0x1a45;
  }
  else {
    uVar3 = 0x1a2c;
  }
  RtlSetLastWin32Error(uVar3);
  return 0;
}



void FUN_1800603d8(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800603e8. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlSetCurrentTransaction(0);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

DWORD GetShortPathNameA(LPCSTR lpszLongPath,LPSTR lpszShortPath,DWORD cchBuffer)

{
  DWORD extraout_EAX;
  DWORD DVar1;
  int iVar2;
  undefined8 uVar3;
  int *piVar4;
  LPWSTR lpszShortPath_00;
  code *pcVar5;
  longlong in_GS_OFFSET;
  undefined auStack696 [32];
  uint local_298;
  LPWSTR local_290;
  undefined local_288 [2];
  short local_286;
  LPCWSTR local_280;
  DWORD local_278;
  ushort local_270 [4];
  void *local_268;
  short local_260;
  LPWSTR local_258;
  WCHAR local_248 [264];
  ulonglong local_38;
  
                    // 0x60400  727  GetShortPathNameA
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack696;
  lpszShortPath_00 = (LPWSTR)0x0;
  local_290 = (LPWSTR)0x0;
  if (lpszLongPath == (LPCSTR)0x0) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    local_268 = (void *)0x0;
    local_280 = (LPCWSTR)0x0;
    local_298 = 0;
    uVar3 = Basep8BitStringToDynamicUnicodeString();
    if ((int)uVar3 != 0) {
      lpszShortPath_00 = local_248;
      local_290 = lpszShortPath_00;
      DVar1 = GetShortPathNameW(local_280,local_248,0x104);
      local_278 = DVar1;
      if (0x103 < DVar1) {
        piVar4 = (int *)KernelBaseGetGlobalData();
        lpszShortPath_00 =
             (LPWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                     *piVar4 + 0x200000);
        local_290 = lpszShortPath_00;
        if (lpszShortPath_00 == (LPWSTR)0x0) {
          DVar1 = 0;
          RtlSetLastWin32Error(8);
        }
        else {
          DVar1 = GetShortPathNameW(local_280,lpszShortPath_00,local_278);
        }
      }
      if (DVar1 != 0) {
        local_286 = ((short)DVar1 + 1) * 2;
        local_260 = (short)DVar1 * 2;
        local_258 = lpszShortPath_00;
        pcVar5 = (code *)GetUnicodeStringToEightBitStringRoutine();
        iVar2 = (*pcVar5)();
        if (iVar2 < 0) {
          BaseSetLastNTError();
          local_298 = 0;
        }
        else {
          local_298 = (uint)local_270[0];
          if ((lpszShortPath == (LPSTR)0x0) || (cchBuffer < local_298 || cchBuffer == local_270[0]))
          {
            local_298 = local_270[0] + 1;
          }
          else {
            RtlMoveMemory(lpszShortPath,local_268,(ulonglong)local_270[0]);
            lpszShortPath[local_270[0]] = '\0';
          }
        }
      }
    }
    if (local_280 != (LPCWSTR)0x0) {
      RtlFreeUnicodeString(local_288);
    }
    if (local_268 != (void *)0x0) {
      RtlFreeAnsiString(local_270);
    }
    if ((lpszShortPath_00 != (LPWSTR)0x0) && (lpszShortPath_00 != local_248)) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_290);
    }
  }
  __security_check_cookie(local_38 ^ (ulonglong)auStack696);
  return extraout_EAX;
}



BOOL CallNamedPipeA(LPCSTR lpNamedPipeName,LPVOID lpInBuffer,DWORD nInBufferSize,LPVOID lpOutBuffer,
                   DWORD nOutBufferSize,LPDWORD lpBytesRead,DWORD nTimeOut)

{
  int iVar1;
  undefined8 uVar2;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x606a0  112  CallNamedPipeA
  uVar2 = Basep8BitStringToDynamicUnicodeString();
  iVar1 = (int)uVar2;
  if (iVar1 != 0) {
    iVar1 = CallNamedPipeW(local_10,lpInBuffer,nInBufferSize,lpOutBuffer,nOutBufferSize,lpBytesRead,
                           nTimeOut);
    RtlFreeUnicodeString(local_18);
  }
  return iVar1;
}



HANDLE CreateNamedPipeA(LPCSTR lpName,DWORD dwOpenMode,DWORD dwPipeMode,DWORD nMaxInstances,
                       DWORD nOutBufferSize,DWORD nInBufferSize,DWORD nDefaultTimeOut,
                       LPSECURITY_ATTRIBUTES lpSecurityAttributes)

{
  undefined8 uVar1;
  HANDLE pvVar2;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x60740  223  CreateNamedPipeA
  uVar1 = Basep8BitStringToDynamicUnicodeString();
  if ((int)uVar1 == 0) {
    pvVar2 = (HANDLE)0xffffffffffffffff;
  }
  else {
    pvVar2 = CreateNamedPipeW(local_10,dwOpenMode,dwPipeMode,nMaxInstances,nOutBufferSize,
                              nInBufferSize,nDefaultTimeOut,lpSecurityAttributes);
    RtlFreeUnicodeString(local_18);
  }
  return pvVar2;
}



BOOL GetNamedPipeClientComputerNameA
               (HANDLE Pipe,LPSTR ClientComputerName,ULONG ClientComputerNameLength)

{
  BOOL extraout_EAX;
  BOOL BVar1;
  int iVar2;
  undefined auStack616 [32];
  ushort local_248 [4];
  char *local_240;
  undefined local_238 [16];
  WCHAR local_228 [264];
  ulonglong local_18;
  
                    // 0x607f0  646  GetNamedPipeClientComputerNameA
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack616;
  if (ClientComputerNameLength == 0) {
    RtlSetLastWin32Error(0x7a);
  }
  else {
    BVar1 = GetNamedPipeClientComputerNameW(Pipe,local_228,0x208);
    if (BVar1 != 0) {
      RtlInitUnicodeString(local_238,local_228);
      iVar2 = RtlUnicodeStringToAnsiString(local_248,local_238);
      if (iVar2 < 0) {
        BaseSetLastNTError();
      }
      else {
        if (*local_240 == '\0') {
          *ClientComputerName = '\0';
        }
        else if (ClientComputerNameLength < local_248[0] + 1) {
          RtlSetLastWin32Error(0x7a);
        }
        else {
          ClientComputerName[local_248[0]] = '\0';
          memcpy(ClientComputerName,local_240,(ulonglong)local_248[0]);
        }
        RtlFreeAnsiString(local_248);
      }
    }
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack616);
  return extraout_EAX;
}



BOOL GetNamedPipeClientProcessId(HANDLE Pipe,PULONG ClientProcessId)

{
  BOOL BVar1;
  ULONG_PTR local_res18 [2];
  
                    // 0x60940  648  GetNamedPipeClientProcessId
  local_res18[0] = 4;
  BVar1 = GetNamedPipeAttribute
                    (Pipe,PipeConnectionAttribute,"ClientProcessId",ClientProcessId,local_res18);
  return BVar1;
}



BOOL GetNamedPipeHandleStateA
               (HANDLE hNamedPipe,LPDWORD lpState,LPDWORD lpCurInstances,
               LPDWORD lpMaxCollectionCount,LPDWORD lpCollectDataTimeout,LPSTR lpUserName,
               DWORD nMaxUserNameSize)

{
  BOOL BVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  longlong in_GS_OFFSET;
  undefined local_28 [2];
  ushort local_26;
  LPWSTR local_20;
  undefined local_18 [2];
  short local_16;
  LPSTR local_10;
  
                    // 0x60980  650  GetNamedPipeHandleStateA
  if (lpUserName == (LPSTR)0x0) {
    BVar1 = GetNamedPipeHandleStateW
                      (hNamedPipe,lpState,lpCurInstances,lpMaxCollectionCount,lpCollectDataTimeout,
                       (LPWSTR)0x0,0);
  }
  else {
    local_10 = lpUserName;
    local_16 = (short)(nMaxUserNameSize & 0xffff);
    if (((nMaxUserNameSize & 0xffff) < nMaxUserNameSize) ||
       (local_26 = local_16 * 2, local_26 < nMaxUserNameSize)) {
      uVar4 = 0x57;
    }
    else {
      puVar3 = (undefined4 *)KernelBaseGetGlobalData();
      local_20 = (LPWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                         *puVar3,local_26);
      if (local_20 != (LPWSTR)0x0) {
        BVar1 = GetNamedPipeHandleStateW
                          (hNamedPipe,lpState,lpCurInstances,lpMaxCollectionCount,
                           lpCollectDataTimeout,local_20,(uint)(local_26 >> 1));
        if (BVar1 != 0) {
          RtlInitUnicodeString(local_28,local_20);
          iVar2 = RtlUnicodeStringToAnsiString(local_18,local_28,0);
          if (iVar2 < 0) {
            BaseSetLastNTError();
            BVar1 = 0;
          }
        }
        if (local_20 == (LPWSTR)0x0) {
          return BVar1;
        }
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_20);
        return BVar1;
      }
      uVar4 = 8;
    }
    RtlSetLastWin32Error(uVar4);
    BVar1 = 0;
  }
  return BVar1;
}



BOOL GetNamedPipeServerProcessId(HANDLE Pipe,PULONG ServerProcessId)

{
  BOOL BVar1;
  ULONG_PTR local_res18 [2];
  
                    // 0x60b10  653  GetNamedPipeServerProcessId
  local_res18[0] = 4;
  BVar1 = GetNamedPipeAttribute(Pipe,PipeAttribute,"ServerProcessId",ServerProcessId,local_res18);
  return BVar1;
}



BOOL WaitNamedPipeA(LPCSTR lpNamedPipeName,DWORD nTimeOut)

{
  int iVar1;
  undefined8 uVar2;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x60b50  1521  WaitNamedPipeA
  uVar2 = Basep8BitStringToDynamicUnicodeString();
  iVar1 = (int)uVar2;
  if (iVar1 != 0) {
    iVar1 = WaitNamedPipeW(local_10,nTimeOut);
    RtlFreeUnicodeString(local_18);
  }
  return iVar1;
}



undefined8 CheckForReadOnlyResource(int **param_1,uint param_2)

{
  int *piVar1;
  bool bVar2;
  int iVar3;
  ulonglong uVar4;
  uint local_res10 [6];
  ulonglong local_98;
  undefined4 local_90;
  undefined local_8c [4];
  ulonglong local_88;
  undefined8 local_80;
  undefined8 local_78 [2];
  byte local_68;
  undefined local_60 [36];
  int local_3c;
  int local_38;
  
                    // 0x60ba0  127  CheckForReadOnlyResource
  if (((((param_2 & 0xfffffffe) == 0) && (piVar1 = *param_1, *piVar1 == -0x3ffffffb)) &&
      (*(longlong *)(piVar1 + 8) == 1)) && (1 < (uint)piVar1[6])) {
    local_98 = *(ulonglong *)(piVar1 + 10);
    iVar3 = NtQueryVirtualMemory(0xffffffffffffffff,local_98,0,local_60,0x30,0);
    if (-1 < iVar3) {
      if (local_3c != 2) {
        return 0;
      }
      if (local_38 == 0x1000000) {
        uVar4 = local_98;
        iVar3 = NtQueryVirtualMemory(0xffffffffffffffff,local_98,6,local_78,0x18,0);
        if (iVar3 < 0) {
          return 0;
        }
        if ((local_68 & 1) != 0) {
          return 0;
        }
        local_88 = RtlImageDirectoryEntryToData
                             (local_78[0],uVar4 & 0xffffffffffffff00 | 1,2,local_res10);
        local_90 = 0;
        bVar2 = false;
        if (((local_88 != 0) && (local_88 <= local_98)) &&
           (bVar2 = false, local_98 < local_res10[0] + local_88)) {
          bVar2 = true;
        }
      }
      else {
        bVar2 = false;
        if ((local_38 == 0x40000) && (bVar2 = false, (param_2 & 1) != 0)) {
          bVar2 = true;
        }
      }
      if (!bVar2) {
        return 0;
      }
      local_80 = 1;
      iVar3 = NtProtectVirtualMemory(0xffffffffffffffff,&local_98,&local_80,8,local_8c);
      if (-1 < iVar3) {
        return 0xffffffff;
      }
      return 0;
    }
  }
  return 0;
}



HANDLE CreateBoundaryDescriptorA(LPCSTR Name,ULONG Flags)

{
  undefined8 uVar1;
  HANDLE pvVar2;
  undefined local_18 [16];
  
                    // 0x60d60  182  CreateBoundaryDescriptorA
  if (Name == (LPCSTR)0x0) {
    BaseSetLastNTError();
  }
  else {
    uVar1 = Basep8BitStringToDynamicUnicodeString();
    if ((int)uVar1 != 0) {
      pvVar2 = (HANDLE)RtlCreateBoundaryDescriptor(local_18,Flags);
      RtlFreeUnicodeString(local_18);
      return pvVar2;
    }
  }
  return (HANDLE)0x0;
}



HANDLE CreatePrivateNamespaceA
                 (LPSECURITY_ATTRIBUTES lpPrivateNamespaceAttributes,LPVOID lpBoundaryDescriptor,
                 LPCSTR lpAliasPrefix)

{
  undefined8 uVar1;
  HANDLE pvVar2;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x60dd0  226  CreatePrivateNamespaceA
  if (lpAliasPrefix == (LPCSTR)0x0) {
    BaseSetLastNTError();
  }
  else {
    uVar1 = Basep8BitStringToDynamicUnicodeString();
    if ((int)uVar1 != 0) {
      pvVar2 = CreatePrivateNamespaceW(lpPrivateNamespaceAttributes,lpBoundaryDescriptor,local_10);
      RtlFreeUnicodeString(local_18);
      return pvVar2;
    }
  }
  return (HANDLE)0x0;
}



HANDLE OpenPrivateNamespaceA(LPVOID lpBoundaryDescriptor,LPCSTR lpAliasPrefix)

{
  undefined8 uVar1;
  HANDLE pvVar2;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x60e50  1041  OpenPrivateNamespaceA
  if (lpAliasPrefix == (LPCSTR)0x0) {
    BaseSetLastNTError();
  }
  else {
    uVar1 = Basep8BitStringToDynamicUnicodeString();
    if ((int)uVar1 != 0) {
      pvVar2 = OpenPrivateNamespaceW(lpBoundaryDescriptor,local_10);
      RtlFreeUnicodeString(local_18);
      return pvVar2;
    }
  }
  return (HANDLE)0x0;
}



// Library Function - Single Match
//  BasepOfShareToWin32Share
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

byte BasepOfShareToWin32Share(uint param_1)

{
  byte bVar1;
  uint uVar2;
  
  uVar2 = param_1 & 0x70;
  if (uVar2 == 0x30) {
    return 2;
  }
  if (uVar2 == 0x20) {
    return 1;
  }
  bVar1 = 3;
  if (uVar2 != 0x40) {
    bVar1 = -(uVar2 != 0x10) & 3;
  }
  return bVar1;
}



BOOL CopyFileA(LPCSTR lpExistingFileName,LPCSTR lpNewFileName,BOOL bFailIfExists)

{
  int iVar1;
  undefined8 uVar2;
  undefined local_28 [8];
  LPCWSTR local_20;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x60ef0  172  CopyFileA
  uVar2 = Basep8BitStringToDynamicUnicodeString();
  iVar1 = (int)uVar2;
  if (iVar1 != 0) {
    uVar2 = Basep8BitStringToDynamicUnicodeString();
    iVar1 = 0;
    if ((int)uVar2 != 0) {
      iVar1 = CopyFileExW(local_10,local_20,(LPPROGRESS_ROUTINE)0x0,(LPVOID)0x0,(LPBOOL)0x0,
                          (uint)(bFailIfExists != 0));
      RtlFreeUnicodeString(local_28);
    }
    RtlFreeUnicodeString(local_18);
  }
  return iVar1;
}



BOOL CopyFileExA(LPCSTR lpExistingFileName,LPCSTR lpNewFileName,LPPROGRESS_ROUTINE lpProgressRoutine
                ,LPVOID lpData,LPBOOL pbCancel,DWORD dwCopyFlags)

{
  int iVar1;
  undefined8 uVar2;
  undefined local_28 [8];
  LPCWSTR local_20;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x60fa0  173  CopyFileExA
  uVar2 = Basep8BitStringToDynamicUnicodeString();
  iVar1 = (int)uVar2;
  if (iVar1 != 0) {
    uVar2 = Basep8BitStringToDynamicUnicodeString();
    iVar1 = 0;
    if ((int)uVar2 != 0) {
      iVar1 = CopyFileExW(local_10,local_20,lpProgressRoutine,lpData,pbCancel,dwCopyFlags);
      RtlFreeUnicodeString(local_28);
    }
    RtlFreeUnicodeString(local_18);
  }
  return iVar1;
}



BOOL CopyFileTransactedA(LPCSTR lpExistingFileName,LPCSTR lpNewFileName,
                        LPPROGRESS_ROUTINE lpProgressRoutine,LPVOID lpData,LPBOOL pbCancel,
                        DWORD dwCopyFlags,HANDLE hTransaction)

{
  BOOL BVar1;
  longlong lVar2;
  undefined8 uVar3;
  
                    // 0x61060  175  CopyFileTransactedA
  if ((longlong)hTransaction - 1U < 0xfffffffffffffffe) {
    lVar2 = RtlGetCurrentTransaction();
    if (lVar2 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      BVar1 = CopyFileExA(lpExistingFileName,lpNewFileName,lpProgressRoutine,lpData,pbCancel,
                          dwCopyFlags);
      RtlSetCurrentTransaction(0);
      return BVar1;
    }
    uVar3 = 0x1a45;
  }
  else {
    uVar3 = 0x1a2c;
  }
  RtlSetLastWin32Error(uVar3);
  return 0;
}



void FUN_180061124(void)

{
                    // WARNING: Could not recover jumptable at 0x000180061134. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlSetCurrentTransaction(0);
  return;
}



BOOL CopyFileTransactedW(LPCWSTR lpExistingFileName,LPCWSTR lpNewFileName,
                        LPPROGRESS_ROUTINE lpProgressRoutine,LPVOID lpData,LPBOOL pbCancel,
                        DWORD dwCopyFlags,HANDLE hTransaction)

{
  BOOL BVar1;
  longlong lVar2;
  
                    // 0x61150  176  CopyFileTransactedW
  if ((longlong)hTransaction - 1U < 0xfffffffffffffffe) {
    lVar2 = RtlGetCurrentTransaction();
    BVar1 = 0;
    if (lVar2 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      BVar1 = CopyFileExW(lpExistingFileName,lpNewFileName,lpProgressRoutine,lpData,pbCancel,
                          dwCopyFlags);
      RtlSetCurrentTransaction(0);
    }
    else {
      RtlSetLastWin32Error(0x1a45);
    }
  }
  else {
    RtlSetLastWin32Error(0x1a2c);
    BVar1 = 0;
  }
  return BVar1;
}



void FUN_180061229(void)

{
                    // WARNING: Could not recover jumptable at 0x000180061239. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlSetCurrentTransaction(0);
  return;
}



HANDLE CreateFileTransactedA
                 (LPCSTR lpFileName,DWORD dwDesiredAccess,DWORD dwShareMode,
                 LPSECURITY_ATTRIBUTES lpSecurityAttributes,DWORD dwCreationDisposition,
                 DWORD dwFlagsAndAttributes,HANDLE hTemplateFile,HANDLE hTransaction,
                 PUSHORT pusMiniVersion,PVOID lpExtendedParameter)

{
  undefined8 uVar1;
  HANDLE pvVar2;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x61250  205  CreateFileTransactedA
  uVar1 = Basep8BitStringToDynamicUnicodeString();
  if ((int)uVar1 == 0) {
    pvVar2 = (HANDLE)0xffffffffffffffff;
  }
  else {
    pvVar2 = CreateFileTransactedW
                       (local_10,dwDesiredAccess,dwShareMode,lpSecurityAttributes,
                        dwCreationDisposition,dwFlagsAndAttributes,hTemplateFile,hTransaction,
                        pusMiniVersion,lpExtendedParameter);
    RtlFreeUnicodeString(local_18);
  }
  return pvVar2;
}



HANDLE CreateFileTransactedW
                 (LPCWSTR lpFileName,DWORD dwDesiredAccess,DWORD dwShareMode,
                 LPSECURITY_ATTRIBUTES lpSecurityAttributes,DWORD dwCreationDisposition,
                 DWORD dwFlagsAndAttributes,HANDLE hTemplateFile,HANDLE hTransaction,
                 PUSHORT pusMiniVersion,PVOID lpExtendedParameter)

{
  longlong lVar1;
  HANDLE pvVar2;
  undefined8 uVar3;
  undefined4 in_register_00000014;
  ushort uVar4;
  undefined4 in_register_00000084;
  longlong in_GS_OFFSET;
  
                    // 0x61310  206  CreateFileTransactedW
  uVar4 = 0;
  if (lpExtendedParameter == (PVOID)0x0) {
    if ((longlong)hTransaction - 1U < 0xfffffffffffffffe) {
      lVar1 = RtlGetCurrentTransaction
                        (lpFileName,CONCAT44(in_register_00000014,dwDesiredAccess),
                         CONCAT44(in_register_00000084,dwShareMode));
      if (lVar1 == 0) {
        RtlSetCurrentTransaction();
        if (pusMiniVersion != (PUSHORT)0x0) {
          uVar4 = *(ushort *)(*(longlong *)(in_GS_OFFSET + 0x30) + 0x2e8);
          *(uint *)(*(longlong *)(in_GS_OFFSET + 0x30) + 0x2e8) = (uint)*pusMiniVersion;
        }
        pvVar2 = CreateFileW(lpFileName,dwDesiredAccess,dwShareMode,lpSecurityAttributes,
                             dwCreationDisposition,dwFlagsAndAttributes,hTemplateFile);
        RtlSetCurrentTransaction();
        if (pusMiniVersion == (PUSHORT)0x0) {
          return pvVar2;
        }
        *(uint *)(*(longlong *)(in_GS_OFFSET + 0x30) + 0x2e8) = (uint)uVar4;
        return pvVar2;
      }
      uVar3 = 0x1a45;
    }
    else {
      uVar3 = 0x1a2c;
    }
  }
  else {
    uVar3 = 0x57;
  }
  RtlSetLastWin32Error(uVar3);
  return (HANDLE)0xffffffffffffffff;
}



void FUN_180061470(undefined8 param_1,longlong param_2)

{
  longlong in_GS_OFFSET;
  
  RtlSetCurrentTransaction();
  if (*(longlong *)(param_2 + 0xb0) != 0) {
    *(uint *)(*(longlong *)(in_GS_OFFSET + 0x30) + 0x2e8) = (uint)*(ushort *)(param_2 + 0x40);
  }
  return;
}



// WARNING: Could not reconcile some variable overlaps

HFILE OpenFile(LPCSTR lpFileName,LPOFSTRUCT lpReOpenBuff,UINT uStyle)

{
  CHAR *lpFileName_00;
  char cVar1;
  char cVar2;
  bool bVar3;
  longlong lVar4;
  byte bVar5;
  DWORD DVar6;
  DWORD DVar7;
  BOOL BVar8;
  UINT UVar9;
  int iVar10;
  undefined7 extraout_var;
  undefined4 *puVar11;
  ulonglong uVar12;
  undefined8 uVar13;
  HANDLE hFile;
  int local_118;
  LPSTR local_110;
  int local_108;
  byte local_104;
  undefined *local_100;
  _FILETIME local_f8;
  undefined local_f0 [16];
  undefined local_e0 [16];
  undefined local_d0 [24];
  undefined4 local_b8;
  undefined4 uStack180;
  undefined4 uStack176;
  undefined4 uStack172;
  undefined4 local_a8;
  undefined4 uStack164;
  undefined4 uStack160;
  undefined4 uStack156;
  undefined4 local_98;
  undefined4 uStack148;
  undefined4 uStack144;
  undefined4 uStack140;
  undefined4 local_88;
  undefined4 uStack132;
  undefined4 uStack128;
  undefined4 uStack124;
  undefined4 local_78;
  undefined4 uStack116;
  undefined4 uStack112;
  undefined4 uStack108;
  undefined4 local_68;
  undefined4 uStack100;
  undefined4 uStack96;
  undefined4 uStack92;
  undefined4 local_58;
  undefined4 uStack84;
  undefined4 uStack80;
  undefined4 uStack76;
  undefined4 local_48;
  undefined4 uStack68;
  undefined4 uStack64;
  undefined4 uStack60;
  undefined8 uStack56;
  
                    // 0x614c0  1032  OpenFile
  bVar3 = false;
  local_b8 = *(undefined4 *)lpReOpenBuff;
  uStack180 = *(undefined4 *)&lpReOpenBuff->Reserved1;
  uStack176 = *(undefined4 *)lpReOpenBuff->szPathName;
  uStack172 = *(undefined4 *)(lpReOpenBuff->szPathName + 4);
  local_a8 = *(undefined4 *)(lpReOpenBuff->szPathName + 8);
  uStack164 = *(undefined4 *)(lpReOpenBuff->szPathName + 0xc);
  uStack160 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x10);
  uStack156 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x14);
  local_98 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x18);
  uStack148 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x1c);
  uStack144 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x20);
  uStack140 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x24);
  local_88 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x28);
  uStack132 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x2c);
  uStack128 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x30);
  uStack124 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x34);
  local_78 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x38);
  uStack116 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x3c);
  uStack112 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x40);
  uStack108 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x44);
  local_68 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x48);
  uStack100 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x4c);
  uStack96 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x50);
  uStack92 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x54);
  local_58 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x58);
  uStack84 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x5c);
  uStack80 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x60);
  uStack76 = *(undefined4 *)(lpReOpenBuff->szPathName + 100);
  local_48 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x68);
  uStack68 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x6c);
  uStack64 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x70);
  uStack60 = *(undefined4 *)(lpReOpenBuff->szPathName + 0x74);
  uStack56 = *(undefined8 *)(lpReOpenBuff->szPathName + 0x78);
  RtlSetLastWin32Error();
  if ((uStyle >> 8 & 1) == 0) {
    DVar7 = 0xc0000000;
    DVar6 = (-(uint)((uStyle & 1) != 0) & 0xc0000000) + 0x80000000;
    uVar12 = 2;
    if ((uStyle & 2) != 0) {
      DVar6 = 0xc0000000;
    }
    bVar5 = BasepOfShareToWin32Share(uStyle);
    if ((uStyle & 0x1000) != 0) {
      DVar6 = DVar7;
    }
    if ((uStyle >> 0xf & 1) == 0) {
      DVar7 = SearchPathA((LPCSTR)0x0,lpFileName,(LPCSTR)0x0,0x7f,lpReOpenBuff->szPathName,
                          &local_110);
      if (0x7f < DVar7) goto LAB_180061580;
      bVar3 = false;
      if (DVar7 == 0) {
        bVar3 = true;
        DVar7 = GetFullPathNameA(lpFileName,0x7f,lpReOpenBuff->szPathName,&local_110);
        if (0x7e < DVar7 - 1) goto LAB_180061580;
      }
      uVar12 = 2;
    }
    if ((uStyle & 0x5000) != 0x4000) {
      lpFileName_00 = lpReOpenBuff->szPathName;
      if ((uStyle >> 9 & 1) == 0) {
        while (hFile = CreateFileA(lpFileName_00,DVar6,(DWORD)CONCAT71(extraout_var,bVar5),
                                   (LPSECURITY_ATTRIBUTES)0x0,3 - ((uStyle & 0x1000) != 0),0,
                                   (HANDLE)0x0), hFile == (HANDLE)0xffffffffffffffff) {
          if ((((uStyle >> 0xd & 1) == 0) || (UVar9 = GetErrorMode(), (UVar9 >> 0xf & 1) != 0)) ||
             (uVar12 = RtlGetThreadErrorMode(), (uVar12 & 0x40) != 0)) goto LAB_1800619e2;
          DVar7 = GetLastError();
          if (DVar7 == 2) {
            uVar13 = 0xd000000f;
          }
          else {
            if (DVar7 != 3) goto LAB_1800619e2;
            uVar13 = 0xd000003a;
          }
          RtlInitAnsiString(local_e0,lpFileName_00);
          iVar10 = RtlAnsiStringToUnicodeString(local_f0);
          if (iVar10 < 0) goto LAB_1800619e2;
          local_100 = local_f0;
          iVar10 = NtRaiseHardError(uVar13);
          RtlFreeUnicodeString();
          if ((iVar10 < 0) || (local_118 != 7)) goto LAB_1800619e2;
        }
        if ((uStyle >> 0xe & 1) != 0) {
          CloseHandle(hFile);
          goto LAB_18006186a;
        }
        iVar10 = NtQueryVolumeInformationFile(hFile,local_d0,&local_108,8,4);
        if (iVar10 < 0) {
          CloseHandle(hFile);
          BaseSetLastNTError();
          goto LAB_1800619d9;
        }
        if (local_108 == 7 || local_108 == 8) {
          lpReOpenBuff->fFixedDisk = ~local_104 & 1;
        }
        else {
          lpReOpenBuff->fFixedDisk = '\0';
        }
        BVar8 = GetFileTime(hFile,(LPFILETIME)0x0,(LPFILETIME)0x0,&local_f8);
        if (BVar8 == 0) {
          lpReOpenBuff->Reserved1 = 0;
          lpReOpenBuff->Reserved2 = 0;
        }
        else {
          BVar8 = FileTimeToDosDateTime(&local_f8,&lpReOpenBuff->Reserved1,&lpReOpenBuff->Reserved2)
          ;
          if (BVar8 == 0) {
            *(undefined4 *)&lpReOpenBuff->Reserved1 = 0;
          }
        }
        lpReOpenBuff->cBytes = 0x88;
        if ((uStyle >> 10 & 1) != 0) {
          if (((WORD)uStack180 != lpReOpenBuff->Reserved1) ||
             (uStack180._2_2_ != lpReOpenBuff->Reserved2)) goto LAB_180061976;
          puVar11 = &uStack176;
          lVar4 = 8 - (longlong)puVar11;
          goto LAB_18006195d;
        }
        goto LAB_1800619e2;
      }
      BVar8 = DeleteFileA(lpFileName_00);
      if (BVar8 != 0) {
        lpReOpenBuff->nErrCode = 0;
        lpReOpenBuff->cBytes = 0x88;
        hFile = (HANDLE)0x1;
        goto LAB_1800619e2;
      }
      lpReOpenBuff->nErrCode = 2;
      goto LAB_1800619d9;
    }
    if (bVar3) {
      uVar12 = uVar12 & 0xffffffff;
    }
    else {
      DVar6 = GetFileAttributesA(lpReOpenBuff->szPathName);
      if (DVar6 == 0xffffffff) {
        uVar12 = 2;
      }
      else {
        if ((DVar6 & 0x10) == 0) {
LAB_18006186a:
          hFile = (HANDLE)0x1;
          lpReOpenBuff->cBytes = 0x88;
          goto LAB_1800619e2;
        }
        uVar12 = 5;
      }
    }
  }
  else {
    DVar6 = GetFullPathNameA(lpFileName,0x7f,lpReOpenBuff->szPathName,&local_110);
    if (DVar6 < 0x80) {
      *(undefined8 *)lpReOpenBuff = 0x188;
      hFile = (HANDLE)0x0;
      goto LAB_1800619e2;
    }
LAB_180061580:
    uVar12 = 0xd;
  }
  RtlSetLastWin32Error(uVar12);
  goto LAB_1800619d9;
  while (puVar11 = (undefined4 *)((longlong)puVar11 + 1), cVar2 != '\0') {
LAB_18006195d:
    cVar1 = *(char *)puVar11;
    cVar2 = *(char *)((longlong)puVar11 + (longlong)lpReOpenBuff + lVar4);
    if (cVar1 != cVar2) break;
  }
  if (cVar1 == cVar2) goto LAB_1800619e2;
LAB_180061976:
  *(undefined4 *)lpReOpenBuff = local_b8;
  *(undefined4 *)&lpReOpenBuff->Reserved1 = uStack180;
  *(undefined4 *)lpReOpenBuff->szPathName = uStack176;
  *(undefined4 *)(lpReOpenBuff->szPathName + 4) = uStack172;
  *(undefined4 *)(lpReOpenBuff->szPathName + 8) = local_a8;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0xc) = uStack164;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x10) = uStack160;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x14) = uStack156;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x18) = local_98;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x1c) = uStack148;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x20) = uStack144;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x24) = uStack140;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x28) = local_88;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x2c) = uStack132;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x30) = uStack128;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x34) = uStack124;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x38) = local_78;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x3c) = uStack116;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x40) = uStack112;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x44) = uStack108;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x48) = local_68;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x4c) = uStack100;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x50) = uStack96;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x54) = uStack92;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x58) = local_58;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x5c) = uStack84;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x60) = uStack80;
  *(undefined4 *)(lpReOpenBuff->szPathName + 100) = uStack76;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x68) = local_48;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x6c) = uStack68;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x70) = uStack64;
  *(undefined4 *)(lpReOpenBuff->szPathName + 0x74) = uStack60;
  *(undefined8 *)(lpReOpenBuff->szPathName + 0x78) = uStack56;
  CloseHandle(hFile);
LAB_1800619d9:
  hFile = (HANDLE)0xffffffffffffffff;
LAB_1800619e2:
  DVar6 = GetLastError();
  lpReOpenBuff->nErrCode = (WORD)DVar6;
  return (HFILE)hFile;
}



void FUN_180061a12(undefined8 param_1,longlong param_2)

{
  DWORD DVar1;
  
  DVar1 = GetLastError();
  *(short *)(*(longlong *)(param_2 + 0x178) + 2) = (short)DVar1;
  return;
}



BOOL ReplaceFileA(LPCSTR lpReplacedFileName,LPCSTR lpReplacementFileName,LPCSTR lpBackupFileName,
                 DWORD dwReplaceFlags,LPVOID lpExclude,LPVOID lpReserved)

{
  BOOL BVar1;
  undefined8 uVar2;
  undefined local_38 [8];
  LPCWSTR local_30;
  undefined local_28 [8];
  LPCWSTR local_20;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x61a40  1224  ReplaceFileA
  BVar1 = 0;
  if ((((lpReplacedFileName == (LPCSTR)0x0) || (lpReplacementFileName == (LPCSTR)0x0)) ||
      (lpExclude != (LPVOID)0x0)) ||
     ((lpReserved != (LPVOID)0x0 || ((dwReplaceFlags & 0xfffffff8) != 0)))) {
    RtlSetLastWin32Error(0x57);
    return 0;
  }
  uVar2 = Basep8BitStringToDynamicUnicodeString();
  if ((int)uVar2 == 0) {
    return 0;
  }
  uVar2 = Basep8BitStringToDynamicUnicodeString();
  if ((int)uVar2 == 0) goto LAB_180061b30;
  if (lpBackupFileName == (LPCSTR)0x0) {
    local_30 = (LPCWSTR)0x0;
LAB_180061ae4:
    BVar1 = ReplaceFileW(local_10,local_20,local_30,dwReplaceFlags,(LPVOID)0x0,(LPVOID)0x0);
    if (lpBackupFileName != (LPCSTR)0x0) {
      RtlFreeUnicodeString(local_38);
    }
  }
  else {
    uVar2 = Basep8BitStringToDynamicUnicodeString();
    BVar1 = 0;
    if ((int)uVar2 != 0) goto LAB_180061ae4;
  }
  RtlFreeUnicodeString(local_28);
LAB_180061b30:
  RtlFreeUnicodeString(local_18);
  return BVar1;
}



BOOL CreateDirectoryExA(LPCSTR lpTemplateDirectory,LPCSTR lpNewDirectory,
                       LPSECURITY_ATTRIBUTES lpSecurityAttributes)

{
  int iVar1;
  undefined8 uVar2;
  undefined local_28 [8];
  LPCWSTR local_20;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x61b80  186  CreateDirectoryExA
  uVar2 = Basep8BitStringToDynamicUnicodeString();
  iVar1 = (int)uVar2;
  if (iVar1 != 0) {
    uVar2 = Basep8BitStringToDynamicUnicodeString();
    iVar1 = 0;
    if ((int)uVar2 != 0) {
      iVar1 = CreateDirectoryExW(local_10,local_20,lpSecurityAttributes);
      RtlFreeUnicodeString(local_28);
    }
    RtlFreeUnicodeString(local_18);
  }
  return iVar1;
}



BOOL CreateDirectoryTransactedW
               (LPCWSTR lpTemplateDirectory,LPCWSTR lpNewDirectory,
               LPSECURITY_ATTRIBUTES lpSecurityAttributes,HANDLE hTransaction)

{
  BOOL BVar1;
  longlong lVar2;
  undefined8 uVar3;
  
                    // 0x61c10  189  CreateDirectoryTransactedW
  if ((longlong)hTransaction - 1U < 0xfffffffffffffffe) {
    lVar2 = RtlGetCurrentTransaction();
    if (lVar2 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      if (lpTemplateDirectory == (LPCWSTR)0x0) {
        BVar1 = CreateDirectoryW(lpNewDirectory,lpSecurityAttributes);
      }
      else {
        BVar1 = CreateDirectoryExW(lpTemplateDirectory,lpNewDirectory,lpSecurityAttributes);
      }
      RtlSetCurrentTransaction(0);
      return BVar1;
    }
    uVar3 = 0x1a45;
  }
  else {
    uVar3 = 0x1a2c;
  }
  RtlSetLastWin32Error(uVar3);
  return 0;
}



void FUN_180061cd8(void)

{
                    // WARNING: Could not recover jumptable at 0x000180061ce8. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlSetCurrentTransaction(0);
  return;
}



BOOL RemoveDirectoryTransactedW(LPCWSTR lpPathName,HANDLE hTransaction)

{
  BOOL BVar1;
  longlong lVar2;
  
                    // 0x61d00  1215  RemoveDirectoryTransactedW
  if ((longlong)hTransaction - 1U < 0xfffffffffffffffe) {
    lVar2 = RtlGetCurrentTransaction();
    BVar1 = 0;
    if (lVar2 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      BVar1 = RemoveDirectoryW(lpPathName);
      RtlSetCurrentTransaction(0);
    }
    else {
      RtlSetLastWin32Error(0x1a45);
    }
  }
  else {
    RtlSetLastWin32Error(0x1a2c);
    BVar1 = 0;
  }
  return BVar1;
}



void FUN_180061d9c(void)

{
                    // WARNING: Could not recover jumptable at 0x000180061dac. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlSetCurrentTransaction(0);
  return;
}



HANDLE CreateFileMappingNumaA
                 (HANDLE hFile,LPSECURITY_ATTRIBUTES lpFileMappingAttributes,DWORD flProtect,
                 DWORD dwMaximumSizeHigh,DWORD dwMaximumSizeLow,LPCSTR lpName,DWORD nndPreferred)

{
  undefined8 uVar1;
  HANDLE pvVar2;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x61dc0  202  CreateFileMappingNumaA
  if (lpName == (LPCSTR)0x0) {
    local_10 = (LPCWSTR)0x0;
  }
  else {
    uVar1 = Basep8BitStringToDynamicUnicodeString();
    if ((int)uVar1 == 0) {
      return (HANDLE)0x0;
    }
  }
  pvVar2 = CreateFileMappingNumaW
                     (hFile,lpFileMappingAttributes,flProtect,dwMaximumSizeHigh,dwMaximumSizeLow,
                      local_10,nndPreferred);
  if (lpName != (LPCSTR)0x0) {
    RtlFreeUnicodeString(local_18);
  }
  return pvVar2;
}



BOOL CreateHardLinkTransactedW
               (LPCWSTR lpFileName,LPCWSTR lpExistingFileName,
               LPSECURITY_ATTRIBUTES lpSecurityAttributes,HANDLE hTransaction)

{
  BOOL BVar1;
  longlong lVar2;
  
                    // 0x61e90  210  CreateHardLinkTransactedW
  if ((longlong)hTransaction - 1U < 0xfffffffffffffffe) {
    lVar2 = RtlGetCurrentTransaction();
    BVar1 = 0;
    if (lVar2 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      BVar1 = CreateHardLinkW(lpFileName,lpExistingFileName,lpSecurityAttributes);
      RtlSetCurrentTransaction(0);
    }
    else {
      RtlSetLastWin32Error(0x1a45);
    }
  }
  else {
    RtlSetLastWin32Error(0x1a2c);
    BVar1 = 0;
  }
  return BVar1;
}



void FUN_180061f4d(void)

{
                    // WARNING: Could not recover jumptable at 0x000180061f5d. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlSetCurrentTransaction(0);
  return;
}



BOOL GetMailslotInfo(HANDLE hMailslot,LPDWORD lpMaxMessageSize,LPDWORD lpNextSize,
                    LPDWORD lpMessageCount,LPDWORD lpReadTimeout)

{
  int iVar1;
  BOOL extraout_EAX;
  DWORD DVar2;
  ulonglong uVar3;
  undefined auStack136 [32];
  undefined4 local_68;
  undefined local_58 [16];
  DWORD local_48 [2];
  DWORD local_40;
  DWORD local_3c;
  int local_38;
  int iStack52;
  ulonglong local_30;
  
                    // 0x61f70  633  GetMailslotInfo
  local_30 = DAT_1800b2220 ^ (ulonglong)auStack136;
  local_68 = 0x1a;
  iVar1 = NtQueryInformationFile(hMailslot,local_58,local_48,0x18);
  if (iVar1 < 0) {
    BaseSetLastNTError();
  }
  else {
    if (lpMaxMessageSize != (LPDWORD)0x0) {
      *lpMaxMessageSize = local_48[0];
    }
    if (lpNextSize != (LPDWORD)0x0) {
      *lpNextSize = local_40;
    }
    if (lpMessageCount != (LPDWORD)0x0) {
      *lpMessageCount = local_3c;
    }
    if (lpReadTimeout != (LPDWORD)0x0) {
      if ((iStack52 == -1) && (local_38 == -1)) {
        *lpReadTimeout = 0xffffffff;
      }
      else {
        uVar3 = (ulonglong)-CONCAT44(iStack52,local_38) / 10000;
        DVar2 = 0xfffffffe;
        if ((int)(uVar3 >> 0x20) == 0) {
          DVar2 = (DWORD)uVar3;
        }
        *lpReadTimeout = DVar2;
      }
    }
  }
  __security_check_cookie(local_30 ^ (ulonglong)auStack136);
  return extraout_EAX;
}



BOOL SetMailslotInfo(HANDLE hMailslot,DWORD lReadTimeout)

{
  int iVar1;
  longlong local_res18;
  longlong *local_res20;
  undefined local_18 [24];
  
                    // 0x62060  1352  SetMailslotInfo
  if (lReadTimeout == 0xffffffff) {
    local_res18 = -1;
  }
  else {
    local_res18 = (ulonglong)lReadTimeout * -10000;
  }
  local_res20 = &local_res18;
  iVar1 = NtSetInformationFile(hMailslot,local_18,&local_res20,8,0x1b);
  if (-1 >= iVar1) {
    BaseSetLastNTError();
  }
  return (uint)(-1 < iVar1);
}



HANDLE CreateWaitableTimerA
                 (LPSECURITY_ATTRIBUTES lpTimerAttributes,BOOL bManualReset,LPCSTR lpTimerName)

{
  HANDLE pvVar1;
  
                    // 0x620e0  258  CreateWaitableTimerA
  pvVar1 = CreateWaitableTimerExA(lpTimerAttributes,lpTimerName,(uint)(bManualReset != 0),0x1f0003);
  return pvVar1;
}



HANDLE CreateWaitableTimerExA
                 (LPSECURITY_ATTRIBUTES lpTimerAttributes,LPCSTR lpTimerName,DWORD dwFlags,
                 DWORD dwDesiredAccess)

{
  LPCWSTR pWVar1;
  undefined8 uVar2;
  HANDLE pvVar3;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x62100  259  CreateWaitableTimerExA
  pWVar1 = (LPCWSTR)lpTimerName;
  if ((lpTimerName == (LPCSTR)0x0) ||
     (uVar2 = Basep8BitStringToDynamicUnicodeString(), pWVar1 = local_10, (int)uVar2 != 0)) {
    local_10 = pWVar1;
    pvVar3 = CreateWaitableTimerExW(lpTimerAttributes,local_10,dwFlags,dwDesiredAccess);
    if (lpTimerName != (LPCSTR)0x0) {
      RtlFreeUnicodeString(local_18);
    }
  }
  else {
    pvVar3 = (HANDLE)0x0;
  }
  return pvVar3;
}



HANDLE OpenSemaphoreA(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCSTR lpName)

{
  undefined8 uVar1;
  HANDLE pvVar2;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x62190  1046  OpenSemaphoreA
  if (lpName == (LPCSTR)0x0) {
    BaseSetLastNTError();
  }
  else {
    uVar1 = Basep8BitStringToDynamicUnicodeString();
    if ((int)uVar1 != 0) {
      pvVar2 = OpenSemaphoreW(dwDesiredAccess,bInheritHandle,local_10);
      RtlFreeUnicodeString(local_18);
      return pvVar2;
    }
  }
  return (HANDLE)0x0;
}



HANDLE OpenWaitableTimerA(DWORD dwDesiredAccess,BOOL bInheritHandle,LPCSTR lpTimerName)

{
  undefined8 uVar1;
  HANDLE pvVar2;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x62200  1052  OpenWaitableTimerA
  if (lpTimerName == (LPCSTR)0x0) {
    BaseSetLastNTError();
  }
  else {
    uVar1 = Basep8BitStringToDynamicUnicodeString();
    if ((int)uVar1 != 0) {
      pvVar2 = OpenWaitableTimerW(dwDesiredAccess,bInheritHandle,local_10);
      RtlFreeUnicodeString(local_18);
      return pvVar2;
    }
  }
  return (HANDLE)0x0;
}



// WARNING: Could not reconcile some variable overlaps

int FUN_180062270(undefined8 param_1,undefined4 *param_2,undefined8 *param_3,undefined8 *param_4,
                 undefined4 *param_5,uint param_6)

{
  bool bVar1;
  char cVar2;
  int iVar3;
  undefined4 uVar4;
  uint local_50;
  int local_4c;
  undefined local_48 [16];
  undefined4 local_38;
  undefined4 uStack52;
  undefined4 uStack48;
  undefined4 uStack44;
  undefined8 local_28;
  
  bVar1 = false;
  *param_2 = 0;
  *(undefined8 *)(param_2 + 2) = 0;
  *param_3 = 0;
  cVar2 = RtlDosPathNameToRelativeNtPathName_U(param_1,param_2,0,&local_38);
  if (cVar2 == '\0') {
    iVar3 = -0x3fffffc6;
  }
  else {
    bVar1 = true;
    *param_3 = *(undefined8 *)(param_2 + 2);
    if ((short)local_38 == 0) {
      local_28 = 0;
    }
    else {
      *param_2 = local_38;
      param_2[1] = uStack52;
      param_2[2] = uStack48;
      param_2[3] = uStack44;
    }
    *param_5 = 0x30;
    *(undefined8 *)(param_5 + 2) = local_28;
    param_5[6] = 0x40;
    *(undefined4 **)(param_5 + 4) = param_2;
    *(undefined8 *)(param_5 + 8) = 0;
    *(undefined8 *)(param_5 + 10) = 0;
    uVar4 = 0x604020;
    iVar3 = NtOpenFile(param_4,param_6 | 0x100080,param_5,local_48,7,0x604020);
    if (iVar3 < 0) {
      if (iVar3 != -0x3ffffff3) goto LAB_1800623fc;
    }
    else {
      iVar3 = NtQueryInformationFile(*param_4,local_48,&local_50,8,0x23,uVar4,iVar3);
      if (((iVar3 < 0) || ((local_50 & 0x400) == 0)) || (local_4c == -0x5ffffffd))
      goto LAB_1800623fc;
      NtClose(*param_4);
      *param_4 = 0xffffffffffffffff;
    }
    iVar3 = NtOpenFile(param_4,param_6 | 0x100000,param_5,local_48,7,0x404020);
  }
LAB_1800623fc:
  if (bVar1) {
    RtlReleaseRelativeName(&local_38);
  }
  return iVar3;
}



void FUN_18006242f(undefined8 param_1,longlong param_2)

{
  if (*(int *)(param_2 + 0x34) != 0) {
    RtlReleaseRelativeName(param_2 + 0x50);
  }
  return;
}



BOOLEAN CreateSymbolicLinkA(LPCSTR lpSymlinkFileName,LPCSTR lpTargetFileName,DWORD dwFlags)

{
  BOOLEAN BVar1;
  undefined8 uVar2;
  undefined4 in_register_00000084;
  undefined local_28 [8];
  LPCWSTR local_20;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x62460  241  CreateSymbolicLinkA
  if ((lpSymlinkFileName == (LPCSTR)0x0) || (lpTargetFileName == (LPCSTR)0x0)) {
    RtlSetLastWin32Error(0x57,lpTargetFileName,CONCAT44(in_register_00000084,dwFlags));
  }
  else {
    uVar2 = Basep8BitStringToDynamicUnicodeString();
    if ((int)uVar2 != 0) {
      uVar2 = Basep8BitStringToDynamicUnicodeString();
      if ((int)uVar2 != 0) {
        BVar1 = CreateSymbolicLinkW(local_20,local_10,dwFlags);
        RtlFreeUnicodeString(local_18);
        RtlFreeUnicodeString(local_28);
        return BVar1;
      }
      RtlFreeUnicodeString(local_28);
    }
  }
  return '\0';
}



BOOLEAN CreateSymbolicLinkTransactedA
                  (LPCSTR lpSymlinkFileName,LPCSTR lpTargetFileName,DWORD dwFlags,
                  HANDLE hTransaction)

{
  BOOLEAN BVar1;
  undefined8 uVar2;
  undefined local_28 [8];
  LPCWSTR local_20;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x62520  242  CreateSymbolicLinkTransactedA
  if ((lpSymlinkFileName == (LPCSTR)0x0) || (lpTargetFileName == (LPCSTR)0x0)) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    uVar2 = Basep8BitStringToDynamicUnicodeString();
    if ((int)uVar2 != 0) {
      uVar2 = Basep8BitStringToDynamicUnicodeString();
      if ((int)uVar2 != 0) {
        BVar1 = CreateSymbolicLinkTransactedW(local_20,local_10,dwFlags,hTransaction);
        RtlFreeUnicodeString(local_18);
        RtlFreeUnicodeString(local_28);
        return BVar1;
      }
      RtlFreeUnicodeString(local_28);
    }
  }
  return '\0';
}



BOOLEAN CreateSymbolicLinkTransactedW
                  (LPCWSTR lpSymlinkFileName,LPCWSTR lpTargetFileName,DWORD dwFlags,
                  HANDLE hTransaction)

{
  BOOLEAN BVar1;
  longlong lVar2;
  undefined8 uVar3;
  undefined4 in_register_00000084;
  
                    // 0x625e0  243  CreateSymbolicLinkTransactedW
  if ((longlong)hTransaction - 1U < 0xfffffffffffffffe) {
    lVar2 = RtlGetCurrentTransaction
                      (lpSymlinkFileName,lpTargetFileName,CONCAT44(in_register_00000084,dwFlags));
    if (lVar2 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      BVar1 = CreateSymbolicLinkW(lpSymlinkFileName,lpTargetFileName,dwFlags);
      RtlSetCurrentTransaction(0);
      return BVar1;
    }
    uVar3 = 0x1a45;
  }
  else {
    uVar3 = 0x1a2c;
  }
  RtlSetLastWin32Error(uVar3);
  return '\0';
}



void FUN_18006268f(void)

{
                    // WARNING: Could not recover jumptable at 0x00018006269f. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlSetCurrentTransaction(0);
  return;
}



BOOL DeleteFileTransactedA(LPCSTR lpFileName,HANDLE hTransaction)

{
  int iVar1;
  undefined8 uVar2;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x626c0  280  DeleteFileTransactedA
  uVar2 = Basep8BitStringToDynamicUnicodeString();
  iVar1 = (int)uVar2;
  if (iVar1 != 0) {
    iVar1 = DeleteFileTransactedW(local_10,hTransaction);
    RtlFreeUnicodeString(local_18);
  }
  return iVar1;
}



DWORD GetCompressedFileSizeTransactedA(LPCSTR lpFileName,LPDWORD lpFileSizeHigh,HANDLE hTransaction)

{
  DWORD DVar1;
  undefined8 uVar2;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x62710  483  GetCompressedFileSizeTransactedA
  uVar2 = Basep8BitStringToDynamicUnicodeString();
  if ((int)uVar2 == 0) {
    DVar1 = 0xffffffff;
  }
  else {
    DVar1 = GetCompressedFileSizeTransactedW(local_10,lpFileSizeHigh,hTransaction);
    RtlFreeUnicodeString(local_18);
  }
  return DVar1;
}



DWORD GetCompressedFileSizeTransactedW
                (LPCWSTR lpFileName,LPDWORD lpFileSizeHigh,HANDLE hTransaction)

{
  DWORD DVar1;
  longlong lVar2;
  undefined8 uVar3;
  
                    // 0x62770  484  GetCompressedFileSizeTransactedW
  if ((longlong)hTransaction - 1U < 0xfffffffffffffffe) {
    lVar2 = RtlGetCurrentTransaction();
    if (lVar2 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      DVar1 = GetCompressedFileSizeW(lpFileName,lpFileSizeHigh);
      RtlSetCurrentTransaction(0);
      return DVar1;
    }
    uVar3 = 0x1a45;
  }
  else {
    uVar3 = 0x1a2c;
  }
  RtlSetLastWin32Error(uVar3);
  return 0xffffffff;
}



void FUN_180062811(void)

{
                    // WARNING: Could not recover jumptable at 0x000180062821. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlSetCurrentTransaction(0);
  return;
}



BOOL GetFileAttributesTransactedA
               (LPCSTR lpFileName,GET_FILEEX_INFO_LEVELS fInfoLevelId,LPVOID lpFileInformation,
               HANDLE hTransaction)

{
  int iVar1;
  undefined8 uVar2;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x62840  590  GetFileAttributesTransactedA
  uVar2 = Basep8BitStringToDynamicUnicodeString();
  iVar1 = (int)uVar2;
  if (iVar1 != 0) {
    iVar1 = GetFileAttributesTransactedW(local_10,fInfoLevelId,lpFileInformation,hTransaction);
    RtlFreeUnicodeString(local_18);
  }
  return iVar1;
}



BOOL GetFileAttributesTransactedW
               (LPCWSTR lpFileName,GET_FILEEX_INFO_LEVELS fInfoLevelId,LPVOID lpFileInformation,
               HANDLE hTransaction)

{
  BOOL BVar1;
  longlong lVar2;
  undefined4 in_register_00000014;
  
                    // 0x628b0  591  GetFileAttributesTransactedW
  if ((longlong)hTransaction - 1U < 0xfffffffffffffffe) {
    lVar2 = RtlGetCurrentTransaction();
    BVar1 = 0;
    if (lVar2 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      BVar1 = GetFileAttributesExW(lpFileName,fInfoLevelId,lpFileInformation);
      RtlSetCurrentTransaction(0);
    }
    else {
      RtlSetLastWin32Error(0x1a45);
    }
  }
  else {
    RtlSetLastWin32Error(0x1a2c,CONCAT44(in_register_00000014,fInfoLevelId));
    BVar1 = 0;
  }
  return BVar1;
}



void FUN_18006296d(void)

{
                    // WARNING: Could not recover jumptable at 0x00018006297d. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlSetCurrentTransaction(0);
  return;
}



BOOL MoveFileA(LPCSTR lpExistingFileName,LPCSTR lpNewFileName)

{
  BOOL BVar1;
  
                    // 0x62990  1006  MoveFileA
  BVar1 = FUN_180062af4(lpExistingFileName,(longlong)lpNewFileName,0,0,2,0);
  return BVar1;
}



BOOL MoveFileExA(LPCSTR lpExistingFileName,LPCSTR lpNewFileName,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // 0x629c0  1007  MoveFileExA
  BVar1 = FUN_180062af4(lpExistingFileName,(longlong)lpNewFileName,0,0,dwFlags,0);
  return BVar1;
}



BOOL MoveFileTransactedA(LPCSTR lpExistingFileName,LPCSTR lpNewFileName,
                        LPPROGRESS_ROUTINE lpProgressRoutine,LPVOID lpData,DWORD dwFlags,
                        HANDLE hTransaction)

{
  BOOL BVar1;
  longlong lVar2;
  undefined8 uVar3;
  
                    // 0x629f0  1009  MoveFileTransactedA
  if ((longlong)hTransaction - 1U < 0xfffffffffffffffe) {
    lVar2 = RtlGetCurrentTransaction();
    if (lVar2 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      BVar1 = FUN_180062af4(lpExistingFileName,(longlong)lpNewFileName,lpProgressRoutine,lpData,
                            dwFlags,hTransaction);
      RtlSetCurrentTransaction(0);
      return BVar1;
    }
    uVar3 = 0x1a45;
  }
  else {
    uVar3 = 0x1a2c;
  }
  RtlSetLastWin32Error(uVar3);
  return 0;
}



void FUN_180062aac(void)

{
                    // WARNING: Could not recover jumptable at 0x000180062abc. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlSetCurrentTransaction(0);
  return;
}



BOOL MoveFileWithProgressA
               (LPCSTR lpExistingFileName,LPCSTR lpNewFileName,LPPROGRESS_ROUTINE lpProgressRoutine,
               LPVOID lpData,DWORD dwFlags)

{
  BOOL BVar1;
  
                    // 0x62ad0  1012  MoveFileWithProgressA
  BVar1 = FUN_180062af4(lpExistingFileName,(longlong)lpNewFileName,lpProgressRoutine,lpData,dwFlags,
                        0);
  return BVar1;
}



undefined4
FUN_180062af4(undefined8 param_1,longlong param_2,undefined8 param_3,undefined8 param_4,
             undefined4 param_5,undefined8 param_6)

{
  undefined4 uVar1;
  undefined8 uVar2;
  undefined local_28 [8];
  undefined8 local_20;
  undefined local_18 [8];
  undefined8 local_10;
  
  uVar2 = Basep8BitStringToDynamicUnicodeString();
  if ((int)uVar2 == 0) {
LAB_180062b23:
    uVar1 = 0;
  }
  else {
    if (param_2 == 0) {
      local_10 = 0;
    }
    else {
      uVar2 = Basep8BitStringToDynamicUnicodeString();
      if ((int)uVar2 == 0) {
        RtlFreeUnicodeString(local_28);
        goto LAB_180062b23;
      }
    }
    uVar1 = MoveFileWithProgressTransactedW(local_20,local_10,param_3,param_4,param_5,param_6);
    RtlFreeUnicodeString(local_28);
    RtlFreeUnicodeString(local_18);
  }
  return uVar1;
}



void PrivMoveFileIdentityW(undefined8 param_1,undefined8 param_2,uint param_3)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  longlong in_GS_OFFSET;
  undefined auStackY408 [32];
  int local_158;
  int local_154;
  undefined local_150 [4];
  uint local_14c;
  longlong local_148;
  longlong local_140;
  uint local_138;
  longlong local_130;
  longlong local_128;
  undefined4 local_120 [2];
  undefined8 local_118;
  undefined8 local_110;
  undefined4 local_108 [2];
  undefined8 local_100;
  undefined local_f8 [16];
  undefined4 local_e8 [12];
  undefined4 local_b8 [12];
  undefined local_88 [16];
  undefined local_78 [16];
  undefined8 local_68;
  ulonglong local_60 [5];
  ulonglong local_38;
  
                    // 0x62be0  1072  PrivMoveFileIdentityW
  local_38 = DAT_1800b2220 ^ (ulonglong)auStackY408;
  local_154 = 0;
  local_130 = -1;
  local_128 = -1;
  local_108[0] = 0;
  local_100 = 0;
  local_148 = 0;
  local_120[0] = 0;
  local_118 = 0;
  local_140 = 0;
  local_150[0] = 1;
  uVar2 = 0x82;
  local_110 = param_2;
  if ((param_3 & 1) != 0) {
    uVar2 = 0x10082;
  }
  while ((local_14c = uVar2,
         local_158 = FUN_180062270(param_1,local_108,&local_148,&local_130,local_e8,uVar2),
         local_158 < 0 && ((uVar2 & param_3 & 2) != 0))) {
    if (local_148 != 0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_148);
      local_148 = 0;
      uVar2 = local_14c;
    }
    if (local_130 != -1) {
      NtClose();
      local_130 = -1;
    }
    uVar2 = uVar2 & 0xfffffffd;
    if (-1 < local_154) {
      local_154 = local_158;
    }
  }
  if (-1 < local_158) {
    uVar1 = uVar2 & 2;
    uVar3 = 0x100;
    if (uVar1 != 0) {
      uVar3 = 0x102;
    }
    while ((local_138 = uVar3,
           local_158 = FUN_180062270(local_110,local_120,&local_140,&local_128,local_b8,
                                     (-(uint)(uVar1 != 0) & 2) + 0x100), local_158 < 0 &&
           ((uVar3 & param_3 & 2) != 0))) {
      if (local_140 != 0) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_140);
        local_140 = 0;
        uVar2 = local_14c;
        uVar3 = local_138;
      }
      if (local_128 != -1) {
        NtClose();
        local_128 = -1;
      }
      uVar3 = uVar3 & 0xfffffffd;
      if (-1 < local_154) {
        local_154 = local_158;
      }
    }
    if (-1 < local_158) {
      local_158 = NtQueryInformationFile(local_130,local_f8,local_60,0x28);
      if (-1 < local_158) {
        local_78 = ZEXT816(0);
        local_68 = 0;
        local_88 = ZEXT816(local_60[0]);
        local_158 = NtSetInformationFile(local_128,local_f8,local_88,0x28);
      }
      if (local_158 < 0) {
        if ((param_3 & 2) == 0) goto LAB_180062f23;
        if (-1 < local_154) {
          local_154 = local_158;
        }
        local_158 = 0;
      }
      if ((((uVar3 & uVar2 & 2) != 0) &&
          (local_158 = BasepNotifyTrackingService(&local_130,local_e8,local_128,local_120),
          local_158 < 0)) && ((param_3 & 2) != 0)) {
        if (-1 < local_154) {
          local_154 = local_158;
        }
        local_158 = 0;
      }
    }
  }
LAB_180062f23:
  if (local_148 != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_148);
  }
  if (local_140 != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_140);
  }
  if ((-1 < local_158) && ((param_3 & 1) != 0)) {
    local_158 = NtSetInformationFile(local_130,local_f8,local_150,1);
  }
  if (local_128 != -1) {
    NtClose();
  }
  if (local_130 != -1) {
    NtClose();
  }
  if ((local_158 < 0) || (local_154 < 0)) {
    BaseSetLastNTError();
  }
  __security_check_cookie(local_38 ^ (ulonglong)auStackY408);
  return;
}



void FUN_18006302f(undefined8 param_1,longlong param_2)

{
  longlong in_GS_OFFSET;
  
  if (*(longlong *)(param_2 + 0x50) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x50));
  }
  if (*(longlong *)(param_2 + 0x58) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x58));
  }
  return;
}



BOOL SetFileAttributesTransactedA(LPCSTR lpFileName,DWORD dwFileAttributes,HANDLE hTransaction)

{
  int iVar1;
  undefined8 uVar2;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x630a0  1324  SetFileAttributesTransactedA
  uVar2 = Basep8BitStringToDynamicUnicodeString();
  iVar1 = (int)uVar2;
  if (iVar1 != 0) {
    iVar1 = SetFileAttributesTransactedW(local_10,dwFileAttributes,hTransaction);
    RtlFreeUnicodeString(local_18);
  }
  return iVar1;
}



BOOL SetFileAttributesTransactedW(LPCWSTR lpFileName,DWORD dwFileAttributes,HANDLE hTransaction)

{
  BOOL BVar1;
  longlong lVar2;
  undefined8 uVar3;
  undefined4 in_register_00000014;
  
                    // 0x63100  1325  SetFileAttributesTransactedW
  if ((longlong)hTransaction - 1U < 0xfffffffffffffffe) {
    lVar2 = RtlGetCurrentTransaction(lpFileName,CONCAT44(in_register_00000014,dwFileAttributes));
    if (lVar2 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      BVar1 = SetFileAttributesW(lpFileName,dwFileAttributes);
      RtlSetCurrentTransaction(0);
      return BVar1;
    }
    uVar3 = 0x1a45;
  }
  else {
    uVar3 = 0x1a2c;
  }
  RtlSetLastWin32Error(uVar3);
  return 0;
}



void FUN_18006319e(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800631ae. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlSetCurrentTransaction(0);
  return;
}



ulonglong Heap32First(longlong *param_1,undefined4 param_2,longlong param_3)

{
  longlong *plVar1;
  longlong *plVar2;
  ushort uVar3;
  longlong *plVar4;
  longlong lVar5;
  longlong *plVar6;
  int iVar7;
  uint uVar8;
  longlong lVar9;
  ulonglong uVar10;
  longlong *plVar11;
  longlong *plVar12;
  ulonglong uVar13;
  longlong *plVar14;
  uint uVar15;
  
                    // 0x631d0  846  Heap32First
  uVar13 = 0;
  if ((param_1 != (longlong *)0x0) && (*param_1 == 0x38)) {
    uVar15 = 0x400000;
    while (lVar9 = RtlCreateQueryDebugBuffer(uVar15,0), lVar9 != 0) {
      plVar4 = *(longlong **)(lVar9 + 8);
      lVar5 = *(longlong *)(lVar9 + 0x58);
      iVar7 = RtlQueryProcessDebugInformation();
      if (iVar7 != -0x3fffffe9) {
LAB_18006327d:
        if (-1 < iVar7) {
          plVar6 = *(longlong **)(lVar9 + 0x70);
          if (((((plVar6 < plVar4) || (plVar12 = plVar6 + 0xc, plVar12 < plVar6)) ||
               (plVar2 = (longlong *)(lVar5 + (longlong)plVar4), plVar2 < plVar4)) ||
              (plVar2 < plVar12)) ||
             ((uVar15 = *(uint *)plVar6, 1 < uVar15 &&
              (((uVar10 = (ulonglong)(uVar15 - 1) * 0x58, 0xffffffff < uVar10 || (plVar12 < plVar4))
               || ((plVar11 = (longlong *)((uVar10 & 0xffffffff) + (longlong)plVar12),
                   plVar11 < plVar12 || (plVar2 < plVar11)))))))) goto LAB_18006341e;
          if (uVar15 == 0) goto LAB_18006340b;
          plVar12 = plVar6 + 1;
          uVar10 = uVar13;
          goto LAB_180063319;
        }
        RtlDestroyQueryDebugBuffer(lVar9);
        break;
      }
      if (uVar15 * 2 <= uVar15) {
        iVar7 = -0x3fffffdd;
        goto LAB_18006327d;
      }
      RtlDestroyQueryDebugBuffer();
      uVar15 = uVar15 * 2;
    }
  }
LAB_180063440:
  BaseSetLastNTError();
  return 0;
  while( true ) {
    uVar8 = (int)uVar10 + 1;
    uVar10 = (ulonglong)uVar8;
    plVar12 = plVar12 + 0xb;
    if (uVar15 <= uVar8) break;
LAB_180063319:
    if (*plVar12 == param_3) {
      plVar12 = (longlong *)plVar12[10];
      if (((plVar12 < plVar4) || (plVar11 = plVar12 + 4, plVar11 < plVar12)) || (plVar2 < plVar11))
      goto LAB_18006341e;
      *(undefined4 *)((longlong)param_1 + 0x2c) = param_2;
      *(undefined8 *)((longlong)param_1 + 0x24) = 0;
      param_1[6] = param_3;
      param_1[1] = param_3;
      if ((*(byte *)(plVar12 + 1) & 2) == 0) goto LAB_1800633af;
      goto LAB_18006336e;
    }
  }
  goto LAB_18006340b;
LAB_18006341e:
  RtlDestroyQueryDebugBuffer(lVar9);
  goto LAB_180063440;
  while (plVar1 = plVar11 + 1, plVar11 = plVar14, (*(byte *)plVar1 & 2) != 0) {
LAB_18006336e:
    uVar3 = *(ushort *)(uVar10 * 0x58 + 0x14 + (longlong)plVar6);
    lVar5 = plVar11[-1];
    *(int *)(param_1 + 5) = *(int *)(param_1 + 5) + 1;
    param_1[2] = (ulonglong)uVar3 + lVar5;
    if (*(uint *)(uVar10 * 0x58 + 0x2c + *(longlong *)(lVar9 + 0x70)) <= *(uint *)(param_1 + 5)) {
      RtlDestroyQueryDebugBuffer(lVar9);
      RtlSetLastWin32Error(0x12);
      return 0;
    }
    plVar12 = plVar12 + 4;
    plVar14 = plVar11 + 4;
    if (((plVar12 < plVar4) || (plVar14 < plVar12)) || (plVar2 < plVar14)) goto LAB_18006341e;
  }
LAB_1800633af:
  if ((*(ushort *)(plVar12 + 1) & 0x20f1) == 0) {
    if ((*(byte *)(plVar12 + 1) & 0x20) == 0) {
      if ((*(ushort *)(plVar12 + 1) & 0x1000) != 0) {
        *(undefined4 *)(param_1 + 4) = 2;
      }
    }
    else {
      *(undefined4 *)(param_1 + 4) = 4;
    }
  }
  else {
    *(undefined4 *)(param_1 + 4) = 1;
  }
  uVar13 = 1;
  param_1[3] = *plVar12;
LAB_18006340b:
  RtlDestroyQueryDebugBuffer(lVar9);
  return uVar13;
}



bool Heap32ListFirst(undefined8 param_1,longlong *param_2)

{
  undefined4 *puVar1;
  longlong lVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  int iVar6;
  int *local_res10;
  undefined8 local_res18;
  undefined8 local_res20;
  
                    // 0x63470  847  Heap32ListFirst
  if ((param_2 != (longlong *)0x0) && (*param_2 == 0x20)) {
    local_res18 = 0;
    local_res20 = 0;
    local_res10 = (int *)0x0;
    iVar6 = NtMapViewOfSection(param_1,0xffffffffffffffff,&local_res10,0,0,&local_res18,&local_res20
                               ,1,0,4);
    if (-1 < iVar6) {
      iVar6 = *local_res10;
      if (iVar6 != 0) {
        lVar2 = *(longlong *)(local_res10 + 4);
        puVar1 = (undefined4 *)(lVar2 + (longlong)local_res10);
        uVar3 = puVar1[1];
        uVar4 = puVar1[2];
        uVar5 = puVar1[3];
        *(undefined4 *)param_2 = *puVar1;
        *(undefined4 *)((longlong)param_2 + 4) = uVar3;
        *(undefined4 *)(param_2 + 1) = uVar4;
        *(undefined4 *)((longlong)param_2 + 0xc) = uVar5;
        puVar1 = (undefined4 *)(lVar2 + 0x10 + (longlong)local_res10);
        uVar3 = puVar1[1];
        uVar4 = puVar1[2];
        uVar5 = puVar1[3];
        *(undefined4 *)(param_2 + 2) = *puVar1;
        *(undefined4 *)((longlong)param_2 + 0x14) = uVar3;
        *(undefined4 *)(param_2 + 3) = uVar4;
        *(undefined4 *)((longlong)param_2 + 0x1c) = uVar5;
        local_res10[0xc] = 1;
      }
      else {
        memset(param_2 + 1,0,*param_2 - 8);
        RtlSetLastWin32Error(0x12);
      }
      NtUnmapViewOfSection(0xffffffffffffffff,local_res10);
      return iVar6 != 0;
    }
  }
  BaseSetLastNTError();
  return false;
}



bool Heap32ListNext(undefined8 param_1,longlong *param_2)

{
  undefined4 *puVar1;
  uint uVar2;
  uint uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  int iVar7;
  longlong lVar8;
  uint *local_res10;
  undefined8 local_res18;
  undefined8 local_res20;
  
                    // 0x63570  848  Heap32ListNext
  if ((param_2 != (longlong *)0x0) && (*param_2 == 0x20)) {
    local_res18 = 0;
    local_res20 = 0;
    local_res10 = (uint *)0x0;
    iVar7 = NtMapViewOfSection(param_1,0xffffffffffffffff,&local_res10,0,0,&local_res18,&local_res20
                               ,1,0,4);
    if (-1 < iVar7) {
      uVar3 = local_res10[0xc];
      uVar2 = *local_res10;
      if (uVar2 <= uVar3) {
        RtlSetLastWin32Error(0x12);
      }
      else {
        lVar8 = (ulonglong)uVar3 * 0x20 + *(longlong *)(local_res10 + 4);
        local_res10[0xc] = uVar3 + 1;
        puVar1 = (undefined4 *)(lVar8 + (longlong)local_res10);
        uVar4 = puVar1[1];
        uVar5 = puVar1[2];
        uVar6 = puVar1[3];
        *(undefined4 *)param_2 = *puVar1;
        *(undefined4 *)((longlong)param_2 + 4) = uVar4;
        *(undefined4 *)(param_2 + 1) = uVar5;
        *(undefined4 *)((longlong)param_2 + 0xc) = uVar6;
        puVar1 = (undefined4 *)(lVar8 + 0x10 + (longlong)local_res10);
        uVar4 = puVar1[1];
        uVar5 = puVar1[2];
        uVar6 = puVar1[3];
        *(undefined4 *)(param_2 + 2) = *puVar1;
        *(undefined4 *)((longlong)param_2 + 0x14) = uVar4;
        *(undefined4 *)(param_2 + 3) = uVar5;
        *(undefined4 *)((longlong)param_2 + 0x1c) = uVar6;
      }
      NtUnmapViewOfSection(0xffffffffffffffff,local_res10);
      return uVar2 > uVar3;
    }
  }
  BaseSetLastNTError();
  return false;
}



undefined8 Heap32Next(longlong *param_1)

{
  longlong *plVar1;
  longlong *plVar2;
  ushort uVar3;
  longlong *plVar4;
  longlong *plVar5;
  longlong lVar6;
  int iVar7;
  longlong lVar8;
  ulonglong uVar9;
  longlong *plVar10;
  longlong *plVar11;
  uint uVar12;
  ulonglong uVar13;
  longlong *plVar14;
  longlong lVar15;
  uint uVar16;
  
                    // 0x63670  849  Heap32Next
  uVar13 = 0;
  if ((param_1 != (longlong *)0x0) && (*param_1 == 0x38)) {
    uVar16 = 0x400000;
    while (lVar8 = RtlCreateQueryDebugBuffer(uVar16,0), lVar8 != 0) {
      plVar4 = *(longlong **)(lVar8 + 8);
      lVar15 = *(longlong *)(lVar8 + 0x58);
      iVar7 = RtlQueryProcessDebugInformation();
      if (iVar7 != -0x3fffffe9) {
LAB_180063713:
        if (-1 < iVar7) {
          plVar5 = *(longlong **)(lVar8 + 0x70);
          if (((((plVar5 < plVar4) || (plVar11 = plVar5 + 0xc, plVar11 < plVar5)) ||
               (plVar2 = (longlong *)(lVar15 + (longlong)plVar4), plVar2 < plVar4)) ||
              (plVar2 < plVar11)) ||
             ((uVar16 = *(uint *)plVar5, 1 < uVar16 &&
              (((uVar9 = (ulonglong)(uVar16 - 1) * 0x58, 0xffffffff < uVar9 || (plVar11 < plVar4))
               || ((plVar10 = (longlong *)((uVar9 & 0xffffffff) + (longlong)plVar11),
                   plVar10 < plVar11 || (plVar2 < plVar10)))))))) goto LAB_1800638d1;
          if (uVar16 == 0) goto LAB_1800638af;
          goto LAB_1800637ad;
        }
        RtlDestroyQueryDebugBuffer(lVar8);
        break;
      }
      if (uVar16 * 2 <= uVar16) {
        iVar7 = -0x3fffffdd;
        goto LAB_180063713;
      }
      RtlDestroyQueryDebugBuffer();
      uVar16 = uVar16 * 2;
    }
  }
LAB_1800638f3:
  BaseSetLastNTError();
  return 0;
  while( true ) {
    uVar12 = uVar12 + 1;
    uVar13 = (ulonglong)uVar12;
    if (uVar16 <= uVar12) break;
LAB_1800637ad:
    uVar12 = (uint)uVar13;
    if (plVar5[uVar13 * 0xb + 1] == param_1[6]) break;
  }
  if (uVar12 < uVar16) {
    *(int *)(param_1 + 5) = *(int *)(param_1 + 5) + 1;
    lVar15 = (ulonglong)uVar12 * 0x58;
    if (*(uint *)(param_1 + 5) < *(uint *)(lVar15 + 0x2c + (longlong)plVar5)) {
      plVar11 = (longlong *)
                ((ulonglong)*(uint *)(param_1 + 5) * 0x20 + plVar5[(ulonglong)uVar12 * 0xb + 0xb]);
      if (((plVar4 <= plVar11) && (plVar10 = plVar11 + 4, plVar11 <= plVar10)) &&
         (plVar10 <= plVar2)) {
        if ((*(byte *)(plVar11 + 1) & 2) == 0) {
          param_1[2] = param_1[2] + param_1[3];
        }
        else {
          do {
            uVar3 = *(ushort *)(lVar15 + 0x14 + (longlong)plVar5);
            lVar6 = plVar10[-1];
            *(int *)(param_1 + 5) = *(int *)(param_1 + 5) + 1;
            param_1[2] = (ulonglong)uVar3 + lVar6;
            if (*(uint *)(*(longlong *)(lVar8 + 0x70) + 0x2c + lVar15) <= *(uint *)(param_1 + 5))
            goto LAB_1800638af;
            plVar11 = plVar11 + 4;
            plVar14 = plVar10 + 4;
            if (((plVar11 < plVar4) || (plVar14 < plVar11)) || (plVar2 < plVar14))
            goto LAB_1800638d1;
            plVar1 = plVar10 + 1;
            plVar10 = plVar14;
          } while ((*(byte *)plVar1 & 2) != 0);
        }
        param_1[3] = *plVar11;
        if ((*(ushort *)(plVar11 + 1) & 0x20f1) == 0) {
          if ((*(byte *)(plVar11 + 1) & 0x20) == 0) {
            if ((*(ushort *)(plVar11 + 1) & 0x1000) != 0) {
              *(undefined4 *)(param_1 + 4) = 2;
            }
          }
          else {
            *(undefined4 *)(param_1 + 4) = 4;
          }
        }
        else {
          *(undefined4 *)(param_1 + 4) = 1;
        }
        RtlDestroyQueryDebugBuffer(lVar8);
        return 1;
      }
LAB_1800638d1:
      RtlDestroyQueryDebugBuffer(lVar8);
      goto LAB_1800638f3;
    }
  }
LAB_1800638af:
  RtlDestroyQueryDebugBuffer(lVar8);
  RtlSetLastWin32Error(0x12);
  return 0;
}



void Module32First(undefined8 param_1,uint *param_2)

{
  undefined auStackY1176 [32];
  uint local_458;
  uint local_454;
  uint local_450;
  uint local_44c;
  uint local_448;
  undefined8 local_440;
  uint local_438;
  undefined8 local_430;
  WCHAR local_428 [256];
  WCHAR local_228 [264];
  ulonglong local_18;
  
                    // 0x63920  1002  Module32First
  local_18 = DAT_1800b2220 ^ (ulonglong)auStackY1176;
  if ((param_2 == (uint *)0x0) || (*param_2 < 0x238)) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    local_458 = 0x438;
    Module32FirstW(param_1,&local_458);
    WideCharToMultiByte(0,0x400,local_228,-1,(LPSTR)(param_2 + 0x4c),0x104,(LPCSTR)0x0,(LPBOOL)0x0);
    WideCharToMultiByte(0,0x400,local_428,-1,(LPSTR)(param_2 + 0xc),0x100,(LPCSTR)0x0,(LPBOOL)0x0);
    param_2[1] = local_454;
    param_2[2] = local_450;
    param_2[3] = local_44c;
    param_2[4] = local_448;
    *(undefined8 *)(param_2 + 6) = local_440;
    param_2[8] = local_438;
    *(undefined8 *)(param_2 + 10) = local_430;
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStackY1176);
  return;
}



void Module32Next(undefined8 param_1,uint *param_2)

{
  undefined auStackY1176 [32];
  int local_458;
  uint local_454;
  uint local_44c;
  uint local_448;
  undefined8 local_440;
  uint local_438;
  undefined8 local_430;
  WCHAR local_428 [256];
  WCHAR local_228 [264];
  ulonglong local_18;
  
                    // 0x63a60  1004  Module32Next
  local_18 = DAT_1800b2220 ^ (ulonglong)auStackY1176;
  if ((param_2 == (uint *)0x0) || (*param_2 < 0x238)) {
    RtlSetLastWin32Error(0xd);
  }
  else {
    local_458 = 0x438;
    Module32NextW(param_1,&local_458);
    WideCharToMultiByte(0,0x400,local_428,-1,(LPSTR)(param_2 + 0xc),0x100,(LPCSTR)0x0,(LPBOOL)0x0);
    WideCharToMultiByte(0,0x400,local_228,-1,(LPSTR)(param_2 + 0x4c),0x104,(LPCSTR)0x0,(LPBOOL)0x0);
    param_2[1] = local_454;
    param_2[3] = local_44c;
    param_2[4] = local_448;
    *(undefined8 *)(param_2 + 6) = local_440;
    param_2[8] = local_438;
    *(undefined8 *)(param_2 + 10) = local_430;
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStackY1176);
  return;
}



void Process32First(undefined8 param_1,uint *param_2)

{
  undefined auStackY664 [32];
  uint local_258;
  uint local_254;
  uint local_250;
  undefined8 local_248;
  uint local_240;
  uint local_23c;
  uint local_238;
  uint local_234;
  uint local_230;
  WCHAR local_22c [266];
  ulonglong local_18;
  
                    // 0x63b90  1073  Process32First
  local_18 = DAT_1800b2220 ^ (ulonglong)auStackY664;
  if ((param_2 == (uint *)0x0) || (*param_2 < 0x130)) {
    BaseSetLastNTError();
  }
  else {
    local_258 = 0x238;
    Process32FirstW(param_1,&local_258);
    WideCharToMultiByte(0,0x400,local_22c,-1,(LPSTR)(param_2 + 0xb),0x104,(LPCSTR)0x0,(LPBOOL)0x0);
    *(undefined8 *)(param_2 + 4) = local_248;
    param_2[6] = local_240;
    param_2[7] = local_23c;
    param_2[8] = local_238;
    param_2[9] = local_234;
    param_2[1] = local_254;
    param_2[10] = local_230;
    param_2[2] = local_250;
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStackY664);
  return;
}



void Process32Next(undefined8 param_1,uint *param_2)

{
  undefined auStackY664 [32];
  int local_258;
  uint local_254;
  uint local_250;
  undefined8 local_248;
  uint local_240;
  uint local_23c;
  uint local_238;
  uint local_234;
  uint local_230;
  WCHAR local_22c [266];
  ulonglong local_18;
  
                    // 0x63c90  1075  Process32Next
  local_18 = DAT_1800b2220 ^ (ulonglong)auStackY664;
  if ((param_2 == (uint *)0x0) || (*param_2 < 0x130)) {
    BaseSetLastNTError();
  }
  else {
    local_258 = 0x238;
    Process32NextW(param_1,&local_258);
    WideCharToMultiByte(0,0x400,local_22c,-1,(LPSTR)(param_2 + 0xb),0x104,(LPCSTR)0x0,(LPBOOL)0x0);
    *(undefined8 *)(param_2 + 4) = local_248;
    param_2[6] = local_240;
    param_2[7] = local_23c;
    param_2[8] = local_238;
    param_2[9] = local_234;
    param_2[1] = local_254;
    param_2[10] = local_230;
    param_2[2] = local_250;
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStackY664);
  return;
}



BOOL DefineDosDeviceA(DWORD dwFlags,LPCSTR lpDeviceName,LPCSTR lpTargetPath)

{
  BOOL BVar1;
  undefined8 uVar2;
  undefined local_28 [8];
  LPCWSTR local_20;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x63d90  272  DefineDosDeviceA
  uVar2 = Basep8BitStringToDynamicUnicodeString();
  BVar1 = 0;
  if ((int)uVar2 == 0) {
    return 0;
  }
  if (lpTargetPath == (LPCSTR)0x0) {
    local_20 = (LPCWSTR)0x0;
  }
  else {
    uVar2 = Basep8BitStringToDynamicUnicodeString();
    if ((int)uVar2 == 0) goto LAB_180063e06;
  }
  BVar1 = DefineDosDeviceW(dwFlags,local_10,local_20);
  if (lpTargetPath != (LPCSTR)0x0) {
    RtlFreeUnicodeString(local_28);
  }
LAB_180063e06:
  RtlFreeUnicodeString(local_18);
  return BVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Could not reconcile some variable overlaps

DWORD QueryDosDeviceA(LPCSTR lpDeviceName,LPSTR lpTargetPath,DWORD ucchMax)

{
  DWORD DVar1;
  int iVar2;
  undefined8 uVar3;
  undefined4 *puVar4;
  LPWSTR lpTargetPath_00;
  code *pcVar5;
  ushort uVar6;
  uint uVar7;
  uint uVar8;
  LPCWSTR pWVar9;
  LPCWSTR pWVar10;
  longlong in_GS_OFFSET;
  undefined local_58 [16];
  ushort local_48;
  short local_46;
  LPSTR local_40;
  short local_38;
  short local_36;
  LPWSTR local_30;
  
                    // 0x63e30  1098  QueryDosDeviceA
  pWVar9 = (LPCWSTR)0x0;
  local_58 = ZEXT816(0);
  local_58._8_8_ = pWVar9;
  if (lpDeviceName != (LPCSTR)0x0) {
    uVar3 = Basep8BitStringToDynamicUnicodeString();
    if ((int)uVar3 == 0) {
      return 0;
    }
  }
  puVar4 = (undefined4 *)KernelBaseGetGlobalData();
  lpTargetPath_00 =
       (LPWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),*puVar4);
  if (lpTargetPath_00 == (LPWSTR)0x0) {
    RtlSetLastWin32Error(8);
    if (local_58._8_8_ != (LPCWSTR)0x0) {
      RtlFreeUnicodeString(local_58);
    }
    return 0;
  }
  DVar1 = QueryDosDeviceW(local_58._8_8_,lpTargetPath_00,ucchMax);
  uVar7 = DVar1 - 1;
  if (DVar1 == 0) {
    uVar7 = 0;
  }
  pWVar10 = pWVar9;
  if (uVar7 != 0) {
    do {
      uVar6 = 0x7ffe;
      if (uVar7 - (int)pWVar9 < 0x7ffe) {
        uVar6 = (short)uVar7 - (short)pWVar9;
      }
      local_40 = (LPSTR)((longlong)pWVar10 + (longlong)lpTargetPath);
      local_48 = 0;
      if (ucchMax - (int)pWVar10 < 0x10000) {
        local_46 = (short)ucchMax - (short)pWVar10;
      }
      else {
        local_46 = -1;
      }
      local_30 = lpTargetPath_00 + (longlong)pWVar9;
      while( true ) {
        local_38 = uVar6 * 2;
        local_36 = local_38 + 2;
        pcVar5 = (code *)GetUnicodeStringToEightBitStringRoutine();
        iVar2 = (*pcVar5)();
        if (iVar2 != -0x3fffff10) break;
        uVar6 = uVar6 >> 1;
      }
      if (iVar2 < 0) {
        BaseSetLastNTError();
        DVar1 = 0;
        break;
      }
      uVar8 = (int)pWVar9 + (uint)uVar6;
      pWVar9 = (LPCWSTR)(ulonglong)uVar8;
      pWVar10 = (LPCWSTR)(ulonglong)((int)pWVar10 + (uint)local_48);
    } while (uVar8 < uVar7);
  }
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpTargetPath_00);
  if (local_58._8_8_ != (LPCWSTR)0x0) {
    RtlFreeUnicodeString(local_58);
    return DVar1;
  }
  return DVar1;
}



BOOL DeleteVolumeMountPointA(LPCSTR lpszVolumeMountPoint)

{
  int iVar1;
  undefined8 uVar2;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x64030  290  DeleteVolumeMountPointA
  uVar2 = Basep8BitStringToDynamicUnicodeString();
  iVar1 = (int)uVar2;
  if (iVar1 != 0) {
    iVar1 = DeleteVolumeMountPointW(local_10);
    RtlFreeUnicodeString(local_18);
  }
  return iVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

HANDLE FindFirstVolumeA(LPSTR lpszVolumeName,DWORD cchBufferLength)

{
  ushort uVar1;
  int iVar2;
  undefined4 *puVar3;
  code *pcVar4;
  longlong in_GS_OFFSET;
  HANDLE local_38;
  uint local_30 [2];
  LPWSTR local_28;
  ushort local_20;
  short local_1e;
  LPSTR local_18;
  
  local_1e = (short)cchBufferLength;
                    // 0x64080  397  FindFirstVolumeA
  local_20 = local_1e - 1;
  local_28 = (LPWSTR)0x0;
  local_30[0] = 0;
  uVar1 = local_1e * 2;
  local_18 = lpszVolumeName;
  puVar3 = (undefined4 *)KernelBaseGetGlobalData();
  local_28 = (LPWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                     *puVar3,uVar1);
  if (local_28 == (LPWSTR)0x0) {
    RtlSetLastWin32Error(8);
  }
  else {
    local_30[0] = local_30[0] & 0xffff | (uint)uVar1 << 0x10;
    local_38 = FindFirstVolumeW(local_28,cchBufferLength);
    if (local_38 == (HANDLE)0xffffffffffffffff) goto LAB_18006419d;
    RtlInitUnicodeString(local_30,local_28);
    pcVar4 = (code *)GetUnicodeStringToEightBitStringRoutine();
    iVar2 = (*pcVar4)();
    if ((-1 < iVar2) && (local_20 < cchBufferLength)) {
      local_18[local_20] = '\0';
      goto LAB_18006419d;
    }
    BaseSetLastNTError();
  }
  local_38 = (HANDLE)0xffffffffffffffff;
LAB_18006419d:
  if (local_28 != (LPWSTR)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_28);
  }
  return local_38;
}



void FUN_1800641de(undefined8 param_1,longlong param_2)

{
  longlong in_GS_OFFSET;
  
  if (*(longlong *)(param_2 + 0x30) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x30));
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

HANDLE FindFirstVolumeMountPointA
                 (LPCSTR lpszRootPathName,LPSTR lpszVolumeMountPoint,DWORD cchBufferLength)

{
  ushort uVar1;
  int iVar2;
  undefined8 uVar3;
  undefined4 *puVar4;
  code *pcVar5;
  longlong in_GS_OFFSET;
  HANDLE local_40;
  uint local_38 [2];
  LPWSTR local_30;
  ushort local_28;
  short local_26;
  LPSTR local_20;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x64220  398  FindFirstVolumeMountPointA
  uVar3 = Basep8BitStringToDynamicUnicodeString();
  if ((int)uVar3 == 0) {
    return (HANDLE)0xffffffffffffffff;
  }
  local_26 = (short)cchBufferLength;
  local_28 = local_26 - 1;
  local_30 = (LPWSTR)0x0;
  local_38[0] = 0;
  uVar1 = local_26 * 2;
  local_20 = lpszVolumeMountPoint;
  puVar4 = (undefined4 *)KernelBaseGetGlobalData();
  local_30 = (LPWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                     *puVar4);
  if (local_30 == (LPWSTR)0x0) {
    RtlSetLastWin32Error(8);
  }
  else {
    local_38[0] = local_38[0] & 0xffff | (uint)uVar1 << 0x10;
    local_40 = FindFirstVolumeMountPointW(local_10,local_30,cchBufferLength);
    if (local_40 == (HANDLE)0xffffffffffffffff) goto LAB_18006436f;
    RtlInitUnicodeString(local_38,local_30);
    pcVar5 = (code *)GetUnicodeStringToEightBitStringRoutine();
    iVar2 = (*pcVar5)();
    if ((-1 < iVar2) && (local_28 < cchBufferLength)) {
      local_20[local_28] = '\0';
      goto LAB_18006436f;
    }
    BaseSetLastNTError();
  }
  local_40 = (HANDLE)0xffffffffffffffff;
LAB_18006436f:
  if (local_30 != (LPWSTR)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_30);
  }
  RtlFreeUnicodeString(local_18);
  return local_40;
}



HANDLE FindFirstVolumeMountPointW
                 (LPCWSTR lpszRootPathName,LPWSTR lpszVolumeMountPoint,DWORD cchBufferLength)

{
  int iVar1;
  UINT UVar2;
  undefined4 *puVar3;
  HANDLE hObject;
  HANDLE *ppvVar4;
  undefined4 uVar5;
  uint uVar6;
  longlong in_GS_OFFSET;
  ushort local_48;
  undefined2 local_46;
  LPCWSTR local_40;
  ushort local_38 [4];
  longlong local_30;
  ushort local_28 [8];
  
                    // 0x64410  399  FindFirstVolumeMountPointW
  if (lpszRootPathName != (LPCWSTR)0x0) {
    iVar1 = RtlInitUnicodeStringEx(local_38,lpszRootPathName);
    if ((iVar1 < 0) || (*(short *)(local_30 + -2 + (ulonglong)(local_38[0] >> 1) * 2) != 0x5c)) {
LAB_18006445d:
      BaseSetLastNTError();
      return (HANDLE)0xffffffffffffffff;
    }
    UVar2 = GetDriveTypeW(lpszRootPathName);
    if (UVar2 != 4) {
      RtlInitUnicodeString();
      uVar6 = local_38[0] + 2 + (uint)local_28[0];
      if (0xffff < uVar6) goto LAB_18006445d;
      local_46 = (undefined2)uVar6;
      local_48 = 0;
      puVar3 = (undefined4 *)KernelBaseGetGlobalData();
      local_40 = (LPCWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30)
                                          ,*puVar3,local_46);
      if (local_40 != (LPCWSTR)0x0) {
        RtlCopyUnicodeString(&local_48,local_38);
        RtlAppendUnicodeStringToString(&local_48,local_28);
        local_40[local_48 >> 1] = L'\0';
        hObject = CreateFileW(local_40,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0x2020000,
                              (HANDLE)0x0);
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_40);
        if (hObject != (HANDLE)0xffffffffffffffff) {
          puVar3 = (undefined4 *)KernelBaseGetGlobalData();
          ppvVar4 = (HANDLE *)
                    RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                    *puVar3);
          if (ppvVar4 == (HANDLE *)0x0) {
            CloseHandle(hObject);
            RtlSetLastWin32Error(8);
          }
          else {
            ppvVar4[1] = (HANDLE)0x0;
            ppvVar4[2] = (HANDLE)0x0;
            *ppvVar4 = hObject;
            iVar1 = FUN_1800649d8(ppvVar4,lpszVolumeMountPoint,cchBufferLength,1);
            if (iVar1 != 0) {
              return ppvVar4;
            }
            CloseHandle(*ppvVar4);
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,ppvVar4);
          }
        }
        return (HANDLE)0xffffffffffffffff;
      }
      uVar5 = 8;
      goto LAB_180064666;
    }
  }
  uVar5 = 0x57;
LAB_180064666:
  RtlSetLastWin32Error(uVar5);
  return (HANDLE)0xffffffffffffffff;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

BOOL FindNextVolumeA(HANDLE hFindVolume,LPSTR lpszVolumeName,DWORD cchBufferLength)

{
  ushort uVar1;
  int iVar2;
  undefined4 *puVar3;
  code *pcVar4;
  longlong in_GS_OFFSET;
  BOOL local_48;
  uint local_40 [2];
  LPWSTR local_38;
  ushort local_30;
  short local_2e;
  LPSTR local_28;
  
  local_2e = (short)cchBufferLength;
                    // 0x646a0  408  FindNextVolumeA
  local_30 = local_2e - 1;
  local_38 = (LPWSTR)0x0;
  local_40[0] = 0;
  uVar1 = local_2e * 2;
  local_28 = lpszVolumeName;
  puVar3 = (undefined4 *)KernelBaseGetGlobalData();
  local_38 = (LPWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                     *puVar3);
  if (local_38 == (LPWSTR)0x0) {
    RtlSetLastWin32Error(8);
  }
  else {
    local_40[0] = local_40[0] & 0xffff | (uint)uVar1 << 0x10;
    local_48 = FindNextVolumeW(hFindVolume,local_38,cchBufferLength);
    if (local_48 == 0) goto LAB_1800647c1;
    RtlInitUnicodeString(local_40,local_38);
    pcVar4 = (code *)GetUnicodeStringToEightBitStringRoutine();
    iVar2 = (*pcVar4)();
    if ((-1 < iVar2) && (local_30 < cchBufferLength)) {
      local_28[local_30] = '\0';
      goto LAB_1800647c1;
    }
    BaseSetLastNTError();
  }
  local_48 = 0;
LAB_1800647c1:
  if (local_38 != (LPWSTR)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_38);
  }
  return local_48;
}



void FUN_1800647fd(undefined8 param_1,longlong param_2)

{
  longlong in_GS_OFFSET;
  
  if (*(longlong *)(param_2 + 0x30) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x30));
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

BOOL FindNextVolumeMountPointA
               (HANDLE hFindVolumeMountPoint,LPSTR lpszVolumeMountPoint,DWORD cchBufferLength)

{
  ushort uVar1;
  int iVar2;
  undefined4 *puVar3;
  code *pcVar4;
  longlong in_GS_OFFSET;
  int local_48;
  uint local_40 [2];
  void *local_38;
  ushort local_30;
  short local_2e;
  LPSTR local_28;
  
  local_2e = (short)cchBufferLength;
                    // 0x64840  409  FindNextVolumeMountPointA
  local_30 = local_2e - 1;
  local_38 = (void *)0x0;
  local_40[0] = 0;
  uVar1 = local_2e * 2;
  local_28 = lpszVolumeMountPoint;
  puVar3 = (undefined4 *)KernelBaseGetGlobalData();
  local_38 = (void *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                     *puVar3);
  if (local_38 == (void *)0x0) {
    RtlSetLastWin32Error(8);
  }
  else {
    local_40[0] = local_40[0] & 0xffff | (uint)uVar1 << 0x10;
    local_48 = FUN_1800649d8((undefined8 *)hFindVolumeMountPoint,local_38,cchBufferLength,0);
    if (local_48 == 0) goto LAB_18006495d;
    RtlInitUnicodeString(local_40,local_38);
    pcVar4 = (code *)GetUnicodeStringToEightBitStringRoutine();
    iVar2 = (*pcVar4)();
    if ((-1 < iVar2) && (local_30 < cchBufferLength)) {
      local_28[local_30] = '\0';
      goto LAB_18006495d;
    }
    BaseSetLastNTError();
  }
  local_48 = 0;
LAB_18006495d:
  if (local_38 != (void *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_38);
  }
  return local_48;
}



void FUN_180064999(undefined8 param_1,longlong param_2)

{
  longlong in_GS_OFFSET;
  
  if (*(longlong *)(param_2 + 0x30) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x30));
  }
  return;
}



void FUN_1800649d8(undefined8 *param_1,void *param_2,int param_3,ulonglong param_4)

{
  short sVar1;
  int iVar2;
  BOOL BVar3;
  undefined4 *puVar4;
  int *lpOutBuffer;
  ulonglong uVar5;
  uint *puVar6;
  undefined8 uVar7;
  ulonglong uVar8;
  longlong in_GS_OFFSET;
  undefined auStackY328 [32];
  HANDLE local_e8;
  ulonglong local_e0;
  undefined4 local_d8 [2];
  DWORD local_d0 [2];
  undefined4 local_c8;
  undefined4 *local_c0;
  undefined4 local_b8 [2];
  undefined4 *local_b0;
  undefined local_a8 [16];
  undefined4 local_98 [2];
  undefined8 local_90;
  undefined4 *local_88;
  undefined4 local_80;
  undefined local_78 [16];
  undefined4 local_68;
  undefined4 uStack100;
  int iStack96;
  undefined4 uStack92;
  undefined4 local_58;
  undefined8 local_54;
  ulonglong local_48;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStackY328;
  local_e0 = 0;
  uVar8 = param_4 & 0xffffffff;
  if ((((longlong)param_1 - 1U < 0xfffffffffffffffe) && (param_2 != (void *)0x0)) && (param_3 != 0))
  {
    do {
      if ((int)uVar8 == 0) {
        if (*(int *)(param_1 + 2) == 0) goto LAB_180064a8c;
        local_68 = *(undefined4 *)(param_1 + 1);
        uStack100 = *(undefined4 *)((longlong)param_1 + 0xc);
        iStack96 = *(int *)(param_1 + 2);
        uStack92 = *(undefined4 *)((longlong)param_1 + 0x14);
        *(undefined4 *)(param_1 + 2) = 0;
      }
      else {
        local_c0 = &local_58;
        local_54 = 0;
        local_58 = 0xa0000003;
        local_c8 = 0xc000c;
        uVar8 = 0;
LAB_180064a8c:
        iVar2 = NtQueryDirectoryFile(*param_1,0,0,0);
        if (iVar2 < 0) goto LAB_180064de8;
      }
      if (iStack96 != -0x5ffffffd) {
        uVar7 = 0x12;
        goto LAB_180064ee5;
      }
      local_b0 = &local_68;
      local_b8[0] = 0x80008;
      local_90 = *param_1;
      local_88 = local_b8;
      local_98[0] = 0x30;
      local_80 = 0;
      local_d8[0] = 0x11;
      local_78 = ZEXT816(0);
      iVar2 = RtlAcquirePrivilege(local_d8,1,0,&local_e0);
      if (iVar2 < 0) {
        local_e0 = 0;
      }
      iVar2 = NtOpenFile(&local_e8,0x100000,local_98);
      if (local_e0 != 0) {
        RtlReleasePrivilege();
      }
      if (iVar2 < 0) goto LAB_180064de8;
      puVar4 = (undefined4 *)KernelBaseGetGlobalData();
      lpOutBuffer = (int *)RtlAllocateHeap(*(undefined8 *)
                                            (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),*puVar4,
                                           0x4000);
      if (lpOutBuffer == (int *)0x0) goto LAB_180064d6c;
      BVar3 = DeviceIoControl(local_e8,0x900a8,(LPVOID)0x0,0,lpOutBuffer,0x4000,local_d0,
                              (LPOVERLAPPED)0x0);
      if ((BVar3 == 0) || (*lpOutBuffer != -0x5ffffffd)) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpOutBuffer);
        CloseHandle(local_e8);
        goto LAB_180064ef3;
      }
      uVar5 = (ulonglong)*(ushort *)(lpOutBuffer + 2);
      if (((((*(short *)((longlong)lpOutBuffer + 10) == 0x60) ||
            ((*(short *)((longlong)lpOutBuffer + 10) == 0x62 &&
             (*(short *)(uVar5 + 0x70 + (longlong)lpOutBuffer) == 0x5c)))) &&
           (*(short *)(uVar5 + 0x10 + (longlong)lpOutBuffer) == 0x5c)) &&
          ((((sVar1 = *(short *)(uVar5 + 0x12 + (longlong)lpOutBuffer), sVar1 == 0x3f ||
             (sVar1 == 0x5c)) && (*(short *)(uVar5 + 0x14 + (longlong)lpOutBuffer) == 0x3f)) &&
           ((*(short *)(uVar5 + 0x16 + (longlong)lpOutBuffer) == 0x5c &&
            (*(short *)(uVar5 + 0x18 + (longlong)lpOutBuffer) == 0x56)))))) &&
         ((((*(short *)(uVar5 + 0x1a + (longlong)lpOutBuffer) == 0x6f &&
            ((*(short *)(uVar5 + 0x1c + (longlong)lpOutBuffer) == 0x6c &&
             (*(short *)(uVar5 + 0x1e + (longlong)lpOutBuffer) == 0x75)))) &&
           ((*(short *)(uVar5 + 0x20 + (longlong)lpOutBuffer) == 0x6d &&
            ((((*(short *)(uVar5 + 0x22 + (longlong)lpOutBuffer) == 0x65 &&
               (*(short *)(uVar5 + 0x24 + (longlong)lpOutBuffer) == 0x7b)) &&
              (*(short *)(uVar5 + 0x36 + (longlong)lpOutBuffer) == 0x2d)) &&
             (((*(short *)(uVar5 + 0x40 + (longlong)lpOutBuffer) == 0x2d &&
               (*(short *)(uVar5 + 0x4a + (longlong)lpOutBuffer) == 0x2d)) &&
              ((*(short *)(uVar5 + 0x54 + (longlong)lpOutBuffer) == 0x2d &&
               ((*(short *)(uVar5 + 0x6e + (longlong)lpOutBuffer) == 0x7d &&
                (*(short *)((longlong)lpOutBuffer + 10) == 0x62)))))))))))) && (sVar1 == 0x3f))))
      goto LAB_180064d10;
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
      CloseHandle(local_e8);
    } while( true );
  }
  uVar7 = 0x57;
LAB_180064ee5:
  RtlSetLastWin32Error(uVar7);
LAB_180064ef3:
  __security_check_cookie(local_48 ^ (ulonglong)auStackY328);
  return;
LAB_180064d10:
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpOutBuffer);
  iVar2 = param_3 * 2 + 2;
  puVar4 = (undefined4 *)KernelBaseGetGlobalData();
  puVar6 = (uint *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                   *puVar4,iVar2);
  if (puVar6 == (uint *)0x0) {
LAB_180064d6c:
    CloseHandle(local_e8);
    uVar7 = 8;
  }
  else {
    iVar2 = NtQueryInformationFile(local_e8,local_a8,puVar6,iVar2);
    if (iVar2 < 0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar6);
      CloseHandle(local_e8);
      if (iVar2 == -0x7ffffffb) {
        *(undefined4 *)(param_1 + 1) = local_68;
        *(undefined4 *)((longlong)param_1 + 0xc) = uStack100;
        *(int *)(param_1 + 2) = iStack96;
        *(undefined4 *)((longlong)param_1 + 0x14) = uStack92;
      }
LAB_180064de8:
      BaseSetLastNTError();
      goto LAB_180064ef3;
    }
    uVar8 = (ulonglong)*puVar6 - 2;
    if (uVar8 <= *puVar6) {
      memcpy(param_2,(void *)((longlong)puVar6 + 6),uVar8);
      *(undefined2 *)((longlong)param_2 + (ulonglong)(*puVar6 >> 1) * 2 + -2) = 0x5c;
      *(undefined2 *)((longlong)param_2 + (ulonglong)(*puVar6 >> 1) * 2) = 0;
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar6);
      CloseHandle(local_e8);
      goto LAB_180064ef3;
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar6);
    CloseHandle(local_e8);
    uVar7 = 0x6f;
  }
  goto LAB_180064ee5;
}



BOOL FindNextVolumeMountPointW
               (HANDLE hFindVolumeMountPoint,LPWSTR lpszVolumeMountPoint,DWORD cchBufferLength)

{
  BOOL BVar1;
  
                    // 0x64f30  410  FindNextVolumeMountPointW
  BVar1 = FUN_1800649d8((undefined8 *)hFindVolumeMountPoint,lpszVolumeMountPoint,cchBufferLength,0);
  return BVar1;
}



BOOL FindVolumeMountPointClose(HANDLE hFindVolumeMountPoint)

{
  BOOL BVar1;
  longlong in_GS_OFFSET;
  
                    // 0x64f40  419  FindVolumeMountPointClose
  if ((longlong)hFindVolumeMountPoint - 1U < 0xfffffffffffffffe) {
                    // WARNING: Load size is inaccurate
    BVar1 = CloseHandle(*hFindVolumeMountPoint);
    if (BVar1 != 0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,hFindVolumeMountPoint
                 );
    }
  }
  else {
    RtlSetLastWin32Error(0x57);
    BVar1 = 0;
  }
  return BVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

BOOL GetVolumePathNameA(LPCSTR lpszFileName,LPSTR lpszVolumePathName,DWORD cchBufferLength)

{
  ushort uVar1;
  int iVar2;
  undefined8 uVar3;
  undefined4 *puVar4;
  code *pcVar5;
  longlong in_GS_OFFSET;
  BOOL local_48;
  uint local_40 [2];
  LPWSTR local_38;
  ushort local_30;
  short local_2e;
  LPSTR local_28;
  undefined local_20 [8];
  LPCWSTR local_18;
  
                    // 0x64fc0  814  GetVolumePathNameA
  uVar3 = Basep8BitStringToDynamicUnicodeString();
  if ((int)uVar3 == 0) {
    return 0;
  }
  local_2e = (short)cchBufferLength;
  local_30 = local_2e - 1;
  local_38 = (LPWSTR)0x0;
  local_40[0] = 0;
  uVar1 = local_2e * 2;
  local_28 = lpszVolumePathName;
  puVar4 = (undefined4 *)KernelBaseGetGlobalData();
  local_38 = (LPWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                     *puVar4);
  if (local_38 == (LPWSTR)0x0) {
    RtlSetLastWin32Error(8);
  }
  else {
    local_40[0] = local_40[0] & 0xffff | (uint)uVar1 << 0x10;
    local_48 = GetVolumePathNameW(local_18,local_38,cchBufferLength);
    if (local_48 == 0) goto LAB_1800650fa;
    RtlInitUnicodeString(local_40,local_38);
    pcVar5 = (code *)GetUnicodeStringToEightBitStringRoutine();
    iVar2 = (*pcVar5)();
    if ((-1 < iVar2) && (local_30 < cchBufferLength)) {
      local_28[local_30] = '\0';
      goto LAB_1800650fa;
    }
    BaseSetLastNTError();
  }
  local_48 = 0;
LAB_1800650fa:
  if (local_38 != (LPWSTR)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_38);
  }
  RtlFreeUnicodeString(local_20);
  return local_48;
}



void FUN_180065149(undefined8 param_1,longlong param_2)

{
  longlong in_GS_OFFSET;
  
  if (*(longlong *)(param_2 + 0x30) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x30));
  }
  RtlFreeUnicodeString(param_2 + 0x48);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Could not reconcile some variable overlaps

BOOL GetVolumePathNamesForVolumeNameA
               (LPCSTR lpszVolumeName,LPCH lpszVolumePathNames,DWORD cchBufferLength,
               PDWORD lpcchReturnLength)

{
  short sVar1;
  DWORD DVar2;
  int iVar3;
  uint uVar4;
  undefined8 uVar5;
  undefined4 *puVar6;
  code *pcVar7;
  longlong in_GS_OFFSET;
  BOOL local_48;
  DWORD local_44;
  undefined4 local_40;
  short local_38;
  short local_36;
  LPWCH local_30;
  ushort local_28;
  short local_26;
  LPCH local_20;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x651a0  816  GetVolumePathNamesForVolumeNameA
  uVar5 = Basep8BitStringToDynamicUnicodeString();
  if ((int)uVar5 == 0) {
    return 0;
  }
  local_26 = (short)cchBufferLength;
  local_30 = (LPWCH)0x0;
  sVar1 = local_26 * 2;
  local_36 = sVar1;
  local_20 = lpszVolumePathNames;
  if (sVar1 == 0) {
    local_30 = (LPWCH)0x0;
LAB_180065259:
    local_48 = GetVolumePathNamesForVolumeNameW(local_10,local_30,cchBufferLength,&local_44);
    if ((local_48 == 0) && (DVar2 = GetLastError(), DVar2 != 0xea)) goto LAB_180065300;
    local_38 = sVar1;
    if (local_48 != 0) {
      local_38 = (short)local_44 * 2;
    }
    pcVar7 = (code *)GetUnicodeStringToEightBitStringRoutine();
    iVar3 = (*pcVar7)();
    if (((iVar3 + 0x80000000U & 0x80000000) != 0) || (iVar3 == -0x7ffffffb)) {
      if (lpcchReturnLength != (PDWORD)0x0) {
        if (local_48 == 0) {
          uVar4 = local_44 * 2;
        }
        else {
          uVar4 = (uint)local_28;
        }
        *lpcchReturnLength = uVar4;
      }
      goto LAB_180065300;
    }
    BaseSetLastNTError();
  }
  else {
    puVar6 = (undefined4 *)KernelBaseGetGlobalData();
    local_40 = *puVar6;
    local_30 = (LPWCH)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                      local_40);
    if (local_30 != (LPWCH)0x0) goto LAB_180065259;
    RtlSetLastWin32Error(8);
  }
  local_48 = 0;
LAB_180065300:
  if (local_30 != (LPWCH)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_30);
  }
  RtlFreeUnicodeString(local_18);
  return local_48;
}



void FUN_180065356(undefined8 param_1,longlong param_2)

{
  longlong in_GS_OFFSET;
  
  if (*(longlong *)(param_2 + 0x38) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x38));
  }
  RtlFreeUnicodeString(param_2 + 0x50);
  return;
}



BOOL SetVolumeMountPointA(LPCSTR lpszVolumeMountPoint,LPCSTR lpszVolumeName)

{
  BOOL BVar1;
  int iVar2;
  undefined8 uVar3;
  undefined local_28 [8];
  LPCWSTR local_20;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x653b0  1414  SetVolumeMountPointA
  uVar3 = Basep8BitStringToDynamicUnicodeString();
  BVar1 = 0;
  iVar2 = (int)uVar3;
  if ((int)uVar3 != 0) {
    uVar3 = Basep8BitStringToDynamicUnicodeString();
    if ((int)uVar3 != 0) {
      BVar1 = SetVolumeMountPointW(local_10,local_20);
      RtlFreeUnicodeString(local_28);
    }
    RtlFreeUnicodeString(local_18);
    iVar2 = BVar1;
  }
  return iVar2;
}



// WARNING: Could not reconcile some variable overlaps

undefined8 DosPathToSessionPathA(int param_1,void *param_2,char **param_3,undefined8 param_4)

{
  BOOL BVar1;
  int iVar2;
  uint uVar3;
  undefined8 uVar4;
  longlong lVar5;
  char *_Dst;
  undefined4 uVar6;
  wchar_t *local_res10;
  char **local_res18;
  undefined local_40 [8];
  char *local_38;
  undefined local_30 [24];
  
                    // 0x65430  303  DosPathToSessionPathA
  local_30._0_16_ = ZEXT816(0);
  local_res18 = param_3;
  if (((param_2 == (void *)0x0) || (BVar1 = IsBadReadPtr(param_2,1), BVar1 != 0)) ||
     (BVar1 = IsBadWritePtr(param_3,8), BVar1 != 0)) {
    uVar6 = 0x57;
  }
  else {
    RtlInitAnsiString(local_40,param_2);
    iVar2 = RtlAnsiStringToUnicodeString(local_30,local_40,1);
    if (iVar2 < 0) {
      BaseSetLastNTError();
      return 0;
    }
    uVar4 = DosPathToSessionPathW(param_1,local_30._8_8_,&local_res10);
    RtlFreeUnicodeString(local_30);
    if ((int)uVar4 == 0) {
      return 0;
    }
    RtlInitUnicodeString(local_30,local_res10);
    iVar2 = RtlUnicodeStringToAnsiString(local_40,local_30,1);
    if (iVar2 < 0) {
      BaseSetLastNTError();
      LocalFree(local_res10);
      return 0;
    }
    lVar5 = -1;
    do {
      lVar5 = lVar5 + 1;
    } while (local_38[lVar5] != '\0');
    uVar3 = (int)lVar5 + 1;
    _Dst = (char *)LocalAlloc(0,(ulonglong)uVar3);
    if (_Dst != (char *)0x0) {
      strcpy_s(_Dst,(ulonglong)uVar3,local_38);
      *param_3 = _Dst;
      LocalFree(local_res10);
      RtlFreeAnsiString(local_40);
      return 1;
    }
    LocalFree(local_res10);
    RtlFreeAnsiString(local_40);
    uVar6 = 8;
  }
  RtlSetLastWin32Error(uVar6);
  return 0;
}



bool FUN_180065604(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



// WARNING: Restarted to delay deadcode elimination for space: register

undefined8 DosPathToSessionPathW(int param_1,void *param_2,wchar_t **param_3)

{
  ulonglong _SizeInWords;
  BOOL BVar1;
  longlong lVar2;
  wchar_t *_Dst;
  undefined4 uVar3;
  int iVar4;
  
                    // 0x65630  304  DosPathToSessionPathW
  if (*(char *)(DAT_1800b2bf8 + 0x9cc) == '\x01') {
    iVar4 = 0xd;
  }
  else {
    iVar4 = (-(uint)(param_1 != 0) & 0x14) + 0x17;
  }
  if (((param_2 == (void *)0x0) || (BVar1 = IsBadReadPtr(param_2,2), BVar1 != 0)) ||
     (BVar1 = IsBadWritePtr(param_3,8), BVar1 != 0)) {
    uVar3 = 0x57;
  }
  else {
    lVar2 = -1;
    do {
      lVar2 = lVar2 + 1;
    } while (*(short *)((longlong)param_2 + lVar2 * 2) != 0);
    _SizeInWords = (ulonglong)(uint)((int)lVar2 + iVar4);
    _Dst = (wchar_t *)LocalAlloc(0,_SizeInWords * 2);
    if (_Dst != (wchar_t *)0x0) {
      if (*(char *)(DAT_1800b2bf8 + 0x9cc) == '\x01') {
        swprintf_s(_Dst,_SizeInWords,L"%ws",param_2);
      }
      else if (param_1 == 0) {
        swprintf_s(_Dst,_SizeInWords,L"%ws\\DosDevices\\%ws",L"GLOBALROOT");
      }
      else {
        swprintf_s(_Dst,_SizeInWords,L"%ws%u\\DosDevices\\%ws",L"GLOBALROOT\\Sessions\\");
      }
      *param_3 = _Dst;
      return 1;
    }
    uVar3 = 8;
  }
  RtlSetLastWin32Error(uVar3);
  return 0;
}



bool FUN_180065799(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



BOOL FindActCtxSectionStringA
               (DWORD dwFlags,GUID *lpExtensionGuid,ULONG ulSectionId,LPCSTR lpStringToFind,
               PACTCTX_SECTION_KEYED_DATA ReturnedData)

{
  bool bVar1;
  undefined8 uVar2;
  undefined7 extraout_var;
  undefined *puVar3;
  undefined local_18 [16];
  
                    // 0x657c0  378  FindActCtxSectionStringA
  puVar3 = (undefined *)0x0;
  if (lpStringToFind != (LPCSTR)0x0) {
    uVar2 = Basep8BitStringToDynamicUnicodeString();
    if ((int)uVar2 == 0) {
      return 0;
    }
    puVar3 = local_18;
  }
  bVar1 = FUN_180013330(dwFlags,lpExtensionGuid,ulSectionId,puVar3,&ReturnedData->cbSize);
  if (puVar3 != (undefined *)0x0) {
    RtlFreeUnicodeString(puVar3);
  }
  return (uint)((int)CONCAT71(extraout_var,bVar1) != 0);
}



HANDLE FindFirstFileTransactedW
                 (LPCWSTR lpFileName,FINDEX_INFO_LEVELS fInfoLevelId,LPVOID lpFindFileData,
                 FINDEX_SEARCH_OPS fSearchOp,LPVOID lpSearchFilter,DWORD dwAdditionalFlags,
                 HANDLE hTransaction)

{
  longlong lVar1;
  HANDLE pvVar2;
  undefined8 uVar3;
  undefined4 in_register_00000014;
  undefined4 in_register_0000008c;
  
                    // 0x65860  393  FindFirstFileTransactedW
  if ((longlong)hTransaction - 1U < 0xfffffffffffffffe) {
    lVar1 = RtlGetCurrentTransaction
                      (lpFileName,CONCAT44(in_register_00000014,fInfoLevelId),lpFindFileData,
                       CONCAT44(in_register_0000008c,fSearchOp));
    if (lVar1 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      pvVar2 = FindFirstFileExW(lpFileName,fInfoLevelId,lpFindFileData,fSearchOp,lpSearchFilter,
                                dwAdditionalFlags);
      RtlSetCurrentTransaction(0);
      return pvVar2;
    }
    uVar3 = 0x1a45;
  }
  else {
    uVar3 = 0x1a2c;
  }
  RtlSetLastWin32Error(uVar3);
  return (HANDLE)0xffffffffffffffff;
}



void FUN_18006592d(void)

{
                    // WARNING: Could not recover jumptable at 0x00018006593d. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlSetCurrentTransaction(0);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

BOOL SetDllDirectoryA(LPCSTR lpPathName)

{
  int iVar1;
  code *pcVar2;
  undefined local_28 [16];
  undefined local_18 [16];
  
                    // 0x65950  1310  SetDllDirectoryA
  local_28 = ZEXT816(0);
  if (lpPathName == (LPCSTR)0x0) {
    RtlInitUnicodeString(local_28,0);
  }
  else {
    iVar1 = RtlInitAnsiStringEx(local_18,lpPathName);
    if (iVar1 < 0) goto LAB_1800659e8;
    pcVar2 = (code *)GetEightBitStringToUnicodeStringRoutine();
    iVar1 = (*pcVar2)();
    if (iVar1 < 0) goto LAB_1800659e8;
  }
  iVar1 = LdrSetDllDirectory(local_28);
  RtlFreeUnicodeString(local_28);
  if (-1 < iVar1) {
    return 1;
  }
LAB_1800659e8:
  BaseSetLastNTError();
  return 0;
}



WORD GetActiveProcessorGroupCount(void)

{
  WORD WVar1;
  undefined8 uVar2;
  longlong in_GS_OFFSET;
  DWORD local_res8 [2];
  PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX local_res10 [3];
  
                    // 0x65a00  446  GetActiveProcessorGroupCount
  uVar2 = FUN_18001d558(local_res10,local_res8);
  WVar1 = 0;
  if ((int)uVar2 != 0) {
    WVar1 = *(WORD *)&(local_res10[0]->u).field_0x2;
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_res10[0]);
  }
  return WVar1;
}



DWORD GetMaximumProcessorCount(WORD GroupNumber)

{
  byte bVar1;
  ushort uVar2;
  uint uVar3;
  undefined8 uVar4;
  byte *pbVar5;
  ulonglong uVar6;
  ushort uVar7;
  longlong in_GS_OFFSET;
  DWORD local_res10 [2];
  PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX local_res18 [2];
  
                    // 0x65a60  634  GetMaximumProcessorCount
  uVar4 = FUN_18001d558(local_res18,local_res10);
  uVar7 = 0;
  uVar3 = (uint)uVar4;
  if (uVar3 != 0) {
    if (GroupNumber == 0xffff) {
      uVar2 = *(ushort *)&(local_res18[0]->u).field_0x2;
      if (uVar2 != 0) {
        pbVar5 = &(local_res18[0]->u).field_0x18;
        uVar6 = (ulonglong)uVar2;
        uVar7 = 0;
        do {
          bVar1 = *pbVar5;
          pbVar5 = pbVar5 + 0x30;
          uVar7 = uVar7 + bVar1;
          uVar6 = uVar6 - 1;
        } while (uVar6 != 0);
      }
    }
    else if (GroupNumber < *(ushort *)&(local_res18[0]->u).field_0x2) {
      uVar7 = (ushort)(byte)(&(local_res18[0]->u).field_0x18)[(ulonglong)GroupNumber * 0x30];
    }
    else {
      RtlSetLastWin32Error(0x57);
      uVar7 = 0;
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_res18[0]);
    uVar3 = (uint)uVar7;
  }
  return uVar3;
}



BOOL IsBadWritePtr(LPVOID lp,UINT_PTR ucb)

{
  uint uVar1;
  LPVOID pvVar2;
  undefined *puVar3;
  ulonglong uVar4;
  
                    // 0x65b20  896  IsBadWritePtr
  uVar1 = DAT_1800b2a48;
  uVar4 = (ulonglong)DAT_1800b2a48;
  if (ucb != 0) {
    if ((lp == (LPVOID)0x0) || (pvVar2 = (LPVOID)((ucb - 1) + (longlong)lp), pvVar2 < lp)) {
      return 1;
    }
                    // WARNING: Load size is inaccurate
    *(undefined *)lp = *lp;
    puVar3 = (undefined *)((longlong)(int)-uVar1 & (ulonglong)lp);
    while (puVar3 != (undefined *)((ulonglong)pvVar2 & (longlong)(int)-uVar1)) {
      puVar3 = puVar3 + uVar4;
      *puVar3 = *puVar3;
    }
  }
  return 0;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Could not reconcile some variable overlaps

DWORD LoadModule(LPCSTR lpModuleName,LPVOID lpParameterBlock)

{
  byte bVar1;
  DWORD DVar2;
  int iVar3;
  undefined4 *puVar4;
  LPCSTR lpBuffer;
  HANDLE hObject;
  longlong in_GS_OFFSET;
  undefined auStackY360 [32];
  LPSTR local_110;
  BOOL local_108;
  undefined local_e0 [16];
  undefined8 local_d0;
  undefined local_c8 [8];
  undefined8 local_c0;
  undefined local_b8 [16];
  _STARTUPINFOA local_a8;
  
                    // 0x65bb0  973  LoadModule
  local_e0 = ZEXT816(0);
  local_d0 = 0;
  local_108 = 0;
  if ((*(int *)((longlong)lpParameterBlock + 0x18) == 0) &&
     (**(short **)((longlong)lpParameterBlock + 0x10) == 2)) {
    local_110 = (LPSTR)0x0;
    puVar4 = (undefined4 *)KernelBaseGetGlobalData();
    lpBuffer = (LPCSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                       *puVar4,0x104);
    if (lpBuffer == (LPCSTR)0x0) {
      RtlSetLastWin32Error(8);
    }
    else {
      DVar2 = SearchPathA((LPCSTR)0x0,lpModuleName,".exe",0x104,lpBuffer,(LPSTR *)0x0);
      if (0x102 < DVar2 - 1) {
        iVar3 = RtlInitAnsiStringEx(local_b8,lpModuleName);
        if (iVar3 < 0) {
          _local_unwind(auStackY360,0x180065f01);
          return 2;
        }
        iVar3 = RtlAnsiStringToUnicodeString(local_c8,local_b8,1);
        if (iVar3 < 0) {
          _local_unwind(auStackY360,0x180065f46);
          return 2;
        }
        iVar3 = RtlDetermineDosPathNameType_U(local_c0);
        RtlFreeUnicodeString(local_c8);
        if (iVar3 == 5) {
          _local_unwind(auStackY360,0x18006602e);
          return 2;
        }
        hObject = CreateFileA(lpModuleName,0x80000000,3,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,
                              (HANDLE)0x0);
        if (hObject != (HANDLE)0xffffffffffffffff) {
          CloseHandle(hObject);
          _local_unwind(auStackY360,0x180065fe2);
          return 2;
        }
        DVar2 = GetLastError();
        _local_unwind(auStackY360,0x18006600d);
        return DVar2;
      }
      memset(&local_a8,0,0x68);
      local_a8.cb = 0x68;
      local_a8.dwFlags = 1;
      local_a8.wShowWindow = *(WORD *)(*(longlong *)((longlong)lpParameterBlock + 0x10) + 2);
      bVar1 = **(byte **)((longlong)lpParameterBlock + 8);
      puVar4 = (undefined4 *)KernelBaseGetGlobalData();
      local_110 = (LPSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                         *puVar4);
      if (local_110 == (LPSTR)0x0) {
        RtlSetLastWin32Error(8);
      }
      else {
        memcpy(local_110,lpBuffer,(ulonglong)DVar2);
        local_110[DVar2] = ' ';
        memcpy(local_110 + (DVar2 + 1),(void *)(*(longlong *)((longlong)lpParameterBlock + 8) + 1),
               (ulonglong)(uint)bVar1);
        local_110[bVar1 + DVar2 + 1] = '\0';
                    // WARNING: Load size is inaccurate
        local_108 = CreateProcessA(lpBuffer,local_110,(LPSECURITY_ATTRIBUTES)0x0,
                                   (LPSECURITY_ATTRIBUTES)0x0,0,0,*lpParameterBlock,(LPCSTR)0x0,
                                   &local_a8,(LPPROCESS_INFORMATION)local_e0);
      }
    }
    if (lpBuffer != (LPCSTR)0x0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpBuffer);
    }
    if (local_110 != (LPSTR)0x0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_110);
    }
    if (local_108 != 0) {
      if (DAT_1800b2cc0 != 0) {
        (*(code *)DAT_1800b2cc0)();
      }
      NtClose(local_e0._0_8_);
      NtClose(local_e0._8_8_);
      return 0x21;
    }
    DVar2 = GetLastError();
    if (DVar2 == 2) {
      return 2;
    }
    if (DVar2 == 3) {
      return 3;
    }
    if (DVar2 == 0xc1) {
      return 0xb;
    }
  }
  else {
    BaseSetLastNTError();
  }
  return 0;
}



void FUN_180066060(undefined8 param_1,longlong param_2)

{
  longlong in_GS_OFFSET;
  
  if (*(longlong *)(param_2 + 0x50) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x50));
  }
  if (*(longlong *)(param_2 + 0x58) != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                *(undefined8 *)(param_2 + 0x58));
  }
  return;
}



bool FUN_1800660be(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



BOOL SetProcessAffinityMask(HANDLE hProcess,DWORD_PTR dwProcessAffinityMask)

{
  int iVar1;
  DWORD_PTR local_res10 [3];
  
                    // 0x660f0  1357  SetProcessAffinityMask
  local_res10[0] = dwProcessAffinityMask;
  iVar1 = NtSetInformationProcess(hProcess,0x15,local_res10);
  if (-1 >= iVar1) {
    BaseSetLastNTError();
  }
  return (uint)(-1 < iVar1);
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

UINT WinExec(LPCSTR lpCmdLine,UINT uCmdShow)

{
  BOOL BVar1;
  UINT extraout_EAX;
  DWORD dwCreationFlags;
  undefined auStackY312 [32];
  undefined4 local_e8 [2];
  ULONG_PTR local_e0;
  _PROCESS_INFORMATION local_d8;
  _STARTUPINFOA local_b8;
  _PROC_THREAD_ATTRIBUTE_LIST *local_50;
  _PROC_THREAD_ATTRIBUTE_LIST local_48 [48];
  ulonglong local_18;
  
                    // 0x66140  1555  WinExec
  local_18 = DAT_1800b2220 ^ (ulonglong)auStackY312;
  if ((int)uCmdShow < 0) {
    local_e0 = 0x30;
    BVar1 = InitializeProcThreadAttributeList(local_48,1,0,&local_e0);
    if (BVar1 == 0) goto LAB_1800662f1;
    local_e8[0] = 1;
    dwCreationFlags = 0x80000;
    BVar1 = UpdateProcThreadAttribute(local_48,0,0x60001,local_e8,4,(PVOID)0x0,(PSIZE_T)0x0);
    if (BVar1 != 0) {
      local_50 = local_48;
      goto LAB_1800661f9;
    }
  }
  else {
    dwCreationFlags = 0;
LAB_1800661f9:
    memset(&local_b8,0,0x68);
    local_b8.dwFlags = 1;
    local_b8.wShowWindow = (WORD)uCmdShow;
    local_b8.cb = (-(uint)(dwCreationFlags != 0) & 8) + 0x68;
    BVar1 = CreateProcessA((LPCSTR)0x0,lpCmdLine,(LPSECURITY_ATTRIBUTES)0x0,
                           (LPSECURITY_ATTRIBUTES)0x0,0,dwCreationFlags,(LPVOID)0x0,(LPCSTR)0x0,
                           &local_b8,&local_d8);
    if (BVar1 == 0) {
      GetLastError();
    }
    else {
      if (DAT_1800b2cc0 != 0) {
        (*(code *)DAT_1800b2cc0)();
      }
      NtClose(local_d8.hProcess);
      NtClose(local_d8.hThread);
    }
    if (dwCreationFlags == 0) goto LAB_1800662f1;
  }
  DeleteProcThreadAttributeList(local_48);
LAB_1800662f1:
  __security_check_cookie(local_18 ^ (ulonglong)auStackY312);
  return extraout_EAX;
}



BOOL GetDevicePowerState(HANDLE hDevice,BOOL *pfOn)

{
  int iVar1;
  uint local_res18 [4];
  
                    // 0x66320  560  GetDevicePowerState
  local_res18[0] = 0;
  iVar1 = NtGetDevicePowerState(hDevice,local_res18);
  if (-1 < iVar1) {
    *pfOn = (uint)(local_res18[0] < 2);
  }
  else {
    BaseSetLastNTError();
  }
  return (uint)(-1 < iVar1);
}



DWORD GetFirmwareEnvironmentVariableA(LPCSTR lpName,LPCSTR lpGuid,PVOID pBuffer,DWORD nSize)

{
  DWORD DVar1;
  
                    // 0x66380  604  GetFirmwareEnvironmentVariableA
  DVar1 = GetFirmwareEnvironmentVariableExA((longlong)lpName,(longlong)lpGuid,pBuffer,nSize,0);
  return DVar1;
}



undefined4
GetFirmwareEnvironmentVariableExA
          (longlong param_1,longlong param_2,undefined8 param_3,undefined4 param_4,
          undefined8 param_5)

{
  int iVar1;
  undefined4 uVar2;
  undefined local_48 [8];
  longlong local_40;
  undefined local_38 [8];
  longlong local_30;
  undefined local_28 [16];
  undefined local_18 [16];
  
                    // 0x663a0  605  GetFirmwareEnvironmentVariableExA
  if ((param_1 == 0) || (param_2 == 0)) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    RtlInitString(local_28,param_1);
    iVar1 = RtlAnsiStringToUnicodeString(local_48,local_28,1);
    if (-1 < iVar1) {
      RtlInitString(local_18,param_2);
      iVar1 = RtlAnsiStringToUnicodeString(local_38,local_18,1);
      if (-1 < iVar1) {
        uVar2 = GetFirmwareEnvironmentVariableExW(local_40,local_30,param_3,param_4,param_5);
        RtlFreeUnicodeString(local_48);
        RtlFreeUnicodeString(local_38);
        return uVar2;
      }
      RtlFreeUnicodeString(local_48);
    }
    BaseSetLastNTError();
  }
  return 0;
}



DWORD GetFirmwareEnvironmentVariableW(LPCWSTR lpName,LPCWSTR lpGuid,PVOID pBuffer,DWORD nSize)

{
  DWORD DVar1;
  
                    // 0x664d0  607  GetFirmwareEnvironmentVariableW
  DVar1 = GetFirmwareEnvironmentVariableExW((longlong)lpName,(longlong)lpGuid,pBuffer,nSize,0);
  return DVar1;
}



BOOL SetFirmwareEnvironmentVariableA(LPCSTR lpName,LPCSTR lpGuid,PVOID pValue,DWORD nSize)

{
  BOOL BVar1;
  
                    // 0x664f0  1337  SetFirmwareEnvironmentVariableA
  BVar1 = SetFirmwareEnvironmentVariableExA((longlong)lpName,(longlong)lpGuid,pValue,nSize,1);
  return BVar1;
}



undefined4
SetFirmwareEnvironmentVariableExA
          (longlong param_1,longlong param_2,undefined8 param_3,undefined4 param_4,
          undefined4 param_5)

{
  int iVar1;
  undefined4 uVar2;
  undefined local_48 [8];
  longlong local_40;
  undefined local_38 [8];
  longlong local_30;
  undefined local_28 [16];
  undefined local_18 [16];
  
                    // 0x66510  1338  SetFirmwareEnvironmentVariableExA
  if ((param_1 == 0) || (param_2 == 0)) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    RtlInitString(local_28,param_1);
    iVar1 = RtlAnsiStringToUnicodeString(local_48,local_28,1);
    if (-1 < iVar1) {
      RtlInitString(local_18,param_2);
      iVar1 = RtlAnsiStringToUnicodeString(local_38,local_18,1);
      if (-1 < iVar1) {
        uVar2 = SetFirmwareEnvironmentVariableExW(local_40,local_30,param_3,param_4,param_5);
        RtlFreeUnicodeString(local_48);
        RtlFreeUnicodeString(local_38);
        return uVar2;
      }
      RtlFreeUnicodeString(local_48);
    }
    BaseSetLastNTError();
  }
  return 0;
}



void SetFirmwareEnvironmentVariableExW
               (longlong param_1,longlong param_2,undefined8 param_3,undefined4 param_4,
               undefined4 param_5)

{
  int iVar1;
  undefined auStack136 [32];
  undefined4 local_68;
  undefined local_58 [16];
  undefined local_48 [16];
  undefined local_38 [16];
  ulonglong local_28;
  
                    // 0x66640  1339  SetFirmwareEnvironmentVariableExW
  local_28 = DAT_1800b2220 ^ (ulonglong)auStack136;
  if ((param_1 == 0) || (param_2 == 0)) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    RtlInitUnicodeString(local_48,param_1);
    RtlInitUnicodeString(local_58,param_2);
    iVar1 = RtlGUIDFromString(local_58,local_38);
    if (-1 < iVar1) {
      local_68 = param_5;
      iVar1 = NtSetSystemEnvironmentValueEx(local_48,local_38,param_3,param_4);
      if (-1 < iVar1) goto LAB_1800666fe;
    }
    BaseSetLastNTError();
  }
LAB_1800666fe:
  __security_check_cookie(local_28 ^ (ulonglong)auStack136);
  return;
}



BOOL SetFirmwareEnvironmentVariableW(LPCWSTR lpName,LPCWSTR lpGuid,PVOID pValue,DWORD nSize)

{
  BOOL BVar1;
  
                    // 0x66720  1340  SetFirmwareEnvironmentVariableW
  BVar1 = SetFirmwareEnvironmentVariableExW((longlong)lpName,(longlong)lpGuid,pValue,nSize,1);
  return BVar1;
}



DWORD GetFullPathNameTransactedW
                (LPCWSTR lpFileName,DWORD nBufferLength,LPWSTR lpBuffer,LPWSTR *lpFilePart,
                HANDLE hTransaction)

{
  DWORD DVar1;
  longlong lVar2;
  undefined4 in_register_00000014;
  
                    // 0x66740  611  GetFullPathNameTransactedW
  if ((longlong)hTransaction - 1U < 0xfffffffffffffffe) {
    lVar2 = RtlGetCurrentTransaction();
    DVar1 = 0;
    if (lVar2 == 0) {
      RtlSetCurrentTransaction(hTransaction);
      DVar1 = GetFullPathNameW(lpFileName,nBufferLength,lpBuffer,lpFilePart);
      RtlSetCurrentTransaction(0);
    }
    else {
      RtlSetLastWin32Error(0x1a45);
    }
  }
  else {
    RtlSetLastWin32Error(0x1a2c,CONCAT44(in_register_00000014,nBufferLength));
    DVar1 = 0;
  }
  return DVar1;
}



void FUN_180066804(void)

{
                    // WARNING: Could not recover jumptable at 0x000180066814. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlSetCurrentTransaction(0);
  return;
}



BOOL SetVolumeLabelA(LPCSTR lpRootPathName,LPCSTR lpVolumeName)

{
  BOOL BVar1;
  undefined8 uVar2;
  undefined local_28 [8];
  LPCWSTR local_20;
  undefined local_18 [8];
  LPCWSTR local_10;
  
                    // 0x66830  1412  SetVolumeLabelA
  BVar1 = 0;
  uVar2 = Basep8BitStringToDynamicUnicodeString();
  if ((int)uVar2 == 0) {
    return 0;
  }
  if (lpVolumeName == (LPCSTR)0x0) {
    local_20 = (LPCWSTR)0x0;
  }
  else {
    uVar2 = Basep8BitStringToDynamicUnicodeString();
    if ((int)uVar2 == 0) goto LAB_1800668a9;
  }
  BVar1 = SetVolumeLabelW(local_10,local_20);
  if (lpVolumeName != (LPCSTR)0x0) {
    RtlFreeUnicodeString(local_28);
  }
LAB_1800668a9:
  RtlFreeUnicodeString(local_18);
  return BVar1;
}



// WARNING: Could not reconcile some variable overlaps

BOOL SetVolumeLabelW(LPCWSTR lpRootPathName,LPCWSTR lpVolumeName)

{
  char cVar1;
  BOOL BVar2;
  BOOL extraout_EAX;
  int iVar3;
  undefined4 *puVar4;
  uint *puVar5;
  undefined8 uVar6;
  longlong in_GS_OFFSET;
  undefined auStack744 [32];
  undefined4 local_2c8;
  undefined4 local_2c0;
  int local_2b8;
  undefined4 local_2b4;
  longlong local_2b0;
  undefined4 local_2a8;
  int local_2a4;
  uint *local_2a0;
  undefined4 local_298;
  ushort local_290 [4];
  longlong local_288;
  uint local_280 [2];
  void *local_278;
  undefined4 local_270 [2];
  undefined8 local_268;
  ushort *local_260;
  undefined4 local_258;
  undefined local_250 [16];
  undefined local_240 [24];
  undefined4 local_228 [132];
  ulonglong local_18;
  
                    // 0x668e0  1413  SetVolumeLabelW
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack744;
  local_2a8 = 0x5c;
  if (lpVolumeName == (LPCWSTR)0x0) {
    local_280[0] = 0;
    local_278 = (void *)0x0;
  }
  else {
    RtlInitUnicodeString(local_280);
  }
  if ((lpRootPathName == (LPCWSTR)0x0) ||
     (BVar2 = GetVolumeNameForVolumeMountPointW(lpRootPathName,(LPWSTR)local_228,0x104), BVar2 == 0)
     ) {
    puVar4 = &local_2a8;
    if (lpRootPathName != (LPCWSTR)0x0) {
      puVar4 = (undefined4 *)lpRootPathName;
    }
  }
  else {
    puVar4 = local_228;
  }
  cVar1 = RtlDosPathNameToNtPathName_U(puVar4,local_290,0,0);
  if (cVar1 == '\0') {
    uVar6 = 3;
LAB_18006698f:
    RtlSetLastWin32Error(uVar6);
    goto LAB_18006699d;
  }
  if (*(short *)(local_288 + -2 + (ulonglong)(local_290[0] >> 1) * 2) == 0x5c) {
    local_270[0] = 0x30;
    local_268 = 0;
    local_258 = 0x40;
    local_260 = local_290;
    local_250 = ZEXT816(0);
    local_2c0 = 0x20;
    local_2c8 = 3;
    local_2b8 = NtOpenFile(&local_2b0,0x100002,local_270,local_240);
    if (-1 < local_2b8) {
      iVar3 = FUN_1800590ec(local_2b0);
      if (iVar3 == 0) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_288);
        NtClose(local_2b0);
        uVar6 = 0x90;
        goto LAB_18006698f;
      }
      NtClose(local_2b0);
      local_290[0] = local_290[0] - 2;
      local_270[0] = 0x30;
      local_268 = 0;
      local_258 = 0x40;
      local_260 = local_290;
      local_250 = ZEXT816(0);
      local_2c0 = 0x20;
      local_2c8 = 3;
      local_2b8 = NtOpenFile(&local_2b0,0x100002,local_270,local_240);
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
      if (local_2b8 < 0) goto LAB_1800669fc;
      local_2a0 = (uint *)0x0;
      local_2b4 = 1;
      local_2a4 = (local_280[0] & 0xffff) + 6;
      if ((ushort)local_280[0] == 0) {
        local_2a4 = 8;
      }
      puVar4 = (undefined4 *)KernelBaseGetGlobalData();
      local_298 = *puVar4;
      puVar5 = (uint *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                       local_298);
      local_2a0 = puVar5;
      if (puVar5 == (uint *)0x0) {
LAB_180066c40:
        local_2b4 = 0;
        BaseSetLastNTError();
      }
      else {
        memcpy(puVar5 + 1,local_278,(ulonglong)(ushort)local_280[0]);
        *puVar5 = local_280[0] & 0xffff;
        local_2c8 = 2;
        iVar3 = NtSetVolumeInformationFile(local_2b0,local_240,puVar5,local_2a4);
        if (iVar3 < 0) goto LAB_180066c40;
      }
      NtClose(local_2b0);
      if (puVar5 != (uint *)0x0) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_2a0);
      }
      goto LAB_18006699d;
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_288);
  }
  else {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_288);
  }
LAB_1800669fc:
  BaseSetLastNTError();
LAB_18006699d:
  __security_check_cookie(local_18 ^ (ulonglong)auStack744);
  return extraout_EAX;
}



BOOL GetNumaAvailableMemoryNodeEx(USHORT Node,PULONGLONG AvailableBytes)

{
  int iVar1;
  undefined local_res18 [16];
  uint local_418 [2];
  ULONGLONG aUStack1040 [129];
  
                    // 0x66ce0  659  GetNumaAvailableMemoryNodeEx
  iVar1 = NtQuerySystemInformation(0x3c,local_418,0x408,local_res18);
  if (iVar1 < 0) {
    BaseSetLastNTError();
  }
  else {
    if (Node <= local_418[0]) {
      *AvailableBytes = aUStack1040[Node];
      return 1;
    }
    RtlSetLastWin32Error(0x57);
  }
  return 0;
}



BOOL GetNumaNodeProcessorMask(UCHAR Node,PULONGLONG ProcessorMask)

{
  BOOL BVar1;
  BOOL extraout_EAX;
  ULONGLONG UVar2;
  undefined auStack72 [32];
  WORD local_28 [4];
  _GROUP_AFFINITY local_20;
  ulonglong local_10;
  
                    // 0x66d70  662  GetNumaNodeProcessorMask
  local_10 = DAT_1800b2220 ^ (ulonglong)auStack72;
  BVar1 = GetNumaNodeProcessorMaskEx((ushort)Node,&local_20);
  if (BVar1 != 0) {
    RtlGetCurrentProcessorNumberEx(local_28);
    UVar2 = 0;
    if (local_20.Group == local_28[0]) {
      UVar2 = local_20.Mask;
    }
    *ProcessorMask = UVar2;
  }
  __security_check_cookie(local_10 ^ (ulonglong)auStack72);
  return extraout_EAX;
}



BOOL GetNumaProcessorNodeEx(PPROCESSOR_NUMBER Processor,PUSHORT NodeNumber)

{
  int iVar1;
  ushort uVar2;
  undefined local_res8 [8];
  uint local_418 [2];
  ulonglong uStack1040;
  WORD aWStack1032 [512];
  ulonglong uVar3;
  
                    // 0x66df0  665  GetNumaProcessorNodeEx
  if (((Processor->Group < 0x14) && (Processor->Number < 0x40)) &&
     (uVar3 = 0, Processor->Reserved == '\0')) {
    iVar1 = NtQuerySystemInformation(0x37,local_418,0x408,local_res8);
    if (iVar1 < 0) {
      *NodeNumber = 0xffff;
      BaseSetLastNTError();
      return 0;
    }
    do {
      if ((aWStack1032[uVar3 * 8] == Processor->Group) &&
         (((&uStack1040)[uVar3 * 2] & 1 << (Processor->Number & 0x3f)) != 0)) {
        *NodeNumber = (USHORT)uVar3;
        return 1;
      }
      uVar2 = (USHORT)uVar3 + 1;
      uVar3 = (ulonglong)uVar2;
    } while (uVar2 <= local_418[0]);
  }
  *NodeNumber = 0xffff;
  RtlSetLastWin32Error(0x57);
  return 0;
}



DWORD FUN_180066ec4(undefined8 param_1,undefined4 param_2,undefined8 param_3,undefined4 param_4,
                   undefined8 param_5,undefined4 param_6)

{
  DWORD DVar1;
  int iVar2;
  HANDLE hHandle;
  int local_18 [4];
  
  hHandle = CreateEventA((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCSTR)0x0);
  if (hHandle == (HANDLE)0x0) {
    DVar1 = GetLastError();
  }
  else {
    iVar2 = NtDeviceIoControlFile
                      (param_1,hHandle,0,0,local_18,param_2,param_3,param_4,param_5,param_6);
    if (iVar2 == 0x103) {
      WaitForSingleObject(hHandle,0xffffffff);
      iVar2 = local_18[0];
    }
    CloseHandle(hHandle);
    if (iVar2 < 0) {
      DVar1 = BaseSetLastNTError();
    }
    else {
      DVar1 = 0;
    }
  }
  return DVar1;
}



DWORD GetTapeParameters(HANDLE hDevice,DWORD dwOperation,LPDWORD lpdwSize,LPVOID lpTapeInformation)

{
  DWORD DVar1;
  undefined4 uVar2;
  
                    // 0x66fc0  763  GetTapeParameters
  if (dwOperation == 0) {
    if (*lpdwSize < 0x20) goto LAB_180066fef;
    uVar2 = 0x1f401c;
  }
  else {
    if (dwOperation != 1) {
      return 1;
    }
    if (*lpdwSize < 0x20) {
LAB_180066fef:
      *lpdwSize = 0x20;
      return 0xea;
    }
    uVar2 = 0x1f4014;
  }
  DVar1 = FUN_180066ec4(hDevice,uVar2,0,0,lpTapeInformation,0x20);
  return DVar1;
}



BOOL GetThreadSelectorEntry(HANDLE hThread,DWORD dwSelector,LPLDT_ENTRY lpSelectorEntry)

{
                    // 0x67020  783  GetThreadSelectorEntry
  BaseSetLastNTError();
  return 0;
}



UINT LocalFlags(HLOCAL hMem)

{
  char cVar1;
  UINT UVar2;
  HLOCAL pvVar3;
  uint local_res10 [2];
  HLOCAL local_res18 [2];
  
                    // 0x67040  982  LocalFlags
  UVar2 = 0x8000;
  RtlLockHeap(DAT_1800b2a30);
  pvVar3 = hMem;
  if (((ulonglong)hMem & 8) == 0) {
    local_res18[0] = (HLOCAL)0x0;
    local_res10[0] = 0;
    cVar1 = RtlGetUserInfoHeap(DAT_1800b2a30,0,hMem,local_res18,local_res10);
    if ((cVar1 != '\0') &&
       ((local_res18[0] == (HLOCAL)0x0 || (pvVar3 = local_res18[0], (local_res10[0] & 0x200) == 0)))
       ) {
      UVar2 = 0;
      pvVar3 = hMem;
    }
    if (((ulonglong)pvVar3 & 8) == 0) goto LAB_18006710f;
  }
  cVar1 = RtlIsValidHandle(DAT_1800b2a20,(longlong)pvVar3 + -8);
  if (cVar1 != '\0') {
    UVar2 = (UINT)(byte)*(undefined2 *)((longlong)pvVar3 + -6);
    if ((*(byte *)((longlong)pvVar3 + -8) & 8) != 0) {
      UVar2 = UVar2 | 0x4000;
    }
    if ((*(byte *)((longlong)pvVar3 + -8) & 4) != 0) {
      UVar2 = UVar2 | 0xf00;
    }
  }
LAB_18006710f:
  if (UVar2 == 0x8000) {
    RtlSetLastWin32Error(6);
  }
  RtlUnlockHeap(DAT_1800b2a30);
  return UVar2;
}



bool FUN_180067156(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



void FUN_180067176(void)

{
  RtlUnlockHeap(DAT_1800b2a30);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

undefined8
FUN_1800671a0(undefined param_1,undefined param_2,undefined param_3,undefined param_4,int *param_5,
             int param_6)

{
  undefined7 in_register_00000089;
  
  if ((param_6 == 4) && (*param_5 == 1)) {
    (**(code **)CONCAT71(in_register_00000089,param_4))();
  }
  return 0;
}



undefined8 UnregisterWaitUntilOOBECompleted(longlong param_1)

{
  int iVar1;
  longlong in_GS_OFFSET;
  
                    // 0x671d0  1484  UnregisterWaitUntilOOBECompleted
  if (param_1 == 0) {
    RtlSetLastWin32Error(0x57);
  }
  else {
    iVar1 = RtlUnsubscribeWnfStateChangeNotification(*(undefined8 *)(param_1 + 0x10));
    if (-1 < iVar1) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_1);
      return 1;
    }
    BaseSetLastNTError();
  }
  return 0;
}



BOOL SetEnvironmentStringsA(LPCH NewEnvironment)

{
  int iVar1;
  char *pcVar2;
  char *pcVar3;
  longlong lVar4;
  undefined2 local_28 [4];
  undefined8 local_20;
  undefined2 local_18 [4];
  LPCH local_10;
  
                    // 0x67240  1314  SetEnvironmentStringsA
  lVar4 = -1;
  do {
    lVar4 = lVar4 + 1;
    pcVar3 = NewEnvironment;
  } while (NewEnvironment[lVar4] != '\0');
  while( true ) {
    if ((lVar4 == 0) || (pcVar2 = strchr(pcVar3 + 1,0x3d), pcVar2 == (char *)0x0))
    goto LAB_18006729b;
    pcVar3 = pcVar3 + lVar4 + 1;
    if (*pcVar3 == '\0') break;
    lVar4 = -1;
    do {
      lVar4 = lVar4 + 1;
    } while (pcVar3[lVar4] != '\0');
  }
  if (pcVar3 + (1 - (longlong)NewEnvironment) < (char *)0x8000) {
    local_18[0] = SUB82(pcVar3 + (1 - (longlong)NewEnvironment),0);
    local_10 = NewEnvironment;
    iVar1 = RtlOemStringToUnicodeString(local_28,local_18,1);
    if (-1 < iVar1) {
      iVar1 = RtlSetEnvironmentStrings(local_20,local_28[0]);
      RtlFreeUnicodeString(local_28);
      if (-1 < iVar1) {
        return 1;
      }
    }
  }
LAB_18006729b:
  BaseSetLastNTError();
  return 0;
}



void FUN_180067328(void)

{
  int iVar1;
  wchar_t *pwVar2;
  longlong lVar3;
  void *_Dst;
  longlong in_GS_OFFSET;
  undefined auStack680 [32];
  undefined4 local_288;
  uint *local_280;
  uint local_278 [2];
  undefined4 local_270;
  longlong local_268;
  undefined8 local_260;
  undefined4 local_258;
  undefined8 local_250;
  undefined4 *local_248;
  undefined4 local_240;
  undefined local_238 [16];
  wchar_t local_228 [264];
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack680;
  local_260 = 0;
  lVar3 = *(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x20);
  pwVar2 = wcsrchr(*(wchar_t **)(lVar3 + 0x68),L'\\');
  if (pwVar2 == (wchar_t *)0x0) {
    pwVar2 = *(wchar_t **)(lVar3 + 0x68);
  }
  else {
    pwVar2 = pwVar2 + 1;
  }
  wcscpy_s(local_228,0x105,pwVar2);
  pwVar2 = wcsrchr(local_228,L'.');
  if (pwVar2 != (wchar_t *)0x0) {
    *pwVar2 = L'\0';
  }
  local_268 = 0;
  local_270 = 0;
  lVar3 = -1;
  do {
    lVar3 = lVar3 + 1;
  } while (local_228[lVar3] != L'\0');
  local_278[0] = (int)lVar3 * 2 + 0xd8;
  pwVar2 = (wchar_t *)
           RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_278[0]
                          );
  if (pwVar2 != (wchar_t *)0x0) {
    wcscpy_s(pwVar2,(ulonglong)(local_278[0] >> 1),
             L"\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Terminal Server\\Compatibility\\Applications\\"
            );
    wcscat_s(pwVar2,(ulonglong)(local_278[0] >> 1),local_228);
    RtlInitUnicodeString(&local_270);
  }
  _Dst = (void *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
  if ((local_268 != 0) && (_Dst != (void *)0x0)) {
    local_248 = &local_270;
    local_258 = 0x30;
    local_250 = 0;
    local_240 = 0x40;
    local_238 = ZEXT816(0);
    iVar1 = NtOpenKey(&local_260);
    if (-1 < iVar1) {
      RtlInitUnicodeString(&local_270,L"Flags");
      local_280 = local_278;
      local_288 = 0x224;
      NtQueryValueKey(local_260,&local_270,2,_Dst);
      NtClose(local_260);
    }
  }
  if (pwVar2 != (wchar_t *)0x0) {
    memset(pwVar2,0,(ulonglong)local_270._2_2_);
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pwVar2);
  }
  if (_Dst != (void *)0x0) {
    memset(_Dst,0,0x224);
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,_Dst);
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack680);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void FUN_1800675e8(void)

{
  bool bVar1;
  int iVar2;
  undefined4 uVar3;
  HMODULE hModule;
  FARPROC pFVar4;
  undefined auStack136 [32];
  undefined4 local_68;
  undefined4 local_60;
  undefined4 local_58;
  undefined4 local_50;
  undefined4 local_48;
  undefined4 local_40;
  longlong *local_38;
  int local_28;
  longlong local_20;
  undefined4 local_18;
  undefined2 local_14;
  ulonglong local_10;
  
  local_10 = DAT_1800b2220 ^ (ulonglong)auStack136;
  local_14 = 0x500;
  local_20 = 0;
  local_18 = 0;
  hModule = LoadLibraryW(L"advapi32.dll");
  if (hModule == (HMODULE)0x0) goto LAB_1800677d5;
  pFVar4 = GetProcAddress(hModule,"CheckTokenMembership");
  if (pFVar4 != (FARPROC)0x0) {
    local_38 = &local_20;
    local_40 = 0;
    bVar1 = false;
    local_48 = 0;
    local_50 = 0;
    local_58 = 0;
    local_60 = 0;
    local_68 = 0;
    iVar2 = RtlAllocateAndInitializeSid(&local_18,2,0x20,0x220);
    if (iVar2 < 0) {
      uVar3 = RtlNtStatusToDosError(iVar2);
LAB_1800676f5:
      RtlSetLastWin32Error(uVar3);
    }
    else {
      iVar2 = (*pFVar4)();
      if (iVar2 != 0) {
        if (local_28 == 0) {
          uVar3 = 5;
          goto LAB_1800676f5;
        }
        RtlSetLastWin32Error(0);
        bVar1 = true;
      }
    }
    if (local_20 != 0) {
      RtlFreeSid();
      local_20 = 0;
    }
    if (!bVar1) {
      local_38 = &local_20;
      local_40 = 0;
      local_48 = 0;
      local_50 = 0;
      local_58 = 0;
      local_60 = 0;
      local_68 = 0;
      iVar2 = RtlAllocateAndInitializeSid(&local_18,1,0x12,0);
      if (iVar2 < 0) {
        uVar3 = RtlNtStatusToDosError(iVar2);
LAB_1800677b2:
        RtlSetLastWin32Error(uVar3);
      }
      else {
        iVar2 = (*pFVar4)();
        if (iVar2 != 0) {
          if (local_28 == 0) {
            uVar3 = 5;
            goto LAB_1800677b2;
          }
          RtlSetLastWin32Error(0);
        }
      }
    }
  }
  FreeLibrary(hModule);
LAB_1800677d5:
  if (local_20 != 0) {
    RtlFreeSid();
  }
  __security_check_cookie(local_10 ^ (ulonglong)auStack136);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void SetTermsrvAppInstallMode(undefined4 param_1)

{
  int iVar1;
  undefined4 uVar2;
  ulonglong uVar3;
  HMODULE hModule;
  undefined auStack1032 [32];
  int local_3e8 [4];
  undefined local_3d8 [64];
  undefined4 local_398;
  ulonglong local_18;
  
                    // 0x67820  1380  SetTermsrvAppInstallMode
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack1032;
  uVar3 = RtlGetSuiteMask();
  if ((uVar3 & 0x10) == 0) goto LAB_180067922;
  iVar1 = FUN_180017900(local_3e8);
  if (-1 < iVar1) {
    if (local_3e8[0] == 0) goto LAB_180067922;
    local_398 = param_1;
    iVar1 = CsrClientCallServer(local_3d8,0,0x10015,4);
    if (-1 < iVar1) {
      if (DAT_1800b2f60 == (FARPROC)0x0) {
        hModule = LoadLibraryExW(L"tsappcmp.dll",(HANDLE)0x0,0x800);
        if (hModule != (HMODULE)0x0) {
          DAT_1800b2f60 = GetProcAddress(hModule,"TermsrvUpdateAllUserMenu");
        }
        if (DAT_1800b2f60 == (FARPROC)0x0) goto LAB_180067922;
      }
      (*DAT_1800b2f60)();
      goto LAB_180067922;
    }
  }
  uVar2 = RtlNtStatusToDosError(iVar1);
  RtlSetLastWin32Error(uVar2);
LAB_180067922:
  __security_check_cookie(local_18 ^ (ulonglong)auStack1032);
  return;
}



ulonglong FUN_18006794c(short *param_1,ulonglong param_2,short *param_3,short **param_4,
                       longlong *param_5)

{
  uint uVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  short *psVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  ulonglong local_res10;
  
  uVar6 = 0;
  uVar3 = param_2 >> 1;
  uVar5 = uVar6;
  if (0x7ffffffe < uVar3 - 1) {
    uVar5 = 0x80070057;
  }
  uVar2 = uVar6;
  if (-1 < (int)uVar5) {
    uVar1 = FUN_180067ae8(param_1,uVar3,(longlong *)&local_res10);
    uVar5 = (ulonglong)uVar1;
    uVar2 = local_res10;
  }
  if (-1 < (int)uVar5) {
    uVar3 = uVar3 - uVar2;
    psVar4 = param_1 + uVar2;
    if (uVar3 < 2) {
      if (*param_3 != 0) {
        if (param_1 == (short *)0x0) {
          return 0x80070057;
        }
        uVar6 = 0x8007007a;
      }
    }
    else {
      local_res10 = 0;
      uVar1 = FUN_18000b1d8(psVar4,uVar3,(longlong *)&local_res10,(longlong)param_3);
      uVar6 = (ulonglong)uVar1;
      uVar3 = uVar3 - local_res10;
      psVar4 = psVar4 + local_res10;
      if (((uVar1 + 0x80000000 & 0x80000000) == 0) && (uVar1 != 0x8007007a)) {
        return uVar6;
      }
    }
    if (param_4 != (short **)0x0) {
      *param_4 = psVar4;
    }
    uVar5 = uVar6;
    if (param_5 != (longlong *)0x0) {
      *param_5 = (ulonglong)((uint)param_2 & 1) + uVar3 * 2;
    }
  }
  return uVar5;
}



uint FUN_180067a5c(short *param_1,undefined8 param_2,longlong param_3,short **param_4,
                  longlong *param_5)

{
  uint uVar1;
  longlong local_res10;
  
  local_res10 = 0;
  uVar1 = FUN_18000b1d8(param_1,0x105,&local_res10,param_3);
  if (((uVar1 + 0x80000000 & 0x80000000) != 0) || (uVar1 == 0x8007007a)) {
    if (param_4 != (short **)0x0) {
      *param_4 = param_1 + local_res10;
    }
    if (param_5 != (longlong *)0x0) {
      *param_5 = (0x105 - local_res10) * 2;
    }
  }
  return uVar1;
}



uint FUN_180067ae8(short *param_1,longlong param_2,longlong *param_3)

{
  uint uVar1;
  longlong lVar2;
  
  lVar2 = param_2;
  if (param_2 != 0) {
    do {
      if (*param_1 == 0) break;
      param_1 = param_1 + 1;
      lVar2 = lVar2 + -1;
    } while (lVar2 != 0);
  }
  uVar1 = ~-(uint)(lVar2 != 0) & 0x80070057;
  if (param_3 != (longlong *)0x0) {
    if (lVar2 != 0) {
      *param_3 = param_2 - lVar2;
      return uVar1;
    }
    *param_3 = 0;
  }
  return uVar1;
}



void FUN_180067b30(longlong param_1,longlong param_2)

{
  int iVar1;
  undefined auStack168 [32];
  undefined8 local_88;
  undefined4 local_80 [2];
  undefined8 local_78;
  longlong local_70;
  undefined4 local_68;
  undefined local_60 [16];
  undefined local_50 [56];
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack168;
  iVar1 = FUN_180067c78(param_1,param_2,&local_88);
  if ((iVar1 != -0x3fffffcc) && (-1 < iVar1)) {
    local_78 = 0;
    local_80[0] = 0x30;
    local_68 = 0x40;
    local_60 = ZEXT816(0);
    local_70 = param_1;
    NtQueryFullAttributesFile(local_80,local_50);
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack168);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

undefined8 TermsrvConvertSysRootToUserDir(void)

{
  undefined8 uVar1;
  
                    // 0x67be0  1442  TermsrvConvertSysRootToUserDir
  if (DAT_1800b2dc8 != 0) {
    uVar1 = (*(code *)DAT_1800b2dc8)();
                    // WARNING: Treating indirect jump as call
    return uVar1;
  }
  return 0xc0000135;
}



void FUN_180067c00(undefined8 param_1)

{
  undefined auStack136 [32];
  undefined4 local_68 [2];
  undefined8 local_60;
  undefined8 local_58;
  undefined4 local_50;
  undefined local_48 [16];
  undefined local_38 [40];
  ulonglong local_10;
  
  local_10 = DAT_1800b2220 ^ (ulonglong)auStack136;
  local_68[0] = 0x30;
  local_60 = 0;
  local_50 = 0x40;
  local_48 = ZEXT816(0);
  local_58 = param_1;
  NtQueryAttributesFile(local_68,local_38);
  __security_check_cookie(local_10 ^ (ulonglong)auStack136);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180067c78(longlong param_1,longlong param_2,undefined8 *param_3)

{
  int iVar1;
  longlong lVar2;
  wchar_t *_Str1;
  wchar_t *pwVar4;
  undefined auStack808 [32];
  undefined8 local_308;
  undefined8 local_300;
  undefined4 local_2f8;
  undefined8 local_2f0;
  undefined8 local_2e8;
  wchar_t *local_2d8;
  longlong local_2d0;
  longlong local_2c8;
  undefined4 local_2c0 [2];
  undefined *local_2b8;
  int local_2b0 [4];
  undefined4 local_2a0 [2];
  undefined8 local_298;
  undefined4 *local_290;
  undefined4 local_288;
  undefined local_280 [16];
  undefined local_270 [16];
  undefined8 local_260;
  undefined local_258 [528];
  ulonglong local_48;
  longlong lVar3;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStack808;
  local_260 = 0;
  local_2d0 = 0;
  local_270 = ZEXT816(0);
  memset(local_258,0,0x20a);
  local_2c0[0] = 0x20a0000;
  local_2b8 = local_258;
  local_2d8 = (wchar_t *)0x0;
  if ((((param_1 != 0) && (param_2 != 0)) && (param_3 != (undefined8 *)0x0)) &&
     ((iVar1 = RtlAppendUnicodeStringToString(local_2c0,param_2), -1 < iVar1 &&
      (iVar1 = RtlAppendUnicodeToString(local_2c0,L"\\inifile.upd"), -1 < iVar1)))) {
    local_290 = local_2c0;
    local_300 = (wchar_t *)CONCAT44(local_300._4_4_,0x20);
    *param_3 = 0;
    local_2a0[0] = 0x30;
    local_298 = 0;
    local_288 = 0x40;
    local_280 = ZEXT816(0);
    local_2b0[0] = 0;
    local_308 = (int *)CONCAT44(local_308._4_4_,3);
    iVar1 = NtOpenFile(&local_2d0,0x120089,local_2a0,local_2b0);
    if (-1 < iVar1) {
      local_308 = (int *)CONCAT44(local_308._4_4_,5);
      iVar1 = NtQueryInformationFile(local_2d0,local_2b0,local_270,0x18);
      if (iVar1 == -0x7ffffffb) {
        iVar1 = 0;
      }
      if (-1 < iVar1) {
        local_2c8 = (ulonglong)local_270._8_4_ + 8;
        local_300 = (wchar_t *)CONCAT44(local_300._4_4_,4);
        local_308 = (int *)CONCAT44(local_308._4_4_,0x2000);
        iVar1 = NtAllocateVirtualMemory(0xffffffffffffffff,&local_2d8,0,&local_2c8);
        if (-1 < iVar1) {
          local_300 = (wchar_t *)CONCAT44(local_300._4_4_,4);
          local_308 = (int *)CONCAT44(local_308._4_4_,0x1000);
          iVar1 = NtAllocateVirtualMemory(0xffffffffffffffff,&local_2d8,0,&local_2c8);
          if (-1 < iVar1) {
            local_2e8 = 0;
            local_2f0 = 0;
            local_2f8 = local_270._8_4_;
            local_300 = local_2d8;
            local_308 = local_2b0;
            iVar1 = NtReadFile(local_2d0,0,0,0);
            if (iVar1 == 0x103) {
              iVar1 = NtWaitForSingleObject(local_2d0,0,0);
            }
            if ((-1 < iVar1) && (-1 < local_2b0[0])) {
              pwVar4 = (wchar_t *)((ulonglong)local_270._8_4_ + (longlong)local_2d8);
              _Str1 = local_2d8;
              if (local_2d8 < pwVar4) {
                do {
                  iVar1 = _wcsicmp(_Str1,*(wchar_t **)(param_1 + 8));
                  if (-1 < iVar1) break;
                  lVar2 = -1;
                  do {
                    lVar3 = lVar2;
                    lVar2 = lVar3 + 1;
                  } while (_Str1[lVar2] != L'\0');
                  _Str1 = _Str1 + lVar3 + 6;
                } while (_Str1 < pwVar4);
                if ((_Str1 < pwVar4) && (iVar1 == 0)) {
                  lVar2 = -1;
                  do {
                    lVar3 = lVar2;
                    lVar2 = lVar3 + 1;
                  } while (_Str1[lVar3 + 1] != L'\0');
                  *(undefined4 *)param_3 = *(undefined4 *)(_Str1 + lVar3 + 2);
                  *(undefined4 *)((longlong)param_3 + 4) = *(undefined4 *)(_Str1 + lVar3 + 4);
                }
              }
            }
          }
        }
      }
    }
    if (local_2d8 != (wchar_t *)0x0) {
      NtFreeVirtualMemory(0xffffffffffffffff,&local_2d8,&local_2c8,0x8000);
    }
    if (local_2d0 != 0) {
      NtClose();
    }
  }
  __security_check_cookie(local_48 ^ (ulonglong)auStack808);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Could not reconcile some variable overlaps

void FUN_180067fa4(undefined8 param_1,int *param_2,undefined *param_3)

{
  char cVar1;
  longlong lVar2;
  int iVar3;
  char *pcVar4;
  char *pcVar5;
  char *pcVar6;
  ulonglong uVar7;
  short sVar8;
  ushort uVar9;
  ulonglong uVar10;
  longlong lVar11;
  longlong in_GS_OFFSET;
  undefined auStack696 [32];
  undefined4 local_298;
  undefined4 *local_290;
  undefined4 *local_288;
  char *local_278;
  undefined4 local_270;
  undefined4 local_26c;
  undefined4 local_268 [2];
  int local_260;
  int iStack604;
  undefined8 uStack600;
  ulonglong local_48;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStack696;
  pcVar5 = (char *)0x0;
  local_268[0] = 0;
  local_26c = 0;
  *param_3 = 0;
  pcVar4 = pcVar5;
LAB_18006825d:
  local_270 = 0;
  local_278 = (char *)0x0;
  if (DAT_1800b2f70 != 0) {
    local_288 = &local_26c;
    local_290 = local_268;
    local_298 = 0x200;
    iVar3 = (*(code *)DAT_1800b2f70)();
    if (iVar3 < 0) {
      if (pcVar5 != (char *)0x0) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pcVar5);
      }
      *(undefined4 *)(*(longlong *)(param_2 + 4) + 0x54) =
           *(undefined4 *)(*(longlong *)(param_2 + 4) + 0x34);
    }
    else {
      if (*local_278 != '[') goto LAB_18006816b;
      if (pcVar5 != (char *)0x0) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pcVar5);
      }
      pcVar4 = strrchr(local_278,0x5d);
      if (pcVar4 == (char *)0x0) {
        lVar11 = -1;
        do {
          lVar11 = lVar11 + 1;
        } while (local_278[lVar11] != '\0');
        sVar8 = (short)lVar11;
        uVar9 = sVar8 + 1;
      }
      else {
        uVar9 = (short)pcVar4 - (short)local_278;
        *pcVar4 = '\0';
        sVar8 = uVar9 - 1;
      }
      uVar10 = (ulonglong)uVar9;
      local_260 = CONCAT22(uVar9,sVar8);
      pcVar5 = (char *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,
                                       uVar9);
      uStack600 = pcVar5;
      if (pcVar5 != (char *)0x0) {
        if (uVar10 != 0) {
          lVar11 = 0x7ffffffe - uVar10;
          pcVar4 = pcVar5;
          do {
            if ((lVar11 + uVar10 == 0) ||
               (pcVar4[(longlong)(local_278 + (1 - (longlong)pcVar5))] == '\0')) break;
            *pcVar4 = pcVar4[(longlong)(local_278 + (1 - (longlong)pcVar5))];
            pcVar4 = pcVar4 + 1;
            uVar10 = uVar10 - 1;
          } while (uVar10 != 0);
          pcVar6 = pcVar4 + -1;
          if (uVar10 != 0) {
            pcVar6 = pcVar4;
          }
          *pcVar6 = '\0';
        }
        uStack600._0_4_ = (int)pcVar5;
        uStack600._4_4_ = (int)((ulonglong)pcVar5 >> 0x20);
        param_2[0x12] = local_260;
        param_2[0x13] = iStack604;
        param_2[0x14] = (int)uStack600;
        param_2[0x15] = uStack600._4_4_;
        *(undefined8 *)(param_2 + 0x2c) = *(undefined8 *)(*(longlong *)(param_2 + 4) + 0x38);
        uVar10 = FUN_18000f960((longlong)param_2);
        iVar3 = (int)uVar10;
        goto LAB_180068249;
      }
    }
  }
  goto LAB_18006827c;
LAB_18006816b:
  if ((*local_278 != ';') && (pcVar6 = strchr(local_278,0x3d), pcVar6 != (char *)0x0)) {
    sVar8 = (short)pcVar6 - (short)local_278;
    *(char **)(param_2 + 0x18) = local_278;
    *(short *)((longlong)param_2 + 0x5a) = sVar8;
    *(short *)(param_2 + 0x16) = sVar8;
    uVar10 = 1;
    pcVar6 = pcVar6 + 1;
    param_2[0x26] = 0;
    *(char **)(param_2 + 0x24) = pcVar6;
    for (; ((cVar1 = *pcVar6, cVar1 != '\0' && (cVar1 != '\n')) && (cVar1 != '\r'));
        pcVar6 = pcVar6 + 1) {
      param_2[0x26] = param_2[0x26] + 1;
    }
    if (pcVar4 != (char *)0x0) {
      *(char **)(param_2 + 0x2c) = pcVar4;
      uVar7 = FUN_18000f478((longlong)param_2);
      if (-1 < (int)uVar7) goto LAB_18006825d;
    }
    lVar11 = *(longlong *)(*(longlong *)(param_2 + 4) + 0x38);
    *(longlong *)(param_2 + 0x2c) = lVar11;
    uVar10 = FUN_180022b0c(param_2,uVar10);
    lVar2 = *(longlong *)(param_2 + 4);
    *(ulonglong *)(param_2 + 0x30) =
         (ulonglong)*(uint *)(lVar2 + 0x34) + *(longlong *)(lVar2 + 0x38);
    if ((int)uVar10 < 0) {
      *(undefined4 *)(lVar2 + 0x54) = *(undefined4 *)(lVar2 + 0x34);
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_278);
      if (pcVar5 != (char *)0x0) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pcVar5);
      }
LAB_18006827c:
      __security_check_cookie(local_48 ^ (ulonglong)auStack696);
      return;
    }
    *param_3 = 1;
    if (lVar11 != *(longlong *)(*(longlong *)(param_2 + 4) + 0x38)) {
      *(longlong *)(param_2 + 0x2c) = *(longlong *)(*(longlong *)(param_2 + 4) + 0x38);
      uVar10 = FUN_18000f960((longlong)param_2);
      iVar3 = (int)uVar10;
LAB_180068249:
      if (iVar3 < 0) {
        pcVar4 = (char *)0x0;
      }
      else {
        pcVar4 = *(char **)(param_2 + 0x2c);
      }
    }
  }
  goto LAB_18006825d;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180068340(ushort *param_1,longlong param_2,undefined4 *param_3)

{
  ushort uVar1;
  ulonglong uVar2;
  int iVar3;
  ulonglong uVar4;
  longlong lVar5;
  longlong lVar6;
  wchar_t *pwVar7;
  wchar_t *_Str1;
  ulonglong uVar8;
  undefined auStack856 [32];
  undefined8 local_338;
  undefined8 local_330;
  uint local_328;
  undefined8 local_320;
  undefined8 local_318;
  undefined8 local_310;
  undefined4 local_308;
  wchar_t *local_2f8;
  longlong local_2f0;
  ulonglong local_2e8;
  int local_2e0 [4];
  ulonglong local_2d0;
  undefined8 local_2c8;
  int local_2c0;
  undefined4 local_2bc;
  undefined4 local_2b8 [2];
  undefined *local_2b0;
  undefined4 local_2a8 [2];
  undefined8 local_2a0;
  undefined4 *local_298;
  undefined4 local_290;
  undefined local_288 [16];
  undefined local_278 [16];
  undefined8 local_268;
  undefined local_258 [528];
  ulonglong local_48;
  
  local_2b0 = local_258;
  local_48 = DAT_1800b2220 ^ (ulonglong)auStack856;
  local_2b8[0] = 0x20a0000;
  local_2f0 = 0;
  local_268 = 0;
  local_2f8 = (wchar_t *)0x0;
  local_2e8 = 0;
  local_278 = ZEXT816(0);
  if ((((param_1 == (ushort *)0x0) || (param_2 == 0)) || (param_3 == (undefined4 *)0x0)) ||
     ((iVar3 = RtlAppendUnicodeStringToString(local_2b8), iVar3 < 0 ||
      (iVar3 = RtlAppendUnicodeToString(local_2b8,L"\\inifile.upd"), iVar3 < 0))))
  goto LAB_1800687f3;
  local_308 = 0;
  local_298 = local_2b8;
  local_310 = 0;
  local_318 = CONCAT44(local_318._4_4_,0x60);
  local_320 = CONCAT44(local_320._4_4_,3);
  local_328 = 2;
  local_330 = (wchar_t *)CONCAT44(local_330._4_4_,0x80);
  local_338 = (int *)0x0;
  local_2a8[0] = 0x30;
  local_2a0 = 0;
  local_290 = 0x40;
  local_288 = ZEXT816(0);
  local_2e0[0] = 0;
  iVar3 = NtCreateFile(&local_2f0,0x100083,local_2a8,local_2e0);
  uVar4 = local_2e8;
  uVar2 = local_2d0;
  if (-1 < iVar3) {
    local_338 = (int *)CONCAT44(local_338._4_4_,5);
    iVar3 = NtQueryInformationFile(local_2f0,local_2e0,local_278,0x18);
    if (iVar3 == -0x7ffffffb) {
      iVar3 = 0;
    }
    uVar4 = local_2e8;
    uVar2 = local_2d0;
    if (-1 < iVar3) {
      uVar4 = (ulonglong)local_278._8_4_;
      local_2e8 = uVar4 + 8;
      if ((uVar4 < local_2e8) &&
         (local_2d0 = uVar4 + 0x1008, uVar4 = local_2e8, uVar2 = local_2e8, local_2e8 < local_2d0))
      {
        local_330 = (wchar_t *)CONCAT44(local_330._4_4_,4);
        local_338 = (int *)CONCAT44(local_338._4_4_,0x2000);
        iVar3 = NtAllocateVirtualMemory(0xffffffffffffffff,&local_2f8,0,&local_2d0);
        uVar4 = local_2e8;
        uVar2 = local_2d0;
        if (-1 < iVar3) {
          local_330 = (wchar_t *)CONCAT44(local_330._4_4_,4);
          local_338 = (int *)CONCAT44(local_338._4_4_,0x1000);
          iVar3 = NtAllocateVirtualMemory(0xffffffffffffffff,&local_2f8,0,&local_2e8);
          uVar4 = local_2e8;
          uVar2 = local_2d0;
          if (-1 < iVar3) {
            if (local_278._8_4_ != 0) {
              local_318 = 0;
              local_320 = 0;
              local_328 = local_278._8_4_;
              local_330 = local_2f8;
              local_338 = local_2e0;
              iVar3 = NtReadFile(local_2f0,0,0,0);
              if (iVar3 == 0x103) {
                iVar3 = NtWaitForSingleObject(local_2f0,0,0);
              }
              uVar4 = local_2e8;
              uVar2 = local_2d0;
              if (iVar3 < 0) goto LAB_1800687b3;
              iVar3 = local_2e0[0];
            }
            uVar4 = local_2e8;
            uVar2 = local_2d0;
            if (-1 < iVar3) {
              pwVar7 = (wchar_t *)((ulonglong)local_278._8_4_ + (longlong)local_2f8);
              _Str1 = local_2f8;
              if (local_2f8 < pwVar7) {
                do {
                  iVar3 = _wcsicmp(_Str1,*(wchar_t **)(param_1 + 4));
                  if (-1 < iVar3) break;
                  lVar5 = -1;
                  do {
                    lVar6 = lVar5;
                    lVar5 = lVar6 + 1;
                  } while (_Str1[lVar5] != L'\0');
                  _Str1 = _Str1 + lVar6 + 6;
                } while (_Str1 < pwVar7);
                if ((pwVar7 <= _Str1) || (iVar3 != 0)) goto LAB_180068644;
                lVar5 = -1;
                do {
                  lVar6 = lVar5;
                  lVar5 = lVar6 + 1;
                } while (_Str1[lVar6 + 1] != L'\0');
                *(undefined4 *)(_Str1 + lVar6 + 2) = *param_3;
                *(undefined4 *)(_Str1 + lVar6 + 4) = param_3[1];
LAB_1800686e5:
                local_2c8 = 0;
                local_338 = (int *)CONCAT44(local_338._4_4_,0xe);
                NtSetInformationFile(local_2f0,local_2e0,&local_2c8,8);
                local_318 = 0;
                local_328 = ((int)pwVar7 - (int)local_2f8) + 1;
                local_320 = 0;
                local_330 = local_2f8;
                local_338 = local_2e0;
                iVar3 = NtWriteFile(local_2f0,0,0,0);
                if (iVar3 == 0x103) {
                  iVar3 = NtWaitForSingleObject(local_2f0,0,0);
                }
                uVar4 = local_2e8;
                uVar2 = local_2d0;
                if ((-1 < iVar3) && (-1 < local_2e0[0])) {
                  local_2c0 = (int)pwVar7 - (int)local_2f8;
                  local_2bc = 0;
                  local_338 = (int *)CONCAT44(local_338._4_4_,0x14);
                  NtSetInformationFile(local_2f0,local_2e0,&local_2c0,8);
                  uVar4 = local_2e8;
                  uVar2 = local_2d0;
                }
              }
              else {
LAB_180068644:
                uVar1 = *param_1;
                uVar8 = (ulonglong)uVar1 + 10;
                uVar4 = local_2e8;
                uVar2 = local_2d0;
                if (local_2e8 <= uVar8 + local_2e8) {
                  local_330 = (wchar_t *)CONCAT44(local_330._4_4_,4);
                  local_338 = (int *)CONCAT44(local_338._4_4_,0x1000);
                  local_2e8 = uVar8 + local_2e8;
                  iVar3 = NtAllocateVirtualMemory(0xffffffffffffffff,&local_2f8,0,&local_2e8);
                  uVar4 = local_2e8;
                  uVar2 = local_2d0;
                  if (-1 < iVar3) {
                    if (_Str1 < pwVar7) {
                      RtlMoveMemory((void *)((longlong)_Str1 + (uVar8 & 0xfffffffffffffffe)),_Str1,
                                    (longlong)pwVar7 - (longlong)_Str1);
                    }
                    pwVar7 = (wchar_t *)((longlong)pwVar7 + uVar8);
                    FUN_1800176c8(_Str1,(ulonglong)uVar1 + 2,*(longlong *)(param_1 + 4));
                    uVar1 = *param_1;
                    *(undefined4 *)((longlong)_Str1 + ((ulonglong)uVar1 + 2 & 0xfffffffffffffffe)) =
                         *param_3;
                    *(undefined4 *)
                     ((longlong)_Str1 + ((ulonglong)uVar1 + 2 & 0xfffffffffffffffe) + 4) =
                         param_3[1];
                    goto LAB_1800686e5;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
LAB_1800687b3:
  local_2d0 = uVar2;
  local_2e8 = uVar4;
  if (local_2f8 != (wchar_t *)0x0) {
    NtFreeVirtualMemory(0xffffffffffffffff,&local_2f8,&local_2d0,0x8000);
  }
  if (local_2f0 != 0) {
    NtClose();
  }
LAB_1800687f3:
  __security_check_cookie(local_48 ^ (ulonglong)auStack856);
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void TermsrvRestoreKey(void)

{
                    // 0x68830  1451  TermsrvRestoreKey
  if (DAT_1800b2df8 != 0) {
    (*(code *)DAT_1800b2df8)();
                    // WARNING: Treating indirect jump as call
    return;
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

void TermsrvSyncUserIniFileExt(void)

{
                    // 0x68850  1454  TermsrvSyncUserIniFileExt
  if (DAT_1800b2ce0 != 0) {
    (*(code *)DAT_1800b2ce0)();
                    // WARNING: Treating indirect jump as call
    return;
  }
  return;
}



HFILE _lcreat(LPCSTR lpPathName,int iAttribute)

{
  HANDLE pvVar1;
  
                    // 0x68870  1597  _lcreat
  RtlSetLastWin32Error(0);
  pvVar1 = CreateFileA(lpPathName,0xc0000000,3,(LPSECURITY_ATTRIBUTES)0x0,2,iAttribute & 0x5affb7,
                       (HANDLE)0x0);
  return (HFILE)pvVar1;
}



HFILE _lopen(LPCSTR lpPathName,int iReadWrite)

{
  byte bVar1;
  undefined7 extraout_var;
  HANDLE pvVar2;
  DWORD dwDesiredAccess;
  
                    // 0x688e0  1600  _lopen
  RtlSetLastWin32Error();
  dwDesiredAccess = ((~iReadWrite & 1U) + 1) * 0x40000000;
  if ((iReadWrite & 2U) != 0) {
    dwDesiredAccess = 0xc0000000;
  }
  bVar1 = BasepOfShareToWin32Share(iReadWrite);
  pvVar2 = CreateFileA(lpPathName,dwDesiredAccess,(DWORD)CONCAT71(extraout_var,bVar1),
                       (LPSECURITY_ATTRIBUTES)0x0,3,0,(HANDLE)0x0);
  return (HFILE)pvVar2;
}



long _hwrite(HFILE hFile,LPCCH lpBuffer,long lBytes)

{
  int iVar1;
  DWORD DVar2;
  DWORD local_res18 [4];
  
                    // 0x68960  1595  _hwrite
                    // 0x68960  1602  _lwrite
  if (lBytes == 0) {
    local_res18[0] = 0;
    iVar1 = SetEndOfFile((HANDLE)(longlong)hFile);
  }
  else {
    iVar1 = WriteFile((HANDLE)(longlong)hFile,lpBuffer,lBytes,local_res18,(LPOVERLAPPED)0x0);
  }
  DVar2 = 0xffffffff;
  if (iVar1 != 0) {
    DVar2 = local_res18[0];
  }
  return DVar2;
}



LPWSTR lstrcatW(LPWSTR lpString1,LPCWSTR lpString2)

{
  WCHAR WVar1;
  longlong lVar2;
  LPWSTR pWVar3;
  
                    // 0x689b0  1605  lstrcatW
  pWVar3 = lpString1 + -1;
  do {
    pWVar3 = pWVar3 + 1;
  } while (*pWVar3 != L'\0');
  lVar2 = 0;
  do {
    WVar1 = lpString2[lVar2];
    pWVar3[lVar2] = WVar1;
    lVar2 = lVar2 + 1;
  } while (WVar1 != L'\0');
  return lpString1;
}



MMRESULT timeGetSystemTime(LPMMTIME pmmt,UINT cbmmt)

{
  DWORD DVar1;
  MMRESULT MVar2;
  
                    // 0x68a00  1624  timeGetSystemTime
  if ((cbmmt < 0xc) || (pmmt == (LPMMTIME)0x0)) {
    MVar2 = 0x81;
  }
  else {
    DVar1 = timeGetTime();
    *(DWORD *)&pmmt->u = DVar1;
    MVar2 = 0;
    pmmt->wType = 1;
  }
  return MVar2;
}



BOOL CloseConsoleHandle(HANDLE hObject)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180068a40. Too many branches
                    // WARNING: Treating indirect jump as call
                    // 0x68a40  137  CloseConsoleHandle
  BVar1 = CloseHandle(hObject);
  return BVar1;
}



HANDLE DuplicateConsoleHandle(HANDLE param_1,DWORD param_2,BOOL param_3,DWORD param_4)

{
  BOOL BVar1;
  HANDLE hTargetProcessHandle;
  HANDLE hSourceProcessHandle;
  HANDLE local_18 [2];
  
                    // 0x68a60  305  DuplicateConsoleHandle
  hTargetProcessHandle = GetCurrentProcess();
  hSourceProcessHandle = GetCurrentProcess();
  BVar1 = DuplicateHandle(hSourceProcessHandle,param_1,hTargetProcessHandle,local_18,param_2,param_3
                          ,param_4);
  if (BVar1 == 0) {
    local_18[0] = (HANDLE)0xffffffffffffffff;
  }
  return local_18[0];
}



void GetConsoleInputWaitHandle(void)

{
                    // 0x68b00  515  GetConsoleInputWaitHandle
                    // WARNING: Could not recover jumptable at 0x000180068b05. Too many branches
                    // WARNING: Treating indirect jump as call
  GetStdHandle(0xfffffff6);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void OpenConsoleW(LPCWSTR param_1,DWORD param_2,uint param_3,DWORD param_4)

{
  undefined local_28 [16];
  ulonglong local_18;
  
                    // 0x68b20  1028  OpenConsoleW
  local_28 = CONCAT124(SUB1612(ZEXT816(0) >> 0x20,0),0x18);
  local_18 = (ulonglong)param_3;
  CreateFileW(param_1,param_2,param_4,(LPSECURITY_ATTRIBUTES)local_28,3,0,(HANDLE)0x0);
  return;
}



undefined8 ConsoleMenuControl(undefined8 param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined4 local_60;
  undefined4 local_5c;
  undefined8 local_58;
  
                    // 0x68b80  161  ConsoleMenuControl
  local_60 = param_2;
  local_5c = param_3;
  iVar1 = FUN_18006a664(param_1,local_68,0x300000b,0x10);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
    local_58 = 0;
  }
  return local_58;
}



bool GetConsoleHardwareState(undefined8 param_1,undefined4 *param_2,undefined4 *param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined4 local_60;
  undefined4 local_5c;
  
                    // 0x68be0  511  GetConsoleHardwareState
  iVar1 = FUN_18006a664(param_1,local_68,0x300000f,8);
  if (-1 < iVar1) {
    *param_2 = local_60;
    *param_3 = local_5c;
  }
  else {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return -1 < iVar1;
}



undefined8
RegisterConsoleVDM(int param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
                  undefined8 param_5,undefined4 *param_6,undefined8 *param_7,undefined8 param_8,
                  undefined8 *param_9)

{
  int iVar1;
  undefined4 uVar2;
  undefined8 uVar3;
  undefined4 local_68 [2];
  int local_60;
  undefined8 local_58;
  undefined8 local_50;
  undefined8 local_48;
  undefined4 local_40;
  undefined8 local_38;
  undefined8 local_30;
  
                    // 0x68c60  1198  RegisterConsoleVDM
  if (param_1 != 0) {
    local_58 = param_2;
    local_50 = param_3;
    local_48 = param_4;
  }
  local_60 = param_1;
  iVar1 = FUN_18006a664(0,local_68,0x300000e,0x38);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
    uVar3 = 0;
  }
  else {
    if (param_1 != 0) {
      *param_6 = local_40;
      *param_7 = local_38;
      *param_9 = local_30;
    }
    uVar3 = 1;
  }
  return uVar3;
}



bool SetConsoleCursor(undefined8 param_1,undefined8 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined8 local_60;
  
                    // 0x68d10  1275  SetConsoleCursor
  local_60 = param_2;
  iVar1 = FUN_18006a664(param_1,local_68,0x3000009,8);
  if (-1 >= iVar1) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return -1 < iVar1;
}



bool SetConsoleHardwareState(undefined8 param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined4 local_60;
  undefined4 local_5c;
  
                    // 0x68d70  1281  SetConsoleHardwareState
  local_60 = param_2;
  local_5c = param_3;
  iVar1 = FUN_18006a664(param_1,local_68,0x3000010,8);
  if (-1 >= iVar1) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return -1 < iVar1;
}



bool SetConsoleKeyShortcuts(int param_1,undefined param_2,undefined8 param_3,int param_4)

{
  int iVar1;
  undefined4 uVar2;
  int local_78 [2];
  undefined8 local_70;
  undefined4 local_68 [2];
  undefined local_60;
  undefined local_5f;
  
                    // 0x68dd0  1286  SetConsoleKeyShortcuts
  local_60 = param_1 != 0;
  local_78[0] = param_4 << 2;
  local_70 = param_3;
  local_5f = param_2;
  iVar1 = FUN_18006a818(0,local_68,0x300001c,2,local_78,1,(int *)0x0,0);
  if (-1 >= iVar1) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return -1 < iVar1;
}



bool SetConsoleMenuClose(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined local_60;
  
                    // 0x68e60  1289  SetConsoleMenuClose
  local_60 = param_1 != 0;
  iVar1 = FUN_18006a664(0,local_68,0x300001d,1);
  if (-1 >= iVar1) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return -1 < iVar1;
}



bool SetConsolePalette(undefined8 param_1,undefined8 param_2,undefined4 param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined8 local_60;
  undefined4 local_58;
  
                    // 0x68ec0  1296  SetConsolePalette
  local_60 = param_2;
  local_58 = param_3;
  iVar1 = FUN_18006a664(param_1,local_68,0x300000c,0x10);
  if (-1 >= iVar1) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return -1 < iVar1;
}



undefined4 ShowConsoleCursor(undefined8 param_1,int param_2)

{
  undefined4 local_68 [2];
  undefined local_60;
  undefined4 local_5c;
  
                    // 0x68f30  1421  ShowConsoleCursor
  local_60 = param_2 != 0;
  FUN_18006a664(param_1,local_68,0x300000a,8);
  return local_5c;
}



bool WriteConsoleInputVDMA(undefined8 param_1,undefined8 param_2,int param_3,undefined4 *param_4)

{
  int iVar1;
  int local_88 [2];
  undefined8 local_80;
  undefined4 local_78 [2];
  undefined4 local_70;
  undefined2 local_6c;
  
                    // 0x68f70  1565  WriteConsoleInputVDMA
  local_6c = 0;
  local_88[0] = param_3 * 0x14;
  local_80 = param_2;
  iVar1 = FUN_18006a818(param_1,local_78,0x2000010,8,local_88,1,(int *)0x0,0);
  *param_4 = local_70;
  if (-1 >= iVar1) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus();
  }
  return -1 < iVar1;
}



bool WriteConsoleInputVDMW(undefined8 param_1,undefined8 param_2,int param_3,undefined4 *param_4)

{
  int iVar1;
  int local_88 [2];
  undefined8 local_80;
  undefined4 local_78 [2];
  undefined4 local_70;
  undefined2 local_6c;
  
                    // 0x69000  1566  WriteConsoleInputVDMW
  local_88[0] = param_3 * 0x14;
  local_6c = 1;
  local_80 = param_2;
  iVar1 = FUN_18006a818(param_1,local_78,0x2000010,8,local_88,1,(int *)0x0,0);
  *param_4 = local_70;
  if (-1 >= iVar1) {
    RtlSetLastWin32ErrorAndNtStatusFromNtStatus();
  }
  return -1 < iVar1;
}



bool GetConsoleCharType(undefined8 param_1,undefined4 param_2,undefined4 *param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined4 local_60;
  undefined4 local_5c;
  
                    // 0x69090  501  GetConsoleCharType
  local_60 = param_2;
  iVar1 = FUN_18006a664(param_1,local_68,0x3000020,8);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  else {
    *param_3 = local_5c;
  }
  return iVar1 >= 0;
}



bool GetConsoleCursorMode(undefined8 param_1,uint *param_2,uint *param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  byte local_60;
  byte local_5f;
  
                    // 0x69100  507  GetConsoleCursorMode
  iVar1 = FUN_18006a664(param_1,local_68,0x3000023,2);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  else {
    *param_2 = (uint)local_60;
    *param_3 = (uint)local_5f;
  }
  return iVar1 >= 0;
}



bool GetConsoleNlsMode(undefined8 param_1,undefined4 *param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined local_60;
  undefined4 local_5c;
  
                    // 0x69180  519  GetConsoleNlsMode
  local_60 = 0;
  iVar1 = FUN_18006a664(param_1,local_68,0x3000026,8);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  else {
    *param_2 = local_5c;
  }
  return iVar1 >= 0;
}



undefined8 RegisterConsoleIME(void)

{
                    // 0x691f0  1196  RegisterConsoleIME
                    // 0x691f0  1481  UnregisterConsoleIME
  RtlSetLastWin32Error(0x78);
  return 0;
}



bool RegisterConsoleOS2(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined local_60;
  
                    // 0x69220  1197  RegisterConsoleOS2
  local_60 = param_1 != 0;
  iVar1 = FUN_18006a664(0,local_68,0x3000024,1);
  if (-1 >= iVar1) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return -1 < iVar1;
}



bool SetConsoleCursorMode(undefined8 param_1,int param_2,int param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined local_60;
  undefined local_5f;
  
                    // 0x69280  1277  SetConsoleCursorMode
  local_60 = param_2 != 0;
  local_5f = param_3 != 0;
  iVar1 = FUN_18006a664(param_1,local_68,0x3000022,2);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return iVar1 >= 0;
}



undefined8
SetConsoleLocalEUDC(undefined8 param_1,undefined2 param_2,undefined4 param_3,undefined8 param_4)

{
  int iVar1;
  undefined4 uVar2;
  ulonglong uVar3;
  undefined4 local_78 [2];
  undefined8 local_70;
  undefined4 local_68 [2];
  undefined2 local_60;
  undefined4 local_5e;
  
                    // 0x692f0  1287  SetConsoleLocalEUDC
  uVar3 = ((longlong)((short)param_3 + 7) / 8 & 0xffffffffU) *
          (ulonglong)(uint)(int)(short)((uint)param_3 >> 0x10);
  local_70 = param_4;
  local_60 = param_2;
  local_5e = param_3;
  if (uVar3 < 0x100000000) {
    local_78[0] = (undefined4)uVar3;
    iVar1 = FUN_18006a818(param_1,local_68,0x3000021,6,local_78,1,(int *)0x0,0);
    if (-1 < iVar1) {
      return 1;
    }
    uVar2 = RtlNtStatusToDosError(iVar1);
  }
  else {
    uVar2 = 0x57;
  }
  RtlSetLastWin32Error(uVar2);
  return 0;
}



bool SetConsoleNlsMode(undefined8 param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [3];
  undefined4 local_5c;
  
                    // 0x693b0  1291  SetConsoleNlsMode
  local_5c = param_2;
  iVar1 = FUN_18006a664(param_1,local_68,0x3000027,8);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return iVar1 >= 0;
}



bool SetConsoleOS2OemFormat(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined local_60;
  
                    // 0x69410  1294  SetConsoleOS2OemFormat
  local_60 = param_1 != 0;
  iVar1 = FUN_18006a664(0,local_68,0x3000025,1);
  if (-1 >= iVar1) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return -1 < iVar1;
}



undefined4
GetConsoleFontInfo(undefined8 param_1,undefined param_2,ulonglong param_3,undefined8 param_4)

{
  int iVar1;
  undefined4 uVar2;
  ulonglong uVar3;
  int local_78 [2];
  undefined8 local_70;
  undefined4 local_68 [2];
  undefined local_60;
  undefined4 local_5c;
  
                    // 0x69470  509  GetConsoleFontInfo
  uVar3 = (param_3 & 0xffffffff) << 3;
  local_60 = param_2;
  if (uVar3 < 0x100000000) {
    local_78[0] = (int)uVar3;
    local_70 = param_4;
    iVar1 = FUN_18006a818(param_1,local_68,0x3000002,8,(undefined4 *)0x0,0,local_78,1);
    if (iVar1 < 0) {
      local_5c = 0;
      uVar2 = RtlNtStatusToDosError(iVar1);
      RtlSetLastWin32Error(uVar2);
    }
  }
  else {
    RtlSetLastWin32Error(0x57);
    local_5c = 0;
  }
  return local_5c;
}



// WARNING: Removing unreachable block (ram,0x0001800695a6)

ulonglong GetConsoleKeyboardLayoutNameA(short *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined local_60 [18];
  undefined local_4e;
  
                    // 0x69520  516  GetConsoleKeyboardLayoutNameA
  local_4e = 1;
  iVar1 = FUN_18006a664(0,local_68,0x300001e,0x14);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  else {
    FID_conflict_RtlStringCchCopyA((char *)param_1,9,(longlong)local_60);
  }
  return (ulonglong)(iVar1 >= 0);
}



// WARNING: Removing unreachable block (ram,0x00018006959f)

ulonglong GetConsoleKeyboardLayoutNameW(char *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 auStack104 [2];
  undefined auStack96 [18];
  undefined uStack78;
  
                    // 0x69540  517  GetConsoleKeyboardLayoutNameW
  uStack78 = 0;
  iVar1 = FUN_18006a664(0,auStack104,0x300001e,0x14);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  else {
    FUN_18000760c((short *)param_1,0x12,auStack96);
  }
  return (ulonglong)(iVar1 >= 0);
}



undefined4 GetNumberOfConsoleFonts(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined4 local_60;
  
                    // 0x695f0  671  GetNumberOfConsoleFonts
  iVar1 = FUN_18006a664(0,local_68,0x3000000,4);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
    local_60 = 0;
  }
  return local_60;
}



bool SetConsoleFont(undefined8 param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined4 local_60;
  
                    // 0x69650  1280  SetConsoleFont
  local_60 = param_2;
  iVar1 = FUN_18006a664(param_1,local_68,0x3000005,4);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return iVar1 >= 0;
}



bool SetConsoleIcon(undefined8 param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined8 local_60;
  
                    // 0x696b0  1283  SetConsoleIcon
  local_60 = param_1;
  iVar1 = FUN_18006a664(0,local_68,0x3000006,8);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return iVar1 >= 0;
}



bool InvalidateConsoleDIBits(undefined8 param_1,undefined8 *param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  undefined8 local_60;
  
                    // 0x69710  889  InvalidateConsoleDIBits
  local_60 = *param_2;
  iVar1 = FUN_18006a664(param_1,local_68,0x3000007,8);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
  }
  return iVar1 >= 0;
}



undefined8 VDMConsoleOperation(uint param_1,undefined8 *param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_68 [2];
  uint local_60;
  byte local_5c;
  undefined8 local_58;
  undefined4 local_50;
  undefined4 uStack76;
  undefined4 uStack72;
  undefined4 uStack68;
  
                    // 0x69770  1489  VDMConsoleOperation
  if (param_1 - 4 < 2) {
    local_58 = *param_2;
  }
  else if ((param_1 == 7) || (param_1 == 8)) {
    local_5c = param_2 != (undefined8 *)0x0;
  }
  local_60 = param_1;
  iVar1 = FUN_18006a664(0,local_68,0x3000008,0x20);
  if (iVar1 < 0) {
    uVar2 = RtlNtStatusToDosError(iVar1);
    RtlSetLastWin32Error(uVar2);
    return 0;
  }
  if (param_1 != 2) {
    if (param_1 == 3) {
      *(undefined4 *)param_2 = local_50;
      *(undefined4 *)((longlong)param_2 + 4) = uStack76;
      *(undefined4 *)(param_2 + 1) = uStack72;
      *(undefined4 *)((longlong)param_2 + 0xc) = uStack68;
      return 1;
    }
    if (param_1 < 4) {
      return 1;
    }
    if (param_1 < 6) {
      *param_2 = local_58;
      return 1;
    }
    if (param_1 != 6) {
      return 1;
    }
  }
  *(uint *)param_2 = (uint)local_5c;
  return 1;
}



void FUN_180069838(HGLOBAL *param_1)

{
  if (param_1 != (HGLOBAL *)0x0) {
    if (*param_1 != (HGLOBAL)0x0) {
      GlobalFree(*param_1);
      *param_1 = (HGLOBAL)0x0;
    }
    if (param_1[1] != (HGLOBAL)0x0) {
      GlobalFree(param_1[1]);
      param_1[1] = (HGLOBAL)0x0;
    }
    if (param_1[4] != (HGLOBAL)0x0) {
      GlobalFree(param_1[4]);
      param_1[4] = (HGLOBAL)0x0;
    }
    LocalFree(param_1);
  }
  return;
}



HGLOBAL * FUN_1800698b0(int param_1,undefined8 param_2,int param_3)

{
  HGLOBAL *ppvVar1;
  HGLOBAL pvVar2;
  
  ppvVar1 = (HGLOBAL *)LocalAlloc(0x40,0x80);
  if (ppvVar1 != (HGLOBAL *)0x0) {
    pvVar2 = GlobalAlloc(0x40,0x1080);
    *ppvVar1 = pvVar2;
    if (pvVar2 != (HGLOBAL)0x0) {
      *(int *)(ppvVar1 + 9) = param_3;
      *(int *)((longlong)ppvVar1 + 0x4c) = param_1;
      while ((param_3 != 0 && (param_1 != 0))) {
        pvVar2 = GlobalAlloc(0x40,(ulonglong)(param_3 + 1));
        ppvVar1[1] = pvVar2;
        if (pvVar2 != (HGLOBAL)0x0) {
          pvVar2 = GlobalAlloc(0x40,(ulonglong)*(uint *)((longlong)ppvVar1 + 0x4c));
          ppvVar1[4] = pvVar2;
          if (pvVar2 != (HGLOBAL)0x0) {
            return ppvVar1;
          }
          GlobalFree(ppvVar1[1]);
        }
        *(int *)(ppvVar1 + 9) = *(int *)(ppvVar1 + 9) + -0x400;
        *(int *)((longlong)ppvVar1 + 0x4c) = *(int *)((longlong)ppvVar1 + 0x4c) + -0x400;
        param_3 = *(int *)(ppvVar1 + 9);
        param_1 = *(int *)((longlong)ppvVar1 + 0x4c);
      }
      GlobalFree(*ppvVar1);
    }
  }
  return (HGLOBAL *)0x0;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_1800699a0(int param_1,int param_2,longlong *param_3)

{
  int iVar1;
  ulonglong uVar2;
  undefined8 uVar3;
  undefined auStackY120 [32];
  byte in_stack_ffffffffffffffa8;
  undefined local_48 [16];
  undefined4 local_38;
  ulonglong local_30;
  
  local_30 = DAT_1800b2220 ^ (ulonglong)auStackY120;
  local_38 = 0;
  local_48 = ZEXT816(0);
  iVar1 = FUN_180069b80((undefined8 *)local_48,param_1,(LONG *)(param_3 + 8));
  if ((iVar1 == 1) || (*(int *)(param_3 + 8) < 0xe)) {
    iVar1 = FUN_180069c50((undefined8 *)local_48);
    if (iVar1 == 1) {
      if (local_48[8] != 'A') goto LAB_180069a76;
      uVar2 = FUN_18006a0e4(param_1,param_2,local_48._12_4_ + -1,1,in_stack_ffffffffffffffa8,param_3
                           );
      iVar1 = (int)uVar2;
    }
    else {
      uVar3 = FUN_180069a98(param_1,param_2,(longlong)param_3);
      iVar1 = (int)uVar3;
    }
    if ((iVar1 == 1) && (iVar1 = FUN_18006a490(0x46,param_2,(longlong)param_3), iVar1 == 1)) {
      FUN_180069ca8((HANDLE)(longlong)param_1,(HANDLE)(longlong)param_2);
    }
  }
LAB_180069a76:
  __security_check_cookie(local_30 ^ (ulonglong)auStackY120);
  return;
}



undefined8 FUN_180069a98(HFILE param_1,int param_2,longlong param_3)

{
  LONG LVar1;
  UINT lBytes;
  UINT UVar2;
  longlong lVar3;
  ulonglong uVar4;
  
  LVar1 = _llseek(param_1,0,0);
  if (LVar1 == 0) {
    if ((param_2 != -2) && (LVar1 = _llseek(param_2,0,0), LVar1 != 0)) {
      return 0xfffffffe;
    }
    uVar4 = (ulonglong)*(uint *)(param_3 + 0x48);
    lVar3 = *(longlong *)(param_3 + 8) + 1 + uVar4;
    *(undefined4 *)(param_3 + 0x38) = 0;
    *(longlong *)(param_3 + 0x10) = lVar3;
    *(longlong *)(param_3 + 0x18) = lVar3;
    *(longlong *)(param_3 + 0x30) = *(longlong *)(param_3 + 0x20);
    *(undefined4 *)(param_3 + 0x44) = 0;
    *(ulonglong *)(param_3 + 0x28) =
         (ulonglong)*(uint *)(param_3 + 0x4c) + *(longlong *)(param_3 + 0x20);
    while (lBytes = _hread(param_1,*(LPVOID *)(param_3 + 8),(UINT)uVar4), lBytes != 0) {
      if (lBytes == 0xffffffff) {
        return 0xffffffff;
      }
      UVar2 = _hwrite(param_2,*(LPCCH *)(param_3 + 8),lBytes);
      if (UVar2 != lBytes) {
        if (UVar2 != 0xffffffff) {
          return 0xfffffffe;
        }
        return 0xfffffffc;
      }
      *(int *)(param_3 + 0x44) = *(int *)(param_3 + 0x44) + UVar2;
      if (lBytes != *(UINT *)(param_3 + 0x48)) break;
      uVar4 = (ulonglong)*(uint *)(param_3 + 0x48);
    }
    if (lBytes != 0xffffffff) {
      return 1;
    }
  }
  return 0xffffffff;
}



void FUN_180069b80(undefined8 *param_1,HFILE param_2,LONG *param_3)

{
  byte bVar1;
  LONG LVar2;
  UINT UVar3;
  byte bVar4;
  int iVar5;
  uint uVar6;
  byte *pbVar7;
  undefined auStack88 [32];
  undefined8 local_38;
  undefined local_30;
  undefined local_2f;
  byte local_2e [6];
  ulonglong local_28;
  
  local_28 = DAT_1800b2220 ^ (ulonglong)auStack88;
  LVar2 = _llseek(param_2,0,2);
  uVar6 = 0;
  *param_3 = LVar2;
  if (((-1 < LVar2) && (LVar2 = _llseek(param_2,0,0), LVar2 == 0)) &&
     (UVar3 = _hread(param_2,&local_38,0xe), UVar3 == 0xe)) {
    pbVar7 = local_2e;
    *param_1 = local_38;
    iVar5 = 0;
    *(undefined *)(param_1 + 1) = local_30;
    *(undefined *)((longlong)param_1 + 9) = local_2f;
    do {
      bVar1 = *pbVar7;
      pbVar7 = pbVar7 + 1;
      bVar4 = (byte)iVar5;
      iVar5 = iVar5 + 8;
      uVar6 = uVar6 | (uint)bVar1 << (bVar4 & 0x1f);
    } while (iVar5 < 0x20);
    *(uint *)((longlong)param_1 + 0xc) = uVar6;
    *(LONG *)(param_1 + 2) = *param_3;
  }
  __security_check_cookie(local_28 ^ (ulonglong)auStack88);
  return;
}



void FUN_180069c50(undefined8 *param_1)

{
  undefined auStack72 [32];
  undefined8 local_28;
  undefined local_20;
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack72;
  local_28 = *param_1;
  local_20 = 0;
  FUN_18001c48c((byte *)&local_28,&DAT_18008ac30);
  __security_check_cookie(local_18 ^ (ulonglong)auStack72);
  return;
}



undefined8 FUN_180069ca8(HANDLE param_1,HANDLE param_2)

{
  BOOL BVar1;
  _FILETIME local_res18;
  _FILETIME local_res20;
  _FILETIME local_18 [2];
  
  BVar1 = GetFileTime(param_1,local_18,&local_res20,&local_res18);
  if ((BVar1 != 0) && (BVar1 = SetFileTime(param_2,local_18,&local_res20,&local_res18), BVar1 != 0))
  {
    return 1;
  }
  return 0xffffffff;
}



BYTE * FUN_180069d0c(BYTE *param_1)

{
  BYTE TestChar;
  BOOL BVar1;
  BYTE *pBVar2;
  
  TestChar = *param_1;
  pBVar2 = param_1;
  while (TestChar != '\0') {
    BVar1 = IsDBCSLeadByte(TestChar);
    if (((BVar1 == 0) && ((byte)(*pBVar2 - 0x2f) < 0x2e)) &&
       ((0x200000000801U >> ((ulonglong)(byte)(*pBVar2 - 0x2f) & 0x3f) & 1) != 0)) {
      param_1 = FUN_18006a50c(pBVar2);
    }
    pBVar2 = FUN_18006a50c(pBVar2);
    TestChar = *pBVar2;
  }
  do {
    BVar1 = IsDBCSLeadByte(*param_1);
    if (BVar1 == 0) {
      if (*param_1 == '\0') {
        return (BYTE *)0x0;
      }
      if (*param_1 == '.') {
        return param_1 + 1;
      }
    }
    param_1 = FUN_18006a50c(param_1);
  } while( true );
}



ulonglong FUN_180069dac(char *param_1,ulonglong param_2)

{
  errno_t eVar1;
  ulonglong in_RAX;
  char *pcVar2;
  undefined4 extraout_var;
  longlong lVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  uint uVar6;
  
  uVar5 = 0;
  if (param_1 == (char *)0x0) {
    uVar6 = 0x80070057;
  }
  else {
    lVar3 = 0x106;
    pcVar2 = param_1;
    do {
      if (*pcVar2 == '\0') break;
      pcVar2 = pcVar2 + 1;
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
    in_RAX = 0x106 - lVar3;
    uVar6 = ~-(uint)(lVar3 != 0) & 0x80070057;
    param_2 = -(ulonglong)(lVar3 != 0) & in_RAX;
  }
  if ((int)uVar6 < 0) {
    return in_RAX & 0xffffffffffffff00;
  }
  uVar4 = param_2 & 0xffffffff;
  if ((int)param_2 == 0) {
LAB_180069e5e:
    pcVar2 = "._";
  }
  else {
    do {
      uVar6 = (int)uVar4 - 1;
      uVar4 = (ulonglong)uVar6;
      if (param_1[uVar4] == '.') break;
      if ((param_1[uVar4] == '\\') || (param_1[uVar4] == ':')) {
        uVar4 = 0;
        break;
      }
    } while (uVar6 != 0);
    if ((int)uVar4 == 0) goto LAB_180069e5e;
    if (3 < param_2 - uVar4) {
      uVar5 = (ulonglong)(byte)param_1[param_2 - 1];
      param_1[param_2 - 1] = '_';
      goto LAB_180069e77;
    }
    pcVar2 = "_";
  }
  eVar1 = strcat_s(param_1,0x106,pcVar2);
  uVar4 = CONCAT44(extraout_var,eVar1);
LAB_180069e77:
  return uVar4 & 0xffffffffffffff00 | uVar5;
}



wchar_t FUN_180069e88(void)

{
  short sVar1;
  size_t sVar2;
  short *psVar3;
  wchar_t *pwVar4;
  short *psVar5;
  wchar_t *pwVar6;
  
  psVar3 = &DAT_1800b3000;
  psVar5 = &DAT_1800b3000;
  pwVar4 = (wchar_t *)0x0;
  sVar1 = DAT_1800b3000;
  while (sVar1 != 0) {
    if ((sVar1 == 0x5c) || (sVar1 == 0x3a)) {
      psVar5 = psVar3 + 1;
    }
    psVar3 = psVar3 + 1;
    sVar1 = *psVar3;
  }
  sVar1 = *psVar5;
  while ((sVar1 != 0 && (sVar1 != 0x2e))) {
    psVar5 = psVar5 + 1;
    sVar1 = *psVar5;
  }
  pwVar6 = psVar5 + 1;
  if (sVar1 != 0x2e) {
    pwVar6 = pwVar4;
  }
  if (pwVar6 == (wchar_t *)0x0) {
    pwVar6 = L"._";
  }
  else {
    sVar2 = wcsnlen(pwVar6,(longlong)(pwVar6 + -0xc00596fa) >> 1);
    if (2 < sVar2) {
      pwVar4 = (wchar_t *)(ulonglong)(ushort)pwVar6[sVar2 - 1];
      pwVar6[sVar2 - 1] = L'_';
      goto LAB_180069f59;
    }
    pwVar6 = L"_";
  }
  wcscat_s(&DAT_1800b3000,0x106,pwVar6);
LAB_180069f59:
  return (wchar_t)pwVar4;
}



void FUN_180069f74(BYTE *param_1,undefined8 param_2,BYTE param_3)

{
  ushort uVar1;
  BOOL BVar2;
  BYTE *_Str;
  longlong lVar3;
  undefined6 extraout_var;
  undefined6 extraout_var_00;
  size_t sVar4;
  BYTE *pBVar5;
  BYTE BVar6;
  BYTE *pBVar7;
  BYTE BVar8;
  
  _Str = FUN_180069d0c(param_1);
  if (_Str != (BYTE *)0x0) {
    BVar8 = param_3;
    if (((byte)(param_3 + 0xbf) < 0x1a) || ((byte)(param_3 + 0x9f) < 0x1a)) {
      for (; BVar6 = *param_1, BVar6 != '\0'; param_1 = param_1 + lVar3) {
        BVar2 = IsDBCSLeadByte(BVar6);
        if (BVar2 == 0) {
          BVar6 = *param_1;
          if ((('@' < (char)BVar6) && ((char)BVar6 < '[')) ||
             (('`' < (char)BVar6 && ((char)BVar6 < '{')))) break;
          lVar3 = 1;
        }
        else {
          lVar3 = 2;
        }
      }
      uVar1 = FUN_18006a550(BVar6);
      if ((int)CONCAT62(extraout_var,uVar1) == 0) {
        uVar1 = FUN_18006a5dc(*param_1);
        if (((int)CONCAT62(extraout_var_00,uVar1) != 0) && ((byte)(param_3 + 0x9f) < 0x1a)) {
          BVar8 = param_3 + 0xe0;
        }
      }
      else {
        BVar8 = param_3 + ' ';
        if (0x19 < (byte)(param_3 + 0xbf)) {
          BVar8 = param_3;
        }
      }
    }
    sVar4 = strnlen((char *)_Str,(size_t)(_Str + (0x104 - (longlong)param_1)));
    if (0 < (int)sVar4) {
      BVar2 = IsDBCSLeadByte(*_Str);
      if (((BVar2 == 0) && (*_Str == '_')) && (BVar2 = IsDBCSLeadByte(_Str[1]), BVar2 != 0)) {
        *_Str = BVar8;
      }
      else {
        BVar6 = *_Str;
        pBVar5 = _Str;
        pBVar7 = _Str;
        if (BVar6 != '\0') {
          do {
            pBVar7 = pBVar5;
            pBVar5 = FUN_18006a50c(pBVar7);
          } while (*pBVar5 != '\0');
          BVar6 = *pBVar7;
        }
        BVar2 = IsDBCSLeadByte(BVar6);
        if ((BVar2 == 0) && (*pBVar7 == '_')) {
          *pBVar7 = BVar8;
        }
      }
    }
    if ((*_Str == '\0') && (_Str[-1] == '.')) {
      _Str[-1] = '\0';
    }
  }
  return;
}



ulonglong FUN_18006a0e4(HFILE param_1,int param_2,int param_3,int param_4,byte param_5,
                       longlong *param_6)

{
  byte bVar1;
  byte bVar2;
  longlong *plVar3;
  LONG LVar4;
  int iVar5;
  int iVar6;
  undefined4 extraout_var;
  undefined8 uVar7;
  undefined4 extraout_var_00;
  byte *pbVar8;
  longlong lVar9;
  ulonglong uVar10;
  uint uVar11;
  ulonglong uVar12;
  byte local_res20 [8];
  
  plVar3 = param_6;
  uVar10 = 0;
  *(undefined4 *)((longlong)param_6 + 0x3c) = 0x10;
  if (param_4 == 1) {
    LVar4 = _llseek(param_1,0xe,0);
    if (LVar4 != 0xe) {
      return 0xffffffff;
    }
    if ((param_2 != -2) && (LVar4 = _llseek(param_2,0,0), LVar4 != 0)) {
      return 0xfffffffe;
    }
    lVar9 = plVar3[1] + (ulonglong)*(uint *)(plVar3 + 9) + 1;
    plVar3[6] = plVar3[4];
    plVar3[5] = (ulonglong)*(uint *)((longlong)plVar3 + 0x4c) + plVar3[4];
    plVar3[2] = lVar9;
    plVar3[3] = lVar9;
    *(undefined4 *)(plVar3 + 7) = 0;
    *(undefined4 *)((longlong)plVar3 + 0x44) = 0;
    uVar12 = uVar10;
    if (0 < 0x1000 - *(int *)((longlong)plVar3 + 0x3c)) {
      do {
        uVar11 = (int)uVar12 + 1;
        *(undefined *)(uVar10 + *plVar3) = 0x20;
        uVar10 = uVar10 + 1;
        uVar12 = (ulonglong)uVar11;
      } while ((int)uVar11 < 0x1000 - *(int *)((longlong)plVar3 + 0x3c));
    }
    *(int *)((longlong)plVar3 + 0x54) = 0x1000 - *(int *)((longlong)plVar3 + 0x3c);
    *(undefined4 *)(plVar3 + 10) = 0;
  }
  pbVar8 = (byte *)plVar3[3];
  if (pbVar8 < (byte *)plVar3[2]) goto LAB_18006a374;
  uVar10 = FUN_18006a3f0(local_res20,param_1,(longlong)plVar3);
  if ((int)uVar10 == 1) {
    do {
      while( true ) {
        if (*(int *)((longlong)plVar3 + 0x44) != param_3 &&
            param_3 <= *(int *)((longlong)plVar3 + 0x44)) {
          if (plVar3[3] == plVar3[1] + 1) {
            *(undefined4 *)(plVar3 + 7) = 1;
            return 1;
          }
          plVar3[3] = plVar3[3] + -1;
          return 1;
        }
        *(uint *)(plVar3 + 10) = *(uint *)(plVar3 + 10) >> 1;
        if ((*(uint *)(plVar3 + 10) & 0x100) == 0) {
          *(uint *)(plVar3 + 10) = local_res20[0] | 0xff00;
          pbVar8 = (byte *)plVar3[3];
          if (pbVar8 < (byte *)plVar3[2]) {
            local_res20[0] = *pbVar8;
            plVar3[3] = (longlong)(pbVar8 + 1);
          }
          else {
            uVar7 = FUN_18006a3f0(local_res20,param_1,(longlong)plVar3);
            if ((int)uVar7 != 1) {
              return 0xfffffffd;
            }
          }
        }
        bVar2 = local_res20[0];
        if ((*(byte *)(plVar3 + 10) & 1) == 0) {
          pbVar8 = (byte *)plVar3[3];
          if (pbVar8 < (byte *)plVar3[2]) {
            param_5 = *pbVar8;
            plVar3[3] = (longlong)(pbVar8 + 1);
          }
          else {
            uVar7 = FUN_18006a3f0(&param_5,param_1,(longlong)plVar3);
            if ((int)uVar7 != 1) {
              return 0xfffffffd;
            }
          }
          uVar11 = (uint)param_5;
          iVar5 = 0;
          do {
            bVar1 = *(byte *)((ulonglong)(((uVar11 & 0xf0) << 4 | (uint)bVar2) + iVar5 & 0xfff) +
                             *plVar3);
            local_res20[0] = bVar1;
            if ((byte *)plVar3[6] < (byte *)plVar3[5]) {
              *(byte *)plVar3[6] = bVar1;
              plVar3[6] = plVar3[6] + 1;
              *(int *)((longlong)plVar3 + 0x44) = *(int *)((longlong)plVar3 + 0x44) + 1;
            }
            else {
              *(int *)((longlong)plVar3 + 0x44) = *(int *)((longlong)plVar3 + 0x44) + 1;
              iVar6 = FUN_18006a490(bVar1,param_2,(longlong)plVar3);
              if (iVar6 != 1) {
                return CONCAT44(extraout_var_00,iVar6);
              }
            }
            iVar5 = iVar5 + 1;
            *(byte *)((longlong)*(int *)((longlong)plVar3 + 0x54) + *plVar3) = bVar1;
            *(uint *)((longlong)plVar3 + 0x54) = *(int *)((longlong)plVar3 + 0x54) + 1U & 0xfff;
          } while (iVar5 <= (int)((uVar11 & 0xf) + 2));
        }
        else {
          if ((byte *)plVar3[6] < (byte *)plVar3[5]) {
            *(byte *)plVar3[6] = local_res20[0];
            plVar3[6] = plVar3[6] + 1;
            *(int *)((longlong)plVar3 + 0x44) = *(int *)((longlong)plVar3 + 0x44) + 1;
          }
          else {
            *(int *)((longlong)plVar3 + 0x44) = *(int *)((longlong)plVar3 + 0x44) + 1;
            iVar5 = FUN_18006a490(local_res20[0],param_2,(longlong)plVar3);
            if (iVar5 != 1) {
              return CONCAT44(extraout_var,iVar5);
            }
          }
          *(byte *)((longlong)*(int *)((longlong)plVar3 + 0x54) + *plVar3) = bVar2;
          *(uint *)((longlong)plVar3 + 0x54) = *(int *)((longlong)plVar3 + 0x54) + 1U & 0xfff;
        }
        pbVar8 = (byte *)plVar3[3];
        if ((byte *)plVar3[2] <= pbVar8) break;
LAB_18006a374:
        local_res20[0] = *pbVar8;
        plVar3[3] = (longlong)(pbVar8 + 1);
      }
      uVar10 = FUN_18006a3f0(local_res20,param_1,(longlong)plVar3);
      iVar5 = (int)uVar10;
      if ((iVar5 != 1) && (iVar5 != 500)) {
        return uVar10;
      }
    } while (iVar5 != 500);
  }
  else if ((int)uVar10 != 500) {
    return uVar10;
  }
  return 1;
}



undefined8 FUN_18006a3f0(undefined *param_1,HFILE param_2,longlong param_3)

{
  undefined *puVar1;
  undefined uVar2;
  UINT UVar3;
  undefined8 uVar4;
  
  **(undefined **)(param_3 + 8) = *(undefined *)(*(longlong *)(param_3 + 0x10) + -1);
  UVar3 = _hread(param_2,(LPVOID)(*(longlong *)(param_3 + 8) + 1),*(UINT *)(param_3 + 0x48));
  if (UVar3 == *(UINT *)(param_3 + 0x48)) {
LAB_18006a444:
    puVar1 = *(undefined **)(param_3 + 8);
    *(undefined **)(param_3 + 0x18) = puVar1 + 1;
    if (*(int *)(param_3 + 0x38) == 0) {
      if (*(int *)(param_3 + 0x48) == 0) goto LAB_18006a468;
      uVar2 = puVar1[1];
      *(undefined **)(param_3 + 0x18) = puVar1 + 2;
    }
    else {
      uVar2 = *puVar1;
      *(undefined4 *)(param_3 + 0x38) = 0;
    }
    *param_1 = uVar2;
    uVar4 = 1;
  }
  else {
    if (UVar3 != 0xffffffff) {
      if (UVar3 == 0) {
        return 500;
      }
      *(ulonglong *)(param_3 + 0x10) = (ulonglong)UVar3 + *(longlong *)(param_3 + 8) + 1;
      goto LAB_18006a444;
    }
LAB_18006a468:
    uVar4 = 0xffffffff;
  }
  return uVar4;
}



undefined4 FUN_18006a490(undefined param_1,int param_2,longlong param_3)

{
  long lVar1;
  undefined4 uVar2;
  int lBytes;
  
  lBytes = *(int *)(param_3 + 0x30) - *(int *)(param_3 + 0x20);
  *(LPCCH *)(param_3 + 0x30) = *(LPCCH *)(param_3 + 0x20);
  if ((param_2 == -2) ||
     (lVar1 = _hwrite(param_2,*(LPCCH *)(param_3 + 0x20),lBytes), lVar1 == lBytes)) {
    **(undefined **)(param_3 + 0x30) = param_1;
    *(longlong *)(param_3 + 0x30) = *(longlong *)(param_3 + 0x30) + 1;
    uVar2 = 1;
  }
  else {
    uVar2 = 0xfffffffc;
    if (lVar1 == -1) {
      uVar2 = 0xfffffffe;
    }
  }
  return uVar2;
}



BYTE * FUN_18006a50c(BYTE *param_1)

{
  BOOL BVar1;
  BYTE *pBVar2;
  
  if (*NlsMbCodePageTag_exref != (code)0x0) {
    BVar1 = IsDBCSLeadByte(*param_1);
    if (BVar1 != 0) {
      param_1 = param_1 + 1;
    }
  }
  pBVar2 = param_1 + 1;
  if (*param_1 == '\0') {
    pBVar2 = param_1;
  }
  return pBVar2;
}



ushort FUN_18006a550(BYTE param_1)

{
  BOOL BVar1;
  BYTE local_res8 [8];
  WCHAR local_res10 [4];
  ushort local_res18 [8];
  
  local_res18[0] = 0;
  local_res10[0] = L'\0';
  local_res8[0] = param_1;
  if ((*NlsMbCodePageTag_exref != (code)0x0) && (BVar1 = IsDBCSLeadByte(param_1), BVar1 != 0)) {
    return 0;
  }
  RtlMultiByteToUnicodeN(local_res10,2,0,local_res8,1);
  GetStringTypeW(1,local_res10,1,local_res18);
  return local_res18[0] >> 1 & 1;
}



ushort FUN_18006a5dc(BYTE param_1)

{
  BOOL BVar1;
  BYTE local_res8 [8];
  WCHAR local_res10 [4];
  ushort local_res18 [8];
  
  local_res18[0] = 0;
  local_res10[0] = L'\0';
  local_res8[0] = param_1;
  if ((*NlsMbCodePageTag_exref != (code)0x0) && (BVar1 = IsDBCSLeadByte(param_1), BVar1 != 0)) {
    return 0;
  }
  RtlMultiByteToUnicodeN(local_res10,2,0,local_res8,1);
  GetStringTypeW(1,local_res10,1,local_res18);
  return local_res18[0] & 1;
}



void FUN_18006a664(undefined8 param_1,undefined4 *param_2,undefined4 param_3,int param_4)

{
  longlong in_GS_OFFSET;
  
  FUN_18006a6ac(*(longlong *)(*(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x20) + 0x10),
                param_1,param_2,param_3,param_4,(undefined4 *)0x0,0,(int *)0x0,0);
  return;
}



void FUN_18006a6ac(longlong param_1,undefined8 param_2,undefined4 *param_3,undefined4 param_4,
                  int param_5,undefined4 *param_6,uint param_7,int *param_8,uint param_9)

{
  uint uVar1;
  longlong *plVar2;
  ulonglong uVar3;
  uint uVar4;
  undefined auStack344 [32];
  undefined *local_138;
  undefined4 local_130;
  undefined8 *local_128;
  int local_120;
  undefined8 local_118;
  undefined4 local_110;
  undefined local_108 [16];
  undefined8 local_f8;
  uint local_f0;
  int local_ec;
  int local_e8 [2];
  undefined4 *local_e0;
  longlong local_d8 [20];
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack344;
  uVar3 = (ulonglong)param_7;
  uVar4 = param_9 + 2 + param_7;
  if ((uVar4 < 0xb) && (0 < param_1)) {
    local_f0 = param_7 + 1;
    *param_3 = param_4;
    param_3[1] = param_5;
    local_e8[0] = param_5 + 8;
    local_e0 = param_3;
    local_d8[(ulonglong)local_f0 * 2 + -1] = (longlong)(param_3 + 2);
    local_ec = param_9 + 1;
    local_e8[(ulonglong)local_f0 * 4] = param_5;
    if (param_7 != 0) {
      plVar2 = local_d8 + 1;
      do {
        *(undefined4 *)(plVar2 + -1) = *param_6;
        *plVar2 = *(longlong *)(param_6 + 2);
        plVar2 = plVar2 + 2;
        uVar3 = uVar3 - 1;
        param_6 = param_6 + 4;
      } while (uVar3 != 0);
    }
    uVar1 = 0;
    if (param_9 != 0) {
      do {
        uVar3 = (ulonglong)(param_7 + 2 + uVar1);
        uVar1 = uVar1 + 1;
        local_e8[uVar3 * 4] = *param_8;
        local_d8[uVar3 * 2 + -1] = *(longlong *)(param_8 + 2);
        param_8 = param_8 + 4;
      } while (uVar1 < param_9);
    }
    local_110 = 0;
    local_118 = 0;
    local_120 = (uVar4 + 1) * 0x10;
    local_128 = &local_f8;
    local_138 = local_108;
    local_130 = 0x500016;
    local_f8 = param_2;
    NtDeviceIoControlFile(param_1,0,0,0);
  }
  __security_check_cookie(local_38 ^ (ulonglong)auStack344);
  return;
}



void FUN_18006a818(undefined8 param_1,undefined4 *param_2,undefined4 param_3,int param_4,
                  undefined4 *param_5,uint param_6,int *param_7,uint param_8)

{
  longlong in_GS_OFFSET;
  
  FUN_18006a6ac(*(longlong *)(*(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x20) + 0x10),
                param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8);
  return;
}



void FUN_18006a87c(void)

{
  int iVar1;
  undefined auStack184 [32];
  undefined4 local_98;
  undefined *local_90;
  undefined8 local_88;
  undefined local_80 [8];
  undefined local_78 [16];
  undefined local_68 [16];
  undefined4 local_58 [2];
  undefined8 local_50;
  undefined *local_48;
  undefined4 local_40;
  undefined local_38 [16];
  undefined local_28 [24];
  ulonglong local_10;
  
  local_10 = DAT_1800b2220 ^ (ulonglong)auStack184;
  RtlInitUnicodeString(local_68,L"CorruptDetection");
  RtlInitUnicodeString(local_78,L"\\REGISTRY\\MACHINE\\SYSTEM\\CurrentControlSet\\Control\\WOW");
  local_48 = local_78;
  local_58[0] = 0x30;
  local_50 = 0;
  local_40 = 0x40;
  local_38 = ZEXT816(0);
  iVar1 = NtOpenKey(&local_88,0x20019,local_58);
  if (-1 < iVar1) {
    local_90 = local_80;
    local_98 = 0x14;
    NtQueryValueKey(local_88,local_68,2,local_28);
    NtClose(local_88);
  }
  __security_check_cookie(local_10 ^ (ulonglong)auStack184);
  return;
}



void FUN_18006a988(char param_1)

{
  int iVar1;
  wchar_t *pwVar2;
  undefined auStack184 [32];
  undefined4 local_98;
  undefined *local_90;
  undefined8 local_88;
  undefined local_80 [8];
  undefined local_78 [16];
  undefined local_68 [16];
  undefined4 local_58 [2];
  undefined8 local_50;
  undefined *local_48;
  undefined4 local_40;
  undefined local_38 [16];
  undefined local_28 [24];
  ulonglong local_10;
  
  local_10 = DAT_1800b2220 ^ (ulonglong)auStack184;
  pwVar2 = L"VDMDisallowed";
  if (param_1 == '\0') {
    pwVar2 = L"DisallowedPolicyDefault";
  }
  RtlInitUnicodeString(local_68,pwVar2);
  pwVar2 = L"\\REGISTRY\\MACHINE\\Software\\Policies\\Microsoft\\Windows\\AppCompat";
  if (param_1 == '\0') {
    pwVar2 = L"\\REGISTRY\\MACHINE\\SYSTEM\\CurrentControlSet\\Control\\WOW";
  }
  RtlInitUnicodeString(local_78,pwVar2);
  local_48 = local_78;
  local_58[0] = 0x30;
  local_50 = 0;
  local_40 = 0x40;
  local_38 = ZEXT816(0);
  iVar1 = NtOpenKey(&local_88,0x20019,local_58);
  if (-1 < iVar1) {
    local_90 = local_80;
    local_98 = 0x14;
    NtQueryValueKey(local_88,local_68,2,local_28);
    NtClose(local_88);
  }
  __security_check_cookie(local_10 ^ (ulonglong)auStack184);
  return;
}



undefined8 FUN_18006aac0(void)

{
  RtlInitializeCriticalSection(&DAT_1800b2f90);
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18006aae8(undefined8 param_1,undefined8 *param_2)

{
  REGHANDLE RegHandle;
  int iVar1;
  undefined8 uVar2;
  undefined8 uVar3;
  
  uVar3 = 0;
  uVar2 = 0;
  RtlRunOnceExecuteOnce(&DAT_1800b2f80,FUN_18006aac0);
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_1800b2f90);
  iVar1 = FUN_18001b7a4(&DAT_1800b20c8);
  if (-1 < iVar1) {
    FUN_180040c08((uint *)&DAT_1800b20c8,param_2,uVar2,uVar3);
    RegHandle = DAT_1800b20e8;
    DAT_1800b20e8 = 0;
    _DAT_1800b20c8 = 0;
    EventUnregister(RegHandle);
  }
                    // WARNING: Could not recover jumptable at 0x00018006ab71. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_1800b2f90);
  return;
}



int FUN_18006ab84(ushort *param_1,int param_2,uint *param_3)

{
  short *psVar1;
  byte bVar2;
  void *_Dst;
  wchar_t *pwVar3;
  short *psVar4;
  ulonglong uVar5;
  int iVar6;
  longlong in_GS_OFFSET;
  ushort local_18;
  short local_16;
  void *local_10;
  
  local_18 = *param_1;
  uVar5 = (ulonglong)local_18;
  iVar6 = 0xe;
  if (param_2 != 0) {
    psVar1 = *(short **)(param_1 + 4);
    iVar6 = 0x68;
    for (psVar4 = (short *)((longlong)psVar1 + (uVar5 - 2)); psVar1 <= psVar4; psVar4 = psVar4 + -1)
    {
      if ((*psVar4 == 0x5c) || (*psVar4 == 0x2f)) {
        psVar4 = psVar4 + 1;
        break;
      }
    }
    if (psVar4 < psVar1) {
      return -0x3ffffff3;
    }
    local_18 = (short)((longlong)psVar4 - (longlong)psVar1 >> 1) * 2;
    uVar5 = (ulonglong)local_18;
  }
  if (0xffff - iVar6 < (int)uVar5) {
    iVar6 = -0x3ffffefa;
  }
  else {
    local_16 = (short)uVar5 + (short)iVar6;
    _Dst = (void *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
    if (_Dst == (void *)0x0) {
      iVar6 = -0x3fffffe9;
    }
    else {
      memcpy(_Dst,*(void **)(param_1 + 4),(ulonglong)local_18);
      pwVar3 = L".Local";
      if (param_2 != 0) {
        pwVar3 = L"microsoft.system.package.metadata\\Application.Local";
      }
      local_10 = _Dst;
      iVar6 = RtlAppendUnicodeToString(&local_18,pwVar3);
      if (-1 < iVar6) {
        *(undefined2 *)((longlong)_Dst + (ulonglong)(local_18 >> 1) * 2) = 0;
        bVar2 = RtlDoesFileExists_U();
        *param_3 = (uint)bVar2;
      }
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,_Dst);
    }
  }
  return iVar6;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18006ace8(longlong *param_1,undefined8 param_2,longlong *param_3,undefined2 *param_4)

{
  longlong *plVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  uint uVar7;
  int iVar8;
  undefined auStack312 [32];
  undefined8 local_118;
  undefined8 local_110;
  undefined8 *local_108;
  undefined8 local_100;
  undefined4 local_f8;
  undefined4 local_f0;
  int local_e8 [2];
  ulonglong local_e0;
  undefined4 local_d8;
  undefined4 local_d4;
  longlong local_d0;
  ulonglong local_c8;
  ulonglong local_c0;
  undefined8 local_b8;
  undefined4 local_b0 [2];
  undefined8 local_a8;
  ulonglong *local_a0;
  undefined4 local_98;
  undefined local_90 [16];
  undefined local_80 [16];
  undefined local_70 [16];
  undefined8 local_60;
  undefined8 local_58;
  undefined8 local_50;
  ulonglong local_48;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStack312;
  local_60 = 0x18;
  local_50 = 0;
  local_d4 = 0;
  local_c8 = 0;
  local_e0 = 0;
  local_e8[0] = 0;
  local_d0 = 0;
  local_b8 = 0;
  local_58 = param_2;
  if (*param_3 == 0) {
    local_a0 = (ulonglong *)param_1[1];
    local_110 = (ulonglong *)CONCAT44(local_110._4_4_,0x60);
    local_b0[0] = 0x30;
    local_a8 = 0;
    local_90 = ZEXT816(0);
    local_98 = 0x40;
    local_118 = (ulonglong *)CONCAT44(local_118._4_4_,5);
    uVar7 = NtOpenFile(param_3,0x120089,local_b0,local_80);
    if ((int)uVar7 < 0) {
      if ((((uVar7 != 0xc0000204) && (2 < uVar7 + 0x3fffff77)) && (uVar7 != 0xc0000034)) &&
         ((uVar7 != 0xc000000f && (uVar7 != 0xc0150002)))) {
        local_110 = (ulonglong *)((ulonglong)local_110 & 0xffffffff00000000 | (ulonglong)uVar7);
        local_118 = local_a0;
        DbgPrintEx(0x33,0,"SXS: %s() NtOpenFile(%wZ) failed. Status = 0x%x\n",
                   "BasepSxsCreateResourceStreamFromFileHandle");
      }
      goto LAB_18006af6a;
    }
  }
  local_110 = &local_e0;
  local_100 = 0;
  local_108 = (undefined8 *)0x0;
  local_118 = &local_c8;
  iVar8 = LdrResSearchResource(*param_3,&local_60,3,0x8810);
  if ((-1 < iVar8) && (local_e0 < 0x800001)) {
    local_108 = (undefined8 *)0x0;
    plVar1 = param_3 + 2;
    local_110 = (ulonglong *)CONCAT44(local_110._4_4_,0x8000000);
    local_d8 = (undefined4)local_e0;
    local_118 = (ulonglong *)CONCAT44(local_118._4_4_,4);
    iVar8 = NtCreateSection(plVar1,6,0,&local_d8);
    if (-1 < iVar8) {
      local_108 = &local_b8;
      local_f0 = 4;
      local_f8 = 0;
      local_100 = CONCAT44(local_100._4_4_,2);
      local_110 = (ulonglong *)0x0;
      local_118 = (ulonglong *)0x0;
      iVar8 = NtMapViewOfSection(*plVar1,param_3[1],&local_d0,0);
      if (-1 < iVar8) {
        param_3[3] = local_d0;
        local_c0 = local_c8 & 0xffffffff;
        local_118 = (ulonglong *)CONCAT44(local_118._4_4_,0xe);
        iVar8 = NtSetInformationFile(*param_3,local_70,&local_c0,8);
        if (-1 < iVar8) {
          uVar7 = FUN_18006af94(*param_3,param_3[3],(undefined4)local_e0,local_e8);
          if ((-1 < (int)uVar7) && (local_e8[0] == (int)local_e0)) {
            *(longlong *)(param_4 + 0xc) = *param_3;
            *param_4 = 0x101;
            puVar2 = (undefined4 *)*param_1;
            uVar3 = *puVar2;
            uVar4 = puVar2[1];
            uVar5 = puVar2[2];
            uVar6 = puVar2[3];
            *(undefined *)(param_4 + 1) = 3;
            *(undefined4 *)(param_4 + 4) = uVar3;
            *(undefined4 *)(param_4 + 6) = uVar4;
            *(undefined4 *)(param_4 + 8) = uVar5;
            *(undefined4 *)(param_4 + 10) = uVar6;
            *(longlong *)(param_4 + 0x10) = *plVar1;
            *(undefined8 *)(param_4 + 0x14) = 0;
            *(ulonglong *)(param_4 + 0x18) = local_e0;
          }
        }
      }
    }
  }
LAB_18006af6a:
  __security_check_cookie(local_48 ^ (ulonglong)auStack312);
  return;
}



uint FUN_18006af94(undefined8 param_1,undefined8 param_2,undefined4 param_3,undefined4 *param_4)

{
  uint uVar1;
  undefined local_18 [8];
  undefined4 local_10;
  
  uVar1 = NtReadFile(param_1,0,0,0,local_18,param_2,param_3,0,0);
  if (uVar1 == 0x103) {
    uVar1 = NtWaitForSingleObject(param_1,0,0);
  }
  if ((int)uVar1 < 0) {
    if (uVar1 == 0xc0000011) {
      if (param_4 == (undefined4 *)0x0) {
        return 0xc0000011;
      }
      *param_4 = 0;
      return 0xc0000011;
    }
    if ((uVar1 & 0xc0000000) != 0x80000000) {
      return uVar1;
    }
  }
  if (param_4 != (undefined4 *)0x0) {
    *param_4 = local_10;
  }
  return uVar1;
}



bool FUN_18006b030(HMODULE param_1,undefined8 param_2,LPCWSTR param_3,undefined4 *param_4)

{
  bool bVar1;
  DWORD DVar2;
  int iVar3;
  HRSRC hResInfo;
  HMODULE _Str1;
  HMODULE pHVar4;
  undefined **ppuVar5;
  uint uVar6;
  
  bVar1 = false;
  hResInfo = FindResourceW(param_1,param_3,(LPCWSTR)&DAT_00000018);
  if (hResInfo != (HRSRC)0x0) {
    _Str1 = (HMODULE)LoadResource(param_1,hResInfo);
    DVar2 = SizeofResource(param_1,hResInfo);
    pHVar4 = (HMODULE)((longlong)&_Str1->unused + (ulonglong)DVar2);
    if (((param_1 <= _Str1) && (param_1 <= pHVar4)) && (DVar2 != 0)) {
      for (; _Str1 < pHVar4; _Str1 = (HMODULE)((longlong)&_Str1->unused + 1)) {
        if (bVar1) {
          return !bVar1;
        }
        uVar6 = 0;
        ppuVar5 = &PTR_s_JR_Inno_Setup_18007fc98;
        do {
          if (bVar1) break;
          if (((HMODULE)((longlong)&_Str1->unused + (ulonglong)*(uint *)(ppuVar5 + -1)) < pHVar4) &&
             (iVar3 = _strnicmp((char *)_Str1,*ppuVar5,(ulonglong)*(uint *)(ppuVar5 + -1)),
             iVar3 == 0)) {
            *param_4 = 1;
            bVar1 = true;
          }
          uVar6 = uVar6 + 1;
          ppuVar5 = ppuVar5 + 3;
        } while (uVar6 < 8);
      }
    }
  }
  return !bVar1;
}



uint FUN_18006b134(uint param_1)

{
  if (0 < (int)param_1) {
    param_1 = param_1 & 0xffff | 0x80070000;
  }
  if (-1 < (int)param_1) {
    param_1 = 0x80004005;
  }
  return param_1;
}



uint FUN_18006b158(short *param_1,ulonglong param_2,undefined8 param_3)

{
  uint uVar1;
  ulonglong uVar2;
  
  uVar2 = param_2 >> 1;
  uVar1 = 0;
  if (0x7ffffffe < uVar2 - 1) {
    uVar1 = 0x80070057;
  }
  if ((int)uVar1 < 0) {
    if (uVar2 != 0) {
      *param_1 = 0;
    }
  }
  else {
    uVar1 = FUN_18001cf74(param_1,uVar2,param_3,param_3);
  }
  return uVar1;
}



undefined8 FUN_18006b1a4(undefined8 *param_1)

{
  int iVar1;
  uint uVar2;
  longlong lVar3;
  undefined8 uVar4;
  char *pcVar5;
  undefined8 uVar6;
  
  uVar4 = 0x80004005;
  if (param_1 == (undefined8 *)0x0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid args\n",900);
    uVar4 = 0x80070057;
  }
  else {
    lVar3 = FUN_18001ce80();
    if (lVar3 == 0) {
      uVar6 = 0x38c;
      pcVar5 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
    }
    else {
      iVar1 = FUN_18001ce14();
      if (-1 < iVar1) {
        lVar3 = *(longlong *)(lVar3 + 0x358);
        if ((lVar3 == 0) || (uVar2 = FUN_18001cc84(lVar3), (int)uVar2 < 0)) {
          DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid PEB entry\n",0x39e);
        }
        else if (*(uint *)(lVar3 + 0x908) < 0x200) {
          *param_1 = *(undefined8 *)(lVar3 + 0x8e8);
          *(undefined8 **)(lVar3 + 0x8e8) = param_1;
          LOCK();
          *(int *)(lVar3 + 0x908) = *(int *)(lVar3 + 0x908) + 1;
          uVar4 = 0;
        }
        else {
          uVar4 = 0x8007007a;
        }
        RtlReleasePebLock();
        return uVar4;
      }
      uVar6 = 0x394;
      pcVar5 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
    }
    DbgPrintEx(0x96,0,pcVar5,uVar6);
  }
  return uVar4;
}



undefined8 FUN_18006b2e4(undefined8 *param_1,undefined4 *param_2)

{
  short sVar1;
  short sVar2;
  longlong lVar3;
  undefined8 *puVar4;
  int iVar5;
  uint uVar6;
  longlong lVar7;
  longlong *plVar8;
  longlong *plVar9;
  undefined8 *puVar10;
  undefined8 *puVar11;
  undefined8 uVar12;
  char *pcVar13;
  
  uVar12 = 0x80004005;
  if ((param_1 == (undefined8 *)0x0) || (param_2 == (undefined4 *)0x0)) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid args\n",0x1454);
    return 0x80070057;
  }
  *param_2 = 0;
  lVar7 = FUN_18001ce80();
  if (lVar7 == 0) {
    uVar12 = 0x145e;
    pcVar13 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
  }
  else {
    iVar5 = FUN_18001ce14();
    if (-1 < iVar5) {
      lVar7 = *(longlong *)(lVar7 + 0x358);
      if ((lVar7 == 0) || (uVar6 = FUN_18001cc84(lVar7), (int)uVar6 < 0)) {
        DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid PEB entry\n",0x1470);
      }
      else {
        plVar9 = *(longlong **)(lVar7 + 0x8f8);
        if (plVar9 == (longlong *)0x0) {
          *param_1 = 0;
          *(undefined8 **)(lVar7 + 0x8f8) = param_1;
        }
        else {
          do {
            plVar8 = plVar9 + 3;
            lVar3 = 0x18 - (longlong)plVar8;
            do {
              sVar1 = *(short *)plVar8;
              sVar2 = *(short *)((longlong)plVar8 + (longlong)param_1 + lVar3);
              if (sVar1 != sVar2) break;
              plVar8 = (longlong *)((longlong)plVar8 + 2);
            } while (sVar2 != 0);
            if ((sVar1 == sVar2) && (plVar9[2] == param_1[2])) {
              *param_2 = 1;
              goto LAB_18006b39b;
            }
            plVar9 = (longlong *)*plVar9;
          } while (plVar9 != (longlong *)0x0);
          uVar6 = 0;
          puVar4 = *(undefined8 **)(lVar7 + 0x8f8);
          puVar11 = (undefined8 *)0x0;
          while (puVar10 = puVar4, puVar10 != (undefined8 *)0x0) {
            uVar6 = uVar6 + 1;
            puVar11 = puVar10;
            puVar4 = (undefined8 *)*puVar10;
          }
          if (0xf < uVar6) {
            uVar12 = 0x8007007a;
            goto LAB_18006b44d;
          }
          if (puVar11 == (undefined8 *)0x0) {
            *(undefined8 **)(lVar7 + 0x8f8) = param_1;
          }
          else {
            *puVar11 = param_1;
          }
          *param_1 = 0;
        }
LAB_18006b39b:
        uVar12 = 0;
      }
LAB_18006b44d:
      RtlReleasePebLock();
      return uVar12;
    }
    uVar12 = 0x1466;
    pcVar13 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
  }
  DbgPrintEx(0x96,0,pcVar13,uVar12);
  return 0x80004005;
}



void FUN_18006b49a(void)

{
                    // WARNING: Could not recover jumptable at 0x00018006b4a8. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlReleasePebLock();
  return;
}



DWORD FUN_18006b4bc(HANDLE param_1,LPVOID param_2)

{
  BOOL BVar1;
  DWORD DVar2;
  uint uVar3;
  HANDLE hProcess;
  char *pcVar4;
  undefined8 uVar5;
  bool bVar6;
  uint local_res8 [2];
  uint local_res18 [2];
  LPCVOID local_res20;
  
  local_res20 = (LPCVOID)0x0;
  local_res8[0] = 0;
  local_res18[0] = 0;
  if ((param_1 == (HANDLE)0x0) || (param_2 == (LPVOID)0x0)) {
    uVar5 = 0xc3b;
    pcVar4 = "WER/CrashAPI:%u: ERROR Invalid arguments\n";
LAB_18006b6cd:
    DbgPrintEx(0x96,0,pcVar4,uVar5);
    DVar2 = 0x80070057;
  }
  else {
    BVar1 = IsWow64Process(param_1,(PBOOL)local_res8);
    local_res8[0] = local_res8[0] & -(uint)(BVar1 != 0);
    bVar6 = local_res8[0] == 0;
    hProcess = GetCurrentProcess();
    BVar1 = IsWow64Process(hProcess,(PBOOL)local_res18);
    local_res18[0] = local_res18[0] & -(uint)(BVar1 != 0);
    if (local_res18[0] == 0) {
LAB_18006b569:
      if (local_res8[0] == 0) goto LAB_18006b56d;
      DVar2 = FUN_18006ba10(param_1,&local_res20);
      if (-1 < (int)DVar2) goto LAB_18006b5df;
      uVar5 = 0xc92;
    }
    else {
      BVar1 = IsWow64Process(param_1,(PBOOL)local_res8);
      local_res8[0] = -(uint)(BVar1 != 0) & local_res8[0];
      bVar6 = false;
      if (local_res8[0] != 0) goto LAB_18006b569;
      bVar6 = true;
LAB_18006b56d:
      if ((local_res18[0] != 0) && (bVar6)) {
        uVar5 = 0xc6a;
        pcVar4 = "WER/CrashAPI:%u: ERROR Failed to read the peb from the process\n";
        goto LAB_18006b6cd;
      }
      DVar2 = FUN_18006bb68(param_1,&local_res20);
      if (-1 < (int)DVar2) {
LAB_18006b5df:
        if (local_res20 == (LPCVOID)0x0) {
          return 0x80070490;
        }
        if ((local_res18[0] != 0) && (bVar6)) {
          DbgPrintEx(0x96,0,
                     "WER/CrashAPI:%u: ERROR WerpNtWow64ReadVirtualMemory64 failed while trying to read PebBaseAddress\n"
                     ,0xcaf);
          return 0xd0000001;
        }
        BVar1 = ReadProcessMemory(param_1,local_res20,param_2,0x968,(SIZE_T *)0x0);
        if (BVar1 != 0) {
          uVar3 = FUN_18001cc84((longlong)param_2);
          if ((int)uVar3 < 0) {
            DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpValidatePebHeader failed\n",0xcc7);
            return 0x80004005;
          }
          *(undefined2 *)((longlong)param_2 + 0x8a6) = 0;
          return 0;
        }
        DbgPrintEx(0x96,0,
                   "WER/CrashAPI:%u: ERROR ReadProcessMemory failed while trying to read WerRegistrationData\n"
                   ,0xcbe);
        DVar2 = GetLastError();
        if ((int)DVar2 < 1) {
          return DVar2;
        }
        return DVar2 & 0xffff | 0x80070000;
      }
      uVar5 = 0xc7f;
    }
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Failed to read the peb from the process\n",uVar5);
  }
  return DVar2;
}



wchar_t * FUN_18006b700(void)

{
  int iVar1;
  uint uVar2;
  longlong lVar3;
  wchar_t *pwVar4;
  char *pcVar5;
  undefined8 uVar6;
  
  pwVar4 = (wchar_t *)0x0;
  lVar3 = FUN_18001ce80();
  if (lVar3 == 0) {
    uVar6 = 0x3d0;
    pcVar5 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
  }
  else {
    iVar1 = FUN_18001ce14();
    if (-1 < iVar1) {
      lVar3 = *(longlong *)(lVar3 + 0x358);
      if ((lVar3 == 0) || (uVar2 = FUN_18001cc84(lVar3), (int)uVar2 < 0)) {
        DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid PEB entry\n",0x3e0);
      }
      else {
        pwVar4 = (wchar_t *)(lVar3 + 0x918);
        uVar2 = FUN_18006e7c4(pwVar4);
        if ((int)uVar2 < 0) {
          DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid Heap\n",0x3eb);
          pwVar4 = (wchar_t *)0x0;
        }
      }
      RtlReleasePebLock();
      return pwVar4;
    }
    uVar6 = 0x3d6;
    pcVar5 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
  }
  DbgPrintEx(0x96,0,pcVar5,uVar6);
  return (wchar_t *)0x0;
}



undefined8 FUN_18006b804(int **param_1)

{
  int iVar1;
  uint uVar2;
  longlong lVar3;
  char *pcVar4;
  undefined8 uVar5;
  
  uVar5 = 0;
  if (param_1 == (int **)0x0) {
    return 0x80070057;
  }
  *param_1 = (int *)0x0;
  lVar3 = FUN_18001ce80();
  if (lVar3 == 0) {
    uVar5 = 0xeee;
    pcVar4 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
  }
  else {
    iVar1 = FUN_18001ce14();
    if (-1 < iVar1) {
      lVar3 = *(longlong *)(lVar3 + 0x358);
      if ((lVar3 == 0) || (uVar2 = FUN_18001cc84(lVar3), (int)uVar2 < 0)) {
        DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid PEB entry\n",0xefe);
        uVar5 = 0x80004005;
      }
      else if (*(int *)(lVar3 + 0x8a8) == 0x40) {
        *param_1 = (int *)(lVar3 + 0x8a8);
      }
      else {
        DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid handle passed\n",0xf05);
        uVar5 = 0x80070006;
      }
      RtlReleasePebLock();
      return uVar5;
    }
    uVar5 = 0xef4;
    pcVar4 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
  }
  DbgPrintEx(0x96,0,pcVar4,uVar5);
  return 0x80004005;
}



uint FUN_18006b92c(longlong param_1)

{
  uint uVar1;
  ulonglong uVar2;
  undefined8 local_48 [7];
  uint local_10;
  
  if (param_1 != 0) {
    memset(local_48,0,0x40);
    uVar2 = 0;
    local_48[0] = 0x40;
    uVar1 = NtQueryInformationProcess(param_1,0,local_48,0x40,0);
    if (-1 < (int)uVar1) {
      return local_10 & 1;
    }
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR NtQueryInformationProcess failed with status: 0x%x\n",
               0x1050,uVar2 & 0xffffffff00000000 | (ulonglong)uVar1);
  }
  return 0;
}



short * FUN_18006b9b8(short *param_1)

{
  longlong lVar1;
  short *psVar2;
  short *psVar3;
  
  if (param_1 == (short *)0x0) {
    return (short *)0x0;
  }
  lVar1 = -1;
  do {
    lVar1 = lVar1 + 1;
  } while (param_1[lVar1] != 0);
  psVar2 = param_1 + lVar1;
  do {
    psVar3 = psVar2;
    if (psVar3 <= param_1) {
      return psVar3;
    }
    psVar2 = psVar3 + -1;
  } while ((0x2d < (ushort)(*psVar2 - 0x2fU)) ||
          ((0x200000000801U >> ((ulonglong)(ushort)(*psVar2 - 0x2fU) & 0x3f) & 1) == 0));
  return psVar3;
}



DWORD FUN_18006ba10(HANDLE param_1,LPVOID param_2)

{
  uint uVar1;
  BOOL BVar2;
  DWORD DVar3;
  longlong local_res8;
  ulonglong uVar4;
  
  local_res8 = 0;
  if ((param_1 == (HANDLE)0x0) || (param_2 == (LPVOID)0x0)) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid arg\n",0xb58);
    DVar3 = 0x80070057;
  }
  else {
    uVar4 = 0;
    uVar1 = NtQueryInformationProcess(param_1,0x1a,&local_res8,8,0);
    if ((int)uVar1 < 0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR NtQueryInformationProcess failed with status 0x%x\n"
                 ,0xb65,uVar4 & 0xffffffff00000000 | (ulonglong)uVar1);
      DVar3 = uVar1 | 0x10000000;
    }
    else if (local_res8 == 0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR No 32 PEB for process\n",0xb6d);
      DVar3 = 0x80004005;
    }
    else {
      BVar2 = ReadProcessMemory(param_1,(LPCVOID)(local_res8 + 0x230),param_2,8,(SIZE_T *)0x0);
      if (BVar2 == 0) {
        DbgPrintEx(0x96,0,
                   "WER/CrashAPI:%u: ERROR ReadProcessMemory failed while trying to read Peb32BaseAddress\n"
                   ,0xb77);
        DVar3 = GetLastError();
        if (0 < (int)DVar3) {
          DVar3 = DVar3 & 0xffff | 0x80070000;
        }
      }
      else {
        DVar3 = 0;
      }
    }
  }
  return DVar3;
}



DWORD FUN_18006bb68(HANDLE param_1,LPVOID param_2)

{
  int iVar1;
  BOOL BVar2;
  DWORD DVar3;
  undefined local_38 [8];
  longlong local_30;
  
  if ((param_1 == (HANDLE)0x0) || (param_2 == (LPVOID)0x0)) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid arg\n",0xbf6);
    DVar3 = 0x80070057;
  }
  else {
    iVar1 = NtQueryInformationProcess(param_1,0,local_38,0x30,0);
    if (iVar1 < 0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR NtQueryInformationProcess failed\n",0xc00);
      DVar3 = 0x80070006;
    }
    else if (local_30 == 0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR No PEB for process\n",0xc08);
      DVar3 = 0x80004005;
    }
    else {
      BVar2 = ReadProcessMemory(param_1,(LPCVOID)(local_30 + 0x358),param_2,8,(SIZE_T *)0x0);
      if (BVar2 == 0) {
        DbgPrintEx(0x96,0,
                   "WER/CrashAPI:%u: ERROR ReadProcessMemory failed while trying to read PebBaseAddress\n"
                   ,0xc12);
        DVar3 = GetLastError();
        if (0 < (int)DVar3) {
          DVar3 = DVar3 & 0xffff | 0x80070000;
        }
      }
      else {
        DVar3 = 0;
      }
    }
  }
  return DVar3;
}



ulonglong FUN_18006bca8(longlong param_1,uint param_2)

{
  bool bVar1;
  int iVar2;
  undefined7 extraout_var;
  wchar_t *pwVar3;
  undefined (*pauVar4) [16];
  ulonglong uVar5;
  char *pcVar6;
  undefined4 uVar7;
  undefined8 uVar8;
  undefined8 uVar9;
  wchar_t *pwVar10;
  
  uVar5 = 0x80004005;
  uVar7 = 0x80004005;
  pauVar4 = (undefined (*) [16])0x0;
  uVar8 = 0;
  uVar9 = 0;
  if ((param_1 == 0) || (param_2 == 0)) {
    uVar8 = 0xa5b;
    pcVar6 = "WER/CrashAPI:%u: ERROR Invalid args passed\n";
  }
  else {
    if (param_2 < 0x10001) {
      bVar1 = FUN_18002189c();
      if ((int)CONCAT71(extraout_var,bVar1) == 0) {
        DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid state\n",0xa69,uVar7,uVar8,uVar9);
        return 0x8007139f;
      }
      iVar2 = FUN_18001ccd4();
      if (iVar2 < 0) {
        DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpInitPEBStore failed\n",0xa6f,uVar7,uVar8,uVar9
                  );
        return 0x80004005;
      }
      FUN_18006dd48(param_1);
      pwVar3 = FUN_18006b700();
      if (pwVar3 == (wchar_t *)0x0) {
        DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpGetHeapHandle returned NULL\n",0xa86,uVar7,
                   uVar8,0);
      }
      else {
        pwVar10 = pwVar3;
        pauVar4 = (undefined (*) [16])FUN_18006e27c((longlong)pwVar3,0x20);
        if (pauVar4 == (undefined (*) [16])0x0) {
          DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR OOM\n",0xa90,uVar7,0,pwVar10);
          uVar5 = 0x8007000e;
        }
        else {
          *pauVar4 = ZEXT816(0);
          pauVar4[1] = ZEXT816(0);
          *(ushort *)(*pauVar4 + 8) = *(ushort *)(*pauVar4 + 8) & 0x3fff;
          *(longlong *)pauVar4[1] = param_1;
          *(uint *)(pauVar4[1] + 8) = param_2;
          *(ushort *)(*pauVar4 + 8) = *(ushort *)(*pauVar4 + 8) & 0xc020;
          *(ushort *)(*pauVar4 + 8) = *(ushort *)(*pauVar4 + 8) | 0x20;
          uVar5 = FUN_18006b1a4((undefined8 *)pauVar4);
          uVar5 = uVar5 & 0xffffffff;
        }
      }
      if (-1 < (int)uVar5) {
        return uVar5;
      }
      if (pauVar4 == (undefined (*) [16])0x0) {
        return uVar5;
      }
      FUN_18006e550((longlong)pwVar3,(longlong)pauVar4);
      return uVar5;
    }
    uVar8 = 0xa63;
    pcVar6 = "WER/CrashAPI:%u: ERROR Invalid args, too  big block\n";
  }
  DbgPrintEx(0x96,0,pcVar6,uVar8,0x80004005,0,0);
  return 0x80070057;
}



void FUN_18006be89(undefined8 param_1,longlong param_2)

{
  if ((*(int *)(param_2 + 0x20) < 0) && (*(longlong *)(param_2 + 0x28) != 0)) {
    FUN_18006e550(*(longlong *)(param_2 + 0x30),*(longlong *)(param_2 + 0x28));
    *(undefined8 *)(param_2 + 0x28) = 0;
  }
  return;
}



undefined8 FUN_18006bebc(longlong param_1,undefined8 *param_2,undefined8 *param_3)

{
  wchar_t *pwVar1;
  undefined8 uVar2;
  undefined8 uVar3;
  
  uVar3 = 0;
  if ((param_1 == 0) || (param_2 == (undefined8 *)0x0)) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid args\n",0x5ec);
    uVar3 = 0x80070057;
  }
  else {
    LOCK();
    *(int *)(param_1 + 0x908) = *(int *)(param_1 + 0x908) + -1;
    if (param_3 == (undefined8 *)0x0) {
      *(undefined8 *)(param_1 + 0x8e8) = *param_2;
    }
    else {
      *param_3 = *param_2;
    }
    pwVar1 = FUN_18006b700();
    if (pwVar1 == (wchar_t *)0x0) {
      uVar3 = 0x80004005;
    }
    else {
      uVar2 = FUN_18006e550((longlong)pwVar1,(longlong)param_2);
      if ((int)uVar2 == 0) {
        uVar3 = 0x80004005;
        DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpHeapFree failed with 0x%x\n",0x603,0x80004005)
        ;
      }
    }
  }
  return uVar3;
}



undefined4 FUN_18006bf74(wchar_t *param_1,undefined8 *param_2,undefined8 *param_3)

{
  uint uVar1;
  int iVar2;
  longlong lVar3;
  undefined4 uVar4;
  undefined8 *puVar5;
  undefined8 *puVar6;
  
  uVar4 = 0x80070490;
  if (param_2 == (undefined8 *)0x0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid args\n",0x518);
    uVar4 = 0x80070057;
  }
  else {
    lVar3 = FUN_18001ce80();
    lVar3 = *(longlong *)(lVar3 + 0x358);
    if ((lVar3 == 0) || (uVar1 = FUN_18001cc84(lVar3), (int)uVar1 < 0)) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR PEB is not initialized\n",0x524);
    }
    else {
      puVar5 = (undefined8 *)0x0;
      for (puVar6 = *(undefined8 **)(lVar3 + 0x8e8); puVar6 != (undefined8 *)0x0;
          puVar6 = (undefined8 *)*puVar6) {
        if (((*(ushort *)(puVar6 + 1) & 0xc000) == 0x4000) &&
           (iVar2 = _wcsnicmp((wchar_t *)((longlong)puVar6 + 0x12),param_1,0x104), iVar2 == 0)) {
          if (param_3 != (undefined8 *)0x0) {
            *param_3 = puVar5;
          }
          *param_2 = puVar6;
          if (puVar6 != (undefined8 *)0x0) {
            return 0;
          }
          break;
        }
        puVar5 = puVar6;
      }
      uVar4 = 0x80070490;
    }
  }
  return uVar4;
}



bool FUN_18006c098(int **param_1)

{
  return **param_1 == -0x3ffffffb;
}



undefined8 FUN_18006c0c0(longlong param_1,undefined8 *param_2,undefined8 *param_3)

{
  undefined8 *puVar1;
  uint uVar2;
  longlong lVar3;
  undefined8 *puVar4;
  undefined8 *puVar5;
  undefined8 uVar6;
  
  uVar6 = 0x80004005;
  if (param_2 == (undefined8 *)0x0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid args\n",0x417);
    uVar6 = 0x80070057;
  }
  else {
    lVar3 = FUN_18001ce80();
    lVar3 = *(longlong *)(lVar3 + 0x358);
    if ((lVar3 == 0) || (uVar2 = FUN_18001cc84(lVar3), (int)uVar2 < 0)) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR PEB is not initialized\n",0x423);
    }
    else {
      puVar1 = *(undefined8 **)(lVar3 + 0x8e8);
      puVar5 = (undefined8 *)0x0;
      while (puVar4 = puVar1, puVar4 != (undefined8 *)0x0) {
        if (((*(ushort *)(puVar4 + 1) & 0xc000) == 0) && (puVar4[2] == param_1)) {
          if (param_3 != (undefined8 *)0x0) {
            *param_3 = puVar5;
          }
          *param_2 = puVar4;
          if (puVar4 != (undefined8 *)0x0) {
            return 0;
          }
          break;
        }
        puVar5 = puVar4;
        puVar1 = (undefined8 *)*puVar4;
      }
      uVar6 = 0x80070490;
    }
  }
  return uVar6;
}



// WARNING: Could not reconcile some variable overlaps

uint WerpGetDebugger(longlong param_1,uint *param_2)

{
  uint *puVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  LPVOID _Dst;
  undefined *puVar5;
  undefined4 local_res8 [2];
  longlong local_res18 [2];
  undefined8 in_stack_ffffffffffffff88;
  undefined4 uVar8;
  ulonglong uVar6;
  undefined8 uVar7;
  undefined local_68 [16];
  undefined local_58 [12];
  undefined4 uStack76;
  undefined local_48 [16];
  
                    // 0x6c1d0  1549  WerpGetDebugger
  uVar8 = (undefined4)((ulonglong)in_stack_ffffffffffffff88 >> 0x20);
  local_res18[0] = 0;
  local_res8[0] = 0;
  local_68 = ZEXT816(0);
  _local_58 = ZEXT816(0);
  local_48 = ZEXT816(0);
  if ((param_1 == 0) || (param_2 == (uint *)0x0)) {
    uVar3 = 0x80070057;
  }
  else {
    memset(param_2,0,0x250);
    _Dst = VirtualAlloc((LPVOID)0x0,0x25a,0x1000,4);
    if (_Dst == (LPVOID)0x0) {
      uVar3 = 0x8007000e;
    }
    else {
      uVar2 = FUN_18006b92c(param_1);
      puVar5 = &DAT_180080740;
      local_68 = CONCAT124(SUB1612(local_68 >> 0x20,0) &
                           SUB1612((undefined  [16])0xffffffffffffffff >> 0x20,0),0x30);
      local_48 = ZEXT816(0);
      if (uVar2 == 0) {
        puVar5 = &DAT_180080750;
      }
      _local_58 = CONCAT88(stack0xffffffffffffffb0,puVar5);
      uVar3 = NtOpenKey(local_res18,1,local_68);
      if ((int)uVar3 < 0) {
        uVar3 = uVar3 | 0x10000000;
      }
      else {
        memset(_Dst,0,0x25a);
        puVar5 = &DAT_1800806f0;
        if (uVar2 == 0) {
          puVar5 = &DAT_180080700;
        }
        uVar6 = CONCAT44(uVar8,0x25a);
        iVar4 = NtQueryValueKey(local_res18[0],puVar5,2,_Dst,uVar6,local_res8);
        if ((iVar4 < 0) || (*(int *)((longlong)_Dst + 4) != 1)) {
          uVar3 = 0x80070490;
        }
        else {
          puVar1 = (uint *)((longlong)_Dst + 0xc);
          uVar3 = FUN_18001cf30((short *)(param_2 + 1),0x125,puVar1);
          uVar8 = (undefined4)(uVar6 >> 0x20);
          if ((int)uVar3 < 0) {
            DbgPrintEx(0x96,0,
                       "WER/CrashAPI:%u: ERROR Stringcchcopy failed while copying the debugger path 0x%x\n"
                       ,0x1141,uVar6 & 0xffffffff00000000 | (ulonglong)uVar3);
          }
          else {
            uVar3 = *param_2;
            *param_2 = uVar3 | 1;
            if (uVar2 != 0) {
              *param_2 = uVar3 | 0x7d;
              memset(_Dst,0,0x25a);
              uVar7 = CONCAT44(uVar8,0x25a);
              iVar4 = NtQueryValueKey(local_res18[0],&DAT_1800806e0,2,_Dst,uVar7,local_res8);
              uVar8 = (undefined4)((ulonglong)uVar7 >> 0x20);
              if ((-1 < iVar4) && (*(int *)((longlong)_Dst + 4) == 4)) {
                *param_2 = ~-(uint)(*puVar1 != 0) & 4 | *param_2 & 0xfffffffb;
              }
              if ((*(byte *)param_2 & 4) != 0) {
                memset(_Dst,0,0x25a);
                uVar7 = CONCAT44(uVar8,0x25a);
                iVar4 = NtQueryValueKey(local_res18[0],&DAT_180080730,2,_Dst,uVar7,local_res8);
                uVar8 = (undefined4)((ulonglong)uVar7 >> 0x20);
                if ((-1 < iVar4) && (*(int *)((longlong)_Dst + 4) == 4)) {
                  uVar3 = *puVar1;
                  uVar2 = *param_2;
                  if (uVar3 < 8) {
                    *param_2 = (uVar3 << 3 ^ uVar2) & 0x78 ^ uVar2;
                  }
                  else {
                    if (uVar3 == 0x80000000) {
                      uVar2 = uVar2 & 0xfffffff7 | 0x70;
                    }
                    else {
                      uVar2 = uVar2 | 0x78;
                    }
                    *param_2 = uVar2;
                  }
                }
              }
            }
            memset(_Dst,0,0x25a);
            uVar6 = CONCAT44(uVar8,0x25a);
            uVar3 = 2;
            iVar4 = NtQueryValueKey(local_res18[0],&DAT_1800806d0,2,_Dst,uVar6,local_res8);
            if (((iVar4 < 0) ||
                (((*(int *)((longlong)_Dst + 4) != 1 || (*(short *)puVar1 != 0x31)) &&
                 ((*(int *)((longlong)_Dst + 4) != 4 || (*puVar1 == 0)))))) ||
               (iVar4 = FUN_18006c9a0(param_1), iVar4 != 0)) {
              uVar3 = 0;
            }
            uVar2 = *param_2;
            *param_2 = uVar2 & 0xfffffffd | uVar3;
            uVar6 = uVar6 & 0xffffffff00000000 | (ulonglong)(uVar2 & 1);
            DbgPrintEx(0x96,2,"WER/CrashAPI:%u: TRACE WERP_DEBUGGER_INFO.Available: %u\n",0x11a6,
                       uVar6);
            uVar6 = uVar6 & 0xffffffff00000000 | (ulonglong)(*param_2 >> 1) & 0xffffffff00000001;
            DbgPrintEx(0x96,2,"WER/CrashAPI:%u: TRACE WERP_DEBUGGER_INFO.AutoEnabled: %u\n",0x11a7,
                       uVar6);
            uVar6 = uVar6 & 0xffffffff00000000 | (ulonglong)(*param_2 >> 2) & 0xffffffff00000001;
            DbgPrintEx(0x96,2,"WER/CrashAPI:%u: TRACE WERP_DEBUGGER_INFO.Protected: %u\n",0x11a8,
                       uVar6);
            DbgPrintEx(0x96,2,"WER/CrashAPI:%u: TRACE WERP_DEBUGGER_INFO.ProtectionLevel: %08X\n",
                       0x11a9,uVar6 & 0xffffffff00000000 |
                              (ulonglong)(*param_2 >> 3) & 0xffffffff0000000f);
            DbgPrintEx(0x96,2,"WER/CrashAPI:%u: TRACE WERP_DEBUGGER_INFO.Debugger: %S\n",0x11aa,
                       param_2 + 1);
            uVar3 = 0;
          }
        }
      }
    }
    if (local_res18[0] != 0) {
      NtClose();
    }
    if (_Dst != (LPVOID)0x0) {
      VirtualFree(_Dst,0,0x8000);
    }
  }
  return uVar3;
}



void FUN_18006c5f4(HANDLE param_1,undefined4 *param_2)

{
  undefined auStack2488 [32];
  DWORD local_998;
  undefined local_988 [2324];
  undefined4 local_74;
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStack2488;
  memset(local_988,0,0x968);
  if ((param_1 == (HANDLE)0x0) || (param_2 == (undefined4 *)0x0)) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid params\n",0x1013);
  }
  else {
    local_998 = FUN_18006b4bc(param_1,local_988);
    if (-1 < (int)local_998) {
      *param_2 = local_74;
      local_998 = 0;
    }
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStack2488);
  return;
}



bool FUN_18006c6a8(int **param_1)

{
  return **param_1 == -0x3ffffffb;
}



DWORD FUN_18006c6d0(HANDLE param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  DWORD DVar4;
  LPVOID _Dst;
  
  if ((param_1 == (HANDLE)0x0) || (param_2 == (undefined4 *)0x0)) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid args\n",0xe06);
    DVar4 = 0x80070057;
  }
  else {
    _Dst = VirtualAlloc((LPVOID)0x0,0x968,0x1000,4);
    if (_Dst == (LPVOID)0x0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR OOM\n",0xe15);
      DVar4 = 0x8007000e;
    }
    else {
      memset(_Dst,0,0x968);
      memset(param_2,0,0x40);
      DVar4 = FUN_18006b4bc(param_1,_Dst);
      if (-1 < (int)DVar4) {
        if (*(longlong *)((longlong)_Dst + 0x8b0) == 0) {
          DVar4 = 0x80070490;
        }
        else {
          uVar1 = *(undefined4 *)((longlong)_Dst + 0x8ac);
          uVar2 = *(undefined4 *)((longlong)_Dst + 0x8b0);
          uVar3 = *(undefined4 *)((longlong)_Dst + 0x8b4);
          *param_2 = *(undefined4 *)((longlong)_Dst + 0x8a8);
          param_2[1] = uVar1;
          param_2[2] = uVar2;
          param_2[3] = uVar3;
          uVar1 = *(undefined4 *)((longlong)_Dst + 0x8bc);
          uVar2 = *(undefined4 *)((longlong)_Dst + 0x8c0);
          uVar3 = *(undefined4 *)((longlong)_Dst + 0x8c4);
          param_2[4] = *(undefined4 *)((longlong)_Dst + 0x8b8);
          param_2[5] = uVar1;
          param_2[6] = uVar2;
          param_2[7] = uVar3;
          uVar1 = *(undefined4 *)((longlong)_Dst + 0x8cc);
          uVar2 = *(undefined4 *)((longlong)_Dst + 0x8d0);
          uVar3 = *(undefined4 *)((longlong)_Dst + 0x8d4);
          param_2[8] = *(undefined4 *)((longlong)_Dst + 0x8c8);
          param_2[9] = uVar1;
          param_2[10] = uVar2;
          param_2[0xb] = uVar3;
          uVar1 = *(undefined4 *)((longlong)_Dst + 0x8dc);
          uVar2 = *(undefined4 *)((longlong)_Dst + 0x8e0);
          uVar3 = *(undefined4 *)((longlong)_Dst + 0x8e4);
          param_2[0xc] = *(undefined4 *)((longlong)_Dst + 0x8d8);
          param_2[0xd] = uVar1;
          param_2[0xe] = uVar2;
          param_2[0xf] = uVar3;
        }
      }
    }
    if (_Dst != (LPVOID)0x0) {
      VirtualFree(_Dst,0,0x8000);
    }
  }
  return DVar4;
}



void FUN_18006c817(undefined8 param_1,longlong param_2)

{
  if (*(LPVOID *)(param_2 + 0x28) != (LPVOID)0x0) {
    VirtualFree(*(LPVOID *)(param_2 + 0x28),0,0x8000);
    *(undefined8 *)(param_2 + 0x28) = 0;
  }
  return;
}



void FUN_18006c850(HANDLE param_1,short *param_2,uint *param_3,undefined4 *param_4)

{
  DWORD DVar1;
  uint uVar2;
  longlong lVar3;
  uint uVar5;
  undefined auStack2520 [32];
  uint local_9b8;
  undefined local_9a8 [32];
  undefined4 local_988;
  int local_984;
  short local_900 [1124];
  ulonglong local_38;
  longlong lVar4;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStack2520;
  memset(local_9a8,0,0x968);
  if (param_3 == (uint *)0x0) {
LAB_18006c8a0:
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid arg\n",0xd9e);
  }
  else {
    if (param_2 == (short *)0x0) {
      if (*param_3 != 0) goto LAB_18006c8a0;
    }
    else {
      *param_2 = 0;
    }
    DVar1 = FUN_18006b4bc(param_1,local_9a8);
    if (-1 < (int)DVar1) {
      if (local_984 == 0) {
        *param_3 = 0;
      }
      else {
        if (param_4 != (undefined4 *)0x0) {
          *param_4 = local_988;
        }
        lVar3 = -1;
        do {
          lVar4 = lVar3;
          lVar3 = lVar4 + 1;
        } while (local_900[lVar3] != 0);
        uVar5 = (int)lVar4 + 2;
        if (*param_3 < uVar5) {
          *param_3 = uVar5;
        }
        else {
          if (param_2 != (short *)0x0) {
            if ((int)lVar3 == 0) {
              *param_2 = 0;
            }
            else {
              uVar2 = FUN_18001cf30(param_2,(ulonglong)*param_3,local_900);
              if ((int)uVar2 < 0) {
                local_9b8 = uVar2;
                DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR StringCchCopy failed with 0x%x\n",0xdd2);
                goto LAB_18006c8c5;
              }
            }
          }
          *param_3 = uVar5;
        }
      }
    }
  }
LAB_18006c8c5:
  __security_check_cookie(local_38 ^ (ulonglong)auStack2520);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18006c9a0(longlong param_1)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  short *psVar4;
  char *pcVar5;
  undefined8 uVar6;
  undefined auStack728 [32];
  undefined8 local_2b8;
  undefined4 *local_2b0;
  undefined4 local_2a8 [2];
  HANDLE local_2a0;
  undefined local_298 [16];
  undefined4 local_288 [2];
  undefined8 local_280;
  undefined *local_278;
  undefined4 local_270;
  undefined local_268 [16];
  undefined local_258 [8];
  short *local_250;
  undefined local_38 [16];
  undefined4 local_28;
  ulonglong local_20;
  
  local_20 = DAT_1800b2220 ^ (ulonglong)auStack728;
  local_2a0 = (HANDLE)0x0;
  memset(local_258,0,0x220);
  local_2a8[0] = 0;
  local_38 = ZEXT816(0);
  local_28 = 0;
  uVar1 = FUN_18006b92c(param_1);
  local_2b8 = 0;
  uVar2 = NtQueryInformationProcess(param_1,0x2b,local_258,0x218);
  if ((uVar2 & 0xc0000000) == 0xc0000000) {
    uVar6 = 0x1089;
    pcVar5 = "WER/CrashAPI:%u: ERROR NtQueryInformationProcess failed 0x%x\n";
  }
  else {
    psVar4 = FUN_18006b9b8(local_250);
    if (psVar4 == (short *)0x0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpPathTail returned NULL\n",0x1091);
      goto LAB_18006cb6d;
    }
    local_280 = 0;
    local_288[0] = 0x30;
    local_270 = 0x40;
    local_278 = &DAT_180080710;
    if (uVar1 == 0) {
      local_278 = &DAT_180080720;
    }
    local_268 = ZEXT816(0);
    iVar3 = NtOpenKey(&local_2a0,1,local_288);
    if (iVar3 < 0) goto LAB_18006cb6d;
    uVar2 = RtlInitUnicodeStringEx(local_298,psVar4);
    if ((uVar2 & 0xc0000000) != 0xc0000000) {
      local_2b0 = local_2a8;
      local_2b8 = CONCAT44(local_2b8._4_4_,0x14);
      NtQueryValueKey(local_2a0,local_298,2,local_38);
      goto LAB_18006cb6d;
    }
    uVar6 = 0x10ab;
    pcVar5 = "WER/CrashAPI:%u: ERROR RtlInitUnicodeStringEx returned 0x%x\n";
  }
  local_2b8 = local_2b8 & 0xffffffff00000000 | (ulonglong)uVar2;
  DbgPrintEx(0x96,0,pcVar5,uVar6);
LAB_18006cb6d:
  if (local_2a0 != (HANDLE)0x0) {
    CloseHandle(local_2a0);
  }
  __security_check_cookie(local_20 ^ (ulonglong)auStack728);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void WerpLaunchAeDebug(HANDLE param_1,HANDLE param_2,undefined4 *param_3,undefined4 *param_4,
                      uint *param_5)

{
  byte bVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  undefined4 uVar12;
  undefined4 *puVar13;
  uint uVar14;
  DWORD DVar15;
  DWORD DVar16;
  BOOL BVar17;
  int iVar18;
  wchar_t *lpCommandLine;
  HANDLE pvVar19;
  HANDLE hSourceProcessHandle;
  LPVOID lpBaseAddress;
  undefined4 *puVar20;
  undefined8 uVar21;
  wchar_t *lpAttributeList;
  longlong lVar22;
  uint uVar23;
  undefined4 *puVar24;
  uint *puVar25;
  char *pcVar26;
  ulonglong uVar27;
  wchar_t *lpAttributeList_00;
  undefined auStackY1880 [32];
  byte local_708 [4];
  uint local_704;
  int local_700;
  HANDLE local_6f8 [2];
  DWORD local_6e8;
  wchar_t *local_6e0;
  SIZE_T local_6d8;
  HANDLE local_6d0;
  SIZE_T local_6c8;
  HANDLE local_6c0;
  uint *local_6b8;
  HANDLE local_6b0;
  HANDLE local_6a8;
  HANDLE local_6a0;
  undefined local_698 [16];
  undefined8 local_688;
  _SECURITY_ATTRIBUTES local_680;
  undefined local_668 [16];
  LPWSTR local_658;
  wchar_t *local_600;
  ushort local_5f8 [8];
  undefined4 local_5e8;
  uint local_5e4;
  DWORD local_5e0;
  undefined4 local_5dc;
  undefined8 local_5d8;
  undefined4 *local_5d0;
  undefined4 *local_5c8;
  undefined4 local_5c0;
  undefined4 uStack1468;
  undefined4 uStack1464;
  undefined4 uStack1460;
  undefined4 local_5b0;
  undefined4 uStack1452;
  undefined4 uStack1448;
  undefined4 uStack1444;
  undefined4 local_5a0;
  undefined4 uStack1436;
  undefined4 uStack1432;
  undefined4 uStack1428;
  undefined4 local_590;
  undefined4 uStack1420;
  undefined4 uStack1416;
  undefined4 uStack1412;
  undefined4 local_580;
  undefined4 uStack1404;
  undefined4 uStack1400;
  undefined4 uStack1396;
  undefined4 local_570;
  undefined4 uStack1388;
  undefined4 uStack1384;
  undefined4 uStack1380;
  undefined4 local_560;
  undefined4 uStack1372;
  undefined4 uStack1368;
  undefined4 uStack1364;
  undefined4 uStack1360;
  undefined4 uStack1356;
  undefined4 uStack1352;
  undefined4 uStack1348;
  undefined4 uStack1344;
  undefined4 uStack1340;
  undefined4 uStack1336;
  undefined4 uStack1332;
  undefined8 uStack1328;
  undefined4 local_528 [308];
  ulonglong local_58;
  
                    // 0x6cbc0  1551  WerpLaunchAeDebug
  local_58 = DAT_1800b2220 ^ (ulonglong)auStackY1880;
  lpAttributeList = (wchar_t *)0x0;
  local_6b8 = param_5;
  local_6f8[0] = (HANDLE)0x0;
  local_668._0_4_ = 0;
  local_6d0 = param_1;
  memset(local_668 + 8,0,0x68);
  local_704 = 0xffffffff;
  local_6d8 = 0;
  local_688 = 0;
  local_698 = ZEXT816(0);
  local_700 = 0;
  local_6b0 = (HANDLE)0x0;
  DVar15 = GetProcessId(param_1);
  local_6e8 = DVar15;
  if (DVar15 == 0) {
    DVar15 = GetLastError();
    lpCommandLine = lpAttributeList;
    lpAttributeList_00 = lpAttributeList;
    if (0 < (int)DVar15) {
      lpCommandLine = (wchar_t *)0x0;
      lpAttributeList_00 = (wchar_t *)0x0;
    }
  }
  else {
    DVar16 = GetCurrentProcessId();
    lpCommandLine = (wchar_t *)VirtualAlloc((LPVOID)0x0,0x4d0,0x1000,4);
    lpAttributeList_00 = (wchar_t *)0x0;
    local_6e0 = lpCommandLine;
    if (lpCommandLine != (wchar_t *)0x0) {
      local_680.lpSecurityDescriptor = (LPVOID)0x0;
      local_680.nLength = 0x18;
      local_680.bInheritHandle = 1;
      pvVar19 = GetCurrentProcess();
      hSourceProcessHandle = GetCurrentProcess();
      BVar17 = DuplicateHandle(hSourceProcessHandle,param_2,pvVar19,local_6f8,0,1,2);
      local_6f8[0] = (HANDLE)((ulonglong)local_6f8[0] & -(ulonglong)(BVar17 != 0));
      local_6c0 = CreateEventW(&local_680,1,0,(LPCWSTR)0x0);
      if (((local_6c0 == (HANDLE)0x0) || (param_3 == (undefined4 *)0x0)) ||
         (iVar18 = NtQuerySystemInformation(1,local_5f8,0xc), iVar18 < 0)) {
        lpBaseAddress = (LPVOID)0x0;
      }
      else {
        if (param_2 == (HANDLE)0x0) {
          local_5e0 = 0;
        }
        else {
          local_5e0 = GetThreadId(param_2);
        }
        pvVar19 = local_6d0;
        local_5dc = 0;
        local_5e4 = (uint)local_5f8[0];
        local_5d8 = *(undefined8 *)(param_3 + 4);
        local_5e8 = 0x28;
        if (DVar15 == DVar16) {
          lpBaseAddress = (LPVOID)0x0;
          local_5d0 = param_3;
          local_5c8 = param_4;
        }
        else {
          lpBaseAddress = VirtualAllocEx(local_6d0,(LPVOID)0x0,0x590,0x1000,4);
          if (lpBaseAddress != (LPVOID)0x0) {
            local_5c0 = *param_3;
            uStack1468 = param_3[1];
            uStack1464 = param_3[2];
            uStack1460 = param_3[3];
            local_5b0 = param_3[4];
            uStack1452 = param_3[5];
            uStack1448 = param_3[6];
            uStack1444 = param_3[7];
            uStack1328 = *(undefined8 *)(param_3 + 0x24);
            local_5a0 = param_3[8];
            uStack1436 = param_3[9];
            uStack1432 = param_3[10];
            uStack1428 = param_3[0xb];
            local_590 = param_3[0xc];
            uStack1420 = param_3[0xd];
            uStack1416 = param_3[0xe];
            uStack1412 = param_3[0xf];
            local_580 = param_3[0x10];
            uStack1404 = param_3[0x11];
            uStack1400 = param_3[0x12];
            uStack1396 = param_3[0x13];
            local_570 = param_3[0x14];
            uStack1388 = param_3[0x15];
            uStack1384 = param_3[0x16];
            uStack1380 = param_3[0x17];
            local_560 = param_3[0x18];
            uStack1372 = param_3[0x19];
            uStack1368 = param_3[0x1a];
            uStack1364 = param_3[0x1b];
            uStack1344 = param_3[0x20];
            uStack1340 = param_3[0x21];
            uStack1336 = param_3[0x22];
            uStack1332 = param_3[0x23];
            uStack1360 = param_3[0x1c];
            uStack1356 = param_3[0x1d];
            uStack1352 = param_3[0x1e];
            uStack1348 = param_3[0x1f];
            lVar22 = 9;
            puVar13 = local_528;
            do {
              puVar24 = param_4;
              puVar20 = puVar13;
              uVar2 = puVar24[1];
              uVar3 = puVar24[2];
              uVar4 = puVar24[3];
              uVar5 = puVar24[4];
              uVar6 = puVar24[5];
              uVar7 = puVar24[6];
              uVar8 = puVar24[7];
              *puVar20 = *puVar24;
              puVar20[1] = uVar2;
              puVar20[2] = uVar3;
              puVar20[3] = uVar4;
              uVar2 = puVar24[8];
              uVar3 = puVar24[9];
              uVar4 = puVar24[10];
              uVar9 = puVar24[0xb];
              puVar20[4] = uVar5;
              puVar20[5] = uVar6;
              puVar20[6] = uVar7;
              puVar20[7] = uVar8;
              uVar5 = puVar24[0xc];
              uVar6 = puVar24[0xd];
              uVar7 = puVar24[0xe];
              uVar8 = puVar24[0xf];
              puVar20[8] = uVar2;
              puVar20[9] = uVar3;
              puVar20[10] = uVar4;
              puVar20[0xb] = uVar9;
              uVar2 = puVar24[0x10];
              uVar3 = puVar24[0x11];
              uVar4 = puVar24[0x12];
              uVar9 = puVar24[0x13];
              puVar20[0xc] = uVar5;
              puVar20[0xd] = uVar6;
              puVar20[0xe] = uVar7;
              puVar20[0xf] = uVar8;
              uVar5 = puVar24[0x14];
              uVar6 = puVar24[0x15];
              uVar7 = puVar24[0x16];
              uVar8 = puVar24[0x17];
              puVar20[0x10] = uVar2;
              puVar20[0x11] = uVar3;
              puVar20[0x12] = uVar4;
              puVar20[0x13] = uVar9;
              uVar2 = puVar24[0x18];
              uVar3 = puVar24[0x19];
              uVar4 = puVar24[0x1a];
              uVar9 = puVar24[0x1b];
              puVar20[0x14] = uVar5;
              puVar20[0x15] = uVar6;
              puVar20[0x16] = uVar7;
              puVar20[0x17] = uVar8;
              uVar5 = puVar24[0x1c];
              uVar6 = puVar24[0x1d];
              uVar7 = puVar24[0x1e];
              uVar8 = puVar24[0x1f];
              puVar20[0x18] = uVar2;
              puVar20[0x19] = uVar3;
              puVar20[0x1a] = uVar4;
              puVar20[0x1b] = uVar9;
              puVar20[0x1c] = uVar5;
              puVar20[0x1d] = uVar6;
              puVar20[0x1e] = uVar7;
              puVar20[0x1f] = uVar8;
              lVar22 = lVar22 + -1;
              puVar13 = puVar20 + 0x20;
              param_4 = puVar24 + 0x20;
            } while (lVar22 != 0);
            uVar2 = puVar24[0x21];
            uVar3 = puVar24[0x22];
            uVar4 = puVar24[0x23];
            uVar5 = puVar24[0x24];
            uVar6 = puVar24[0x25];
            uVar7 = puVar24[0x26];
            uVar8 = puVar24[0x27];
            puVar20[0x20] = puVar24[0x20];
            puVar20[0x21] = uVar2;
            puVar20[0x22] = uVar3;
            puVar20[0x23] = uVar4;
            uVar9 = puVar24[0x28];
            uVar10 = puVar24[0x29];
            uVar11 = puVar24[0x2a];
            uVar12 = puVar24[0x2b];
            puVar20[0x24] = uVar5;
            puVar20[0x25] = uVar6;
            puVar20[0x26] = uVar7;
            puVar20[0x27] = uVar8;
            uVar2 = puVar24[0x2c];
            uVar3 = puVar24[0x2d];
            uVar4 = puVar24[0x2e];
            uVar5 = puVar24[0x2f];
            puVar20[0x28] = uVar9;
            puVar20[0x29] = uVar10;
            puVar20[0x2a] = uVar11;
            puVar20[0x2b] = uVar12;
            uVar6 = puVar24[0x30];
            uVar7 = puVar24[0x31];
            uVar8 = puVar24[0x32];
            uVar9 = puVar24[0x33];
            puVar20[0x2c] = uVar2;
            puVar20[0x2d] = uVar3;
            puVar20[0x2e] = uVar4;
            puVar20[0x2f] = uVar5;
            puVar20[0x30] = uVar6;
            puVar20[0x31] = uVar7;
            puVar20[0x32] = uVar8;
            puVar20[0x33] = uVar9;
            local_6c8 = (longlong)lpBaseAddress - (longlong)&local_5e8;
            local_5d0 = (undefined4 *)((longlong)&local_5c0 + local_6c8);
            local_5c8 = (undefined4 *)((longlong)local_528 + local_6c8);
            WriteProcessMemory(pvVar19,lpBaseAddress,&local_5e8,0x590,&local_6c8);
          }
        }
      }
      puVar25 = local_6b8 + 1;
      lpCommandLine = local_6e0;
      if ((*(short *)puVar25 == 0x22) ||
         (iVar18 = RtlDetermineDosPathNameType_U(puVar25), lpCommandLine = local_6e0, iVar18 != 5))
      {
LAB_18006cfe6:
        pvVar19 = local_6c0;
        iVar18 = FUN_1800582f8(lpCommandLine,0x143,(wchar_t *)puVar25,(ulonglong)local_6e8);
        if (iVar18 < 0) {
          pcVar26 = 
          "WER/CrashAPI:%u: ERROR StringCchPrintf failed while printng the debugger commandline with 0x%x\n"
          ;
          uVar21 = 0x12e9;
        }
        else {
          local_6b0 = (HANDLE)RtlGetCurrentTransaction();
          RtlSetCurrentTransaction();
          puVar25 = local_6b8;
          local_658 = L"";
          local_668._0_4_ = 0x70;
          uVar23 = *local_6b8;
          DVar15 = (uVar23 & 4) << 0x10;
          uVar14 = local_704;
          if ((uVar23 & 4) != 0) {
            bVar1 = (byte)uVar23;
            uVar23 = uVar23 >> 3 & 0xf;
            uVar14 = uVar23;
            if (((0x18 < (bVar1 & 0x78)) && (uVar14 = local_704, 0x20 < (bVar1 & 0x78))) &&
               ((uVar14 = uVar23, 0x38 < (bVar1 & 0x78) &&
                (uVar14 = local_704, (bVar1 & 0x78) == 0x70)))) {
              local_708[0] = 0;
              iVar18 = NtQueryInformationProcess(local_6d0,0x3d,local_708,1);
              if (iVar18 < 0) {
                DbgPrintEx(0x96,1,
                           "WER/CrashAPI:%u: WARNING NtQueryInformationProcess/ProcessProtectionInformation failed: NTSTATUS %08X\n"
                           ,0x1319);
                uVar14 = local_704;
              }
              else {
                DbgPrintEx(0x96,2,
                           "WER/CrashAPI:%u: TRACE Faulting process protection/signer: %02x/%02x\n",
                           0x131e);
                if (((local_708[0] & 7) < 3) && ((local_708[0] & 0xf0) < 0x90)) {
                  uVar14 = *(uint *)(&DAT_18008c210 +
                                    ((ulonglong)(local_708[0] & 7) * 9 +
                                    (ulonglong)(local_708[0] >> 4)) * 4);
                }
                else {
                  uVar14 = 0xffffffff;
                }
              }
            }
          }
          local_704 = uVar14;
          DbgPrintEx(0x96,2,"WER/CrashAPI:%u: TRACE Mapped protection level %02X -> %08X\n",0x132c);
          if (((*(byte *)puVar25 & 4) == 0) || (local_704 == 0xffffffff)) {
LAB_18006d322:
            uVar27 = 0;
            BVar17 = CreateProcessW((LPCWSTR)0x0,lpCommandLine,(LPSECURITY_ATTRIBUTES)0x0,
                                    (LPSECURITY_ATTRIBUTES)0x0,1,DVar15,(LPVOID)0x0,(LPCWSTR)0x0,
                                    (LPSTARTUPINFOW)local_668,(LPPROCESS_INFORMATION)local_698);
            if (BVar17 != 0) {
              if (pvVar19 != (HANDLE)0x0) {
                local_6a8 = pvVar19;
                local_6a0 = local_698._0_8_;
                do {
                  uVar27 = uVar27 & 0xffffffffffffff00 | 1;
                  iVar18 = NtWaitForMultipleObjects(2,&local_6a8,1,uVar27);
                  if (iVar18 == 0) break;
                } while (iVar18 != 1);
              }
              goto LAB_18006d3d4;
            }
            DVar15 = GetLastError();
            FUN_18006b134(DVar15);
            uVar21 = 0x137d;
            pcVar26 = "WER/CrashAPI:%u: ERROR Debugger spawn failed: 0x%x\n";
          }
          else {
            BVar17 = InitializeProcThreadAttributeList
                               ((LPPROC_THREAD_ATTRIBUTE_LIST)0x0,1,0,&local_6d8);
            if ((BVar17 == 0) && (DVar16 = GetLastError(), DVar16 != 0x7a)) {
              DVar15 = GetLastError();
              FUN_18006b134(DVar15);
              uVar21 = 0x133b;
LAB_18006d225:
              pcVar26 = "WER/CrashAPI:%u: ERROR InitializeProcThreadAttributeList failed: 0x%x\n";
            }
            else {
              lpAttributeList = (wchar_t *)VirtualAlloc((LPVOID)0x0,local_6d8,0x1000,4);
              if (lpAttributeList == (wchar_t *)0x0) {
                pcVar26 = "WER/CrashAPI:%u: ERROR Failed to allocate attribute list: 0x%x\n";
                uVar21 = 0x1348;
              }
              else {
                BVar17 = InitializeProcThreadAttributeList
                                   ((LPPROC_THREAD_ATTRIBUTE_LIST)lpAttributeList,1,0,&local_6d8);
                if (BVar17 == 0) {
                  DVar15 = GetLastError();
                  FUN_18006b134(DVar15);
                  uVar21 = 0x1354;
                  goto LAB_18006d225;
                }
                local_700 = 1;
                BVar17 = UpdateProcThreadAttribute
                                   ((LPPROC_THREAD_ATTRIBUTE_LIST)lpAttributeList,0,0x2000b,
                                    &local_704,4,(PVOID)0x0,(PSIZE_T)0x0);
                if (BVar17 != 0) {
                  DVar15 = DVar15 | 0x80000;
                  local_600 = lpAttributeList;
                  goto LAB_18006d322;
                }
                DVar15 = GetLastError();
                FUN_18006b134(DVar15);
                uVar21 = 0x1364;
                pcVar26 = "WER/CrashAPI:%u: ERROR UpdateProcThreadAttribute failed: 0x%x\n";
              }
            }
          }
        }
        DbgPrintEx(0x96,0,pcVar26,uVar21);
      }
      else {
        puVar25 = (uint *)(local_6e0 + 0x143);
        uVar21 = RtlGetNtSystemRoot();
        iVar18 = FUN_1800582f8((wchar_t *)puVar25,0x125,L"%s\\system32\\%s",uVar21);
        if (-1 < iVar18) goto LAB_18006cfe6;
        DbgPrintEx(0x96,0,
                   "WER/CrashAPI:%u: ERROR StringCchPrintf failed while printing the debugger path with 0x%x\n"
                   ,0x12d4);
        pvVar19 = local_6c0;
      }
LAB_18006d3d4:
      if (lpBaseAddress != (LPVOID)0x0) {
        VirtualFreeEx(local_6d0,lpBaseAddress,0,0x8000);
      }
      lpAttributeList_00 = lpAttributeList;
      if (pvVar19 != (HANDLE)0x0) {
        CloseHandle(pvVar19);
      }
    }
  }
  if (local_6f8[0] != (HANDLE)0x0) {
    CloseHandle(local_6f8[0]);
    local_6f8[0] = (HANDLE)0x0;
  }
  if (local_698._0_8_ != (HANDLE)0x0) {
    CloseHandle(local_698._0_8_);
  }
  if (local_698._8_8_ != (HANDLE)0x0) {
    CloseHandle(local_698._8_8_);
  }
  if (local_700 != 0) {
    if (lpAttributeList_00 == (wchar_t *)0x0) goto LAB_18006d485;
    DeleteProcThreadAttributeList((LPPROC_THREAD_ATTRIBUTE_LIST)lpAttributeList_00);
  }
  if (lpAttributeList_00 != (wchar_t *)0x0) {
    VirtualFree(lpAttributeList_00,0,0x8000);
  }
LAB_18006d485:
  pvVar19 = local_6b0;
  if (local_6b0 != (HANDLE)0x0) {
    RtlSetCurrentTransaction(local_6b0);
    CloseHandle(pvVar19);
  }
  if (lpCommandLine != (wchar_t *)0x0) {
    VirtualFree(lpCommandLine,0,0x8000);
  }
  __security_check_cookie(local_58 ^ (ulonglong)auStackY1880);
  return;
}



void FUN_18006d500(int param_1)

{
  undefined8 uVar1;
  int *local_res10 [3];
  
  local_res10[0] = (int *)0x0;
  uVar1 = FUN_18006b804(local_res10);
  if ((int)uVar1 < 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpGetRecoveryInfoForSelf failed with 0x%x\n",0xf73,
               (int)uVar1);
    return;
  }
  if (local_res10[0][0xc] == 1) {
    local_res10[0][0xd] = param_1;
    if (*(HANDLE *)(local_res10[0] + 8) != (HANDLE)0x0) {
                    // WARNING: Could not recover jumptable at 0x00018006d563. Too many branches
                    // WARNING: Treating indirect jump as call
      SetEvent(*(HANDLE *)(local_res10[0] + 8));
      return;
    }
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR No done event for recovery mode\n",0xf86);
  }
  return;
}



undefined8 FUN_18006d59c(undefined4 *param_1)

{
  int *piVar1;
  DWORD DVar2;
  undefined8 uVar3;
  int *local_res8;
  
  local_res8 = (int *)0x0;
  if (param_1 == (undefined4 *)0x0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid params\n",0xf33);
    uVar3 = 0x80070057;
  }
  else {
    *param_1 = 0;
    uVar3 = FUN_18006b804(&local_res8);
    piVar1 = local_res8;
    if ((int)uVar3 < 0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpGetRecoveryInfoForSelf failed with 0x%x\n",0xf3c
                 ,(int)uVar3);
    }
    else if (local_res8[0xc] != 0) {
      DVar2 = WaitForSingleObject(*(HANDLE *)(local_res8 + 10),0);
      if (DVar2 == 0) {
        *param_1 = 1;
      }
      else if (*(HANDLE *)(piVar1 + 6) != (HANDLE)0x0) {
        SetEvent(*(HANDLE *)(piVar1 + 6));
      }
      return 0;
    }
    uVar3 = 0x80004005;
  }
  return uVar3;
}



uint FUN_18006d66c(wchar_t *param_1,int param_2,uint param_3)

{
  ulonglong uVar1;
  bool bVar2;
  int iVar3;
  undefined7 extraout_var;
  longlong lVar4;
  wchar_t *pwVar6;
  longlong *_Dst;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  undefined8 uVar10;
  undefined8 uVar11;
  wchar_t *pwVar12;
  longlong lVar5;
  
  _Dst = (longlong *)0x0;
  uVar10 = 0;
  uVar11 = 0;
  bVar2 = FUN_18002189c();
  if ((int)CONCAT71(extraout_var,bVar2) == 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid state\n",0x8c2);
    uVar7 = 0x8007139f;
  }
  else {
    if (param_1 == (wchar_t *)0x0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid params\n",0x8c8);
    }
    else if (((param_3 & 0xfffffffc) == 0) && (param_2 - 1U < 2)) {
      lVar4 = -1;
      do {
        lVar5 = lVar4;
        lVar4 = lVar5 + 1;
      } while (param_1[lVar4] != L'\0');
      uVar7 = (int)lVar5 + 2;
      if (uVar7 < (uint)lVar4) {
        uVar10 = 0x8de;
      }
      else {
        uVar1 = (ulonglong)uVar7 * 2;
        if (uVar1 < 0x100000000) {
          uVar8 = (int)uVar1 + 0x20;
          uVar7 = 0xffffffff;
          if (uVar8 >= 0x20) {
            uVar7 = uVar8;
          }
          uVar9 = -(uint)(uVar8 < 0x20) & 0x80070216;
          if (uVar8 < 0x20) {
            DbgPrintEx(0x96,0,
                       "WER/CrashAPI:%u: ERROR Arithmetic overflow when calculating allocation size\n"
                       ,0x8ee,uVar9,uVar10,uVar11);
            return uVar9;
          }
          if (0x228 < uVar7) {
            DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Final gather block size exceeds limit\n",0x8f4
                       ,uVar9,uVar10,uVar11);
            return 0x800700ce;
          }
          iVar3 = FUN_18001ccd4();
          if (-1 < iVar3) {
            FUN_18006dbd8(param_1);
            pwVar6 = FUN_18006b700();
            if (pwVar6 == (wchar_t *)0x0) {
              DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Unable to get the heap handle\n",0x90c,uVar9
                         ,uVar10,0);
              uVar7 = 0x80004005;
            }
            else {
              pwVar12 = pwVar6;
              _Dst = FUN_18006e27c((longlong)pwVar6,(ulonglong)uVar7);
              if (_Dst == (longlong *)0x0) {
                DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR OOM\n",0x916,uVar9,0,pwVar12);
                uVar7 = 0x8007000e;
              }
              else {
                memset(_Dst,0,(ulonglong)uVar7);
                *(ushort *)(_Dst + 1) = *(ushort *)(_Dst + 1) & 0x3fff;
                *(ushort *)(_Dst + 1) = *(ushort *)(_Dst + 1) | 0x4000;
                *(ushort *)(_Dst + 2) = *(ushort *)(_Dst + 2) & 0x8000;
                *(ushort *)(_Dst + 2) = *(ushort *)(_Dst + 2) | (ushort)param_3 & 0x7fff;
                *(ushort *)(_Dst + 1) = *(ushort *)(_Dst + 1) & 0xc000;
                *(ushort *)(_Dst + 1) = *(ushort *)(_Dst + 1) | (ushort)uVar7 & 0x3fff;
                if (param_2 == 1) {
                  *(ushort *)(_Dst + 2) = *(ushort *)(_Dst + 2) & 0x7fff;
                }
                else if (param_2 == 2) {
                  *(ushort *)(_Dst + 2) = *(ushort *)(_Dst + 2) | 0x8000;
                }
                uVar7 = FUN_18006b158((short *)((longlong)_Dst + 0x12),uVar1 & 0xffffffff,param_1);
                if (-1 < (int)uVar7) {
                  uVar10 = FUN_18006b1a4(_Dst);
                  uVar7 = (uint)uVar10;
                }
              }
            }
            if (-1 < (int)uVar7) {
              return uVar7;
            }
            if (_Dst == (longlong *)0x0) {
              return uVar7;
            }
            FUN_18006e550((longlong)pwVar6,(longlong)_Dst);
            return uVar7;
          }
          DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpInitPEBStore failed\n",0x8fa,uVar9,uVar10,
                     uVar11);
          return 0x80004005;
        }
        uVar10 = 0x8e6;
      }
      DbgPrintEx(0x96,0,
                 "WER/CrashAPI:%u: ERROR Arithmetic overflow when calculating filename size\n",
                 uVar10);
      return 0x80070216;
    }
    uVar7 = 0x80070057;
  }
  return uVar7;
}



ulonglong FUN_18006d98c(longlong param_1,longlong param_2)

{
  bool bVar1;
  int iVar2;
  uint uVar3;
  undefined7 extraout_var;
  longlong lVar4;
  wchar_t *pwVar5;
  longlong *_Dst;
  ulonglong uVar6;
  char *pcVar7;
  int local_res18 [4];
  undefined4 uVar8;
  undefined8 uVar9;
  longlong *plVar10;
  undefined8 uVar11;
  wchar_t *pwVar12;
  
  uVar6 = 0x80004005;
  uVar8 = 0x80004005;
  _Dst = (longlong *)0x0;
  uVar9 = 0;
  uVar11 = 0;
  local_res18[0] = 0;
  bVar1 = FUN_18002189c();
  if ((int)CONCAT71(extraout_var,bVar1) == 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid state\n",0x14dd,uVar8,uVar9,uVar11);
    return 0x8007139f;
  }
  if (param_1 == 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid arguments in call to function\n",0x14e3,uVar8,
               uVar9,uVar11);
    return 0x80070057;
  }
  iVar2 = FUN_18001ccd4();
  if (iVar2 < 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR WerpInitPEBStore failed\n",0x14e9,uVar8,uVar9,uVar11);
    return 0x80004005;
  }
  lVar4 = -1;
  do {
    lVar4 = lVar4 + 1;
  } while (*(short *)(param_1 + lVar4 * 2) != 0);
  iVar2 = (int)lVar4 * 2;
  uVar3 = iVar2 + 0x1a;
  pwVar5 = FUN_18006b700();
  if (pwVar5 == (wchar_t *)0x0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Unable to get the heap handle\n",0x14fd,uVar8,uVar9,0)
    ;
  }
  else {
    pwVar12 = pwVar5;
    _Dst = FUN_18006e27c((longlong)pwVar5,(ulonglong)uVar3);
    if (_Dst == (longlong *)0x0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR OOM\n",0x1507,uVar8,0,pwVar12);
      uVar6 = 0x8007000e;
    }
    else {
      plVar10 = _Dst;
      memset(_Dst,0,(ulonglong)uVar3);
      _Dst[2] = param_2;
      *(uint *)(_Dst + 1) = uVar3;
      uVar3 = FUN_18006b158((short *)(_Dst + 3),(ulonglong)(iVar2 + 2),param_1);
      uVar6 = (ulonglong)uVar3;
      if ((int)uVar3 < 0) {
        uVar9 = 0x151d;
        pcVar7 = "WER/CrashAPI:%u: ERROR StringCbCopy failed\n";
      }
      else {
        uVar6 = FUN_18006b2e4(_Dst,local_res18);
        uVar3 = (uint)uVar6;
        uVar6 = uVar6 & 0xffffffff;
        if (-1 < (int)uVar3) goto LAB_18006db70;
        uVar9 = 0x1528;
        pcVar7 = "WER/CrashAPI:%u: ERROR Failed register runtime crash dll\n";
      }
      DbgPrintEx(0x96,0,pcVar7,uVar9,uVar3,plVar10,pwVar12);
    }
  }
LAB_18006db70:
  if ((((int)uVar6 < 0) || (local_res18[0] != 0)) && (_Dst != (longlong *)0x0)) {
    FUN_18006e550((longlong)pwVar5,(longlong)_Dst);
  }
  return uVar6;
}



ulonglong FUN_18006dbd8(wchar_t *param_1)

{
  bool bVar1;
  int iVar2;
  uint uVar3;
  undefined7 extraout_var;
  longlong lVar4;
  ulonglong uVar5;
  char *pcVar6;
  undefined8 uVar7;
  undefined8 *local_res8;
  undefined8 *local_res10;
  
  local_res10 = (undefined8 *)0x0;
  local_res8 = (undefined8 *)0x0;
  uVar5 = 0x80004005;
  if (param_1 == (wchar_t *)0x0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid args\n",0x621);
    uVar5 = 0x80070057;
  }
  else {
    bVar1 = FUN_18002189c();
    if ((int)CONCAT71(extraout_var,bVar1) == 0) {
      DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid state\n",0x627);
      uVar5 = 0x8007139f;
    }
    else {
      lVar4 = FUN_18001ce80();
      if (lVar4 == 0) {
        uVar7 = 0x62f;
        pcVar6 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
      }
      else {
        iVar2 = FUN_18001ce14();
        if (-1 < iVar2) {
          lVar4 = *(longlong *)(lVar4 + 0x358);
          if ((lVar4 == 0) || (uVar3 = FUN_18001cc84(lVar4), (int)uVar3 < 0)) {
            DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR PEB is not initialized\n",0x63f);
          }
          else {
            uVar3 = FUN_18006bf74(param_1,&local_res10,&local_res8);
            uVar5 = (ulonglong)uVar3;
            if (uVar3 == 0) {
              uVar5 = FUN_18006bebc(lVar4,local_res10,local_res8);
              uVar5 = uVar5 & 0xffffffff;
            }
          }
          RtlReleasePebLock();
          return uVar5;
        }
        uVar7 = 0x635;
        pcVar6 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
      }
      DbgPrintEx(0x96,0,pcVar6,uVar7);
    }
  }
  return uVar5;
}



ulonglong FUN_18006dd48(longlong param_1)

{
  bool bVar1;
  int iVar2;
  uint uVar3;
  undefined7 extraout_var;
  longlong lVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  char *pcVar7;
  undefined8 uVar8;
  undefined8 *local_res8;
  undefined8 *local_res18;
  
  local_res18 = (undefined8 *)0x0;
  local_res8 = (undefined8 *)0x0;
  uVar6 = 0x80070490;
  if (param_1 == 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid args\n",0xb02);
    return 0x80070057;
  }
  bVar1 = FUN_18002189c();
  if ((int)CONCAT71(extraout_var,bVar1) != 0) {
    lVar4 = FUN_18001ce80();
    if (lVar4 == 0) {
      uVar8 = 0xb10;
      pcVar7 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
    }
    else {
      iVar2 = FUN_18001ce14();
      if (-1 < iVar2) {
        lVar4 = *(longlong *)(lVar4 + 0x358);
        if ((lVar4 == 0) || (uVar3 = FUN_18001cc84(lVar4), (int)uVar3 < 0)) {
          DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR PEB is not initialized\n",0xb20);
        }
        else {
          uVar5 = FUN_18006c0c0(param_1,&local_res18,&local_res8);
          uVar6 = uVar5 & 0xffffffff;
          if ((int)uVar5 == 0) {
            uVar6 = FUN_18006bebc(lVar4,local_res18,local_res8);
            uVar6 = uVar6 & 0xffffffff;
          }
        }
        RtlReleasePebLock();
        return uVar6;
      }
      uVar8 = 0xb16;
      pcVar7 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
    }
    DbgPrintEx(0x96,0,pcVar7,uVar8);
    return 0x80004005;
  }
  DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid state\n",0xb08);
  return 0x8007139f;
}



undefined8 FUN_18006debc(longlong param_1,longlong param_2)

{
  short sVar1;
  short sVar2;
  int iVar3;
  uint uVar4;
  longlong lVar5;
  wchar_t *pwVar6;
  undefined8 *puVar7;
  undefined8 *puVar8;
  undefined8 *puVar9;
  undefined8 uVar10;
  char *pcVar11;
  undefined8 uVar12;
  longlong lVar13;
  
  uVar10 = 0x80004005;
  if (param_1 == 0) {
    DbgPrintEx(0x96,0,"WER/CrashAPI:%u: ERROR Invalid arguments in call to function\n",0x1557);
    return 0x80070057;
  }
  lVar5 = FUN_18001ce80();
  if (lVar5 == 0) {
    uVar10 = 0x155f;
    pcVar11 = "WER/CrashAPI:%u: ERROR Unable to get the pPeb, WerpCurrentPeb failed\n";
LAB_18006df37:
    DbgPrintEx(0x96,0,pcVar11,uVar10);
    return 0x80004005;
  }
  iVar3 = FUN_18001ce14();
  if (iVar3 < 0) {
    uVar10 = 0x1567;
    pcVar11 = "WER/CrashAPI:%u: ERROR Unable to get the peb lock\n";
    goto LAB_18006df37;
  }
  lVar5 = *(longlong *)(lVar5 + 0x358);
  if ((lVar5 == 0) || (uVar4 = FUN_18001cc84(lVar5), (int)uVar4 < 0)) {
    uVar12 = 0x1571;
    pcVar11 = "WER/CrashAPI:%u: ERROR Invalid PEB entry\n";
  }
  else {
    pwVar6 = FUN_18006b700();
    if (pwVar6 != (wchar_t *)0x0) {
      puVar8 = *(undefined8 **)(lVar5 + 0x8f8);
      puVar9 = (undefined8 *)0x0;
      while (puVar7 = puVar8, puVar7 != (undefined8 *)0x0) {
        puVar8 = puVar7 + 3;
        lVar13 = param_1 - (longlong)puVar8;
        do {
          sVar1 = *(short *)puVar8;
          sVar2 = *(short *)((longlong)puVar8 + lVar13);
          if (sVar1 != sVar2) break;
          puVar8 = (undefined8 *)((longlong)puVar8 + 2);
        } while (sVar2 != 0);
        if ((sVar1 == sVar2) && (puVar7[2] == param_2)) {
          if (puVar9 == (undefined8 *)0x0) {
            *(undefined8 *)(lVar5 + 0x8f8) = *puVar7;
          }
          else {
            *puVar9 = *puVar7;
          }
          FUN_18006e550((longlong)pwVar6,(longlong)puVar7);
          uVar10 = 0;
          goto LAB_18006e02f;
        }
        puVar9 = puVar7;
        puVar8 = (undefined8 *)*puVar7;
      }
      uVar10 = 0x80070002;
      goto LAB_18006e02f;
    }
    uVar12 = 0x157c;
    pcVar11 = "WER/CrashAPI:%u: ERROR Unable to get the heap handle\n";
  }
  DbgPrintEx(0x96,0,pcVar11,uVar12);
LAB_18006e02f:
  RtlReleasePebLock();
  return uVar10;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

undefined4 FUN_18006e064(longlong param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  code *pcVar4;
  undefined4 uVar5;
  char *pcVar6;
  
  if (param_1 == 0) {
    DbgPrintEx(0x96,0,"WER/Recovery:%u: ERROR Invalid params\n");
    uVar5 = 0x80070057;
  }
  else if (*(int *)(param_1 + 0x30) == 0) {
    iVar1 = NtClearEvent(*(undefined8 *)(param_1 + 0x18));
    iVar2 = NtClearEvent(*(undefined8 *)(param_1 + 0x20));
    iVar3 = NtClearEvent();
    if (iVar3 < 0 || (iVar1 < 0 || iVar2 < 0)) {
      uVar5 = 0x6b;
      pcVar6 = "WER/Recovery:%u: ERROR Invalid events\n";
    }
    else {
      if (*(longlong *)(param_1 + 8) != 0) {
        *(undefined4 *)(param_1 + 0x30) = 1;
        pcVar4 = (code *)RtlDecodeSystemPointer();
        (*pcVar4)();
        *(undefined4 *)(param_1 + 0x30) = 0;
        return 0;
      }
      uVar5 = 0x8a;
      pcVar6 = "WER/Recovery:%u: ERROR No recovery function found\n";
    }
    DbgPrintEx(0x96,0,pcVar6,uVar5);
    uVar5 = 0x80004005;
  }
  else {
    DbgPrintEx(0x96,0,"WER/Recovery:%u: ERROR Already in recovery\n");
    uVar5 = 0x8007139f;
  }
  return uVar5;
}



bool FUN_18006e1d0(int **param_1)

{
  return **param_1 == -0x3ffffffb;
}



int FUN_18006e1f8(void)

{
  int iVar1;
  undefined8 uVar2;
  int *local_res8 [4];
  
  local_res8[0] = (int *)0x0;
  uVar2 = FUN_18006b804(local_res8);
  if ((int)uVar2 == 0) {
    iVar1 = FUN_18006e064((longlong)local_res8[0]);
    if (iVar1 < 0) {
      DbgPrintEx(0x96,0,"WER/Recovery:%u: ERROR WerpInitiateRecovery failed\n",0x225);
    }
    else {
      iVar1 = 0;
    }
  }
  else {
    DbgPrintEx(0x96,0,
               "WER/Recovery:%u: ERROR No recovery rotuine found when control reached WerpRecoveryInvokedRemotely\n"
               ,0x21b);
    iVar1 = -0x7fffbffb;
  }
  return iVar1;
}



// WARNING: Could not reconcile some variable overlaps

longlong * FUN_18006e27c(longlong param_1,ulonglong param_2)

{
  bool bVar1;
  bool bVar2;
  int iVar3;
  undefined7 extraout_var;
  longlong *lpAddress;
  uint uVar4;
  ulonglong dwSize;
  longlong *plVar5;
  char *pcVar6;
  undefined8 uVar7;
  bool bVar8;
  undefined4 uVar9;
  undefined local_60 [16];
  undefined local_50 [16];
  undefined local_40 [16];
  
  uVar9 = 0;
  lpAddress = (longlong *)0x0;
  bVar1 = false;
  bVar8 = false;
  if ((param_1 == 0) || (param_2 == 0)) {
    DbgPrintEx(0x96,0,"WER/Heap:%u: ERROR Invalid arguments\n",0x15d,0);
    SetLastError(0x57);
    return (longlong *)0x0;
  }
  if (param_2 + 0x28 < param_2) {
    uVar7 = 0x16a;
    pcVar6 = "WER/Heap:%u: ERROR Arithmetic overflow when calculating block size\n";
LAB_18006e300:
    DbgPrintEx(0x96,0,pcVar6,uVar7,uVar9);
    return (longlong *)0x0;
  }
  if (param_2 + 0x2f < param_2 + 0x28) {
    dwSize = 0xffffffffffffffff;
    iVar3 = -0x7ff8fdea;
  }
  else {
    dwSize = param_2 + 0x2f & 0xfffffffffffffff8;
    iVar3 = 0;
  }
  if (iVar3 < 0) {
    uVar7 = 0x175;
    pcVar6 = "WER/Heap:%u: ERROR Arithmetic overflow when aligning block size\n";
    goto LAB_18006e300;
  }
  local_60 = ZEXT816(0);
  local_50 = ZEXT816(0);
  local_40 = ZEXT816(0);
  GetSystemInfo((LPSYSTEM_INFO)local_60);
  if (local_60._4_4_ == 0) {
    uVar7 = 0x187;
    pcVar6 = "WER/Heap:%u: ERROR Invalid page size, GetSystemInfo  may have failed\n";
    goto LAB_18006e300;
  }
  bVar2 = FUN_18006e73c(param_1);
  if ((int)CONCAT71(extraout_var,bVar2) == 0) {
    uVar7 = 0x18d;
    pcVar6 = "WER/Heap:%u: ERROR Failed to lock the heap\n";
    goto LAB_18006e300;
  }
  if (*(longlong *)(param_1 + 0x38) == 0) {
    bVar2 = true;
    bVar8 = false;
LAB_18006e3e7:
    lpAddress = (longlong *)VirtualAlloc((LPVOID)0x0,dwSize,0x3000,4);
    if (lpAddress == (longlong *)0x0) {
      plVar5 = (longlong *)0x0;
      goto LAB_18006e471;
    }
  }
  else {
    if (*(longlong *)(param_1 + 0x40) != 0) {
      lpAddress = FUN_18006e6b0(param_1,dwSize - 0x28);
      bVar8 = lpAddress != (longlong *)0x0;
    }
    bVar2 = false;
    if (lpAddress == (longlong *)0x0) {
      uVar4 = local_60._4_4_ -
              SUB164(ZEXT816(*(ulonglong *)(param_1 + 0x38)) % ZEXT416(local_60._4_4_),0);
      if ((uVar4 < dwSize) || (uVar4 == local_60._4_4_)) {
        bVar2 = true;
      }
      else {
        lpAddress = *(longlong **)(param_1 + 0x38);
        bVar2 = false;
      }
    }
    if (bVar2) goto LAB_18006e3e7;
  }
  if (!bVar8) {
    *(ulonglong *)(param_1 + 0x38) = dwSize + (longlong)lpAddress;
    lpAddress[3] = (ulonglong)((int)dwSize - 0x28);
  }
  plVar5 = lpAddress + 5;
  lpAddress[2] = (longlong)plVar5;
  *(undefined4 *)(lpAddress + 4) = 1;
  lpAddress[1] = 0;
  *lpAddress = *(longlong *)(param_1 + 0x28);
  if (*(longlong *)(param_1 + 0x20) == 0) {
    *(longlong **)(param_1 + 0x20) = lpAddress;
  }
  if (*(longlong *)(param_1 + 0x28) != 0) {
    *(longlong **)(*(longlong *)(param_1 + 0x28) + 8) = lpAddress;
  }
  *(longlong **)(param_1 + 0x28) = lpAddress;
  bVar1 = true;
LAB_18006e471:
  FUN_18006e788(param_1);
  if (bVar1) {
    return plVar5;
  }
  if (lpAddress != (longlong *)0x0) {
    if (bVar2) {
      VirtualFree(lpAddress,0,0x8000);
      return plVar5;
    }
    return plVar5;
  }
  return plVar5;
}



void FUN_18006e504(undefined8 param_1,longlong param_2)

{
  FUN_18006e788(*(longlong *)(param_2 + 0xa0));
  if (((*(int *)(param_2 + 0x24) == 0) && (*(LPVOID *)(param_2 + 0x30) != (LPVOID)0x0)) &&
     (*(int *)(param_2 + 0x20) != 0)) {
    VirtualFree(*(LPVOID *)(param_2 + 0x30),0,0x8000);
  }
  return;
}



undefined8 FUN_18006e550(longlong param_1,longlong param_2)

{
  longlong *plVar1;
  longlong **pplVar2;
  bool bVar3;
  undefined7 extraout_var;
  undefined8 uVar4;
  
  uVar4 = 0;
  if ((param_1 == 0) || (param_2 == 0)) {
    DbgPrintEx(0x96,0,"WER/Heap:%u: ERROR Invalid arguments\n",0x224);
    SetLastError(0x57);
  }
  else {
    bVar3 = FUN_18006e73c(param_1);
    if ((int)CONCAT71(extraout_var,bVar3) != 0) {
      plVar1 = (longlong *)(param_2 + -0x28);
      if (*(longlong *)(param_2 + -0x18) == param_2) {
        if (*plVar1 != 0) {
          *(undefined8 *)(*plVar1 + 8) = *(undefined8 *)(param_2 + -0x20);
        }
        if (*(longlong **)(param_2 + -0x20) != (longlong *)0x0) {
          **(longlong **)(param_2 + -0x20) = *plVar1;
        }
        if (plVar1 == *(longlong **)(param_1 + 0x20)) {
          *(undefined8 *)(param_1 + 0x20) = *(undefined8 *)(param_2 + -0x20);
        }
        if (plVar1 == *(longlong **)(param_1 + 0x28)) {
          *(longlong *)(param_1 + 0x28) = *plVar1;
        }
        *(undefined4 *)(param_2 + -8) = 0;
        pplVar2 = *(longlong ***)(param_1 + 0x40);
        *(longlong ***)(param_2 + -0x20) = pplVar2;
        if (pplVar2 != (longlong **)0x0) {
          *pplVar2 = plVar1;
        }
        *plVar1 = 0;
        *(longlong **)(param_1 + 0x40) = plVar1;
        uVar4 = 1;
      }
      else {
        DbgPrintEx(0x96,0,"WER/Heap:%u: ERROR Invalid block passed\n",0x23b);
        SetLastError(0x57);
      }
      FUN_18006e788(param_1);
      return uVar4;
    }
    DbgPrintEx(0x96,0,"WER/Heap:%u: ERROR Failed to lock the heap\n",0x22c);
  }
  return 0;
}



void FUN_18006e692(undefined8 param_1,longlong param_2)

{
  FUN_18006e788(*(longlong *)(param_2 + 0x30));
  return;
}



longlong * FUN_18006e6b0(longlong param_1,ulonglong param_2)

{
  ulonglong uVar1;
  longlong *plVar2;
  longlong *plVar3;
  longlong *plVar4;
  
  plVar3 = *(longlong **)(param_1 + 0x40);
  plVar4 = (longlong *)0x0;
  if (plVar3 != (longlong *)0x0) {
    do {
      uVar1 = plVar3[3];
      plVar2 = plVar3;
      if (uVar1 == param_2) break;
      if ((param_2 < uVar1) && ((plVar4 == (longlong *)0x0 || (uVar1 < (ulonglong)plVar4[3])))) {
        plVar4 = plVar3;
      }
      plVar3 = (longlong *)plVar3[1];
      plVar2 = plVar4;
    } while (plVar3 != (longlong *)0x0);
    plVar3 = plVar2;
    if (plVar3 != (longlong *)0x0) {
      if (*plVar3 != 0) {
        *(longlong *)(*plVar3 + 8) = plVar3[1];
      }
      if ((longlong *)plVar3[1] != (longlong *)0x0) {
        *(longlong *)plVar3[1] = *plVar3;
      }
      if (*(longlong **)(param_1 + 0x40) == plVar3) {
        *(longlong *)(param_1 + 0x40) = plVar3[1];
      }
      memset((void *)plVar3[2],0,plVar3[3]);
    }
  }
  return plVar3;
}



bool FUN_18006e73c(longlong param_1)

{
  DWORD DVar1;
  bool bVar2;
  
  if (param_1 == 0) {
    SetLastError(0x57);
    bVar2 = false;
  }
  else {
    DVar1 = WaitForSingleObject(*(HANDLE *)(param_1 + 0x30),4000);
    bVar2 = DVar1 == 0;
  }
  return bVar2;
}



BOOL FUN_18006e788(longlong param_1)

{
  BOOL BVar1;
  
  if (param_1 == 0) {
    SetLastError(0x57);
    return 0;
  }
                    // WARNING: Could not recover jumptable at 0x00018006e7b2. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = ReleaseMutex(*(HANDLE *)(param_1 + 0x30));
  return BVar1;
}



uint FUN_18006e7c4(wchar_t *param_1)

{
  int iVar1;
  uint uVar2;
  
  if (param_1 == (wchar_t *)0x0) {
    DbgPrintEx(0x96,0,"WER/Heap:%u: ERROR Invalid args\n");
    uVar2 = 0x80070057;
  }
  else {
    iVar1 = wcscmp(param_1,L"HEAP_SIGNATURE");
    uVar2 = -(uint)(iVar1 != 0) & 0x80004005;
  }
  return uVar2;
}



bool FUN_18006e83c(int **param_1)

{
  return **param_1 == -0x3ffffffb;
}



uint FUN_18006e864(HANDLE param_1,undefined8 param_2,undefined8 param_3,wchar_t *param_4,
                  short param_5,wchar_t *param_6,undefined8 param_7,short *param_8)

{
  short *psVar1;
  ushort uVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  undefined6 extraout_var;
  wchar_t *pwVar6;
  undefined8 uVar7;
  ulonglong in_stack_ffffffffffffffd8;
  
  uVar3 = FUN_18006b92c((longlong)param_1);
  param_5 = 0;
  iVar4 = IsWow64Process2(param_1,&param_5);
  if (iVar4 == 0) {
    uVar5 = FUN_18006f170();
    DbgPrintEx(0x96,1,"WER/ReportFault:%u: WARNING IsWow64Process2 failed: %u.\n",0xbd,
               in_stack_ffffffffffffffd8 & 0xffffffff00000000 | (ulonglong)uVar5);
  }
  psVar1 = param_8;
  if ((param_5 == 0x14c) || (param_5 == 0x1c4)) {
    iVar4 = GetSystemWow64Directory2W(param_8,0x20);
  }
  else {
    uVar2 = FUN_18001ae0c(param_8,0x20);
    iVar4 = (int)CONCAT62(extraout_var,uVar2);
  }
  if ((iVar4 - 1U < 0x20) && (*psVar1 != 0)) {
    pwVar6 = L"WerFaultSecure.exe";
    if (uVar3 == 0) {
      pwVar6 = L"WerFault.exe";
    }
    uVar3 = FUN_1800582f8(param_4,0x40,L"%s\\%s",psVar1);
    if ((int)uVar3 < 0) {
      uVar7 = 0xdf;
    }
    else {
      GetProcessId(param_1);
      pwVar6 = (wchar_t *)((ulonglong)pwVar6 & 0xffffffff00000000);
      uVar3 = FUN_1800582f8(param_6,0x80,L"%s -u -p %d -s %I64d",param_4);
      if (-1 < (int)uVar3) {
        return 0;
      }
      uVar7 = 0x115;
    }
    DbgPrintEx(0x96,0,"WER/ReportFault:%u: ERROR StringCchPrintf failed: HRESULT %08X.\n",uVar7,
               (ulonglong)pwVar6 & 0xffffffff00000000 | (ulonglong)uVar3);
  }
  else {
    DbgPrintEx(0x96,0,
               "WER/ReportFault:%u: ERROR GetSystemWindowsDirectory failed or the size was inadequate.\n"
              );
    uVar3 = 0x800700a1;
  }
  return uVar3;
}



undefined8 FUN_18006ea20(int param_1)

{
  undefined8 uVar1;
  
  if (param_1 < -0x7fe47fff) {
    if (param_1 == -0x7fe48000) {
      return 3;
    }
    if (((((param_1 != -0x7ff8fff8) && (param_1 != -0x7ff8fff2)) && (param_1 != -0x7ff8fb96)) &&
        ((param_1 != -0x7ff8fa56 && (param_1 != -0x7ff8fa51)))) && (param_1 != -0x7ff8f8e8)) {
      return 4;
    }
    return 9;
  }
  uVar1 = 0;
  if ((param_1 != -0x7fe47fff) && (param_1 != 0)) {
    if (param_1 == 0x1b0000) {
      uVar1 = 6;
    }
    else if (param_1 != 0x1b0001) {
      if (param_1 == 0x1b0002) {
        return 2;
      }
      if (param_1 < 0x1b000b) {
        return 4;
      }
      uVar1 = 0;
      if (0x1b000c < param_1) {
        return 4;
      }
    }
  }
  return uVar1;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18006eabc(undefined8 param_1,PVOID param_2,uint param_3,HANDLE *param_4)

{
  uint uVar1;
  uint uVar2;
  BOOL BVar3;
  int iVar4;
  HANDLE pvVar5;
  longlong lVar6;
  LPDWORD lpOldMode;
  int iVar7;
  LPPROC_THREAD_ATTRIBUTE_LIST p_Var8;
  undefined8 uVar9;
  LPPROC_THREAD_ATTRIBUTE_LIST lpAddress;
  uint uVar10;
  undefined auStackY792 [32];
  short in_stack_fffffffffffffd08;
  undefined8 in_stack_fffffffffffffd18;
  int local_2c8;
  DWORD local_2c4;
  LPPROC_THREAD_ATTRIBUTE_LIST local_2c0;
  int local_2b8;
  uint local_2b4;
  UINT local_2b0;
  PVOID local_2a8;
  HANDLE *local_2a0;
  undefined local_298 [16];
  undefined8 local_288;
  undefined local_278 [60];
  DWORD local_23c;
  WORD local_238;
  LPPROC_THREAD_ATTRIBUTE_LIST local_210;
  WCHAR local_208 [32];
  wchar_t local_1c8 [64];
  wchar_t local_148 [128];
  ulonglong local_48;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStackY792;
  uVar9 = 0;
  local_2b4 = param_3;
  local_2a8 = param_2;
  local_2a0 = param_4;
  memset(local_278 + 8,0,0x68);
  p_Var8 = (LPPROC_THREAD_ATTRIBUTE_LIST)0x0;
  local_2b8 = 2;
  *param_4 = (HANDLE)0x0;
  local_288 = 0;
  local_298 = ZEXT816(0);
  local_2c0 = (LPPROC_THREAD_ATTRIBUTE_LIST)0x0;
  local_2c4 = 0;
  local_23c = 1;
  local_2c8 = 0;
  local_208[0] = L'\0';
  local_1c8[0] = L'\0';
  local_148[0] = L'\0';
  local_278._0_4_ = 0x70;
  local_238 = 0;
  pvVar5 = GetCurrentProcess();
  uVar1 = FUN_18006e864(pvVar5,uVar9,param_1,local_1c8,in_stack_fffffffffffffd08,local_148,
                        in_stack_fffffffffffffd18,local_208);
  if ((int)uVar1 < 0) {
    DbgPrintEx(0x96,0,
               "WER/ReportFault:%u: ERROR Failed to get the paths for the crash vertical: HRESULT %08X.\n"
               ,0x222);
  }
  else {
    pvVar5 = GetCurrentProcess();
    uVar1 = FUN_18006b92c((longlong)pvVar5);
    uVar1 = -(uint)(uVar1 != 0) & 0x40000;
    local_2b0 = SetErrorMode(1);
    lpOldMode = &local_2c4;
    SetThreadErrorMode(1,lpOldMode);
    lVar6 = RtlGetCurrentTransaction();
    RtlSetCurrentTransaction();
    lpAddress = p_Var8;
    do {
      iVar7 = (int)p_Var8;
      uVar10 = uVar1;
      if (iVar7 == 0) {
        local_2c8 = 4;
      }
      else if (iVar7 == 1) {
        local_2c8 = 0;
        uVar10 = uVar1 | 0x1000000;
      }
      else {
        if (iVar7 != 2) goto LAB_18006ee03;
        local_2c8 = 0;
      }
      if (lpAddress != (LPPROC_THREAD_ATTRIBUTE_LIST)0x0) {
        lpOldMode = (LPDWORD)0x0;
        VirtualFree(lpAddress,0,0x8000);
        local_2c0 = (LPPROC_THREAD_ATTRIBUTE_LIST)0x0;
      }
      uVar2 = FUN_18006ee80(&local_2c0,lpOldMode,&local_2c8,local_2a8,local_2b4,&local_2b8);
      lpAddress = local_2c0;
      if ((int)uVar2 < 0) {
        DbgPrintEx(0x96,0,
                   "WER/ReportFault:%u: ERROR WerpBuildCreateProcessAttributeList failed, HRESULT %08X.\n"
                   ,0x26e);
        lpAddress = local_2c0;
        goto LAB_18006ee03;
      }
      local_210 = local_2c0;
      BVar3 = CreateProcessW(local_1c8,local_148,(LPSECURITY_ATTRIBUTES)0x0,
                             (LPSECURITY_ATTRIBUTES)0x0,1,
                             -(uint)(local_2c0 != (LPPROC_THREAD_ATTRIBUTE_LIST)0x0) & 0x80000 |
                             uVar10,(LPVOID)0x0,local_208,(LPSTARTUPINFOW)local_278,
                             (LPPROCESS_INFORMATION)local_298);
      if (BVar3 != 0) break;
      iVar4 = FUN_18006f170();
      if (iVar7 == 0) {
        if (iVar4 != 0x522) {
LAB_18006eda3:
          DbgPrintEx(0x96,0,
                     "WER/ReportFault:%u: ERROR CreateProcess/mode%u failed with Win32 error %u.\n",
                     0x296);
          goto LAB_18006ee03;
        }
        uVar9 = 0x28b;
      }
      else {
        if ((iVar7 != 1) || (iVar4 != 5)) goto LAB_18006eda3;
        uVar9 = 0x291;
      }
      lpOldMode = (LPDWORD)0x1;
      DbgPrintEx(0x96,1,
                 "WER/ReportFault:%u: WARNING CreateProcess/mode%u failed with Win32 error %u.\n",
                 uVar9);
      p_Var8 = (LPPROC_THREAD_ATTRIBUTE_LIST)(ulonglong)(iVar7 + 1U);
    } while (iVar7 + 1U < 3);
    *local_2a0 = local_298._0_8_;
    NtClose(local_298._8_8_);
LAB_18006ee03:
    SetErrorMode(local_2b0);
    SetThreadErrorMode(local_2c4,(LPDWORD)0x0);
    if (lVar6 != 0) {
      RtlSetCurrentTransaction(lVar6);
    }
    if (lpAddress != (LPPROC_THREAD_ATTRIBUTE_LIST)0x0) {
      VirtualFree(lpAddress,0,0x8000);
    }
  }
  __security_check_cookie(local_48 ^ (ulonglong)auStackY792);
  return;
}



uint FUN_18006ee80(LPPROC_THREAD_ATTRIBUTE_LIST *param_1,undefined8 param_2,int *param_3,
                  PVOID param_4,uint param_5,int *param_6)

{
  bool bVar1;
  int iVar2;
  BOOL BVar3;
  uint uVar4;
  uint uVar5;
  LPPROC_THREAD_ATTRIBUTE_LIST lpAttributeList;
  int iVar6;
  int iVar7;
  DWORD dwAttributeCount;
  char *pcVar8;
  undefined8 uVar9;
  SIZE_T local_res10;
  ulonglong in_stack_ffffffffffffffb8;
  
  local_res10 = 0;
  lpAttributeList = (LPPROC_THREAD_ATTRIBUTE_LIST)0x0;
  *param_1 = (LPPROC_THREAD_ATTRIBUTE_LIST)0x0;
  bVar1 = false;
  iVar6 = 1;
  if ((param_3 == (int *)0x0) || (iVar7 = iVar6, *param_3 == 0)) {
    iVar7 = 0;
  }
  if ((param_4 == (PVOID)0x0) || (iVar2 = iVar6, param_5 == 0)) {
    iVar2 = 0;
  }
  if ((param_6 == (int *)0x0) || (*param_6 == 0)) {
    iVar6 = 0;
  }
  dwAttributeCount = iVar7 + iVar2 + iVar6;
  if (dwAttributeCount == 0) {
LAB_18006efe9:
    if ((param_3 != (int *)0x0) && (*param_3 != 0)) {
      in_stack_ffffffffffffffb8 = 0;
      BVar3 = UpdateProcThreadAttribute(lpAttributeList,0,0x60001,param_3,4,(PVOID)0x0,(PSIZE_T)0x0)
      ;
      if (BVar3 == 0) {
        uVar4 = FUN_18006f170();
        uVar5 = FUN_18006b134(uVar4);
        uVar9 = 0x19e;
        pcVar8 = "WER/ReportFault:%u: ERROR UpdateProcThreadAttribute/EXTENDED_FLAGS failed: %u.\n";
        goto LAB_18006ef3a;
      }
    }
    if ((param_4 != (PVOID)0x0) && (param_5 != 0)) {
      in_stack_ffffffffffffffb8 = (ulonglong)param_5 << 3;
      BVar3 = UpdateProcThreadAttribute
                        (lpAttributeList,0,0x20002,param_4,in_stack_ffffffffffffffb8,(PVOID)0x0,
                         (PSIZE_T)0x0);
      if (BVar3 == 0) {
        uVar4 = FUN_18006f170();
        uVar5 = FUN_18006b134(uVar4);
        uVar9 = 0x1b1;
        pcVar8 = "WER/ReportFault:%u: ERROR UpdateProcThreadAttribute/HANDLE_LIST failed: %u.\n";
        goto LAB_18006ef3a;
      }
    }
    if ((param_6 != (int *)0x0) && (*param_6 != 0)) {
      in_stack_ffffffffffffffb8 = 0;
      BVar3 = UpdateProcThreadAttribute(lpAttributeList,0,0x2000e,param_6,4,(PVOID)0x0,(PSIZE_T)0x0)
      ;
      if (BVar3 == 0) {
        uVar4 = FUN_18006f170();
        uVar5 = FUN_18006b134(uVar4);
        uVar9 = 0x1c4;
        pcVar8 = "WER/ReportFault:%u: ERROR UpdateProcThreadAttribute/CHILD_PROCESS failed: %u.\n";
        goto LAB_18006ef3a;
      }
    }
    *param_1 = lpAttributeList;
    uVar5 = (uint)(lpAttributeList == (LPPROC_THREAD_ATTRIBUTE_LIST)0x0);
  }
  else {
    BVar3 = InitializeProcThreadAttributeList
                      ((LPPROC_THREAD_ATTRIBUTE_LIST)0x0,dwAttributeCount,0,&local_res10);
    if ((BVar3 == 0) && (iVar6 = FUN_18006f170(), iVar6 != 0x7a)) {
      uVar4 = FUN_18006f170();
      uVar5 = FUN_18006b134(uVar4);
      uVar9 = 0x15c;
    }
    else {
      lpAttributeList = (LPPROC_THREAD_ATTRIBUTE_LIST)VirtualAlloc((LPVOID)0x0,local_res10,0x1000,4)
      ;
      if (lpAttributeList == (LPPROC_THREAD_ATTRIBUTE_LIST)0x0) {
        uVar5 = 0x8007000e;
        DbgPrintEx(0x96,0,
                   "WER/ReportFault:%u: ERROR Failed to allocate attribute list: HRESULT %08X.\n",
                   0x169,0x8007000e);
        goto LAB_18006f136;
      }
      BVar3 = InitializeProcThreadAttributeList(lpAttributeList,dwAttributeCount,0,&local_res10);
      if (BVar3 != 0) {
        bVar1 = true;
        goto LAB_18006efe9;
      }
      uVar4 = FUN_18006f170();
      uVar5 = FUN_18006b134(uVar4);
      uVar9 = 0x176;
    }
    pcVar8 = "WER/ReportFault:%u: ERROR InitializeProcThreadAttributeList failed: %u.\n";
LAB_18006ef3a:
    DbgPrintEx(0x96,0,pcVar8,uVar9,in_stack_ffffffffffffffb8 & 0xffffffff00000000 | (ulonglong)uVar4
              );
  }
  if (-1 < (int)uVar5) {
    return uVar5;
  }
  if ((bVar1) && (lpAttributeList != (LPPROC_THREAD_ATTRIBUTE_LIST)0x0)) {
    DeleteProcThreadAttributeList(lpAttributeList);
  }
LAB_18006f136:
  VirtualFree(lpAttributeList,0,0x8000);
  return uVar5;
}



void FUN_18006f170(void)

{
  return;
}



bool FUN_18006f1b4(int **param_1)

{
  return **param_1 != -0x3fffff03;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18006f2e0(int **param_1)

{
  bool bVar1;
  int **ppiVar2;
  uint uVar3;
  BOOL BVar4;
  DWORD DVar5;
  int iVar6;
  HANDLE pvVar7;
  HANDLE pvVar8;
  HANDLE pvVar9;
  undefined4 *puVar10;
  ulonglong uVar11;
  undefined4 *lpBaseAddress;
  ulonglong uVar12;
  char *pcVar13;
  undefined8 uVar14;
  longlong in_GS_OFFSET;
  undefined auStackY280 [32];
  uint local_d8;
  HANDLE local_d0;
  HANDLE local_c8;
  HANDLE local_c0;
  HANDLE local_b8;
  HANDLE local_b0;
  undefined4 *local_a8;
  HANDLE local_a0;
  int *local_98;
  undefined local_90 [16];
  undefined8 local_80;
  BOOL local_78;
  undefined4 local_74;
  int **local_70;
  longlong local_68;
  undefined local_60 [16];
  undefined8 local_50;
  undefined local_48 [8];
  HANDLE pvStack64;
  undefined local_38 [16];
  undefined8 local_28;
  ulonglong local_20;
  
  local_20 = DAT_1800b2220 ^ (ulonglong)auStackY280;
  lpBaseAddress = (undefined4 *)0x0;
  local_a8 = (undefined4 *)0x0;
  local_b8 = (HANDLE)0x0;
  local_b0 = (HANDLE)0x0;
  local_a0 = (HANDLE)0x0;
  local_c0 = (HANDLE)0x0;
  local_c8 = (HANDLE)0x0;
  _local_48 = ZEXT816(0);
  local_38 = ZEXT816(0);
  local_28 = 0;
  local_d0 = (HANDLE)0x0;
  local_98 = (int *)0x0;
  local_90 = CONCAT124(SUB1612(ZEXT816(0) >> 0x20,0),0x18);
  local_90 = local_90 & (undefined  [16])0xffffffffffffffff;
  local_80 = 1;
  local_70 = param_1;
  pvVar7 = CreateEventW((LPSECURITY_ATTRIBUTES)local_90,1,0,(LPCWSTR)0x0);
  local_b8 = pvVar7;
  if (pvVar7 == (HANDLE)0x0) {
    FUN_18006f170();
    DbgPrintEx(0x96,1,"WER/ReportFault:%u: WARNING CreateEvent/hRecoveryEvent failed: %u.\n",0x305);
  }
  else {
    _local_48 = CONCAT88(pvStack64,pvVar7);
  }
  bVar1 = pvVar7 != (HANDLE)0x0;
  uVar11 = (ulonglong)bVar1;
  pvVar8 = CreateEventW((LPSECURITY_ATTRIBUTES)local_90,1,0,(LPCWSTR)0x0);
  local_b0 = pvVar8;
  if (pvVar8 == (HANDLE)0x0) {
    FUN_18006f170();
    DbgPrintEx(0x96,1,"WER/ReportFault:%u: WARNING CreateEvent/hCompletionEvent failed: %u.\n",0x310
              );
  }
  else {
    *(HANDLE *)(local_48 + uVar11 * 8) = pvVar8;
    uVar11 = (ulonglong)(bVar1 + 1);
  }
  pvVar9 = CreateFileMappingW((HANDLE)0xffffffffffffffff,(LPSECURITY_ATTRIBUTES)local_90,4,0,0xf8,
                              (LPCWSTR)0x0);
  local_a0 = pvVar9;
  if (pvVar9 == (HANDLE)0x0) {
    uVar3 = FUN_18006f170();
    uVar14 = 0x327;
    pcVar13 = "WER/ReportFault:%u: ERROR CreateFileMapping failed: %u.\n";
LAB_18006f92d:
    uVar3 = uVar3 | 0x10000000;
  }
  else {
    *(HANDLE *)(local_48 + uVar11 * 8) = pvVar9;
    local_d8 = (int)uVar11 + 1;
    uVar12 = (ulonglong)local_d8;
    puVar10 = (undefined4 *)MapViewOfFile(pvVar9,6,0,0,0);
    local_a8 = puVar10;
    if (puVar10 == (undefined4 *)0x0) {
      uVar3 = FUN_18006f170();
      uVar14 = 0x333;
      pcVar13 = "WER/ReportFault:%u: ERROR MapViewOfFile failed: %u.\n";
      lpBaseAddress = puVar10;
      goto LAB_18006f92d;
    }
    pvVar7 = GetCurrentProcess();
    pvVar8 = GetCurrentProcess();
    pvVar9 = GetCurrentProcess();
    BVar4 = DuplicateHandle(pvVar9,pvVar8,pvVar7,&local_c0,0x1fffff,1,0);
    if (BVar4 == 0) {
      FUN_18006f170();
      DbgPrintEx(0x96,1,
                 "WER/ReportFault:%u: WARNING DuplicateHandle of current process failed: %u.\n",
                 0x34d);
    }
    else {
      *(HANDLE *)(local_48 + uVar12 * 8) = local_c0;
      local_d8 = (int)uVar11 + 2;
      uVar12 = (ulonglong)local_d8;
    }
    pvVar7 = GetCurrentProcess();
    pvVar8 = GetCurrentProcess();
    local_78 = DuplicateHandle(pvVar8,(HANDLE)0xfffffffffffffffe,pvVar7,&local_c8,0x1fffff,1,0);
    if (local_78 == 0) {
      FUN_18006f170();
      DbgPrintEx(0x96,1,
                 "WER/ReportFault:%u: WARNING DuplicateHandle of current thread failed: %u.\n",0x35e
                );
    }
    else {
      *(HANDLE *)(local_48 + uVar12 * 8) = local_c8;
      local_d8 = (int)uVar12 + 1;
    }
    *puVar10 = 0xf8;
    DVar5 = GetCurrentProcessId();
    ppiVar2 = local_70;
    lpBaseAddress = local_a8;
    pvVar8 = local_b0;
    pvVar7 = local_b8;
    puVar10[1] = DVar5;
    local_68 = *(longlong *)(in_GS_OFFSET + 0x30);
    local_74 = *(undefined4 *)(local_68 + 0x48);
    local_a8[2] = local_74;
    *(int ***)(local_a8 + 0x2a) = local_70;
    local_a8[0x2c] = 0x80004005;
    *(HANDLE *)(local_a8 + 0x2e) = local_c0;
    *(HANDLE *)(local_a8 + 0x30) = local_c8;
    *(HANDLE *)(local_a8 + 0x32) = local_b8;
    *(HANDLE *)(local_a8 + 0x34) = local_b0;
    *(undefined8 *)(local_a8 + 0x38) = 0;
    local_a8[0x3a] = 0xc0000001;
    local_a8[0x3b] = 0;
    DVar5 = GetTickCount();
    lpBaseAddress[0x3c] = DVar5;
    DVar5 = GetCurrentProcessId();
    pvVar9 = local_a0;
    iVar6 = RtlWerpReportException(DVar5,local_a0,local_48,local_d8);
    if (-1 < iVar6) {
      if (iVar6 != 0x1b000b) {
LAB_18006f7d8:
        if (local_d0 == (HANDLE)0x0) {
          uVar3 = 0x1b0002;
        }
        else {
          local_60 = ZEXT816(0);
          local_50 = 0;
          DVar5 = 0xd000022d;
LAB_18006f806:
          if (DVar5 == 0xd000022d) {
            uVar11 = 1;
            if (pvVar8 != (HANDLE)0x0) {
              uVar11 = 2;
              local_60._8_8_ = pvVar8;
            }
            local_60 = CONCAT88(local_60._8_8_,local_d0);
            if (pvVar7 != (HANDLE)0x0) {
              *(HANDLE *)(local_60 + uVar11 * 8) = pvVar7;
              uVar11 = (ulonglong)((int)uVar11 + 1);
            }
            DVar5 = WaitForMultipleObjects((DWORD)uVar11,(HANDLE *)local_60,0,0xffffffff);
            if (DVar5 == 0) {
LAB_18006f8b9:
              DVar5 = 0;
            }
            else {
              if (DVar5 == 1) {
                if (pvVar8 != (HANDLE)0x0) goto LAB_18006f8b9;
              }
              else if (DVar5 != 2) {
                if (0 < (int)DVar5) {
                  DVar5 = DVar5 & 0xffff | 0x80070000;
                }
                DbgPrintEx(0x96,0);
                goto LAB_18006f806;
              }
              if ((pvVar7 == (HANDLE)0x0) || (uVar14 = FUN_18006b804(&local_98), (int)uVar14 < 0))
              goto LAB_18006f8b9;
              NtClose(pvVar7);
              pvVar7 = (HANDLE)0x0;
              local_b8 = (HANDLE)0x0;
              FUN_18006e064((longlong)local_98);
              DVar5 = 0xd000022d;
            }
            goto LAB_18006f806;
          }
          uVar3 = lpBaseAddress[0x2c];
          pvVar7 = local_b8;
          lpBaseAddress = local_a8;
          pvVar9 = local_a0;
          pvVar8 = local_b0;
        }
        goto LAB_18006f949;
      }
      uVar14 = 0x3b6;
      pcVar13 = 
      "WER/ReportFault:%u: ERROR RtlWerpReportException failed: too many concurrent workers\n";
LAB_18006f75f:
      uVar3 = 0x1b000b;
      DbgPrintEx(0x96,0,pcVar13,uVar14);
      goto LAB_18006f949;
    }
    DbgPrintEx(0x96,1,"WER/ReportFault:%u: WARNING RtlWerpReportException failed: NTSTATUS %08X.\n",
               900);
    if (iVar6 == -0x3fffffbf) {
      uVar14 = 0x38f;
      pcVar13 = "WER/ReportFault:%u: ERROR RtlWerpReportException failed: Service port busy\n";
      goto LAB_18006f75f;
    }
    if (**ppiVar2 == -0x3fffff03) {
      uVar3 = 0x80070032;
      goto LAB_18006f949;
    }
    uVar3 = FUN_18006eabc(pvVar9,local_48,local_d8,&local_d0);
    if (-1 < (int)uVar3) goto LAB_18006f7d8;
    uVar14 = 0x3a7;
    pcVar13 = "WER/ReportFault:%u: ERROR StartCrashVertical failed: HRESULT %08X.\n";
  }
  DbgPrintEx(0x96,0,pcVar13,uVar14);
LAB_18006f949:
  if (local_c8 != (HANDLE)0x0) {
    NtClose();
  }
  if (local_c0 != (HANDLE)0x0) {
    NtClose();
  }
  if (pvVar8 != (HANDLE)0x0) {
    NtClose(pvVar8);
  }
  if (pvVar7 != (HANDLE)0x0) {
    NtClose(pvVar7);
  }
  if (lpBaseAddress != (undefined4 *)0x0) {
    UnmapViewOfFile(lpBaseAddress);
  }
  if (pvVar9 != (HANDLE)0x0) {
    NtClose(pvVar9);
  }
  if (local_d0 != (HANDLE)0x0) {
    NtClose();
  }
  FUN_18006ea20(uVar3);
  __security_check_cookie(local_20 ^ (ulonglong)auStackY280);
  return;
}



void FUN_18006fa15(undefined8 param_1,longlong param_2)

{
  if (*(longlong *)(param_2 + 0x50) != 0) {
    NtClose();
  }
  if (*(longlong *)(param_2 + 0x58) != 0) {
    NtClose();
  }
  if (*(longlong *)(param_2 + 0x68) != 0) {
    NtClose();
  }
  if (*(longlong *)(param_2 + 0x60) != 0) {
    NtClose();
  }
  if (*(LPCVOID *)(param_2 + 0x70) != (LPCVOID)0x0) {
    UnmapViewOfFile(*(LPCVOID *)(param_2 + 0x70));
  }
  if (*(longlong *)(param_2 + 0x78) != 0) {
    NtClose();
  }
  if (*(longlong *)(param_2 + 0x48) != 0) {
    NtClose();
  }
  return;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Exceeded maximum restarts with more pending

bool BaseFlushAppcompatCacheWorker(void)

{
  int iVar1;
  undefined local_188 [248];
  undefined4 local_90;
  
                    // 0x6fad0  55  BaseFlushAppcompatCacheWorker
  memset(local_188,0,0x178);
  local_90 = 0xfff;
  iVar1 = NtApphelpCacheControl();
  return -1 < iVar1;
}



bool BaseUpdateAppcompatCacheWorker(LPCWSTR param_1,ulonglong param_2,int param_3)

{
  ulonglong uVar1;
  bool bVar2;
  
                    // 0x6fb30  71  BaseUpdateAppcompatCacheWorker
  if (param_3 == 0) {
    bVar2 = false;
  }
  else {
    uVar1 = FUN_1800703f4(param_1,param_2);
    bVar2 = -1 < (int)uVar1;
  }
  return bVar2;
}



DWORD FUN_18006fb5c(HANDLE param_1,LPVOID param_2)

{
  int iVar1;
  DWORD DVar2;
  BOOL BVar3;
  LPCVOID local_res8;
  
  DVar2 = 0;
  local_res8 = (LPCVOID)0x0;
  if ((param_1 == (HANDLE)0x0) || (param_2 == (LPVOID)0x0)) {
    DVar2 = 0x57;
  }
  else {
    iVar1 = NtQueryInformationProcess(param_1,0x1a,&local_res8,8,0);
    if (iVar1 < 0) {
      DVar2 = RtlNtStatusToDosError(iVar1);
    }
    else if (local_res8 == (LPCVOID)0x0) {
      DVar2 = 0xd;
    }
    else {
      BVar3 = ReadProcessMemory(param_1,local_res8,param_2,0x480,(SIZE_T *)0x0);
      if (BVar3 == 0) {
        DVar2 = GetLastError();
      }
    }
  }
  return DVar2;
}



int FUN_18006fc10(longlong *param_1)

{
  int iVar1;
  longlong lVar2;
  
  iVar1 = FUN_180016834();
  if (-1 < iVar1) {
    lVar2 = RtlDecodeSystemPointer(DAT_1800b2d60);
    iVar1 = 0;
    *param_1 = lVar2;
    if (lVar2 == 0) {
      iVar1 = -0x3fffffff;
    }
  }
  return iVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Exceeded maximum restarts with more pending

bool BasepInitAppCompatData(longlong param_1,undefined8 param_2,undefined4 param_3)

{
  int iVar1;
  bool bVar2;
  undefined local_188 [328];
  longlong local_40;
  undefined8 local_38;
  undefined4 local_30;
  
                    // 0x6fc60  92  BasepInitAppCompatData
  bVar2 = false;
  if (param_1 != 0) {
    memset(local_188,0,0x178);
    local_40 = param_1;
    local_38 = param_2;
    local_30 = param_3;
    iVar1 = NtApphelpCacheControl();
    bVar2 = -1 < iVar1;
  }
  return bVar2;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

undefined4
BasepQueryModuleChpeSettings
          (undefined8 *param_1,int param_2,undefined8 param_3,undefined8 param_4,undefined8 param_5,
          longlong param_6,longlong *param_7,undefined4 *param_8,void **param_9,int *param_10)

{
  int iVar1;
  undefined4 uVar2;
  short local_res8 [4];
  undefined4 local_a8;
  undefined4 local_a4;
  undefined4 local_a0 [2];
  longlong local_98;
  code *local_90;
  ulonglong local_88;
  undefined8 local_80;
  undefined local_78 [16];
  undefined local_68 [16];
  undefined4 local_58;
  undefined8 local_50;
  undefined *local_48;
  undefined4 local_40;
  undefined local_38 [16];
  
                    // 0x6fcf0  99  BasepQueryModuleChpeSettings
  if ((param_1 == (undefined8 *)0x0) || (param_2 != 0x20)) {
    uVar2 = 0x57;
  }
  else {
    *(byte *)((longlong)param_1 + 0x15) = *(byte *)((longlong)param_1 + 0x15) & 0xfe;
    *param_1 = 0;
    *(undefined4 *)(param_1 + 1) = 0x80000000;
    uVar2 = 0;
    *(undefined4 *)((longlong)param_1 + 0xc) = 0;
    *(undefined4 *)(param_1 + 2) = 0x2000000;
    *(undefined *)((longlong)param_1 + 0x14) = 0x54;
    param_1[3] = 0;
    local_res8[0] = 0x14c;
    local_98 = 0;
    local_a0[0] = 0;
    local_80 = 0;
    local_a4 = 0;
    local_88 = 0;
    local_a8 = 0;
    local_90 = (code *)0x0;
    local_68 = ZEXT816(0);
    local_78 = ZEXT816(0);
    iVar1 = RtlDosPathNameToNtPathName_U_WithStatus(param_3,local_78,0,0);
    if (iVar1 < 0) {
      uVar2 = 3;
    }
    else {
      local_48 = local_78;
      local_58 = 0x30;
      local_50 = 0;
      local_40 = 0x40;
      local_38 = ZEXT816(0);
      iVar1 = NtCreateFile();
      if (iVar1 < 0) {
        uVar2 = 0x6e;
      }
      else {
        BasepQueryAppCompat(0,0,0,local_98,0,param_3,param_5,param_6,param_7,param_8,param_9,
                            param_10,local_a0,&local_80,&local_a4,local_res8,&local_88,&local_a8);
        iVar1 = FUN_18006fc10((longlong *)&local_90);
        if (iVar1 < 0) {
          uVar2 = 0x7f;
        }
        else {
          (*local_90)();
        }
      }
    }
    if (local_98 != 0) {
      NtClose();
    }
    RtlFreeUnicodeString(local_78);
  }
  return uVar2;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

ulonglong BaseQueryModuleData(undefined param_1,undefined param_2,undefined param_3,
                             undefined param_4,undefined8 param_5,undefined8 param_6,
                             undefined8 param_7)

{
  code *pcVar1;
  byte bVar2;
  
                    // 0x6ff40  66  BaseQueryModuleData
  bVar2 = 0;
  pcVar1 = (code *)FUN_180016834();
  if (-1 < (int)pcVar1) {
    pcVar1 = (code *)RtlDecodeSystemPointer(DAT_1800b2d50);
    if (pcVar1 != (code *)0x0) {
      pcVar1 = (code *)(*pcVar1)();
      bVar2 = (byte)pcVar1;
    }
  }
  return (ulonglong)pcVar1 & 0xffffffffffffff00 | (ulonglong)bVar2;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

ulonglong FUN_18006ff4c(undefined param_1,undefined param_2,undefined param_3,undefined param_4,
                       undefined8 param_5,undefined8 param_6,undefined8 param_7)

{
  code *pcVar1;
  byte bVar2;
  
  bVar2 = 0;
  pcVar1 = (code *)FUN_180016834();
  if (-1 < (int)pcVar1) {
    pcVar1 = (code *)RtlDecodeSystemPointer(DAT_1800b2d50);
    if (pcVar1 != (code *)0x0) {
      pcVar1 = (code *)(*pcVar1)();
      bVar2 = (byte)pcVar1;
    }
  }
  return (ulonglong)pcVar1 & 0xffffffffffffff00 | (ulonglong)bVar2;
}



uint QuirkGetData2Worker(wchar_t *param_1,int *param_2)

{
  uint uVar1;
  uint uVar2;
  wchar_t *pwVar3;
  
                    // 0x6fff0  1119  QuirkGetData2Worker
  if (((param_1 == (wchar_t *)0x0) || (param_2 == (int *)0x0)) || (*param_2 != 0x208)) {
    uVar1 = 0x80070057;
  }
  else {
    pwVar3 = param_1;
    if ((DAT_1800b2d98 == 0) && (uVar1 = FUN_1800093c4(), (int)uVar1 < 0)) {
      uVar1 = uVar1 | 0x10000000;
    }
    else {
      pwVar3 = FUN_1800702fc(pwVar3,param_1);
      if (pwVar3 == (wchar_t *)0x0) {
        uVar1 = 0x80070490;
      }
      else {
        param_2[1] = *(int *)(pwVar3 + 0x8a);
        uVar1 = FUN_18000b370((short *)(param_2 + 2),0x80,(longlong)pwVar3);
        if ((-1 < (int)uVar1) &&
           (uVar2 = FUN_18000b370((short *)(param_2 + 0x42),0x80,(longlong)(pwVar3 + 0x94)),
           uVar1 = 0, (int)uVar2 < 0)) {
          uVar1 = uVar2;
        }
      }
    }
  }
  return uVar1;
}



uint QuirkGetDataWorker(uint param_1,int *param_2)

{
  uint uVar1;
  uint uVar2;
  longlong lVar3;
  
                    // 0x700c0  1120  QuirkGetDataWorker
  if ((param_2 == (int *)0x0) || (*param_2 != 0x208)) {
    uVar1 = 0x80070057;
  }
  else if ((DAT_1800b2d98 == 0) && (uVar1 = FUN_1800093c4(), (int)uVar1 < 0)) {
    uVar1 = uVar1 | 0x10000000;
  }
  else {
    lVar3 = FUN_18000bde0(DAT_1800b2d98,param_1);
    if (lVar3 == 0) {
      uVar1 = 0x80070490;
    }
    else {
      param_2[1] = param_1;
      uVar1 = FUN_18000b370((short *)(param_2 + 2),0x80,lVar3);
      if (-1 < (int)uVar1) {
        uVar2 = FUN_18000b370((short *)(param_2 + 0x42),0x80,lVar3 + 0x128);
        uVar1 = 0;
        if ((int)uVar2 < 0) {
          uVar1 = uVar2;
        }
      }
    }
  }
  return uVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint QuirkIsEnabled2Worker(uint param_1,ulonglong param_2)

{
  int iVar1;
  longlong lVar2;
  longlong lVar3;
  HANDLE pvVar4;
  byte bVar5;
  uint uVar6;
  longlong in_GS_OFFSET;
  
                    // 0x70180  1121  QuirkIsEnabled2Worker
  uVar6 = 0;
  lVar2 = *(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x2d8);
  if ((((param_2 != 0xffffffffffffffff) ||
       ((lVar2 != 0 && ((*(uint *)(lVar2 + 0x2d8) & 0x400) != 0)))) &&
      ((DAT_1800b2d98 != 0 || (iVar1 = FUN_1800093c4(), -1 < iVar1)))) &&
     (lVar2 = FUN_18000bde0(DAT_1800b2d98,param_1), uVar6 = 0, lVar2 != 0)) {
    lVar3 = FUN_18001f5dc(*(longlong *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x2d8));
    if (lVar3 == 0) {
      bVar5 = 0;
    }
    else {
      bVar5 = (byte)*(undefined4 *)(lVar3 + 0x20);
    }
    uVar6 = 1;
    if ((*(ulonglong *)(lVar2 + 0x10c) & 1 << (bVar5 & 0x3f) & 0xffffffffU) == 0) {
      uVar6 = 0;
    }
    else {
      if (DAT_1800b230c == -1) {
        if ((*(uint *)(lVar2 + 0x228) & 1) == 0) {
          if ((*(uint *)(lVar2 + 0x228) & 2) == 0) {
            uVar6 = (uint)(param_2 < *(ulonglong *)(lVar2 + 0x104));
          }
          else {
            uVar6 = 0;
          }
        }
      }
      else {
        uVar6 = (uint)(DAT_1800b230c != 0);
      }
      if ((uVar6 != 0) && (((byte)*(uint *)(lVar2 + 0x228) & 0xc) == 4)) {
        *(uint *)(lVar2 + 0x228) = *(uint *)(lVar2 + 0x228) | 8;
      }
    }
    if (_DAT_1800b2cec != 0) {
      pvVar4 = GetCurrentProcess();
      FUN_18000bd38(lVar2,uVar6,pvVar4,(undefined2 *)0x0,(undefined2 *)0x0);
    }
  }
  return uVar6;
}



uint QuirkIsEnabledForPackage2Worker
               (undefined2 *param_1,undefined2 *param_2,uint param_3,ulonglong param_4,uint *param_5
               )

{
  uint uVar1;
  
                    // 0x702d0  1123  QuirkIsEnabledForPackage2Worker
  uVar1 = FUN_180009000(param_1,param_2,param_3,param_4,0xffffffff,param_5);
  if (-1 < (int)uVar1) {
    uVar1 = 0;
  }
  return uVar1;
}



// WARNING: Could not reconcile some variable overlaps

wchar_t * FUN_1800702fc(undefined8 param_1,wchar_t *param_2)

{
  longlong lVar1;
  longlong lVar2;
  int iVar3;
  ushort uVar4;
  ushort uVar5;
  wchar_t *_Str1;
  ulonglong uVar6;
  undefined8 local_res8;
  undefined local_38 [16];
  
  lVar2 = DAT_1800b2d98;
  local_res8 = param_1;
  iVar3 = RtlInitUnicodeStringEx(local_38);
  if ((((-1 < iVar3) && (iVar3 = RtlHashUnicodeString(local_38,1,0,&local_res8), -1 < iVar3)) &&
      ((int)local_res8 != 0)) && (uVar5 = 0, *(short *)(lVar2 + 2) != 0)) {
    do {
      uVar6 = (ulonglong)uVar5;
      uVar4 = 0;
      lVar1 = *(longlong *)(lVar2 + 0x10 + uVar6 * 0x10);
      if (*(short *)(lVar2 + 8 + uVar6 * 0x10) != 0) {
        do {
          _Str1 = (wchar_t *)((ulonglong)uVar4 * 0x22c + lVar1 + lVar2);
          if ((*(int *)(_Str1 + 0x80) == (int)local_res8) &&
             (iVar3 = _wcsicmp(_Str1,param_2), iVar3 == 0)) {
            return _Str1;
          }
          uVar4 = uVar4 + 1;
        } while (uVar4 < *(ushort *)(lVar2 + 8 + uVar6 * 0x10));
      }
      uVar5 = uVar5 + 1;
    } while (uVar5 < *(ushort *)(lVar2 + 2));
  }
  return (wchar_t *)0x0;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Could not reconcile some variable overlaps
// WARNING: Exceeded maximum restarts with more pending

ulonglong FUN_1800703f4(LPCWSTR param_1,ulonglong param_2)

{
  uint uVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  ulonglong local_1b8;
  undefined4 local_1b0;
  undefined local_1a8 [12];
  undefined4 uStack412;
  undefined8 local_198;
  undefined local_188 [256];
  undefined4 local_88;
  ulonglong local_70;
  undefined4 local_68;
  undefined4 uStack100;
  undefined4 uStack96;
  undefined4 uStack92;
  
  local_1b8 = 0;
  local_1b0 = 0;
  _local_1a8 = ZEXT816(0);
  local_198 = 0;
  uVar2 = FUN_180018ba8(&local_1b8,param_1,param_2);
  uVar3 = uVar2 & 0xffffffff;
  if (-1 < (int)uVar2) {
    memset(local_188,0,0x178);
    local_70 = local_1b8;
    local_68 = local_1a8._8_4_;
    uStack100 = uStack412;
    uStack96 = (undefined4)local_198;
    uStack92 = local_198._4_4_;
    local_88 = 0x109f;
    uVar1 = NtApphelpCacheControl();
    uVar3 = (ulonglong)uVar1;
  }
  FUN_180018b64((longlong *)&local_1b8);
  return uVar3;
}



uint FUN_1800704a4(uint param_1,byte *param_2,uint param_3)

{
  byte bVar1;
  uint uVar2;
  ulonglong uVar3;
  
  uVar2 = ~param_1;
  if (param_3 != 0) {
    uVar3 = (ulonglong)param_3;
    do {
      bVar1 = *param_2;
      param_2 = param_2 + 1;
      uVar2 = *(uint *)(&DAT_18008d3c0 + (((ulonglong)uVar2 ^ (ulonglong)bVar1) & 0xff) * 4) ^
              uVar2 >> 8;
      uVar3 = uVar3 - 1;
    } while (uVar3 != 0);
  }
  return ~uVar2;
}



undefined8 FUN_1800704f0(wchar_t *param_1)

{
  int iVar1;
  undefined8 uVar2;
  undefined8 local_res8;
  undefined8 in_stack_ffffffffffffff98;
  undefined4 uVar3;
  undefined local_58 [8];
  wchar_t *local_50;
  undefined local_48 [16];
  undefined4 local_38 [2];
  undefined8 local_30;
  undefined *local_28;
  undefined4 local_20;
  undefined local_18 [16];
  
  uVar3 = (undefined4)((ulonglong)in_stack_ffffffffffffff98 >> 0x20);
  uVar2 = 0;
  local_50 = (wchar_t *)0x0;
  iVar1 = _wcsnicmp(param_1,L"\\SystemRoot\\",0xc);
  if (iVar1 == 0) {
    RtlInitUnicodeString(local_58,param_1);
  }
  else {
    iVar1 = RtlDosPathNameToNtPathName_U_WithStatus(param_1,local_58,0,0);
    if (iVar1 < 0) {
      FUN_18001188c(1,0xb8,0xde,0x78,(char)param_1);
      goto LAB_1800705f4;
    }
  }
  local_30 = 0;
  local_28 = local_58;
  local_38[0] = 0x30;
  local_20 = 0x40;
  local_18 = ZEXT816(0);
  iVar1 = ZwOpenFile(&local_res8,0x100080,local_38,local_48,CONCAT44(uVar3,3),1);
  if (iVar1 < 0) {
    if ((iVar1 != -0x3fffffde) && (iVar1 != -0x3fffffbd)) goto LAB_1800705f4;
  }
  else {
    ZwClose(local_res8);
  }
  uVar2 = 1;
LAB_1800705f4:
  if ((local_50 != param_1) && (local_50 != (wchar_t *)0x0)) {
    RtlFreeUnicodeString(local_58);
  }
  return uVar2;
}



undefined8 FUN_180070630(undefined8 param_1)

{
  int iVar1;
  undefined8 uVar2;
  undefined8 local_res10 [3];
  undefined local_58 [16];
  undefined local_48 [16];
  undefined4 local_38 [2];
  undefined8 local_30;
  undefined *local_28;
  undefined4 local_20;
  undefined local_18 [16];
  
  uVar2 = 0;
  local_res10[0] = 0;
  local_48 = ZEXT816(0);
  RtlInitUnicodeString(local_58,param_1);
  local_28 = local_58;
  local_38[0] = 0x30;
  local_30 = 0;
  local_20 = 0x40;
  local_18 = ZEXT816(0);
  iVar1 = ZwOpenFile(local_res10,0x100080,local_38,local_48,1,0);
  if (iVar1 < 0) {
    if ((iVar1 == -0x3fffffbd) || (iVar1 == -0x3fffffde)) {
      uVar2 = 1;
    }
  }
  else {
    uVar2 = 1;
    ZwClose(local_res10[0]);
  }
  return uVar2;
}



int FUN_1800706f4(void)

{
  int iVar1;
  
  iVar1 = ZwClose();
  if (iVar1 < 0) {
    FUN_18001188c(1,0x28,0xfe,0x10,(char)iVar1);
  }
  return iVar1;
}



undefined8 FUN_180070740(int param_1)

{
  if (((param_1 != -0x3fffffc6) && (param_1 != -0x3fffffcc)) && (param_1 != -0x3fffff34)) {
    return 0;
  }
  return 1;
}



int FUN_18007076c(undefined8 *param_1,longlong param_2)

{
  bool bVar1;
  int iVar2;
  wchar_t *_Str1;
  uint uVar3;
  undefined uVar4;
  undefined uVar5;
  longlong in_GS_OFFSET;
  uint local_res8 [2];
  uint *in_stack_ffffffffffffff48;
  undefined local_78 [8];
  longlong local_70;
  undefined local_68 [16];
  undefined4 local_58 [2];
  undefined8 local_50;
  undefined *local_48;
  undefined4 local_40;
  undefined local_38 [16];
  
  *param_1 = 0;
  local_res8[0] = 0;
  bVar1 = false;
  RtlInitUnicodeString(local_78);
  uVar3 = 0x208;
  do {
    uVar4 = SUB81(in_stack_ffffffffffffff48,0);
    _Str1 = (wchar_t *)
            RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,uVar3);
    if (_Str1 == (wchar_t *)0x0) {
      FUN_18001188c(1,0x38,0x8a,0x98,uVar4);
      iVar2 = -0x3fffffe9;
      goto LAB_180070981;
    }
    in_stack_ffffffffffffff48 = local_res8;
    iVar2 = RtlGetFullPathName_UEx(param_2,uVar3,_Str1,0);
    if (iVar2 < 0) {
      uVar5 = 0x48;
      uVar4 = 0x95;
      goto LAB_180070947;
    }
    if (uVar3 < local_res8[0]) {
      if (bVar1) {
        FUN_18001188c(1,0x38,0x9d,0x70,(char)in_stack_ffffffffffffff48);
        iVar2 = -0x3fffffdd;
        goto LAB_180070981;
      }
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
      _Str1 = (wchar_t *)0x0;
      uVar3 = local_res8[0];
    }
    bVar1 = true;
  } while (uVar3 <= local_res8[0]);
  iVar2 = _wcsnicmp(_Str1,L"\\SystemRoot\\",0xc);
  if (iVar2 == 0) {
LAB_1800708b5:
    local_48 = local_78;
    local_50 = 0;
    local_58[0] = 0x30;
    local_40 = 0x40;
    local_38 = ZEXT816(0);
    iVar2 = ZwCreateFile(param_1,0x80100080,local_58,local_68,0,0x80,1,1,0x60,0,0);
    if (-1 < iVar2) goto LAB_180070981;
    uVar5 = 0xf0;
    uVar4 = 0xcc;
  }
  else {
    iVar2 = RtlDosPathNameToNtPathName_U_WithStatus(_Str1,local_78,0,0);
    if (-1 < iVar2) goto LAB_1800708b5;
    uVar5 = 0xb8;
    uVar4 = 0xb4;
  }
LAB_180070947:
  FUN_18001188c(1,0x38,uVar4,uVar5,(char)iVar2);
LAB_180070981:
  if (local_70 != param_2) {
    RtlFreeUnicodeString(local_78);
  }
  if (_Str1 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,_Str1);
  }
  return iVar2;
}



// WARNING: Could not reconcile some variable overlaps

undefined8 FUN_1800709e0(undefined2 *param_1,short *param_2)

{
  longlong lVar1;
  undefined8 uVar2;
  longlong in_GS_OFFSET;
  undefined local_18 [16];
  
  local_18 = ZEXT816(0);
  RtlInitUnicodeString(local_18,L"\\Registry\\Machine");
  uVar2 = 0;
  *param_1 = 0;
  lVar1 = -1;
  do {
    lVar1 = lVar1 + 1;
  } while (param_2[lVar1] != 0);
  param_1[1] = ((short)lVar1 + 1) * 2 + local_18._0_2_;
  lVar1 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8);
  *(longlong *)(param_1 + 4) = lVar1;
  if (lVar1 == 0) {
    uVar2 = 0xc0000017;
    FUN_18001188c(1,0x68,0x8c,0x38,(char)param_1[1]);
  }
  else {
    RtlAppendUnicodeStringToString(param_1,local_18);
    if ((param_2 != (short *)0x0) && (*param_2 != 0x5c)) {
      RtlAppendUnicodeToString(param_1,&DAT_180085358);
    }
    RtlAppendUnicodeToString(param_1,param_2);
  }
  return uVar2;
}



void FUN_180070af8(void *param_1,undefined8 param_2,undefined8 param_3,undefined4 param_4)

{
  int iVar1;
  undefined auStack632 [32];
  undefined4 local_258;
  undefined4 *local_250;
  undefined4 local_248 [4];
  undefined local_238 [12];
  uint local_22c;
  undefined local_228 [512];
  ulonglong local_28;
  
  local_28 = DAT_1800b2220 ^ (ulonglong)auStack632;
  local_250 = local_248;
  local_258 = 0x20c;
  local_248[0] = 0;
  iVar1 = ZwEnumerateKey(param_3,param_4,0,local_238);
  if ((-1 < iVar1) && ((local_22c >> 1) + 1 < 0x104)) {
    memcpy(param_1,local_228,(ulonglong)local_22c);
    *(undefined2 *)((longlong)param_1 + ((ulonglong)local_22c & 0xfffffffffffffffe)) = 0;
  }
  __security_check_cookie(local_28 ^ (ulonglong)auStack632);
  return;
}



// WARNING: Could not reconcile some variable overlaps

ulonglong FUN_180070bb4(undefined8 *param_1,short *param_2)

{
  undefined8 uVar1;
  uint uVar2;
  ulonglong uVar3;
  ulonglong uVar4;
  undefined uVar5;
  undefined uVar6;
  longlong in_GS_OFFSET;
  undefined8 local_res8;
  undefined local_48 [16];
  undefined4 local_38 [2];
  undefined8 local_30;
  undefined *local_28;
  undefined4 local_20;
  undefined local_18 [16];
  
  *param_1 = 0;
  local_res8 = 0;
  local_48 = ZEXT816(0);
  uVar3 = FUN_1800709e0((undefined2 *)local_48,param_2);
  uVar4 = uVar3 & 0xffffffff;
  if ((int)uVar3 < 0) {
    uVar6 = 0xd0;
    uVar5 = 0x14;
  }
  else {
    local_30 = 0;
    local_28 = local_48;
    local_38[0] = 0x30;
    local_20 = 0x40;
    local_18 = ZEXT816(0);
    uVar2 = ZwOpenKey(&local_res8,0x20019,local_38);
    uVar1 = local_res8;
    uVar4 = (ulonglong)uVar2;
    if (-1 < (int)uVar2) {
      uVar4 = 0;
      local_res8 = 0;
      *param_1 = uVar1;
      goto LAB_180070c7e;
    }
    if (uVar2 == 0xc0000034) goto LAB_180070c7e;
    uVar6 = 0x18;
    uVar5 = 0x3f;
  }
  FUN_18001188c(1,0,uVar5,uVar6,(char)param_2);
LAB_180070c7e:
  if (local_48._8_8_ != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_48._8_8_);
  }
  return uVar4;
}



void FUN_180070cc4(undefined4 *param_1,undefined8 param_2,undefined8 param_3)

{
  int iVar1;
  undefined auStackY104 [32];
  undefined uVar2;
  undefined local_30 [4];
  int local_2c;
  int local_28;
  undefined4 local_24;
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStackY104;
  *param_1 = 0;
  uVar2 = 0x14;
  iVar1 = ZwQueryValueKey(param_2,param_3,2,local_30);
  if (iVar1 < 0) {
    if (iVar1 != -0x3fffffcc) {
      FUN_18001188c(1,0x60,0xa1,0x40,(char)iVar1);
    }
  }
  else if ((local_2c == 4) && (local_28 == 4)) {
    *param_1 = local_24;
  }
  else {
    FUN_18001188c(1,0x60,0xa8,0x80,uVar2);
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStackY104);
  return;
}



ulonglong FUN_180070dac(undefined8 *param_1,undefined8 param_2,undefined8 param_3)

{
  uint uVar1;
  ulonglong uVar2;
  undefined local_48 [16];
  undefined4 local_38 [2];
  undefined8 local_30;
  undefined *local_28;
  undefined4 local_20;
  undefined local_18 [16];
  
  *param_1 = 0;
  uVar1 = RtlInitUnicodeStringEx(local_48,param_3);
  uVar2 = (ulonglong)uVar1;
  if ((int)uVar1 < 0) {
    FUN_18001188c(1,8,0x1c,0xd8,(char)uVar1);
  }
  else {
    local_28 = local_48;
    local_38[0] = 0x30;
    local_20 = 0x40;
    local_18 = ZEXT816(0);
    local_30 = param_2;
    uVar2 = ZwOpenKey(param_1,0x20019,local_38);
  }
  return uVar2;
}



void FUN_180070e60(wchar_t **param_1,short *param_2)

{
  ulonglong uVar1;
  uint uVar2;
  BOOL BVar3;
  wchar_t *pwVar4;
  undefined4 *puVar5;
  HANDLE hFindFile;
  wchar_t *pwVar6;
  LPWIN32_FIND_DATAW lpFindFileData;
  undefined4 *lpFileName;
  undefined uVar7;
  undefined uVar8;
  int iVar9;
  longlong in_GS_OFFSET;
  undefined auStackY744 [32];
  undefined4 *local_2b8;
  ulonglong local_2b0;
  wchar_t **local_2a8;
  byte local_298;
  uint local_278;
  ulonglong local_48;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStackY744;
  pwVar6 = (wchar_t *)0x0;
  *param_1 = (wchar_t *)0x0;
  local_2b8 = (undefined4 *)0x0;
  local_2a8 = param_1;
  memset((_WIN32_FIND_DATAW *)&local_298,0,0x250);
  iVar9 = 9;
  uVar2 = FUN_18000eaac((short **)&local_2b8,param_2);
  lpFileName = local_2b8;
  if ((int)uVar2 < 0) {
    uVar8 = 0xc0;
    uVar7 = 0xbd;
LAB_180070ee1:
    FUN_18001188c(1,0xe0,uVar7,uVar8,(char)uVar2);
    lpFileName = local_2b8;
  }
  else {
    pwVar4 = wcsrchr((wchar_t *)local_2b8,L'\\');
    puVar5 = lpFileName;
    if (pwVar4 != (wchar_t *)0x0) {
      puVar5 = (undefined4 *)(pwVar4 + 1);
    }
    *puVar5 = 0x2a;
    hFindFile = FindFirstFileW((LPCWSTR)lpFileName,(LPWIN32_FIND_DATAW)&local_298);
    pwVar4 = pwVar6;
    if (hFindFile == (HANDLE)0xffffffffffffffff) {
      GetLastError();
      FUN_18001188c(1,0xe0,0xd0,0x10,(char)lpFileName);
      goto LAB_180071096;
    }
    do {
      if (((local_298 & 0x10) == 0) && (local_278 != 0)) {
        pwVar4 = (wchar_t *)(ulonglong)(((int)pwVar4 << 1 | (uint)((int)pwVar4 < 0)) ^ local_278);
        iVar9 = iVar9 + -1;
      }
      lpFindFileData = (LPWIN32_FIND_DATAW)&local_298;
      BVar3 = FindNextFileW(hFindFile,lpFindFileData);
    } while ((BVar3 != 0) && (0 < iVar9));
    FindClose(hFindFile);
    iVar9 = FUN_18000ed58(param_2,lpFindFileData,(longlong *)&local_2b0);
    if (iVar9 < 0) {
      uVar8 = 0x38;
      uVar7 = 0xeb;
    }
    else {
      uVar1 = local_2b0 + 0x15;
      if (local_2b0 <= uVar1) {
        pwVar6 = (wchar_t *)
                 RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,
                                 uVar1 * 2);
        lpFileName = local_2b8;
        if (pwVar6 == (wchar_t *)0x0) goto LAB_180071096;
        uVar2 = FUN_180039540(pwVar6,uVar1,L"SIGN.MEDIA=%X %s",pwVar4);
        if (-1 < (int)uVar2) {
          *local_2a8 = pwVar6;
          pwVar6 = (wchar_t *)0x0;
          lpFileName = local_2b8;
          goto LAB_180071096;
        }
        uVar8 = 0x98;
        uVar7 = 0x12;
        goto LAB_180070ee1;
      }
      uVar8 = 0x58;
      iVar9 = -0x3fffff6b;
      uVar7 = 0xf8;
    }
    FUN_18001188c(1,0xe0,uVar7,uVar8,(char)iVar9);
    pwVar6 = (wchar_t *)0x0;
  }
LAB_180071096:
  if (lpFileName != (undefined4 *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_2b8);
  }
  if (pwVar6 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pwVar6);
  }
  __security_check_cookie(local_48 ^ (ulonglong)auStackY744);
  return;
}



void FUN_180071114(wchar_t **param_1,LPCWSTR param_2)

{
  ulonglong uVar1;
  uint uVar2;
  int iVar3;
  HANDLE hFindFile;
  wchar_t *pwVar4;
  wchar_t *pwVar5;
  wchar_t *_Dst;
  size_t _Size;
  wchar_t *_Str;
  longlong lVar6;
  undefined uVar7;
  undefined uVar8;
  wchar_t *pwVar9;
  longlong in_GS_OFFSET;
  undefined auStackY744 [32];
  wchar_t *local_2b8;
  HANDLE local_2b0;
  uint local_2a8;
  ulonglong local_2a0;
  _WIN32_FIND_DATAW local_298;
  ulonglong local_48;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStackY744;
  _Size = 0;
  *param_1 = (wchar_t *)0x0;
  local_2b8 = (wchar_t *)0x0;
  memset(&local_298,0,0x250);
  local_2a0 = 0;
  hFindFile = FindFirstFileW(param_2,&local_298);
  lVar6 = -1;
  local_2b0 = hFindFile;
  if (hFindFile == (HANDLE)0xffffffffffffffff) {
    GetLastError();
    FUN_18001188c(1,0xe0,0x96,0xb8,(char)param_2);
    goto LAB_1800713df;
  }
  local_2a8 = local_298.nFileSizeHigh;
  uVar2 = FUN_18000eaac(&local_2b8,param_2);
  _Str = local_2b8;
  if ((int)uVar2 < 0) {
    FUN_18001188c(1,0xe0,0xa7,0xc0,(char)uVar2);
    _Str = local_2b8;
    pwVar4 = (wchar_t *)0x0;
  }
  else {
    pwVar4 = wcsrchr(local_2b8,L'.');
    if (pwVar4 != (wchar_t *)0x0) {
      do {
        lVar6 = lVar6 + 1;
      } while (pwVar4[lVar6] != L'\0');
      _Size = lVar6 * 2 + 2;
    }
    pwVar5 = wcsrchr(_Str,L'\\');
    pwVar9 = _Str;
    if (pwVar5 != (wchar_t *)0x0) {
      pwVar9 = pwVar5 + 1;
    }
    pwVar5 = (wchar_t *)0x5b;
    _Dst = wcsrchr(_Str,L'[');
    if (_Dst != (wchar_t *)0x0) {
      if (pwVar4 == (wchar_t *)0x0) {
        *_Dst = L'\0';
      }
      else {
        RtlMoveMemory(_Dst,pwVar4,_Size);
        pwVar5 = pwVar4;
      }
    }
    iVar3 = FUN_18000ed58(pwVar9,pwVar5,(longlong *)&local_2a0);
    if (iVar3 < 0) {
      uVar8 = 0x10;
      uVar7 = 0xca;
    }
    else {
      uVar1 = local_2a0 + 0x1a;
      if (local_2a0 <= uVar1) {
        pwVar4 = (wchar_t *)
                 RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,
                                 uVar1 * 2);
        _Str = local_2b8;
        hFindFile = local_2b0;
        if (pwVar4 != (wchar_t *)0x0) {
          iVar3 = FUN_180039540(pwVar4,uVar1,L"SIGN.IE=%X%X %s",(ulonglong)local_2a8);
          if (iVar3 < 0) {
            FUN_18001188c(1,0xe0,0xe5,0x70,(char)iVar3);
            _Str = local_2b8;
            hFindFile = local_2b0;
          }
          else {
            *param_1 = pwVar4;
            _Str = local_2b8;
            pwVar4 = (wchar_t *)0x0;
            hFindFile = local_2b0;
          }
        }
        goto LAB_180071388;
      }
      uVar8 = 0x58;
      iVar3 = -0x3fffff6b;
      uVar7 = 0xd4;
    }
    FUN_18001188c(1,0xe0,uVar7,uVar8,(char)iVar3);
    pwVar4 = (wchar_t *)0x0;
    hFindFile = local_2b0;
  }
LAB_180071388:
  if (_Str != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_2b8);
  }
  if (pwVar4 != (wchar_t *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pwVar4);
  }
  FindClose(hFindFile);
LAB_1800713df:
  __security_check_cookie(local_48 ^ (ulonglong)auStackY744);
  return;
}



undefined8 FUN_180071414(wchar_t *param_1,void *param_2,ulonglong param_3)

{
  ulonglong uVar1;
  ulonglong uVar2;
  wchar_t wVar3;
  short sVar4;
  int iVar5;
  wchar_t *pwVar6;
  ulonglong uVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  ulonglong uVar11;
  ulonglong uVar12;
  
  uVar12 = 0xffffffffffffffff;
  do {
    uVar11 = uVar12;
    uVar12 = uVar11 + 1;
  } while (param_1[uVar12] != L'\0');
  if (param_3 < uVar11 + 2) {
    return 0xc0000023;
  }
  pwVar6 = wcschr(param_1,L':');
  if (pwVar6 == (wchar_t *)0x0) {
    uVar11 = 4;
    iVar5 = wcsncmp(param_1,L"\\??\\",4);
    if (iVar5 == 0) goto LAB_1800714d3;
    iVar5 = wcsncmp(param_1,L"\\\\",2);
    if (iVar5 == 0) {
      uVar11 = 2;
      goto LAB_1800714d3;
    }
    pwVar6 = wcschr(param_1,L'\\');
    if (pwVar6 == (wchar_t *)0x0) {
      uVar11 = 1;
      goto LAB_1800714d3;
    }
  }
  uVar11 = ((ulonglong)((longlong)pwVar6 - (longlong)param_1) >> 1) + 1;
LAB_1800714d3:
  RtlMoveMemory(param_2,param_1,uVar11 * 2);
  uVar9 = uVar11;
  uVar7 = uVar11;
  while (uVar9 < uVar12) {
    uVar8 = uVar7;
    uVar10 = uVar9;
    if ((param_1[uVar9] == L'\\') || (param_1[uVar9] == L'/')) {
      if ((uVar7 == 0) || (*(short *)((longlong)param_2 + uVar7 * 2 + -2) != 0x5c)) {
        *(undefined2 *)((longlong)param_2 + uVar7 * 2) = 0x5c;
        uVar8 = uVar7 + 1;
      }
    }
    else if (param_1[uVar9] == L'.') {
      uVar1 = uVar9 + 1;
      if (uVar1 == uVar12) break;
      wVar3 = param_1[uVar9 + 1];
      uVar10 = uVar1;
      if ((((wVar3 != L'\\') && (wVar3 != L'/')) && (uVar10 = uVar9, wVar3 == L'.')) &&
         (((uVar2 = uVar9 + 2, uVar2 == uVar12 || (param_1[uVar2] == L'\\')) ||
          (param_1[uVar2] == L'/')))) {
        if (uVar11 <= uVar7) {
          do {
            sVar4 = *(short *)((longlong)param_2 + uVar7 * 2);
            *(undefined2 *)((longlong)param_2 + uVar7 * 2) = 0;
            if (sVar4 == 0x5c) break;
            uVar7 = uVar7 - 1;
          } while (uVar11 <= uVar7);
          for (; (uVar11 <= uVar7 &&
                 (sVar4 = *(short *)((longlong)param_2 + uVar7 * 2),
                 *(undefined2 *)((longlong)param_2 + uVar7 * 2) = 0, sVar4 != 0x5c));
              uVar7 = uVar7 - 1) {
          }
        }
        uVar8 = uVar7 + 1;
        uVar10 = uVar1;
        if (uVar11 <= uVar7) {
          uVar8 = uVar7;
        }
      }
    }
    else {
      if (uVar9 < uVar12) {
        do {
          wVar3 = param_1[uVar9];
          if ((wVar3 == L'\\') || (wVar3 == L'/')) break;
          *(wchar_t *)((longlong)param_2 + uVar7 * 2) = wVar3;
          uVar9 = uVar9 + 1;
          uVar7 = uVar7 + 1;
        } while (uVar9 < uVar12);
        if ((((uVar9 < uVar12) && (1 < uVar7)) &&
            (*(short *)((longlong)param_2 + uVar7 * 2 + -2) == 0x2e)) &&
           (*(short *)((longlong)param_2 + uVar7 * 2 + -4) != 0x2e)) {
          uVar7 = uVar7 - 1;
        }
      }
      uVar8 = uVar7;
      uVar10 = uVar9 - 1;
    }
    uVar7 = uVar8;
    uVar9 = uVar10 + 1;
  }
  *(undefined2 *)((longlong)param_2 + uVar7 * 2) = 0;
  return 0;
}



undefined4 FUN_180071638(ushort *param_1)

{
  short sVar1;
  longlong lVar2;
  ulonglong uVar3;
  int iVar4;
  int iVar5;
  ulonglong uVar6;
  ushort uVar7;
  ushort uVar8;
  ushort uVar9;
  ushort uVar10;
  undefined in_stack_ffffffffffffffd8;
  
  uVar7 = *param_1 >> 1;
  if ((*param_1 < 2) || (**(wchar_t **)(param_1 + 4) == L'\0')) {
    FUN_18001188c(1,0x30,0xd9,8,0xf2);
    return 0xc00000f2;
  }
  if ((7 < uVar7) && (iVar4 = _wcsnicmp(*(wchar_t **)(param_1 + 4),L"\\??\\UNC\\",8), iVar4 == 0)) {
    iVar4 = 5;
    goto LAB_180071712;
  }
  iVar4 = 4;
  if (3 < uVar7) {
    iVar5 = wcsncmp(*(wchar_t **)(param_1 + 4),L"\\??\\",4);
    if (iVar5 == 0) {
      iVar4 = 3;
      goto LAB_180071712;
    }
    iVar5 = wcsncmp(*(wchar_t **)(param_1 + 4),L"\\\\?\\",4);
    if ((iVar5 == 0) || (iVar5 = wcsncmp(*(wchar_t **)(param_1 + 4),L"\\\\.\\",4), iVar5 == 0))
    goto LAB_180071712;
  }
  if ((uVar7 < 3) || (iVar5 = wcsncmp(*(wchar_t **)(param_1 + 4),L"\\\\",2), iVar5 != 0)) {
    iVar4 = 1;
  }
LAB_180071712:
  uVar6 = 0;
  do {
    uVar3 = uVar6 * 2;
    if (*param_1 <= uVar3) break;
    if ((*(short *)(uVar3 + *(longlong *)(param_1 + 4)) == 0x5c) ||
       (*(short *)(uVar3 + *(longlong *)(param_1 + 4)) == 0x2f)) {
      iVar4 = iVar4 + -1;
    }
    uVar6 = (ulonglong)(ushort)((short)uVar6 + 1);
  } while (0 < iVar4);
  uVar10 = (ushort)uVar6;
  uVar8 = uVar10;
  for (uVar9 = uVar10; uVar9 < uVar7; uVar9 = uVar9 + 1) {
    if (uVar9 < uVar8) {
      FUN_18001188c(1,0x30,0xe5,0x50,in_stack_ffffffffffffffd8);
      return 0xc00000e5;
    }
    lVar2 = *(longlong *)(param_1 + 4);
    uVar6 = (ulonglong)uVar9;
    if ((*(short *)(lVar2 + uVar6 * 2) == 0x5c) || (*(short *)(lVar2 + uVar6 * 2) == 0x2f)) {
      if ((uVar8 == 0) || (*(short *)(lVar2 + -2 + (ulonglong)uVar8 * 2) != 0x5c)) {
        *(undefined2 *)(lVar2 + (ulonglong)uVar8 * 2) = 0x5c;
        uVar8 = uVar8 + 1;
      }
    }
    else if (*(short *)(lVar2 + uVar6 * 2) == 0x2e) {
      uVar6 = (ulonglong)uVar9;
      if (uVar9 + 1 == (uint)uVar7) break;
      sVar1 = *(short *)(lVar2 + 2 + uVar6 * 2);
      if ((sVar1 != 0x5c) && (sVar1 != 0x2f)) {
        if ((sVar1 != 0x2e) ||
           (((uVar9 + 2 != (uint)uVar7 && (*(short *)(lVar2 + 4 + uVar6 * 2) != 0x5c)) &&
            (*(short *)(lVar2 + 4 + uVar6 * 2) != 0x2f)))) goto LAB_180071894;
        if (uVar10 <= uVar8) {
          do {
            sVar1 = *(short *)(*(longlong *)(param_1 + 4) + (ulonglong)uVar8 * 2);
            *(undefined2 *)(*(longlong *)(param_1 + 4) + (ulonglong)uVar8 * 2) = 0;
            if (sVar1 == 0x5c) break;
            uVar8 = uVar8 - 1;
          } while (uVar10 <= uVar8);
          if (uVar10 <= uVar8) {
            do {
              sVar1 = *(short *)(*(longlong *)(param_1 + 4) + (ulonglong)uVar8 * 2);
              *(undefined2 *)(*(longlong *)(param_1 + 4) + (ulonglong)uVar8 * 2) = 0;
              if (sVar1 == 0x5c) break;
              uVar8 = uVar8 - 1;
            } while (uVar10 <= uVar8);
            if (uVar10 <= uVar8) goto LAB_180071839;
          }
        }
        uVar8 = uVar8 + 1;
      }
LAB_180071839:
      uVar9 = uVar9 + 1;
    }
    else {
      for (; uVar9 < uVar7; uVar9 = uVar9 + 1) {
        sVar1 = *(short *)(*(longlong *)(param_1 + 4) + (ulonglong)uVar9 * 2);
        if ((sVar1 == 0x5c) || (sVar1 == 0x2f)) break;
        if (uVar9 != uVar8) {
          *(short *)(*(longlong *)(param_1 + 4) + (ulonglong)uVar8 * 2) = sVar1;
        }
        uVar8 = uVar8 + 1;
      }
      uVar9 = uVar9 - 1;
    }
LAB_180071894:
  }
  *(undefined2 *)(*(longlong *)(param_1 + 4) + (ulonglong)uVar8 * 2) = 0;
  *param_1 = uVar8 * 2;
  return 0;
}



void FUN_18007192c(longlong *param_1)

{
  longlong local_res8 [4];
  
  if ((param_1 != (longlong *)0x0) && (local_res8[0] = *param_1, local_res8[0] != 0)) {
    if (local_res8[0] == -1) {
      *param_1 = 0;
    }
    else {
      FUN_1800730fc(local_res8);
      *param_1 = 0;
    }
  }
  return;
}



// WARNING: Could not reconcile some variable overlaps

uint FUN_180071970(short *param_1,ulonglong param_2,wchar_t *param_3,uint **param_4)

{
  ulonglong uVar1;
  uint uVar2;
  int iVar3;
  undefined8 uVar4;
  uint *puVar5;
  ulonglong uVar6;
  void *pvVar7;
  undefined4 *puVar8;
  uint uVar9;
  ulonglong uVar10;
  undefined uVar11;
  undefined uVar12;
  short *psVar13;
  uint uVar14;
  longlong in_GS_OFFSET;
  ulonglong local_res10;
  undefined in_stack_ffffffffffffff58;
  size_t local_98;
  size_t local_90;
  uint *local_88;
  undefined local_80 [16];
  longlong local_70;
  undefined local_68 [8];
  undefined4 uStack96;
  undefined4 uStack92;
  undefined local_58 [8];
  undefined4 uStack80;
  undefined4 uStack76;
  undefined local_48 [16];
  undefined8 local_38;
  undefined8 local_30;
  short *psVar15;
  
  psVar15 = (short *)0x0;
  uVar9 = 0;
  uVar14 = 0;
  if (param_1 == (short *)0x0) {
    return 0xc00000ef;
  }
  if ((param_3 == (wchar_t *)0x0) || (*param_3 == L'\0')) {
    return 0xc00000f1;
  }
  if (param_4 == (uint **)0x0) {
    return 0xc00000f2;
  }
  *param_4 = (uint *)0x0;
  *param_1 = 0;
  local_88 = (uint *)0x0;
  local_res10 = param_2 & 0xffffffffffff0000;
  local_80 = ZEXT816(0);
  psVar13 = (short *)0x0;
  local_48 = ZEXT816(0);
  _local_68 = ZEXT816(0);
  _local_58 = ZEXT816(0);
  uVar2 = RtlDosPathNameToNtPathName_U_WithStatus(param_3,local_80,0);
  if ((int)uVar2 < 0) {
    uVar12 = 0x58;
    uVar11 = 0xa6;
    psVar13 = psVar15;
  }
  else {
    uVar2 = FUN_180071638((ushort *)local_80);
    if ((int)uVar2 < 0) {
      uVar12 = 0xa8;
      uVar11 = 0xb1;
      psVar13 = psVar15;
    }
    else {
      uVar2 = FUN_180073678(local_80._0_2_,4,(ushort *)&local_res10);
      if ((int)uVar2 < 0) {
        uVar12 = 200;
        uVar11 = 0xb7;
      }
      else {
        uVar6 = local_res10 & 0xffff;
        psVar13 = (short *)RtlAllocateHeap(*(undefined8 *)
                                            (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,
                                           local_res10 & 0xffff);
        if (psVar13 == (short *)0x0) {
LAB_180071ab5:
          uVar2 = 0xc0000017;
          goto LAB_180071edd;
        }
        uVar2 = FUN_1800735e0(psVar13,uVar6,local_80._8_8_,(ulonglong)local_80._0_2_);
        if ((int)uVar2 < 0) {
          uVar12 = 0xe8;
          uVar11 = 0xc3;
          goto LAB_180071a2d;
        }
        iVar3 = FUN_180073260(psVar13);
        if (iVar3 == 0) {
          uVar2 = 0xc0000039;
          FUN_18001188c(1,0x88,0xd5,8,in_stack_ffffffffffffff58);
          goto LAB_180071edd;
        }
        if (iVar3 == 1) {
          *param_4 = (uint *)0xffffffffffffffff;
          uVar4 = FUN_180070630(local_80._8_8_);
          if ((int)uVar4 == 0) {
            uVar2 = 0x80000006;
            goto LAB_180071edd;
          }
          uVar2 = FUN_18000ecd4(param_1,0x104,(longlong)param_3);
          if (-1 < (int)uVar2) {
            uVar2 = 0;
            goto LAB_180071edd;
          }
          uVar12 = 0xe8;
          uVar11 = 0xe7;
          goto LAB_180071a2d;
        }
        puVar5 = (uint *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                         8,0x40);
        local_88 = puVar5;
        if (puVar5 == (uint *)0x0) goto LAB_180071ab5;
        iVar3 = wcsncmp(param_3,L"\\??\\",4);
        *puVar5 = (uint)(iVar3 != 0);
        *(short **)(puVar5 + 2) = psVar13;
        psVar13 = (short *)0x0;
        *(undefined (*) [16])(puVar5 + 4) = ZEXT816(0);
        *(undefined (*) [16])(puVar5 + 8) = ZEXT816(0);
        *(undefined (*) [16])(puVar5 + 0xc) = ZEXT816(0);
        *(undefined8 *)(puVar5 + 4) = *(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30);
        *(undefined8 *)(puVar5 + 0xc) = 0x10;
        *(undefined8 *)(puVar5 + 8) = 0;
        *(undefined8 *)(puVar5 + 10) = 0;
        *(undefined8 *)(puVar5 + 0xe) = 0;
        *(undefined8 *)(puVar5 + 6) = 0x20;
        uVar6 = *(longlong *)(puVar5 + 0xc) + 7;
        if (uVar6 < 8) {
          uVar9 = 0xc0000095;
LAB_180071cbc:
          uVar14 = uVar9;
          if (*(longlong *)(puVar5 + 0xe) != 0) {
            RtlFreeHeap(*(undefined8 *)(puVar5 + 4),0);
          }
          *(undefined (*) [16])(puVar5 + 4) = ZEXT816(0);
          *(undefined (*) [16])(puVar5 + 8) = ZEXT816(0);
          *(undefined (*) [16])(puVar5 + 0xc) = ZEXT816(0);
          if ((int)uVar14 < 0) {
            FUN_18001188c(1,0x50,0x44,0x30,(char)uVar14);
            goto LAB_180071d0c;
          }
        }
        else {
          uVar6 = ~(*(longlong *)(puVar5 + 0xc) - 1U) & uVar6;
          uVar4 = FUN_180073990(0,*(ulonglong *)(puVar5 + 6),&local_38);
          if (((int)uVar4 < 0) ||
             (uVar4 = FUN_180073990(uVar6,*(ulonglong *)(puVar5 + 6),&local_98), (int)uVar4 < 0)) {
            uVar9 = 0xc0000095;
          }
          else {
            if (*(longlong *)(puVar5 + 0xe) == 0) {
              pvVar7 = (void *)RtlAllocateHeap(*(undefined8 *)(puVar5 + 4),0,local_98);
              if (pvVar7 != (void *)0x0) {
                memset(pvVar7,0,local_98);
              }
            }
            else {
              pvVar7 = (void *)RtlReAllocateHeap(*(undefined8 *)(puVar5 + 4),0,
                                                 *(longlong *)(puVar5 + 0xe),local_98);
            }
            if (pvVar7 == (void *)0x0) {
              uVar9 = 0xc0000017;
            }
            else {
              *(void **)(puVar5 + 0xe) = pvVar7;
              *(ulonglong *)(puVar5 + 10) = uVar6;
            }
          }
          if (uVar9 != 0) goto LAB_180071cbc;
LAB_180071d0c:
          if ((int)uVar14 < 0) {
            uVar12 = 0x30;
            uVar11 = 0xd;
            psVar13 = psVar15;
            uVar2 = uVar14;
            goto LAB_180071a2d;
          }
        }
        puVar5 = local_88;
        RtlInitUnicodeString(local_48,*(undefined8 *)(local_88 + 2));
        uVar2 = FUN_180072ed0((undefined8 *)local_68,(ushort *)local_48,*(short **)(puVar5 + 2),1,
                              (short *)0x0,0);
        if ((int)uVar2 < 0) {
          uVar12 = 0x60;
          uVar11 = 0x1a;
          goto LAB_180071a2d;
        }
        uVar6 = *(ulonglong *)(puVar5 + 8);
        if (uVar6 < *(ulonglong *)(puVar5 + 10)) {
LAB_180071e68:
          uVar4 = FUN_180073990(*(ulonglong *)(puVar5 + 6),uVar6,&local_70);
          uVar2 = 0;
          if (((int)uVar4 < 0) ||
             (puVar8 = (undefined4 *)(local_70 + *(longlong *)(puVar5 + 0xe)),
             puVar8 < *(undefined4 **)(puVar5 + 0xe))) {
            uVar2 = 0xc0000095;
          }
          else {
            *puVar8 = local_68._0_4_;
            puVar8[1] = local_68._4_4_;
            puVar8[2] = uStack96;
            puVar8[3] = uStack92;
            puVar8[4] = local_58._0_4_;
            puVar8[5] = local_58._4_4_;
            puVar8[6] = uStack80;
            puVar8[7] = uStack76;
            *(longlong *)(puVar5 + 8) = *(longlong *)(puVar5 + 8) + 1;
          }
        }
        else {
          uVar1 = uVar6 + 1;
          if (uVar1 < *(ulonglong *)(puVar5 + 10) || uVar1 == *(ulonglong *)(puVar5 + 10)) {
            uVar2 = 0xc000000d;
          }
          else {
            uVar10 = (*(longlong *)(puVar5 + 0xc) - 1U) + uVar1;
            if (uVar10 < uVar1) {
              uVar2 = 0xc0000095;
            }
            else {
              uVar10 = ~(*(longlong *)(puVar5 + 0xc) - 1U) & uVar10;
              uVar4 = FUN_180073990(*(ulonglong *)(puVar5 + 10),*(ulonglong *)(puVar5 + 6),&local_30
                                   );
              if (((int)uVar4 < 0) ||
                 (uVar4 = FUN_180073990(uVar10,*(ulonglong *)(puVar5 + 6),&local_90), (int)uVar4 < 0
                 )) {
                uVar2 = 0xc0000095;
              }
              else {
                if (*(longlong *)(puVar5 + 0xe) == 0) {
                  pvVar7 = (void *)RtlAllocateHeap(*(undefined8 *)(puVar5 + 4),0,local_90);
                  if (pvVar7 != (void *)0x0) {
                    memset(pvVar7,0,local_90);
                  }
                }
                else {
                  pvVar7 = (void *)RtlReAllocateHeap(*(undefined8 *)(puVar5 + 4),0,
                                                     *(longlong *)(puVar5 + 0xe),local_90);
                }
                if (pvVar7 == (void *)0x0) {
                  uVar2 = 0xc0000017;
                }
                else {
                  *(ulonglong *)(puVar5 + 10) = uVar10;
                  uVar2 = 0;
                  *(void **)(puVar5 + 0xe) = pvVar7;
                }
              }
              if (uVar2 == 0) goto LAB_180071e68;
            }
          }
        }
        if (-1 < (int)uVar2) {
          *param_4 = puVar5;
          _local_68 = ZEXT816(0);
          _local_58 = ZEXT816(0);
          uVar2 = FUN_180071f5c(param_1,0x104,(int *)puVar5);
          goto LAB_180071edd;
        }
        uVar12 = 0xa8;
        uVar11 = 0x20;
        psVar13 = psVar15;
      }
    }
  }
LAB_180071a2d:
  FUN_18001188c(1,0x88,uVar11,uVar12,(char)uVar2);
LAB_180071edd:
  RtlFreeUnicodeString(local_80);
  if (psVar13 != (short *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,psVar13);
  }
  if ((int)uVar2 < 0) {
    FUN_1800730fc((longlong *)&local_88);
    FUN_1800731fc((longlong)local_68);
    *param_4 = (uint *)0x0;
  }
  return uVar2;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180071f5c(short *param_1,undefined8 param_2,int *param_3)

{
  undefined auVar1 [16];
  short sVar2;
  int iVar3;
  uint uVar4;
  longlong lVar5;
  undefined8 uVar6;
  ushort *puVar7;
  undefined uVar8;
  undefined4 *puVar9;
  size_t sVar10;
  void *pvVar11;
  ulonglong uVar12;
  ulonglong uVar13;
  undefined uVar14;
  ulonglong uVar15;
  undefined uVar16;
  ushort *puVar17;
  longlong in_GS_OFFSET;
  undefined auStackY424 [32];
  short *in_stack_fffffffffffffe78;
  ushort local_148 [4];
  undefined local_140 [8];
  void *pvStack312;
  size_t local_130;
  size_t local_128;
  size_t local_120;
  ulonglong local_118;
  ulonglong local_110;
  longlong local_108;
  longlong local_100;
  longlong local_f8;
  longlong local_f0;
  longlong local_e8;
  longlong local_e0;
  longlong local_d8;
  longlong local_d0;
  undefined local_c8 [8];
  undefined4 uStack192;
  undefined4 uStack188;
  undefined local_b8 [8];
  undefined4 uStack176;
  undefined4 uStack172;
  undefined8 local_a8;
  undefined8 local_a0;
  undefined8 local_98;
  undefined local_90 [16];
  undefined local_80 [8];
  undefined2 *local_78;
  undefined local_70 [8];
  longlong lStack104;
  undefined local_60 [16];
  undefined local_50 [16];
  ulonglong local_40;
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStackY424;
  if (((param_3 != (int *)0xffffffffffffffff) && (param_1 != (short *)0x0)) &&
     (param_3 != (int *)0x0)) {
    local_148[0] = 0;
    local_90 = ZEXT816(0);
    local_40 = 0;
    _local_140 = ZEXT816(0);
    _local_c8 = ZEXT816(0);
    _local_b8 = ZEXT816(0);
    _local_70 = ZEXT816(0);
    local_60 = ZEXT816(0);
    local_50 = ZEXT816(0);
    lVar5 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,0x268);
    if (lVar5 != 0) {
      uVar15 = *(ulonglong *)(param_3 + 8);
      while (uVar15 != 0) {
        puVar17 = (ushort *)0x0;
        puVar7 = puVar17;
        if ((uVar15 - 1 < uVar15) &&
           ((uVar6 = FUN_180073990(*(ulonglong *)(param_3 + 6),uVar15 - 1,&local_108),
            (int)uVar6 < 0 ||
            (puVar7 = (ushort *)(local_108 + *(longlong *)(param_3 + 0xe)),
            (ushort *)(local_108 + *(longlong *)(param_3 + 0xe)) < *(ushort **)(param_3 + 0xe))))) {
          puVar7 = puVar17;
        }
        if (puVar7 == (ushort *)0x0) {
          FUN_18001188c(1,0xd0,0xff,0xa8,(char)in_stack_fffffffffffffe78);
          uVar16 = 0xf0;
          uVar14 = 0xa2;
          iVar3 = -0x3fffff1b;
LAB_180072b4d:
          uVar8 = (undefined)iVar3;
LAB_180072b56:
          FUN_18001188c(1,0xd0,uVar14,uVar16,uVar8);
          break;
        }
        if (*(longlong *)(puVar7 + 0xc) == 0) {
          FUN_18001188c(1,0xd0,0xa7,0xe8,(char)in_stack_fffffffffffffe78);
          uVar15 = *(ulonglong *)(param_3 + 8);
          if (uVar15 == 0) {
            uVar4 = 0x8000001a;
LAB_1800720f9:
            in_stack_fffffffffffffe78 = (short *)(ulonglong)uVar4;
            uVar16 = 0xf0;
            uVar14 = 0x1a;
            uVar8 = 0x18;
            goto LAB_180072779;
          }
          puVar7 = puVar17;
          if ((uVar15 - 1 < uVar15) &&
             ((uVar6 = FUN_180073990(*(ulonglong *)(param_3 + 6),uVar15 - 1,&local_100),
              (int)uVar6 < 0 ||
              (puVar7 = (ushort *)(local_100 + *(longlong *)(param_3 + 0xe)),
              (ushort *)(local_100 + *(longlong *)(param_3 + 0xe)) < *(ushort **)(param_3 + 0xe)))))
          {
            puVar7 = puVar17;
          }
          if (puVar7 == (ushort *)0x0) {
            uVar4 = 0xc00000e5;
            FUN_18001188c(1,0xd0,0xff,0xa8,(char)in_stack_fffffffffffffe78);
            goto LAB_1800720f9;
          }
          FUN_1800731fc((longlong)puVar7);
          uVar15 = *(ulonglong *)(param_3 + 8) - 1;
          if (((uVar15 < *(ulonglong *)(param_3 + 8)) &&
              (uVar6 = FUN_180073990(*(ulonglong *)(param_3 + 6),uVar15,&local_f8), -1 < (int)uVar6)
              ) && (pvVar11 = (void *)(local_f8 + *(longlong *)(param_3 + 0xe)),
                   *(void **)(param_3 + 0xe) <= pvVar11)) {
            sVar10 = (*(longlong *)(param_3 + 8) - uVar15) - 1;
            local_118 = sVar10;
            if (sVar10 != 0) {
              uVar6 = FUN_180073990(sVar10,*(ulonglong *)(param_3 + 6),&local_118);
              if ((((int)uVar6 < 0) ||
                  (uVar6 = FUN_180073990(*(ulonglong *)(param_3 + 6),uVar15 + 1,&local_f0),
                  sVar10 = local_118, (int)uVar6 < 0)) ||
                 ((void *)(local_f0 + *(longlong *)(param_3 + 0xe)) < *(void **)(param_3 + 0xe)))
              goto LAB_18007277e;
              RtlMoveMemory(pvVar11,(void *)(local_f0 + *(longlong *)(param_3 + 0xe)),local_118);
            }
            memset((void *)(sVar10 + (longlong)pvVar11),0,*(size_t *)(param_3 + 6));
            *(longlong *)(param_3 + 8) = *(longlong *)(param_3 + 8) + -1;
            if (0x10 < *(ulonglong *)(param_3 + 8)) {
              uVar15 = *(ulonglong *)(param_3 + 10);
              if ((0x3ff < *(ulonglong *)(param_3 + 6) * uVar15) &&
                 (*(ulonglong *)(param_3 + 8) < uVar15 >> 2)) {
                uVar12 = uVar15 >> 1;
                uVar6 = FUN_180073990(uVar15,*(ulonglong *)(param_3 + 6),&local_a8);
                if ((-1 < (int)uVar6) &&
                   (uVar6 = FUN_180073990(uVar12,*(ulonglong *)(param_3 + 6),&local_130),
                   -1 < (int)uVar6)) {
                  uVar6 = *(undefined8 *)(param_3 + 4);
                  if (*(longlong *)(param_3 + 0xe) == 0) {
                    pvVar11 = (void *)RtlAllocateHeap();
                    sVar10 = local_130;
joined_r0x00018007252a:
                    if (pvVar11 != (void *)0x0) {
                      memset(pvVar11,0,sVar10);
                    }
                  }
                  else {
LAB_180072279:
                    pvVar11 = (void *)RtlReAllocateHeap(uVar6);
                  }
                  if (pvVar11 != (void *)0x0) {
                    *(void **)(param_3 + 0xe) = pvVar11;
                    *(ulonglong *)(param_3 + 10) = uVar12;
                  }
                }
              }
            }
          }
        }
        else {
          RtlInitUnicodeString(local_140,*(undefined8 *)(puVar7 + 8));
          in_stack_fffffffffffffe78 = (short *)local_90;
          iVar3 = ZwQueryDirectoryFile(*(undefined8 *)(puVar7 + 0xc),0,0);
          if (iVar3 < 0) {
            if ((iVar3 != -0x7ffffffa) && (iVar3 != -0x3ffffff1)) {
              FUN_18001188c(1,0xd0,0xbf,0x10,(char)iVar3);
              in_stack_fffffffffffffe78 = *(short **)(puVar7 + 4);
              FUN_18001188c(2,0xd0,0xc0,0x48,(char)in_stack_fffffffffffffe78);
            }
            uVar15 = *(ulonglong *)(param_3 + 8);
            if (uVar15 == 0) {
              uVar4 = 0x8000001a;
            }
            else {
              puVar7 = puVar17;
              if ((uVar15 - 1 < uVar15) &&
                 ((uVar6 = FUN_180073990(*(ulonglong *)(param_3 + 6),uVar15 - 1,&local_e8),
                  (int)uVar6 < 0 ||
                  (puVar7 = (ushort *)(local_e8 + *(longlong *)(param_3 + 0xe)),
                  (ushort *)(local_e8 + *(longlong *)(param_3 + 0xe)) < *(ushort **)(param_3 + 0xe))
                  ))) {
                puVar7 = puVar17;
              }
              if (puVar7 != (ushort *)0x0) {
                FUN_1800731fc((longlong)puVar7);
                uVar15 = *(ulonglong *)(param_3 + 8) - 1;
                if (((uVar15 < *(ulonglong *)(param_3 + 8)) &&
                    (uVar6 = FUN_180073990(*(ulonglong *)(param_3 + 6),uVar15,&local_e0),
                    -1 < (int)uVar6)) &&
                   (pvVar11 = (void *)(local_e0 + *(longlong *)(param_3 + 0xe)),
                   *(void **)(param_3 + 0xe) <= pvVar11)) {
                  sVar10 = (*(longlong *)(param_3 + 8) - uVar15) - 1;
                  local_110 = sVar10;
                  if (sVar10 != 0) {
                    uVar6 = FUN_180073990(sVar10,*(ulonglong *)(param_3 + 6),&local_110);
                    if ((((int)uVar6 < 0) ||
                        (uVar6 = FUN_180073990(*(ulonglong *)(param_3 + 6),uVar15 + 1,&local_d8),
                        sVar10 = local_110, (int)uVar6 < 0)) ||
                       ((void *)(local_d8 + *(longlong *)(param_3 + 0xe)) <
                        *(void **)(param_3 + 0xe))) goto LAB_18007277e;
                    RtlMoveMemory(pvVar11,(void *)(local_d8 + *(longlong *)(param_3 + 0xe)),
                                  local_110);
                  }
                  memset((void *)(sVar10 + (longlong)pvVar11),0,*(size_t *)(param_3 + 6));
                  *(longlong *)(param_3 + 8) = *(longlong *)(param_3 + 8) + -1;
                  if (0x10 < *(ulonglong *)(param_3 + 8)) {
                    uVar15 = *(ulonglong *)(param_3 + 10);
                    if ((0x3ff < *(ulonglong *)(param_3 + 6) * uVar15) &&
                       (*(ulonglong *)(param_3 + 8) < uVar15 >> 2)) {
                      uVar12 = uVar15 >> 1;
                      uVar6 = FUN_180073990(uVar15,*(ulonglong *)(param_3 + 6),&local_a0);
                      if ((-1 < (int)uVar6) &&
                         (uVar6 = FUN_180073990(uVar12,*(ulonglong *)(param_3 + 6),&local_128),
                         -1 < (int)uVar6)) {
                        uVar6 = *(undefined8 *)(param_3 + 4);
                        if (*(longlong *)(param_3 + 0xe) != 0) goto LAB_180072279;
                        pvVar11 = (void *)RtlAllocateHeap(uVar6);
                        sVar10 = local_128;
                        goto joined_r0x00018007252a;
                      }
                    }
                  }
                }
                goto LAB_18007277e;
              }
              uVar4 = 0xc00000e5;
              FUN_18001188c(1,0xd0,0xff,0xa8,(char)in_stack_fffffffffffffe78);
            }
            in_stack_fffffffffffffe78 = (short *)(ulonglong)uVar4;
            uVar16 = 0xf0;
            uVar14 = 0x1a;
            uVar8 = 0x18;
          }
          else {
            if (*(int *)(lVar5 + 0x3c) == 4) {
              if (*(short *)(lVar5 + 0x5e) == 0x2e) {
                if (*(short *)(lVar5 + 0x60) == 0x2e) goto LAB_18007277e;
                goto LAB_180072563;
              }
            }
            else {
LAB_180072563:
              if ((*(int *)(lVar5 + 0x3c) == 2) && (*(short *)(lVar5 + 0x5e) == 0x2e))
              goto LAB_18007277e;
            }
            in_stack_fffffffffffffe78 = (short *)(lVar5 + 0x5e);
            uVar4 = FUN_180072ed0((undefined8 *)local_c8,puVar7,*(short **)(puVar7 + 8),
                                  *(uint *)(lVar5 + 0x38) >> 4 & 1,in_stack_fffffffffffffe78,
                                  *(ushort *)(lVar5 + 0x3c));
            if (uVar4 == 0xc0000273) {
              uVar4 = FUN_180073678(*puVar7,*(short *)(lVar5 + 0x3c),local_148);
              if (-1 < (int)uVar4) {
                local_50._0_8_ = 2;
                uVar4 = FUN_180073678(local_148[0],2,local_148);
                if (-1 < (int)uVar4) {
                  local_60._0_8_ = &local_40;
                  local_60 = CONCAT88(&local_40,local_60._0_8_);
                  _local_70 = CONCAT88(&local_40,local_70);
                  local_50 = CONCAT88(local_50._0_8_,local_50._0_8_);
                  local_40 = local_40 & 0xffffffffffff0000;
                  _local_70 = CONCAT124(stack0xffffffffffffff94,0x20000);
                  if (local_148[0] + local_50._0_8_ < 0xffff) {
                    if (local_50._0_8_ < local_148[0] + local_50._0_8_) {
                      iVar3 = RtlpEnsureBufferSize(0,local_60);
                      if (iVar3 < 0) {
                        uVar4 = 0xc0000017;
                        goto LAB_180072878;
                      }
                    }
                    uVar15 = 0;
                    local_70 = SUB148(CONCAT122(stack0xffffffffffffff94,local_50._0_2_),0) << 0x10;
                    _local_70 = CONCAT88(local_60._0_8_,local_70);
                    _local_70 = _local_70 & (undefined  [16])0xffffffffffff0000;
                    if ((ulonglong)*puVar7 + 2 < 0xffff) {
                      if (local_50._0_8_ < (ulonglong)*puVar7 + 2) {
                        iVar3 = RtlpEnsureBufferSize(0,local_60);
                        if (iVar3 < 0) {
                          uVar4 = 0xc0000017;
                          goto LAB_1800728e5;
                        }
                        uVar15 = (ulonglong)local_70._0_2_;
                      }
                      _local_70 = CONCAT88(local_60._0_8_,local_70);
                      RtlMoveMemory((void *)((longlong)local_60._0_8_ +
                                            (uVar15 & 0xfffffffffffffffe)),*(void **)(puVar7 + 4),
                                    (ulonglong)*puVar7);
                      sVar2 = *puVar7 + 2 + local_70._0_2_;
                      local_70._0_2_ = local_70._0_2_ + *puVar7;
                      _local_70 = CONCAT142(CONCAT122(stack0xffffffffffffff94,sVar2),local_70._0_2_)
                      ;
                      *(undefined2 *)(lStack104 + (ulonglong)(local_70._0_2_ >> 1) * 2) = 0;
                      if (*(short *)(*(longlong *)(puVar7 + 4) + -2 + (ulonglong)(*puVar7 >> 1) * 2)
                          != 0x5c) {
                        uVar15 = (ulonglong)(local_70._0_2_ + 2) + 2;
                        if (0xfffe < uVar15) {
                          uVar4 = 0xc0000106;
LAB_180072998:
                          uVar16 = 0x28;
                          uVar14 = 0x3f;
                          goto LAB_180072889;
                        }
                        if (local_50._0_8_ < uVar15) {
                          iVar3 = RtlpEnsureBufferSize(0,local_60);
                          if (iVar3 < 0) {
                            uVar4 = 0xc0000017;
                            goto LAB_180072998;
                          }
                        }
                        _local_70 = CONCAT88(local_60._0_8_,local_70);
                        *(undefined2 *)
                         ((longlong)local_60._0_8_ + (ulonglong)(local_70._0_2_ >> 1) * 2) = 0x5c;
                        local_70._0_4_ = CONCAT22(local_70._0_2_ + 4,local_70._0_2_ + 2);
                        *(undefined2 *)
                         ((longlong)local_60._0_8_ +
                         (ulonglong)((ushort)(local_70._0_2_ + 2) >> 1) * 2) = 0;
                      }
                      pvStack312 = (void *)(lVar5 + 0x5e);
                      local_140._0_2_ = *(ushort *)(lVar5 + 0x3c);
                      uVar15 = (ulonglong)((uint)local_70._0_2_ + (uint)local_140._0_2_) + 2;
                      if (uVar15 < 0xffff) {
                        if (local_50._0_8_ < uVar15) {
                          iVar3 = RtlpEnsureBufferSize();
                          if (iVar3 < 0) {
                            uVar4 = 0xc0000017;
                            goto LAB_180072a47;
                          }
                        }
                        _local_70 = CONCAT88(local_60._0_8_,local_70);
                        RtlMoveMemory((void *)((longlong)local_60._0_8_ +
                                              ((ulonglong)local_70._0_2_ & 0xfffffffffffffffe)),
                                      pvStack312,(ulonglong)local_140._0_2_);
                        auVar1 = _local_70;
                        local_140._0_2_ = local_140._0_2_ + local_70._0_2_;
                        local_70._0_4_ = CONCAT22(local_140._0_2_ + 2,local_140._0_2_);
                        lStack104 = SUB168(auVar1,8);
                        *(undefined2 *)(lStack104 + (ulonglong)(local_140._0_2_ >> 1) * 2) = 0;
                        if ((*param_3 == 0) ||
                           (uVar4 = RtlNtPathNameToDosPathName(0,local_70,0), -1 < (int)uVar4)) {
                          uVar4 = FUN_1800735e0(param_1,0x208,lStack104,(ulonglong)local_70._0_2_);
                          if (-1 < (int)uVar4) break;
                          uVar16 = 0xe8;
                          uVar14 = 100;
                        }
                        else {
                          uVar16 = 0x58;
                          uVar14 = 0x59;
                        }
                      }
                      else {
                        uVar4 = 0xc0000106;
LAB_180072a47:
                        uVar16 = 0x28;
                        uVar14 = 0x4e;
                      }
                    }
                    else {
                      uVar4 = 0xc0000106;
LAB_1800728e5:
                      uVar16 = 0xf8;
                      uVar14 = 0x38;
                    }
                  }
                  else {
                    uVar4 = 0xc0000106;
LAB_180072878:
                    uVar16 = 0xc0;
                    uVar14 = 0x2e;
                  }
LAB_180072889:
                  uVar8 = (undefined)uVar4;
                  goto LAB_180072b56;
                }
              }
              in_stack_fffffffffffffe78 = (short *)0xc0000095;
              uVar16 = 0x98;
              uVar14 = 0x25;
            }
            else {
              if ((uVar4 == 0xc0000103) || (uVar4 == 0xc00000ba)) goto LAB_18007277e;
              if (-1 < (int)uVar4) {
                uVar15 = *(ulonglong *)(param_3 + 8);
                if (uVar15 < *(ulonglong *)(param_3 + 10)) {
LAB_1800726be:
                  uVar6 = FUN_180073990(*(ulonglong *)(param_3 + 6),uVar15,&local_d0);
                  if (((int)uVar6 < 0) ||
                     (puVar9 = (undefined4 *)(local_d0 + *(longlong *)(param_3 + 0xe)),
                     puVar9 < *(undefined4 **)(param_3 + 0xe))) {
                    iVar3 = -0x3fffff6b;
                  }
                  else {
                    iVar3 = 0;
                    *puVar9 = local_c8._0_4_;
                    puVar9[1] = local_c8._4_4_;
                    puVar9[2] = uStack192;
                    puVar9[3] = uStack188;
                    puVar9[4] = local_b8._0_4_;
                    puVar9[5] = local_b8._4_4_;
                    puVar9[6] = uStack176;
                    puVar9[7] = uStack172;
                    *(longlong *)(param_3 + 8) = *(longlong *)(param_3 + 8) + 1;
                  }
                }
                else {
                  uVar12 = uVar15 + 1;
                  if (uVar12 < *(ulonglong *)(param_3 + 10) ||
                      uVar12 == *(ulonglong *)(param_3 + 10)) {
                    iVar3 = -0x3ffffff3;
                  }
                  else {
                    uVar13 = (*(longlong *)(param_3 + 0xc) - 1U) + uVar12;
                    if (uVar13 < uVar12) {
                      iVar3 = -0x3fffff6b;
                    }
                    else {
                      uVar13 = ~(*(longlong *)(param_3 + 0xc) - 1U) & uVar13;
                      uVar6 = FUN_180073990(*(ulonglong *)(param_3 + 10),*(ulonglong *)(param_3 + 6)
                                            ,&local_98);
                      if (((int)uVar6 < 0) ||
                         (uVar6 = FUN_180073990(uVar13,*(ulonglong *)(param_3 + 6),&local_120),
                         (int)uVar6 < 0)) {
                        iVar3 = -0x3fffff6b;
                      }
                      else {
                        if (*(longlong *)(param_3 + 0xe) == 0) {
                          pvVar11 = (void *)RtlAllocateHeap();
                          if (pvVar11 != (void *)0x0) {
                            memset(pvVar11,0,local_120);
                          }
                        }
                        else {
                          pvVar11 = (void *)RtlReAllocateHeap(*(undefined8 *)(param_3 + 4));
                        }
                        if (pvVar11 == (void *)0x0) {
                          iVar3 = -0x3fffffe9;
                        }
                        else {
                          *(void **)(param_3 + 0xe) = pvVar11;
                          iVar3 = 0;
                          *(ulonglong *)(param_3 + 10) = uVar13;
                        }
                      }
                      if (iVar3 == 0) goto LAB_1800726be;
                    }
                  }
                }
                if (-1 < iVar3) goto LAB_18007277e;
                uVar16 = 0xa8;
                uVar14 = 0xf1;
                goto LAB_180072b4d;
              }
              in_stack_fffffffffffffe78 = (short *)(ulonglong)uVar4;
              uVar16 = 0x68;
              uVar14 = 0xf9;
            }
            uVar8 = 0xd0;
          }
LAB_180072779:
          FUN_18001188c(1,uVar8,uVar14,uVar16,(char)in_stack_fffffffffffffe78);
        }
LAB_18007277e:
        uVar15 = *(ulonglong *)(param_3 + 8);
      }
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lVar5);
    }
    if ((local_60._0_8_ != (ulonglong *)0x0) && (local_60._0_8_ != (ulonglong *)local_60._8_8_)) {
      local_78 = (undefined2 *)local_60._0_8_;
      RtlFreeUnicodeString(local_80);
    }
    if (local_60._8_8_ != (undefined2 *)0x0) {
      *local_60._8_8_ = 0;
    }
  }
  __security_check_cookie(local_38 ^ (ulonglong)auStackY424);
  return;
}



void FUN_180072b70(undefined8 *param_1)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  longlong in_GS_OFFSET;
  
  if (param_1 != (undefined8 *)0x0) {
    puVar2 = (undefined8 *)*param_1;
    while (puVar2 != param_1) {
      if (puVar2[4] != 0) {
        ZwClose();
        puVar2[4] = 0;
      }
      puVar1 = (undefined8 *)*puVar2;
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar2);
      puVar2 = puVar1;
    }
    if (param_1[3] != 0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_1);
  }
  return;
}



uint FUN_180072c30(longlong *param_1,undefined8 *param_2,short *param_3)

{
  uint uVar1;
  longlong **pplVar2;
  ulonglong uVar3;
  longlong in_GS_OFFSET;
  
  *param_2 = 0;
  pplVar2 = (longlong **)
            RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,0x20);
  if (pplVar2 == (longlong **)0x0) {
    uVar1 = 0xc0000017;
  }
  else {
    pplVar2[2] = (longlong *)0x0;
    pplVar2[3] = (longlong *)0x0;
    pplVar2[1] = (longlong *)pplVar2;
    *pplVar2 = (longlong *)pplVar2;
    uVar1 = FUN_18000eaac((short **)(pplVar2 + 3),param_3);
    if ((-1 < (int)uVar1) && (uVar1 = FUN_180072e24((short *)pplVar2[3],pplVar2), -1 < (int)uVar1))
    {
      pplVar2[2] = *pplVar2;
      uVar3 = FUN_180072d0c(param_1,(longlong *)pplVar2);
      uVar1 = (uint)uVar3;
      if (-1 < (int)uVar1) {
        *param_2 = pplVar2;
        pplVar2 = (longlong **)0x0;
      }
    }
    if (pplVar2 != (longlong **)0x0) {
      FUN_180072b70(pplVar2);
    }
  }
  return uVar1;
}



ulonglong FUN_180072d0c(longlong *param_1,longlong *param_2)

{
  longlong *plVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  longlong *plVar4;
  
  plVar1 = (longlong *)param_2[2];
  if ((longlong *)param_2[2] == (longlong *)0x0) {
    uVar2 = 0x8000001a;
  }
  else {
    do {
      while( true ) {
        plVar4 = plVar1;
        if (plVar4 == param_2) {
          uVar2 = 0x8000001a;
          plVar4 = (longlong *)0x0;
          goto LAB_180072d6e;
        }
        uVar3 = FUN_180073434((longlong)plVar4,(longlong)param_2);
        uVar2 = uVar3 & 0xffffffff;
        if (-1 < (int)uVar3) break;
        plVar1 = (longlong *)plVar4[1];
      }
      plVar1 = (longlong *)*plVar4;
    } while ((longlong *)*plVar4 != param_2);
    *param_1 = plVar4[4];
LAB_180072d6e:
    param_2[2] = (longlong)plVar4;
  }
  return uVar2;
}



ulonglong FUN_180072d88(longlong param_1,longlong param_2,longlong **param_3)

{
  code *pcVar1;
  longlong **pplVar2;
  longlong *plVar3;
  ulonglong uVar4;
  longlong in_GS_OFFSET;
  
  pplVar2 = (longlong **)
            RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,0x30);
  uVar4 = 0;
  if (pplVar2 == (longlong **)0x0) {
    uVar4 = 0xc0000017;
  }
  else {
    pplVar2[1] = (longlong *)pplVar2;
    *pplVar2 = (longlong *)pplVar2;
    *(undefined4 *)(pplVar2 + 5) = 0;
    pplVar2[4] = (longlong *)0x0;
    pplVar2[3] = (longlong *)param_2;
    pplVar2[2] = (longlong *)param_1;
    plVar3 = *param_3;
    if ((longlong **)plVar3[1] != param_3) {
      plVar3 = (longlong *)0x3;
      pcVar1 = (code *)swi(0x29);
      pplVar2 = (longlong **)(*pcVar1)();
    }
    *pplVar2 = plVar3;
    pplVar2[1] = (longlong *)param_3;
    plVar3[1] = (longlong)pplVar2;
    *param_3 = (longlong *)pplVar2;
  }
  return uVar4 & 0xffffffff;
}



void FUN_180072e24(short *param_1,longlong **param_2)

{
  short *psVar1;
  bool bVar2;
  short *psVar3;
  ulonglong uVar4;
  short *psVar5;
  short *psVar6;
  
  uVar4 = 0xffffffffffffffff;
  do {
    uVar4 = uVar4 + 1;
  } while (param_1[uVar4] != 0);
  psVar3 = param_1 + (uVar4 & 0xffffffff);
  psVar6 = param_1 + (uVar4 & 0xffffffff);
  bVar2 = false;
  while( true ) {
    do {
      while( true ) {
        psVar1 = psVar6;
        psVar5 = psVar3;
        psVar6 = psVar1 + -1;
        if (psVar6 <= param_1) {
          if (!bVar2) {
            psVar5 = psVar6;
          }
          FUN_180072d88(-(ulonglong)bVar2 & (ulonglong)psVar6,(longlong)psVar5,param_2);
          return;
        }
        psVar3 = psVar5;
        if ((*psVar6 != 0x2a) && (*psVar6 != 0x3f)) break;
        bVar2 = true;
      }
    } while ((*psVar6 != 0x5c) || (psVar3 = psVar6, !bVar2));
    uVar4 = FUN_180072d88((longlong)psVar1,(longlong)psVar5,param_2);
    if ((int)uVar4 < 0) break;
    *psVar6 = 0;
    bVar2 = false;
  }
  return;
}



uint FUN_180072ed0(undefined8 *param_1,ushort *param_2,short *param_3,int param_4,short *param_5,
                  ushort param_6)

{
  longlong lVar1;
  ulonglong uVar2;
  uint uVar3;
  undefined uVar4;
  undefined uVar5;
  longlong in_GS_OFFSET;
  ushort local_res8 [4];
  undefined local_58 [16];
  undefined4 local_48 [2];
  undefined8 local_40;
  undefined8 *local_38;
  undefined4 local_30;
  undefined local_28 [16];
  
  *param_1 = 0;
  param_1[1] = 0;
  param_1[3] = 0;
  for (; param_1[2] = param_3, *param_3 != 0; param_3 = param_3 + 1) {
  }
  param_1[2] = param_3 + 1;
  if (param_3[1] == 0) {
    uVar3 = (-(uint)(param_4 != 0) & 0xfffffe47) + 0xc0000273;
  }
  else {
    if (param_4 == 0) {
      uVar3 = 0xc0000103;
      goto LAB_1800730d3;
    }
    local_res8[0] = *param_2;
    uVar3 = FUN_180073678(local_res8[0],param_6,local_res8);
    if ((int)uVar3 < 0) {
      uVar5 = 200;
      uVar4 = 0x26;
    }
    else {
      uVar3 = FUN_180073678(local_res8[0],4,local_res8);
      if ((int)uVar3 < 0) {
        uVar5 = 200;
        uVar4 = 0x2c;
      }
      else {
        *(ushort *)((longlong)param_1 + 2) = local_res8[0];
        *(undefined2 *)param_1 = 0;
        lVar1 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8);
        param_1[1] = lVar1;
        if (lVar1 == 0) {
          uVar3 = 0xc0000017;
          goto LAB_1800730d3;
        }
        uVar2 = FUN_1800737b8((ushort *)param_1,param_2);
        uVar3 = (uint)uVar2;
        if ((int)uVar3 < 0) {
          uVar5 = 0xa0;
          uVar4 = 0x3b;
        }
        else if ((*(short *)(param_1[1] + -2 + (ulonglong)(*(ushort *)param_1 >> 1) * 2) == 0x5c) ||
                (uVar3 = FUN_1800736a0((ushort *)param_1,(longlong)param_2), -1 < (int)uVar3)) {
          if ((param_5 != (short *)0x0) && (param_6 != 0)) {
            uVar2 = FUN_18007371c((ushort *)param_1,param_5,(ulonglong)param_6);
            uVar3 = (uint)uVar2;
            if ((int)uVar3 < 0) {
              uVar5 = 0xf0;
              uVar4 = 0x53;
              goto LAB_1800730ba;
            }
          }
          local_48[0] = 0x30;
          local_40 = 0;
          local_30 = 0x40;
          local_28 = ZEXT816(0);
          local_38 = param_1;
          uVar3 = ZwOpenFile(param_1 + 3,0x100001,local_48,local_58,1,0x21);
          if (-1 < (int)uVar3) {
            return uVar3;
          }
          uVar5 = 0x20;
          uVar4 = 0x61;
        }
        else {
          uVar5 = 200;
          uVar4 = 0x4b;
        }
      }
    }
LAB_1800730ba:
    FUN_18001188c(1,0x80,uVar4,uVar5,(char)uVar3);
  }
  if (-1 < (int)uVar3) {
    return uVar3;
  }
LAB_1800730d3:
  FUN_1800731fc((longlong)param_1);
  return uVar3;
}



void FUN_1800730fc(longlong *param_1)

{
  longlong lVar1;
  undefined8 uVar2;
  ulonglong uVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  longlong in_GS_OFFSET;
  longlong local_res8;
  
  if ((param_1 != (longlong *)0x0) && (lVar1 = *param_1, lVar1 != 0)) {
    uVar4 = *(ulonglong *)(lVar1 + 0x20);
    uVar5 = 0;
    if (uVar4 != 0) {
      do {
        uVar3 = 0;
        if ((uVar5 < uVar4) &&
           ((uVar2 = FUN_180073990(*(ulonglong *)(lVar1 + 0x18),uVar5,&local_res8), (int)uVar2 < 0
            || (uVar3 = local_res8 + *(longlong *)(lVar1 + 0x38),
               uVar3 < *(ulonglong *)(lVar1 + 0x38))))) {
          uVar3 = 0;
        }
        FUN_1800731fc(uVar3);
        uVar4 = *(ulonglong *)(lVar1 + 0x20);
        uVar5 = uVar5 + 1;
      } while (uVar5 < uVar4);
    }
    if (*(longlong *)(lVar1 + 0x38) != 0) {
      RtlFreeHeap(*(undefined8 *)(lVar1 + 0x10),0);
    }
    *(undefined (*) [16])(lVar1 + 0x10) = ZEXT816(0);
    *(undefined (*) [16])(lVar1 + 0x20) = ZEXT816(0);
    *(undefined (*) [16])(lVar1 + 0x30) = ZEXT816(0);
    if (*(longlong *)(lVar1 + 8) != 0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
      *(undefined8 *)(lVar1 + 8) = 0;
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lVar1);
    *param_1 = 0;
  }
  return;
}



void FUN_1800731fc(longlong param_1)

{
  longlong in_GS_OFFSET;
  
  if (param_1 != 0) {
    if (*(longlong *)(param_1 + 0x18) != 0) {
      ZwClose();
      *(undefined8 *)(param_1 + 0x18) = 0;
    }
    if (*(longlong *)(param_1 + 8) != 0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
      *(undefined8 *)(param_1 + 8) = 0;
    }
    *(undefined8 *)(param_1 + 0x10) = 0;
  }
  return;
}



int FUN_180073260(short *param_1)

{
  int iVar1;
  int iVar2;
  short *psVar3;
  short sVar4;
  short *psVar5;
  ushort local_18 [4];
  wchar_t *local_10;
  
  if (param_1 == (short *)0x0) {
    return 0;
  }
  if (*param_1 == 0) {
    return 0;
  }
  RtlInitUnicodeString(local_18,param_1);
  if ((local_18[0] < 2) || (*local_10 == L'\0')) {
    FUN_18001188c(1,0x38,0xbe,8,0xf2);
    return 0;
  }
  local_18[0] = local_18[0] >> 1;
  if ((7 < local_18[0]) && (iVar1 = _wcsnicmp(local_10,L"\\??\\UNC\\",8), iVar1 == 0)) {
    iVar1 = 4;
    goto LAB_180073362;
  }
  if (3 < local_18[0]) {
    iVar1 = wcsncmp(local_10,L"\\??\\",4);
    if (iVar1 == 0) {
      iVar1 = 2;
      goto LAB_180073362;
    }
    iVar1 = wcsncmp(local_10,L"\\\\?\\",4);
    if ((iVar1 == 0) || (iVar1 = wcsncmp(local_10,L"\\\\.\\",4), iVar1 == 0)) {
      iVar1 = 3;
      goto LAB_180073362;
    }
  }
  if (2 < local_18[0]) {
    iVar2 = wcsncmp(local_10,L"\\\\",2);
    iVar1 = 3;
    if (iVar2 == 0) goto LAB_180073362;
  }
  iVar1 = 0;
LAB_180073362:
  iVar1 = -iVar1;
  sVar4 = *param_1;
  psVar3 = param_1;
  while (sVar4 != 0) {
    if (sVar4 == 0x5c) {
      if (-1 < iVar1) {
        *psVar3 = 0;
      }
      iVar1 = iVar1 + 1;
    }
    psVar3 = psVar3 + 1;
    sVar4 = *psVar3;
  }
  psVar3[1] = 0;
  sVar4 = *param_1;
  if (sVar4 != 0) {
    while( true ) {
      while (sVar4 != 0) {
        param_1 = param_1 + 1;
        sVar4 = *param_1;
      }
      psVar3 = param_1 + 1;
      sVar4 = *psVar3;
      psVar5 = psVar3;
      if (sVar4 == 0) break;
      do {
        if ((sVar4 == 0x2a) || (sVar4 == 0x3f)) goto LAB_1800733e0;
        sVar4 = psVar5[1];
        psVar5 = psVar5 + 1;
      } while (sVar4 != 0);
      iVar1 = iVar1 + -1;
      *param_1 = 0x5c;
      sVar4 = 0x5c;
      if (*psVar3 == 0) break;
    }
  }
LAB_1800733e0:
  if (iVar1 + 1 < 0) {
    return 0;
  }
  return iVar1 + 1;
}



// WARNING: Could not reconcile some variable overlaps

ulonglong FUN_180073434(longlong param_1,longlong param_2)

{
  longlong *plVar1;
  undefined2 uVar2;
  short *psVar3;
  uint uVar4;
  ulonglong uVar5;
  longlong lVar6;
  undefined8 uVar7;
  ulonglong uVar8;
  short *psVar9;
  longlong in_GS_OFFSET;
  undefined local_18 [4];
  undefined auStack20 [12];
  
  _local_18 = ZEXT816(0);
  if (*(longlong *)(param_1 + 8) == param_2) {
    plVar1 = (longlong *)(param_1 + 0x20);
    if (*plVar1 == 0) {
      uVar5 = FUN_180070bb4(plVar1,*(short **)(param_1 + 0x18));
      uVar5 = uVar5 & 0xffffffff;
    }
    else {
      ZwClose(*plVar1);
      *plVar1 = 0;
      uVar5 = 0x8000001a;
    }
  }
  else {
    lVar6 = -1;
    do {
      lVar6 = lVar6 + 1;
    } while (*(short *)(*(longlong *)(param_1 + 0x18) + lVar6 * 2) != 0);
    psVar9 = (short *)&DAT_00000008;
    auStack20 = SUB1612(_local_18 >> 0x20,0);
    _local_18 = ZEXT1416(CONCAT122(auStack20,((short)lVar6 + 0x105) * 2)) << 0x10;
    uVar7 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
    _local_18 = CONCAT88(uVar7,_local_18);
    psVar3 = *(short **)(*(longlong *)(param_1 + 8) + 0x20);
    do {
      do {
        *auStack20._4_8_ = 0;
        uVar4 = FUN_180070af8(auStack20._4_8_,psVar9,psVar3,*(undefined4 *)(param_1 + 0x28));
        uVar5 = (ulonglong)uVar4;
        if ((int)uVar4 < 0) {
          *(undefined4 *)(param_1 + 0x28) = 0;
          goto LAB_180073595;
        }
        *(int *)(param_1 + 0x28) = *(int *)(param_1 + 0x28) + 1;
        uVar2 = **(undefined2 **)(param_1 + 0x18);
        **(undefined2 **)(param_1 + 0x18) = 0;
        uVar7 = FUN_180073d70(*(short **)(param_1 + 0x10),auStack20._4_8_);
        **(undefined2 **)(param_1 + 0x18) = uVar2;
        psVar9 = auStack20._4_8_;
      } while ((int)uVar7 == 0);
      lVar6 = -1;
      do {
        lVar6 = lVar6 + 1;
      } while (*(short *)((longlong)auStack20._4_8_ + lVar6 * 2) != 0);
      _local_18 = CONCAT142(stack0xffffffffffffffea,(short)lVar6 * 2);
      RtlAppendUnicodeToString(local_18,*(undefined8 *)(param_1 + 0x18));
      plVar1 = (longlong *)(param_1 + 0x20);
      if (*plVar1 != 0) {
        ZwClose(*plVar1);
        *plVar1 = 0;
      }
      psVar9 = psVar3;
      uVar8 = FUN_180070dac(plVar1,psVar3,auStack20._4_8_);
      uVar5 = uVar8 & 0xffffffff;
    } while ((int)uVar8 < 0);
  }
LAB_180073595:
  if (auStack20._4_8_ != (short *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,auStack20._4_8_);
  }
  return uVar5;
}



uint FUN_1800735e0(short *param_1,ulonglong param_2,longlong param_3,ulonglong param_4)

{
  short sVar1;
  short *psVar2;
  ulonglong uVar3;
  longlong lVar4;
  longlong lVar5;
  uint uVar6;
  
  uVar3 = param_2 >> 1;
  uVar6 = 0;
  if (0x7ffffffe < uVar3 - 1) {
    uVar6 = 0xc000000d;
  }
  if (-1 < (int)uVar6) {
    if (param_4 >> 1 < 0x7fffffff) {
      if (uVar3 != 0) {
        lVar5 = (param_4 >> 1) - uVar3;
        lVar4 = param_3 - (longlong)param_1;
        do {
          if ((lVar5 + uVar3 == 0) || (sVar1 = *(short *)(lVar4 + (longlong)param_1), sVar1 == 0))
          break;
          *param_1 = sVar1;
          param_1 = param_1 + 1;
          uVar3 = uVar3 - 1;
        } while (uVar3 != 0);
      }
      psVar2 = param_1 + -1;
      if (uVar3 != 0) {
        psVar2 = param_1;
      }
      uVar6 = ~-(uint)(uVar3 != 0) & 0x80000005;
      *psVar2 = 0;
    }
    else {
      uVar6 = 0xc000000d;
      *param_1 = 0;
    }
  }
  return uVar6;
}



uint FUN_180073678(ushort param_1,short param_2,ushort *param_3)

{
  ushort uVar1;
  bool bVar2;
  
  uVar1 = param_2 + param_1;
  bVar2 = uVar1 < param_1;
  if (bVar2) {
    uVar1 = 0xffff;
  }
  *param_3 = uVar1;
  return -(uint)bVar2 & 0xc0000095;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_1800736a0(ushort *param_1,longlong param_2)

{
  ulonglong uVar1;
  longlong local_res10;
  ulonglong local_res18;
  ulonglong local_res20;
  longlong local_18 [2];
  
  local_res10 = param_2;
  uVar1 = FUN_180073874(param_1,local_18,&local_res18,&local_res20);
  if (-1 < (int)uVar1) {
    local_res10 = 0;
    RtlWideCharArrayCopyStringWorker
              (local_18[0] + local_res20 * 2,local_res18 - local_res20,&local_res10,
               (short *)&DAT_180085358,0x7fff);
    *param_1 = ((short)local_res20 + (short)local_res10) * 2;
  }
  return;
}



// WARNING: Could not reconcile some variable overlaps

ulonglong FUN_18007371c(ushort *param_1,short *param_2,ulonglong param_3)

{
  ulonglong uVar1;
  longlong local_res20;
  ulonglong local_28;
  ulonglong local_20;
  longlong local_18 [2];
  
  uVar1 = FUN_180073874(param_1,local_18,&local_28,&local_20);
  if (-1 < (int)uVar1) {
    if (param_3 >> 1 < 0x8000) {
      local_res20 = 0;
      uVar1 = RtlWideCharArrayCopyStringWorker
                        (local_18[0] + local_20 * 2,local_28 - local_20,&local_res20,param_2,
                         param_3 >> 1);
      *param_1 = ((short)local_20 + (short)local_res20) * 2;
    }
    else {
      uVar1 = 0xc000000d;
    }
  }
  return uVar1;
}



ulonglong FUN_1800737b8(ushort *param_1,ushort *param_2)

{
  ulonglong uVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  ulonglong uVar4;
  undefined2 *puVar5;
  ulonglong local_res18;
  longlong local_res20;
  
  uVar2 = 0;
  uVar1 = FUN_180073874(param_1,&local_res20,&local_res18,(ulonglong *)0x0);
  if ((int)uVar1 < 0) {
    return uVar1 & 0xffffffff;
  }
  puVar5 = (undefined2 *)(uVar2 & 0xffffffff);
  uVar4 = uVar2 & 0xffffffff;
  uVar1 = FUN_1800738e0(param_2);
  uVar3 = uVar1 & 0xffffffff;
  if (-1 < (int)uVar1) {
    if (param_2 != (ushort *)0x0) {
      puVar5 = *(undefined2 **)(param_2 + 4);
      uVar4 = (ulonglong)(*param_2 >> 1);
    }
    if (-1 < (int)uVar1) {
      uVar3 = uVar2 & 0xffffffff;
      if (local_res18 != 0) {
        local_res20 = local_res20 - (longlong)puVar5;
        do {
          if (uVar4 == 0) break;
          uVar4 = uVar4 - 1;
          *(undefined2 *)(local_res20 + (longlong)puVar5) = *puVar5;
          uVar2 = uVar2 + 1;
          puVar5 = puVar5 + 1;
          local_res18 = local_res18 - 1;
        } while (local_res18 != 0);
        if (local_res18 != 0) goto LAB_180073854;
      }
      if (uVar4 != 0) {
        uVar3 = 0x80000005;
      }
    }
  }
LAB_180073854:
  *param_1 = (short)uVar2 * 2;
  return uVar3;
}



ulonglong FUN_180073874(ushort *param_1,undefined8 *param_2,ulonglong *param_3,ulonglong *param_4)

{
  ulonglong uVar1;
  ushort *puVar2;
  
  *param_2 = 0;
  *param_3 = 0;
  if (param_4 != (ulonglong *)0x0) {
    *param_4 = 0;
  }
  puVar2 = param_1;
  uVar1 = FUN_1800738e0(param_1);
  if ((-1 < (int)uVar1) && (puVar2 != (ushort *)0x0)) {
    *param_2 = *(undefined8 *)(param_1 + 4);
    *param_3 = (ulonglong)(puVar2[1] >> 1);
    if (param_4 != (ulonglong *)0x0) {
      *param_4 = (ulonglong)(*puVar2 >> 1);
    }
  }
  return uVar1 & 0xffffffff;
}



undefined8 FUN_1800738e0(ushort *param_1)

{
  ushort uVar1;
  undefined8 uVar2;
  
  uVar2 = 0;
  if ((((((*(byte *)param_1 & 1) != 0) || (uVar1 = param_1[1], (uVar1 & 1) != 0)) ||
       (uVar1 <= *param_1 && *param_1 != uVar1)) || (uVar1 == 0xffff)) ||
     ((*(longlong *)(param_1 + 4) == 0 && ((*param_1 != 0 || (uVar1 != 0)))))) {
    uVar2 = 0xc000000d;
  }
  return uVar2;
}



// Library Function - Single Match
//  RtlWideCharArrayCopyStringWorker
// 
// Library: Visual Studio 2019 Release

longlong RtlWideCharArrayCopyStringWorker
                   (longlong param_1,longlong param_2,longlong *param_3,short *param_4,
                   longlong param_5)

{
  longlong lVar1;
  longlong lVar2;
  longlong lVar3;
  
  lVar1 = 0;
  lVar3 = lVar1;
  if (param_2 != 0) {
    lVar2 = param_1 - (longlong)param_4;
    do {
      if ((param_5 == 0) || (*param_4 == 0)) break;
      *(short *)(lVar2 + (longlong)param_4) = *param_4;
      param_5 = param_5 + -1;
      param_4 = param_4 + 1;
      lVar3 = lVar3 + 1;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
    if (param_2 != 0) goto LAB_18007397d;
  }
  if ((param_5 != 0) && (lVar1 = 0, *param_4 != 0)) {
    lVar1 = 0x80000005;
  }
LAB_18007397d:
  *param_3 = lVar3;
  return lVar1;
}



undefined8 FUN_180073990(ulonglong param_1,ulonglong param_2,undefined8 *param_3)

{
  if (SUB168(ZEXT816(param_2) * ZEXT816(param_1) >> 0x40,0) == 0) {
    *param_3 = SUB168(ZEXT816(param_2) * ZEXT816(param_1),0);
    return 0;
  }
  *param_3 = 0xffffffffffffffff;
  return 0x80070216;
}



int FUN_1800739b8(wchar_t *param_1,undefined8 param_2,uint *param_3)

{
  int iVar1;
  
  iVar1 = FUN_180039540(param_1,0x2b,
                        L"{%08lx-%04hx-%04hx-%02hx%02hx-%02hx%02hx%02hx%02hx%02hx%02hx}",
                        (ulonglong)*param_3);
  if (iVar1 < 0) {
    FUN_18001188c(1,0x40,0x45,0x98,(char)iVar1);
  }
  else {
    iVar1 = 0;
  }
  return iVar1;
}



int FUN_180073a94(undefined4 *param_1,uint *param_2)

{
  int iVar1;
  wchar_t *pwVar2;
  longlong in_GS_OFFSET;
  undefined in_stack_ffffffffffffff98;
  
  *param_1 = 0x4e004c;
  pwVar2 = (wchar_t *)RtlAllocateHeap();
  if (pwVar2 == (wchar_t *)0x0) {
    FUN_18001188c(1,0xa0,0xed,0x98,in_stack_ffffffffffffff98);
    iVar1 = -0x3fffffe9;
  }
  else {
    iVar1 = FUN_180039540(pwVar2,(ulonglong)(*(ushort *)((longlong)param_1 + 2) >> 1),
                          L"{%08lx-%04hx-%04hx-%02hx%02hx-%02hx%02hx%02hx%02hx%02hx%02hx}",
                          (ulonglong)*param_2);
    if (iVar1 < 0) {
      FUN_18001188c(1,0xa0,1,0x98,(char)iVar1);
    }
    else {
      *(wchar_t **)(param_1 + 2) = pwVar2;
      pwVar2 = (wchar_t *)0x0;
      iVar1 = 0;
    }
    if (pwVar2 != (wchar_t *)0x0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pwVar2);
    }
  }
  return iVar1;
}



// WARNING: Could not reconcile some variable overlaps

int FUN_180073c10(undefined8 *param_1)

{
  uint uVar1;
  longlong lVar2;
  uint uVar3;
  undefined uVar4;
  undefined uVar5;
  longlong in_GS_OFFSET;
  undefined in_stack_ffffffffffffffc8;
  undefined local_28 [8];
  longlong lStack32;
  undefined local_18 [16];
  
  RtlInitString(local_18);
  uVar1 = RtlxAnsiStringToUnicodeSize(local_18);
  uVar3 = 0;
  *param_1 = 0;
  _local_28 = ZEXT816(0);
  if (uVar1 < 0x10000) {
    lVar2 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,uVar1);
    _local_28 = CONCAT88(lVar2,local_28);
    if (lVar2 == 0) {
      uVar3 = 0xc0000017;
      FUN_18001188c(1,0x80,0x8b,0x98,in_stack_ffffffffffffffc8);
      goto LAB_180073d27;
    }
    _local_28 = ZEXT1416(CONCAT122(stack0xffffffffffffffdc,(short)uVar1)) << 0x10;
    uVar1 = RtlAnsiStringToUnicodeString(local_28,local_18,0);
    if (-1 < (int)uVar1) {
      *param_1 = lStack32;
      _local_28 = _local_28 & (undefined  [16])0xffffffffffffffff;
      goto LAB_180073d27;
    }
    uVar5 = 0x98;
    uVar4 = 0x94;
    uVar3 = uVar1;
  }
  else {
    uVar5 = 0x50;
    uVar4 = 0x84;
    uVar3 = 0xc000000d;
  }
  FUN_18001188c(1,0x80,uVar4,uVar5,(char)uVar1);
LAB_180073d27:
  if (lStack32 != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lStack32);
  }
  return uVar3;
}



undefined8 FUN_180073d70(short *param_1,short *param_2)

{
  short sVar1;
  short sVar2;
  undefined8 uVar3;
  short *psVar4;
  
  sVar1 = *param_1;
LAB_180073d93:
  do {
    psVar4 = param_1;
    if ((sVar1 == 0) && (*param_2 == 0)) {
      return 1;
    }
    if (sVar1 == 0x3f) {
LAB_180073dd5:
      psVar4 = psVar4 + 1;
      goto LAB_180073e29;
    }
    if (sVar1 != 0x2a) {
      sVar1 = RtlUpcaseUnicodeChar();
      sVar2 = RtlUpcaseUnicodeChar();
      if (sVar2 != sVar1) {
        return 0;
      }
      goto LAB_180073dd5;
    }
    param_1 = psVar4 + 1;
    sVar1 = *param_1;
  } while (sVar1 == 0x2a);
  if (sVar1 != 0) {
    sVar1 = RtlUpcaseUnicodeChar(sVar1);
    sVar2 = RtlUpcaseUnicodeChar();
    if ((sVar1 != sVar2) || (uVar3 = FUN_180073d70(param_1,param_2), (int)uVar3 == 0)) {
LAB_180073e29:
      if (*param_2 == 0) {
        return 0;
      }
      sVar1 = *psVar4;
      param_2 = param_2 + 1;
      param_1 = psVar4;
      goto LAB_180073d93;
    }
  }
  return 1;
}



longlong FUN_180073e64(longlong param_1,uint param_2,char *param_3,uint param_4)

{
  uint uVar1;
  char *pcVar3;
  uint uVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  ulonglong uVar2;
  
  if ((param_2 != 0) && (param_4 <= param_2)) {
    uVar6 = 0;
    do {
      uVar2 = uVar6;
      pcVar3 = param_3;
      uVar5 = 0;
      uVar4 = 0;
      if (param_4 != 0) {
        do {
          uVar4 = (uint)uVar5;
          if (param_2 <= (uint)uVar2) break;
          if ((*(char *)(uVar2 + param_1) == '\0') &&
             (uVar1 = (uint)uVar2 + 1, uVar2 = (ulonglong)uVar1, param_2 <= uVar1)) {
            return 0;
          }
          if (*(char *)(uVar2 + param_1) != *pcVar3) break;
          uVar4 = uVar4 + 1;
          uVar2 = (ulonglong)((int)uVar2 + 1);
          pcVar3 = pcVar3 + 1;
          uVar5 = (ulonglong)uVar4;
        } while (uVar4 < param_4);
      }
      if (uVar4 == param_4) {
        return uVar6 + param_1;
      }
      uVar4 = (int)uVar6 + 1;
      uVar6 = (ulonglong)uVar4;
    } while (uVar4 + param_4 <= param_2);
  }
  return 0;
}



longlong FUN_180073efc(longlong param_1,uint param_2,short *param_3,uint param_4)

{
  uint uVar1;
  short *psVar3;
  uint uVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  ulonglong uVar2;
  
  if ((param_2 != 0) && (param_4 <= param_2)) {
    uVar6 = 0;
    do {
      uVar2 = uVar6;
      psVar3 = param_3;
      uVar5 = 0;
      uVar4 = 0;
      if (param_4 != 0) {
        do {
          uVar4 = (uint)uVar5;
          if (param_2 <= (uint)uVar2) break;
          if ((*(short *)(param_1 + uVar2 * 2) == 0) &&
             (uVar1 = (uint)uVar2 + 1, uVar2 = (ulonglong)uVar1, param_2 <= uVar1)) {
            return 0;
          }
          if (*(short *)(param_1 + uVar2 * 2) != *psVar3) break;
          uVar4 = uVar4 + 1;
          uVar2 = (ulonglong)((int)uVar2 + 1);
          psVar3 = psVar3 + 1;
          uVar5 = (ulonglong)uVar4;
        } while (uVar4 < param_4);
      }
      if (uVar4 == param_4) {
        return param_1 + uVar6 * 2;
      }
      uVar4 = (int)uVar6 + 1;
      uVar6 = (ulonglong)uVar4;
    } while (uVar4 + param_4 <= param_2);
  }
  return 0;
}



undefined8 FUN_180073f98(short *param_1)

{
  ushort uVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  ulonglong uVar4;
  
  if (param_1 == (short *)0x0) {
    return 0xc000000d;
  }
  if (*param_1 != 0) {
    uVar3 = 0xffffffffffffffff;
    do {
      uVar3 = uVar3 + 1;
    } while (param_1[uVar3] != 0);
    uVar2 = 0;
    if (uVar3 != 0) {
      do {
        uVar1 = param_1[uVar2];
        uVar4 = 0;
        do {
          if ((*(ushort *)((longlong)&DAT_18008e500 + uVar4) <= uVar1) &&
             (uVar1 < *(ushort *)((longlong)&DAT_18008e502 + uVar4) ||
              uVar1 == *(ushort *)((longlong)&DAT_18008e502 + uVar4))) goto LAB_180073ff6;
          uVar4 = uVar4 + 4;
        } while (uVar4 < 0x14);
        param_1[uVar2] = 0x40;
LAB_180073ff6:
        uVar2 = uVar2 + 1;
      } while (uVar2 < uVar3);
    }
  }
  return 0;
}



void FUN_180074008(undefined (*param_1) [16])

{
  longlong in_GS_OFFSET;
  
  if (param_1 != (undefined (*) [16])0x0) {
    if (*(void **)(*param_1 + 8) != (void *)0x0) {
      memset(*(void **)(*param_1 + 8),0x42,(ulonglong)*(ushort *)(*param_1 + 2));
      if (*(longlong *)(*param_1 + 8) != 0) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
      }
    }
    *param_1 = ZEXT816(0);
  }
  return;
}



longlong FUN_180074064(short *param_1,wchar_t *param_2,ulonglong param_3,wchar_t *param_4,
                      ulonglong param_5,longlong *param_6)

{
  int iVar1;
  longlong lVar2;
  wchar_t *pwVar3;
  longlong lVar4;
  ulonglong uVar5;
  longlong lVar6;
  ulonglong uVar7;
  ulonglong local_res18 [2];
  
  lVar4 = 0;
  lVar6 = lVar4;
  if (param_3 != 0) {
    do {
      uVar7 = 0;
      if (*param_2 == L'%') {
        uVar5 = param_3 - 1;
        pwVar3 = param_2 + 1;
        if (uVar5 == 0) goto LAB_1800741b8;
        do {
          if (*pwVar3 == L'%') break;
          pwVar3 = pwVar3 + 1;
          uVar7 = uVar7 + 1;
        } while (uVar7 < uVar5);
        if ((uVar7 == 0) || (uVar5 <= uVar7)) goto LAB_1800741b8;
        lVar2 = FUN_1800746e0(param_1,param_2 + 1,uVar7,param_4,param_5,local_res18);
        iVar1 = (int)lVar2;
        if (iVar1 == -0x3fffffdd) {
          lVar6 = lVar6 + (local_res18[0] - 1);
          uVar5 = param_3 + (-2 - uVar7);
LAB_18007413f:
          lVar4 = 0xc0000023;
        }
        else if (iVar1 < 0) {
          if (iVar1 != -0x3fffff00) {
            FUN_18001188c(1,0x50,0x7f,0x30,(char)lVar2);
          }
          lVar6 = lVar6 + 1;
          pwVar3 = param_2;
        }
        else {
          lVar6 = lVar6 + local_res18[0];
          uVar5 = param_3 + (-2 - uVar7);
          if (param_5 <= local_res18[0]) goto LAB_18007413f;
          param_5 = param_5 - local_res18[0];
          param_4 = param_4 + local_res18[0];
        }
      }
      else {
LAB_1800741b8:
        if ((int)lVar4 != -0x3fffffdd) {
          if (param_5 < 2) {
            lVar4 = 0xc0000023;
          }
          else {
            param_5 = param_5 - 1;
            *param_4 = *param_2;
            param_4 = param_4 + 1;
          }
        }
        lVar6 = lVar6 + 1;
        uVar5 = param_3 - 1;
        pwVar3 = param_2;
      }
      param_2 = pwVar3 + 1;
      param_3 = uVar5;
    } while (uVar5 != 0);
    if ((int)lVar4 == -0x3fffffdd) goto LAB_1800741ff;
  }
  if (param_5 == 0) {
    lVar4 = 0xc0000023;
  }
  else {
    *param_4 = L'\0';
  }
LAB_1800741ff:
  if (param_6 != (longlong *)0x0) {
    *param_6 = lVar6 + 1;
  }
  return lVar4;
}



ulonglong FUN_180074234(short *param_1,wchar_t *param_2,wchar_t *param_3,ulonglong param_4,
                       longlong *param_5,short param_6,short param_7)

{
  ulonglong uVar1;
  wchar_t *pwVar2;
  longlong lVar3;
  uint uVar4;
  longlong lVar5;
  ulonglong uVar6;
  ulonglong uVar7;
  undefined uVar8;
  undefined uVar9;
  longlong in_GS_OFFSET;
  uint local_res10 [2];
  undefined uVar10;
  
  pwVar2 = (wchar_t *)0x0;
  uVar7 = 0xffffffffffffffff;
  local_res10[0] = 0;
  lVar5 = -1;
  do {
    lVar5 = lVar5 + 1;
  } while (param_2[lVar5] != L'\0');
  uVar4 = (int)lVar5 + 1;
  if (param_3 != (wchar_t *)0x0) {
    *param_3 = L'\0';
  }
  if (param_5 != (longlong *)0x0) {
    *param_5 = 0;
  }
  uVar10 = (undefined)param_6;
  uVar1 = FUN_1800748b4(param_2,uVar4,(short *)0x0,0,param_6,param_7,local_res10);
  if ((int)uVar1 != -0x3fffffdd) {
    uVar7 = 0xc00000e5;
    uVar9 = 0x68;
    uVar8 = 7;
LAB_1800742df:
    FUN_18001188c(1,0xa8,uVar8,uVar9,uVar10);
    return uVar7;
  }
  if (uVar4 == local_res10[0]) {
LAB_1800743a8:
    do {
      uVar7 = uVar7 + 1;
    } while (param_2[uVar7] != L'\0');
    uVar7 = FUN_180074064(param_1,param_2,uVar7,param_3,param_4,param_5);
    uVar6 = uVar7 & 0xffffffff;
    if ((((int)uVar7 + 0x80000000U & 0x80000000) != 0) || ((int)uVar6 == -0x3fffffdd))
    goto LAB_180074411;
    uVar10 = (undefined)uVar6;
    uVar9 = 0xe0;
    uVar8 = 0x2a;
  }
  else {
    pwVar2 = (wchar_t *)
             RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,
                             (ulonglong)local_res10[0] * 2);
    if (pwVar2 == (wchar_t *)0x0) {
      uVar7 = 0xc0000017;
      uVar9 = 0x98;
      uVar8 = 0xf;
      goto LAB_1800742df;
    }
    lVar5 = -1;
    do {
      lVar3 = lVar5;
      lVar5 = lVar3 + 1;
    } while (param_2[lVar5] != L'\0');
    uVar1 = FUN_1800748b4(param_2,(int)lVar3 + 2,pwVar2,local_res10[0],param_6,param_7,local_res10);
    uVar6 = uVar1 & 0xffffffff;
    param_2 = pwVar2;
    if (-1 < (int)uVar1) goto LAB_1800743a8;
    uVar10 = (undefined)uVar1;
    uVar9 = 0xc0;
    uVar8 = 0x1b;
  }
  FUN_18001188c(1,0xa8,uVar8,uVar9,uVar10);
LAB_180074411:
  if (pwVar2 == (wchar_t *)0x0) {
    return uVar6;
  }
  RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pwVar2);
  return uVar6;
}



void FUN_180074458(short *param_1,longlong param_2,short *param_3,short param_4,short *param_5)

{
  uint uVar1;
  ulonglong uVar2;
  undefined uVar3;
  undefined uVar4;
  undefined auStackY232 [32];
  short local_b8 [64];
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStackY232;
  memset(local_b8,0,0x80);
  *param_1 = 0;
  if ((param_5 == (short *)0x0) || (*param_5 == param_4)) {
    FUN_180074590(param_1,param_2,param_3,param_4,param_5);
    goto LAB_180074568;
  }
  uVar1 = FUN_1800099f8(local_b8,0x40,(longlong)L"\\SysNative");
  if ((int)uVar1 < 0) {
    uVar4 = 0x30;
    uVar3 = 0x96;
  }
  else if ((param_3 == (short *)0x0) || (*param_3 == 0)) {
    uVar1 = FUN_18000ecd4(param_1,param_2,(longlong)local_b8);
    if (-1 < (int)uVar1) goto LAB_180074568;
    uVar4 = 0x50;
    uVar3 = 0xa8;
  }
  else {
    uVar2 = FUN_18000b98c(local_b8,param_3,param_1,param_2);
    uVar1 = (uint)uVar2;
    if (-1 < (int)uVar1) goto LAB_180074568;
    uVar4 = 0xd0;
    uVar3 = 0xa0;
  }
  FUN_18001188c(1,0x30,uVar3,uVar4,(char)uVar1);
LAB_180074568:
  __security_check_cookie(local_38 ^ (ulonglong)auStackY232);
  return;
}



void FUN_180074590(short *param_1,longlong param_2,short *param_3,short param_4,short *param_5)

{
  uint uVar1;
  short *psVar2;
  short sVar3;
  undefined uVar4;
  ulonglong uVar5;
  undefined uVar6;
  undefined auStackY232 [32];
  short local_b8 [64];
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStackY232;
  memset(local_b8,0,0x80);
  uVar5 = 0;
  *param_1 = 0;
  sVar3 = param_4;
  if (param_5 != (short *)0x0) {
    sVar3 = *param_5;
  }
  psVar2 = &DAT_1800b2102;
  while ((psVar2[-1] != param_4 || (*psVar2 != sVar3))) {
    uVar5 = uVar5 + 1;
    psVar2 = psVar2 + 8;
    if (6 < uVar5) {
LAB_180074612:
      __security_check_cookie(local_38 ^ (ulonglong)auStackY232);
      return;
    }
  }
  uVar1 = FUN_1800099f8(local_b8,0x40,(longlong)(&PTR_u__System32_1800b2108)[uVar5 * 2]);
  if ((int)uVar1 < 0) {
    uVar6 = 0x30;
    uVar4 = 0x86;
  }
  else if ((param_3 == (short *)0x0) || (*param_3 == 0)) {
    uVar1 = FUN_18000ecd4(param_1,param_2,(longlong)local_b8);
    if (-1 < (int)uVar1) goto LAB_180074612;
    uVar6 = 0x50;
    uVar4 = 0x98;
  }
  else {
    uVar5 = FUN_18000b98c(local_b8,param_3,param_1,param_2);
    uVar1 = (uint)uVar5;
    if (-1 < (int)uVar1) goto LAB_180074612;
    uVar6 = 0xd0;
    uVar4 = 0x90;
  }
  FUN_18001188c(1,0xb0,uVar4,uVar6,(char)uVar1);
  goto LAB_180074612;
}



longlong FUN_1800746e0(short *param_1,wchar_t *param_2,ulonglong param_3,undefined2 *param_4,
                      ulonglong param_5,ulonglong *param_6)

{
  wchar_t *pwVar1;
  bool bVar2;
  short sVar3;
  short sVar4;
  int iVar5;
  void *_Src;
  longlong lVar6;
  ulonglong uVar7;
  short *psVar9;
  short *psVar10;
  longlong lVar11;
  wchar_t *pwVar12;
  ulonglong uVar8;
  
  pwVar1 = param_2 + param_3;
  lVar11 = 0;
  if ((param_3 < 10) || (iVar5 = _wcsnicmp(param_2,L"systemroot",10), iVar5 != 0)) {
    if (param_1 != (short *)0x0) {
      while (*param_1 != 0) {
        psVar10 = param_1;
        pwVar12 = param_2;
        if (param_2 < pwVar1) {
          do {
            if (*psVar10 == 0) break;
            sVar3 = RtlUpcaseUnicodeChar(*psVar10);
            sVar4 = RtlUpcaseUnicodeChar();
            if (sVar3 != sVar4) break;
            psVar10 = psVar10 + 1;
            pwVar12 = pwVar12 + 1;
          } while (pwVar12 < pwVar1);
        }
        if ((pwVar12 == pwVar1) && (*psVar10 == 0x3d)) {
          bVar2 = true;
          psVar9 = psVar10;
LAB_180074803:
          sVar3 = *psVar9;
          psVar10 = psVar9;
          for (lVar6 = lVar11; (sVar3 != 0 && (lVar6 < 0xfffe)); lVar6 = lVar6 + 2) {
            psVar10 = psVar10 + 1;
            sVar3 = *psVar10;
          }
          if (bVar2) {
            uVar7 = (longlong)psVar10 - (longlong)(psVar9 + 1) >> 1;
            if (uVar7 < param_5) {
              memcpy(param_4,psVar9 + 1,uVar7 * 2);
              param_4[uVar7] = 0;
            }
            else {
              if ((param_4 != (undefined2 *)0x0) && (param_5 != 0)) {
                *param_4 = 0;
              }
              lVar11 = 0xc0000023;
              uVar7 = uVar7 + 1;
            }
            *param_6 = uVar7;
            return lVar11;
          }
        }
        else {
          bVar2 = false;
          for (; *psVar10 != 0; psVar10 = psVar10 + 1) {
            if ((*psVar10 == 0x3d) && (psVar9 = psVar10, psVar10 != param_1)) goto LAB_180074803;
          }
        }
        param_1 = psVar10 + 1;
      }
    }
    lVar11 = 0xc0000100;
  }
  else {
    _Src = (void *)FUN_18001b894();
    uVar7 = 0xffffffffffffffff;
    do {
      uVar8 = uVar7;
      uVar7 = uVar8 + 1;
    } while (*(short *)((longlong)_Src + uVar7 * 2) != 0);
    if (uVar7 < param_5) {
      *param_6 = uVar7;
      memcpy(param_4,_Src,uVar7 * 2);
      param_4[uVar7] = 0;
    }
    else {
      if ((param_4 != (undefined2 *)0x0) && (param_5 != 0)) {
        *param_4 = 0;
      }
      lVar11 = 0xc0000023;
      *param_6 = uVar8 + 2;
    }
  }
  return lVar11;
}



ulonglong FUN_1800748b4(wchar_t *param_1,uint param_2,short *param_3,uint param_4,short param_5,
                       short param_6,uint *param_7)

{
  short sVar1;
  int iVar2;
  uint uVar3;
  short *psVar4;
  short *psVar5;
  ulonglong uVar6;
  ulonglong uVar7;
  uint uVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  undefined uVar11;
  undefined uVar12;
  ulonglong uVar13;
  
  uVar6 = 0;
  uVar7 = uVar6;
  uVar9 = uVar6;
  uVar13 = uVar6;
  do {
    uVar8 = (uint)uVar7;
    if ((int)uVar6 != 0) goto LAB_180074bfd;
    if ((&DAT_1800b2180)[uVar13 * 6] < param_2) {
      iVar2 = _wcsnicmp(param_1,(wchar_t *)(&PTR_u__system32__1800b2170)[uVar13 * 3],
                        (ulonglong)(&DAT_1800b2180)[uVar13 * 6]);
      uVar10 = 0;
      if (iVar2 == 0) {
        uVar8 = ((&DAT_1800b2184)[uVar13 * 6] - (&DAT_1800b2180)[uVar13 * 6]) + param_2;
        uVar7 = (ulonglong)uVar8;
        if (param_4 < uVar8) {
          uVar7 = 0xc0000023;
          goto LAB_180074c00;
        }
        if (uVar13 == 0) {
          do {
            uVar6 = 0;
            if ((*(short *)((longlong)&DAT_1800b2100 + uVar10) == param_5) &&
               (*(short *)((longlong)&DAT_1800b2102 + uVar10) == param_6)) {
              uVar9 = (ulonglong)param_4;
              if (0x7ffffffe < uVar9 - 1) {
                uVar6 = 0xc000000d;
              }
              if ((int)uVar6 < 0) {
                if (uVar9 != 0) {
                  *param_3 = 0;
                }
              }
              else {
                psVar5 = param_3;
                uVar6 = uVar9;
                if (uVar9 != 0) {
                  do {
                    if (((0x7ffffffe - uVar9) + uVar6 == 0) ||
                       (sVar1 = *(short *)(((longlong)L"%systemroot%" - (longlong)param_3) +
                                          (longlong)psVar5), sVar1 == 0)) break;
                    *psVar5 = sVar1;
                    psVar5 = psVar5 + 1;
                    uVar6 = uVar6 - 1;
                  } while (uVar6 != 0);
                }
                psVar4 = psVar5 + -1;
                if (uVar6 != 0) {
                  psVar4 = psVar5;
                }
                uVar6 = (ulonglong)(~-(uint)(uVar6 != 0) & 0x80000005);
                *psVar4 = 0;
              }
              uVar3 = (uint)uVar6;
              if ((int)uVar3 < 0) {
                uVar11 = 0xac;
                goto LAB_180074b9b;
              }
              uVar6 = FUN_18000bab4(param_3,uVar9,
                                    *(longlong *)((longlong)&PTR_u__System32_1800b2108 + uVar10));
              uVar3 = (uint)uVar6;
              uVar6 = uVar6 & 0xffffffff;
              if ((int)uVar3 < 0) {
                uVar12 = 0x18;
                uVar11 = 0xb2;
                goto LAB_180074ba2;
              }
              uVar6 = FUN_18000bab4(param_3,uVar9,(longlong)(param_1 + DAT_1800b2180));
              uVar3 = (uint)uVar6;
              uVar6 = uVar6 & 0xffffffff;
              if ((int)uVar3 < 0) {
                uVar12 = 0x18;
                uVar11 = 0xb8;
                goto LAB_180074ba2;
              }
              uVar9 = 1;
            }
            uVar10 = uVar10 + 0x10;
          } while (uVar10 < 0x70);
          if ((int)uVar9 == 0) {
            FUN_18001188c((char)uVar9 + '\x01',0,0xc3,0x40,(char)param_5);
            goto LAB_180074acc;
          }
        }
        else {
LAB_180074acc:
          if ((int)uVar9 == 0) {
            uVar3 = FUN_18000ecd4(param_3,(ulonglong)param_4,
                                  (longlong)(&PTR_u__systemroot__system32_1800b2178)[uVar13 * 3]);
            uVar6 = (ulonglong)uVar3;
            if ((int)uVar3 < 0) {
              uVar11 = 0xd4;
              goto LAB_180074b9b;
            }
            uVar6 = FUN_18000bab4(param_3,(ulonglong)param_4,
                                  (longlong)(param_1 + (&DAT_1800b2180)[uVar13 * 6]));
            uVar3 = (uint)uVar6;
            uVar6 = uVar6 & 0xffffffff;
            if ((int)uVar3 < 0) {
              uVar12 = 0x18;
              uVar11 = 0xda;
              goto LAB_180074ba2;
            }
          }
        }
        uVar6 = 1;
      }
    }
    uVar13 = uVar13 + 1;
  } while (uVar13 < 4);
  uVar8 = (uint)uVar7;
  if ((int)uVar6 == 0) {
    if (param_4 < param_2) {
      *param_7 = param_2;
      return 0xc0000023;
    }
    uVar3 = FUN_18000ecd4(param_3,(ulonglong)param_4,(longlong)param_1);
    uVar6 = (ulonglong)uVar3;
    uVar8 = param_2;
    if ((int)uVar3 < 0) {
      uVar11 = 0xfa;
LAB_180074b9b:
      uVar12 = 0x50;
LAB_180074ba2:
      FUN_18001188c(1,0,uVar11,uVar12,(char)uVar3);
      return uVar6;
    }
  }
LAB_180074bfd:
  uVar7 = 0;
LAB_180074c00:
  *param_7 = uVar8;
  return uVar7;
}



ulonglong FUN_180074c28(longlong param_1)

{
  int *piVar1;
  uint uVar2;
  ulonglong uVar3;
  
  if (*(int *)(param_1 + 0x48) == 0) {
    if (*(longlong *)(param_1 + 0x20) != 0) {
      return 0;
    }
    piVar1 = (int *)(param_1 + 0x38);
    if (*piVar1 != 1) {
      uVar2 = FUN_180010174((longlong *)(param_1 + 8),'\0');
      if ((int)uVar2 < 0) {
        return (ulonglong)uVar2;
      }
      if (*(char *)(param_1 + 0x33) != '\0') {
        *piVar1 = 6;
        return (ulonglong)uVar2;
      }
      uVar3 = FUN_180010090(param_1 + 8,piVar1);
      if (-1 < (int)uVar3) {
        return uVar3 & 0xffffffff;
      }
      FUN_18001188c(1,0x60,0x4f,0x10,(char)*(undefined8 *)param_1);
      *piVar1 = 3;
      return uVar3 & 0xffffffff;
    }
  }
  else if (*(int *)(param_1 + 0x38) != 1) {
    return (ulonglong)(~-(uint)(*(longlong *)(param_1 + 0x20) != 0) & 0xc000046d);
  }
  return 0xc000011e;
}



ulonglong FUN_180074cf8(int *param_1,longlong param_2)

{
  int iVar1;
  ulonglong uVar2;
  int iVar3;
  undefined uVar4;
  undefined uVar5;
  short local_res8 [4];
  short local_res10 [4];
  uint local_res18 [2];
  uint local_res20 [2];
  
  iVar3 = 0;
  local_res10[0] = 0;
  local_res8[0] = 0;
  local_res20[0] = 0;
  local_res18[0] = 0;
  if (*(int *)(param_2 + 0x38) == 1) {
    iVar3 = 1;
  }
  else {
    uVar2 = FUN_180074c28(param_2);
    iVar1 = (int)uVar2;
    if (iVar1 < 0) {
      uVar5 = 0x78;
      uVar4 = 0x50;
LAB_180074d50:
      uVar2 = uVar2 & 0xffffffff;
LAB_180074d54:
      FUN_18001188c(1,0x68,uVar4,uVar5,(char)iVar1);
      goto LAB_180074e9c;
    }
    iVar1 = *(int *)(param_2 + 0x38);
    if (iVar1 == 3) {
      iVar3 = 2;
    }
    else if (iVar1 == 4) {
      iVar3 = 3;
    }
    else if (iVar1 == 5) {
      iVar3 = 4;
    }
    else {
      if (iVar1 != 6) {
        uVar2 = 0xc0000001;
        uVar5 = 0x88;
        uVar4 = 0x73;
        goto LAB_180074d54;
      }
      uVar2 = FUN_180074ebc(local_res10,local_res8,local_res18,local_res20,param_2);
      iVar1 = (int)uVar2;
      if (iVar1 < 0) {
        uVar5 = 0xa8;
        uVar4 = 0x7d;
        goto LAB_180074d50;
      }
      if (local_res18[0] == 0) {
        if (local_res8[0] == 0x20b) {
          if (local_res10[0] == 0x200) {
            iVar3 = 0xb;
          }
          else if (local_res10[0] == -0x799c) {
            iVar3 = 9;
          }
          else {
            iVar3 = 10;
            if (local_res10[0] != -0x559c) {
              iVar3 = 8;
            }
          }
        }
        else if (local_res10[0] == 0x14c) {
          iVar3 = 6;
        }
        else if ((local_res10[0] == 0x1c0) || (local_res10[0] == 0x1c4)) {
          iVar3 = 7;
        }
        else {
          iVar3 = 5;
        }
      }
      else if (local_res8[0] == 0x20b) {
        iVar3 = 0xf;
      }
      else if ((local_res20[0] & 0x20002) == 0x20002) {
        iVar3 = 0xe;
      }
      else {
        iVar3 = 0xd - (uint)((local_res20[0] & 0x20003) != 1);
      }
    }
  }
  uVar2 = 0;
LAB_180074e9c:
  if (param_1 != (int *)0x0) {
    *param_1 = iVar3;
  }
  return uVar2;
}



ulonglong FUN_180074ebc(short *param_1,short *param_2,uint *param_3,undefined4 *param_4,
                       longlong param_5)

{
  uint uVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  short sVar4;
  uint uVar5;
  undefined uVar6;
  undefined uVar7;
  short sVar8;
  bool bVar9;
  undefined in_stack_ffffffffffffff88;
  undefined4 local_64;
  uint local_60;
  longlong local_50;
  longlong local_48;
  
  uVar3 = 0;
  local_50 = 0;
  uVar5 = 0;
  sVar4 = 0;
  local_60 = 0;
  local_64 = 0;
  sVar8 = sVar4;
  if (*(int *)(param_5 + 0x38) == 1) {
    uVar3 = 0xc000007b;
    local_60 = uVar5;
    local_64 = 0;
    goto LAB_1800750c8;
  }
  uVar2 = FUN_180074c28(param_5);
  uVar1 = (uint)uVar2;
  if ((int)uVar1 < 0) {
    uVar7 = 0x78;
    uVar6 = 0x4e;
    uVar3 = uVar2 & 0xffffffff;
  }
  else {
    if (*(int *)(param_5 + 0x38) != 6) {
      uVar3 = 0xc000007b;
      goto LAB_1800750c8;
    }
    uVar1 = FUN_1800764e0(&local_50,param_5);
    if (-1 < (int)uVar1) {
      sVar4 = *(short *)(local_50 + 4);
      sVar8 = *(short *)(local_50 + 0x18);
      if ((*(int *)(param_5 + 0x48) == 0) &&
         ((param_3 != (uint *)0x0 || (param_4 != (undefined4 *)0x0)))) {
        if (sVar8 == 0x10b) {
          uVar5 = *(uint *)(local_50 + 0xe8);
        }
        else if (sVar8 == 0x20b) {
          uVar5 = *(uint *)(local_50 + 0xf8);
        }
        if (uVar5 != 0) {
          local_48 = FUN_180077f84(local_50,param_5 + 8,uVar5);
          bVar9 = local_48 != 0;
          if (bVar9) {
            local_64 = *(undefined4 *)(local_48 + 0x10);
          }
          else {
            FUN_18001188c(2,0xa0,0x98,0xe8,in_stack_ffffffffffffff88);
            local_64 = 0;
          }
          local_60 = (uint)bVar9;
          uVar3 = 0;
          goto LAB_1800750c8;
        }
      }
      local_64 = 0;
      local_60 = 0;
      goto LAB_1800750c8;
    }
    uVar7 = 0xc0;
    uVar6 = 0x62;
    uVar3 = (ulonglong)uVar1;
  }
  FUN_18001188c(1,0xa0,uVar6,uVar7,(char)uVar1);
LAB_1800750c8:
  if (param_1 != (short *)0x0) {
    *param_1 = sVar4;
  }
  if (param_2 != (short *)0x0) {
    *param_2 = sVar8;
  }
  if (param_3 != (uint *)0x0) {
    *param_3 = local_60;
  }
  if (param_4 != (undefined4 *)0x0) {
    *param_4 = local_64;
  }
  return uVar3;
}



undefined4 FUN_180075107(int **param_1,longlong param_2)

{
  *(int ***)(param_2 + 0x58) = param_1;
  *(uint *)(param_2 + 0x44) = (uint)(**param_1 != -0x3fffff03);
  return *(undefined4 *)(param_2 + 0x44);
}



ulonglong FUN_180075138(undefined4 *param_1,wchar_t **param_2,ulonglong param_3)

{
  int iVar1;
  wchar_t *pwVar2;
  undefined uVar3;
  uint uVar4;
  int iVar5;
  ulonglong uVar6;
  ulonglong uVar7;
  ulonglong uVar8;
  undefined8 uVar9;
  uint *puVar10;
  undefined uVar11;
  undefined uVar12;
  
  uVar8 = 0;
  if (param_3 == 0) {
    return 0;
  }
  if (*(int *)(param_2 + 7) == 1) {
    puVar10 = param_1 + 6;
    do {
      iVar5 = (int)uVar8;
      if ((iVar5 == 0) || (iVar5 == 0x11)) {
        *(undefined8 *)(puVar10 + -2) = 0;
LAB_18007519a:
        puVar10[-6] = 2;
        uVar4 = *puVar10 | 1;
        *(undefined8 *)(puVar10 + -4) = 4;
      }
      else {
        if (iVar5 == 0x1c) {
          *(undefined8 *)(puVar10 + -2) = 1;
          goto LAB_18007519a;
        }
        uVar4 = *puVar10 | 2;
      }
      *puVar10 = uVar4;
      uVar8 = (ulonglong)(iVar5 + 1U);
      puVar10 = puVar10 + 8;
      if (0x20 < (int)(iVar5 + 1U)) {
        return 0;
      }
    } while( true );
  }
  if (*(int *)(param_2 + 9) != 0) {
    puVar10 = param_1 + 6;
    uVar6 = uVar8;
    do {
      iVar5 = (int)uVar6;
      if ((iVar5 != 1) &&
         ((iVar5 < 0x11 ||
          (((0x13 < iVar5 && (iVar5 != 0x16)) && ((iVar5 < 0x1c || (0x1f < iVar5)))))))) {
        *puVar10 = *puVar10 | 2;
      }
      uVar6 = (ulonglong)(iVar5 + 1U);
      puVar10 = puVar10 + 8;
    } while ((int)(iVar5 + 1U) < 0x21);
  }
  uVar7 = FUN_180074c28((longlong)param_2);
  iVar5 = (int)uVar7;
  uVar6 = uVar8;
  if (iVar5 == -0x3fffffe9) {
    if (*(int *)(param_2 + 9) == 0) {
      uVar7 = FUN_180078074((longlong)param_1,(longlong)param_2);
      iVar5 = (int)uVar7;
      if (-1 < iVar5) goto LAB_18007525c;
      uVar12 = 0xd8;
      uVar11 = 0xeb;
      goto LAB_180075220;
    }
  }
  else if (-1 < iVar5) {
LAB_18007525c:
    do {
      iVar5 = (int)uVar8;
      if (((param_3 >> ((byte)uVar8 & 0x3f) & 1) != 0) &&
         ((*(byte *)((longlong)param_1 + uVar6 + 0x18) & 3) == 0)) {
        if (iVar5 < 0x18) {
          if (iVar5 == 0x17) {
LAB_1800754d3:
            uVar7 = FUN_180076754((longlong)param_1,(ulonglong)param_2);
            uVar4 = (uint)uVar7;
            uVar7 = uVar7 & 0xffffffff;
            if ((int)uVar4 < 0) {
              uVar12 = 0xb8;
              uVar11 = 99;
LAB_18007547e:
              uVar3 = (undefined)uVar4;
              goto LAB_180075229;
            }
          }
          else if (iVar5 < 0x12) {
            if (iVar5 == 0x11) {
              iVar1 = *(int *)(param_2 + 7);
              if (iVar1 == 4) {
                uVar9 = 1;
              }
              else if (iVar1 == 5) {
                uVar9 = 2;
              }
              else if (iVar1 == 6) {
                uVar9 = 3;
              }
              else {
                uVar9 = 0;
              }
              param_1[0x8e] = param_1[0x8e] | 1;
              param_1[0x88] = 2;
              *(undefined8 *)(param_1 + 0x8a) = 4;
              *(undefined8 *)(param_1 + 0x8c) = uVar9;
            }
            else {
              if (iVar5 != 0) {
                if (iVar5 != 1) {
                  if (iVar5 == 2) goto LAB_1800754af;
                  if (iVar5 < 3) {
                    return 0xc00000e5;
                  }
                  if (0x10 < iVar5) {
                    return 0xc00000e5;
                  }
                  goto LAB_1800752c1;
                }
                goto LAB_180075389;
              }
LAB_180075418:
              pwVar2 = param_2[3];
              param_1[0x106] = param_1[0x106] | 1;
              param_1[6] = param_1[6] | 1;
              *(ulonglong *)(param_1 + 4) = (ulonglong)pwVar2 & 0xffffffff;
              param_1[0x100] = 3;
              *(undefined8 *)(param_1 + 0x102) = 8;
              *(wchar_t **)(param_1 + 0x104) = pwVar2;
              *param_1 = 2;
              *(undefined8 *)(param_1 + 2) = 4;
            }
          }
          else {
            if (0x13 < iVar5) {
              if (iVar5 < 0x16) {
                uVar7 = FUN_180076138((longlong)param_1,(longlong)param_2);
                uVar4 = (uint)uVar7;
                uVar7 = uVar7 & 0xffffffff;
                if ((int)uVar4 < 0) {
                  uVar12 = 0x18;
                  uVar11 = 0x76;
                  goto LAB_18007547e;
                }
                goto LAB_1800752ff;
              }
              if (iVar5 != 0x16) {
                return 0xc00000e5;
              }
            }
LAB_180075389:
            uVar7 = FUN_1800762d4((longlong)param_1,(longlong)param_2);
            uVar4 = (uint)uVar7;
            uVar7 = uVar7 & 0xffffffff;
            if ((int)uVar4 < 0) {
              uVar12 = 0x88;
              uVar11 = 0x59;
              goto LAB_18007547e;
            }
          }
        }
        else if (iVar5 == 0x18) {
LAB_1800752c1:
          uVar8 = FUN_180076878((longlong)param_1,param_2);
          if (((int)uVar8 < -0x3fffff77) || ((int)uVar8 + 0x3fffff74U < 0x3fffff74)) {
            FUN_18001188c(1,8,0x2e,0x28,(char)uVar8);
          }
        }
        else {
          if (iVar5 == 0x19) goto LAB_1800754d3;
          if (iVar5 == 0x1a) {
LAB_1800754af:
            uVar7 = FUN_18007585c((longlong)param_1,(longlong)param_2);
            uVar4 = (uint)uVar7;
            uVar7 = uVar7 & 0xffffffff;
            if ((int)uVar4 < 0) {
              uVar12 = 0x48;
              uVar11 = 0x80;
              goto LAB_18007547e;
            }
          }
          else if (iVar5 == 0x1b) {
            uVar4 = FUN_180075bfc((longlong)param_1,(longlong)param_2);
            uVar7 = (ulonglong)uVar4;
            if ((int)uVar4 < 0) {
              uVar12 = 0xe8;
              uVar11 = 0x6c;
              goto LAB_18007547e;
            }
          }
          else {
            if (iVar5 != 0x1c) {
              if (iVar5 < 0x1d) {
                return 0xc00000e5;
              }
              if (0x1f < iVar5) {
                if (iVar5 != 0x20) {
                  return 0xc00000e5;
                }
                goto LAB_180075418;
              }
              goto LAB_180075389;
            }
            uVar7 = FUN_1800760b4((longlong)param_1,(longlong)param_2);
            uVar4 = (uint)uVar7;
            uVar7 = uVar7 & 0xffffffff;
            if ((int)uVar4 < 0) {
              uVar12 = 0x58;
              uVar11 = 0x4a;
              goto LAB_18007547e;
            }
          }
        }
      }
LAB_1800752ff:
      uVar8 = (ulonglong)(iVar5 + 1U);
      uVar6 = uVar6 + 0x20;
      if (0x20 < (int)(iVar5 + 1U)) {
        return 0;
      }
    } while( true );
  }
  uVar12 = 0x78;
  uVar11 = 0xef;
LAB_180075220:
  uVar3 = (undefined)iVar5;
  uVar7 = uVar7 & 0xffffffff;
LAB_180075229:
  FUN_18001188c(1,8,uVar11,uVar12,uVar3);
  return uVar7;
}



void FUN_180075508(void *param_1)

{
  longlong *plVar1;
  longlong lVar2;
  longlong in_GS_OFFSET;
  
  if (param_1 != (void *)0x0) {
    plVar1 = (longlong *)((longlong)param_1 + 0x10);
    lVar2 = 0x21;
    do {
      if (((((*(byte *)(plVar1 + 1) & 1) != 0) && (*(int *)(plVar1 + -2) == 4)) &&
          ((*(byte *)(plVar1 + 1) & 4) != 0)) && (*plVar1 != 0)) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
      }
      plVar1 = plVar1 + 4;
      lVar2 = lVar2 + -1;
    } while (lVar2 != 0);
    memset(param_1,0,0x420);
  }
  return;
}



void FUN_180075590(undefined8 *param_1,longlong param_2)

{
  int iVar1;
  undefined auStackY328 [32];
  undefined local_118 [256];
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStackY328;
  if (*(int *)(param_2 + 0x38) == 5) {
    memset(local_118,0,0x100);
    iVar1 = FUN_180077468(local_118,param_2);
    if (iVar1 < 0) {
      FUN_18001188c(1,0xb8,0x15,0x88,(char)iVar1);
    }
    else {
      iVar1 = FUN_180073c10(param_1);
      if (iVar1 < 0) {
        FUN_18001188c(1,0xb8,0x1b,0x40,(char)iVar1);
      }
    }
  }
  else {
    *param_1 = 0;
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStackY328);
  return;
}



void FUN_180075674(undefined8 *param_1,longlong param_2)

{
  int iVar1;
  undefined auStackY328 [32];
  undefined local_118 [256];
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStackY328;
  if (*(int *)(param_2 + 0x38) == 5) {
    memset(local_118,0,0x100);
    iVar1 = FUN_180077598(local_118,param_2);
    if (iVar1 < 0) {
      FUN_18001188c(1,8,0x43,0xd8,(char)iVar1);
    }
    else {
      iVar1 = FUN_180073c10(param_1);
      if (iVar1 < 0) {
        FUN_18001188c(1,8,0x49,0x40,(char)iVar1);
      }
    }
  }
  else {
    *param_1 = 0;
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStackY328);
  return;
}



undefined8 FUN_180075758(int *param_1,longlong param_2)

{
  int iVar1;
  int *piVar2;
  ulonglong uVar3;
  int iVar4;
  uint uVar5;
  ulonglong uVar7;
  ulonglong uVar6;
  
  uVar5 = 0x200;
  uVar3 = 0;
  uVar7 = 0x1000;
  iVar4 = 0;
  if (*(ulonglong *)(param_2 + 0x10) < 0x1000) {
    uVar5 = 0;
    uVar7 = (ulonglong)*(uint *)(param_2 + 0x10);
  }
  else if (*(ulonglong *)(param_2 + 0x10) < 0x1200) {
    uVar5 = *(int *)(param_2 + 0x10) - 0x1000;
  }
  if (3 < (uint)uVar7) {
    piVar2 = (int *)((ulonglong)uVar5 + *(longlong *)(param_2 + 0x18));
    uVar6 = uVar3;
    for (; iVar4 = (int)uVar6, uVar3 < uVar7 >> 2; uVar3 = uVar3 + 1) {
      iVar1 = *piVar2;
      piVar2 = piVar2 + 1;
      uVar5 = (uint)(iVar4 + iVar1) >> 1;
      if ((iVar4 + iVar1 & 1U) != 0) {
        uVar5 = uVar5 | 0x80000000;
      }
      uVar6 = (ulonglong)uVar5;
    }
  }
  *param_1 = iVar4;
  return 0;
}



undefined4 FUN_18007582d(int **param_1,longlong param_2)

{
  *(int ***)(param_2 + 0x48) = param_1;
  *(uint *)(param_2 + 0x34) = (uint)(**param_1 != -0x3fffff03);
  return *(undefined4 *)(param_2 + 0x34);
}



// WARNING: Could not reconcile some variable overlaps

ulonglong FUN_18007585c(longlong param_1,longlong param_2)

{
  uint uVar1;
  ulonglong uVar2;
  undefined8 *puVar3;
  undefined uVar4;
  undefined uVar5;
  uint local_res10 [2];
  undefined1 in_stack_ffffffffffffffb8;
  undefined local_38 [16];
  undefined local_28 [16];
  undefined local_18 [16];
  
  local_38 = ZEXT816(0);
  local_28 = ZEXT816(0);
  local_18 = ZEXT816(0);
  if (*(int *)(param_2 + 0x4c) != 0) {
    FUN_18001188c(1,0xd0,1,0x80,in_stack_ffffffffffffffb8);
    *(uint *)(param_1 + 0x58) = *(uint *)(param_1 + 0x58) | 2;
    uVar2 = 0xc0000001;
    *(uint *)(param_1 + 0x358) = *(uint *)(param_1 + 0x358) | 2;
    goto LAB_1800759d5;
  }
  uVar2 = FUN_180010004(param_2);
  uVar2 = uVar2 & 0xffffffff;
  uVar1 = (uint)uVar2;
  if (((uVar1 + 0x80000000 & 0x80000000) == 0) && (uVar1 != 0xc000010e)) {
    uVar5 = 0xf0;
    uVar4 = 0xf;
  }
  else {
    puVar3 = (undefined8 *)(param_2 + 8);
    if (uVar1 == 0xc000010e) {
      local_38 = CONCAT88(local_38._8_8_,*puVar3);
      uVar1 = FUN_180010174((longlong *)local_38,'\0');
      uVar2 = (ulonglong)uVar1;
      if ((int)uVar1 < 0) {
        uVar5 = 8;
        uVar4 = 0x21;
        goto LAB_1800758f1;
      }
      puVar3 = (undefined8 *)local_38;
    }
    local_res10[0] = 0;
    uVar2 = FUN_180075758((int *)local_res10,(longlong)puVar3);
    uVar1 = (uint)uVar2;
    uVar2 = uVar2 & 0xffffffff;
    if ((int)uVar1 < 0) {
      uVar5 = 0x20;
      uVar4 = 0x31;
    }
    else {
      uVar2 = (ulonglong)local_res10[0];
      *(uint *)(param_1 + 0x58) = *(uint *)(param_1 + 0x58) | 1;
      local_res10[0] = 0;
      *(ulonglong *)(param_1 + 0x50) = uVar2;
      *(undefined4 *)(param_1 + 0x40) = 2;
      *(undefined8 *)(param_1 + 0x48) = 4;
      uVar2 = FUN_180075d88(local_res10,(longlong)puVar3);
      uVar1 = (uint)uVar2;
      uVar2 = uVar2 & 0xffffffff;
      if (-1 < (int)uVar1) {
        *(uint *)(param_1 + 0x358) = *(uint *)(param_1 + 0x358) | 1;
        *(ulonglong *)(param_1 + 0x350) = (ulonglong)local_res10[0];
        uVar2 = 0;
        *(undefined4 *)(param_1 + 0x340) = 2;
        *(undefined8 *)(param_1 + 0x348) = 4;
        goto LAB_1800759d5;
      }
      uVar5 = 0x40;
      uVar4 = 0x42;
    }
  }
LAB_1800758f1:
  FUN_18001188c(1,0xd0,uVar4,uVar5,(char)uVar1);
LAB_1800759d5:
  FUN_1800117d4((undefined (*) [16])local_38);
  return uVar2;
}



int FUN_180075a00(undefined *param_1,longlong param_2)

{
  uint uVar1;
  longlong lVar2;
  int iVar3;
  longlong lVar4;
  int *piVar5;
  uint *puVar6;
  undefined uVar7;
  undefined uVar8;
  longlong local_res8;
  undefined in_stack_ffffffffffffffb8;
  
  local_res8 = 0;
  puVar6 = (uint *)0x0;
  *param_1 = 0;
  iVar3 = FUN_1800764e0(&local_res8,param_2);
  lVar2 = local_res8;
  if (iVar3 < 0) {
    FUN_18001188c(1,0xe0,0x33,0xc0,(char)iVar3);
    return iVar3;
  }
  if (*(short *)(local_res8 + 0x18) == 0x10b) {
    puVar6 = (uint *)(local_res8 + 0xe8);
  }
  else if (*(short *)(local_res8 + 0x18) == 0x20b) {
    puVar6 = (uint *)(local_res8 + 0xf8);
  }
  if (((puVar6 == (uint *)0x0) || (*puVar6 == 0)) || (puVar6[1] < 0x48)) {
    return -0x3fffff85;
  }
  lVar4 = FUN_180077f84(local_res8,param_2 + 8,*puVar6);
  if (lVar4 == 0) {
    uVar8 = 0xf8;
    uVar7 = 0x50;
  }
  else {
    if (*(short *)(lVar4 + 4) != 2) {
      return -0x3fffff45;
    }
    piVar5 = (int *)FUN_180077f84(lVar2,param_2 + 8,*(uint *)(lVar4 + 8));
    if (piVar5 == (int *)0x0) {
      uVar8 = 0x30;
      uVar7 = 100;
    }
    else {
      if (*piVar5 != 0x424a5342) {
        iVar3 = -0x3fffff45;
        uVar8 = 0x68;
        uVar7 = 0x6e;
        goto LAB_180075ad8;
      }
      uVar1 = piVar5[3];
      if ((ulonglong)uVar1 - 1 < 0xff) {
        memcpy(param_1,piVar5 + 4,(ulonglong)uVar1);
        param_1[uVar1] = 0;
        return 0;
      }
      uVar8 = 0x98;
      uVar7 = 0x7a;
    }
  }
  iVar3 = -0x3fffff85;
LAB_180075ad8:
  FUN_18001188c(1,0xe0,uVar7,uVar8,in_stack_ffffffffffffffb8);
  return iVar3;
}



undefined4 FUN_180075bcd(int **param_1,longlong param_2)

{
  *(int ***)(param_2 + 0x48) = param_1;
  *(uint *)(param_2 + 0x34) = (uint)(**param_1 != -0x3fffff03);
  return *(undefined4 *)(param_2 + 0x34);
}



void FUN_180075bfc(longlong param_1,longlong param_2)

{
  int iVar1;
  ulonglong uVar2;
  undefined8 uVar3;
  longlong lVar4;
  short *psVar5;
  undefined uVar6;
  undefined uVar7;
  undefined auStackY360 [32];
  short *local_138 [2];
  undefined local_128 [256];
  ulonglong local_28;
  
  local_28 = DAT_1800b2220 ^ (ulonglong)auStackY360;
  memset(local_128,0,0x100);
  local_138[0] = (short *)0x0;
  uVar2 = FUN_180074c28(param_2);
  iVar1 = (int)uVar2;
  if (iVar1 < 0) {
    uVar7 = 0x78;
    uVar6 = 0xd5;
LAB_180075c59:
    FUN_18001188c(1,0x98,uVar6,uVar7,(char)iVar1);
  }
  else {
    if (*(int *)(param_2 + 0x38) == 6) {
      if ((*(byte *)(param_1 + 0x398) & 1) == 0) {
        uVar2 = FUN_1800760b4(param_1,param_2);
        iVar1 = (int)uVar2;
        if (iVar1 < 0) {
          uVar7 = 0x58;
          uVar6 = 0xe6;
          goto LAB_180075c59;
        }
      }
      if (*(int *)(param_1 + 0x390) - 0xcU < 4) {
        iVar1 = FUN_180075a00(local_128,param_2);
        if (iVar1 < 0) {
          uVar7 = 0xb8;
          uVar6 = 0xf9;
        }
        else {
          iVar1 = FUN_180073c10(local_138);
          if (iVar1 < 0) {
            uVar7 = 0x40;
            uVar6 = 0xff;
          }
          else {
            psVar5 = local_138[0];
            uVar3 = FUN_180073f98(local_138[0]);
            iVar1 = (int)uVar3;
            if (-1 < iVar1) {
              *(undefined4 *)(param_1 + 0x360) = 4;
              lVar4 = -1;
              do {
                lVar4 = lVar4 + 1;
              } while (psVar5[lVar4] != 0);
              *(uint *)(param_1 + 0x378) = *(uint *)(param_1 + 0x378) | 5;
              *(longlong *)(param_1 + 0x368) = lVar4;
              *(short **)(param_1 + 0x370) = psVar5;
              goto LAB_180075d5a;
            }
            uVar7 = 0xf8;
            uVar6 = 5;
          }
        }
        goto LAB_180075c59;
      }
    }
    *(uint *)(param_1 + 0x378) = *(uint *)(param_1 + 0x378) | 2;
  }
LAB_180075d5a:
  __security_check_cookie(local_28 ^ (ulonglong)auStackY360);
  return;
}



undefined8 FUN_180075d88(uint *param_1,longlong param_2)

{
  ulonglong uVar1;
  uint uVar2;
  byte *pbVar3;
  uint uVar4;
  
  uVar1 = *(ulonglong *)(param_2 + 0x10);
  uVar2 = 0;
  if (uVar1 < 0x2000) {
    uVar4 = *(uint *)(param_2 + 0x20);
    pbVar3 = *(byte **)(param_2 + 0x18);
  }
  else {
    pbVar3 = *(byte **)(param_2 + 0x18);
    uVar4 = 0x1000;
    uVar2 = FUN_1800704a4(0,pbVar3,0x1000);
    pbVar3 = pbVar3 + (uVar1 - 0x1000);
  }
  uVar2 = FUN_1800704a4(uVar2,pbVar3,uVar4);
  *param_1 = uVar2;
  return 0;
}



undefined4 FUN_180075e13(int **param_1,longlong param_2)

{
  *(int ***)(param_2 + 0x38) = param_1;
  *(uint *)(param_2 + 0x34) = (uint)(**param_1 != -0x3fffff03);
  return *(undefined4 *)(param_2 + 0x34);
}



int FUN_180075e44(undefined4 *param_1,longlong param_2)

{
  int *piVar1;
  int iVar2;
  longlong lVar3;
  int local_res8 [2];
  int *local_res10;
  
  *param_1 = 0;
  local_res10 = (int *)0x0;
  if (*(ulonglong *)(param_2 + 0x18) < 0x100000000) {
    iVar2 = FUN_1800764e0((longlong *)&local_res10,param_2);
    piVar1 = local_res10;
    if (iVar2 < 0) {
      FUN_18001188c(1,0x40,0x4b,0xc0,(char)iVar2);
    }
    else {
      iVar2 = FUN_1800770b8((longlong)local_res10);
      if (iVar2 == 0) {
        lVar3 = FUN_180076f50(local_res8,(longlong)piVar1,param_2);
        iVar2 = (int)lVar3;
        if (iVar2 < 0) {
          if (iVar2 == -0x3ffffddb) {
            FUN_18001188c(2,0x40,100,0x58,(char)*(undefined8 *)(param_2 + 0x18));
            return -0x3ffffddb;
          }
          FUN_18001188c(1,0x40,0x66,0x98,(char)lVar3);
          return iVar2;
        }
        if (local_res8[0] == 0) {
          if (((*piVar1 == 0x4550) && (*(char *)((longlong)piVar1 + 0x1a) == 'S')) &&
             (*(char *)((longlong)piVar1 + 0x1b) == 'R')) {
            *param_1 = 3;
          }
          else {
            iVar2 = FUN_180077ef8((longlong)piVar1);
            if (iVar2 != 0) {
              *param_1 = 4;
            }
          }
        }
        else {
          *param_1 = 2;
        }
      }
      else {
        *param_1 = 1;
      }
      iVar2 = 0;
    }
  }
  else {
    iVar2 = 0;
  }
  return iVar2;
}



undefined4 FUN_180075fba(int **param_1,longlong param_2)

{
  *(int ***)(param_2 + 0x38) = param_1;
  *(uint *)(param_2 + 0x34) = (uint)(**param_1 != -0x3fffff03);
  return *(undefined4 *)(param_2 + 0x34);
}



void FUN_180075fe8(undefined8 *param_1,ulonglong param_2)

{
  uint uVar1;
  undefined uVar2;
  undefined uVar3;
  undefined auStackY328 [32];
  char local_118 [256];
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStackY328;
  memset(local_118,0,0x100);
  uVar1 = FUN_1800776c4(local_118,param_2);
  if ((int)uVar1 < 0) {
    if ((uVar1 == 0xc0000225) || (uVar1 == 0xc000007b)) goto LAB_180076088;
    uVar3 = 0;
    uVar2 = 0x81;
  }
  else {
    uVar1 = FUN_180073c10(param_1);
    if (-1 < (int)uVar1) goto LAB_180076088;
    uVar3 = 0x40;
    uVar2 = 0x88;
  }
  FUN_18001188c(1,0x28,uVar2,uVar3,(char)uVar1);
LAB_180076088:
  __security_check_cookie(local_18 ^ (ulonglong)auStackY328);
  return;
}



ulonglong FUN_1800760b4(longlong param_1,longlong param_2)

{
  ulonglong uVar1;
  ulonglong uVar2;
  int local_res18 [4];
  
  local_res18[0] = 0;
  uVar1 = FUN_180074cf8(local_res18,param_2);
  uVar2 = uVar1 & 0xffffffff;
  if ((int)uVar1 < 0) {
    FUN_18001188c(1,0xf0,0xb4,0xc0,(char)uVar1);
  }
  else {
    *(uint *)(param_1 + 0x398) = *(uint *)(param_1 + 0x398) | 1;
    *(longlong *)(param_1 + 0x390) = (longlong)local_res18[0];
    uVar2 = 0;
    *(undefined4 *)(param_1 + 0x380) = 2;
    *(undefined8 *)(param_1 + 0x388) = 4;
  }
  return uVar2;
}



ulonglong FUN_180076138(longlong param_1,longlong param_2)

{
  int iVar1;
  ulonglong uVar2;
  longlong lVar3;
  short *psVar4;
  longlong lVar5;
  ulonglong uVar6;
  undefined uVar7;
  undefined uVar8;
  short *local_res18;
  short *local_res20;
  
  uVar6 = 0;
  local_res18 = (short *)0x0;
  local_res20 = (short *)0x0;
  uVar2 = FUN_180074c28(param_2);
  iVar1 = (int)uVar2;
  uVar2 = uVar2 & 0xffffffff;
  if (iVar1 < 0) {
    uVar8 = 0x78;
    uVar7 = 0x22;
LAB_180076178:
    FUN_18001188c(1,0xc0,uVar7,uVar8,(char)iVar1);
    uVar6 = uVar2;
  }
  else {
    if (*(int *)(param_2 + 0x38) == 5) {
      *(uint *)(param_1 + 600) = *(uint *)(param_1 + 600) | 2;
      *(uint *)(param_1 + 0x278) = *(uint *)(param_1 + 0x278) | 2;
      *(uint *)(param_1 + 0x2d8) = *(uint *)(param_1 + 0x2d8) | 2;
      *(uint *)(param_1 + 0x38) = *(uint *)(param_1 + 0x38) | 2;
      *(uint *)(param_1 + 0x338) = *(uint *)(param_1 + 0x338) | 2;
      *(uint *)(param_1 + 0x2f8) = *(uint *)(param_1 + 0x2f8) | 2;
      *(uint *)(param_1 + 0x3b8) = *(uint *)(param_1 + 0x3b8) | 2;
      *(uint *)(param_1 + 0x3d8) = *(uint *)(param_1 + 0x3d8) | 2;
      *(uint *)(param_1 + 0x3f8) = *(uint *)(param_1 + 0x3f8) | 2;
      iVar1 = FUN_180075590(&local_res18,param_2);
      lVar5 = -1;
      if (iVar1 < 0) {
        *(uint *)(param_1 + 0x298) = *(uint *)(param_1 + 0x298) | 2;
      }
      else {
        psVar4 = local_res18;
        uVar2 = FUN_180073f98(local_res18);
        iVar1 = (int)uVar2;
        uVar2 = uVar2 & 0xffffffff;
        if (iVar1 < 0) {
          uVar8 = 0xf8;
          uVar7 = 0x45;
          goto LAB_180076178;
        }
        *(undefined4 *)(param_1 + 0x280) = 4;
        lVar3 = -1;
        do {
          lVar3 = lVar3 + 1;
        } while (psVar4[lVar3] != 0);
        *(uint *)(param_1 + 0x298) = *(uint *)(param_1 + 0x298) | 5;
        *(longlong *)(param_1 + 0x288) = lVar3;
        *(short **)(param_1 + 0x290) = psVar4;
      }
      iVar1 = FUN_180075674(&local_res20,param_2);
      if (-1 < iVar1) {
        psVar4 = local_res20;
        uVar2 = FUN_180073f98(local_res20);
        iVar1 = (int)uVar2;
        uVar2 = uVar2 & 0xffffffff;
        if (-1 < iVar1) {
          *(undefined4 *)(param_1 + 0x2a0) = 4;
          do {
            lVar5 = lVar5 + 1;
          } while (psVar4[lVar5] != 0);
          *(uint *)(param_1 + 0x2b8) = *(uint *)(param_1 + 0x2b8) | 5;
          *(longlong *)(param_1 + 0x2a8) = lVar5;
          *(short **)(param_1 + 0x2b0) = psVar4;
          return 0;
        }
        uVar8 = 0xf8;
        uVar7 = 0x5a;
        goto LAB_180076178;
      }
    }
    else {
      *(uint *)(param_1 + 0x298) = *(uint *)(param_1 + 0x298) | 2;
    }
    *(uint *)(param_1 + 0x2b8) = *(uint *)(param_1 + 0x2b8) | 2;
  }
  return uVar6;
}



ulonglong FUN_1800762d4(longlong param_1,longlong param_2)

{
  int iVar1;
  ulonglong uVar2;
  uint uVar3;
  uint uVar4;
  ulonglong uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  ushort local_res18 [4];
  ushort local_res20 [4];
  ushort local_48 [2];
  uint local_44;
  uint local_40;
  uint local_3c;
  uint local_38 [4];
  
  local_44 = 0;
  local_40 = 0;
  local_3c = 0;
  local_38[0] = 0;
  uVar2 = FUN_180074c28(param_2);
  uVar5 = uVar2 & 0xffffffff;
  if ((int)uVar2 < 0) {
    FUN_18001188c(1,0xa0,0xaa,0x78,(char)uVar2);
  }
  else {
    if (*(int *)(param_2 + 0x38) == 6) {
      *(uint *)(param_1 + 0x298) = *(uint *)(param_1 + 0x298) | 2;
      *(uint *)(param_1 + 0x2b8) = *(uint *)(param_1 + 0x2b8) | 2;
      iVar1 = FUN_1800765dc(&local_44,(int *)&local_40,&local_3c,local_38,local_res18,local_res20,
                            (short *)local_48,param_2);
      if (iVar1 < 0) {
        uVar6 = *(uint *)(param_1 + 600) | 2;
        uVar7 = *(uint *)(param_1 + 0x278) | 2;
        uVar8 = *(uint *)(param_1 + 0x2d8) | 2;
        uVar4 = *(uint *)(param_1 + 0x38) | 2;
        uVar9 = *(uint *)(param_1 + 0x3b8) | 2;
        uVar3 = 2;
      }
      else {
        *(ulonglong *)(param_1 + 0x250) = (ulonglong)local_44;
        *(ulonglong *)(param_1 + 0x270) = (ulonglong)local_40;
        uVar3 = 1;
        *(ulonglong *)(param_1 + 0x2d0) = (ulonglong)local_3c;
        uVar6 = *(uint *)(param_1 + 600) | 1;
        uVar7 = *(uint *)(param_1 + 0x278) | 1;
        *(ulonglong *)(param_1 + 0x30) = (ulonglong)local_38[0];
        uVar8 = *(uint *)(param_1 + 0x2d8) | 1;
        uVar4 = *(uint *)(param_1 + 0x38) | 1;
        *(ulonglong *)(param_1 + 0x3b0) = (ulonglong)local_res18[0];
        uVar9 = *(uint *)(param_1 + 0x3b8) | 1;
        *(ulonglong *)(param_1 + 0x3d0) = (ulonglong)local_res20[0];
        *(ulonglong *)(param_1 + 0x3f0) = (ulonglong)local_48[0];
        *(undefined4 *)(param_1 + 0x240) = 2;
        *(undefined8 *)(param_1 + 0x248) = 4;
        *(undefined4 *)(param_1 + 0x260) = 2;
        *(undefined8 *)(param_1 + 0x268) = 4;
        *(undefined4 *)(param_1 + 0x2c0) = 2;
        *(undefined8 *)(param_1 + 0x2c8) = 4;
        *(undefined4 *)(param_1 + 0x20) = 2;
        *(undefined8 *)(param_1 + 0x28) = 4;
        *(undefined4 *)(param_1 + 0x3a0) = 1;
        *(undefined8 *)(param_1 + 0x3a8) = 2;
        *(undefined4 *)(param_1 + 0x3c0) = 1;
        *(undefined8 *)(param_1 + 0x3c8) = 2;
        *(undefined4 *)(param_1 + 0x3e0) = 1;
        *(undefined8 *)(param_1 + 1000) = 2;
      }
      *(uint *)(param_1 + 0x3d8) = *(uint *)(param_1 + 0x3d8) | uVar3;
      *(uint *)(param_1 + 0x3f8) = *(uint *)(param_1 + 0x3f8) | uVar3;
      *(uint *)(param_1 + 600) = uVar6;
      *(uint *)(param_1 + 0x3b8) = uVar9;
      *(uint *)(param_1 + 0x38) = uVar4;
      *(uint *)(param_1 + 0x2d8) = uVar8;
      *(uint *)(param_1 + 0x278) = uVar7;
    }
    else {
      *(uint *)(param_1 + 600) = *(uint *)(param_1 + 600) | 2;
      *(uint *)(param_1 + 0x278) = *(uint *)(param_1 + 0x278) | 2;
      *(uint *)(param_1 + 0x2d8) = *(uint *)(param_1 + 0x2d8) | 2;
      *(uint *)(param_1 + 0x38) = *(uint *)(param_1 + 0x38) | 2;
      *(uint *)(param_1 + 0x3f8) = *(uint *)(param_1 + 0x3f8) | 2;
      *(uint *)(param_1 + 0x3b8) = *(uint *)(param_1 + 0x3b8) | 2;
      *(uint *)(param_1 + 0x3d8) = *(uint *)(param_1 + 0x3d8) | 2;
    }
    uVar5 = 0;
  }
  return uVar5;
}



undefined4 FUN_1800764e0(longlong *param_1,longlong param_2)

{
  longlong lVar1;
  ulonglong uVar2;
  undefined4 uVar3;
  
  if (*(int *)(param_2 + 0x38) == 6) {
    lVar1 = (longlong)*(int *)(*(longlong *)(param_2 + 0x20) + 0x3c);
    uVar2 = lVar1 + 0x108;
    if ((*(ulonglong *)(param_2 + 0x18) < uVar2) || (*(ulonglong *)(param_2 + 0x28) < uVar2)) {
      uVar3 = 0xc000007b;
      FUN_18001188c(1,0x20,0x17,0x28,0x7b);
    }
    else {
      *param_1 = lVar1 + *(longlong *)(param_2 + 0x20);
      uVar3 = 0;
    }
  }
  else {
    uVar3 = 0xc00000bb;
    FUN_18001188c(1,0x20,0xb,0,0xbb);
  }
  return uVar3;
}



undefined4 FUN_1800765ad(int **param_1,longlong param_2)

{
  *(int ***)(param_2 + 0x38) = param_1;
  *(uint *)(param_2 + 0x34) = (uint)(**param_1 != -0x3fffff03);
  return *(undefined4 *)(param_2 + 0x34);
}



int FUN_1800765dc(undefined4 *param_1,int *param_2,undefined4 *param_3,undefined4 *param_4,
                 undefined2 *param_5,undefined2 *param_6,short *param_7,longlong param_8)

{
  short sVar1;
  int iVar2;
  int iVar3;
  longlong local_20 [3];
  
  iVar2 = FUN_1800764e0(local_20,param_8);
  iVar3 = 0;
  if (iVar2 < 0) {
    FUN_18001188c(1,0xe0,0xa5,0xc0,(char)iVar2);
    iVar3 = iVar2;
  }
  else {
    *param_2 = (uint)(byte)*(undefined2 *)(local_20[0] + 0x44) * 0x10000 +
               (uint)(byte)*(undefined2 *)(local_20[0] + 0x46);
    *param_3 = *(undefined4 *)(local_20[0] + 8);
    sVar1 = *(short *)(local_20[0] + 0x18);
    *param_7 = sVar1;
    *param_5 = *(undefined2 *)(local_20[0] + 4);
    if ((sVar1 == 0x10b) || (sVar1 == 0x20b)) {
      *param_1 = *(undefined4 *)(local_20[0] + 0x58);
      *param_4 = *(undefined4 *)(local_20[0] + 0x50);
      *param_6 = *(undefined2 *)(local_20[0] + 0x5c);
    }
    else {
      *param_1 = 0;
      *param_4 = 0;
      *param_6 = 0;
      iVar3 = -0x3fffff45;
    }
  }
  return iVar3;
}



undefined4 FUN_180076723(int **param_1,longlong param_2)

{
  *(int ***)(param_2 + 0x40) = param_1;
  *(uint *)(param_2 + 0x34) = (uint)(**param_1 != -0x3fffff03);
  return *(undefined4 *)(param_2 + 0x34);
}



ulonglong FUN_180076754(longlong param_1,ulonglong param_2)

{
  int iVar1;
  uint uVar2;
  ulonglong uVar3;
  longlong lVar4;
  short *psVar5;
  ulonglong uVar6;
  undefined uVar7;
  undefined uVar8;
  uint local_res18 [2];
  short *local_res20;
  
  uVar6 = 0;
  local_res18[0] = 0;
  local_res20 = (short *)0x0;
  uVar3 = FUN_180074c28(param_2);
  if ((int)uVar3 < 0) {
    uVar8 = 0x78;
    uVar7 = 0x4e;
LAB_18007678c:
    uVar6 = uVar3 & 0xffffffff;
    FUN_18001188c(1,0x78,uVar7,uVar8,(char)uVar3);
  }
  else {
    if (*(int *)(param_2 + 0x38) == 6) {
      iVar1 = FUN_180075e44(local_res18,param_2);
      if (iVar1 < 0) {
        uVar2 = 2;
      }
      else {
        *(ulonglong *)(param_1 + 0x330) = (ulonglong)local_res18[0];
        uVar2 = 1;
        *(undefined4 *)(param_1 + 800) = 2;
        *(undefined8 *)(param_1 + 0x328) = 4;
      }
      *(uint *)(param_1 + 0x338) = *(uint *)(param_1 + 0x338) | uVar2;
      iVar1 = FUN_180075fe8(&local_res20,param_2);
      if (-1 < iVar1) {
        psVar5 = local_res20;
        uVar3 = FUN_180073f98(local_res20);
        if (-1 < (int)uVar3) {
          *(undefined4 *)(param_1 + 0x2e0) = 4;
          lVar4 = -1;
          do {
            lVar4 = lVar4 + 1;
          } while (psVar5[lVar4] != 0);
          *(uint *)(param_1 + 0x2f8) = *(uint *)(param_1 + 0x2f8) | 5;
          *(longlong *)(param_1 + 0x2e8) = lVar4;
          *(short **)(param_1 + 0x2f0) = psVar5;
          return 0;
        }
        uVar8 = 0xf8;
        uVar7 = 0x71;
        goto LAB_18007678c;
      }
    }
    else {
      *(uint *)(param_1 + 0x338) = *(uint *)(param_1 + 0x338) | 2;
    }
    *(uint *)(param_1 + 0x2f8) = *(uint *)(param_1 + 0x2f8) | 2;
  }
  return uVar6;
}



ulonglong FUN_180076878(longlong param_1,wchar_t **param_2)

{
  int iVar1;
  ulonglong uVar2;
  wchar_t *pwVar3;
  ulonglong uVar4;
  wchar_t *pwVar5;
  wchar_t *local_res18;
  wchar_t *local_res20;
  
  local_res18 = (wchar_t *)0x0;
  local_res20 = (wchar_t *)0x0;
  iVar1 = FUN_18007692c(&local_res18,&local_res20,param_2);
  pwVar3 = local_res20;
  pwVar5 = local_res18;
  if (iVar1 < 0) {
    if (2 < iVar1 + 0x3fffff77U) {
      FUN_18001188c(3,0xa0,0xcb,0x78,(char)iVar1);
    }
    pwVar3 = (wchar_t *)0x0;
    pwVar5 = (wchar_t *)0x0;
  }
  FUN_180077144(param_1,(longlong)pwVar3);
  uVar2 = FUN_180077258(param_1,(ushort *)pwVar5);
  uVar4 = uVar2 & 0xffffffff;
  if ((int)uVar2 < 0) {
    FUN_18001188c(1,0xa0,0xe2,0xc0,(char)uVar2);
  }
  else {
    uVar4 = 0;
  }
  return uVar4;
}



// WARNING: Removing unreachable block (ram,0x000180076d0d)
// WARNING: Removing unreachable block (ram,0x000180076d7c)
// WARNING: Removing unreachable block (ram,0x000180076d94)
// WARNING: Removing unreachable block (ram,0x000180076de6)
// WARNING: Removing unreachable block (ram,0x000180076e05)
// WARNING: Removing unreachable block (ram,0x000180076e08)
// WARNING: Removing unreachable block (ram,0x000180076e25)
// WARNING: Removing unreachable block (ram,0x000180076e20)
// WARNING: Removing unreachable block (ram,0x000180076e2c)
// WARNING: Removing unreachable block (ram,0x000180076dcf)
// WARNING: Removing unreachable block (ram,0x000180076d23)
// WARNING: Removing unreachable block (ram,0x000180076ebf)
// WARNING: Could not reconcile some variable overlaps

void FUN_18007692c(wchar_t **param_1,wchar_t **param_2,wchar_t **param_3)

{
  wchar_t *pwVar1;
  int iVar2;
  ulonglong uVar3;
  undefined8 uVar4;
  wchar_t *pwVar5;
  undefined uVar6;
  undefined uVar7;
  undefined uVar8;
  undefined auStackY584 [32];
  wchar_t *local_1f8;
  undefined8 local_1f0;
  wchar_t *local_1e0;
  wchar_t **local_1d8;
  wchar_t *local_1d0;
  wchar_t *local_1c8;
  wchar_t **local_1c0;
  wchar_t **local_1b8;
  undefined local_1b0 [16];
  undefined local_1a0 [16];
  undefined local_190 [40];
  undefined4 local_168;
  undefined4 local_164;
  undefined4 local_160;
  undefined8 local_48;
  undefined8 local_40;
  undefined8 local_38;
  ulonglong local_30;
  
  local_30 = DAT_1800b2220 ^ (ulonglong)auStackY584;
  local_1f8 = (wchar_t *)0x0;
  local_1f0 = 0;
  local_1b0 = ZEXT816(0);
  local_1a0 = ZEXT816(0);
  local_190._0_16_ = ZEXT816(0);
  pwVar1 = param_3[8];
  local_1d8 = param_2;
  local_1c0 = param_1;
  local_1b8 = param_3;
  if (pwVar1 != (wchar_t *)0x0) {
    pwVar5 = (wchar_t *)0x0;
    if (0x33 < (ushort)pwVar1[1]) {
      pwVar5 = pwVar1 + 0x14;
    }
    *param_2 = pwVar5;
    *param_1 = param_3[8];
    goto LAB_180076eba;
  }
  uVar3 = FUN_180074c28((longlong)param_3);
  if ((int)uVar3 < 0) {
    FUN_18001188c(1,0xf0,0x30,0x78,(char)uVar3);
    goto LAB_180076eba;
  }
  if (*(int *)(param_3 + 7) != 6) goto LAB_180076eba;
  local_48 = 0x10;
  local_40 = 1;
  local_38 = 0;
  local_1a0._8_8_ = param_3[4];
  local_1e0 = param_3[5];
  uVar6 = SUB81(&local_1f8,0);
  local_1d0 = local_1a0._8_8_;
  local_1c8 = local_1e0;
  iVar2 = LdrResSearchResource();
  local_190._0_8_ = local_1e0;
  if (iVar2 < 0) {
    if (iVar2 + 0x3fffff77U < 3) goto LAB_180076eba;
    if (((iVar2 != -0x3fffff85) || (*(char *)((longlong)param_3 + 0x33) != '\0')) ||
       (*(int *)((longlong)param_3 + 0x4c) != 0)) {
      FUN_18001188c(1,0xf0,0xad,0xe8,(char)*param_3);
      goto LAB_180076eba;
    }
    uVar3 = 0x11c;
    memset(&local_168,0,0x11c);
    local_168 = 0x11c;
    local_164 = 6;
    local_160 = 2;
    uVar3 = uVar3 & 0xffffffffffffff00 | 3;
    uVar4 = VerSetConditionMask(0,2,uVar3);
    uVar4 = VerSetConditionMask(uVar4,1,uVar3 & 0xffffffffffffff00 | 3);
    iVar2 = RtlVerifyVersionInfo(&local_168,3,uVar4);
    if (iVar2 < 0) goto LAB_180076eba;
    local_1b0 = CONCAT88(local_1b0._8_8_,param_3[1]);
    iVar2 = FUN_180010174((longlong *)local_1b0,'\x01');
    if (iVar2 < 0) {
      uVar7 = 8;
      uVar6 = 0x8c;
    }
    else {
      FUN_18001188c(3,0xf0,0x95,0x28,(char)*param_3);
      iVar2 = LdrResSearchResource(local_1a0._8_8_,&local_48,3,0);
      uVar6 = 0x60;
      if (iVar2 < 0) {
        uVar6 = 0x70;
      }
      FUN_18001188c(2,0xf0,0xa2,0x90,uVar6);
      if (-1 < iVar2) {
        local_1d0 = local_1a0._8_8_;
        local_1c8 = local_190._0_8_;
        goto LAB_180076ccc;
      }
      uVar7 = 200;
      uVar6 = 0xa5;
    }
    FUN_18001188c(1,0xf0,uVar6,uVar7,(char)iVar2);
    goto LAB_180076eba;
  }
LAB_180076ccc:
  if (local_1f8 == (wchar_t *)0x0) {
    FUN_18001188c(1,0xf0,0xb4,0x10,(char)iVar2);
    goto LAB_180076eba;
  }
  if ((local_1f8 < local_1a0._8_8_) ||
     ((wchar_t *)((longlong)local_190._0_8_ + (longlong)local_1a0._8_8_) < local_1f8)) {
    uVar7 = 0xce;
LAB_180076e5c:
    uVar8 = 0x78;
  }
  else {
    if (((*(char *)((longlong)param_3 + 0x33) == '\0') && (local_1b0._8_8_ == 0)) &&
       ((wchar_t *)((longlong)param_3[3] + (longlong)local_1a0._8_8_) < local_1f8)) {
      uVar7 = 0xe0;
      goto LAB_180076e5c;
    }
    uVar8 = 0x98;
    uVar7 = 0xeb;
  }
  local_1e0 = local_1f8;
  FUN_18001188c(1,0xf0,uVar7,uVar8,uVar6);
LAB_180076eba:
  FUN_1800117d4((undefined (*) [16])local_1b0);
  __security_check_cookie(local_30 ^ (ulonglong)auStackY584);
  return;
}



undefined4 FUN_180076f1c(int **param_1,longlong param_2)

{
  *(int ***)(param_2 + 0xd0) = param_1;
  *(uint *)(param_2 + 0x60) = (uint)(**param_1 != -0x3fffff03);
  return *(undefined4 *)(param_2 + 0x60);
}



longlong FUN_180076f50(undefined4 *param_1,longlong param_2,longlong param_3)

{
  ulonglong uVar1;
  longlong *plVar2;
  longlong lVar3;
  longlong *plVar4;
  longlong lVar5;
  ulonglong uVar6;
  
  lVar3 = 0;
  *param_1 = 0;
  uVar6 = *(ulonglong *)(param_3 + 0x18);
  if (*(ulonglong *)(param_3 + 0x28) <= uVar6) {
    uVar6 = *(ulonglong *)(param_3 + 0x28);
  }
  if (((uVar6 - 0x401 < 0xfffffbff) && (*(int *)(param_3 + 0x4c) == 0)) &&
     (*(int *)(param_3 + 0x48) == 0)) {
    if (*(short *)(param_2 + 0x18) == 0x10b) {
      lVar5 = param_2 + 0x98;
    }
    else {
      lVar5 = lVar3;
      if (*(short *)(param_2 + 0x18) == 0x20b) {
        lVar5 = param_2 + 0xa8;
      }
    }
    if ((lVar5 == 0) || (uVar1 = (ulonglong)(*(int *)(lVar5 + 4) + 0x400), uVar6 <= uVar1)) {
      lVar3 = 0xc0000225;
    }
    else {
      plVar4 = (longlong *)(*(longlong *)(param_3 + 0x20) + (uVar6 - uVar1));
      for (plVar2 = (longlong *)((longlong)plVar4 + 0x3e6); plVar4 <= plVar2;
          plVar2 = (longlong *)((longlong)plVar2 + -1)) {
        if (((*plVar2 == 0x464f564d41534d54) && (*(short *)(plVar2 + 1) == 1)) &&
           ((ulonglong)*(uint *)((longlong)plVar2 + 0x12) +
            (ulonglong)*(uint *)((longlong)plVar2 + 0xe) +
            (ulonglong)*(uint *)((longlong)plVar2 + 10) + 0x26e ==
            (ulonglong)*(uint *)((longlong)plVar2 + 0x16))) {
          *param_1 = 1;
          return 0;
        }
      }
    }
  }
  else {
    lVar3 = 0xc0000225;
  }
  return lVar3;
}



undefined4 FUN_180077087(int **param_1,longlong param_2)

{
  *(int ***)(param_2 + 0x48) = param_1;
  *(uint *)(param_2 + 0x34) = (uint)(**param_1 != -0x3fffff03);
  return *(undefined4 *)(param_2 + 0x34);
}



undefined4 FUN_1800770b8(longlong param_1)

{
  int iVar1;
  uint uVar2;
  char *_Str1;
  
  _Str1 = (char *)(param_1 + 0x18 + (ulonglong)*(ushort *)(param_1 + 0x14));
  uVar2 = 0;
  if (*(short *)(param_1 + 6) != 0) {
    do {
      if (((*(int *)(_Str1 + 0xc) != 0) && (*(int *)(_Str1 + 8) != 0)) &&
         (iVar1 = strncmp(_Str1,".securom",8), iVar1 == 0)) {
        return 1;
      }
      uVar2 = uVar2 + 1;
      _Str1 = _Str1 + 0x28;
    } while (uVar2 < *(ushort *)(param_1 + 6));
  }
  return 0;
}



void FUN_180077144(longlong param_1,longlong param_2)

{
  uint uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  uint *puVar4;
  longlong lVar5;
  
  lVar5 = 4;
  puVar4 = (uint *)(param_1 + 0x1b8);
  if (param_2 == 0) {
    do {
      *puVar4 = *puVar4 | 2;
      puVar4 = puVar4 + 8;
      lVar5 = lVar5 + -1;
    } while (lVar5 != 0);
    *(uint *)(param_1 + 0x98) = *(uint *)(param_1 + 0x98) | 2;
    *(uint *)(param_1 + 0x78) = *(uint *)(param_1 + 0x78) | 2;
    return;
  }
  *(undefined4 *)(param_1 + 0x1a0) = 2;
  *(undefined8 *)(param_1 + 0x1a8) = 4;
  uVar1 = *(uint *)(param_2 + 0x2c);
  *puVar4 = *puVar4 | 1;
  *(ulonglong *)(param_1 + 0x1b0) = (ulonglong)uVar1;
  *(undefined4 *)(param_1 + 0x1c0) = 2;
  *(undefined8 *)(param_1 + 0x1c8) = 4;
  uVar1 = *(uint *)(param_2 + 0x30);
  *(uint *)(param_1 + 0x1d8) = *(uint *)(param_1 + 0x1d8) | 1;
  *(ulonglong *)(param_1 + 0x1d0) = (ulonglong)uVar1;
  *(undefined4 *)(param_1 + 0x1e0) = 2;
  *(undefined8 *)(param_1 + 0x1e8) = 4;
  uVar1 = *(uint *)(param_2 + 0x20);
  *(uint *)(param_1 + 0x1f8) = *(uint *)(param_1 + 0x1f8) | 1;
  *(ulonglong *)(param_1 + 0x1f0) = (ulonglong)uVar1;
  *(undefined4 *)(param_1 + 0x200) = 2;
  *(undefined8 *)(param_1 + 0x208) = 4;
  uVar1 = *(uint *)(param_2 + 0x24);
  *(uint *)(param_1 + 0x218) = *(uint *)(param_1 + 0x218) | 1;
  *(ulonglong *)(param_1 + 0x210) = (ulonglong)uVar1;
  uVar2 = *(undefined4 *)(param_2 + 0x14);
  uVar3 = *(undefined4 *)(param_2 + 0x10);
  *(uint *)(param_1 + 0x98) = *(uint *)(param_1 + 0x98) | 1;
  *(ulonglong *)(param_1 + 0x90) = CONCAT44(uVar3,uVar2);
  *(undefined4 *)(param_1 + 0x80) = 3;
  *(undefined8 *)(param_1 + 0x88) = 8;
  uVar2 = *(undefined4 *)(param_2 + 0xc);
  uVar3 = *(undefined4 *)(param_2 + 8);
  *(uint *)(param_1 + 0x78) = *(uint *)(param_1 + 0x78) | 1;
  *(ulonglong *)(param_1 + 0x70) = CONCAT44(uVar3,uVar2);
  *(undefined4 *)(param_1 + 0x60) = 3;
  *(undefined8 *)(param_1 + 0x68) = 8;
  return;
}



// WARNING: Could not reconcile some variable overlaps

ulonglong FUN_180077258(longlong param_1,ushort *param_2)

{
  ushort uVar1;
  uint uVar2;
  ulonglong uVar3;
  ushort *puVar4;
  short *psVar5;
  uint uVar6;
  uint *puVar7;
  ulonglong uVar8;
  longlong lVar9;
  longlong lVar10;
  ushort *puVar11;
  uint uVar12;
  undefined uVar13;
  undefined uVar14;
  ushort *puVar15;
  ulonglong local_res10;
  ushort *local_res18;
  ulonglong local_res20;
  short *local_48;
  ulonglong local_40;
  
  puVar15 = (ushort *)0x0;
  local_48 = (short *)0x0;
  local_40 = 0;
  local_res18 = (ushort *)0x0;
  local_res10 = 0;
  local_res20 = 0;
  if (param_2 == (ushort *)0x0) {
    puVar7 = (uint *)(param_1 + 0xb8);
    lVar9 = 8;
    do {
      *puVar7 = *puVar7 | 2;
      puVar7 = puVar7 + 8;
      lVar9 = lVar9 + -1;
    } while (lVar9 != 0);
    *(uint *)(param_1 + 0x318) = *(uint *)(param_1 + 0x318) | 2;
  }
  else {
    uVar6 = FUN_180077c34(param_2,L"\\VarFileInfo\\Translation",&local_res18,
                          (longlong *)&local_res10);
    puVar4 = local_res18;
    uVar3 = local_res10;
    uVar8 = (ulonglong)uVar6;
    uVar12 = 0;
    puVar11 = puVar15;
    if (uVar6 != 0xc0000225) {
      if ((int)uVar6 < 0) {
        uVar14 = 0xa8;
        uVar13 = 0xb9;
LAB_180077430:
        FUN_18001188c(1,0xd0,uVar13,uVar14,(char)uVar6);
        return uVar8;
      }
      uVar6 = FUN_180077bcc(&local_res20,(longlong)local_res18,local_res10);
      if ((-1 < (int)uVar6) && (puVar11 = (ushort *)0x0, local_res20 < uVar3)) {
        uVar12 = (int)uVar3 - (int)local_res20;
        puVar11 = (ushort *)(local_res20 + (longlong)puVar4);
      }
    }
    uVar12 = uVar12 >> 2;
    do {
      uVar2 = *(uint *)(puVar15 + 0xc00401b8);
      local_res10 = local_res10 & 0xffffffff00000000 | (ulonglong)uVar2;
      uVar6 = FUN_1800778b4(&local_48,&local_40,param_2,puVar11,(ulonglong)uVar12,
                            *(longlong *)(puVar15 + 0xc00401bc));
      psVar5 = local_48;
      uVar8 = (ulonglong)uVar6;
      if ((int)uVar6 < 0) {
        if (uVar6 != 0xc0000225) {
          uVar14 = 0x20;
          uVar13 = 0xf0;
          goto LAB_180077430;
        }
        puVar7 = (uint *)((longlong)(int)uVar2 * 0x20 + 0x18 + param_1);
        *puVar7 = *puVar7 | 2;
      }
      else {
        uVar8 = FUN_180073f98(local_48);
        uVar6 = (uint)uVar8;
        uVar8 = uVar8 & 0xffffffff;
        if ((int)uVar6 < 0) {
          uVar14 = 0xf8;
          uVar13 = 0xe3;
          goto LAB_180077430;
        }
        lVar9 = (longlong)(int)local_res10 * 0x20;
        lVar10 = -1;
        *(undefined4 *)(lVar9 + param_1) = 4;
        do {
          lVar10 = lVar10 + 1;
        } while (psVar5[lVar10] != 0);
        puVar7 = (uint *)(lVar9 + 0x18 + param_1);
        *puVar7 = *puVar7 | 1;
        *(longlong *)(lVar9 + 8 + param_1) = lVar10;
        *(short **)(lVar9 + 0x10 + param_1) = psVar5;
      }
      puVar15 = puVar15 + 8;
    } while (puVar15 < (ushort *)0x80);
    if ((puVar11 == (ushort *)0x0) || ((ulonglong)uVar12 != 1)) {
      *(uint *)(param_1 + 0x318) = *(uint *)(param_1 + 0x318) | 2;
    }
    else {
      *(undefined4 *)(param_1 + 0x300) = 2;
      *(undefined8 *)(param_1 + 0x308) = 4;
      uVar1 = *puVar11;
      *(uint *)(param_1 + 0x318) = *(uint *)(param_1 + 0x318) | uVar12;
      *(ulonglong *)(param_1 + 0x310) = (ulonglong)uVar1;
    }
  }
  return 0;
}



undefined4 FUN_180077468(undefined *param_1,longlong param_2)

{
  byte bVar1;
  longlong lVar2;
  ulonglong uVar3;
  longlong lVar4;
  undefined4 uVar5;
  undefined uVar6;
  undefined1 in_stack_ffffffffffffffc8;
  
  *param_1 = 0;
  if (*(int *)(param_2 + 0x38) == 5) {
    lVar2 = *(longlong *)(param_2 + 0x20);
    uVar3 = *(ulonglong *)(param_2 + 0x18);
    if ((uVar3 < (longlong)*(int *)(lVar2 + 0x3c) + 0x40U) ||
       (lVar4 = (longlong)*(int *)(*(int *)(lVar2 + 0x3c) + lVar2 + 0x2c), uVar3 < lVar4 + 1U)) {
      uVar6 = 0x79;
    }
    else {
      bVar1 = *(byte *)(lVar4 + lVar2);
      if ((bVar1 == 0) || (0x100 < bVar1 + 1)) {
        uVar6 = 0x82;
      }
      else {
        if (lVar4 + 1 + (ulonglong)bVar1 <= uVar3) {
          memcpy(param_1,(byte *)(lVar4 + lVar2) + 1,(ulonglong)bVar1);
          param_1[bVar1] = 0;
          return 0;
        }
        uVar6 = 0x88;
      }
    }
    uVar5 = 0xc000007b;
    FUN_18001188c(1,0x40,uVar6,0x28,in_stack_ffffffffffffffc8);
  }
  else {
    uVar5 = 0xc00000bb;
  }
  return uVar5;
}



undefined4 FUN_180077569(int **param_1,longlong param_2)

{
  *(int ***)(param_2 + 0x38) = param_1;
  *(uint *)(param_2 + 0x34) = (uint)(**param_1 != -0x3fffff03);
  return *(undefined4 *)(param_2 + 0x34);
}



undefined4 FUN_180077598(undefined *param_1,longlong param_2)

{
  ushort uVar1;
  longlong lVar2;
  ulonglong uVar3;
  byte *pbVar4;
  ulonglong _Size;
  undefined uVar5;
  longlong lVar6;
  undefined1 in_stack_ffffffffffffffc8;
  
  *param_1 = 0;
  if (*(int *)(param_2 + 0x38) != 5) {
    return 0xc00000bb;
  }
  lVar2 = *(longlong *)(param_2 + 0x20);
  lVar6 = (longlong)*(int *)(lVar2 + 0x3c);
  uVar3 = *(ulonglong *)(param_2 + 0x18);
  if (lVar6 + 0x40U <= uVar3) {
    uVar1 = *(ushort *)(lVar6 + lVar2 + 0x26);
    if ((ulonglong)uVar1 + 1 <= uVar3) {
      pbVar4 = (byte *)((ulonglong)uVar1 + lVar6 + lVar2);
      if (*pbVar4 == 0) {
        uVar5 = 0xcf;
      }
      else {
        _Size = (ulonglong)*pbVar4;
        if (_Size + 1 + (longlong)(int)((uint)uVar1 + *(int *)(lVar2 + 0x3c)) <= uVar3) {
          memcpy(param_1,pbVar4 + 1,_Size);
          param_1[_Size] = 0;
          return 0;
        }
        uVar5 = 0xd6;
      }
      goto LAB_18007763c;
    }
  }
  uVar5 = 0xc6;
LAB_18007763c:
  FUN_18001188c(1,0x60,uVar5,0x28,in_stack_ffffffffffffffc8);
  return 0xc000007b;
}



undefined4 FUN_180077693(int **param_1,longlong param_2)

{
  *(int ***)(param_2 + 0x38) = param_1;
  *(uint *)(param_2 + 0x34) = (uint)(**param_1 != -0x3fffff03);
  return *(undefined4 *)(param_2 + 0x34);
}



uint FUN_1800776c4(char *param_1,ulonglong param_2)

{
  uint uVar1;
  ulonglong uVar2;
  char *pcVar3;
  undefined uVar4;
  undefined uVar5;
  uint local_res8 [4];
  uint local_res18;
  longlong local_res20;
  undefined in_stack_ffffffffffffffb8;
  
  local_res8[0] = 0;
  local_res20 = 0;
  *param_1 = '\0';
  uVar2 = param_2;
  uVar1 = FUN_1800764e0(&local_res20,param_2);
  if ((int)uVar1 < 0) {
    uVar5 = 0xc0;
    uVar4 = 0xb6;
LAB_180077705:
    FUN_18001188c(1,0x68,uVar4,uVar5,(char)uVar1);
  }
  else {
    uVar2 = RtlImageDirectoryEntryToData
                      (*(undefined8 *)(param_2 + 0x20),
                       uVar2 & 0xffffffffffffff00 | (ulonglong)*(byte *)(param_2 + 0x33),0,
                       local_res8);
    if ((uVar2 == 0) || (local_res8[0] < 0x28)) {
      uVar1 = 0xc0000225;
      if (uVar2 == 0) {
        return 0xc0000225;
      }
      uVar5 = 0x80;
      uVar4 = 199;
    }
    else if ((uVar2 < *(ulonglong *)(param_2 + 0x20)) ||
            (*(longlong *)(param_2 + 0x18) + *(ulonglong *)(param_2 + 0x20) < uVar2 + 0x28)) {
      uVar1 = 0xc000007b;
      uVar5 = 0xd0;
      uVar4 = 0xd5;
    }
    else {
      pcVar3 = (char *)FUN_180077f84(local_res20,param_2 + 8,*(uint *)(uVar2 + 0xc));
      if (((pcVar3 != (char *)0x0) &&
          (pcVar3 < (char *)(*(longlong *)(param_2 + 0x18) + *(longlong *)(param_2 + 0x20)))) &&
         (*pcVar3 != '\0')) {
        local_res18 = (*(int *)(param_2 + 0x18) - (int)pcVar3) + *(int *)(param_2 + 0x20);
        if (0x100 < local_res18) {
          local_res18 = 0x100;
        }
        uVar1 = FID_conflict_RtlStringCchCopyA(param_1,(ulonglong)local_res18,(longlong)pcVar3);
        if (-1 < (int)uVar1) {
          return 0;
        }
        uVar5 = 0x68;
        uVar4 = 0xea;
        goto LAB_180077705;
      }
      uVar1 = 0xc000007b;
      uVar5 = 0x30;
      uVar4 = 0xde;
    }
    FUN_18001188c(2,0x68,uVar4,uVar5,in_stack_ffffffffffffffb8);
  }
  return uVar1;
}



undefined4 FUN_180077884(int **param_1,longlong param_2)

{
  *(int ***)(param_2 + 0x48) = param_1;
  *(uint *)(param_2 + 0x34) = (uint)(**param_1 != -0x3fffff03);
  return *(undefined4 *)(param_2 + 0x34);
}



void FUN_1800778b4(short **param_1,ulonglong *param_2,ushort *param_3,ushort *param_4,
                  ulonglong param_5,longlong param_6)

{
  uint uVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  undefined uVar4;
  undefined uVar5;
  undefined auStackY440 [32];
  ulonglong local_188;
  ushort *local_180;
  ulonglong local_178;
  short *local_170;
  longlong local_168;
  wchar_t local_158 [128];
  ulonglong local_58;
  
  local_58 = DAT_1800b2220 ^ (ulonglong)auStackY440;
  uVar3 = 0;
  *param_1 = (short *)0x0;
  *param_2 = 0;
  local_168 = param_6;
  local_158[0] = L'\0';
  local_170 = (short *)0x0;
  local_178 = 0;
  local_180 = (ushort *)0x0;
  local_188 = 0;
  do {
    uVar1 = FUN_18000ecd4(local_158,0x80,
                          *(longlong *)
                           ((longlong)&PTR_u__StringFileInfo_000004B0__180080760 + uVar3));
    if ((int)uVar1 < 0) {
      uVar5 = 0x50;
      uVar4 = 0xd8;
      goto LAB_180077aa4;
    }
    uVar2 = FUN_18000bab4(local_158,0x80,param_6);
    uVar1 = (uint)uVar2;
    if ((int)uVar1 < 0) {
      uVar5 = 0x18;
      uVar4 = 0xde;
      goto LAB_180077aa4;
    }
    uVar1 = FUN_180077c34(param_3,local_158,&local_180,(longlong *)&local_188);
    if (-1 < (int)uVar1) {
      uVar3 = FUN_180077e44(&local_170,&local_178,(longlong)local_180,local_188);
      if (-1 < (int)uVar3) goto LAB_180077a64;
      break;
    }
    if (uVar1 != 0xc0000225) {
      uVar5 = 0xa8;
      uVar4 = 0xfc;
      goto LAB_180077aa4;
    }
    uVar3 = uVar3 + 8;
  } while (uVar3 < 0x20);
  if ((param_4 != (ushort *)0x0) && (uVar3 = 0, param_5 != 0)) {
LAB_1800779cc:
    uVar1 = FUN_180039540(local_158,0x80,L"\\StringFileInfo\\%04X%04X\\%s",(ulonglong)*param_4);
    if ((int)uVar1 < 0) {
      uVar5 = 0x98;
      uVar4 = 0xe;
      goto LAB_180077aa4;
    }
    uVar1 = FUN_180077c34(param_3,local_158,&local_180,(longlong *)&local_188);
    if (-1 < (int)uVar1) {
      uVar3 = FUN_180077e44(&local_170,&local_178,(longlong)local_180,local_188);
      if (-1 < (int)uVar3) {
LAB_180077a64:
        *param_2 = local_178;
        *param_1 = local_170;
      }
      goto LAB_180077abb;
    }
    if (uVar1 == 0xc0000225) {
      uVar3 = uVar3 + 1;
      param_4 = param_4 + 2;
      if (param_5 <= uVar3) goto LAB_180077abb;
      goto LAB_1800779cc;
    }
    uVar5 = 0xa8;
    uVar4 = 0x2c;
LAB_180077aa4:
    FUN_18001188c(1,0x20,uVar4,uVar5,(char)uVar1);
  }
LAB_180077abb:
  __security_check_cookie(local_58 ^ (ulonglong)auStackY440);
  return;
}



short * FUN_180077ae4(short *param_1,undefined8 param_2,short **param_3)

{
  short *psVar1;
  short *psVar2;
  short sVar3;
  undefined4 *puVar4;
  
  if ((param_3 == (short **)0x0) ||
     ((param_1 == (short *)0x0 && (param_1 = *param_3, param_1 == (short *)0x0)))) {
    param_1 = (short *)0x0;
  }
  else {
    for (; *param_1 != 0; param_1 = param_1 + 1) {
      puVar4 = &DAT_180085358;
      sVar3 = 0x5c;
      do {
        if (sVar3 == *param_1) break;
        puVar4 = (undefined4 *)((longlong)puVar4 + 2);
        sVar3 = *(short *)puVar4;
      } while (sVar3 != 0);
      if (sVar3 == 0) break;
    }
    sVar3 = *param_1;
    psVar1 = param_1;
    while (psVar2 = psVar1, sVar3 != 0) {
      puVar4 = &DAT_180085358;
      sVar3 = 0x5c;
      do {
        if (sVar3 == *psVar1) break;
        puVar4 = (undefined4 *)((longlong)puVar4 + 2);
        sVar3 = *(short *)puVar4;
      } while (sVar3 != 0);
      psVar2 = psVar1 + 1;
      if (sVar3 != 0) {
        *psVar1 = 0;
        break;
      }
      psVar1 = psVar2;
      sVar3 = *psVar2;
    }
    *param_3 = psVar2;
    if (psVar2 == param_1) {
      param_1 = (short *)0x0;
    }
  }
  return param_1;
}



uint FUN_180077bcc(ulonglong *param_1,longlong param_2,longlong param_3)

{
  uint uVar1;
  ulonglong local_res8 [4];
  
  *param_1 = 0;
  if (param_3 - 8U < 0x7ff8) {
    uVar1 = FID_conflict_StringCbLengthW
                      ((short *)(param_2 + 6),(ulonglong)(&DAT_fffffffffffffffa + param_3),
                       (longlong *)local_res8);
    if (-1 < (int)uVar1) {
      if (local_res8[0] + 8 < local_res8[0]) {
        uVar1 = 0xc0000095;
      }
      else {
        *param_1 = local_res8[0] + 0xb & 0xfffffffffffffffc;
        uVar1 = 0;
      }
    }
  }
  else {
    uVar1 = 0xc000000d;
  }
  return uVar1;
}



uint FUN_180077c34(ushort *param_1,wchar_t *param_2,ushort **param_3,longlong *param_4)

{
  ushort uVar1;
  uint uVar2;
  int iVar3;
  wchar_t *_Str1;
  short *psVar4;
  ushort *puVar5;
  ushort *puVar6;
  undefined uVar7;
  undefined uVar8;
  longlong in_GS_OFFSET;
  short *local_res8;
  ulonglong local_res20;
  undefined in_stack_ffffffffffffffb8;
  short *local_38 [2];
  
  local_res8 = (short *)0x0;
  local_38[0] = (short *)0x0;
  local_res20 = 0;
  *param_4 = 0;
  if (param_1[2] != 0) {
    FUN_18001188c(1,0xe8,0x9b,0x98,in_stack_ffffffffffffffb8);
    return 0xc000000d;
  }
  uVar2 = FUN_18000eaac(&local_res8,param_2);
  if ((int)uVar2 < 0) {
    FUN_18001188c(1,0xe8,0xa1,0xc0,(char)uVar2);
  }
  else {
    if (*param_1 < 0x8000) {
      if (7 < *param_1) {
        puVar6 = (ushort *)((ulonglong)*param_1 + (longlong)param_1);
        uVar1 = puVar6[-1];
        puVar6[-1] = 0;
        psVar4 = local_res8;
        puVar5 = puVar6;
        while (_Str1 = FUN_180077ae4(psVar4,param_2,local_38), _Str1 != (wchar_t *)0x0) {
          uVar2 = (int)puVar6 - (int)param_1;
          if (((uVar2 < 8) || (uVar2 < *param_1)) ||
             (uVar2 = FUN_180077bcc(&local_res20,(longlong)param_1,(ulonglong)uVar2), (int)uVar2 < 0
             )) {
LAB_180077dc5:
            uVar2 = 0xc0000225;
            goto LAB_180077df7;
          }
          local_res20 = ((ulonglong)param_1[1] + 3 & 0xfffffffffffffffc) + local_res20;
          if (*param_1 < local_res20) goto LAB_180077dc5;
          puVar5 = (ushort *)((ulonglong)*param_1 + (longlong)param_1);
          param_1 = (ushort *)((longlong)param_1 + local_res20);
          while( true ) {
            if (((puVar5 <= param_1) || (*param_1 < 9)) ||
               ((ulonglong)((longlong)puVar5 - (longlong)param_1) < (ulonglong)*param_1))
            goto LAB_180077dc5;
            param_2 = (wchar_t *)(param_1 + 3);
            iVar3 = _wcsicmp(_Str1,param_2);
            if (iVar3 == 0) break;
            param_1 = (ushort *)((longlong)param_1 + ((ulonglong)*param_1 + 3 & 0xfffffffffffffffc))
            ;
          }
          psVar4 = (short *)0x0;
        }
        *param_3 = param_1;
        *param_4 = (longlong)puVar5 - (longlong)param_1;
        uVar2 = 0;
LAB_180077df7:
        puVar6[-1] = uVar1;
        goto LAB_180077dfb;
      }
      uVar8 = 0x20;
      uVar7 = 0xb2;
    }
    else {
      uVar8 = 0;
      uVar7 = 0xad;
    }
    uVar2 = 0xc000000d;
    FUN_18001188c(1,0xe8,uVar7,uVar8,in_stack_ffffffffffffffb8);
  }
LAB_180077dfb:
  if (local_res8 != (short *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_res8);
  }
  return uVar2;
}



ulonglong FUN_180077e44(short **param_1,ulonglong *param_2,longlong param_3,ulonglong param_4)

{
  uint uVar1;
  undefined4 extraout_var;
  ulonglong uVar2;
  short *psVar3;
  ulonglong local_res8;
  ulonglong local_res10;
  
  *param_1 = (short *)0x0;
  *param_2 = 0;
  local_res8 = 0;
  local_res10 = 0;
  uVar1 = FUN_180077bcc(&local_res8,param_3,param_4);
  uVar2 = CONCAT44(extraout_var,uVar1);
  if (-1 < (int)uVar1) {
    if (param_4 < local_res8) {
      uVar2 = 0xc000000d;
    }
    else {
      if (local_res8 == param_4) {
        psVar3 = (short *)((local_res8 - 2) + param_3);
        local_res10 = 0;
      }
      else {
        psVar3 = (short *)(local_res8 + param_3);
        uVar2 = param_4 - local_res8;
        uVar1 = FID_conflict_StringCbLengthW(psVar3,uVar2,(longlong *)&local_res10);
        if ((int)uVar1 < 0) {
          local_res10 = uVar2 - 2;
          *(undefined2 *)((longlong)psVar3 + (local_res10 & 0xfffffffffffffffe)) = 0;
        }
      }
      *param_2 = local_res10 >> 1;
      *param_1 = psVar3;
      uVar2 = 0;
    }
  }
  return uVar2;
}



undefined4 FUN_180077ef8(longlong param_1)

{
  int iVar1;
  uint uVar2;
  char *_Str1;
  
  _Str1 = (char *)(param_1 + 0x18 + (ulonglong)*(ushort *)(param_1 + 0x14));
  uVar2 = 0;
  if (*(short *)(param_1 + 6) != 0) {
    do {
      if (((*(int *)(_Str1 + 0xc) != 0) && (*(int *)(_Str1 + 8) != 0)) &&
         (iVar1 = strncmp(_Str1,".ps4",8), iVar1 == 0)) {
        return 1;
      }
      uVar2 = uVar2 + 1;
      _Str1 = _Str1 + 0x28;
    } while (uVar2 < *(ushort *)(param_1 + 6));
  }
  return 0;
}



longlong FUN_180077f84(longlong param_1,longlong param_2,uint param_3)

{
  ulonglong uVar1;
  longlong lVar2;
  uint uVar3;
  
  if (*(char *)(param_2 + 0x2b) == '\0') {
    lVar2 = param_1 + 0x18 + (ulonglong)*(ushort *)(param_1 + 0x14);
    uVar3 = 0;
    if (*(ushort *)(param_1 + 6) != 0) {
      do {
        if ((*(uint *)(lVar2 + 0xc) <= param_3) &&
           (param_3 < *(uint *)(lVar2 + 0xc) + *(int *)(lVar2 + 0x10))) goto LAB_180077fd5;
        lVar2 = lVar2 + 0x28;
        uVar3 = uVar3 + 1;
      } while (uVar3 < *(ushort *)(param_1 + 6));
    }
    lVar2 = 0;
LAB_180077fd5:
    if (lVar2 == 0) {
      return 0;
    }
    uVar1 = (ulonglong)((*(int *)(lVar2 + 0x14) - *(int *)(lVar2 + 0xc)) + param_3);
    if (*(ulonglong *)(param_2 + 0x10) <= uVar1) {
      return 0;
    }
    lVar2 = *(longlong *)(param_2 + 0x18);
  }
  else {
    uVar1 = (ulonglong)param_3;
    if (*(ulonglong *)(param_2 + 0x20) <= uVar1) {
      return 0;
    }
    lVar2 = *(longlong *)(param_2 + 0x18);
  }
  return lVar2 + uVar1;
}



// Library Function - Multiple Matches With Different Base Names
//  long __cdecl StringCbLengthW(unsigned short const * __ptr64,unsigned __int64,unsigned __int64 *
// __ptr64)
//  StringCbLengthW
// 
// Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release

uint FID_conflict_StringCbLengthW(short *param_1,ulonglong param_2,longlong *param_3)

{
  ulonglong uVar1;
  longlong lVar2;
  uint uVar3;
  ulonglong uVar4;
  
  lVar2 = 0;
  uVar4 = param_2 >> 1;
  if ((param_1 == (short *)0x0) || (uVar1 = uVar4, 0x7fffffff < uVar4)) {
    uVar3 = 0xc000000d;
  }
  else {
    for (; (uVar1 != 0 && (*param_1 != 0)); param_1 = param_1 + 1) {
      uVar1 = uVar1 - 1;
    }
    uVar3 = ~-(uint)(uVar1 != 0) & 0xc000000d;
    if (uVar1 != 0) {
      lVar2 = uVar4 - uVar1;
    }
  }
  if (param_3 != (longlong *)0x0) {
    if ((int)uVar3 < 0) {
      *param_3 = 0;
    }
    else {
      *param_3 = lVar2 * 2;
    }
  }
  return uVar3;
}



ulonglong FUN_180078074(longlong param_1,longlong param_2)

{
  longlong *plVar1;
  ulonglong uVar2;
  undefined8 *puVar3;
  int iVar4;
  uint *puVar5;
  longlong *local_res10;
  
  if (*(ulonglong *)(param_2 + 0x18) < 0x100000) {
    uVar2 = 0xc00000f0;
  }
  else {
    local_res10 = (longlong *)0x0;
    puVar5 = (uint *)(param_1 + 0x18);
    iVar4 = 0;
    do {
      if ((iVar4 < 0) ||
         ((((0x13 < iVar4 && (iVar4 != 0x16)) && (iVar4 != 0x18)) && (5 < iVar4 - 0x1aU)))) {
        *puVar5 = *puVar5 | 2;
      }
      iVar4 = iVar4 + 1;
      puVar5 = puVar5 + 8;
    } while (iVar4 < 0x21);
    puVar3 = FUN_1800785a0(&local_res10,(undefined8 *)(param_2 + 8));
    plVar1 = local_res10;
    uVar2 = (ulonglong)puVar3 & 0xffffffff;
    if (-1 < (int)puVar3) {
      uVar2 = FUN_1800782c0(param_1,local_res10);
      if ((int)uVar2 < 0) {
        FUN_18001188c(1,0x80,0xf8,0x30,(char)uVar2);
      }
      if (plVar1 == (longlong *)0x0) {
        uVar2 = 0xc00000f0;
      }
      else {
        *(longlong *)(param_2 + 0x10) = plVar1[1];
        *(undefined *)(param_2 + 0x31) = 1;
        plVar1[1] = 0;
        *(longlong *)(param_2 + 0x20) = plVar1[2];
        *(longlong *)(param_2 + 0x28) = plVar1[3];
        *(undefined2 *)(param_2 + 0x32) = 1;
        *(undefined4 *)(param_2 + 0x4c) = 1;
        plVar1[2] = 0;
        plVar1[3] = 0;
        FUN_1800787d0((longlong *)&local_res10);
        uVar2 = FUN_180010090(param_2 + 8,(undefined4 *)(param_2 + 0x38));
        uVar2 = uVar2 & 0xffffffff;
      }
    }
    FUN_1800787d0((longlong *)&local_res10);
  }
  return uVar2;
}



ulonglong FUN_1800781ac(int *param_1,longlong *param_2)

{
  ulonglong uVar1;
  int *piVar2;
  ulonglong uVar3;
  uint uVar4;
  uint uVar5;
  ulonglong uVar6;
  
  uVar1 = 0;
  if ((((*(ulonglong *)(*param_2 + 0x10) < 0x100000) || (param_2[2] == 0)) ||
      ((ulonglong)param_2[3] < 0x1200)) || (param_2[4] != 0)) {
    uVar1 = 0xc000000d;
  }
  else {
    piVar2 = (int *)(param_2[2] + 0x200);
    uVar6 = uVar1;
    for (uVar3 = uVar1; uVar3 < 0x400; uVar3 = uVar3 + 1) {
      uVar4 = (int)uVar6 + *piVar2;
      piVar2 = piVar2 + 1;
      uVar5 = uVar4 >> 1;
      if ((uVar4 & 1) != 0) {
        uVar5 = uVar5 | 0x80000000;
      }
      uVar6 = (ulonglong)uVar5;
    }
    *param_1 = (int)uVar6;
  }
  return uVar1;
}



undefined4 FUN_180078292(int **param_1,longlong param_2)

{
  *(int ***)(param_2 + 0x48) = param_1;
  *(uint *)(param_2 + 0x34) = (uint)(**param_1 != -0x3fffff03);
  return *(undefined4 *)(param_2 + 0x34);
}



ulonglong FUN_1800782c0(longlong param_1,longlong *param_2)

{
  ulonglong uVar1;
  uint local_res18 [4];
  
  local_res18[0] = 0;
  uVar1 = FUN_1800781ac((int *)local_res18,param_2);
  if ((int)uVar1 < 0) {
    FUN_18001188c(1,0x68,0xa1,0x40,(char)uVar1);
    *(uint *)(param_1 + 0x58) = *(uint *)(param_1 + 0x58) | 2;
  }
  else {
    uVar1 = (ulonglong)local_res18[0];
    *(uint *)(param_1 + 0x58) = *(uint *)(param_1 + 0x58) | 1;
    local_res18[0] = 0;
    *(ulonglong *)(param_1 + 0x50) = uVar1;
    *(undefined4 *)(param_1 + 0x40) = 2;
    *(undefined8 *)(param_1 + 0x48) = 4;
    uVar1 = FUN_1800783b4(local_res18,param_2);
    if (-1 < (int)uVar1) {
      *(uint *)(param_1 + 0x358) = *(uint *)(param_1 + 0x358) | 1;
      *(ulonglong *)(param_1 + 0x350) = (ulonglong)local_res18[0];
      *(undefined4 *)(param_1 + 0x340) = 2;
      *(undefined8 *)(param_1 + 0x348) = 4;
      return 0;
    }
    FUN_18001188c(1,0x68,0xb6,0x40,(char)uVar1);
  }
  *(uint *)(param_1 + 0x358) = *(uint *)(param_1 + 0x358) | 2;
  return uVar1 & 0xffffffff;
}



undefined8 FUN_1800783b4(uint *param_1,longlong *param_2)

{
  ulonglong uVar1;
  longlong lVar2;
  uint uVar3;
  undefined8 uVar4;
  ulonglong uVar5;
  uint uVar6;
  undefined uVar7;
  
  uVar4 = 0;
  *param_1 = 0;
  uVar1 = *(ulonglong *)(*param_2 + 0x10);
  if ((((uVar1 < 0x100000) || (lVar2 = param_2[5], lVar2 == 0)) || ((ulonglong)param_2[6] < 0x1000))
     || ((((byte *)param_2[2] == (byte *)0x0 || ((ulonglong)param_2[3] < 0x1000)) ||
         (param_2[4] != 0)))) {
    uVar4 = 0xc000000d;
  }
  else {
    uVar5 = uVar1 - param_2[7];
    if (uVar5 < (ulonglong)param_2[6] || uVar5 == param_2[6]) {
      uVar6 = 0x1000;
      uVar3 = FUN_1800704a4(0,(byte *)param_2[2],0x1000);
      uVar3 = FUN_1800704a4(uVar3,(byte *)(lVar2 + (uVar5 - 0x1000)),uVar6);
      *param_1 = uVar3;
    }
    else {
      FUN_18001188c(0,200,0x76,0xb0,(char)uVar1);
      FUN_18001188c(0,200,0x77,0xe8,(char)*(undefined8 *)(*param_2 + 0x10));
      FUN_18001188c(0,200,0x78,0,(char)param_2[7]);
      FUN_18001188c(0,200,0x79,0x18,(char)*(undefined4 *)(param_2 + 6));
      uVar7 = (undefined)(uVar5 - 0x1000);
      FUN_18001188c(0,200,0x7a,0x30,uVar7);
      FUN_18001188c(1,200,0x7e,0x48,uVar7);
      uVar4 = 0xc0000220;
    }
  }
  return uVar4;
}



undefined4 FUN_180078571(int **param_1,longlong param_2)

{
  *(int ***)(param_2 + 0x38) = param_1;
  *(uint *)(param_2 + 0x30) = (uint)(**param_1 != -0x3fffff03);
  return *(undefined4 *)(param_2 + 0x30);
}



undefined8 * FUN_1800785a0(undefined8 *param_1,undefined8 *param_2)

{
  undefined8 *puVar1;
  uint uVar2;
  undefined8 *puVar3;
  ulonglong uVar4;
  undefined8 *puVar5;
  undefined uVar6;
  undefined uVar7;
  longlong in_GS_OFFSET;
  undefined8 *local_res18 [2];
  undefined8 in_stack_ffffffffffffff68;
  undefined4 uVar8;
  undefined8 in_stack_ffffffffffffff70;
  undefined4 uVar9;
  undefined4 local_68;
  undefined4 local_64;
  undefined8 local_60;
  undefined8 local_58;
  undefined4 local_50;
  undefined4 local_4c;
  undefined local_48 [16];
  
  uVar8 = (undefined4)((ulonglong)in_stack_ffffffffffffff68 >> 0x20);
  uVar9 = (undefined4)((ulonglong)in_stack_ffffffffffffff70 >> 0x20);
  local_64 = 0;
  local_4c = 0;
  puVar3 = (undefined8 *)
           RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,0x40);
  if (puVar3 == (undefined8 *)0x0) {
    return (undefined8 *)0xc0000017;
  }
  puVar1 = puVar3 + 1;
  local_68 = 0x30;
  local_60 = 0;
  local_50 = 0;
  local_58 = 0;
  local_48 = ZEXT816(0);
  local_res18[0] = puVar3;
  uVar2 = ZwCreateSection(puVar1,0xf0005,&local_68,0,CONCAT44(uVar8,2),CONCAT44(uVar9,0x8000000),
                          *param_2);
  puVar5 = (undefined8 *)(ulonglong)uVar2;
  if ((int)uVar2 < 0) {
    uVar7 = 0x60;
    uVar6 = 0x59;
  }
  else {
    puVar3[7] = param_2[2] - 0x1000 & 0xffffffffffff0000;
    uVar2 = ZwMapViewOfSection(*puVar1,0xffffffffffffffff,puVar3 + 5,0,0,puVar3 + 7,puVar3 + 6,2,
                               0x500000,2);
    puVar5 = (undefined8 *)(ulonglong)uVar2;
    if ((int)uVar2 < 0) {
      uVar7 = 0xc0;
      uVar6 = 0x75;
    }
    else {
      uVar4 = 0x20000000;
      do {
        puVar3[3] = uVar4;
        puVar3[4] = 0;
        uVar2 = ZwMapViewOfSection(*puVar1,0xffffffffffffffff,puVar3 + 2,0,0,puVar3 + 4,puVar3 + 3,2
                                   ,0x500000,2);
        uVar4 = uVar4 >> 1;
        puVar5 = (undefined8 *)(ulonglong)uVar2;
        if (uVar2 != 0xc0000017) break;
      } while (0xfffff < uVar4);
      puVar3 = (undefined8 *)0x0;
      if (-1 < (int)uVar2) {
        *local_res18[0] = param_2;
        *param_1 = local_res18[0];
        local_res18[0] = (undefined8 *)0x0;
        puVar5 = puVar3;
        goto LAB_180078799;
      }
      uVar7 = 0;
      uVar6 = 0x9f;
      puVar3 = local_res18[0];
    }
  }
  FUN_18001188c(1,0xa8,uVar6,uVar7,(char)uVar2);
LAB_180078799:
  if (puVar3 != (undefined8 *)0x0) {
    FUN_1800787d0((longlong *)local_res18);
  }
  return puVar5;
}



void FUN_1800787d0(longlong *param_1)

{
  longlong lVar1;
  longlong in_GS_OFFSET;
  
  if ((param_1 != (longlong *)0x0) && (lVar1 = *param_1, lVar1 != 0)) {
    FUN_180078848((longlong *)(lVar1 + 0x28));
    FUN_180078848((longlong *)(lVar1 + 0x10));
    if (*(longlong *)(lVar1 + 8) != 0) {
      ZwClose();
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lVar1);
    *param_1 = 0;
  }
  return;
}



void FUN_180078848(longlong *param_1)

{
  if ((param_1 != (longlong *)0x0) && (*param_1 != 0)) {
    ZwUnmapViewOfSection(0xffffffffffffffff);
    *param_1 = 0;
    param_1[1] = 0;
    param_1[2] = 0;
  }
  return;
}



// WARNING: Could not reconcile some variable overlaps

uint FUN_180078888(undefined4 param_1)

{
  int iVar1;
  uint uVar2;
  ulonglong uVar3;
  ulonglong uVar4;
  uint uVar5;
  undefined4 local_res8 [2];
  
  uVar5 = 0;
  local_res8[0] = param_1;
  iVar1 = FUN_180011b58((undefined2 *)local_res8,(undefined2 *)0x0);
  if (iVar1 < 0) {
    FUN_18001188c(1,0x18,0x46,0x90,(char)iVar1);
  }
  else {
    uVar4 = 0;
    do {
      if (((&DAT_18008fca0)[uVar4] & 0x1f) != 0) {
        uVar3 = 0;
        do {
          if ((*(short *)((longlong)&DAT_1800b2100 + uVar3) == (short)local_res8[0]) &&
             (*(short *)((longlong)&DAT_1800b2102 + uVar3) ==
              *(short *)((longlong)&DAT_18008fc9c + uVar4))) {
            uVar2 = FUN_180011ad4(*(short *)((longlong)&DAT_18008fc9c + uVar4),(short *)local_res8);
            uVar5 = uVar5 | uVar2;
            break;
          }
          uVar3 = uVar3 + 0x10;
        } while (uVar3 < 0x70);
      }
      uVar4 = uVar4 + 0xc;
    } while (uVar4 < 0x3c);
  }
  return uVar5;
}



undefined8 FUN_180078948(longlong param_1,undefined8 param_2,uint param_3)

{
  undefined8 uVar1;
  undefined (*pauVar2) [16];
  uint uVar3;
  
  if ((param_3 < 0x10) &&
     (uVar3 = 1 << ((byte)param_3 & 0x1f), (*(uint *)(param_1 + 0x1c) & uVar3) != 0)) {
    pauVar2 = (undefined (*) [16])(((ulonglong)param_3 + 1) * 0x20 + param_1);
    if (((pauVar2[1][8] & 2) != 0) && (*(longlong ***)pauVar2[1] != (longlong **)0x0)) {
      FUN_180011708(*(longlong ***)pauVar2[1]);
    }
    *pauVar2 = ZEXT816(0);
    pauVar2[1] = ZEXT816(0);
    *(uint *)(param_1 + 0x1c) = *(uint *)(param_1 + 0x1c) & ~uVar3;
    if (param_3 == 1) {
      *(undefined8 *)(param_1 + 0x10) = 0;
    }
    uVar1 = 1;
  }
  else {
    uVar1 = 0;
  }
  return uVar1;
}



void FUN_1800789d4(longlong param_1,longlong *param_2,undefined8 param_3,undefined8 *param_4,
                  uint *param_5)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  ulonglong uVar6;
  longlong **pplVar7;
  undefined uVar8;
  longlong *plVar9;
  longlong lVar10;
  uint uVar11;
  undefined uVar12;
  uint *puVar13;
  undefined uVar14;
  undefined auStackY648 [32];
  byte bVar15;
  wchar_t *pwVar16;
  uint local_258;
  uint local_254 [3];
  wchar_t local_248 [264];
  ulonglong local_38;
  
  local_38 = DAT_1800b2220 ^ (ulonglong)auStackY648;
  local_254[0] = 0;
  local_258 = 0;
  uVar11 = *param_5 >> 0x1c;
  if ((*param_5 & 0xf0000000) == 0) {
    uVar11 = *param_5;
  }
  bVar15 = (byte)uVar11;
  if (uVar11 < 0x10) {
    FUN_180078948(param_1,param_2,uVar11);
    pwVar16 = local_248;
    pplVar7 = (longlong **)&local_258;
    puVar13 = local_254;
    plVar9 = param_2;
    uVar6 = FUN_180079500(param_1,param_2,puVar13,(uint *)pplVar7,pwVar16);
    uVar12 = SUB81(pwVar16,0);
    if (0x102 < (int)uVar6 - 1U) {
      bVar15 = (byte)uVar6;
      uVar14 = 0x50;
      uVar12 = 0x1d;
      goto LAB_180078b4e;
    }
    if ((*(short *)(param_1 + 0x240) == 0x7fff) || ((local_258 & *(uint *)(param_1 + 0x220)) != 0))
    {
      pplVar7 = FUN_180010688(local_248,plVar9,puVar13,pplVar7);
      if (pplVar7 == (longlong **)0x0) {
        FUN_18001188c(1,0x28,0x42,0xc0,uVar12);
      }
      else {
        lVar10 = (ulonglong)uVar11 * 0x20;
        *(longlong ***)(lVar10 + 0x30 + param_1) = pplVar7;
        *(undefined4 *)(lVar10 + 0x38 + param_1) = 2;
        *(uint *)(param_1 + 0x1c) = *(uint *)(param_1 + 0x1c) | 1 << (bVar15 & 0x1f);
        if (param_2 == (longlong *)0x0) {
          *(undefined (*) [16])(lVar10 + 0x20 + param_1) = ZEXT816(0);
        }
        else {
          uVar2 = *(undefined4 *)param_2;
          uVar3 = *(undefined4 *)((longlong)param_2 + 4);
          uVar4 = *(undefined4 *)(param_2 + 1);
          uVar5 = *(undefined4 *)((longlong)param_2 + 0xc);
          puVar13 = (uint *)(lVar10 + 0x38 + param_1);
          *puVar13 = *puVar13 | 1;
          puVar1 = (undefined4 *)(lVar10 + 0x20 + param_1);
          *puVar1 = uVar2;
          puVar1[1] = uVar3;
          puVar1[2] = uVar4;
          puVar1[3] = uVar5;
        }
        if (uVar11 == 1) {
          *(longlong ***)(param_1 + 0x10) = pplVar7;
        }
        *param_5 = uVar11 << 0x1c;
        if (param_4 != (undefined8 *)0x0) {
          *param_4 = pplVar7;
        }
      }
      goto LAB_180078b5f;
    }
    bVar15 = (byte)local_248;
    uVar12 = 0x32;
    uVar14 = 0x88;
    uVar8 = 3;
  }
  else {
    uVar14 = 0x40;
    uVar12 = 0xfb;
LAB_180078b4e:
    uVar8 = 1;
  }
  FUN_18001188c(uVar8,0x28,uVar12,uVar14,bVar15);
LAB_180078b5f:
  __security_check_cookie(local_38 ^ (ulonglong)auStackY648);
  return;
}



uint FUN_180078b90(longlong param_1,uint param_2,undefined8 param_3,undefined8 param_4,
                  wchar_t *param_5)

{
  short sVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  wchar_t *_Str2;
  undefined8 unaff_RDI;
  
  uVar2 = FUN_18001140c(param_1,param_2);
  do {
    if (uVar2 == 0) {
      return 0;
    }
    sVar1 = FUN_1800113d4(param_1,uVar2);
    if ((sVar1 == 0x702b) && (uVar3 = FUN_1800110fc(param_1,uVar2,0x6001), uVar3 != 0)) {
      _Str2 = (wchar_t *)FUN_180078d74(param_1,uVar3);
      if (_Str2 == (wchar_t *)0x0) {
        FUN_18001188c(1,0x20,0x98,0,(char)unaff_RDI);
        return 0;
      }
      iVar4 = _wcsicmp(param_5,_Str2);
      if (iVar4 == 0) {
        return uVar2;
      }
    }
    uVar2 = FUN_180011170(param_1,param_2,uVar2);
  } while( true );
}



bool FUN_180078c50(undefined8 param_1,longlong param_2,uint **param_3)

{
  uint uVar1;
  undefined1 unaff_DIL;
  undefined uVar2;
  undefined uVar3;
  bool bVar4;
  
  if (param_2 == 0) {
    uVar3 = 0xa8;
    uVar2 = 0xb2;
  }
  else {
    if (param_3 != (uint **)0x0) {
      uVar1 = FUN_1800110fc(param_2,0,0x7801);
      *(uint *)(param_2 + 0x548) = uVar1;
      bVar4 = uVar1 != 0;
      if (!bVar4) {
        FUN_18001188c(1,0xe0,0xc2,0x40,unaff_DIL);
        return bVar4;
      }
      *param_3 = (uint *)(param_2 + 0x548);
      return bVar4;
    }
    uVar3 = 0;
    uVar2 = 0xb8;
  }
  FUN_18001188c(1,0xe0,uVar2,uVar3,unaff_DIL);
  return false;
}



longlong FUN_180078d00(longlong param_1,uint param_2)

{
  ushort uVar1;
  longlong lVar2;
  
  uVar1 = FUN_1800113d4(param_1,param_2);
  if ((uVar1 & 0xf000) == 0x9000) {
    lVar2 = FUN_180078f2c(param_1,param_2);
  }
  else {
    FUN_1800113d4(param_1,param_2);
    FUN_18001188c(1,0,0xb4,0xa8,(char)param_2);
    lVar2 = 0;
  }
  return lVar2;
}



longlong FUN_180078d74(longlong param_1,uint param_2)

{
  ushort uVar1;
  int iVar2;
  longlong lVar3;
  undefined unaff_DIL;
  undefined uVar4;
  undefined uVar5;
  
  if (param_1 == 0) {
    uVar5 = 0x80;
    uVar4 = 0x7b;
  }
  else {
    uVar1 = FUN_1800113d4(param_1,param_2);
    if ((uVar1 & 0xf000) == 0x8000) {
      lVar3 = FUN_180078f2c(param_1,param_2);
      return lVar3;
    }
    if ((uVar1 & 0xf000) != 0x6000) {
      return 0;
    }
    iVar2 = FUN_180079128(param_1,param_2);
    if (iVar2 != 0) {
      lVar3 = FUN_180078ec4(param_1,iVar2);
      return lVar3;
    }
    uVar5 = 0x68;
    uVar4 = 0x8f;
  }
  FUN_18001188c(1,0x90,uVar4,uVar5,unaff_DIL);
  return 0;
}



undefined8 FUN_180078e24(longlong param_1,uint param_2,undefined8 param_3)

{
  ushort uVar1;
  undefined8 uVar2;
  undefined8 uVar3;
  undefined8 local_res18 [2];
  
  local_res18[0] = param_3;
  uVar1 = FUN_1800113d4(param_1,param_2);
  if ((uVar1 & 0xf000) == 0x5000) {
    uVar2 = FUN_18001107c(param_1,param_2,local_res18,8);
    uVar3 = local_res18[0];
    if ((int)uVar2 == 0) {
      uVar3 = param_3;
    }
  }
  else {
    FUN_1800113d4(param_1,param_2);
    FUN_18001188c(1,0x40,0x9d,0xf0,(char)param_2);
    uVar3 = param_3;
  }
  return uVar3;
}



longlong FUN_180078ec4(longlong param_1,int param_2)

{
  uint uVar1;
  longlong lVar2;
  uint local_res18 [2];
  longlong local_res20;
  undefined in_stack_fffffffffffffff8;
  
  local_res18[0] = 0;
  local_res20 = 0;
  uVar1 = FUN_180078fb0(param_1,param_2,local_res18,&local_res20);
  if (((uVar1 != 0) && (local_res18[0] != 0)) && (local_res20 != 0)) {
    lVar2 = FUN_180078f2c(local_res20,local_res18[0]);
    return lVar2;
  }
  FUN_18001188c(1,0x88,0x7a,0x40,in_stack_fffffffffffffff8);
  return 0;
}



longlong FUN_180078f2c(longlong param_1,uint param_2)

{
  int iVar1;
  uint uVar2;
  longlong lVar3;
  undefined in_stack_ffffffffffffffe8;
  
  iVar1 = FUN_1800111e0(param_1,param_2);
  uVar2 = iVar1 + param_2;
  if (uVar2 < *(uint *)(param_1 + 0x14)) {
    lVar3 = (ulonglong)uVar2 + *(longlong *)(param_1 + 8);
    if (lVar3 != 0) {
      return lVar3;
    }
  }
  else {
    FUN_18001188c(1,0x80,0xea,0x30,(char)uVar2);
    in_stack_ffffffffffffffe8 = (undefined)uVar2;
    lVar3 = 0;
  }
  FUN_18001188c(1,8,0xcf,0xe8,in_stack_ffffffffffffffe8);
  return lVar3;
}



uint FUN_180078fb0(longlong param_1,int param_2,uint *param_3,longlong *param_4)

{
  uint uVar1;
  short sVar2;
  uint uVar3;
  int iVar4;
  longlong lVar5;
  uint uVar6;
  int *local_res8;
  undefined in_stack_ffffffffffffffc8;
  
  uVar6 = 0;
  local_res8 = (int *)0x0;
  if (*(int *)(param_1 + 0x10) == 0) {
    uVar3 = RtlRunOnceExecuteOnce(param_1 + 0x540,FUN_180078c50,param_1,&local_res8);
    if ((int)uVar3 < 0) {
      FUN_18001188c(1,0x58,3,0x80,(char)uVar3);
      param_1 = 0;
      goto LAB_1800790e7;
    }
    if ((local_res8 == (int *)0x0) || (iVar4 = *local_res8, iVar4 == 0)) {
      FUN_18001188c(1,0x58,0x13,0xd0,in_stack_ffffffffffffffc8);
      param_1 = 0;
      uVar3 = 0xc0000229;
      goto LAB_1800790e7;
    }
  }
  else {
    param_1 = *(longlong *)(param_1 + 0x550);
    if (param_1 == 0) {
      FUN_18001188c(1,0x58,0xef,0x40,in_stack_ffffffffffffffc8);
      param_1 = 0;
      uVar3 = 0xc0000225;
      uVar6 = 0;
      goto LAB_1800790e7;
    }
    iVar4 = 6;
  }
  uVar6 = iVar4 + param_2;
  sVar2 = FUN_1800113d4(param_1,uVar6);
  uVar3 = 0;
  if (sVar2 != -0x77ff) {
    FUN_18001188c(1,0x58,0x21,0x18,in_stack_ffffffffffffffc8);
    uVar3 = 0xc0000024;
  }
LAB_1800790e7:
  lVar5 = 0;
  uVar1 = 0;
  if (-1 < (int)uVar3) {
    lVar5 = param_1;
    uVar1 = uVar6;
  }
  *param_3 = uVar1;
  *param_4 = lVar5;
  return ~uVar3 >> 0x1f;
}



undefined4 FUN_180079128(longlong param_1,uint param_2)

{
  ushort uVar1;
  undefined8 uVar2;
  undefined4 local_res18 [4];
  undefined in_stack_ffffffffffffffe8;
  
  local_res18[0] = 0;
  uVar1 = FUN_1800113d4(param_1,param_2);
  if ((uVar1 & 0xf000) == 0x6000) {
    uVar2 = FUN_18001107c(param_1,param_2,local_res18,4);
    if ((int)uVar2 != 0) {
      return local_res18[0];
    }
    FUN_18001188c((char)uVar2 + '\x01',0x50,0x28,0x48,in_stack_ffffffffffffffe8);
  }
  else {
    FUN_1800113d4(param_1,param_2);
    FUN_18001188c(1,0x50,0x23,0x20,(char)param_2);
  }
  return 0;
}



undefined8 FUN_1800791d4(wchar_t *param_1,uint **param_2)

{
  wchar_t *pwVar1;
  uint *puVar2;
  longlong lVar3;
  wchar_t *pwVar4;
  wchar_t *pwVar5;
  uint uVar6;
  undefined uVar7;
  undefined uVar8;
  wchar_t *pwVar9;
  wchar_t *pwVar10;
  wchar_t *pwVar11;
  undefined uVar12;
  undefined8 unaff_R15;
  longlong in_GS_OFFSET;
  
  uVar12 = (undefined)unaff_R15;
  pwVar9 = (wchar_t *)0x0;
  if (param_1 == (wchar_t *)0x0) {
    uVar8 = 0xd8;
    uVar7 = 0x6c;
  }
  else {
    uVar6 = (uint)(*param_1 != L'\0');
    pwVar1 = param_1;
    while( true ) {
      pwVar1 = wcschr(pwVar1,L';');
      uVar12 = (undefined)unaff_R15;
      if (pwVar1 == (wchar_t *)0x0) break;
      uVar6 = uVar6 + 1;
      pwVar1 = pwVar1 + 1;
    }
    puVar2 = (uint *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,
                                     (ulonglong)(uVar6 - 1) * 0x30 + 0x38);
    if (puVar2 != (uint *)0x0) {
      *puVar2 = uVar6;
      lVar3 = -1;
      do {
        lVar3 = lVar3 + 1;
      } while (param_1[lVar3] != L'\0');
      pwVar5 = pwVar9;
      pwVar11 = pwVar9;
      for (pwVar1 = param_1 + lVar3; param_1 <= pwVar1; pwVar1 = pwVar1 + -1) {
        pwVar4 = pwVar5;
        pwVar10 = pwVar11;
        if (((((*pwVar1 != L'\\') || (pwVar4 = pwVar1, pwVar5 == (wchar_t *)0x0)) &&
             (pwVar5 = pwVar4, *pwVar1 == L';')) || (param_1 == pwVar1)) &&
           (pwVar5 != (wchar_t *)0x0)) {
          if (*pwVar1 == L';') {
            pwVar1 = pwVar1 + 1;
          }
          pwVar10 = (wchar_t *)(ulonglong)((int)pwVar11 + 1);
          puVar2[(longlong)pwVar11 * 0xc + 4] = (int)((longlong)pwVar5 - (longlong)pwVar1 >> 1) + 1;
          *(wchar_t **)(puVar2 + (longlong)pwVar11 * 0xc + 2) = pwVar1;
          pwVar5 = pwVar9;
        }
        pwVar11 = pwVar10;
      }
      *param_2 = puVar2;
      return 1;
    }
    uVar8 = 0x18;
    uVar7 = 0x89;
  }
  FUN_18001188c(1,0xf0,uVar7,uVar8,uVar12);
  return 0;
}



undefined8 * FUN_180079338(undefined8 param_1,undefined4 param_2)

{
  undefined8 *puVar1;
  undefined8 uVar2;
  longlong in_GS_OFFSET;
  undefined in_stack_ffffffffffffffe8;
  
  puVar1 = (undefined8 *)
           RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,0x580);
  if (puVar1 == (undefined8 *)0x0) {
    FUN_18001188c(1,0x40,0x4d,0x18,in_stack_ffffffffffffffe8);
  }
  else {
    *(undefined4 *)(puVar1 + 2) = 0;
    *(uint *)(puVar1 + 3) = *(uint *)(puVar1 + 3) | 1;
    *puVar1 = 0;
    puVar1[1] = param_1;
    *(undefined4 *)((longlong)puVar1 + 0x14) = param_2;
    uVar2 = FUN_180011390((longlong)puVar1,0,&stack0xffffffffffffffe8,0xc);
    if ((int)uVar2 == 0) {
      FUN_18001188c((char)uVar2 + '\x01',0x40,0x58,0x98,in_stack_ffffffffffffffe8);
    }
    else {
      uVar2 = FUN_1800107cc((longlong)puVar1,(int *)&stack0xffffffffffffffe8);
      if ((int)uVar2 != 0) {
        return puVar1;
      }
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar1);
  }
  return (undefined8 *)0x0;
}



void FUN_180079430(undefined2 *param_1,undefined8 param_2,uint *param_3,undefined8 param_4)

{
  uint uVar1;
  undefined8 uVar2;
  undefined uVar3;
  undefined uVar4;
  undefined8 uVar5;
  undefined auStackY184 [32];
  wchar_t local_88 [48];
  ulonglong local_28;
  
  local_28 = DAT_1800b2220 ^ (ulonglong)auStackY184;
  uVar2 = 0;
  uVar5 = param_4;
  memset(local_88,0,0x56);
  uVar3 = (undefined)uVar5;
  if ((param_3 == (uint *)0x0) || (uVar1 = FUN_1800798dc(local_88,uVar2,param_3), -1 < (int)uVar1))
  {
    uVar1 = FUN_180011cac(param_1,uVar2,7,uVar3,local_88,param_4);
    if (-1 < (int)uVar1) goto LAB_1800794d6;
    uVar4 = 0x58;
    uVar3 = 4;
  }
  else {
    uVar4 = 0x80;
    uVar3 = 0xf8;
  }
  FUN_18001188c(1,0xa8,uVar3,uVar4,(char)uVar1);
LAB_1800794d6:
  __security_check_cookie(local_28 ^ (ulonglong)auStackY184);
  return;
}



// WARNING: Could not reconcile some variable overlaps

ulonglong FUN_180079500(longlong param_1,longlong *param_2,uint *param_3,uint *param_4,
                       undefined2 *param_5)

{
  bool bVar1;
  int iVar2;
  longlong lVar3;
  undefined7 extraout_var;
  ulonglong uVar4;
  uint uVar5;
  undefined4 uVar6;
  undefined **ppuVar9;
  ulonglong uVar10;
  longlong in_GS_OFFSET;
  uint uStack0000000000000030;
  undefined1 in_stack_ffffffffffffff68;
  uint local_88 [2];
  longlong local_80;
  undefined local_78 [16];
  undefined local_68 [16];
  undefined4 local_58 [2];
  undefined8 local_50;
  undefined *local_48;
  undefined4 local_40;
  undefined local_38 [16];
  ulonglong uVar7;
  undefined2 *puVar8;
  
  uVar4 = 0;
  uStack0000000000000030 = 0;
  local_88[0] = 0;
  local_80 = 0;
  uVar10 = 0;
  local_78 = ZEXT816(0);
  local_68 = ZEXT816(0);
  if (param_5 == (undefined2 *)0x0) {
    return 0;
  }
  *param_5 = 0;
  ppuVar9 = &PTR_DAT_1800b21d0;
  uVar7 = uVar4;
  do {
    lVar3 = *(longlong *)*ppuVar9 - *param_2;
    if (lVar3 == 0) {
      lVar3 = *(longlong *)((longlong)*ppuVar9 + 8) - param_2[1];
    }
    if (lVar3 == 0) {
      lVar3 = (longlong)(int)uVar7;
      uVar5 = (&DAT_1800b21d8)[lVar3 * 6];
      iVar2 = (&DAT_1800b21dc)[lVar3 * 6];
      uStack0000000000000030 = uVar5;
      if ((&DAT_1800b21e0)[lVar3 * 6] != 0) {
        puVar8 = param_5;
        bVar1 = FUN_180011c80(param_5,ppuVar9,(&DAT_1800b21e0)[lVar3 * 6]);
        uVar6 = SUB84(puVar8,0);
        if ((int)CONCAT71(extraout_var,bVar1) == 0) {
          uVar6 = 1;
          FUN_18001188c(1,0xe0,0xbd,0xc0,in_stack_ffffffffffffff68);
        }
        else {
          uVar4 = 0xffffffffffffffff;
          do {
            uVar4 = uVar4 + 1;
          } while (param_5[uVar4] != 0);
        }
        if (param_3 != (uint *)0x0) {
          *param_3 = uVar5;
        }
        if (param_4 != (uint *)0x0) {
          uVar5 = FUN_180078888(uVar6);
          *param_4 = uVar5;
          if (iVar2 != 0) {
            *param_4 = uVar5 & 0x1b;
          }
        }
        goto LAB_18007961f;
      }
      break;
    }
    uVar5 = (int)uVar7 + 1;
    uVar7 = (ulonglong)uVar5;
    ppuVar9 = (undefined **)((longlong **)ppuVar9 + 3);
  } while (uVar5 < 3);
  iVar2 = FUN_180073a94((undefined4 *)local_68,(uint *)param_2);
  if (iVar2 < 0) {
    FUN_18001188c(1,0xe0,0xd4,0xf8,(char)iVar2);
    uVar10 = uVar4;
  }
  else {
    iVar2 = local_68._0_2_ + 0xb8;
    uVar4 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,iVar2);
    if (uVar4 == 0) {
      FUN_18001188c(1,0xe0,0xe9,0x20,(char)iVar2);
    }
    else {
      local_78 = CONCAT88(uVar4,SUB148(CONCAT122(local_78._4_12_,(short)iVar2),0) << 0x10);
      local_78 = local_78 & (undefined  [16])0xffffffffffff0000;
      RtlAppendUnicodeToString
                (local_78,
                 L"\\Registry\\Machine\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\InstalledSDB"
                );
      RtlAppendUnicodeToString(local_78,&DAT_180085358);
      RtlAppendUnicodeStringToString(local_78,local_68);
      local_48 = local_78;
      local_58[0] = 0x30;
      local_50 = 0;
      lVar3 = 0x80000100;
      local_40 = 0x40;
      local_38 = ZEXT816(0);
      iVar2 = ZwOpenKey(&local_80,0x80000100,local_58);
      if (iVar2 < 0) {
        FUN_18001188c(1,0xe0,0xf9,8,SUB161(local_78 >> 0x40,0));
      }
      else {
        if (param_3 != (uint *)0x0) {
          lVar3 = local_80;
          iVar2 = FUN_180070cc4((undefined4 *)&stack0x00000030,local_80,&DAT_180080790);
          if (iVar2 < 0) {
            FUN_18001188c(1,0xe0,5,0x28,(char)iVar2);
            *param_3 = 0;
            goto LAB_18007985f;
          }
          *param_3 = uStack0000000000000030 & 0x7fffffff;
        }
        if (param_4 != (uint *)0x0) {
          lVar3 = local_80;
          iVar2 = FUN_180070cc4(local_88,local_80,&DAT_180080780);
          if (iVar2 < 0) {
            FUN_18001188c(1,0xe0,0x15,0x50,(char)iVar2);
            *param_4 = 0;
            goto LAB_18007985f;
          }
          *param_4 = local_88[0];
        }
        iVar2 = FUN_180079430(param_5,lVar3,(uint *)param_2,param_1 + 0x240);
        if (iVar2 == 0) {
          FUN_18001188c(1,0xe0,0x1e,0x78,in_stack_ffffffffffffff68);
        }
        else {
          uVar10 = 0xffffffffffffffff;
          do {
            uVar10 = uVar10 + 1;
          } while (param_5[uVar10] != 0);
        }
      }
    }
  }
LAB_18007985f:
  if (local_80 != 0) {
    ZwClose();
  }
  if (uVar4 != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,uVar4);
  }
  uVar4 = uVar10;
  if (local_68._8_8_ != 0) {
    FUN_180074008((undefined (*) [16])local_68);
  }
LAB_18007961f:
  return uVar4 & 0xffffffff;
}



uint FUN_1800798dc(wchar_t *param_1,undefined8 param_2,uint *param_3)

{
  wchar_t wVar1;
  uint uVar2;
  wchar_t *pwVar3;
  longlong lVar4;
  wchar_t *pwVar5;
  longlong lVar6;
  undefined uVar7;
  undefined uVar8;
  longlong lVar9;
  
  *param_1 = L'\0';
  uVar2 = FUN_1800739b8(param_1,param_2,param_3);
  if ((int)uVar2 < 0) {
    uVar8 = 0x90;
    uVar7 = 0x2b;
  }
  else {
    lVar6 = 0x2b;
    pwVar3 = param_1;
    do {
      if (*pwVar3 == L'\0') break;
      pwVar3 = pwVar3 + 1;
      lVar6 = lVar6 + -1;
    } while (lVar6 != 0);
    uVar2 = ~-(uint)(lVar6 != 0) & 0xc000000d;
    if (lVar6 != 0) {
      lVar4 = -lVar6 + 0x2b;
      pwVar3 = param_1 + lVar4;
      lVar4 = 0x2b - lVar4;
      if (lVar4 != 0) {
        lVar6 = -lVar6 + 0x7ffffffe + lVar4;
        lVar9 = (longlong)L".sdb" - (longlong)pwVar3;
        do {
          if ((lVar6 == 0) || (wVar1 = *(wchar_t *)(lVar9 + (longlong)pwVar3), wVar1 == L'\0'))
          break;
          *pwVar3 = wVar1;
          lVar6 = lVar6 + -1;
          pwVar3 = pwVar3 + 1;
          lVar4 = lVar4 + -1;
        } while (lVar4 != 0);
      }
      pwVar5 = pwVar3 + -1;
      if (lVar4 != 0) {
        pwVar5 = pwVar3;
      }
      uVar2 = ~-(uint)(lVar4 != 0) & 0x80000005;
      *pwVar5 = L'\0';
    }
    if (-1 < (int)uVar2) {
      return 0;
    }
    uVar8 = 0x18;
    uVar7 = 0x31;
  }
  FUN_18001188c(1,0xb0,uVar7,uVar8,(char)uVar2);
  return uVar2;
}



void FUN_1800799f0(short *param_1,ulonglong param_2,short *param_3,short *param_4)

{
  uint uVar1;
  ulonglong uVar2;
  short *psVar3;
  undefined uVar4;
  undefined uVar5;
  undefined auStackY680 [32];
  short local_278 [2];
  undefined2 local_274 [2];
  undefined4 local_270;
  undefined4 uStack620;
  undefined4 uStack616;
  undefined4 uStack612;
  undefined4 local_260;
  undefined2 local_25c;
  short local_258 [264];
  ulonglong local_48;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStackY680;
  local_260 = 0x340036;
  local_25c = 0;
  local_270 = 0x700041;
  uStack620 = 0x500070;
  uStack616 = 0x740061;
  uStack612 = 0x680063;
  if (param_2 < 0xb) goto LAB_180079b44;
  local_274[0] = 0xffff;
  local_258[0] = 0;
  local_278[0] = -1;
  uVar1 = FUN_180079fb8(local_274,local_278,param_4);
  if ((int)uVar1 < 0) {
    uVar5 = 0x38;
    uVar4 = 0xe0;
  }
  else if ((local_278[0] == 9) || (local_278[0] == 0xc)) {
    psVar3 = (short *)&DAT_180085634;
    if (param_3 != (short *)0x0) {
      psVar3 = param_3;
    }
    uVar2 = FUN_18000b98c((short *)&local_270,psVar3,local_258,0x104);
    uVar1 = (uint)uVar2;
    if (-1 < (int)uVar1) goto LAB_180079b2d;
    uVar5 = 0xd0;
    uVar4 = 0xec;
  }
  else {
    psVar3 = (short *)&DAT_180085634;
    if (param_3 != (short *)0x0) {
      psVar3 = param_3;
    }
    uVar1 = FUN_18000ecd4(local_258,0x104,(longlong)psVar3);
    if (-1 < (int)uVar1) {
LAB_180079b2d:
      FUN_1800105c0(param_1,param_2,local_258);
      goto LAB_180079b44;
    }
    uVar5 = 0x90;
    uVar4 = 0xf2;
  }
  FUN_18001188c(1,0x70,uVar4,uVar5,(char)uVar1);
LAB_180079b44:
  __security_check_cookie(local_48 ^ (ulonglong)auStackY680);
  return;
}



void FUN_180079b70(short *param_1,ulonglong param_2,short *param_3,short *param_4)

{
  int iVar1;
  ulonglong uVar2;
  short *psVar3;
  undefined uVar4;
  undefined uVar5;
  undefined auStackY680 [32];
  short local_278 [2];
  short local_274 [2];
  undefined4 local_270;
  undefined4 uStack620;
  undefined4 uStack616;
  undefined4 uStack612;
  undefined4 local_260;
  undefined2 local_25c;
  short local_258 [264];
  ulonglong local_48;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStackY680;
  local_260 = 0x720065;
  local_25c = 0;
  local_270 = 0x61005c;
  uStack620 = 0x700070;
  uStack616 = 0x610072;
  uStack612 = 0x730069;
  if (10 < param_2) {
    *param_1 = 0;
    local_258[0] = 0;
    psVar3 = (short *)&DAT_180085634;
    if (param_3 != (short *)0x0) {
      psVar3 = param_3;
    }
    local_274[0] = -1;
    local_278[0] = -1;
    uVar2 = FUN_18000b98c((short *)&local_270,psVar3,local_258,0x104);
    iVar1 = (int)uVar2;
    if (iVar1 < 0) {
      uVar5 = 0xd0;
      uVar4 = 0xbb;
    }
    else {
      iVar1 = FUN_180079fb8(local_274,local_278,param_4);
      if (-1 < iVar1) {
        FUN_180074458(param_1,param_2,local_258,local_274[0],local_278);
        goto LAB_180079c88;
      }
      uVar5 = 0x38;
      uVar4 = 0xc1;
    }
    FUN_18001188c(1,0x70,uVar4,uVar5,(char)iVar1);
  }
LAB_180079c88:
  __security_check_cookie(local_48 ^ (ulonglong)auStackY680);
  return;
}



void FUN_180079cb0(short *param_1,ulonglong param_2,short *param_3)

{
  ulonglong uVar1;
  short *psVar2;
  undefined auStackY648 [32];
  undefined4 local_258;
  undefined4 uStack596;
  undefined4 uStack592;
  undefined4 uStack588;
  undefined4 local_248;
  undefined2 local_244;
  short local_238 [264];
  ulonglong local_28;
  
  local_28 = DAT_1800b2220 ^ (ulonglong)auStackY648;
  local_248 = 0x420044;
  local_244 = 0;
  local_258 = 0x43005c;
  uStack596 = 0x730075;
  uStack592 = 0x6f0074;
  uStack588 = 0x53006d;
  if (10 < param_2) {
    *param_1 = 0;
    local_238[0] = 0;
    psVar2 = (short *)&DAT_180085634;
    if (param_3 != (short *)0x0) {
      psVar2 = param_3;
    }
    uVar1 = FUN_18000b98c((short *)&local_258,psVar2,local_238,0x104);
    if ((int)uVar1 < 0) {
      FUN_18001188c(1,0xf0,0x4a,0xd0,(char)uVar1);
    }
    else {
      FUN_1800105c0(param_1,param_2,local_238);
    }
  }
  __security_check_cookie(local_28 ^ (ulonglong)auStackY648);
  return;
}



void FUN_180079da0(short *param_1,ulonglong param_2,short *param_3,short *param_4)

{
  int iVar1;
  ulonglong uVar2;
  short *psVar3;
  undefined8 *puVar4;
  undefined uVar5;
  undefined uVar6;
  undefined auStackY728 [32];
  short local_2a8 [2];
  undefined2 local_2a4 [2];
  undefined8 local_2a0;
  undefined4 local_298;
  undefined2 local_294;
  undefined4 local_290;
  undefined4 uStack652;
  undefined4 uStack648;
  undefined4 uStack644;
  undefined4 local_280;
  undefined4 uStack636;
  undefined4 uStack632;
  undefined4 uStack628;
  short local_268 [264];
  ulonglong local_58;
  
  local_58 = DAT_1800b2220 ^ (ulonglong)auStackY728;
  local_2a0 = 0x74007300750043;
  local_298 = 0x6d006f;
  local_294 = 0;
  local_290 = 0x750043;
  uStack652 = 0x740073;
  uStack648 = 0x6d006f;
  uStack644 = 0x43005c;
  local_280 = 0x730075;
  uStack636 = 0x6f0074;
  uStack632 = 0x36006d;
  uStack628 = 0x34;
  if (6 < param_2) {
    local_2a4[0] = 0xffff;
    *param_1 = 0;
    puVar4 = &local_2a0;
    local_268[0] = 0;
    local_2a8[0] = -1;
    iVar1 = FUN_180079fb8(local_2a4,local_2a8,param_4);
    if (iVar1 < 0) {
      uVar6 = 0x38;
      uVar5 = 0x7b;
    }
    else {
      if ((local_2a8[0] == 9) || (local_2a8[0] == 0xc)) {
        puVar4 = (undefined8 *)&local_290;
      }
      psVar3 = (short *)&DAT_180085634;
      if (param_3 != (short *)0x0) {
        psVar3 = param_3;
      }
      uVar2 = FUN_18000b98c((short *)puVar4,psVar3,local_268,0x104);
      iVar1 = (int)uVar2;
      if (-1 < iVar1) {
        FUN_1800105c0(param_1,param_2,local_268);
        goto LAB_180079ee4;
      }
      uVar6 = 0xd0;
      uVar5 = 0x89;
    }
    FUN_18001188c(1,0x38,uVar5,uVar6,(char)iVar1);
  }
LAB_180079ee4:
  __security_check_cookie(local_58 ^ (ulonglong)auStackY728);
  return;
}



int FUN_180079f10(short *param_1,longlong param_2,short *param_3,short *param_4)

{
  int iVar1;
  undefined uVar2;
  undefined uVar3;
  short local_18 [2];
  short local_14 [6];
  
  iVar1 = FUN_180079fb8(local_14,local_18,param_4);
  if (iVar1 < 0) {
    uVar3 = 0x38;
    uVar2 = 0x10;
  }
  else {
    iVar1 = FUN_180074590(param_1,param_2,param_3,local_14[0],local_18);
    if (-1 < iVar1) {
      return iVar1;
    }
    uVar3 = 0xf0;
    uVar2 = 0x16;
  }
  FUN_18001188c(1,0xc0,uVar2,uVar3,(char)iVar1);
  return iVar1;
}



int FUN_180079fb8(undefined2 *param_1,short *param_2,short *param_3)

{
  short sVar1;
  int iVar2;
  short local_res20 [4];
  undefined2 local_28 [8];
  
  local_res20[0] = -1;
  local_28[0] = 0xffff;
  iVar2 = FUN_180011b58(local_28,local_res20);
  if (-1 < iVar2) {
    if ((param_3 == (short *)0x0) || (sVar1 = FUN_180011bf4(*param_3), sVar1 == -1)) {
      sVar1 = local_res20[0];
    }
    *param_1 = local_28[0];
    *param_2 = sVar1;
    return 0;
  }
  FUN_18001188c(1,0xe0,0x69,0xa8,(char)iVar2);
  return iVar2;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

undefined4
FUN_18007a060(undefined4 *param_1,longlong param_2,longlong param_3,undefined8 param_4,uint param_5,
             longlong param_6)

{
  code *pcVar1;
  uint uVar2;
  undefined4 uVar3;
  longlong lVar4;
  undefined unaff_DIL;
  undefined uVar5;
  undefined uVar6;
  
  pcVar1 = *(code **)(param_2 + 0x3c8);
  *param_1 = 0;
  if (pcVar1 == (code *)0x0) {
    uVar6 = 0x98;
    uVar5 = 0xee;
  }
  else {
    uVar2 = FUN_1800110fc(param_3,param_5,0x6001);
    if (uVar2 == 0) {
      uVar6 = 0xd8;
      uVar5 = 0xf4;
    }
    else {
      lVar4 = FUN_180078d74(param_3,uVar2);
      if (lVar4 != 0) {
        uVar3 = (*pcVar1)();
        *param_1 = uVar3;
        if (param_6 == 0) {
          return 1;
        }
        *(undefined4 *)(param_6 + 0x50) = 1;
        return 1;
      }
      uVar6 = 0xf8;
      uVar5 = 0xfa;
    }
  }
  FUN_18001188c(1,0xc0,uVar5,uVar6,unaff_DIL);
  return 0;
}



int FUN_18007a130(int *param_1,longlong param_2,longlong param_3,undefined8 param_4,uint param_5,
                 uint *param_6)

{
  int *piVar1;
  uint *puVar2;
  uint *puVar3;
  uint uVar4;
  int iVar5;
  wchar_t *pwVar6;
  undefined8 uVar7;
  int iVar8;
  undefined uVar9;
  undefined uVar10;
  longlong lVar11;
  longlong in_GS_OFFSET;
  undefined in_stack_ffffffffffffffb8;
  void **ppvVar12;
  
  iVar5 = 0;
  uVar4 = FUN_1800110fc(param_3,param_5,0x6001);
  if (uVar4 != 0) {
    pwVar6 = (wchar_t *)FUN_180078d74(param_3,uVar4);
    puVar2 = param_6;
    iVar8 = 0;
    if (pwVar6 == (wchar_t *)0x0) {
      uVar10 = 0x10;
      uVar9 = 0xf7;
    }
    else {
      lVar11 = -1;
      do {
        lVar11 = lVar11 + 1;
      } while (pwVar6[lVar11] != L'\0');
      if (((*(byte *)param_6 & 1) != 0) || (uVar7 = FUN_18007c0e8(param_6), (int)uVar7 != 0)) {
        piVar1 = *(int **)(puVar2 + 0x12);
        if (0 < *piVar1) {
          do {
            param_6 = (uint *)0x0;
            ppvVar12 = (void **)(piVar1 + (longlong)iVar8 * 0xc + 2);
            uVar7 = FUN_18007c37c(param_2,(longlong)puVar2,pwVar6,(uint)lVar11,ppvVar12,
                                  (wchar_t **)&param_6);
            puVar3 = param_6;
            in_stack_ffffffffffffffb8 = SUB81(ppvVar12,0);
            if ((int)uVar7 == 0) {
              uVar10 = 0x58;
              uVar9 = 0x1c;
              goto LAB_18007a197;
            }
            uVar7 = FUN_1800704f0((wchar_t *)param_6);
            iVar5 = (int)uVar7;
            if (puVar3 != (uint *)0x0) {
              RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_6);
            }
            if (iVar5 != 0) {
              if (0 < iVar8) {
                puVar2[0x14] = 1;
              }
              break;
            }
            iVar8 = iVar8 + 1;
          } while (iVar8 < *piVar1);
        }
        if (((ushort)(*pwVar6 + L'ￛ') < 0x38) &&
           ((0x80000000000201U >> ((ulonglong)(ushort)(*pwVar6 + L'ￛ') & 0x3f) & 1) != 0)) {
          puVar2[0x14] = 1;
        }
        goto LAB_18007a2ac;
      }
      uVar10 = 0x50;
      uVar9 = 4;
    }
LAB_18007a197:
    FUN_18001188c(1,0x40,uVar9,uVar10,in_stack_ffffffffffffffb8);
  }
LAB_18007a2ac:
  *param_1 = iVar5;
  return iVar5;
}



wchar_t **
FUN_18007a300(uint *param_1,longlong param_2,longlong param_3,undefined8 param_4,uint param_5,
             wchar_t **param_6)

{
  wchar_t **ppwVar1;
  uint uVar2;
  int iVar3;
  wchar_t *pwVar4;
  ulonglong uVar5;
  undefined8 uVar6;
  wchar_t **ppwVar7;
  undefined uVar8;
  undefined uVar9;
  int iVar10;
  wchar_t **ppwVar11;
  wchar_t **ppwVar12;
  longlong in_GS_OFFSET;
  undefined in_stack_ffffffffffffff98;
  void **ppvVar13;
  uint local_58 [2];
  wchar_t **local_50;
  longlong local_48;
  int *local_40;
  
  ppwVar1 = param_6;
  ppwVar7 = (wchar_t **)0x0;
  local_58[0] = 0;
  local_50 = (wchar_t **)0x0;
  ppwVar12 = ppwVar7;
  if (param_6[0xb] == (wchar_t *)0x0) {
    uVar2 = FUN_1800110fc(param_3,param_5,0x6001);
    ppwVar11 = ppwVar7;
    if (uVar2 == 0) goto LAB_18007a562;
    pwVar4 = (wchar_t *)FUN_180078d74(param_3,uVar2);
    if (pwVar4 == (wchar_t *)0x0) {
      uVar9 = 0x10;
      uVar8 = 0x84;
    }
    else {
      ppwVar11 = (wchar_t **)0x0;
      if (((wchar_t **)ppwVar1[1] != (wchar_t **)0x0) && (*pwVar4 == L'*')) {
        uVar5 = FUN_18007cbbc(local_58,param_2,param_3,param_5,(wchar_t **)ppwVar1[1]);
        iVar10 = (int)uVar5;
        uVar6 = FUN_180070740(iVar10);
        ppwVar12 = (wchar_t **)0x0;
        ppwVar7 = (wchar_t **)0x0;
        if (((int)uVar6 == 0) && (iVar10 < 0)) {
          FUN_18001188c(1,0x78,0x9d,0x90,(char)iVar10);
        }
        else {
          ppwVar11 = (wchar_t **)0x1;
        }
        goto LAB_18007a562;
      }
      local_48 = -1;
      do {
        local_48 = local_48 + 1;
      } while (pwVar4[local_48] != L'\0');
      if (((*(byte *)ppwVar1 & 1) != 0) || (uVar6 = FUN_18007c0e8((uint *)ppwVar1), (int)uVar6 != 0)
         ) {
        local_40 = (int *)ppwVar1[9];
        iVar10 = 0;
        if (0 < *local_40) {
          do {
            ppvVar13 = (void **)(local_40 + (longlong)iVar10 * 0xc + 2);
            uVar6 = FUN_18007c37c(param_2,(longlong)ppwVar1,pwVar4,(uint)local_48,ppvVar13,
                                  (wchar_t **)&local_50);
            ppwVar7 = local_50;
            if ((int)uVar6 == 0) {
              FUN_18001188c(1,0x78,0xcf,0xb8,(char)ppvVar13);
              ppwVar7 = local_50;
              goto LAB_18007a562;
            }
            param_6 = (wchar_t **)0x0;
            iVar3 = FUN_18001033c(&param_6,(wchar_t *)local_50);
            ppwVar12 = param_6;
            if (-1 < iVar3) {
              uVar5 = FUN_18007cbbc(local_58,param_2,param_3,param_5,param_6);
              if (-1 < (int)uVar5) {
                if (0 < iVar10) {
                  *(undefined4 *)(ppwVar1 + 10) = 1;
                }
                break;
              }
              FUN_18001175c((longlong *)ppwVar12);
              param_6 = (wchar_t **)0x0;
            }
            if (ppwVar7 != (wchar_t **)0x0) {
              RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_50);
            }
            iVar10 = iVar10 + 1;
            ppwVar7 = (wchar_t **)0x0;
            local_50 = (wchar_t **)0x0;
            ppwVar12 = param_6;
          } while (iVar10 < *local_40);
        }
        if (((ushort)(*pwVar4 + L'ￛ') < 0x38) &&
           ((0x80000000000201U >> ((ulonglong)(ushort)(*pwVar4 + L'ￛ') & 0x3f) & 1) != 0)) {
          *(undefined4 *)(ppwVar1 + 10) = 1;
        }
        goto LAB_18007a55f;
      }
      uVar9 = 0x50;
      uVar8 = 0xb7;
    }
    FUN_18001188c(1,0x78,uVar8,uVar9,in_stack_ffffffffffffff98);
    ppwVar11 = ppwVar7;
  }
  else {
    local_58[0] = 1;
LAB_18007a55f:
    ppwVar11 = (wchar_t **)0x1;
  }
LAB_18007a562:
  FUN_18001175c((longlong *)ppwVar12);
  if (ppwVar7 != (wchar_t **)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_50);
  }
  *param_1 = local_58[0];
  return ppwVar11;
}



undefined8
FUN_18007a5f0(undefined4 *param_1,undefined8 param_2,longlong param_3,undefined8 param_4,
             uint param_5,longlong param_6)

{
  int iVar1;
  undefined8 uVar2;
  undefined uVar3;
  undefined uVar4;
  uint local_res8 [2];
  undefined uVar5;
  uint local_48;
  undefined4 local_44;
  size_t local_40;
  void *local_38;
  longlong local_30;
  short *local_28;
  wchar_t *local_20;
  short *local_18 [2];
  uint *puVar6;
  
  *param_1 = 0;
  local_44 = 0;
  local_18[0] = (short *)0x0;
  puVar6 = &local_48;
  local_20 = (wchar_t *)0x0;
  local_48 = 0;
  local_28 = (short *)0x0;
  local_res8[0] = 0;
  local_30 = 0;
  local_38 = (void *)0x0;
  local_40 = 0;
  uVar2 = FUN_18007bdc4(param_3,param_5,local_18,(longlong *)&local_20,puVar6,(ulonglong *)&local_28
                        ,local_res8,&local_30,(ulonglong *)&local_38,&local_40);
  uVar5 = SUB81(puVar6,0);
  if ((int)uVar2 == 0) {
    uVar4 = 0x98;
    uVar3 = 0xcb;
  }
  else {
    uVar5 = (undefined)local_res8[0];
    iVar1 = FUN_18007a71c(local_18[0],local_20,local_48,local_28,local_res8[0],local_30,local_38,
                          local_40,&local_44);
    if (iVar1 != 0) {
      *(undefined4 *)(param_6 + 0x50) = 1;
      *param_1 = local_44;
      return 1;
    }
    uVar4 = 0xe0;
    uVar3 = 0xdc;
  }
  FUN_18001188c(1,0xc0,uVar3,uVar4,uVar5);
  return 0;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18007a71c(undefined8 param_1,wchar_t *param_2,uint param_3,short *param_4,int param_5,
                  longlong param_6,void *param_7,size_t param_8,undefined4 *param_9)

{
  int iVar1;
  undefined auStackY776 [32];
  undefined in_stack_fffffffffffffd18;
  longlong local_2b8;
  undefined local_2b0 [16];
  undefined local_2a0 [16];
  undefined local_290 [16];
  undefined local_280 [16];
  undefined8 local_270;
  undefined4 local_268;
  wchar_t local_258 [264];
  ulonglong local_48;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStackY776;
  local_258[0] = L'\0';
  local_2b8 = 0;
  local_270 = 0;
  *param_9 = 0;
  local_268 = 0;
  local_280 = ZEXT816(0);
  local_2b0 = ZEXT816(0);
  local_2a0 = ZEXT816(0);
  local_290 = ZEXT816(0);
  iVar1 = FUN_180039540(local_258,0x104,L"\\REGISTRY\\MACHINE\\%s",param_1);
  if (iVar1 < 0) {
    FUN_18001188c(1,0xb8,0xe4,0x90,in_stack_fffffffffffffd18);
    goto LAB_18007a8dd;
  }
  RtlInitUnicodeString(local_280,local_258);
  local_2b0 = CONCAT124(local_2b0._4_12_,0x30);
  local_2b0 = local_2b0 & (undefined  [16])0xffffffffffffffff;
  local_290 = ZEXT816(0);
  iVar1 = ZwOpenKey(&local_2b8,0x20019);
  if (iVar1 < 0) {
    iVar1 = ZwQuerySystemInformation(1,&local_270,0xc);
    if (iVar1 < 0) {
      FUN_18001188c(1,0xb8,7,0xd8,(char)iVar1);
      goto LAB_18007a8dd;
    }
    if (((short)local_270 != 9) || (iVar1 = ZwOpenKey(&local_2b8,0x20219), iVar1 < 0))
    goto LAB_18007a8dd;
  }
  FUN_18007a920(local_2b8,param_2,param_3,param_4,param_5,param_6,param_7,param_8,param_9);
LAB_18007a8dd:
  if (local_2b8 != 0) {
    ZwClose();
  }
  __security_check_cookie(local_48 ^ (ulonglong)auStackY776);
  return;
}



short * FUN_18007a920(undefined8 param_1,wchar_t *param_2,uint param_3,short *param_4,int param_5,
                     longlong param_6,void *param_7,size_t param_8,undefined4 *param_9)

{
  int iVar1;
  uint uVar2;
  short *psVar3;
  undefined8 uVar4;
  short *psVar5;
  short *psVar6;
  longlong *_Src;
  longlong lVar7;
  undefined uVar8;
  undefined uVar9;
  short *_Dst;
  longlong in_GS_OFFSET;
  bool bVar10;
  undefined4 local_res10 [2];
  undefined uVar11;
  undefined4 uVar12;
  short *local_48;
  undefined local_40 [24];
  
  psVar3 = (short *)0x0;
  local_48 = (short *)0x0;
  local_res10[0] = 0;
  _Dst = (short *)0x0;
  lVar7 = 0;
  psVar6 = (short *)0x0;
  if ((param_2 == (wchar_t *)0x0) || (*param_2 == L'\0')) {
LAB_18007ac30:
    *param_9 = 1;
    goto LAB_18007ac3a;
  }
  iVar1 = _wcsicmp(param_2,L"dbRegistryDefaultName");
  if (iVar1 == 0) {
    psVar5 = (short *)0x0;
  }
  else {
    uVar2 = FUN_18000eaac(&local_48,param_2);
    psVar5 = local_48;
    if ((int)uVar2 < 0) goto LAB_18007ac85;
  }
  RtlInitUnicodeString(local_40,psVar5);
  uVar11 = 0;
  iVar1 = ZwQueryValueKey(param_1,local_40);
  if (((iVar1 < 0) && (iVar1 != -0x7ffffffb)) && (iVar1 != -0x3fffffdd)) {
    psVar6 = (short *)0x1;
    goto LAB_18007ac85;
  }
  lVar7 = RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8);
  psVar6 = psVar3;
  if (lVar7 == 0) {
    FUN_18001188c(1,0,200,0xe0,uVar11);
    goto LAB_18007ac85;
  }
  uVar12 = local_res10[0];
  iVar1 = ZwQueryValueKey(param_1,local_40,1,lVar7,local_res10[0],local_res10);
  uVar11 = (undefined)uVar12;
  if (iVar1 < 0) {
    uVar9 = 0x20;
    uVar8 = 0xd3;
    _Dst = psVar3;
    goto LAB_18007aa74;
  }
  uVar2 = *(uint *)(lVar7 + 4);
  if (param_3 == 0) {
    *param_9 = 1;
LAB_18007aa93:
    psVar6 = (short *)0x1;
    _Dst = psVar3;
  }
  else {
    if (uVar2 != param_3) goto LAB_18007aa93;
    _Src = (longlong *)((ulonglong)*(uint *)(lVar7 + 8) + lVar7);
    if (uVar2 == 0) {
LAB_18007ac1e:
      uVar9 = 0x38;
      uVar8 = 0x5a;
      _Dst = psVar3;
LAB_18007aa74:
      FUN_18001188c(1,0,uVar8,uVar9,uVar11);
    }
    else {
      if (uVar2 < 3) {
        _Dst = (short *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8
                                       );
        if (_Dst == (short *)0x0) {
          uVar8 = 0xf8;
LAB_18007abee:
          uVar9 = 0xe0;
          goto LAB_18007aa74;
        }
        RtlMoveMemory(_Dst,_Src,(ulonglong)*(uint *)(lVar7 + 0xc));
        _Dst[*(uint *)(lVar7 + 0xc) >> 1] = 0;
LAB_18007ab75:
        uVar4 = FUN_180073d70(param_4,_Dst);
        if ((int)uVar4 != 0) goto LAB_18007ac30;
      }
      else {
        if (uVar2 == 3) {
          if (param_8 != *(uint *)(lVar7 + 0xc)) goto LAB_18007ac3a;
          iVar1 = memcmp(param_7,_Src,param_8);
          bVar10 = iVar1 == 0;
        }
        else if (uVar2 == 4) {
          bVar10 = param_5 == *(int *)_Src;
        }
        else {
          if (uVar2 == 7) {
            _Dst = (short *)RtlAllocateHeap(*(undefined8 *)
                                             (*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8);
            if (_Dst != (short *)0x0) {
              RtlMoveMemory(_Dst,_Src,(ulonglong)*(uint *)(lVar7 + 0xc));
              _Dst[*(uint *)(lVar7 + 0xc) >> 1] = 0;
              psVar6 = _Dst;
              if (_Dst < (short *)(((ulonglong)*(uint *)(lVar7 + 0xc) & 0xfffffffffffffffe) +
                                  (longlong)_Dst)) {
                do {
                  if (*psVar6 == 0) {
                    if (psVar6[1] == 0) break;
                    *psVar6 = 0x3b;
                  }
                  psVar6 = psVar6 + 1;
                } while (psVar6 < (short *)(((ulonglong)*(uint *)(lVar7 + 0xc) & 0xfffffffffffffffe)
                                           + (longlong)_Dst));
              }
              goto LAB_18007ab75;
            }
            uVar8 = 0xf;
            goto LAB_18007abee;
          }
          if (uVar2 != 0xb) goto LAB_18007ac1e;
          bVar10 = param_6 == *_Src;
        }
        _Dst = psVar3;
        if (bVar10) goto LAB_18007ac30;
      }
LAB_18007ac3a:
      psVar6 = (short *)0x1;
    }
  }
  if (lVar7 != 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lVar7);
  }
  if (_Dst != (short *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,_Dst);
  }
LAB_18007ac85:
  if (local_48 != (short *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_48);
  }
  return psVar6;
}



undefined8
FUN_18007ace0(undefined4 *param_1,longlong param_2,longlong param_3,undefined8 param_4,uint param_5,
             uint *param_6)

{
  undefined8 uVar1;
  longlong *plVar2;
  undefined8 uVar3;
  undefined uVar4;
  undefined uVar5;
  longlong in_GS_OFFSET;
  uint local_res8 [2];
  undefined uVar6;
  uint local_38;
  uint local_34;
  uint local_30;
  undefined4 local_2c;
  short *local_28;
  wchar_t *local_20;
  uint *puVar7;
  
  uVar3 = 0;
  local_res8[0] = 0x2000;
  *param_1 = 0;
  local_2c = 0;
  local_30 = 0;
  local_20 = (wchar_t *)0x0;
  local_28 = (short *)0x0;
  local_34 = 0;
  local_38 = 0;
  puVar7 = &local_34;
  uVar1 = FUN_18007bb70(param_3,param_5,&local_20,&local_28,puVar7,(int *)&local_38,local_res8);
  uVar6 = SUB81(puVar7,0);
  if ((int)uVar1 == 0) {
    uVar5 = 0x30;
    uVar4 = 0x99;
  }
  else {
    uVar6 = (undefined)local_34;
    plVar2 = FUN_18007ae18(param_2,param_6,local_20,local_28,local_34,local_38,local_res8[0],
                           &local_2c,&local_30);
    if ((int)plVar2 != 0) {
      uVar3 = 1;
      param_6[0x14] = param_6[0x14] | local_30;
      *param_1 = local_2c;
      goto LAB_18007add0;
    }
    uVar5 = 0x70;
    uVar4 = 0xaa;
  }
  FUN_18001188c(1,0x58,uVar4,uVar5,uVar6);
LAB_18007add0:
  if (local_28 != (short *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_28);
  }
  return uVar3;
}



longlong *
FUN_18007ae18(longlong param_1,uint *param_2,wchar_t *param_3,short *param_4,uint param_5,
             uint param_6,uint param_7,undefined4 *param_8,undefined4 *param_9)

{
  int *piVar1;
  int iVar2;
  undefined8 uVar3;
  ulonglong uVar4;
  longlong *plVar5;
  wchar_t *pwVar6;
  uint uVar7;
  longlong *plVar8;
  int iVar9;
  uint uVar10;
  wchar_t *pwVar11;
  undefined uVar12;
  undefined uVar13;
  longlong lVar14;
  longlong in_GS_OFFSET;
  undefined4 local_res10;
  undefined in_stack_ffffffffffffff98;
  undefined uVar15;
  void **ppvVar16;
  longlong *local_58;
  wchar_t *local_50;
  void *local_48;
  void *local_40;
  
  plVar5 = (longlong *)0x0;
  local_res10 = 0;
  local_50 = (wchar_t *)0x0;
  local_58 = (longlong *)0x0;
  *param_8 = 0;
  *param_9 = 0;
  plVar8 = plVar5;
  if (((*(byte *)param_2 & 1) == 0) && (uVar3 = FUN_18007c0e8(param_2), (int)uVar3 == 0)) {
    FUN_18001188c(1,0x78,0x94,0x50,in_stack_ffffffffffffff98);
    pwVar6 = (wchar_t *)0x0;
    goto LAB_18007af80;
  }
  pwVar6 = (wchar_t *)0x0;
  piVar1 = *(int **)(param_2 + 0x12);
  pwVar11 = pwVar6;
  if (0 < *piVar1) {
    do {
      iVar9 = (int)pwVar11;
      ppvVar16 = (void **)(piVar1 + (longlong)iVar9 * 0xc + 2);
      lVar14 = -1;
      do {
        lVar14 = lVar14 + 1;
      } while (param_3[lVar14] != L'\0');
      uVar3 = FUN_18007c37c(param_1,(longlong)param_2,param_3,(uint)lVar14,ppvVar16,&local_50);
      if ((int)uVar3 == 0) {
        FUN_18001188c(1,0x78,0xac,0x98,(char)ppvVar16);
        goto LAB_18007b020;
      }
      iVar2 = FUN_18001033c(&local_58,local_50);
      plVar8 = local_58;
      if (-1 < iVar2) {
        uVar4 = FUN_180010004((longlong)local_58);
        iVar2 = (int)uVar4;
      }
      pwVar6 = (wchar_t *)0x0;
      uVar3 = FUN_180070740(iVar2);
      if ((int)uVar3 == 0) {
        if (iVar2 < 0) {
          FUN_18001188c(1,0x78,0xcc,0xc0,(char)iVar2);
          goto LAB_18007b020;
        }
        if (0 < iVar9) {
          *param_9 = 1;
        }
        if (plVar8 != (longlong *)0x0) {
          uVar4 = (ulonglong)pwVar6 & 0xffffffff;
          local_40 = (void *)plVar8[4];
          if ((ulonglong)plVar8[3] <= (ulonglong)param_7) {
            param_7 = *(uint *)(plVar8 + 3);
          }
          if (param_5 <= param_7) {
            if (param_7 != 0) goto LAB_18007b083;
            goto LAB_18007b17b;
          }
        }
        break;
      }
      FUN_18001175c(plVar8);
      local_58 = (longlong *)0x0;
      if (local_50 != (wchar_t *)0x0) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_50);
      }
      pwVar6 = (wchar_t *)0x0;
      pwVar11 = (wchar_t *)(ulonglong)(iVar9 + 1U);
      local_50 = (wchar_t *)0x0;
      plVar8 = local_58;
    } while ((int)(iVar9 + 1U) < *piVar1);
  }
  *param_8 = (int)pwVar6;
  goto LAB_18007af70;
LAB_18007b083:
  do {
    uVar10 = (uint)uVar4;
    if (param_5 < uVar10) {
      uVar10 = uVar10 + ((((uint)pwVar6 & 0xffffff00 | (uint)(param_6 == 3)) + 1) - param_5);
    }
    uVar7 = param_7 - uVar10;
    if (0x1000 < uVar7) {
      uVar7 = 0x1000;
    }
    local_48 = (void *)RtlAllocateHeap();
    uVar15 = SUB81(ppvVar16,0);
    if (local_48 == (void *)0x0) {
      uVar13 = 0xd8;
      uVar12 = 0x13;
LAB_18007b196:
      FUN_18001188c(1,0x78,uVar12,uVar13,uVar15);
      plVar8 = local_58;
LAB_18007b020:
      pwVar6 = (wchar_t *)0x0;
      goto LAB_18007af80;
    }
    if ((void *)((ulonglong)uVar10 + (longlong)local_40) < local_40) {
      uVar13 = 0xf8;
      uVar12 = 0x1a;
      goto LAB_18007b196;
    }
    memcpy(local_48,(void *)((ulonglong)uVar10 + (longlong)local_40),(ulonglong)uVar7);
    uVar15 = SUB81(ppvVar16,0);
    if (param_6 == 0) {
LAB_18007b189:
      uVar13 = 0x18;
      uVar12 = 0x3c;
      goto LAB_18007b196;
    }
    if (param_6 < 3) {
      lVar14 = FUN_180073e64((longlong)local_48,uVar7,(char *)param_4,param_5);
      if (lVar14 != 0) {
        local_res10 = 1;
      }
    }
    else {
      if (param_6 != 3) goto LAB_18007b189;
      lVar14 = FUN_180073efc((longlong)local_48,uVar7 >> 1,param_4,param_5 >> 1);
      if (lVar14 != 0) {
        local_res10 = 1;
      }
    }
    uVar4 = (ulonglong)(uVar10 + uVar7);
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
  } while (uVar10 + uVar7 < param_7);
  pwVar6 = (wchar_t *)0x0;
  plVar8 = local_58;
LAB_18007b17b:
  *param_8 = local_res10;
LAB_18007af70:
  plVar5 = (longlong *)0x1;
LAB_18007af80:
  if (((ushort)(*param_3 + L'ￛ') < 0x38) &&
     ((0x80000000000201U >> ((ulonglong)(ushort)(*param_3 + L'ￛ') & 0x3f) & 1) != 0)) {
    *param_9 = 1;
  }
  if (local_50 != pwVar6) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_50);
    plVar8 = local_58;
  }
  if (plVar8 != (longlong *)0x0) {
    FUN_18001175c(plVar8);
  }
  return plVar5;
}



void FUN_18007b200(uint *param_1,longlong param_2,longlong param_3,undefined8 param_4,uint param_5,
                  uint *param_6)

{
  uint uVar1;
  wchar_t **ppwVar2;
  undefined8 uVar3;
  ulonglong uVar4;
  wchar_t **ppwVar5;
  undefined uVar6;
  undefined uVar7;
  longlong lVar8;
  int iVar9;
  longlong in_GS_OFFSET;
  undefined auStackY728 [32];
  undefined in_stack_fffffffffffffd48;
  void **ppvVar10;
  uint local_2a8 [2];
  wchar_t **local_2a0;
  wchar_t **local_298;
  uint *local_290;
  longlong local_288;
  wchar_t *local_280;
  uint *local_278;
  longlong local_270;
  int *local_268;
  wchar_t local_258 [264];
  ulonglong local_48;
  
  local_48 = DAT_1800b2220 ^ (ulonglong)auStackY728;
  ppwVar2 = (wchar_t **)0x0;
  local_2a8[0] = 0;
  local_2a0 = (wchar_t **)0x0;
  local_298 = (wchar_t **)0x0;
  local_290 = (uint *)0x0;
  ppwVar5 = ppwVar2;
  local_288 = param_2;
  local_278 = param_1;
  local_270 = param_3;
  if (*(longlong *)(param_6 + 0x16) == 0) {
    uVar1 = FUN_1800110fc(param_3,param_5,0x6001);
    if (uVar1 != 0) {
      local_280 = (wchar_t *)FUN_180078d74(param_3,uVar1);
      if (local_280 == (wchar_t *)0x0) {
        uVar7 = 0x10;
        uVar6 = 0x53;
      }
      else {
        lVar8 = -1;
        do {
          lVar8 = lVar8 + 1;
        } while (local_280[lVar8] != L'\0');
        if (((*(byte *)param_6 & 1) != 0) || (uVar3 = FUN_18007c0e8(param_6), (int)uVar3 != 0)) {
          local_268 = *(int **)(param_6 + 0x12);
          iVar9 = 0;
          if (0 < *local_268) {
            do {
              ppvVar10 = (void **)(local_268 + (longlong)iVar9 * 0xc + 2);
              uVar3 = FUN_18007c37c(local_288,(longlong)param_6,local_280,(uint)lVar8,ppvVar10,
                                    (wchar_t **)&local_2a0);
              if ((int)uVar3 == 0) {
                FUN_18001188c(1,0xd8,0x79,0xb8,(char)ppvVar10);
                ppwVar5 = local_2a0;
                param_1 = local_278;
                goto LAB_18007b49c;
              }
              FUN_18007192c((longlong *)&local_290);
              uVar4 = 0;
              memset(local_258,0,0x208);
              ppwVar5 = local_2a0;
              uVar1 = FUN_180071970(local_258,uVar4,(wchar_t *)local_2a0,&local_290);
              while (-1 < (int)uVar1) {
                if (ppwVar2 != (wchar_t **)0x0) {
                  FUN_18001175c((longlong *)ppwVar2);
                  local_298 = (wchar_t **)0x0;
                }
                uVar1 = FUN_18001033c(&local_298,local_258);
                ppwVar2 = local_298;
                if ((int)uVar1 < 0) break;
                uVar4 = FUN_18007cbbc(local_2a8,local_288,local_270,param_5,local_298);
                if (-1 < (int)uVar4) goto LAB_18007b490;
                uVar1 = FUN_180071f5c(local_258,0x104,(int *)local_290);
              }
              if (uVar1 != 0x80000006) {
                FUN_18001188c(3,0xd8,0xaf,0xf8,(char)uVar1);
              }
              if (ppwVar5 != (wchar_t **)0x0) {
                RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_2a0);
                ppwVar5 = (wchar_t **)0x0;
                local_2a0 = (wchar_t **)0x0;
                ppwVar2 = local_298;
              }
              iVar9 = iVar9 + 1;
            } while (iVar9 < *local_268);
          }
LAB_18007b490:
          param_6[0x14] = 1;
          param_1 = local_278;
          goto LAB_18007b49c;
        }
        uVar7 = 0x50;
        uVar6 = 0x61;
      }
      FUN_18001188c(1,0xd8,uVar6,uVar7,in_stack_fffffffffffffd48);
      ppwVar2 = (wchar_t **)0x0;
      ppwVar5 = (wchar_t **)0x0;
    }
  }
  else {
    local_2a8[0] = 1;
  }
LAB_18007b49c:
  FUN_18007192c((longlong *)&local_290);
  FUN_18001175c((longlong *)ppwVar2);
  if (ppwVar5 != (wchar_t **)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_2a0);
  }
  *param_1 = local_2a8[0];
  __security_check_cookie(local_48 ^ (ulonglong)auStackY728);
  return;
}



undefined8
FUN_18007b510(int *param_1,undefined8 param_2,longlong param_3,undefined8 param_4,uint param_5,
             longlong param_6)

{
  undefined8 uVar1;
  undefined uVar2;
  undefined uVar3;
  uint local_res8 [2];
  undefined uVar4;
  uint local_48;
  int local_44;
  size_t local_40;
  void *local_38;
  longlong local_30;
  short *local_28;
  wchar_t *local_20;
  short *local_18 [2];
  uint *puVar5;
  
  *param_1 = 0;
  local_44 = 0;
  local_18[0] = (short *)0x0;
  puVar5 = &local_48;
  local_20 = (wchar_t *)0x0;
  local_48 = 0;
  local_28 = (short *)0x0;
  local_res8[0] = 0;
  local_30 = 0;
  local_38 = (void *)0x0;
  local_40 = 0;
  uVar1 = FUN_18007bdc4(param_3,param_5,local_18,(longlong *)&local_20,puVar5,(ulonglong *)&local_28
                        ,local_res8,&local_30,(ulonglong *)&local_38,&local_40);
  uVar4 = SUB81(puVar5,0);
  if ((int)uVar1 == 0) {
    uVar3 = 8;
    uVar2 = 0x74;
  }
  else {
    uVar4 = (undefined)local_res8[0];
    uVar1 = FUN_18007b63c(local_18[0],local_20,local_48,local_28,local_res8[0],local_30,local_38,
                          local_40,&local_44);
    if ((int)uVar1 != 0) {
      *(undefined4 *)(param_6 + 0x50) = 1;
      *param_1 = local_44;
      return 1;
    }
    uVar3 = 0x60;
    uVar2 = 0x85;
  }
  FUN_18001188c(1,0x38,uVar2,uVar3,uVar4);
  return 0;
}



undefined8
FUN_18007b63c(short *param_1,wchar_t *param_2,uint param_3,short *param_4,int param_5,
             longlong param_6,void *param_7,size_t param_8,int *param_9)

{
  uint uVar1;
  short *psVar2;
  ulonglong uVar3;
  longlong local_38;
  longlong *local_30;
  
  local_30 = (longlong *)0x0;
  local_38 = 0;
  *param_9 = 0;
  uVar1 = FUN_180072c30(&local_38,&local_30,param_1);
  while ((-1 < (int)uVar1 &&
         ((psVar2 = FUN_18007a920(local_38,param_2,param_3,param_4,param_5,param_6,param_7,param_8,
                                  param_9), (int)psVar2 == 0 || (*param_9 == 0))))) {
    uVar3 = FUN_180072d0c(&local_38,local_30);
    uVar1 = (uint)uVar3;
  }
  FUN_180072b70(local_30);
  return 1;
}



undefined8
FUN_18007b730(uint *param_1,longlong param_2,longlong param_3,undefined8 param_4,uint param_5)

{
  uint uVar1;
  
  uVar1 = FUN_180010c20(param_3,param_5,0);
  *param_1 = (uint)((*(uint *)(param_2 + 0x230) & uVar1) != 0);
  return 1;
}



undefined8
FUN_18007b780(int *param_1,longlong param_2,undefined8 param_3,undefined8 param_4,uint param_5,
             longlong param_6)

{
  ushort uVar1;
  longlong lVar2;
  bool bVar3;
  uint uVar4;
  int iVar5;
  undefined8 uVar6;
  short *psVar7;
  ulonglong uVar8;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  short *psVar9;
  int iVar10;
  short *psVar11;
  short *psVar12;
  short *psVar13;
  undefined2 *puVar14;
  undefined8 unaff_R15;
  undefined uVar15;
  
  psVar9 = (short *)0x0;
  iVar10 = 1;
  lVar2 = *(longlong *)(param_6 + 0x58);
  *param_1 = 0;
  psVar11 = psVar9;
  do {
    uVar4 = FUN_1800110fc(*(longlong *)(param_2 + 8),param_5,psVar11[0xc0059190]);
    uVar15 = (undefined)unaff_R15;
    uVar8 = (ulonglong)uVar4;
    if (uVar4 != 0) {
      psVar7 = *(short **)(lVar2 + 0x10);
      if (psVar7 == (short *)0x0) {
LAB_18007b9b8:
        FUN_18001188c(1,0x68,0x88,0x38,uVar15);
        return 0;
      }
      puVar14 = &DAT_1800b2320;
      psVar13 = psVar9;
      do {
        psVar12 = psVar9;
        if ((psVar13 < psVar7) &&
           ((uVar6 = FUN_180073990(*(ulonglong *)(lVar2 + 8),(ulonglong)psVar13,&param_6),
            (int)uVar6 < 0 ||
            (psVar12 = (short *)(param_6 + *(longlong *)(lVar2 + 0x28)),
            psVar12 < *(short **)(lVar2 + 0x28))))) {
          psVar12 = psVar9;
        }
        uVar15 = (undefined)unaff_R15;
        if (*psVar12 == *(short *)((longlong)psVar11 + (longlong)(puVar14 + 1))) break;
        psVar7 = *(short **)(lVar2 + 0x10);
        psVar13 = (short *)((longlong)psVar13 + 1);
        psVar12 = psVar9;
      } while (psVar13 < psVar7);
      if (psVar12 == (short *)0x0) goto LAB_18007b9b8;
      uVar1 = *(ushort *)((longlong)psVar11 + (longlong)puVar14);
      uVar4 = (uint)uVar8;
      if (uVar1 == 0x4045) {
        iVar5 = FUN_180010c20(*(longlong *)(param_2 + 8),uVar4,0xffffffff);
        if (iVar5 == -1) {
          return 0;
        }
        uVar4 = (uint)(iVar5 == *(int *)(psVar12 + 4));
      }
      else if (uVar1 == 0x5014) {
LAB_18007b92d:
        uVar8 = FUN_180078e24(*(longlong *)(param_2 + 8),uVar4,0xffffffffffffffff);
        if (uVar8 == 0xffffffffffffffff) {
          return 0;
        }
        uVar6 = FUN_18007d0d4(uVar8,*(ulonglong *)(psVar12 + 4));
        uVar4 = (uint)uVar6;
      }
      else if (uVar1 == 0x5015) {
LAB_18007b909:
        uVar8 = FUN_180078e24(*(longlong *)(param_2 + 8),uVar4,0xffffffffffffffff);
        if (uVar8 == 0xffffffffffffffff) {
          return 0;
        }
        bVar3 = FUN_18007d04c(uVar8,*(ulonglong *)(psVar12 + 4));
        uVar4 = (uint)CONCAT71(extraout_var_00,bVar3);
      }
      else {
        if (uVar1 != 0x5016) {
          if (uVar1 == 0x5017) goto LAB_18007b92d;
          if (uVar1 == 0x5018) goto LAB_18007b909;
          if (uVar1 != 0x5019) {
            if (uVar1 < 0x6029) {
              return 0;
            }
            if (0x602b < uVar1) {
              return 0;
            }
            psVar7 = (short *)FUN_180078d74(*(longlong *)(param_2 + 8),uVar4);
            if (psVar7 == (short *)0x0) {
              return 0;
            }
            uVar6 = FUN_180073d70(psVar7,*(short **)(psVar12 + 4));
            uVar4 = (uint)uVar6;
            goto LAB_18007b970;
          }
        }
        uVar8 = FUN_180078e24(*(longlong *)(param_2 + 8),uVar4,0xffffffffffffffff);
        if (uVar8 == 0xffffffffffffffff) {
          return 0;
        }
        bVar3 = FUN_18007d090(uVar8,*(ulonglong *)(psVar12 + 4));
        uVar4 = (uint)CONCAT71(extraout_var,bVar3);
      }
LAB_18007b970:
      if ((iVar10 == 0) || (iVar10 = 1, uVar4 == 0)) {
        iVar10 = 0;
      }
    }
    psVar11 = psVar11 + 2;
    if ((short *)0x27 < psVar11) {
      *param_1 = iVar10;
      return 1;
    }
  } while( true );
}



undefined8
FUN_18007b9e0(uint *param_1,longlong param_2,longlong param_3,undefined8 param_4,uint param_5)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  
  uVar1 = *(uint *)(param_2 + 0x220);
  uVar2 = FUN_180010c20(param_3,param_5,0x7f);
  if ((*(uint *)(param_3 + 0x530) & 2) == 0) {
    *param_1 = (uint)((uVar2 & uVar1) != 0);
    return 1;
  }
  uVar3 = 0;
  uVar5 = 1;
  if (uVar2 != 0xc0000000) {
    iVar4 = 0;
    do {
      uVar5 = uVar3;
      if (uVar3 != 0) break;
      uVar5 = uVar2 >> ((byte)iVar4 & 0x1f);
      if ((uVar5 & 0x40) != 0) {
        uVar5 = uVar5 & 0x3f;
        if (uVar5 == 0) {
          uVar5 = 1;
          if ((uVar1 & 1) != 0) break;
LAB_18007bac9:
          uVar3 = 0;
        }
        else {
          if (uVar5 == 5) {
            uVar3 = uVar1 >> 3;
          }
          else {
            if (uVar5 != 9) {
              if ((uVar5 == 0xb) || (uVar5 == 0xc)) {
                uVar3 = uVar1 >> 2;
                goto LAB_18007baaf;
              }
              if (uVar5 != 0xd) goto LAB_18007bac9;
            }
            uVar3 = uVar1 >> 1;
          }
LAB_18007baaf:
          uVar3 = uVar3 & 1;
        }
        uVar5 = uVar3;
        if (uVar3 != 0) break;
      }
      iVar4 = iVar4 + 8;
      uVar5 = uVar3;
    } while (iVar4 < 0x18);
  }
  *param_1 = uVar5;
  return 1;
}



undefined8 FUN_18007baec(undefined8 *param_1,longlong param_2,longlong param_3,uint param_4)

{
  undefined8 uVar1;
  ushort uVar2;
  ulonglong uVar3;
  ushort uVar4;
  
  uVar2 = FUN_1800113d4(param_3,param_4);
  uVar4 = 0;
  if (param_4 != 0) {
    do {
      uVar3 = (ulonglong)uVar4;
      if ((uint)uVar2 == *(uint *)(param_2 + 0x248 + uVar3 * 0x18)) {
        uVar1 = *(undefined8 *)(param_2 + 0x250 + uVar3 * 0x18);
        *param_1 = *(undefined8 *)(param_2 + 600 + uVar3 * 0x18);
        return uVar1;
      }
      uVar4 = uVar4 + 1;
    } while (uVar4 < 0x10);
  }
  return 0;
}



undefined8
FUN_18007bb70(longlong param_1,uint param_2,short **param_3,void **param_4,uint *param_5,
             int *param_6,undefined4 *param_7)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  short *psVar5;
  undefined8 uVar6;
  void *pvVar7;
  undefined uVar8;
  undefined uVar9;
  undefined unaff_R15B;
  longlong in_GS_OFFSET;
  
  *param_3 = (short *)0x0;
  uVar4 = 0x2000;
  *param_4 = (void *)0x0;
  *param_5 = 0;
  pvVar7 = (void *)0x0;
  *param_6 = 0;
  *param_7 = 0x2000;
  uVar1 = FUN_1800110fc(param_1,param_2,0x6001);
  if (uVar1 == 0) {
    uVar9 = 8;
    uVar8 = 0x1a;
  }
  else {
    psVar5 = (short *)FUN_180078d74(param_1,uVar1);
    if ((psVar5 == (short *)0x0) || (*psVar5 == 0)) {
      uVar8 = 0x20;
      uVar9 = 0x50;
LAB_18007bd71:
      FUN_18001188c(1,0x30,uVar8,uVar9,unaff_R15B);
      if (pvVar7 == (void *)0x0) {
        return 0;
      }
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pvVar7);
      return 0;
    }
    uVar1 = FUN_1800110fc(param_1,param_2,-0x6fed);
    if (uVar1 == 0) {
      uVar9 = 0x78;
      uVar8 = 0x29;
    }
    else {
      uVar2 = FUN_1800112b0(param_1,uVar1);
      if (uVar2 == 0) {
        uVar9 = 0x98;
        uVar8 = 0x2f;
      }
      else {
        pvVar7 = (void *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                         8,(ulonglong)uVar2 + 2);
        if (pvVar7 != (void *)0x0) {
          uVar6 = FUN_180010820(param_1,uVar1,pvVar7,uVar2);
          if ((int)uVar6 == 0) {
            uVar8 = 0x3a;
            uVar9 = 0xe8;
          }
          else {
            uVar1 = FUN_1800110fc(param_1,param_2,0x4053);
            if (uVar1 == 0) {
              uVar8 = 0x43;
              uVar9 = 0x10;
            }
            else {
              iVar3 = FUN_180010c20(param_1,uVar1,0);
              if (iVar3 != 0) {
                uVar1 = FUN_1800110fc(param_1,param_2,0x4001);
                if (uVar1 != 0) {
                  uVar4 = FUN_180010c20(param_1,uVar1,0x2000);
                }
                *param_3 = psVar5;
                *param_4 = pvVar7;
                *param_5 = uVar2;
                *param_6 = iVar3;
                *param_7 = uVar4;
                return 1;
              }
              uVar8 = 0x49;
              uVar9 = 0x30;
            }
          }
          goto LAB_18007bd71;
        }
        uVar9 = 0xc0;
        uVar8 = 0x35;
      }
    }
  }
  FUN_18001188c(1,0x30,uVar8,uVar9,unaff_R15B);
  return 0;
}



undefined8
FUN_18007bdc4(longlong param_1,uint param_2,short **param_3,longlong *param_4,uint *param_5,
             ulonglong *param_6,uint *param_7,undefined8 *param_8,ulonglong *param_9,
             ulonglong *param_10)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  short *psVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  ulonglong uVar7;
  ulonglong uVar8;
  undefined uVar9;
  undefined uVar10;
  undefined in_stack_ffffffffffffffa8;
  longlong local_50;
  undefined8 local_48;
  
  uVar8 = 0;
  uVar3 = 0;
  *param_3 = (short *)0x0;
  local_50 = 0;
  local_48 = 0;
  *param_5 = 0;
  *param_4 = 0;
  *param_6 = 0;
  *param_7 = 0;
  *param_8 = 0;
  *param_9 = 0;
  *param_10 = 0;
  uVar1 = FUN_1800110fc(param_1,param_2,0x6001);
  if (uVar1 == 0) {
    uVar10 = 0x50;
    uVar9 = 0x18;
  }
  else {
    psVar4 = (short *)FUN_180078d74(param_1,uVar1);
    if ((psVar4 == (short *)0x0) || (*psVar4 == 0)) {
      uVar10 = 0x98;
      uVar9 = 0x1e;
      goto LAB_18007c0b2;
    }
    uVar1 = FUN_1800110fc(param_1,param_2,0x6030);
    if (uVar1 != 0) {
      local_50 = FUN_180078d74(param_1,uVar1);
    }
    uVar2 = FUN_1800110fc(param_1,param_2,0x4051);
    uVar5 = uVar8;
    uVar6 = uVar8;
    uVar7 = uVar8;
    uVar1 = uVar3;
    if (uVar2 == 0) goto LAB_18007bf4c;
    uVar1 = FUN_180010c20(param_1,uVar2,0);
    if (uVar1 == 0) {
      uVar10 = 0xb0;
      uVar9 = 0x31;
      goto LAB_18007c0b2;
    }
    if (2 < uVar1) {
      uVar7 = 0;
      if (uVar1 == 3) {
        uVar2 = FUN_1800110fc(param_1,param_2,-0x6fee);
        if (uVar2 == 0) {
          uVar10 = 0x68;
          uVar9 = 0x60;
        }
        else {
          uVar6 = FUN_180078d00(param_1,uVar2);
          if (uVar6 != 0) {
            uVar2 = FUN_1800112b0(param_1,uVar2);
            uVar5 = (ulonglong)uVar2;
            goto LAB_18007bf4c;
          }
          uVar10 = 0xf8;
          uVar9 = 0x66;
        }
        goto LAB_18007c0b2;
      }
      if (uVar1 == 4) {
        uVar3 = FUN_1800110fc(param_1,param_2,0x4052);
        if (uVar3 == 0) {
          uVar10 = 0x18;
          uVar9 = 0x4c;
          goto LAB_18007c0b2;
        }
        uVar3 = FUN_180010c20(param_1,uVar3,0);
        uVar5 = 0;
        uVar6 = 0;
        uVar7 = uVar8;
        goto LAB_18007bf4c;
      }
      if (uVar1 != 7) {
        if (uVar1 == 0xb) {
          uVar2 = FUN_1800110fc(param_1,param_2,0x501b);
          if (uVar2 != 0) {
            local_48 = FUN_180078e24(param_1,uVar2,0);
            goto LAB_18007bf4c;
          }
          uVar10 = 0x40;
          uVar9 = 0x56;
        }
        else {
          uVar10 = 0x90;
          uVar9 = 0x6d;
        }
        goto LAB_18007c0b2;
      }
    }
    uVar2 = FUN_1800110fc(param_1,param_2,0x6031);
    if (uVar2 == 0) {
      uVar10 = 0xd0;
      uVar9 = 0x3e;
    }
    else {
      uVar7 = FUN_180078d74(param_1,uVar2);
      if (uVar7 != 0) {
LAB_18007bf4c:
        *param_3 = psVar4;
        *param_4 = local_50;
        *param_5 = uVar1;
        *param_6 = uVar7;
        *param_7 = uVar3;
        *param_8 = local_48;
        *param_9 = uVar6;
        *param_10 = uVar5;
        return 1;
      }
      uVar10 = 0xf8;
      uVar9 = 0x44;
    }
  }
LAB_18007c0b2:
  FUN_18001188c(1,0x70,uVar9,uVar10,in_stack_ffffffffffffffa8);
  return 0;
}



undefined8 FUN_18007c0e8(uint *param_1)

{
  wchar_t *_Dst;
  undefined8 uVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  undefined uVar5;
  undefined uVar6;
  undefined unaff_R15B;
  longlong in_GS_OFFSET;
  ulonglong uVar4;
  
  if (*(longlong *)(param_1 + 0x12) != 0) {
    return 1;
  }
  _Dst = *(wchar_t **)(param_1 + 0x10);
  if (_Dst == (wchar_t *)0x0) {
    if (((*(byte *)param_1 & 2) == 0) && (*(short **)(param_1 + 0xe) != (short *)0x0)) {
      _Dst = FUN_18007c744(*(short **)(param_1 + 0xe),*(void **)(param_1 + 8),
                           *(void **)(param_1 + 10));
      if (_Dst != (wchar_t *)0x0) goto LAB_18007c204;
      uVar6 = 0x78;
      uVar5 = 0x61;
    }
    else {
      uVar2 = 0xffffffffffffffff;
      uVar3 = 0xffffffffffffffff;
      do {
        uVar4 = uVar3;
        uVar3 = uVar4 + 1;
      } while (*(short *)(*(longlong *)(param_1 + 8) + uVar3 * 2) != 0);
      do {
        uVar2 = uVar2 + 1;
      } while (*(short *)(*(longlong *)(param_1 + 10) + uVar2 * 2) != 0);
      _Dst = (wchar_t *)
             RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,
                             (ulonglong)(uint)((int)uVar4 + 2 + (int)uVar2) * 2);
      if (_Dst != (wchar_t *)0x0) {
        uVar3 = uVar3 & 0xffffffff;
        RtlMoveMemory(_Dst,*(void **)(param_1 + 8),uVar3 * 2);
        RtlMoveMemory(_Dst + uVar3,*(void **)(param_1 + 10),(uVar2 & 0xffffffff) * 2);
        _Dst[(uVar2 & 0xffffffff) + uVar3] = L'\0';
        goto LAB_18007c204;
      }
      uVar6 = 0x28;
      uVar5 = 0x52;
    }
    FUN_18001188c(1,0x58,uVar5,uVar6,unaff_R15B);
    uVar1 = 0;
  }
  else {
LAB_18007c204:
    *(wchar_t **)(param_1 + 0x10) = _Dst;
    uVar1 = FUN_1800791d4(_Dst,(uint **)(param_1 + 0x12));
    if ((int)uVar1 != 0) {
      *param_1 = *param_1 | 1;
    }
  }
  return uVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

undefined8
FUN_18007c360(int *param_1,longlong param_2,longlong param_3,undefined8 param_4,uint param_5)

{
  uint uVar1;
  uint uVar2;
  code *pcVar3;
  undefined8 uVar4;
  int iStack0000000000000030;
  undefined8 local_28 [2];
  
  iStack0000000000000030 = 1;
  uVar1 = FUN_18001140c(param_3,param_5);
  do {
    if (uVar1 == 0) {
LAB_18007c325:
      *param_1 = iStack0000000000000030;
      return 1;
    }
    pcVar3 = (code *)FUN_18007baec(local_28,param_2,param_3,uVar1);
    if (pcVar3 != (code *)0x0) {
      uVar4 = (*pcVar3)();
      if ((int)uVar4 == 0) {
        return uVar4;
      }
      uVar2 = FUN_1800110fc(param_3,uVar1,0x1003);
      if (uVar2 != 0) {
        if (iStack0000000000000030 == 0) {
          iStack0000000000000030 = 1;
          goto LAB_18007c325;
        }
        iStack0000000000000030 = 0;
      }
      if (iStack0000000000000030 == 1) goto LAB_18007c325;
    }
    uVar1 = FUN_180011170(param_3,param_5,uVar1);
  } while( true );
}



undefined8
FUN_18007c37c(longlong param_1,longlong param_2,wchar_t *param_3,uint param_4,void **param_5,
             wchar_t **param_6)

{
  undefined auVar1 [16];
  short sVar2;
  int iVar3;
  ulonglong uVar4;
  wchar_t *_Dst;
  undefined8 uVar5;
  ulonglong uVar6;
  undefined uVar7;
  undefined uVar8;
  undefined uVar9;
  undefined8 uVar10;
  longlong in_GS_OFFSET;
  short local_res20 [4];
  undefined in_stack_ffffffffffffff98;
  ulonglong *puVar11;
  ulonglong local_48 [2];
  
  uVar10 = 0;
  local_48[0] = 0;
  local_res20[0] = -1;
  *param_6 = (wchar_t *)0x0;
  param_6._0_2_ = -1;
  if (param_4 == 0) {
    uVar7 = 0xa0;
    uVar8 = 0x31;
    goto LAB_18007c686;
  }
  if (*param_3 == L'%') {
    iVar3 = FUN_180011b58((undefined2 *)&param_6,local_res20);
    if (iVar3 < 0) {
      uVar8 = (undefined)iVar3;
      uVar9 = 0xa8;
      uVar7 = 0x46;
LAB_18007c40d:
      FUN_18001188c(1,0xc0,uVar7,uVar9,uVar8);
      return 0;
    }
    sVar2 = FUN_180011bf4(*(short *)(param_1 + 0x240));
    if (sVar2 == -1) {
      sVar2 = local_res20[0];
    }
    puVar11 = local_48;
    uVar4 = FUN_180074234(*(short **)(param_2 + 0x38),param_3,(wchar_t *)0x0,0,(longlong *)puVar11,
                          (short)param_6,sVar2);
    in_stack_ffffffffffffff98 = SUB81(puVar11,0);
    if ((((int)uVar4 + 0x80000000U & 0x80000000) == 0) && ((int)uVar4 != -0x3fffffdd)) {
      uVar8 = (undefined)uVar4;
      uVar9 = 0xd8;
      uVar7 = 0x57;
      goto LAB_18007c40d;
    }
    uVar6 = local_48[0] * 2;
LAB_18007c4bb:
    if (uVar6 <= uVar6 + 0x14) {
      auVar1 = ZEXT816(2) * ZEXT816(uVar6 + 0x14);
      uVar4 = SUB168(auVar1,0);
      if (SUB168(auVar1 >> 0x40,0) != 0) {
        uVar7 = 0x18;
        uVar8 = 0x74;
        goto LAB_18007c686;
      }
      uVar6 = uVar4;
      if (uVar4 < 0x208) {
        uVar6 = 0x208;
      }
      local_48[0] = uVar4;
      _Dst = (wchar_t *)
             RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8);
      if (_Dst == (wchar_t *)0x0) {
        uVar7 = 0x98;
        uVar8 = 0x7c;
        goto LAB_18007c686;
      }
      if (*param_3 == L'%') {
        iVar3 = FUN_180011b58((undefined2 *)&param_6,local_res20);
        if (-1 < iVar3) {
          sVar2 = FUN_180011bf4(*(short *)(param_1 + 0x240));
          if (sVar2 == -1) {
            sVar2 = local_res20[0];
          }
          uVar4 = FUN_180074234(*(short **)(param_2 + 0x38),param_3,_Dst,uVar6 >> 1,
                                (longlong *)local_48,(short)param_6,sVar2);
          if ((int)uVar4 < 0) {
            FUN_18001188c(1,0xc0,0x99,0xd0,(char)param_3);
            goto LAB_18007c63d;
          }
          goto LAB_18007c60f;
        }
        uVar7 = 0xa8;
        uVar8 = 0x88;
      }
      else {
        RtlMoveMemory(_Dst,*param_5,(ulonglong)*(uint *)(param_5 + 1) * 2);
        RtlMoveMemory(_Dst + *(uint *)(param_5 + 1),param_3,(ulonglong)(param_4 + 1) * 2);
LAB_18007c60f:
        uVar5 = FUN_180071414(_Dst,_Dst,uVar6 >> 1);
        iVar3 = (int)uVar5;
        if (-1 < iVar3) {
          *param_6 = _Dst;
          _Dst = (wchar_t *)0x0;
          uVar10 = 1;
          goto LAB_18007c63d;
        }
        uVar7 = 0x30;
        uVar8 = 0xb2;
      }
      FUN_18001188c(1,0xc0,uVar8,uVar7,(char)iVar3);
LAB_18007c63d:
      if (_Dst == (wchar_t *)0x0) {
        return uVar10;
      }
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,_Dst);
      return uVar10;
    }
    uVar8 = 0x6f;
  }
  else {
    uVar4 = (ulonglong)*(uint *)(param_5 + 1) + (ulonglong)param_4;
    if (uVar4 < *(uint *)(param_5 + 1)) {
      uVar8 = 100;
    }
    else {
      uVar6 = uVar4 + 1;
      if (uVar4 <= uVar6) goto LAB_18007c4bb;
      uVar8 = 0x69;
    }
  }
  uVar7 = 0;
LAB_18007c686:
  FUN_18001188c(1,0xc0,uVar8,uVar7,in_stack_ffffffffffffff98);
  return 0;
}



bool FUN_18007c6bc(int **param_1)

{
  FUN_18001188c(1,0x10,0x93,0xb0,(char)**param_1);
  return **param_1 != -0x3fffff03;
}



short * FUN_18007c744(short *param_1,void *param_2,void *param_3)

{
  int iVar1;
  bool bVar2;
  short sVar3;
  short sVar4;
  int iVar5;
  longlong lVar6;
  short *psVar7;
  ulonglong uVar8;
  longlong lVar9;
  wchar_t *pwVar10;
  short *psVar11;
  short *psVar12;
  ulonglong uVar13;
  ulonglong uVar14;
  longlong in_GS_OFFSET;
  ulonglong local_res8;
  void *local_res10;
  void *local_res18;
  undefined uVar15;
  undefined8 in_stack_ffffffffffffffb8;
  
  lVar9 = -1;
  uVar13 = 0xffffffffffffffff;
  do {
    uVar8 = uVar13;
    uVar13 = uVar8 + 1;
  } while (*(short *)((longlong)param_2 + uVar13 * 2) != 0);
  uVar14 = 0xffffffffffffffff;
  do {
    uVar14 = uVar14 + 1;
  } while (*(short *)((longlong)param_3 + uVar14 * 2) != 0);
  local_res10 = param_2;
  local_res18 = param_3;
  iVar5 = _wcsnicmp(L"__PROCESS_HISTORY",L"systemroot",10);
  uVar15 = (undefined)in_stack_ffffffffffffffb8;
  iVar1 = (int)uVar8;
  if (iVar5 == 0) {
    lVar6 = FUN_18001b894();
    do {
      lVar9 = lVar9 + 1;
    } while (*(short *)(lVar6 + lVar9 * 2) != 0);
LAB_18007c913:
    iVar5 = -0x3fffffdd;
    uVar8 = (ulonglong)(uint)(iVar1 + 3 + (int)uVar14) + lVar9 + 1;
  }
  else {
    if (param_1 != (short *)0x0) {
      sVar3 = *param_1;
      psVar7 = param_1;
      while (uVar15 = (undefined)in_stack_ffffffffffffffb8, sVar3 != 0) {
        pwVar10 = L"__PROCESS_HISTORY";
        psVar12 = psVar7;
        do {
          if (*psVar12 == 0) break;
          sVar3 = RtlUpcaseUnicodeChar(*pwVar10);
          sVar4 = RtlUpcaseUnicodeChar();
          if (sVar4 != sVar3) break;
          psVar12 = psVar12 + 1;
          pwVar10 = pwVar10 + 1;
        } while (pwVar10 < L"");
        uVar15 = (undefined)in_stack_ffffffffffffffb8;
        param_2 = local_res10;
        if ((pwVar10 == L"") && (*psVar12 == 0x3d)) {
          bVar2 = true;
          psVar11 = psVar12;
LAB_18007c841:
          sVar3 = *psVar11;
          psVar12 = psVar11;
          for (lVar9 = 0; (sVar3 != 0 && (lVar9 < 0xfffe)); lVar9 = lVar9 + 2) {
            psVar12 = psVar12 + 1;
            sVar3 = *psVar12;
          }
          if (bVar2) {
            lVar9 = (longlong)psVar12 - (longlong)(psVar11 + 1) >> 1;
            goto LAB_18007c913;
          }
        }
        else {
          bVar2 = false;
          for (; *psVar12 != 0; psVar12 = psVar12 + 1) {
            if ((*psVar12 == 0x3d) && (psVar11 = psVar12, psVar12 != psVar7)) goto LAB_18007c841;
          }
        }
        psVar7 = psVar12 + 1;
        sVar3 = *psVar7;
      }
    }
    iVar5 = -0x3fffff00;
    uVar8 = (ulonglong)(uint)(iVar1 + 2 + (int)uVar14);
  }
  psVar7 = (short *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,
                                    uVar8 * 2);
  if (psVar7 == (short *)0x0) {
    FUN_18001188c(1,0,0xbd,0xd0,uVar15);
    psVar7 = (short *)0x0;
  }
  else {
    *psVar7 = 0;
    psVar12 = psVar7;
    if ((iVar5 == -0x3fffffdd) &&
       (local_res8 = uVar8 * 2,
       lVar9 = FUN_1800746e0(param_1,L"__PROCESS_HISTORY",0x11,psVar7,uVar8 & 0x7fffffffffffffff,
                             &local_res8), -1 < (int)lVar9)) {
      psVar11 = psVar7 + local_res8;
      psVar12 = psVar11 + -1;
      if (psVar11[-1] != 0x3b) {
        *psVar11 = 0x3b;
        psVar12 = psVar11;
      }
      psVar12 = psVar12 + 1;
    }
    RtlMoveMemory(psVar12,param_2,(uVar13 & 0xffffffff) * 2);
    RtlMoveMemory(psVar12 + (uVar13 & 0xffffffff),local_res18,(uVar14 & 0xffffffff) * 2);
    (psVar12 + (uVar13 & 0xffffffff))[uVar14 & 0xffffffff] = 0;
  }
  return psVar7;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

int FUN_18007c9e4(longlong *param_1)

{
  undefined4 uVar1;
  undefined8 uVar2;
  int iVar3;
  longlong lVar4;
  longlong **pplVar5;
  int iVar6;
  undefined uVar7;
  undefined uVar8;
  longlong in_GS_OFFSET;
  undefined in_stack_ffffffffffffffb8;
  int iStack44;
  
  iVar6 = 0;
  pplVar5 = (longlong **)0x0;
  if (DAT_1800b29f8 == 0) {
    uVar8 = 0x18;
    uVar7 = 0x93;
  }
  else if (*(uint *)(*param_1 + 0x14) < 0x14) {
    uVar8 = 0x70;
    uVar7 = 0x98;
  }
  else {
    lVar4 = *(longlong *)(*param_1 + 8);
    uVar2 = *(undefined8 *)(lVar4 + 8);
    uVar1 = *(undefined4 *)(lVar4 + 0x10);
    if ((int)uVar2 == 0x6662647a) {
      iStack44 = (int)((ulonglong)uVar2 >> 0x20);
      if (iStack44 == DAT_1800b2a00) {
        lVar4 = RtlAllocateHeap(uVar2,*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),8,
                                uVar1);
        if (lVar4 != 0) {
          iVar3 = (*(code *)DAT_1800b29f8)();
          if (iVar3 == 0) {
            FUN_18001188c(1,0x50,0xc1,0x40,in_stack_ffffffffffffffb8);
            iVar6 = 0;
          }
          else {
            pplVar5 = (longlong **)FUN_180079338(lVar4,uVar1);
            if (pplVar5 != (longlong **)0x0) {
              *(uint *)(pplVar5 + 3) = *(uint *)(pplVar5 + 3) | 0xc;
              lVar4 = 0;
              iVar6 = 1;
            }
          }
          if (lVar4 != 0) {
            RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lVar4);
            if (pplVar5 != (longlong **)0x0) {
              pplVar5[1] = (longlong *)0x0;
            }
          }
          if ((iVar6 == 0) && (pplVar5 != (longlong **)0x0)) {
            FUN_180011708(pplVar5);
            pplVar5 = (longlong **)0x0;
          }
          goto LAB_18007cb95;
        }
        uVar8 = 0xf0;
        uVar7 = 0xb7;
      }
      else {
        uVar8 = 0xa8;
        uVar7 = 0xa4;
      }
    }
    else {
      uVar8 = 0x90;
      uVar7 = 0x9f;
    }
  }
  FUN_18001188c(1,0x50,uVar7,uVar8,in_stack_ffffffffffffffb8);
  iVar6 = 0;
LAB_18007cb95:
  FUN_180011708((longlong **)*param_1);
  *param_1 = (longlong)pplVar5;
  return iVar6;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

ulonglong FUN_18007cbbc(uint *param_1,longlong param_2,longlong param_3,uint param_4,
                       wchar_t **param_5)

{
  ushort uVar1;
  uint uVar2;
  undefined4 *puVar3;
  ulonglong *puVar4;
  ulonglong uVar5;
  undefined8 uVar6;
  ushort uVar7;
  longlong lVar8;
  ulonglong uVar9;
  uint uVar10;
  int *piVar11;
  uint uVar12;
  longlong in_GS_OFFSET;
  bool bVar13;
  uint local_58;
  undefined4 local_54;
  ulonglong local_50 [2];
  
  uVar12 = 0;
  *param_1 = 0;
  local_58 = 1;
  if (param_5 == (wchar_t **)0x0) {
    return 0;
  }
  if (*(int *)(param_5 + 9) == 0) {
    if (param_5[1] != (wchar_t *)0x0) goto LAB_18007cc21;
    bVar13 = false;
  }
  else {
    bVar13 = param_5[4] != (wchar_t *)0x0;
  }
  if (!bVar13) {
    return 0;
  }
LAB_18007cc21:
  puVar3 = (undefined4 *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30))
  ;
  if (puVar3 == (undefined4 *)0x0) {
    uVar9 = 0xc0000017;
  }
  else {
    piVar11 = &DAT_1800b2354;
    uVar10 = local_58;
    do {
      uVar1 = *(ushort *)(piVar11 + -1);
      uVar2 = FUN_1800110fc(param_3,param_4,uVar1);
      if (uVar2 != 0) {
        uVar10 = 0;
        uVar7 = uVar1 & 0xf000;
        puVar4 = (ulonglong *)0x0;
        if (uVar7 == 0x4000) {
          local_54 = FUN_180010c20(param_3,uVar2,0);
          puVar4 = (ulonglong *)&local_54;
          uVar10 = 4;
        }
        else if (uVar7 == 0x5000) {
          local_50[0] = FUN_180078e24(param_3,uVar2,0);
          puVar4 = local_50;
          uVar10 = 8;
        }
        else if (uVar7 == 0x6000) {
          puVar4 = (ulonglong *)FUN_180078d74(param_3,uVar2);
          lVar8 = -1;
          do {
            lVar8 = lVar8 + 1;
          } while (*(short *)((longlong)puVar4 + lVar8 * 2) != 0);
          uVar10 = (int)lVar8 * 2 + 2;
        }
        uVar5 = FUN_180075138(puVar3,param_5,1 << ((byte)*piVar11 & 0x3f));
        uVar9 = uVar5 & 0xffffffff;
        if ((int)uVar5 < 0) {
          FUN_18001188c(1,0xc0,0xe8,0xa0,(char)(&DAT_1800b2354)[(longlong)(int)uVar12 * 2]);
          goto LAB_18007cde0;
        }
        if ((*(byte *)(puVar3 + (longlong)*piVar11 * 8 + 6) & 1) == 0) {
          uVar9 = 0;
          goto LAB_18007cde0;
        }
        uVar6 = FUN_18007ce88(&local_58,uVar1,puVar4,uVar10,
                              (longlong)(puVar3 + (longlong)*piVar11 * 8));
        uVar10 = local_58;
        if ((int)uVar6 == 0) {
          uVar9 = 0xc00000e5;
          FUN_18001188c(1,0xc0,0xff,0xd8,0xe5);
          goto LAB_18007cde0;
        }
        if (*(code **)(param_2 + 0x3d0) != (code *)0x0) {
          (**(code **)(param_2 + 0x3d0))();
        }
        if (uVar10 == 0) break;
      }
      uVar12 = uVar12 + 1;
      piVar11 = piVar11 + 2;
    } while (uVar12 < 0x22);
    uVar9 = 0;
    *param_1 = uVar10;
LAB_18007cde0:
    FUN_180075508(puVar3);
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,puVar3);
  }
  return uVar9;
}



undefined8
FUN_18007ce88(uint *param_1,ushort param_2,ulonglong *param_3,uint param_4,longlong param_5)

{
  bool bVar1;
  ushort uVar2;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined8 uVar4;
  undefined1 unaff_DIL;
  undefined uVar5;
  uint uVar3;
  
  uVar3 = 0;
  *param_1 = 0;
  if (param_2 == 0x401e) {
    if (param_4 < 4) {
      uVar5 = 0x3c;
      goto LAB_18007cf3c;
    }
    uVar3 = (uint)(*(uint *)(param_5 + 0x10) <= *(uint *)param_3);
  }
  else {
    if (param_2 == 0x4033) {
      if (3 < param_4) {
        uVar3 = (uint)(*(uint *)param_3 < *(uint *)(param_5 + 0x10) ||
                      *(uint *)param_3 == *(uint *)(param_5 + 0x10));
        goto LAB_18007d032;
      }
      uVar5 = 0x2f;
      goto LAB_18007cf3c;
    }
    if (0x5001 < param_2) {
      if (param_2 < 0x5004) {
        if (7 < param_4) {
          uVar4 = FUN_18007d0d4(*param_3,*(ulonglong *)(param_5 + 0x10));
          uVar3 = (uint)uVar4;
          goto LAB_18007d032;
        }
        uVar5 = 6;
        goto LAB_18007cf3c;
      }
      if ((param_2 == 0x5006) || (param_2 == 0x500d)) {
        if (7 < param_4) {
          bVar1 = FUN_18007d090(*param_3,*(ulonglong *)(param_5 + 0x10));
          uVar3 = (uint)CONCAT71(extraout_var_00,bVar1);
          goto LAB_18007d032;
        }
        uVar5 = 0x22;
        goto LAB_18007cf3c;
      }
      if ((0x5011 < param_2) && (param_2 < 0x5014)) {
        if (7 < param_4) {
          bVar1 = FUN_18007d04c(*param_3,*(ulonglong *)(param_5 + 0x10));
          uVar3 = (uint)CONCAT71(extraout_var,bVar1);
          goto LAB_18007d032;
        }
        uVar5 = 0x14;
        goto LAB_18007cf3c;
      }
    }
    uVar2 = param_2 & 0xf000;
    if (uVar2 == 0x4000) {
      if (param_4 < 4) {
        uVar5 = 0x4c;
LAB_18007cf3c:
        FUN_18001188c(1,0x88,uVar5,0x68,unaff_DIL);
        return 0;
      }
      bVar1 = *(int *)param_3 == *(int *)(param_5 + 0x10);
    }
    else {
      if (uVar2 != 0x5000) {
        if (uVar2 == 0x6000) {
          if (param_4 < 2) {
            uVar5 = 0x5c;
            goto LAB_18007cf3c;
          }
          uVar4 = FUN_180073d70((short *)param_3,*(short **)(param_5 + 0x10));
          uVar3 = (uint)uVar4;
        }
        goto LAB_18007d032;
      }
      if (param_4 < 8) {
        uVar5 = 0x6a;
        goto LAB_18007cf3c;
      }
      bVar1 = *param_3 == *(ulonglong *)(param_5 + 0x10);
    }
    uVar3 = (uint)bVar1;
  }
LAB_18007d032:
  *param_1 = uVar3;
  return 1;
}



bool FUN_18007d04c(ulonglong param_1,ulonglong param_2)

{
  int iVar1;
  ushort uVar2;
  ushort uVar3;
  
  iVar1 = 0x30;
  while( true ) {
    uVar2 = (ushort)(param_1 >> ((byte)iVar1 & 0x3f));
    uVar3 = (ushort)(param_2 >> ((byte)iVar1 & 0x3f));
    if ((uVar2 != uVar3) && (uVar2 != 0xffff)) break;
    iVar1 = iVar1 + -0x10;
    if (iVar1 < 0) {
      return true;
    }
  }
  return uVar2 < uVar3;
}



bool FUN_18007d090(ulonglong param_1,ulonglong param_2)

{
  int iVar1;
  ushort uVar2;
  ushort uVar3;
  
  iVar1 = 0x30;
  while( true ) {
    uVar2 = (ushort)(param_1 >> ((byte)iVar1 & 0x3f));
    uVar3 = (ushort)(param_2 >> ((byte)iVar1 & 0x3f));
    if ((uVar2 != uVar3) && (uVar2 != 0xffff)) break;
    iVar1 = iVar1 + -0x10;
    if (iVar1 < 0) {
      return true;
    }
  }
  return uVar3 < uVar2;
}



undefined8 FUN_18007d0d4(ulonglong param_1,ulonglong param_2)

{
  int iVar1;
  short sVar2;
  
  iVar1 = 0x30;
  while ((sVar2 = (short)(param_1 >> ((byte)iVar1 & 0x3f)),
         sVar2 == (short)(param_2 >> ((byte)iVar1 & 0x3f)) || (sVar2 == -1))) {
    iVar1 = iVar1 + -0x10;
    if (iVar1 < 0) {
      return 1;
    }
  }
  return 0;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

longlong FUN_18007d110(longlong param_1,void *param_2,undefined **param_3)

{
  longlong lVar1;
  
  lVar1 = 0;
  if (((param_1 != 0) && (*(int *)(param_1 + 0x20c) == -0x53f21255)) &&
     (*(int *)(param_1 + 0x208) == 0x11c0)) {
    lVar1 = (*(code *)*param_3)();
    if (lVar1 != 0) {
      RtlMoveMemory(param_2,(void *)(param_1 + 0x218),0x1c8);
      (*(code *)param_3[2])();
    }
  }
  return lVar1;
}



undefined8 FUN_18007d1b0(undefined8 param_1,undefined8 param_2,longlong param_3)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  longlong *plVar4;
  uint uVar5;
  longlong lVar6;
  ulonglong uVar7;
  undefined8 uVar8;
  undefined8 in_R9;
  longlong in_GS_OFFSET;
  uint local_38;
  int local_34;
  void *local_30;
  longlong *local_28;
  undefined8 local_20;
  
  uVar8 = 0;
  local_28 = (longlong *)0x0;
  local_34 = 0;
  local_30 = (void *)0x0;
  local_38 = 0;
  lVar6 = FUN_18007d2f4((undefined)param_1,(undefined)param_2,8,(char)&local_28,&local_34,in_R9);
  plVar4 = local_28;
  if ((int)lVar6 != 0) {
    lVar6 = FUN_18007d2f4((undefined)param_1,(undefined)param_2,9,(char)&local_30,&local_38,in_R9);
    if ((int)lVar6 != 0) {
      uVar5 = 0x30;
      if (local_38 < 0x30) {
        uVar5 = local_38;
      }
      *(uint *)(param_3 + 0x3c) = uVar5;
      memcpy((void *)(param_3 + 0x40),local_30,(ulonglong)uVar5 << 4);
      if (local_34 != 0) {
        uVar7 = FUN_1800166c0(plVar4,&local_20);
        if ((int)uVar7 != 0) {
          *(undefined4 *)(param_3 + 0x38) = 5;
          uVar1 = *(undefined4 *)((longlong)plVar4 + 4);
          uVar2 = *(undefined4 *)(plVar4 + 1);
          uVar3 = *(undefined4 *)((longlong)plVar4 + 0xc);
          *(undefined4 *)(param_3 + 0x18) = *(undefined4 *)plVar4;
          *(undefined4 *)(param_3 + 0x1c) = uVar1;
          *(undefined4 *)(param_3 + 0x20) = uVar2;
          *(undefined4 *)(param_3 + 0x24) = uVar3;
        }
      }
      uVar8 = 1;
    }
  }
  if (plVar4 != (longlong *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_28);
  }
  if (local_30 != (void *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,local_30);
  }
  return uVar8;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall
// WARNING: Removing unreachable block (ram,0x00018007d350)
// WARNING: Removing unreachable block (ram,0x00018007d361)
// WARNING: Removing unreachable block (ram,0x00018007d38a)
// WARNING: Removing unreachable block (ram,0x00018007d3af)

longlong FUN_18007d2f4(undefined param_1,undefined param_2,undefined param_3,undefined param_4,
                      undefined4 *param_5,longlong param_6)

{
  int iVar1;
  undefined7 in_register_00000089;
  longlong in_GS_OFFSET;
  
  iVar1 = (**(code **)(param_6 + 0x18))();
  if (iVar1 == 0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,0);
  }
  *(undefined8 *)CONCAT71(in_register_00000089,param_4) = 0;
  *param_5 = 0;
  return (ulonglong)(iVar1 != 0);
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18007d40c(uint *param_1)

{
  int iVar1;
  undefined auStack152 [32];
  undefined4 local_78;
  undefined *local_70;
  longlong local_68;
  undefined local_60 [8];
  undefined4 local_58 [2];
  undefined8 local_50;
  undefined *local_48;
  undefined4 local_40;
  undefined local_38 [16];
  undefined local_28 [8];
  int iStack32;
  int iStack28;
  undefined4 local_18;
  ulonglong local_10;
  
  local_10 = DAT_1800b2220 ^ (ulonglong)auStack152;
  local_68 = 0;
  local_50 = 0;
  local_48 = &DAT_1800807b0;
  local_58[0] = 0x30;
  local_40 = 0x40;
  local_38 = ZEXT816(0);
  iVar1 = NtOpenKey(&local_68,0x101,local_58);
  if (-1 < iVar1) {
    local_18 = 0;
    local_70 = local_60;
    local_78 = 0x14;
    _local_28 = ZEXT816(0);
    iVar1 = NtQueryValueKey(local_68,&DAT_1800807a0,2,local_28);
    if (((-1 < iVar1) && (local_28._4_4_ == 4)) && (iStack32 == 4)) {
      *param_1 = (uint)(iStack28 == 1);
    }
  }
  if (local_68 != 0) {
    NtClose();
  }
  __security_check_cookie(local_10 ^ (ulonglong)auStack152);
  return;
}



void FUN_18007d510(undefined8 param_1,undefined8 param_2)

{
  ResolveDelayLoadedAPI(0x180000000,param_1,0,DelayLoadFailureHook_exref,param_2,0);
  return;
}



int FUN_18007d554(void *param_1,uint *param_2)

{
  int iVar1;
  longlong lVar2;
  int local_res18 [2];
  longlong local_res20;
  undefined local_78 [16];
  undefined local_68 [16];
  undefined local_58 [16];
  undefined4 local_48 [2];
  undefined8 local_40;
  undefined *local_38;
  undefined4 local_30;
  undefined local_28 [16];
  
  local_res20 = 0;
  RtlInitUnicodeString(local_68,L"Network ComputerName");
  RtlInitUnicodeString
            (local_78,
             L"\\Registry\\Machine\\System\\CurrentControlSet\\Control\\ComputerName\\ActiveComputerName"
            );
  local_38 = local_78;
  local_48[0] = 0x30;
  local_40 = 0;
  local_30 = 0x40;
  local_28 = ZEXT816(0);
  iVar1 = NtCreateKey(&local_res20,0x2001f,local_48,0,local_68,1,local_res18);
  if (-1 < iVar1) {
    if (local_res18[0] == 2) {
      iVar1 = FUN_18007d8f0(0,(undefined *)
                              L"\\Registry\\Machine\\System\\CurrentControlSet\\Control\\ComputerName\\ActiveComputerName"
                            ,L"ComputerName",param_1,param_2);
      if (iVar1 == -0x3fffffcc) {
        iVar1 = -0x3fffffff;
        goto LAB_18007d68e;
      }
    }
    RtlInitUnicodeString(local_58,L"ComputerName");
    lVar2 = -1;
    do {
      lVar2 = lVar2 + 1;
    } while (*(short *)((longlong)param_1 + lVar2 * 2) != 0);
    iVar1 = NtSetValueKey(local_res20,local_58,0,1,param_1,(int)lVar2 * 2 + 2);
  }
LAB_18007d68e:
  if (local_res20 != 0) {
    NtClose();
  }
  return iVar1;
}



// WARNING: Function: _guard_dispatch_icall replaced with injection: guard_dispatch_icall

undefined8 FUN_18007d6c4(void)

{
  int iVar1;
  HMODULE hModule;
  FARPROC pFVar2;
  undefined8 uVar3;
  
  hModule = LoadLibraryExW(L"DNSAPI.DLL",(HANDLE)0x0,0);
  if (hModule == (HMODULE)0x0) {
    uVar3 = 0x485;
  }
  else {
    pFVar2 = GetProcAddress(hModule,"DnsValidateName_W");
    if (pFVar2 == (FARPROC)0x0) {
      FreeLibrary(hModule);
      uVar3 = 0x482;
    }
    else {
      iVar1 = (*pFVar2)();
      FreeLibrary(hModule);
      if ((iVar1 == 0) || (iVar1 == 0x2554)) {
        return 1;
      }
      uVar3 = 0x57;
    }
  }
  RtlSetLastWin32Error(uVar3);
  return 0;
}



undefined8 FUN_18007d780(wchar_t *param_1)

{
  int iVar1;
  size_t sVar2;
  ulonglong uVar3;
  int local_res10 [2];
  ulonglong uVar4;
  
  uVar3 = 0xffffffffffffffff;
  do {
    uVar4 = uVar3;
    uVar3 = uVar4 + 1;
  } while (param_1[uVar3] != L'\0');
  iVar1 = RtlUnicodeToMultiByteSize(local_res10,param_1,(int)uVar3 * 2);
  if ((((-1 < iVar1) && (local_res10[0] - 1U < 0xf)) &&
      (sVar2 = wcscspn(param_1,
                       L"\"/\\[]:|<>+=;,?\x01\x02\x03\x04\x05\x06\a\b\t\n\v\f\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f"
                      ), (uVar3 & 0xffffffff) <= sVar2)) &&
     ((*param_1 != L' ' && (param_1[uVar4 & 0xffffffff] != L' ')))) {
    return 1;
  }
  RtlSetLastWin32Error(0x57);
  return 0;
}



LPWSTR FUN_18007d828(COMPUTER_NAME_FORMAT param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  undefined4 *puVar3;
  LPWSTR lpBuffer;
  longlong in_GS_OFFSET;
  uint local_res10 [6];
  
  lpBuffer = (LPWSTR)0x0;
  local_res10[0] = 0;
  BVar1 = GetComputerNameExW(param_1,(LPWSTR)0x0,local_res10);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
    if (DVar2 == 0xea) {
      puVar3 = (undefined4 *)KernelBaseGetGlobalData();
      lpBuffer = (LPWSTR)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                         *puVar3,(ulonglong)local_res10[0] * 2);
      if (lpBuffer != (LPWSTR)0x0) {
        BVar1 = GetComputerNameExW(param_1,lpBuffer,local_res10);
        if (BVar1 == 0) {
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lpBuffer);
          lpBuffer = (LPWSTR)0x0;
        }
      }
    }
  }
  return lpBuffer;
}



int FUN_18007d8f0(longlong param_1,undefined *param_2,undefined8 param_3,void *param_4,uint *param_5
                 )

{
  uint uVar1;
  int iVar2;
  
  param_5._0_4_ = *param_5 * 2;
  iVar2 = FUN_18001a90c(param_1,param_2,param_3,param_4,(uint *)&param_5);
  if (iVar2 == -0x3fffffcc) {
    param_5._0_4_ = *param_5 * 2;
    iVar2 = FUN_18001a90c(0,param_2,param_3,param_4,(uint *)&param_5);
  }
  *param_5 = (uint)param_5 >> 1;
  if (-1 < iVar2) {
    if (((uint)param_5 >> 1 == 0) ||
       (uVar1 = ((uint)param_5 >> 1) - 1, *(short *)((longlong)param_4 + (ulonglong)uVar1 * 2) != 0)
       ) {
      iVar2 = -0x3fffff1b;
    }
    else {
      *param_5 = uVar1;
    }
  }
  return iVar2;
}



wchar_t * FUN_18007d998(int param_1)

{
  uint uVar1;
  LPWSTR _Src;
  wchar_t *_Src_00;
  undefined4 *puVar2;
  wchar_t *_Dst;
  wchar_t *pwVar3;
  wchar_t *pwVar4;
  wchar_t *pwVar5;
  longlong in_GS_OFFSET;
  
  pwVar5 = (wchar_t *)0x0;
  if (param_1 < 0) {
    return (wchar_t *)0x0;
  }
  if (param_1 < 3) {
LAB_18007db66:
    _Dst = (wchar_t *)FUN_18007db94(param_1);
  }
  else {
    if (param_1 != 3) {
      if (param_1 < 4) {
        return (wchar_t *)0x0;
      }
      if (param_1 < 7) goto LAB_18007db66;
      if (param_1 != 7) {
        return (wchar_t *)0x0;
      }
    }
    _Src = FUN_18007d998(1);
    _Src_00 = FUN_18007d998(2);
    if (_Src == (wchar_t *)0x0) {
      if (_Src_00 == (wchar_t *)0x0) {
        return (wchar_t *)0x0;
      }
      _Src = FUN_18007d828(ComputerNameDnsHostname);
    }
    else if (_Src_00 == (wchar_t *)0x0) {
      _Src_00 = FUN_18007d828(ComputerNameDnsDomain);
    }
    pwVar4 = (wchar_t *)0xffffffffffffffff;
    pwVar3 = pwVar5;
    if (_Src != (wchar_t *)0x0) {
      pwVar3 = (wchar_t *)0xffffffffffffffff;
      do {
        pwVar3 = (wchar_t *)((longlong)pwVar3 + 1);
      } while (_Src[(longlong)pwVar3] != L'\0');
    }
    _Dst = _Src;
    if (_Src_00 != (wchar_t *)0x0) {
      do {
        pwVar4 = (wchar_t *)((longlong)pwVar4 + 1);
      } while (_Src_00[(longlong)pwVar4] != L'\0');
      if (((int)pwVar4 != 0) && ((int)pwVar3 != 0)) {
        if (((int)pwVar4 == 1) && (*_Src_00 == L'.')) {
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,_Src_00);
          _Src_00 = pwVar5;
          pwVar4 = pwVar5;
        }
        puVar2 = (undefined4 *)KernelBaseGetGlobalData();
        uVar1 = (int)pwVar4 + 2 + (int)pwVar3;
        _Dst = (wchar_t *)
               RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),*puVar2,
                               (ulonglong)uVar1 * 2);
        if (_Dst != (wchar_t *)0x0) {
          wcscpy_s(_Dst,(ulonglong)uVar1,_Src);
          wcscat_s(_Dst,(ulonglong)uVar1,L".");
          if (_Src_00 != (wchar_t *)0x0) {
            wcscat_s(_Dst,(ulonglong)uVar1,_Src_00);
          }
        }
        if (_Src != (wchar_t *)0x0) {
          RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,_Src);
        }
      }
    }
    if (_Src_00 != (wchar_t *)0x0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,_Src_00);
    }
  }
  return _Dst;
}



void * FUN_18007db94(int param_1)

{
  int iVar1;
  undefined4 *puVar2;
  void *pvVar3;
  wchar_t *pwVar4;
  wchar_t *pwVar5;
  wchar_t *pwVar6;
  longlong in_GS_OFFSET;
  uint local_res8 [2];
  
  pvVar3 = (void *)0x0;
  local_res8[0] = 0;
  if (param_1 == 0) {
LAB_18007dbff:
    pwVar6 = (wchar_t *)0x0;
    pwVar5 = L"\\Registry\\Machine\\System\\CurrentControlSet\\Control\\ComputerName\\ComputerName";
    pwVar4 = L"ComputerName";
  }
  else {
    if (param_1 == 1) {
LAB_18007dbe8:
      pwVar6 = L"DnscacheTcpipParameters";
      pwVar5 = L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters";
      pwVar4 = L"NV Hostname";
      goto LAB_18007dc0f;
    }
    if (param_1 != 2) {
      if (param_1 == 4) goto LAB_18007dbff;
      if (param_1 == 5) goto LAB_18007dbe8;
      if (param_1 != 6) {
        return (void *)0x0;
      }
    }
    pwVar6 = L"DnscacheTcpipParameters";
    pwVar5 = L"\\Registry\\Machine\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters";
    pwVar4 = L"NV Domain";
  }
LAB_18007dc0f:
  iVar1 = FUN_18007d8f0((longlong)pwVar6,(undefined *)pwVar5,pwVar4,(void *)0x0,local_res8);
  if (iVar1 == -0x7ffffffb) {
    puVar2 = (undefined4 *)KernelBaseGetGlobalData();
    pvVar3 = (void *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),
                                     *puVar2,(ulonglong)local_res8[0] * 2);
    if (pvVar3 == (void *)0x0) {
      return (void *)0x0;
    }
    iVar1 = FUN_18007d8f0((longlong)pwVar6,(undefined *)pwVar5,pwVar4,pvVar3,local_res8);
  }
  if (iVar1 < 0) {
    if (pvVar3 != (void *)0x0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,pvVar3);
    }
    return (void *)0x0;
  }
  return pvVar3;
}



int * FUN_18007dccc(HANDLE param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  int *_Dst;
  longlong in_GS_OFFSET;
  uint local_res10 [2];
  
  local_res10[0] = 0x20;
  while( true ) {
    KernelBaseGetGlobalData();
    _Dst = (int *)RtlAllocateHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
    if (_Dst == (int *)0x0) break;
    memset(_Dst,0,(ulonglong)local_res10[0]);
    BVar1 = DeviceIoControl(param_1,0x560000,(LPVOID)0x0,0,_Dst,local_res10[0],local_res10,
                            (LPOVERLAPPED)0x0);
    if (BVar1 == 1) {
      return _Dst;
    }
    DVar2 = GetLastError();
    if (DVar2 != 0xea) goto LAB_18007ddba;
    local_res10[0] = *_Dst * 0x18 + 8;
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30));
  }
  DVar2 = 8;
LAB_18007ddba:
  if (DVar2 != 0) {
    if (_Dst != (int *)0x0) {
      RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,_Dst);
      _Dst = (int *)0x0;
    }
    RtlSetLastWin32Error(DVar2);
  }
  return _Dst;
}



void FUN_18007de0c(uint param_1)

{
  DWORD DVar1;
  BOOL BVar2;
  ulonglong uVar3;
  HANDLE hDevice;
  undefined auStackY200 [32];
  DWORD local_88 [2];
  undefined local_80 [16];
  undefined local_70 [16];
  wchar_t local_58 [32];
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStackY200;
  local_88[0] = 0;
  DVar1 = 0;
  hDevice = (HANDLE)0xffffffffffffffff;
  uVar3 = FUN_180017608(local_58,0x40,L"\\\\.\\PhysicalDrive%lu",(ulonglong)param_1);
  if ((int)(uint)uVar3 < 0) {
    DVar1 = (uint)uVar3 & 0xffff;
  }
  else {
    hDevice = CreateFileW(local_58,0x80000000,3,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,
                          (HANDLE)0xffffffffffffffff);
    if (hDevice != (HANDLE)0xffffffffffffffff) {
      local_80 = ZEXT816(0);
      local_70 = ZEXT816(0);
      BVar2 = DeviceIoControl(hDevice,0x70214,(LPVOID)0x0,0,local_80,0x20,local_88,(LPOVERLAPPED)0x0
                             );
      if (BVar2 != 0) goto LAB_18007df07;
    }
    DVar1 = GetLastError();
  }
LAB_18007df07:
  if (DVar1 != 0) {
    RtlSetLastWin32Error(DVar1);
  }
  if (hDevice != (HANDLE)0xffffffffffffffff) {
    CloseHandle(hDevice);
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStackY200);
  return;
}



void FUN_18007df68(uint param_1)

{
  DWORD DVar1;
  BOOL BVar2;
  ulonglong uVar3;
  HANDLE hDevice;
  ulonglong uVar4;
  undefined auStackY168 [32];
  char local_68 [4];
  DWORD local_64 [3];
  wchar_t local_58 [32];
  ulonglong local_18;
  
  local_18 = DAT_1800b2220 ^ (ulonglong)auStackY168;
  local_64[0] = 0;
  local_68[0] = '\0';
  uVar4 = 0;
  hDevice = (HANDLE)0xffffffffffffffff;
  uVar3 = FUN_180017608(local_58,0x40,L"\\\\.\\PhysicalDrive%lu",(ulonglong)param_1);
  if ((int)uVar3 < 0) {
    uVar4 = uVar3 & 0xffff;
  }
  else {
    hDevice = CreateFileW(local_58,0,3,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0xffffffffffffffff)
    ;
    if ((hDevice == (HANDLE)0xffffffffffffffff) ||
       (BVar2 = DeviceIoControl(hDevice,0x700f8,(LPVOID)0x0,0,local_68,1,local_64,(LPOVERLAPPED)0x0)
       , BVar2 == 0)) {
      DVar1 = GetLastError();
      uVar4 = (ulonglong)DVar1;
    }
    else if (local_68[0] != '\0') goto LAB_18007e067;
  }
  if ((int)uVar4 != 0) {
    RtlSetLastWin32Error(uVar4);
  }
LAB_18007e067:
  if (hDevice != (HANDLE)0xffffffffffffffff) {
    CloseHandle(hDevice);
  }
  __security_check_cookie(local_18 ^ (ulonglong)auStackY168);
  return;
}



undefined4 FUN_18007e0b4(LPCWSTR param_1,longlong param_2)

{
  WCHAR WVar1;
  DWORD DVar2;
  undefined4 uVar3;
  HANDLE hObject;
  int *piVar4;
  undefined4 uVar5;
  longlong in_GS_OFFSET;
  
  uVar3 = 0;
  DVar2 = 0;
  piVar4 = (int *)0x0;
  WVar1 = param_1[param_2 + -1];
  if (WVar1 == L'\\') {
    param_1[param_2 + -1] = L'\0';
  }
  hObject = CreateFileW(param_1,0,3,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0xffffffffffffffff);
  if (WVar1 == L'\\') {
    param_1[param_2 + -1] = L'\\';
  }
  if (hObject == (HANDLE)0xffffffffffffffff) {
LAB_18007e13d:
    DVar2 = GetLastError();
    uVar3 = 0;
LAB_18007e174:
    if (DVar2 == 0) goto LAB_18007e186;
  }
  else {
    piVar4 = FUN_18007dccc(hObject);
    if (piVar4 == (int *)0x0) goto LAB_18007e13d;
    if (*piVar4 != 0) {
      uVar3 = FUN_18007de0c(piVar4[2]);
      goto LAB_18007e174;
    }
    DVar2 = 0x57;
  }
  RtlSetLastWin32Error(DVar2);
LAB_18007e186:
  uVar5 = 0;
  if (DVar2 == 0) {
    uVar5 = uVar3;
  }
  if (hObject != (HANDLE)0xffffffffffffffff) {
    CloseHandle(hObject);
  }
  if (piVar4 != (int *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,piVar4);
  }
  return uVar5;
}



undefined4 FUN_18007e1f0(LPCWSTR param_1,longlong param_2)

{
  WCHAR WVar1;
  DWORD DVar2;
  undefined4 uVar3;
  HANDLE hObject;
  int *piVar4;
  undefined4 uVar5;
  longlong in_GS_OFFSET;
  
  uVar3 = 0;
  DVar2 = 0;
  piVar4 = (int *)0x0;
  WVar1 = param_1[param_2 + -1];
  if (WVar1 == L'\\') {
    param_1[param_2 + -1] = L'\0';
  }
  hObject = CreateFileW(param_1,0,3,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0xffffffffffffffff);
  if (WVar1 == L'\\') {
    param_1[param_2 + -1] = L'\\';
  }
  if (hObject == (HANDLE)0xffffffffffffffff) {
LAB_18007e279:
    DVar2 = GetLastError();
    uVar3 = 0;
LAB_18007e2b0:
    if (DVar2 == 0) goto LAB_18007e2c2;
  }
  else {
    piVar4 = FUN_18007dccc(hObject);
    if (piVar4 == (int *)0x0) goto LAB_18007e279;
    if (*piVar4 != 0) {
      uVar3 = FUN_18007df68(piVar4[2]);
      goto LAB_18007e2b0;
    }
    DVar2 = 0x57;
  }
  RtlSetLastWin32Error(DVar2);
LAB_18007e2c2:
  uVar5 = 0;
  if (DVar2 == 0) {
    uVar5 = uVar3;
  }
  if (hObject != (HANDLE)0xffffffffffffffff) {
    CloseHandle(hObject);
  }
  if (piVar4 != (int *)0x0) {
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,piVar4);
  }
  return uVar5;
}



void FUN_18007e32c(int *param_1)

{
  longlong lVar1;
  int iVar2;
  longlong lVar3;
  longlong lVar4;
  longlong in_GS_OFFSET;
  
  if (param_1 != (int *)0x0) {
    lVar4 = *(longlong *)(param_1 + 2);
    if (lVar4 != 0) {
      iVar2 = 0;
      if (0 < *param_1) {
        lVar3 = 0;
        do {
          lVar1 = *(longlong *)(lVar3 + lVar4);
          if (*(longlong *)(lVar3 + lVar4) != 0) {
            do {
              lVar4 = *(longlong *)(lVar1 + 0x10);
              RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,lVar1);
              lVar1 = lVar4;
            } while (lVar4 != 0);
            lVar4 = *(longlong *)(param_1 + 2);
          }
          iVar2 = iVar2 + 1;
          lVar3 = lVar3 + 8;
        } while (iVar2 < *param_1);
      }
      if (lVar4 != 0) {
        RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0);
      }
    }
    RtlFreeHeap(*(undefined8 *)(*(longlong *)(in_GS_OFFSET + 0x60) + 0x30),0,param_1);
  }
  return;
}


